[{"tags": ["mongodb", "go", "mgo"], "owner": {"reputation": 964, "user_id": 93276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMfFU.jpg?s=128&g=1", "display_name": "Puran", "link": "https://stackoverflow.com/users/93276/puran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494458016, "creation_date": 1494458016, "question_id": 43904067, "link": "https://stackoverflow.com/questions/43904067/go-mgo-session-mode-change-per-query", "title": "go Mgo session mode change per query", "body": "<p>I am initializing my master <code>*mgo.Session</code> mode value to <code>mgo.Monotonic</code> when I first create a MongoDB connection. I was wondering if anyone has seen any issues if we change the mode to say <code>mgo.Strong</code> for the copied session using <code>masterSession.Copy()</code></p>\n\n<p>The reason I am trying to do this is because there are times when I would prefer to read from the primary node to avoid any issues with replica set lag and there are cases where it's okay to rely on read from secondary or replica node.</p>\n\n<p>Would love to know how developers out there handle this similar scenarios\nThanks</p>\n"}, {"tags": ["postgresql", "go", "configuration", "el"], "comments": [{"owner": {"reputation": 2303, "user_id": 109274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a59b0daee5e5570e07a9f976721017e7?s=128&d=identicon&r=PG", "display_name": "mikezter", "link": "https://stackoverflow.com/users/109274/mikezter"}, "edited": false, "score": 0, "creation_date": 1494449000, "post_id": 43902155, "comment_id": 74838605, "body": "what do you want to configure?"}, {"owner": {"reputation": 637, "user_id": 673895, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5a872b8c1949ee382fd068cabb90663?s=128&d=identicon&r=PG&f=1", "display_name": "Here to Learn.", "link": "https://stackoverflow.com/users/673895/here-to-learn"}, "reply_to_user": {"reputation": 2303, "user_id": 109274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a59b0daee5e5570e07a9f976721017e7?s=128&d=identicon&r=PG", "display_name": "mikezter", "link": "https://stackoverflow.com/users/109274/mikezter"}, "edited": false, "score": 0, "creation_date": 1494449719, "post_id": 43902155, "comment_id": 74838977, "body": "I want to configure run time rules (and have a capability to evaluate those runtime). If the configurations are okay for requirements, i want to store those for future computations."}, {"owner": {"reputation": 2303, "user_id": 109274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a59b0daee5e5570e07a9f976721017e7?s=128&d=identicon&r=PG", "display_name": "mikezter", "link": "https://stackoverflow.com/users/109274/mikezter"}, "edited": false, "score": 0, "creation_date": 1494449997, "post_id": 43902155, "comment_id": 74839121, "body": "Hm, i&#39;m sorry i don&#39;t know what you mean by &quot;expression language&quot;. You are not talking about writing or storing SQL queries, right?"}, {"owner": {"reputation": 637, "user_id": 673895, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5a872b8c1949ee382fd068cabb90663?s=128&d=identicon&r=PG&f=1", "display_name": "Here to Learn.", "link": "https://stackoverflow.com/users/673895/here-to-learn"}, "reply_to_user": {"reputation": 2303, "user_id": 109274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a59b0daee5e5570e07a9f976721017e7?s=128&d=identicon&r=PG", "display_name": "mikezter", "link": "https://stackoverflow.com/users/109274/mikezter"}, "edited": false, "score": 0, "creation_date": 1494450315, "post_id": 43902155, "comment_id": 74839280, "body": "No problem. Thanks for asking. I am talking about storing expressions that can be operated on top of existing DB contents. These expressions would be stored only if they are satisfying certain criteria. To identify whether the expression satisfies certain criteria, i need some kind of expression language evaluator that works on top of postgresql DB contents (lets say, we get those details in some struct)."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494455248, "post_id": 43902155, "comment_id": 74841300, "body": "I&#39;m not sure this is quite for your use-case given that you allow users to interact with it. For a project where I needed to give an extra dynamic boost, I found this library which will evaluate javascript in go. My usage was purely internal though, so I wasn&#39;t much concerned with the possible safety issues with executing raw javascript. I guess it depends on what exactly you are letting them do and how it affects your application. <a href=\"https://github.com/robertkrimen/otto\" rel=\"nofollow noreferrer\">github.com/robertkrimen/otto</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2591, "user_id": 905486, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7f7e926f83a1b86e0681bae3b79f28ec?s=128&d=identicon&r=PG", "display_name": "Anton Medvedev", "link": "https://stackoverflow.com/users/905486/anton-medvedev"}, "is_accepted": false, "score": 1, "last_activity_date": 1558944596, "creation_date": 1558944596, "answer_id": 56322078, "question_id": 43902155, "link": "https://stackoverflow.com/questions/43902155/expression-language-support-in-golang/56322078#56322078", "title": "Expression Language support in Golang", "body": "<p>Try <a href=\"https://github.com/antonmedv/expr\" rel=\"nofollow noreferrer\">https://github.com/antonmedv/expr</a> \u2013 is an engine that can evaluate expressions.</p>\n\n<p>It can handle expressions like this:</p>\n\n<pre><code>user.Group in [\"good_customers\", \"collaborator\"]\n\nlen(article.Comments) &gt; 100 and article.Category not in [\"misc\"]\n\nproduct.Stock &lt; 15\n\nall(Tickets, {.Price &gt;0})\n</code></pre>\n\n<p>And also has static type checker and user-friendly error messages</p>\n\n<pre><code>error: unclosed \"(\"\n | (boo + bar]\n | ----------^\n</code></pre>\n"}], "owner": {"reputation": 637, "user_id": 673895, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5a872b8c1949ee382fd068cabb90663?s=128&d=identicon&r=PG&f=1", "display_name": "Here to Learn.", "link": "https://stackoverflow.com/users/673895/here-to-learn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558944596, "creation_date": 1494448016, "question_id": 43902155, "link": "https://stackoverflow.com/questions/43902155/expression-language-support-in-golang", "title": "Expression Language support in Golang", "body": "<p>I am trying to implement a functionality that lets users try out configurations in run rime.</p>\n\n<p>Basically, there are some preexisting configurations in DB, but users can make some tweaks on top of those and see results. </p>\n\n<p>This component is written in Golang. One approach i am thinking is about using expression language support. I found some open source packages like <a href=\"https://github.com/araddon/qlbridge\" rel=\"nofollow noreferrer\">https://github.com/araddon/qlbridge</a> </p>\n\n<p>But there are almost negligible number of sample programs / tutorials that demo how to use expression language along with PostgresQL. </p>\n\n<p>Has any one used and attempted such thing? Any suggestions are welcome. Thank you for your time!</p>\n"}, {"tags": ["go", "middleware", "grpc"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1494445494, "post_id": 43901235, "comment_id": 74836821, "body": "It looks kosher so my first guess would be you&#39;re referencing the <code>context</code> package differently than your version of <code>grpc</code>. That package, as of the Go 1.7 moved <code>context</code> from <code>golang.org&#47;x&#47;net&#47;context</code> to just <code>context</code>, and the compiler likely doesn&#39;t see them as equivalent."}, {"owner": {"reputation": 491, "user_id": 7655137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5203fc333c6443affb37aa2209267d71?s=128&d=identicon&r=PG&f=1", "display_name": "darkwing", "link": "https://stackoverflow.com/users/7655137/darkwing"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494448705, "post_id": 43901235, "comment_id": 74838467, "body": "That was right! I could not see that at all, thank you. Post an answer so I can mark it correct."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494449223, "post_id": 43901235, "comment_id": 74838719, "body": "Glad it worked out! Posted as an answer for the benefit of future Google searches."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 6, "last_activity_date": 1494449197, "creation_date": 1494449197, "answer_id": 43902461, "question_id": 43901235, "link": "https://stackoverflow.com/questions/43901235/why-can-i-not-use-func-literal-as-custom-func-type-despite-matching-parameters-i/43902461#43902461", "title": "Why can I not use func literal as custom func type despite matching parameters in golang?", "body": "<p>You may be referencing the <code>context</code> package differently than your version of <code>grpc</code>. As of Go 1.7, the package moved from <code>golang.org/x/net/context</code> to just <code>context</code>, and the compiler likely doesn't see them as equivalent.</p>\n"}], "owner": {"reputation": 491, "user_id": 7655137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5203fc333c6443affb37aa2209267d71?s=128&d=identicon&r=PG&f=1", "display_name": "darkwing", "link": "https://stackoverflow.com/users/7655137/darkwing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6870, "favorite_count": 1, "accepted_answer_id": 43902461, "answer_count": 1, "score": 7, "last_activity_date": 1494449197, "creation_date": 1494444655, "last_edit_date": 1495535486, "question_id": 43901235, "link": "https://stackoverflow.com/questions/43901235/why-can-i-not-use-func-literal-as-custom-func-type-despite-matching-parameters-i", "title": "Why can I not use func literal as custom func type despite matching parameters in golang?", "body": "<p>Package <code>google.golang.org/grpc</code> defines type <code>UnaryClientInterceptor</code> as:</p>\n\n<pre><code>type UnaryClientInterceptor func(ctx context.Context, method string, req, reply interface{}, cc *ClientConn, invoker UnaryInvoker, opts ...CallOption) error\n</code></pre>\n\n<p>In my code I'd like to do something like:</p>\n\n<pre><code>func clientInterceptor() grpc.UnaryClientInterceptor {\n    return func(ctx context.Context, method string, req, reply interface{}, cc *grpc.ClientConn, invoker grpc.UnaryInvoker, opts ...grpc.CallOption) error {\n        //intercept stuff\n        return invoker(ctx, method, req, reply, cc, opts...)\n    }\n}\n</code></pre>\n\n<p>However I get this error: </p>\n\n<p>\"cannot use func literal (type func(\"context\".Context, string, interface {}, interface {}, *grpc.ClientConn, grpc.UnaryInvoker, ...grpc.CallOption) error) as type grpc.UnaryClientInterceptor in return argument\"</p>\n\n<p>Looking at <a href=\"https://stackoverflow.com/questions/19334542/why-can-i-type-alias-functions-and-use-them-without-casting\">Why can I type alias functions and use them without casting?</a> I get the impression that the anonymous function returned in my <code>clientInterceptor()</code> should match the <code>grpc.ClientInterceptor</code> type.</p>\n\n<p>Also, from the spec on Type Identity (<a href=\"http://golang.org/ref/spec#Type_identity\" rel=\"noreferrer\">http://golang.org/ref/spec#Type_identity</a>)</p>\n\n<blockquote>\n  <p>Two function types are identical if they have the same number of parameters and result values, corresponding parameter and result types are identical, and either both functions are variadic or neither is. Parameter and result names are not required to match. </p>\n</blockquote>\n\n<p>I've tried casting and making variables of type <code>grpc.UnaryClientInterceptor</code> but nothing works. </p>\n\n<p>I also did essentially the exact same thing with the <code>grpc.UnaryServerInterceptor</code> and had no problems.</p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 7176437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/549cb8faa34003416eccec2fd3c7dd71?s=128&d=identicon&r=PG&f=1", "display_name": "vkosyj", "link": "https://stackoverflow.com/users/7176437/vkosyj"}, "edited": false, "score": 0, "creation_date": 1494443884, "post_id": 43900906, "comment_id": 74835911, "body": "After I change that, I get new error message                                             &quot;cannot use PaxosInstance literal (type *PaxosInstance) as type PaxosInstance in return argument&quot;"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 679, "user_id": 7176437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/549cb8faa34003416eccec2fd3c7dd71?s=128&d=identicon&r=PG&f=1", "display_name": "vkosyj", "link": "https://stackoverflow.com/users/7176437/vkosyj"}, "edited": false, "score": 1, "creation_date": 1494443970, "post_id": 43900906, "comment_id": 74835965, "body": "There are two changes in my answer. <code>*PaxosInstance</code> on the first line, and the <code>&amp;</code> on the return line. Did you make both changes?"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 21, "last_activity_date": 1614728293, "last_edit_date": 1614728293, "creation_date": 1494443417, "answer_id": 43900906, "question_id": 43900806, "link": "https://stackoverflow.com/questions/43900806/cannot-use-as-type-in-assignment-in-go/43900906#43900906", "title": "Cannot use as type in assignment in go", "body": "<p>Your map is expecting a pointer to a <code>PaxosInstance</code> (<code>*PaxosInstance</code>), but you are passing a struct value to it. Change your Initialize function to return a pointer.</p>\n<pre><code>func (px *Paxos) InitializePaxosInstance(val interface{}) *PaxosInstance {\n    return &amp;PaxosInstance {decided:false, value: val}\n}\n</code></pre>\n<p>Now it returns a pointer. You can take the pointer of a variable using <code>&amp;</code> and, should you need the struct value itself, dereference it again with <code>*</code>.</p>\n<p>After a line like</p>\n<pre><code>x := &amp;PaxosInstance{} \n</code></pre>\n<p>or</p>\n<pre><code>p := PaxosInstance{}\nx := &amp;p\n</code></pre>\n<p>the value type of <code>x</code> is <code>*PaxosInstance</code>. And if you ever need to, you can dereference it back into a <code>PaxosInstance</code> struct value with</p>\n<pre><code>p = *x\n</code></pre>\n<p>You usually do not want to pass structs around as actual values, because Go is pass-by-value, which means it will copy the whole thing. Using struct values with maps and slices often results in logic errors because a copy is made should you iterate them or otherwise reference them except via index. It depends on your use-case, but your identifier <code>Instance</code> would infer that you would want to avoid duplications and such logic errors.</p>\n<p>As for reading the compiler errors, you can see what it was telling you. The type <code>PaxosInstance</code> and type <code>*PaxosInstance</code> are not the same.</p>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494443866, "post_id": 43900952, "comment_id": 74835894, "body": "Generally it isn&#39;t a good idea to store a map of struct values. Each time you set or get it, a copy is made. Struct pointers almost always win out in go"}, {"owner": {"reputation": 319, "user_id": 6884527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58339134cacec9b3825da9861889a035?s=128&d=identicon&r=PG&f=1", "display_name": "vase", "link": "https://stackoverflow.com/users/6884527/vase"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1494443969, "post_id": 43900952, "comment_id": 74835964, "body": "I think &quot;generally&quot; and &quot;up to your use case&quot; are fairly similar phrases. :)"}], "tags": [], "owner": {"reputation": 319, "user_id": 6884527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58339134cacec9b3825da9861889a035?s=128&d=identicon&r=PG&f=1", "display_name": "vase", "link": "https://stackoverflow.com/users/6884527/vase"}, "is_accepted": false, "score": 5, "last_activity_date": 1494443984, "last_edit_date": 1494443984, "creation_date": 1494443601, "answer_id": 43900952, "question_id": 43900806, "link": "https://stackoverflow.com/questions/43900806/cannot-use-as-type-in-assignment-in-go/43900952#43900952", "title": "Cannot use as type in assignment in go", "body": "<p>The <code>instance</code> field within the <code>Paxos</code> struct is a map of integer keys to <em>pointers</em>  to <code>PaxosInstance</code> structs.</p>\n\n<p>When you call:</p>\n\n<pre><code>px.instance[seq] = px.InitializePaxosInstance(val)\n</code></pre>\n\n<p>You're attempting to assign a concrete (not pointer) <code>PaxosInstance</code> struct into an element of <code>px.instance</code>, which are pointers.</p>\n\n<p>You can alleviate this by returning a pointer to a <code>PaxosInstance</code> in <code>InitializePaxosInstance</code>, like so:</p>\n\n<pre><code>func (px *Paxos) InitializePaxosInstance(val interface{}) *PaxosInstance {\n    return &amp;PaxosInstance{decided: false, value: val}\n}\n</code></pre>\n\n<p>or you could modify the <code>instance</code> field within the <code>Paxos</code> struct to not be a map of pointers:</p>\n\n<pre><code>type Paxos struct {\n    instance   map[int]PaxosInstance\n}\n</code></pre>\n\n<p>Which option you choose is up to your use case.</p>\n"}, {"tags": [], "owner": {"reputation": 276, "user_id": 903870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUi8B.jpg?s=128&g=1", "display_name": "deoren", "link": "https://stackoverflow.com/users/903870/deoren"}, "is_accepted": false, "score": 0, "last_activity_date": 1610122490, "last_edit_date": 1610122490, "creation_date": 1610122166, "answer_id": 65632492, "question_id": 43900806, "link": "https://stackoverflow.com/questions/43900806/cannot-use-as-type-in-assignment-in-go/65632492#65632492", "title": "Cannot use as type in assignment in go", "body": "<p>For anyone else pulling their hair out: check your imports.</p>\n<p>Not sure when it started happening, but my Visual Studio Code + gopls setup will occasionally insert an import line that references my vendored dependencies path instead of the original import path. I usually won't catch this until I start polishing code for release, or an error like this one pops up.</p>\n<p>In my case this caused two otherwise identical types to not compare equally. Once I fixed my imports this resolved the error.</p>\n"}], "owner": {"reputation": 679, "user_id": 7176437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/549cb8faa34003416eccec2fd3c7dd71?s=128&d=identicon&r=PG&f=1", "display_name": "vkosyj", "link": "https://stackoverflow.com/users/7176437/vkosyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28882, "favorite_count": 1, "accepted_answer_id": 43900906, "answer_count": 3, "score": 15, "last_activity_date": 1614728293, "creation_date": 1494443097, "question_id": 43900806, "link": "https://stackoverflow.com/questions/43900806/cannot-use-as-type-in-assignment-in-go", "title": "Cannot use as type in assignment in go", "body": "<p>when I compile my code, I get the following error message, not sure why it happens.  Can someone help me point why?  Thank you in advance.</p>\n\n<blockquote>\n  <p>cannot use px.InitializePaxosInstance(val) (type PaxosInstance) as\n  type *PaxosInstance in assignment</p>\n</blockquote>\n\n<pre><code>type Paxos struct {\n    instance   map[int]*PaxosInstance\n}    \n\ntype PaxosInstance struct {\n    value        interface{}\n    decided      bool\n}    \n\nfunc (px *Paxos) InitializePaxosInstance(val interface{}) PaxosInstance {\n    return PaxosInstance {decided:false, value: val}\n}\n\nfunc (px *Paxos) PartAProcess(seq int, val interface{}) error {  \n    px.instance[seq] = px.InitializePaxosInstance(val)\n    return nil \n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["go", "aerospike"], "comments": [{"owner": {"reputation": 2229, "user_id": 4147181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CIuNh.jpg?s=128&g=1", "display_name": "Meher", "link": "https://stackoverflow.com/users/4147181/meher"}, "edited": false, "score": 2, "creation_date": 1494451384, "post_id": 43900028, "comment_id": 74839785, "body": "Can you simply telnet to that port (3000)? What does the aerospike.log say? Is the node up and ready? (Do you see the &#39;soon there will be cake&#39; message?)"}], "owner": {"reputation": 347, "user_id": 6271752, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd7a7b3bc70226842a6d3e4791e5bddb?s=128&d=identicon&r=PG&f=1", "display_name": "A Sears", "link": "https://stackoverflow.com/users/6271752/a-sears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1494440478, "creation_date": 1494440478, "question_id": 43900028, "link": "https://stackoverflow.com/questions/43900028/issue-connecting-to-remote-aerospike-server-via-go-code-running-locally", "title": "Issue connecting to remote Aerospike server via Go code running locally", "body": "<p>I have installed Go (1.8.0) on my Mac (10.10 and then upgraded to 10.12), and then followed the steps at <a href=\"https://github.com/aerospike/aerospike-client-go\" rel=\"nofollow noreferrer\">https://github.com/aerospike/aerospike-client-go</a> for getting the Aerospike client library on my machine.</p>\n\n<p>We have code that we have created and works with our remote server IP address(es) for Aerospike on coworkers' machines as well as a VM running on Google Cloud.  This code does not work on my machine.  I have even tried the test code that is in the aerospike-client-go README, and I get the same error: <code>Failed to connect to host(s): [X.X.X.X:3000]; error: Connecting to the cluster timed out.</code></p>\n\n<p>I am able to ping those IP addresses on port 3000 without any issues.</p>\n\n<p>Is there a configuration that I might be missing that might have to be changed (environmental variable, etc) to get this to go?</p>\n"}, {"tags": ["json", "database", "go", "struct"], "comments": [{"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "edited": false, "score": 2, "creation_date": 1494436097, "post_id": 43898259, "comment_id": 74831334, "body": "Short answer: no. Long answer: I also recommend sqlx. The standard library does not support unmarshalling into a struct."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494436850, "post_id": 43898259, "comment_id": 74831784, "body": "Same recommendation from me as well."}, {"owner": {"reputation": 3596, "user_id": 2481780, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IlH4E.jpg?s=128&g=1", "display_name": "Andzej Maciusovic", "link": "https://stackoverflow.com/users/2481780/andzej-maciusovic"}, "edited": false, "score": 0, "creation_date": 1494437866, "post_id": 43898259, "comment_id": 74832398, "body": "Yep it is not supported, but if you still want to use standard sql package I would recommend to read <a href=\"http://go-database-sql.org/retrieving.html\" rel=\"nofollow noreferrer\">go-database-sql.org/retrieving.html</a>"}, {"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 0, "creation_date": 1494438405, "post_id": 43898259, "comment_id": 74832732, "body": "RE: The second part of your question: I made a little package I use all over the place for exactly this. It&#39;s pretty straightforward if you want to check it out, I threw it up in a gist here: <a href=\"https://gist.github.com/heyimalex/075bb442af0ecbf3e5f561336101e4f7\" rel=\"nofollow noreferrer\">gist.github.com/heyimalex/075bb442af0ecbf3e5f561336101e4f7</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 0, "creation_date": 1494454200, "post_id": 43898259, "comment_id": 74840906, "body": "@AlexGuerra it may be annoying to have to make and tag structs for <code>sqlx</code> but utilizing the type-safety of that method has its advantages."}], "answers": [{"comments": [{"owner": {"reputation": 98, "user_id": 4913880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29c8ccbac55f28590f96018dc138b15e?s=128&d=identicon&r=PG", "display_name": "Avery", "link": "https://stackoverflow.com/users/4913880/avery"}, "edited": false, "score": 0, "creation_date": 1494442069, "post_id": 43899685, "comment_id": 74834812, "body": "I just spoke with my boss, who revealed he has been using <code>sqlx</code> in his tinkerings with the same data. I&#39;ll be trying this solution, because for now I only want the JSON representation of the data, but I will probably move to <code>sqlx</code> per the other comments and your recommendation. Thanks!"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 2, "last_activity_date": 1494439594, "last_edit_date": 1494439594, "creation_date": 1494439284, "answer_id": 43899685, "question_id": 43898259, "link": "https://stackoverflow.com/questions/43898259/scanning-large-rows-into-structs-in-go/43899685#43899685", "title": "Scanning large rows into structs in Go", "body": "<blockquote>\n  <p>the ultimate goal of this function is to return a JSON array of objects</p>\n</blockquote>\n\n<p>It sounds like you could byass the struct entirely then, and instead scan into a <code>map[string]interface{}</code>, and do it all pretty dynamically:\nYou could do something like this:</p>\n\n<pre><code>rows, _ := db.Query(\"SELECT * FROM coderyte\") \ncols, _ := rows.Columns()\nstore := []map[string]interface{}\nfor rows.Next() {\n    columns := make([]interface{}, len(cols))\n    columnPointers := make([]interface{}, len(cols))\n    for i, _ := range columns {\n        columnPointers[i] = &amp;columns[i]\n    }\n\n    if err := rows.Scan(columnPointers...); err != nil {\n        return err\n    }\n    m := make(map[string]interface{})\n    for i, colName := range cols {\n        val := columnPointers[i].(*interface{})\n        m[colName] = *val\n    }\n    store = append(store, m)        \n}\njs, _ := json.Marshal(store)\nfmt.Println(string(js))\n</code></pre>\n\n<p>Now, obviously you could also convert it to a struct, since you could take the json and do <code>json.Unmarshal</code>, but given your use case that seems like a pointless extra step.</p>\n\n<pre><code>js, _ := json.Marshal(store)\nstructs := []Coderyte{}\njson.Unmarshal(js, &amp;structs)\n</code></pre>\n\n<p>All that being said, you should probably just use sqlx - they probably do way cleverer things and do it way more efficiently.</p>\n"}], "owner": {"reputation": 98, "user_id": 4913880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29c8ccbac55f28590f96018dc138b15e?s=128&d=identicon&r=PG", "display_name": "Avery", "link": "https://stackoverflow.com/users/4913880/avery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3030, "favorite_count": 0, "accepted_answer_id": 43899685, "answer_count": 1, "score": 1, "last_activity_date": 1494439594, "creation_date": 1494434257, "question_id": 43898259, "link": "https://stackoverflow.com/questions/43898259/scanning-large-rows-into-structs-in-go", "title": "Scanning large rows into structs in Go", "body": "<p>I'm working with a database which has yet to be normalized, and this table contains records with over 40 columns.</p>\n\n<p>The following is my Go code for (attempting) to scan the records into a large struct:</p>\n\n<pre><code>type Coderyte struct {\n  ID int `json:\"id\"`\n  EmrID int `json:\"emr_id\"`\n  DftID int `json:\"dft_id\"`\n\n  Fix int `json:\"fix\"`\n  ReportDate string `json:\"report_date\"` // Time?\n  Patient string `json:\"patient\"`\n  ... // etc\n}\nfunc ReadCoderyte(res http.ResponseWriter, req *http.Request) {\n  rows, err := db.Query(\"SELECT * FROM coderyte\")\n  if err != nil {\n    http.Error(res, \"Error querying database\", 500)\n  }\n  defer rows.Close()\n\n  // Convert rows into a slice of Coderyte structs\n  coderytes := make([]*Coderyte, 0)\n  for rows.Next() {\n    coderyte := new(Coderyte)\n    err := rows.Scan(&amp;coderyte) // Expected 42 columns\n    if err != nil {\n      panic(err)\n      http.Error(res, \"Error converting coderyte object\", 500)\n    }\n    coderytes = append(coderytes, coderyte)\n  }\n</code></pre>\n\n<p>When I call this code, <code>Scan</code> complains that it \"expected 42 destination arguments, not 1\". My understanding is that I would need to address every single field in this large struct, inside of the scan call, ie <code>Scan(&amp;coderyte.ID, &amp;coderyte.EmrID, etc)</code></p>\n\n<p>My searches have only yielded <a href=\"https://stackoverflow.com/questions/17265463/how-do-i-convert-a-database-row-into-a-struct-in-go\">this other question</a>, where the suggested answer is to use <code>sqlx</code>. I'm trying to avoid using a third-party tool if I don't need it.</p>\n\n<p>My question boils down to: <strong>Is there a way to convert a large database record into a struct without specifying every single field?</strong>.</p>\n\n<p>I should also note that the ultimate goal of this function is to return a JSON array of objects, but I did not include that part of the code because I feel it is not important. If there is a way to bypass <code>Scan</code> and return JSON, that would be an appreciated answer as well. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 0, "last_activity_date": 1494436349, "last_edit_date": 1494436349, "creation_date": 1494435183, "answer_id": 43898545, "question_id": 43898245, "link": "https://stackoverflow.com/questions/43898245/running-all-files-in-directory-what-is-go-run-cmd-go/43898545#43898545", "title": "Running all files in directory, what is go run ./cmd/*.go?", "body": "<blockquote>\n  <p><a href=\"https://en.wikipedia.org\" rel=\"nofollow noreferrer\">Wikipedia</a></p>\n  \n  <p><a href=\"https://en.wikipedia.org/wiki/Glob_(programming)\" rel=\"nofollow noreferrer\">glob (programming)</a></p>\n  \n  <blockquote>\n    <p>In computer programming, in particular in a Unix-like environment,\n    glob patterns specify sets of filenames with wildcard characters. For\n    example, the Unix command mv *.txt textfiles/ moves (mv) all files\n    with names ending in .txt from the current directory to the directory\n    textfiles. Here, * is a wildcard standing for \"any string of\n    characters\" and *.txt is a glob pattern. The other common wildcard is\n    the question mark (?), which stands for one character.</p>\n  </blockquote>\n</blockquote>\n\n<p>Clearly, <code>./cmd/platform/*.go</code>, starting in the current directory, looks in the <code>cmd/platform</code> directory for files matching the wildcard <code>*.go</code>.</p>\n\n<p>The <code>ls ./cmd/platform/*.go</code> command will list the files on Linux.</p>\n\n<p>So, the <code>go run ./cmd/platform/*.go</code> command compiles and runs these Go (<code>*.go</code>) source files. See <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">Command go</a> documentation: <a href=\"https://golang.org/cmd/go/#hdr-Compile_and_run_Go_program\" rel=\"nofollow noreferrer\">Compile and run Go program</a>.</p>\n"}], "owner": {"reputation": 29, "user_id": 4545305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12fb0c59b90b8116e2aa682b96f72f12?s=128&d=identicon&r=PG&f=1", "display_name": "mikelee54", "link": "https://stackoverflow.com/users/4545305/mikelee54"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 1, "accepted_answer_id": 43898545, "answer_count": 1, "score": 1, "last_activity_date": 1494436349, "creation_date": 1494434217, "question_id": 43898245, "link": "https://stackoverflow.com/questions/43898245/running-all-files-in-directory-what-is-go-run-cmd-go", "title": "Running all files in directory, what is go run ./cmd/*.go?", "body": "<p>I am currently looking at this project (<a href=\"https://github.com/mattermost/platform\" rel=\"nofollow noreferrer\">Mattermost</a>) that has a certain line in the makefile that I'm confused about:</p>\n\n<pre><code>$(GO) run $(GOFLAGS) $(GO_LINKER_FLAGS) ./cmd/platform/*.go --disableconfigwatch &amp;\n</code></pre>\n\n<p>What is the meaning of <code>./cmd/platform/*.go</code>? What specific files are executed? The program executes correctly when I type it in the terminal.</p>\n\n<p>I am trying to enter the command line arguments in an IDE but I need a specific entry file.....</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1121, "user_id": 2203218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a9e261af43bdb3164fc4cc3b05f318?s=128&d=identicon&r=PG&f=1", "display_name": "eugecm", "link": "https://stackoverflow.com/users/2203218/eugecm"}, "edited": false, "score": 4, "creation_date": 1494433721, "post_id": 43898074, "comment_id": 74829927, "body": "have you tried <code>errcheck</code>? <a href=\"https://github.com/kisielk/errcheck\" rel=\"nofollow noreferrer\">github.com/kisielk/errcheck</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494436901, "post_id": 43898074, "comment_id": 74831811, "body": "You say you&#39;re aware of the many, many tools available to do static code checking of Go code, but didn&#39;t state why any of the ones you&#39;re already aware of were an adequate solution... is there something in particular you&#39;re looking for that you&#39;ve yet to find?"}], "answers": [{"comments": [{"owner": {"reputation": 1653, "user_id": 3041544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jLIp6.png?s=128&g=1", "display_name": "Farshid T", "link": "https://stackoverflow.com/users/3041544/farshid-t"}, "edited": false, "score": 1, "creation_date": 1615116624, "post_id": 43901848, "comment_id": 117587030, "body": "<a href=\"https://github.com/alecthomas/gometalinter\" rel=\"nofollow noreferrer\">github.com/alecthomas/gometalinter</a> is deprecated by <a href=\"https://github.com/golangci/golangci-lint\" rel=\"nofollow noreferrer\">github.com/golangci/golangci-lint</a>."}], "tags": [], "owner": {"reputation": 68, "user_id": 1003469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0079ba9664abd6d6360d0898506c130?s=128&d=identicon&r=PG", "display_name": "TheGrum", "link": "https://stackoverflow.com/users/1003469/thegrum"}, "is_accepted": true, "score": 4, "last_activity_date": 1494447198, "last_edit_date": 1494447198, "creation_date": 1494446871, "answer_id": 43901848, "question_id": 43898074, "link": "https://stackoverflow.com/questions/43898074/is-there-a-way-to-find-not-handled-errors-in-go-code/43901848#43901848", "title": "Is there a way to find not handled errors in go code?", "body": "<p>As @eugecm suggested, github.com/kisielk/errcheck will do this, as will github.com/GoASTScanner/gas . Also, github.com/alecthomas/gometalinter makes it easy to download a collection of linters and run them in parallel, and includes both of the above.</p>\n\n<p>So, </p>\n\n<pre><code>go get github.com/alecthomas/gometalinter\ngometalinter --install\ngometalinter\n</code></pre>\n\n<p>would download gometalinter, which will then install a number of error and style checkers and run them in parallel, reporting the results.</p>\n\n<p>The relevant results from your example would be like:</p>\n\n<pre><code>main.go:13::warning: Errors unhandled.,LOW,HIGH (gas)\nmain.go:13::warning: error return value not checked (doStuff()) (errcheck)\n</code></pre>\n\n<p>I recommend gometalinter because it gives results like the above, where running errcheck on a bare command just says <code>main.go:13:10  doStuff()</code> (because errcheck is a program that <em>only</em> checks for unchecked error return values, so no additional information is really necessary).</p>\n"}], "owner": {"reputation": 13903, "user_id": 86388, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/cPl84.jpg?s=128&g=1", "display_name": "Tarion", "link": "https://stackoverflow.com/users/86388/tarion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1939, "favorite_count": 1, "accepted_answer_id": 43901848, "answer_count": 1, "score": 2, "last_activity_date": 1494447198, "creation_date": 1494433616, "question_id": 43898074, "link": "https://stackoverflow.com/questions/43898074/is-there-a-way-to-find-not-handled-errors-in-go-code", "title": "Is there a way to find not handled errors in go code?", "body": "<p>Let's assume the following code:</p>\n\n<pre><code>func main() {\n    doStuff()\n}\n</code></pre>\n\n<p>Sound good, until your program runs without any error but does nothing because you just forgot that <code>doStuff()</code> actually looks like:</p>\n\n<pre><code>func doStuff() error {\n    // ...\n    return errors.New(\"woops!\")\n}\n</code></pre>\n\n<p>What we should do ist:</p>\n\n<pre><code>func main() {\n    err := doStuff()\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Or at least (to make it obvious):</p>\n\n<pre><code>func main() {\n    _ = doStuff()\n}\n</code></pre>\n\n<p>There are so many go tools out there like. Is there a simple way to check my code for not handled error return values?</p>\n"}, {"tags": ["unit-testing", "testing", "go", "testify"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1494437029, "post_id": 43897446, "comment_id": 74831881, "body": "You don&#39;t need special syntax or any library-provided function. You&#39;re talking about five lines of code - why not just write the function yourself?"}, {"owner": {"reputation": 7523, "user_id": 1094541, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ctLek.png?s=128&g=1", "display_name": "3cheesewheel", "link": "https://stackoverflow.com/users/1094541/3cheesewheel"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1494503428, "post_id": 43897446, "comment_id": 74862289, "body": "I agree. I want it, I don&#39;t need it. It is very trivial to create my own function, but oftentimes packages will include this sort of thing if it&#39;s something that comes up a lot. Since it doesn&#39;t appear that it&#39;s been included, then I will just write the function. It never hurts to ask. :)"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 4107956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LjlBF.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4107956/will"}, "is_accepted": false, "score": 2, "last_activity_date": 1494433088, "creation_date": 1494433088, "answer_id": 43897908, "question_id": 43897446, "link": "https://stackoverflow.com/questions/43897446/is-it-possible-to-dynamically-assert-if-two-values-are-equal-or-not-equal-when-u/43897908#43897908", "title": "Is it possible to dynamically assert if two values are equal or not equal when unit testing in Go?", "body": "<p>Since it's just for readability, and since it appears that this function does not exist, you could just copy-paste your working code into a separate function:</p>\n\n<pre><code>func equalOrNotEqual(t TestingT, expected, actual interface{}, shouldBeEqual bool) {\n    if shouldBeEqual {\n        assert.Equal(t, expected, actual)\n    } else {\n        assert.NotEqual(t, expected, actual)\n    }\n}\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>for _, table := range tables {\n    actualResult := sampleFunc(table.input)\n    equalOrNotEqual(t, table.comparisonResult, actualResult, table.shouldBeEqual)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9345, "user_id": 4237316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/100004533998341/picture?type=large", "display_name": "Harald Nordgren", "link": "https://stackoverflow.com/users/4237316/harald-nordgren"}, "is_accepted": false, "score": 0, "last_activity_date": 1511745946, "creation_date": 1511745946, "answer_id": 47502807, "question_id": 43897446, "link": "https://stackoverflow.com/questions/43897446/is-it-possible-to-dynamically-assert-if-two-values-are-equal-or-not-equal-when-u/47502807#47502807", "title": "Is it possible to dynamically assert if two values are equal or not equal when unit testing in Go?", "body": "<p>Golang does have a functional aspect, although it's more rigid than in Python or JavaScript.</p>\n\n<p>You can allow your struct table to hold functions if you know their signatures. Then you get rid of the <code>if</code> logic inside the tests:</p>\n\n<pre><code>func TestFunc(t *testing.T) {\n    tables := []struct {\n        input            string\n        comparisonResult string\n        assert           func(assert.TestingT, interface{}, interface{}, ...interface{}) bool\n    }{\n        {\n            input:            \"some irrelevant input\",\n            comparisonResult: \"some result\",\n            assert:           assert.Equal,\n        },\n        {\n            input:            \"some other irrelevant input\",\n            comparisonResult: \"some other result\",\n            assert:           assert.NotEqual,\n        },\n    }\n\n    for _, table := range tables {\n        actualResult := sampleFunc(table.input)\n        table.assert(t, table.comparisonResult, actualResult)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7523, "user_id": 1094541, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ctLek.png?s=128&g=1", "display_name": "3cheesewheel", "link": "https://stackoverflow.com/users/1094541/3cheesewheel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1971, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511745946, "creation_date": 1494431694, "last_edit_date": 1494503902, "question_id": 43897446, "link": "https://stackoverflow.com/questions/43897446/is-it-possible-to-dynamically-assert-if-two-values-are-equal-or-not-equal-when-u", "title": "Is it possible to dynamically assert if two values are equal or not equal when unit testing in Go?", "body": "<p>I've just started using Go. I'm writing unit tests and I'd like to be able to test using a table, where the result to be compared to the actual result sometimes should or should not be equal. </p>\n\n<p>For example, this is the code that I currently have: </p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/stretchr/testify/assert\"\n    \"testing\"\n)\n\nfunc TestFunc(t *testing.T) {\n    tables := []struct {\n        input               string\n        comparisonResult    string\n        shouldBeEqual       bool\n    }{\n        {\n            \"some irrelevant input\",\n            \"some result\",\n            true,\n        },\n        {\n            \"some other irrelevant input\",\n            \"some other result\",\n            false,\n        },\n    }\n\n    for _, table := range tables {\n        actualResult := sampleFunc(table.input)\n        if table.shouldBeEqual {\n            assert.Equal(t, table.expectedResult, actualResult)\n        } else {\n            assert.NotEqual(t, table.expectedResult, actualResult)\n        }\n    }\n}\n</code></pre>\n\n<p>Now, this isn't too bad, but it would be even better if the last bit could be changed to something cleaner like this for better readability:</p>\n\n<pre><code>for _, table := range tables {\n    actualResult := sampleFunc(table.input)\n    assert.EqualOrNotEqual(t, table.comparisonResult, actualResult, table.shouldBeEqual)\n}\n</code></pre>\n\n<p>So, the first test should pass if <code>table.comparisonResult</code> and <code>actualResult</code> are equal, and the second test should pass if the two <em>aren't</em> equal. </p>\n\n<p>I've looked through the <a href=\"https://godoc.org/github.com/stretchr/testify/assert\" rel=\"nofollow noreferrer\"><code>testify/assert</code> docs</a> and I don't think I found a function that is similar to the fake <code>EqualOrNotEqual</code> function that I made up above, but perhaps I accidentally skipped over something, or there is some kind of Go special syntax that I don't know about that might help me achieve this. </p>\n\n<p>Note: I am well aware that I can write my own function for this. My reason for asking was because if this is a well-established pattern, then packages/libraries often include it as a built-in function which may at times be undocumented/buried in the documentation. And if not, maybe there's a reason why I shouldn't do this, or maybe there's a better way of doing it. Starting to use a new language is very labour-intensive at first, not least because you have to learn all the new idioms and quirks and The Right Way to do things. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3591, "user_id": 4107956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LjlBF.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4107956/will"}, "edited": false, "score": 2, "creation_date": 1494430249, "post_id": 43896821, "comment_id": 74827794, "body": "It&#39;s looking for <code>main.main</code>.  You have <code>main.Main</code>."}, {"owner": {"reputation": 43, "user_id": 6821449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f38d300ff92213c148f168b8dd4357b?s=128&d=identicon&r=PG&f=1", "display_name": "R.J.", "link": "https://stackoverflow.com/users/6821449/r-j"}, "reply_to_user": {"reputation": 3591, "user_id": 4107956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LjlBF.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4107956/will"}, "edited": false, "score": 0, "creation_date": 1494499643, "post_id": 43896821, "comment_id": 74859609, "body": "ohh...man.... sorry to have wasted your time"}, {"owner": {"reputation": 3591, "user_id": 4107956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LjlBF.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4107956/will"}, "edited": false, "score": 0, "creation_date": 1494506685, "post_id": 43896821, "comment_id": 74864679, "body": "No problem, this is what SO is for :)"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 4107956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LjlBF.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4107956/will"}, "is_accepted": true, "score": 2, "last_activity_date": 1494513137, "last_edit_date": 1494513137, "creation_date": 1494430494, "answer_id": 43897011, "question_id": 43896821, "link": "https://stackoverflow.com/questions/43896821/golang-function-return-argument-error/43897011#43897011", "title": "Golang: function return argument error", "body": "<p>You error messages are telling you it's looking for a function called <code>main</code> in your <code>main</code> package.  You called your entry point <code>Main</code> (Note the caps).  Try this:</p>\n\n<pre><code>func main() {\n    a := Bindldap(Ldap1, Lport1, Prpl1, Pass1)\n    //do something with a\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6821449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f38d300ff92213c148f168b8dd4357b?s=128&d=identicon&r=PG&f=1", "display_name": "R.J.", "link": "https://stackoverflow.com/users/6821449/r-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 43897011, "answer_count": 1, "score": -1, "last_activity_date": 1494513137, "creation_date": 1494430005, "last_edit_date": 1494430579, "question_id": 43896821, "link": "https://stackoverflow.com/questions/43896821/golang-function-return-argument-error", "title": "Golang: function return argument error", "body": "<p>The following code gives:</p>\n\n<pre><code>runtime.main: call to external function main.main\nruntime.main: main.main: not defined\nruntime.main: undefined: main.main\n</code></pre>\n\n<p>I messed up with the return argument, but why?</p>\n\n<p>Requesting:</p>\n\n<pre><code>fmt.Println( reflect.TypeOf(l)) \n</code></pre>\n\n<p>gives *ldap.Conn as type</p>\n\n<p>The code works without trying to return the object</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"gopkg.in/ldap.v2\"\n)\n\n\nvar Ldap1 = \"10.0.0.1\"\nvar Lport1 = 389\nvar Prpl1 = \"cn=admin,dc=Example,dc=com\"\nvar Pass1 = \"password\"\n\nfunc Bindldap(ldaphost string, port int, principal string, password string) *ldap.Conn {\n\n    l, err := ldap.Dial(\"tcp\", fmt.Sprintf(\"%s:%d\", ldaphost, port))\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer l.Close()\n\n    err = l.Bind(principal, password)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return l\n}\n\nfunc Main() {\n    a := Bindldap(Ldap1, Lport1, Prpl1, Pass1)\n    //do something with a\n}\n</code></pre>\n"}, {"tags": ["json", "go", "struct", "unmarshalling"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1494429710, "post_id": 43896583, "comment_id": 74827398, "body": "<code>music_type := values.Type[0].Music.Type</code> didn&#39;t work?"}, {"owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1494486700, "post_id": 43896583, "comment_id": 74850781, "body": "Perfectly! Thank you @Flimzy."}], "owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494429394, "creation_date": 1494429394, "last_edit_date": 1495540957, "question_id": 43896583, "link": "https://stackoverflow.com/questions/43896583/get-value-of-key-in-json-struct-unmarshalled", "title": "Get value of key in json struct unmarshalled", "body": "<p>First of all, I have read a lot of questions, I only find two similar questions but I can't add a comment (reputation):</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36350730/unmarshmaling-json-to-nested-struct\">Unmarshmaling json to nested struct</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/24409665/casting-interface-to-struct-in-json-encoding\">Casting interface{} to struct in json encoding</a></p>\n\n<p>I attach you my go code:\n<a href=\"https://play.golang.org/p/YFP0Y4QJAv\" rel=\"nofollow noreferrer\">I want to extract each value</a></p>\n\n<p>I don't know how I can get each value and to store it in a different variable like this:</p>\n\n<pre><code>music_type := ...\nfmt.Println(music_type) // Rock\n</code></pre>\n\n<p>Can somebody help me please ?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["pointers", "go", "interface", "null"], "comments": [{"owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "edited": false, "score": 0, "creation_date": 1494428065, "post_id": 43895862, "comment_id": 74826097, "body": "Please note this question is about why &quot;IsNil()&quot; isn&#39;t provided in Go as a method.  The &quot;duplicated&quot; question doesn&#39;t go this way."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1494428065, "post_id": 43895862, "comment_id": 74826098, "body": "You can use <code>== nil</code> on all interface values to test if they are equal. The confusion in your case comes from that inside <code>process()</code> you check if the <i>interface</i> value is <code>nil</code>, while in your <code>main()</code> function you check the <b>non-interface, pointer</b> value. The interface value is automatically, implicitly created when the pointer is passed to the function."}], "answers": [{"comments": [{"owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "edited": false, "score": 0, "creation_date": 1494428812, "post_id": 43896204, "comment_id": 74826705, "body": "Hi icza, thanks for your answer.  I didn&#39;t realize the method is inside reflect package."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1494428898, "last_edit_date": 1495540025, "creation_date": 1494428415, "answer_id": 43896204, "question_id": 43895862, "link": "https://stackoverflow.com/questions/43895862/why-interface-type-doesnt-provide-an-isnil-method/43896204#43896204", "title": "Why interface type doesn&#39;t provide an &quot;IsNil&quot; method?", "body": "<p>First read this related question: <a href=\"https://stackoverflow.com/questions/29138591/hiding-nil-values-understanding-why-golang-fails-here/29138676#29138676\">Hiding nil values, understanding why golang fails here</a></p>\n\n<p>You can check if the interface value itself is <code>nil</code> by comparing it to <code>nil</code>.</p>\n\n<p>If you want to check if the value wrapped inside a non-<code>nil</code> interface is <code>nil</code>, you can use reflection: <a href=\"https://golang.org/pkg/reflect/#Value.IsNil\" rel=\"nofollow noreferrer\"><code>reflect.Value.IsNil()</code></a>.</p>\n\n<p>See this modified example:</p>\n\n<pre><code>func process(body io.Reader) {\n    fmt.Printf(\"process(): body == nil ? %t\\n\", body == nil)\n    if body != nil {\n        fmt.Println(\"\\tINSIDE IsNil():\", reflect.ValueOf(body).IsNil())\n    }\n}\n\nfunc main() {\n    var body *bytes.Buffer\n    fmt.Printf(\"main(): body == nil ? %t\\n\", body == nil)\n    process(body)\n    process(nil)\n    process(&amp;bytes.Buffer{})\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/PX8IDo-gXS\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>main(): body == nil ? true\nprocess(): body == nil ? false\n    INSIDE IsNil(): true\nprocess(): body == nil ? true\nprocess(): body == nil ? false\n    INSIDE IsNil(): false\n</code></pre>\n\n<p>If you want a \"unified\" <code>IsNil()</code> function which tells if either is <code>nil</code>:</p>\n\n<pre><code>func IsNil(i interface{}) bool {\n    return i == nil || reflect.ValueOf(i).IsNil()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1591093586, "creation_date": 1591093586, "answer_id": 62149893, "question_id": 43895862, "link": "https://stackoverflow.com/questions/43895862/why-interface-type-doesnt-provide-an-isnil-method/62149893#62149893", "title": "Why interface type doesn&#39;t provide an &quot;IsNil&quot; method?", "body": "<p>Here's a function that reports if an interface contains any <code>nil</code>. Note that <code>reflect.Value.IsNil()</code> panics if the type doesn't have a nil value, so some checking on the kind must be done before calling it.</p>\n\n<pre><code>func isNil(x interface{}) bool {\n    v := reflect.ValueOf(x)\n    switch v.Kind() {\n    case reflect.Chan, reflect.Func, reflect.Map, reflect.Ptr, reflect.UnsafePointer, reflect.Slice:\n        return v.IsNil()\n    default:\n        return false\n    }\n}\n</code></pre>\n\n<p>Here's a working example in the playground: <a href=\"https://play.golang.org/p/RHzu3VVj4Zd\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RHzu3VVj4Zd</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13304520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df89a3b61976f8afb7ca3d9ad47ffb83?s=128&d=identicon&r=PG&f=1", "display_name": "al_shopov", "link": "https://stackoverflow.com/users/13304520/al-shopov"}, "is_accepted": false, "score": -1, "last_activity_date": 1591784125, "creation_date": 1591784125, "answer_id": 62301085, "question_id": 43895862, "link": "https://stackoverflow.com/questions/43895862/why-interface-type-doesnt-provide-an-isnil-method/62301085#62301085", "title": "Why interface type doesn&#39;t provide an &quot;IsNil&quot; method?", "body": "<p>The following is clearly based on Paul Hankin's answer, a tad of what icza wrote and the sources of reflect/value.go where <code>func (v Value) IsNil() bool</code> is defined. Do not trust the source, I am a newbie taking advantage of Cunningham's law! I would have just commented but I do not even have 50 points (-:</p>\n\n<pre><code>func isNil(x interface{}) bool {\n    if x == nil {                                 // nil with no type.\n        return true\n    }\n    v := reflect.ValueOf(x)\n    switch v.Kind() {                             // reflect.Invalid for nil\n    case reflect.Chan, reflect.Func, reflect.Map, // 1st case of v.isNil\n        reflect.Ptr, reflect.UnsafePointer,       \n        reflect.Interface, reflect.Slice:         // 2nd case of v.isNil\n        return v.IsNil()\n    default:\n        return false\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 43896204, "answer_count": 3, "score": 0, "last_activity_date": 1591784125, "creation_date": 1494427591, "last_edit_date": 1494429008, "question_id": 43895862, "link": "https://stackoverflow.com/questions/43895862/why-interface-type-doesnt-provide-an-isnil-method", "title": "Why interface type doesn&#39;t provide an &quot;IsNil&quot; method?", "body": "<p>First let's consider the following:</p>\n\n<pre><code>func process(body io.Reader) {\n    fmt.Printf(\"body == nil ? %+v\\n\", body == nil)\n}\n\nfunc main() {\n    var body *bytes.Buffer\n    fmt.Printf(\"body == nil ? %+v\\n\", body == nil)\n    process(body)\n    process(nil)\n}\n</code></pre>\n\n<p>And here's the output:</p>\n\n<pre><code>body == nil ? true\nbody == nil ? false  // Did you get this right?\nbody == nil ? true\n</code></pre>\n\n<p>Another example:</p>\n\n<pre><code>type Container struct {\n    Reader io.Reader\n}\n\nfunc processContainer(container Container) {\n    fmt.Printf(\"container.Reader == nil ? %+v\\n\", container.Reader == nil)\n}\n\nfunc main() {\n    var body *bytes.Buffer\n    processContainer(Container{Reader: body})\n    processContainer(Container{Reader: nil})\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>container.Reader == nil ? false // Did you get this right?\ncontainer.Reader == nil ? true\n</code></pre>\n\n<p>The explanation for this is at <a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#nil_error</a>.</p>\n\n<p>A naive solution is to make the <code>== nil</code> test just return true if the interface object contains <code>nil</code> value.  But this would violate transitivity of <code>==</code>, as it would assert two objects with nil value but different interface types true under <code>==</code>.</p>\n\n<p><strong>However, I wonder if there should be an <code>IsNil()</code> method on all interface types, which would solve this issue?</strong></p>\n\n<p>Another example, this line from Go http client, can catch you unexpectedly:</p>\n\n<p><a href=\"https://github.com/golang/go/blob/master/src/net/http/client.go#L545\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/net/http/client.go#L545</a></p>\n\n<p>So if you call it like this</p>\n\n<pre><code>var body *bytes.Buffer\nhttp.NewRequest(method, path, body)\n</code></pre>\n\n<p>You'll get a nil pointer exception, even though, by the look of the source code, this shouldn't happen.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Sorry I referenced the wrong line of the Go http source, now corrected.\nBut the example still holds.</p>\n\n<p><strong>Edit 2</strong></p>\n\n<p>I've highlighted my question to make it clear what I'm asking.</p>\n"}, {"tags": ["eclipse", "go", "path", "goclipse", "gopath"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1494423779, "post_id": 43894101, "comment_id": 74822600, "body": "What is your question exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 6531633, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EX1M89PWSaw/AAAAAAAAAAI/AAAAAAAAB1c/FuIb5U1EVc8/photo.jpg?sz=128", "display_name": "Renju Ashokan", "link": "https://stackoverflow.com/users/6531633/renju-ashokan"}, "is_accepted": false, "score": 0, "last_activity_date": 1552381095, "creation_date": 1552381095, "answer_id": 55117496, "question_id": 43894101, "link": "https://stackoverflow.com/questions/43894101/goclipse-error-resource-doesnt-have-a-corresponding-go-package/55117496#55117496", "title": "goclipse error &quot;resource doesn&#39;t have a corresponding go package&quot;", "body": "<p>You should write the code inside folder which present inside src folder, ie the src folder shouldn't contain any *.go files it can contain folder which contains go files.</p>\n\n<p>Here is an example, </p>\n\n<pre><code>&gt; New_Project/\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 test.exe\n\u251c\u2500\u2500 pkg\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 windows_amd64\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 strlocal\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 file1.go\n    \u2514\u2500\u2500 test\n        \u2514\u2500\u2500 main.go\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5410361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a6de90eb68304dd5386519d33aa282f?s=128&d=identicon&r=PG&f=1", "display_name": "mx88", "link": "https://stackoverflow.com/users/5410361/mx88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1660, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552381095, "creation_date": 1494423367, "last_edit_date": 1495540961, "question_id": 43894101, "link": "https://stackoverflow.com/questions/43894101/goclipse-error-resource-doesnt-have-a-corresponding-go-package", "title": "goclipse error &quot;resource doesn&#39;t have a corresponding go package&quot;", "body": "<p>I check in questions database and find this: <a href=\"https://stackoverflow.com/questions/34775953/golang-on-eclipse-resource-doesnt-have-a-corresponding-go-package-on-mac\">link</a> but problem doesn't solve.</p>\n\n<p>My pc have windows 10 and eclipse Neon.3 Release (4.6.3), goclipse is installed, my set for Go are:</p>\n\n<ul>\n<li>Go installation: <code>C:\\Go</code></li>\n<li>Eclipse GOPATH: <code>C:\\Go\\workspace</code></li>\n</ul>\n\n<p>tools path are:</p>\n\n<ul>\n<li>gocode: <code>C:\\Go\\bin\\bin\\gocode.exe</code></li>\n<li>guru: <code>C:\\Go\\bin\\bin\\guru.exe</code></li>\n<li>godef: <code>C:\\Go\\bin\\bin\\godef.exe</code></li>\n</ul>\n\n<p>but I think tools work.</p>\n\n<p>I search for this by 3 days. thank for your help.</p>\n"}, {"tags": ["go", "time", "casting", "flags"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1494418747, "post_id": 43892039, "comment_id": 74818468, "body": "This is not an answer to the question, but consider using <a href=\"https://godoc.org/flag#Duration\" rel=\"nofollow noreferrer\"><code>flag.Duration</code></a> instead of <code>flag.Int64</code>."}, {"owner": {"reputation": 1362, "user_id": 18703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/45b0ee94acfbcc06f333f2daf03d4c91?s=128&d=identicon&r=PG", "display_name": "Hace", "link": "https://stackoverflow.com/users/18703/hace"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1494419216, "post_id": 43892039, "comment_id": 74818815, "body": "Hi @CeriseLim&#243;n Yes, thanks for the suggestion: those are the things I&#39;m looking for as a Golang newby :) That saves referring to time.Duration indeed!"}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 2, "last_activity_date": 1494418908, "creation_date": 1494418908, "answer_id": 43892390, "question_id": 43892039, "link": "https://stackoverflow.com/questions/43892039/golang-how-to-convert-int-to-calculate-into-time-duration/43892390#43892390", "title": "Golang: How to convert int to calculate into time.duration", "body": "<p><code>grpc.WithTimeout(100*time.Second)</code> and <code>grpc.WithTimeout(*connTimeout*time.Second)</code> does not because of <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability rules</a>:</p>\n\n<p>the latter expression satisfies none of those, and the former satisfies the</p>\n\n<ul>\n<li><code>x</code> is an untyped constant representable by a value of type <code>T</code>.</li>\n</ul>\n\n<p>rule</p>\n"}], "owner": {"reputation": 1362, "user_id": 18703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/45b0ee94acfbcc06f333f2daf03d4c91?s=128&d=identicon&r=PG", "display_name": "Hace", "link": "https://stackoverflow.com/users/18703/hace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5504, "favorite_count": 0, "accepted_answer_id": 43892390, "answer_count": 1, "score": 0, "last_activity_date": 1494418908, "creation_date": 1494418000, "question_id": 43892039, "link": "https://stackoverflow.com/questions/43892039/golang-how-to-convert-int-to-calculate-into-time-duration", "title": "Golang: How to convert int to calculate into time.duration", "body": "<p>I'm new to GoLang and at the moment at a loss why the compiler does not accept a particular line of code.</p>\n\n<p>I've got this working example for creating a timeout when dialing:</p>\n\n<pre><code>    conn, err := grpc.Dial(*connAddress,\n      grpc.WithInsecure(),\n      grpc.WithBlock(),                  // will block till the connection is available\n      grpc.WithTimeout(100*time.Second)) // times out after 100 seconds\n</code></pre>\n\n<p>Now the hardcoded 100 there is not nice, so I would like to make that a commandline variable via a flag, like so:</p>\n\n<pre><code>    connTimeout := flag.Int64(\"connection-timeout\", 100, \"give the timeout for dialing connection x\")\n...\n    conn, err := grpc.Dial(*connAddress,\n      grpc.WithInsecure(),\n      grpc.WithBlock(),\n      grpc.WithTimeout(*connTimeout*time.Second)) \n</code></pre>\n\n<p>However this gives the following compilation error:</p>\n\n<blockquote>\n  <p>mismatched types int64 and time.Duration</p>\n</blockquote>\n\n<p>So apparently I can't use the int64 flag variable directly to calculate a duration but a number can?</p>\n\n<p>Eventually I found a solution for using the flag variable by creating a variable related to time.Duration first:</p>\n\n<pre><code>var timeoutduration = time.Duration(*distributorTimeout) * time.Second\n    // create distributor connection\n    conn, err := grpc.Dial(*connAddress,\n        grpc.WithBlock(),\n        grpc.WithTimeout(timeoutduration)) \n</code></pre>\n\n<p>The above seems to work as expected: the dialing is tried for as long as the commandline parameter given (default 100) and than throws a message that the connection could not be made. Good.</p>\n\n<p>However: How come directly using the int64 flag-variable is not possible for calculating a time.Duration, in other words what is the difference for golang between the number 100 and the variable that contains the int64?</p>\n"}, {"tags": ["go", "concurrency", "sleep", "scheduler", "channel"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1494417532, "last_edit_date": 1592644375, "creation_date": 1494417532, "answer_id": 43891863, "question_id": 43891350, "link": "https://stackoverflow.com/questions/43891350/how-to-use-time-after-instead-of-time-sleep-to-obtain-interruptible-pause/43891863#43891863", "title": "How to use time.After() instead of time.Sleep() to obtain interruptible pause", "body": "<blockquote>\n<p>&quot;23:00:15 Fetching&quot; is something I didn't expect.</p>\n</blockquote>\n<p>This is not surprising, this is the intended working. Quoting from <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">Spec: Select statements</a>:</p>\n<blockquote>\n<p>Execution of a &quot;select&quot; statement proceeds in several steps:</p>\n<ol>\n<li>For all the cases in the statement, the channel operands of receive operations and the channel and right-hand-side expressions of send statements are evaluated exactly once, in source order, upon entering the &quot;select&quot; statement.</li>\n</ol>\n<p>[...]</p>\n</blockquote>\n<p>So the <code>select</code> statement evaluates the communication operations before it decides on which branch to proceed / execute.</p>\n<p>This means that</p>\n<pre><code>case data &lt;- fetch():\n</code></pre>\n<p><code>fetch()</code> will be called, even if sending on <code>data</code> would not be possible and even if receiving from <code>quit</code> can proceed immediately.</p>\n<p>Since you have the sleep in one of the <code>case</code> branches, it doesn't matter that <code>quit</code> becomes ready to receive from, checking that (and optionally deciding to go on that branch) has to wait until <code>time.Sleep()</code> \u2013and the whole <code>case</code> branch\u2013 completes.</p>\n<p>So the communication operation should be a receive operation from the channel returned by <a href=\"https://golang.org/pkg/time/#After\" rel=\"nofollow noreferrer\"><code>time.After()</code></a>, and only call <code>fetch()</code> in the body of this case branch.</p>\n<p>You can make it work like this:</p>\n<pre><code>for {\n    // Wait until e.g. exactly 0,10,20,30,40 or 50 mins past the hour\n    interval := time.Second * 5\n    now := time.Now()\n    delay := now.Truncate(interval).Add(interval).Sub(now)\n\n    select {\n    case &lt;-quit:\n        log.Println(&quot;Quitting&quot;)\n        close(data)\n        return\n    case &lt;-time.After(delay):\n        data &lt;- fetch()\n    }\n}\n</code></pre>\n<p>And now the output (try it on the <a href=\"https://play.golang.org/p/Mnb_Sb54zi\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>2009/11/10 23:00:00 Hello, playground\n2009/11/10 23:00:05 Fetching\n2009/11/10 23:00:05 Fetched message\n2009/11/10 23:00:10 Fetching\n2009/11/10 23:00:10 Fetched message\n2009/11/10 23:00:12 Quitting\n2009/11/10 23:00:12 Goodbye, playground\n</code></pre>\n"}], "owner": {"reputation": 3488, "user_id": 477035, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cYpss.jpg?s=128&g=1", "display_name": "RedGrittyBrick", "link": "https://stackoverflow.com/users/477035/redgrittybrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 43891863, "answer_count": 1, "score": 1, "last_activity_date": 1494420367, "creation_date": 1494416162, "last_edit_date": 1495542396, "question_id": 43891350, "link": "https://stackoverflow.com/questions/43891350/how-to-use-time-after-instead-of-time-sleep-to-obtain-interruptible-pause", "title": "How to use time.After() instead of time.Sleep() to obtain interruptible pause", "body": "<p>I have a program which periodically checks an external mailbox for messages and which has a user view which allows them to view messages and to terminate the program.</p>\n\n<p>Stripped to minimal features it looks like this</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    log.Println(\"Hello, playground\")\n\n    quit := make(chan bool)\n    data := make(chan string)\n\n    go func() {\n        for {\n            select {\n            case &lt;-quit:\n                log.Println(\"Quitting\")\n                close(data)\n                return\n            case data &lt;- fetch():\n                // Wait until e.g. exactly 0,10,20,30,40 or 50 mins past the hour\n                interval := time.Second * 5\n                now := time.Now()\n                time.Sleep(now.Truncate(interval).Add(interval).Sub(now))\n            }\n        }\n    }()\n\n    go func() {\n        time.Sleep(12 * time.Second) // actually user presses a \"quit\" button\n        quit &lt;- true\n    }()\n\nloop:\n    for {\n        select {\n        case info, ok := &lt;-data:\n            if !ok {\n                break loop\n            }\n            log.Println(\"Fetched\", info)\n        }\n    }\n\n    log.Println(\"Goodbye, playground\")\n}\n\nfunc fetch() string {\n    log.Println(\"Fetching\")\n    return \"message\"\n}\n</code></pre>\n\n<p>You can <a href=\"https://play.golang.org/p/cCCX9s3I6O\" rel=\"nofollow noreferrer\">run this in the Go Playground</a></p>\n\n<p>Output is </p>\n\n<pre><code>2009/11/10 23:00:00 Hello, playground\n2009/11/10 23:00:00 Fetching\n2009/11/10 23:00:00 Fetched message\n2009/11/10 23:00:05 Fetching\n2009/11/10 23:00:05 Fetched message\n2009/11/10 23:00:10 Fetching\n2009/11/10 23:00:10 Fetched message\n2009/11/10 23:00:15 Fetching\n2009/11/10 23:00:15 Quitting\n2009/11/10 23:00:15 Goodbye, playground\n</code></pre>\n\n<p>Notice that</p>\n\n<ul>\n<li><code>\"23:00:15 Fetching\"</code> is something I didn't expect.</li>\n<li>The program quits at 23:00:15, not at 23:00:12 because it's sleeping.</li>\n</ul>\n\n<p>The latter would be a problem in my program because it uses a 10 minute sleep between checking for messages. Delaying a quit for that long would make the program seem pretty unresponsive.</p>\n\n<p>From <a href=\"https://stackoverflow.com/a/23331563/477035\">this answer</a> I have learned that you can use <code>time.After()</code> to create a loop delay that can be interrupted.</p>\n\n<p>How should I best apply that to my program?</p>\n"}, {"tags": ["pointers", "go", "methods", "slice"], "answers": [{"comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1494415707, "post_id": 43890898, "comment_id": 74816177, "body": "As it stands I think <code>GetName</code> is a bit misleading. It is returning a pointer to <code>string</code> in a copy of a <code>Person</code>. I assume the method should either have a pointer receiver or return by-value, no?"}], "tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": false, "score": 3, "last_activity_date": 1494414981, "creation_date": 1494414981, "answer_id": 43890898, "question_id": 43890706, "link": "https://stackoverflow.com/questions/43890706/my-object-is-not-updated-even-if-i-use-the-pointer-to-a-type-to-update-it/43890898#43890898", "title": "My object is not updated even if I use the pointer to a type to update it", "body": "<p>Two things to fix this:</p>\n\n<ul>\n<li>You need the methods attach via a \"pointer\" method, otherwise the name is only changed inside the method.</li>\n<li>You need to use pointers for the actual <code>Person</code> variables, since they need to implement an interface</li>\n</ul>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Individual interface {\n    GetName() *string\n    SetName(name string)\n}\n\ntype Person struct {\n    name string\n}\n\n// Implement functions of the Individual interface\nfunc (p Person) GetName() *string  {\n    return &amp;p.name\n}\n\nfunc (p *Person) SetName(newName string)  {\n    p.name = newName\n}\n\n\nvar individuals []Individual\n\nfunc main() {\n    person := &amp;Person{name: \"Steve\"}\n    fmt.Println(person)\n\n    individuals = append(individuals, person) // append Person to slice\n    p1 := individuals[0]     // Retrieve the only Person from slice\n    p1.SetName(\"Peter\")      // Change name\n    fmt.Println(p1)          // Prints \"Steve\"\n    fmt.Println(person)      // Prints \"Steve\"\n}\n</code></pre>\n\n<p>Example on <a href=\"https://play.golang.org/p/L7E74qLxWw\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 1, "creation_date": 1494415569, "post_id": 43890923, "comment_id": 74816072, "body": "I assume it would be more idiomatic for <code>GetName</code> to return the <code>string</code> by-value?"}, {"owner": {"reputation": 2357, "user_id": 1008572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2546a87d9eb9ce02de5bf6a62ec7893c?s=128&d=identicon&r=PG", "display_name": "Rox", "link": "https://stackoverflow.com/users/1008572/rox"}, "edited": false, "score": 0, "creation_date": 1494416195, "post_id": 43890923, "comment_id": 74816514, "body": "Thank you for a good response! If I call <code>p1 := individuals[0]</code> several times and then print the address with <code>fmt.Println(&amp;p1)</code> after each call I get different addresses each time. <code>p2 := individuals[0]</code> and then <code>fmt.Println(&amp;p2)</code> will print another address. Why?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1494416197, "post_id": 43890923, "comment_id": 74816516, "body": "@ChrisDrew Yes, obviously. I just wanted to guide through from the code what the asker presented, because I think it is edifying / illuminating (that <i>copy of copy</i> part is not self-evident)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2357, "user_id": 1008572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2546a87d9eb9ce02de5bf6a62ec7893c?s=128&d=identicon&r=PG", "display_name": "Rox", "link": "https://stackoverflow.com/users/1008572/rox"}, "edited": false, "score": 0, "creation_date": 1494416318, "post_id": 43890923, "comment_id": 74816602, "body": "@Rox <code>p1 := individuals[0]</code> is a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a>, which creates a local variable, and <code>&amp;p1</code> is the address of the <i>local variable</i> (and not the pointer value should it contain a pointer), which will (might) be different each time."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1494415043, "creation_date": 1494415043, "answer_id": 43890923, "question_id": 43890706, "link": "https://stackoverflow.com/questions/43890706/my-object-is-not-updated-even-if-i-use-the-pointer-to-a-type-to-update-it/43890923#43890923", "title": "My object is not updated even if I use the pointer to a type to update it", "body": "<p>Whenever a method wants to modify the receiver, <strong>it must be a pointer to the value</strong>; the method must have a pointer receiver.</p>\n\n<p>If a method has a non-pointer receiver, a copy will be made and passed when that method is called. From that point, no matter what you do with the receiver, you can only modify the copy, and not the original.</p>\n\n<p>So in your example:</p>\n\n<pre><code>func (p Person) SetName(newName string)  {\n    name := p.GetName();\n    *name = newName\n}\n</code></pre>\n\n<p>When <code>SetName()</code> is called, a copy is made of the <code>Person</code>. Inside <code>SetName()</code> you obtain the address of the <code>name</code> field of the <strong>copy</strong>, which you modify. <em>(Actually, a <strong>copy of the copy</strong>, more on this later...)</em></p>\n\n<p>Solution: use a pointer receiver:</p>\n\n<pre><code>func (p *Person) SetName(newName string)  {\n    name := p.GetName();\n    *name = newName\n}\n</code></pre>\n\n<p>From this point on, only <code>*Person</code> implements <code>Individual</code>, so use a pointer when appending:</p>\n\n<pre><code>individuals = append(individuals, &amp;person)\n</code></pre>\n\n<p>It's tricky, because after this it sill won't work. Why is that?</p>\n\n<p>It is because the <code>Person.GetName()</code> still has a non-pointer receiver:</p>\n\n<pre><code>func (p Person) GetName() *string {\n    return &amp;p.name\n}\n</code></pre>\n\n<p>So when <code>GetName()</code> is called from <code>SetName()</code>, a copy will be made again, and <code>GetName()</code> will return the address of the <code>name</code> field of the <strong>copy</strong>, and <code>SetName()</code> will only modify the copy created for calling <code>GetName()</code>.</p>\n\n<p>So to make all work, you also have to use pointer receiver for <code>GetName()</code>:</p>\n\n<pre><code>func (p *Person) GetName() *string {\n    return &amp;p.name\n}\n</code></pre>\n\n<p>And now it's working, output (try it on the <a href=\"https://play.golang.org/p/wOA74mA1Q5\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{Steve}\n&amp;{Peter}\n{Peter}\n</code></pre>\n\n<p>But know that the easiest and recommended way is simply:</p>\n\n<pre><code>func (p *Person) SetName(newName string) {\n    p.name = newName\n}\n</code></pre>\n\n<p>That's all it takes.</p>\n"}, {"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": false, "score": 0, "last_activity_date": 1494416800, "creation_date": 1494416800, "answer_id": 43891588, "question_id": 43890706, "link": "https://stackoverflow.com/questions/43890706/my-object-is-not-updated-even-if-i-use-the-pointer-to-a-type-to-update-it/43891588#43891588", "title": "My object is not updated even if I use the pointer to a type to update it", "body": "<p>See <a href=\"https://play.golang.org/p/eg8oYDV6Xx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eg8oYDV6Xx</a> p1 and p2 are already addresses, you don't need to their address (address of address), just print p1 and p2 - they'll be the same as you can see.</p>\n"}], "owner": {"reputation": 2357, "user_id": 1008572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2546a87d9eb9ce02de5bf6a62ec7893c?s=128&d=identicon&r=PG", "display_name": "Rox", "link": "https://stackoverflow.com/users/1008572/rox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 2, "accepted_answer_id": 43890923, "answer_count": 3, "score": 5, "last_activity_date": 1546114466, "creation_date": 1494414450, "last_edit_date": 1546114466, "question_id": 43890706, "link": "https://stackoverflow.com/questions/43890706/my-object-is-not-updated-even-if-i-use-the-pointer-to-a-type-to-update-it", "title": "My object is not updated even if I use the pointer to a type to update it", "body": "<p>I store some <code>Individual</code> objects in a slice. Before appending it to the slice I print the name of the <code>Individual</code> object.</p>\n\n<p>After I have stored it in the slice, I then retrieve it as a pointer and want to change the name to <code>\"Peter\"</code>, but the change does not work since it still prints <code>\"Steve\"</code>. Why? </p>\n\n<pre><code>type Individual interface {\n    GetName() *string\n    SetName(name string)\n}\n\ntype Person struct {\n    name string\n}\n\n// Implement functions of the Individual interface\nfunc (p Person) GetName() *string  {\n    return &amp;p.name\n}\n\nfunc (p Person) SetName(newName string)  {\n    name := p.GetName();\n    *name = newName\n}\n\n\nvar individuals []Individual\n\nfunc main() {\n    person := Person{name: \"Steve\"}\n    fmt.Println(person)\n\n    individuals = append(individuals, person) // append Person to slice\n    p1 := individuals[0]     // Retrieve the only Person from slice\n    p1.SetName(\"Peter\")      // Change name\n    fmt.Println(p1)          // Should print \"Peter\", but prints \"Steve\"\n    fmt.Println(person)      // Should print \"Peter\", but prints \"Steve\"\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1494419412, "creation_date": 1494419412, "answer_id": 43892572, "question_id": 43890657, "link": "https://stackoverflow.com/questions/43890657/execute-a-command-inside-a-particular-directory-using-os-exec-in-golng/43892572#43892572", "title": "Execute a command inside a particular directory using os/exec in golng", "body": "<p>The first argument to Command specifies the executable to run. To run a shell pipe expression, execute a shell:</p>\n\n<pre><code>command := exec.Command(\"/bin/sh\", \"-c\", \"echo *tar.gz | xargs -n1 tar zxf\") \ncommand.Dir = pathFinal \ncmdErr := command.Run()\n</code></pre>\n"}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 43892572, "answer_count": 1, "score": 0, "last_activity_date": 1494419412, "creation_date": 1494414307, "question_id": 43890657, "link": "https://stackoverflow.com/questions/43890657/execute-a-command-inside-a-particular-directory-using-os-exec-in-golng", "title": "Execute a command inside a particular directory using os/exec in golng", "body": "<p>I want to run a command inside a particular directory.So here are 2 ways to do it. </p>\n\n<pre><code>command := exec.Command(\"echo *tar.gz | xargs -n1 tar zxf\") \ncommand.Dir = pathFinal \ncmdErr := command.Run()\n</code></pre>\n\n<p>This is not working for me on the otherhand, </p>\n\n<pre><code>command := \"cd \"+pathFinal+\"; \"+\"echo *tar.gz | xargs -n1 tar zxf\" \ncmd := exec.Command(\"/bin/sh\", \"-c\", command) \ncmdErr := command.Run()\n</code></pre>\n\n<p>This is working. \nI want to implement it the first way. I don't know why it is not working\nSecond one throws an error </p>\n\n<p>Failed to untar file: exec: \"echo *tar.gz | xargs -n1 tar zxf\": executable file not found in $PATH\nAm I missing something?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1494411556, "post_id": 43889545, "comment_id": 74813132, "body": "Well, <code>.rec</code> tries to access an unexported fields, so that&#39;s to expect (and has nothing to do with the loop). Also: probably you got your data types wrong."}], "answers": [{"tags": [], "owner": {"reputation": 248, "user_id": 6073838, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1530379783927023/picture?type=large", "display_name": "\u0410\u043d\u0434\u0440\u0435\u0439 \u0410\u043d\u0442\u043e\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/6073838/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%90%d0%bd%d1%82%d0%be%d0%bd%d0%be%d0%b2"}, "is_accepted": false, "score": -1, "last_activity_date": 1494411674, "creation_date": 1494411674, "answer_id": 43889705, "question_id": 43889545, "link": "https://stackoverflow.com/questions/43889545/how-to-get-key-in-loop-slice-in-text-template/43889705#43889705", "title": "How to get key in loop slice in text/template?", "body": "<pre><code>{{ range $k, $v := .}}\n{{ $k }} :: {{ $v }}\n{{ end }}\n</code></pre>\n"}], "owner": {"reputation": 248, "user_id": 6073838, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1530379783927023/picture?type=large", "display_name": "\u0410\u043d\u0434\u0440\u0435\u0439 \u0410\u043d\u0442\u043e\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/6073838/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%90%d0%bd%d1%82%d0%be%d0%bd%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494411674, "creation_date": 1494411277, "question_id": 43889545, "link": "https://stackoverflow.com/questions/43889545/how-to-get-key-in-loop-slice-in-text-template", "title": "How to get key in loop slice in text/template?", "body": "<p>For example</p>\n\n<pre><code>{{ range $k, $v := .rec}}\n{{ $k }} :: {{ $v }}\n{{ end }}\n</code></pre>\n\n<p>Catch error <code>panic: template: let:2:19: executing \"let\" at &lt;.rec&gt;: can't evaluate field rec in type []string</code>. </p>\n"}, {"tags": ["go", "error-handling", "string-formatting"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1494407160, "post_id": 43887776, "comment_id": 74810024, "body": "Use %s (but please look up what %v and %s do in the package description of fmt)."}, {"owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1494424458, "post_id": 43887776, "comment_id": 74823124, "body": "@Volker I know what <code>%v</code> and <code>%s</code> does. I would like to understand why you recommend <code>%s</code> for <code>error</code> objects. Can you share the rationale please?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1494426380, "post_id": 43887776, "comment_id": 74824652, "body": "Less indirection. What gets printed is the output of the <code>Error()</code> method and that&#39;s a string: Clearer."}], "answers": [{"comments": [{"owner": {"reputation": 1715, "user_id": 2014469, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/546864e623b84d3964638b521d54cd3d?s=128&d=identicon&r=PG", "display_name": "Nathan Lutterman", "link": "https://stackoverflow.com/users/2014469/nathan-lutterman"}, "edited": false, "score": 3, "creation_date": 1560801425, "post_id": 43898231, "comment_id": 99847067, "body": "The only thing that I&#39;d say is perhaps confusing about this is that the Golang team uses <code>%v</code> in their blogs: <a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"nofollow noreferrer\">blog.golang.org/error-handling-and-go</a>.  Otherwise I think it&#39;s probably okay to just use <code>%s</code> as well."}, {"owner": {"reputation": 1715, "user_id": 2014469, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/546864e623b84d3964638b521d54cd3d?s=128&d=identicon&r=PG", "display_name": "Nathan Lutterman", "link": "https://stackoverflow.com/users/2014469/nathan-lutterman"}, "edited": false, "score": 2, "creation_date": 1560802045, "post_id": 43898231, "comment_id": 99847338, "body": "Also more discussion in this issue here:  <a href=\"https://github.com/golang/go/issues/29934\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/29934</a>, which is somewhat relevant"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1529891"}, "is_accepted": true, "score": 16, "last_activity_date": 1494434168, "creation_date": 1494434168, "answer_id": 43898231, "question_id": 43887776, "link": "https://stackoverflow.com/questions/43887776/what-is-the-correct-format-specifier-to-print-error-object-in-go-s-or-v/43898231#43898231", "title": "What is the correct format specifier to print error object in Go: %s or %v?", "body": "<p><a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\">According to docs</a>:</p>\n\n<pre><code>%v  the value in a default format\n...\n%s  the uninterpreted bytes of the string or slice\n</code></pre>\n\n<p><a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"noreferrer\">Also, more information about <code>error</code></a>:</p>\n\n<blockquote>\n  <p>The error type is an interface type. An error variable represents <strong>any\n  value that can describe itself as a string.</strong></p>\n</blockquote>\n\n<p>So, treat it as <code>%s</code>.</p>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7385, "favorite_count": 2, "accepted_answer_id": 43898231, "answer_count": 1, "score": 11, "last_activity_date": 1494434168, "creation_date": 1494406497, "last_edit_date": 1494424539, "question_id": 43887776, "link": "https://stackoverflow.com/questions/43887776/what-is-the-correct-format-specifier-to-print-error-object-in-go-s-or-v", "title": "What is the correct format specifier to print error object in Go: %s or %v?", "body": "<p>Here is my program.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\nfunc main() {\n    a := -1\n    err := assertPositive(a)\n    fmt.Printf(\"error: %s; int: %d\\n\", err, a)\n    fmt.Printf(\"error: %v; int: %d\\n\", err, a)\n}\n\nfunc assertPositive(a int) error {\n    if a &lt;= 0 {\n        return errors.New(\"Assertion failure\")\n    }\n    return nil\n}\n</code></pre>\n\n<p>Here is the output.</p>\n\n<pre><code>error: Assertion failure; int: -1\nerror: Assertion failure; int: -1\n</code></pre>\n\n<p>In this program, it makes no difference whether I use <code>%s</code> or <code>%v</code> to print\nthe <code>error</code> object.</p>\n\n<p>I have two questions.</p>\n\n<ol>\n<li>Is there any scenario while printing errors where it would make a\ndifference for <code>%s</code> and <code>%v</code>?</li>\n<li>What is the correct format specifier to use in this case?</li>\n</ol>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 712, "user_id": 8868419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a530d27369c9d4f6ecf421fe83d2b4?s=128&d=identicon&r=PG&f=1", "display_name": "Madeo", "link": "https://stackoverflow.com/users/8868419/madeo"}, "edited": false, "score": 2, "creation_date": 1596252036, "post_id": 43889338, "comment_id": 111760051, "body": "that is quite cumbersome API, why the caller needs to know where a file is?"}], "tags": [], "owner": {"reputation": 118, "user_id": 667637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTLMX.jpg?s=128&g=1", "display_name": "Peter Goetz", "link": "https://stackoverflow.com/users/667637/peter-goetz"}, "is_accepted": true, "score": 2, "last_activity_date": 1494411443, "last_edit_date": 1494411443, "creation_date": 1494410759, "answer_id": 43889338, "question_id": 43887759, "link": "https://stackoverflow.com/questions/43887759/read-file-from-relative-path-with-different-callers/43889338#43889338", "title": "Read file from relative path with different callers", "body": "<p>Pass in the filepath as a parameter to the function (as indicated in your last question).</p>\n\n<p><strong>More details:</strong></p>\n\n<p>The relative path <code>\"wordlists/specialChars.txt\"</code> is in fact not dependent on where the source file is located (such as <code>Main.go</code> or <code>CleanupUtil_test.go</code>), but where you execute it from. So you could run your tests from your root directory and then it would actually work. In short, the current working directory is relevant.</p>\n\n<p>Still, I'd recommend specifying the path, because that makes your function more reusable and universal.</p>\n\n<p>Maybe you don't even need to put this information into a file, but can simply have a string containing those chars. In this case you could also check if <a href=\"https://golang.org/pkg/regexp/#Regexp.ReplaceAll\" rel=\"nofollow noreferrer\">https://golang.org/pkg/regexp/#Regexp.ReplaceAll</a> already covers your use case.</p>\n"}], "owner": {"reputation": 1009, "user_id": 2837489, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9332e46ce84393e32ab32f7612f0354?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel Bochtler", "link": "https://stackoverflow.com/users/2837489/marcel-bochtler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2459, "favorite_count": 0, "accepted_answer_id": 43889338, "answer_count": 1, "score": 2, "last_activity_date": 1494411443, "creation_date": 1494406456, "last_edit_date": 1495535472, "question_id": 43887759, "link": "https://stackoverflow.com/questions/43887759/read-file-from-relative-path-with-different-callers", "title": "Read file from relative path with different callers", "body": "<p>I'm trying to read from a file in my project's directory.</p>\n\n<p>My problem is, that depending on the caller, the path changes. The caller changes, because I want to unit test this code and the caller is not <code>Main.go</code> anymore.</p>\n\n<p>This is what my project structure looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uO9Kx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uO9Kx.png\" alt=\"Project Structure\"></a></p>\n\n<p>The code where I try to access <code>specialChars.txt</code> from looks like this:</p>\n\n<pre><code>func RemoveSpecialChars(word string) string {\n    file, err := ioutil.ReadFile(\"wordlists/specialChars.txt\")\n    [...]\n}\n</code></pre>\n\n<p>This code works for the start from <code>Main.go</code> but not for the start from <code>CleanupUtil_test.go</code>. To get it working from the test I would need <code>file, err := ioutil.ReadFile(\"../wordlists/specialChars.txt\")</code></p>\n\n<p>I found answers like this one: <a href=\"https://stackoverflow.com/a/32163888/2837489\">https://stackoverflow.com/a/32163888/2837489</a>\n<code>_, filename, _, ok := runtime.Caller(0)</code> which is obviously also dependent on the caller.</p>\n\n<p>Is it possible to get the projects root path independent of the calling function?\nOr is my code design wrong? Should I pass the file path into the function?</p>\n"}, {"tags": ["go", "google-api", "oauth-2.0", "google-api-client"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494406361, "post_id": 43886361, "comment_id": 74809480, "body": "Your snippet is still unclear, for example how <code>self.listAllFiles</code> and <code>self.newPathfinder()</code> is implemented?"}, {"owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494406726, "post_id": 43886361, "comment_id": 74809718, "body": "@putu, can you see updated"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494407689, "post_id": 43886361, "comment_id": 74810394, "body": "You can filter the file by <a href=\"https://godoc.org/google.golang.org/api/drive/v3#File\" rel=\"nofollow noreferrer\"><code>drive.File</code></a>. There is <code>Trashed</code> and <code>ExplicitlyTrashed</code> field in the struct. Set it in the query which will be passed to <code>Q(...)</code>. For more detail on the query, see <a href=\"https://developers.google.com/drive/v3/web/search-parameters\" rel=\"nofollow noreferrer\">Search for Files</a>"}, {"owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494407879, "post_id": 43886361, "comment_id": 74810554, "body": "where i need to specify drive.file"}, {"owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494407995, "post_id": 43886361, "comment_id": 74810632, "body": "can you update the same in answer section"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494409039, "post_id": 43886361, "comment_id": 74811392, "body": "For <code>trashed</code> you need to specify inside the <code>Fields(...)</code>."}, {"owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494409763, "post_id": 43886361, "comment_id": 74811886, "body": "thank you, please specify the same in answer"}, {"owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494410474, "post_id": 43886361, "comment_id": 74812368, "body": "fileds in this example is basically a string"}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 1, "last_activity_date": 1494460643, "creation_date": 1494460643, "answer_id": 43904394, "question_id": 43886361, "link": "https://stackoverflow.com/questions/43886361/golangexclude-trash-files-from-google-drive/43904394#43904394", "title": "GOLANG:exclude trash files from google drive", "body": "<p>To filter files that you want to retrieve from google drive, you need to specify  search parameters as described in <a href=\"https://developers.google.com/drive/v3/web/search-parameters\" rel=\"nofollow noreferrer\">\"Search for Files\"</a>. Pass it as the argument of <code>Q(...)</code>, for example</p>\n\n<blockquote>\n  <p>Suppose you want to search for <code>pdf</code> file with a name containing <code>myfile</code> and <code>not in trashed</code>. </p>\n</blockquote>\n\n<p>then the code will look like</p>\n\n<pre><code>err := self.service.Files.List().\n   Q(\"mimeType='application/pdf' and name contains 'myfile' and trashed=false\")\n</code></pre>\n"}], "owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 43904394, "answer_count": 1, "score": 2, "last_activity_date": 1494460643, "creation_date": 1494402215, "last_edit_date": 1494410438, "question_id": 43886361, "link": "https://stackoverflow.com/questions/43886361/golangexclude-trash-files-from-google-drive", "title": "GOLANG:exclude trash files from google drive", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>type listAllFilesArgs struct {\r\n\tquery     string\r\n\tfields    []googleapi.Field\r\n\tsortOrder string\r\n\tmaxFiles  int64\r\n}\r\ntype Field string</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>func (self *Drive) listAllFiles(args listAllFilesArgs) ([]*drive.File, error) {\r\n\tvar files []*drive.File\r\n\tvar pageSize int64\r\n\tif args.maxFiles &gt; 0 &amp;&amp; args.maxFiles &lt; 1000 {\r\n\t\tpageSize = args.maxFiles\r\n\t} else {\r\n\t\tpageSize = 1000\r\n\t}\r\n\tcontrolledStop := fmt.Errorf(\"Controlled stop\")\r\n\terr := self.service.Files.List().Q(args.query).Fields(args.fields...).OrderBy(args.sortOrder).PageSize(pageSize).Pages(context.TODO(), func(fl *drive.FileList) error {\r\n\t\tfiles = append(files, fl.Files...)\r\n\r\n\t\t// Stop when we have all the files we need\r\n\t\tif args.maxFiles &gt; 0 &amp;&amp; len(files) &gt;= int(args.maxFiles) {\r\n\t\t\treturn controlledStop\r\n\t\t}\r\n\r\n\t\treturn nil\r\n\t})\r\n\r\n\tif err != nil &amp;&amp; err != controlledStop {\r\n\t\treturn nil, err\r\n\t}\r\n\r\n\tif args.maxFiles &gt; 0 {\r\n\t\tn := min(len(files), int(args.maxFiles))\r\n\t\treturn files[:n], nil\r\n\t}\r\n\r\n\treturn files, nil\r\n}\r\n\r\nfunc (self *Drive) newPathfinder() *remotePathfinder {\r\n\treturn &amp;remotePathfinder{\r\n\t\tservice: self.service.Files,\r\n\t\tfiles:   make(map[string]*drive.File),\r\n\t}\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>i am using go for my googledrive api development following wre the details of version usage,\ngo version go1.8.1 windows/amd64\nand imported \n\"google.golang.org/api/drive/v3\"\n    \"google.golang.org/api/googleapi\"\nfor development</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>err = gDrive.List(listArgs)\r\n\tif err != nil {\r\n\t\tfmt.Errorf(\"Failed to list files: %s\", err)\r\n\t}\r\n\r\nfunc (self *Drive) List(args ListFilesArgs) (err error) {\r\n\tlistArgs := listAllFilesArgs{\r\n\t\tquery:     args.Query,\r\n\t\tfields:    []googleapi.Field{\"nextPageToken\", \"files(id,name,md5Checksum,mimeType,size,createdTime,parents)\"},\r\n\t\tsortOrder: args.SortOrder,\r\n\t\tmaxFiles:  args.MaxFiles,\r\n\t}\r\n\tfiles, err := self.listAllFiles(listArgs)\r\n\tif err != nil {\r\n\t\treturn fmt.Errorf(\"Failed to list files: %s /n\", err)\r\n\t}\r\n\r\n\tpathfinder := self.newPathfinder()\r\n\r\n\tif args.AbsPath {\r\n\t\t// Replace name with absolute path\r\n\t\tfor _, f := range files {\r\n\t\t\tf.Name, err = pathfinder.absPath(f)\r\n\t\t\tif err != nil {\r\n\t\t\t\treturn err\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tPrintFileList(PrintFileListArgs{\r\n\t\tOut:         args.Out,\r\n\t\tFiles:       files,\r\n\t\tNameWidth:   int(args.NameWidth),\r\n\t\tSkipHeader:  args.SkipHeader,\r\n\t\tSizeInBytes: args.SizeInBytes,\r\n\t})\r\n\r\n\treturn\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>google drive api for Golang listing files including trash.\nHow to exclude trash files,</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494401950, "post_id": 43885347, "comment_id": 74806777, "body": "What&#39;s the <code>GOPATH</code> value?"}, {"owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494402082, "post_id": 43885347, "comment_id": 74806862, "body": "@zerkms <code>GOPATH</code> is C:\\path\\to\\myproject"}], "answers": [{"tags": [], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "is_accepted": true, "score": 0, "last_activity_date": 1494406621, "creation_date": 1494406621, "answer_id": 43887824, "question_id": 43885347, "link": "https://stackoverflow.com/questions/43885347/go-glide-error-the-system-cannot-find-the-path-specified/43887824#43887824", "title": "Go Glide Error &quot;The system cannot find the path specified&quot;", "body": "<p>I found the <code>github.com/golang/protobuf</code> version <code>2402d76f3d41f928c7902a765dfc872356dd3aad</code> which <code>github.com/gin-gonic/gin</code> wants does not has <code>ptype</code>. I added below lines to <code>glide.yaml</code>.</p>\n\n<pre><code>- package: github.com/golang/protobuf\n  version: b50ceb1fa9818fa4d78b016c2d4ae025593a7ce3\n</code></pre>\n\n<p><code>b50ceb1fa9818fa4d78b016c2d4ae025593a7ce3</code> is the current newest commit.</p>\n\n<p>The error has gone. But I am not sure this is the straightforward way because I still have the warning below.</p>\n\n<pre><code>[WARN]  Conflict: github.com/golang/protobuf rev is currently b50ceb1fa9818fa4d78b016c2d4ae025593a7ce3, but github.com/gin-gonic/gin wants 2402d76f3d41f928c7902a765dfc872356dd3aad\n</code></pre>\n\n<p>If another way is desirable, please advise me.</p>\n"}], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 43887824, "answer_count": 1, "score": 0, "last_activity_date": 1494406621, "creation_date": 1494398933, "question_id": 43885347, "link": "https://stackoverflow.com/questions/43885347/go-glide-error-the-system-cannot-find-the-path-specified", "title": "Go Glide Error &quot;The system cannot find the path specified&quot;", "body": "<p>I am trying to manage my Go project with glide.</p>\n\n<p>I executed <code>glide update</code>, but got <code>The system cannot find the path specified</code> error as below.</p>\n\n<pre><code>C:\\path\\to\\myproject\\src&gt;glide update\n[INFO]  Downloading dependencies. Please wait...\n[INFO]  --&gt; Fetching google.golang.org/appengine.\n[INFO]  --&gt; Fetching cloud.google.com/go.\n[INFO]  --&gt; Fetching golang.org/x/net.\n[INFO]  --&gt; Fetching github.com/gin-gonic/gin.\n[INFO]  --&gt; Fetching google.golang.org/api.\n[INFO]  --&gt; Fetching golang.org/x/oauth2.\n[INFO]  --&gt; Detected semantic version. Setting version for github.com/gin-gonic/gin to v1.1.4.\n[INFO]  --&gt; Detected semantic version. Setting version for google.golang.org/appengine to v1.0.0.\n[INFO]  --&gt; Detected semantic version. Setting version for cloud.google.com/go to v0.7.0.\n[INFO]  Resolving imports\n[INFO]  Found Godeps.json file in C:\\Users\\myhome\\.glide\\cache\\src\\https-github.com-gin-gonic-gin\n[INFO]  --&gt; Parsing Godeps metadata...\n[INFO]  --&gt; Fetching github.com/manucorporat/sse.\n[INFO]  --&gt; Setting version for github.com/manucorporat/sse to ee05b128a739a0fb76c7ebd3ae4810c1de808d6d.\n[INFO]  --&gt; Fetching github.com/mattn/go-isatty.\n[INFO]  --&gt; Setting version for golang.org/x/net to f315505cf3349909cdf013ea56690da34e96a451.\n[INFO]  --&gt; Fetching github.com/golang/protobuf.\n[INFO]  --&gt; Setting version for github.com/golang/protobuf to 2402d76f3d41f928c7902a765dfc872356dd3aad.\n[INFO]  --&gt; Fetching github.com/googleapis/gax-go.\n[INFO]  --&gt; Fetching gopkg.in/go-playground/validator.v8.\n[INFO]  --&gt; Setting version for gopkg.in/go-playground/validator.v8 to c193cecd124b5cc722d7ee5538e945bdb3348435.\n[INFO]  --&gt; Fetching gopkg.in/yaml.v2.\n[INFO]  --&gt; Fetching golang.org/x/sys.\n[INFO]  --&gt; Fetching google.golang.org/grpc.\n[INFO]  --&gt; Fetching google.golang.org/genproto.\n[ERROR] Error scanning github.com\\golang\\protobuf\\ptypes\\any: open C:\\Users\\myhome\\.glide\\cache\\src\\https-github.com-golang-protobuf\\ptypes\\any: The system cannot find the path specified.\n[ERROR] Failed to retrieve a list of dependencies: Error resolving imports\n</code></pre>\n\n<p>Actually there is not <code>C:\\Users\\myhome\\.glide\\cache\\src\\https-github.com-golang-protobuf\\ptypes</code> directory, but I can not understand why this directory is missed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HKzX5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HKzX5.png\" alt=\"enter image description here\"></a></p>\n\n<p>My <code>glide.yaml</code> is as follows.</p>\n\n<pre><code>package: .\nimport:\n- package: cloud.google.com/go\n  version: ^0.7.0\n  subpackages:\n  - bigquery\n  - civil\n- package: github.com/gin-gonic/gin\n  version: ^1.1.4\n- package: golang.org/x/net\n  subpackages:\n  - context\n- package: golang.org/x/oauth2\n  subpackages:\n  - google\n- package: google.golang.org/api\n  subpackages:\n  - iterator\n- package: google.golang.org/appengine\n  version: ^1.0.0\n  subpackages:\n  - datastore\n  - log\n  - memcache\n  - remote_api\n</code></pre>\n\n<p>How can I fix?</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"tags": [], "owner": {"reputation": 795, "user_id": 1254794, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VoLcO.jpg?s=128&g=1", "display_name": "Amir Mohsen", "link": "https://stackoverflow.com/users/1254794/amir-mohsen"}, "is_accepted": true, "score": 3, "last_activity_date": 1494394564, "creation_date": 1494394564, "answer_id": 43884296, "question_id": 43884295, "link": "https://stackoverflow.com/questions/43884295/how-to-get-database-tables-list-in-go-language-show-tables/43884296#43884296", "title": "How To get database Tables list in go language (SHOW TABLES)", "body": "<p>I'm trying this code and work successfully. I create a list of string and use Select query to get list of database tables.</p>\n\n<pre><code>tables := []string{}\ndbmap.Select(&amp;tables, \"SHOW TABLES\")\nfmt.Println(tables)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13897, "user_id": 1713660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5aa62fae5a22b542d2a188b95384aee?s=128&d=identicon&r=PG", "display_name": "vladkras", "link": "https://stackoverflow.com/users/1713660/vladkras"}, "is_accepted": false, "score": 5, "last_activity_date": 1534181522, "creation_date": 1534181522, "answer_id": 51827707, "question_id": 43884295, "link": "https://stackoverflow.com/questions/43884295/how-to-get-database-tables-list-in-go-language-show-tables/51827707#51827707", "title": "How To get database Tables list in go language (SHOW TABLES)", "body": "<p>I use classic <a href=\"https://godoc.org/github.com/go-sql-driver/mysql\" rel=\"noreferrer\">go-sql-driver/mysql</a>:</p>\n\n<pre><code>db, _ := sql.Open(\"mysql\", \"root:qwerty@/dbname\")\n\nres, _ := db.Query(\"SHOW TABLES\")\n\nvar table string\n\nfor res.Next() {\n    res.Scan(&amp;table)\n    fmt.Println(table)\n}\n</code></pre>\n\n<p>PS don't ignore errors! This is only an example</p>\n"}], "owner": {"reputation": 795, "user_id": 1254794, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VoLcO.jpg?s=128&g=1", "display_name": "Amir Mohsen", "link": "https://stackoverflow.com/users/1254794/amir-mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5913, "favorite_count": 1, "accepted_answer_id": 43884296, "answer_count": 2, "score": 3, "last_activity_date": 1534181522, "creation_date": 1494394564, "last_edit_date": 1592644375, "question_id": 43884295, "link": "https://stackoverflow.com/questions/43884295/how-to-get-database-tables-list-in-go-language-show-tables", "title": "How To get database Tables list in go language (SHOW TABLES)", "body": "<p>I have a problem with getting database table list (SHOW TABLES) in go lang</p>\n<p>I use this packages</p>\n<blockquote>\n<p>database/sql</p>\n<p>gopkg.in/gorp.v1</p>\n<p>github.com/ziutek/mymysql/godrv</p>\n</blockquote>\n<p>and connect to MYSQL by this code:</p>\n<pre><code>db, err := sql.Open(\n    &quot;mymysql&quot;,\n    &quot;tcp:127.0.0.1:3306*test/root/root&quot;)\nif err != nil {\n    panic(err)\n}\n\ndbmap := &amp;DbMap{Conn:&amp;gorp.DbMap{Db: db}}\n</code></pre>\n<p>And I use this code to get list of tables</p>\n<pre><code>result, _ := dbmap.Exec(&quot;SHOW TABLES&quot;)\n</code></pre>\n<p>But result is empty!</p>\n"}, {"tags": ["pointers", "go", "interface", "type-conversion"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494397183, "post_id": 43883502, "comment_id": 74804087, "body": "peterSo&#39;s answer is very good. Just one remark: To invoke a pointer receiver method you need a pointer to the value. This pointer can be explicit or implicit but you formally must have a pointer which requires an <i>adressable</i> variable and not everything in Go is addressable: prominent examples are values in interfaces (your case here) and map entries. In these cases you have to &quot;copy the unaddressable value out of the interface/the map&quot; to get an addressable value from which you can get a pointer and invoke a pointer receiver method."}], "answers": [{"comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1494500412, "post_id": 43883600, "comment_id": 74860177, "body": "Downvoter(s) cares to comment? If no, then you have my sympathy with you."}], "tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": false, "score": -2, "last_activity_date": 1494390581, "creation_date": 1494390581, "answer_id": 43883600, "question_id": 43883502, "link": "https://stackoverflow.com/questions/43883502/how-to-invoke-a-method-with-pointer-receiver-after-type-assertion/43883600#43883600", "title": "How to invoke a method with pointer receiver after type assertion?", "body": "<p>The fix would be:</p>\n\n<pre><code>var b interface{} = &amp;Employee{\"Bob\"}\nb.(*Employee).Hello()\n</code></pre>\n\n<p>Here b is an interface that is actually a \"pointer to Employee\" and then same has been type asserted. The thing to remember is that \"Employee\" and \"pointer to Employee\" are two different types altogether.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1494401284, "last_edit_date": 1494401284, "creation_date": 1494390790, "answer_id": 43883635, "question_id": 43883502, "link": "https://stackoverflow.com/questions/43883502/how-to-invoke-a-method-with-pointer-receiver-after-type-assertion/43883635#43883635", "title": "How to invoke a method with pointer receiver after type assertion?", "body": "<p>You can't (in this case implicitly for a pointer receiver) take the address of the result of an expression (<code>b.(Employee)</code>). You can take the address of a variable. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Employee struct {\n    Name string\n}\n\nfunc (e Employee) Hi() {\n    fmt.Printf(\"Hi! I am %s.\\n\", e.Name)\n}\n\nfunc (e *Employee) Hello() {\n    fmt.Printf(\"Hello! I am %s.\\n\", e.Name)\n}\n\nfunc main() {\n    var a Employee = Employee{\"Alice\"}\n    a.Hi()\n    a.Hello()\n\n    var b interface{} = Employee{\"Bob\"}\n    b.(Employee).Hi()\n    // b.(Employee).Hello()\n    // main.go:24: cannot call pointer method on b.(Employee)\n    // main.go:24: cannot take the address of b.(Employee)\n    e := b.(Employee)  // e, a variable, is addressable\n    e.Hello()\n\n    var c interface{} = &amp;Employee{\"Chris\"}\n    c.(*Employee).Hi()\n    c.(*Employee).Hello()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Hi! I am Alice.\nHello! I am Alice.\nHi! I am Bob.\nHello! I am Bob.\nHi! I am Chris.\nHello! I am Chris.\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">Type assertions</a></p>\n  \n  <p>For an expression x of interface type and a type T, the primary\n  expression</p>\n\n<pre><code>x.(T)\n</code></pre>\n  \n  <p>asserts that x is not nil and that the value stored in x is of type T.\n  The notation x.(T) is called a type assertion. </p>\n  \n  <p>If the type assertion holds, the value of the expression is the value\n  stored in x and its type is T. If the type assertion is false, a\n  run-time panic occurs.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Calls\" rel=\"noreferrer\">Calls</a></p>\n  \n  <p>A method call x.m() is valid if the method set of (the type of) x\n  contains m and the argument list can be assigned to the parameter list\n  of m. If x is addressable and &amp;x's method set contains m, x.m() is\n  shorthand for (&amp;x).m()</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"noreferrer\">Address operators</a></p>\n  \n  <p>For an operand x of type T, the address operation &amp;x generates a\n  pointer of type *T to x. The operand must be addressable, that is,\n  either a variable, pointer indirection, or slice indexing operation;\n  or a field selector of an addressable struct operand; or an array\n  indexing operation of an addressable array. As an exception to the\n  addressability requirement, x may also be a (possibly parenthesized)\n  composite literal.</p>\n</blockquote>\n\n<p>The value of the type assertion <code>b.(Employee)</code> is of type <code>Employee</code>. The method call <code>b.(Employee).Hello()</code> is shorthand for <code>(&amp;b.(Employee)).Hello()</code> since <code>func (e *Employee) Hello()</code> has a pointer receiver. But, <code>b.(Employee)</code>, an expression, is not addressable. Therefore,</p>\n\n<pre><code>error: cannot call pointer method on b.(Employee)\nerror: cannot take the address of b.(Employee)\n</code></pre>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 4, "accepted_answer_id": 43883635, "answer_count": 2, "score": 2, "last_activity_date": 1494402137, "creation_date": 1494389957, "last_edit_date": 1494402137, "question_id": 43883502, "link": "https://stackoverflow.com/questions/43883502/how-to-invoke-a-method-with-pointer-receiver-after-type-assertion", "title": "How to invoke a method with pointer receiver after type assertion?", "body": "<p>I am learning interface, type conversions and methods with pointer receivers.\nThe rules and terminology behind pointer receiver methods are confusing to me.\nLet me demonstrate my confusion with one program.</p>\n\n<p>This is my Go program.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Employee struct {\n    Name string\n}\n\nfunc (e Employee) Hi() {\n    fmt.Printf(\"Hi! I am %s.\\n\", e.Name)\n}\n\nfunc (e *Employee) Hello() {\n    fmt.Printf(\"Hello! I am %s.\\n\", e.Name)\n}\n\nfunc main() {\n    var a Employee = Employee{\"Alice\"}\n    a.Hi()\n    a.Hello()\n\n    var b interface{} = Employee{\"Bob\"}\n    b.(Employee).Hi()\n    // b.(Employee).Hello()\n}\n</code></pre>\n\n<p>This is the output.</p>\n\n<pre><code>Hi! I am Alice.\nHello! I am Alice.\nHi! I am Bob.\n</code></pre>\n\n<p>If I remove the last commented out line, I get this error.</p>\n\n<pre><code># command-line-arguments\n./foo.go:24: cannot call pointer method on b.(Employee)\n./foo.go:24: cannot take the address of b.(Employee)\n</code></pre>\n\n<p>How can I fix that line of code so that I am able to invoke the method with\npointer receiver? Please explain a solution with some clarification on why this\ndoes not work by laying down the concepts of methods with pointer receiver.</p>\n"}, {"tags": ["go", "go-templates", "template-variables"], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494394410, "post_id": 43884159, "comment_id": 74803022, "body": "Is there any alternative way to do what I&#39;m trying?"}, {"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494394711, "post_id": 43884159, "comment_id": 74803128, "body": "define <code>title</code> variable in golang, pass it to <code>template.Execute</code> function."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 1, "creation_date": 1494395068, "post_id": 43884159, "comment_id": 74803245, "body": "The only other way I can think of, is to include the <code>header.tmpl</code> with <code>{{template &quot;header&quot; &quot;Title Here&quot;}}</code> then in <code>header.tmpl</code> I could use <code>{{.}}</code> to access that title. Only issue is, it would be nice if I can add a description or some other data (only through the template)"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494398133, "post_id": 43884159, "comment_id": 74804527, "body": "Anyone else looking for an answer... check out <a href=\"http://technosophos.com/2013/11/23/using-custom-template-functions-in-go.html\" rel=\"nofollow noreferrer\">technosophos.com/2013/11/23/&hellip;</a> - The best method for me was to make two seperate functions: <code>get</code> and <code>set</code> for defining globally accessible variables."}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 1, "last_activity_date": 1494393887, "creation_date": 1494393887, "answer_id": 43884159, "question_id": 43883110, "link": "https://stackoverflow.com/questions/43883110/parse-custom-variables-through-templates-in-golang/43884159#43884159", "title": "Parse Custom Variables Through Templates in Golang", "body": "<p>no, it's impossible parse variable through to another file.</p>\n\n<p>according to <a href=\"https://golang.org/pkg/text/template/#hdr-Variables\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<blockquote>\n  <p>A variable's scope extends to the \"end\" action of the control structure (\"if\", \"with\", or \"range\") in which it is declared, or to the end of the template if there is no such control structure. <strong>A template invocation does not inherit variables from the point of its invocation.</strong></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494485426, "post_id": 43887937, "comment_id": 74849974, "body": "Probably the closest thing to what I was looking for. Thank you! :)"}], "tags": [], "owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "is_accepted": true, "score": 1, "last_activity_date": 1494406941, "creation_date": 1494406941, "answer_id": 43887937, "question_id": 43883110, "link": "https://stackoverflow.com/questions/43883110/parse-custom-variables-through-templates-in-golang/43887937#43887937", "title": "Parse Custom Variables Through Templates in Golang", "body": "<p>As @zzn said, it's not possible to refer to a variable in one template from a different one.</p>\n\n<p>One way to achieve what you want is to define a template \u2013 that will pass through from one template to another.</p>\n\n<p><strong>header.html</strong>\n<code>\n{{define \"header\"}}\n&lt;title&gt;{{template \"title\"}}&lt;/title&gt;\n{{end}}\n</code></p>\n\n<p><strong>login.html</strong>\n<code>\n{{define \"title\"}}Login{{end}}\n{{define \"login\"}}\n&lt;html&gt;\n    &lt;head&gt;\n        {{template \"header\" .}}\n    &lt;/head&gt;\n    &lt;body&gt;\n        Login Body!\n    &lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></p>\n\n<p>You could also pass through the title as the pipeline when you invoke the \"header\" template (<code>{{template header $title}}</code> or even <code>{{template header \"index\"}}</code>), but that will prevent you passing in anything else to that template.</p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 43887937, "answer_count": 2, "score": 0, "last_activity_date": 1494406941, "creation_date": 1494386769, "question_id": 43883110, "link": "https://stackoverflow.com/questions/43883110/parse-custom-variables-through-templates-in-golang", "title": "Parse Custom Variables Through Templates in Golang", "body": "<p>Is it possible for me to set a variable in a template file <code>{{$title := \"Login\"}}</code> then parse it through to another file included using <code>{{template \"header\" .}}</code>?</p>\n\n<p>An example of what I'm attempting:</p>\n\n<p><strong>header.tmpl</strong></p>\n\n<pre><code>{{define \"header\"}}\n&lt;title&gt;{{.title}}&lt;/title&gt;\n{{end}}\n</code></pre>\n\n<p><strong>login.tmpl</strong></p>\n\n<pre><code>{{define \"login\"}}\n&lt;html&gt;\n    &lt;head&gt;\n        {{$title := \"Login\"}}\n        {{template \"header\" .}}\n    &lt;/head&gt;\n    &lt;body&gt;\n        Login Body!\n    &lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>How can I parse this custom $title variable I made through to my header template?</p>\n"}, {"tags": ["http", "go", "tcp", "proxy-protocol"], "answers": [{"comments": [{"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "edited": false, "score": 0, "creation_date": 1494385315, "post_id": 43882724, "comment_id": 74800445, "body": "Sorry I should have been for specific. I am using a TCP ELB and I only have access i those headers if using an HTTP or HTTPS ELB"}, {"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "edited": false, "score": 0, "creation_date": 1494385401, "post_id": 43882724, "comment_id": 74800467, "body": "That is why that package I referred to was created. So that the client up could be pulled out of a tcp connection and passed along if the proxy protocol is used"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 1, "last_activity_date": 1494383795, "creation_date": 1494383795, "answer_id": 43882724, "question_id": 43882010, "link": "https://stackoverflow.com/questions/43882010/get-source-ip-address-from-go-http-server/43882724#43882724", "title": "Get Source IP Address from Go HTTP Server", "body": "<p>The usual way of finding out the actual client IP over HTTP is by using some HTTP headers such as:</p>\n\n<ul>\n<li><code>X-Forwarded-For</code></li>\n<li><code>X-Real-IP</code></li>\n</ul>\n\n<p>Actually, Amazon ELB seems to support the X-Forwarded-For header:</p>\n\n<p><a href=\"http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/x-forwarded-headers.html\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/x-forwarded-headers.html</a></p>\n\n<p>If you are using Gorilla, they have a middleware that seems to take care of that for you:</p>\n\n<p><a href=\"https://godoc.org/github.com/gorilla/handlers#ProxyHeaders\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/gorilla/handlers#ProxyHeaders</a></p>\n"}], "owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494383795, "creation_date": 1494378104, "last_edit_date": 1494378605, "question_id": 43882010, "link": "https://stackoverflow.com/questions/43882010/get-source-ip-address-from-go-http-server", "title": "Get Source IP Address from Go HTTP Server", "body": "<p>I am trying to implement a HTTP server in Golang that receives requests from an Amazon ELB that uses the proxy protocol. Now I'd like to know what the original IP address is and so I was thinking about using <a href=\"https://github.com/armon/go-proxyproto\" rel=\"nofollow noreferrer\">this</a> package.</p>\n\n<p>Now <a href=\"https://github.com/armon/go-proxyproto\" rel=\"nofollow noreferrer\">this</a> package talks raws HTTP as far as I can tell but my server implements a higher level HTTP server with a router. </p>\n\n<p>I am having trouble translating between them. <strong>My question is this</strong>: how do I use <a href=\"https://github.com/armon/go-proxyproto\" rel=\"nofollow noreferrer\">this</a> library and still use a router like gorilla/mux? Now there's nothing special about <a href=\"https://github.com/armon/go-proxyproto\" rel=\"nofollow noreferrer\">this</a> package, it just talks at a lower level than HTTP.</p>\n\n<p>Example:</p>\n\n<pre><code>// Listen on TCP port 2000 on all interfaces.\nl, err := net.Listen(\"tcp\", \":2000\")\n// proxyproxy is the library that maintains the source ip address for me\nproxyList := &amp;proxyproto.Listener{Listener: list}\nif err != nil {\n    log.Fatal(err)\n}\ndefer proxyList.Close()\n\nfor {\n    // Wait for a connection.\n    conn, err := proxyList.Accept()\n    if err != nil {\n        log.Fatal(err)\n    }\n    // Handle the connection in a new goroutine.\n    // The loop then returns to accepting, so that\n    // multiple connections may be served concurrently.\n    go func(c net.Conn) {\n\n        // how do I connect my router\n\n    }(conn)\n}\n</code></pre>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1494375062, "post_id": 43881261, "comment_id": 74798168, "body": "From the sounds of it, the most likely cause is a hardware or device driver fault.  Check that your device drivers are up to date.  If that doesn&#39;t resolve the problem, try a stress tester like Prime95 to see if you can make the problem exhibit that way."}], "owner": {"reputation": 135, "user_id": 2277674, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f7d09788f6fff37f4896423fe507866?s=128&d=identicon&r=PG", "display_name": "sujitv", "link": "https://stackoverflow.com/users/2277674/sujitv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1494437242, "creation_date": 1494371883, "last_edit_date": 1494433940, "question_id": 43881261, "link": "https://stackoverflow.com/questions/43881261/debugging-running-go-program-freezes-windows-computer", "title": "Debugging/running go program freezes windows computer", "body": "<p>I am facing a weird issue, and am struggling to find the cause. I have a go program that iterates over a number of EC2 instances, and fetches CPU utilization metrics for them, then iterates to average and prints out a report. There are several loops and several call outs to external endpoints (Prometheus, Influx, Cloudwatch, AWS APIs, etc.).</p>\n\n<p>The issue I am facing is that, when I debug the application in Visual Studio Code, randomly sometimes, it causes my entire computer to freeze up. Randomly = I have not been able to associate any particular change or trigger point that seems to cause the issue or remove the issue. Freezes = completely freezes the machine (no mouse operations, no keyboard, cannot do anything other than force-power-cycle).</p>\n\n<p>I believe it is originating from my golang code, due to a few reasons:\n1. The freeze has occured about 7 times now, and only occurs when I run the code.\n2. The freeze consistently reproduced when I tried running the code through the debugger (after each restart)</p>\n\n<p>However, contrarily, stepping through the code that resulted in a freeze, does not reproduce the freeze at all.</p>\n\n<p>Finally, I ran the code outside of the Visual Studio environment (post build, as an exe). After several runs without any incident, I ran into a modified form of freeze. In this case, my computer did not completely freeze. The Mouse pointer was still responsive, but everything else froze up (no keyboard, no ctrl-alt-del), and I still had to force-power-cycle.</p>\n\n<p>I had logs in my code, and I found a pattern repeating when the freeze happens. My log pattern is a repeating pattern of 4 lines like this (where the value of i represents the iteration count):</p>\n\n<pre><code>2017/05/09 17:31:28 Computing avg &amp; normalized util for i=506, s=0, i-s=506, i-beg=506, len(avgs)=4049, len(ut.Values)=3278, pre time-point avg: 0.000000, pre overall avg: 0.111194, metricValue: 0.084000\n2017/05/09 17:31:28 \nRunning avg for time-point raw avg:0.084000, normalized avg:5.376000\nOverall running avg=&gt; raw:0.111140, normalized:7.112963 2017/05/09\n</code></pre>\n\n<p>Now, in this instance when the freeze occurred, the last entry to the log consisted of this unfinished snippet followed by a long stream of NUL characters, like this (# of NULs truncated):</p>\n\n<pre><code>17:31:28 Computing avg &amp; normalized util for i=507, s=0, i-s=507, i-beg=507, len(avgs)=4049, len(ut.Values)=3278, pre time-point avg: 0.000000, pre overall avg: 0.111140, metricValue: 0.104000 \n2017/05/09 17:31:28\nRunning avg for time-point raw avg:0.104000, normalized avg:6.656000 Overall running avg=&gt; raw:0.111126, normalNULNULNULNULNUL\n</code></pre>\n\n<p>In this particular case, it occurred on the 507th iteration. In a previous run, when the freeze occurred, the NULs were printed at a different iteration. And, the code has successfully processed iterations upto 5000 previously.</p>\n\n<p>Because the freeze, freezes me out, I am unable to conclusively debug the code. I am running this with go 1.7.4 on Windows 7 Pro 64-bit, and my laptop is a fairly powerful machine with 16GB RAM and Intel i7. I have not had many programs open when the freezes repeated (like today when I had to power-cycle my machine 3 times), so resource usage during subsequent freezes would have been minimal.</p>\n\n<p>Any help or pointers in how I can debug this issue, would be greatly appreciated.</p>\n\n<p>--Edit 05/10/2017--<br>\nI had a few more freezes since posting this question. A few new observations:<br>\n1. Running as a binary (as against debugging using Visual Studio Code) does produce complete freezes too.<br>\n2. Sometimes the freeze is instantaneous (everything seems to be moving along fine, and then suddenly everything freezes), while at other times the freeze develops slowly (first the cursor in the command window freezes, then the tooltips freeze, then the windows cannot be switched, the mouse freezes, and finally the taskmanager freezes).<br>\n3. I am now able to reproduce the freeze (running certain workloads always causes the freeze, although at different points in time/code). All of the workloads that produce a freeze have more iterations than the others. My logic processes a collection of containers, where each container itself is a collection of instances, and where each instance has a collection of metrics, and these workloads all had more number of top-level collections.  </p>\n\n<p>The above observations make it very likely to be a resource related issue. I was able to get a few pictures of the task manager after the machine had frozen. And, the task manager and resource manager do not indicate any untoward resource utilization.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/WdESh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WdESh.jpg\" alt=\"Task manager view when the machine had frozen\"></a>\n<a href=\"https://i.stack.imgur.com/G7O6A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G7O6A.jpg\" alt=\"Resource Manager &amp; Task Manager view during another freeze\"></a></p>\n"}, {"tags": ["elasticsearch", "go"], "answers": [{"comments": [{"owner": {"reputation": 3078, "user_id": 506238, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e437d7910d6a7b9cc7849c9638bf0e6a?s=128&d=identicon&r=PG", "display_name": "CamelBlues", "link": "https://stackoverflow.com/users/506238/camelblues"}, "edited": false, "score": 1, "creation_date": 1494477798, "post_id": 43879898, "comment_id": 74846614, "body": "Where can I learn more about this pattern? I&#39;d love to see a project that follows it"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 2, "last_activity_date": 1494364073, "creation_date": 1494364073, "answer_id": 43879898, "question_id": 43879353, "link": "https://stackoverflow.com/questions/43879353/how-to-share-service-connections-in-golang/43879898#43879898", "title": "How to share service connections in Golang", "body": "<p>This gets into a topic that is kinda controversial in go: <strong>dependency injection.</strong></p>\n\n<p>Unlike some other languages, we don't usually believe in complicated IOC containers, xml config, and reflection based tools for this kind of thing. I merely follow a few simple principles:</p>\n\n<ol>\n<li>Application packages and components should have all of their dependencies passed to them explicitly. Preferably as an interface type. If my <code>web</code> package needs a database connection, and an elastic client, it may have a function like <code>Serve(addr string, db database.DB, client *elastic.Client)</code> where <code>DB</code> is an interface type for my application's db.</li>\n<li><p>The job of <code>main</code> is essentially to read configuration, create all shared components, and pass them to the various components:</p>\n\n<pre><code>func main(){\n  var config = readConfig() //flags, json, whatever\n  var elastic = elastic.NewClient(config.whatever)\n  var db = database.New(config.Connectionstring)\n\n  //now start app components\n  web.Serve(config.Addr, db, elastic)\n}\n</code></pre></li>\n</ol>\n\n<p>I find this pattern helps keep my packages separate yet inter-operable. I try to avoid package level variables for anything that needs to change from run to run.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 1139277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WA5Ss.jpg?s=128&g=1", "display_name": "Alexey Smychagin", "link": "https://stackoverflow.com/users/1139277/alexey-smychagin"}, "is_accepted": false, "score": 1, "last_activity_date": 1494535163, "creation_date": 1494535163, "answer_id": 43925128, "question_id": 43879353, "link": "https://stackoverflow.com/questions/43879353/how-to-share-service-connections-in-golang/43925128#43925128", "title": "How to share service connections in Golang", "body": "<p>I would create special type that holds these objects.</p>\n\n<pre><code>type AppFactory struct {\n  Client          *http.Client\n  DatastoreClient *datastore.Client\n  FileStorage     FileStorage\n  DB              DB\n} \n</code></pre>\n\n<p>or you can use context.Context</p>\n\n<pre><code>type key int\nconst clientKey key = 0\n\nfunc NewContext(ctx context.Context, client *elastic.Client) context.Context {\n    return context.WithValue(ctx, clientKey, client)\n}\n\nfunc ClientFromContext(ctx context.Context) *elastic.Client {\n    client := ctx.Value(clientKey).(*elastic.Client)\n    return client\n}\n</code></pre>\n\n<p>Personally, I would use context.Context because it is more universal solution.</p>\n\n<p>I don't think it is a good idea to use global variables.\nVery quickly it can become a problem.</p>\n"}], "owner": {"reputation": 3078, "user_id": 506238, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e437d7910d6a7b9cc7849c9638bf0e6a?s=128&d=identicon&r=PG", "display_name": "CamelBlues", "link": "https://stackoverflow.com/users/506238/camelblues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1494535163, "creation_date": 1494362049, "last_edit_date": 1494362571, "question_id": 43879353, "link": "https://stackoverflow.com/questions/43879353/how-to-share-service-connections-in-golang", "title": "How to share service connections in Golang", "body": "<p>I'm new to Go and looking at this the <a href=\"https://github.com/olivere/elastic\" rel=\"nofollow noreferrer\">elastic library</a> for go and in the Getting Started example it says \"You typically create one client for your app.\"</p>\n\n<p>What does that mean? Do you create a client in the your <code>main</code> function and somehow pass it to the functions with <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">context</a>? Do you create a global variable and assign it to the client, like this?</p>\n\n<pre><code>var (\n  client *elastic.Client\n)\n\nfunc a() {\n  client.Search()\n}\n\nfunc main() {\n  c, err := elastic.NewClient()\n  client = c\n}\n</code></pre>\n"}, {"tags": ["sql", "go"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1494359735, "post_id": 43878740, "comment_id": 74792514, "body": "<a href=\"http://stackoverflow.com/questions/19730941/how-to-use-wildcards-in-sql-query-with-parameters\" title=\"how to use wildcards in sql query with parameters\">stackoverflow.com/questions/19730941/&hellip;</a> suggests making your parameter argument (in this case, <code>name</code>) include the wildcards instead of the query.  So <code>stmt.Query(&quot;%&quot; + name + &quot;%&quot;)</code>.  This still prevents injection, because it&#39;s still being sent as a parameter instead of inline with the query."}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 2, "last_activity_date": 1494427274, "last_edit_date": 1495542392, "creation_date": 1494427274, "answer_id": 43895723, "question_id": 43878740, "link": "https://stackoverflow.com/questions/43878740/trying-to-query-contains-search-in-golang-with-prepare/43895723#43895723", "title": "Trying to query contains search in golang with Prepare", "body": "<p>Reposting my comment as an answer so this question actually has one:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19730941/how-to-use-wildcards-in-sql-query-with-parameters\">This answer</a> suggests making your parameter argument (in this case, <code>name</code>) include the wildcards instead of the query. So <code>stmt.Query(\"%\" + name + \"%\")</code>. This still prevents injection, because it's still being sent as a parameter instead of inline with the query.</p>\n"}, {"tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1494430020, "last_edit_date": 1494430020, "creation_date": 1494428165, "answer_id": 43896110, "question_id": 43878740, "link": "https://stackoverflow.com/questions/43878740/trying-to-query-contains-search-in-golang-with-prepare/43896110#43896110", "title": "Trying to query contains search in golang with Prepare", "body": "<p>You could either make the whole %searchValue% a parameter value itself, or use string concatenation for it inside the query itself. </p>\n\n<p>Approach 1 (recommended):</p>\n\n<pre><code>stmt, err := dBusers.Prepare(\"SELECT id, name, email, username FROM users WHERE name LIKE ?;\")\n    if err != nil {\n        logging.LogError(\"Could Not Query All Users: \"+err.Error())\n        return nil, errors.New(\"Could Not Query Users\")\n    }\n    rows, err := stmt.Query(\"%\" + name + \"%\")\n</code></pre>\n\n<p>Approach 2:</p>\n\n<pre><code>stmt, err := dBusers.Prepare(\"SELECT id, name, email, username FROM users WHERE name LIKE '%' + ? + '%';\")\n    if err != nil {\n        logging.LogError(\"Could Not Query All Users: \"+err.Error())\n        return nil, errors.New(\"Could Not Query Users\")\n    }\n    rows, err := stmt.Query(name) \n</code></pre>\n\n<p>I would recommend the first approach because it wouldn't force you to always use a \"contains' search. You could selectively use the same statement to do exact (just name), begins with (name+\"%\"), ends with (\"%\"+name) or contains (\"%\"+name+\"%\") searches.</p>\n\n<p>PS: Thinking about it, the second approach might lead to injection, not sure, need to think about it more. </p>\n"}], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 43895723, "answer_count": 2, "score": 1, "last_activity_date": 1494430020, "creation_date": 1494359436, "question_id": 43878740, "link": "https://stackoverflow.com/questions/43878740/trying-to-query-contains-search-in-golang-with-prepare", "title": "Trying to query contains search in golang with Prepare", "body": "<p>I have a prepare and a query function in go and when I place the ? in the search it works fine. When I try and do a contains search with the % I get <code>sql: statement expects 0 inputs; got 1</code></p>\n\n<p>How can I do this type of query without having the variables directly in the SQL? I want to prevent SQL injection . Thank You for your help.</p>\n\n<p>I am using go version go1.8.1 darwin/amd64 and using MySQL </p>\n\n<p>My Go Code:</p>\n\n<pre><code>stmt, err := dBusers.Prepare(\"SELECT id, name, email, username FROM users WHERE name LIKE '%?%';\")\n    if err != nil {\n        logging.LogError(\"Could Not Query All Users: \"+err.Error())\n        return nil, errors.New(\"Could Not Query Users\")\n    }\n    rows, err := stmt.Query(name)\n</code></pre>\n"}, {"tags": ["go", "struct", "types", "field"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1494326374, "post_id": 43867570, "comment_id": 74770163, "body": "You cannot. The only way it to copy the type."}], "answers": [{"tags": [], "owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "is_accepted": false, "score": 1, "last_activity_date": 1494328505, "creation_date": 1494328505, "answer_id": 43868343, "question_id": 43867570, "link": "https://stackoverflow.com/questions/43867570/declare-type-of-a-struct-field-by-type-of-another-struct-field/43868343#43868343", "title": "Declare type of a struct field by type of another struct field", "body": "<p>As @zerkms said, you can't.\nBest idea is to probably create your own field of the same type in <code>MyObject</code>.</p>\n\n<p>You can also embed the <code>s3.GetObjectOutput</code> in <code>MyObject</code>.</p>\n\n<pre><code>type MyObject struct {\n    *s3.GetObjectOutput\n    ...\n}\n</code></pre>\n\n<p>Given <code>myobj</code> is an instance of <code>MyObject</code>, use <code>myobj.Metadata</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494420241, "post_id": 43881595, "comment_id": 74819642, "body": "Why do you embed it then ? Btw a new answer if not the best place to answer my own answer, use the comments."}, {"owner": {"reputation": 98, "user_id": 6888786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6YB0C.jpg?s=128&g=1", "display_name": "San Nguyen", "link": "https://stackoverflow.com/users/6888786/san-nguyen"}, "reply_to_user": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494461316, "post_id": 43881595, "comment_id": 74842818, "body": "@WilliamPoussier I want to use only the type of Metadata in *s3.GetObjectOutput struct. If I embed *s3.GetObjectOutput, it will pollute my MyObject struct. And since I want to clearly declare field of MyObject struct as Metadata type, not map[string]*string type, I embedded Metadata type in MyObject struct"}], "tags": [], "owner": {"reputation": 98, "user_id": 6888786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6YB0C.jpg?s=128&g=1", "display_name": "San Nguyen", "link": "https://stackoverflow.com/users/6888786/san-nguyen"}, "is_accepted": true, "score": 0, "last_activity_date": 1494374726, "last_edit_date": 1494374726, "creation_date": 1494374426, "answer_id": 43881595, "question_id": 43867570, "link": "https://stackoverflow.com/questions/43867570/declare-type-of-a-struct-field-by-type-of-another-struct-field/43881595#43881595", "title": "Declare type of a struct field by type of another struct field", "body": "<p>@William Poussier\nIn that way I have to use a global variable just for use its type. As @zerkms suggested I copied Metadata type from *s3.GetObjectOutput </p>\n\n<pre><code>type Metadata map[string]*string \n</code></pre>\n\n<p>and use:</p>\n\n<pre><code>type MyObject struct { \n    Metadata\n}\n</code></pre>\n"}], "owner": {"reputation": 98, "user_id": 6888786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6YB0C.jpg?s=128&g=1", "display_name": "San Nguyen", "link": "https://stackoverflow.com/users/6888786/san-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 43881595, "answer_count": 2, "score": 0, "last_activity_date": 1494374726, "creation_date": 1494326325, "question_id": 43867570, "link": "https://stackoverflow.com/questions/43867570/declare-type-of-a-struct-field-by-type-of-another-struct-field", "title": "Declare type of a struct field by type of another struct field", "body": "<p>Here is *s3.GetObjectOutput struct:</p>\n\n<pre><code>type GetObjectOutput struct {\n    ...\n    Metadata map[string]*string\n    ...\n}\n</code></pre>\n\n<p>I want to declare my struct with a struct field has type of Metadata field in GetObjectOutput struct like this</p>\n\n<pre><code>type MyObject struct {\n    Metadata *s3.GetObjectOutput.Metadata\n    ...\n}\n</code></pre>\n\n<p>But it was not correct. How do I declare a struct with a field has type of another struct's field instead of explicitly write down:</p>\n\n<pre><code>type MyObject struct {\n    Metadata map[string]*string\n    ...\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "syslog"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494323081, "post_id": 43865923, "comment_id": 74767911, "body": "How about a *syslog.Writer ? What&#39;s the actual question because that answer is just too obvious."}, {"owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494324042, "post_id": 43865923, "comment_id": 74768571, "body": "If I do this question it&#39;s because I&#39;m rookie in golang and the answer is not obvious for me... I don&#39;t know how I can write the function."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494324376, "post_id": 43865923, "comment_id": 74768813, "body": "If new to Go the best recommendation is to take the Tour of Go twice and read through Effective Go afterwards."}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 0, "creation_date": 1494331289, "post_id": 43867156, "comment_id": 74773577, "body": "Thank you @Elad. That&#39;s exactly what I did at the first time but after, I don&#39;t get to take the variable, for example sysLog.Info(&quot;message&quot;), in my main function :S"}, {"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "reply_to_user": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 0, "creation_date": 1494335764, "post_id": 43867156, "comment_id": 74776888, "body": "I edited. In any case, you should listen to @Volker advice and take the GO Tour."}, {"owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 0, "creation_date": 1494336915, "post_id": 43867156, "comment_id": 74777801, "body": "Yes, he has reason."}], "tags": [], "owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "is_accepted": true, "score": 2, "last_activity_date": 1494335573, "last_edit_date": 1494335573, "creation_date": 1494325137, "answer_id": 43867156, "question_id": 43865923, "link": "https://stackoverflow.com/questions/43865923/implement-a-function-which-returns-a-pointer/43867156#43867156", "title": "Implement a function which returns a pointer", "body": "<p>The answer is pretty simple as @Volker said,</p>\n\n<pre><code>func LogBook() *syslog.Writer {\n    sysLog, _ := syslog.New(syslog.LOG_LOCAL0|syslog.LOG_ERROR, \"myapp\")\n    return sysLog\n}\n</code></pre>\n\n<p>Usage Example:</p>\n\n<pre><code>func main(){\n    w := LogBook()\n    w.Info(\"message\")\n}\n</code></pre>\n\n<p>Please notice:</p>\n\n<ul>\n<li>This package is not implemented on Windows. As the syslog package is frozen, Windows users are encouraged to use a package outside of the standard library. For background, see <a href=\"https://golang.org/issue/1108\" rel=\"nofollow noreferrer\">https://golang.org/issue/1108</a>.</li>\n<li>This package is not implemented on Plan 9.</li>\n<li>This package is not implemented on NaCl (Native Client).</li>\n</ul>\n"}], "owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 43867156, "answer_count": 1, "score": -1, "last_activity_date": 1494335573, "creation_date": 1494321602, "question_id": 43865923, "link": "https://stackoverflow.com/questions/43865923/implement-a-function-which-returns-a-pointer", "title": "Implement a function which returns a pointer", "body": "<p>I have implemented the syslog daemon service in my golang app. I used syslog.New in main package and it works but now, I want to export it to another package.</p>\n\n<pre><code>package config\n\nimport (\n    \"log/syslog\"\n)\n\nfunc LogBook() ? {\n    sysLog, _ := syslog.New(syslog.LOG_LOCAL0|syslog.LOG_ERROR, \"myapp\") // syslog.New returns (*Writer, error)\n    return ?\n}\n</code></pre>\n\n<p>How can I implement this function?\nAfter, how can I use this variable 'sysLog' in other packages?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-api-gateway", "client-certificates"], "answers": [{"comments": [{"owner": {"reputation": 512, "user_id": 1813664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hfn2Z.jpg?s=128&g=1", "display_name": "mkatanski", "link": "https://stackoverflow.com/users/1813664/mkatanski"}, "edited": false, "score": 0, "creation_date": 1494348734, "post_id": 43866188, "comment_id": 74786196, "body": "Thanks for Your answer. But I still don&#39;t know from where i can get the <code>server.crt</code> and <code>server.key</code> files. Your example gives me an error: <code>open server.crt: no such file or directory</code>"}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "reply_to_user": {"reputation": 512, "user_id": 1813664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hfn2Z.jpg?s=128&g=1", "display_name": "mkatanski", "link": "https://stackoverflow.com/users/1813664/mkatanski"}, "edited": false, "score": 0, "creation_date": 1494355749, "post_id": 43866188, "comment_id": 74790206, "body": "This is the certificate and keys for the server, your service. Either generate a self signed one (not sure it will work with AWS, or get one for free with Let&#39;s Encrypt)."}, {"owner": {"reputation": 471, "user_id": 1147183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8a81a9b55252b0de017c284d4a313c?s=128&d=identicon&r=PG", "display_name": "droid-zilla", "link": "https://stackoverflow.com/users/1147183/droid-zilla"}, "edited": false, "score": 0, "creation_date": 1506698265, "post_id": 43866188, "comment_id": 79938333, "body": "@WilliamPoussier The issue the OP is referring to is that AWS offers a client certificate but describes no method to actually get a file copy of the pem keys. I assume you could use <a href=\"http://docs.aws.amazon.com/cli/latest/reference/apigateway/get-client-certificate.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/cli/latest/reference/apigateway/&hellip;</a> to get the PEM certificate as a string and then make a PEM and insert the text. Although it is a self signed certificate so likely Let&#39;s Encrypt is still more secure."}], "tags": [], "owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "is_accepted": true, "score": 3, "last_activity_date": 1494323374, "last_edit_date": 1494323374, "creation_date": 1494322373, "answer_id": 43866188, "question_id": 43864955, "link": "https://stackoverflow.com/questions/43864955/aws-api-gateway-client-certificates-in-go-lang/43866188#43866188", "title": "AWS API Gateway client certificates in Go lang", "body": "<p>The client certificate AWS is given you is for authenticating the client that send requests to your service, which is the AWS gateway.</p>\n\n<p>This cert is not to be used to start your server, but to authenticates requests.</p>\n\n<p>See an example of use below, untested code, but as a lead.</p>\n\n<pre><code>func Hello(w http.ResponseWriter, req *http.Request) {\n    io.WriteString(w, \"hello, world!\\n\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/hello\", Hello)\n\n    certBytes, err := ioutil.ReadFile(\"aws-gateway.pem\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    block, certBytes := pem.Decode(certBytes)\n\n    cert, err := x509.ParseCertificate(block.Bytes)\n    if err != nil {\n       log.Fatal(err)\n    }\n\n    clientCertPool := x509.NewCertPool()\n    clientCertPool.AddCerts(cert)\n\n    tlsConfig := &amp;tls.Config{\n        ClientCAs: clientCertPool,\n        // NoClientCert\n        // RequestClientCert\n        // RequireAnyClientCert\n        // VerifyClientCertIfGiven\n        // RequireAndVerifyClientCert\n        ClientAuth: tls.RequireAndVerifyClientCert,\n    }\n    tlsConfig.BuildNameToCertificate()\n\n    server := &amp;http.Server{\n        Addr:      \":8080\",\n        TLSConfig: tlsConfig,\n    }\n\n    server.ListenAndServeTLS(\"server.crt\", \"server.key\")\n}\n</code></pre>\n\n<p>This way, your service will require that all requests provide a certificate and will verify it against the pool of ClientCA. You could, of course, add more certificates to the client pool if desired.</p>\n"}], "owner": {"reputation": 512, "user_id": 1813664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hfn2Z.jpg?s=128&g=1", "display_name": "mkatanski", "link": "https://stackoverflow.com/users/1813664/mkatanski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1061, "favorite_count": 0, "accepted_answer_id": 43866188, "answer_count": 1, "score": 1, "last_activity_date": 1494323374, "creation_date": 1494318911, "question_id": 43864955, "link": "https://stackoverflow.com/questions/43864955/aws-api-gateway-client-certificates-in-go-lang", "title": "AWS API Gateway client certificates in Go lang", "body": "<p>I'm trying to secure connection between AWS API Gateway and my API endpoint services exactly as it is described int his documentation: <a href=\"http://docs.aws.amazon.com/apigateway/latest/developerguide/getting-started-client-side-ssl-authentication.html\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/apigateway/latest/developerguide/getting-started-client-side-ssl-authentication.html</a> </p>\n\n<p>AFAIK I need to copy the cert form AWS API Gateway and use <code>http.ListenAndServeTLS</code> method. But it accepts two files: <strong>keyFile</strong> and <strong>certFile</strong> \n<code>func ListenAndServeTLS(addr, certFile, keyFile string, handler Handler)</code>.</p>\n\n<p>When I click on copy link (see image below)\n<a href=\"https://i.stack.imgur.com/IVREw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IVREw.png\" alt=\"example of certificate generated by AWS\"></a></p>\n\n<p>the only thing I get is the certificate in such format (I've shortened it for explanation purposes):</p>\n\n<pre><code>-----BEGIN CERTIFICATE-----\nMIIC6TCCAdGgAwIBAgIJAKbyiCf2f5J2MA0GCSqGSIb3DQEBCwUAMDQxCzAJBgNV\nfYe+dxR0PMFvfUpZaGgaY1ykQG1sNaw/b6NjNg9c1aEVSZ7b1eU/cBmb6XqHw0Ih\n7yHtBm+p8Px4NMAT9YhytTxPRBYpApfUsfPMa3qfUWvvj4TD0LR6bW980bebyxUn\nBigXToSFlPeiNGdU/Zpiw9crzplojNBFc=\n-----END CERTIFICATE-----\n</code></pre>\n\n<p>So my question is, how exactly I need to configure <code>ListenAndServeTLS</code> method to make sure the any request to my service is from API Gateway? Where I can find private key? It's quite confusing for me.</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1494320165, "post_id": 43864844, "comment_id": 74765885, "body": "<code>Go loop iterates faster than mysql can load entries</code> Oh, really?"}, {"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1494320268, "post_id": 43864844, "comment_id": 74765957, "body": "Maybe you just have few entries in you array? Did you print it to see its&#39; contents?"}, {"owner": {"reputation": 77, "user_id": 4453376, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2ce2b7b23975304fb2a04e3d463ca9bc?s=128&d=identicon&r=PG&f=1", "display_name": "Anshul Sinha", "link": "https://stackoverflow.com/users/4453376/anshul-sinha"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1494320614, "post_id": 43864844, "comment_id": 74766185, "body": "I have about 30,000 entries in the array, all of them have values I have printed them"}, {"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1494320707, "post_id": 43864844, "comment_id": 74766259, "body": "<code>checkErr</code> shows you something?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1494320800, "post_id": 43864844, "comment_id": 74766328, "body": "<code>db.Prepare</code> should be outside the loop. The point is, prepare once, assign parameter many times."}, {"owner": {"reputation": 77, "user_id": 4453376, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2ce2b7b23975304fb2a04e3d463ca9bc?s=128&d=identicon&r=PG&f=1", "display_name": "Anshul Sinha", "link": "https://stackoverflow.com/users/4453376/anshul-sinha"}, "edited": false, "score": 0, "creation_date": 1494320918, "post_id": 43864844, "comment_id": 74766401, "body": "nope checkErr doesn&#39;t raise any issue, I want want to know if there is a way  of loading the entire array into the table instead of looping though it and losing entries."}, {"owner": {"reputation": 77, "user_id": 4453376, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2ce2b7b23975304fb2a04e3d463ca9bc?s=128&d=identicon&r=PG&f=1", "display_name": "Anshul Sinha", "link": "https://stackoverflow.com/users/4453376/anshul-sinha"}, "edited": false, "score": 0, "creation_date": 1494321742, "post_id": 43864844, "comment_id": 74766982, "body": "Thank putting the Prepare outside the loop fixed the problem"}], "owner": {"reputation": 77, "user_id": 4453376, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2ce2b7b23975304fb2a04e3d463ca9bc?s=128&d=identicon&r=PG&f=1", "display_name": "Anshul Sinha", "link": "https://stackoverflow.com/users/4453376/anshul-sinha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 367, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494320214, "creation_date": 1494318621, "last_edit_date": 1494320214, "question_id": 43864844, "link": "https://stackoverflow.com/questions/43864844/loading-multiple-entries-into-sql-table-using-golang", "title": "loading multiple entries into sql table using Golang", "body": "<pre><code>for _,data := range Array { \n    stmt, err := db.Prepare(INSERT log SET a=?,b=?,c=?)\n    checkErr(err)\n    _, err = stmt.Exec(data.a,data.b,data.c)\n    checkErr(err)\n}\n</code></pre>\n\n<p>This is the loop to add data into the table but the Go loop iterates faster than mysql can load entries into the table thus only the last few entries are populated, is there any way to load all the sql statements and populate the table at once? </p>\n"}, {"tags": ["go", "benchmarking"], "answers": [{"comments": [{"owner": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "edited": false, "score": 0, "creation_date": 1494316129, "post_id": 43864037, "comment_id": 74763257, "body": "Since this solution contains a <code>main()</code> function, it must be placed in a &quot;main&quot; package, right? My project is a library, so there is no main package, and adding one to the repo would cause difficulties with people acquiring it via <code>go get</code>. Is there any workaround?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "edited": false, "score": 0, "creation_date": 1494316219, "post_id": 43864037, "comment_id": 74763315, "body": "@dylhunn I included a link to the <a href=\"https://play.golang.org/p/0Rf_y1vNUp\" rel=\"nofollow noreferrer\">Go Playground</a> where you can try it. Having a <code>main()</code> function is so just you can try it out of the box. You can use the code inside the <code>main()</code> function <i>everywhere</i>, obviously including non-<code>main</code> functions too, also including test packages."}, {"owner": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "edited": false, "score": 0, "creation_date": 1494316313, "post_id": 43864037, "comment_id": 74763377, "body": "@ixza Ah, I understand. Thanks for the help!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1494315883, "creation_date": 1494315883, "answer_id": 43864037, "question_id": 43863794, "link": "https://stackoverflow.com/questions/43863794/how-to-use-time-value-of-benchmark/43864037#43864037", "title": "How to use time value of benchmark", "body": "<p>You may use the <a href=\"https://golang.org/pkg/testing/#Benchmark\" rel=\"noreferrer\"><code>testing.Benchmark()</code></a> function to manually measure / benchmark \"benchmark\" functions (that have the signature of <code>func(*testing.B)</code>), and you get the result as a value of <a href=\"https://golang.org/pkg/testing/#BenchmarkResult\" rel=\"noreferrer\"><code>testing.BenchmarkResult</code></a>, which is a struct with all the details you need:</p>\n\n<pre><code>type BenchmarkResult struct {\n    N         int           // The number of iterations.\n    T         time.Duration // The total time taken.\n    Bytes     int64         // Bytes processed in one iteration.\n    MemAllocs uint64        // The total number of memory allocations.\n    MemBytes  uint64        // The total number of bytes allocated.\n}\n</code></pre>\n\n<p>The time per execution is returned by the <a href=\"https://golang.org/pkg/testing/#BenchmarkResult.NsPerOp\" rel=\"noreferrer\"><code>BenchmarkResult.NsPerOp()</code></a> method, you can do whatever you want to with that.</p>\n\n<p>See this simple example:</p>\n\n<pre><code>func main() {\n    res := testing.Benchmark(BenchmarkSleep)\n    fmt.Println(res)\n    fmt.Println(\"Ns per op:\", res.NsPerOp())\n    fmt.Println(\"Time per op:\", time.Duration(res.NsPerOp()))\n}\n\nfunc BenchmarkSleep(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        time.Sleep(time.Millisecond * 12)\n    }\n}\n</code></pre>\n\n<p>Output is (try it on the <a href=\"https://play.golang.org/p/0Rf_y1vNUp\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>     100      12000000 ns/op\nNs per op: 12000000\nTime per op: 12ms\n</code></pre>\n"}], "owner": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 3, "accepted_answer_id": 43864037, "answer_count": 1, "score": 6, "last_activity_date": 1554648113, "creation_date": 1494315079, "last_edit_date": 1554648113, "question_id": 43863794, "link": "https://stackoverflow.com/questions/43863794/how-to-use-time-value-of-benchmark", "title": "How to use time value of benchmark", "body": "<p>I have written a benchmark for my chess engine in Go:</p>\n\n<pre><code>func BenchmarkStartpos(b *testing.B) {\n    board := ParseFen(startpos)\n    for i := 0; i &lt; b.N; i++ {\n        Perft(&amp;board, 5)\n    }\n}\n</code></pre>\n\n<p>I see this output when it runs:</p>\n\n<pre><code>goos: darwin\ngoarch: amd64\nBenchmarkStartpos-4           10     108737398 ns/op\nPASS\nok      _/Users/dylhunn/Documents/go-chess  1.215s\n</code></pre>\n\n<p>I want to use the time per execution (in this case, <code>108737398 ns/op</code>) to compute another value, and also print it as a result of the benchmark. Specifically, I want to output <em>nodes per second</em>, which is given as the result of the <code>Perft</code> call divided by the time per call.</p>\n\n<p>How can I access the time the benchmark took to execute, so I can print my own derived results?</p>\n"}, {"tags": ["session", "go", "gorilla"], "comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494316510, "post_id": 43862627, "comment_id": 74763507, "body": "What does &quot;working&quot; mean for your application. Gorilla/Sessions does not seems to provide anything to do what you ask out of the box. Perhaps you could recreate a cookie, update its expiration date, if the user you want to keep logged-in has sent a request in the last 5 minutes..."}, {"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "reply_to_user": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494316725, "post_id": 43862627, "comment_id": 74763644, "body": "Working means user is using web app. If he is performing any activity (like visiting menus or any back end process related to browser request) then he should not logged out of the system."}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494317991, "post_id": 43862627, "comment_id": 74764452, "body": "Well, either you increment that 10minutes expiration timeout, or you implement a system to detect user-activity and update the cookie expiration date based on that."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494325152, "post_id": 43862627, "comment_id": 74769331, "body": "See <a href=\"http://stackoverflow.com/questions/28616830/gorilla-sessions-how-to-automatically-update-cookie-expiration-on-request\">related question</a>"}, {"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "edited": false, "score": 0, "creation_date": 1494326005, "post_id": 43862627, "comment_id": 74769881, "body": "Okay.. Thanks !"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1529891"}, "is_accepted": false, "score": 1, "last_activity_date": 1495233400, "creation_date": 1495233400, "answer_id": 44079916, "question_id": 43862627, "link": "https://stackoverflow.com/questions/43862627/logout-only-if-idle/44079916#44079916", "title": "Logout only if idle", "body": "<p>Here is sample code that I use to do this:</p>\n\n<pre><code>func SessionHandler(ses sessions.Session, timeout int64) {\n    timeNow := time.Now().Unix()\n\n    if ses.Get(\"authenticated\").(bool) {\n        switch ses.Get(\"timestamp\").(type) {\n        case int64:\n            sessiontime := ses.Get(\"timestamp\").(int64)\n\n            if sessiontime &gt; 0 {\n                if timeNow &gt; (sessiontime + timeout) {\n                    ses.Clear()\n                    ses.Save()\n                    return\n                }\n\n                ses.Set(\"timestamp\", timeNow)\n                ses.Save()\n            }\n        default:\n            ses.Set(\"timestamp\", timeNow)\n            ses.Save()\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 3144840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/usgFv.png?s=128&g=1", "display_name": "mzupan", "link": "https://stackoverflow.com/users/3144840/mzupan"}, "is_accepted": false, "score": 1, "last_activity_date": 1501861233, "creation_date": 1501861233, "answer_id": 45510794, "question_id": 43862627, "link": "https://stackoverflow.com/questions/43862627/logout-only-if-idle/45510794#45510794", "title": "Logout only if idle", "body": "<p>I had some good experience using <a href=\"https://github.com/alexedwards/scs\" rel=\"nofollow noreferrer\">https://github.com/alexedwards/scs</a> for session-handling.</p>\n\n<p>It also includes a setting for idle-timeout:</p>\n\n<pre><code>session.IdleTimeout(30*time.Minute)\n</code></pre>\n\n<p>I don't know if switching the session-library is an option for you, but scs integrates pretty seamlessly, so it might be worth looking at it at least. :)</p>\n"}], "owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1501861233, "creation_date": 1494311423, "question_id": 43862627, "link": "https://stackoverflow.com/questions/43862627/logout-only-if-idle", "title": "Logout only if idle", "body": "<p>I am using <a href=\"http://www.gorillatoolkit.org/pkg/sessions\" rel=\"nofollow noreferrer\">gorilla/sessions</a> for session handling. Below is my code for session:</p>\n\n<pre><code>var STORE = sessions.NewCookieStore([]byte(\"some_secret_text\"))\n\nsession, err := STORE.Get(c.Request, \"user\")\nif err != nil {\n    fmt.Println(\"Error: \",err)\n}\nif session.IsNew {\n   session.Options.MaxAge = 10 * 60\n}\n</code></pre>\n\n<p>I want to logout user only if he is idle for 10 minutes. \nCurrently user gets logged out even if he is working.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 178, "user_id": 7623834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ttyjm.png?s=128&g=1", "display_name": "R. Gadeev", "link": "https://stackoverflow.com/users/7623834/r-gadeev"}, "edited": false, "score": 1, "creation_date": 1494306778, "post_id": 43861546, "comment_id": 74758428, "body": "You have forgotten to put comma on line 36 -&gt; <code>Dial: make_dialer(false),</code>"}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 7623834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ttyjm.png?s=128&g=1", "display_name": "R. Gadeev", "link": "https://stackoverflow.com/users/7623834/r-gadeev"}, "is_accepted": true, "score": 2, "last_activity_date": 1494310031, "creation_date": 1494310031, "answer_id": 43862283, "question_id": 43861546, "link": "https://stackoverflow.com/questions/43861546/keep-getting-compile-error-when-configuring-http-client/43862283#43862283", "title": "keep getting compile error when configuring http client", "body": "<p>As error says, you have made syntax error.<br>\nMore specifically, you have forgotten to put comma on line 36:</p>\n\n<pre><code>...\nfunc httpGet ()  int {\n    tr := &amp;http.Transport{\n        Dial: make_dialer(false), // &lt;-- comma\n    }\n...\n</code></pre>\n"}], "owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 43862283, "answer_count": 1, "score": 0, "last_activity_date": 1494310031, "creation_date": 1494306302, "question_id": 43861546, "link": "https://stackoverflow.com/questions/43861546/keep-getting-compile-error-when-configuring-http-client", "title": "keep getting compile error when configuring http client", "body": "<p>New to golang here. Tried to follow <a href=\"https://raw.githubusercontent.com/jiaz/simpleloadclient/master/main.go\" rel=\"nofollow noreferrer\">sample code</a> and created the following code snippet, but I keep getting compile error. Not sure why.</p>\n\n<pre><code>go run te2.go \n# command-line-arguments\n./te2.go:36: syntax error: unexpected semicolon or newline, expecting comma or }\n</code></pre>\n\n<p>Here is code snippet</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"bufio\"\nimport \"os\"\nimport \"time\"\nimport \"net/http\"\nimport \"sync/atomic\"\n\nvar req = []byte(\"GET /small HTTP/1.1\\r\\n\" +\n\"Host: localhost\\r\\n\" +\n\"Content-Length: 0\\r\\n\\r\\n\");\nvar buf = make([]byte, 1024)\nvar total uint64 = 0;\nvar t0 = time.Now()\nvar c = make(chan int)\n\ntype DialerFunc func(net, addr string) (net.Conn, error)\n\nfunc make_dialer(keepAlive bool) DialerFunc {\n    return func(network, addr string) (net.Conn, error) {\n        conn, err := (&amp;net.Dialer{\n            Timeout:   3 * time.Second,\n            KeepAlive: 3000 * time.Second,\n        }).Dial(network, addr)\n        if err != nil {\n            return conn, err\n        }\n        conn.(*net.TCPConn).SetLinger(0)\n        return conn, err\n    }\n}\n\nfunc httpGet ()  int {\n    tr := &amp;http.Transport{\n        Dial: make_dialer(false)\n    }\n    client := &amp;http.Client{ Transport: tr}\n    resp, err := client.Do(req)\n    //defer resp.Body.Close()\n    if (err != nil) {\n        fmt.Println(err)\n    } else {\n        resp.Body.Close()\n    }\n    atomic.AddUint64(&amp;total, 1)\n    if (total == 10000) {\n        fmt.Println(time.Now().Sub(t0))\n    }\n    c &lt;- 1\n    return 0;\n}\n\nfunc main() {\n    i := 1\n    t0 = time.Now()\n    for (i &lt; 10) {\n        go httpGet()\n        i += 1\n    }\n    for (1 &lt; 2) {\n        &lt;-c\n        go httpGet()\n    }\n    reader := bufio.NewReader(os.Stdin)\n    text, _ := reader.ReadString('\\n')\n    fmt.Println(text)   \n}\n</code></pre>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1494308987, "post_id": 43861492, "comment_id": 74759297, "body": "Related / possible duplicatr of <a href=\"http://stackoverflow.com/questions/37588639/in-go-when-will-a-variable-become-unreachable/37591282#37591282\">In Go, when will a variable become unreachable?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 5, "last_activity_date": 1494308940, "last_edit_date": 1494308940, "creation_date": 1494308531, "answer_id": 43861938, "question_id": 43861492, "link": "https://stackoverflow.com/questions/43861492/collision-between-garbage-collector-and-deferred-functions/43861938#43861938", "title": "Collision between garbage collector and deferred functions?", "body": "<p>the problems of the code is after <code>file.Fd()</code> return, <code>file</code> is unreachable, so <code>file</code> may be close by the finalizer(garbage collected).</p>\n\n<p>according to <a href=\"https://golang.org/pkg/runtime/#SetFinalizer\" rel=\"noreferrer\">runtime.SetFinalizer</a>:</p>\n\n<blockquote>\n  <p>For example, if p points to a struct that contains a file descriptor d, and p has a finalizer that closes that file descriptor, and if the last use of p in a function is a call to syscall.Write(p.d, buf, size), then p may be unreachable as soon as the program enters syscall.Write. The finalizer may run at that moment, closing p.d, causing syscall.Write to fail because it is writing to a closed file descriptor (or, worse, to an entirely different file descriptor opened by a different goroutine). To avoid this problem, call runtime.KeepAlive(p) after the call to syscall.Write.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/pkg/runtime/#KeepAlive\" rel=\"noreferrer\">runtime.KeepAlive</a> usage:</p>\n\n<blockquote>\n  <p>KeepAlive marks its argument as currently reachable. This ensures that the object is not freed, and its finalizer is not run, before the point in the program where KeepAlive is called.</p>\n</blockquote>\n\n<pre><code>func a(fd int) {\n    file := os.NewFile(uintptr(fd), \"\")\n    defer func() {\n        if err := syscall.Close(int(file.Fd()); err != nil { \n             fmt.Printf(\"%v\", err)\n        }\n        runtime.KeepAlive(file)\n    }()\n }\n</code></pre>\n"}], "owner": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1494308940, "creation_date": 1494306029, "question_id": 43861492, "link": "https://stackoverflow.com/questions/43861492/collision-between-garbage-collector-and-deferred-functions", "title": "Collision between garbage collector and deferred functions?", "body": "<p>Consider the following code snippet:</p>\n\n<pre><code>func a(fd int) {\n file := os.NewFile(uintptr(fd), \"\")\n defer func() {\n   if err := file.Close(); err != nil { \n      fmt.Printf(\"%v\", err)\n   }\n}\n</code></pre>\n\n<p>This piece of code is legit, and will work OK. Files will be closed upon returning from <code>a()</code>\nHowever, The following will not work correctly:</p>\n\n<pre><code>func a(fd int) {\n file := os.NewFile(uintptr(fd), \"\")\n defer func() {\n   if err := syscall.Close(int(file.Fd()); err != nil { \n      fmt.Printf(\"%v\", err)\n   }\n}\n</code></pre>\n\n<p>The error that will be received, occasionally, will be <code>bad file descriptor</code>, due to the fact of <a href=\"https://github.com/golang/go/blob/master/src/os/file_unix.go#L69\" rel=\"nofollow noreferrer\">NewFile setting a finalizer</a>\nwhich, during garbage collection, will close the file itself.</p>\n\n<p>Whats unclear to me, is that the deferred function still has a reference to the file, so theoretically, it shouldn't be garbage collected yet.\nSo why is golang runtime behaves that way?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 7, "last_activity_date": 1494303860, "creation_date": 1494303860, "answer_id": 43861112, "question_id": 43861055, "link": "https://stackoverflow.com/questions/43861055/why-goroutine-block-main-func-in-this-http-server/43861112#43861112", "title": "why goroutine block main func in this http server?", "body": "<blockquote>\n  <p>The function value and parameters are evaluated as usual in the calling goroutine</p>\n</blockquote>\n\n<p>\u2014 <a href=\"https://golang.org/ref/spec#Go_statements\" rel=\"noreferrer\">Go language spec, \"Go statements\"</a>.</p>\n\n<p>You're creating a goroutine for the call to <code>log.Fatal</code>, but the <em>arguments</em> to <code>log.Fatal</code> are evaluated beforehand, in the main goroutine. And <code>Fatal</code>'s argument is the return value of <code>http.ListenAndServe</code>. So the new goroutine doesn't start until <em>after</em> <code>ListenAndServe</code> returns.</p>\n"}, {"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 3, "last_activity_date": 1577720008, "last_edit_date": 1577720008, "creation_date": 1494304394, "answer_id": 43861193, "question_id": 43861055, "link": "https://stackoverflow.com/questions/43861055/why-goroutine-block-main-func-in-this-http-server/43861193#43861193", "title": "why goroutine block main func in this http server?", "body": "<p>Since the <code>http.ListenAndServe()</code> is blocking, then you can put one of it in a goroutine. The idea is to separate the start of those two web servers in separated goroutine.</p>\n\n<pre><code>func main() {\n    router := httprouter.New()\n    router.GET(\"/\", Index)\n\n    go func() {\n        fmt.Println(\"listen on 8080\")\n        log.Fatal(http.ListenAndServe(\":8080\", router))\n    }()\n\n    fmt.Println(\"listen on 8888\")\n    log.Fatal(http.ListenAndServe(\":8888\", router))\n}\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 3868484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8845181e3d0c229fb60538051bf0b70c?s=128&d=identicon&r=PG", "display_name": "LeoTao", "link": "https://stackoverflow.com/users/3868484/leotao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1793, "favorite_count": 1, "accepted_answer_id": 43861112, "answer_count": 2, "score": 3, "last_activity_date": 1577720008, "creation_date": 1494303587, "question_id": 43861055, "link": "https://stackoverflow.com/questions/43861055/why-goroutine-block-main-func-in-this-http-server", "title": "why goroutine block main func in this http server?", "body": "<p>I want to setup a http server with httprouter listening on two ports <code>8888</code> and <code>8080</code> just like the code below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/julienschmidt/httprouter\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc Index(w http.ResponseWriter, r *http.Request, _ httprouter.Params) {\n    fmt.Fprint(w, \"Welcome!\\n\")\n}\n\nfunc main() {\n    router := httprouter.New()\n    router.GET(\"/\", Index)\n\n    fmt.Println(\"listen on 8080\")\n    // this is where blocked\n    go log.Fatal(http.ListenAndServe(\":8080\", router))\n    fmt.Println(\"listen on 8888\")\n    log.Fatal(http.ListenAndServe(\":8888\", router))\n}\n</code></pre>\n\n<p>But it doesn't work properly,my server only listen on <code>8080</code>.If I make some change:</p>\n\n<pre><code>go func() { log.Fatal(http.ListenAndServe(\":8080\", router)) }()\n</code></pre>\n\n<p>It works finely both on <code>8080</code> and <code>8888</code>.So why? It's about <code>closure</code> or something else?</p>\n"}, {"tags": ["go", "influxdb"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494324471, "post_id": 43860816, "comment_id": 74768880, "body": "How if you split the write operation, e.g. every 100 points, call <code>c.Write(bp)</code> and then recreate new batch points?"}, {"owner": {"reputation": 135, "user_id": 2277674, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f7d09788f6fff37f4896423fe507866?s=128&d=identicon&r=PG", "display_name": "sujitv", "link": "https://stackoverflow.com/users/2277674/sujitv"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494355240, "post_id": 43860816, "comment_id": 74789897, "body": "Is there a significance to the value 100? While I could try that, it seems to be a random number. From the documentation for the client, the golang client is supposed to handle the http limits without needing explicit splitting. In fact, the reference example has 1000 points added at a time."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494364721, "post_id": 43860816, "comment_id": 74795045, "body": "No, you can try even with 1000, but I think lower number is better for starting point, since we don&#39;t know what the exact problem. Where on the documentation said that the client will handle http limits for you? Looking at the <code>client.go</code>, it simply send the data through <code>POST</code> request. One more poin, how did you define and fill the data to <code>ResultSet</code>? Is it used concurrently?"}, {"owner": {"reputation": 135, "user_id": 2277674, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f7d09788f6fff37f4896423fe507866?s=128&d=identicon&r=PG", "display_name": "sujitv", "link": "https://stackoverflow.com/users/2277674/sujitv"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494372530, "post_id": 43860816, "comment_id": 74797610, "body": "All of my code is running sequentially. The ResultSet is populated first, then sequentially, it is passed into this function to be written. I will try restricting the count to 100 and see if it helps."}], "owner": {"reputation": 135, "user_id": 2277674, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f7d09788f6fff37f4896423fe507866?s=128&d=identicon&r=PG", "display_name": "sujitv", "link": "https://stackoverflow.com/users/2277674/sujitv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 839, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494302113, "creation_date": 1494302113, "question_id": 43860816, "link": "https://stackoverflow.com/questions/43860816/writing-to-influxdb-using-go-client-results-in-random-errors", "title": "Writing to InfluxDB using Go client results in random errors", "body": "<p>I am using the golang influx v2 client library to write to my influxdb. My code, based on the reference example in the client documentation is fairly straightforward:</p>\n\n<pre><code>func SaveMetricsToInflux(id string, rs Resultset, mtype string) {\n    defer conf.Trace()()\n    // Create a new HTTPClient\n    c, err := client.NewHTTPClient(client.HTTPConfig{\n        Addr:     conf.InfluxEP,\n        Username: conf.InfluxUser,\n        Password: conf.InfluxPasswd,\n    })\n    if err != nil {\n        log.Println(\"Error connecting to the Influx server\", err)\n    }\n    defer c.Close()\n\n    bp, err := client.NewBatchPoints(client.BatchPointsConfig{\n        Database:  conf.InfluxDb,\n        Precision: \"s\",\n    })\n    if err != nil {\n        log.Println(\"Error creating a NewBatchPoint\", err)\n    }\n    for _, v := range rs.Values {\n        tags := map[string]string{\n            \"id\":    id,\n            \"mtype\": mtype,\n        }\n        fields := map[string]interface{}{\n            avgpcpu: v.MetricValue,\n        }\n        pt, err := client.NewPoint(\n            tablename,\n            tags,\n            fields,\n            time.Unix(v.MetricTime, 0),\n        )\n        if err != nil {\n            log.Println(\"Error creating NewPoint \", err)\n        }\n        bp.AddPoint(pt)\n        //      f, _ := pt.Fields()\n        //      log.Printf(\"adding point %s &gt;&gt; %v &gt;&gt; %s &gt;&gt; %d &gt;&gt; %v\", pt.Name(), pt.Tags(), pt.Time(), pt.UnixNano(), f)\n    }\n    if err := c.Write(bp); err != nil {\n        log.Println(\"Error writing to Influx\", err)\n    }\n\n}\n</code></pre>\n\n<p>In general, the Resultset will have about 4200 rows (sometimes its in lower 100s), and each of those is converted to a BatchPoint comprising two string tags, and one float field. The metric is retrieved from Cloudwatch and pushed into Influx, with the SaveMetricsToInflux method called in a loop, once per EC2 instance.</p>\n\n<p>The problem I am facing is that almost every time, the write operation returns with a Partial Write error. The details of the error vary from attempt to next. </p>\n\n<p>As an example, the following error came during my latest run (attempting to write 196 records):</p>\n\n<blockquote>\n  <p>Error writing to Influx {\"error\":\"partial write:\\nunable to parse\n  'metrics,id=i-094385fbc09268fd6,mtype=ec2-cpu avg-pcpu=1.662-cpu\n  avg-pcpu=1.802 1494277200': invalid number\\nunable to parse '6\n  1494244500': invalid field format\\nunable to parse\n  'metrics,id=i-094385fbc09268fd6,mtype=ec': missing fields\"}</p>\n</blockquote>\n\n<p>As is seen, this looks like data corruption. First I thought that this was because of too many records being sent, but as seen in the last example above, it occurs also for low 100 records too.</p>\n\n<p>Next, I thought, I might be corrupting the memory someway in my code. So I logged out each BatchPoint as it was added, and also logged out the HTTP Query data (from the Influx golang client) of the records being sent by HTTP. The data in both those places was pristine and correct, and yet I received the error.</p>\n\n<p>The partial writes have so far resulted in a loss of less than a 100 records. Inside the Influxdb, this is also messing up my data by creating invalid measurements and data:</p>\n\n<pre><code>&gt; show measurements\nname: measurements\nname\n----\nmetricd01d7a  &lt;-- this is invalid\nmetrics       &lt;-- valid\ns             &lt;-- this is invalid\n\n&gt; select count(*) from metrics group by mtype\nname: metrics\ntags: mtype=             &lt;-- this is invalid\ntime count_avg-pcpu\n---- --------------\n0    4\n\nname: metrics\ntags: mtype=ec2-cec2-cpu &lt;-- this is invalid\ntime count_avg-pcpu\n---- --------------\n0    1\n\nname: metrics            &lt;-- valid\ntags: mtype=ec2-cpu\ntime count_avg-pcpu\n---- --------------\n0    42210\n</code></pre>\n\n<p>Since I have not seen this issue widely reported, I have to assume this is uniquely occurring in my environment. In a previous development, I had used node.js and javascript API to write to the same InfluxDB (with about the same rows) without this issue occurring. Which seems to put the blame back onto the golang code I have written.</p>\n\n<p>I am stumped on what else to do to debug this issue further. Any help or guidance would be greatly appreciated.</p>\n"}, {"tags": ["database", "go", "google-cloud-platform", "google-cloud-spanner"], "answers": [{"tags": [], "owner": {"reputation": 37598, "user_id": 153407, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zoFYE.png?s=128&g=1", "display_name": "Dan McGrath", "link": "https://stackoverflow.com/users/153407/dan-mcgrath"}, "is_accepted": false, "score": 2, "last_activity_date": 1494303446, "creation_date": 1494303446, "answer_id": 43861025, "question_id": 43860449, "link": "https://stackoverflow.com/questions/43860449/should-a-new-cloud-spanner-client-instance-be-created-on-every-request/43861025#43861025", "title": "Should a new Cloud Spanner Client instance be created on every request?", "body": "<blockquote>\n  <p>Does this imply that NewClient() is intended to be invoked for each\n  unique request handled by a service which needs to access Cloud\n  Spanner?</p>\n</blockquote>\n\n<p>No. Think of a client as a connection to the database. Each connection can service many requests and is typically created at during application initialization and closed when your application closes or no longer needs a database.</p>\n\n<p>You can have many clients (connections) so you can process requests in parallel, if needed.</p>\n"}], "owner": {"reputation": 243, "user_id": 1275173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d72e0f039d59b7a6ad0f089116aad7dc?s=128&d=identicon&r=PG", "display_name": "Voobr", "link": "https://stackoverflow.com/users/1275173/voobr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497862377, "creation_date": 1494299592, "question_id": 43860449, "link": "https://stackoverflow.com/questions/43860449/should-a-new-cloud-spanner-client-instance-be-created-on-every-request", "title": "Should a new Cloud Spanner Client instance be created on every request?", "body": "<p>Google's official Cloud Spanner client library for Go has a <code>NewClient()</code> function which accepts a <code>Context</code>. Typically, <code>Context</code>s are passed around as part of a (potentially long-running) request chain. Does this imply that <code>NewClient()</code> is intended to be invoked for each unique request handled by a service which needs to access Cloud Spanner?</p>\n\n<p>If I were using a traditional relational database, I'd be creating a shared pool of clients to be used many times by a process in order to cut down on resource usage (e.g. network connections). The idea of creating a unique database client whenever a request handler kicks off is a little off-putting to me, and I wonder if I'm misunderstanding the intended usage of the client library.</p>\n\n<p>On the other hand, Cloud Spanner <em>is</em> rather magical in general, so it wouldn't surprise me too much to learn that this is in fact an encouraged and efficient pattern. Still, it'd be nice to know for sure, and the docs don't really discuss it.</p>\n"}, {"tags": ["assembly", "go"], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494290129, "post_id": 43858617, "comment_id": 74754067, "body": "To follow up, do you know of an easy way to view user code separately from the runtime packages?"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1494325744, "post_id": 43858617, "comment_id": 74769714, "body": "See: <a href=\"https://golang.org/doc/asm\" rel=\"nofollow noreferrer\">Go&#39;s assembly documentation</a> and <a href=\"http://plan9.bell-labs.com/sys/doc/asm.html\" rel=\"nofollow noreferrer\">an introduction to Plan 9 syntax</a>"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494325788, "post_id": 43858617, "comment_id": 74769747, "body": "@olivia Do you mean when you are using something like <code>objdump</code>? Only dump the object files that correspond to user code, not the entire binary."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1494326411, "post_id": 43858617, "comment_id": 74770188, "body": "@CodyGray This is not easily done in Go as Go object files do not actually contain machine code. They use the Plan 9 approach where object files contain assembly code with some pseudo-instructions not otherwise available that is optimized during linking."}, {"owner": {"reputation": 377, "user_id": 6723763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/1r3OV.gif?s=128&g=1", "display_name": "Rtsne42", "link": "https://stackoverflow.com/users/6723763/rtsne42"}, "edited": false, "score": 1, "creation_date": 1494343405, "post_id": 43858617, "comment_id": 74782764, "body": "Thanks for the answer, but I feel like you slightly missed the question. My confusion was mainly due to the varying outputs I was getting from both commands. As I later learned it seems that when using <code>objdump</code> the resulting file contains not just the program but every library and built-in function that was compiled. At the end, I managed to use <code>go build -gcflags -S file.go</code> to print out the assembly code for my program."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 3, "last_activity_date": 1494285236, "creation_date": 1494285236, "answer_id": 43858617, "question_id": 43858356, "link": "https://stackoverflow.com/questions/43858356/how-to-get-assembly-output-for-a-short-go-program/43858617#43858617", "title": "How to get assembly output for a short Go program?", "body": "<p>Both of these give you human-readable assembly, it's just that the Go toolchain uses Plan 9 assembly syntax which is a bit weird to the untrained eye. Use a tool like <code>objdump</code> from the GNU binutils to get more familiar syntax.</p>\n"}], "owner": {"reputation": 377, "user_id": 6723763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/1r3OV.gif?s=128&g=1", "display_name": "Rtsne42", "link": "https://stackoverflow.com/users/6723763/rtsne42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1494285236, "creation_date": 1494283404, "question_id": 43858356, "link": "https://stackoverflow.com/questions/43858356/how-to-get-assembly-output-for-a-short-go-program", "title": "How to get assembly output for a short Go program?", "body": "<p>I have this program written in Go:</p>\n\n<pre><code>package main\n\nfunc add(a, b int) int {\n    return a + b\n}\n\nfunc main () {\n    add(1,2)\n}\n</code></pre>\n\n<p>For curiosity's sake, I would like to see what this program looks like in assembly.</p>\n\n<p>I found a couple of ways to output assembly instructions from a Go program, mainly:</p>\n\n<pre><code>go tool compile -S file.go &gt; file.S\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>go tool objdump executable &gt; disassembly\n</code></pre>\n\n<p>But it seems like both of these produce totally different outputs.</p>\n\n<p>How can I print out human-readable assembly instructions that make up my Go program? </p>\n"}, {"tags": ["go", "null", "segmentation-fault", "initialization"], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 5704287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301db416d4780f831d32422efd9f7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Hefner", "link": "https://stackoverflow.com/users/5704287/evan-hefner"}, "edited": false, "score": 0, "creation_date": 1494365636, "post_id": 43858364, "comment_id": 74795466, "body": "An interface type can be <code>nil</code>, which means any function that takes that type has to either nil-check it or risk panicking when it tries to call a method on it, which is what I&#39;m trying to avoid."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 0, "last_activity_date": 1494283425, "creation_date": 1494283425, "answer_id": 43858364, "question_id": 43858337, "link": "https://stackoverflow.com/questions/43858337/how-can-i-prevent-initialization-of-an-exported-type-in-go/43858364#43858364", "title": "How can I prevent initialization of an exported type in Go?", "body": "<p>Now <code>foo.Bar</code> is just an interface type. The default value is a nil pointer. You are very close, just initialize it as <code>b := foo.NewBar()</code></p>\n"}], "owner": {"reputation": 317, "user_id": 5704287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301db416d4780f831d32422efd9f7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Hefner", "link": "https://stackoverflow.com/users/5704287/evan-hefner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1494365251, "creation_date": 1494283322, "last_edit_date": 1494365251, "question_id": 43858337, "link": "https://stackoverflow.com/questions/43858337/how-can-i-prevent-initialization-of-an-exported-type-in-go", "title": "How can I prevent initialization of an exported type in Go?", "body": "<p>Edit: I'm not asking how to initialize variables correctly.  I'm asking how to <em>prevent</em> them from being initialized <em>incorrectly</em>, so that functions that take that type don't have to explicitly validate their arguments.</p>\n\n<p>In Go, I have a type that contains maps, e.g.:</p>\n\n<pre><code>package foo\n\ntype Bar struct {\n  baz map[string]int\n  total int\n}\n\nfunc NewBar() *Bar {\n  return &amp;Bar{baz: map[string]int{}}\n}\n\nfunc (b *Bar) IncrementBaz(key string) {\n    f.baz[key] = f.baz[key] + 1\n    f.total++\n}\n\n// ...\n</code></pre>\n\n<p>If another package initializes the type and then tries to write to it, it will try to write to a nil map, causing a segfault:</p>\n\n<pre><code>package main\n\nimport \"foo\"\n\nfunc main() {\n  var b foo.Bar\n  b.IncrementBaz(\"some_key\") // write to nil map -&gt; segfault\n  // ...\n}\n</code></pre>\n\n<p>To prevent this, I want to make it so that other packages can't initialize an empty <code>foo.Bar</code>.</p>\n\n<p>I can't simply make it unexported, because I want functions in other packages to be able to declare it as an argument or return type.  If I wrap it in an interface, I get a similar problem:</p>\n\n<pre><code>package \"foo\"\n\ntype Bar interface {\n  IncrementBaz(string)\n  // ...\n}\n\ntype bar struct {\n  baz map[string]int\n  total int\n}\n\nfunc NewBar() Bar {\n  return &amp;bar{baz: map[string]int{}}\n}\n\nfunc (b *bar) IncrementBaz(key string) {\n    f.baz[key] = f.baz[key] + 1\n    f.total++\n}\n\n// ...\n</code></pre>\n\n<p>Similar problem:</p>\n\n<pre><code>package main\n\nimport \"foo\"\n\nfunc main() {\n  var b foo.Bar\n  b.IncrementBaz(\"some_key\") // method call on nil interface -&gt; segfault\n  // ...\n}\n</code></pre>\n\n<p>Is there any way to have an exported type that only the package that declares it can initialize it?</p>\n"}, {"tags": ["json", "go", "marshalling"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494276312, "post_id": 43856948, "comment_id": 74749733, "body": "Why are you leaving the redis response as strings, and not some more concrete type? Your data model has those rows as strings, so of course it has to escape the quotes to put those in json. If your json code involves string processing, you are doing something wrong."}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494276415, "post_id": 43856948, "comment_id": 74749785, "body": "Using <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">go-redis</a> and <code>todos, _ := c.LRange(&quot;todos&quot;, 0, -1).Result()</code> returns a <code>[]string</code>."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494276448, "post_id": 43856948, "comment_id": 74749805, "body": "You could parse each item to a struct type perhaps. Checking an alternate solution now."}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494276540, "post_id": 43856948, "comment_id": 74749851, "body": "Well, I have a <code>Todo</code> struct with <code>id</code> and <code>content</code> and I already tried that solution but, I got the same result. Should I show that also?"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1494276609, "post_id": 43856948, "comment_id": 74749894, "body": "If Response.Data is a <code>[]*Todo</code>, and you can get it into that form, it should marshal just fine. Using <code>json.RawMessage</code> instead of string is another possibility, but also requires some extra processing."}], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 4, "last_activity_date": 1494276789, "creation_date": 1494276789, "answer_id": 43857096, "question_id": 43856948, "link": "https://stackoverflow.com/questions/43856948/marshall-json-slice-to-valid-json/43857096#43857096", "title": "Marshall JSON Slice to valid JSON", "body": "<p>Whenever possible you should marshal from go objects that match your desired json. I'd recommend parsing the json from redis:</p>\n\n<pre><code>type Response struct {\n    Status string\n    Data   []*Info\n}\n\ntype Info struct {\n    Content string `json:\"content\"`\n    ID      string `json:\"id\"`\n}\n\nfunc main() {\n    r := &amp;Response{Status: \"OK\"}\n    for _, d := range data {\n        info := &amp;Info{}\n        json.Unmarshal([]byte(d), info)\n        //handle error\n        r.Data = append(r.Data, info)\n    }\n    dat, _ := json.Marshal(r)\n    fmt.Println(string(dat))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ourp0B2GWi\" rel=\"nofollow noreferrer\">Playground Link</a></p>\n"}], "owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 43857096, "answer_count": 1, "score": 2, "last_activity_date": 1494276789, "creation_date": 1494276148, "last_edit_date": 1494276489, "question_id": 43856948, "link": "https://stackoverflow.com/questions/43856948/marshall-json-slice-to-valid-json", "title": "Marshall JSON Slice to valid JSON", "body": "<p>I'm building a REST API using Golang but I'm having some troubles trying to correctly Marshalling a Json Slice. I've been scratching my head for a while now, even after looking to several questions and answer and on the web.</p>\n\n<p>Essentially, I have a <strong>Redis</strong> client that called after a call <code>-X GET /todo/</code> spits up a slice of <code>todos</code></p>\n\n<pre><code>[{\"content\":\"test6\",\"id\":\"46\"} {\"content\":\"test5\",\"id\":\"45\"}] //[]string\n</code></pre>\n\n<p>Now, I want to return a given <code>Response</code> based on the fact that I found <code>todos</code> or not, so I have a <code>Struct</code> like</p>\n\n<pre><code>type Response struct {\n    Status string\n    Data []string\n}\n</code></pre>\n\n<p>Then, If I found some <code>todos</code> I just <code>Marshal</code> a json with</p>\n\n<pre><code>if(len(todos) &gt; 0){\n    res := SliceResponse{\"Ok\", todos}\n    response, _ = json.Marshal(res)\n}\n</code></pre>\n\n<p>And, In order to remove unnecessary <code>\\</code> inside the response, I use <code>bytes.Replace</code> like</p>\n\n<pre><code>response = bytes.Replace(response, []byte(\"\\\\\"), []byte(\"\"), -1)\n</code></pre>\n\n<p>Finally, getting</p>\n\n<pre><code>{\n   \"Status\" : \"Ok\",\n   \"Data\" : [\n              \"{\"content\":\"test6\",\"id\":\"46\"}\",\n              \"{\"content\":\"test5\",\"id\":\"45\"}\"\n    ]\n}\n</code></pre>\n\n<p>As you can see each <code>\"</code> before each <code>{</code> and after each <code>}</code>, excluding the first and the last ones, are clearly wrong.\nWhile the correct JSON would be</p>\n\n<pre><code>{\n    \"Status\": \"Ok\",\n    \"Data\": [{\n        \"content \": \"test6\",\n        \"id \": \"46\"\n    }, {\n        \"content \": \"test5\",\n        \"id \": \"45\"\n    }]\n}\n</code></pre>\n\n<blockquote>\n  <p>I successfully managed to get them off by finding their index and trim them off and\n  also with regex but I was wondering.</p>\n</blockquote>\n\n<p><strong>Is there a clean and better way to achieve that?</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1494267050, "post_id": 43854294, "comment_id": 74744646, "body": "I think the person who you think suggested this was just asking a question about whether it&#39;s cancelled automatically rather than claiming anything."}], "answers": [{"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 6, "last_activity_date": 1494267169, "creation_date": 1494267169, "answer_id": 43854581, "question_id": 43854294, "link": "https://stackoverflow.com/questions/43854294/does-context-done-unblock-when-context-variable-goes-out-of-scope-in-golang/43854581#43854581", "title": "Does Context.Done() unblock when context variable goes out of scope in golang?", "body": "<p>No, it doesn't cancel automatically when the context leaves scope. Typically one calls <code>defer cancel()</code> (using the callback from <code>ctx.WithCancel()</code>) oneself to make sure that the context is cancelled.</p>\n\n<p><a href=\"https://blog.golang.org/context\" rel=\"noreferrer\">https://blog.golang.org/context</a> provides a good overview of how to use contexts correctly (including the <code>defer</code> pattern above). Also, the source code <a href=\"https://golang.org/src/context/context.go\" rel=\"noreferrer\">https://golang.org/src/context/context.go</a> is quite readable and you can see there's no magic that would provide automatic cancellation.</p>\n"}, {"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 2, "last_activity_date": 1494268002, "last_edit_date": 1494268002, "creation_date": 1494267615, "answer_id": 43854684, "question_id": 43854294, "link": "https://stackoverflow.com/questions/43854294/does-context-done-unblock-when-context-variable-goes-out-of-scope-in-golang/43854684#43854684", "title": "Does Context.Done() unblock when context variable goes out of scope in golang?", "body": "<p>\"Unblocking\" is not the clearest terminology. <code>Done()</code> returns a channel (or nil) that will receive a <code>struct{}</code> and/or close when the context is \"cancelled\". What exactly that chan is, or when it is sent on, is up to the individual implementation. It may be sent/closed at some fixed time as with <code>WithDeadline</code>, or manually done as with <code>WithCancel</code>. </p>\n\n<p>The key though, is that this is never \"automatic\" or guaranteed to happen. If you make a context with <code>WithCancel</code> and read from the <code>Done()</code> channel, that read will block <strong>indefinitely</strong> until the <code>Cancel()</code> method is called. If that never happens, then you have a wasted goroutine and your application's memory will increase each time you do it. </p>\n\n<p>Once the context is completely out of scope (no executing goroutine is listening to it or has a reference to the parent context), it will get garbage collected and everything will go away.</p>\n\n<p><strong>EDIT</strong>: After reading the source though, it looks like <a href=\"https://golang.org/src/context/context.go#L229\" rel=\"nofollow noreferrer\">WithCancel</a> and friends spawn goroutines to propigate the cancellation. Therefore you <strong>must</strong> make sure Cancel gets called at some point to avoid goroutine leaks.</p>\n"}], "owner": {"reputation": 491, "user_id": 7655137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5203fc333c6443affb37aa2209267d71?s=128&d=identicon&r=PG&f=1", "display_name": "darkwing", "link": "https://stackoverflow.com/users/7655137/darkwing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1432, "favorite_count": 1, "accepted_answer_id": 43854581, "answer_count": 2, "score": 3, "last_activity_date": 1494268002, "creation_date": 1494266168, "question_id": 43854294, "link": "https://stackoverflow.com/questions/43854294/does-context-done-unblock-when-context-variable-goes-out-of-scope-in-golang", "title": "Does Context.Done() unblock when context variable goes out of scope in golang?", "body": "<p>Will context.Done() unblock when a context variable goes out of scope and cancel is not explicitly called? </p>\n\n<p>Let's say I have the following code:</p>\n\n<pre><code>func DoStuff() {\n    ctx, _ := context.WithCancel(context.Background())\n    go DoWork(ctx)\n    return\n}\n</code></pre>\n\n<p>Will ctx.Done() unblock in DoWork after the return in DoStuff()? </p>\n\n<p>I found this thread, <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/BbvTlaQwhjw\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/BbvTlaQwhjw</a>, where the person asking how to use Context.Done() claims that context.Done() will unblock when the context variable leaves scope but no one validated this, and I didn't see anything in the docs. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1494266676, "post_id": 43854117, "comment_id": 74744422, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/30731687/how-do-i-represent-an-optional-string-in-go/30741287#30741287\">How do I represent an Optional String in Go?</a>"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1494269758, "post_id": 43854117, "comment_id": 74746123, "body": "If you want it to be explicitly optional (and you care about uninitialized vs default value), you probably want to use <code>*bool</code> instead of <code>bool</code>. It makes things a bit harder to deal with though, so make sure you need to."}, {"owner": {"reputation": 2577, "user_id": 3512709, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sA5RZ.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3512709/adam"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494273681, "post_id": 43854117, "comment_id": 74748324, "body": "@OliviaRuth: yeah, I think that&#39;s my only real solution. But like you said, it makes things slightly more complicated. Maybe it&#39;s not that important for me to have optional inputs."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 3, "creation_date": 1494275661, "post_id": 43854117, "comment_id": 74749408, "body": "Worth noting that if the default for the boolean is &quot;true&quot;, you should probably invert the boolean.  For example, if the boolean is &quot;logInput&quot;, and you want it to default to on, you should probably make the boolean option instead be &quot;noLog&quot; and default to false.  This follows the Go axiom of making default values useful."}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1494294015, "post_id": 43854117, "comment_id": 74754910, "body": "You have two options in here, one is use pointer for fields, the second is encapsulate the <code>Options</code> struct and generate <code>Get</code> and <code>Set</code> methods for the fields that record/check if is set."}], "answers": [{"tags": [], "owner": {"reputation": 464, "user_id": 6135914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnNc6.jpg?s=128&g=1", "display_name": "JT.", "link": "https://stackoverflow.com/users/6135914/jt"}, "is_accepted": false, "score": 1, "last_activity_date": 1494267341, "creation_date": 1494267341, "answer_id": 43854626, "question_id": 43854117, "link": "https://stackoverflow.com/questions/43854117/detecting-uninitialized-struct-fields/43854626#43854626", "title": "Detecting uninitialized struct fields", "body": "<p>The default value for a bool is false. If you notice that you are overwriting the options value to true every time you run the code. </p>\n\n<p>The default values of a strings variable is \"\". So if check the string with <code>len(opts.StringOption) == 0</code> or <code>opts.StringOption == \"\"</code> that would work as well.</p>\n\n<p><a href=\"https://play.golang.org/p/jifZZvoBVZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/jifZZvoBVZ</a></p>\n"}, {"comments": [{"owner": {"reputation": 2577, "user_id": 3512709, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sA5RZ.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3512709/adam"}, "edited": false, "score": 0, "creation_date": 1494347553, "post_id": 43856941, "comment_id": 74785506, "body": "Thanks for this. I think the only other option, as @Olivia Ruth points out, I could use a pointer inside by options struct and check for nil."}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": true, "score": 4, "last_activity_date": 1494369880, "last_edit_date": 1494369880, "creation_date": 1494276127, "answer_id": 43856941, "question_id": 43854117, "link": "https://stackoverflow.com/questions/43854117/detecting-uninitialized-struct-fields/43856941#43856941", "title": "Detecting uninitialized struct fields", "body": "<p>For <strong>detecting</strong> uninitialized struct fields, as a rule certain types have <strong>zero values</strong>, they are otherwise <strong><code>nil</code></strong> (maps and channels need to be <code>make</code>d):</p>\n\n<pre><code>var i int     // i = 0\nvar f float64 // f = 0\nvar b bool    // b = false\nvar s string  // s = \"\"\nvar m chan int// c = nil\n</code></pre>\n\n<p>There is a <a href=\"https://tour.golang.org/basics/12\" rel=\"nofollow noreferrer\">tour</a> slide which is useful.</p>\n\n<p>I think you're problem involves creating a <strong>default boolean value of true</strong></p>\n\n<hr>\n\n<p>For your sake, however, if you are passing an <code>Option</code> struct into that function, and the user did not specify the options, then <strong>yes</strong> they will be <code>false</code> and <code>\"\"</code> by default. </p>\n\n<p><strong>One solution</strong> is to create a(nother) constructor: <code>func NewOptions(b bool, s string) Options</code></p>\n\n<p>This constructor would make the bool default <code>true</code>.</p>\n\n<p>You could also try an enum to simulate a boolean; the <strong>zero value</strong> will be <code>0</code>. So instead of <code>type bool</code> for the <code>Options</code> struct value <code>BoolOption</code>, you could use <code>int</code>:</p>\n\n<pre><code>const (\n        TRUE\n        FALSE\n)\n</code></pre>\n\n<p>You could also have a <code>UNINITIALIZED</code> as zero, but I think you just want to switch the default value, rather than detecting that it is uninitialized.</p>\n\n<p>So when checking a value of <code>Options</code>, you could write:</p>\n\n<pre><code>if opt.BoolOption == FALSE {\n    // Do something with the option\n} else {\n    // The default option\n}\n</code></pre>\n\n<hr>\n\n<p>A bit simpler would be to make the <code>BoolOption</code> into <code>notBoolOption</code>, and have the default be false.</p>\n\n<hr>\n\n<p>Or, as Olivia Ruth points out, if you have the field as a pointer to a boolean, it will be remain <code>nil</code> until \"initialized\".</p>\n"}], "owner": {"reputation": 2577, "user_id": 3512709, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sA5RZ.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3512709/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2611, "favorite_count": 0, "accepted_answer_id": 43856941, "answer_count": 2, "score": 4, "last_activity_date": 1494369880, "creation_date": 1494265647, "question_id": 43854117, "link": "https://stackoverflow.com/questions/43854117/detecting-uninitialized-struct-fields", "title": "Detecting uninitialized struct fields", "body": "<p>I have a service, written in golang, that can be initialized with some options. Options are passed as a struct to a constructor function. The constructor function uses default values for option fields that weren't included. Here's an example:</p>\n\n<pre><code>type Service struct {\n  options Options\n}\n\ntype Options struct {\n  BoolOption bool\n  StringOption string\n}\n\nconst (\n  DefaultBoolOption = true\n  DefaultStringOption = \"bar\"\n)\n\nfunc New(opts Options) *Service {\n  if !opts.BoolOption {\n    opts.BoolOption = DefaultBoolOption\n  }\n\n  if len(opts.StringOption) &lt; 1 {\n    opts.StringOption = DefaultStringOption\n  }\n\n  return &amp;Service{options: opts,}\n}\n\n...\n\n// elsewhere in my code\no := Options{BoolOption: false,}\n\n// sets s.options.BoolOption to true!!!\ns := New(o)\n</code></pre>\n\n<p>My problem is that for <code>bool</code> or <code>int</code> option types, I can't tell whether or not a field value was set in the Options struct. For example, was <code>BoolOption</code> set to false or just not initialized?</p>\n\n<p>One possible solution would be to use strings for all of my Options fields. For instance, <code>BoolOption</code> would be <code>\"false\"</code> rather than <code>false</code>. I could then check the length of the string to check if it was initialized.</p>\n\n<p>Are there better solutions?</p>\n"}, {"tags": ["go", "dll"], "comments": [{"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "edited": false, "score": 0, "creation_date": 1494368771, "post_id": 43853778, "comment_id": 74796560, "body": "It is safe. <a href=\"https://www.quora.com/Go-programming-language-What-happens-when-a-goroutine-blocks\" rel=\"nofollow noreferrer\">quora.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8030351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dd237e0b81f61fe926250bf171479b?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon S", "link": "https://stackoverflow.com/users/8030351/brandon-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1495105914, "creation_date": 1495105914, "answer_id": 44046168, "question_id": 43853778, "link": "https://stackoverflow.com/questions/43853778/calling-a-blocking-dll-function-from-a-goroutine/44046168#44046168", "title": "Calling a blocking DLL function from a goroutine?", "body": "<p>Then you make syscall all os thread locks and waits the syscall end. All other threads works well.</p>\n\n<p>For better concurrency you can use <a href=\"https://golang.org/pkg/runtime/#LockOSThread\" rel=\"nofollow noreferrer\">runtime.LockOSThread()</a> to move out all goroutines from current os thread. </p>\n"}], "owner": {"reputation": 61, "user_id": 407793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51aabecbf3242170e71e5f962ac69958?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/407793/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1495105914, "creation_date": 1494264522, "question_id": 43853778, "link": "https://stackoverflow.com/questions/43853778/calling-a-blocking-dll-function-from-a-goroutine", "title": "Calling a blocking DLL function from a goroutine?", "body": "<p>I'm writing a Go program for Windows that will call into a C DLL that I wrote and built separately.  The C function will run an event loop that spends spend most of its time in a blocking system call.</p>\n\n<p>The goroutine looks like this:\n1) Load the DLL\n2) Find the function by name\n3) call it, which will return only when I'm shutting down the process.</p>\n\n<p>I know goroutines aren't \"real\" threads but is it safe to treat it as one in this case?  So far this program seems to do exactly what I want it to but I'm a little worried the goroutine scheduler is going to bite me at some point.</p>\n\n<p>Is this safe?  Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494263949, "post_id": 43853506, "comment_id": 74742889, "body": "What&#39;s the syntax error?  Have you tried running the query at console (which usually tells you <i>where</i> the error is)?  What variant of SQL are you running (MySQL, Postgres, etc)?"}, {"owner": {"reputation": 29, "user_id": 7297164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vSPLm.gif?s=128&g=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/7297164/rocky"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494313404, "post_id": 43853506, "comment_id": 74761645, "body": "It&#39;s mssql query working on SQL Management Studio/Console but not working with golang getting a syntax error on this sql query."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494339560, "post_id": 43859457, "comment_id": 74779869, "body": "Alternatively, you can use backticks to annotate a string literal.  New lines are treated properly in such a case.  It also avoids the performance issues that come when concatenating a boatload of strings."}, {"owner": {"reputation": 365, "user_id": 243523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1221cdb730309b19a2dd8d70826c035a?s=128&d=identicon&r=PG", "display_name": "TehCorwiz", "link": "https://stackoverflow.com/users/243523/tehcorwiz"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494339741, "post_id": 43859457, "comment_id": 74780003, "body": "@Kaedys True, that also preserves all line breaks newlines which is something to be aware of. SQL isn&#39;t particularly sensitive to whitespace, but it&#39;s good to keep in mind."}], "tags": [], "owner": {"reputation": 365, "user_id": 243523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1221cdb730309b19a2dd8d70826c035a?s=128&d=identicon&r=PG", "display_name": "TehCorwiz", "link": "https://stackoverflow.com/users/243523/tehcorwiz"}, "is_accepted": true, "score": 5, "last_activity_date": 1494339921, "last_edit_date": 1494339921, "creation_date": 1494291904, "answer_id": 43859457, "question_id": 43853506, "link": "https://stackoverflow.com/questions/43853506/golang-sql-query-syntax/43859457#43859457", "title": "Golang SQL Query Syntax", "body": "<p>Your SQL statement is on multiple lines, but you're not using the correct multi-line syntax. The correct syntax would be:</p>\n\n<pre><code>someLongString := \"Line 1 \" +    // Don't forget the trailing space\n                  \"Second line.\" // This is on the next line.\n</code></pre>\n\n<p>Currently you're just trying to stuff everything between a set of quotes on different lines.</p>\n\n<hr>\n\n<p>EDIT: Per as @Kaedys says below, the following also works and may be more performant.</p>\n\n<pre><code>someLongString := `Line 1\n                   Second line.`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 8096201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lTPId.png?s=128&g=1", "display_name": "Nevercare", "link": "https://stackoverflow.com/users/8096201/nevercare"}, "is_accepted": false, "score": 0, "last_activity_date": 1497675880, "creation_date": 1497675880, "answer_id": 44600970, "question_id": 43853506, "link": "https://stackoverflow.com/questions/43853506/golang-sql-query-syntax/44600970#44600970", "title": "Golang SQL Query Syntax", "body": "<p>change both your first and last \"\\\"\" to \"`\", or quote your each line of the query string and then add a \"+\" between each line like </p>\n\n<pre><code>\"select\" +\n\" *\" +\n\" from\" +\n\" table\"\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7297164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vSPLm.gif?s=128&g=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/7297164/rocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1170, "favorite_count": 0, "closed_date": 1520589841, "accepted_answer_id": 43859457, "answer_count": 2, "score": -8, "last_activity_date": 1497675880, "creation_date": 1494263485, "last_edit_date": 1494312748, "question_id": 43853506, "link": "https://stackoverflow.com/questions/43853506/golang-sql-query-syntax", "closed_reason": "Not suitable for this site", "title": "Golang SQL Query Syntax", "body": "<p>Getting syntax erro with sql query in golang code. Required proper syntax for this SQL query in golang: </p>\n\n<pre><code>rows, errQuery := dbCon.Query(\"SELECT B.LatestDate\n    ,A.SVRName AS ServerName\n    ,A.DRIVE\n,A.TotalSpace_GB AS TotalSpaceGB\n,(ISNULL(A.TotalSpace_GB, 0) - ISNULL(A.FreeSpace_GB, 0)) AS \n UsedSpaceGB\n,A.FreeSpace_GB AS FreeSpaceGB\n,CASE \nWHEN ((A.FreeSpace_GB / A.TotalSpace_GB) * 100)  between 25 and \n35\nTHEN 1\nWHEN ((A.FreeSpace_GB / A.TotalSpace_GB) * 100) &lt;= 25   THEN 2\nELSE 0\nEND AS WARNINGSTATUS\n    FROM Table_ServerDiskSpaceDetails A WITH (NOLOCK)\n    INNER JOIN (\nSELECT SVRName\n,MAX(Dt) LatestDate\nFROM Table_ServerDiskSpaceDetails WITH (NOLOCK)\nGROUP BY SVRName\n) B ON A.Dt = B.LatestDate\nAND A.SVRName = B.SVRName\n    ORDER BY WARNINGSTATUS DESC\n,ServerName\n,A.Drive\")\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 3763112, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/bea14956d83fe906ba4bafcea761250d?s=128&d=identicon&r=PG&f=1", "display_name": "Angger", "link": "https://stackoverflow.com/users/3763112/angger"}, "edited": false, "score": 0, "creation_date": 1494371820, "post_id": 43853523, "comment_id": 74797427, "body": "Many thanks!. Btw. how do I perform looping in static page?"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 545, "user_id": 3763112, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/bea14956d83fe906ba4bafcea761250d?s=128&d=identicon&r=PG&f=1", "display_name": "Angger", "link": "https://stackoverflow.com/users/3763112/angger"}, "edited": false, "score": 0, "creation_date": 1494372208, "post_id": 43853523, "comment_id": 74797521, "body": "{{range .SomeList}} ... {{.SomeField}} ... {{end}}"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 1, "last_activity_date": 1494263536, "creation_date": 1494263536, "answer_id": 43853523, "question_id": 43853442, "link": "https://stackoverflow.com/questions/43853442/passing-value-to-static-page-golang/43853523#43853523", "title": "Passing value to static page Golang", "body": "<p>A common approach it to make <code>sayName.html</code> an <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\"><code>html/template</code></a>, and execute it on each request. </p>\n\n<p>Then your handler is something like:</p>\n\n<pre><code>func templateHandler(w http.ResponseWriter, r *http.Request){\n   tplTxt,err := ioutil.ReadFile(...)\n   //error handling\n   tpl := template.Must(template.New(\"\").Parse(string(tplTxt)))\n   templateData := map[string]interface{}{\"Name\":\"Jon Snow\"}\n   tpl.Execute(w, templateData)\n}\n</code></pre>\n\n<p>And your html template can use <code>{{.Name}}</code> to insert the name.</p>\n\n<p>You should cache the parsed templates and handle errors better, but thats the general idea.</p>\n"}], "owner": {"reputation": 545, "user_id": 3763112, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/bea14956d83fe906ba4bafcea761250d?s=128&d=identicon&r=PG&f=1", "display_name": "Angger", "link": "https://stackoverflow.com/users/3763112/angger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 43853523, "answer_count": 1, "score": 1, "last_activity_date": 1494263536, "creation_date": 1494263270, "question_id": 43853442, "link": "https://stackoverflow.com/questions/43853442/passing-value-to-static-page-golang", "title": "Passing value to static page Golang", "body": "<p>I'm new to Golang. how to I pass value to static page?</p>\n\n<p>suppose I have this code :</p>\n\n<pre><code>// webtes project main.go\npackage main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n\n    http.HandleFunc(\"/sayName\", func(writer http.ResponseWriter, r *http.Request) {\n        name := \"Jon Snow\"\n        http.ServeFile(writer, r, \"static/sayName.html\")/*How do I pass 'name' to this static page and print it?*/\n    })\n\n    log.Fatal(http.ListenAndServe(\":8081\", nil))\n}\n</code></pre>\n\n<p>static/sayName.html</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n   &lt;head&gt;&lt;/head&gt;\n   &lt;body&gt;{/*print name here*/}&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I want to pass \"name\" variable to the static page \"sayName.html\" and print that there. How do I achieve this? thks.</p>\n"}, {"tags": ["go", "http2"], "comments": [{"owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 0, "creation_date": 1494263606, "post_id": 43852955, "comment_id": 74742695, "body": "I know they recently had a blog post (<a href=\"https://blog.golang.org/h2push\" rel=\"nofollow noreferrer\">blog.golang.org/h2push</a>) about server push, but I haven&#39;t seen anything about client yet. As I understand it H2 push works by pushing a response (by manufacturing a request and including that request and response together) to a client that stores the response directly in its cache. The result is that when the client makes the request rather than going over the network it refers to its local cache. This is expected to be built in to browsers that support h2, whether or not the language&#39;s http client supports it natively would require some digging."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 0, "creation_date": 1494263731, "post_id": 43852955, "comment_id": 74742767, "body": "Right. I don&#39;t actually need client support for receiving pushes, I just need to really validate that &quot;If I was a browser, the server is configured to push these things properly&quot;"}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1494269811, "post_id": 43852955, "comment_id": 74746159, "body": "Looking at the <a href=\"https://github.com/golang/net/blob/77412025ac6f6821b4938edeb45af939de5cccec/http2/server_push_test.go\" rel=\"nofollow noreferrer\">test suite</a> it appears as though private methods (e.g. decodeHeader) are required to actually get at that data, and <a href=\"https://github.com/golang/go/issues/18594\" rel=\"nofollow noreferrer\">there isn&#39;t much discussion about a proper client API</a>."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1494270173, "post_id": 43852955, "comment_id": 74746373, "body": "That&#39;s a bit disheartening @nothingmuch. Maybe the answer is &quot;sometime in the future&quot;?"}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1494270677, "post_id": 43852955, "comment_id": 74746661, "body": "Perhaps your case is a good motivating example to encourage progress on that front? I would encourage you participate in the discussion, since your test case seems like a very elementary thing to try to verify when starting to use that kind of feature, I think it&#39;s worth bringing up.  Another idea is to use something like <a href=\"https://github.com/molnarg/node-http2/blob/master/example/client.js\" rel=\"nofollow noreferrer\">node-http2</a>, it&#39;d be pretty easy to call out to that from a Go test I suppose though I&#39;m not sure if it&#39;s worth the headache of having another dev stack even if opportunistically."}], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494864186, "post_id": 43900205, "comment_id": 74997237, "body": "A nice start. I&#39;d hate to have to fork std lib to do this though. Perhaps I&#39;ll nudge that issue a bit."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 4, "last_activity_date": 1494441070, "creation_date": 1494441070, "answer_id": 43900205, "question_id": 43852955, "link": "https://stackoverflow.com/questions/43852955/how-can-i-read-http-2-push-frames-from-a-net-http-request/43900205#43900205", "title": "How can I read HTTP/2 push frames from a net/http request", "body": "<p>Using the Framer in golang.org/x/net/http2 isn't hard, if we can get a copy of the bytes that are read naturally by the http.Client. We can do that by implementing our own net.Conn.</p>\n\n<p>I made some progress with the program below, however I did not see the expected PUSH_PROMISE frames. After some digging around I found that <a href=\"https://github.com/golang/go/blob/go1.8.1/src/net/http/h2_bundle.go#L5864\" rel=\"nofollow noreferrer\">the Go client explicitly disables Push</a>.  Servers are not allowed to send those frames in this case. I don't see an obvious way to change that setting (short of hacking the stdlib).</p>\n\n<p>Thought I still share my code. Perhaps I missed something simple to make it work after all.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/tls\"\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"os\"\n\n    \"golang.org/x/net/http2\"\n)\n\nfunc main() {\n    buf := &amp;bytes.Buffer{}\n    transport := &amp;http2.Transport{DialTLS: dialT(buf)}\n    client := &amp;http.Client{Transport: transport}\n\n    res, err := client.Get(\"https://http2-push.appspot.com/\")\n    if err != nil {\n            log.Fatal(err)\n    }\n\n    res.Body.Close()\n    res.Write(os.Stdout)\n\n    framer := http2.NewFramer(ioutil.Discard, buf)\n    for {\n            f, err := framer.ReadFrame()\n            if err == io.EOF || err == io.ErrUnexpectedEOF {\n                    break\n            }\n            switch err.(type) {\n            case nil:\n                    log.Println(f)\n            case http2.ConnectionError:\n                    // Ignore. There will be many errors of type \"PROTOCOL_ERROR, DATA\n                    // frame with stream ID 0\". Presumably we are abusing the framer.\n            default:\n                    log.Println(err, framer.ErrorDetail())\n            }\n    }\n}\n\n// dialT returns a connection that writes everything that is read to w.\nfunc dialT(w io.Writer) func(network, addr string, cfg *tls.Config) (net.Conn, error) {\n    return func(network, addr string, cfg *tls.Config) (net.Conn, error) {\n            conn, err := tls.Dial(network, addr, cfg)\n            return &amp;tConn{conn, w}, err\n    }\n}\n\ntype tConn struct {\n    net.Conn\n    T io.Writer // receives everything that is read from Conn\n}\n\nfunc (w *tConn) Read(b []byte) (n int, err error) {\n    n, err = w.Conn.Read(b)\n    w.T.Write(b)\n    return\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "edited": false, "score": 0, "creation_date": 1516107055, "post_id": 48014107, "comment_id": 83546882, "body": "Go1.10 is frozen, this might make it for Go1.11"}], "tags": [], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "is_accepted": false, "score": 1, "last_activity_date": 1514493664, "creation_date": 1514493664, "answer_id": 48014107, "question_id": 43852955, "link": "https://stackoverflow.com/questions/43852955/how-can-i-read-http-2-push-frames-from-a-net-http-request/48014107#48014107", "title": "How can I read HTTP/2 push frames from a net/http request", "body": "<p>A <a href=\"https://go-review.googlesource.com/c/net/+/85577\" rel=\"nofollow noreferrer\">patch</a> was submitted for review.</p>\n\n<p>\"http2: support consuming PUSH_PROMISE streams in the client\" </p>\n\n<p>(The github issue has milestone \"Unplanned\", which hopefully won't give it significantly less priority in the review queue.)</p>\n"}], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1855, "favorite_count": 3, "answer_count": 2, "score": 9, "last_activity_date": 1514493664, "creation_date": 1494261687, "question_id": 43852955, "link": "https://stackoverflow.com/questions/43852955/how-can-i-read-http-2-push-frames-from-a-net-http-request", "title": "How can I read HTTP/2 push frames from a net/http request", "body": "<p>I am trying to write a Go client to test our http/2 infrastructure. I would like to make an http request to <code>https://mydomain.tld/somePage</code> and expect to receive an html response, along with several pushed resources. I would like to ensure those pushes are successful, and fail if they are not.</p>\n\n<p>It is not clear to me if any part of the standard library exposes this functionality I need.</p>\n\n<p>I can look at the response and check the protocol version to detect http2. </p>\n\n<p>I can see <code>Link</code> headers in responses from sites like <a href=\"https://http2-push.appspot.com/\" rel=\"noreferrer\">https://http2-push.appspot.com/</a> that send pushes, but I'm not quite clear on the relationship between Link headers and actual Push Promise frames. You can get link headers over http 1.1, so I'm not sure that alone ensures a push will happen.</p>\n\n<p>The <a href=\"https://godoc.org/golang.org/x/net/http2\" rel=\"noreferrer\">http2 package</a> has a lower level <a href=\"https://godoc.org/golang.org/x/net/http2#Framer\" rel=\"noreferrer\"><code>Framer</code></a> interface that I may be able to leverage to verify the raw frames, but honestly, I have no idea how to set one up and issue the initial request to it. </p>\n\n<p>Is there any example of how a go client can verify the proper configuration of http2 pushed resources?</p>\n"}, {"tags": ["arrays", "string", "go"], "answers": [{"tags": [], "owner": {"reputation": 35869, "user_id": 7512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d064a7aca29011d3246302b27c41f4d9?s=128&d=identicon&r=PG", "display_name": "slim", "link": "https://stackoverflow.com/users/7512/slim"}, "is_accepted": false, "score": 1, "last_activity_date": 1494260819, "last_edit_date": 1494260819, "creation_date": 1494260507, "answer_id": 43852617, "question_id": 43852529, "link": "https://stackoverflow.com/questions/43852529/how-are-strings-stored-in-a-go-array/43852617#43852617", "title": "How are strings stored in a GO array?", "body": "<p>In Go, a string is a fixed-length struct containing a length and a pointer to a byte array.</p>\n\n<p>So <code>var a [2]string</code> allocates an array with space for two such structs.</p>\n\n<p><code>a[0] = \"Hello\"</code> allocates another array to store \"Hello\", and puts a pointer to this, and a length into <code>a[0]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 65147, "user_id": 90308, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7b7aefbc459629eb4c864b825894c9c4?s=128&d=identicon&r=PG", "display_name": "FogleBird", "link": "https://stackoverflow.com/users/90308/foglebird"}, "is_accepted": false, "score": 1, "last_activity_date": 1494260623, "creation_date": 1494260623, "answer_id": 43852653, "question_id": 43852529, "link": "https://stackoverflow.com/questions/43852529/how-are-strings-stored-in-a-go-array/43852653#43852653", "title": "How are strings stored in a GO array?", "body": "<p>Strings are like read-only slices of bytes. So the reason this code works is because the array need only allocate space for a pointer and some metadata (the length of the string).</p>\n\n<p>See the section on Strings here (at the bottom):</p>\n\n<p><a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">https://blog.golang.org/slices</a></p>\n"}], "owner": {"reputation": 9, "user_id": 6476990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cead3f0c352142f0f0f389b6ebb822cb?s=128&d=identicon&r=PG&f=1", "display_name": "orrios", "link": "https://stackoverflow.com/users/6476990/orrios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1494261257, "creation_date": 1494260233, "last_edit_date": 1494261257, "question_id": 43852529, "link": "https://stackoverflow.com/questions/43852529/how-are-strings-stored-in-a-go-array", "title": "How are strings stored in a GO array?", "body": "<p>Following the tour of GO, I encountered the following code:</p>\n\n<pre><code>var a [2]string\na[0] = \"Hello\"\na[1] = \"World\"\n</code></pre>\n\n<p>So, an array's length is inmutable and set when the array is declared. But then you can store strings of any size in it.</p>\n\n<p>Why can you do this?</p>\n"}, {"tags": ["go", "types", "casting"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1494260503, "post_id": 43852418, "comment_id": 74740865, "body": "I&#39;ll wager the confusion is due to the implicit typing of following constants <i>if you don&#39;t assign them a value</i>, as in this example: <a href=\"https://play.golang.org/p/0rCHhMN6vv\" rel=\"nofollow noreferrer\">play.golang.org/p/0rCHhMN6vv</a>"}, {"owner": {"reputation": 3279, "user_id": 1493534, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WIQKD.jpg?s=128&g=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/1493534/rakesh"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494263528, "post_id": 43852418, "comment_id": 74742645, "body": "@Kaedys Yup that is what confused me."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user184968"}, "is_accepted": true, "score": 3, "last_activity_date": 1494260675, "last_edit_date": 1494260675, "creation_date": 1494259850, "answer_id": 43852418, "question_id": 43852232, "link": "https://stackoverflow.com/questions/43852232/golang-not-able-to-detect-implicitly-typed-const-when-assigning-to-a-variable/43852418#43852418", "title": "Golang not able to detect implicitly typed const when assigning to a variable", "body": "<p><code>Second</code> is an untyped const and has this property (<a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">https://blog.golang.org/constants</a>):</p>\n\n<blockquote>\n  <p>An untyped constant is just a value, one not yet given a defined type\n  that would force it to obey the strict rules that prevent combining\n  differently typed values.\n  ...\n  Assigning them to a variable of any type compatible with strings works\n  without error.</p>\n</blockquote>\n\n<p>On the contrary <code>out</code> is a  variable of type string. Again from the blog post:</p>\n\n<blockquote>\n  <p>and by now you might be asking, \"if the constant is untyped, how does\n  str get a type in this variable declaration?\" The answer is that an\n  untyped constant has a default type, an implicit type that it\n  transfers to a value if a type is needed where none is provided. For\n  untyped string constants, that default type is obviously string</p>\n</blockquote>\n"}], "owner": {"reputation": 3279, "user_id": 1493534, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WIQKD.jpg?s=128&g=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/1493534/rakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 43852418, "answer_count": 1, "score": 0, "last_activity_date": 1494263822, "creation_date": 1494259227, "last_edit_date": 1494263822, "question_id": 43852232, "link": "https://stackoverflow.com/questions/43852232/golang-not-able-to-detect-implicitly-typed-const-when-assigning-to-a-variable", "title": "Golang not able to detect implicitly typed const when assigning to a variable", "body": "<p>When I try to assign an implicitly typed constant to a variable, the assigned variable doesn't detect the custom type and instead gets assigned as the underlying primitive type. i.e;\nFor:</p>\n\n<pre><code>type Custom string\nconst (\n    First Custom = \"10\"\n    Second = \"20\"\n)\n</code></pre>\n\n<p>If I have a function: </p>\n\n<pre><code>func SomeFunc( x Custom) {\n    fmt.Printf(\"Inside func %v %v\", x, reflect.TypeOf(x))\n}\n</code></pre>\n\n<p>Then when I:</p>\n\n<pre><code>out := Second\nSomeFunc(out)\n</code></pre>\n\n<p>it errors with:</p>\n\n<blockquote>\n  <p>cannot use out (type string) as type Custom in argument to SomeFunc</p>\n</blockquote>\n\n<p>However <code>SomeFunc(Second)</code> works fine.</p>\n\n<p>Also</p>\n\n<pre><code>fmt.Printf(\"%v %v\\n\",reflect.TypeOf(second),reflect.TypeOf(out)) //prints string string\n</code></pre>\n\n<p>Here is the reproducer: <a href=\"https://play.golang.org/p/Iv-C1ee992\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Iv-C1ee992</a></p>\n\n<p>Can someone help me understand what is happening here?</p>\n"}, {"tags": ["go", "intellij-idea", "delve"], "owner": {"reputation": 113, "user_id": 1007231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b721319b7a852eff5bb3a2ca459b2d47?s=128&d=identicon&r=PG", "display_name": "user1007231", "link": "https://stackoverflow.com/users/1007231/user1007231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1494258119, "creation_date": 1494258119, "question_id": 43851853, "link": "https://stackoverflow.com/questions/43851853/intellij-2017-1-2-golang-debug-does-not-work-on-breakpoints-in-packages", "title": "IntelliJ 2017.1.2 GOLANG debug does not work on breakpoints in packages", "body": "<p>My application is made up of one main.go file and a handful of packages. When hitting breakpoints within the main.go, IntelliJ works as expected, showing variable values etc., however, when a breakpoint is set in a different package - aside from it being hit, no variables are shown and step over/in features do not work as expected (ignored when hit). Has anyone run into this issue and if so is there a workaround?</p>\n"}, {"tags": ["json", "validation", "go", "swagger", "swagger-2.0"], "answers": [{"tags": [], "owner": {"reputation": 1159, "user_id": 23418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39a948a58f4569c53d971c2e120920?s=128&d=identicon&r=PG", "display_name": "Casual Jim", "link": "https://stackoverflow.com/users/23418/casual-jim"}, "is_accepted": true, "score": 2, "last_activity_date": 1494257623, "creation_date": 1494257623, "answer_id": 43851668, "question_id": 43851176, "link": "https://stackoverflow.com/questions/43851176/how-do-i-validate-an-instance-of-json-schema-against-a-swagger-schema/43851668#43851668", "title": "How do I validate an instance of JSON schema against a swagger schema?", "body": "<p>You need to get a hold of the schema that defines your validation rules, that's typically stored in the swagger spec definition property.</p>\n\n<p>And you need to get your model (json data structure, can be a map or a struct).\nHere's an example: </p>\n\n<pre><code>var model models.User\njson.Unmarshal(bytes, &amp;model)\n\nvar spec *spec.Swagger = getSpec()\nschema := spec.Definitions[\"User\"]\n\nif err := validate.AgainstSchema(schema, &amp;model, strfmt.Default); err != nil {\n  return err\n}\n</code></pre>\n"}], "owner": {"reputation": 2904, "user_id": 5832720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb8ed71cd77d9da995685ca872b303e7?s=128&d=identicon&r=PG", "display_name": "Nikhita Raghunath", "link": "https://stackoverflow.com/users/5832720/nikhita-raghunath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 43851668, "answer_count": 1, "score": 0, "last_activity_date": 1494257623, "creation_date": 1494256237, "question_id": 43851176, "link": "https://stackoverflow.com/questions/43851176/how-do-i-validate-an-instance-of-json-schema-against-a-swagger-schema", "title": "How do I validate an instance of JSON schema against a swagger schema?", "body": "<p>I have a JSON payload (request or response) and I want to validate that instance against a swagger schema that I have. How do I do that?</p>\n\n<p>Please note that I am not trying to validate if my spec is an OpenAPI/Swagger spec.</p>\n\n<p>I'd like to achieve this without the use of external JSON validators. I am also trying to achieve this in Go (specifically go-openapi)</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["mysql", "sql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1494250083, "post_id": 43848535, "comment_id": 74733831, "body": "maybe stupid question  but why do you use binary for <code>user_id</code>? why dot you use something like <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Universally_unique_identifier</a>?"}, {"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1494250183, "post_id": 43848535, "comment_id": 74733913, "body": "i can see here <a href=\"http://stackoverflow.com/questions/15130321/is-there-a-method-to-generate-a-uuid-with-go-language\" title=\"is there a method to generate a uuid with go language\">stackoverflow.com/questions/15130321/&hellip;</a> that is really easy to generate that."}, {"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1494250254, "post_id": 43848535, "comment_id": 74733966, "body": "i am always using that, but my best guess that all depend on database. I can see that you have <code>id</code> and then <code>user_id</code>, why do you have <code>user_id</code> at all?"}, {"owner": {"reputation": 366, "user_id": 3153830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WWne5.png?s=128&g=1", "display_name": "Joshua Lawson", "link": "https://stackoverflow.com/users/3153830/joshua-lawson"}, "reply_to_user": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 1, "creation_date": 1494250606, "post_id": 43848535, "comment_id": 74734207, "body": "Mysql does not have a uuid field. Gorm generated the id column itself. I want a uuid column and will look into removing the gorm generated columns if need be..."}, {"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1494251024, "post_id": 43848535, "comment_id": 74734514, "body": "I have asked you why you have <code>user_id</code> at all if your primary key in users table is <code>id</code>? And you should consider renaming your table to <code>user</code> since it is one model. Take a look at here <a href=\"http://stackoverflow.com/questions/338156/table-naming-dilemma-singular-vs-plural-names\" title=\"table naming dilemma singular vs plural names\">stackoverflow.com/questions/338156/&hellip;</a>. having <code>id</code> as primary and <code>user_id</code> as far as i can see it is completely redundant."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494253679, "post_id": 43848535, "comment_id": 74736316, "body": "The way it&#39;s written, there&#39;s inconsistent behavior; when you insert a new user, if their ID is nil, you set it, manually marshal it, and pass it directly to GORM. In any other case, you let GORM figure it out for itself. I&#39;d think BeforeCreate would either only set the ID if it&#39;s nil, and let GORM handle marshaling, or it would marshal the value and call <code>scope.SetColumn</code> outside the if block, so that it behaves the same whether or not the ID was set. Not sure if it&#39;s relevant to your issue but it could be a confounding factor."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494253744, "post_id": 43848535, "comment_id": 74736347, "body": "How if you change the len of <code>user_id</code> (for debugging purpose, e.g. set it to 100 --&gt; <code>user_id BINARY(100) NOT NULL</code>) then observe the result. If no error, then look at the content of <code>user_id</code> which was saved to MySQL."}, {"owner": {"reputation": 366, "user_id": 3153830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WWne5.png?s=128&g=1", "display_name": "Joshua Lawson", "link": "https://stackoverflow.com/users/3153830/joshua-lawson"}, "edited": false, "score": 0, "creation_date": 1494280146, "post_id": 43848535, "comment_id": 74751359, "body": "When I change the length to 100 it inserts fine"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494281800, "post_id": 43848535, "comment_id": 74751899, "body": "Now take a look at <code>user_id</code> record in MySQL, what was added to the record which causing the length exceed 16-bytes?"}], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 2019791, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6cffa15ceb7bf5309370bdf529c2ee5d?s=128&d=identicon&r=PG", "display_name": "NeXtMaN_786", "link": "https://stackoverflow.com/users/2019791/nextman-786"}, "edited": false, "score": 0, "creation_date": 1547232205, "post_id": 43858941, "comment_id": 95135608, "body": "based on this issue <a href=\"https://github.com/jinzhu/gorm/issues/1687\" rel=\"nofollow noreferrer\">github.com/jinzhu/gorm/issues/1687</a> jinzhu advises against using []byte as the type"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 471, "user_id": 2019791, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6cffa15ceb7bf5309370bdf529c2ee5d?s=128&d=identicon&r=PG", "display_name": "NeXtMaN_786", "link": "https://stackoverflow.com/users/2019791/nextman-786"}, "edited": false, "score": 1, "creation_date": 1547420089, "post_id": 43858941, "comment_id": 95176904, "body": "@NeXtMaN_786 The question is specifically for MySQL which AFAIK doesn&#39;t have UUID column type. The issue you&#39;ve mention is for PostgreSQL which has UUID data type for its column, and is also being supported by the Go driver. In the later case, I agree that we should not use <code>[]byte</code> to store GUID in Golang."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 4, "last_activity_date": 1494287661, "creation_date": 1494287661, "answer_id": 43858941, "question_id": 43848535, "link": "https://stackoverflow.com/questions/43848535/gorm-uuid-too-long/43858941#43858941", "title": "GORM UUID too long", "body": "<p>I think the problem is in the definition of model <code>User</code>. To save the GUID as 16-bytes binary, you need to define the <code>UserID</code> column as <code>[]byte</code> not <a href=\"https://godoc.org/github.com/satori/go.uuid#UUID\" rel=\"nofollow noreferrer\"><code>uuid.UUID</code></a>.</p>\n\n<pre><code>type User struct {\n    //other fields ..\n    UserID    []byte\n\n    //other fields ...\n}\n\nfunc (u *User) BeforeCreate(scope *gorm.Scope) (err error) {\n    if u.UserID == nil {\n        uuid, err := uuid.NewV4().MarshalBinary()\n        scope.SetColumn(\"user_id\", uuid)\n    }\n    return nil\n}\n</code></pre>\n\n<p>If you define the field as <code>uuid.UUID</code>, <code>gorm</code> \"misinterpreted\" the field as string and then insert that string into the database as binary. For example, the following UUID,</p>\n\n<pre><code>uuid: 16ac369b-e57f-471b-96f6-1068ead0bf98\n//16-bytes equivalent\nbytes: [22 172 54 155 229 127 71 27 150 246 16 104 234 208 191 152]\n</code></pre>\n\n<p>will be inserted to database as the ASCII codes of the UUID which are</p>\n\n<pre><code>0x31 0x36 0x61 0x63 0x33 0x36 0x39 0x62 0x2D 0x65 ...\n('1' '6'  'a'  'c'  '3'  '6'  '9'  'b'  '-'  'e'  ...)\n</code></pre>\n\n<p>which are 36-bytes in length, thus you're getting <code>Error 1406: ...</code></p>\n"}], "owner": {"reputation": 366, "user_id": 3153830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WWne5.png?s=128&g=1", "display_name": "Joshua Lawson", "link": "https://stackoverflow.com/users/3153830/joshua-lawson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2452, "favorite_count": 0, "accepted_answer_id": 43858941, "answer_count": 1, "score": 2, "last_activity_date": 1494287661, "creation_date": 1494248955, "question_id": 43848535, "link": "https://stackoverflow.com/questions/43848535/gorm-uuid-too-long", "title": "GORM UUID too long", "body": "<p>Currently I am using GO-GORM for all of my database queries (mostly CRUD) and I am having some issues inserting a generated UUID into a MySQL database column.</p>\n\n<p>The column is a BINARY(16) as suggested in multiple blogs, the UUID is generated using github.com/satori/go.uuid package for Golang.</p>\n\n<p>I am using GORM's BeforeCreate hook to generate the UUID if one does not already exist on the user, the code that I am using is as follows:</p>\n\n<pre><code>func (u *User) BeforeCreate(scope *gorm.Scope) (err error) {\n    if u.UserID == uuid.Nil {\n        uuid, err := uuid.NewV4().MarshalBinary()\n        scope.SetColumn(\"user_id\", uuid)\n    }\n}\n</code></pre>\n\n<p>I have also used len to get the length that MarshalBinary outputs and it returns as 16.</p>\n\n<p>The error I get from GORM when trying to insert the UUID into MySQL is as follows:</p>\n\n<p><code>(Error 1406: Data too long for column 'user_id' at row 1)</code></p>\n\n<p>I have also fmt.Println(uuid) to see the results and they are also as follows (obviosuly changes as the UUID is generated every insert)</p>\n\n<p><code>[93 132 59 55 102 96 72 35 137 185 34 21 195 88 213 127]</code></p>\n\n<p>My MYSQL schema is as follows also:</p>\n\n<pre><code>CREATE TABLE users\n(\n    id INT(10) unsigned PRIMARY KEY NOT NULL AUTO_INCREMENT,\n    created_at TIMESTAMP,\n    updated_at TIMESTAMP,\n    deleted_at TIMESTAMP,\n    user_id BINARY(16) NOT NULL,\n    username VARCHAR(255) NOT NULL,\n    password VARCHAR(255),\n    firstname VARCHAR(255),\n    lastname VARCHAR(255),\n    email VARCHAR(255),\n    address_id VARCHAR(255)\n);\nCREATE INDEX idx_users_deleted_at ON users (deleted_at);\nCREATE UNIQUE INDEX username ON users (username);\nCREATE UNIQUE INDEX user_id ON users (user_id);\n</code></pre>\n\n<p>I have tried different methods and libraries to generate UUIDs and convert them to binary to insert with similar results.</p>\n"}, {"tags": ["go", "cobra", "viper-go"], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 335310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9dcc1333aab199ad9af952568a804b?s=128&d=identicon&r=PG", "display_name": "Ralf", "link": "https://stackoverflow.com/users/335310/ralf"}, "edited": false, "score": 3, "creation_date": 1503105263, "post_id": 43850691, "comment_id": 78492020, "body": "This approach works, but I think the question points towards a different problem that I did not figure out as well:  The OP uses <code>StringVar</code> as opposed to <code>StringP</code> to get the value set in the string pointer passed to it. Cobra &amp; Viper linked together don&#39;t seem to propagate values into those passed value pointers.   If anyone could provide a pointer how to make that work, feel free to post another answer."}], "tags": [], "owner": {"reputation": 2907, "user_id": 7357841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RJs6M9j2t9Q/AAAAAAAAAAI/AAAAAAAAAAA/f77YfS3xpcs/photo.jpg?sz=128", "display_name": "minamijoyo", "link": "https://stackoverflow.com/users/7357841/minamijoyo"}, "is_accepted": true, "score": 10, "last_activity_date": 1583289989, "last_edit_date": 1583289989, "creation_date": 1494254883, "answer_id": 43850691, "question_id": 43847791, "link": "https://stackoverflow.com/questions/43847791/why-is-cobra-not-reading-my-configuration-file/43850691#43850691", "title": "Why is Cobra not reading my configuration file?", "body": "<p>To combine <code>spf13/cobra</code> and <code>spf13/viper</code>, first define the flag with Cobra:</p>\n\n<pre><code>RootCmd.PersistentFlags().StringP(\"foo\", \"\", \"loaded from config\")\n</code></pre>\n\n<p>Bind it with Viper:</p>\n\n<pre><code>viper.BindPFlag(\"foo\", RootCmd.PersistentFlags().Lookup(\"foo\"))\n</code></pre>\n\n<p>And get the variable via the Viper's method:</p>\n\n<pre><code>fmt.Println(\"fooString is: \", viper.GetString(\"foo\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2541, "user_id": 371970, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/35122322d66164b170ef5c1b20ef99d1?s=128&d=identicon&r=PG", "display_name": "WGH", "link": "https://stackoverflow.com/users/371970/wgh"}, "is_accepted": false, "score": 2, "last_activity_date": 1530917378, "creation_date": 1530917378, "answer_id": 51218491, "question_id": 43847791, "link": "https://stackoverflow.com/questions/43847791/why-is-cobra-not-reading-my-configuration-file/51218491#51218491", "title": "Why is Cobra not reading my configuration file?", "body": "<p>Since Viper values are somewhat inferior to pflags (e.g. no support for custom data types), I was not satisfied with answer \"use Viper to retrieve values\", and ended up writing small helper type to put values back in pflags.</p>\n\n<pre><code>type viperPFlagBinding struct {\n        configName string\n        flagValue  pflag.Value\n}\n\ntype viperPFlagHelper struct {\n        bindings []viperPFlagBinding\n}\n\nfunc (vch *viperPFlagHelper) BindPFlag(configName string, flag *pflag.Flag) (err error) {\n        err = viper.BindPFlag(configName, flag)\n        if err == nil {\n                vch.bindings = append(vch.bindings, viperPFlagBinding{configName, flag.Value})\n        }\n        return\n}\n\nfunc (vch *viperPFlagHelper) setPFlagsFromViper() {\n        for _, v := range vch.bindings {\n                v.flagValue.Set(viper.GetString(v.configName))\n        }\n}\n\n\nfunc main() {\n        var rootCmd = &amp;cobra.Command{}\n        var viperPFlagHelper viperPFlagHelper\n\n        rootCmd.PersistentFlags().StringVar(&amp;config.Password, \"password\", \"\", \"API server password (remote HTTPS mode only)\")\n        viperPFlagHelper.BindPFlag(\"password\", rootCmd.Flag(\"password\"))\n\n        rootCmd.PersistentPreRunE = func(cmd *cobra.Command, args []string) error {\n                err := viper.ReadInConfig()\n                if err != nil {\n                        if _, ok := err.(viper.ConfigFileNotFoundError); !ok {\n                                return err\n                        }\n                }\n\n                viperPFlagHelper.setPFlagsFromViper()\n\n                return nil\n        }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 96, "user_id": 11361490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b17f7762d46ff0eb63dba7bf04456a9?s=128&d=identicon&r=PG&f=1", "display_name": "drFunJohn", "link": "https://stackoverflow.com/users/11361490/drfunjohn"}, "edited": false, "score": 0, "creation_date": 1608800961, "post_id": 60839834, "comment_id": 115688234, "body": "Ok, but root command in most cases does not have &quot;Run&quot; function and it means it will never been executed? I found what during debug ReadInConfig() is called from init() of root command is not completed before sub command is evaluated. During regular execution this works fine.  Do you suggest duplicate call of ReadInConfig in init() of each sub command?"}], "tags": [], "owner": {"reputation": 109, "user_id": 8175031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FmCU4.jpg?s=128&g=1", "display_name": "Mqll", "link": "https://stackoverflow.com/users/8175031/mqll"}, "is_accepted": false, "score": 4, "last_activity_date": 1585086359, "creation_date": 1585086359, "answer_id": 60839834, "question_id": 43847791, "link": "https://stackoverflow.com/questions/43847791/why-is-cobra-not-reading-my-configuration-file/60839834#60839834", "title": "Why is Cobra not reading my configuration file?", "body": "<p>For those facing the same issue, the problem is on this call:</p>\n\n<pre><code>cobra.OnInitialize(initConfig)\n</code></pre>\n\n<p>The function initConfig is not executed directly but append to an array of initializers <a href=\"https://github.com/spf13/cobra/blob/master/cobra.go#L80\" rel=\"nofollow noreferrer\">https://github.com/spf13/cobra/blob/master/cobra.go#L80</a></p>\n\n<p>So, the values stored in your config file will be loaded when the <code>Run</code> field is executed:</p>\n\n<pre><code>  rootCmd = &amp;cobra.Command{\n    Use:   \"example\",\n    Short: \"example cmd\",\n    Run: func(cmd *cobra.Command, args []string) { // OnInitialize is called first\n      fmt.Println(viper.AllKeys())\n    },  \n  }\n</code></pre>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4572, "favorite_count": 1, "accepted_answer_id": 43850691, "answer_count": 3, "score": 6, "last_activity_date": 1585086359, "creation_date": 1494246767, "last_edit_date": 1583289752, "question_id": 43847791, "link": "https://stackoverflow.com/questions/43847791/why-is-cobra-not-reading-my-configuration-file", "title": "Why is Cobra not reading my configuration file?", "body": "<p>The documentation in Cobra and Viper are confusing me. I did <code>cobra init fooproject</code> and then inside the project dir I did <code>cobra add bar</code>. I have a <code>PersistentFlag</code> that is named <code>foo</code> and here is the init function from the <code>root</code> command.</p>\n\n<pre><code>func Execute() {\n    if err := RootCmd.Execute(); err != nil {\n        fmt.Println(err)\n        os.Exit(-1)\n    }\n\n    fmt.Println(cfgFile)\n    fmt.Println(\"fooString is: \", fooString)\n}\n\n\nfunc init() {\n    cobra.OnInitialize(initConfig)\n\n    // Here you will define your flags and configuration settings.\n    // Cobra supports Persistent Flags, which, if defined here,\n    // will be global for your application.\n\n    RootCmd.PersistentFlags().StringVar(&amp;cfgFile, \"config\", \"\", \"config file (default is $HOME/.fooproject.yaml)\")\n    RootCmd.PersistentFlags().StringVar(&amp;fooString, \"foo\", \"\", \"loaded from config\")\n\n    viper.BindPFlag(\"foo\", RootCmd.PersistentFlags().Lookup(\"foo\"))\n    // Cobra also supports local flags, which will only run\n    // when this action is called directly.\n    RootCmd.Flags().BoolP(\"toggle\", \"t\", false, \"Help message for toggle\")\n}\n</code></pre>\n\n<p>My configuration file looks like this...</p>\n\n<pre><code>---\nfoo: aFooString\n</code></pre>\n\n<p>And when I call <code>go run main.go</code> I see this...</p>\n\n<pre><code>A longer description that spans multiple lines and likely contains\nexamples and usage of using your application. For example:\n\nCobra is a CLI library for Go that empowers applications.\nThis application is a tool to generate the needed files\nto quickly create a Cobra application.\n\nUsage:\n  fooproject [command]\n\nAvailable Commands:\n  bar         A brief description of your command\n  help        Help about any command\n\nFlags:\n      --config string   config file (default is $HOME/.fooproject.yaml)\n      --foo string      loaded from config\n  -h, --help            help for fooproject\n  -t, --toggle          Help message for toggle\n\nUse \"fooproject [command] --help\" for more information about a command.\n\nfooString is:\n</code></pre>\n\n<p>When I call <code>go run main.go bar</code> I see this...</p>\n\n<pre><code>Using config file: my/gopath/github.com/user/fooproject/.fooproject.yaml\nbar called\n\nfooString is:\n</code></pre>\n\n<p>So it is using the configuration file, but neither one of them seems to be reading it. Maybe I am misunderstanding the way that Cobra and Viper work. Any ideas?</p>\n"}, {"tags": ["go", "synchronization"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1494261014, "post_id": 43846743, "comment_id": 74741166, "body": "Further, if you&#39;re running this on a single thread, the main routine, since it has an infinite loop with no function calls or anything else that would cause a goroutine scheduling to occur, could consume 100% of the run time without ever allowing <code>setup()</code> to proceed.  That&#39;s why channels are the general solution for communicating between goroutines.  The common axiom in Go is: &quot;Don&#39;t communicate by sharing memory, share memory by communicating&quot;."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494261720, "post_id": 43846743, "comment_id": 74741568, "body": "@Kaedys: The question says we are running on two threads: &quot;there are no synchronization events between the two threads.&quot;"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494262900, "post_id": 43846743, "comment_id": 74742284, "body": "The question itself does not indicate how many OS threads the OP is running, just the quote from the article linked.  The problem OP highlighted (&quot;busy waiting on a value&quot;) occurs far more often out here due to the main routine consuming 100% run time than it does due to cache coherence.  In any case, <i>both</i> are worth highlighting, as either one can cause an issue in this case depending on the architecture being run on."}, {"owner": {"reputation": 23, "user_id": 5185044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2899589d10376fe05df6c9749e7eb1e0?s=128&d=identicon&r=PG&f=1", "display_name": "flyingpine", "link": "https://stackoverflow.com/users/5185044/flyingpine"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494295869, "post_id": 43846743, "comment_id": 74755330, "body": "@kaedys,@peterSO,Thank you for clear explanation, CPU cache coherence and no-func goroutine can&#39;t get schedule are new to me, seems there are lots of knowledge to be learnt."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494339713, "post_id": 43846743, "comment_id": 74779976, "body": "On the goroutine side, the important thing to remember is to have some sort of pause in a goroutine.  Reading from/writing to an unbuffered channel, writing out to disk or console/log or something, entering a function, all of these actions can cause the scheduler to yield to another goroutine.  If you just have an infinite loop, however, that goroutine never yields, and the others don&#39;t get a chance to run unless you have multiple OS threads available.  That&#39;s why channels are so nice for communicating between goroutines."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494339853, "post_id": 43846743, "comment_id": 74780093, "body": "For example, your original code re-implemented using channels for communication: <a href=\"https://play.golang.org/p/E5qq8X2j2S\" rel=\"nofollow noreferrer\">play.golang.org/p/E5qq8X2j2S</a>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1494246097, "last_edit_date": 1494246097, "creation_date": 1494243671, "answer_id": 43846743, "question_id": 43843960, "link": "https://stackoverflow.com/questions/43843960/how-to-understand-the-incorrect-synchronization-samples-in-go-memory-model/43846743#43846743", "title": "How to understand the &quot;Incorrect synchronization&quot; samples in Go Memory Model", "body": "<pre><code>package main\n\nvar a string\n\nvar done bool\n\nfunc setup() {\n    a = \"hello, world\"\n    done = true\n}\nfunc main() {\n    go setup()\n    for !done {\n    }\n    println(a)\n}\n</code></pre>\n\n<p>You have two goroutines, main and setup. For example, assume that they are running on separate threads on separate CPUs with local memory cache. Assume that both main and setup read the done variable into a local CPU memory cache. The setup goroutine updates done in its local memory cache, which does lazy writes. Since there is no cache synchronization event between the independent main and setup goroutines there is no guarantee of cache coherency, no guarantee that main memory and both CPU memory caches will be synchronized. Different hardware handles this differently. In Go, only the lowest common denominator can be guaranteed.</p>\n\n<p>See <a href=\"https://en.wikipedia.org/wiki/Cache_coherence\" rel=\"nofollow noreferrer\">Cache coherence</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 5185044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2899589d10376fe05df6c9749e7eb1e0?s=128&d=identicon&r=PG&f=1", "display_name": "flyingpine", "link": "https://stackoverflow.com/users/5185044/flyingpine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 1, "accepted_answer_id": 43846743, "answer_count": 1, "score": 2, "last_activity_date": 1494246097, "creation_date": 1494235141, "last_edit_date": 1494235657, "question_id": 43843960, "link": "https://stackoverflow.com/questions/43843960/how-to-understand-the-incorrect-synchronization-samples-in-go-memory-model", "title": "How to understand the &quot;Incorrect synchronization&quot; samples in Go Memory Model", "body": "<p>I am just starting learning golang, when reading <a href=\"https://golang.org/ref/mem#tmp_10\" rel=\"nofollow noreferrer\">Go Memory Model</a> I got a question to understand what it says about \"Another incorrect idiom is busy waiting for a value,\" </p>\n\n<pre><code>var a string\nvar done bool\nfunc setup() {\n    a = \"hello, world\"\n    done = true\n}\nfunc main() {\n    go setup()\n    for !done {\n    }\n    print(a)\n}\n</code></pre>\n\n<p>It says:</p>\n\n<blockquote>\n  <p>\"Worse, there is no guarantee that the write to done will ever be observed by main, since there are no synchronization events between the two threads. The loop in main is not guaranteed to finish.\"</p>\n</blockquote>\n\n<p>I know that the order of writes to 'a' and 'done' is not deterministic in setup(), My question is: why main is not guaranteed to see the write to done?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["string", "go", "io", "stdin"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1494234479, "post_id": 43843477, "comment_id": 74723291, "body": "It already does. It accepts all whitespace except for a new line. Maybe if you give us an example of the input you want to scan, and a small program showing how you are scanning it."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6781453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5c42967fa7f354ebfdc017545350f3a?s=128&d=identicon&r=PG&f=1", "display_name": "fauzanrazandi", "link": "https://stackoverflow.com/users/6781453/fauzanrazandi"}, "edited": false, "score": 0, "creation_date": 1494237324, "post_id": 43843848, "comment_id": 74725110, "body": "Amazing, I haven&#39;t completely read all of the documentation regarding fmt package, thanks @icza"}, {"owner": {"reputation": 2804, "user_id": 2326753, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tzfnK.png?s=128&g=1", "display_name": "C4d", "link": "https://stackoverflow.com/users/2326753/c4d"}, "edited": false, "score": 5, "creation_date": 1509701956, "post_id": 43843848, "comment_id": 81134463, "body": "Thanks for this solution. Anyway it&#39;s confusing for me that a command which obviously shortens from &quot;Scan line()&quot; doesnt reads till the line ends."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1494235474, "last_edit_date": 1494235474, "creation_date": 1494234746, "answer_id": 43843848, "question_id": 43843477, "link": "https://stackoverflow.com/questions/43843477/scanln-in-golang-doesnt-accept-whitespace/43843848#43843848", "title": "Scanln in Golang doesn&#39;t accept whitespace", "body": "<p>You can't use the <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\"><code>fmt</code></a> package's <code>Scanln()</code> and similar functions for what you want to do, because quoting from <code>fmt</code> package doc:</p>\n\n<blockquote>\n  <p>Input processed by verbs is implicitly space-delimited: the implementation of every verb except %c starts by <strong>discarding leading spaces</strong> from the remaining input, and the %s verb (and %v reading into a string) <strong>stops consuming input at the first space</strong> or newline character.</p>\n</blockquote>\n\n<p>The <code>fmt</code> package intentionally filters out whitespaces, this is how it is implemented.</p>\n\n<p>Instead use <a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"noreferrer\"><code>bufio.Scanner</code></a> to read lines that might contain white spaces which you don't want to filter out. To read / scan from the standard input, create a new <code>bufio.Scanner</code> using the <a href=\"https://golang.org/pkg/bufio/#NewScanner\" rel=\"noreferrer\"><code>bufio.NewScanner()</code></a> function, passing <code>os.Stdin</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>scanner := bufio.NewScanner(os.Stdin)\nif scanner.Scan() {\n    line := scanner.Text()\n    fmt.Printf(\"Input was: %q\\n\", line)\n}\n</code></pre>\n\n<p>Now if you enter 3 spaces and press <kbd>Enter</kbd>, the output will be:</p>\n\n<pre><code>Input was: \"   \"\n</code></pre>\n\n<p>A more complete example that keeps reading lines until you terminate the app or enter <code>\"quit\"</code>, and also checks if there was an error:</p>\n\n<pre><code>scanner := bufio.NewScanner(os.Stdin)\nfor scanner.Scan() {\n    line := scanner.Text()\n    fmt.Printf(\"Input was: %q\\n\", line)\n    if line == \"quit\" {\n        fmt.Println(\"Quitting...\")\n        break\n    }\n}\nif err := scanner.Err(); err != nil {\n    fmt.Println(\"Error encountered:\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6781453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5c42967fa7f354ebfdc017545350f3a?s=128&d=identicon&r=PG&f=1", "display_name": "fauzanrazandi", "link": "https://stackoverflow.com/users/6781453/fauzanrazandi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4597, "favorite_count": 0, "accepted_answer_id": 43843848, "answer_count": 1, "score": 7, "last_activity_date": 1560600404, "creation_date": 1494233602, "last_edit_date": 1560600404, "question_id": 43843477, "link": "https://stackoverflow.com/questions/43843477/scanln-in-golang-doesnt-accept-whitespace", "title": "Scanln in Golang doesn&#39;t accept whitespace", "body": "<p>How can I use <code>Scanln</code> that accepts whitespace as input?</p>\n"}, {"tags": ["loops", "dictionary", "go"], "comments": [{"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 1, "creation_date": 1494240365, "post_id": 43843280, "comment_id": 74727028, "body": "A <code>map</code> in Go is a hash/dictionary structure like in many other languages. Why would there be an index for something that doesn&#39;t have a deterministic result and isn&#39;t stored as a list?  If you&#39;re thinking about a map reduce style iteration, then that takes a list as input. But, it has no relation to the map structure.  <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">blog.golang.org/go-maps-in-action</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1494244698, "post_id": 43843280, "comment_id": 74729802, "body": "<code>Where is the index of the loop returned in this case?</code> What index? Why would you expect there to be an index when iterating over something that has no index?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1494254109, "post_id": 43843280, "comment_id": 74736610, "body": "Or, viewed another way, where the index in a slice or array is an integer, the &quot;index&quot; in a map is the key - so when you get the key, you <i>are</i> getting the index, as far as a map is concerned."}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1494239913, "post_id": 43843281, "comment_id": 74726772, "body": "The official documentation for the <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">For statements with range clause</a> is in <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a>."}], "tags": [], "owner": {"reputation": 3410, "user_id": 3570517, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9n356.jpg?s=128&g=1", "display_name": "Abdul Wasae", "link": "https://stackoverflow.com/users/3570517/abdul-wasae"}, "is_accepted": true, "score": 3, "last_activity_date": 1494680902, "last_edit_date": 1494680902, "creation_date": 1494233010, "answer_id": 43843281, "question_id": 43843280, "link": "https://stackoverflow.com/questions/43843280/which-different-variables-does-range-clause-return-for-different-data-structure/43843281#43843281", "title": "Which different variables does range clause return for different data structure types like map?", "body": "<p>As per the <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">documentation of range clause</a>, following are the returned values for different kinds of types that it is used with:</p>\n\n<ul>\n<li><p>array or slice a <code>[n]E</code>, <code>*[n]E</code>, or <code>[]E</code>: </p>\n\n<ul>\n<li><strong>1st value:</strong> index <code>i int</code></li>\n<li><strong>2nd value (optional):</strong> <code>a[i]</code> E (element at index i)</li>\n</ul></li>\n<li><p>string s string type</p>\n\n<ul>\n<li><strong>1st value:</strong> index <code>i int</code></li>\n<li><strong>2nd value (optional):</strong> rune <code>int</code> (the unicode of the character. to get the actual character, simply cast like this: <code>string(value)</code>)</li>\n</ul></li>\n<li><p>map m <code>map[K]V</code>: </p>\n\n<ul>\n<li><strong>1st value:</strong> key <code>k K</code></li>\n<li><strong>2nd value (optional):</strong> value <code>m[k]</code> V</li>\n</ul></li>\n<li><p>channel c chan E: </p>\n\n<ul>\n<li><strong>1st value:</strong> element <code>e E</code></li>\n</ul></li>\n</ul>\n\n<p><a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">Simplified read here</a></p>\n"}], "owner": {"reputation": 3410, "user_id": 3570517, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9n356.jpg?s=128&g=1", "display_name": "Abdul Wasae", "link": "https://stackoverflow.com/users/3570517/abdul-wasae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 43843281, "answer_count": 1, "score": -4, "last_activity_date": 1515476971, "creation_date": 1494233010, "last_edit_date": 1515476971, "question_id": 43843280, "link": "https://stackoverflow.com/questions/43843280/which-different-variables-does-range-clause-return-for-different-data-structure", "title": "Which different variables does range clause return for different data structure types like map?", "body": "<p>When looping through an array, the first variable returned is the index, and the second variable returned is the value:</p>\n\n<pre><code>array := []int{2, 3, 4}\nfor index, value := range array {\n    fmt.Printf(\"Index: %s, Value: %s\\n\", index, value)\n}\n</code></pre>\n\n<p>What is returned when looping through map with the range clause. It is not the same as for array. There cannot be an index of a map anyway. Can we get key names?</p>\n"}, {"tags": ["javascript", "mongodb", "go"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7064515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280d817298bfb424e7ed6aaadbbd7f8f?s=128&d=identicon&r=PG&f=1", "display_name": "hari prasad", "link": "https://stackoverflow.com/users/7064515/hari-prasad"}, "edited": false, "score": 0, "creation_date": 1494238696, "post_id": 43842080, "comment_id": 74725987, "body": "Thank you @GujaratSantana, i can able to store the function in system.js collection. How can I execute the js  form golang"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 75, "user_id": 7064515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280d817298bfb424e7ed6aaadbbd7f8f?s=128&d=identicon&r=PG&f=1", "display_name": "hari prasad", "link": "https://stackoverflow.com/users/7064515/hari-prasad"}, "edited": false, "score": 0, "creation_date": 1494244047, "post_id": 43842080, "comment_id": 74729366, "body": "@hariprasad see here : <a href=\"http://stackoverflow.com/questions/12008910/how-can-i-ask-mongodb-to-evaluate-some-javascript-in-order-to-obtain-value-for-a\" title=\"how can i ask mongodb to evaluate some javascript in order to obtain value for a\">stackoverflow.com/questions/12008910/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": true, "score": 1, "last_activity_date": 1494228662, "creation_date": 1494228662, "answer_id": 43842080, "question_id": 43841262, "link": "https://stackoverflow.com/questions/43841262/how-to-insert-javascritpt-function-in-mongodb-using-go-driver-or-golang/43842080#43842080", "title": "How to insert javascritpt function in Mongodb using Go driver or Golang", "body": "<p>Here is how First create a function that will return <code>bson.JavaScript</code> struct :</p>\n\n<pre><code>func mongoNow() bson.JavaScript {\n\n    return bson.JavaScript{\n      // place your function in here in string\n      Code: \"(new Date()).ISODate('YYYY-MM-DD hh:mm:ss')\"\n    }\n}\n</code></pre>\n\n<p>And insert to your collections : </p>\n\n<pre><code>c := mongoSession.DB(\"YourDB\").C(\"YourCollection\")\nerr := c.Insert(\n   struct{LastSeen interface{}}\n      {  \n         LastSeen: mongoNow() \n      }\n)\n</code></pre>\n\n<p>Please do not forget to insert your appropriate <code>import</code> package.</p>\n"}], "owner": {"reputation": 75, "user_id": 7064515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280d817298bfb424e7ed6aaadbbd7f8f?s=128&d=identicon&r=PG&f=1", "display_name": "hari prasad", "link": "https://stackoverflow.com/users/7064515/hari-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 43842080, "answer_count": 1, "score": 2, "last_activity_date": 1494228662, "creation_date": 1494225568, "question_id": 43841262, "link": "https://stackoverflow.com/questions/43841262/how-to-insert-javascritpt-function-in-mongodb-using-go-driver-or-golang", "title": "How to insert javascritpt function in Mongodb using Go driver or Golang", "body": "<p>I saw the below code in mongodb official site, to insert a Javascript function in mongodb.</p>\n\n<pre><code>db.system.js.save(\n   {\n     _id: \"echoFunction\",\n     value : function(x) { return x; }\n   }\n)\n</code></pre>\n\n<p>link is:\n<a href=\"https://docs.mongodb.com/manual/tutorial/store-javascript-function-on-server/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/tutorial/store-javascript-function-on-server/</a></p>\n\n<p>I tried the procedures in mongoShell and it is working good.\nNow, I want to store javascript function in to mongodb using golang.</p>\n\n<p>I saw the below structure  in <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson\" rel=\"nofollow noreferrer\">gopkg.in/mgo.v2/bson package</a>.</p>\n\n<pre><code>// JavaScript is a type that holds JavaScript code. If Scope is non-nil, it\n// will be marshaled as a mapping from identifiers to values that may be\n// used when evaluating the provided Code.\ntype JavaScript struct {\n    Code  string\n    Scope interface{}\n}\n</code></pre>\n\n<p>Does it relates to what I expected?\nPlease share your Knowledge.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1494213012, "post_id": 43839145, "comment_id": 74714461, "body": "Irrelevant: there is a data race on the <code>total</code> variable. Use <code>atomic.AddInt32</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1494254332, "post_id": 43839145, "comment_id": 74736755, "body": "Below answer is correct for the panic. The other message <code>connect: cannot assign requested address</code> I believe is due to running out of ports to use to make requests on."}, {"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494298639, "post_id": 43839145, "comment_id": 74756057, "body": "@zerkms, thanks for the good point of using <code>atomic.AddInt32</code>, it makes perfect sense."}, {"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494306110, "post_id": 43839145, "comment_id": 74758207, "body": "Thanks @Adrian for the tip, I set the <code>ip_local_port_range</code>  but it didn&#39;t help much. But after setting <code>conn.(*net.TCPConn).SetLinger(0)</code>, it helped. I guess the difference is that setting linger option to be 0 will force TCP session to reset at the end instead of nature timeout."}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 3, "last_activity_date": 1494213128, "creation_date": 1494213128, "answer_id": 43839211, "question_id": 43839145, "link": "https://stackoverflow.com/questions/43839145/go-error-on-doing-http-requests/43839211#43839211", "title": "go error on doing HTTP requests", "body": "<pre><code>resp, err := client.Do(req)\n//defer resp.Body.Close()\nif (err != nil) {\n    fmt.Println(err)\n}\nresp.Body.Close()\n</code></pre>\n\n<p>In this fragment you're checking the <code>err</code> and continue execution.</p>\n\n<p>So if something happened and the <code>err</code> is not <code>nil</code>, but <code>resp</code> is (or the <code>resp.Body</code> is) - you print the error then dereference a nil pointer.</p>\n\n<p>What you should have done: if an error occurs - cleanup and return from the function.</p>\n"}], "owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 43839211, "answer_count": 1, "score": 1, "last_activity_date": 1494213128, "creation_date": 1494212607, "question_id": 43839145, "link": "https://stackoverflow.com/questions/43839145/go-error-on-doing-http-requests", "title": "go error on doing HTTP requests", "body": "<p>When running the following http client to stress test a web server, got strange error, wonder what was the cause.  The version of go is <code>go1.8.1 linux/amd64</code> running on Ubuntu 14.04 with 16GB of ram. </p>\n\n<pre><code>$ go run te2.go \n563.904492ms\nGet http://10.3.0.6/small: dial tcp 10.3.0.6:80: connect: cannot assign requested address\nGet http://10.3.0.6/small: dial tcp 10.3.0.6:80: connect: cannot assign requested address\nGet http://10.3.0.6/small: dial tcp 10.3.0.6:80: connect: cannot assign requested address\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x40 pc=0x5e3b27]\n\ngoroutine 140284 [running]:\nmain.httpGet(0x0)\n    /home/jon/learn/go/te2.go:27 +0x107\ncreated by main.main\n    /home/jon/learn/go/te2.go:45 +0xd3\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x40 pc=0x5e3b27]\n\ngoroutine 140375 [running]:\nmain.httpGet(0x0)\n    /home/jon/learn/go/te2.go:27 +0x107\ncreated by main.main\n    /home/jon/learn/go/te2.go:45 +0xd3\nexit status 2\n</code></pre>\n\n<p>any ideas?</p>\n\n<p>Here is the code snippet:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"bufio\"\nimport \"os\"\nimport \"time\"\nimport \"net/http\"\n\nvar req = []byte(\"GET /small HTTP/1.1\\r\\n\" +\n\"Host: localhost\\r\\n\" +\n\"Content-Length: 0\\r\\n\\r\\n\");\nvar buf = make([]byte, 1024)\nvar total = 0;\nvar t0 = time.Now()\nvar c = make(chan int)\n\nfunc httpGet ()  int {\n    req, err := http.NewRequest(\"GET\", \"http://10.3.0.6/small\", nil)\n    //req.Header.Add(\"User-Agent\", `MYCLIENT`)\n    //req.Header.Add(\"Cookie\", `sessid=12345`)\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    //defer resp.Body.Close()\n    if (err != nil) {\n        fmt.Println(err)\n    }\n    resp.Body.Close()\n    total ++\n    if (total == 10000) {\n        fmt.Println(time.Now().Sub(t0))\n    }\n    c &lt;- 1\n    return 0;\n}\n\nfunc main() {\n    i := 1\n    t0 = time.Now()\n    for (i &lt; 1000) {\n        go httpGet()\n        i += 1\n    }\n    for (1 &lt; 2) {\n        &lt;-c\n        go httpGet()\n    }\n    reader := bufio.NewReader(os.Stdin)\n    text, _ := reader.ReadString('\\n')\n    fmt.Println(text)   \n}\n</code></pre>\n"}, {"tags": ["ios", "go", "gomobile"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "edited": false, "score": 0, "creation_date": 1494381788, "post_id": 43842632, "comment_id": 74799660, "body": "Thank you. But  I am asking for apple app store."}, {"owner": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "edited": false, "score": 0, "creation_date": 1494383333, "post_id": 43842632, "comment_id": 74800021, "body": "And do u know how to make the screen to be landscape, the default layout is portrait."}], "tags": [], "owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "is_accepted": false, "score": 0, "last_activity_date": 1494230650, "creation_date": 1494230650, "answer_id": 43842632, "question_id": 43839091, "link": "https://stackoverflow.com/questions/43839091/can-gomobile-build-app-be-published-on-appstore/43842632#43842632", "title": "Can gomobile build app be published on appstore", "body": "<p>First you need to create a runnable apk file using <a href=\"https://godoc.org/golang.org/x/mobile/cmd/gomobile\" rel=\"nofollow noreferrer\">gomobile</a> toolset.</p>\n\n<p>Given that you have gomobile initialized and NDK installed</p>\n\n<pre><code>gomobile build -target=android -v -o=myApp.apk path/to/your/goProject\n</code></pre>\n\n<p>Or install directly into your phone (to test out first) with </p>\n\n<pre><code>gomobile install .....\n</code></pre>\n\n<p>If you use gomobile build, you may have to first sign your app using either jarsigner or <a href=\"https://developer.android.com/studio/publish/app-signing.html\" rel=\"nofollow noreferrer\">android studio</a></p>\n\n<p>Then follow instructions from <a href=\"https://developer.android.com/studio/publish/index.html\" rel=\"nofollow noreferrer\">Google</a> to finally publish into appstore</p>\n\n<p>There is an <a href=\"https://github.com/art4711/kk\" rel=\"nofollow noreferrer\">example Gomobile project</a> on Github for more info</p>\n"}], "owner": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1494464456, "creation_date": 1494212183, "last_edit_date": 1494464456, "question_id": 43839091, "link": "https://stackoverflow.com/questions/43839091/can-gomobile-build-app-be-published-on-appstore", "title": "Can gomobile build app be published on appstore", "body": "<p><code>gomobile</code> build is a simple go mobile tool to build app,  it is easy to build ios / android app cross platform, but  can <code>gomobile</code> build an app (ios/android) to be published on the App Store or Google Play?</p>\n\n<p><a href=\"https://pt.slideshare.net/takuyaueda967/go-for-mobile-games\" rel=\"nofollow noreferrer\">Here</a> is a document to show how to publish go build app on Google Play.</p>\n\n<p>However,  there is no document on how to publish an app on the App Store</p>\n\n<p>how to do this,  is it possible ?</p>\n\n<p>I tried on appstore,  it reports \nERROR ITMS-90161: \"Invalid Provisioning Profile. The provisioning profile included in the bundle com.company.app [Payload/App.app] is invalid</p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494207199, "post_id": 43838487, "comment_id": 74713357, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/43835778/yaml-list-of-unnamed-strings-with-optional-boolean\">YAML List of Unnamed Strings With Optional Boolean</a>"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1494238174, "post_id": 43838487, "comment_id": 74725679, "body": "Just in case you wanted to try something other than yaml, I would suggest HCL (much like nginx conf and based on UCL). So far not problem using it: <a href=\"https://github.com/hashicorp/hcl\" rel=\"nofollow noreferrer\">github.com/hashicorp/hcl</a>."}], "owner": {"reputation": 1560, "user_id": 830610, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ad4beaa5454a99a1d3a581302f7d6af?s=128&d=identicon&r=PG", "display_name": "John Montague", "link": "https://stackoverflow.com/users/830610/john-montague"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1494207108, "creation_date": 1494207108, "question_id": 43838487, "link": "https://stackoverflow.com/questions/43838487/yaml-golang-mix-top-level-map-second-level-optional-bool", "title": "YAML/GoLang Mix Top Level Map Second Level Optional Bool", "body": "<p>I want to define YAML that defines a list of strings by default.  I don't want this list of strings to be a named attribute.  I also want to have an optional boolean parameter.  As in</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    yaml \"gopkg.in/yaml.v2\"\n)\n\ntype ThingAndGroups struct {\n    Groups   []string\n    boolval  boolean\n}\n\nvar someStr = `\nthing1:\n  - g1\n  - g2\n  boolval:\n    y\n\nthing2:\n  - g1\n  - g2\n`\n\nfunc main() {\n    t := make(map[string]ThingAndGroups)\n\n    err := yaml.Unmarshal([]byte(someStr), &amp;t)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"--- t:\\n%v\\n\\n\", t)\n}\n</code></pre>\n\n<p>Would then return</p>\n\n<blockquote>\n  <p>map[thing1:{[g1, g2] true}, thing2:{[g1, g2] false}]</p>\n</blockquote>\n\n<p>Is that possible?</p>\n\n<p>I DO NOT want to define the YAML as</p>\n\n<pre><code>var someStr = `\nthing1:\n  groups:\n    - g1\n    - g2\n  boolval:\n    y`\n</code></pre>\n\n<p>And if the YAML didn't have boolval I could just do</p>\n\n<pre><code> func main() {\n    // NOTE THIS IS A MAP\n    t := make(map[string][]string)\n\n    err := yaml.Unmarshal([]byte(someStr), &amp;t)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"--- t:\\n%v\\n\\n\", t)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1496356472, "post_id": 43838049, "comment_id": 75641895, "body": "Can you send an &quot;Upgrade&quot; header?"}], "answers": [{"tags": [], "owner": {"reputation": 752, "user_id": 7496656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMGuk.jpg?s=128&g=1", "display_name": "Jan Zerebecki", "link": "https://stackoverflow.com/users/7496656/jan-zerebecki"}, "is_accepted": false, "score": 2, "last_activity_date": 1496356007, "creation_date": 1496356007, "answer_id": 44318048, "question_id": 43838049, "link": "https://stackoverflow.com/questions/43838049/can-i-make-an-http-request-that-only-uses-http-2/44318048#44318048", "title": "Can I make an HTTP request that only uses HTTP/2", "body": "<p>You can use <code>Response.ProtoAtLeast(2, 0)</code> to check if it came in over version 2. See: <a href=\"https://golang.org/pkg/net/http/#Response.ProtoAtLeast\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Response.ProtoAtLeast</a></p>\n"}], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1496356007, "creation_date": 1494202441, "question_id": 43838049, "link": "https://stackoverflow.com/questions/43838049/can-i-make-an-http-request-that-only-uses-http-2", "title": "Can I make an HTTP request that only uses HTTP/2", "body": "<p>I am working on some scripts to test our infrastructure at various levels. I am trying to make tests to verify functionality for clients both with and without http2. <a href=\"https://golang.org/pkg/net/http/\" rel=\"noreferrer\">The docs</a> specify how to <em>disable</em> http2 by overriding <code>Transport.TLSNextProto</code>, but I can't find any way to <strong>require</strong> http2.</p>\n\n<p>Is there a way to require an http request uses http/2 only? Or if not is there any kind of field or hook to see if it used http2 or not?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 0, "creation_date": 1494189452, "post_id": 43836206, "comment_id": 74709498, "body": "I don&#39;t have the time to debug this code, but I see you&#39;re using goroutines inside a loop in an unpredictable way.  See <a href=\"https://github.com/golang/go/wiki/CommonMistakes#using-goroutines-on-loop-iterator-variables\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}, {"owner": {"reputation": 1050, "user_id": 4534275, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/671721deaa074d660cc7a13bfbd6b397?s=128&d=identicon&r=PG", "display_name": "nefas", "link": "https://stackoverflow.com/users/4534275/nefas"}, "reply_to_user": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 0, "creation_date": 1494238473, "post_id": 43836206, "comment_id": 74725861, "body": "the unpredictable way is the fact that I&#39;m passing the loop index (<code>i</code>) to the goroutine or the fact that I&#39;m using the <code>url</code> iterator ?"}, {"owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 0, "creation_date": 1494253513, "post_id": 43836206, "comment_id": 74736199, "body": "The loop index must be done like this: <code>go func(i int) { worker(lCh, outCh, wg, i); }(i)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 4, "last_activity_date": 1494190899, "creation_date": 1494190899, "answer_id": 43836689, "question_id": 43836206, "link": "https://stackoverflow.com/questions/43836206/deadlock-with-double-channel/43836689#43836689", "title": "deadlock with double channel", "body": "<p>You need to pump the urls in a goroutine, otherwise the <code>outCh</code> will fill up which as you aren't emptying it.  This will stall all the workers and it will deadlock.</p>\n\n<p>So re-arrange the code to look like this</p>\n\n<pre><code>go func() {\n    for _, link := range urls {\n        lCh &lt;- link\n    }\n    close(lCh)\n    wg.Wait()\n    close(outCh)\n}()\n\nfor res := range outCh {\n    fmt.Printf(\"%s\\n\", res)\n}\n</code></pre>\n\n<p>And it will work fine</p>\n\n<p><a href=\"https://play.golang.org/p/dNJM3M8Xde\" rel=\"nofollow noreferrer\">Complete code</a></p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 7972167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90829de396c0e3cbdcbe4d072afdfba6?s=128&d=identicon&r=PG&f=1", "display_name": "Justin S", "link": "https://stackoverflow.com/users/7972167/justin-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1494241969, "creation_date": 1494241969, "answer_id": 43846202, "question_id": 43836206, "link": "https://stackoverflow.com/questions/43836206/deadlock-with-double-channel/43846202#43846202", "title": "deadlock with double channel", "body": "<p><a href=\"https://golang.org/ref/spec#For_range\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#For_range</a> :</p>\n\n<blockquote>\n  <p>For channels, the iteration values produced are the successive values sent on the channel until the channel is closed. If the channel is nil, the range expression blocks forever. </p>\n</blockquote>\n\n<p>You use <code>range</code> <strong>before</strong> close <code>outCh</code>. You have to close <code>outCh</code> after <code>wg.Wait()</code>, like in Nick`s answer.</p>\n"}], "owner": {"reputation": 1050, "user_id": 4534275, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/671721deaa074d660cc7a13bfbd6b397?s=128&d=identicon&r=PG", "display_name": "nefas", "link": "https://stackoverflow.com/users/4534275/nefas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 43836689, "answer_count": 2, "score": 2, "last_activity_date": 1494241969, "creation_date": 1494188055, "question_id": 43836206, "link": "https://stackoverflow.com/questions/43836206/deadlock-with-double-channel", "title": "deadlock with double channel", "body": "<p>I'm trying to create a program that send strings to a pool of goroutines (through a channel). Once the goroutine have finish their job, they send some results (through an other channel).</p>\n\n<p>The code is:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"os\"\nimport \"sync\"\nimport \"bufio\"\n\nfunc worker(linkChan &lt;-chan string, outChan chan&lt;- string, wg *sync.WaitGroup, jobId int) {\n   defer wg.Done()\n\n   for url := range linkChan {\n    // ...\n     outChan &lt;- url\n   }\n}\n\nfunc main() {\n    lCh := make(chan string)\n    wg := new(sync.WaitGroup)\n    outCh := make(chan string)\n\n    urls := []string{}\n    if len(os.Args) &gt; 1 {\n        for _, link := range os.Args[1:] {\n            urls = append(urls, link)\n        }\n    } else {\n        s := bufio.NewScanner(os.Stdin)\n        for s.Scan() {\n            urls = append(urls, s.Text())\n        }\n    }\n\n    num_worker := 10\n\n    for i := 0; i &lt; num_worker; i++ {\n        wg.Add(1)\n        go worker(lCh, outCh, wg, i)\n    }\n    for _, link := range urls {\n        lCh &lt;- link\n    }\n    close(lCh)\n\n    for res := range outCh {\n        fmt.Printf(\"%s\\n\", res)\n    }\n    close(outCh)\n    wg.Wait()\n\n}\n</code></pre>\n\n<p>Running <code>echo \"something\" | ./main</code> cause a deadlock.</p>\n\n<p>From what I've understood, <code>close(lCh)</code> should stop the <code>for url := range linkChan</code> loop. Am I wrong (it seems so since the code deadlock) ?</p>\n\n<p>How can I resolve this deadlock ?</p>\n\n<p>Thank you for your answers.</p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1494238164, "post_id": 43835778, "comment_id": 74725672, "body": "Just in case you wanted to try something other than yaml, I would suggest HCL (much like nginx conf and based on UCL). So far not problem using it: <a href=\"https://github.com/hashicorp/hcl\" rel=\"nofollow noreferrer\">github.com/hashicorp/hcl</a>."}, {"owner": {"reputation": 6343, "user_id": 3665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57c4c78783994419d04c73a319ca98e?s=128&d=identicon&r=PG", "display_name": "gz.", "link": "https://stackoverflow.com/users/3665/gz"}, "edited": false, "score": 0, "creation_date": 1494355491, "post_id": 43835778, "comment_id": 74790043, "body": "Your desired yaml is not valid, it won&#39;t parse. So, it&#39;s use the more readable form later (which can still go in the same go struct) or give up on yaml."}], "answers": [{"tags": [], "owner": {"reputation": 27602, "user_id": 42223, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d73fc2c7bd494149d303a2b87aa5a6d5?s=128&d=identicon&r=PG", "display_name": "dreftymac", "link": "https://stackoverflow.com/users/42223/dreftymac"}, "is_accepted": false, "score": 1, "last_activity_date": 1555018093, "creation_date": 1555018093, "answer_id": 55641435, "question_id": 43835778, "link": "https://stackoverflow.com/questions/43835778/yaml-list-of-unnamed-strings-with-optional-boolean/55641435#55641435", "title": "YAML List of Unnamed Strings With Optional Boolean", "body": "<h2>Problem</h2>\n\n<ul>\n<li>Defining a YAML sequence without using a mapping key.</li>\n</ul>\n\n<h2>Solution</h2>\n\n<ul>\n<li>Change BEFORE into AFTER</li>\n</ul>\n\n<h3>BEFORE</h3>\n\n<pre><code>  var someStr = `\n  thing1:\n    - g1\n    - g2\n    boolval:\n      y\n\n  thing2:\n    - g1\n    - g2\n  `\n</code></pre>\n\n<h3>AFTER</h3>\n\n<pre><code>  var someStr = `\n  thing1:\n    - g1\n    - g2\n    - boolval: y\n\n  thing2:\n    - g1\n    - g2\n  `\n</code></pre>\n\n<h3>Pitfalls</h3>\n\n<ul>\n<li>This approach is not desirable because it uses the YAML sequence to store two different kinds of data (the groups and the boolean value).</li>\n<li>Another answer (that was later deleted) suggested using a groups key, and that was a good suggestion.</li>\n</ul>\n"}], "owner": {"reputation": 1560, "user_id": 830610, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ad4beaa5454a99a1d3a581302f7d6af?s=128&d=identicon&r=PG", "display_name": "John Montague", "link": "https://stackoverflow.com/users/830610/john-montague"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1555018093, "creation_date": 1494185564, "last_edit_date": 1494197329, "question_id": 43835778, "link": "https://stackoverflow.com/questions/43835778/yaml-list-of-unnamed-strings-with-optional-boolean", "title": "YAML List of Unnamed Strings With Optional Boolean", "body": "<p>I want to define YAML that defines a list of strings by default.  I don't want this list of strings to be a named attribute.  I also want to have an optional boolean parameter.  As in</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    yaml \"gopkg.in/yaml.v2\"\n)\n\ntype ThingAndGroups struct {\n    Groups   []string\n    boolval  boolean\n}\n\nvar someStr = `\nthing1:\n  - g1\n  - g2\n  boolval:\n    y\n\nthing2:\n  - g1\n  - g2\n`\n\nfunc main() {\n    t := make(map[string]ThingAndGroups)\n\n    err := yaml.Unmarshal([]byte(someStr), &amp;t)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"--- t:\\n%v\\n\\n\", t)\n}\n</code></pre>\n\n<p>Would then return</p>\n\n<blockquote>\n  <p>map[thing1:{[g1, g2] true}, thing2:{[g1, g2] false}]</p>\n</blockquote>\n\n<p>Is that possible?</p>\n\n<p>I DO NOT want to define the YAML as</p>\n\n<pre><code>var someStr = `\nthing1:\n  groups:\n    - g1\n    - g2\n  boolval:\n    y`\n</code></pre>\n\n<p>And if the YAML didn't have boolval I could just do</p>\n\n<pre><code> func main() {\n    // NOTE THIS IS A MAP\n    t := make(map[string][]string)\n\n    err := yaml.Unmarshal([]byte(someStr), &amp;t)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"--- t:\\n%v\\n\\n\", t)\n}\n</code></pre>\n"}, {"tags": ["go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1494182556, "creation_date": 1494182556, "answer_id": 43835275, "question_id": 43835217, "link": "https://stackoverflow.com/questions/43835217/how-to-make-go-append-work-inside-a-range-loop/43835275#43835275", "title": "How to make Go append work inside a range loop", "body": "<p>Append to the slice like this:</p>\n\n<pre><code>allKeys = append(allKeys, keys...) \n</code></pre>\n\n<p>The first argument to append is the slice. The remaining arguments are the elements to append to the slice.  The append function returns the new slice.</p>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 43835275, "answer_count": 1, "score": -2, "last_activity_date": 1494182556, "creation_date": 1494182167, "question_id": 43835217, "link": "https://stackoverflow.com/questions/43835217/how-to-make-go-append-work-inside-a-range-loop", "title": "How to make Go append work inside a range loop", "body": "<p>I have this function which takes an unknown amount of input from a struct:</p>\n\n<pre><code>func GetAllXXXByQueryFilters(ctx context.Context, filters ...XXXFilters) ([]XXX, error) {\n    var allKeys []*datastore.Key\n    var xxx []XXX\n    for _, filter := range filters {\n        query := datastore.NewQuery(\"XXX\")\n        if filter.Foo != \"\" {\n            query = query.Filter(\"foo =\", filter.Foo)\n        }\n        if filter.Bar != \"\" {\n            query = query.Filter(\"bar =\", filter.Bar)\n        }\n        keys, err := models.DSClient().GetAll(ctx, query, &amp;xxx)\n        if err != nil {\n            return nil, err\n        }\n        allKeys = append(keys) // PROBLEM HERE\n    }\n    for i, key := range allKeys {\n        xxx[i].ID = key.ID\n    }\n    return xxx, nil\n}\n</code></pre>\n\n<p>The problem is that allKeys will override previous query results. I have previously overcome the problem by doing:</p>\n\n<pre><code>keys1, err := models.DSClient().GetAll(ctx, query1, &amp;xxx)\nkeys2, err := models.DSClient().GetAll(ctx, query2, &amp;xxx)\nkeys = append(keys1, keys2...)\n</code></pre>\n\n<p>But I wanted my GetAllXXXByQueryFilters to be more sophisticated and avoid duplicated code, and now I can't seem to figure out how I can store the keys from the <code>for _, filter := range filters</code> loop and then append them all afterwards. So I was hoping that maybe there was a smarter way to do/replace the <code>allKeys = append(keys)</code> line so that it doesn't override previous keys?</p>\n"}, {"tags": ["go", "time", "process", "weekday"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1494184239, "post_id": 43835425, "comment_id": 74707725, "body": "In go how would you verify the process is already running if it called to start?  So the process would not have more than one running instance?"}, {"owner": {"reputation": 7220, "user_id": 4671754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeNSv.jpg?s=128&g=1", "display_name": "Bassie", "link": "https://stackoverflow.com/users/4671754/bassie"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1494184378, "post_id": 43835425, "comment_id": 74707772, "body": "@user2777145 Sorry but you will have to do some research or ask a seperate question as I don&#39;t know"}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1494184817, "post_id": 43835425, "comment_id": 74707914, "body": "No problem my fix is to ps | grep for process before starting process to verify it is not running."}], "tags": [], "owner": {"reputation": 7220, "user_id": 4671754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeNSv.jpg?s=128&g=1", "display_name": "Bassie", "link": "https://stackoverflow.com/users/4671754/bassie"}, "is_accepted": true, "score": 4, "last_activity_date": 1494183488, "creation_date": 1494183488, "answer_id": 43835425, "question_id": 43835216, "link": "https://stackoverflow.com/questions/43835216/allow-to-run-from-sunday-to-friday/43835425#43835425", "title": "Allow to run from Sunday to Friday?", "body": "<p>This should do the same thing: </p>\n\n<pre><code>now := time.Now()\nday := now.Weekday()\nhr  := now.Hour()\n\nif day == 0 {\n    if hr &lt; 15 { os.Exit(0) }\n} \nif day == 5 {\n    if hr &gt; 19 { os.Exit(0) }\n}\nif day == 6 {\n    os.Exit(0)\n}\n</code></pre>\n\n<p>Where similarly, each day can be represented by an integer (0 - 6).</p>\n\n<p>Note that to use <code>time</code> and <code>os</code> you will need to call</p>\n\n<pre><code>import \"time\"\nimport \"os\"\n</code></pre>\n\n<p>See <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">the documentation</a> for more about Golang time.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1494187806, "post_id": 43835796, "comment_id": 74708933, "body": "I am in a loop till I hit the other side of the date/time.  So I haft to call time.now and then do a test of either switch / case or if.  Not sure which would be the best way togo.  switch / case is faster than several if in the main function of go."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1494186035, "last_edit_date": 1494186035, "creation_date": 1494185696, "answer_id": 43835796, "question_id": 43835216, "link": "https://stackoverflow.com/questions/43835216/allow-to-run-from-sunday-to-friday/43835796#43835796", "title": "Allow to run from Sunday to Friday?", "body": "<p>Don't write PHP code as Go code. Write Go code. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    now := time.Now()\n    hour := now.Hour()\n    switch now.Weekday() {\n    case time.Sunday:\n        if hour &lt; 15 {\n            os.Exit(0)\n        }\n    case time.Friday:\n        if hour &gt; 19 {\n            os.Exit(0)\n        }\n    case time.Saturday:\n        os.Exit(0)\n    }\n    // Do Something\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 43835425, "answer_count": 2, "score": -2, "last_activity_date": 1494186035, "creation_date": 1494182164, "last_edit_date": 1494183719, "question_id": 43835216, "link": "https://stackoverflow.com/questions/43835216/allow-to-run-from-sunday-to-friday", "title": "Allow to run from Sunday to Friday?", "body": "<p>The following PHP code that allows a process to only run between certain times.  How would this be done in GoLang?</p>\n\n<pre><code>$curdate = date('Y-m-d');\n$mydate=getdate(strtotime($curdate));\nif ( $mydate['wday'] === 0 ) {\n  if ( date('H') &lt; 15 ) { exit; }; // This is for 0 Sunday!!!\n}\nif ( $mydate['wday'] === 5 ) {\n  if ( date('H') &gt; 19 ) { exit; }; // This is for 5 Friday!!!\n}\nif ( $mydate['wday'] === 6 ) {\n  exit;  // This is for 6 Saturday //\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "c++11", "go"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1494175458, "post_id": 43833968, "comment_id": 74704752, "body": "QT is C++, not C."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494175628, "post_id": 43833968, "comment_id": 74704830, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1757090/shared-library-in-go\">Shared library in Go?</a>"}, {"owner": {"reputation": 131, "user_id": 7850797, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/646cecbdd8472ce53970d0550dffb5d8?s=128&d=identicon&r=PG&f=1", "display_name": "no_ideaw", "link": "https://stackoverflow.com/users/7850797/no-ideaw"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1494177194, "post_id": 43833968, "comment_id": 74705371, "body": "@Olaf yes, I need to call it from c++ because I wanna build it for android."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1494177391, "post_id": 43833968, "comment_id": 74705445, "body": "So why use the tag for an unrelated language? C is not C++! Stop spamming tags!"}], "owner": {"reputation": 131, "user_id": 7850797, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/646cecbdd8472ce53970d0550dffb5d8?s=128&d=identicon&r=PG&f=1", "display_name": "no_ideaw", "link": "https://stackoverflow.com/users/7850797/no-ideaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494177396, "creation_date": 1494174995, "last_edit_date": 1494177396, "question_id": 43833968, "link": "https://stackoverflow.com/questions/43833968/how-to-use-golang-methods-in-c", "title": "how to use GOlang methods in C++?", "body": "<p>I'm using a <a href=\"https://github.com/ahmdrz/goinsta\" rel=\"nofollow noreferrer\">GO library</a> for my project. but I am also using Qt creator so I need to bind GOlang to C++. for example there is a method <code>Upload</code> as following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/ahmdrz/goinsta\"\n)\n\nfunc Upload() {\n    insta := goinsta.New(\"USERNAME\", \"PASSWORD\")\n\n    if err := insta.Login(); err != nil {\n        panic(err)\n    }\n\n    defer insta.Logout()\n\n    resp, _ := insta.UploadPhoto(\"PATH_TO_IMAGE\", \"CAPTION\", insta.NewUploadID(), 87,goinsta.Filter_Lark) // default quality is 87\n\n    fmt.Println(resp.Status)\n}\n</code></pre>\n\n<p>this is in golang but I need to use it in C++. How can I call it in C++?</p>\n"}, {"tags": ["arrays", "go", "type-conversion", "slice"], "comments": [{"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 0, "creation_date": 1494169980, "post_id": 43829976, "comment_id": 74702907, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/36429885/convert-uint32-to-byte-and-vice-versa-in-golang\">Convert &#91;&#93;uint32 to &#91;&#93;byte and vice versa in golang</a>"}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 3340499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e043fa179ec7689e0998fd2a11350?s=128&d=identicon&r=PG&f=1", "display_name": "user3340499", "link": "https://stackoverflow.com/users/3340499/user3340499"}, "is_accepted": false, "score": 1, "last_activity_date": 1494151307, "creation_date": 1494151307, "answer_id": 43830161, "question_id": 43829976, "link": "https://stackoverflow.com/questions/43829976/convert-32byte-to-8uint32/43830161#43830161", "title": "Convert [32]byte to [8]uint32", "body": "<p>It seems I can do this using something like:</p>\n\n<pre><code>data_uint32[0] = binary.LittleEndian.Uint32(data_bytes[0:4])\ndata_uint32[1] = binary.LittleEndian.Uint32(data_bytes[4:8])\ndata_uint32[2] = binary.LittleEndian.Uint32(data_bytes[8:12])\ndata_uint32[3] = binary.LittleEndian.Uint32(data_bytes[12:16])\ndata_uint32[4] = binary.LittleEndian.Uint32(data_bytes[16:20])\ndata_uint32[5] = binary.LittleEndian.Uint32(data_bytes[20:24])\ndata_uint32[6] = binary.LittleEndian.Uint32(data_bytes[24:28])\ndata_uint32[7] = binary.LittleEndian.Uint32(data_bytes[28:32])\n</code></pre>\n\n<p>Perhaps there's an even simpler way, but this will do for now.</p>\n"}, {"comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1494155360, "post_id": 43830694, "comment_id": 74698619, "body": "Since there&#39;s a constant number of elements, OP&#39;s unrolled solution <i>may</i> be faster."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1494155725, "post_id": 43830694, "comment_id": 74698706, "body": "@TimCooper Maybe, but he was looking for an <i>easier</i> way, not <i>faster</i>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1494177378, "last_edit_date": 1494177378, "creation_date": 1494154935, "answer_id": 43830694, "question_id": 43829976, "link": "https://stackoverflow.com/questions/43829976/convert-32byte-to-8uint32/43830694#43830694", "title": "Convert [32]byte to [8]uint32", "body": "<h3>Using <code>binary.ByteOrder</code></h3>\n\n<p>The <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow noreferrer\"><code>encoding/binary</code></a> package makes it easy, values of the <a href=\"https://golang.org/pkg/encoding/binary/#ByteOrder\" rel=\"nofollow noreferrer\"><code>binary.ByteOrder</code></a> interface type can be used to read <code>uint32</code> values from byte slices. There is a <code>binary.LittleEndian</code> exported variable which you can use out of the box. Put this in a simple <code>for</code> loop to read all 8 values:</p>\n\n<pre><code>data := [32]byte{1, 0, 0, 0, 2}\nints := [8]uint32{}\n\nfor i := 0; i &lt; len(data); i += 4 {\n    ints[i/4] = binary.LittleEndian.Uint32(data[i:])\n}\n\nfmt.Println(ints)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/rdpwmyUYg1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[1 2 0 0 0 0 0 0]\n</code></pre>\n\n<p>And this of course works for any number of bytes (being multiple of 4), not just for 32.</p>\n\n<h3>Using <code>binary.Read()</code></h3>\n\n<p>Another, even shorter alternative would be to use <a href=\"https://golang.org/pkg/encoding/binary/#Read\" rel=\"nofollow noreferrer\"><code>binary.Read()</code></a>: </p>\n\n<pre><code>func Read(r io.Reader, order ByteOrder, data interface{}) error\n</code></pre>\n\n<p>This of course requires an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a>, for which you may use <a href=\"https://golang.org/pkg/bytes/#NewBuffer\" rel=\"nofollow noreferrer\"><code>bytes.NewBuffer()</code></a>. This way the conversion is a simple line:</p>\n\n<pre><code>data := [32]byte{1, 0, 0, 0, 2}\nints := [8]uint32{}\n\nerr := binary.Read(bytes.NewBuffer(data[:]), binary.LittleEndian, &amp;ints)\n\nfmt.Println(ints, err)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/XnGv4B9r00\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[1 2 0 0 0 0 0 0] &lt;nil&gt;\n</code></pre>\n\n<h3>Using <code>unsafe.Pointer</code></h3>\n\n<p>For completeness, here's yet another, <em>unsafe</em> way. Since arrays are laid out sequentially in memory, both arrays occupy the same size. We can interpret the memory area of the input as a value of the output type:</p>\n\n<pre><code>data := [32]byte{1, 0, 0, 0, 2}\nints := [8]uint32{}\n\nints = *(*[8]uint32)((unsafe.Pointer)(&amp;data))\n\nfmt.Println(ints)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/XSnx80KGKr\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[1 2 0 0 0 0 0 0]\n</code></pre>\n\n<p>This is the most efficient and the most unsafe way to solve your task.</p>\n\n<p>In this case it's safe to do it like presented, but use package <a href=\"https://golang.org/pkg/unsafe/\" rel=\"nofollow noreferrer\"><code>unsafe</code></a> with caution and as a last resort. Many other, seemingly very similar cases might not work. We were \"lucky\" since we had arrays <em>and</em> input was given in little endian byte order, but with slices and / or with different byte order it would be a different story. The above presented 2 other ways are more general and work both with slices and arrays.</p>\n"}], "owner": {"reputation": 129, "user_id": 3340499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e043fa179ec7689e0998fd2a11350?s=128&d=identicon&r=PG&f=1", "display_name": "user3340499", "link": "https://stackoverflow.com/users/3340499/user3340499"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 1, "accepted_answer_id": 43830694, "answer_count": 2, "score": 3, "last_activity_date": 1494177378, "creation_date": 1494149822, "last_edit_date": 1494157222, "question_id": 43829976, "link": "https://stackoverflow.com/questions/43829976/convert-32byte-to-8uint32", "title": "Convert [32]byte to [8]uint32", "body": "<p>I have 256 bits stored in a <code>[32]byte</code>.</p>\n\n<p>I want to convert this to an <code>[8]uint32</code>, with the first <code>uint32</code> storing the first four bytes, etc.</p>\n\n<p>I'm about to write a function that does this by shifting the bits into the correct positions etc, I wonder if there is an easier way to do this in Go?</p>\n"}, {"tags": ["go", "execution"], "comments": [{"owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "edited": false, "score": 1, "creation_date": 1494147463, "post_id": 43829627, "comment_id": 74696517, "body": "This is the execution under Windows 10:  4 Smaller than random num Smaller than random num 5 Smaller than random num Smaller than random num 7 Smaller than random num Smaller than random num 9 Bigger than random num Bigger than random num  8 You guessed correctly in 8 tries"}, {"owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "edited": false, "score": 0, "creation_date": 1494157800, "post_id": 43829627, "comment_id": 74699281, "body": "With Scanln it is an infinite loop, printing smaller than random num"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1494159593, "post_id": 43829627, "comment_id": 74699778, "body": "And is there any error returned (is it a value <code>!= nil</code>?) Both <a href=\"https://golang.org/pkg/fmt/#Scanf\" rel=\"nofollow noreferrer\"><code>Scanf</code></a> and <a href=\"https://golang.org/pkg/fmt/#Scanln\" rel=\"nofollow noreferrer\"><code>Scanln</code></a> return the number of items processed and an error value that you should be checking."}, {"owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "edited": false, "score": 0, "creation_date": 1494160161, "post_id": 43829627, "comment_id": 74699923, "body": "No error is returned. Or at least not in the terminal (command prompt)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1494160812, "post_id": 43829627, "comment_id": 74700095, "body": "You assigned the two values returned by those functions and compared the error returned to ensure it&#39;s equal to <code>nil</code>, right? If it&#39;s not <code>nil</code>, there was a possible problem. See <a href=\"https://play.golang.org/p/4owK6-n31i\" rel=\"nofollow noreferrer\">this example</a>"}, {"owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "edited": false, "score": 0, "creation_date": 1494269375, "post_id": 43829627, "comment_id": 74745923, "body": "Although the problem is solved, would you mind explaining the difference between null and nil?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1494283690, "post_id": 43829627, "comment_id": 74752487, "body": "Some languages call it &quot;null&quot;. Go calls it &quot;nil&quot;. That&#39;s all."}, {"owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "edited": false, "score": 0, "creation_date": 1494303524, "post_id": 43829627, "comment_id": 74757387, "body": "Thanks @Chrono Kitsune"}], "answers": [{"comments": [{"owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "edited": false, "score": 0, "creation_date": 1494167257, "post_id": 43831821, "comment_id": 74702001, "body": "@ChronoKitsune you&#39;re right - go version go1.8.1 windows/amd64,never would&#39;ve thought of that, thanks."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 2, "last_activity_date": 1494162186, "creation_date": 1494162186, "answer_id": 43831821, "question_id": 43829627, "link": "https://stackoverflow.com/questions/43829627/different-execution-under-windows-and-linux-with-go/43831821#43831821", "title": "Different execution under Windows and Linux with Go", "body": "<p>Newlines are different in Linux and Windows, and thus your program behaves differently.</p>\n\n<p>See this issue: <a href=\"https://github.com/golang/go/issues/5391\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/5391</a></p>\n\n<p>To fix this, you can replace your Scanf with this (note the \"\\n\" at the end):</p>\n\n<pre><code>fmt.Scanf(\"%v\\n\",&amp;number)\n</code></pre>\n"}], "owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "accepted_answer_id": 43831821, "answer_count": 1, "score": 2, "last_activity_date": 1494174802, "creation_date": 1494147335, "last_edit_date": 1494174802, "question_id": 43829627, "link": "https://stackoverflow.com/questions/43829627/different-execution-under-windows-and-linux-with-go", "title": "Different execution under Windows and Linux with Go", "body": "<p>I created a very small game of number guessing in Go. The thing is, it executes differently under Windows and under Linux. By executing it on Ubuntu for example, everything works just fine. But when I try to start it under Windows, it compiles just fine but during execution when I enter something (for example 5) it prints me twice \"Smaller than random num\"or \"Bigger than random num\". I have no idea why it happens. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc main () {\n    var number int //declaration\n    var tries int = 0\n    random_number := random(1, 9) //gets random number\n    for ; ;tries++ {\n                //fmt.Printf(\"Enter your prediction: \")\n                fmt.Scanf(\"%v\",&amp;number)\n                if number == random_number {\n                        break;\n                } else if number&lt;random_number{\n                            fmt.Printf(\"Smaller than random num\\n\")\n                } else {\n                            fmt.Printf(\"Bigger than random num\\n\")\n                }\n         }\n    fmt.Printf(\"You guessed correctly in %v tries\",tries)\n\n}\n\n func random(min, max int) int {\n    rand.Seed(time.Now().Unix())\n    return rand.Intn(max - min) + min\n}\n</code></pre>\n"}, {"tags": ["go", "grpc", "handshake"], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": false, "score": 3, "last_activity_date": 1494222678, "creation_date": 1494222678, "answer_id": 43840621, "question_id": 43829022, "link": "https://stackoverflow.com/questions/43829022/failed-to-complete-security-handshake-on-grpc/43840621#43840621", "title": "failed to complete security handshake on grpc?", "body": "<p>If your server certificate doesn't have the domain definition and it's not signed by GIAG3 (like your example), you should add <code>InsecureSkipVerify</code> (this allow you skip the validation of the server name and the server certificate) in the client configuration, that will fix the issue with the invalid name.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>creds := credentials.NewTLS(&amp;tls.Config{\n    ServerName:   addr,\n    Certificates: []tls.Certificate{certificate},\n    RootCAs:      certPool,\n    InsecureSkipVerify: true,\n})\n</code></pre>\n\n<p>But you'll have another problem, because the client is using a self-signed certificate, and the server required a certificate signed by GIAG3 for the authentication (<code>tls.RequireAndVerifyClientCert</code>), so you have some options with this, </p>\n\n<ul>\n<li>you use a certificate signed by GIAG3 for the client.</li>\n<li>reduce the authentication type to <code>tls.RequireAnyClientCert</code>, this allow you use any certificate at the moment of the auth (it could be or not signed by GIAG3), the client just need to use any certificate when it's connected.</li>\n<li>remove the client authentication with certificate.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2387, "user_id": 2397613, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ukaSU.jpg?s=128&g=1", "display_name": "ton", "link": "https://stackoverflow.com/users/2397613/ton"}, "is_accepted": false, "score": 1, "last_activity_date": 1559138200, "creation_date": 1559138200, "answer_id": 56362312, "question_id": 43829022, "link": "https://stackoverflow.com/questions/43829022/failed-to-complete-security-handshake-on-grpc/56362312#56362312", "title": "failed to complete security handshake on grpc?", "body": "<p>If you found this log in <code>journalctl -u docker</code>:</p>\n\n<pre><code>mai 29 10:33:04 ca275nt dockerd[1523]: time=\"2019-05-29T10:33:04.454362399-03:00\" level=warning msg=\"grpc: Server.Serve failed to complete security handshake from \\\"192.168.0.45:58392\\\": remote error: tls: bad certificate\" module=grpc    \n</code></pre>\n\n<p>It can be related with <code>docker swarm</code> requests from another swarm cluster node host trying to connect to docker swarm master node with a invalid token.</p>\n\n<p>You can discover the invalid cluster node hostname with:</p>\n\n<pre><code>nslookup 192.168.0.45                                                                                                                                          \n45.0.168.192.in-addr.arpa       name = hostabc.domain.com.\n45.0.168.192.in-addr.arpa       name = hostabc.\n\nAuthoritative answers can be found from:\n</code></pre>\n\n<p>By running a <code>docker swarm leave</code> on the reported host, resolve the issue. </p>\n\n<p>I know it's not related with the main question, but I was searching for:\n<code>docker \"grpc: Server.Serve failed to complete security handshake from\"</code> and this was the first question. then I think it's useful to put the troubleshooting here to save some time to others.</p>\n"}], "owner": {"reputation": 1091, "user_id": 3387602, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c5ef481e47f40861b734abc7d7973777?s=128&d=identicon&r=PG&f=1", "display_name": "zer09", "link": "https://stackoverflow.com/users/3387602/zer09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7387, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559138200, "creation_date": 1494142921, "question_id": 43829022, "link": "https://stackoverflow.com/questions/43829022/failed-to-complete-security-handshake-on-grpc", "title": "failed to complete security handshake on grpc?", "body": "<p>I've already changed many times the port number on the server and client, but the server always get the incorrect port number.</p>\n\n<p>when I execute the client the server will log this:\n<code>2017/05/07 15:06:07 grpc: Server.Serve failed to complete security handshake from \"127.0.0.1:32763\": remote error: tls: bad certificate</code>\nand on the client side, i got this:\n<code>2017/05/07 15:06:07 Failed to dial localhost:8070: connection error: desc = \"transport: x509: certificate is not valid for any names, but wanted to match localhost:8070\"; please retry.\nrpc error: code = Internal desc = connection error: desc = \"transport: x509: certificate is not valid for any names, but wanted to match localhost:8070\"</code></p>\n\n<p>I have this code for the server.go</p>\n\n<pre><code>func serve() {\n    addr := \"localhost:8070\"\n    crt, key := certificate.CreatePemKey()\n    certificate, err := tls.X509KeyPair(crt, key)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    certPool := x509.NewCertPool()\n    ca, err := ioutil.ReadFile(\"F:/GIAG3.crt\")\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    if ok := certPool.AppendCertsFromPEM(ca); !ok {\n        fmt.Println(\"unable to append certificate\")\n    }\n\n    lis, err := net.Listen(\"tcp\", addr)\n    if err != nil {\n        fmt.Println(\"could not list on %s: %s\", addr, err)\n    }\n\n    // Create the TLS credentials\n    creds := credentials.NewTLS(&amp;tls.Config{\n        ClientAuth:   tls.RequireAndVerifyClientCert,\n        Certificates: []tls.Certificate{certificate},\n        ClientCAs:    certPool,\n    })\n\n    srv := grpc.NewServer(grpc.Creds(creds))\n    pb.RegisterPingerServer(srv, &amp;server{})\n\n    if err := srv.Serve(lis); err != nil {\n        fmt.Println(\"grpc serve error: %s\", err)\n    }\n}\n</code></pre>\n\n<p>and this is for the client.go</p>\n\n<pre><code>func testDial2() {\n    addr := \"localhost:8070\"\n    crt, key := certificate.CreatePemKey()\n    certificate, err := tls.X509KeyPair(crt, key)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    certPool := x509.NewCertPool()\n    ca, err := ioutil.ReadFile(\"F:/GIAG3.crt\")\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    if ok := certPool.AppendCertsFromPEM(ca); !ok {\n        fmt.Println(\"unable to append certificate\")\n    }\n\n    creds := credentials.NewTLS(&amp;tls.Config{\n        ServerName:   addr,\n        Certificates: []tls.Certificate{certificate},\n        RootCAs:      certPool,\n    })\n\n    conn, err := grpc.Dial(addr, grpc.WithTransportCredentials(creds))\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    defer conn.Close()\n    c := pb.NewPingerClient(conn)\n    r, err := c.Ping(context.Background(), &amp;pb.Payload{Message: \"Ping\"})\n    if err != nil {\n        fmt.Println(err)\n    }\n    log.Printf(\"%s\", r.Message)\n}\n</code></pre>\n\n<p>this is for the CreatePemKey, it is based on this example <a href=\"https://golang.org/src/crypto/tls/generate_cert.go\" rel=\"nofollow noreferrer\">https://golang.org/src/crypto/tls/generate_cert.go</a></p>\n\n<pre><code>func publicKey(priv interface{}) interface{} {\n    switch k := priv.(type) {\n    case *rsa.PrivateKey:\n        return &amp;k.PublicKey\n    case *ecdsa.PrivateKey:\n        return &amp;k.PublicKey\n    default:\n        return nil\n    }\n}\n\nfunc pemBlockForKey(priv interface{}) *pem.Block {\n    switch k := priv.(type) {\n    case *rsa.PrivateKey:\n        return &amp;pem.Block{Type: \"RSA PRIVATE KEY\", Bytes: x509.MarshalPKCS1PrivateKey(k)}\n    case *ecdsa.PrivateKey:\n        b, err := x509.MarshalECPrivateKey(k)\n        if err != nil {\n            fmt.Fprintf(os.Stderr, \"Unable to marshal ECDSA private key: %v\", err)\n            os.Exit(2)\n        }\n        return &amp;pem.Block{Type: \"EC PRIVATE KEY\", Bytes: b}\n    default:\n        return nil\n    }\n}\n\nfunc CreatePemKey() (certpem, keypem []byte) {\n    priv, _ := rsa.GenerateKey(rand.Reader, 2048)\n    notBefore := time.Now()\n    notAfter := notBefore.AddDate(1, 0, 0)\n    serialNumberLimit := new(big.Int).Lsh(big.NewInt(1), 128)\n    serialNumber, _ := rand.Int(rand.Reader, serialNumberLimit)\n\n    template := x509.Certificate{\n        SerialNumber: serialNumber,\n        Subject: pkix.Name{\n            Organization: []string{\"Acme Co\"},\n        },\n        NotBefore:             notBefore,\n        NotAfter:              notAfter,\n        KeyUsage:              x509.KeyUsageKeyEncipherment | x509.KeyUsageDigitalSignature,\n        ExtKeyUsage:           []x509.ExtKeyUsage{x509.ExtKeyUsageServerAuth},\n        BasicConstraintsValid: true,\n    }\n    // template.IPAddresses = append(template.IPAddresses, net.ParseIP(\"localhost\"))\n    template.IsCA = true\n    derbytes, _ := x509.CreateCertificate(rand.Reader, &amp;template, &amp;template, publicKey(priv), priv)\n    certpem = pem.EncodeToMemory(&amp;pem.Block{Type: \"CERTIFICATE\", Bytes: derbytes})\n    keypem = pem.EncodeToMemory(pemBlockForKey(priv))\n    return certpem, keypem\n}\n</code></pre>\n\n<p>BTW the GIAG3.crt is came from here <a href=\"https://pki.goog/\" rel=\"nofollow noreferrer\">https://pki.goog/</a></p>\n\n<p>Please help me, thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1494138020, "post_id": 43828374, "comment_id": 74694294, "body": "Go intentionally randomizes map entry order. Is it possible that your range over wordsValues might be coming up with different lowVal and lowValName, depending on the order?"}, {"owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1494138629, "post_id": 43828374, "comment_id": 74694422, "body": "I am not sure how that could be a problem unless the range over wordsValues randomly called duplicates. I suppose I could range over the original slice and explicitly call the value for that name stored in wordsValues to rule it out. I will try that and let you know."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1494139220, "post_id": 43828374, "comment_id": 74694553, "body": "The first thing to do is to compile the program without errors: <code>25:9: k declared and not used</code>."}, {"owner": {"reputation": 1168, "user_id": 2079484, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1e334d2fa189682927dcc80cd1018388?s=128&d=identicon&r=PG", "display_name": "user2027202827", "link": "https://stackoverflow.com/users/2079484/user2027202827"}, "edited": false, "score": 0, "creation_date": 1494139819, "post_id": 43828374, "comment_id": 74694685, "body": "I tried hardcoding the text file and am not seeing any variation in answers. I&#39;m not sure it&#39;s producing the correct answer (the answer it&#39;s producing ends in 928) but it is consistent."}, {"owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "edited": false, "score": 0, "creation_date": 1494139822, "post_id": 43828374, "comment_id": 74694687, "body": "peterSO, fixed. k Was used by a Println that was used for debugging but was removed and I forgot to fix before copy and pasting."}, {"owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "edited": false, "score": 0, "creation_date": 1494140466, "post_id": 43828374, "comment_id": 74694832, "body": "user2027202827 that number sounds correct but I am unsure by what you mean &quot;hardcoding&quot;.  I tried just now tried coding the contents of the file as a string literal and I am still getting the same changing result."}, {"owner": {"reputation": 1168, "user_id": 2079484, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1e334d2fa189682927dcc80cd1018388?s=128&d=identicon&r=PG", "display_name": "user2027202827", "link": "https://stackoverflow.com/users/2079484/user2027202827"}, "edited": false, "score": 0, "creation_date": 1494258025, "post_id": 43828374, "comment_id": 74739363, "body": "It sounds like others have already identified the problem but I just meant that I created an array of the names instead of reading them from a file."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "edited": false, "score": 1, "creation_date": 1494167453, "post_id": 43829254, "comment_id": 74702076, "body": "peterSO (and abhink below), your solution is certainly more compact and (more importantly) accurate, but is there a solution to using the method I was trying? I was challenging myself to do the alphabetizing and this seemed the most direct route. As I mentioned I had also written this using big numbers package but was met with the same issue. Is there any way to correct the floating point inaccuracy problem?"}, {"owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "edited": false, "score": 1, "creation_date": 1494167479, "post_id": 43829254, "comment_id": 74702089, "body": "Also, no disrespect intended, but I don&#39;t really see how the order of iteration over a map in the way that I am using it would be problematic. I am only looking for the lowest value stored in the map and not relying on order in any way. It gives me a convenient way to access both the value and the string. Once again, intend no disrespect, just would like to understand how the use of maps could be problematic in this example."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "edited": false, "score": 0, "creation_date": 1494175871, "post_id": 43829254, "comment_id": 74704913, "body": "@StephenAdams: Your <code>float64</code> <code>wordValue</code> algorithm is hopelessly flawed: <a href=\"https://en.wikipedia.org/wiki/Floating-point_arithmetic\" rel=\"nofollow noreferrer\">Floating-point arithmetic</a>. Keep it simple and use an <code>int64</code> algorithm."}, {"owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "edited": false, "score": 1, "creation_date": 1494192016, "post_id": 43829254, "comment_id": 74710256, "body": "thank you for taking the time to break it down for me. I realize that you and most everyone on this forum likely have much more experience then I and these really are trivial and routine exercises. For most, project euler probably is a place to work on optimization. For me however, with about 17 days of experience with go and limited experience with coding project euler is a great place for me to practice these mundane tasks. I could easily have googled the correct solution and been done and never be able to remember it when it mattered but I choose to do it the hard, ugly, slow way."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1494180956, "last_edit_date": 1494180956, "creation_date": 1494144739, "answer_id": 43829254, "question_id": 43828374, "link": "https://stackoverflow.com/questions/43828374/project-euler-22-with-golang-returns-different-result-every-time/43829254#43829254", "title": "Project Euler #22 with Golang; returns different result every time", "body": "<p>The use of floating point is suspicious, it's imprecise. The iteration order over maps is not specified and is not guaranteed to be the same from one iteration to the next. Your use of maps is the most likely explanation for seemingly random behavior. </p>\n\n<hr>\n\n<p>The first question to ask is: What is the right answer?</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"strings\"\n)\n\nfunc readNames(f string) []string {\n    b, err := ioutil.ReadFile(f)\n    if err != nil {\n        log.Fatal(err)\n    }\n    s := string(bytes.Replace(b, []byte(`\"`), []byte(``), -1))\n    return strings.Split(s, \",\")\n}\n\nfunc totalScores(names []string) int64 {\n    for i := 0; i &lt; len(names); i++ {\n        for j := i + 1; j &lt; len(names); j++ {\n            if names[i] &gt; names[j] {\n                names[i], names[j] = names[j], names[i]\n            }\n        }\n    }\n\n    total := int64(0)\n    for i, name := range names {\n        score := int64(0)\n        for _, char := range name {\n            score += int64(char - 'A' + 1)\n        }\n        score *= int64(i) + 1\n        total += score\n    }\n    return total\n}\n\nfunc main() {\n    names := readNames(\"p022_names.txt\")\n    total := totalScores(names)\n    fmt.Println(\"The total is: \", total)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>The total is:  871198282\n</code></pre>\n\n<p>This is how Project Euler expected you to write the first version of your solution. Your second version should replace the simple selection sort with a faster sort, like Quicksort.</p>\n\n<p>For example, your program takes a long time to produce the wrong result:</p>\n\n<pre><code>The total is:  871197995\nreal    0m1.945s\nuser    0m1.944s\nsys     0m0.004s\n</code></pre>\n\n<p>My program produces the correct result and is faster:</p>\n\n<pre><code>The total is:  871198282\nreal    0m0.771s\nuser    0m0.768s\nsys     0m0.004s\n</code></pre>\n\n<p>If we replace my selection sort with a Go sort:</p>\n\n<pre><code>sort.StringSlice(names).Sort()\n</code></pre>\n\n<p>The revised program produces the correct result and it's much faster:</p>\n\n<pre><code>The total is:  871198282\nreal    0m0.014s\nuser    0m0.012s\nsys     0m0.000s\n</code></pre>\n\n<p>Project Euler, Names scores, Problem 22 is about fast sort algorithms, not about the trivial calculation of scores.</p>\n\n<hr>\n\n<p>For a stable result from your code, comment out the <code>delete</code> statement:</p>\n\n<pre><code>// delete(wordsValues, lowValName)\n</code></pre>\n\n<p>Now you are left with the floating-point error: <a href=\"https://en.wikipedia.org/wiki/Floating-point_arithmetic\" rel=\"nofollow noreferrer\">Floating-point arithmetic</a> and <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow noreferrer\">IEEE floating point</a>.</p>\n\n<hr>\n\n<p>Your algorithm creates approximate, non-unique floating-point <code>wordValue</code>s. Therefore, the random iteration over the map may choose some different <code>lowVal</code> and <code>lowValName</code> pairs and different map entries may be deleted.</p>\n\n<p>Non-unique <code>wordValue</code>s:</p>\n\n<pre><code>0.657666698284738\n0.6576697465786885\n0.6576697465786885\n0.6576698865786884\n0.6578786577658275\n0.6578847978698485\n0.658571858384738\n0.6669827865826875\n0.6765847269827377\n0.676976698384738\n0.677282738384698\n0.6772827383847367\n0.6772827383847367\n0.677282738384738\n0.677282738384738\n0.6772827383847982\n0.6776697769788476\n0.6982786983847379\n0.6986657871697675\n0.7076798269786776\n0.7076798269788476\n0.7082657867698368\n0.7082657867738368\n0.7082696869827366\n0.7082696869827366\n0.7165668273697676\n0.716979827169658\n0.7169798271698486\n0.716979827173658\n0.716979827173658\n0.716979827173658\n0.7185737676698277\n0.7269788273698486\n0.7273766869716582\n0.7465678185697674\n0.746567818569769\n0.746567818569769\n0.7469657878698486\n0.7479836980727379\n0.7565847265827377\n0.7565847269827377\n0.7573776669827669\n0.7765716865766978\n0.7765826769767379\n0.7765826769767379\n0.7765827165826985\n0.7765827165826985\n0.7765827165826985\n0.7765827165826985\n0.7765827165827385\n0.7765827165827385\n0.7765827185698275\n0.7773677269767378\n0.827983657673787\n0.8384698072657875\n0.8472797765837379\n0.8665766978847378\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 4, "last_activity_date": 1494166551, "last_edit_date": 1494166551, "creation_date": 1494149959, "answer_id": 43829991, "question_id": 43828374, "link": "https://stackoverflow.com/questions/43828374/project-euler-22-with-golang-returns-different-result-every-time/43829991#43829991", "title": "Project Euler #22 with Golang; returns different result every time", "body": "<p>You are correct about the fault in your code being related to floating point numbers. Take these two names for example:</p>\n\n<pre><code>[\"BERNARDINE\", \"BERNARDINA\"]\n</code></pre>\n\n<p>If you simply run your code on this input set, you get the following value for <code>wordsValues</code>:</p>\n\n<pre><code>map[BERNARDINE:0.6669827865826875 BERNARDINA:0.6669827865826875]\n</code></pre>\n\n<p>As you can clearly see, both these keys map to same value due to loss in floating point number precision. And as it has already been mentioned that map iteration order is <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">randomized</a> in Go, it is possible that your sorting algorithm is producing incorrect result (some iteration may put <code>BERNARDINE</code> before <code>BERNARDINA</code> since both will have same values).</p>\n\n<p>Since <code>float64</code> supports up to 15 significant digits, names having more than 8 characters could spell trouble.</p>\n\n<p>The best solution is to use pre-existing sorting procedure as already detailed by @peterSO above.</p>\n"}], "owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1494180956, "creation_date": 1494137347, "last_edit_date": 1494139670, "question_id": 43828374, "link": "https://stackoverflow.com/questions/43828374/project-euler-22-with-golang-returns-different-result-every-time", "title": "Project Euler #22 with Golang; returns different result every time", "body": "<p>I am doing problem 22 of Project Euler with Go, which I am new to, and my code gives me inconsistent results meaning every time I run the program it shows a different result. It is always very close to what I have seen is the correct answer but ranges around within several hundred points. I originally thought it may have been due to float rounding inaccuracy but I have checked and that is not the case(I think). \nI would really appreciate it if someone could point out what may be going on that would cause this. I have struggled to find the problem with my code for several days and have not been able to solve it or even find similar issues on forums.\nAs a side note I originally wrote this using the golang math/big package and was getting the same changing results.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"math\"\n    \"strings\"\n)\n\nfunc openFileReturnSlice(f string) []string {\n    bytes, err := ioutil.ReadFile(f)\n    if err != nil {\n        log.Fatal(\"Failed to read file: p022_names.txt\")\n    }\n    s2s := strings.Split(string(bytes), \"\\\"\")\n    s22 := strings.Join(s2s, \"\")\n    names := strings.Split(s22, \",\")\n    return names\n}\n\nfunc alphabetize(n []string) ([]string, map[string]int) {\n    wordsValues := make(map[string]float64)\n    wordLetterVal := make(map[string]int)\n    for _, s := range n {\n        loop := -1\n        var wordValue float64\n        alpha := int(0)\n        for _, l := range s {\n            ell := int(l) - 64\n            mvDec := math.Pow(100, math.Abs(float64(loop)))\n            wordValue += float64(l) / mvDec\n            alpha += ell\n            loop--\n        }\n        wordsValues[s] = wordValue\n        wordLetterVal[s] = alpha\n    }\n    var sortedNames []string\n    lenWordValues := len(wordsValues)\n    for i := 0; i &lt; lenWordValues; i++ {\n        var lowValName string\n        lowVal := float64(10)\n        for k, v := range wordsValues {\n            if v &lt; lowVal {\n                lowVal = v\n                lowValName = k\n            }\n        }\n        delete(wordsValues, lowValName)\n        sortedNames = append(sortedNames, lowValName)\n    }\n    return sortedNames, wordLetterVal\n}\n\nfunc main() {\n    names := openFileReturnSlice(\"p022_names.txt\")\n    alphabetical, sumAlphaValues := alphabetize(names)\n    var total int\n    for k := 0; k &lt; len(alphabetical); k++ {\n        var temp int\n        key := k + 1\n        temp = sumAlphaValues[alphabetical[k]] * key\n        total += temp\n    }\n    fmt.Println(\"The total is: \", total)\n}\n</code></pre>\n"}, {"tags": ["go", "vagrant", "phpstorm"], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 3203950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60c803c142f030d6d44d4cbfc69c67ce?s=128&d=identicon&r=PG&f=1", "display_name": "gutierri", "link": "https://stackoverflow.com/users/3203950/gutierri"}, "is_accepted": false, "score": 0, "last_activity_date": 1494174405, "creation_date": 1494174405, "answer_id": 43833851, "question_id": 43828254, "link": "https://stackoverflow.com/questions/43828254/how-to-configure-phpstorm-to-read-golang-environment-variable-goroot-from-vagran/43833851#43833851", "title": "How to configure PhpStorm to read GoLang environment variable GOROOT from Vagrant VM", "body": "<p>PHPStorm connect to the VM. Read this\u00b9 text from a JetBrains conference and see if it helps.</p>\n\n<p>[1] <a href=\"https://confluence.jetbrains.com/display/PhpStorm/Working+with+Advanced+Vagrant+features+in+PhpStorm\" rel=\"nofollow noreferrer\">https://confluence.jetbrains.com/display/PhpStorm/Working+with+Advanced+Vagrant+features+in+PhpStorm</a></p>\n"}], "owner": {"reputation": 942, "user_id": 1104431, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4aa311ac8fffa8af85daf2c03a919728?s=128&d=identicon&r=PG", "display_name": "kagundajm", "link": "https://stackoverflow.com/users/1104431/kagundajm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494174405, "creation_date": 1494136223, "last_edit_date": 1494153576, "question_id": 43828254, "link": "https://stackoverflow.com/questions/43828254/how-to-configure-phpstorm-to-read-golang-environment-variable-goroot-from-vagran", "title": "How to configure PhpStorm to read GoLang environment variable GOROOT from Vagrant VM", "body": "<p>How can one configure <code>GOROOT</code> setting in PhpStorm to read the value from a Vagrant VM?</p>\n\n<p>My host is Windows 10.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494165726, "post_id": 43827507, "comment_id": 74701540, "body": "Thanks @OliviaRuth, it works.  Please write a answer on this so I can accept it."}], "answers": [{"comments": [{"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1494165255, "post_id": 43827545, "comment_id": 74701413, "body": "I got the same resultl when printing <code>runtime.Version()</code>:  <code>$ go run te.go xgcc (Ubuntu 4.9.3-0ubuntu4) 4.9.3</code>"}, {"owner": {"reputation": 152, "user_id": 2758145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a6032fcaf4d1bc58ea4381d9b4da2d?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil Kumar", "link": "https://stackoverflow.com/users/2758145/sunil-kumar"}, "edited": false, "score": 0, "creation_date": 1585990723, "post_id": 43827545, "comment_id": 107963650, "body": "There is no need to write the small program to get the version of <code>go</code> what you can do is that go to the terminal in ubuntu and run command <code>go version</code>  and you would receive the version of your go. <code>go version go1.10.4 linux&#47;amd64</code>   Also, for new comers, if you are writing the small program don&#39;t forget to add import of <code>runtime</code> package. Cheers"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 5, "last_activity_date": 1494128017, "creation_date": 1494128017, "answer_id": 43827545, "question_id": 43827507, "link": "https://stackoverflow.com/questions/43827507/find-go-version/43827545#43827545", "title": "Find go version", "body": "<p>Perhaps write a small program to print <a href=\"https://golang.org/pkg/runtime/#Version\" rel=\"noreferrer\">runtime.Version()</a> ?</p>\n"}], "owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20477, "favorite_count": 1, "closed_date": 1494173320, "answer_count": 1, "score": 15, "last_activity_date": 1494128017, "creation_date": 1494127592, "question_id": 43827507, "link": "https://stackoverflow.com/questions/43827507/find-go-version", "closed_reason": "Duplicate", "title": "Find go version", "body": "<p>Why can't I find the version of go on my ubuntu 14.04? The output of <code>go version</code> doesn't give me info on whether the <code>go</code> is 1.7 or 1.8. Any ideas?</p>\n\n<pre><code>$ go version\ngo version xgcc (Ubuntu 4.9.3-0ubuntu4) 4.9.3 linux/amd64\n$ uname -a\nLinux jin1-hp1 3.19.0-65-generic #73~14.04.1-Ubuntu SMP Wed Jun 29 21:05:22 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n\n<p>Following another post, I found it from the command of <code>docker</code>, but I would like to find the version from <code>go</code> command itself.</p>\n\n<pre><code>$ docker version\nClient:\n Version:      1.11.2\n API version:  1.23\n Go version:   go1.5.4\n Git commit:   b9f10c9\n Built:        Wed Jun  1 21:47:50 2016\n OS/Arch:      linux/amd64\nCannot connect to the Docker daemon. Is the docker daemon running on this host?\n</code></pre>\n"}, {"tags": ["gcc", "docker", "go", "gccgo", "docker-engine"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1494155515, "post_id": 43826843, "comment_id": 74698668, "body": "have you tried to configure GOBIN=&quot;&quot; to point to the desired location ? /opt/gopath/bin see also <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-GOPATH_environment_variable</a>: <code>If the GOBIN environment variable is set, commands are installed to the directory it names instead of DIR&#47;bin. GOBIN must be an absolute path</code> not sure what means &quot;commands are installed to the directory it names&quot;"}, {"owner": {"reputation": 21, "user_id": 6283163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef06fe7a801f826f90aa3b0c138121?s=128&d=identicon&r=PG&f=1", "display_name": "chingy", "link": "https://stackoverflow.com/users/6283163/chingy"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1494260975, "post_id": 43826843, "comment_id": 74741149, "body": "@mh-cbon yes I have tried setting the GOBIN, and I made sure that GOBIN was an absolute path. It does look like the .a files were generated fine, but at the end I am missing a linker invocation."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1494322286, "post_id": 43826843, "comment_id": 74767362, "body": "if that is a builder environment problem, you might want to try the ML@go-nuts"}], "owner": {"reputation": 21, "user_id": 6283163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef06fe7a801f826f90aa3b0c138121?s=128&d=identicon&r=PG&f=1", "display_name": "chingy", "link": "https://stackoverflow.com/users/6283163/chingy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494118969, "creation_date": 1494118969, "question_id": 43826843, "link": "https://stackoverflow.com/questions/43826843/go-install-fail-to-generate-binary", "title": "go install fail to generate binary", "body": "<p>There are two folds to this problem:</p>\n\n<p>1) Go install not able to generate binary</p>\n\n<pre><code>go version go1.7.3 linux/amd64\n\ngo env:\nGOARCH=\"amd64\" GOBIN=\"\" GOEXE=\"\" GOHOSTARCH=\"amd64\" GOHOSTOS=\"linux\" GOOS=\"linux\" GOPATH=\"/opt/gopath\" GORACE=\"\" GOROOT=\"/opt/go\" GOTOOLDIR=\"/opt/go/pkg/tool/linux_amd64\" CC=\"gcc\" GOGCCFLAGS=\"-fPIC\n-m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build831334660=/tmp/go-build -gno-record-gcc-switches\" CXX=\"g++\" CGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Source of the program: <code>https://github.com/hyperledger/fabric</code></p>\n\n<p>Working dir: <code>/opt/gopath/src/github.com/hyperledger/fabric</code></p>\n\n<p>Main program to build: <code>/opt/gopath/src/github.com/hyperledger/fabric/peer/main.go</code></p>\n\n<p>Build command:</p>\n\n<pre><code>CGO_ENABLED=0 GOBIN=/opt/gopath/bin go install -x -ldflags \" -X github.com/hyperledger/fabric/common/metadata.Version=1.0.0-snapshot-d6fbfcf -X github.com/hyperledger/fabric/common/metadata.BaseVersion=0.3.0 -X github.com/hyperledger/fabric/common/metadata.BaseDockerLabel=org.hyperledger.fabric -X github.com/hyperledger/fabric/common/metadata.DockerNamespace=hyperledger -X github.com/hyperledger/fabric/common/metadata.BaseDockerNamespace=hyperledger -linkmode external -extldflags -static -lpthread\" github.com/hyperledger/fabric/peer\n</code></pre>\n\n<p>I expect the binary built in <code>/opt/gopath/bin</code> but there was nothing there.</p>\n\n<p>It shows on the console that series of .a files were built and moved to <code>/opt/gopath/pkg/linux_amd64/</code>\nEventually program stopped and no binary was built.\nThis is true regardless CGO_ENABLED was set to 0 or 1.</p>\n\n<p>Somehow the program thoughts it was done, without linking the object files and building the binary? Any other debugging measures that I can use to look further into it?</p>\n\n<p>2) The 'Go install' command was taken from Makefile  </p>\n\n<pre><code>@$(DRUN) \\\n-v $(abspath build/docker/bin):/opt/gopath/bin \\\n-v $(abspath build/docker/$(TARGET)/pkg):/opt/gopath/pkg \\\nhyperledger/fabric-baseimage:$(BASE_DOCKER_TAG) \\\ngo install -compiler gccgo -ldflags \"$(DOCKER_GO_LDFLAGS)\" $(pkgmap.$(@F))\n\nwhere \nDRUN = docker run -i --rm $(DOCKER_RUN_FLAGS) \\\n-v $(abspath .):/opt/gopath/src/$(PKGNAME) \\\n-w /opt/gopath/src/$(PKGNAME)\n</code></pre>\n\n<p>The <code>'Go install'</code> command was run inside a docker container, which was started the same way the Makefile specified. The only difference was that I was doing it manually, in two shots, i.e. start docker container + go install. If I were to build it with Makefile in one shot, it would work just fine.</p>\n\n<p>Is there any catch/caveat on using this <code>'docker run &lt;image&gt; go install &lt;args&gt;'</code> style command?</p>\n"}, {"tags": ["python", "mongodb", "python-3.x", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": true, "score": 1, "last_activity_date": 1494123588, "creation_date": 1494123588, "answer_id": 43827212, "question_id": 43826463, "link": "https://stackoverflow.com/questions/43826463/array-of-strings-sorting-as-array-of-interfaces-with-mgo-in-golang/43827212#43827212", "title": "array of strings sorting as array of Interfaces with mgo in golang", "body": "<p>First you can change the <code>results</code> variable from the query using your <code>[]CatMixing</code>. Because <code>.All(result interface{})</code> needs an <code>interace{}</code> argument doesn't mean you can't pass your struct. </p>\n\n<p>Note that <code>interface{}</code> in Go can hold any type including your struct.</p>\n\n<p>try this code : </p>\n\n<pre><code>var results [] CatMixing\nerr := c.Find(bson.M{}).Limit(10).All(&amp;results)\nif err != nil {\n   fmt.Fatal(err)\n}\nfmt.Println(results)\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 43827212, "answer_count": 1, "score": 1, "last_activity_date": 1494123588, "creation_date": 1494114460, "last_edit_date": 1494115822, "question_id": 43826463, "link": "https://stackoverflow.com/questions/43826463/array-of-strings-sorting-as-array-of-interfaces-with-mgo-in-golang", "title": "array of strings sorting as array of Interfaces with mgo in golang", "body": "<p>here is my code  :</p>\n\n<pre><code>type CatMixing struct {\n    Id      bson.ObjectId `json:\"id\" bson:\"_id,omitempty\"`\n    CatMix []string  `json:\"comb\"`\n}\n\nfunc main(){\n    session, err := mgo.Dial(\"127.0.0.1\")\n    if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n    c := session.DB(\"MixiIng\").C(\"Combination\")\n    var results []bson.M\n    err5 := c.Find(nil).Limit(10).All(&amp;results)\n    if err5 == nil {\n\n    }\n        fmt.Println(results)\n    for _,catm := range results {\n        fmt.Println(catm)\n        for _,catm2 := range catm {\n            fmt.Println(reflect.TypeOf(catm2))\n\n        }\n\n    }\n\n\n}\n</code></pre>\n\n<p>the problem is that it seems that comb is an array of interfaces  :</p>\n\n<pre><code>map[_id:ObjectIdHex(\"590e5cb36aace327da180c89\") comb:[60fps]]\nbson.ObjectId\n[]interface {}\n</code></pre>\n\n<p>but in mongo it shows as an array of string  :</p>\n\n<p><a href=\"https://i.stack.imgur.com/2Kdg3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Kdg3.png\" alt=\"60FPS\"></a></p>\n\n<p>So my mapping is not working ...\nIf i try with : </p>\n\n<pre><code>var results []CatMixing\n</code></pre>\n\n<p>i have the _id but not comb , comb appears as empty</p>\n\n<p>I don't understand why it's not an array of string and why my mapping is not working.</p>\n\n<p>I've added data to mongodb with python : </p>\n\n<pre><code>from pymongo import MongoClient\nclient = MongoClient()\ndb = client['MixiIng']\ncollection = db['Combination']\ncombination = {}\nresult = [[\"60fps\"]]\nfor r in result :\n    combination = {\"comb\":r}\n    collection.insert_one(combination)\n</code></pre>\n\n<p>So i don't understand why comb is not an array of string and how to get it...</p>\n\n<p>thanks and regards</p>\n"}, {"tags": ["http", "post", "go"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494114414, "post_id": 43826412, "comment_id": 74690718, "body": "Build the URL with fmt.Sprintf"}, {"owner": {"reputation": 489, "user_id": 1401162, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/34ccb916234d4117540155fed4e4ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Vipercold", "link": "https://stackoverflow.com/users/1401162/vipercold"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494114530, "post_id": 43826412, "comment_id": 74690740, "body": "Cool... there&#39;s some more elegant way to do this? or just using another http client library?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1494155716, "post_id": 43826412, "comment_id": 74698701, "body": "are you looking for url api ? <a href=\"https://golang.org/pkg/net/url/#example_ParseQuery\" rel=\"nofollow noreferrer\">golang.org/pkg/net/url/#example_ParseQuery</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494192408, "post_id": 43826412, "comment_id": 74710358, "body": "More elegant how? You&#39;re injecting a string into another string, Sprintf does precisely that. What specifically are you looking for beyond &quot;put string x at this position in string y&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 1786, "user_id": 942301, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ddb4bd469282ec26eba7f527151516fb?s=128&d=identicon&r=PG", "display_name": "Savaratkar", "link": "https://stackoverflow.com/users/942301/savaratkar"}, "edited": false, "score": 0, "creation_date": 1567599140, "post_id": 43834709, "comment_id": 102009585, "body": "How to also incorporate a body in this?"}], "tags": [], "owner": {"reputation": 464, "user_id": 6135914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnNc6.jpg?s=128&g=1", "display_name": "JT.", "link": "https://stackoverflow.com/users/6135914/jt"}, "is_accepted": true, "score": 2, "last_activity_date": 1494179246, "creation_date": 1494179246, "answer_id": 43834709, "question_id": 43826412, "link": "https://stackoverflow.com/questions/43826412/how-to-properly-set-path-params-in-url-using-golang-http-client/43834709#43834709", "title": "How to properly set path params in url using golang http client?", "body": "<p>If you are trying to add params to a URL before you make a server request you can do something like this.</p>\n\n<pre><code>const (\n    sellersURL = \"http://myhost.com/v1/sellers\"\n)\n\nq := url.Values{}\nq.Add(\"id\", \"1\")\n\nreq, err := http.NewRequest(\"POST\", sellersURL, strings.NewReader(q.Encode()))\nif err != nil {\n    return err\n}\n\nreq.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")\nreq.Close = true\n\nresp, err := http.DefaultClient.Do(req)\nif err != nil {\n    return err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 5072889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc7f50398fd02c8a967eb99e1ddeef22?s=128&d=identicon&r=PG&f=1", "display_name": "palestamp", "link": "https://stackoverflow.com/users/5072889/palestamp"}, "is_accepted": false, "score": 1, "last_activity_date": 1494184335, "creation_date": 1494184335, "answer_id": 43835555, "question_id": 43826412, "link": "https://stackoverflow.com/questions/43826412/how-to-properly-set-path-params-in-url-using-golang-http-client/43835555#43835555", "title": "How to properly set path params in url using golang http client?", "body": "<p>There is one place where I saw more elegant way to do this (without fmt.Sprintf): <a href=\"https://godoc.org/google.golang.org/api/googleapi/internal/uritemplates#example-Expand\" rel=\"nofollow noreferrer\">uritemplates</a></p>\n"}], "owner": {"reputation": 489, "user_id": 1401162, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/34ccb916234d4117540155fed4e4ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Vipercold", "link": "https://stackoverflow.com/users/1401162/vipercold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4070, "favorite_count": 0, "accepted_answer_id": 43834709, "answer_count": 2, "score": 3, "last_activity_date": 1494184335, "creation_date": 1494113915, "question_id": 43826412, "link": "https://stackoverflow.com/questions/43826412/how-to-properly-set-path-params-in-url-using-golang-http-client", "title": "How to properly set path params in url using golang http client?", "body": "<p>I'm using net/http package and i would like to set dynamic values to an POST url:</p>\n\n<p><a href=\"http://myhost.com/v1/sellers/\" rel=\"nofollow noreferrer\">http://myhost.com/v1/sellers/</a>{id}/whatever</p>\n\n<p>How can i set id values in this path parameter?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494099966, "post_id": 43824649, "comment_id": 74687493, "body": "You must show actual code."}, {"owner": {"reputation": 57, "user_id": 5081941, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ebbaa05eb3f2fece6685b69bebf6b564?s=128&d=identicon&r=PG&f=1", "display_name": "shishh03", "link": "https://stackoverflow.com/users/5081941/shishh03"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494100094, "post_id": 43824649, "comment_id": 74687524, "body": "I think my sample code in the link above is enough to get me started. If you run that code, you can see its printing the same output. What I want is iterate through the ids and print all of them"}, {"owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 1, "creation_date": 1494103577, "post_id": 43824649, "comment_id": 74688463, "body": "I don&#39;t have the time to debug this code but I suggest you read this whole document:  <a href=\"https://github.com/golang/go/wiki/CommonMistakes#using-goroutines-on-loop-iterator-variables\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5081941, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ebbaa05eb3f2fece6685b69bebf6b564?s=128&d=identicon&r=PG&f=1", "display_name": "shishh03", "link": "https://stackoverflow.com/users/5081941/shishh03"}, "edited": false, "score": 0, "creation_date": 1494107403, "post_id": 43825250, "comment_id": 74689406, "body": "thanks, that makes sense however, now I&#39;m stuck on &quot;all goroutines are asleep- deadlock&quot;. I&#39;ve been trying to add waitgroups and close the channel but not getting far. Any suggestions?"}], "tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": true, "score": 2, "last_activity_date": 1494103723, "creation_date": 1494103723, "answer_id": 43825250, "question_id": 43824649, "link": "https://stackoverflow.com/questions/43824649/how-do-i-close-all-the-goroutines-that-are-asleep/43825250#43825250", "title": "How do I close all the goroutines that are &quot;asleep&quot;?", "body": "<p>You started 3 goroutines (<code>go serviceReq(i, httpCh)</code>) passing them a channel. And then you receive on that channel only <b>once</b> (<code>ch := (&lt;-httpCh).serviceData</code>).</p>\n\n<p>Instead of that you should receive in a loop:</p>\n\n<pre><code>for resp := range httpCh {\n    output = append(output, resp.serviceData)\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5081941, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ebbaa05eb3f2fece6685b69bebf6b564?s=128&d=identicon&r=PG&f=1", "display_name": "shishh03", "link": "https://stackoverflow.com/users/5081941/shishh03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 43825250, "answer_count": 1, "score": -1, "last_activity_date": 1494957924, "creation_date": 1494099443, "last_edit_date": 1494957924, "question_id": 43824649, "link": "https://stackoverflow.com/questions/43824649/how-do-i-close-all-the-goroutines-that-are-asleep", "title": "How do I close all the goroutines that are &quot;asleep&quot;?", "body": "<p>I have a goroutine running in a for loop:</p>\n\n<pre><code>    func main(){\n           for _, i := range x{\n               go httpRequests(i, ch)\n           }\n\n           for i := range ch{\n              print i\n\n        }\n    }\n\nfunc httpRequests(i, ch){\n           for _, x := range y{\n               go func(string x){\n                  do something with i\n                  ch &lt;- result\n              }(x)\n           }\n\n\n           }\n</code></pre>\n\n<p>When I run that, it says all goroutines are asleep. Any suggestions?</p>\n"}, {"tags": ["go", "travis-ci"], "comments": [{"owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "edited": false, "score": 0, "creation_date": 1494099860, "post_id": 43824546, "comment_id": 74687472, "body": "For cross platform compilation in Go, check out <a href=\"https://github.com/mitchellh/gox\" rel=\"nofollow noreferrer\">gox</a>.  It&#39;s makes building for all possible platforms a breeze!"}, {"owner": {"reputation": 2008, "user_id": 710618, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/779233af08fd9f187990a44146f1778c?s=128&d=identicon&r=PG", "display_name": "Alexandre Thenorio", "link": "https://stackoverflow.com/users/710618/alexandre-thenorio"}, "reply_to_user": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "edited": false, "score": 1, "creation_date": 1494115416, "post_id": 43824546, "comment_id": 74690891, "body": "Thank you but I am avoiding gox on purpose as I want to keep to the standard tooling as much as I can. Besides I am not having problems building, it is the publishing that is the issue"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1494156374, "post_id": 43824546, "comment_id": 74698896, "body": "is this of interest <a href=\"https://github.com/travis-ci/travis-ci/issues/929\" rel=\"nofollow noreferrer\">github.com/travis-ci/travis-ci/issues/929</a> ? Maybe you can use script deploy and do some bash trick to skip or upload <a href=\"https://docs.travis-ci.com/user/deployment/script/\" rel=\"nofollow noreferrer\">docs.travis-ci.com/user/deployment/script</a>."}], "owner": {"reputation": 2008, "user_id": 710618, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/779233af08fd9f187990a44146f1778c?s=128&d=identicon&r=PG", "display_name": "Alexandre Thenorio", "link": "https://stackoverflow.com/users/710618/alexandre-thenorio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1494099789, "creation_date": 1494098648, "question_id": 43824546, "link": "https://stackoverflow.com/questions/43824546/how-to-create-github-release-using-travisci-from-multiple-build-matrixes", "title": "How to create github release using TravisCI from multiple build matrixes?", "body": "<p>I have setup a simple go repository and configured TravisCI in the following way</p>\n\n<pre><code>language: go\n\ngo:\n  - 1.8.x\n  - master\n\ngobuild_args: -ldflags \"-X main.Version=${TRAVIS_TAG} -X main.buildTime=`date -u '+%Y-%m-%d_%I:%M:%S%p'` -X main.commitId=${TRAVIS_COMMIT}\"\n\nenv:\n  - GOOS=linux GOARCH=amd64\n  - GOOS=windows GOARCH=amd64\n\nafter_success:\n  - ./build.sh\n\nmatrix:\n  allow_failures:\n  - go: master\n</code></pre>\n\n<p>This will essentially create 4 different builds in TravisCI. This is great for building a cross compilation project where I can build windows and linux binaries separately.</p>\n\n<p>What I have been struggling to do is to create 1 single release in Github from all the binaries generated across those builds?</p>\n\n<p>TravisCI documentation says they support releases but it is very vague on how to handle such a scenario.</p>\n\n<ul>\n<li>Don't all the the build run on different virtual servers? If so how do I specify the file in each</li>\n<li>If I setup a release will it run for each build? How does work with github, will it fail because the release will be attempted to be created several times?</li>\n</ul>\n\n<p>Has anybody attempted this?</p>\n"}, {"tags": ["go", "rsa", "x509certificate", "pem", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 1091, "user_id": 3387602, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c5ef481e47f40861b734abc7d7973777?s=128&d=identicon&r=PG&f=1", "display_name": "zer09", "link": "https://stackoverflow.com/users/3387602/zer09"}, "edited": false, "score": 0, "creation_date": 1494137942, "post_id": 43828190, "comment_id": 74694280, "body": "thanks a lot, I was late for few minutes to post may own solution. My solution is quite similar to you. For reference, I just dig this up <a href=\"https://golang.org/src/crypto/tls/generate_cert.go\" rel=\"nofollow noreferrer\">golang.org/src/crypto/tls/generate_cert.go</a>, this also a good example and my solution base on that link."}], "tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 5, "last_activity_date": 1494135426, "creation_date": 1494135426, "answer_id": 43828190, "question_id": 43822945, "link": "https://stackoverflow.com/questions/43822945/golang-can-i-create-x509keypair-using-rsa-key/43828190#43828190", "title": "golang, can i create X509KeyPair using rsa key?", "body": "<p>If you want to generate your own certificate and private key, you have to do:</p>\n\n<p>1.- Generate private key:</p>\n\n<pre><code>key, err := rsa.GenerateKey(rand.Reader, 2048)\nif err != nil {\n    log.Fatal(\"Private key cannot be created.\", err.Error())\n}\n\n// Generate a pem block with the private key\nkeyPem := pem.EncodeToMemory(&amp;pem.Block{\n    Type:  \"RSA PRIVATE KEY\",\n    Bytes: x509.MarshalPKCS1PrivateKey(key),\n})\n</code></pre>\n\n<p>2.- Generate the certificate:</p>\n\n<pre><code>tml := x509.Certificate{\n    // you can add any attr that you need\n    NotBefore:    time.Now(),\n    NotAfter:     time.Now().AddDate(5, 0, 0),\n    // you have to generate a different serial number each execution\n    SerialNumber: big.NewInt(123123),\n    Subject: pkix.Name{\n        CommonName:   \"New Name\",\n        Organization: []string{\"New Org.\"},\n    },\n    BasicConstraintsValid: true,\n}\ncert, err := x509.CreateCertificate(rand.Reader, &amp;tml, &amp;tml, &amp;key.PublicKey, key)\nif err != nil {\n    log.Fatal(\"Certificate cannot be created.\", err.Error())\n}\n\n// Generate a pem block with the certificate\ncertPem := pem.EncodeToMemory(&amp;pem.Block{\n    Type:  \"CERTIFICATE\",\n    Bytes: cert,\n})\n</code></pre>\n\n<p>3.- Load certificate/private key pair:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>tlsCert, err := tls.X509KeyPair(certPem, keyPem)\nif err != nil {\n    log.Fatal(\"Cannot be loaded the certificate.\", err.Error())\n}\n</code></pre>\n\n<p>4.- Use the <code>tlsCert</code> for whatever you want, ex:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>l, err := tls.Listen(\"tcp\", \":8080\", &amp;tls.Config{\n    Certificates: []tls.Certificate{tlsCert},\n})\n</code></pre>\n"}], "owner": {"reputation": 1091, "user_id": 3387602, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c5ef481e47f40861b734abc7d7973777?s=128&d=identicon&r=PG&f=1", "display_name": "zer09", "link": "https://stackoverflow.com/users/3387602/zer09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1608, "favorite_count": 1, "accepted_answer_id": 43828190, "answer_count": 1, "score": 0, "last_activity_date": 1494135426, "creation_date": 1494088978, "question_id": 43822945, "link": "https://stackoverflow.com/questions/43822945/golang-can-i-create-x509keypair-using-rsa-key", "title": "golang, can i create X509KeyPair using rsa key?", "body": "<p>I am trying to create gRPC connection with mutual tls following the instruction on this blog <a href=\"http://bbengfort.github.io/programmer/2017/03/03/secure-grpc.html\" rel=\"nofollow noreferrer\">Secure gRPC with TLS/SSL</a>, but i don't want to create the certificate and save it to a file on the disk, I want the service itself to create its keys, then the certificate authority key will be taken somewhere else (I am planning using the google pki as the ca).</p>\n\n<p>What i did so far I can create the private/public key pair using rsa, then encode the public key to pem key following some code here <a href=\"https://www.socketloop.com/tutorials/golang-generate-dsa-private-public-key-and-pem-files-example\" rel=\"nofollow noreferrer\">Golang : Generate DSA private, public key and PEM files example</a> now i am stock on how to create the certificate using the <a href=\"https://golang.org/pkg/crypto/tls/#LoadX509KeyPair\" rel=\"nofollow noreferrer\">LoadX509KeyPair</a>. I don't know where to get the value for the second parameter, it needs keyPemBlock in bytes, but the RSA private key is not on bytes.</p>\n\n<p>I would like to ask, is there a much more better way to create a certificate using the RSA, if it is possible?</p>\n\n<p>And also if we can create a certificate using RSA; using the incomplete solution of mine above, where i can get the value for the second parameter of the <code>tls.LoadX509KeyPair</code>?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "bigint"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1494086291, "post_id": 43822478, "comment_id": 74683299, "body": "Use the <a href=\"https://godoc.org/math/big#Int.Cmp\" rel=\"nofollow noreferrer\"><code>Int.Cmp</code> method</a>."}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 4015297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/827cf44882f40849d3b6f2540915a901?s=128&d=identicon&r=PG", "display_name": "MaxCodes", "link": "https://stackoverflow.com/users/4015297/maxcodes"}, "edited": false, "score": 0, "creation_date": 1494259496, "post_id": 43822603, "comment_id": 74740279, "body": "How would I implement this as <code>&lt;=</code>? As in, less than or equal to?"}, {"owner": {"reputation": 165, "user_id": 6475160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a70867403bef59444d9b8722651424?s=128&d=identicon&r=PG&f=1", "display_name": "Qubert", "link": "https://stackoverflow.com/users/6475160/qubert"}, "reply_to_user": {"reputation": 318, "user_id": 4015297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/827cf44882f40849d3b6f2540915a901?s=128&d=identicon&r=PG", "display_name": "MaxCodes", "link": "https://stackoverflow.com/users/4015297/maxcodes"}, "edited": false, "score": 0, "creation_date": 1494263735, "post_id": 43822603, "comment_id": 74742768, "body": "It is less than or equal to. Remember that Cmp returns 1 only if greater. So when I is 10, Cmp returns 0 and it still prints, but when i is 11 it returns 1 and stops. Take a good look at the playground example, modify it until you understand."}], "tags": [], "owner": {"reputation": 165, "user_id": 6475160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a70867403bef59444d9b8722651424?s=128&d=identicon&r=PG&f=1", "display_name": "Qubert", "link": "https://stackoverflow.com/users/6475160/qubert"}, "is_accepted": false, "score": 2, "last_activity_date": 1494087243, "last_edit_date": 1494087243, "creation_date": 1494086918, "answer_id": 43822603, "question_id": 43822478, "link": "https://stackoverflow.com/questions/43822478/operator-not-defined-on-pointer/43822603#43822603", "title": "operator &lt;= not defined on pointer", "body": "<p>Use the Cmp method of big (<a href=\"https://golang.org/pkg/math/big/#Int.Cmp\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/big/#Int.Cmp</a>)\nCmp returns -1 if less than. 0 if equal or 1 if greater.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    for i := big.NewInt(2); i.Cmp(big.NewInt(10)) &lt; 1; i.Add(i, big.NewInt(1)) {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p>playground: <a href=\"https://play.golang.org/p/FpU8xaRrdE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FpU8xaRrdE</a></p>\n"}], "owner": {"reputation": 318, "user_id": 4015297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/827cf44882f40849d3b6f2540915a901?s=128&d=identicon&r=PG", "display_name": "MaxCodes", "link": "https://stackoverflow.com/users/4015297/maxcodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2479, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494087243, "creation_date": 1494086228, "question_id": 43822478, "link": "https://stackoverflow.com/questions/43822478/operator-not-defined-on-pointer", "title": "operator &lt;= not defined on pointer", "body": "<p>I can't seem to use the &lt;= (<strong>greater than or equal to</strong>) operator when using big.Int.</p>\n\n<p>Is there a way of comparing two big.Ints?</p>\n\n<p>My code is as such:</p>\n\n<pre><code>for i := big.NewInt(2); i &lt;= sqrt; i.Add(i, big.NewInt(1)) {...\n</code></pre>\n\n<p>'<strong>i</strong>' and '<strong>sqrt</strong>' are what I want to compare.</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["go", "yaml", "go-templates", "templating-engine"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 1, "creation_date": 1494087350, "post_id": 43821989, "comment_id": 74683608, "body": "Why not use a YAML parser instead of a generic text template engine? It seems to me you&#39;re using the wrong tool for the job here. That being said, if you don&#39;t want spaces then ... don&#39;t type them?"}, {"owner": {"reputation": 2994, "user_id": 4175647, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cdc00400f3017caba1581296dc6c4f01?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Roz", "link": "https://stackoverflow.com/users/4175647/nick-roz"}, "edited": false, "score": 0, "creation_date": 1534889066, "post_id": 43821989, "comment_id": 90865137, "body": "There is an issue right now <a href=\"https://github.com/hairyhenderson/gomplate/issues/290#issuecomment-382597288\" rel=\"nofollow noreferrer\">github.com/hairyhenderson/gomplate/issues/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 6598221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9542698e76d1cd8e7e0e25ddce5c8e?s=128&d=identicon&r=PG&f=1", "display_name": "dirtbikejunkie", "link": "https://stackoverflow.com/users/6598221/dirtbikejunkie"}, "is_accepted": false, "score": 0, "last_activity_date": 1494110411, "creation_date": 1494110411, "answer_id": 43826030, "question_id": 43821989, "link": "https://stackoverflow.com/questions/43821989/how-to-indent-content-of-included-template/43826030#43826030", "title": "How to indent content of included template", "body": "<p>I found I can work around the issue if I indent the contents of pod.tmpl and then indent the top portion to align as below </p>\n\n<pre><code>{{ if (eq $template \"pod.tmpl\") }}\n    apiVersion: v1\n    kind: Pod\n{{ end }}\n{{ if (eq $template \"deployment.tmpl\") }}\napiVersion: v1\nkind: Deployment\nmetadata:\n  name: {{ .Name }}-deployment\nspec:\n  replicas: {{ .Scale }}\n  template:\n{{template \"pod\" dict \"Version\" $version \"Domain\" $domain \"Image\" $image \"ImageDerived\" $imageDerived \"Service\" . }}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 453, "user_id": 3930782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1781267d07b34f7c100317f310e10b9b?s=128&d=identicon&r=PG", "display_name": "tmirks", "link": "https://stackoverflow.com/users/3930782/tmirks"}, "is_accepted": false, "score": 1, "last_activity_date": 1554790168, "last_edit_date": 1554790168, "creation_date": 1495032296, "answer_id": 44028099, "question_id": 43821989, "link": "https://stackoverflow.com/questions/43821989/how-to-indent-content-of-included-template/44028099#44028099", "title": "How to indent content of included template", "body": "<p>You should be able to pipe the output of your template to the <code>indent</code> function available in the <a href=\"https://github.com/Masterminds/sprig\" rel=\"nofollow noreferrer\">sprig</a> package:</p>\n\n\n\n<pre><code>{{ if (eq .Case \"service\")\n  service:\n    # need to indent! so contents become members of service:\n{{ template \"pod\" | indent 4 }}\n{{ end }}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 652, "user_id": 2723305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PEkio.jpg?s=128&g=1", "display_name": "Giovanni Bassi", "link": "https://stackoverflow.com/users/2723305/giovanni-bassi"}, "is_accepted": false, "score": 1, "last_activity_date": 1571883993, "creation_date": 1571883993, "answer_id": 58533280, "question_id": 43821989, "link": "https://stackoverflow.com/questions/43821989/how-to-indent-content-of-included-template/58533280#58533280", "title": "How to indent content of included template", "body": "<p>You can indent freely, but you need to use <code>include</code> instead of <code>template</code>, as <code>template</code> is an action and can't be passed to other functions:</p>\n\n\n\n<pre><code>{{ include \"pod\" | indent 4 }}\n</code></pre>\n\n<p>See the <a href=\"https://helm.sh/docs/chart_template_guide/#named-templates\" rel=\"nofollow noreferrer\">Helm guide</a> for more info.</p>\n"}, {"tags": [], "owner": {"reputation": 1477, "user_id": 1090482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/66f8470ff78540a581da8a583d64d4d2?s=128&d=identicon&r=PG", "display_name": "s12chung", "link": "https://stackoverflow.com/users/1090482/s12chung"}, "is_accepted": false, "score": 4, "last_activity_date": 1576714298, "creation_date": 1576714298, "answer_id": 59401696, "question_id": 43821989, "link": "https://stackoverflow.com/questions/43821989/how-to-indent-content-of-included-template/59401696#59401696", "title": "How to indent content of included template", "body": "<p>@Giovanni Bassi's answer only works in helm. The <code>include</code> function is defined in <a href=\"https://github.com/helm/helm/blob/8648ccf5d35d682dcd5f7a9c2082f0aaf071e817/pkg/engine/engine.go#L147-L154\" rel=\"nofollow noreferrer\"><code>helm</code> here</a>.</p>\n\n<p>Combining with <a href=\"https://github.com/Masterminds/sprig/blob/1c4ac026244459b0f824a4c669e940325b2dbf20/functions.go#L151\" rel=\"nofollow noreferrer\"><code>indent</code> from <code>sprig</code></a> from @tmirks answer, you get:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func renderTemplate(templatePath string, vars interface{}, out io.Writer) error {\n    t := template.New(filepath.Base(templatePath))\n    var funcMap template.FuncMap = map[string]interface{}{}\n    // copied from: https://github.com/helm/helm/blob/8648ccf5d35d682dcd5f7a9c2082f0aaf071e817/pkg/engine/engine.go#L147-L154\n    funcMap[\"include\"] = func(name string, data interface{}) (string, error) {\n        buf := bytes.NewBuffer(nil)\n        if err := t.ExecuteTemplate(buf, name, data); err != nil {\n            return \"\", err\n        }\n        return buf.String(), nil\n    }\n\n    t, err := t.Funcs(sprig.TxtFuncMap()).Funcs(funcMap).ParseFiles(templatePath)\n    if err != nil {\n        return err\n    }\n    err = t.Execute(out, &amp;vars)\n    if err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>then</p>\n\n<pre><code>{{ include \"pod\" | indent 4 }}\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 6598221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9542698e76d1cd8e7e0e25ddce5c8e?s=128&d=identicon&r=PG&f=1", "display_name": "dirtbikejunkie", "link": "https://stackoverflow.com/users/6598221/dirtbikejunkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6512, "favorite_count": 0, "answer_count": 4, "score": 6, "last_activity_date": 1576714298, "creation_date": 1494083249, "last_edit_date": 1549892939, "question_id": 43821989, "link": "https://stackoverflow.com/questions/43821989/how-to-indent-content-of-included-template", "title": "How to indent content of included template", "body": "<p>I am using go templates to create yaml definitions for kubernetes. I am trying to nest templates but run into issues where I can't re-use a definition simply because the indention is wrong when included. I.e., in one case the contents need indentation but do not in another. How can I control the indention of included content?</p>\n\n<p>Example below. I am reusing pod.tmpl, in the first case it can be included as is. In the second case I need to indent the entire contents so it becomes member of service</p>\n\n<pre><code>{{ if (eq .Case \"pod\")\n  # NO indenting\n  {{ template \"pod\" }}\n{{ end }}\n\n{{ if (eq .Case \"service\")\n  service:\n    # need to indent! so contents become members of service:\n    {{ template \"pod\" }}\n{{ end }}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "module", "google-cloud-datastore", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 1212331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a490e8119b35a0a99b2902465714db7?s=128&d=identicon&r=PG", "display_name": "caitcoo0odes", "link": "https://stackoverflow.com/users/1212331/caitcoo0odes"}, "is_accepted": false, "score": 1, "last_activity_date": 1494084440, "last_edit_date": 1494084440, "creation_date": 1494083895, "answer_id": 43822091, "question_id": 43821899, "link": "https://stackoverflow.com/questions/43821899/sharing-data-between-appengine-modules/43822091#43822091", "title": "Sharing data between appengine modules", "body": "<p>There are eventual consistency issues you may be hitting. Datastore is distributed so it's possible one service hits a consistent version of the data and another service(module) hits another version that is stale. The datastore is definitely a way to share data between modules so it could either be a consistency problem where you won't be guaranteed to be able to read the data back right away unless you restructure your data or your query to be strongly consistent, or it could be some other problem like you have the wrong key in the other module or are somehow hitting a different namespace.</p>\n\n<p>Here are a some resources on datastore consistency:\n<a href=\"https://cloud.google.com/datastore/docs/concepts/structuring_for_strong_consistency\" rel=\"nofollow noreferrer\">https://cloud.google.com/datastore/docs/concepts/structuring_for_strong_consistency</a>\n<a href=\"https://cloud.google.com/datastore/docs/articles/balancing-strong-and-eventual-consistency-with-google-cloud-datastore/\" rel=\"nofollow noreferrer\">https://cloud.google.com/datastore/docs/articles/balancing-strong-and-eventual-consistency-with-google-cloud-datastore/</a>\n<a href=\"https://cloud.google.com/datastore/docs/best-practices\" rel=\"nofollow noreferrer\">https://cloud.google.com/datastore/docs/best-practices</a></p>\n\n<p>From the last link:</p>\n\n<blockquote>\n  <p>If you need strong consistency for your queries, use an ancestor\n  query. (To use ancestor queries, you first need to structure your data\n  for strong consistency.) An ancestor query returns strongly consistent\n  results. Note that a non-ancestor keys-only query followed by a\n  lookup() does not return strong results, because the non-ancestor\n  keys-only query could get results from an index that is not consistent\n  at the time of the query.</p>\n</blockquote>\n"}], "owner": {"reputation": 211, "user_id": 5174803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22e6722c5b91fbc9b15b3dbe626d38bc?s=128&d=identicon&r=PG&f=1", "display_name": "user5174803", "link": "https://stackoverflow.com/users/5174803/user5174803"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494084440, "creation_date": 1494082649, "question_id": 43821899, "link": "https://stackoverflow.com/questions/43821899/sharing-data-between-appengine-modules", "title": "Sharing data between appengine modules", "body": "<p>I'm trying to use appengine datastore to share a key between appengine modules.\nI'm writing the key in one module, I can read it from that module.</p>\n\n<p>Trying to read it from the second module doesn't work, and I get no such entity response.</p>\n\n<p>What's the best way to share a key between modules? can I use datastore for that? from what I have read in the documentation data store is shared between services. but it doesn't seems to work for me.</p>\n"}, {"tags": ["git", "nginx", "go", "bitbucket", "haproxy"], "comments": [{"owner": {"reputation": 1374, "user_id": 560561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6c5947ff77ff642f370d78017cf04fc?s=128&d=identicon&r=PG", "display_name": "fzerorubigd", "link": "https://stackoverflow.com/users/560561/fzerorubigd"}, "edited": false, "score": 0, "creation_date": 1494083937, "post_id": 43821889, "comment_id": 74682501, "body": "There is a tool for github, with a minor change in source code, I think you can use it for bitbucket too. (since you say another tool ) <a href=\"https://github.com/niemeyer/gopkg\" rel=\"nofollow noreferrer\">github.com/niemeyer/gopkg</a>"}, {"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "reply_to_user": {"reputation": 1374, "user_id": 560561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6c5947ff77ff642f370d78017cf04fc?s=128&d=identicon&r=PG", "display_name": "fzerorubigd", "link": "https://stackoverflow.com/users/560561/fzerorubigd"}, "edited": false, "score": 0, "creation_date": 1494085172, "post_id": 43821889, "comment_id": 74682934, "body": "thanks for the suggestion. Building a custom web server would certainly work but I use a reverse proxy for a number of other tasks and i&#39;m trying to keep the number of components down."}, {"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "reply_to_user": {"reputation": 1374, "user_id": 560561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6c5947ff77ff642f370d78017cf04fc?s=128&d=identicon&r=PG", "display_name": "fzerorubigd", "link": "https://stackoverflow.com/users/560561/fzerorubigd"}, "edited": false, "score": 0, "creation_date": 1494086295, "post_id": 43821889, "comment_id": 74683303, "body": "i see a few nginx posts i.e. <a href=\"http://stackoverflow.com/questions/26347516/using-go-get-on-a-personal-git-repo\" title=\"using go get on a personal git repo\">stackoverflow.com/questions/26347516/&hellip;</a>"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1494106652, "post_id": 43821889, "comment_id": 74689239, "body": "This can be done solely in HAProxy, if I understand what you&#39;re looking to do... but can you give examples of a couple of different requests and their respective (different) responses?"}, {"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "edited": false, "score": 0, "creation_date": 1494113191, "post_id": 43821889, "comment_id": 74690502, "body": "hi Michael.. the solution requires a flexible HTTP response using variables and NGinx can do this quite easily. HAProxy really isn&#39;t intended for this.. it&#39;s best at load-balancing. Having said that, i&#39;ll try to back it up with a gist in a day or two."}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1494123950, "post_id": 43821889, "comment_id": 74692127, "body": "Okay, @JamesFremen, have it your way. :)  HAProxy solution shown below."}, {"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "edited": false, "score": 0, "creation_date": 1494167488, "post_id": 43821889, "comment_id": 74702092, "body": "it looks like a viable solution.. just a minor quibble, but the &#39;go&#39; client is actually sending an https request to the server by default. I find that the client also objects if it gets back a non-https path to the git repo in the meta tag. I was handling this using sni and an internal redirect but your nice magic trick is better than the monitor-uri hack :). I will try to post nginx solution shortly for comparison."}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1494181390, "post_id": 43821889, "comment_id": 74706807, "body": "Well, I didn&#39;t have an SSL cert for example.com handy for testing, so I just wrote the whole proof of concept to work with HTTP.  It sounds to me like you are sufficiently familiar with HAProxy that you could wire it up to do exactly what you need, once you had a working example of how to render a response.  For static replies, another simple hack is to create a backend with no servers, set its <code>errorfile 503</code> to a raw HTTP response file that begins <code>HTTP&#47;1.0 200 OK\\r\\n...</code> and contains the complete raw response. :)"}, {"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1494181439, "post_id": 43821889, "comment_id": 74706824, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/143624/discussion-between-james-fremen-and-michael-sqlbot\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "is_accepted": false, "score": 1, "last_activity_date": 1494123886, "creation_date": 1494123886, "answer_id": 43827231, "question_id": 43821889, "link": "https://stackoverflow.com/questions/43821889/how-do-you-support-go-get-using-bitbucket-server/43827231#43827231", "title": "How do you support &#39;go get&#39; using bitbucket server?", "body": "<p>Depending on how you need to customize the response, this is possible using only HAProxy, compiled with Lua support.  Here, using HAProxy 1.6.12 with Lua 5.3.4, I'm taking the request path and dropping it into the the response as-is, to do the customization -- essentially any path is just getting copied in.  You could also use <code>string.gsub()</code> if you needed to modify it.</p>\n\n<p>A small Lua script:</p>\n\n\n\n<pre><code>-- /etc/haproxy/lua/custom-response.lua\n\ncore.register_service(\"magic-endpoint\", \"http\", function(applet)\n   local response =\n         \"&lt;head&gt;\\r\\n\" ..\n         \"  &lt;meta name=\\\"go-import\\\" content=\\\"example.com\" .. applet.path ..\n         \" git http://example.dev:7600/scm/project\" .. applet.path ..\n         \"\\\"&gt;\\r\\n&lt;/head&gt;\\r\\n\";\n   applet:set_status(200);\n   applet:add_header(\"Content-Length\", string.len(response));\n   applet:add_header(\"Content-Type\", \"text/whatevs\");\n   applet:start_response();\n   applet:send(response);\nend)\n</code></pre>\n\n<p>And the relevant lines from config.  I'm just using the hostname to route the request to the backend, but you could of course trigger it using whatever logic you need.</p>\n\n<pre><code>-- /etc/haproxy.cfg \n\nglobal\n    lua-load /etc/haproxy/lua/custom-response.lua\n\nfrontend main-frontend\n    mode http\n    bind :80\n    use_backend example if { hdr(host) -i example.com }\n\nbackend example\n    mode http\n    http-request use-service lua.magic-endpoint\n</code></pre>\n\n<p>And, test:</p>\n\n<pre><code>$ curl -v http://example.com/project1\n* Hostname was NOT found in DNS cache\n*   Trying 127.0.0.1...\n* Connected to example.com (127.0.0.1) port 80 (#0)\n&gt; GET /project1 HTTP/1.1\n&gt; User-Agent: curl/7.35.0\n&gt; Host: example.com\n&gt; Accept: */*\n&gt;\n&lt; HTTP/1.1 200 OK\n&lt; Content-Type: text/whatevs\n&lt; Content-Length: 124\n&lt;\n&lt;head&gt;\n  &lt;meta name=\"go-import\" content=\"example.com/project1 git http://example.dev:7600/scm/project/project1\"&gt;\n&lt;/head&gt;\n</code></pre>\n\n<p>Seems legit.</p>\n"}, {"comments": [{"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "edited": false, "score": 0, "creation_date": 1494248077, "post_id": 43836577, "comment_id": 74732288, "body": "the original title of the question explicitly referenced HAProxy so I think Michael has a legitimate claim on the answer. That said, i think Nginx is better suited out-of-the-box for this task because it can flexibly handle multiple projects/components in a simple manner which is well within its scope."}], "tags": [], "owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "is_accepted": true, "score": 0, "last_activity_date": 1494190203, "creation_date": 1494190203, "answer_id": 43836577, "question_id": 43821889, "link": "https://stackoverflow.com/questions/43821889/how-do-you-support-go-get-using-bitbucket-server/43836577#43836577", "title": "How do you support &#39;go get&#39; using bitbucket server?", "body": "<p>For the purpose of conversation and because flexible generation of HTTP responses is useful I gave it a try using nginx - with a switch to ssh. The non-standard part of the configuration file has a rule to point the go client to the Bitbucket server:</p>\n\n<pre><code>location ~ \"^(/[^/]+)(/[^/]+)?\" {\n    if ($arg_go-get = \"1\") {\n        return 200 '&lt;html&gt;&lt;head&gt;&lt;meta name=\"go-import\" content=\"acme.com$1$2 git ssh://acme.dev:7999$1$2\"&gt;&lt;/head&gt;&lt;/html&gt;';\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 1, "accepted_answer_id": 43836577, "answer_count": 2, "score": 1, "last_activity_date": 1494247333, "creation_date": 1494082589, "last_edit_date": 1494247333, "question_id": 43821889, "link": "https://stackoverflow.com/questions/43821889/how-do-you-support-go-get-using-bitbucket-server", "title": "How do you support &#39;go get&#39; using bitbucket server?", "body": "<p>I would like to support requests of the form:</p>\n\n<pre><code>go get acme.com/component\n</code></pre>\n\n<p>where <code>component</code> is a git project stored in Bitbucket Server which can be retrieved via:</p>\n\n<pre><code>git clone http://acme.dev:7600/scm/project/component\n</code></pre>\n\n<p>The go 1.8 client does not know how to fetch the component based on the <code>go get</code> parameters so it does an HTTPS get (as per <a href=\"https://golang.org/cmd/go/#hdr-Remote_import_paths\" rel=\"nofollow noreferrer\">https://golang.org/cmd/go/#hdr-Remote_import_paths</a>) of:</p>\n\n<pre><code>https://acme.com/component?go-get=1\n</code></pre>\n\n<p>In response it expects an HTTP 200 containing the following:</p>\n\n<pre><code>&lt;head&gt;\n  &lt;meta name=\"go-import\" content=\"acme.com/component git http://acme.dev:7600/scm/project/component\"&gt;\n&lt;/head&gt;\n</code></pre>\n\n<p>HAProxy is attractive because the Bitbucket Server SSL termination procedure uses it. It has a monitor-uri hack to return an HTTP response if it detects that the backend is responding to a specific URI but I don't think it's sufficiently flexible to handle different component names. </p>\n\n<p>Does anyone know a way to handle this using HAProxy or, perhaps, another tool like NGinx?</p>\n"}, {"tags": ["go", "bigint"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1494078201, "post_id": 43821111, "comment_id": 74680567, "body": "<a href=\"https://golang.org/pkg/math/big/#Int.Sqrt\" rel=\"nofollow noreferrer\">golang.org/pkg/math/big/#Int.Sqrt</a>"}, {"owner": {"reputation": 318, "user_id": 4015297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/827cf44882f40849d3b6f2540915a901?s=128&d=identicon&r=PG", "display_name": "MaxCodes", "link": "https://stackoverflow.com/users/4015297/maxcodes"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1494078346, "post_id": 43821111, "comment_id": 74680606, "body": "@ain could you answer with an example usage? Thanks"}, {"owner": {"reputation": 2241, "user_id": 6284825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z7dY9qEIYqY/AAAAAAAAAAI/AAAAAAAAABE/DUXNdvdCo9I/photo.jpg?sz=128", "display_name": "Abhilekh Singh", "link": "https://stackoverflow.com/users/6284825/abhilekh-singh"}, "edited": false, "score": 0, "creation_date": 1494079126, "post_id": 43821111, "comment_id": 74680822, "body": "@MaxCodes I added the example."}], "answers": [{"tags": [], "owner": {"reputation": 2241, "user_id": 6284825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z7dY9qEIYqY/AAAAAAAAAAI/AAAAAAAAABE/DUXNdvdCo9I/photo.jpg?sz=128", "display_name": "Abhilekh Singh", "link": "https://stackoverflow.com/users/6284825/abhilekh-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1494078945, "creation_date": 1494078945, "answer_id": 43821290, "question_id": 43821111, "link": "https://stackoverflow.com/questions/43821111/find-the-square-root-of-a-big-int/43821290#43821290", "title": "Find the square root of a big.Int", "body": "<p>Use <a href=\"https://golang.org/pkg/math/big/#Int.Sqrt\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/big/#Int.Sqrt</a> given in big.int interface</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    var Str = `10000000000000000000000000000000000000000000000000000`\n    bigInt := &amp;big.Int{}\n    value, _ := bigInt.SetString(Str, 10)\n    sqrt := bigInt.Sqrt(value)\n    fmt.Println(sqrt)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>100000000000000000000000000\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 4015297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/827cf44882f40849d3b6f2540915a901?s=128&d=identicon&r=PG", "display_name": "MaxCodes", "link": "https://stackoverflow.com/users/4015297/maxcodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494078945, "creation_date": 1494077908, "question_id": 43821111, "link": "https://stackoverflow.com/questions/43821111/find-the-square-root-of-a-big-int", "title": "Find the square root of a big.Int", "body": "<p>I am required to use big.Ints for my project because the numbers I am working with exceed the int64 limit.</p>\n\n<p>With regular ints, you can square it using:</p>\n\n<pre><code>math.Sqrt(value)\n</code></pre>\n\n<p>But I can't work out how to do this, but with big.Ints.</p>\n\n<p>Any help would be appreciated greatly,</p>\n\n<p>Thanks</p>\n"}, {"tags": ["debugging", "go", "intellij-idea", "input"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494075111, "post_id": 43820597, "comment_id": 74679661, "body": "What exactly do you mean when you say &quot;If I debug the code&quot;. How do you &quot;debug&quot; the code?"}, {"owner": {"reputation": 177, "user_id": 4281565, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a969b0887ab0b189c2dcb874f17c9745?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4281565/mark"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494075444, "post_id": 43820597, "comment_id": 74679756, "body": "that I run the code in debug mode, in such a way that I can set breakpoints, see the values of the variables, execute one instruction at a time (if I want to) etc."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494100964, "post_id": 43820597, "comment_id": 74687754, "body": "Are you sure your debugger has stdin connected and if yes: To what?"}, {"owner": {"reputation": 96, "user_id": 271910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMlmI.jpg?s=128&g=1", "display_name": "FabienM", "link": "https://stackoverflow.com/users/271910/fabienm"}, "edited": false, "score": 0, "creation_date": 1502981629, "post_id": 43820597, "comment_id": 78434655, "body": "Seems to be related to a delve issue : <a href=\"https://github.com/derekparker/delve/issues/65\" rel=\"nofollow noreferrer\">github.com/derekparker/delve/issues/65</a>"}], "owner": {"reputation": 177, "user_id": 4281565, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a969b0887ab0b189c2dcb874f17c9745?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4281565/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1494074492, "creation_date": 1494074492, "question_id": 43820597, "link": "https://stackoverflow.com/questions/43820597/golang-strange-behavior-when-debugging-code-that-takes-inputs", "title": "Golang: strange behavior when debugging code that takes inputs", "body": "<p>I am considering this simple code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"bufio\"\n    \"io\"\n    \"os\"\n\n)\nvar in *bufio.Reader\nvar out io.Writer\n\nfunc init() {\n    in = bufio.NewReader(os.Stdin)\n    out = os.Stdout\n}\n\nfunc main() {\n    str, err := in.ReadString('\\n')\n    fmt.Println(\"str: \", str, \"err: \", err)\n}\n</code></pre>\n\n<p>I am using IntelliJ with the Go plugin. My version of Go is 1.8.\nIf I simply run the code there is no problem: str will be the same as the string I put, and err will be &lt; nil >.\nIf I debug the code I will not have the chance to put anything as input and I will have the following output:</p>\n\n<pre><code>    API server listening at: 127.0.0.1:44824\n    str:   err:  EOF\n</code></pre>\n\n<p>I have no idea of what is happening: what is the first line for? How is it generated? And why the terminal does not \"block\" to let me write the input? And why err is \"EOF\" (it is like the part in which I have to put text is simply skipped: why?) ?</p>\n\n<p>Last additional detail: I am executing this simple piece of code because I am actually trying to understand what is happening in a bigger project, in which a similar issue occurs. In fact, in that case I still have to put something by hand, and, again, if I debug the code it returns an error. In this case, however, the err variable contains a different thing: \"error\".</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1494066919, "post_id": 43819074, "comment_id": 74677288, "body": "<a href=\"https://godoc.org/gopkg.in/aws/aws-sdk-go.v1/service/s3#example-S3-PutObject\" rel=\"nofollow noreferrer\">godoc.org/gopkg.in/aws/aws-sdk-go.v1/service/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7972526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aZwc-9CWL_s/AAAAAAAAAAI/AAAAAAAAATQ/lXFo3USr2N8/photo.jpg?sz=128", "display_name": "Febriansyah", "link": "https://stackoverflow.com/users/7972526/febriansyah"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1494083910, "post_id": 43819074, "comment_id": 74682493, "body": "Thank you for your answer @mkopriva and the link, it really help me, should be flag as the answer but i dont know how, sorry, once again thank you"}], "owner": {"reputation": 1, "user_id": 7972526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aZwc-9CWL_s/AAAAAAAAAAI/AAAAAAAAATQ/lXFo3USr2N8/photo.jpg?sz=128", "display_name": "Febriansyah", "link": "https://stackoverflow.com/users/7972526/febriansyah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494064646, "creation_date": 1494064646, "question_id": 43819074, "link": "https://stackoverflow.com/questions/43819074/creating-an-object-in-aws-s3-using-go-language", "title": "Creating an Object in AWS S3 using Go Language", "body": "<p>i want to create an object (file) in my s3 bucket using Go Language, i've read the API Reference and search it on google but all of them just uploading the file, no one using the method create a new object and fill it body with base64 encoded (for image), if someone can help me with this? i've done it with PHP but now im using Go Language</p>\n"}, {"tags": ["go", "google-app-engine-go", "ginkgo"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 7705046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f6e1961a908ca40336de8d8cd8a837?s=128&d=identicon&r=PG&f=1", "display_name": "Shaunak Godbole", "link": "https://stackoverflow.com/users/7705046/shaunak-godbole"}, "is_accepted": false, "score": 0, "last_activity_date": 1494310331, "last_edit_date": 1494310331, "creation_date": 1494309712, "answer_id": 43862201, "question_id": 43817251, "link": "https://stackoverflow.com/questions/43817251/gikngo-tests-hang-during-goapp-tests/43862201#43862201", "title": "Gikngo Tests hang during goapp tests", "body": "<p>It turns out that Ginkgo or Golang had nothing to do with this.  There seems to be some limitation on the number of fields one can read per second from dev_appserver.py.  (I suspect that it might be related to SQLite which is the DB that dev_appserver uses internally).</p>\n\n<p>The following code points out the problem:</p>\n\n<pre><code>package preorder\n\nimport (\n    \"fmt\"\n    \"testing\"\n\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/aetest\"\n    \"google.golang.org/appengine/datastore\"\n)\n\nfunc TestLoad(t *testing.T) {\n    opts := aetest.Options{StronglyConsistentDatastore: true}\n    inst, _ := aetest.NewInstance(&amp;opts)\n    defer inst.Close()\n\n    for i := 0; i &lt; 10000; i++ {\n        req, _ := inst.NewRequest(\"GET\", \"/\", nil)\n        ctx := appengine.NewContext(req)\n\n        k := datastore.NewKey(ctx, ENTITY_NAME, \"\", 12345, nil)\n        var entity Entity\n        datastore.Get(ctx, k, &amp;entity)\n        fmt.Println(\"Iteration Count: \", i)\n        ctx.Done()\n    }\n}\n</code></pre>\n\n<p>Any help on figuring out how to work around the limit of 240 operations would be appreciated.  One technique I can think of is to artificially inject delays.</p>\n"}], "owner": {"reputation": 71, "user_id": 7705046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f6e1961a908ca40336de8d8cd8a837?s=128&d=identicon&r=PG&f=1", "display_name": "Shaunak Godbole", "link": "https://stackoverflow.com/users/7705046/shaunak-godbole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494310331, "creation_date": 1494050346, "question_id": 43817251, "link": "https://stackoverflow.com/questions/43817251/gikngo-tests-hang-during-goapp-tests", "title": "Gikngo Tests hang during goapp tests", "body": "<p>I'm trying to use <a href=\"http://onsi.github.io/ginkgo/\" rel=\"nofollow noreferrer\">Gikngo</a> to write some tests for appengine. </p>\n\n<p>My setup for the tests is as follows:</p>\n\n<p>suite_test.go:</p>\n\n<pre><code>BeforeSuite() {\n  inst, err = aetest.NewInstance(options)\n  if err != nil {\n    Fail(fmt.Sprintf(\"%s\", err))\n  }\n}\n\nvar(\n  req *http.Request\n  ctx context.Context\n)\nBeforeEach() {\n  req = inst.NewRequest()\n  ctx = appengine.NewContext(req)\n\n  // Clean up local datastore using the context.\n}\n</code></pre>\n\n<p>validation_test.go</p>\n\n<pre><code>Describe(\"Some Test\", func() {\n  It(\"ValidateFoo\", func() {\n    // Access ctx here\n  })\n  ...\n  It(\"ValidateBar\", func() {\n    // Access ctx here.\n  })\n})\n</code></pre>\n\n<p>I see our tests consistently hanging with the error of the type:</p>\n\n<pre><code>Expected success, but got an error:\n    &lt;*url.Error | 0xc8210570b0&gt;: {\n        Op: \"Post\",\n        URL: \"http://localhost:59072\",\n        Err: {s: \"EOF\"},\n    }\n    Post http://localhost:59072: EOF\n</code></pre>\n\n<p>This seems to indicate that the API server has become inaccessible.  However, the test output does not seem to indicate this.</p>\n\n<p>What are the ways in which we can debug a goapp test?</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "edited": false, "score": 1, "creation_date": 1494218918, "post_id": 43816039, "comment_id": 74715895, "body": "Check my new solution, its full working example. Just copy paste correctly and it will work"}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 1, "last_activity_date": 1494040086, "creation_date": 1494040086, "answer_id": 43816301, "question_id": 43816039, "link": "https://stackoverflow.com/questions/43816039/html-partials-in-golang/43816301#43816301", "title": "HTML Partials in GoLang", "body": "<p>You need to pass the data as <code>struct</code> or <code>map</code> to template. Example of your <code>rootHandler</code> using <code>map</code>: </p>\n\n<pre><code>func rootHandler(wr http.ResponseWriter, req *http.Request) {\n    title := \"home\"\n    //Wrap your variable into a map\n    data := map[string]interface{}{\n        \"Title\":  title,\n        \"IntVar\": 100,\n    }\n\n    err := templates.ExecuteTemplate(wr, title+\".html\", data)\n\n    //other codes...\n}\n</code></pre>\n\n<p>For more details, see <a href=\"https://golang.org/pkg/text/template/#hdr-Arguments\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "is_accepted": true, "score": 8, "last_activity_date": 1611707912, "last_edit_date": 1611707912, "creation_date": 1494063572, "answer_id": 43818930, "question_id": 43816039, "link": "https://stackoverflow.com/questions/43816039/html-partials-in-golang/43818930#43818930", "title": "HTML Partials in GoLang", "body": "<p><strong>This is full working example.</strong></p>\n<p>home.html inside temps folder:</p>\n<pre><code>{{define &quot;homeHTML&quot;}}\n\n{{template &quot;headHTML&quot; .}}\n\n{{template &quot;headerHTML&quot; .}}\n\n{{template &quot;footerHTML&quot; .}}\n\n{{end}}\n</code></pre>\n<p>head.html inside data folder:</p>\n<pre><code>{{define &quot;headHTML&quot;}}\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta charset=&quot;utf-8&quot;&gt;\n        &lt;title&gt;{{.title}} - MySite&lt;/title&gt;\n        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;style.css&quot;&gt;\n    &lt;/head&gt;  \n{{end}}\n</code></pre>\n<p>header.html inside data folder</p>\n<pre><code>{{define &quot;headerHTML&quot;}}\n&lt;header&gt;\n    {{.header}}\n    &lt;h1&gt;Welcome to my site!&lt;/h1&gt;\n    &lt;br&gt;\n    &lt;nav&gt;\n        &lt;a href=&quot;/&quot;&gt;Home&lt;/a&gt;\n    &lt;/nav&gt;\n&lt;/header&gt;\n{{end}}\n</code></pre>\n<p>footer.html inside data folder:</p>\n<pre><code>{{define &quot;footerHTML&quot;}}\n&lt;h1&gt;Welcome! {{.footer}}&lt;/h1&gt;\n&lt;footer&gt;\n&lt;p&gt;Thank You for Visiting&lt;/p&gt;\n&lt;/footer&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n<p>And the code will be like this</p>\n<pre><code>package main\n\nimport (\n    &quot;html/template&quot;\n    &quot;io/ioutil&quot;\n    &quot;net/http&quot;\n    &quot;path/filepath&quot;\n    &quot;strings&quot;\n)\n\nvar tPath = &quot;./temps/&quot;\nvar dPath = &quot;./data/&quot;\n\nvar templateDirs = []string{&quot;temps&quot;, &quot;data&quot;}\nvar templates *template.Template\n\nfunc getTemplates() (templates *template.Template, err error) {\n    var allFiles []string\n    for _, dir := range templateDirs {\n        files2, _ := ioutil.ReadDir(dir)\n        for _, file := range files2 {\n            filename := file.Name()\n            if strings.HasSuffix(filename, &quot;.html&quot;) {\n                filePath := filepath.Join(dir, filename)\n                allFiles = append(allFiles, filePath)\n            }\n        }\n    }\n\n    templates, err = template.New(&quot;&quot;).ParseFiles(allFiles...)\n    return\n}\n\nfunc init() {\n    templates, _ = getTemplates()\n}\n\nfunc rootHandler(wr http.ResponseWriter, req *http.Request) {\n    title := &quot;home&quot;\n\n    data := map[string]interface{}{\n        &quot;title&quot;:  title,\n        &quot;header&quot;: &quot;My Header&quot;,\n        &quot;footer&quot;: &quot;My Footer&quot;,\n    }\n\n    err := templates.ExecuteTemplate(wr, &quot;homeHTML&quot;, data)\n\n    if err != nil {\n        http.Error(wr, err.Error(), http.StatusInternalServerError)\n    }\n}\n\nfunc main() {\n    http.HandleFunc(&quot;/&quot;, rootHandler)\n    http.ListenAndServe(&quot;:8080&quot;, nil)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 7355457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d99c9ef61a4336cdf98b8ec5782d71?s=128&d=identicon&r=PG&f=1", "display_name": "SS MM", "link": "https://stackoverflow.com/users/7355457/ss-mm"}, "is_accepted": false, "score": 0, "last_activity_date": 1609128818, "creation_date": 1609128818, "answer_id": 65472943, "question_id": 43816039, "link": "https://stackoverflow.com/questions/43816039/html-partials-in-golang/65472943#65472943", "title": "HTML Partials in GoLang", "body": "<p>The accepted answer can be simplified by using template.ParseGlob</p>\n<p>Replace the contents of func getTemplates() with</p>\n<pre><code> templates, err:= template.ParseGlob(&quot;temps/*&quot;)\n if err!= nil {\n   return nil, err\n }\n return templates.ParseGlob(&quot;data/*)\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 3498886, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7e53d3b11d7866d583c8469b96cb00f?s=128&d=identicon&r=PG&f=1", "display_name": "gangwerz", "link": "https://stackoverflow.com/users/3498886/gangwerz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3635, "favorite_count": 1, "accepted_answer_id": 43818930, "answer_count": 3, "score": 4, "last_activity_date": 1611707912, "creation_date": 1494037320, "last_edit_date": 1494097565, "question_id": 43816039, "link": "https://stackoverflow.com/questions/43816039/html-partials-in-golang", "title": "HTML Partials in GoLang", "body": "<p>I am just getting started with Go, and I want to create a web app with it. What I am trying now is to use the templating in a handlebarsjs-esque manner. I want to pull my header and footer out of my main page so I can inject them on every webpage.</p>\n\n<p>My current set up is supposed to parse the homepage, header, and footer HTML files and cache them. Then I execute my home.html template, which has fields for the pages Title, the header.html file, and the footer.html file.</p>\n\n<p>Whenever I search for similar pages I just see javascript pages, so if this is a repost, let me know where to look.</p>\n\n<p><strong>edit:</strong>\nI have updated my code to take tips from the answers by @Minty and @putu. I am trying to read the html files and store them in a data map, while also adding the template <code>define</code> to my templates. There are some new bugs that I am working on squashing, so the site does not render currently. But, if there are any new tips you can give, that would help a lot.</p>\n\n<p>server.go</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"regexp\"\n)\n\nvar tPath = \"./temps/\"\nvar dPath = \"./data/\"\n\nvar templates = template.Must(template.ParseFiles(tPath+\"home.html\", dPath+\"header.html\", dPath+\"footer.html\"))\nvar validPath = regexp.MustCompile(\"^/\")\n\nfunc rootHandler(wr http.ResponseWriter, req *http.Request) {\n    title := \"home\"\n    headerFile, headErr := ioutil.ReadFile(dPath + \"header.html\")\n    footerFile, footErr := ioutil.ReadFile(dPath + \"footer.html\")\n\n    if headErr != nil || footErr != nil {\n        http.Error(wr, headErr.Error(), http.StatusInternalServerError)\n        http.Error(wr, footErr.Error(), http.StatusInternalServerError)\n    }\n\n    data := map[string]interface{}{\n        \"Title\":  title,\n        \"Header\": string(headerFile),\n        \"Footer\": string(footerFile),\n    }\n\n    err := templates.ExecuteTemplate(wr, title+\".html\", data)\n\n    if err != nil {\n        http.Error(wr, err.Error(), http.StatusInternalServerError)\n    }\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", rootHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>home.html:</p>\n\n<pre><code>{{define \"homeHTML\"}}\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"utf-8\"&gt;\n        &lt;title&gt;{{.Title}} - MySite&lt;/title&gt;\n        &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\"&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        {{.Header}}\n        &lt;h1&gt;Welcome!&lt;/h1&gt;\n        {{.Footer}}\n    &lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>Header.html:</p>\n\n<pre><code>{{define \"headerHTML\"}}\n&lt;header&gt;\n    &lt;h1&gt;MySite&lt;/h1&gt;\n    &lt;br&gt;\n    &lt;nav&gt;\n        &lt;a href=\"/\"&gt;Home&lt;/a&gt;\n    &lt;/nav&gt;\n&lt;/header&gt;\n{{end}}\n</code></pre>\n\n<p>Footer.html</p>\n\n<pre><code>{{define \"footerHTML\"}}\n&lt;footer&gt;\n    &lt;p&gt;Thank You for Visiting&lt;/p&gt;\n&lt;/footer&gt;\n{{end}}\n</code></pre>\n"}, {"tags": ["arrays", "go", "multidimensional-array"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494036646, "post_id": 43815912, "comment_id": 74671204, "body": "<code>val 2darray [][]int64, float64</code> &lt;- what does this mean?"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1494038549, "post_id": 43815912, "comment_id": 74671478, "body": "hello there, welcome to Stack Overflow and welcome to Go golang.org I think you should take the golang tour tour.golang.org"}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1494039161, "post_id": 43815912, "comment_id": 74671544, "body": "[][] int64 float64 are the 2 columns of time and value"}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1494053251, "post_id": 43815912, "comment_id": 74673930, "body": "It shouldn&#39;t be <code>val</code>but <code>var</code>."}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1494053385, "post_id": 43815912, "comment_id": 74673959, "body": "Even after changing <code>val</code> to <code>var</code>, you have invalid syntax: <code>var 2darray [][]int64, float64</code> is not valid Go."}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1494053586, "post_id": 43815912, "comment_id": 74673997, "body": "It&#39;s not clear how you want the resulting slice should look. Could you provide an example, perhaps in another language?"}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1494061758, "post_id": 43815912, "comment_id": 74675898, "body": "looking for the best way to take 2 1D arrays or slices how ever you want to call or refer to them and combine both 1D into 2D.  So you have 2D with col1 and col2 time and value"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494063916, "post_id": 43815912, "comment_id": 74676478, "body": "Create a structure that has 2 fields: time and value and create an array of those structures."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1494193997, "post_id": 43836500, "comment_id": 74710720, "body": "What I am looking for!  Thank!"}], "tags": [], "owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "is_accepted": true, "score": 0, "last_activity_date": 1494189763, "creation_date": 1494189763, "answer_id": 43836500, "question_id": 43815912, "link": "https://stackoverflow.com/questions/43815912/go-1d-array-combine-2d-array-with-append/43836500#43836500", "title": "go 1d array combine 2d array with append", "body": "<p>Here's an example of how it can be done:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype TimeAndValue struct {\n    time  int64\n    value float64\n}\n\nfunc main() {\n    times := []int64{0, 1, 2, 3, 4}\n    values := []float64{1.23, 2.34, 3.45, 4.56, 5.67}\n\n    timesAndValues := zip(times, values)\n\n    fmt.Println(timesAndValues)\n}\n\nfunc zip(ts []int64, vs []float64) []TimeAndValue {\n    if len(ts) != len(vs) {\n        panic(\"not same length\")\n    }\n\n    var res []TimeAndValue\n    for i, t := range ts {\n        res = append(res, TimeAndValue{time: t, value: vs[i]})\n    }\n\n    return res\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/1OWJ1HG1XL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/1OWJ1HG1XL</a></p>\n"}], "owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 43836500, "answer_count": 1, "score": -1, "last_activity_date": 1494189763, "creation_date": 1494035749, "last_edit_date": 1494036164, "question_id": 43815912, "link": "https://stackoverflow.com/questions/43815912/go-1d-array-combine-2d-array-with-append", "title": "go 1d array combine 2d array with append", "body": "<p>I have two one dimensional array and I want to combine the two single arrays into one multi dimensional array with <strong>append</strong>. </p>\n\n<p>How would this be done for the fastest in go?</p>\n\n<pre><code>val time []int64\nval value []float64\n\nval 2darray [][]int64, float64\n</code></pre>\n\n<p>Would append be the best way to do this in go?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": false, "score": 0, "last_activity_date": 1494034353, "creation_date": 1494034353, "answer_id": 43815806, "question_id": 43815605, "link": "https://stackoverflow.com/questions/43815605/why-does-glide-expect-gopath-to-be-set/43815806#43815806", "title": "Why does glide expect GOPATH to be set?", "body": "<p>I'm not very familiar with <code>glide</code> but GOPATH is a variable used by <code>go</code> to define where your workspace is. </p>\n\n<p>As of Go 1.8.1, GOPATH defaults to a <code>go</code> subdirectory in your user's home directory. Here's the relevant commit <a href=\"https://github.com/golang/go/commit/74628a8b9f102bddd5078ee426efe0fd57033115\" rel=\"nofollow noreferrer\">https://github.com/golang/go/commit/74628a8b9f102bddd5078ee426efe0fd57033115</a></p>\n\n<p>If you're using anything below Go 1.8.1 then your GOPATH is required to be set. </p>\n\n<p>Also, glide doesn't seem to make any assumptions about GOPATH but it plays nicely with Go's 1.8.1 default. </p>\n"}, {"comments": [{"owner": {"reputation": 57199, "user_id": 265261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e27be34f21aa0acd442e1961c17c362?s=128&d=identicon&r=PG", "display_name": "aknuds1", "link": "https://stackoverflow.com/users/265261/aknuds1"}, "edited": false, "score": 0, "creation_date": 1494034451, "post_id": 43815809, "comment_id": 74670895, "body": "Aha... that makes sense. Thanks for clearing this up!"}], "tags": [], "owner": {"reputation": 18829, "user_id": 24998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c14a4f2931fa9336fdccdfe11318fef?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/24998/jack"}, "is_accepted": true, "score": 2, "last_activity_date": 1494034525, "last_edit_date": 1494034525, "creation_date": 1494034392, "answer_id": 43815809, "question_id": 43815605, "link": "https://stackoverflow.com/questions/43815605/why-does-glide-expect-gopath-to-be-set/43815809#43815809", "title": "Why does glide expect GOPATH to be set?", "body": "<blockquote>\n  <p>Why does glide require GOPATH to be set?</p>\n</blockquote>\n\n<p>Because <code>GOPATH</code> wasn't optional until Go 1.8 and glide existed before 1.8. Glide <a href=\"https://github.com/Masterminds/glide/pull/798\" rel=\"nofollow noreferrer\">was updated 25 days ago to handle this change</a>, but the most recent release (<code>0.12.13</code> and what you're using) was released in <a href=\"https://github.com/Masterminds/glide/releases/tag/v0.12.3\" rel=\"nofollow noreferrer\">October of 2016</a></p>\n"}], "owner": {"reputation": 57199, "user_id": 265261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e27be34f21aa0acd442e1961c17c362?s=128&d=identicon&r=PG", "display_name": "aknuds1", "link": "https://stackoverflow.com/users/265261/aknuds1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 43815809, "answer_count": 2, "score": 1, "last_activity_date": 1494034525, "creation_date": 1494032090, "last_edit_date": 1494034005, "question_id": 43815605, "link": "https://stackoverflow.com/questions/43815605/why-does-glide-expect-gopath-to-be-set", "title": "Why does glide expect GOPATH to be set?", "body": "<p>I'm trying to install the dependencies for a project (on OS X), which involves calling <code>glide up</code>. However, <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow noreferrer\">glide</a> fails consistently with the following error: <code>[ERROR] $GOPATH is not set.</code>. I'm using glide version 0.12.3 and go version 1.8.1.</p>\n\n<p>Why does glide require <code>GOPATH</code> to be set?</p>\n\n<p>I'm new to go and glide, but from what I can tell defining $GOPATH should be optional.</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1494028199, "post_id": 43815108, "comment_id": 74669812, "body": "In order for the compiled protobuf to be importable as &quot;tutorial&quot;, you need to set <code>--go_out=</code> to <code>$GOPATH&#47;src&#47;tutorial</code>."}, {"owner": {"reputation": 193, "user_id": 7965600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1b7a13c82d51eeba94befbf35d298dd?s=128&d=identicon&r=PG&f=1", "display_name": "whyme", "link": "https://stackoverflow.com/users/7965600/whyme"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1494028878, "post_id": 43815108, "comment_id": 74669938, "body": "Yes, that works. Thanks ! ... it seems that I need to read more about import in golang, since I don&#39;t understand why I cannot import it from the same directory"}], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 7965600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1b7a13c82d51eeba94befbf35d298dd?s=128&d=identicon&r=PG&f=1", "display_name": "whyme", "link": "https://stackoverflow.com/users/7965600/whyme"}, "is_accepted": false, "score": 2, "last_activity_date": 1494044232, "creation_date": 1494044232, "answer_id": 43816662, "question_id": 43815108, "link": "https://stackoverflow.com/questions/43815108/protocol-buffers-in-go-cannot-find-package/43816662#43816662", "title": "Protocol buffers in Go: cannot find package", "body": "<p>This question showed my lack of understanding of Go's packaging. After some reading, here are my conclusions/rules:<br>\n1. one package per folder: all the .go files in directory \"<strong>abc</strong>\" will indicate <code>package abc</code><br>\n2. you can't have package <code>main</code> and package <code>abc</code> in same folder<br>\n3. <code>go install</code> creates package object <code>abc.a</code> in <code>$GOPATH/pkg/GOOS_GOARCH/&lt;path_to_abc_excluding_abc&gt;</code><br>\n4. for the package <code>main</code> in folder <code>$GOPATH/src/x/y/z/foo/</code> then <code>go install</code> compiles and installs an executable called <code>foo</code> (the name of the last directory in the path) in <code>$GOPATH/bin</code>  </p>\n\n<p>Now, back to the initial question: the directory <code>$GOPATH/src/protobufs</code> contains multiple packages:<br>\n- the compiled protobuf with the package name <code>tutorial</code>  and<br>\n- the <code>main</code> package in <code>test.go</code><br>\nThis contradicts with the above listed rules.</p>\n\n<p>I believe that one elegant solution is:<br>\n- assuming I'm in <code>$GOPATH/src/protobufs</code><br>\n- create a subdir called <code>tutorials</code><br>\n- install the compiled protobuf in that subdir:  <code>protoc --go_out=./tutorial ./addressbook.proto</code><br>\n- the <code>test.go</code> can now have <code>package main</code> and <code>import \"protobufs/tutorial\"</code>  </p>\n\n<p>Thanks for putting on the right track !</p>\n"}, {"tags": [], "owner": {"reputation": 1163, "user_id": 5335565, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-coM64Z-2njg/AAAAAAAAAAI/AAAAAAAAADs/r4GxkKH6FII/photo.jpg?sz=128", "display_name": "Izana", "link": "https://stackoverflow.com/users/5335565/izana"}, "is_accepted": false, "score": 0, "last_activity_date": 1608841563, "creation_date": 1608841563, "answer_id": 65442950, "question_id": 43815108, "link": "https://stackoverflow.com/questions/43815108/protocol-buffers-in-go-cannot-find-package/65442950#65442950", "title": "Protocol buffers in Go: cannot find package", "body": "<p>check <a href=\"https://golang.org/doc/gopath_code.html#Workspaces\" rel=\"nofollow noreferrer\">GO workspace</a>:</p>\n<pre><code>A workspace is a directory hierarchy with two directories at its root:\n\nsrc contains Go source files, and\nbin contains executable commands.\n</code></pre>\n<p>The tutorial is based on this structure, i.e.,</p>\n<pre><code>src/\n    github.com/protocolbuffers/protobuf/examples/\n      tutorial/\n         addressbook.pb.go\n      list_address.go\n</code></pre>\n<p>In the <a href=\"https://github.com/protocolbuffers/protobuf/blob/635156e40637d65650e91a21afec10ad8fac5c19/examples/Makefile#L33\" rel=\"nofollow noreferrer\">makefile</a> of that tutorial, it generates <code>pb.go</code> under <code>examples</code> dir through:</p>\n<pre><code>mkdir -p tutorial\nprotoc $$PROTO_PATH --go_out=tutorial addressbook.proto\n</code></pre>\n<p>Under the <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">add_person.go</a>, it just assumes the import path is under <code>worksapce/src</code>, which is <code>$GOPATH/src</code> mentioned above:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n....\n\npb &quot;github.com/protocolbuffers/protobuf/examples/tutorial&quot;\n// find through $GOPATH/src/github.com/protocolbuffers/protobuf/examples/tutorial\n)\n\n</code></pre>\n<p>What you need to do is to set the right <code>GOPATH</code> and generate that <code>pb.go</code> under <code>$GOPATH/src</code></p>\n<pre><code>protoc -I=. --go_out=/Users/guihaoliang/Playground/go/my_workspace/src addressbook.proto\n</code></pre>\n<p>where <code>.</code> refers to where the <code>addressbook.proto</code> is located.</p>\n<p>The <code>GOPATH</code> workspace is going to be superseded by <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">go modules</a> so that you don't have to maintain the <code>src</code> and <code>bin</code> structure. The protobuf example is not using the new module structure.</p>\n"}], "owner": {"reputation": 193, "user_id": 7965600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1b7a13c82d51eeba94befbf35d298dd?s=128&d=identicon&r=PG&f=1", "display_name": "whyme", "link": "https://stackoverflow.com/users/7965600/whyme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2122, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1608841563, "creation_date": 1494027408, "question_id": 43815108, "link": "https://stackoverflow.com/questions/43815108/protocol-buffers-in-go-cannot-find-package", "title": "Protocol buffers in Go: cannot find package", "body": "<p>I'm following the <a href=\"https://developers.google.com/protocol-buffers/docs/gotutorial#compiling-your-protocol-buffers\" rel=\"nofollow noreferrer\">Protocol Buffer for Go tutorial</a> but I have the following problem:</p>\n\n<ol>\n<li>I create the addressbook proto definition</li>\n</ol>\n\n<blockquote>\n<pre><code>syntax = \"proto3\";\npackage tutorial;\n\nmessage Person {\n  string name = 1;\n...\n}\n</code></pre>\n</blockquote>\n\n<ol start=\"2\">\n<li>I successfully run the compiler and generate the go code</li>\n<li>I try to import the pb package but it fails</li>\n</ol>\n\n<p>Here is exactly what happens: I specifying the <code>--go_out</code> to be same as my proto definition: (<code>protoc --go_out=. addressbook.proto</code>)</p>\n\n<p>then in same folder, I create a test.go with these simple lines:</p>\n\n<pre><code>package main\n\nimport \"tutorial\"\n</code></pre>\n\n<p>but <code>go build test.go</code> returns error:</p>\n\n<pre><code>test.go:3:8: cannot find package \"tutorial\" in any of:\n    /usr/local/go/src/tutorial (from $GOROOT)\n    /home/vagrant/go2/src/tutorial (from $GOPATH)\n</code></pre>\n\n<p>then I change <code>test.go</code> to this:</p>\n\n<pre><code>package main\n\nimport \"protobufs/tutorial\"\n</code></pre>\n\n<p>and get this error:</p>\n\n<pre><code>test.go:3:8: cannot find package \"protobufs/tutorial\" in any of:\n    /usr/local/go/src/protobufs/tutorial (from $GOROOT)\n    /home/vagrant/go2/src/protobufs/tutorial (from $GOPATH)\n</code></pre>\n\n<p>but if I change the import to only:</p>\n\n<pre><code>package main\n\nimport \"protobufs\"\n</code></pre>\n\n<p>it finds that there's a \"tutorial\" package in that location:</p>\n\n<pre><code>test.go:3:8: found packages tutorial (addressbook.pb.go) and main (list_people.go) in /home/vagrant/go2/src/protobufs\n</code></pre>\n\n<p>What am I doing wrong ? How should the import look like in order to make this work ?</p>\n\n<p>Thank you !</p>\n\n<p>FYI: a snippet of my go env:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"/home/vagrant/go2/bin\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/vagrant/go2\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\n</code></pre>\n"}, {"tags": ["testing", "go", "integration-testing", "microservices"], "comments": [{"owner": {"reputation": 69512, "user_id": 697630, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/40769e88c0dc93d387a9e368c332fdf9?s=128&d=identicon&r=PG", "display_name": "Edwin Dalorzo", "link": "https://stackoverflow.com/users/697630/edwin-dalorzo"}, "edited": false, "score": 0, "creation_date": 1494025891, "post_id": 43814764, "comment_id": 74669304, "body": "The question seems kind of broad. It seems you need to go and do some research first and then come back with specific questions. <a href=\"https://martinfowler.com/articles/microservice-testing/\" rel=\"nofollow noreferrer\">This</a> might be a good start."}], "answers": [{"comments": [{"owner": {"reputation": 7399, "user_id": 5077196, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AjgU4.jpg?s=128&g=1", "display_name": "Yahya Hussein", "link": "https://stackoverflow.com/users/5077196/yahya-hussein"}, "edited": false, "score": 0, "creation_date": 1524555018, "post_id": 43816774, "comment_id": 87007905, "body": "I do not see how CDC would replace e2e test, e2e usually includes UI, does CDC?"}], "tags": [], "owner": {"reputation": 14518, "user_id": 2575224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXLfW.jpg?s=128&g=1", "display_name": "Constantin Galbenu", "link": "https://stackoverflow.com/users/2575224/constantin-galbenu"}, "is_accepted": true, "score": 1, "last_activity_date": 1494045527, "creation_date": 1494045527, "answer_id": 43816774, "question_id": 43814764, "link": "https://stackoverflow.com/questions/43814764/testing-microservices/43816774#43816774", "title": "Testing microservices?", "body": "<p>An alternative approach to end-to-end testing is <a href=\"https://www.martinfowler.com/articles/consumerDrivenContracts.html\" rel=\"nofollow noreferrer\">Consumer-Driven Contract</a> (CDC).</p>\n\n<p>Although is useful to have some end-to-end tests, they have some disadvantages like:</p>\n\n<ul>\n<li><p>the consumer service must know how to start the provider service. This sounds like unnecessary information, likely difficult to maintain when the number of services start ramping up;</p></li>\n<li><p>starting up a service can be slow. Even if we\u2019re only talking a few seconds, this is adding overhead to build times. If a consumer depends on multiple services, this all starts adding up;</p></li>\n<li><p>the provider service might depend on a data store or other services to work as expected. It means that now not only the Provider needs to be started but also a few other services, maybe a database.</p></li>\n</ul>\n\n<p>The idea of CDC is described shortly as:</p>\n\n<ol>\n<li>The consumer defines what it expects from a specific request to a service</li>\n<li>The provider and the consumer agree on this contract</li>\n<li>The provider continuously verifies that the contract is fulfilled</li>\n</ol>\n\n<p>This information is taken from <a href=\"http://techblog.newsweaver.com/why-should-you-use-consumer-driven-contracts-for-microservices-integration-tests/\" rel=\"nofollow noreferrer\">here</a>. Read more on this <a href=\"https://specto.io/blog/2016/11/16/spring-cloud-contract/\" rel=\"nofollow noreferrer\">article</a>, it can be useful even if it is specific to Java.</p>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1494192979, "creation_date": 1494192979, "answer_id": 43836979, "question_id": 43814764, "link": "https://stackoverflow.com/questions/43814764/testing-microservices/43836979#43836979", "title": "Testing microservices?", "body": "<p>You can do this in a standard Go unit test using the <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\">httptest</a> package. This allows you to create mock <code>Request</code> and <code>ResponseWriter</code> objects that can be passed to any <code>Handler</code> or <code>HandleFunc</code>. You create the appropriate <code>Request</code>, pass it to your handler, then read the response out of the <code>ResponseRecorder</code> and check it against the expected response.</p>\n\n<p>If you're using the default mux (calling <code>http.Handle()</code> to register handlers) you can test against <code>http.DefaultServeMux</code>. I've used it for microservices in the past with good results. Works for benchmarking handlers, routing, and middleware as well.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 7994586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa7a864dbe7fa102be0d08d7f06955b3?s=128&d=identicon&r=PG&f=1", "display_name": "Ang", "link": "https://stackoverflow.com/users/7994586/ang"}, "is_accepted": false, "score": 0, "last_activity_date": 1494741571, "creation_date": 1494741571, "answer_id": 43960829, "question_id": 43814764, "link": "https://stackoverflow.com/questions/43814764/testing-microservices/43960829#43960829", "title": "Testing microservices?", "body": "<p>You should always use golang's native <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">unit testing framework</a> to test each individual service (please, no shell script!). httptest seems fine, but I would argue it is helpful to have finer-grained test boundaries -- you should really have one _test.go for each functional block of your code. Smaller tests are easier to maintain.</p>\n\n<p>In terms of overall integration tests that involve multiple microservices, you shouldn't do them at development time. Set up a staging area and run the tests over there.</p>\n\n<p>My 2 cents.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6467981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 43816774, "answer_count": 3, "score": 4, "last_activity_date": 1494741571, "creation_date": 1494024395, "question_id": 43814764, "link": "https://stackoverflow.com/questions/43814764/testing-microservices", "title": "Testing microservices?", "body": "<p>I know this question is a little subjective but I am lost on what to do here. At the moment I am using Go + Go-kit to write some microservices. I'd like to test the endpoints of these microservices in an integration test type fashion but I am unsure how to go about it. The only thing I can think of is to have shell scripts that hit the endpoints and check for responses. But this seems like kludge and not a real smart practice. I feel like there should be a better way to do this. Does anyone have any suggestions?</p>\n"}, {"tags": ["go", "types", "casting"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 3, "creation_date": 1494017477, "post_id": 43813553, "comment_id": 74666579, "body": "Can you put some amount of relevant code in the question itself please?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 2132358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3465f3138406b42e0beadbe4d8fe86b?s=128&d=identicon&r=PG", "display_name": "Nohac", "link": "https://stackoverflow.com/users/2132358/nohac"}, "edited": false, "score": 0, "creation_date": 1494018452, "post_id": 43813591, "comment_id": 74666944, "body": "Thanks, but that answer isn&#39;t good enough for me as I still find it kind of unintuitive. It looks like they should produce the exact same result. I understand that interfaces are different from the go primitives, but that doesn&#39;t really explain the different behavior when using a type alias."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 41, "user_id": 2132358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3465f3138406b42e0beadbe4d8fe86b?s=128&d=identicon&r=PG", "display_name": "Nohac", "link": "https://stackoverflow.com/users/2132358/nohac"}, "edited": false, "score": 2, "creation_date": 1494019315, "post_id": 43813591, "comment_id": 74667241, "body": "<code>type Apple interface{}</code> is not a type alias. It says &quot;Anything that implements this set of methods is a valid Apple&quot;. In the case of the empty interface, literally anything satisfies it."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 1, "last_activity_date": 1494017647, "creation_date": 1494017647, "answer_id": 43813591, "question_id": 43813553, "link": "https://stackoverflow.com/questions/43813553/go-type-switch-for-type-aliases/43813591#43813591", "title": "Go type switch for type aliases", "body": "<p>In the case where Apple and Orange are defined as <code>interface{}</code>, the type switch is satisfied by anything that implements that interface. </p>\n\n<p>For the empty interface, that is <strong>anything at all</strong>, and it takes the first case that matches. </p>\n\n<p>When Apple and Orange are \"aliases\" for a non-interface type (int), only a variable that is explicitly an Apple or Orange can satisfy the type switch.</p>\n"}, {"tags": [], "owner": {"reputation": 464, "user_id": 6135914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnNc6.jpg?s=128&g=1", "display_name": "JT.", "link": "https://stackoverflow.com/users/6135914/jt"}, "is_accepted": false, "score": 1, "last_activity_date": 1564574622, "last_edit_date": 1564574622, "creation_date": 1494179948, "answer_id": 43834837, "question_id": 43813553, "link": "https://stackoverflow.com/questions/43813553/go-type-switch-for-type-aliases/43834837#43834837", "title": "Go type switch for type aliases", "body": "<p>Because you are defining the Apple and Orange types to an empty interface they are satisfied by anything. </p>\n\n<p>The empty interface is in essence nothing specific.</p>\n\n<p>Everything in the first example can be asserted as the int type neither Apple or Oranges.</p>\n\n<p>Look at this small change to your first example's code.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\n\ntype Apple interface{}\ntype Orange interface{}\n\ntype Basket struct {\n    Fruit interface{}\n}\n\nfunc getFruites(basket Basket) {\n    switch t := basket.Fruit.(type) {\n    case int: \n        fmt.Println(\"empty interfaces are satisfying an int\")\n    case Apple:\n        apples, ok := t.(int)\n        if !ok {\n            log.Panic(\"Rotten apples!\")\n        }\n        fmt.Println(\"Apples:\", apples)\n    case Orange:\n        oranges, ok := t.(int)\n        if !ok {\n            log.Panic(\"Rotten oranges!\")\n        }\n        fmt.Println(\"Oranges:\", oranges)\n    }\n}\n\nfunc main() {\n    appleBasket := Basket{\n        Fruit: Apple(10),\n    }\n\n    getFruites(appleBasket)\n\n    orangeBasket := Basket{\n        Fruit: Orange(10),\n    }\n\n    getFruites(orangeBasket)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/LDtvbXnjT7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LDtvbXnjT7</a></p>\n"}, {"tags": [], "owner": {"reputation": 271, "user_id": 8849444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760b3e84b3d7b6ce9ea0f8f336f4e791?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Khandelwal", "link": "https://stackoverflow.com/users/8849444/tarun-khandelwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1591993773, "last_edit_date": 1591993773, "creation_date": 1591993430, "answer_id": 62351955, "question_id": 43813553, "link": "https://stackoverflow.com/questions/43813553/go-type-switch-for-type-aliases/62351955#62351955", "title": "Go type switch for type aliases", "body": "<p>Since you said other answers didn't feel intuitive, I am attempting to explain it from a completely different standpoint. The case you mention has <strong>nothing to do with your type aliases</strong> and everything to do with how interfaces work in Go. To more clearly show the difference between the two codes you provided, here is a different code that gives the similar output as your interface example, but doesn't use type aliases at all.</p>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/0tyDV28cp2b\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0tyDV28cp2b</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\n\n// Create two interfaces that have exactly the same signature\n// Why? So every struct that implements one automatically implements the other\n\ntype interface1 interface {\n    Foo() int\n}\n\ntype interface2 interface {\n    Foo() int\n}\n\n// Create an impl for the interfaces defined above\ntype impl int\n\nfunc (i impl) Foo() int { return int(i) }\n\n// Note that the Fruit is of type \"interface2\"\n// Despite that, it will always go to \"interface1\" case in the type switch\n// It is because anything that implements interface2\n// also implements interface1\ntype Basket struct {\n    Fruit interface2\n}\n\nfunc getFruites(basket Basket) {\n    switch t := basket.Fruit.(type) {\n    case interface1:\n        ans, ok := t.(impl)\n        if !ok {\n            log.Panic(\"Rotten ans!\")\n        }\n        fmt.Println(\"Interface1:\", ans)\n    case interface2:\n        ans, ok := t.(impl)\n        if !ok {\n            log.Panic(\"Rotten ans!\")\n        }\n        fmt.Println(\"Interface2:\", ans)\n    }\n}\n\nfunc main() {\n    appleBasket := Basket{\n        Fruit: impl(10),\n    }\n\n    getFruites(appleBasket)\n\n    orangeBasket := Basket{\n        Fruit: impl(10),\n    }\n\n    getFruites(orangeBasket)\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 2132358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3465f3138406b42e0beadbe4d8fe86b?s=128&d=identicon&r=PG", "display_name": "Nohac", "link": "https://stackoverflow.com/users/2132358/nohac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1591993773, "creation_date": 1494017442, "last_edit_date": 1591985155, "question_id": 43813553, "link": "https://stackoverflow.com/questions/43813553/go-type-switch-for-type-aliases", "title": "Go type switch for type aliases", "body": "<p>The answer to this is probably pretty obvious, but I'm asking anyways because I failed to find a good explanation for this.</p>\n\n<p>I have two examples that I've made, they do pretty much the same thing, however, the first one uses int's and the other one is using interfaces:</p>\n\n<p>Interface: <a href=\"https://play.golang.org/p/yb2oVaOJGF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yb2oVaOJGF</a> </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Apple interface{}\ntype Orange interface{}\n\ntype Basket struct {\n    Fruit interface{}\n}\n\nfunc getFruites(basket Basket) {\n    switch t := basket.Fruit.(type) {\n    case Apple:\n        apples, ok := t.(int)\n        if !ok {\n            log.Panic(\"Rotten apples!\")\n        }\n        fmt.Println(\"Apples:\", apples)\n    case Orange:\n        oranges, ok := t.(int)\n        if !ok {\n            log.Panic(\"Rotten oranges!\")\n        }\n        fmt.Println(\"Oranges:\", oranges)\n    }\n}\n\nfunc main() {\n    appleBasket := Basket{\n        Fruit: Apple(10),\n    }\n\n    getFruites(appleBasket)\n\n    orangeBasket := Basket{\n        Fruit: Orange(10),\n    }\n\n    getFruites(orangeBasket)\n}\n</code></pre>\n\n<p>Int: <a href=\"https://play.golang.org/p/_z8Mm0II41\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_z8Mm0II41</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Apple int\ntype Orange int\n\ntype Basket struct {\n    Fruit interface{}\n}\n\nfunc getFruites(basket Basket) {\n    switch t := basket.Fruit.(type) {\n    case Apple:\n        apples := t\n        fmt.Println(\"Apples:\", apples)\n    case Orange:\n        oranges := t\n        fmt.Println(\"Oranges:\", oranges)\n    }\n}\n\nfunc main() {\n    appleBasket := Basket{\n        Fruit: Apple(10),\n    }\n\n    getFruites(appleBasket)\n\n    orangeBasket := Basket{\n        Fruit: Orange(10),\n    }\n\n    getFruites(orangeBasket)\n}\n</code></pre>\n\n<p>Could someone please explain why they produce different output?</p>\n"}, {"tags": ["pointers", "go", "struct"], "comments": [{"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1494010901, "post_id": 43811652, "comment_id": 74663504, "body": "Here is a nice explanation of pointers in Go: <a href=\"https://dave.cheney.net/2017/04/26/understand-go-pointers-in-less-than-800-words-or-your-money-back\" rel=\"nofollow noreferrer\">dave.cheney.net/2017/04/26/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 0, "creation_date": 1494015262, "post_id": 43811786, "comment_id": 74665557, "body": "My attempt to try the first method gave a compiler error (&quot;invalid pointer type *bool for composite literal&quot;) but the second method worked for my purposes. Thank you!"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 0, "creation_date": 1494037773, "post_id": 43811786, "comment_id": 74671378, "body": "@BartSilverstrim Ah well I didn&#39;t test it. I guess I should have."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 0, "creation_date": 1494038556, "post_id": 43811786, "comment_id": 74671480, "body": "@BartSilverstrim I fixed my first example."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 10, "last_activity_date": 1494038524, "last_edit_date": 1494038524, "creation_date": 1494009614, "answer_id": 43811786, "question_id": 43811652, "link": "https://stackoverflow.com/questions/43811652/golang-assigning-a-value-to-struct-member-that-is-a-pointer/43811786#43811786", "title": "Golang: Assigning a value to struct member that is a pointer", "body": "<p>Why is it an error? Because a pointer only points. It doesn't create anything to point <em>AT</em>. You need to do that.</p>\n\n<p>How to set it to false? This all depends on <em>WHY</em> you made it a pointer.</p>\n\n<p>Is every copy of this supposed to point to the same bool? Then it should be allocated some space in a creation function.</p>\n\n<pre><code>func NewStruct() *strctTest {\n    bl := true\n    return &amp;strctTest{\n        blTest: &amp;bl,\n     }\n}\n</code></pre>\n\n<p>Is the user supposed to point it at a boolean of his own? Then it should be set manually when creating the object.</p>\n\n<pre><code>func main() {\n    myBool := false\n    stctTest := strctTest{\n        blTest: &amp;myBool\n    }\n\n    fmt.Println(\"Test is \" + strconv.FormatBool(*strctTest.blTest))\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1526958437, "post_id": 43834903, "comment_id": 87931673, "body": "This didn&#39;t really answer the OP&#39;s question. He asked how to assign a value to a bool, not how to make a new memory allocation. In your example you should add how to assign a value to it. See <a href=\"https://play.golang.org/p/iqOD5hLcPPp\" rel=\"nofollow noreferrer\">play.golang.org/p/iqOD5hLcPPp</a>"}], "tags": [], "owner": {"reputation": 464, "user_id": 6135914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnNc6.jpg?s=128&g=1", "display_name": "JT.", "link": "https://stackoverflow.com/users/6135914/jt"}, "is_accepted": false, "score": 2, "last_activity_date": 1494180328, "creation_date": 1494180328, "answer_id": 43834903, "question_id": 43811652, "link": "https://stackoverflow.com/questions/43811652/golang-assigning-a-value-to-struct-member-that-is-a-pointer/43834903#43834903", "title": "Golang: Assigning a value to struct member that is a pointer", "body": "<p>Another way you can think of it is the zero value of a boolean is false.</p>\n\n<p>This is not as clear but another way to do it.</p>\n\n<p><a href=\"https://play.golang.org/p/REbnJumcFi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/REbnJumcFi</a></p>\n\n<p>I would recommend a <code>New()</code> func that returns a reference to a initialized struct type.</p>\n"}, {"tags": [], "owner": {"reputation": 2393, "user_id": 7648377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lK7JG.jpg?s=128&g=1", "display_name": "Andrei Lupuleasa", "link": "https://stackoverflow.com/users/7648377/andrei-lupuleasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1583136621, "creation_date": 1583136621, "answer_id": 60484772, "question_id": 43811652, "link": "https://stackoverflow.com/questions/43811652/golang-assigning-a-value-to-struct-member-that-is-a-pointer/60484772#60484772", "title": "Golang: Assigning a value to struct member that is a pointer", "body": "<p>You could also do something like:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\n// Test\ntype stctTest struct {\n    blTest *bool\n}\n\nfunc main() {\n\n    strctTest := stctTest{\n        blTest: &amp;[]bool{true}[0],\n    }\n\n    fmt.Println(\"Test is \" + strconv.FormatBool(*strctTest.blTest))\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/OWSosQhrUql\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OWSosQhrUql</a></p>\n"}], "owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11077, "favorite_count": 2, "accepted_answer_id": 43811786, "answer_count": 3, "score": 7, "last_activity_date": 1583136621, "creation_date": 1494009062, "question_id": 43811652, "link": "https://stackoverflow.com/questions/43811652/golang-assigning-a-value-to-struct-member-that-is-a-pointer", "title": "Golang: Assigning a value to struct member that is a pointer", "body": "<p>I'm trying to assign a value to a struct member that is a pointer, but it gives \"panic: runtime error: invalid memory address or nil pointer dereference\" at runtime...</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\n// Test\ntype stctTest struct {\n    blTest *bool\n}\n\nfunc main() {\n\n    var strctTest stctTest\n    *strctTest.blTest = false\n\n    fmt.Println(\"Test is \" + strconv.FormatBool(*strctTest.blTest))\n\n}\n</code></pre>\n\n<p>The runtime error seems to come from the assignment of the value with *strctTest.blTest = false , but why? How do I set it to false?</p>\n"}, {"tags": ["api", "amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 1915, "user_id": 1267765, "user_type": "registered", "profile_image": "https://graph.facebook.com/113100281/picture?type=large", "display_name": "Luke Waite", "link": "https://stackoverflow.com/users/1267765/luke-waite"}, "edited": false, "score": 0, "creation_date": 1494008910, "post_id": 43811508, "comment_id": 74662466, "body": "What kind of tokens are you trying to generate? It sounds like (since you say 2 tokens) you might be trying to generate short lived AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY pairs?"}, {"owner": {"reputation": 643, "user_id": 7552759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ldvQc.jpg?s=128&g=1", "display_name": "Anurope", "link": "https://stackoverflow.com/users/7552759/anurope"}, "reply_to_user": {"reputation": 1915, "user_id": 1267765, "user_type": "registered", "profile_image": "https://graph.facebook.com/113100281/picture?type=large", "display_name": "Luke Waite", "link": "https://stackoverflow.com/users/1267765/luke-waite"}, "edited": false, "score": 0, "creation_date": 1494008996, "post_id": 43811508, "comment_id": 74662513, "body": "To be honest I don&#39;t know what the tokens should be. I think you&#39;re spot on. How would I generate these access keys from inside the program?"}, {"owner": {"reputation": 1915, "user_id": 1267765, "user_type": "registered", "profile_image": "https://graph.facebook.com/113100281/picture?type=large", "display_name": "Luke Waite", "link": "https://stackoverflow.com/users/1267765/luke-waite"}, "edited": false, "score": 0, "creation_date": 1494009277, "post_id": 43811508, "comment_id": 74662662, "body": "Pre-signed URLs then would be your go-to. You&#39;d need to return one for each upload being performed. To be clear - short lived key pairs as mentioned in my first comment are <i>not</i> where you want to go."}], "answers": [{"comments": [{"owner": {"reputation": 643, "user_id": 7552759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ldvQc.jpg?s=128&g=1", "display_name": "Anurope", "link": "https://stackoverflow.com/users/7552759/anurope"}, "edited": false, "score": 0, "creation_date": 1494009474, "post_id": 43811683, "comment_id": 74662749, "body": "This is great, Thank you."}], "tags": [], "owner": {"reputation": 1915, "user_id": 1267765, "user_type": "registered", "profile_image": "https://graph.facebook.com/113100281/picture?type=large", "display_name": "Luke Waite", "link": "https://stackoverflow.com/users/1267765/luke-waite"}, "is_accepted": true, "score": 1, "last_activity_date": 1494009207, "creation_date": 1494009207, "answer_id": 43811683, "question_id": 43811508, "link": "https://stackoverflow.com/questions/43811508/amazon-s3-token-generation-from-a-golang-rest-api/43811683#43811683", "title": "Amazon S3 token generation from a Golang REST API", "body": "<p>To generate tokens for users to upload files directly to s3, you can use <a href=\"http://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/s3-example-presigned-urls.html\" rel=\"nofollow noreferrer\">pre-signed URLS</a>.</p>\n\n<p>After generating a pre-signed URL, return that to the user and the calling application can use that to upload the file.</p>\n\n<p>This example from the link above should be about what you're looking for:</p>\n\n<pre><code>svc := s3.New(session.New(&amp;aws.Config{Region: aws.String(\"us-west-2\")}))\nreq, _ := svc.PutObjectRequest(&amp;s3.PutObjectInput{\n    Bucket: aws.String(\"myBucket\"),\n    Key:    aws.String(\"myKey\"),\n})\nstr, err := req.Presign(15 * time.Minute)\n\nlog.Println(\"The URL is:\", str, \" err:\", err)\n</code></pre>\n"}], "owner": {"reputation": 643, "user_id": 7552759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ldvQc.jpg?s=128&g=1", "display_name": "Anurope", "link": "https://stackoverflow.com/users/7552759/anurope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 43811683, "answer_count": 1, "score": 0, "last_activity_date": 1494009207, "creation_date": 1494008533, "last_edit_date": 1494008914, "question_id": 43811508, "link": "https://stackoverflow.com/questions/43811508/amazon-s3-token-generation-from-a-golang-rest-api", "title": "Amazon S3 token generation from a Golang REST API", "body": "<p>I'm writing a Golang REST API that needs to generate S3 tokens for users so that they can upload files to the specific folder inside a bucket.</p>\n\n<p>This is what I need to implement:</p>\n\n<pre><code>Method: GET\nEndpoint: myapp.com/images/:imageid/token\nDescription: Return 2 tokens so that the user can upload files to the S3 \n             bucket related to the image ID parameter.\n</code></pre>\n\n<p>I'm using the Golang echo framework.\nAnd I'm not really sure how to implement this functionality.</p>\n\n<p>Should this be done via the AWS SDK or does Amazon offer other ways of programmatically generrating tokens?</p>\n"}, {"tags": ["function", "go"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5961999, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10208892459852196/picture?type=large", "display_name": "Hassaan Hasan", "link": "https://stackoverflow.com/users/5961999/hassaan-hasan"}, "edited": false, "score": 0, "creation_date": 1494010116, "post_id": 43811498, "comment_id": 74663063, "body": "This solves the original error but it now gives this error undefined: cornerFinder, where I am calling the function recursively"}, {"owner": {"reputation": 71, "user_id": 5961999, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10208892459852196/picture?type=large", "display_name": "Hassaan Hasan", "link": "https://stackoverflow.com/users/5961999/hassaan-hasan"}, "edited": false, "score": 0, "creation_date": 1494011216, "post_id": 43811498, "comment_id": 74663644, "body": "Thank you so much."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1494010774, "last_edit_date": 1494010774, "creation_date": 1494008505, "answer_id": 43811498, "question_id": 43811387, "link": "https://stackoverflow.com/questions/43811387/incorrect-function-declaration-syntax-error-unexpected-cornerfinder-expecting/43811498#43811498", "title": "incorrect function declaration syntax error: unexpected cornerFinder, expecting (", "body": "<p><a href=\"https://golang.org/ref/spec#Function_declarations\" rel=\"nofollow noreferrer\">Function declarations</a> are only allowed at <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">top level</a>. Assign a <a href=\"https://golang.org/ref/spec#Function_literals\" rel=\"nofollow noreferrer\">function literal</a> to a local variable instead.</p>\n\n<pre><code>    var cornerFinder func(censusData []CensusGroup)\n    cornerFinder = func(censusData []CensusGroup) {\n       ... function body from the question\n    }\n    cornerFinder(censusData)\n</code></pre>\n\n<p>A <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a> is not used here because the function calls itself recursively.</p>\n"}], "owner": {"reputation": 71, "user_id": 5961999, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10208892459852196/picture?type=large", "display_name": "Hassaan Hasan", "link": "https://stackoverflow.com/users/5961999/hassaan-hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 43811498, "answer_count": 1, "score": 0, "last_activity_date": 1494010774, "creation_date": 1494008030, "last_edit_date": 1494010237, "question_id": 43811387, "link": "https://stackoverflow.com/questions/43811387/incorrect-function-declaration-syntax-error-unexpected-cornerfinder-expecting", "title": "incorrect function declaration syntax error: unexpected cornerFinder, expecting (", "body": "<p>I receive this error when I try to run this code:\nsyntax error: unexpected cornerFinder, expecting (</p>\n\n<pre><code>case \"-v2\":\n        func cornerFinder(censusData []CensusGroup) {\n            if len(censusData) &lt;= 10000{\n                for i := 0; i &lt;= 10000; i++ {\n                    if (censusData.latitude &gt; maxLat){\n                        maxLat = censusData.latitude\n                    }\n                    if (censusData.latitude &lt; minLat){\n                        minLat = censusData.latitude\n                    }\n                    if (censusData.longitude &gt; maxLong){ \n                        maxLong = censusData.longitude\n                    }\n                    if (censusData.longitude &lt; minLong){\n                        minLong = censusData.longitude\n                    }\n                }    \n            }\n            mid := len(data)/2\n            done := make(chan bool)\n            go func() {\n                cornerFinder(censusData[:mid])\n                done&lt;- true\n            } ()\n            cornerFinder(censusData[mid:len(censusData)])\n            &lt;-done\n            return\n        }\n        cornerFinder(censusData)\n</code></pre>\n\n<p>Its giving this error on the second line of the code:</p>\n\n<p>func cornerFinder(censusData []CensusGroup) {</p>\n\n<p>I think it something trivial that I am missing. Been stuck on it for a couple of hours. Help would be appreciated</p>\n"}, {"tags": ["go", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": true, "score": 4, "last_activity_date": 1494013147, "creation_date": 1494013147, "answer_id": 43812631, "question_id": 43811221, "link": "https://stackoverflow.com/questions/43811221/unmarshal-yaml-map-nested-with-list/43812631#43812631", "title": "Unmarshal YAML Map Nested With List", "body": "<p>Change your type to this</p>\n\n<pre><code>type ThingAndGroups struct {\n    Groups []string `yaml:\"Groups\"`\n    Value  int      `yaml:\"Value\"`\n}\n</code></pre>\n\n<p>In the doc for <a href=\"https://godoc.org/gopkg.in/yaml.v2#Marshal\" rel=\"nofollow noreferrer\">https://godoc.org/gopkg.in/yaml.v2#Marshal</a> it says</p>\n\n<blockquote>\n  <p>Struct fields are only unmarshalled if they are exported (have an upper case first letter), and are unmarshalled using the field name lowercased as the default key. Custom keys may be defined via the \"yaml\" name in the field tag</p>\n</blockquote>\n\n<p>Alternatively you could change your yaml input to use lowercase fields like <code>value</code> then you wouldn't need to specify custom names.</p>\n"}], "owner": {"reputation": 1560, "user_id": 830610, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ad4beaa5454a99a1d3a581302f7d6af?s=128&d=identicon&r=PG", "display_name": "John Montague", "link": "https://stackoverflow.com/users/830610/john-montague"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 0, "accepted_answer_id": 43812631, "answer_count": 1, "score": 0, "last_activity_date": 1494013454, "creation_date": 1494007336, "last_edit_date": 1494013454, "question_id": 43811221, "link": "https://stackoverflow.com/questions/43811221/unmarshal-yaml-map-nested-with-list", "title": "Unmarshal YAML Map Nested With List", "body": "<p>I'm trying to write YAML for a datastructure which is both an int and a list of strings.  But I'm having trouble getting the data structure and the YAML string to match. eg</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    yaml \"gopkg.in/yaml.v2\"\n)\n\ntype ThingAndGroups struct {\n    Groups []string\n    Value  int\n}\n\nvar someStr = `\nthing1:\n  Groups:\n    - g1\n    - g2\n  Value:\n    5\n`\n\nfunc main() {\n    t := make(map[string]ThingAndGroups)\n\n    err := yaml.Unmarshal([]byte(someStr), &amp;t)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"--- t:\\n%v\\n\\n\", t)\n}\n</code></pre>\n\n<p>Returns</p>\n\n<blockquote>\n  <p>map[thing1:{[] 0}]</p>\n</blockquote>\n\n<p>How do I get thing1 to be a list of strings?</p>\n"}, {"tags": ["regex", "performance", "go"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1494004797, "post_id": 43810523, "comment_id": 74660337, "body": "The fact that it takes two function calls does not necessarily imply that it performs poorly.  Line count != performance.  In this case, such a function would still have to do both, finding each item and then replacing it.  If you really want it to be a single line, though, you could extract the values out within an enclosure handed to <a href=\"https://golang.org/pkg/regexp/#Regexp.ReplaceAllFunc\" rel=\"nofollow noreferrer\">golang.org/pkg/regexp/#Regexp.ReplaceAllFunc</a>.  Pretty sure it would actually be <i>less</i> efficient to do it that way, though."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1494004968, "post_id": 43810523, "comment_id": 74660422, "body": "I agree with your sentiment @Kaedys, but regexp in general for string processing is convenient, but often horrible overkill, especially if performance is a primary concern. But yes, performance and LOC can often be completely uncorrelated."}, {"owner": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494005243, "post_id": 43810523, "comment_id": 74660566, "body": "@Kaedys I agree completely that line count has nothing to do with performance. I was simply assuming that having those two regex call would loop through each string twice, and was inquiring if it could be done in one iteration, in what I would assume would be a performance gain."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1494008640, "post_id": 43810523, "comment_id": 74662332, "body": "I think some have found a way to do it in one go <a href=\"https://elliot.silvrback.com/go-replace-string-with-regular-expression-callback\" rel=\"nofollow noreferrer\">elliot.silvrback.com/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "edited": false, "score": 0, "creation_date": 1494005426, "post_id": 43810611, "comment_id": 74660674, "body": "That sounds elegant and simple, honestly I didn&#39;t expect calling ParseFloat on every word to be performant at all, but I&#39;ll try it out and see. I was assuming that regex matching was efficient as long as the pattern was pre-compiled beforehand, but it seems I was wrong."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "edited": false, "score": 0, "creation_date": 1494005664, "post_id": 43810611, "comment_id": 74660803, "body": "Yeah, that&#39;s a concern. But if it is not something that looks like a number, ParseFloat is pretty fast. Just looks at enough characters to know it isn&#39;t a number and then returns."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "edited": false, "score": 0, "creation_date": 1494005723, "post_id": 43810611, "comment_id": 74660837, "body": "<a href=\"https://golang.org/src/strconv/atof.go?s=11079:11134#L477\" rel=\"nofollow noreferrer\">golang.org/src/strconv/atof.go?s=11079:11134#L477</a> is actually kinda interesting to read through."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "edited": false, "score": 0, "creation_date": 1494005806, "post_id": 43810611, "comment_id": 74660881, "body": "When in doubt, run benchmarks. I&#39;d bet this would easily beat regexp, but I&#39;ve also been pretty surprised by things in the past."}, {"owner": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "edited": false, "score": 0, "creation_date": 1494006377, "post_id": 43810611, "comment_id": 74661197, "body": "Sadly after testing with my data, splitting on &quot; &quot; doesnt cover everything... some numbers have a &#39;%&#39;, &#39;+&#39; or &#39;-&#39; attached to them. It wasn&#39;t clear in my question, sorry. It was the main reason why I was looking into regex in the first place."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "edited": false, "score": 1, "creation_date": 1494006486, "post_id": 43810611, "comment_id": 74661247, "body": "I see. Still, anytime I feel like regex is the solution to my problem, I make sure to ask if a simple for loop could also solve it."}, {"owner": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "edited": false, "score": 0, "creation_date": 1494007534, "post_id": 43810611, "comment_id": 74661779, "body": "It could possibly still work if before parsing to float I check the last byte to see if its % then remove it, same with if the first byte is &#39;+&#39;. I think &#39;-&#39; should already get parsed correctly. Sadly the strings.Split returns a string token so I&#39;d have to parse it to []byte..."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 1, "last_activity_date": 1494005946, "last_edit_date": 1494005946, "creation_date": 1494004867, "answer_id": 43810611, "question_id": 43810523, "link": "https://stackoverflow.com/questions/43810523/is-it-possible-to-extract-parts-of-a-string-and-replace-those-parts-in-one-opera/43810611#43810611", "title": "Is it possible to extract parts of a string and replace those parts in one operation in Golang?", "body": "<p>If you need raw performance than regexp is rarely the way to achieve it, even if it is convenient. Iterating token by token should be pretty fast. Some code:</p>\n\n<pre><code>input := \"sdasd 3.2 sadas 6\"\noutput := []string{}\nnumbers := []float64{}\n\nfor _, tok := range strings.Split(input, \" \") {\n    if f, err := strconv.ParseFloat(tok, 64); err == nil {\n        numbers = append(numbers, f)\n        tok = \"#\"\n    }\n    output = append(output, tok)\n}\nfinalString := strings.Join(output, \" \")\nfmt.Println(finalString, numbers)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/8ZjljACahn\" rel=\"nofollow noreferrer\">playground link</a></p>\n\n<p>I'm sure there's a few more optimizations in there that could be made, but this is the general approach I'd take.</p>\n"}, {"tags": [], "owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "is_accepted": false, "score": 0, "last_activity_date": 1494008514, "creation_date": 1494008514, "answer_id": 43811501, "question_id": 43810523, "link": "https://stackoverflow.com/questions/43810523/is-it-possible-to-extract-parts-of-a-string-and-replace-those-parts-in-one-opera/43811501#43811501", "title": "Is it possible to extract parts of a string and replace those parts in one operation in Golang?", "body": "<p>Never underestimate the power of regex, especially the RE2 engine of Go.</p>\n\n<p>Also, never, ever, assume anything about performance without benchmarking.  It always surprises.</p>\n\n<p>The regular expression is usually compiled and cached.  To be sure, you could optimize by compiling it first.</p>\n"}], "owner": {"reputation": 357, "user_id": 2765757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78f2fdbb026f088d3503121ef822e10d?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/2765757/storm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494011835, "creation_date": 1494004544, "last_edit_date": 1494011835, "question_id": 43810523, "link": "https://stackoverflow.com/questions/43810523/is-it-possible-to-extract-parts-of-a-string-and-replace-those-parts-in-one-opera", "title": "Is it possible to extract parts of a string and replace those parts in one operation in Golang?", "body": "<p>Say I want to extract all numbers from a string (Most likely using regex matching) and I also want to replace those number matches with a generic placeholder like \"#\".</p>\n\n<p>This is easily done in two parts using FindAll, then ReplaceAll. However I have serious doubts about the performance costs of doing such operations.</p>\n\n<p>So take a string </p>\n\n<pre><code>\"sdasd 3.2% sadas 6 ... +8.9\"\n</code></pre>\n\n<p>replace it with </p>\n\n<pre><code>\"sdasd #% sadas # ... +#\"\n</code></pre>\n\n<p>and get a slice</p>\n\n<pre><code>[3.2,6.0,8.9]\n</code></pre>\n\n<p>In the most performant way possible.</p>\n\n<p>Edit : I implemented the regexp.FindAllString + regexp.ReplaceAllString and the performance hit to my app was very minimal. I will hopefully try Elliot Chance's approach and compare the two when I have time.</p>\n"}, {"tags": ["heroku", "go", "makefile"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494005382, "post_id": 43810294, "comment_id": 74660646, "body": "I don&#39;t see any <code>.go</code> files in your project."}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494005401, "post_id": 43810294, "comment_id": 74660659, "body": "They are inside the folders"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494005496, "post_id": 43810294, "comment_id": 74660716, "body": "You need at least one <code>.go</code> file in the root of your project which must be <code>package main</code>"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494005628, "post_id": 43810294, "comment_id": 74660785, "body": "But I want the web dynos to run the main package inside secretly-sender-web. Will that still work?"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494005729, "post_id": 43810294, "comment_id": 74660841, "body": "Nah, need at least one <code>main</code> go program. What you can do is include your go files within those folders with <code>include &quot;github.com&#47;heroku&#47;secretly-sender&#47;cmd&#47;secretly-sender-web&quot;</code> as long as the <code>secretly-sender-web</code> is not <code>package main</code>"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494005871, "post_id": 43810294, "comment_id": 74660919, "body": "Your options are:   - Make those <code>go</code> files in the sub folders their own packages and include into a <code>main.go</code> file located in the root of your project.  - Change your layout so all <code>go</code> files are in the root of your project (all with <code>package main</code>"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 1, "creation_date": 1494006171, "post_id": 43810294, "comment_id": 74661081, "body": "But look at my procfile. How can I have the web dyno run the main in cmd/secretly-sender-web and the worker dyno run the cmd/secretly-sender-worker. I structured it like this because I read it was a good practice but I don&#39;t get how they make this work."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494006309, "post_id": 43810294, "comment_id": 74661168, "body": "Hm, sorry but I&#39;m not sure about proc files and I&#39;ve never done anything like that. As far as I know, if you want to run any kind of <code>go</code> file, it needs to be of package <code>main</code>."}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1494006564, "post_id": 43810294, "comment_id": 74661287, "body": "Yes, they are. secretly-sender-web and secretly-sender-worker they each have a main. I told the procfile to execute those files and that works but I can&#39;t deploy it to Heroku :/ Thank you for your help anyway"}], "answers": [{"tags": [], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "is_accepted": true, "score": 1, "last_activity_date": 1494007980, "creation_date": 1494007980, "answer_id": 43811378, "question_id": 43810294, "link": "https://stackoverflow.com/questions/43810294/deploying-go-app-to-heroku-error/43811378#43811378", "title": "Deploying Go app to heroku error", "body": "<p>The answer was to add this:</p>\n\n<pre><code>\"heroku\": {\n    \"install\": [\n        \"./cmd/...\"\n    ]\n},\n</code></pre>\n\n<p>to vendor/vendor.json\n:D</p>\n"}], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 43811378, "answer_count": 1, "score": 1, "last_activity_date": 1494007980, "creation_date": 1494003672, "last_edit_date": 1494005467, "question_id": 43810294, "link": "https://stackoverflow.com/questions/43810294/deploying-go-app-to-heroku-error", "title": "Deploying Go app to heroku error", "body": "<p>I refactored my code file structure to be under the cmd folder since I now added a worker and now it has this structure:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NMzfn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NMzfn.png\" alt=\"enter image description here\"></a></p>\n\n<p>All the go files are inside the folders so in order to install it locally I use '<em>make install</em>' which I configured to <em>go install</em> each package.\nBut when I try to push to Heroku it just runs <em>go install</em> and so I get the error:</p>\n\n<blockquote>\n  <p>Running: go install -v -tags heroku .  can't load package: package\n  github.com/heroku/secretly-sender: no buildable Go source files in\n  /tmp/tmp.pTW8NahxGm/.go/src/github.com/heroku/secretly-sender</p>\n</blockquote>\n\n<p>How can I fix this?\nHere are my other files</p>\n\n<p>Procfile:</p>\n\n<pre><code>web: secretly-sender-web\nworker: secretly-sender-worker\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM alpine:latest\n\nWORKDIR \"/opt\"\n\nADD .docker_build/secretly-sender /opt/bin/secretly-sender/cmd\nADD ./templates /opt/templates\nADD ./static /opt/static\n\nCMD [\"/opt/bin/secretly-sender/cmd\"]\n</code></pre>\n\n<p>Makefile</p>\n\n<pre><code>GO_BUILD_ENV := GOOS=linux GOARCH=amd64\nDOCKER_BUILD=$(shell pwd)/.docker_build\nDOCKER_CMD=$(DOCKER_BUILD)/secretly-sender/cmd\n\n$(DOCKER_CMD): clean\n    mkdir -p $(DOCKER_BUILD)\n    $(GO_BUILD_ENV) go build -v -o $(DOCKER_CMD) .\n\nclean:\n    rm -rf $(DOCKER_BUILD)\n\nheroku: $(DOCKER_CMD)\n    heroku container:push web\n    heroku container:push worker\n\ninstall:\n    go install github.com/heroku/secretly-sender/cmd/secretly-sender-web\n    go install github.com/heroku/secretly-sender/cmd/secretly-sender-worker\n    go install github.com/heroku/secretly-sender/shared\n\nbuild:\n    go build github.com/heroku/secretly-sender/cmd/secretly-sender-web\n    go build github.com/heroku/secretly-sender/cmd/secretly-sender-worker\n    go build github.com/heroku/secretly-sender/shared\n</code></pre>\n\n<p>I don't really understand what these files and path mean so I still couldn't solve my issue\nThank you very much!</p>\n"}]