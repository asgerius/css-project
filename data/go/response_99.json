[{"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1480545807, "post_id": 40899548, "comment_id": 69012977, "body": "literally <i>nothing</i> comes to mind?"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480545848, "post_id": 40899548, "comment_id": 69012997, "body": "I did loop through range and check for nil."}], "answers": [{"comments": [{"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1480545999, "post_id": 40899586, "comment_id": 69013058, "body": "Ah my issue was missing that 0 while doing make()"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 1, "creation_date": 1480546191, "post_id": 40899586, "comment_id": 69013148, "body": "@James, <code>make([]interface, 0)</code> works exactly the same, this just pre-allocates the cap. In most code I would probably just use <code>var newSlice []interface</code>, and let append allocate as needed since it rarely matters."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1480546372, "post_id": 40899586, "comment_id": 69013215, "body": "also, in-place filter if order doesn&#39;t matter: <a href=\"https://play.golang.org/p/IWBeCs4Cwu\" rel=\"nofollow noreferrer\">play.golang.org/p/IWBeCs4Cwu</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1480546484, "post_id": 40899586, "comment_id": 69013261, "body": "and for thoroughness, in-place filter maintaining order: <a href=\"https://play.golang.org/p/HUmUwYAMRq\" rel=\"nofollow noreferrer\">play.golang.org/p/HUmUwYAMRq</a>"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 5, "last_activity_date": 1480545697, "creation_date": 1480545697, "answer_id": 40899586, "question_id": 40899548, "link": "https://stackoverflow.com/questions/40899548/golang-removing-nil-from-slice-of-interface/40899586#40899586", "title": "Golang removing nil from slice of interface{}", "body": "<pre><code>newSlice := make([]interface{}, 0, len(Slice))\nfor _, item := range Slice {\n    if item != nil {\n        newSlice = append(newSlice, item)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "is_accepted": false, "score": 1, "last_activity_date": 1480552441, "last_edit_date": 1480552441, "creation_date": 1480551885, "answer_id": 40900624, "question_id": 40899548, "link": "https://stackoverflow.com/questions/40899548/golang-removing-nil-from-slice-of-interface/40900624#40900624", "title": "Golang removing nil from slice of interface{}", "body": "<p>You can also use type switches like this example:</p>\n\n<pre><code>slice := []interface{}{1, nil, \"string\", nil}\nnewSlice := make([]interface{}, 0, len(slice))\n\nfor _, val := range(slice){\n    switch val.(type) {\n        case string, int: // add your desired types which will fill newSlice\n            newSlice = append(newSlice, val)\n    }\n}\n\nfmt.Printf(\"newSlice: %v\\tType: %T\\n\", newSlice, newSlice)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>newSlice: [1 string]    Type: []interface {}\n</code></pre>\n\n<p>You can see the full example within <a href=\"https://play.golang.org/p/yNiuA4CmN_\" rel=\"nofollow noreferrer\">The Go Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 364, "user_id": 297468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/776cbe4c8aea34b07ac3598cd9a56521?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/297468/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1598766763, "last_edit_date": 1598766763, "creation_date": 1573663014, "answer_id": 58841621, "question_id": 40899548, "link": "https://stackoverflow.com/questions/40899548/golang-removing-nil-from-slice-of-interface/58841621#58841621", "title": "Golang removing nil from slice of interface{}", "body": "<p>Unless needed for other reasons, this can be done without allocating a new slice:</p>\n<pre><code>    things := []interface{}{\n        nil,\n        1,\n        nil,\n        &quot;2&quot;,\n        nil,\n        3,\n        nil,\n    }\n\n    for i := 0; i &lt; len(things); {\n        if things[i] != nil {\n            i++\n            continue\n        }\n\n        if i &lt; len(things)-1 {\n            copy(things[i:], things[i+1:])\n        }\n\n        things[len(things)-1] = nil\n        things = things[:len(things)-1]\n    }\n\n    fmt.Printf(&quot;%#v&quot;, things)\n</code></pre>\n<p>Output:</p>\n<pre><code>[]interface {}{1, &quot;2&quot;, 3}\n</code></pre>\n<p>You can play with that <a href=\"https://play.golang.org/p/NX1eXZfClzX\" rel=\"nofollow noreferrer\">here</a>, and you can find more information about slice operations <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6311, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1598766763, "creation_date": 1480545441, "question_id": 40899548, "link": "https://stackoverflow.com/questions/40899548/golang-removing-nil-from-slice-of-interface", "title": "Golang removing nil from slice of interface{}", "body": "<p>What is the best way to remove \"nil\" from slice of interface{} and generating a new slice of interface{}?</p>\n\n<pre><code> Slice := []interface{}{1, nil, \"string\", nil}\n</code></pre>\n\n<p>Nothing good comes to my mind ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1480541880, "post_id": 40898613, "comment_id": 69011156, "body": "Your code is not in your GOPATH. It needs to be in a subdirectory of <code>$GOPATH&#47;src&#47;</code>. See <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 1, "user_id": 7233165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ea67168ffe74415600f5485f324f33?s=128&d=identicon&r=PG&f=1", "display_name": "Young Jang", "link": "https://stackoverflow.com/users/7233165/young-jang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480609502, "post_id": 40898613, "comment_id": 69043354, "body": "Thank you JimB, it worked."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7233165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ea67168ffe74415600f5485f324f33?s=128&d=identicon&r=PG&f=1", "display_name": "Young Jang", "link": "https://stackoverflow.com/users/7233165/young-jang"}, "edited": false, "score": 0, "creation_date": 1480609538, "post_id": 40898800, "comment_id": 69043380, "body": "Thank you mpmlj, it is working now. I appreciate your help."}], "tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": false, "score": 1, "last_activity_date": 1480542383, "creation_date": 1480542383, "answer_id": 40898800, "question_id": 40898613, "link": "https://stackoverflow.com/questions/40898613/golang-getting-this-error-upon-go-install/40898800#40898800", "title": "GoLang: getting this error upon go install", "body": "<p>@Young Jang,\nYou need to keep your code in a very specific location, i.e. under the Go's workspace, but also, following a location format to match your repository, \nfor example:\n~/go/src/github.com/young_jang/gobuster</p>\n\n<p>More details: <a href=\"https://www.goinggo.net/2016/05/installing-go-and-your-workspace.html\" rel=\"nofollow noreferrer\">https://www.goinggo.net/2016/05/installing-go-and-your-workspace.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7233165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ea67168ffe74415600f5485f324f33?s=128&d=identicon&r=PG&f=1", "display_name": "Young Jang", "link": "https://stackoverflow.com/users/7233165/young-jang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480542383, "creation_date": 1480541538, "question_id": 40898613, "link": "https://stackoverflow.com/questions/40898613/golang-getting-this-error-upon-go-install", "title": "GoLang: getting this error upon go install", "body": "<p>I am getting this error message when typing 'go install'.</p>\n\n<pre><code>root@kali:~/Scripts/Enum/gobuster# go install\n\ngo install: no install location for directory /root/Scripts/Enum/gobuster outside GOPATH\nFor more details see: go help gopath\n</code></pre>\n\n<p>My 'go env' is as following.</p>\n\n<pre><code>root@kali:~/Scripts/Enum/gobuster# go env\n\nGOARCH=\"386\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"386\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/root\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go\"\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_386\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m32 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Can someone help please?\nThank you.</p>\n"}, {"tags": ["go", "udp"], "answers": [{"comments": [{"owner": {"reputation": 232, "user_id": 79178, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3b12de015ea506efbd7e9660fbce61f3?s=128&d=identicon&r=PG", "display_name": "HankB", "link": "https://stackoverflow.com/users/79178/hankb"}, "edited": false, "score": 0, "creation_date": 1480543349, "post_id": 40897620, "comment_id": 69011864, "body": "These changes work. I&#39;ve marked it accordingly.  Edit: I&#39;m curious what you edited in my original post. I can&#39;t see any change."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 232, "user_id": 79178, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3b12de015ea506efbd7e9660fbce61f3?s=128&d=identicon&r=PG", "display_name": "HankB", "link": "https://stackoverflow.com/users/79178/hankb"}, "edited": false, "score": 0, "creation_date": 1480544932, "post_id": 40897620, "comment_id": 69012556, "body": "@HankB: look at the diff (<a href=\"https://stackoverflow.com/posts/40897417/revisions\">stackoverflow.com/posts/40897417/revisions</a>), I formatted the code so it displayed properly."}, {"owner": {"reputation": 232, "user_id": 79178, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3b12de015ea506efbd7e9660fbce61f3?s=128&d=identicon&r=PG", "display_name": "HankB", "link": "https://stackoverflow.com/users/79178/hankb"}, "edited": false, "score": 0, "creation_date": 1480545363, "post_id": 40897620, "comment_id": 69012762, "body": "I was so focused in the problem I didn&#39;t even notice the crappy formatting. ;)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1516994217, "last_edit_date": 1516994217, "creation_date": 1480537875, "answer_id": 40897620, "question_id": 40897417, "link": "https://stackoverflow.com/questions/40897417/cant-read-udp-reply-golang/40897620#40897620", "title": "Can&#39;t read UDP reply (golang)", "body": "<p>You need to use <code>ListenUDP</code> instead of <code>DialUDP</code>. When you use <code>DialUDP</code>, it creates a \"connected\" UDP port, and only packets originating from the remote address are returned on read.</p>\n\n<pre><code>conn, err = net.ListenUDP(\"udp\", ourAddr)\n</code></pre>\n\n<p>Since the connection doesn't have a default destination, you will also need to use <code>WriteTo*</code> methods to send packets:</p>\n\n<pre><code>sendLen, err := conn.WriteToUDP(discoverMsg, serverAddr)\n</code></pre>\n"}], "owner": {"reputation": 232, "user_id": 79178, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3b12de015ea506efbd7e9660fbce61f3?s=128&d=identicon&r=PG", "display_name": "HankB", "link": "https://stackoverflow.com/users/79178/hankb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1685, "favorite_count": 1, "accepted_answer_id": 40897620, "answer_count": 1, "score": 4, "last_activity_date": 1516994217, "creation_date": 1480537143, "last_edit_date": 1480537358, "question_id": 40897417, "link": "https://stackoverflow.com/questions/40897417/cant-read-udp-reply-golang", "title": "Can&#39;t read UDP reply (golang)", "body": "<p>I'm working on a Go program that sends out a UDP broadcast to query existence of devices on the local network and then reads the replies. Using Wireshark I confirm that the packet is broadcast and that the single device on (my) network replies (ten times, in fact) but my application blocks on the read as if it does not see the incoming packet. Here is the code:</p>\n\n<pre><code>func Discover(timeout int) ([]string, error) {\n    inBuf := make([]byte, 1024)\n    devices := make([]string, 0)\n    var readLen int\n    var fromAddr *net.UDPAddr\n\n    // get server connection\n    server := fmt.Sprintf(\"%s:%d\", bcastIP, udpDiscoverPort) // \"255.255.255.255\", 10000\n    serverAddr, err = net.ResolveUDPAddr(\"udp\", server)\n    checkErr(err)\n    ourAddr, err = net.ResolveUDPAddr(\"udp\", \"192.168.1.132:10000\")\n    checkErr(err)\n    conn, err = net.DialUDP(\"udp\", ourAddr, serverAddr)\n    checkErr(err)\n    defer conn.Close()\n\n    // send the Discover message\n    discoverMsg := []byte(magic)\n    discoverMsg = append(discoverMsg, discovery...)\n    sendLen, err := conn.Write(discoverMsg)\n    checkErr(err)\n    fmt.Println(\"Sent\", sendLen, \"bytes\")\n\n    // read one reply\n    readLen, fromAddr, err = conn.ReadFromUDP(inBuf)\n    fmt.Println(\"Read \", readLen, \"bytesfrom \", fromAddr)\n    txtutil.Dump(string(inBuf[:readLen]))\n    return devices, nil\n}\n</code></pre>\n\n<p>checkErr(err) prints a diagnostic and exits if err is not nil, BTW.</p>\n\n<p>The information in the replies looks like:</p>\n\n<pre><code>Internet Protocol Version 4, Src: 192.168.1.126 (192.168.1.126), Dst: 192.168.1.132 (192.168.1.132)\nUser Datagram Protocol, Src Port: ndmp (10000), Dst Port: ndmp (10000)\n</code></pre>\n\n<p>I have tried \"0.0.0.0:10000\", \":10000\" and \"127.0.0.1:10000\" in place of \"192.168.1.132:10000\" and none seem to make any difference. </p>\n\n<p>Any suggestions as to what I'm doing wrong are welcome!</p>\n"}, {"tags": ["java", "go", "environment-variables", "exec"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1480533630, "post_id": 40896293, "comment_id": 69006784, "body": "You could always try just running <code>make.bash</code> if the tests are not super important to you."}, {"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 0, "creation_date": 1480533669, "post_id": 40896293, "comment_id": 69006820, "body": "For the <code>User.Current()</code> to work, you need to enable cgo, which you disabled with <code>CGO_ENABLED=0</code>. See issue <a href=\"https://github.com/golang/go/issues/6376#issuecomment-66085388\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 0, "creation_date": 1480534028, "post_id": 40896293, "comment_id": 69006996, "body": "@ivan.sim it does not, strictly speaking, &quot;not work&quot;. It just goes to a <a href=\"https://github.com/golang/go/blob/964639cc338db650ccadeafb7424bc8ebb2c0f6c/src/os/user/lookup_stubs.go#L22\" rel=\"nofollow noreferrer\">fallback</a> implementation that trusts some env vars."}, {"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1480534322, "post_id": 40896293, "comment_id": 69007123, "body": "@captncraig Only true if he&#39;s using <a href=\"https://github.com/golang/go/commit/795e712b72802ad49b7c077964046f79c4f6586e\" rel=\"nofollow noreferrer\">go 1.7+</a>"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1480534782, "post_id": 40896293, "comment_id": 69007332, "body": "Good catch. He has the new error message though so I&#39;m guessing he&#39;s on master."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 1914745, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8908d789c305f93d58b776d6bcdb4369?s=128&d=identicon&r=PG", "display_name": "user1914745", "link": "https://stackoverflow.com/users/1914745/user1914745"}, "edited": false, "score": 0, "creation_date": 1480623423, "post_id": 40896480, "comment_id": 69051472, "body": "I tried adding the environment variable &quot;envp[4] = &quot;USER=whatever&quot;;&quot; but got the same error, so I tried &quot;envp[4] = &quot;USER=&lt;myactualusername&gt;&quot;;&quot; and &quot;envp[4] = &quot;HOME=/Users/&lt;myactualusername&gt;&quot;;&quot; (separately), but got the same error every time. Am I doing something wrong here?"}, {"owner": {"reputation": 73, "user_id": 1914745, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8908d789c305f93d58b776d6bcdb4369?s=128&d=identicon&r=PG", "display_name": "user1914745", "link": "https://stackoverflow.com/users/1914745/user1914745"}, "edited": false, "score": 0, "creation_date": 1480623572, "post_id": 40896480, "comment_id": 69051553, "body": "If you want the full Runtime error, it&#39;s at <a href=\"http://pastebin.com/5XnGzysq\" rel=\"nofollow noreferrer\">pastebin.com/5XnGzysq</a>"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 73, "user_id": 1914745, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8908d789c305f93d58b776d6bcdb4369?s=128&d=identicon&r=PG", "display_name": "user1914745", "link": "https://stackoverflow.com/users/1914745/user1914745"}, "edited": false, "score": 0, "creation_date": 1480623652, "post_id": 40896480, "comment_id": 69051594, "body": "@user1914745 looks like you also need to set HOME to some value as well. Sorry."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 0, "last_activity_date": 1480533599, "creation_date": 1480533599, "answer_id": 40896480, "question_id": 40896293, "link": "https://stackoverflow.com/questions/40896293/building-go-from-source-fails-tests-when-run-using-javas-runtime-getruntime-e/40896480#40896480", "title": "Building Go from source fails tests when run using Java&#39;s Runtime.getRuntime().exec()", "body": "<p>Looking at the source code for the <code>os/user</code> package, it looks like the <a href=\"https://github.com/golang/go/blob/964639cc338db650ccadeafb7424bc8ebb2c0f6c/src/os/user/lookup_unix.go#L6\" rel=\"nofollow noreferrer\">native user handling</a> depends on having cgo enabled. If cgo=0 (your case), it will fall back to the <code>USER</code> and <code>HOME</code> environment variables. </p>\n\n<p><a href=\"https://github.com/golang/go/blob/964639cc338db650ccadeafb7424bc8ebb2c0f6c/src/os/user/lookup_stubs.go#L22\" rel=\"nofollow noreferrer\">source code in question</a></p>\n\n<p>Try putting <code>USER=whatever</code> in your exec environment.</p>\n\n<p>I'm afraid I'd need more information to diagnose the runtime issue.</p>\n"}], "owner": {"reputation": 73, "user_id": 1914745, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8908d789c305f93d58b776d6bcdb4369?s=128&d=identicon&r=PG", "display_name": "user1914745", "link": "https://stackoverflow.com/users/1914745/user1914745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 40896480, "answer_count": 1, "score": 0, "last_activity_date": 1480533599, "creation_date": 1480532943, "last_edit_date": 1495542273, "question_id": 40896293, "link": "https://stackoverflow.com/questions/40896293/building-go-from-source-fails-tests-when-run-using-javas-runtime-getruntime-e", "title": "Building Go from source fails tests when run using Java&#39;s Runtime.getRuntime().exec()", "body": "<p>This question is related to a previous question, here: <a href=\"https://stackoverflow.com/questions/40873863/java-runtime-getruntime-exec-appears-to-be-overwriting-path\">Java Runtime.getRuntime().exec() appears to be overwriting $PATH</a></p>\n\n<p>I am trying to build Go from source from inside a Java program. I can build it properly using Terminal, but Java's Runtime.getRuntime().exec() gets interesting results. I tried using ProcessBuilder, but could not get it to properly make Go. Using my current setup with exec(), it makes properly, but then fails two tests. Code snippet:</p>\n\n<pre><code>String[] envp = new String[4];\nenvp[0] = \"CC=/usr/bin/clang\";\nenvp[1] = \"GOROOT_BOOTSTRAP=/usr/local/go\";\nenvp[2] = \"CGO_ENABLED=0\";\nenvp[3] = \"PATH=\" + System.getenv().get(\"PATH\");\nRuntime.getRuntime().exec(\"./all.bash\", envp, \"$HOME/Desktop/go/src\");\n</code></pre>\n\n<p>It runs properly and compiles properly, but when it gets to running the test suite, I get two errors:</p>\n\n<pre><code>--- FAIL: TestCurrent (0.00s)\nuser_test.go:24: Current: user: Current not implemented on darwin/amd64 (got &amp;user.User{Uid:\"502\", Gid:\"20\", Username:\"\", Name:\"\", HomeDir:\"\"})\nFAIL\nFAIL    os/user 0.009s\n</code></pre>\n\n<p>and a much longer one that I won't paste here due to absurd length, but it comes down to:</p>\n\n<pre><code>panic: test timed out after 3m0s\n...\nFAIL    runtime 180.056s\n</code></pre>\n\n<p>I haven't any idea why the former is failing, but for the runtime when I build from the Terminal, it says:</p>\n\n<pre><code>ok      runtime 19.096s\n</code></pre>\n\n<p>So something is causing that to take absurd amounts of time. I did some googling, and heard that it might be fixed if I use ARM=5 as an environment variable, but that didn't change anything. Does anyone have any idea why these tests are failing when I build from Java as opposed to the Terminal?</p>\n"}, {"tags": ["go", "type-conversion", "type-assertion"], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": false, "score": 6, "last_activity_date": 1480536849, "creation_date": 1480536849, "answer_id": 40897333, "question_id": 40895901, "link": "https://stackoverflow.com/questions/40895901/passing-in-a-type-variable-into-function/40897333#40897333", "title": "Passing in a type variable into function", "body": "<p>@hlin117,</p>\n\n<p>Hey, if I understood your question correctly and you need to compare the types, here's what you can do: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc myfunction(v interface{}, mytype interface{}) bool {\n    return reflect.TypeOf(v) == reflect.TypeOf(mytype)\n}\n\nfunc main() {\n\n    assertNoMatch := myfunction(\"hello world\", map[string]string{})\n\n    fmt.Printf(\"%+v\\n\", assertNoMatch)\n\n    assertMatch := myfunction(\"hello world\", \"stringSample\")\n\n    fmt.Printf(\"%+v\\n\", assertMatch)\n\n}\n</code></pre>\n\n<p>The approach is to use a sample of the type you'd like to match.</p>\n"}], "owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13955, "favorite_count": 0, "answer_count": 1, "score": 10, "last_activity_date": 1557210681, "creation_date": 1480531475, "last_edit_date": 1557210681, "question_id": 40895901, "link": "https://stackoverflow.com/questions/40895901/passing-in-a-type-variable-into-function", "title": "Passing in a type variable into function", "body": "<p>I'm trying to achieve a type assertion by passing in a type into a function. In other words, I'm trying to achieve something like this:</p>\n\n<pre><code>// Note that this is pseudocode, because Type isn't the valid thing to use here\nfunc myfunction(mystring string, mytype Type) {\n    ...\n\n    someInterface := translate(mystring)\n    object, ok := someInterface.(mytype)\n\n    ...  // Do other stuff\n}\n\nfunc main() {\n    // What I want the function to be like\n    myfunction(\"hello world\", map[string]string)\n}\n</code></pre>\n\n<p>What's the proper function declaration I need to use in <code>myfunction</code>, to successfully perform the type assertion in <code>myfunction</code>?</p>\n"}, {"tags": ["cookies", "go"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1480526890, "post_id": 40894443, "comment_id": 69002939, "body": "Do you mean to have a cookie that is only valid for 10 seconds?"}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1480527066, "post_id": 40894443, "comment_id": 69003057, "body": "Sorry I also tried putting -1 so that&#39;s always valid till you close the browser or invalidate session."}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1480527156, "post_id": 40894443, "comment_id": 69003111, "body": "ohh setting it to 999 worked. but -1 should have also worked isn&#39;t it?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1480529171, "post_id": 40894443, "comment_id": 69004336, "body": "No, a negative number would indicate that you want to delete the cookie."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1480529413, "post_id": 40894443, "comment_id": 69004470, "body": "For reference, 0 would give you a session cookie."}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 2, "last_activity_date": 1480529818, "last_edit_date": 1592644375, "creation_date": 1480529818, "answer_id": 40895438, "question_id": 40894443, "link": "https://stackoverflow.com/questions/40894443/setting-before-rendering-html-page-go-gin/40895438#40895438", "title": "Setting before rendering html page go-gin", "body": "<p>The issue is with your <code>maxAge</code> input. Your current code instructs the browser to delete your cookie in 10 seconds.</p>\n<p>Gin is wrapping <a href=\"https://golang.org/pkg/net/http/#SetCookie\" rel=\"nofollow noreferrer\"><code>http.SetCookie</code></a> and creating a <a href=\"https://golang.org/pkg/net/http/#Cookie\" rel=\"nofollow noreferrer\"><code>http.Cookie</code></a> for you. To better understand what is happening you should read through those two links.</p>\n<blockquote>\n<p>MaxAge=0 means no 'Max-Age' attribute specified.</p>\n<p>MaxAge&lt;0 means delete cookie now, equivalently 'Max-Age: 0'</p>\n<p>MaxAge&gt;0 means Max-Age attribute present and given in seconds</p>\n</blockquote>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480529818, "creation_date": 1480526466, "question_id": 40894443, "link": "https://stackoverflow.com/questions/40894443/setting-before-rendering-html-page-go-gin", "title": "Setting before rendering html page go-gin", "body": "<p>I am trying to set a cookie on an HTML page </p>\n\n<pre><code> func testCookie(c *gin.Context) {\n    c.SetCookie(\"test1\", \"testvalue\", 10, \"/\", \"\", true, true)\n    c.HTML(200, \"dashboard\", gin.H{\n        \"title\":    \"Dashboard\",\n        }\n    }\n</code></pre>\n\n<p>This should have set the cookie on the HTML page but it doesn't.\nMy server is running to serve https requests. I am not sure why I am not able to set cookies here. I am using google-chrome and ideally I should have been able to see the cookie there.</p>\n"}, {"tags": ["python", "go", "zlib"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480527517, "post_id": 40893411, "comment_id": 69003334, "body": "zlib uses a DEFLATE implementation, but flate and zlib aren&#39;t the same. Here you&#39;re closing the flate stream in go, while in python you&#39;re only flushing. If you change the Go code to <code>Flush()</code> the output will be the same. Also note that different implementations aren&#39;t guaranteed to produce the same binary output, they only are guaranteed to produce compatible output."}, {"owner": {"reputation": 192, "user_id": 1650345, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21e2ede2aeeeb53b7291e06e91cda29f?s=128&d=identicon&r=PG", "display_name": "everial", "link": "https://stackoverflow.com/users/1650345/everial"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480529753, "post_id": 40893411, "comment_id": 69004652, "body": "@jimb: <a href=\"https://golang.org/pkg/compress/flate/\" rel=\"nofollow noreferrer\">golang.org/pkg/compress/flate</a> says &quot;Package flate implements the DEFLATE compressed data format, described in RFC 1951...&quot; which seems to contradict the first sentence or I&#39;m misunderstanding you (or the docs =)). Similarly, <a href=\"https://golang.org/pkg/compress/flate/#Writer.Close\" rel=\"nofollow noreferrer\">golang.org/pkg/compress/flate/#Writer.Close</a> claims to flush the writer and adding an explicit <code>w.Flush()</code> after the <code>w.Write(...)</code> line adds more padding/checksum bytes. Would you mind providing a little more detail as there&#39;s something I&#39;m clearly not following?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1480530711, "post_id": 40893411, "comment_id": 69005159, "body": "This output matches the python output: <a href=\"https://play.golang.org/p/_SCAspI3Mq\" rel=\"nofollow noreferrer\">play.golang.org/p/_SCAspI3Mq</a>. I don&#39;t understand what you find contradicting; you&#39;re using zlib in python which <i>uses</i> DEFLATE internally to produce a zlib format output, whereas your Go example is using a DEFLATE implementation directly. I don&#39;t know if you can get the python zlib library to output the raw, complete DEFLATE stream, but trying to get different libraries to output byte-for-byte matches of compressed data doesn&#39;t seem useful or maintainable."}, {"owner": {"reputation": 192, "user_id": 1650345, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21e2ede2aeeeb53b7291e06e91cda29f?s=128&d=identicon&r=PG", "display_name": "everial", "link": "https://stackoverflow.com/users/1650345/everial"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480532528, "post_id": 40893411, "comment_id": 69006180, "body": "&gt; This output matches the python output: play.golang.org/p/_SCAspI3Mq  ah, thanks for clarifying (I&#39;d misread &quot;change&quot; as &quot;add&quot;).   &gt; I don&#39;t know if you can get the python zlib library to output the raw, complete DEFLATE stream, but trying to get different libraries to output byte-for-byte matches of compressed data doesn&#39;t seem useful or maintainable. Fair enough,"}, {"owner": {"reputation": 192, "user_id": 1650345, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21e2ede2aeeeb53b7291e06e91cda29f?s=128&d=identicon&r=PG", "display_name": "everial", "link": "https://stackoverflow.com/users/1650345/everial"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480532914, "post_id": 40893411, "comment_id": 69006372, "body": "(continued - ran into edit time limits when trying to reformat) I&#39;m having trouble with the round trip and was trying to produce a simpler example by isolating the compression bit. Thanks for the suggestions and help--if you feel like turning your comments into an answer I&#39;m happy to accept it."}], "answers": [{"comments": [{"owner": {"reputation": 192, "user_id": 1650345, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21e2ede2aeeeb53b7291e06e91cda29f?s=128&d=identicon&r=PG", "display_name": "everial", "link": "https://stackoverflow.com/users/1650345/everial"}, "edited": false, "score": 0, "creation_date": 1484338370, "post_id": 40897460, "comment_id": 70485269, "body": "Whoops, sorry it took so long for me to accept answer, missed notification. Thanks for writing it up nicely. =)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1480537312, "creation_date": 1480537312, "answer_id": 40897460, "question_id": 40893411, "link": "https://stackoverflow.com/questions/40893411/golang-python-zlib-difference/40897460#40897460", "title": "golang/python zlib difference", "body": "<p>The output from the python example isn't a \"complete\" stream, its just flushing the buffer after compressing the first string. You can get the same output from the Go code by replacing <code>Close()</code> with <code>Flush()</code>:</p>\n\n<p><a href=\"https://play.golang.org/p/BMcjTln-ej\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BMcjTln-ej</a></p>\n\n<pre><code>func compress(source string) []byte {\n    buf := new(bytes.Buffer)\n    w, _ := flate.NewWriter(buf, 7)\n    w.Write([]byte(source))\n    w.Flush()\n\n    return buf.Bytes()\n}\n</code></pre>\n\n<p>However, you are comparing output from zlib in python, which uses DEFLATE internally to produce a zlib format output, and <code>flate</code> in Go, which <em>is</em> a DEFLATE implementation. I don't know if you can get the python zlib library to output the raw, complete DEFLATE stream, but trying to get different libraries to output byte-for-byte matches of compressed data doesn't seem useful or maintainable. The output of the compression libraries is only guaranteed to be compatible, not identical. </p>\n"}], "owner": {"reputation": 192, "user_id": 1650345, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21e2ede2aeeeb53b7291e06e91cda29f?s=128&d=identicon&r=PG", "display_name": "everial", "link": "https://stackoverflow.com/users/1650345/everial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1318, "favorite_count": 2, "accepted_answer_id": 40897460, "answer_count": 1, "score": 7, "last_activity_date": 1480537312, "creation_date": 1480523380, "question_id": 40893411, "link": "https://stackoverflow.com/questions/40893411/golang-python-zlib-difference", "title": "golang/python zlib difference", "body": "<p>Debugging differences between Python's zlib and golang's zlib. Why don't the following have the same results?</p>\n\n<p><code>compress.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"compress/flate\"\n    \"bytes\"\n    \"fmt\"\n)\n\n\nfunc compress(source string) []byte {\n    w, _ := flate.NewWriter(nil, 7)\n    buf := new(bytes.Buffer)\n\n    w.Reset(buf)\n    w.Write([]byte(source))\n    w.Close()\n\n    return buf.Bytes()\n}\n\n\nfunc main() {\n    example := \"foo\"\n    compressed := compress(example)\n    fmt.Println(compressed)\n}\n</code></pre>\n\n<p><code>compress.py</code>:</p>\n\n<pre><code>from __future__ import print_function\n\nimport zlib\n\n\ndef compress(source):\n    # golang zlib strips header + checksum\n    compressor = zlib.compressobj(7, zlib.DEFLATED, -15)\n    compressor.compress(source)\n    # python zlib defaults to Z_FLUSH, but \n    # https://golang.org/pkg/compress/flate/#Writer.Flush\n    # says \"Flush is equivalent to Z_SYNC_FLUSH\"\n    return compressor.flush(zlib.Z_SYNC_FLUSH)\n\n\ndef main():\n    example = u\"foo\"\n    compressed = compress(example)\n    print(list(bytearray(compressed)))\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>\n\n<p>Results</p>\n\n<pre><code>$ go version\ngo version go1.7.3 darwin/amd64\n$ go build compress.go\n$ ./compress\n[74 203 207 7 4 0 0 255 255]\n$ python --version\n$ python 2.7.12\n$ python compress.py\n[74, 203, 207, 7, 0, 0, 0, 255, 255]\n</code></pre>\n\n<p>The Python version has <code>0</code> for the fifth byte, but the golang version has <code>4</code> -- what's causing the different output?</p>\n"}, {"tags": ["go", "golint"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 715002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a819e2c7dc3ef7d4467d6daa7bfb80b?s=128&d=identicon&r=PG", "display_name": "endorama", "link": "https://stackoverflow.com/users/715002/endorama"}, "edited": false, "score": 1, "creation_date": 1565111110, "post_id": 40891417, "comment_id": 101246219, "body": "What if I&#39;m passing the context to a different module (where the unexported <code>key</code> is not available)?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 349, "user_id": 715002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a819e2c7dc3ef7d4467d6daa7bfb80b?s=128&d=identicon&r=PG", "display_name": "endorama", "link": "https://stackoverflow.com/users/715002/endorama"}, "edited": false, "score": 1, "creation_date": 1565111754, "post_id": 40891417, "comment_id": 101246485, "body": "@endorama You must provide exported getters and maybe setters. <code>PrincipalIDFromCtx(context.Context) (int64)</code> and <code>CtxWithPrincipalID(context.Context, int64) (context.Context)</code>."}, {"owner": {"reputation": 349, "user_id": 715002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a819e2c7dc3ef7d4467d6daa7bfb80b?s=128&d=identicon&r=PG", "display_name": "endorama", "link": "https://stackoverflow.com/users/715002/endorama"}, "edited": false, "score": 0, "creation_date": 1565205508, "post_id": 40891417, "comment_id": 101283596, "body": "Should these methods go in pkg1, pkg2 or both? I see possible cycle dependencies if only in pkg1 or pkg2.  Having such method in both makes sense, but that produces duplicated code."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 82, "last_activity_date": 1480520989, "last_edit_date": 1480520989, "creation_date": 1480517617, "answer_id": 40891417, "question_id": 40891345, "link": "https://stackoverflow.com/questions/40891345/fix-should-not-use-basic-type-string-as-key-in-context-withvalue-golint/40891417#40891417", "title": "Fix &quot;should not use basic type string as key in context.WithValue&quot; golint", "body": "<p>Just use a key type:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type key int\n\nconst (\n    keyPrincipalID key = iota\n    // ...\n)\n</code></pre>\n\n<p>Since you've defined a separate type, it will never collide. Even if you have two packages, <code>pkg1.key(0) != pkg2.key(0)</code>.</p>\n\n<p>See also: <a href=\"https://blog.golang.org/context#TOC_3.2.\" rel=\"noreferrer\">Go Blog about key collisions in context</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 327, "user_id": 7642689, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-idGeLpbFres/AAAAAAAAAAI/AAAAAAAAEqo/kp6kgSdgA64/photo.jpg?sz=128", "display_name": "Saurabh Nayar", "link": "https://stackoverflow.com/users/7642689/saurabh-nayar"}, "edited": false, "score": 0, "creation_date": 1560978089, "post_id": 54913728, "comment_id": 99918793, "body": "I am not sure I get the comment - string should work as a parameter to function that takes input as interface{}"}, {"owner": {"reputation": 379, "user_id": 6097285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caed10d0c712a106142e2bb79a8cd665?s=128&d=identicon&r=PG&f=1", "display_name": "yogesh_desai", "link": "https://stackoverflow.com/users/6097285/yogesh-desai"}, "reply_to_user": {"reputation": 327, "user_id": 7642689, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-idGeLpbFres/AAAAAAAAAAI/AAAAAAAAEqo/kp6kgSdgA64/photo.jpg?sz=128", "display_name": "Saurabh Nayar", "link": "https://stackoverflow.com/users/7642689/saurabh-nayar"}, "edited": false, "score": 0, "creation_date": 1561453246, "post_id": 54913728, "comment_id": 100058524, "body": "@SaurabhNayar That is no Golang idiomatic way. You would get GoLinter warnings."}], "tags": [], "owner": {"reputation": 379, "user_id": 6097285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caed10d0c712a106142e2bb79a8cd665?s=128&d=identicon&r=PG&f=1", "display_name": "yogesh_desai", "link": "https://stackoverflow.com/users/6097285/yogesh-desai"}, "is_accepted": false, "score": -10, "last_activity_date": 1551298336, "creation_date": 1551298336, "answer_id": 54913728, "question_id": 40891345, "link": "https://stackoverflow.com/questions/40891345/fix-should-not-use-basic-type-string-as-key-in-context-withvalue-golint/54913728#54913728", "title": "Fix &quot;should not use basic type string as key in context.WithValue&quot; golint", "body": "<p>Sharing a brief answer for the above question.\n<a href=\"https://github.com/mgechev/revive/blob/master/fixtures/golint/context-keys-type.go\" rel=\"nofollow noreferrer\">GitHub Link</a>\nIn short, <code>context.WithValue()</code> needs <code>interface{}</code> type as <strong>keys</strong> and <strong>values</strong>.</p>\n\n<p>I hope this helps.\nThank you.</p>\n"}, {"tags": [], "owner": {"reputation": 1201, "user_id": 5097493, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/95b290a191545edb4077adfaab317f1a?s=128&d=identicon&r=PG&f=1", "display_name": "RuNpiXelruN", "link": "https://stackoverflow.com/users/5097493/runpixelrun"}, "is_accepted": false, "score": 1, "last_activity_date": 1592374699, "creation_date": 1592374699, "answer_id": 62422581, "question_id": 40891345, "link": "https://stackoverflow.com/questions/40891345/fix-should-not-use-basic-type-string-as-key-in-context-withvalue-golint/62422581#62422581", "title": "Fix &quot;should not use basic type string as key in context.WithValue&quot; golint", "body": "<p>I achieve the above by doing the following and feel it's pretty clean</p>\n\n<pre><code>package util\n\nimport \"context\"\n\ntype contextKey string\n\nfunc (c contextKey) String() string {\n    return string(c)\n}\n\nvar (\n    // ContextKeyDeleteCaller var\n    ContextKeyDeleteCaller = contextKey(\"deleteCaller\")\n    // ContextKeyJobID var\n    ContextKeyJobID contextKey\n)\n\n// GetCallerFromContext gets the caller value from the context.\nfunc GetCallerFromContext(ctx context.Context) (string, bool) {\n    caller, ok := ctx.Value(ContextKeyDeleteCaller).(string)\n    return caller, ok\n}\n\n// GetJobIDFromContext gets the jobID value from the context.\nfunc GetJobIDFromContext(ctx context.Context) (string, bool) {\n    jobID, ok := ctx.Value(ContextKeyJobID).(string)\n    return jobID, ok\n}\n</code></pre>\n\n<p>..and then set on context by,</p>\n\n<pre><code>ctx := context.WithValue(context.Background(), util.ContextKeyDeleteCaller, \"Kafka Listener\")\n</code></pre>\n\n<p>..get value from context by,</p>\n\n<pre><code>caller, ok := util.GetCallerFromContext(ctx)\nif !ok {\n    dc.log.Warn(\"could not get caller from context\")\n}\nfmt.Println(\"value is:\", caller) // will be 'Kafka Listener'\n</code></pre>\n\n<p>and can print out value of key by doing,</p>\n\n<pre><code>fmt.Println(\"Key is:\", ContextKeyDeleteCaller.String())\n</code></pre>\n"}], "owner": {"reputation": 2437, "user_id": 4102515, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31b3a2bfa392f631bc24a7c1dce899b9?s=128&d=identicon&r=PG", "display_name": "snorberhuis", "link": "https://stackoverflow.com/users/4102515/snorberhuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18901, "favorite_count": 5, "accepted_answer_id": 40891417, "answer_count": 3, "score": 60, "last_activity_date": 1592374699, "creation_date": 1480517422, "question_id": 40891345, "link": "https://stackoverflow.com/questions/40891345/fix-should-not-use-basic-type-string-as-key-in-context-withvalue-golint", "title": "Fix &quot;should not use basic type string as key in context.WithValue&quot; golint", "body": "<p>I am passing an uuid in using the <code>Context</code> and <code>WithValue</code> to subsequent functions that handle this <code>*http.request</code>. This uuid is was passed in the authorization header to a REST call to identify a person. The authorization token is verified and needs to accessible to check if the call is itself is authorized.</p>\n\n<p>I used:</p>\n\n<pre><code>ctx := context.WithValue(r.Context(), string(\"principal_id\"), *id)\n</code></pre>\n\n<p>But golint complains: </p>\n\n<pre><code>should not use basic type string as key in context.WithValue\n</code></pre>\n\n<p>What is the best option that could be used to retrieve this key that is not a basic type like a simple string? </p>\n"}, {"tags": ["go", "floating-point", "byte"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1480516129, "post_id": 40890557, "comment_id": 68995460, "body": "My guess is that you generate the wrong bytes from Java, or the Java output bytes for your number and the bytes you use in the Go code do not match. Please post how you produce the bytes you want to &quot;decode&quot;."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1480516286, "post_id": 40890557, "comment_id": 68995569, "body": "Please post how you&#39;re encoding the java value. That string of bytes simply cannot represent <code>3177408.5</code> as an IEEE754 double in memory."}, {"owner": {"reputation": 117, "user_id": 2044216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f3bbbcae3035052c1fe0b16c088f34?s=128&d=identicon&r=PG&f=1", "display_name": "vulkoingim", "link": "https://stackoverflow.com/users/2044216/vulkoingim"}, "edited": false, "score": 0, "creation_date": 1480518103, "post_id": 40890557, "comment_id": 68996893, "body": "I&#39;ve edited the post with the method"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1480518970, "post_id": 40890557, "comment_id": 68997570, "body": "You managed to store 3445713.95 in a Java long? Congratulations! Please show actual code, actual input, actual output, expected output and explain why you think the expected output is correct."}, {"owner": {"reputation": 117, "user_id": 2044216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f3bbbcae3035052c1fe0b16c088f34?s=128&d=identicon&r=PG&f=1", "display_name": "vulkoingim", "link": "https://stackoverflow.com/users/2044216/vulkoingim"}, "edited": false, "score": 0, "creation_date": 1480520741, "post_id": 40890557, "comment_id": 68998830, "body": "Haha, my bad... Actually the problem lies somewhere else. Thanks for the replies"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1480516741, "creation_date": 1480516741, "answer_id": 40891122, "question_id": 40890557, "link": "https://stackoverflow.com/questions/40890557/converting-a-byte-array-java-double-encoded-to-float64/40891122#40891122", "title": "Converting a []byte array (java double encoded) to Float64", "body": "<p>The closest I can get is if I use <a href=\"https://golang.org/pkg/encoding/binary/#ByteOrder\" rel=\"nofollow noreferrer\"><code>binary.BigEndian.Uint64</code></a>:</p>\n\n<pre><code>b := []byte(\"AJ\\x02\\xef\\xe1\\xaf(l\")\nu := binary.BigEndian.Uint64(b)\nf := math.Float64frombits(u)\nfmt.Printf(\"%f\", f)\n</code></pre>\n\n<p>This gives me <code>3409375.763158</code>. Make sure you're encoding your float correctly on the Java side.</p>\n\n<p>Playground: <a href=\"https://play.golang.org/p/4KGZoWjLTF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/4KGZoWjLTF</a>.</p>\n"}], "owner": {"reputation": 117, "user_id": 2044216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f3bbbcae3035052c1fe0b16c088f34?s=128&d=identicon&r=PG&f=1", "display_name": "vulkoingim", "link": "https://stackoverflow.com/users/2044216/vulkoingim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 40891122, "answer_count": 1, "score": -1, "last_activity_date": 1480520635, "creation_date": 1480515141, "last_edit_date": 1480520635, "question_id": 40890557, "link": "https://stackoverflow.com/questions/40890557/converting-a-byte-array-java-double-encoded-to-float64", "title": "Converting a []byte array (java double encoded) to Float64", "body": "<p>So, I'm trying to decode a byte array to Float64. I've tried a bunch of different ways, found all over StackOverflow, but no luck so far! <a href=\"https://play.golang.org/p/7GnRyUy2r0\" rel=\"nofollow noreferrer\">Here's the go playground link to what I have tried</a>.\n The expected value should be <code>3177408.5</code>. The original value is a Java double, encoded as IEEE 754 floating-point</p>\n\n<p>Edit:</p>\n\n<p>The value is encoded using the <code>org.apache.hadoop.hbase.util.Bytes.toBytes</code> method. </p>\n\n<pre><code>double v = 3445713.95;\nlong ff;\n\nff = Double.doubleToRawLongBits(v);\n\nbArr = toBytes(ff)\n\npublic static byte[] toBytes(long val) {\n    byte[] b = new byte[8];\n\n    for(int i = 7; i &gt; 0; --i) {\n        b[i] = (byte)((int)val);\n        val &gt;&gt;&gt;= 8;\n    }\n\n    b[0] = (byte)((int)val);\n    return b;\n}\n</code></pre>\n\n<p>And actually should be: <code>3445713.95</code></p>\n\n<p>Edit2: </p>\n\n<p>My bad for actually just pasting code I was given, without thinking much first, Java is not exactly my cup of tea. Turns out there is a problem somewhere along the pipeline (multiple systems communicating), and value is getting corrupted. I'll mark @Ainar-G's solution as correct, since it actually gives back something close to the expected.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1480508799, "post_id": 40888248, "comment_id": 68990354, "body": "This seems very unnecessary. Simply passing <code>target</code> to <code>json.Unmarshal</code> should work fine for you."}, {"owner": {"reputation": 399, "user_id": 2405142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsRtS.jpg?s=128&g=1", "display_name": "Alexander Borisov", "link": "https://stackoverflow.com/users/2405142/alexander-borisov"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1480508939, "post_id": 40888248, "comment_id": 68990441, "body": "@TimCooper, if we pass <code>target</code> with type <code>interface{}</code> to <code>json.Unmarshal</code> we will obtain <code>map[string]interface{}</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1480509367, "post_id": 40888248, "comment_id": 68990698, "body": "Show us how you call this <code>decode()</code> function. Most likely you pass a wrong value."}, {"owner": {"reputation": 399, "user_id": 2405142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsRtS.jpg?s=128&g=1", "display_name": "Alexander Borisov", "link": "https://stackoverflow.com/users/2405142/alexander-borisov"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480509897, "post_id": 40888248, "comment_id": 68991018, "body": "@icza added usage example to question."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1480510110, "post_id": 40888248, "comment_id": 68991188, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/a/35449654/1705598\">Passing values to interface{}</a>; and <a href=\"http://stackoverflow.com/questions/38829941/golang-interface-type-misunderstanding/38830638#38830638\">Golang interface{} type misunderstanding</a>."}, {"owner": {"reputation": 399, "user_id": 2405142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsRtS.jpg?s=128&g=1", "display_name": "Alexander Borisov", "link": "https://stackoverflow.com/users/2405142/alexander-borisov"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480510710, "post_id": 40888248, "comment_id": 68991568, "body": "@icza this question is very similar to my use case but I understand why I obtain <code>map</code> instead of <code>struct</code>. So my question is about casting not unmarshaling."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1480510779, "post_id": 40888248, "comment_id": 68991621, "body": "@AlexBor If you read my other answers: you don&#39;t need to convert it to anything. Where you go wrong is calling your <code>decode()</code> function: you must pass a pointer to a struct to it. Inside <code>decode()</code>, you just have to pass the <code>interface{}</code> value to <code>json.Unmarshal()</code>."}, {"owner": {"reputation": 399, "user_id": 2405142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsRtS.jpg?s=128&g=1", "display_name": "Alexander Borisov", "link": "https://stackoverflow.com/users/2405142/alexander-borisov"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480511225, "post_id": 40888248, "comment_id": 68991907, "body": "@icza I can&#39;t pass pointer to <code>methodsMap[Method(base.Method)]</code> struct because it contains draft struct for this request. I&#39;m searching for solution to create a copy for this struct. Then I will be able to send its pointer to <code>decode()</code>. After all I will update my question. If you know better way for duplicating structure (creating new instance with the same type) - I will be very grateful for the advice."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1480511361, "post_id": 40888248, "comment_id": 68991994, "body": "@AlexBor To copy a value wrapped in an interface: <a href=\"http://stackoverflow.com/questions/37851500/how-to-copy-an-interface-value-in-go/37851764#37851764\">How to copy an interface value in Go?</a>"}, {"owner": {"reputation": 399, "user_id": 2405142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsRtS.jpg?s=128&g=1", "display_name": "Alexander Borisov", "link": "https://stackoverflow.com/users/2405142/alexander-borisov"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480511674, "post_id": 40888248, "comment_id": 68992198, "body": "@icza in your answer you use casting to specified type <code>reflect.New(...).Interface().(User)</code>. In my question I ask how I can specify type without hardcoding it?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1480511794, "post_id": 40888248, "comment_id": 68992297, "body": "@AlexBor Just leave out the final type assertion. I used that there because I worked with it afterwards. Just use <code>reflect.New(...).Interface()</code>."}, {"owner": {"reputation": 399, "user_id": 2405142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsRtS.jpg?s=128&g=1", "display_name": "Alexander Borisov", "link": "https://stackoverflow.com/users/2405142/alexander-borisov"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480513757, "post_id": 40888248, "comment_id": 68993687, "body": "@icza Thank you! It works."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1480513763, "creation_date": 1480513763, "answer_id": 40890100, "question_id": 40888248, "link": "https://stackoverflow.com/questions/40888248/casting-interface-to-calculated-in-runtime-type/40890100#40890100", "title": "Casting interface{} to calculated in runtime Type", "body": "<p>Use the following code to create a copy of the draft struct and unmarshal to it:</p>\n\n<pre><code>t := reflect.TypeOf(methodsMap[Method(base.Method)])\npv := reflect.New(t)\nerr := json.Unmarshal(p, pv.Interface())\nreturn pv.Elem().Interface(), err  // pv.Elem() dereferences ptr \n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/H8capqmxp5\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 399, "user_id": 2405142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsRtS.jpg?s=128&g=1", "display_name": "Alexander Borisov", "link": "https://stackoverflow.com/users/2405142/alexander-borisov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1601, "favorite_count": 0, "accepted_answer_id": 40890100, "answer_count": 1, "score": 1, "last_activity_date": 1480513763, "creation_date": 1480508467, "last_edit_date": 1495542630, "question_id": 40888248, "link": "https://stackoverflow.com/questions/40888248/casting-interface-to-calculated-in-runtime-type", "title": "Casting interface{} to calculated in runtime Type", "body": "<p>Here is schematic example what I need:</p>\n\n<pre><code>func decode(data []byte, target interface{}) (interface{}, error) {\n    decoded := target.(reflect.TypeOf(target)) // pseudocode\n    err := json.Unmarshal(data, &amp;decoded)\n    ...\n</code></pre>\n\n<p>I found several similar questions on SO, but all solutions are about switch by <code>target.(type)</code>. This is not the best solution what I look for.</p>\n\n<p>Also I found solution with reflection:</p>\n\n<pre><code>decoded := reflect.ValueOf(target).Convert(reflect.TypeOf(target))\n// fmt.Printf(\"%T\", decoded) == reflect.Value\n</code></pre>\n\n<p>But I couldn't understand how to get struct from <code>reflect.Value</code> to pass it to <code>json.Unmarshal</code> function.</p>\n\n<p><strong>How this <code>decode</code> function will be used?</strong></p>\n\n<p>I have multiple requests in different structures. I can determine what struct I should use to decode request. I have mapping between request type and structure like this <code>map[RequestMethod]interface{}</code>.</p>\n\n<p>Schematic version looks like this:</p>\n\n<pre><code>func hydrate(data []byte) (interface{}, error) {\n    var base baseResponse\n\n    if err := json.Unmarshal(data, &amp;base); err != nil {\n        return nil, err\n    }\n\n    target, ok := methodsMap[Method(base.Method)]\n\n    if !ok {\n        return nil, errors.New(\"Trying to hydrate data with unknown method: \" + base.Method)\n    }\n\n    decoded, err := decode(data, target) // Expected target type.\n</code></pre>\n\n<p>Added:</p>\n\n<p>If we pass our <code>target</code> to <code>json.Unmarshal</code> without casting to it type we will obtain <code>map</code>. Example:</p>\n\n<pre><code>func decode(data []byte, target interface{}) (interface{}, error) {\n    err := json.Unmarshal(data, &amp;target)\n    // fmt.Printf(\"%T\", target) == map[string]interface{} not struct.\n</code></pre>\n\n<p><strong>Solution</strong></p>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/users/1705598/icza\">@icza</a> we found solution:</p>\n\n<p>func hydrate(data []byte) (interface{}, error) {\n        var base baseResponse</p>\n\n<pre><code>    if err := json.Unmarshal(data, &amp;base); err != nil {\n        return nil, err\n    }\n\n    target, ok := methodsMap[Method(base.Method)]\n\n    if !ok {\n        return nil, errors.New(\"Trying to hydrate data with unknown method: \" + base.Method)\n    }\n\n    // Clone request draft struct.\n    decoded := reflect.New(reflect.ValueOf(target).Type()).Interface()\n    err := decode(data, decoded)\n    ...\n</code></pre>\n\n<p>Related links:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/38829941/golang-interface-type-misunderstanding/38830638#38830638\">Golang interface{} type misunderstanding</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/37851500/how-to-copy-an-interface-value-in-go/37851764#37851764\">How to copy an interface value in Go?</a></p>\n"}, {"tags": ["cookies", "go", "go-gin"], "comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 1, "creation_date": 1480507931, "post_id": 40887538, "comment_id": 68989780, "body": "Cookies are set in the response, and you&#39;re looking at the cookies present in the request."}, {"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 0, "creation_date": 1480591361, "post_id": 40887538, "comment_id": 69030966, "body": "Please don&#39;t edit your question completely once you have received answers on it."}], "answers": [{"comments": [{"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1480525933, "post_id": 40888101, "comment_id": 69002376, "body": "<code>c.SetCookie(&quot;test1&quot;, &quot;testvalue&quot;, 10, &quot;&#47;&quot;, &quot;&quot;, true, true) \tc.HTML(200, &quot;dashboard&quot;, gin.H{ \t\t&quot;title&quot;:    &quot;Dashboard&quot;, }</code> This should have ideally set the cookie on the HTML page but its not working"}, {"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "reply_to_user": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1480566921, "post_id": 40888101, "comment_id": 69018722, "body": "@love2code What do you mean by it should set in HTML page? A cookie is part of the headers. Considering you&#39;re passing HttpOnly as True you won&#39;t be able to access the cookie using Javascript either."}, {"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "reply_to_user": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1480585696, "post_id": 40888101, "comment_id": 69027009, "body": "@love2code Read more about HttpOnly cookie here: <a href=\"https://www.owasp.org/index.php/HttpOnly\" rel=\"nofollow noreferrer\">owasp.org/index.php/HttpOnly</a>"}], "tags": [], "owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "is_accepted": false, "score": 0, "last_activity_date": 1480585856, "last_edit_date": 1480585856, "creation_date": 1480508034, "answer_id": 40888101, "question_id": 40887538, "link": "https://stackoverflow.com/questions/40887538/go-gin-unable-to-set-cookies/40888101#40888101", "title": "go-gin unable to set cookies", "body": "<p><a href=\"https://golang.org/pkg/net/http/#SetCookie\" rel=\"nofollow noreferrer\"><code>SetCookie()</code></a> sets the cookie on the <code>ResponseWriter</code>'s headers hence you can read its value in subsequent requests where it can be read using <a href=\"https://godoc.org/net/http#Request\" rel=\"nofollow noreferrer\"><code>Request</code></a> object's <code>Cookie()</code> method.</p>\n\n<p>Here's the <a href=\"https://github.com/gin-gonic/gin/blob/master/context.go#L360\" rel=\"nofollow noreferrer\">related code</a> of the same to give you an idea:</p>\n\n<pre><code>func (c *Context) SetCookie(\n    name string,\n    value string,\n    maxAge int,\n    path string,\n    domain string,\n    secure bool,\n    httpOnly bool,\n) {\n    if path == \"\" {\n        path = \"/\"\n    }\n    http.SetCookie(c.Writer, &amp;http.Cookie{\n        Name:     name,\n        Value:    url.QueryEscape(value),\n        MaxAge:   maxAge,\n        Path:     path,\n        Domain:   domain,\n        Secure:   secure,\n        HttpOnly: httpOnly,\n    })\n}\n\nfunc (c *Context) Cookie(name string) (string, error) {\n    cookie, err := c.Request.Cookie(name)\n    if err != nil {\n        return \"\", err\n    }\n    val, _ := url.QueryUnescape(cookie.Value)\n    return val, nil\n}\n</code></pre>\n\n<hr>\n\n<h1><strong>Update</strong></h1>\n\n<p>You won't be able to access cookies in your page because you're passing <a href=\"https://www.owasp.org/index.php/HttpOnly\" rel=\"nofollow noreferrer\"><code>HttpOnly</code> as <code>true</code></a>. When this is set to true only the server has access to the cookies and you can't fetch their values in front-end using Javascript.</p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 6285363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398a2405e7f5f1551f418be7b2376497?s=128&d=identicon&r=PG&f=1", "display_name": "Mendo", "link": "https://stackoverflow.com/users/6285363/mendo"}, "is_accepted": false, "score": 2, "last_activity_date": 1554722583, "creation_date": 1554722583, "answer_id": 55572314, "question_id": 40887538, "link": "https://stackoverflow.com/questions/40887538/go-gin-unable-to-set-cookies/55572314#55572314", "title": "go-gin unable to set cookies", "body": "<p>Adding to comments above \nTry using</p>\n\n<pre><code>c.SetCookie(\"cookieName\", \"name\", 10, \"/\", \"yourDomain\", true, true)\n</code></pre>\n\n<p>example</p>\n\n<pre><code>c.SetCookie(\"gin_cookie\", \"someName\", 60*60*24, \"/\", \"google.com\", true, true)\n</code></pre>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7917, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1554722583, "creation_date": 1480506243, "last_edit_date": 1480587217, "question_id": 40887538, "link": "https://stackoverflow.com/questions/40887538/go-gin-unable-to-set-cookies", "title": "go-gin unable to set cookies", "body": "<p>I am trying to set a cookie on an HTML page </p>\n\n<pre><code> func testCookie(c *gin.Context) {\n    c.SetCookie(\"test1\", \"testvalue\", 10, \"/\", \"\", true, true)\n    c.HTML(200, \"dashboard\", gin.H{\n        \"title\":    \"Dashboard\",\n        }\n    }\n</code></pre>\n\n<p>This should have set the cookie on the HTML page but it doesn't.\nMy server is running to serve https requests. I am not sure why I am not able to set cookies here.</p>\n"}, {"tags": ["javascript", "angularjs", "go"], "comments": [{"owner": {"reputation": 261, "user_id": 7206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11fbca58483b4cf513eea7edcdbda97?s=128&d=identicon&r=PG&f=1", "display_name": "rule", "link": "https://stackoverflow.com/users/7206171/rule"}, "edited": false, "score": 0, "creation_date": 1480505116, "post_id": 40886911, "comment_id": 68988091, "body": "i am not sure about this , but when the status is 200 and you are setting the credentials you might not have access to your $scope, so they are ending up undefined, try to return the username from the backend, and access to it from response.username or response.token, or whatever you need there."}, {"owner": {"reputation": 19, "user_id": 7107374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13e41bd8d528111a5f1ec2a6b3c8ebf?s=128&d=identicon&r=PG&f=1", "display_name": "devemcn", "link": "https://stackoverflow.com/users/7107374/devemcn"}, "reply_to_user": {"reputation": 261, "user_id": 7206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11fbca58483b4cf513eea7edcdbda97?s=128&d=identicon&r=PG&f=1", "display_name": "rule", "link": "https://stackoverflow.com/users/7206171/rule"}, "edited": false, "score": 0, "creation_date": 1480506924, "post_id": 40886911, "comment_id": 68989188, "body": "Thanks for the response.Tried it there but no success. response.username definitely got the username ok but once the page change happens the variables remain undefined."}, {"owner": {"reputation": 261, "user_id": 7206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11fbca58483b4cf513eea7edcdbda97?s=128&d=identicon&r=PG&f=1", "display_name": "rule", "link": "https://stackoverflow.com/users/7206171/rule"}, "edited": false, "score": 0, "creation_date": 1480507910, "post_id": 40886911, "comment_id": 68989773, "body": "just another thing i noticed now, try to change this 2 lines:   service.setCredentials = function(username, password){               this.username = username;     };      service.getCredentials = function(){              return this.username;     };"}, {"owner": {"reputation": 19, "user_id": 7107374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13e41bd8d528111a5f1ec2a6b3c8ebf?s=128&d=identicon&r=PG&f=1", "display_name": "devemcn", "link": "https://stackoverflow.com/users/7107374/devemcn"}, "reply_to_user": {"reputation": 261, "user_id": 7206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11fbca58483b4cf513eea7edcdbda97?s=128&d=identicon&r=PG&f=1", "display_name": "rule", "link": "https://stackoverflow.com/users/7206171/rule"}, "edited": false, "score": 0, "creation_date": 1480509112, "post_id": 40886911, "comment_id": 68990535, "body": "still no luck. One thing I&#39;m noticing is that console.log(&quot;username&quot; + authService.getCredentials()) is always showing undefined. Should that not be an empty string like I set in the blog.factory ?"}, {"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 0, "creation_date": 1480555034, "post_id": 40886911, "comment_id": 69015836, "body": "Check if there&#39;s a confusion with &quot;username&quot; - you use it both as a function argument and as a local variable."}, {"owner": {"reputation": 19, "user_id": 7107374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13e41bd8d528111a5f1ec2a6b3c8ebf?s=128&d=identicon&r=PG&f=1", "display_name": "devemcn", "link": "https://stackoverflow.com/users/7107374/devemcn"}, "edited": false, "score": 0, "creation_date": 1480610510, "post_id": 40886911, "comment_id": 69043982, "body": "I changed it around so that to use $rootScope instead and that&#39;s got it working. Thanks for the help."}], "answers": [{"tags": [], "owner": {"reputation": 416, "user_id": 2560234, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c16c1eaf4106951c072f9514228410f?s=128&d=identicon&r=PG&f=1", "display_name": "jste89", "link": "https://stackoverflow.com/users/2560234/jste89"}, "is_accepted": false, "score": 0, "last_activity_date": 1483376708, "last_edit_date": 1483376708, "creation_date": 1482337185, "answer_id": 41267363, "question_id": 40886911, "link": "https://stackoverflow.com/questions/40886911/angularjs-authentication-not-working-as-expected/41267363#41267363", "title": "AngularJS authentication not working as expected", "body": "<p>The problem is that your authService doesn't have the Login method you're calling from your controller:</p>\n\n<pre><code>blog.controller('LoginCtrl', function($scope, $http, $window, authService){ \n      $scope.login = function({\n          // Well there's your problem!\n          authService.Login($scope.username, $scope.password, function(response, status){\n              if(status == 200){\n                  authService.setCredentials($scope.username, $scope.password);\n                  $window.location.href=\"/\";\n              } else {\n                   $scope.invalidLogin = true;\n              }\n          });\n      };\n});\n</code></pre>\n\n<p>Instead, you need to define your Login method within your factory like so:</p>\n\n<pre><code>myApp.factory('authService', function(){\n    var service = {};\n    var username = \"\";\n\n    service.setCredentials = function(loginUsername, password){\n              username = loginUsername;\n    };\n\n    service.getCredentials = function(){\n             return username;\n    };    \n\n    service.Login = function(loginUsername, password, callback){\n        $http.post('/login', {Username : loginUsername, Password: password}).\n        success(function(response, status){\n            service.setCredentials(loginUsername, password);\n            callback(response, status);\n        });\n    }\n\n    return service;\n});\n</code></pre>\n\n<p>Note that I've also changed the username function parameters to loginUsername as it was shadowing the variable you where trying to assign to. This was causing the username value to be undefined.</p>\n"}], "owner": {"reputation": 19, "user_id": 7107374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13e41bd8d528111a5f1ec2a6b3c8ebf?s=128&d=identicon&r=PG&f=1", "display_name": "devemcn", "link": "https://stackoverflow.com/users/7107374/devemcn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483376708, "creation_date": 1480504442, "last_edit_date": 1480505085, "question_id": 40886911, "link": "https://stackoverflow.com/questions/40886911/angularjs-authentication-not-working-as-expected", "title": "AngularJS authentication not working as expected", "body": "<p>I'm trying to add authentication to my golang/angular app. the backend authentication works fine and logs that the user has logged in but the angular part is not working as expected, it doesn't set the username as when it successfully logs in and changes page, the username is not set.</p>\n\n<p><b>app.js</b></p>\n\n<pre><code>blog.controller('LoginCtrl', function($scope, $http, $window, authService){ \n      $scope.login = function({\n          authService.Login($scope.username, $scope.password, function(response, status){\n              if(status == 200){\n                  authService.setCredentials($scope.username, $scope.password);\n                  $window.location.href=\"/\";\n              } else {\n                   $scope.invalidLogin = true;\n              }\n          });\n      };\n});\n\nblog.factory('authService', function(username, password, callback){\n    var service = {};\n    var username = \"\";\n\n    $http.post('/login', {Username : username, Password: password}).\n    success(function(response, status){\n        service.setCredentials(username, password);\n        callback(response, status);\n    });\n\n    service.setCredentials = function(username, password){\n              username = username;\n    };\n\n    service.getCredentials = function(){\n             return username;\n    };\n      return service;\n});\n\nblog.controller('NavCtrl', function($scope, $rootScope, authService){\n    $scope.isAuth = (authService.getCredentials() != \"\");\n    console.log(\"username: \" + authService.getCredentials());\n    $scope.username = authService.getCredentials();\n});\n</code></pre>\n"}, {"tags": ["arrays", "json", "postgresql", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1480514529, "post_id": 40884611, "comment_id": 68994280, "body": "Thanks.....Can u please tell me  how to save the json array and retrieve it using sqlx.In my struct i need to store the certificate info...Thanks"}, {"owner": {"reputation": 1057, "user_id": 1750407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EobHJ.jpg?s=128&g=1", "display_name": "Wendy Adi", "link": "https://stackoverflow.com/users/1750407/wendy-adi"}, "reply_to_user": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1480520748, "post_id": 40884611, "comment_id": 68998840, "body": "@RajeshKumar how do you want to store the []Certificateinfo? In postgreSQL text field as json string? or in separate table? You need to give detail about your table."}, {"owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1480555622, "post_id": 40884611, "comment_id": 69015994, "body": "I have updated my information for more info.I apologise for being so elaborate as i m not familiar with json in postgreSQL.Thanks."}, {"owner": {"reputation": 1888, "user_id": 557869, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dd75fa8d754b882a16dbddb5bb1cad9f?s=128&d=identicon&r=PG", "display_name": "JehandadK", "link": "https://stackoverflow.com/users/557869/jehandadk"}, "edited": false, "score": 0, "creation_date": 1570136909, "post_id": 40884611, "comment_id": 102828836, "body": "Can we sql.NullString here?"}], "tags": [], "owner": {"reputation": 1057, "user_id": 1750407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EobHJ.jpg?s=128&g=1", "display_name": "Wendy Adi", "link": "https://stackoverflow.com/users/1750407/wendy-adi"}, "is_accepted": false, "score": 9, "last_activity_date": 1480506098, "last_edit_date": 1480506098, "creation_date": 1480498155, "answer_id": 40884611, "question_id": 40884184, "link": "https://stackoverflow.com/questions/40884184/need-to-insert-struct-directly-in-a-postgresql-db/40884611#40884611", "title": "Need to insert struct directly in a PostgreSQL DB", "body": "<p>You can use <code>https://github.com/jmoiron/sqlx</code> library. It has <code>NamedExec</code> function and you can pass variable to it. But first you need to define <code>db</code> tag for each of your struct field.</p>\n\n<p>Simplified Example:</p>\n\n<pre><code>import (\n    _ \"github.com/lib/pq\"\n    \"github.com/jmoiron/sqlx\"\n    \"log\"\n)\n\ntype ApplyLeave1 struct {\n    LeaveId           int       `db:\"leaveid\"`\n    EmpId             string    `db:\"empid\"`\n    SupervisorEmpId   string    `db:\"supervisorid\"`\n}\n\ndb, err := sqlx.Connect(\"postgres\", \"user=foo dbname=bar sslmode=disable\")\nif err != nil {\n    log.Fatalln(err)\n}\n\nquery := `INSERT INTO TABLENAME(leaveid, empid, supervisorid) \n          VALUES(:leaveid, :empid, :supervisorid)`\n\nvar leave1 ApplyLeave1\n_, err := db.NamedExec(query, leave1)\nif err != nil {\n    log.Fatalln(err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1480503301, "creation_date": 1480503301, "answer_id": 40886499, "question_id": 40884184, "link": "https://stackoverflow.com/questions/40884184/need-to-insert-struct-directly-in-a-postgresql-db/40886499#40886499", "title": "Need to insert struct directly in a PostgreSQL DB", "body": "<p>Another approach is to use the <a href=\"https://github.com/knq/xo\" rel=\"nofollow noreferrer\"><code>github.com/knq/xo</code></a> package which relies on code generation (<code>go tool generate</code>).</p>\n\n<p>This package comes with a tool which takes the schema of your target database and creates a set of Go source code files containing types and code which map to the DB schema (and back).</p>\n\n<p>Compared to <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\"><code>github.com/jmoiron/sqlx</code></a>, the pros and cons are as follows:</p>\n\n<ul>\n<li><code>sqlx</code> is slower because it relies on run-time reflection over the types of the values you submit to it. <code>xo</code> generates static code which is as fast as you can theoretically get which can make some difference under heavy workloads.</li>\n<li><code>xo</code> requires a separate generation step while <code>sqlx</code> doesn't.</li>\n<li><code>sqlx</code> allows you to also use other tags on your types&mdash;so you may have, say, tags for <code>json</code> serialization as well. I'm not sure whether <code>xo</code> tries to preserve your changes done to what it generates.</li>\n</ul>\n"}], "owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9173, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1606205662, "creation_date": 1480496878, "last_edit_date": 1606205662, "question_id": 40884184, "link": "https://stackoverflow.com/questions/40884184/need-to-insert-struct-directly-in-a-postgresql-db", "title": "Need to insert struct directly in a PostgreSQL DB", "body": "<p>I am using go lang as my back end and postgreSQL as my database.I use \"github.com/lib/pq\" driver to connect with my database. I have a struct which have lot of field and it has some JSON inside it.</p>\n\n<p>My struct looks like this</p>\n\n<pre><code>ApplyLeave1 struct {\n        LeaveId           int       \n        EmpId             string    \n        SupervisorEmpId   string    \n        LeaveDays         float64   \n        MDays             float64   \n        LeaveType         string    \n        DayType           string    \n        LeaveFrom         time.Time \n        LeaveTo           time.Time \n        AppliedDate       time.Time \n        LeaveStatus       string    \n        ResultDate        time.Time     \n        Certificate       []*CertificateInfo\n    }\n\n    CertificateInfo struct {\n        Id           int64  \n        FileName     string \n        FileType     string \n        FileLocation string \n    } \n</code></pre>\n\n<p>The struct is big and have some json array inside it and my database schema is as same as the struct. As for as I researched the only way to insert is to use query and insert one by one from mystruct in to the database for example like this</p>\n\n<pre><code>var leave ApplyLeave1\n\n    db.Exec(\"INSERT INTO TABLENAME(leaveid,empid,supervisorid,....) VALUES($1,$2,$3,$4,....)\",leave.LeaveId,leave.EmpId,leave.SupervisorId,.....)\n</code></pre>\n\n<p>This is too long to write as my struct is very big.Is it possible to <strong>insert the whole struct at one time</strong> and please direct me <strong>how to insert a json array</strong> inside the database.Appreciate any help.Thanks</p>\n\n<p>Updated information:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS apply_leave1 \n(\n    leaveid serial PRIMARY KEY NOT NULL ,\n    empid varchar(10) NOT NULL REFERENCES employee(empid),\n    leavedays double precision NOT NULL DEFAULT 0 ,\n    mdays double precision NOT NULL DEFAULT 0 ,\n    leavetype varchar(20) NOT NULL DEFAULT '' ,\n    daytype text NOT NULL DEFAULT '',\n    leavefrom timestamp with time zone NOT NULL,\n    leaveto timestamp with time zone NOT NULL,\n    applieddate timestamp with time zone NOT NULL,\n    leavestatus varchar(15) NOT NULL DEFAULT ''  ,\n    resultdate timestamp with time zone,\n    certificatestatus bool NOT NULL DEFAULT FALSE,\n    certificate json[])\n</code></pre>\n\n<p>Inside certificate(json[]) i will have all the fields of certificateinfo struct which you can see in the above struct information.Here i give certificate as json[]. I don't know which one is better json or json[] for the retrieval.\nI will be doing following operations and I don't if it is possible with the PostgreSQL.</p>\n\n<ul>\n<li>I need to store more than two certificate information per leave</li>\n<li>I would  like  to give certificate id as the auto increment and unique so it is easy for retrieval( i don`t know if its possible as my leave id is primary key and auto increment as well. </li>\n<li>I will searching the certificate info using leave id and certificate id.</li>\n<li>I need to retrieve only some fields of certificate info.For example only filename and file type using the leave id and certificate id.</li>\n<li>I need to update the certificate information of the particular certificate using its id.</li>\n</ul>\n\n<p>Sorry for being so elaborate.Since i m new to use json in Postgres I have lots of doubts.So please bear my unawareness questions.Thanks...Appreciate your help.Thanks </p>\n"}, {"tags": ["go", "gdb"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1480790468, "post_id": 40882206, "comment_id": 69112014, "body": "gdb doesn&#39;t work well with go, for an alternative see <a href=\"http://blog.mailgun.com/introducing-a-new-cross-platform-debugger-for-go/\" rel=\"nofollow noreferrer\">godebug</a>. Or you may have some success with <a href=\"https://www.youtube.com/watch?v=OKLR6rrsBmI\" rel=\"nofollow noreferrer\">cgdb</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": 1, "last_activity_date": 1553754376, "creation_date": 1553754376, "answer_id": 55391346, "question_id": 40882206, "link": "https://stackoverflow.com/questions/40882206/how-to-cast-the-address-to-a-type-and-print-it-in-gdb-for-golang/55391346#55391346", "title": "How to cast the address to a type and print it in GDB for Golang", "body": "<p>The delve tool is better than gdb. <a href=\"https://github.com/go-delve/delve\" rel=\"nofollow noreferrer\">https://github.com/go-delve/delve</a></p>\n\n<ol>\n<li>install delve </li>\n</ol>\n\n<pre><code>go get -u github.com/go-delve/delve/cmd/dlv\n</code></pre>\n\n<ol start=\"2\">\n<li>move path on main.go</li>\n</ol>\n\n<pre><code>cd $GOPATH/src/YOUPROJECT/main.go\n</code></pre>\n\n<ol start=\"3\">\n<li>debug delve</li>\n</ol>\n\n<pre><code>$GOPATH/bin/delve debug main.go\n</code></pre>\n\n<ol start=\"4\">\n<li>break point main</li>\n</ol>\n\n<pre><code>Type 'help' for list of commands.\n(dlv) b main.main\nBreakpoint 1 set at 0x4a7bbf for main.main() main.go:12\n</code></pre>\n\n<ol start=\"5\">\n<li>run</li>\n</ol>\n\n<pre><code>(dlv) c\n&gt; main.main() main.go:12 (hits goroutine(1):1 total:1) (PC: 0x4a7bbf)\n     7: type TestType struct {\n     8:         a int\n     9:         b int\n    10: }\n    11:\n=&gt;  12: func main() {\n    13:         var testType TestType = TestType{1, 2}\n    14:         fmt.Println(testType)\n    15: }\n</code></pre>\n\n<ol start=\"6\">\n<li>break point 14 line</li>\n</ol>\n\n<pre><code>(dlv) b 14\nBreakpoint 2 set at 0x4a7bf0 for main.main() main.go:14\n</code></pre>\n\n<ol start=\"7\">\n<li>continue</li>\n</ol>\n\n<pre><code>(dlv) c\n&gt; main.main() main.go:14 (hits goroutine(1):1 total:1) (PC: 0x4a7bf0)\n     9:         b int\n    10: }\n    11:\n    12: func main() {\n    13:         var testType TestType = TestType{1, 2}\n=&gt;  14:         fmt.Println(testType)\n    15: }\n</code></pre>\n\n<ol start=\"8\">\n<li>show value</li>\n</ol>\n\n<pre><code>(dlv) locals\ntestType = main.TestType {a: 1, b: 2}\n</code></pre>\n\n<p>Finally, using goland, vscode is more convenient for debug.</p>\n"}], "owner": {"reputation": 361, "user_id": 7229120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5af5b05b1499d40493fb6ed087bf12b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/7229120/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 795, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1553754376, "creation_date": 1480489407, "question_id": 40882206, "link": "https://stackoverflow.com/questions/40882206/how-to-cast-the-address-to-a-type-and-print-it-in-gdb-for-golang", "title": "How to cast the address to a type and print it in GDB for Golang", "body": "<p>This is the piece of code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype TestType struct {\n    a int\n    b int\n}\n\nfunc main() {\n    var testType TestType = TestType{1, 2}\n    fmt.Println(testType)\n}\n</code></pre>\n\n<p>And this is the gdb debug output:</p>\n\n<pre><code>(gdb) r\nStarting program: /home/bzhang/common/src/go/src/test/testBinary \n\nBreakpoint 1, main.main () at /home/bzhang/common/src/go/src/test/main.go:14\n14              fmt.Println(testType)\n(gdb) p testType\n$1 = {a = 1, b = 2}\n(gdb) p &amp;testType\n$2 = (main.TestType *) 0xc820059ee8\n(gdb) p ('main.TestType'*) 0xc820059ee8\nA syntax error in expression, near `) 0xc820059ee8'.\n(gdb) p ('TestType'*) 0xc820059ee8     \nA syntax error in expression, near `) 0xc820059ee8'.\n(gdb) whatis testType\ntype = main.TestType\n(gdb) \n</code></pre>\n\n<p>Of course I know that I can print testType directly. But if it is a local variable, sometimes its value can not be printed out directly, and only its address is available. So I want to print its value with the indication of its type. But it seems not work correctly.\nAppreciate for your help!</p>\n"}, {"tags": ["go", "naming-conventions"], "answers": [{"comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 2, "creation_date": 1480580631, "post_id": 40884816, "comment_id": 69024024, "body": "Do you have any naming recommendations for the scenario in question ?"}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1480605780, "post_id": 40884816, "comment_id": 69040901, "body": "Yes @JohnSPerayil two examples from my little corner are the <a href=\"https://github.com/kubernetes/kubernetes/blob/master/docs/devel/coding-conventions.md\" rel=\"nofollow noreferrer\">Kubernetes</a> and  the <a href=\"https://github.com/coreos/docker/blob/master/CONTRIBUTING.md#coding-style\" rel=\"nofollow noreferrer\">Docker</a> contribution style guides."}, {"owner": {"reputation": 392, "user_id": 5767484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063da3e00ffcf4d3a001a1329c4e51b8?s=128&d=identicon&r=PG&f=1", "display_name": "NotX", "link": "https://stackoverflow.com/users/5767484/notx"}, "edited": false, "score": 1, "creation_date": 1573056333, "post_id": 40884816, "comment_id": 103758517, "body": "What about initial acronyms? Should I choose <code>dbName</code> or <code>DBName</code> for local variables?"}], "tags": [], "owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "is_accepted": true, "score": 13, "last_activity_date": 1480498735, "creation_date": 1480498735, "answer_id": 40884816, "question_id": 40881994, "link": "https://stackoverflow.com/questions/40881994/naming-convention-for-similar-golang-variables/40884816#40884816", "title": "Naming convention for similar Golang variables", "body": "<p>The likely most authoritative book in the field, <a href=\"http://www.gopl.io/\" rel=\"noreferrer\">The Go Programming Language</a>, discusses this topic in section <em>10.6 Packages and Naming</em>:</p>\n\n<ul>\n<li>keep names short but don't make them cryptic (<code>user</code> over <code>userName</code>)</li>\n<li>package names usually take singular form (unless there's a conflict with predeclared types)</li>\n<li>pick names so that they read in the context of the package, for example, <a href=\"https://golang.org/pkg/net/#IP\" rel=\"noreferrer\">net.IP</a> </li>\n</ul>\n\n<p>In addition, there's a nice slide deck <a href=\"https://talks.golang.org/2014/names.slide\" rel=\"noreferrer\">What's in a name</a> addressing some of the questions and a somewhat informative <a href=\"https://www.reddit.com/r/golang/comments/2hwch1/what_is_with_the_fascination_for_short_variable/\" rel=\"noreferrer\">reddit thread</a> that might be useful as well.</p>\n\n<p>Most of the naming conventions in my experience (in addition to the above mentioned) are however project or company specific. </p>\n"}], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8038, "favorite_count": 1, "accepted_answer_id": 40884816, "answer_count": 1, "score": 7, "last_activity_date": 1480498735, "creation_date": 1480488557, "question_id": 40881994, "link": "https://stackoverflow.com/questions/40881994/naming-convention-for-similar-golang-variables", "title": "Naming convention for similar Golang variables", "body": "<p>I have a couple of cases where I have the same underlying value being represented as multiple types.</p>\n\n<p>Example :</p>\n\n<pre><code>userIDString := r.URL.Query(\"id\")\nuserID, err :=  strconv.Atoi(userIDString)\n</code></pre>\n\n<p>I need to use both the above variables at different places.</p>\n\n<p>Similarly </p>\n\n<pre><code>recordSeparator = rune(30)\nrecordSeparatorString = string(30)\n</code></pre>\n\n<p>Is my approach to naming such variables considered idiomatic go ? If not what would be the ideal naming convention for such cases ?</p>\n\n<p>PS: I don't think this question is primarily opinion based, I'm looking for answers referencing the naming conventions in popular go projects / standard lib.</p>\n"}, {"tags": ["go", "reflection", "types", "go-reflect"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1480477553, "post_id": 40879748, "comment_id": 68974504, "body": "The reflect package does not contain this functionality.  If you are generating code, then the <a href=\"https://godoc.org/go/types\" rel=\"nofollow noreferrer\">go/types</a> or <a href=\"https://godoc.org/go/ast\" rel=\"nofollow noreferrer\">go/ast</a> packages may be of use."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1480483866, "post_id": 40879748, "comment_id": 68976376, "body": "No. Use a registry of names -&gt; types association for lookup."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1480492805, "last_edit_date": 1495541630, "creation_date": 1480492333, "answer_id": 40882963, "question_id": 40879748, "link": "https://stackoverflow.com/questions/40879748/how-to-get-type-representation-from-name-via-reflection/40882963#40882963", "title": "How to get Type representation from name via reflection?", "body": "<p>The question is not quite explicit, it can be interpreted in 2 ways, to one of which the answer is no, not possible; and the other to which the answer is yes, it's possible.</p>\n\n<h3>At runtime</h3>\n\n<p>If the type name is provided as a <code>string</code> value, then at runtime it's not possible as types that are not referred to explicitly may not get compiled into the final executable binary (and thus obviously become unreachable, \"unknown\" at runtime). For details see  <a href=\"https://stackoverflow.com/questions/38875016/splitting-client-server-code/38875901#38875901\">Splitting client/server code</a>. For possible workarounds see <a href=\"https://stackoverflow.com/questions/37384473/call-all-functions-with-special-prefix-or-suffix-in-golang/37384665#37384665\">Call all functions with special prefix or suffix in Golang</a>.</p>\n\n<h3>At \"coding\" time</h3>\n\n<p>If we're talking about \"coding\" time (source code writing / generating), then it's possible without creating / allocating a variable of the given type and calling <a href=\"https://golang.org/pkg/reflect/#TypeOf\" rel=\"noreferrer\"><code>reflect.TypeOf()</code></a> and passing the variable.</p>\n\n<p>You may start from the <em>pointer</em> to the type, and use a <em>typed <code>nil</code></em> pointer value without allocation, and you can navigate from its <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"noreferrer\"><code>reflect.Type</code></a> descriptor to the descriptor of the <em>base</em> type (or <em>element</em> type) of the pointer using <code>Type.Elem()</code>.</p>\n\n<p>This is how it looks like:</p>\n\n<pre><code>t := reflect.TypeOf((*YourType)(nil)).Elem()\n</code></pre>\n\n<p>The type descriptor <code>t</code> above will be identical to <code>t2</code> below:</p>\n\n<pre><code>var x YourType\nt2 := reflect.TypeOf(x)\n\nfmt.Println(t, t2)\nfmt.Println(t == t2)\n</code></pre>\n\n<p>Output of the above application (try it on the <a href=\"https://play.golang.org/p/W_6MMkxoAS\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>main.YourType main.YourType\ntrue\n</code></pre>\n"}], "owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3926, "favorite_count": 0, "accepted_answer_id": 40882963, "answer_count": 1, "score": 5, "last_activity_date": 1610053075, "creation_date": 1480476510, "last_edit_date": 1610053075, "question_id": 40879748, "link": "https://stackoverflow.com/questions/40879748/how-to-get-type-representation-from-name-via-reflection", "title": "How to get Type representation from name via reflection?", "body": "<p>Is there a way to use the <a href=\"https://golang.org/pkg/reflect/\" rel=\"noreferrer\">reflection libraries</a> in Go to go from the name of a type to its <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"noreferrer\">Type</a> representation?</p>\n\n<p>I've got a library where the user needs to provide Type representations for some code generation. I know it must be possible (in a sense) because  they can just create a variable of that type and call the <a href=\"https://golang.org/pkg/reflect/#TypeOf\" rel=\"noreferrer\">TypeOf function</a>, but is there a way to circumvent this and just get representation from the name?</p>\n"}, {"tags": ["go", "go-html-template"], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 1, "last_activity_date": 1480480769, "creation_date": 1480480769, "answer_id": 40880431, "question_id": 40879481, "link": "https://stackoverflow.com/questions/40879481/nested-template-is-not-being-rendered-golang/40880431#40880431", "title": "Nested template is not being rendered : Golang", "body": "<p>You forgot to reassign the <code>GoldShopHeaderTemplate</code> after you parsed <code>goldShopRepString</code></p>\n\n<p>This line:</p>\n\n<pre><code>GoldShopHeaderTemplate.Parse(goldShopRepString)\n</code></pre>\n\n<p>Should Be:</p>\n\n<pre><code>GoldShopHeaderTemplate, err := GoldShopHeaderTemplate.Parse(goldShopRepString)\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5534366, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/38263eb6a037e0ae2488883573783d5b?s=128&d=identicon&r=PG&f=1", "display_name": "Ashi", "link": "https://stackoverflow.com/users/5534366/ashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 1, "accepted_answer_id": 40880431, "answer_count": 1, "score": 0, "last_activity_date": 1480480769, "creation_date": 1480474719, "question_id": 40879481, "link": "https://stackoverflow.com/questions/40879481/nested-template-is-not-being-rendered-golang", "title": "Nested template is not being rendered : Golang", "body": "<p>The application in perl calls the header in golang via SSI to render the banner.\nIn golang the header template {gold_shop_header.shtml} inculdes another template {reputation_level_info.html}. The issue is that the contents of the included template are not being rendered.</p>\n\n<p>Code for reference:</p>\n\n<pre><code>gold_shop_header.shtml\n\n  {{define \"Gold Banner\"}}\n    .\n    .\n     &lt;div class=\"text-center mt-3\"&gt;\n        &lt;span class=\"fs-12 font-default cursor-default\"&gt;\n              {{ Loc .Lang \"Reputation\" }}\n              {{ template \"reputation_level\" . }}\n        &lt;/span&gt;\n     &lt;/div&gt;\n     .\n     .\n   {{ end }}\n\n\nreputation_level_info.html\n\n    {{define \"reputation_level\"}}\n    &lt;i class=\"icon-help-alt ml-5\"&gt;\n     &lt;div class=\"absolute text-left\" style=\"\"&gt;\n        &lt;div class=\"relative hover-reputation-lib\"&gt;\n            &lt;div class=\"relative w-100p\"&gt;\n                &lt;div class=\"fs-18 mt-5\"&gt;{{ Loc .Lang \"Reputation Levels\" }}&lt;/div&gt;\n\n                &lt;table class=\" mt-10 fs-8 table-repsys\" &gt;\n                    &lt;tbody&gt;\n                        &lt;tr class=\"bold\"&gt;\n                            &lt;th&gt;{{ Loc .Lang \"Badges\" }}&lt;/th&gt;\n                            &lt;th&gt;{{ Loc .Lang \"Name\" }}&lt;/th&gt;\n                            &lt;th&gt;{{ Loc .Lang \"Points\" }}&lt;/th&gt;\n                        &lt;/tr&gt;\n\n                        {{ range .RepLevels }}\n                        &lt;tr class=\"{{ .Class}}\"&gt;\n                            &lt;td&gt;\n                                &lt;span class=\"badges-lib {{ .ImageName}}\"&gt;&lt;/span&gt;\n                            &lt;/td&gt;\n\n                            {{ if eq .Badges \"off\" }}\n                            &lt;td&gt;\n                                {{ .Badges }}\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                {{ if .UpperBound }}\n                                    {{ .LowerBound }} - {{ .UpperBound }} Points\n                                {{ else }}\n                                    &amp;gt; {{ .LowerBound }} Points\n                                {{ end }}\n                            &lt;/td&gt;\n                            {{ else }}\n                                &lt;td colspan=\"2\"&gt;{{ Loc ..Lang \"Reputation Off\" }}&lt;/td&gt;\n                            {{ end }}\n                        &lt;/tr&gt;\n                        {{ end }}\n                    &lt;/tbody&gt;\n                &lt;/table&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/i&gt;\n{{ end }}\n\n\n\n\ngen.go\n\n   var reputationTemplatePath = \"/var/ssi/banner/gold/reputation_level_info.html\"\n\n    _goldShopReputationTemplateBytes, err := ioutil.ReadFile(reputationTemplatePath)\n    if err != nil {\n      log.Panic(\"err\", \"error reading template\", err)\n    }\n\n    var goldShopRepString = string(_goldShopReputationTemplateBytes)\n\n    var headerTemplatePath = \"/var/ssi/banner/gold/gold_shop_header.shtml\"\n\n    _goldShopHeaderTemplateBytes, err := ioutil.ReadFile(headerTemplatePath)\n    if err != nil {\n        log.Panic(\"err\", \"error reading template\", err)\n    }\n\n    var goldShopHeaderString = string(_goldShopHeaderTemplateBytes)\n\n    var templatesString [] string\n\n    GoldShopHeaderTemplate, err = template.New(\"Gold Shop  Header\").Funcs(GetTemplateFunctionMap()).\n      Parse(goldShopHeaderString)\n     if err != nil {\n       log.Panic(\"err\", \"error parsing template\", err)\n     }\n    GoldShopHeaderTemplate.Parse(goldShopRepString)\n\n\nhtmlBuffer := bytes.NewBufferString(\"\")\ntemplate_exec_err := GoldShopHeaderTemplate.Execute(htmlBuffer, argsHeader)\n</code></pre>\n\n<p>Please suggest what is wrong. I am new to golang. The included template is not being rendered. also, for the main template if I remove the {{ define \" Gold Banner\"}} statement does it get rendered, if I include this statement nothing gets rendered.\nNo error is reported.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1480483964, "post_id": 40879451, "comment_id": 68976411, "body": "That&#39;s how the go tool works and you cannot do this for your own code. The stdlib and the std tools are treated differently."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480522089, "post_id": 40879451, "comment_id": 68999794, "body": "Related: <a href=\"http://stackoverflow.com/questions/33118766/why-is-there-no-binary-created-when-running-go-get-golang-org-x-tools-cmd-godoc/33119819#33119819\">Why is there no binary created when running <code>go get golang.org&#47;x&#47;tools&#47;cmd&#47;godoc</code>?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 0, "creation_date": 1480485248, "post_id": 40881231, "comment_id": 68976868, "body": "How does Go handle the translation between <code>&#47;</code> and ` \\ `?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 1, "creation_date": 1480485308, "post_id": 40881231, "comment_id": 68976886, "body": "@GregoryNisbet with <a href=\"https://golang.org/pkg/path/filepath/#FromSlash\" rel=\"nofollow noreferrer\">golang.org/pkg/path/filepath/#FromSlash</a>. Also: <a href=\"http://stackoverflow.com/a/12132445/6309\">stackoverflow.com/a/12132445/6309</a>"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1480583285, "post_id": 40881231, "comment_id": 69025471, "body": "If in doubt, use forward slash &#39;/&#39; which works on POSIX file systems including Windows."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 3, "last_activity_date": 1480485036, "creation_date": 1480485036, "answer_id": 40881231, "question_id": 40879451, "link": "https://stackoverflow.com/questions/40879451/what-rules-decides-the-go-package-installation-location/40881231#40881231", "title": "What rules decides the Go package installation location?", "body": "<p>The <a href=\"https://golang.org/pkg/go/build/\" rel=\"nofollow noreferrer\"><code>go build</code></a> command relies on a go tool directory, where build tools are installed (<code>compile.exe</code>, <code>link.exe</code>, ...).</p>\n\n<p>And <code>ToolDir</code> is defined as:</p>\n\n<pre><code>var ToolDir = filepath.Join(runtime.GOROOT(), \"pkg/tool/\"+runtime.GOOS+\"_\"+runtime.GOARCH)\n</code></pre>\n\n<p>So any build tool is in <code>%GOROOT%\\pkg\\tool\\</code></p>\n"}], "owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1480485036, "creation_date": 1480474443, "question_id": 40879451, "link": "https://stackoverflow.com/questions/40879451/what-rules-decides-the-go-package-installation-location", "title": "What rules decides the Go package installation location?", "body": "<p>When I run <code>go install</code> with some of my own package located in <code>%GOPATH%\\src</code>, it will be installed to <code>%GOPATH%\\pkg</code>.</p>\n\n<p>I read that <code>%GOROOT%</code> and <code>%GOPATH%</code> folders have similar organization. So I tried <code>go install cmd\\cgo</code> with the <code>%GOROOT%\\src\\cmd\\cgo</code> package which is part of the golang installation. But the final <code>cgo.exe</code> is installed to <code>%GOROOT%\\pkg\\tool\\</code>.</p>\n\n<p>I checked all the <code>*.go</code> files in the <code>cmd\\cgo</code> folder. They all have a <code>package main</code> declaration. So I was expecting the final <code>cgo.exe</code> to be installed to <code>%GOROOT%\\bin</code>.</p>\n\n<p>My questions are:</p>\n\n<ul>\n<li>Why the <code>cgo.exe</code> is installed to <code>pkg</code> rather than <code>bin</code>?</li>\n<li>Where does the <code>tool</code> part in the <code>pkg\\tool</code> come from? Can I do similar thing for my own package?</li>\n</ul>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1480473928, "post_id": 40879295, "comment_id": 68973547, "body": "The tags are part of the struct type. There&#39;s nothing related to the tag in the field value itself."}], "answers": [{"tags": [], "owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "is_accepted": false, "score": 0, "last_activity_date": 1480480252, "creation_date": 1480480252, "answer_id": 40880342, "question_id": 40879295, "link": "https://stackoverflow.com/questions/40879295/golang-reflect-passing-a-sturct-member-variable-to-a-function-and-return-its-ta/40880342#40880342", "title": "Golang reflect: passing a sturct member variable to a function and return its tag name", "body": "<p>maybe this can help. <a href=\"https://play.golang.org/p/WtqdQAmsbi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/WtqdQAmsbi</a></p>\n\n<pre><code>x := struct {\n    Bar int `json:\"bar\"`\n    Foo string `json:\"foo\"`\n\n}{2, \"foo\"}\n\nv := reflect.ValueOf(x)\n\nfor i := 0; i &lt; v.NumField(); i++ {\n    fmt.Println(v.Type().Field(i).Name)\n    fmt.Println(v.Type().Field(i).Tag)\n}\n</code></pre>\n\n<p>To fetch the name of the struct field as well as its tag</p>\n"}], "owner": {"reputation": 225, "user_id": 4477081, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/428d8bd6d84f8e49f9ad9d871e9eedae?s=128&d=identicon&r=PG&f=1", "display_name": "NiklausTseng", "link": "https://stackoverflow.com/users/4477081/niklaustseng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480480252, "creation_date": 1480473127, "question_id": 40879295, "link": "https://stackoverflow.com/questions/40879295/golang-reflect-passing-a-sturct-member-variable-to-a-function-and-return-its-ta", "title": "Golang reflect: passing a sturct member variable to a function and return its tag name", "body": "<pre><code>   type Teacher struct {\n     Name string `json:\"name\"`\n     Age int `json:\"age\"`\n   }\n\n\n   func getTag(i interface{}) string\n\n   getTag(teacher.Name) // print name\n   getTag(teacher.Age) // print age\n</code></pre>\n\n<p>I wanna roll my function like the code segment, but I can't find a way to achieve this. Any Ideas?</p>\n"}, {"tags": ["go", "drone", "drone.io"], "answers": [{"comments": [{"owner": {"reputation": 2383, "user_id": 160454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c58a0be77ee441bb8f8595b7f1b4e87?s=128&d=identicon&r=PG", "display_name": "Brad Rydzewski", "link": "https://stackoverflow.com/users/160454/brad-rydzewski"}, "edited": false, "score": 1, "creation_date": 1480506848, "post_id": 40883450, "comment_id": 68989139, "body": "to expand on this answer, the .drone.yml is used by the open source version of drone found at github.com/drone/drone. The open source version of drone is not yet powering the drone.io service. This is planned, but not until the open source project reaches a stable 1.0"}], "tags": [], "owner": {"reputation": 46, "user_id": 1538612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae821bcfae1095d33e5ca6e326472fd0?s=128&d=identicon&r=PG", "display_name": "bugagazavr", "link": "https://stackoverflow.com/users/1538612/bugagazavr"}, "is_accepted": false, "score": 1, "last_activity_date": 1480494240, "creation_date": 1480494240, "answer_id": 40883450, "question_id": 40877978, "link": "https://stackoverflow.com/questions/40877978/drone-io-not-using-drone-yml-file-of-github-repo/40883450#40883450", "title": "drone.io Not using .drone.yml file of GitHub repo", "body": "<p><a href=\"https://drone.io/\" rel=\"nofollow noreferrer\">https://drone.io/</a> - doesn't support <code>.drone.yml</code> file, this file supported by <a href=\"https://github.com/drone/drone\" rel=\"nofollow noreferrer\">https://github.com/drone/drone</a></p>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 7229774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add62de4f707df85fba67c29d291f52e?s=128&d=identicon&r=PG", "display_name": "Thomas Boerger", "link": "https://stackoverflow.com/users/7229774/thomas-boerger"}, "reply_to_user": {"reputation": 3394, "user_id": 4805174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y0dE2.png?s=128&g=1", "display_name": "kayess", "link": "https://stackoverflow.com/users/4805174/kayess"}, "edited": false, "score": 0, "creation_date": 1480506561, "post_id": 40883877, "comment_id": 68988977, "body": "But this is a correct answer, drone.io doesn&#39;t support the drone.yml, it&#39;s only supported by the self-hosted open source version of drone. So he&#39;s forced to host drone on his own."}], "tags": [], "owner": {"reputation": 56, "user_id": 7229774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add62de4f707df85fba67c29d291f52e?s=128&d=identicon&r=PG", "display_name": "Thomas Boerger", "link": "https://stackoverflow.com/users/7229774/thomas-boerger"}, "is_accepted": false, "score": 1, "last_activity_date": 1480495849, "creation_date": 1480495849, "answer_id": 40883877, "question_id": 40877978, "link": "https://stackoverflow.com/questions/40877978/drone-io-not-using-drone-yml-file-of-github-repo/40883877#40883877", "title": "drone.io Not using .drone.yml file of GitHub repo", "body": "<p>If you want to use a .drone.yml you are forced to host drone on your own.</p>\n"}], "owner": {"reputation": 33, "user_id": 1610678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba8ea84942ad96ce3131584af07af0d6?s=128&d=identicon&r=PG", "display_name": "user1610678", "link": "https://stackoverflow.com/users/1610678/user1610678"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480495849, "creation_date": 1480463970, "question_id": 40877978, "link": "https://stackoverflow.com/questions/40877978/drone-io-not-using-drone-yml-file-of-github-repo", "title": "drone.io Not using .drone.yml file of GitHub repo", "body": "<p>I have a problem with the CI tool drone. At the Moment I'm using drone.io and with the selft-hosted version I have the same issue. When I try to build my golang test application drone.io always ignores my .drone.yml file. </p>\n\n<p>The GitHub repo is: <a href=\"https://github.com/norbell/dronetest\" rel=\"nofollow noreferrer\">https://github.com/norbell/dronetest</a></p>\n\n<p>My .drone.yml file looks like this:</p>\n\n<pre><code>pipeline:\n  build:\n    image: golang:1.6\n    commands:\n      - go get\n      - go build\n</code></pre>\n\n<p>And the settings page of my drone.io project looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qVBtw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qVBtw.png\" alt=\"enter image description here\"></a></p>\n\n<p>And when I click the build button it shows me that the project was successfully \"build\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/V2cZV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V2cZV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Obviously does everything but not building my project. I have done everything I found in the documentation but I can't get it working. </p>\n\n<p>When I put <code>go get</code> and <code>go build</code> or <code>go run main.go</code> into the \"commands\" textarea field of the settings page, drone is suddenly able to build my go application. </p>\n\n<p>I'm not sure what I'm doing wrong, so it would be very nice if someone could help me. :)</p>\n"}, {"tags": ["mongodb", "go", "geolocation", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": true, "score": 1, "last_activity_date": 1480617998, "creation_date": 1480617998, "answer_id": 40918194, "question_id": 40877322, "link": "https://stackoverflow.com/questions/40877322/storelocator-with-golang-and-mongodb/40918194#40918194", "title": "storelocator with golang and mongodb", "body": "<p>@user7227958</p>\n\n<p>Looks like Go is playing tricks with you due to (lack of) float64 preciseness of your coordinates.</p>\n\n<p>Check this: \nwith  long := 39.70 and lat := 35.69 you need a scope=3000000 for your record to be selected.\nHowever if you'll use more precise coordinates, say \n<code>\n    long := 39.6910592\n    lat := 35.6909623\n</code>\nthen you'll be able to find your store even with a scope of 1 meter (which is expected).</p>\n\n<p>Cheers,\n-D</p>\n"}], "owner": {"reputation": 23, "user_id": 7227958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f2b0731b81477ba7539301eaea0a4d?s=128&d=identicon&r=PG&f=1", "display_name": "user7227958", "link": "https://stackoverflow.com/users/7227958/user7227958"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 40918194, "answer_count": 1, "score": 1, "last_activity_date": 1480617998, "creation_date": 1480460238, "question_id": 40877322, "link": "https://stackoverflow.com/questions/40877322/storelocator-with-golang-and-mongodb", "title": "storelocator with golang and mongodb", "body": "<p>Hey i am trying to build a store-locator using golang and mongodb . \nI am new to both . I tried to search but was not able to find a code in golang which can help me insert store with name and co-ordinates into mongodb and then search for stores in a radius of 3000 meters of provided latitude and longitude value . </p>\n\n<p>Note : i want to provide id by myself so that i can easily fetch stores if i have the id . </p>\n\n<p>I tried as given below but nothing happens , no error or store insertion in db </p>\n\n<p><strong>test.go is as below :</strong> </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"log\"\n)\n\ntype Store struct {\n    ID       string  `bson:\"_id,omitempty\" json:\"shopid\"`\n    Name     string  `bson:\"name\" json:\"name\"`\n    Location GeoJson `bson:\"location\" json:\"location\"`\n}\n\ntype GeoJson struct {\n    Type        string    `json:\"-\"`\n    Coordinates []float64 `json:\"coordinates\"`\n}\n\nfunc main() {\n    cluster := \"localhost\" // mongodb host\n\n    // connect to mongo\n    session, err := mgo.Dial(cluster)\n    if err != nil {\n        log.Fatal(\"could not connect to db: \", err)\n        panic(err)\n    }\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n\n    // search criteria\n    long := 39.70\n    lat := 35.69\n    scope := 3000 // max distance in metres\n\n    var results []Store // to hold the results\n\n    // query the database\n    c := session.DB(\"test\").C(\"stores\")\n\n    // insert\n    man := Store{}\n    man.ID = \"1\"\n    man.Name = \"vinka medical store\"\n    man.Location.Type = \"Point\"\n    man.Location.Coordinates = []float64{lat, long}\n\n    // insert\n    err = c.Insert(man)\n    fmt.Printf(\"%v\\n\", man)\n    if err != nil {\n        fmt.Println(\"There is insert error\")\n        panic(err)\n    }\n\n    // ensure\n    // Creating the indexes\n    index := mgo.Index{\n        Key:  []string{\"$2dsphere:location\"},\n        Bits: 26,\n    }\n    err = c.EnsureIndex(index)\n    if err != nil {\n        fmt.Println(\"There is index error\")\n        panic(err)\n    }\n\n    //find\n    err = c.Find(bson.M{\n        \"location\": bson.M{\n            \"$nearSphere\": bson.M{\n                \"$geometry\": bson.M{\n                    \"type\":        \"Point\",\n                    \"coordinates\": []float64{long, lat},\n                },\n                \"$maxDistance\": scope,\n            },\n        },\n    }).All(&amp;results)\n\n    //err = c.Find(bson.M{\"_id\": \"1\"}).All(&amp;results)\n    if err != nil {\n        panic(err)\n    }\n\n    //convert it to JSON so it can be displayed\n    formatter := json.MarshalIndent\n    response, err := formatter(results, \" \", \"   \")\n\n    fmt.Println(string(response))\n}\n</code></pre>\n"}, {"tags": ["go", "google-places-api"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1480459346, "post_id": 40876940, "comment_id": 68969328, "body": "The places file for TextSearch states that <code>&#47;&#47; PageToken returns the next 20 results from a previously run search. Setting a PageToken parameter will execute a search with the same parameters used previously \u2014 all parameters other than PageToken will be ignored.</code>  While the documentation doesn&#39;t state that it&#39;s <i>invalid</i> to include the other parameters, it may in fact be.  Have you tried conditionally setting the <code>Query</code> field only if the <code>PageToken</code> is empty (so the pagination queries only have the <code>PageToken</code> and not the <code>Query</code>)?"}, {"owner": {"reputation": 1335, "user_id": 1527290, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c90b45a5bde3f27dcffe26ef54760faf?s=128&d=identicon&r=PG", "display_name": "Cristian Chaparro A.", "link": "https://stackoverflow.com/users/1527290/cristian-chaparro-a"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1480460621, "post_id": 40876940, "comment_id": 68969870, "body": "@Kaedys  I get the same result, if  I do a request without a <code>Query</code> when is present the <code>PageToken</code>"}, {"owner": {"reputation": 1164, "user_id": 1755300, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0d03195ad7c5f18dfae7a94cff796b5?s=128&d=identicon&r=PG", "display_name": "unmultimedio", "link": "https://stackoverflow.com/users/1755300/unmultimedio"}, "edited": false, "score": 0, "creation_date": 1480949375, "post_id": 40876940, "comment_id": 69163125, "body": "Try adding a <code>types</code> parameter. Check <a href=\"http://stackoverflow.com/questions/16826829/google-places-api-invalid-request-with-no-types-attribute\" title=\"google places api invalid request with no types attribute\">stackoverflow.com/questions/16826829/&hellip;</a> and <a href=\"https://code.google.com/p/gmaps-api-issues/issues/detail?id=5456\" rel=\"nofollow noreferrer\">code.google.com/p/gmaps-api-issues/issues/detail?id=5456</a>"}], "owner": {"reputation": 1335, "user_id": 1527290, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c90b45a5bde3f27dcffe26ef54760faf?s=128&d=identicon&r=PG", "display_name": "Cristian Chaparro A.", "link": "https://stackoverflow.com/users/1527290/cristian-chaparro-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1480969500, "creation_date": 1480458452, "last_edit_date": 1480969500, "question_id": 40876940, "link": "https://stackoverflow.com/questions/40876940/bad-request-places-api-go", "title": "Bad request places api Go", "body": "<p>I'm using <a href=\"https://github.com/googlemaps/google-maps-services-go\" rel=\"nofollow noreferrer\">google places api</a> to retrieve all results related with a  search, so this is the things that I'm doing </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Places struct {\n    ApiKey string\n    Cx string\n    c *maps.Client\n}\n\nfunc NewPlacesSearch(apiKey, cx string ) (*Places,error) {\n    c, err := maps.NewClient(maps.WithAPIKey(apiKey))\n    if err != nil {\n        return nil, err\n    }\n    p := &amp;Places{ApiKey:apiKey, Cx: cx, c:c}\n    return p,nil\n}\n\n// Search returns all the results respect a keywords\nfunc (p *Places) Search(search string) ([]*maps.PlacesSearchResponse, error) {\n    results := make([]*maps.PlacesSearchResponse,0)\n    search = url.QueryEscape(search)\n    response, err := p.makeSearch(search, \"\")\n    if err != nil {\n        return results, err\n    }\n    results = append(results,response)\n    fmt.Printf(\"%+v\\n\",response)\n    done:= false\n    if response.NextPageToken == \"\" {\n        done = true\n    }\n    for !done {\n        response, err = p.makeSearch(search, response.NextPageToken)\n        if err != nil {\n            log.Fatalf(\"fatal error: %s\", err)\n        }\n        fmt.Println(response)\n        if response.NextPageToken == \"\" {\n            done = true\n        }\n        results = append(results,response)\n    }\n    return results, nil\n}\n\nfunc (p *Places) makeSearch(search, token  string) (*maps.PlacesSearchResponse,error) {\n    r := &amp;maps.TextSearchRequest{Query: search ,PageToken:token}\n    fmt.Printf(\"%+v\\n\",r)\n    response, err:= p.c.TextSearch(context.Background(),r)\n    if err != nil {\n        return  &amp;maps.PlacesSearchResponse{}, err\n    }\n    return &amp;response,nil\n}\n</code></pre>\n\n<p>Im trying to iterate over all the pagination from google results, as you can see in first request inside of <code>Search</code> function </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>response, err := p.makeSearch(search, \"\")\n</code></pre>\n\n<p>The request is</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>{\n    Query:my+text+to+search\n    Location:&lt;nil&gt; \n    Radius:0 \n    Language: \n    MinPrice: \n    MaxPrice: \n    OpenNow:false \n    Type: \n    PageToken:\n }\n</code></pre>\n\n<p>But when I try to do the second request (inside in the loop) I get a message</p>\n\n<pre><code>fatal error: maps: INVALID_REQUEST - \n</code></pre>\n\n<p>The second request looks like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>{\n    Query:my+text+to+search\n    Location:&lt;nil&gt; \n    Radius:0 \n    Language: \n    MinPrice: \n    MaxPrice: \n    OpenNow: false \n    Type: \n    PageToken: CuQB3AAAAMy72z91....\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["image", "go", "png"], "comments": [{"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 4, "creation_date": 1480459327, "post_id": 40875724, "comment_id": 68969315, "body": "Sorry, but I think the answer is obvious - of course, you can do this. Just write your own parser and if you are a kind person, publish it at Github. If you chose Go you should be prepared that you will need to write your own wrappers, parsers, etc. as it hasn&#39;t libraries for any possible case as C++ or Java or Python. But honestly, how many languages you know that has this function built-in into standard library?"}, {"owner": {"reputation": 123, "user_id": 6085440, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ef8e54767d574352300bcf6a303f273d?s=128&d=identicon&r=PG&f=1", "display_name": "Khalil Claybon", "link": "https://stackoverflow.com/users/6085440/khalil-claybon"}, "reply_to_user": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1480605350, "post_id": 40875724, "comment_id": 69040598, "body": "@RomanR. Yes I agree sorry I am not a senior dev so before I invest time in building something out I want to make sure that it does not already exist."}], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": false, "score": 1, "last_activity_date": 1480459949, "creation_date": 1480459949, "answer_id": 40877261, "question_id": 40875724, "link": "https://stackoverflow.com/questions/40875724/parsing-png-image-with-baked-data/40877261#40877261", "title": "Parsing PNG image with baked data", "body": "<p>@Khalil,</p>\n\n<p>Looks like Go's PNG reader does not support ancillary chunks.\nCheck internals of <a href=\"https://golang.org/src/image/png/reader.go\" rel=\"nofollow noreferrer\">https://golang.org/src/image/png/reader.go</a> for line 87 and compare with <a href=\"https://www.w3.org/TR/PNG/#5ChunkOrdering\" rel=\"nofollow noreferrer\">https://www.w3.org/TR/PNG/#5ChunkOrdering</a>.</p>\n"}], "owner": {"reputation": 123, "user_id": 6085440, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ef8e54767d574352300bcf6a303f273d?s=128&d=identicon&r=PG&f=1", "display_name": "Khalil Claybon", "link": "https://stackoverflow.com/users/6085440/khalil-claybon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1480459949, "creation_date": 1480453477, "question_id": 40875724, "link": "https://stackoverflow.com/questions/40875724/parsing-png-image-with-baked-data", "title": "Parsing PNG image with baked data", "body": "<p>I know there is an image package that exist in Golang that implements encode and decode functionality, but how can I get other data from an image?. For example I am trying to get iTXt chunks from PNG images, is there any way I can do this?</p>\n"}, {"tags": ["go", "locking", "consul"], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 6737107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e3cd4f938bd4d184a70771ca352172f?s=128&d=identicon&r=PG&f=1", "display_name": "DiderDrogba344", "link": "https://stackoverflow.com/users/6737107/diderdrogba344"}, "edited": false, "score": 0, "creation_date": 1493283866, "post_id": 40876084, "comment_id": 74353973, "body": "i know this question is old but i just recently found out about it. anyways, im just curious what is the logic behind checking secondResult to be nil.  .Lock() blocks so I assumed that whenever it unblocked, you can assume that it obtained the lock. The fact that you&#39;re saying you need to check for secondResult to be not nil suggests to me that .Lock() doesn&#39;t actually block?"}, {"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "reply_to_user": {"reputation": 424, "user_id": 6737107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e3cd4f938bd4d184a70771ca352172f?s=128&d=identicon&r=PG&f=1", "display_name": "DiderDrogba344", "link": "https://stackoverflow.com/users/6737107/diderdrogba344"}, "edited": false, "score": 0, "creation_date": 1493411810, "post_id": 40876084, "comment_id": 74423224, "body": "It doesn&#39;t, it&#39;s not supposed to, you check the result only to know if you actually did acquire the lock or not."}], "tags": [], "owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "is_accepted": true, "score": 1, "last_activity_date": 1480454999, "creation_date": 1480454999, "answer_id": 40876084, "question_id": 40874598, "link": "https://stackoverflow.com/questions/40874598/two-clients-acquiring-the-same-lock-in-consul/40876084#40876084", "title": "Two clients acquiring the same lock in Consul", "body": "<p>Issue was that you have to check the channel that's returned from <code>Lock</code>, if the lock is already held the channel is <code>nil</code>:</p>\n\n<pre><code>package publicservice\n\nimport (\n    \"time\"\n    \"github.com/hashicorp/consul/api\"\n    \"github.com/hashicorp/consul/testutil\"\n    \"testing\"\n    \"github.com/xtgo/uuid\"\n)\n\nfunc TestAcquireLock(t *testing.T) {\n    consul := testutil.NewTestServer(t)\n    defer consul.Stop()\n\n    firstClient, err := api.NewClient(&amp;api.Config{\n        Address: consul.HTTPAddr,\n    })\n\n    if err != nil {\n        t.Fatalf(\"failed to create first client with %v\", err)\n    }\n\n    secondClient, err := api.NewClient(&amp;api.Config{\n        Address: consul.HTTPAddr,\n    })\n\n    if err != nil {\n        t.Fatalf(\"failed to create second client with %v\", err)\n    }\n\n    lockKey := \"sample-lock-key\"\n\n    firstLock, err := firstClient.LockOpts(&amp;api.LockOptions{\n        Key: lockKey,\n        SessionName: uuid.NewRandom().String(),\n    })\n\n    if err != nil {\n        t.Fatalf(\"failed to create first lock %v\", err)\n    }\n\n    firstResult, err := firstLock.Lock(nil)\n\n    t.Logf(\"=====&gt; result for first lock is %v\", firstResult)\n\n    if err != nil {\n        t.Fatalf(\"failed to acquire first lock %v\", err)\n    }\n\n    defer firstLock.Unlock()\n\n    secondLock, err := secondClient.LockOpts(&amp;api.LockOptions{\n        Key: lockKey,\n        LockTryOnce: true,\n        LockWaitTime: time.Second,\n        SessionName: uuid.NewRandom().String(),\n    })\n\n    if err != nil {\n        t.Fatalf(\"failed to create second lock %v\", err)\n    }\n\n    secondResult, err := secondLock.Lock(nil)\n\n    if secondResult != nil || err != nil {\n        t.Fatal(\"should not have acquired lock here\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1142, "favorite_count": 1, "accepted_answer_id": 40876084, "answer_count": 1, "score": 1, "last_activity_date": 1480454999, "creation_date": 1480449048, "question_id": 40874598, "link": "https://stackoverflow.com/questions/40874598/two-clients-acquiring-the-same-lock-in-consul", "title": "Two clients acquiring the same lock in Consul", "body": "<p>I have the following code:</p>\n\n<pre><code>package publicservice\n\nimport (\n    \"time\"\n    \"github.com/hashicorp/consul/api\"\n    \"github.com/hashicorp/consul/testutil\"\n    \"testing\"\n)\n\nfunc TestAcquireLock(t *testing.T) {\n    consul := testutil.NewTestServer(t)\n    defer consul.Stop()\n\n    firstClient, err := api.NewClient(&amp;api.Config{\n        Address: consul.HTTPAddr,\n    })\n\n    if err != nil {\n        t.Fatalf(\"failed to create first client with %v\", err)\n    }\n\n    secondClient, err := api.NewClient(&amp;api.Config{\n        Address: consul.HTTPAddr,\n    })\n\n    if err != nil {\n        t.Fatalf(\"failed to create second client with %v\", err)\n    }\n\n    lockKey := \"sample-lock-key\"\n\n    firstLock, err := firstClient.LockOpts(&amp;api.LockOptions{\n        Key: lockKey,\n    })\n\n    if err != nil {\n        t.Fatalf(\"failed to create first lock %v\", err)\n    }\n\n    _, err = firstLock.Lock(nil)\n\n    if err != nil {\n        t.Fatalf(\"failed to acquire first lock %v\", err)\n    }\n\n    defer firstLock.Unlock()\n\n    secondLock, err := secondClient.LockOpts(&amp;api.LockOptions{\n        Key: lockKey,\n        LockTryOnce: true,\n        LockWaitTime: time.Second,\n    })\n\n    if err != nil {\n        t.Fatalf(\"failed to create second lock %v\", err)\n    }\n\n    _, err = secondLock.Lock(nil)\n\n    if err == nil {\n        t.Fatal(\"should not have acquired lock here\")\n    }\n}\n</code></pre>\n\n<p>And when I run it this second lock call never fails, even if it should fail since the lock is already being held by another client as it can be seen by the logs:</p>\n\n<pre><code>2016/11/29 14:46:25 [DEBUG] http: Request GET /v1/catalog/nodes (1.115897356s) from=127.0.0.1:50492\n2016/11/29 14:46:25 [DEBUG] http: Request PUT /v1/session/create (939.436\u00b5s) from=127.0.0.1:50493\n2016/11/29 14:46:25 [DEBUG] http: Request GET /v1/kv/sample-lock-key?wait=15000ms (269.823\u00b5s) from=127.0.0.1:50493\n2016/11/29 14:46:25 [DEBUG] http: Request PUT /v1/kv/sample-lock-key?acquire=aa8fb351-6b6e-8e17-f8d9-fb265c497a9f&amp;flags=3304740253564472344 (899.564\u00b5s) from=127.0.0.1:50493\n2016/11/29 14:46:25 [DEBUG] http: Request GET /v1/kv/sample-lock-key?consistent= (112.87\u00b5s) from=127.0.0.1:50493\n2016/11/29 14:46:25 [DEBUG] http: Request PUT /v1/session/create (595.554\u00b5s) from=127.0.0.1:50494\n2016/11/29 14:46:25 [DEBUG] http: Request GET /v1/kv/sample-lock-key?wait=1000ms (38.602\u00b5s) from=127.0.0.1:50494\n2016/11/29 14:46:26 [DEBUG] http: Request GET /v1/kv/sample-lock-key?index=7&amp;wait=999ms (1.007117154s) from=127.0.0.1:50494\n2016/11/29 14:46:26 [DEBUG] http: Request PUT /v1/session/destroy/fd83b8f8-1757-d9d7-6f0e-5defaf26b886 (1.549558ms) from=127.0.0.1:50494\n2016/11/29 14:46:26 [DEBUG] http: Request PUT /v1/kv/sample-lock-key?flags=3304740253564472344&amp;release=aa8fb351-6b6e-8e17-f8d9-fb265c497a9f (1.56451ms) from=127.0.0.1:50495\n2016/11/29 14:46:26 [DEBUG] http: Request GET /v1/kv/sample-lock-key?consistent=&amp;index=7 (1.010637359s) from=127.0.0.1:50493\n</code></pre>\n\n<p>What am I missing here? Is there something else I must do to make sure the second client doesn't acquire the lock?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1480449369, "post_id": 40874559, "comment_id": 68964404, "body": "It&#39;s not optional, it&#39;s a take-all-or-nothing. Possible duplicate of <a href=\"http://stackoverflow.com/questions/28487036/return-map-like-ok-in-golang-on-normal-functions/28487270#28487270\">Return map like &#39;ok&#39; in Golang on normal functions</a>"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 1, "creation_date": 1480468895, "post_id": 40874559, "comment_id": 68972291, "body": "Too bad that Go has its own weird tricks the user can&#39;t even reproduce. It often feels like Go is &quot;cheating&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "edited": false, "score": 0, "creation_date": 1480449887, "post_id": 40874699, "comment_id": 68964670, "body": "For more detailed info, you can check out this answer: <a href=\"http://stackoverflow.com/questions/6986944/does-the-go-language-have-function-method-overloading\" title=\"does the go language have function method overloading\">stackoverflow.com/questions/6986944/&hellip;</a>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 3, "creation_date": 1480455390, "post_id": 40874699, "comment_id": 68967472, "body": "This is correct.  A number of operations in the language definition (notably, type assertions, map value retrieval, and channel receives, though there may be others I&#39;m forgetting) have both one and two value &quot;versions&quot;, with the second (optional) value indicating the &quot;status&quot; of the operation (and in the case of a type assertion, also preventing a panic if it fails).  Note, however, that any function can be called with <i>all</i> return values implicitly ignored by omission: <a href=\"https://play.golang.org/p/qdbcw5JtVK\" rel=\"nofollow noreferrer\">play.golang.org/p/qdbcw5JtVK</a>"}], "tags": [], "owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "is_accepted": true, "score": 7, "last_activity_date": 1480449454, "creation_date": 1480449454, "answer_id": 40874699, "question_id": 40874559, "link": "https://stackoverflow.com/questions/40874559/golang-why-is-catching-certain-function-return-values-optional/40874699#40874699", "title": "Golang: Why Is Catching Certain Function Return Values Optional?", "body": "<p>In fact, golang doesn't support function overloading, so you can't define different signatures for a function. But some operations from the language definition (like the channel receiver or obtaining data from a map) are 'blessed' with overloading-like behavior.</p>\n"}], "owner": {"reputation": 10064, "user_id": 1769276, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ddbbe9a629cce4be0da2d0a7a3421370?s=128&d=identicon&r=PG", "display_name": "PressingOnAlways", "link": "https://stackoverflow.com/users/1769276/pressingonalways"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 40874699, "answer_count": 1, "score": 1, "last_activity_date": 1480449454, "creation_date": 1480448918, "question_id": 40874559, "link": "https://stackoverflow.com/questions/40874559/golang-why-is-catching-certain-function-return-values-optional", "title": "Golang: Why Is Catching Certain Function Return Values Optional?", "body": "<p>Why does go sometimes allow you to call functions without catching both return values? Such as:</p>\n\n<pre><code>func TestGolang() {\n    myMap := make(map[string]string)\n    test := myMap[\"value\"]\n    // or\n    test, success := myMap[\"value\"]\n}\n</code></pre>\n\n<p>While at other times, you are required to catch all the return results and use a blank identifier if you do not want to use the value?</p>\n\n<pre><code>test := os.Stat(\"test\") // fails\ntest, _ := os.Stat(\"test\") // only way to make it work\n</code></pre>\n\n<p>I thought golang does not support different method signatures for a single function. How does the first example work? Can I implement my own functions that optionally return an error or a status flag but does not error out if the 2nd return value is not caught?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1480445676, "post_id": 40873562, "comment_id": 68962354, "body": "Can you please pose the body of the json that you&#39;re getting back as the body of <code>res</code>? Can&#39;t say whether or not your structs are defined correctly without seeing the raw json."}], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1480446250, "post_id": 40873692, "comment_id": 68962681, "body": "Probably on the money here though one can&#39;t be sure because the poster failed to include any actual json in their question!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1480445899, "creation_date": 1480445899, "answer_id": 40873692, "question_id": 40873562, "link": "https://stackoverflow.com/questions/40873562/golang-json-decoding-fails-on-array/40873692#40873692", "title": "Golang json decoding fails on Array", "body": "<p>The JSON is an array of objects. Use these types:</p>\n\n<pre><code>type one struct {   // Use struct for JSON object\n  Place string `json: \"place\"`\n  Name string `json: \"name\"`\n}\n\n...\n\nvar some []one   // Use slice for JSON array\nrd := json.NewDecoder(res.Body)\nerr := rd.Decode(&amp;some)\n</code></pre>\n\n<p>The the types in the question match this JSON structure:</p>\n\n<pre><code>{\"A\": [{\n    \"name\": \"rdj\",\n    \"place\": \"meh\",\n    \"meh\" : [\"bow\", \"blah\"]\n}]}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": false, "score": 1, "last_activity_date": 1480449575, "creation_date": 1480449575, "answer_id": 40874735, "question_id": 40873562, "link": "https://stackoverflow.com/questions/40873562/golang-json-decoding-fails-on-array/40874735#40874735", "title": "Golang json decoding fails on Array", "body": "<p>@rickydj,</p>\n\n<ol>\n<li><p>If you need to have \"first\" as a separate type:\n<code>\ntype first []one\n</code></p></li>\n<li><p>If you do not care about having \"first\" as a separate type, just cut down to \n<code>\nvar some []one\n</code>\nas @Mellow Marmot suggested above.</p></li>\n</ol>\n"}], "owner": {"reputation": 562, "user_id": 3065652, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0b1e326bd6eb4decfad5266675ec3022?s=128&d=identicon&r=PG&f=1", "display_name": "rickydj", "link": "https://stackoverflow.com/users/3065652/rickydj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1480449575, "creation_date": 1480445475, "question_id": 40873562, "link": "https://stackoverflow.com/questions/40873562/golang-json-decoding-fails-on-array", "title": "Golang json decoding fails on Array", "body": "<p>I have an object like:</p>\n\n<pre><code>   a = [{\n        \"name\": \"rdj\",\n        \"place\": \"meh\",\n        \"meh\" : [\"bow\", \"blah\"]\n    }]\n</code></pre>\n\n<p>I defined a struct like:</p>\n\n<pre><code>type first struct {\n    A []one\n}\n\ntype one struct {\n    Place string `json: \"place\"`\n    Name string `json: \"name\"`\n}\n</code></pre>\n\n<p>when I use the same in code like:</p>\n\n<pre><code>func main() {\n    res, _ := http.Get(\"http://127.0.0.1:8080/sample/\")\n    defer res.Body.Close()\n    var some first\n    rd := json.NewDecoder(res.Body)\n    err := rd.Decode(&amp;some)\n    errorme(err)\n    fmt.Printf(\"%+v\\n\", some)\n}\n</code></pre>\n\n<p>I get the below error:</p>\n\n<pre><code>panic: json: cannot unmarshal array into Go value of type main.first\n</code></pre>\n\n<p>My understanding is:</p>\n\n<p><code>type first</code> defines the array and within that array is data structure defined in <code>type one</code>. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 10064, "user_id": 1769276, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ddbbe9a629cce4be0da2d0a7a3421370?s=128&d=identicon&r=PG", "display_name": "PressingOnAlways", "link": "https://stackoverflow.com/users/1769276/pressingonalways"}, "edited": false, "score": 0, "creation_date": 1480442136, "post_id": 40872513, "comment_id": 68960373, "body": "Thanks, though it is still 2 lines. This seems inconsistent with the behavior where you can have 1 variable already defined and 1 variable not defined in <code>undefined, defined := MultipleReturnCall()</code>. Quirks of Go!"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 10064, "user_id": 1769276, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ddbbe9a629cce4be0da2d0a7a3421370?s=128&d=identicon&r=PG", "display_name": "PressingOnAlways", "link": "https://stackoverflow.com/users/1769276/pressingonalways"}, "edited": false, "score": 2, "creation_date": 1480442304, "post_id": 40872513, "comment_id": 68960457, "body": "@PressingOnAlways: If you think this was just an oversight by the spec authors, I would encourage you to <a href=\"https://github.com/golang/proposal\" rel=\"nofollow noreferrer\">submit a proposal</a> for the change."}, {"owner": {"reputation": 735, "user_id": 7233489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vadH0.jpg?s=128&g=1", "display_name": "Paul Buis", "link": "https://stackoverflow.com/users/7233489/paul-buis"}, "edited": false, "score": 0, "creation_date": 1480593278, "post_id": 40872513, "comment_id": 69032219, "body": "I&#39;m just happy it doesn&#39;t require <i>3</i> lines!"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1480442137, "last_edit_date": 1480442137, "creation_date": 1480441931, "answer_id": 40872513, "question_id": 40872306, "link": "https://stackoverflow.com/questions/40872306/how-do-you-assign-a-struct-field-variable-in-multiple-assignment-statement/40872513#40872513", "title": "How Do You Assign A Struct Field Variable In Multiple Assignment Statement", "body": "<p><a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">Short variable declaration</a> do not support assigning struct receiver properties; they are omitted from the spec definition:</p>\n\n<blockquote>\n  <p>Unlike regular variable declarations, a short variable declaration may redeclare variables provided they were originally declared earlier in the same block (or the parameter lists if the block is the function body) with the same type, and at least one of the non-blank variables is new.</p>\n</blockquote>\n\n<p>The fix is to define <code>exists</code> before the assignment and not use short variable declarations:</p>\n\n<pre><code>type TestMultipleReturns struct {\n    value string\n}\n\nfunc (t *TestMultipleReturns) TestSomething() {\n    someMap := make(map[string]string)\n    someMap[\"Test\"] = \"world\"\n    var exists bool\n    t.value, exists = someMap[\"doesnotexist\"]\n\n    if exists == false {\n        fmt.Println(\"t.value is not set.\")\n    } else {\n        fmt.Println(t.value)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 10064, "user_id": 1769276, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ddbbe9a629cce4be0da2d0a7a3421370?s=128&d=identicon&r=PG", "display_name": "PressingOnAlways", "link": "https://stackoverflow.com/users/1769276/pressingonalways"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2663, "favorite_count": 0, "accepted_answer_id": 40872513, "answer_count": 1, "score": 2, "last_activity_date": 1480442970, "creation_date": 1480441340, "last_edit_date": 1480442970, "question_id": 40872306, "link": "https://stackoverflow.com/questions/40872306/how-do-you-assign-a-struct-field-variable-in-multiple-assignment-statement", "title": "How Do You Assign A Struct Field Variable In Multiple Assignment Statement", "body": "<p>How do you assign a struct field variable in a multiple assignment statement? Please refer to code below.</p>\n\n<pre><code>type TestMultipleReturns struct {\n    value string\n}\n\nfunc (t *TestMultipleReturns) TestSomething() {\n    someMap := make(map[string]string)\n    someMap[\"Test\"] = \"world\"\n    t.value, exists := someMap[\"doesnotexist\"] // fails\n\n    // works, but do I really need a 2nd line?\n    tmp, exists := someMap[\"doesnotexist\"] \n    t.value = tmp\n\n    if exists == false {\n        fmt.Println(\"t.value is not set.\")\n    } else {\n        fmt.Println(t.value)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480436830, "post_id": 40870782, "comment_id": 68957281, "body": "yes, a &quot;blocking profile&quot;: <a href=\"https://golang.org/pkg/net/http/pprof/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/pprof</a>, <a href=\"https://godoc.org/github.com/pkg/profile\" rel=\"nofollow noreferrer\">godoc.org/github.com/pkg/profile</a>, <a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"nofollow noreferrer\">software.intel.com/en-us/blogs/2014/05/10/&hellip;</a>,"}, {"owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480440340, "post_id": 40870782, "comment_id": 68959499, "body": "interesting... I am using it as /debug/pprof/block?debug=2 but does not seem to show the locks that associate to the semaquire lock references. I can&#39;t seem to find a useful document that explains how to read that output"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1480441518, "post_id": 40870782, "comment_id": 68960080, "body": "Oh, I misunderstood what you&#39;re looking for. You won&#39;t really be able to get that information from a profile, because pprof is only a sampling profiler. You may be able to find the answer with the execution tracer (<code>runtime&#47;trace</code>, or <code>-trace</code> flag in <code>go test</code>). Though in this situation, I&#39;ve resorted to just annotating each Lock/Unlock operation."}], "owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480436628, "creation_date": 1480436628, "question_id": 40870782, "link": "https://stackoverflow.com/questions/40870782/pprof-does-not-reveal-what-is-holding-the-lock", "title": "pprof does not reveal what is holding the lock", "body": "<p>While I find that Go's pprof is very helpful to report lock issues through observing the \"semaquire\" waits, it appears to me it is not helping to report \"who/what\" is holding the lock in question. </p>\n\n<p>For example, the following pprof output reveals various semaquire waits on lock sync.(*Mutex).Lock(0xbf038c) , but nothing indicates who is holding that lock and what it's stack trace was. </p>\n\n<p>Pasted pprof output:\n<a href=\"https://justpaste.it/10we7\" rel=\"nofollow noreferrer\">https://justpaste.it/10we7</a></p>\n\n<p>Are there other means to obtain more precide details from pprof on this ? I am accessing this from the http debug such as </p>\n\n<p>\"<a href=\"http://localhost:8080/debug/pprof/goroutine?debug=2\" rel=\"nofollow noreferrer\">http://localhost:8080/debug/pprof/goroutine?debug=2</a>\"</p>\n"}, {"tags": ["encryption", "go", "rsa"], "comments": [{"owner": {"reputation": 261, "user_id": 1732600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNkL2.jpg?s=128&g=1", "display_name": "Brij", "link": "https://stackoverflow.com/users/1732600/brij"}, "edited": false, "score": 1, "creation_date": 1480441880, "post_id": 40870178, "comment_id": 68960250, "body": "what exactly you mean to say..please use English to make it more understandable."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1480506338, "post_id": 40870178, "comment_id": 68988833, "body": "I think we should re-open this question: the language is not too good, but 1) the author is supposedly not a native speaker; 2) the essence of the question is discernible and can be formulated as &quot;Why does the <code>crypto&#47;rsa</code> package of Go only support OAEP and PKCS#1 padding schemes and does not allow using RSA operations on data with no padding?&quot;. The answer, I think, may be due to the reasons outlined <a href=\"http://crypto.stackexchange.com/a/15184\">here</a> (which basically amount to &quot;DON&#39;T DO THAT&quot;) but still the OP might need to deal with legacy data/protocol and their concern is valid."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1480506466, "post_id": 40870178, "comment_id": 68988911, "body": "@ohko, you might want to file a bug in the <a href=\"https://github.com/golang/go/issues\" rel=\"nofollow noreferrer\">project&#39;s bugtracker</a>. If you will do this, please make sure to 1) Try to formulate why you need support for RSA operations with no padding -- don&#39;t just post there a link to this very discussion; 2) Please post a link to the issue you will have filed here (as a comment) -- for future reference."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480514422, "post_id": 40870178, "comment_id": 68994187, "body": "I doubt this would get added to the stdlib since its usage is rather dubious. I can post an answer now if this is reopened, since this just entails a single modulo exponent operation. The entire function could be copied out of the standard library if one wants full blinding and usage of the precomputed CRT values."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5273494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbfbf892bbb5a830f7e7a1ff1f3ce79?s=128&d=identicon&r=PG&f=1", "display_name": "ohko", "link": "https://stackoverflow.com/users/5273494/ohko"}, "edited": false, "score": 0, "creation_date": 1482000360, "post_id": 40915300, "comment_id": 69603013, "body": "Thank you very much! Done!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1480687424, "last_edit_date": 1492087698, "creation_date": 1480608472, "answer_id": 40915300, "question_id": 40870178, "link": "https://stackoverflow.com/questions/40870178/golang-rsa-decrypt-no-padding/40915300#40915300", "title": "golang rsa decrypt no padding?", "body": "<p>Decrypting a ciphertext block using rsa with no padding is a single modulo exponent operation. </p>\n\n<pre><code>c := new(big.Int).SetBytes(cipherText)\nplainText := c.Exp(c, privateKey.D, privateKey.N).Bytes()\n</code></pre>\n\n<p>A full example using your input data is here: <a href=\"https://play.golang.org/p/CgLYgLR61t\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CgLYgLR61t</a></p>\n\n<p>If you want a full version of the decryption function, with side-channel blinding and using precomputed CRT values for faster performance, you can copy the <code>decrypt</code> function from the <code>crypto/rsa/rsa.go</code> source.</p>\n\n<p>If you have the choice, you should not be using rsa in this manner. There is a good <a href=\"https://crypto.stackexchange.com/a/15184\">discussion on the Crypto StackExchange site</a> explaining the details and drawbacks of using this method. </p>\n"}, {"tags": [], "owner": {"reputation": 4120, "user_id": 1099314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jKm3r.png?s=128&g=1", "display_name": "Ninh Pham", "link": "https://stackoverflow.com/users/1099314/ninh-pham"}, "is_accepted": false, "score": 0, "last_activity_date": 1547279080, "creation_date": 1547279080, "answer_id": 54157684, "question_id": 40870178, "link": "https://stackoverflow.com/questions/40870178/golang-rsa-decrypt-no-padding/54157684#54157684", "title": "golang rsa decrypt no padding?", "body": "<p>Not actually answer the question, but I put this here for someone who are looking for encrypting a plain text using rsa with no padding.</p>\n\n<pre><code>var publicKey *rsa.PublicKey\n\n// ...\n// ...\n\nc := new(big.Int).SetBytes([]byte(text))\n\nencryptedBytes := c.Exp(c, big.NewInt(int64(publicKey.E)), publicKey.N).Bytes()\nencryptedBase64 := base64.StdEncoding.EncodeToString(encryptedBytes)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5273494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbfbf892bbb5a830f7e7a1ff1f3ce79?s=128&d=identicon&r=PG&f=1", "display_name": "ohko", "link": "https://stackoverflow.com/users/5273494/ohko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1619, "favorite_count": 0, "accepted_answer_id": 40915300, "answer_count": 2, "score": -2, "last_activity_date": 1547279080, "creation_date": 1480434924, "last_edit_date": 1480514725, "question_id": 40870178, "link": "https://stackoverflow.com/questions/40870178/golang-rsa-decrypt-no-padding", "title": "golang rsa decrypt no padding?", "body": "<p>Golang rsa does not have NO_PADDING?<br>\nBut openssl is ok.\nFor encrypted data docking and other language, the encrypted data with Golang cannot decrypt normally, but the use of PHP and Openssl can be normal, later found like Golang does not support NO_PADDING decryption, seems to only PKCS1.<br>\nOpenssl increase the parameter - raw can normal decryption.The private key is above, a cipher and decrypted correct value.<br>\nCan someone help me to look at how to solve?  </p>\n\n<pre><code>$ cat private.pem  \n-----BEGIN RSA PRIVATE KEY-----  \nMIIBOgIBAAJBANJS/xu+NtmDqobnhCdLjWk46aYbBk/mQrLcozAIbQLFG2mgkrxf  \nB5+CgtISKpKfmRfCO2NhceK+YedaMMBUxn8CAQMCQQCMN1S9KXnmV8cEmlgaMl5G  \nJfEZZ1mKmYHMkxd1WvNXLNuke9ntKwti8zG1lAFcOVHnm/uYsNdua+lvvQlEgBUL  \nAiEA/c8ezGaNUFwEAltwTEFtFItT5PyOXlWIdPAZ7j160lkCIQDUI8f/chEmLxG1  \n5kPcRtyJsQRdAcnQZ5QOz6S0nBnUlwIhAKk0vzLvCOA9WAGSSt2A82MHjUNTCZQ5  \nBaNKu/Qo/Iw7AiEAjW0v/6FgxB9hI+7X6C89sSCtk1aGiu+4Cd/DIxK74w8CIB4q  \nrA1k247JrqKTGlqSHVr1Ta+h3BPbwFKCi5CiDOjV  \n-----END RSA PRIVATE KEY-----  \n\n$ xxd data.txt  \n00000000: 6d4b 5dab 6d64 45e1 e4cb 0ea8 20df b724  mK].mdE..... ..$  \n00000010: cfe5 db3e 75c4 e80e 2337 4f08 1b36 87b4  ...&gt;u...#7O..6..  \n00000020: 7550 47d4 ed60 576a a160 2d01 3cf7 4c50  uPG..`Wj.`-.&lt;.LP  \n00000030: 7e44 6432 1f9d cfe2 2e9f 4f89 f815 ae01  ~Dd2......O.....  \n\n$ base64 -i data.txt  \nbUtdq21kReHkyw6oIN+3JM/l2z51xOgOIzdPCBs2h7R1UEfU7WBXaqFgLQE890xQfkRkMh+dz+Iun0+J+BWuAQ==  \n\n$ cat data.txt | openssl rsautl -decrypt -inkey private.pem -raw  \nqYnYKT2mxuXR5XB615gOenqxOnIUjWs7\n</code></pre>\n"}, {"tags": ["heroku", "go", "import", "revel"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1480444600, "post_id": 40869842, "comment_id": 68961683, "body": "don t use relative path imports. Use package path <code>absolute_package_path.substr($GOPATH.length)</code>"}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1480501502, "post_id": 40869842, "comment_id": 68985673, "body": "Thanks @mh-cbon but... I don&#39;t understand you so well. I tried to use absolute path, or that I think (how you can see on my editing).  For example using <code>import(&quot;base&#47;app&#47;models&quot;)</code> or <code>import(&quot;base-test&#47;app&#47;models&quot;)</code>.  Can you be a litle more concrete, please??"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1480515368, "post_id": 40869842, "comment_id": 68994901, "body": "all user package must exist within GOPATH. Assuming you move the first <code>app</code> under <code>.go&#47;src</code>, controllers package path would be <code>app&#47;app&#47;controllers</code>."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1480515404, "post_id": 40869842, "comment_id": 68994936, "body": "so yeah that s right, should have been <code>absolute_package_path.substr($GOPATH.length + &#39;src&#47;&#39;.length)</code>"}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1480516196, "post_id": 40869842, "comment_id": 68995511, "body": "Hi @mh-cbon. Sorry, but I continue without understand. If I type absolute_package_path I get a compilation error, the same with $GOPATH. So, I can&#39;t make <code>import(absolute_package_path.substr($GOPATH.length + &#39;src&#47;&#39;.length))</code>"}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1480517476, "post_id": 40869842, "comment_id": 68996430, "body": "Ok!! Done. Thanks @mh-cbon, every advise is wellcome."}], "answers": [{"tags": [], "owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "is_accepted": false, "score": 0, "last_activity_date": 1480518004, "creation_date": 1480518004, "answer_id": 40891545, "question_id": 40869842, "link": "https://stackoverflow.com/questions/40869842/revel-app-with-local-packages-in-heroku/40891545#40891545", "title": "Revel app with local packages in heroku", "body": "<p>Ok!!! done!!  </p>\n\n<p>Finally, the old name of the project was generating a problem. It seems that when I change the name of the heroku app, heroku doesn't change the name of the folder when it will be compiled... AND I need change too the content of the .godir file and set it as <code>base-test</code> (the old name).  </p>\n\n<p>So now the imports I have looks like: <code>import(\"base-test/app/models\")</code>.</p>\n\n<p>Thank you everyone.</p>\n"}], "owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480518004, "creation_date": 1480433988, "last_edit_date": 1480500925, "question_id": 40869842, "link": "https://stackoverflow.com/questions/40869842/revel-app-with-local-packages-in-heroku", "title": "Revel app with local packages in heroku", "body": "<p>I am trying to deploy a revel app in heroku, in which I have this folder structure:</p>\n\n<pre><code>+Base\n    +app\n        +controllers\n            -app.go\n        +views\n        +models\n            -user.go\n        +routes\n    +conf\n    +public\n    +test\n    .godir\n</code></pre>\n\n<p>In <code>app.go</code> I try to include models and routes doing this:</p>\n\n<pre><code>import(\"base/app/models\")\n</code></pre>\n\n<p>I am able to run app in local, and after I can use <code>models.User</code>. I had tried to make a lot of ways to import these local packages in heroku:</p>\n\n<pre><code>import(\"../models\")\nimport(\"../models/user\")\nimport(\"./app/models\")\nimport(\"./base/app/models\")\n</code></pre>\n\n<p>I don't remember now all attempts, but I am trying it for a long time and I don't know ho to do.  </p>\n\n<p>I am using locally go 1.6, and 1.4 when I push. And this is the trace that appears when I run <code>git push heroku master</code></p>\n\n<pre><code>Counting objects: 93, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (86/86), done.\nWriting objects: 100% (93/93), 11.68 KiB | 0 bytes/s, done.\nTotal 93 (delta 50), reused 0 (delta 0)\nremote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----&gt; Revel app detected\nremote: -----&gt; Using go1.4\nremote: -----&gt; Running: go get -tags heroku ./...\nremote: can't load package: /tmp/build_02574263f0810eec437968b2e73f635d/.go/src/base/app/controllers/gorp.go:10:2: local import \"../models\" in non-local package\nremote:  !     Push rejected, failed to compile Revel app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: !   Push rejected to ndc-console.\nremote: \nTo https://git.heroku.com/ndc-console.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'https://git.heroku.com/ndc-console.git'\n</code></pre>\n\n<p>It happens using <code>import(\"base/app/models\")</code>.  </p>\n\n<p>Any solution?? Thank you.</p>\n\n<p><strong>EDIT</strong>  </p>\n\n<p>I log into heroku bash (running <code>heroku run bash</code>) and I see the folder structure, and it is something like:</p>\n\n<pre><code>bin\ndev\nmore...\napp /*This is the base folder*/\n    app\n        controllers\n        views\n        models\n        routes\n    config\n    public\n    .go /*this is the GOPATH*/\n\n        src\n            github.com\n            golang.org\n            gopkg.in\n            base-test /* This name is because I change the original name, from base-test to base... */\n            /* IS IT IMPORTANT? */\n            /* Inside this folder the app is duplicated */\n</code></pre>\n\n<p>In this way I tried too <code>import(\"base-test/app/models\")</code> and too including all path from root (trying absurd things).  </p>\n\n<p>I hope it helps to find a solution. Thanks.</p>\n"}, {"tags": ["pointers", "go", "reflection", "struct"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1480434816, "post_id": 40868795, "comment_id": 68955806, "body": "Why not just use <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\"><code>sqlx</code></a>?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1480436727, "post_id": 40868795, "comment_id": 68957204, "body": "You can get fields via reflection using <a href=\"https://golang.org/pkg/reflect/#Value.Field\" rel=\"nofollow noreferrer\">golang.org/pkg/reflect/#Value.Field</a>.  But ya, <code>sqlx</code> would do it all for you.  Its <code>Get()</code> (and <code>Select()</code>) method let you just hand an arbitrary structure (or slice of structures) to the query and it&#39;ll fill the struct fields by tag or name automagically."}, {"owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "edited": false, "score": 0, "creation_date": 1480438512, "post_id": 40868795, "comment_id": 68958406, "body": "this might help you - <a href=\"http://stackoverflow.com/a/18927729/3563197\">stackoverflow.com/a/18927729/3563197</a>"}, {"owner": {"reputation": 363, "user_id": 5470637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UGaTV.gif?s=128&g=1", "display_name": "lambher", "link": "https://stackoverflow.com/users/5470637/lambher"}, "edited": false, "score": 0, "creation_date": 1480438664, "post_id": 40868795, "comment_id": 68958511, "body": "Okey sqlx is perfect, it&#39;s the kind of library I was looking for !"}], "owner": {"reputation": 363, "user_id": 5470637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UGaTV.gif?s=128&g=1", "display_name": "lambher", "link": "https://stackoverflow.com/users/5470637/lambher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480583154, "creation_date": 1480430918, "last_edit_date": 1480583154, "question_id": 40868795, "link": "https://stackoverflow.com/questions/40868795/is-there-a-more-generic-way-to-do-this-function", "title": "Is there a more generic way to do this function?", "body": "<p>I would like to make this function more generic (with a \"for\")</p>\n\n<pre><code>func (e example) ScanRow(rows *sql.Rows) (example, error) {\n    val := reflect.ValueOf(e)\n    test := make([]interface{}, val.Type().NumField())\n\n    test[0] = &amp;e.Id\n    test[1] = &amp;e.CreatedAt\n    test[2] = &amp;e.Text\n    test[3] = &amp;e.AuthorId\n    test[4] = &amp;e.CategoryId\n\n    if err := rows.Scan(test[0], test[1], test[2], test[3], test[4]); err != nil {\n        return e, err\n    }\n    return e, nil\n}\n</code></pre>\n\n<p>Here is the struct example:</p>\n\n<pre><code>type example struct {\n    Id      int `json:\"id\"`\n    CreatedAt   string `json:\"created_at\"`\n    Text        string `json:\"text\"`\n    AuthorId    int `json:\"author_id\"`\n    CategoryId  int `json:\"category_id\"`\n}\n</code></pre>\n\n<p>Do you think it's possible ? I am trying to find a way to do that but i am lost...</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1480430680, "post_id": 40868340, "comment_id": 68952860, "body": "See <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1480430806, "post_id": 40868340, "comment_id": 68952947, "body": "BTW: It is perfectly fine to keep utility functions in a file <code>utilities.go</code> and still under <code>package main</code>. Packages in Go typically consist of several files and often several type."}], "answers": [{"comments": [{"owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480430420, "post_id": 40868503, "comment_id": 68952662, "body": "Do you actually mean move the &quot;utilities.go&quot; to another folder? It looks unwieldy to have a folder holding nothing but a <code>main.go</code> file."}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "reply_to_user": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480430670, "post_id": 40868503, "comment_id": 68952854, "body": "utilities.go is not a package it&#39;s a file. what matters is the package name in the files , you just cannot have a &quot;hello&quot; and a &quot;main&quot; package in the same folder and build your code, that&#39;s all, this is not an opinion, this is how Go works."}, {"owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480431754, "post_id": 40868503, "comment_id": 68953642, "body": "I think I can put <code>package main</code> into the <code>utilities.go</code> and still keep it in the same folder as <code>main.go</code>. Go will still find the entry point by the name <code>main</code>."}, {"owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480477542, "post_id": 40868503, "comment_id": 68974500, "body": "It turns out the built-in <code>cmd\\cgo</code> package does place <code>package main</code> for all the <code>*.go</code> files in the same package folder."}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "reply_to_user": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480525029, "post_id": 40868503, "comment_id": 69001824, "body": "doesn&#39;t really change your issue. Only one package in one folder. I doesn&#39;t matter what the name of the package is. You can&#39;t have 2 packages in the same folder."}], "tags": [], "owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "is_accepted": false, "score": 3, "last_activity_date": 1480432131, "last_edit_date": 1480432131, "creation_date": 1480430081, "answer_id": 40868503, "question_id": 40868340, "link": "https://stackoverflow.com/questions/40868340/how-to-specify-the-package-name-if-multiple-files-exist-in-the-package-folder-an/40868503#40868503", "title": "How to specify the package name if multiple files exist in the package folder and one file contains the &quot;package main&quot;?", "body": "<p>go files in the same package AKA folder must have the same package name. The only exception are tests that can have a _test extension. The rule is 1 folder , 1 package therefore the same package name for all go files in the same folder.</p>\n\n<p>The answer is yes , move the \"hello\" package files to their own folder or , use the same package name for all files in the same directory.</p>\n"}], "owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4056, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1480483656, "creation_date": 1480429674, "last_edit_date": 1480483656, "question_id": 40868340, "link": "https://stackoverflow.com/questions/40868340/how-to-specify-the-package-name-if-multiple-files-exist-in-the-package-folder-an", "title": "How to specify the package name if multiple files exist in the package folder and one file contains the &quot;package main&quot;?", "body": "<p>Suppose I have a package folder as below:</p>\n\n<pre><code>hello\n  |---main.go\n  |---utilities.go\n</code></pre>\n\n<p>In the <code>main.go</code>, I have:</p>\n\n<pre><code>package main\n</code></pre>\n\n<p>In the <code>utilities.go</code>, I have:</p>\n\n<pre><code>package hello\n</code></pre>\n\n<p>I did this because:</p>\n\n<ul>\n<li>I don't want to put all the utilities into the single <code>main.go</code> file. </li>\n<li>And the utilities are only used by this package so I don't want to put it out of the <code>hello</code> folder.</li>\n</ul>\n\n<p>But when I run <code>go list hello</code>, it gives me this:</p>\n\n<blockquote>\n  <p>can't load package: package hello: found packages main (main.go) and\n  hello (utilities.go) in E:\\Workbench\\Go\\src\\hello</p>\n</blockquote>\n\n<p>Then I remove the <code>utilities.go</code> and tried the <code>go list hello</code> again with only <code>main.go</code>. It gives me this:</p>\n\n<blockquote>\n  <p>hello</p>\n</blockquote>\n\n<p>So do I have to move all the utilities to another package folder? </p>\n\n<p>Do I have to keep only the single <code>main.go</code> in the hello package folder because it seems it doesn't get along well with other package names?</p>\n\n<h2>ADD 1</h2>\n\n<p>An useful ref: <a href=\"http://thenewstack.io/understanding-golang-packages/\" rel=\"nofollow noreferrer\">http://thenewstack.io/understanding-golang-packages/</a></p>\n\n<h2>ADD 2</h2>\n\n<p>After a few brief experiments, I guess the <code>import yyy</code> decides the link search path while the <code>package xxx</code> declaration decides the exported symbol name in the compiled <code>.a</code> file.</p>\n\n<p>Because I noticed these facts:</p>\n\n<ul>\n<li>The <code>package xxx</code> declaration doesn't have to be the same as the containing package folder name, say <code>yyy</code>.</li>\n<li>But the <code>import yyy</code> declaration must use the package folder path <code>yyy</code>.</li>\n<li>When using a symbol from a package, we must still use the <code>xxx.Symbol</code> rather than <code>yyy.Symbol</code>.</li>\n</ul>\n\n<h2>ADD 3</h2>\n\n<p>To confirm my guess in ADD 2, I did this:</p>\n\n<p>(pkg1\\file1.go)</p>\n\n<pre><code>package pkg2 // I deliberately use a different pkg name \"pkg2\" rather than the folder name \"pkg1\"\n\nimport \"fmt\"\n\nfunc FA() {\n    fmt.Println(\"in the pkg2.FA\")\n}\n</code></pre>\n\n<p>(cmd1\\main.go)</p>\n\n<pre><code>package main\n\nimport \"pkg1\"\n\nfunc main() {\n    pkg2.FA() //here, the FA is referenced via \"pkg2\" rather than the \"pkg1\".\n}\n</code></pre>\n\n<p>The above 2 files can compile and run.</p>\n\n<p>But if I changed to this:</p>\n\n<p>(cmd1\\main.go)</p>\n\n<pre><code>package main\n\nimport \"pkg1\"\n\nfunc main() {\n    pkg1.FA() //here, the FA is referenced via \"pkg1\" as in the import statement. Should work, isn't it?\n}\n</code></pre>\n\n<p>This will give:</p>\n\n<blockquote>\n  <p>....\\src\\cmd1\\main.go:3: imported and not used: \"pkg1\" <strong>as pkg2</strong></p>\n  \n  <p>....\\src\\cmd1\\main.go:6: undefined: pkg1 in pkg1.FA</p>\n</blockquote>\n\n<p>And to double confirm, I checked the compiled <code>pkg1.a</code> file with <code>go tool nm pkg1.a</code>, <strong>I didn't see package name affects the exported symbols</strong>. (btw, the GNU nm tool seems not be able to recognize the golang <code>.a</code> file format.)</p>\n\n<pre><code>     U\n 515 T %22%22.FA   &lt;========== this is my fuction FA\n 67b R %22%22.FA\u00b7f &lt;========== this is my fuction FA\n 5eb T %22%22.init\n 67b B %22%22.initdone\u00b7\n 683 R %22%22.init\u00b7f\n     U fmt.Println\n     U fmt.init\n 673 R gclocals\u00b733cdeccccebe80329f1fdbee7f5874cb\n 66b R gclocals\u00b769c1753bd5f81501d95132d08af04464\n 65b R gclocals\u00b7e29b39dba2f7b47ee8f21f123fdd2633\n 64d R go.string.\"in the pkg2.FA\"\n 63d R go.string.hdr.\"in the pkg2.FA\"\n 7d2 R go.typelink.*[1]interface {}\n 796 R go.typelink.[1]interface {}\n 737 R go.typelink.[]interface {}\n     U runtime.algarray\n     U runtime.convT2E\n 6ec R runtime.gcbits.01\n 68b R runtime.gcbits.03\n     U runtime.morestack_noctxt\n     U runtime.throwinit\n 79a R type.*[1]interface {}\n 7d6 R type..importpath.fmt.\n 73b R type..namedata.*[1]interface {}.\n 6ed R type..namedata.*[]interface {}.\n 68c R type..namedata.*interface {}.\n 74e R type.[1]interface {}\n 6ff R type.[]interface {}\n 69c R type.interface {}\n     U type.string\n</code></pre>\n\n<p>So the conclusion so far is:</p>\n\n<p>When the declared package name is <strong>different</strong> from the package folder name, package declaration will be used as an alternate name of the package. </p>\n\n<p>Equivalent to this, but implicitly :</p>\n\n<pre><code>import pkg2 \"pkg1\"\n</code></pre>\n\n<p>And btw, since the package declaration is not reflected in the compiled <code>.a</code> file, I guess the golang compilation requires the presence of <code>.go</code> file.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1480427072, "post_id": 40866811, "comment_id": 68950179, "body": "Did you try it? Did it work? If not: What did the compiler tell you?"}, {"owner": {"reputation": 762, "user_id": 4831896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xkeNa.jpg?s=128&g=1", "display_name": "Aljoscha", "link": "https://stackoverflow.com/users/4831896/aljoscha"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1480431862, "post_id": 40866811, "comment_id": 68953711, "body": "Problem solved. The program terminated with a runtime error because of a nil pointer dereference. Therefore I have concluded that the passing of the function is wrong but the error was an assignment in a non-pointer method receiver before that. Sorry for your waste of time. :forgiveme:"}], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 3, "last_activity_date": 1480598053, "last_edit_date": 1480598053, "creation_date": 1480426426, "answer_id": 40867230, "question_id": 40866811, "link": "https://stackoverflow.com/questions/40866811/pass-method-on-struct-as-callback-in-golang/40867230#40867230", "title": "Pass method on struct as callback in golang", "body": "<p>Golang has first class functions, you can pass them as parameters <a href=\"https://golang.org/doc/codewalk/functions/\" rel=\"nofollow noreferrer\">https://golang.org/doc/codewalk/functions/</a>\nYou may also want to look at this <a href=\"https://dave.cheney.net/2016/11/13/do-not-fear-first-class-functions\" rel=\"nofollow noreferrer\">https://dave.cheney.net/2016/11/13/do-not-fear-first-class-functions</a></p>\n"}, {"tags": [], "owner": {"reputation": 52116, "user_id": 197788, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/851acbab08553d1f7aa3eecad17f6aa9?s=128&d=identicon&r=PG", "display_name": "Ken Bloom", "link": "https://stackoverflow.com/users/197788/ken-bloom"}, "is_accepted": true, "score": 1, "last_activity_date": 1480427099, "creation_date": 1480427099, "answer_id": 40867475, "question_id": 40866811, "link": "https://stackoverflow.com/questions/40866811/pass-method-on-struct-as-callback-in-golang/40867475#40867475", "title": "Pass method on struct as callback in golang", "body": "<p>What you've written appears to be correct. </p>\n"}], "owner": {"reputation": 762, "user_id": 4831896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xkeNa.jpg?s=128&g=1", "display_name": "Aljoscha", "link": "https://stackoverflow.com/users/4831896/aljoscha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2502, "favorite_count": 0, "accepted_answer_id": 40867475, "answer_count": 2, "score": 0, "last_activity_date": 1480598053, "creation_date": 1480425201, "last_edit_date": 1480432297, "question_id": 40866811, "link": "https://stackoverflow.com/questions/40866811/pass-method-on-struct-as-callback-in-golang", "title": "Pass method on struct as callback in golang", "body": "<p>Is it possible to pass a method on a struct as a callback function in golang ?  </p>\n\n<p>E.g. Register a message handler :</p>\n\n<pre><code>func (mc MQTTClient) MessageHandler(client MQTT.Client, msg MQTT.Message) {\n   fmt.Printf(\"TOPIC: %s\\n\", msg.Topic())\n   fmt.Printf(\"MSG: %s\\n\", msg.Payload())\n}\n\nfunc (mc MQTTClient) AddMessageHandler(){\n  //..\n  //subscribe to the topic /go-mqtt/sample and request messages to be delivered\n  //at a maximum qos of zero, wait for the receipt to confirm the subscription\n\n  if token := c.Subscribe(\"go-mqtt/sample\", 0, mc.MessageHandler); token.Wait() &amp;&amp; token.Error() != nil {\n                    fmt.Println(token.Error())\n                    os.Exit(1)\n  }\n}\n</code></pre>\n\n<p>Thank you very much !</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 1732600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNkL2.jpg?s=128&g=1", "display_name": "Brij", "link": "https://stackoverflow.com/users/1732600/brij"}, "is_accepted": true, "score": 0, "last_activity_date": 1480425700, "creation_date": 1480425700, "answer_id": 40866995, "question_id": 40866718, "link": "https://stackoverflow.com/questions/40866718/configuration-file-using-viper-giving-null-value-in-go/40866995#40866995", "title": "Configuration file using viper giving null value in GO", "body": "<p>better to check this <a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\">https://github.com/spf13/viper</a> the code snippet looks good ..may be there can be issue with $GOPATH and $GOHOME</p>\n\n<p>and your config.yaml file is not proper double quotes are missing. </p>\n\n<pre><code>API_TOKEN : \"sdsaxxxdfds123\"\n</code></pre>\n\n<p>It has to be like this, hope this resolves your problem. </p>\n"}], "owner": {"reputation": 11, "user_id": 5628873, "user_type": "registered", "profile_image": "https://graph.facebook.com/780085318784929/picture?type=large", "display_name": "Rajeev Paul", "link": "https://stackoverflow.com/users/5628873/rajeev-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 40866995, "answer_count": 1, "score": 0, "last_activity_date": 1480425700, "creation_date": 1480424916, "question_id": 40866718, "link": "https://stackoverflow.com/questions/40866718/configuration-file-using-viper-giving-null-value-in-go", "title": "Configuration file using viper giving null value in GO", "body": "<p>i am new in Go and using viper for configuration management</p>\n\n<p>configuration file looks like (config.yaml) </p>\n\n<pre><code>SD_ORIGIN : web url\nAPI_TRACKING_ID : 77xxx1\nAPI_TOKEN : sdsaxxxdfds123\n</code></pre>\n\n<p>And using the go code to read the value but getting null value while i read code snippet as :-</p>\n\n<pre><code>    viper.SetConfigName(\"config\")\n    viper.AddConfigPath(\".\")\n    err := viper.ReadInConfig()\n    if err != nil {\n        fmt.Println(\"Config not found...\")\n    }\n}\n\nvar apiTrackingID = viper.GetString(\"API_TRACKING_ID\")\n</code></pre>\n\n<p>Please help to find the issue in my config file or implementation in Go.</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 37141, "user_id": 5315974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/MNGHV.png?s=128&g=1", "display_name": "Vao Tsun", "link": "https://stackoverflow.com/users/5315974/vao-tsun"}, "edited": false, "score": 0, "creation_date": 1480493768, "post_id": 40872246, "comment_id": 68980689, "body": "if you pass null to column, null is inserted, not default: <code>t=# create table dfnn(i int default 0); CREATE TABLE t=# insert into dfnn select null; INSERT 0 1 t=# select * from dfnn;  i ---  (1 row)</code>"}], "tags": [], "owner": {"reputation": 1575, "user_id": 491024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/do7Tr.png?s=128&g=1", "display_name": "Lorna Mitchell", "link": "https://stackoverflow.com/users/491024/lorna-mitchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1480493728, "last_edit_date": 1480493728, "creation_date": 1480441107, "answer_id": 40872246, "question_id": 40866712, "link": "https://stackoverflow.com/questions/40866712/how-can-i-use-postgresql-default-keyword-in-a-prepared-statement-in-go/40872246#40872246", "title": "How Can I use postgresql DEFAULT keyword in a prepared statement in GO?", "body": "<p>I think it would be better, since you already have an if/else detecting the situation where you don't have a value to pass, to instead do</p>\n\n<pre><code>INSERT INTO t1 (col1) VALUES ('FOO');\n</code></pre>\n\n<p>and let postgres use the default value for the other column. </p>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1612438014, "creation_date": 1480424904, "last_edit_date": 1612438014, "question_id": 40866712, "link": "https://stackoverflow.com/questions/40866712/how-can-i-use-postgresql-default-keyword-in-a-prepared-statement-in-go", "title": "How Can I use postgresql DEFAULT keyword in a prepared statement in GO?", "body": "<p>Consider that I have a table t1: col1: <code>varchar(255)</code>, col2: <code>boolean DEFAULT true</code></p>\n<p>and I created this prepared statement p1: <code>INSERT INTO t1(col1,col2) VALUES ($1,$2)</code></p>\n<p>and in GO I am executing my prepared statement but based on condition1 I want to pass the <code>DEFAULT</code> keyword to the second parameter in the prepared statement i.e</p>\n<pre><code>if condition1 {\n   sql.Exec(p1,&quot;FOO&quot;,&quot;DEFAULT&quot;)  // but this returns an error:  invalid input syntax for type boolean: &quot;DEFAULT&quot;\n} else{\n  //pass other parameters to the prepared statement\n}\n</code></pre>\n<p>summary: I am trying to end with this sql statement:</p>\n<pre><code>INSERT INTO t1(col1,col2) VALUES ('FOO',DEFAULT) \n</code></pre>\n<p>but I am getting this:</p>\n<pre><code>INSERT INTO t1(col1,col2) VALUES ('FOO','DEFAULT')   //quotations on DEFAULT\n</code></pre>\n<p>anybody knows how can I solve this?</p>\n"}, {"tags": ["go", "netlink"], "owner": {"reputation": 41, "user_id": 5934363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc10af18e2069096476980fe34f9e3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mingqiang Liang", "link": "https://stackoverflow.com/users/5934363/mingqiang-liang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1480424881, "creation_date": 1480424123, "last_edit_date": 1480424881, "question_id": 40866471, "link": "https://stackoverflow.com/questions/40866471/how-to-implement-a-ipvsadm-restore-like-function-using-netlink-for-golang", "title": "How to implement a &quot;ipvsadm --restore&quot; like function using netlink for golang", "body": "<p>I want implement a \"ipvsadm --restore\" like function, leveraging on github.com/vishvananda/netlink/nl. Search on github, I find a helpful golang ipvs lib in <a href=\"https://github.com/docker/libnetwork/tree/master/ipvs\" rel=\"nofollow noreferrer\">libnetwork</a>. </p>\n\n<p>However, it just provide New/Update/Delete functions for Service and Destination. </p>\n\n<p>I want a \"ipvsadm --restore\" like function. I am not an ipvs/netlink expert, is there anyone can kindly point out how to implement one. </p>\n\n<p>Actually, I have try to implement like this, but it does not work.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package ipvs\n\nimport (\n    \"net\"\n    \"syscall\"\n    \"fmt\"\n    \"os/exec\"\n    \"strings\"\n    \"github.com/vishvananda/netlink/nl\"\n    \"bytes\"\n    \"encoding/binary\"\n)\n\n// Service defines an IPVS service in its entirety.\ntype Service struct {\n    // Virtual service address.\n    Address  net.IP\n    Protocol uint16\n    Port     uint16\n    FWMark   uint32 // Firewall mark of the service.\n\n    // Virtual service options.\n    SchedName     string\n    Flags         uint32\n    Timeout       uint32\n    Netmask       uint32\n    AddressFamily uint16\n    PEName        string\n}\n\n// Destination defines an IPVS destination (real server) in its\n// entirety.\ntype Destination struct {\n    Address         net.IP\n    Port            uint16\n    Weight          int\n    ConnectionFlags uint32\n    AddressFamily   uint16\n    UpperThreshold  uint32\n    LowerThreshold  uint32\n}\n\n\ntype ServiceDestination struct {\n    Service *Service\n    Destinations []*Destination\n}\n\n// Handle provides an ipvs handle to program ipvs rules.\ntype IPVSHandle struct {\n    ipvsFamily int\n}\n\n// NewIPVSHandler provides a new ipvs handler\nfunc NewIPVSHandle() (*IPVSHandle, error) {\n    if out, err := exec.Command(\"modprobe\", \"-va\", \"ip_vs\").CombinedOutput(); err != nil {\n        return nil, fmt.Errorf(\"Running modprobe ip_vs failed with message: `%s`, error: %v\", strings.TrimSpace(string(out)), err)\n    }\n\n    ipvsFamily, err := getIPVSFamily()\n    if err != nil {\n        return nil, fmt.Errorf(\"Could not get ipvs family information from the kernel. It is possible that ipvs is not enabled in your kernel.\")\n    }\n\n    return &amp;IPVSHandle{ipvsFamily: ipvsFamily}, nil\n}\n\nfunc ( i *IPVSHandle) Restore(items []ServiceDestination)([][]byte, error) {\n    req := nl.NewNetlinkRequest(i.ipvsFamily, syscall.NLM_F_REPLACE)\n    req.AddData(&amp;genlMsgHdr{cmd: ipvsCmdSetConfig, version: 1})\n\n\n    listAttr := nl.NewRtAttr(ipvsCmdAttrUnspec, nl.Uint16Attr(uint16(i.ipvsFamily)))\n\n    for _, item := range  items {\n        itemAttr := nl.NewRtAttr(ipvsCmdAttrUnspec, nl.Uint16Attr(uint16(i.ipvsFamily)))\n\n        srvAttr := toServiceAttr(item.Service)\n        nl.NewRtAttrChild(itemAttr, ipvsCmdAttrService, srvAttr.Serialize())\n\n        for _, d := range item.Destinations {\n            nl.NewRtAttrChild(itemAttr, ipvsCmdAttrDest, fillDestinaton(d).Serialize())\n        }\n\n        nl.NewRtAttrChild(listAttr, ipvsCmdAttrUnspec, itemAttr.Serialize())\n    }\n\n    req.AddData(listAttr)\n    return req.Execute(syscall.NETLINK_GENERIC, 0)\n}\n\nfunc toServiceAttr(s *Service) *nl.RtAttr {\n    cmdAttr := nl.NewRtAttr(ipvsCmdAttrService, nil)\n    nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrAddressFamily, nl.Uint16Attr(s.AddressFamily))\n    if s.FWMark != 0 {\n        nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrFWMark, nl.Uint32Attr(s.FWMark))\n    } else {\n        nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrProtocol, nl.Uint16Attr(s.Protocol))\n        nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrAddress, rawIPData(s.Address))\n\n        // Port needs to be in network byte order.\n        portBuf := new(bytes.Buffer)\n        binary.Write(portBuf, binary.BigEndian, s.Port)\n        nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrPort, portBuf.Bytes())\n    }\n\n    nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrSchedName, nl.ZeroTerminated(s.SchedName))\n    if s.PEName != \"\" {\n        nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrPEName, nl.ZeroTerminated(s.PEName))\n    }\n\n    f := &amp;ipvsFlags{\n        flags: s.Flags,\n        mask:  0xFFFFFFFF,\n    }\n    nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrFlags, f.Serialize())\n    nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrTimeout, nl.Uint32Attr(s.Timeout))\n    nl.NewRtAttrChild(cmdAttr, ipvsSvcAttrNetmask, nl.Uint32Attr(s.Netmask))\n    return cmdAttr\n}\n\nfunc fillDestinaton(d *Destination) nl.NetlinkRequestData {\n    cmdAttr := nl.NewRtAttr(ipvsCmdAttrDest, nil)\n\n    nl.NewRtAttrChild(cmdAttr, ipvsDestAttrAddress, rawIPData(d.Address))\n    // Port needs to be in network byte order.\n    portBuf := new(bytes.Buffer)\n    binary.Write(portBuf, binary.BigEndian, d.Port)\n    nl.NewRtAttrChild(cmdAttr, ipvsDestAttrPort, portBuf.Bytes())\n\n    nl.NewRtAttrChild(cmdAttr, ipvsDestAttrForwardingMethod, nl.Uint32Attr(d.ConnectionFlags&amp;ConnectionFlagFwdMask))\n    nl.NewRtAttrChild(cmdAttr, ipvsDestAttrWeight, nl.Uint32Attr(uint32(d.Weight)))\n    nl.NewRtAttrChild(cmdAttr, ipvsDestAttrUpperThreshold, nl.Uint32Attr(d.UpperThreshold))\n    nl.NewRtAttrChild(cmdAttr, ipvsDestAttrLowerThreshold, nl.Uint32Attr(d.LowerThreshold))\n\n    return cmdAttr\n}\n</code></pre>\n"}, {"tags": ["json", "go", "struct", "field"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480420828, "post_id": 40864840, "comment_id": 68946090, "body": "Check out this answer (it contains an example to get tag values): <a href=\"http://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">What are the use(s) for tags in Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 2, "creation_date": 1541690097, "post_id": 40865028, "comment_id": 93309216, "body": "Please note that the <code>json</code> tag supports more than just the name of the property, such as <code>&lt;name&gt;,omitempty</code> and your code is going to fail that by returning more than just the name of the field."}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 31, "last_activity_date": 1541691097, "last_edit_date": 1541691097, "creation_date": 1480419623, "answer_id": 40865028, "question_id": 40864840, "link": "https://stackoverflow.com/questions/40864840/how-to-get-the-json-field-names-of-a-struct-in-golang/40865028#40865028", "title": "How to get the json field names of a struct in golang?", "body": "<p>You use the <a href=\"https://golang.org/pkg/reflect/#StructTag\" rel=\"noreferrer\">StructTag</a> type to get the tags. The documentation I linked has examples, look them up, but your code could be something like</p>\n\n<pre><code>func (b example) PrintFields() {\n    val := reflect.ValueOf(b)\n    for i := 0; i &lt; val.Type().NumField(); i++ {\n        fmt.Println(val.Type().Field(i).Tag.Get(\"json\"))\n    }\n}\n</code></pre>\n\n<p><strong>NOTE</strong> The <code>json</code> tag format supports more than just field names, such as <code>omitempty</code> or <code>string</code>, so if you need an approach that takes care of that too, further improvements to the <code>PrintFields</code> function should be made:</p>\n\n<ol>\n<li>we need to check whether the <code>json</code> tag is <code>-</code> (i.e. <code>json:\"-\"</code>)</li>\n<li>we need to check if name exists and isolate it</li>\n</ol>\n\n<p>Something like this:</p>\n\n<pre><code>func (b example) PrintFields() {\n    val := reflect.ValueOf(b)\n    for i := 0; i &lt; val.Type().NumField(); i++ {\n        t := val.Type().Field(i)\n        fieldName := t.Name\n\n        if jsonTag := t.Tag.Get(\"json\"); jsonTag != \"\" &amp;&amp; jsonTag != \"-\" {\n            if commaIdx := strings.Index(jsonTag, \",\"); commaIdx &gt; 0 {\n                fieldName = jsonTag[:commaIdx]\n            }\n        }\n\n\n        fmt.Println(fieldName)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "is_accepted": false, "score": 2, "last_activity_date": 1480419667, "creation_date": 1480419667, "answer_id": 40865043, "question_id": 40864840, "link": "https://stackoverflow.com/questions/40864840/how-to-get-the-json-field-names-of-a-struct-in-golang/40865043#40865043", "title": "How to get the json field names of a struct in golang?", "body": "<p>Use:</p>\n\n<pre><code>func (b example) PrintFields() {\n    val := reflect.ValueOf(b)\n    t := val.Type()\n    for i := 0; i &lt; t.NumField(); i++ {\n        fmt.Println(t.Field(i).Tag.Get(\"json\"))\n    }\n}\n</code></pre>\n\n<p>See it in <a href=\"https://play.golang.org/p/ki8azJtkNH\" rel=\"nofollow noreferrer\">playground.</a></p>\n"}, {"tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": false, "score": 4, "last_activity_date": 1480419822, "creation_date": 1480419822, "answer_id": 40865100, "question_id": 40864840, "link": "https://stackoverflow.com/questions/40864840/how-to-get-the-json-field-names-of-a-struct-in-golang/40865100#40865100", "title": "How to get the json field names of a struct in golang?", "body": "<p>Instead of using <code>StructField</code>'s <code>Name</code>, you can use <code>Tag</code> to get a <code>StructTag</code> object.\nSee: <a href=\"https://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow noreferrer\">https://golang.org/pkg/reflect/#StructTag</a></p>\n\n<p>Then you can use <code>StructTag</code>'s <code>Get</code> or <code>Lookup</code> methods to get the json tag:</p>\n\n<p>Using <code>Get</code>:</p>\n\n<pre><code>func (b example) PrintFields() {\n    val := reflect.ValueOf(b)\n    for i := 0; i &lt; val.Type().NumField(); i++ {\n        // prints empty line if there is no json tag for the field\n        fmt.Println(val.Type().Field(i).Tag.Get(\"json\"))\n    }\n}\n</code></pre>\n\n<p>Using <code>Lookup</code>:</p>\n\n<pre><code>func (b example) PrintFields() {\n    val := reflect.ValueOf(b)\n    for i := 0; i &lt; val.Type().NumField(); i++ {\n        // skips fields without json tag\n        if tag, ok := val.Type().Field(i).Tag.Lookup(\"json\"); ok {\n            fmt.Println(tag)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1057, "user_id": 1750407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EobHJ.jpg?s=128&g=1", "display_name": "Wendy Adi", "link": "https://stackoverflow.com/users/1750407/wendy-adi"}, "is_accepted": false, "score": 1, "last_activity_date": 1480419877, "creation_date": 1480419877, "answer_id": 40865110, "question_id": 40864840, "link": "https://stackoverflow.com/questions/40864840/how-to-get-the-json-field-names-of-a-struct-in-golang/40865110#40865110", "title": "How to get the json field names of a struct in golang?", "body": "<p>Not the <code>Name</code> you are looking for. What you looking is the <code>Tag</code></p>\n\n<pre><code>func (b example) PrintFields() {\n    val := reflect.ValueOf(b)\n    for i := 0; i &lt; val.Type().NumField(); i++ {\n        fmt.Println(val.Type().Field(i).Tag.Get(\"json\"))\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9865510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3291e30f8b7d791cc03c3dddd5f5158f?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckM", "link": "https://stackoverflow.com/users/9865510/chuckm"}, "is_accepted": false, "score": 2, "last_activity_date": 1549403282, "creation_date": 1549403282, "answer_id": 54543572, "question_id": 40864840, "link": "https://stackoverflow.com/questions/40864840/how-to-get-the-json-field-names-of-a-struct-in-golang/54543572#54543572", "title": "How to get the json field names of a struct in golang?", "body": "<p>an updated version with a generic interface as parameter:</p>\n\n<pre><code>func PrintFields(b interface{}) {\n    val := reflect.ValueOf(b)\n    for i := 0; i &lt; val.Type().NumField(); i++ {\n        t := val.Type().Field(i)\n        fieldName := t.Name\n\n        if jsonTag := t.Tag.Get(\"json\"); jsonTag != \"\" &amp;&amp; jsonTag != \"-\" {\n            // check for possible comma as in \"...,omitempty\"\n            var commaIdx int\n            if commaIdx = strings.Index(jsonTag, \",\"); commaIdx &lt; 0 {\n                commaIdx = len(jsonTag)\n            }\n            fieldName = jsonTag[:commaIdx]\n        }\n        fmt.Println(fieldName)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 5470637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UGaTV.gif?s=128&g=1", "display_name": "lambher", "link": "https://stackoverflow.com/users/5470637/lambher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18512, "favorite_count": 5, "accepted_answer_id": 40865028, "answer_count": 5, "score": 26, "last_activity_date": 1549403282, "creation_date": 1480419051, "question_id": 40864840, "link": "https://stackoverflow.com/questions/40864840/how-to-get-the-json-field-names-of-a-struct-in-golang", "title": "How to get the json field names of a struct in golang?", "body": "<p>What is the way to get the json field names of this struct ?</p>\n\n<pre><code>type example struct {\n    Id          int `json:\"id\"`\n    CreatedAt   string `json:\"created_at\"`\n    Tag         string `json:\"tag\"`\n    Text        string `json:\"text\"`\n    AuthorId    int `json:\"author_id\"`\n}\n</code></pre>\n\n<p>I try to print the fields with this function :</p>\n\n<pre><code>func (b example) PrintFields() {\n    val := reflect.ValueOf(b)\n    for i := 0; i &lt; val.Type().NumField(); i++ {\n        fmt.Println(val.Type().Field(i).Name)\n    }\n}\n</code></pre>\n\n<p>Of course I get :</p>\n\n<pre><code>Id\nCreatedAt\nTag\nText\nAuthorId\n</code></pre>\n\n<p>But I would like something like :</p>\n\n<pre><code>id\ncreated_at\ntag\ntext\nauthor_id\n</code></pre>\n"}, {"tags": ["php", "symfony", "go", "base64"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1480414922, "creation_date": 1480414922, "answer_id": 40863349, "question_id": 40863230, "link": "https://stackoverflow.com/questions/40863230/php-and-golang-sha512-different-result/40863349#40863349", "title": "PHP and Golang sha512 different result", "body": "<p>You're using <code>URLEncoding</code>, while PHP seems to use standard encoding. Replace</p>\n\n<pre><code>digest := base64.URLEncoding.EncodeToString(container)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>digest := base64.StdEncoding.EncodeToString(container)\n</code></pre>\n\n<p>and it issues the same results as PHP: <a href=\"https://play.golang.org/p/6pHCN6rb9U\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6pHCN6rb9U</a>.</p>\n"}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 40863349, "answer_count": 1, "score": 4, "last_activity_date": 1480431690, "creation_date": 1480414578, "last_edit_date": 1480431690, "question_id": 40863230, "link": "https://stackoverflow.com/questions/40863230/php-and-golang-sha512-different-result", "title": "PHP and Golang sha512 different result", "body": "<p>I wanted to implement the Symfony password hash in Golang. The result is the same expect some character. </p>\n\n<p>The Symfony solution: </p>\n\n<pre><code>function mergePasswordAndSalt($password, $salt)\n{\n    return $password.'{'.$salt.'}';\n}\n\n$salted = mergePasswordAndSalt('asd12345', 'korsipcidz4w84kk0cccwo840s8s4sg');\n$digest = hash('sha512', $salted, true);\n\n\nfor ($i = 1; $i &lt; 5000; ++$i) {\n    $new = $digest.$salted;\n    $digest = hash('sha512', $new, true);\n}\n\necho base64_encode($digest);\n</code></pre>\n\n<p>The Golang solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/sha512\"\n    \"encoding/base64\"\n    \"fmt\"\n    \"hash\"\n)\n\nvar (\n    hasher    hash.Hash\n    container []byte\n)\n\nfunc main() {\n    password := \"asd12345\"\n    salt := \"korsipcidz4w84kk0cccwo840s8s4sg\"\n    salted := []byte(password + \"{\" + salt + \"}\")\n\n    hasher = sha512.New()\n    hasher.Write(salted)\n    container = hasher.Sum(nil)\n\n    for i := 1; i &lt; 5000; i++ {\n        new := append(container[:], salted[:]...)\n\n        hasher = sha512.New()\n        hasher.Write(new)\n        container = hasher.Sum(nil)\n    }\n    digest := base64.URLEncoding.EncodeToString(container)\n    fmt.Println(digest)\n}\n</code></pre>\n\n<p>The Golang result: </p>\n\n<pre><code>yIp0074qTaxBz7fOGFpTVYU7LaAterUko6YjnmCZ55R6lAYouXWFoBKT_wI7Vit87RKbU9I-U3M2mU11v_KEUQ==\n</code></pre>\n\n<p>The PHP result:</p>\n\n<pre><code>yIp0074qTaxBz7fOGFpTVYU7LaAterUko6YjnmCZ55R6lAYouXWFoBKT/wI7Vit87RKbU9I+U3M2mU11v/KEUQ==\n</code></pre>\n\n<p>So how the example shown, it is the same just some other character lik -,/,+ are the different. I think it can be because of the character coding, but I haven't idea, how can I determine it. \nEnvironment: Fedora 23, Go 1.7, PHP 5.6</p>\n"}, {"tags": ["go", "tcp"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480428369, "post_id": 40862157, "comment_id": 68951094, "body": "Exactly what do you mean by closing the connection &quot;ungracefully&quot;?"}, {"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480429019, "post_id": 40862157, "comment_id": 68951582, "body": "Accidental disconnection, people unplugging the cable, powerloss on the other side, malformed tcp messages. I suspect most of these will generate timeouts, I am not aware of all the errors that <code>tcpConn.Read()</code> may generate."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480429272, "post_id": 40862157, "comment_id": 68951775, "body": "If you want the remote side to simulate a disconnect, like pulling the cable or losing power, make sure keepalive is disabled and just stop responding. If you want to break the connection in various other ways, you need to do that at a lower level on the network."}], "answers": [{"tags": [], "owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "is_accepted": true, "score": 2, "last_activity_date": 1480424430, "last_edit_date": 1480424430, "creation_date": 1480420746, "answer_id": 40865371, "question_id": 40862157, "link": "https://stackoverflow.com/questions/40862157/how-to-test-tcp-disconnection-in-go/40865371#40865371", "title": "How to test TCP disconnection in GO", "body": "<p>A solution is to set a <a href=\"https://golang.org/pkg/net/#TCPConn.SetDeadline\" rel=\"nofollow noreferrer\">deadline</a> to the TCP connection itself:</p>\n\n<pre><code>tcpConn.SetDeadline(time.Now())\n</code></pre>\n\n<p>Later this will trigger a timeout error which can be caught with:</p>\n\n<pre><code>err := decoder.Decode(&amp;msg);\nif err != nil {\n    if neterr, ok := err.(net.Error); ok &amp;&amp; neterr.Timeout() {\n        fmt.Errorf(\"TCP timeout : %s\", err.Error())\n    } else {\n        fmt.Errorf(\"Received error decoding message: %s\", err.Error())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1969, "favorite_count": 0, "accepted_answer_id": 40865371, "answer_count": 1, "score": 2, "last_activity_date": 1480424430, "creation_date": 1480411718, "last_edit_date": 1495542291, "question_id": 40862157, "link": "https://stackoverflow.com/questions/40862157/how-to-test-tcp-disconnection-in-go", "title": "How to test TCP disconnection in GO", "body": "<p>I do have a process receiving data from second local process. I need to test if connection errors are handled well AND if it automatically reconnects and keep receiving data after a disconnection.</p>\n\n<p>To do so I am trying to make it disconnect abruptly or put the TCP connection in an error state from a unit test.\nAs seen in <a href=\"https://stackoverflow.com/questions/12741386/how-to-know-tcp-connection-is-closed-in-golang-net-package\">this question</a> to check if a connection is closed I am checking for data to come and test if it returns an error.\nI am not sure how to:</p>\n\n<ul>\n<li>close the connection ungracefully</li>\n<li>make it be in an error state</li>\n</ul>\n\n<p>This is the essence of my data receiver:</p>\n\n<pre><code>    import (\n        \"bufio\"\n        \"encoding/json\"\n        \"fmt\"\n        \"io\"\n        \"net\"\n    )\n\n    type Message struct {\n        ID string `json:\"id\"`\n    }\n\n    func ReceiveData(listener Listener) {\n        var tcpConn net.Conn\n        var addr string = \"127.0.0.1:9999\"\n        tcpConn, err := net.Dial(\"tcp\", addr)\n        socketReader := bufio.NewReader(tcpConn)\n        decoder := json.NewDecoder(socketReader)\n\n        for {\n            var msg Message\n            if err := decoder.Decode(&amp;msg); err == io.EOF {\n                listener.ProcessUpdate(Message{}, fmt.Errorf(\"Received EOF\"), nil)\n                tcpConn = nil\n                return\n            } else if err != nil {\n                listener.ProcessUpdate(Message{}, nil, fmt.Errorf(\"Error decoding message: %s\", err.Error()))\n                tcpConn = nil\n                return\n        }\n\n        // process message\n        _ = msg\n\n        // Test disconnection\n        // This does not disconnect:\n        // tcpConn = nil\n        // This does but gracefully:\n        // tcpConn.Close()\n    }\n</code></pre>\n\n<p>I am not mocking the TCP connection as I'd like to try with the real data producer. If is needed I'll look at it.</p>\n"}, {"tags": ["variables", "go", "scope"], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 1732600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNkL2.jpg?s=128&g=1", "display_name": "Brij", "link": "https://stackoverflow.com/users/1732600/brij"}, "is_accepted": false, "score": 0, "last_activity_date": 1480406402, "creation_date": 1480406402, "answer_id": 40860581, "question_id": 40859793, "link": "https://stackoverflow.com/questions/40859793/go-obtain-various-query-results-in-if-else-block-based-on-parameters-number/40860581#40860581", "title": "GO: Obtain various query results in if else block based on parameters number", "body": "<p>the problem is because of variables are defined in the scope in which they are declared.</p>\n\n<p>The difference between = and := is that = is just assignment and := is used for assignment and declaration</p>\n\n<p>for example</p>\n\n<pre><code> rows := 1 \n//it basically means \n var rows int \n rows = 1\n</code></pre>\n\n<p>what you want is to declare rows outside the if-else and then use them, will solve the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1480412168, "creation_date": 1480412168, "answer_id": 40862296, "question_id": 40859793, "link": "https://stackoverflow.com/questions/40859793/go-obtain-various-query-results-in-if-else-block-based-on-parameters-number/40862296#40862296", "title": "GO: Obtain various query results in if else block based on parameters number", "body": "<h3>Scope visibility</h3>\n\n<p>Each block has itself visibility scope. A general rule is <strong>visible from inner, invisible from outer</strong>. It means you can see variables from superior scope in subject scope but not vise versa.</p>\n\n<p>I believe you use <code>rows</code> declared in <code>if</code> statement out of the block, so it doesn't exist there.</p>\n\n<pre><code>var err error\nvar rows string\nif warehouseId != 0 {\n    rows, err := db.Query(query, variantId, warehouseId)\n} else {\n    rows, err := db.Query(query, variantId)\n}\nfmt.Println(rows) // It is now possible to use `rows` outside of the block\n</code></pre>\n\n<h3>Declaration styles</h3>\n\n<p><code>var name &lt;type&gt;</code> is a common declaration way. The variable with typed <code>nil</code> value will be declared.</p>\n\n<p><code>name := &lt;value of type&gt;</code> is a short declaration form. It will declare a variable of a type and assign a value to it at the same time. Allowed only in functions.</p>\n"}], "owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480412636, "creation_date": 1480403576, "last_edit_date": 1480412636, "question_id": 40859793, "link": "https://stackoverflow.com/questions/40859793/go-obtain-various-query-results-in-if-else-block-based-on-parameters-number", "title": "GO: Obtain various query results in if else block based on parameters number", "body": "<p>I am using go-mysql-driver to make queries to my database.\nI have a function In which I am passing <code>id</code> and <code>warehouseId</code>.</p>\n\n<p>Now I am modifying my mysql query based on if warehouseId value is 0 or not.</p>\n\n<p>The problem is the parameters that I pass in <code>db.Query()</code>.\nFollowing is my <code>mysql query</code> where I am appending additional query if <code>warehouseId</code> is not <code>0</code>.</p>\n\n<pre><code>query := \"select id,description from offers inner join offer_entities on offers.id = offer_entities.offer_id where offer_entities.entity_id = ?\"\nif warehouseId != 0 {\n    query += `and offer_entities.warehouse_id = ? `\n}\nquery += `group by offer_id`\n</code></pre>\n\n<p>I parse it like this:</p>\n\n<pre><code>if warehouseId != 0 {\n    rows, err := db.Query(query, variantId, warehouseId)\n} else {\n    rows, err := db.Query(query, variantId)\n}\n</code></pre>\n\n<p>However, the problem is when I run it, I get an error <code>undefined: rows</code>. I know that it is because <code>rows</code> should be defined <code>outside the if-else</code> conditions. But I don't understand how to define rows outside if-else or\nIf there is any other way I could achieve my requirements.</p>\n\n<p>How should I tackle this problem. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ssl", "go"], "comments": [{"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1480397071, "post_id": 40857205, "comment_id": 68932767, "body": "If you&#39;re using a self-signed cert, you must to install it in your browser/system and in any other computer to prevent that warning, there&#39;s not other way if you what to use it with ajax. Also, it looks that you&#39;re developing in this moment, so, you can use a simple http for that propose. If you&#39;re connecting directly both golang servers without a browser, you can disable the tls validation with http.Transport."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1480413758, "post_id": 40857205, "comment_id": 68941294, "body": "There is a good answer <a href=\"http://stackoverflow.com/questions/12122159/golang-how-to-do-a-https-request-with-bad-certificate\" title=\"golang how to do a https request with bad certificate\">stackoverflow.com/questions/12122159/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1480413718, "creation_date": 1480413718, "answer_id": 40862911, "question_id": 40857205, "link": "https://stackoverflow.com/questions/40857205/auto-accept-certificates-programmatically-with-go-gin/40862911#40862911", "title": "Auto accept certificates programmatically with go-gin", "body": "<p>In <code>tls.Config</code> you can find the <a href=\"https://golang.org/pkg/crypto/tls/#Config\" rel=\"nofollow noreferrer\"><code>Certificates</code></a> attribute, which could be helpful in your situation:</p>\n\n<blockquote>\n  <p>Certificates contains one or more certificate chains\n  to present to the other side of the connection.\n  Server configurations must include at least one certificate\n  or else set GetCertificate.</p>\n</blockquote>\n\n<p>Then you can use your custom <code>tls.Config</code> to obtain a <code>http.Transport</code> for your purposes</p>\n\n<pre><code>tr := &amp;http.Transport{\n    TLSClientConfig: &amp;tls.Config{...custom config attrs...},\n}\n</code></pre>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 694, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480413718, "creation_date": 1480389515, "last_edit_date": 1480412801, "question_id": 40857205, "link": "https://stackoverflow.com/questions/40857205/auto-accept-certificates-programmatically-with-go-gin", "title": "Auto accept certificates programmatically with go-gin", "body": "<p>I am using golang go-gin server for hosting an application. Both the front-end and back-end work over https and both are separate projects. The front-end makes ajax calls to the back-end which is rest API based. If I clear the browser cache (Google Chrome) and try to load the UI it does not communicate with the back-end API initially. Then in another tab I hit the base url (<a href=\"https://localhost:8080/\" rel=\"nofollow noreferrer\">https://localhost:8080/</a>) accept the certificate and then it works. Is there any way to avoid this? I want the front end should auto accept the certificate and not complain about it.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1480390732, "post_id": 40857132, "comment_id": 68931144, "body": "<a href=\"https://golang.org/pkg/net/http/#pkg-constants\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#pkg-constants</a>"}, {"owner": {"reputation": 9643, "user_id": 1925083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/C3khW.jpg?s=128&g=1", "display_name": "cizixs", "link": "https://stackoverflow.com/users/1925083/cizixs"}, "reply_to_user": {"reputation": 37346, "user_id": 699632, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/EU5sp.jpg?s=128&g=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/699632/marty"}, "edited": false, "score": 0, "creation_date": 1480390795, "post_id": 40857132, "comment_id": 68931166, "body": "@Marty I did not mean status code error, because they are returned in <code>resp</code>, I want to know that is returned as <code>err</code> in the first line of above code."}, {"owner": {"reputation": 314, "user_id": 6546530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c497900ee9c3ea29057f2ff200629eea?s=128&d=identicon&r=PG&f=1", "display_name": "DevX", "link": "https://stackoverflow.com/users/6546530/devx"}, "edited": false, "score": 0, "creation_date": 1529670234, "post_id": 40857132, "comment_id": 88970232, "body": "I was looking for this same question bur instead got an question which had 5 down votes and closed. Thanks @cizixs for asking this question."}], "answers": [{"tags": [], "owner": {"reputation": 24723, "user_id": 3150943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06074c6f020f2509f0b51a2c0ad3a9a8?s=128&d=identicon&r=PG", "display_name": "nu11p01n73R", "link": "https://stackoverflow.com/users/3150943/nu11p01n73r"}, "is_accepted": false, "score": 0, "last_activity_date": 1480389875, "creation_date": 1480389875, "answer_id": 40857258, "question_id": 40857132, "link": "https://stackoverflow.com/questions/40857132/what-are-possible-golang-http-response-errors/40857258#40857258", "title": "What are possible golang http response errors?", "body": "<p>Those errors will mostly network related errors, like network timeouts etc. There is no need to handle them differently. You may exit gracefully like,</p>\n\n<pre><code>resp, err := http.Get(\"http://google.com/\")\n    if err != nil {\n        fmt.Println(err.Error())\n        os.Exit(1)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 314, "user_id": 6546530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c497900ee9c3ea29057f2ff200629eea?s=128&d=identicon&r=PG&f=1", "display_name": "DevX", "link": "https://stackoverflow.com/users/6546530/devx"}, "edited": false, "score": 0, "creation_date": 1529670705, "post_id": 40857275, "comment_id": 88970501, "body": "Thanks for answering, This really helped me."}], "tags": [], "owner": {"reputation": 3546, "user_id": 2651741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1baed77332f7c161914158fa44a0a0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Larry.Z", "link": "https://stackoverflow.com/users/2651741/larry-z"}, "is_accepted": true, "score": 7, "last_activity_date": 1480390410, "last_edit_date": 1480390410, "creation_date": 1480389992, "answer_id": 40857275, "question_id": 40857132, "link": "https://stackoverflow.com/questions/40857132/what-are-possible-golang-http-response-errors/40857275#40857275", "title": "What are possible golang http response errors?", "body": "<ol>\n<li>URL parse error</li>\n<li>too much redirect times</li>\n<li>tcp connect\\write\\read timeout</li>\n<li>302 status, but null Location header</li>\n</ol>\n\n<p>and so on</p>\n\n<p>You can read the source code in http package. Then you can find all the errors returned by this function <code>http.Get</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5628873, "user_type": "registered", "profile_image": "https://graph.facebook.com/780085318784929/picture?type=large", "display_name": "Rajeev Paul", "link": "https://stackoverflow.com/users/5628873/rajeev-paul"}, "is_accepted": false, "score": -1, "last_activity_date": 1480424332, "creation_date": 1480424332, "answer_id": 40866537, "question_id": 40857132, "link": "https://stackoverflow.com/questions/40857132/what-are-possible-golang-http-response-errors/40866537#40866537", "title": "What are possible golang http response errors?", "body": "<p>there are many error responses like :-</p>\n\n<pre><code>301 (Moved Permanently)\n302 (Found)\n303 (See Other)\n307 (Temporary Redirect) \n</code></pre>\n\n<p>better you go and read <a href=\"https://golang.org/pkg/net/http/#example_Get\" rel=\"nofollow noreferrer\">http.Get</a></p>\n"}], "owner": {"reputation": 9643, "user_id": 1925083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/C3khW.jpg?s=128&g=1", "display_name": "cizixs", "link": "https://stackoverflow.com/users/1925083/cizixs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1730, "favorite_count": 1, "accepted_answer_id": 40857275, "answer_count": 3, "score": 1, "last_activity_date": 1480424332, "creation_date": 1480388962, "question_id": 40857132, "link": "https://stackoverflow.com/questions/40857132/what-are-possible-golang-http-response-errors", "title": "What are possible golang http response errors?", "body": "<p>As in many golang <code>net/http</code> articles, a request returns two values: response and error:</p>\n\n<pre><code>resp, err := http.Get(\"http://example.com/\")\nif err != nil {\n    // handle error\n}\ndefer resp.Body.Close()\nbody, err := ioutil.ReadAll(resp.Body)\n</code></pre>\n\n<p>For http-related errors, it will be returned in <code>resp</code> with status code like 502, 400 etc. What are the possible errors returned? I need to know them before I can handle them. </p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 5182, "user_id": 550967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1NTf.jpg?s=128&g=1", "display_name": "DallaRosa", "link": "https://stackoverflow.com/users/550967/dallarosa"}, "edited": false, "score": 1, "creation_date": 1480402889, "post_id": 40856637, "comment_id": 68934945, "body": "Have you tried to actually do it or are you just asking for us to do it for you?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1480403930, "post_id": 40856637, "comment_id": 68935421, "body": "While a <code>Context</code> may provide execution context it does much more, especially handle cancellation. Why do you think <code>Context</code> would be the most appropriate way to handle derived loggers? (It is not.)"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1480441227, "post_id": 40856637, "comment_id": 68959949, "body": "I do pretty much exactly what you are talking about. I have a middleware that sets up a <code>logrus.Entry</code> with session and request info (url, request-id, etc...) . Then I have a log pkg of my own with a function that takes a context and returns a <code>logrus.Entry</code>, if it finds a <code>logrus.Entry</code> on the context it uses it if not it creates a new one."}, {"owner": {"reputation": 545, "user_id": 2543803, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/PPfvI.jpg?s=128&g=1", "display_name": "Norio Akagi", "link": "https://stackoverflow.com/users/2543803/norio-akagi"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1482619703, "post_id": 40856637, "comment_id": 69838559, "body": "@Volker It really depends. For example, in my project we use logrus, and for indexing log in ElasticSearch we want to set logrus.Fields like <code>user_id</code> outside of the default &quot;msg&quot; field. So a cleaner way is create an Entry by <code>logrus.WithField</code> in a middleware when we capture <code>user_id</code> and reuse the Entry throughout a lifecycle of the request by passing the entry in a context.  In this manner, this logger becomes actually a request specific."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 4142736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83818c194f578aa637f6957113f3fbc?s=128&d=identicon&r=PG&f=1", "display_name": "bashxx", "link": "https://stackoverflow.com/users/4142736/bashxx"}, "is_accepted": false, "score": 0, "last_activity_date": 1508371942, "creation_date": 1508371942, "answer_id": 46821088, "question_id": 40856637, "link": "https://stackoverflow.com/questions/40856637/whats-the-proper-way-to-use-logger-along-with-context/46821088#46821088", "title": "What&#39;s the proper way to use logger along with context?", "body": "<p>You can get the <code>request-id</code> from the incoming request and then use the context to pass the <code>request-id</code> to the functions you are calling. \nHere is an example of that : <a href=\"https://medium.com/@cep21/how-to-correctly-use-context-context-in-go-1-7-8f2c0fafdf39\" rel=\"nofollow noreferrer\">https://medium.com/@cep21/how-to-correctly-use-context-context-in-go-1-7-8f2c0fafdf39</a>. \nFor logging: Define your own logger using the std log library</p>\n\n<pre><code>func CreateCustomLogger(requestId string) *log.Logger {\n    defaultLoggingFlags := \nlog.Ldate|log.Ltime|log.LUTC|log.Lmicroseconds|log.Lshortfile\n    return log.New(os.Stderr, requestId + \": \", defaultLoggingFlags)\n}\n</code></pre>\n\n<p>In your function:</p>\n\n<pre><code>customLogger := CreateCustomLogger(requestId)\ncustomLogger.Printf(\"Custom log message\")\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5739882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff4ebbe08e64ca7c8589b4d3caf9f07?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Fu", "link": "https://stackoverflow.com/users/5739882/eric-fu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2908, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1508371942, "creation_date": 1480385014, "question_id": 40856637, "link": "https://stackoverflow.com/questions/40856637/whats-the-proper-way-to-use-logger-along-with-context", "title": "What&#39;s the proper way to use logger along with context?", "body": "<p>I am building a web server in Golang. You know Golang has an <code>context</code> package and it's <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">offically recommended</a> to always pass a context as first argument. <code>context.Context</code> has a <code>Value</code> method to keep variables under a context. </p>\n\n<p>However, most logging libraries also privide a way to inherit logger, say, creating child loggers with fields from its parent. In <a href=\"https://github.com/Sirupsen/logrus\" rel=\"nofollow noreferrer\">logrus</a> (or some other logger, doesn't matter), you may create an <code>logrus.Entry</code> and apply <code>WithFields</code> to get a child logger.</p>\n\n<p>For example, when each HTTP request coming an <code>request-id</code> is attached. I hope it being put in context, and also logged as a field in every log.</p>\n\n<p>So, how to do this in a proper way?</p>\n\n<p>THANKS!!</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "aws-sdk", "aws-sdk-go"], "answers": [{"tags": [], "owner": {"reputation": 383, "user_id": 3326930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae73600d26eff4529ea7b220529a7b70?s=128&d=identicon&r=PG&f=1", "display_name": "Quest", "link": "https://stackoverflow.com/users/3326930/quest"}, "is_accepted": true, "score": 1, "last_activity_date": 1480450172, "creation_date": 1480450172, "answer_id": 40874919, "question_id": 40856473, "link": "https://stackoverflow.com/questions/40856473/signature-does-not-match-403-error-when-signing-a-url-via-aws-sdk-go/40874919#40874919", "title": "Signature Does Not Match 403 error when signing a URL via aws-sdk-go", "body": "<p>my Bucket policy was not properly configured. I had to cross reference my key/secret with the IAM policy and make sure they were listed in the \"principals\" section of the policy</p>\n\n<p><a href=\"https://aws.amazon.com/blogs/security/iam-policies-and-bucket-policies-and-acls-oh-my-controlling-access-to-s3-resources/\" rel=\"nofollow noreferrer\">https://aws.amazon.com/blogs/security/iam-policies-and-bucket-policies-and-acls-oh-my-controlling-access-to-s3-resources/</a></p>\n"}], "owner": {"reputation": 383, "user_id": 3326930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae73600d26eff4529ea7b220529a7b70?s=128&d=identicon&r=PG&f=1", "display_name": "Quest", "link": "https://stackoverflow.com/users/3326930/quest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1347, "favorite_count": 0, "accepted_answer_id": 40874919, "answer_count": 1, "score": 0, "last_activity_date": 1485890024, "creation_date": 1480383848, "last_edit_date": 1485890024, "question_id": 40856473, "link": "https://stackoverflow.com/questions/40856473/signature-does-not-match-403-error-when-signing-a-url-via-aws-sdk-go", "title": "Signature Does Not Match 403 error when signing a URL via aws-sdk-go", "body": "<p>I followed instructions on this issue <a href=\"https://github.com/aws/aws-sdk-go/issues/467\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/issues/467</a> which clearly documented how to create a pre-signed url for a PUT request. The goal is to presign the url, so I can directly upload images from the browser safely</p>\n\n<p>key and secret are of course my current credentials that work with direct PutObject requests via the SDK</p>\n\n<pre><code>creds := credentials.NewStaticCredentials(\"key\", \"secret\", \"\")\n\ncfg := aws.NewConfig().WithRegion(\"us-west-2\").WithCredentials(creds)\nsrv := s3.New(session.New(), cfg)\n\nparams := &amp;s3.PutObjectInput{\n    Bucket: aws.String(\"my-bucket\"),\n    Key:    aws.String(\"/local/test/filename\"), \n}\nreq, _ := srv.PutObjectRequest(params)\nurl, err := req.Presign(15 * time.Hour)\nif err != nil {\n    fmt.Println(\"error signing request\", err)\n}\n\nfmt.Println(\"URL\", url)\n</code></pre>\n\n<p>```</p>\n\n<p>I then take that URL and make a curl request. I get this response</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Error&gt;\n    &lt;Code&gt;SignatureDoesNotMatch&lt;/Code&gt;\n    &lt;Message&gt;The request signature we calculated does not match the signature you provided. Check your key and signing method.&lt;/Message&gt;\n    &lt;AWSAccessKeyId&gt;redacted&lt;/AWSAccessKeyId&gt;\n    &lt;StringToSign&gt;redacted&lt;/StringToSign&gt;\n    &lt;SignatureProvided&gt;redacted&lt;/SignatureProvided&gt;\n    &lt;StringToSignBytes&gt;redacted&lt;/StringToSignBytes&gt;\n    &lt;CanonicalRequest&gt;PUT\n/local/test/filename\nX-Amz-Algorithm=AWS4-HMAC-SHA256&amp;amp;X-Amz-Credential=redacted%2Fus-west-2%2Fs3%2F%20aws4_request&amp;amp;X-Amz-Date=20161129T012909Z&amp;amp;X-Amz-Expires=54000&amp;amp;X-Amz-SignedHeaders=host\nhost:redacted.s3-us-west-2.amazonaws.com\n\nhost\nUNSIGNED-PAYLOAD&lt;/CanonicalRequest&gt;\n    &lt;CanonicalRequestBytes&gt;redacted&lt;/CanonicalRequestBytes&gt;\n    &lt;RequestId&gt;redacted&lt;/RequestId&gt;\n    &lt;HostId&gt;redacted&lt;/HostId&gt;\n&lt;/Error&gt;\n</code></pre>\n\n<p>any ideas why the presigned URL is providing me a signature that supposedly does not match? Again these same credentials are currently working for direct PutObject commands on my server</p>\n"}, {"tags": ["go", "slack-api", "slack"], "answers": [{"comments": [{"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1480370929, "post_id": 40854339, "comment_id": 68925335, "body": "Why would that package export ReactionAddedEvent at first place ?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 1, "creation_date": 1480371587, "post_id": 40854339, "comment_id": 68925606, "body": "It&#39;s a typedef of an unexported structure, but it looks like it&#39;s an exported type (with exported fields) so clients of the library can implement handlers for the event types.  From their example fields: <a href=\"https://github.com/nlopes/slack/blob/master/examples/websocket/websocket.go\" rel=\"nofollow noreferrer\">github.com/nlopes/slack/blob/master/examples/websocket/&hellip;</a>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 3, "creation_date": 1480371659, "post_id": 40854339, "comment_id": 68925639, "body": "The idea, though, seems to be that the events are <i>created</i> by the slack library from events that are received as JSON messages, and then converted into these exported-type Events that the client can setup a handler for.  The client isn&#39;t supposed to create the events themselves."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 3, "last_activity_date": 1480370632, "creation_date": 1480370632, "answer_id": 40854339, "question_id": 40854104, "link": "https://stackoverflow.com/questions/40854104/creating-an-instance-of-a-structure-with-unexported-sub-structures-in-go/40854339#40854339", "title": "Creating an instance of a structure with unexported sub-structures in Go", "body": "<p>First, if <code>slack</code> here refers to the <code>nlopes</code> library, the <code>slack.ReactionAddedEvent</code> structure's <code>Item</code> field is not a pointer, so you can't store an address of a <code>slack.reactionItem</code> struct into that field anyway.  Second, the <code>File</code> field of <code>slack.reactionItem</code> is a string, not a structure.</p>\n\n<p>Third, even if the above isn't/weren't the case, if the types are not exported, but the fields themselves are, you can't assemble the structure in a single literal.  Instead, you'll have to manually set those fields after creating the structure variable:</p>\n\n<pre><code>m := &amp;slack.ReactionAddedEvent{Reaction: \"white_check_mark\"}\nm.Item.File.Preview = \"Test\"\nm.Item.File.URLPrivate = \"http://google.com\"\n</code></pre>\n\n<p>But again, if you're using the <code>nlopes</code> library, that won't work because the <code>File</code> field isn't actually a structure:\n<a href=\"https://github.com/nlopes/slack/blob/master/websocket_reactions.go\" rel=\"nofollow noreferrer\">https://github.com/nlopes/slack/blob/master/websocket_reactions.go</a></p>\n\n<p>And fourth, if the type isn't exported, that's probably a good sign that you <em>shouldn't</em> be manipulating objects of that type.  In this case, in the <code>nlopes</code> library, those structures are only intended to be used for unmarshalling and then handling events from JSON messages.</p>\n"}], "owner": {"reputation": 91, "user_id": 5238873, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oyDZj.jpg?s=128&g=1", "display_name": "king_geedorah", "link": "https://stackoverflow.com/users/5238873/king-geedorah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 40854339, "answer_count": 1, "score": 0, "last_activity_date": 1480370632, "creation_date": 1480369637, "question_id": 40854104, "link": "https://stackoverflow.com/questions/40854104/creating-an-instance-of-a-structure-with-unexported-sub-structures-in-go", "title": "Creating an instance of a structure with unexported sub-structures in Go", "body": "<p>I am trying to manually create an instance of the type ReactionAddedEvent given <a href=\"https://github.com/nlopes/slack/blob/master/websocket_reactions.go#L22\" rel=\"nofollow noreferrer\">here, in nlopes' Go Slack library</a>. However, the sub-type reactionItem is unexported, which leads me to receive the error <code>./bot_test.go:111: cannot refer to unexported name slack.reactionItem</code> when trying to instantiate the object. </p>\n\n<p>Here is my code: </p>\n\n<p><code>m := &amp;slack.ReactionAddedEvent{\n        Item: &amp;slack.reactionItem{\n            File: &amp;slack.File{\n                Preview: \"Test\",\n                URLPrivate: \"http://google.com\",\n            },\n        },\n        Reaction: \"white_check_mark\",\n    }</code></p>\n\n<p>When I remove the identifier <code>&amp;slack.reactionItem</code> from line 2 in that snippet, I get instead the error: <code>./bot_test.go:112: missing type in composite literal</code>, obviously.</p>\n\n<p>Is there any way for me to instantiate an object of this type with the parameters I need? </p>\n"}, {"tags": ["go", "websocket", "gorilla"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480360100, "post_id": 40851437, "comment_id": 68919971, "body": "Are you certain that <code>websocketHandler</code> returns in all cases? What are the file descriptors that your program has open? What does the stack trace show the program is doing with the file descriptors?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1480360541, "post_id": 40851437, "comment_id": 68920216, "body": "Show the code that reads from the socket and the code that sends to the err channel."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1480361654, "post_id": 40851437, "comment_id": 68920786, "body": "Run <code>netstat</code> to view the open network connections in case the problem is elsewhere (opening and not closing database connections for example)."}], "answers": [{"tags": [], "owner": {"reputation": 537, "user_id": 985806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7fa899fafa20b5b76093472799388d4?s=128&d=identicon&r=PG", "display_name": "mileusna", "link": "https://stackoverflow.com/users/985806/mileusna"}, "is_accepted": false, "score": 4, "last_activity_date": 1501969686, "creation_date": 1501969686, "answer_id": 45526674, "question_id": 40851437, "link": "https://stackoverflow.com/questions/40851437/too-many-open-files-error-with-websocket-server-in-golang/45526674#45526674", "title": "too many open files error with websocket server in golang", "body": "<p>If you have closed all body readeres and covered all other possible reasons, it might be the ulimit problem if you have hight traffic. But usually you can increase that even if you are not the root users since there are two types of limits, hard limit ie. the max, and soft limit. You can check both of them in Linux using:</p>\n\n<p><code># ulimit -Sn</code></p>\n\n<p><code># ulimit -Hn</code></p>\n\n<p>If soft limit (Sn) is lower than hard limit (Hn) (default or set by the admin) you can make it higher up to the hard limit. On all my CentOS installs, as I can see the default is 1024 for Sn and 4096 for Hn, so you can easily max out Sn to 4096, no root user involved.</p>\n\n<p>This function will max out the number of open files if it is possible. Copy/paste and call the maxOpenFile() at the begining of main func and see does it help.</p>\n\n<pre><code>import \"syscall\"\n\nfunc maxOpenFiles() {\n    var rLimit syscall.Rlimit\n\n    err := syscall.Getrlimit(syscall.RLIMIT_NOFILE, &amp;rLimit)\n    if err != nil {\n        log.Println(\"Error Getting Rlimit \", err)\n    }\n\n    if rLimit.Cur &lt; rLimit.Max {\n        rLimit.Cur = rLimit.Max\n        err = syscall.Setrlimit(syscall.RLIMIT_NOFILE, &amp;rLimit)\n        if err != nil {\n            log.Println(\"Error Setting Rlimit \", err)\n        }\n    }\n}\n</code></pre>\n\n<p>Code is simple, first we read current settings for number of files and if Cur is less than Max, we max it out. This func will set the file limits only to the current app/linux process.</p>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2960, "favorite_count": 3, "answer_count": 1, "score": 3, "last_activity_date": 1501969686, "creation_date": 1480359209, "question_id": 40851437, "link": "https://stackoverflow.com/questions/40851437/too-many-open-files-error-with-websocket-server-in-golang", "title": "too many open files error with websocket server in golang", "body": "<p>I'm actually using gorilla package to put my websocket server in golang.\nIf I leave my server on, I have this error every 10 days or so.</p>\n\n<pre><code>2016/11/28 19:22:49 http: Accept error: accept tcp [::]:9001: accept4: too many open files; retrying in 1s\n2016/11/28 19:22:50 http: Accept error: accept tcp [::]:9001: accept4: too many open files; retrying in 1s\n2016/11/28 19:22:51 http: Accept error: accept tcp [::]:9001: accept4: too many open files; retrying in 1s\n2016/11/28 19:22:52 http: Accept error: accept tcp [::]:9001: accept4: too many open files; retrying in 1s\n2016/11/28 19:22:53 http: Accept error: accept tcp [::]:9001: accept4: too many open files; retrying in 1s\n2016/11/28 19:22:54 http: Accept error: accept tcp [::]:9001: accept4: too many open files; retrying in 1s\n</code></pre>\n\n<p>this is my code :</p>\n\n<pre><code>func websocketHandler(writer http.ResponseWriter, request *http.Request){\n    var socket *websocket.Conn\n    user := new(user.User)\n    user.Token = getParamURI(request.URL.RequestURI(), \"token\")\n\n    if user.GetUserByToken() == false {\n\n        errors := api.Error{}\n        socket.Close()\n        errors.ListErrors = append(errors.ListErrors, \"Session doesn't exist\")\n        writer.Header().Set(\"Content-Type\", \"application/json\")\n        writer.WriteHeader(http.StatusNotAcceptable)\n        json.NewEncoder(writer).Encode(errors)\n        return\n\n    }\n\n    socket, _ = upgrader.Upgrade(writer, request, nil)\n\n    err := make(chan string)\n\n    go pingSocket(socket, err)\n    go handleChangeNotification(socket, user.Id, err)\n    go handleChangeMessage(socket, user.Id, err)\n    for {\n       tmp := &lt;- err\n        if len(tmp) &gt; 0 {\n            break\n        }\n    }\n   socket.Close()\n}\n</code></pre>\n\n<p>my ulimit configuration :</p>\n\n<pre><code>core file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nscheduling priority             (-e) 0\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 7902\nmax locked memory       (kbytes, -l) 64\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 1024\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nreal-time priority              (-r) 0\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 7902\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n</code></pre>\n\n<p>The error is rather incomprehensible, I don't understand, because I close the socket well in case of break or error and server is in production but in beta close with 4-5 users, so it's not about limit.</p>\n\n<p>Can someone tell me where the error comes from?</p>\n"}, {"tags": ["c#", "go", "dll", "exchange-server", "exchangewebservices"], "answers": [{"comments": [{"owner": {"reputation": 2366, "user_id": 3160967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1d5285da7116b41a824dd9cf0e77e4ea?s=128&d=identicon&r=PG", "display_name": "mwag", "link": "https://stackoverflow.com/users/3160967/mwag"}, "edited": false, "score": 0, "creation_date": 1480360203, "post_id": 40850955, "comment_id": 68920031, "body": "Part of the reason to use the DLL in the first place is to use its support for communicating with the server using EAS. Can a SOAP approach achieve the same thing? If not I will clarify the question."}], "tags": [], "owner": {"reputation": 21, "user_id": 7131934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590747575a9b42505a875020bf479303?s=128&d=identicon&r=PG&f=1", "display_name": "tmack8080", "link": "https://stackoverflow.com/users/7131934/tmack8080"}, "is_accepted": false, "score": 2, "last_activity_date": 1480357225, "creation_date": 1480357225, "answer_id": 40850955, "question_id": 40850691, "link": "https://stackoverflow.com/questions/40850691/golang-wrapper-for-ews-exchangeservice/40850955#40850955", "title": "GoLang wrapper for EWS / ExchangeService", "body": "<p>You have to roll your own SOAP requests to EWS. The managed/.NET EWS API is just a nicely packaged set of SOAP requests.</p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 7248575, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5e5775f6487a74711711b1a57793f303?s=128&d=identicon&r=PG", "display_name": "tmack8080", "link": "https://stackoverflow.com/users/7248575/tmack8080"}, "is_accepted": true, "score": 1, "last_activity_date": 1480867598, "creation_date": 1480867598, "answer_id": 40960603, "question_id": 40850691, "link": "https://stackoverflow.com/questions/40850691/golang-wrapper-for-ews-exchangeservice/40960603#40960603", "title": "GoLang wrapper for EWS / ExchangeService", "body": "<p>You can only use the managed .dll with a .NET language, i.e., C#, PowerShell, etc. If you are not going to use a .NET language then you have to construct your own SOAP requests for EWS to consume.</p>\n\n<p>FYI, if this is an Exchange 2016 environment you might want to look into the Exchange REST API which is language agnostic.</p>\n"}, {"tags": [], "owner": {"reputation": 26124, "user_id": 171950, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ccee38944752d481128936450ddb687e?s=128&d=identicon&r=PG", "display_name": "Muhammad Hewedy", "link": "https://stackoverflow.com/users/171950/muhammad-hewedy"}, "is_accepted": false, "score": 0, "last_activity_date": 1575621600, "creation_date": 1575621600, "answer_id": 59209621, "question_id": 40850691, "link": "https://stackoverflow.com/questions/40850691/golang-wrapper-for-ews-exchangeservice/59209621#59209621", "title": "GoLang wrapper for EWS / ExchangeService", "body": "<p>I am working on <a href=\"https://github.com/mhewedy/ews\" rel=\"nofollow noreferrer\">https://github.com/mhewedy/ews</a> can be a good start.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10164944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475e714d7b10706a768cf3d027a048ca?s=128&d=identicon&r=PG&f=1", "display_name": "rbnhd", "link": "https://stackoverflow.com/users/10164944/rbnhd"}, "is_accepted": false, "score": -1, "last_activity_date": 1589309027, "last_edit_date": 1589309027, "creation_date": 1589299062, "answer_id": 61756218, "question_id": 40850691, "link": "https://stackoverflow.com/questions/40850691/golang-wrapper-for-ews-exchangeservice/61756218#61756218", "title": "GoLang wrapper for EWS / ExchangeService", "body": "<p>You cannot use the <code>.dll</code> file to make a client in Go. You have to <a href=\"https://outlook.office365.com/EWS/Services.wsdl\" rel=\"nofollow noreferrer\">download the WSDL file</a> and the required XSD files (<a href=\"https://outlook.office365.com/EWS/messages.xsd\" rel=\"nofollow noreferrer\"><code>messages.xsd</code></a> and <a href=\"https://outlook.office365.com/EWS/types.xsd\" rel=\"nofollow noreferrer\"><code>types.xsd</code></a>), then convert the WSDL to a Go package (I suggest using <a href=\"https://github.com/hooklift/gowsdl\" rel=\"nofollow noreferrer\">GoWSDL</a>). You can then write a Go client to communicate with EWS. </p>\n"}], "owner": {"reputation": 2366, "user_id": 3160967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1d5285da7116b41a824dd9cf0e77e4ea?s=128&d=identicon&r=PG", "display_name": "mwag", "link": "https://stackoverflow.com/users/3160967/mwag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1696, "favorite_count": 0, "accepted_answer_id": 40960603, "answer_count": 4, "score": 1, "last_activity_date": 1589309027, "creation_date": 1480356178, "question_id": 40850691, "link": "https://stackoverflow.com/questions/40850691/golang-wrapper-for-ews-exchangeservice", "title": "GoLang wrapper for EWS / ExchangeService", "body": "<p>I have some C# code that uses the ExchangeService (via Microsoft.Exchange.WebServices.dll) object to do some typical email tasks (e.g. fetch email, send email). I'd like to be able to do the same thing, but using Go instead of C#. What is the most direct way to do this? I understand there are tools such as CGo but given that this is MSFT-provided DLL that is part of the .NET framework, I suspect the process is not as simple as it would be if I were creating my own DLL.</p>\n"}, {"tags": ["google-app-engine", "go", "hugo"], "comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 1, "creation_date": 1480355248, "post_id": 40850308, "comment_id": 68917429, "body": "Have you tried to run your server locally without GAE? BTW, <code>init</code> function looks weird to me. Shouldn&#39;t it be <code>main</code>?"}, {"owner": {"reputation": 3769, "user_id": 364024, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/97eb936641f63111d3a2a0a155386515?s=128&d=identicon&r=PG", "display_name": "iandouglas", "link": "https://stackoverflow.com/users/364024/iandouglas"}, "reply_to_user": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1480356423, "post_id": 40850308, "comment_id": 68918037, "body": "I copied that part of the main.go script from someone else who launched a Hugo project on GAE. Like I said, it wasn&#39;t a problem with the Go code, it ended up being an issue with a badly-named .md file in the path (which shouldn&#39;t have been uploaded anyway). As soon as I added .md files to the skip_files list in my app.yaml, it started working again."}], "answers": [{"tags": [], "owner": {"reputation": 3769, "user_id": 364024, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/97eb936641f63111d3a2a0a155386515?s=128&d=identicon&r=PG", "display_name": "iandouglas", "link": "https://stackoverflow.com/users/364024/iandouglas"}, "is_accepted": false, "score": 0, "last_activity_date": 1480355179, "creation_date": 1480355179, "answer_id": 40850440, "question_id": 40850308, "link": "https://stackoverflow.com/questions/40850308/deploying-hugo-site-to-gae-results-in-internal-error-13/40850440#40850440", "title": "Deploying Hugo site to GAE results in &quot;internal error 13&quot;", "body": "<p>I must have had a poorly-named .md file in my path. Adding this to my app.yaml solved the problem:</p>\n\n<pre><code>skip_files:\n  - ^(.*/)?.*\\.md$\n</code></pre>\n\n<p>It would be nice if the gcloud system could have told me that a little clearer!</p>\n"}], "owner": {"reputation": 3769, "user_id": 364024, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/97eb936641f63111d3a2a0a155386515?s=128&d=identicon&r=PG", "display_name": "iandouglas", "link": "https://stackoverflow.com/users/364024/iandouglas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1480355754, "creation_date": 1480354706, "question_id": 40850308, "link": "https://stackoverflow.com/questions/40850308/deploying-hugo-site-to-gae-results-in-internal-error-13", "title": "Deploying Hugo site to GAE results in &quot;internal error 13&quot;", "body": "<p>I've been hosting a staging setup for a blog on App Engine and have had a few dozen versions working just fine. My main.go file is pretty simple, but trying to deploy gives an \"internal error\" at the cmdline:</p>\n\n<pre><code>You may also view the gcloud log file, found at\n[/Users/id/.config/gcloud/logs/2016.11.28/10.18.23.292328.log].\nFile upload done.\nUpdating service [default]...failed.\nERROR: (gcloud.app.deploy) Error Response: [13] An internal error occurred.\n</code></pre>\n\n<p>The last chunk of the log file isn't helpful as to the cause of the error:</p>\n\n<pre><code>2016-11-28 10:18:50,133 DEBUG    root            Operation [apps/blog-149523/operations/2a31964d-4f0c-4c1c-9fd7-844d36be257f] complete. Result: {\n    \"metadata\": {\n        \"target\": \"apps/blog-149523/services/default/versions/20161128t101823\",\n        \"method\": \"google.appengine.v1beta5.Versions.CreateVersion\",\n        \"user\": \"ian.douglas@iandouglas.com\",\n        \"insertTime\": \"2016-11-28T17:18:34.140Z\",\n        \"endTime\": \"2016-11-28T17:18:47.381Z\",\n        \"@type\": \"type.googleapis.com/google.appengine.v1beta5.OperationMetadataV1Beta5\"\n    },\n    \"done\": true,\n    \"name\": \"apps/blog-149523/operations/2a31964d-4f0c-4c1c-9fd7-844d36be257f\",\n    \"error\": {\n        \"message\": \"An internal error occurred.\",\n        \"code\": 13\n    }\n}\n2016-11-28 10:18:50,134 DEBUG    root            (gcloud.app.deploy) Error Response: [13] An internal error occurred.\nTraceback (most recent call last):\n  File \"/Users/id/src/public/google-cloud-sdk/lib/googlecloudsdk/calliope/cli.py\", line 740, in Execute\n    resources = args.calliope_command.Run(cli=self, args=args)\n  File \"/Users/id/src/public/google-cloud-sdk/lib/googlecloudsdk/calliope/backend.py\", line 1648, in Run\n    resources = command_instance.Run(args)\n  File \"/Users/id/src/public/google-cloud-sdk/lib/surface/app/deploy.py\", line 53, in Run\n    return deploy_util.RunDeploy(args, app_create=True)\n  File \"/Users/id/src/public/google-cloud-sdk/lib/googlecloudsdk/command_lib/app/deploy_util.py\", line 410, in RunDeploy\n    all_services)\n  File \"/Users/id/src/public/google-cloud-sdk/lib/googlecloudsdk/command_lib/app/deploy_util.py\", line 257, in Deploy\n    endpoints_info)\n  File \"/Users/id/src/public/google-cloud-sdk/lib/googlecloudsdk/api_lib/app/appengine_api_client.py\", line 119, in DeployService\n    return operations.WaitForOperation(self.client.apps_operations, operation)\n  File \"/Users/id/src/public/google-cloud-sdk/lib/googlecloudsdk/api_lib/app/api/operations.py\", line 70, in WaitForOperation\n    encoding.MessageToPyValue(completed_operation.error)))\nOperationError: Error Response: [13] An internal error occurred.\n2016-11-28 10:18:50,135 ERROR    root            (gcloud.app.deploy) Error Response: [13] An internal error occurred.\n2016-11-28 10:18:50,501 DEBUG    root            Metrics reporting process started...\n</code></pre>\n\n<p>Searching for \"internal error 13\" has led me to a lot of answers, even here on SO, saying this is a \"transient\" error and should go away on its own, but I've been dealing with this for over a week.</p>\n\n<p>I've simplified my main.go as much as possible, to no avail:</p>\n\n<pre><code>package main\n\nimport (\n  \"net/http\"\n  \"fmt\"\n)\n\nfunc init() {\n  http.HandleFunc(\"/_ah/health\", func(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, \"OK\") })\n  http.Handle(\"/\", http.FileServer(http.Dir(\"public\")))\n}\n</code></pre>\n\n<p>But the deploy process isn't complaining about my Go code being bad, it's just throwing this vague internal error 13 every time and I can't find any information on whether it's really server-side or something I've done.</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1480354000, "post_id": 40849787, "comment_id": 68916722, "body": "It would be a lot cleaner to use a struct. Thing is, you gotta do <code>root.batters.batter[item].id</code> to get at the value and you&#39;re gonna have to do a type assertion at every layer of indirection if you&#39;re using a <code>map[string]interface{}</code> which is really just some ugly code that needlessly complicates your problem."}, {"owner": {"reputation": 24240, "user_id": 495935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d310e51ac60b2a54b68b96e90593277b?s=128&d=identicon&r=PG", "display_name": "Surreal Dreams", "link": "https://stackoverflow.com/users/495935/surreal-dreams"}, "edited": false, "score": 0, "creation_date": 1480364638, "post_id": 40849787, "comment_id": 68922385, "body": "Why are you avoiding a struct?  Is your data arbitrary?  If it is, how do you know what element you want to edit?"}, {"owner": {"reputation": 2836, "user_id": 1359163, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/063e1984ad8cb19353c311ba3a9290b9?s=128&d=identicon&r=PG", "display_name": "KBN", "link": "https://stackoverflow.com/users/1359163/kbn"}, "edited": false, "score": 0, "creation_date": 1480444484, "post_id": 40849787, "comment_id": 68961612, "body": "Using <code>struct</code> would make it much easier to deal with. One thing to make defining the struct itself easier, you could set type of all other fields as <code>interface{}</code> and only set <code>batters map[string][]map[string]string</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8433, "user_id": 2667536, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/UfmAF.png?s=128&g=1", "display_name": "Derlin", "link": "https://stackoverflow.com/users/2667536/derlin"}, "is_accepted": false, "score": 0, "last_activity_date": 1480354071, "creation_date": 1480354071, "answer_id": 40850139, "question_id": 40849787, "link": "https://stackoverflow.com/questions/40849787/edit-a-value-in-a-json-file-without-knowing-structure-in-golang/40850139#40850139", "title": "Edit a value in a JSON file without knowing structure in Golang", "body": "<p>You can do it without a struct, but this means using casts all over the place. Here is a <a href=\"https://play.golang.org/p/G-Bko0aV9b\" rel=\"nofollow noreferrer\">working example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    str := \"{ \\\"id\\\": \\\"0001\\\", \\\"type\\\": \\\"donut\\\", \\\"name\\\": \\\"Cake\\\", \\\"ppu\\\": 0.55, \\\"batters\\\": { \" +\n                \"\\\"batter\\\": [{ \\\"id\\\": \\\"1001\\\", \\\"type\\\": \\\"Regular\\\" }, { \\\"id\\\": \\\"1002\\\", \\\"type\\\": \" +\n                \"\\\"Chocolate\\\" }] }, \\\"topping\\\": [{ \\\"id\\\": \\\"5001\\\", \\\"type\\\": \\\"None\\\" }, { \\\"id\\\": \\\"5002\\\", \" +\n                \"\\\"type\\\": \\\"Glazed\\\" }, { \\\"id\\\": \\\"5005\\\", \\\"type\\\": \\\"Sugar\\\" }, { \\\"id\\\": \\\"5007\\\", \\\"type\\\": \" +\n                \"\\\"Powdered Sugar\\\" }] }\"\n\n    jsonMap := make(map[string]interface{})\n    err := json.Unmarshal([]byte(str), &amp;jsonMap)\n    if err != nil {\n        panic(err)\n    }\n\n    batters := jsonMap[\"batters\"].(map[string]interface{})[\"batter\"]\n\n    for _, b := range(batters.([]interface{})) {\n        b.(map[string]interface{})[\"id\"] = \"other id\"\n    }\n\n    str2, err := json.Marshal(jsonMap)\n    fmt.Println(string(str2))   \n}\n</code></pre>\n\n<p>I think you are better off using a struct.</p>\n"}], "owner": {"reputation": 11, "user_id": 6323016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6abeaf9ee9c12822e1ba911b16a076?s=128&d=identicon&r=PG&f=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/6323016/vicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3269, "favorite_count": 1, "closed_date": 1480402966, "answer_count": 1, "score": 1, "last_activity_date": 1480354071, "creation_date": 1480352885, "last_edit_date": 1480353704, "question_id": 40849787, "link": "https://stackoverflow.com/questions/40849787/edit-a-value-in-a-json-file-without-knowing-structure-in-golang", "closed_reason": "Duplicate", "title": "Edit a value in a JSON file without knowing structure in Golang", "body": "<p>I have a JSON file which has data like below</p>\n\n<pre><code>{\n    \"id\": \"0001\",\n    \"type\": \"donut\",\n    \"name\": \"Cake\",\n    \"ppu\": 0.55,\n    \"batters\": {\n        \"batter\": [{\n            \"id\": \"1001\",\n            \"type\": \"Regular\"\n        }, {\n            \"id\": \"1002\",\n            \"type\": \"Chocolate\"\n        }]\n    },\n    \"topping\": [{\n        \"id\": \"5001\",\n        \"type\": \"None\"\n    }, {\n        \"id\": \"5002\",\n        \"type\": \"Glazed\"\n    }, {\n        \"id\": \"5005\",\n        \"type\": \"Sugar\"\n    }, {\n        \"id\": \"5007\",\n        \"type\": \"Powdered Sugar\"\n    }]\n}\n</code></pre>\n\n<p>I need to edit 'id' values which are in 'batter' array. \nAssume I didn't use ant struct type to unmarshall. After editing I need to write updated JSON string back to file again. </p>\n"}, {"tags": ["go", "testify"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1480343891, "creation_date": 1480343891, "answer_id": 40846860, "question_id": 40846738, "link": "https://stackoverflow.com/questions/40846738/golang-testing-of-functions-declared-as-variable-testify/40846860#40846860", "title": "Golang testing of functions declared as variable (testify)", "body": "<p>That's because your <code>testableFunction</code> variable gets assigned somewhere else in your code.</p>\n\n<p>See this example:</p>\n\n<pre><code>var testableFunction = func(s string) string {\n    return \"re: \" + s\n}\n</code></pre>\n\n<p>Test code:</p>\n\n<pre><code>func TestFunction(t *testing.T) {\n    exp := \"re: a\"\n    if got := testableFunction(\"a\"); got != exp {\n        t.Errorf(\"Expected: %q, got: %q\", exp, got)\n    }\n}\n</code></pre>\n\n<p>Running <code>go test -cover</code>:</p>\n\n<pre><code>PASS\ncoverage: 100.0% of statements\nok      play    0.002s\n</code></pre>\n\n<p>Obviously if a new function value is assigned to <code>testableFunction</code> before the test execution, then the anonymous function used to initialize your variable will not get called by the test.</p>\n\n<p>To demonstrate, change your test function to this:</p>\n\n<pre><code>func TestFunction(t *testing.T) {\n    testableFunction = func(s string) string { return \"re: \" + s }\n\n    exp := \"re: a\"\n    if got := testableFunction(\"a\"); got != exp {\n        t.Errorf(\"Expected: %q, got: %q\", exp, got)\n    }\n}\n</code></pre>\n\n<p>Running <code>go test -cover</code>:</p>\n\n<pre><code>PASS\ncoverage: 0.0% of statements\nok      play    0.003s\n</code></pre>\n"}], "owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1557, "favorite_count": 0, "accepted_answer_id": 40846860, "answer_count": 1, "score": 2, "last_activity_date": 1480343891, "creation_date": 1480343492, "question_id": 40846738, "link": "https://stackoverflow.com/questions/40846738/golang-testing-of-functions-declared-as-variable-testify", "title": "Golang testing of functions declared as variable (testify)", "body": "<p>I have a problem firing a function declared as variable in golang with testify.</p>\n\n<p>Test and function both declared in same package.</p>\n\n<pre><code>var testableFunction = func(abc string) string {...}\n</code></pre>\n\n<p>now i have a different file with unit test calling testableFunction</p>\n\n<pre><code>func TestFunction(t *testing.T){\n     ...\n     res:=testableFunction(\"abc\")\n     ...\n}\n</code></pre>\n\n<p>Calling TestFunction with <code>go test</code> does not fire any exception, but testableFunction is actually never run. Why?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1480343574, "post_id": 40846695, "comment_id": 68910206, "body": "A panic is a programmer error or some other <i>unrecoverable</i> condition. No std library packages panic due to normal error conditions (nor should 3rd packages either, but we obviously can&#39;t guarantee that)."}, {"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480343718, "post_id": 40846695, "comment_id": 68910307, "body": "The whole question is how do you define <b>normal error conditions</b>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1480344527, "post_id": 40846695, "comment_id": 68910769, "body": "Networking errors are certainly in the &quot;normal&quot; category; they are an expected condition when using a network. To rephrase, you should only get a panic from a <i>programming</i> error, i.e. dereferencing a nil pointer, indexing a slice out of bounds, illegal operations through reflection, etc."}, {"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480347964, "post_id": 40846695, "comment_id": 68913070, "body": "What happen if I try writing to closed connection?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1480348002, "post_id": 40846695, "comment_id": 68913102, "body": "@Aminadav: The <code>error</code> returned from the <code>Write</code> call should be non-nil."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1480348072, "post_id": 40846695, "comment_id": 68913156, "body": "@Aminadav: that depends on how it was closed, and the state of the TCP connection, so you may or may not see an error value from the Write. It will never panic."}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1480423285, "post_id": 40846695, "comment_id": 68947646, "body": "You can&#39;t guarantee there won&#39;t ever be a bug in those two lines of code, now or in  a different version. So maybe in this critical code you should be prepared to have a panic and implement a transaction anyway (with a timeout). The code that performs the transaction might be faulty too, and you will have to be careful. However, it can be heavily tested separately and won&#39;t need to be changed as often as business needs."}], "answers": [{"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": true, "score": 2, "last_activity_date": 1480360939, "last_edit_date": 1592644375, "creation_date": 1480359029, "answer_id": 40851394, "question_id": 40846695, "link": "https://stackoverflow.com/questions/40846695/golang-is-a-network-condition-can-make-a-net-http-handlefunc-to-panic/40851394#40851394", "title": "Golang: Is a network condition can make a net/http HandleFunc to panic?", "body": "<p>The <code>HandlerFunc</code> itself doesn't related to any potential networking issues, it just registers handlers to url patterns.\n<a href=\"https://golang.org/pkg/net/http/#HandleFunc\" rel=\"nofollow noreferrer\">HandlerFunc</a></p>\n<p>With 0 timeouts it will hang not panic. The better way is to use timeouts and handle errors instead of using default timeouts.</p>\n<blockquote>\n<p>More control over the server's behavior is available by creating a custom Server:</p>\n</blockquote>\n<pre><code>s := &amp;http.Server{\n    Addr:           &quot;:8080&quot;,\n    Handler:        myHandler,\n    ReadTimeout:    10 * time.Second,\n    WriteTimeout:   10 * time.Second,\n    MaxHeaderBytes: 1 &lt;&lt; 20,\n}\nlog.Fatal(s.ListenAndServe())\n</code></pre>\n<p>And you shouldn't apprehend a <code>panic</code> from a built-in libs.</p>\n<p><a href=\"https://gobyexample.com/panic\" rel=\"nofollow noreferrer\">Go By Example</a>:</p>\n<blockquote>\n<p>A panic typically means something went unexpectedly wrong. Mostly we use it to fail fast on errors that shouldn\u2019t occur during normal operation, or that we aren\u2019t prepared to handle gracefully.</p>\n<p>Note that unlike some languages which use exceptions for handling of many errors, in Go it is idiomatic to use error-indicating return values wherever possible.</p>\n</blockquote>\n"}], "owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 40851394, "answer_count": 1, "score": 0, "last_activity_date": 1480360939, "creation_date": 1480343370, "question_id": 40846695, "link": "https://stackoverflow.com/questions/40846695/golang-is-a-network-condition-can-make-a-net-http-handlefunc-to-panic", "title": "Golang: Is a network condition can make a net/http HandleFunc to panic?", "body": "<p>Think about that I have a critical function, that should run all or nothing.</p>\n\n<pre><code>TakeMoneyFromSomeone()\nGiveMoneyToSomeoneElse()\n</code></pre>\n\n<p>My question is: Can I trust Go that the function will not panicing between line1 &amp; line2 when using `net/http.HandleFunc? (The two function are inside my http handler)</p>\n\n<p>I'm focusing only on networking issues. For example: if the client disconnect, or timeout or too long body, or  anything else. There is any networking issue that can make the server panic between line1, and line2? (Those two lines not using network)</p>\n\n<p>If the answer is <em>no</em>. What happened if I try to <code>ResponseWriter.write</code> to a client that closed the connection. Is it will panic?</p>\n"}, {"tags": ["string", "unit-testing", "go", "code-coverage"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480342439, "post_id": 40843808, "comment_id": 68909488, "body": "I would note that very few projects in Go try to maintain 100% test coverage, simply because it&#39;s not a useful metric. You end up with useless or even broken tests that are there only for coverage, and it often forces you to refactor some code awkwardly to run the tests."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480360258, "post_id": 40843808, "comment_id": 68920062, "body": "Agree. It is also possible to 100% coverage without testing everything."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480504989, "post_id": 40843808, "comment_id": 68988013, "body": "I now discovered what you mean. The problem shows up when testing the error code returned by a standard lib function. It can be difficult to induce the return of an error code."}], "answers": [{"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1480335700, "post_id": 40843976, "comment_id": 68905227, "body": "Excellent. Didn&#39;t thought of that. My limit was a constant. So obvious once you see it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1480335922, "last_edit_date": 1480335922, "creation_date": 1480335011, "answer_id": 40843976, "question_id": 40843808, "link": "https://stackoverflow.com/questions/40843808/unit-test-coverage-with-huge-string-length-in-go/40843976#40843976", "title": "Unit test coverage with huge string length in Go?", "body": "<p>Refactor your code, move the limit outside of your function which tests can change:</p>\n\n<pre><code>var limit = 1 &lt;&lt; 32\n\nvar ErrTooLarge = errors.New(\"String is too large!\")\n\nfunc Process(s string) error {\n    if len(s) &gt; limit {\n        return ErrTooLarge\n    }\n    // All OK\n    return nil\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>func TestProcess(t *testing.T) {\n    // Save limit and restore it at the end:\n    old := limit\n    defer func() { limit = old }()\n\n    // Test success\n    if err := Process(\"123\"); err != nil {\n        t.Errorf(\"Expected success, got: %v\", err)\n    }\n\n    // Test failure (too large string)\n    limit = 5\n    if err := Process(\"123456\"); err != ErrTooLarge {\n        t.Errorf(\"Expected ErrTooLarge, got: %v\", err)\n    }\n}\n</code></pre>\n\n<p>Running <code>go test -cover</code>:</p>\n\n<pre><code>PASS\ncoverage: 100.0% of statements\nok      play    0.001s\n</code></pre>\n"}], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 40843976, "answer_count": 1, "score": 0, "last_activity_date": 1480355706, "creation_date": 1480334506, "last_edit_date": 1480355706, "question_id": 40843808, "link": "https://stackoverflow.com/questions/40843808/unit-test-coverage-with-huge-string-length-in-go", "title": "Unit test coverage with huge string length in Go?", "body": "<p>In some code I have a test ensuring that a string length is smaller than <code>2^32</code>. But it is difficult to test since generating a bigger string for testing would probably crash the test program with an out of memory error.</p>\n\n<p>How may I achieve 100% test coverage but still testing for such case just to be safe?</p>\n"}, {"tags": ["mongodb", "sorting", "go", "time", "mgo"], "comments": [{"owner": {"reputation": 29341, "user_id": 6337748, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7Si7m.jpg?s=128&g=1", "display_name": "notionquest", "link": "https://stackoverflow.com/users/6337748/notionquest"}, "edited": false, "score": 1, "creation_date": 1480331546, "post_id": 40842503, "comment_id": 68902804, "body": "Are you getting the results from MongoDB?"}, {"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "reply_to_user": {"reputation": 29341, "user_id": 6337748, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7Si7m.jpg?s=128&g=1", "display_name": "notionquest", "link": "https://stackoverflow.com/users/6337748/notionquest"}, "edited": false, "score": 0, "creation_date": 1480331877, "post_id": 40842503, "comment_id": 68902997, "body": "@notionquest, Yes."}], "answers": [{"comments": [{"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1480332453, "post_id": 40842983, "comment_id": 68903335, "body": "Yep. Thanks for the answer. I understood your intent as well."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1480332584, "last_edit_date": 1480332584, "creation_date": 1480331722, "answer_id": 40842983, "question_id": 40842503, "link": "https://stackoverflow.com/questions/40842503/reverse-chronological-order-of-struct-results/40842983#40842983", "title": "Reverse chronological order of struct/results", "body": "<p>Easiest would be to let MongoDB sort the records:</p>\n\n<pre><code>var results []YourType\nerr := sess.DB(\"\").C(\"collname\").Find(bson.M{\"someid\": \"someidval\"}).\n    Sort(\"-timefield\").All(&amp;results)\n</code></pre>\n\n<p>If for some reason you can't or don't want to do this, you may utilize the <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\"><code>sort</code></a> package. You need to implement <a href=\"https://golang.org/pkg/sort/#Interface\" rel=\"nofollow noreferrer\"><code>sort.Interface</code></a>.</p>\n\n<p>For example:</p>\n\n<pre><code>type YourType struct {\n    SomeId    string\n    Timestamp time.Time\n}\n\ntype ByTimestamp []YourType\n\nfunc (a ByTimestamp) Len() int           { return len(a) }\nfunc (a ByTimestamp) Swap(i, j int)      { a[i], a[j] = a[j], a[i] }\nfunc (a ByTimestamp) Less(i, j int) bool {\n    return a[i].Timestamp.After(a[j].Timestamp)\n}\n</code></pre>\n\n<p>This <code>ByTimestamp</code> type is a slice of <code>YourType</code>, and it defines a reverse timestamp order because the <code>Less()</code> method uses <a href=\"https://golang.org/pkg/time/#Time.After\" rel=\"nofollow noreferrer\"><code>Time.After()</code></a> to decide if element and index <code>i</code> is less than element at index <code>j</code>.</p>\n\n<p>And using it (try it on the <a href=\"https://play.golang.org/p/UmDECyPOmA\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>var results []YourType\n\n// Run your MongoDB query here\n\n// Now sort it by Timestamp decreasing:\nsort.Sort(ByTimestamp(results))\n</code></pre>\n\n<p>An alternative implementation for <code>Less()</code> would be to use <a href=\"https://golang.org/pkg/time/#Time.Before\" rel=\"nofollow noreferrer\"><code>Time.Before()</code></a>, but compare element at index <code>j</code> to index <code>i</code>:</p>\n\n<pre><code>func (a ByTimestamp) Less(i, j int) bool {\n    return a[j].Timestamp.Before(a[i].Timestamp)\n}\n</code></pre>\n\n<p>Try this variant on the <a href=\"https://play.golang.org/p/9GsdWnlDgf\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 40842983, "answer_count": 1, "score": 3, "last_activity_date": 1480332584, "creation_date": 1480330367, "last_edit_date": 1480332345, "question_id": 40842503, "link": "https://stackoverflow.com/questions/40842503/reverse-chronological-order-of-struct-results", "title": "Reverse chronological order of struct/results", "body": "<p>Just started learning goLang.</p>\n\n<p>Wondering how can we sort an struct elements in reverse order in Go. Let's say, I am getting the results from database something like as:</p>\n\n<pre><code>var results []&lt;someClass&gt;\ncollection.C(results).Find(bson.M{\"&lt;someid&gt;\":&lt;id_val&gt;}).All(&amp;results)\n</code></pre>\n\n<p>Now, I have my database objects/results available in slice <code>results</code>. How can I sort the slice <code>results</code> in reverse order on a column called time?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 5, "last_activity_date": 1480323647, "creation_date": 1480323647, "answer_id": 40840445, "question_id": 40840316, "link": "https://stackoverflow.com/questions/40840316/parsing-time-in-golang/40840445#40840445", "title": "Parsing time in Golang", "body": "<p>The layout, if you're not using one of the pre-included constant layout that comes with the time module, must be formed from the exact timestamp <code>Mon Jan 2 15:04:05 -0700 MST 2006</code>. Notice that each element of it is unique, so each numeric identifier can be automatically parsed. it's basically 1 (month), 2 (day), 3 (hour), 4 (minute), 5 (second), 6 (year), 7 (time zone) etc. </p>\n\n<p>It's better to use one of the pre-defined standard layouts that are included with the library:</p>\n\n<pre><code>const (\n        ANSIC       = \"Mon Jan _2 15:04:05 2006\"\n        UnixDate    = \"Mon Jan _2 15:04:05 MST 2006\"\n        RubyDate    = \"Mon Jan 02 15:04:05 -0700 2006\"\n        RFC822      = \"02 Jan 06 15:04 MST\"\n        RFC822Z     = \"02 Jan 06 15:04 -0700\" // RFC822 with numeric zone\n        RFC850      = \"Monday, 02-Jan-06 15:04:05 MST\"\n        RFC1123     = \"Mon, 02 Jan 2006 15:04:05 MST\"\n        RFC1123Z    = \"Mon, 02 Jan 2006 15:04:05 -0700\" // RFC1123 with numeric zone\n        RFC3339     = \"2006-01-02T15:04:05Z07:00\"\n        RFC3339Nano = \"2006-01-02T15:04:05.999999999Z07:00\"\n        Kitchen     = \"3:04PM\"\n        // Handy time stamps.\n        Stamp      = \"Jan _2 15:04:05\"\n        StampMilli = \"Jan _2 15:04:05.000\"\n        StampMicro = \"Jan _2 15:04:05.000000\"\n        StampNano  = \"Jan _2 15:04:05.000000000\"\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 1, "last_activity_date": 1480323994, "creation_date": 1480323994, "answer_id": 40840526, "question_id": 40840316, "link": "https://stackoverflow.com/questions/40840316/parsing-time-in-golang/40840526#40840526", "title": "Parsing time in Golang", "body": "<p>Your layout date is wrong. Should be <code>\"January 2, 2006\"</code>. As the specs say: </p>\n\n<blockquote>\n  <p>The layout defines the format by showing how the reference time,\n  defined to be <code>Mon Jan 2 15:04:05 -0700 MST 2006</code> would be interpreted\n  if it were the value</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 1, "last_activity_date": 1480325534, "last_edit_date": 1592644375, "creation_date": 1480325534, "answer_id": 40840998, "question_id": 40840316, "link": "https://stackoverflow.com/questions/40840316/parsing-time-in-golang/40840998#40840998", "title": "Parsing time in Golang", "body": "<p>You should treat it as an example which you provide to <code>time.Provide</code>. And it should be of concrete value described in the documentation.</p>\n<blockquote>\n<p>Parse parses a formatted string and returns the time value it represents. The layout defines the format by showing how the reference time, defined to be</p>\n<p>Mon Jan 2 15:04:05 -0700 MST 2006</p>\n</blockquote>\n<p><a href=\"https://play.golang.org/p/aY5g2LVyuz\" rel=\"nofollow noreferrer\">A playground with correct variant.</a></p>\n"}], "owner": {"reputation": 2273, "user_id": 759856, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/14e1ba14b703535e21680c6e2c8e0d59?s=128&d=identicon&r=PG", "display_name": "zuzuleinen", "link": "https://stackoverflow.com/users/759856/zuzuleinen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1752, "favorite_count": 0, "accepted_answer_id": 40840526, "answer_count": 3, "score": -1, "last_activity_date": 1480325534, "creation_date": 1480323229, "question_id": 40840316, "link": "https://stackoverflow.com/questions/40840316/parsing-time-in-golang", "title": "Parsing time in Golang", "body": "<p>I'm trying to create a Time struct based on some input called dateAdded. My code is like this:</p>\n\n<pre><code>dateAdded := \"November 25, 2016\"\nlayout := \"September 9, 2016\"\nt, err := time.Parse(layout, dateAdded)\nif err != nil {\n    fmt.Println(err)\n} else {\n    fmt.Println(t)\n}\n</code></pre>\n\n<p>And I get the following error: <em>parsing time \"November 25, 2016\" as \"September 9, 2016\": cannot parse \"November 25, 2016\" as \"September 9,</em> \"</p>\n\n<p>I assume the Parse function cannot parse every layout, but I'm curios what's the usual way of reading dates and parse them into time objects.</p>\n"}, {"tags": ["database", "postgresql", "go", "beego"], "comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1480327437, "post_id": 40839370, "comment_id": 68900233, "body": "Please simplify your code snippet or provide a concrete line which raises the error. We can&#39;t build all your application and debug it."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1480327580, "post_id": 40839370, "comment_id": 68900317, "body": "And one more significant thing - your error doesn&#39;t related to sql or any libs you use. It is just a wrong pointer operation."}, {"owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "reply_to_user": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1480328214, "post_id": 40839370, "comment_id": 68900653, "body": "sorry.Beginner on  stack overflow. Thanks for your advice \u2013 I159 .Edited the code to be precise.May i know which pointer is the problem.Thanks"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1480328788, "post_id": 40839370, "comment_id": 68900979, "body": "it is OK, just read the tutorial &quot;how to ask&quot; on stackoverflow. I will try to help you."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1480342395, "post_id": 40839370, "comment_id": 68909448, "body": "Please specify the line which crashes with the mentioned error."}], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": false, "score": 0, "last_activity_date": 1480328127, "creation_date": 1480328127, "answer_id": 40841753, "question_id": 40839370, "link": "https://stackoverflow.com/questions/40839370/create-table-in-postgres-with-json-type-field-using-golang/40841753#40841753", "title": "Create table in Postgres with json type field using GoLang", "body": "<p>I think that your problem is the invalid sql used to create the table, it should be:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE apply_leave1 (\n    leaveid serial PRIMARY KEY NOT NULL ,\n    empid varchar(10) NOT NULL ,\n    leavedays double precision NOT NULL DEFAULT 0 ,\n    mdays double precision NOT NULL DEFAULT 0 ,\n    leavetype varchar(20) NOT NULL DEFAULT '' ,\n    daytype text NOT NULL DEFAULT '',\n    leavefrom timestamp with time zone NOT NULL,\n    leaveto timestamp with time zone NOT NULL,\n    applieddate timestamp with time zone NOT NULL,\n    leavestatus varchar(15) NOT NULL DEFAULT ''  ,\n    resultdate timestamp with time zone,\n    certificatestatus bool NOT NULL DEFAULT FALSE \n    certificate json NULL)\n</code></pre>\n\n<p>You miss the <code>DEFAULT</code> for daytype column. Also, you're not catching correctly the errors, because the func leave() can be executed totally before send a response. You can use a <code>return</code> when you find an error.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>db, err := sql.Open(\"postgres\", conn)\nif err != nil {\n    fmt.Println(err.Error())\n    e.Data[\"json\"] = err.Error()\n    e.ServeJSON()\n    return\n}\n</code></pre>\n\n<p>Also, you're creating a connection and not closing it at the end of the func.</p>\n"}], "owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1418, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1480328127, "creation_date": 1480319271, "last_edit_date": 1480328077, "question_id": 40839370, "link": "https://stackoverflow.com/questions/40839370/create-table-in-postgres-with-json-type-field-using-golang", "title": "Create table in Postgres with json type field using GoLang", "body": "<p>I am using GoLang in the back-end and PostgreSQL as a database. I'm new to PostgreSQL database connections with Go. I'm using <a href=\"https://beego.me/docs/intro/\" rel=\"nofollow noreferrer\">Beego</a> as a back-end. I want to create a table with one of a fields of JSON type using Golang <a href=\"https://golang.org/pkg/database/sql/\" rel=\"nofollow noreferrer\">database/sql</a> package and <a href=\"https://godoc.org/github.com/lib/pq\" rel=\"nofollow noreferrer\">lib/pq</a>. That what I do </p>\n\n<p>This is my create table query</p>\n\n<pre><code>createtable:= `CREATE TABLE apply_leave1 (\n                leaveid serial PRIMARY KEY NOT NULL ,\n                empid varchar(10) NOT NULL ,\n                leavedays double precision NOT NULL DEFAULT 0 ,\n                mdays double precision NOT NULL DEFAULT 0 ,\n                leavetype varchar(20) NOT NULL DEFAULT '' ,\n                daytype text NOT NULL '',\n                leavefrom timestamp with time zone NOT NULL,\n                leaveto timestamp with time zone NOT NULL,\n                applieddate timestamp with time zone NOT NULL,\n                leavestatus varchar(15) NOT NULL DEFAULT ''  ,\n                resultdate timestamp with time zone,\n                certificatestatus bool NOT NULL DEFAULT FALSE \n                certificate json NULL)`\n\n\n\n    conn := fmt.Sprintf(\n        \"user=%s password=%s dbname=%s sslmode=disable\",\n        \"postgres\",\n        \"root\",\n        \"employee\")\n    log.Println(\"Creating a new connection: %v\", conn)\n\n    db, err := sql.Open(\"postgres\", conn)\n\n    stmt, err1 := db.Prepare(createtable)\n\n    defer stmt.Close()\n    _, err = stmt.Exec()\n    if err != nil {\n        fmt.Println(err.Error()\n    }\n\n}\n</code></pre>\n\n<p>This is throwing me the following error</p>\n\n<blockquote>\n  <p>Handler crashed with error runtime error: invalid memory address or nil pointer dereference</p>\n</blockquote>\n\n<p>But when I'm using query to select something from the table there is no problem with table creation query or other executed sql code. I appreciate any help. Thanks!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480319774, "post_id": 40838488, "comment_id": 68895971, "body": "Thanks for pointing out the implementation location. And as a real-world example, the HTML page at <code>https:&#47;&#47;golang.org&#47;x&#47;net&#47;html</code> contains the <code>go-import</code> meta tag."}], "tags": [], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "is_accepted": true, "score": 5, "last_activity_date": 1480320548, "last_edit_date": 1480320548, "creation_date": 1480315403, "answer_id": 40838488, "question_id": 40838321, "link": "https://stackoverflow.com/questions/40838321/how-does-go-get-get-to-know-what-version-control-system-to-use-with-remote-rep/40838488#40838488", "title": "How does &quot;go get&quot; get to know what version control system to use with remote repos?", "body": "<p>One of the nice things about Go is that everything is in, well, Go :-) Including almost all of the standard library and tools.</p>\n\n<p>In <a href=\"https://github.com/golang/go/blob/master/src/cmd/go/vcs.go\" rel=\"nofollow noreferrer\"><code>cmd/go/vcs.go</code></a> we can see how this is done, and in <a href=\"https://github.com/golang/go/blob/master/src/cmd/go/alldocs.go\" rel=\"nofollow noreferrer\"><code>cmd/go/alldocs.go</code></a> it is documented. </p>\n\n<p>Specifically, look at <code>repoRootForImportPath</code>:</p>\n\n<pre><code>// repoRootForImportPath analyzes importPath to determine the\n// version control system, and code repository to use.\nfunc repoRootForImportPath(importPath string, security securityMode) (*repoRoot, error) {\n</code></pre>\n\n<p>What this does is:</p>\n\n<ol>\n<li><p><code>vcsPaths</code> holds a static lists of \"known hosts\". For some (e.g. GitHub) this is easy and we can just set the VCS. For others (e.g. BitBucket) a callback function is used which examines the URL to see which repo can be used.</p></li>\n<li><p>If that fails, it tries to look at a \"VCS extension\" in the path, such as <code>example.com/foo.git</code> or <code>example.com/foo.git/dir</code>.</p></li>\n<li><p>And finally <code>go get</code> will look for a <code>go-import</code> meta tag, which looks like:</p>\n\n<pre><code>&lt;meta name=\"go-import\" content=\"example.com/path git https://github.com/Example/repo.git\"&gt;\n</code></pre>\n\n<p>Also see <code>parseMetaGoImports()</code>. <a href=\"https://npf.io/2016/10/vanity-imports-with-hugo/\" rel=\"nofollow noreferrer\">Vanity Imports with Hugo</a> is a nice introduction on how to use this.</p></li>\n</ol>\n\n<p>There is no real \"auto-detection\" mechanism. So if you repo lives at <code>https://example.com/stuff</code> then <code>go get example.com/stuff</code> will <em>not</em> work. You <em>need</em> the extension or meta tags.</p>\n\n<p>The <code>go-get=1</code> parameter is added so that it's easy for website builders to see that this is a request from <code>go get</code>, which may be useful in some cases.</p>\n"}], "owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 2, "accepted_answer_id": 40838488, "answer_count": 1, "score": 3, "last_activity_date": 1480320548, "creation_date": 1480314586, "question_id": 40838321, "link": "https://stackoverflow.com/questions/40838321/how-does-go-get-get-to-know-what-version-control-system-to-use-with-remote-rep", "title": "How does &quot;go get&quot; get to know what version control system to use with remote repos?", "body": "<p>I am new to golang. I learned that <code>go get</code> serves as a package manager and contact remote repos with various version control systems. </p>\n\n<p>So, given a package import path, how does <code>go get</code> decide which VCS to use?  I always see below query string in the reqeust:</p>\n\n<pre><code>?go-get=1\n</code></pre>\n\n<p>So seems some protocol/convention here?</p>\n"}, {"tags": ["javascript", "html", "css", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1480322687, "post_id": 40838306, "comment_id": 68897394, "body": "Asked <a href=\"https://groups.google.com/d/topic/golang-nuts/67FfXqaBdk8/discussion\" rel=\"nofollow noreferrer\">here</a> as well."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7197274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d43d0a387994d31c6209dd463e261e7?s=128&d=identicon&r=PG&f=1", "display_name": "acer89", "link": "https://stackoverflow.com/users/7197274/acer89"}, "edited": false, "score": 0, "creation_date": 1480315584, "post_id": 40838400, "comment_id": 68894133, "body": "How would I read this in my go file?"}, {"owner": {"reputation": 1658, "user_id": 7156345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SZVmt.jpg?s=128&g=1", "display_name": "Laxman Gite", "link": "https://stackoverflow.com/users/7156345/laxman-gite"}, "reply_to_user": {"reputation": 35, "user_id": 7197274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d43d0a387994d31c6209dd463e261e7?s=128&d=identicon&r=PG&f=1", "display_name": "acer89", "link": "https://stackoverflow.com/users/7197274/acer89"}, "edited": false, "score": 0, "creation_date": 1480315884, "post_id": 40838400, "comment_id": 68894242, "body": "Check this link you will get event as well : <a href=\"http://www.bootstraptoggle.com/\" rel=\"nofollow noreferrer\">bootstraptoggle.com</a>"}], "tags": [], "owner": {"reputation": 1658, "user_id": 7156345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SZVmt.jpg?s=128&g=1", "display_name": "Laxman Gite", "link": "https://stackoverflow.com/users/7156345/laxman-gite"}, "is_accepted": false, "score": 0, "last_activity_date": 1480314984, "creation_date": 1480314984, "answer_id": 40838400, "question_id": 40838306, "link": "https://stackoverflow.com/questions/40838306/golang-how-to-access-html-css-toggle-switch-value-in-go/40838400#40838400", "title": "Golang: How to access html/css toggle switch value in go", "body": "<p>Check Below code for On/Off Event :</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$('input[name=\"my-checkbox\"]').on('switchChange.bootstrapSwitch', function(event, state) {\n  console.log(this); // DOM element\n  console.log(event); // jQuery event\n  console.log(state); // true | false\n});\n</code></pre>\n\n\n"}], "owner": {"reputation": 35, "user_id": 7197274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d43d0a387994d31c6209dd463e261e7?s=128&d=identicon&r=PG&f=1", "display_name": "acer89", "link": "https://stackoverflow.com/users/7197274/acer89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "closed_date": 1480324248, "answer_count": 1, "score": -1, "last_activity_date": 1480319849, "creation_date": 1480314510, "last_edit_date": 1480319849, "question_id": 40838306, "link": "https://stackoverflow.com/questions/40838306/golang-how-to-access-html-css-toggle-switch-value-in-go", "closed_reason": "Duplicate", "title": "Golang: How to access html/css toggle switch value in go", "body": "<p>I am trying to implement a toggle switch in my webpage. I've followed the site below for doing so:</p>\n\n<p><a href=\"http://www.w3schools.com/howto/howto_css_switch.asp\" rel=\"nofollow noreferrer\">w3schools.com</a></p>\n\n<p>I currently have my html file set up with a button and this toggle switch. I also configured my webserver in go to be listening on localhost:8080. And I have a websocket handler configured, so that I can easily pass data through to my webpage on the click of the button.</p>\n\n<p>What I want to do create a toggle switch on my webpage that the user can switch on and off, and then have them click a button. After that button is clicked I want to analyse the users selection using an if condition in my golang code based on whether this toggle switch is on/off, but I cannot figure out how to access this value in go. Any suggestions would be helpful. Also, it'd be ideal to have a toggle switch implemented, but if anyone has any simpler ideas for this use case then I'd be open to them.</p>\n"}, {"tags": ["go", "docker", "vagrant", "docker-compose"], "comments": [{"owner": {"reputation": 17055, "user_id": 164966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c72f100bc09518cd468b9fe146f1f22?s=128&d=identicon&r=PG", "display_name": "R0MANARMY", "link": "https://stackoverflow.com/users/164966/r0manarmy"}, "edited": false, "score": 0, "creation_date": 1480304461, "post_id": 40836586, "comment_id": 68890847, "body": "If you ssh into your Vagrant box, can you curl the go web service?"}, {"owner": {"reputation": 1201, "user_id": 1636905, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05996bb64a3b362a91f40a6e13f088d0?s=128&d=identicon&r=PG", "display_name": "Lee Jacobs", "link": "https://stackoverflow.com/users/1636905/lee-jacobs"}, "reply_to_user": {"reputation": 17055, "user_id": 164966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c72f100bc09518cd468b9fe146f1f22?s=128&d=identicon&r=PG", "display_name": "R0MANARMY", "link": "https://stackoverflow.com/users/164966/r0manarmy"}, "edited": false, "score": 0, "creation_date": 1480304968, "post_id": 40836586, "comment_id": 68890976, "body": "@R0MANARMY it either gives me a Recv failure: connection reset by peer or and empty reply from server unfortunately"}, {"owner": {"reputation": 3178, "user_id": 972966, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77e82beae0d15e24aff8b28d7b9213c8?s=128&d=identicon&r=PG", "display_name": "JazzCat", "link": "https://stackoverflow.com/users/972966/jazzcat"}, "edited": false, "score": 0, "creation_date": 1480357774, "post_id": 40836586, "comment_id": 68918753, "body": "What is the output of docker-compose logs app"}], "owner": {"reputation": 1201, "user_id": 1636905, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05996bb64a3b362a91f40a6e13f088d0?s=128&d=identicon&r=PG", "display_name": "Lee Jacobs", "link": "https://stackoverflow.com/users/1636905/lee-jacobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480302255, "creation_date": 1480302255, "question_id": 40836586, "link": "https://stackoverflow.com/questions/40836586/cant-get-localhost-to-connect-to-docker-inside-vagrant", "title": "Can&#39;t get localhost to connect to docker inside vagrant", "body": "<p>I'm trying to build a local dev environment for GoLang.</p>\n\n<p>My environment would consist of a VirtualBox VM using ubuntu and inside I'd use docker-compose to build out my different pieces.</p>\n\n<p>All other pieces of my environment work, except for golang. </p>\n\n<p>When I attempt to get a simple hello world HTTP response it get back \"ERR_SOCKET_NOT_CONNECTED\" inside chrome. </p>\n\n<p>My vagrant file looks like </p>\n\n<pre><code>Vagrant.configure(\"2\") do |config|\n  config.vm.box =  \"ubuntu/trusty64\"\n\n  port = 3000\n  config.vm.hostname = \"vagrant-docker-example\"\n  config.vm.network(:forwarded_port, guest: port, host: port)\n  config.vm.network(:forwarded_port, guest: 8080, host: 8080)\n  config.vm.network(:forwarded_port, guest: 80, host: 4567)\n\n\n  config.vm.provision :shell, inline: \"apt-get update\"\n  config.vm.provision :docker\n  config.vm.provision :docker_compose, env: { \"PORT\" =&gt; \"#{port}\" }, yml: [\"/vagrant/docker-compose-base.yml\",\"/vagrant/docker-compose.yml\"], rebuild: true, project_name: \"myproject\", run: \"always\"\nend\n</code></pre>\n\n<p>and my docker-compose file looks like</p>\n\n<pre><code>app:\n  build: ./\n  links:\n    - redis\n  ports:\n    - \"${PORT}:8080\"\n\nnginx:\n    image: nginx:latest\n    ports:\n        - 80:80\n</code></pre>\n\n<p>finally my docker file looks like</p>\n\n<pre><code># Start from a Debian image with the latest version of Go installed\n# and a workspace (GOPATH) configured at /go.\nFROM golang\n\n# Copy the local package files to the container's workspace.\nADD . $GOPATH/src/github.com/sinangedik/vagrant-docker-go-example\n\n#Build\nRUN go get github.com/tools/godep &amp;&amp;\\\n    cd $GOPATH/src/github.com/sinangedik/vagrant-docker-go-example &amp;&amp;\\\n    godep go build\n\n#Give the ownership to daemon\nRUN [\"chown\", \"-R\", \"daemon\", \".\"]\nUSER daemon\n#Set the port\nENV PORT 3000\n# Document that the service listens on port 8080.\nEXPOSE 3000\nCMD [\"/go/src/github.com/sinangedik/vagrant-docker-go-example/vagrant-docker-go-example\"]\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n\n<p>the Vagrant call is being run inside windows 10.</p>\n"}, {"tags": ["go", "io", "buffer"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1480283852, "post_id": 40834275, "comment_id": 68886339, "body": "There&#39;s a data race on the bytes.Buffer. Run your application <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">with the race detector</a>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1480290192, "post_id": 40834275, "comment_id": 68887816, "body": "Also, describe the higher-level problem you are trying to solve.  The best solution to that problem may not involve a bytes.Buffer."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480349401, "post_id": 40834275, "comment_id": 68913936, "body": "Besides the data race conditions, there isn&#39;t any logical synchronization between the copy goroutine and the reading goroutine, so the program may exit before the the reads are complete, or your copy function could write to the buffer between the Read and Reset calls, losing data. You need synchronization between the read and the write loops, or they need to be on opposite sides of a FIFO, like an io.Pipe. (You also don&#39;t ever need single-case select statements)"}, {"owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1480354509, "post_id": 40834275, "comment_id": 68917002, "body": "@MellowMarmot I&#39;ve updated the example with a new one that doesn&#39;t have a race."}, {"owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480354725, "post_id": 40834275, "comment_id": 68917135, "body": "@JimB Take a look at the new example. I&#39;m basically looking for some buffer where I can keep writing things perpetually, and then at some point, read what I&#39;ve buffered so far. bytes.Buffer doesn&#39;t seem to be doing what I want it to here. I&#39;ve actually solved this now for my specific problem using a bufio.Writer, but I still don&#39;t understand why the bytes.Buffer approach wouldn&#39;t work."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480358017, "post_id": 40834275, "comment_id": 68918881, "body": "@Dave: see the first comment, you have a race condition on the bytes.Buffer."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1480359621, "post_id": 40834275, "comment_id": 68919694, "body": "@Dave Copy the code in the playground to main.go and <code>go run -race main.go</code>.   You will see there&#39;s still a race."}], "answers": [{"comments": [{"owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "edited": false, "score": 0, "creation_date": 1480516344, "post_id": 40851208, "comment_id": 68995616, "body": "Thanks for this. This is a much smarter way of solving the problem. :) I think if I need to do a long running io.Copy again, I will definitely use a pipe, rather than bytes.Buffer, especially since it isn&#39;t safe for concurrent access, which I didn&#39;t realise initially. I can buffer on the other end of the pipe then."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "edited": false, "score": 1, "creation_date": 1480516436, "post_id": 40851208, "comment_id": 68995679, "body": "@Dave: it&#39;s good to note that <i>no</i> data structures in Go are safe for concurrent access, unless specifically documented as such."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1480454419, "last_edit_date": 1480454419, "creation_date": 1480358225, "answer_id": 40851208, "question_id": 40834275, "link": "https://stackoverflow.com/questions/40834275/long-running-copy-to-bytes-buffer/40851208#40851208", "title": "Long running copy to bytes.Buffer", "body": "<p>You can't synchronize your Read calls with the writes that are happening on the <code>bytes.Buffer</code> in the <code>io.Copy</code>. Even if you wrap the <code>bytes.Buffer</code> in a struct to lock the Read/Write methods, you are going to deadlock when the Copy is waiting on a Write while the ReadAll is blocked on the Read. You either need to do the copy manually, and properly serialize all access, or separate the reads and writes with an <code>io.Pipe</code>.</p>\n\n<p>If you use a FIFO (<code>io.Pipe</code>) to synchronize reads and writes, you don't need any extra locks or channels to tail the first <code>io.Reader</code>. Here's an example <code>read</code> function that either prints when its buffer is full, or waits some interval since the last print statement:</p>\n\n<pre><code>func read(r io.Reader) {\n    buf := make([]byte, 1024)\n    pos := 0\n    lastPrint := time.Now()\n    for {\n        n, err := r.Read(buf[pos:])\n        if n &gt; 0 {\n            pos += n\n        }\n\n        if pos &gt;= len(buf) || time.Since(lastPrint) &gt; 125*time.Millisecond &amp;&amp; pos &gt; 0 {\n            fmt.Println(\"read:\", buf[:pos])\n            lastPrint = time.Now()\n            pos = 0\n        }\n\n        if err != nil {\n            fmt.Println(err)\n            break\n        }\n    }\n\n    if pos &gt; 0 {\n        fmt.Println(\"read:\", buf[:pos])\n    }\n}\n\nfunc main() {\n    pr, pw := io.Pipe()\n    go func() {\n        io.Copy(pw, &amp;trickle{})\n        pw.Close()\n    }()\n    read(pr)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/8NeV3v0LOU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8NeV3v0LOU</a></p>\n"}], "owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2586, "favorite_count": 0, "accepted_answer_id": 40851208, "answer_count": 1, "score": 1, "last_activity_date": 1480454419, "creation_date": 1480283086, "last_edit_date": 1480354439, "question_id": 40834275, "link": "https://stackoverflow.com/questions/40834275/long-running-copy-to-bytes-buffer", "title": "Long running copy to bytes.Buffer", "body": "<p>I have a long lived <code>io.Reader</code> which returns some data every few seconds (never EOF), and a goroutine which does an <code>io.Copy</code> from that reader to a <code>bytes.Buffer</code> (also never terminates). Something like so:</p>\n\n<pre><code>var src io.Reader\nvar buf bytes.Buffer\n\nfunc main() {\n    go io.Copy(&amp;buf, src)\n    // Do stuff. Read from the buffer periodically.\n}\n</code></pre>\n\n<p>What I don't understand is that I see strange results when I try to read from that buffer. It doesn't matter whether I call <code>buf.Bytes()</code> or <code>ioutil.ReadAll(&amp;buf)</code> or anything, I just see the first bytes written to the buffer over and over again.</p>\n\n<p><a href=\"https://play.golang.org/p/yn0JPrvohV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yn0JPrvohV</a></p>\n\n<p>My question is, what am I doing wrong? Can I use <code>bytes.Buffer</code> in this way (<code>io.Copy</code> to it and read periodically)?</p>\n"}, {"tags": ["datetime", "go", "snmp", "gosnmp", "octetstring"], "answers": [{"comments": [{"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1480280108, "post_id": 40833102, "comment_id": 68885167, "body": "some eg or snippet would be very helpful, i already read and tried various options about converting that."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 1, "creation_date": 1480294628, "post_id": 40833102, "comment_id": 68888780, "body": "Sorry, was answering from my phone and thought that might get you started. I&#39;ll put in an example when next in front of a computer (if someone else doesn&#39;t do it first)."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1480304823, "post_id": 40833102, "comment_id": 68890935, "body": "Before I add more information to my answer, do you want to create a Go <code>Time</code> value out of that information or do you just need to print the date and time in the format you showed? Also, can you tell me what aspect of this is giving you difficulty?"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1480304920, "post_id": 40833102, "comment_id": 68890960, "body": "the problem I am facing right now is while converting to string from the byte array, when i tried i got something like this <code>\ufffd*</code> which is not readable. <a href=\"https://play.golang.org/p/CXhjkazUvA\" rel=\"nofollow noreferrer\">play.golang.org/p/CXhjkazUvA</a>"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1480306654, "post_id": 40833102, "comment_id": 68891339, "body": "The byte slice contains the octets as described in the SNMP data and time format (link in my answer). Each byte (or two bytes in the case of the year) contains one component of the date and time. The sequence of bytes itself is not a string \u2013 it&#39;s a set of numeric values as described in the format specification. It looks like your <code>Convert2String</code> function is looking for a 0 byte as an indication of the end of the string, but that&#39;s not appropriate here. See <a href=\"https://play.golang.org/p/fICpTdk-2r\" rel=\"nofollow noreferrer\">play.golang.org/p/fICpTdk-2r</a>."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 0, "creation_date": 1480306806, "post_id": 40833102, "comment_id": 68891377, "body": "Awesome, could you please update in your answer, so i can accept it. thank you so much."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1480307122, "last_edit_date": 1495540383, "creation_date": 1480275540, "answer_id": 40833102, "question_id": 40832472, "link": "https://stackoverflow.com/questions/40832472/converting-datetime-octetstring-to-human-readable-string-in-golang/40833102#40833102", "title": "Converting datetime OctetString to human readable string in GoLang", "body": "<p>The format is described here: <a href=\"https://stackoverflow.com/questions/4571899/convert-snmp-octet-string-to-human-readable-date-format\">Convert snmp octet string to human readable date format</a></p>\n\n<p>If you just need to create a date/time string in the format you mentioned, this will do it:</p>\n\n<pre><code>func snmpTimeString(c []byte) string {\n    year := (int(c[0]) &lt;&lt; 8) | int(c[1])\n    return fmt.Sprintf(\"%d-%d-%d,%02d:%02d:%02d.%d,%c%d:%d\", year, c[2], c[3], c[4], c[5], c[6], c[7], c[8], c[9], c[10])\n}\n\nfunc main() {\n    c := []byte{0x7, 0xe0, 0x1, 0x1c, 0x14, 0x4, 0x2a, 0x0, 0x2b, 0x0, 0x0}\n    fmt.Println(snmpTimeString(c))\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/7WwQbPuESC\" rel=\"nofollow noreferrer\">https://play.golang.org/p/7WwQbPuESC</a>.</p>\n"}], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 1, "accepted_answer_id": 40833102, "answer_count": 1, "score": 1, "last_activity_date": 1480307122, "creation_date": 1480271787, "last_edit_date": 1495540798, "question_id": 40832472, "link": "https://stackoverflow.com/questions/40832472/converting-datetime-octetstring-to-human-readable-string-in-golang", "title": "Converting datetime OctetString to human readable string in GoLang", "body": "<p>How to convert Datetime Octetstring to ASCII. I read through one of the example in <a href=\"https://stackoverflow.com/questions/4571899/convert-snmp-octet-string-to-human-readable-date-format\">python netsnmp</a> but still not able to solve it.</p>\n\n<p>This is what I received from <a href=\"https://godoc.org/github.com/soniah/gosnmp\" rel=\"nofollow noreferrer\">gosnmp</a> as slice of <code>[]uint8</code></p>\n\n<pre><code>[7 224 1 28 20 5 42 0 43 0 0]\n</code></pre>\n\n<p>or Go-syntax representation of the value</p>\n\n<pre><code>[]byte{0x7, 0xe0, 0x1, 0x1c, 0x14, 0x4, 0x2a, 0x0, 0x2b, 0x0, 0x0}\n</code></pre>\n\n<p>And output in datetime should be something like this:</p>\n\n<pre><code>2015-10-7,17:23:27.0,+0:0\n</code></pre>\n\n<p>here is the mibs:oid: <code>HOST-RESOURCES-MIB::hrSWInstalledDate</code></p>\n\n<p>Can someone give me some idea on how to use <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow noreferrer\">binary</a> to decode that into human readable ascii or strings.</p>\n"}, {"tags": ["go", "split", "range"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "edited": false, "score": 0, "creation_date": 1480267038, "post_id": 40831462, "comment_id": 68880960, "body": "The file exactly as shown in the question with exactly 2 lines, no extra line at the bottom, like your eofSlice string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "edited": false, "score": 0, "creation_date": 1480268023, "post_id": 40831462, "comment_id": 68881267, "body": "@user2443447 After you check <code>err</code>, does <code>fmt.Fprintln(os.Stderr, data[len(data)-1])</code> print <code>10</code>? If so, then you have a set of bytes like <code>extraSlice</code>, not <code>eofSlice</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "edited": false, "score": 0, "creation_date": 1480268437, "post_id": 40831462, "comment_id": 68881402, "body": "You can <a href=\"https://play.golang.org/p/xCv0XN6gv4\" rel=\"nofollow noreferrer\">see another Playground example</a> if you wish. It uses pretty much the same code as your question, except files are replaced with strings."}, {"owner": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "edited": false, "score": 0, "creation_date": 1480270943, "post_id": 40831462, "comment_id": 68882221, "body": "You&#39;re right.  There was an extra \\r\\n at the end even though gvim didn&#39;t show it.  Hex mode showed it.  Notepad++ was more accurate.  Thank you for your help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": true, "score": 1, "last_activity_date": 1480266278, "last_edit_date": 1480266278, "creation_date": 1480265976, "answer_id": 40831462, "question_id": 40830868, "link": "https://stackoverflow.com/questions/40830868/split-includes-eof/40831462#40831462", "title": "split includes EOF?", "body": "<p>If your file ends with a newline sequence, splitting the file content on newline sequences will result in an extraneous empty string. If EOF occurred before a final newline sequence was read, then you don't get that empty string:</p>\n\n<pre><code>eofSlice := strings.Split(\"Hello\\r\\nWorld\", \"\\r\\n\")\nextraSlice := strings.Split(\"Hello\\r\\nWorld\\r\\n\", \"\\r\\n\")\n\n// [Hello World] 2\nfmt.Println(eofSlice, len(eofSlice))\n\n// [Hello World ] 3\nfmt.Println(extraSlice, len(extraSlice))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/0r4SlSe78X\" rel=\"nofollow noreferrer\">Playground link</a></p>\n"}], "owner": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 40831462, "answer_count": 1, "score": 0, "last_activity_date": 1480266278, "creation_date": 1480262379, "question_id": 40830868, "link": "https://stackoverflow.com/questions/40830868/split-includes-eof", "title": "split includes EOF?", "body": "<p>I'm trying to run gopl.io/ch1/dup3 program from Donovan book on windows 7 using go version 1.7.3.</p>\n\n<p>When I run the below program test.go, I get an empty line at the end.  Is that for EOF? How do I distinguish it from an actual empty line?</p>\n\n<pre><code>package main\nimport (\n  \"fmt\"\n  \"io/ioutil\"\n  \"os\"\n  \"strings\"\n)\nfunc main() {\n   Counts := make(map[string]int)\n   for _, filename := range os.Args[1:] {\n   data, err := ioutil.ReadFile(filename)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"%s: %v\\n\", os.Args[0], err)\n        continue\n    }\n    for _, line := range strings.Split(string(data), \"\\r\\n\") {\n        counts[line]++\n    }\n  }\n  for line, n := range counts {\n    if n &gt; 1 {\n        fmt.Printf(\"%d\\t%s\\n\", n, line)\n    }\n  }\n}\n</code></pre>\n\n<p>with test.dat file:</p>\n\n<pre><code>Line number one\nLine number two\n</code></pre>\n\n<p>Command:</p>\n\n<pre><code>&gt; test.exe test.dat test.dat\n</code></pre>\n\n<p>Output is</p>\n\n<pre><code>2       Line number one  \n2       Line number two  \n2                           &lt;-- Here is the empty line.\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 179, "user_id": 680906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d0acd7c48668139953457729851453?s=128&d=identicon&r=PG", "display_name": "whytheplatypus", "link": "https://stackoverflow.com/users/680906/whytheplatypus"}, "is_accepted": true, "score": 5, "last_activity_date": 1480255753, "creation_date": 1480255753, "answer_id": 40829843, "question_id": 40828156, "link": "https://stackoverflow.com/questions/40828156/why-interface-dont-implement-method-with-pointer-reference-while-direct-access/40829843#40829843", "title": "Why interface don&#39;t implement method with pointer reference while direct access is still possible?", "body": "<p>I think you've got it. <code>u.modify()</code> works because go sees it as shorthand for <code>(&amp;u).modify()</code>. <code>interfaceModify(&amp;u)</code> would also work. Here's a playground with some more examples of pass by reference vs. value.</p>\n\n<p><a href=\"https://play.golang.org/p/HCMtcFAhLe\" rel=\"noreferrer\">https://play.golang.org/p/HCMtcFAhLe</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype user struct {\n    name string\n}\n\ntype userPointer struct {\n    user\n}\n\nfunc (up *userPointer) modify() {\n    up.name = \"My name\"\n}\n\ntype modifier interface {\n    modify()\n}\n\nfunc (u user) modify() {\n    u.name = \"My name\"\n}\n\nfunc interfaceModify(m modifier) {\n    m.modify()\n\n}\n\nfunc main() {\n    u := user{\"Default Name\"}\n    u.modify()\n    fmt.Println(u.name)\n    interfaceModify(u)\n    fmt.Println(u.name)\n\n    up := userPointer{user{\"Default Name\"}}\n    interfaceModify(&amp;up)\n    fmt.Println(up.name)\n    // short hand version\n    up.name = \"Default Name\"\n    up.modify()\n    fmt.Println(up.name)\n    // long hand version https://golang.org/ref/spec#Calls\n    up.name = \"Default Name\"\n    (&amp;up).modify()\n    fmt.Println(up.name)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 2, "last_activity_date": 1480449637, "last_edit_date": 1480449637, "creation_date": 1480256884, "answer_id": 40830041, "question_id": 40828156, "link": "https://stackoverflow.com/questions/40828156/why-interface-dont-implement-method-with-pointer-reference-while-direct-access/40830041#40830041", "title": "Why interface don&#39;t implement method with pointer reference while direct access is still possible?", "body": "<p><code>T</code> type is not '&amp;T' type. In other words a type pointer to struct is not a struct type. So if you decided to implement a method with pointer receiver you must use the pointer not the struct itself because exactly pointer implements the method. Your code lacks just one character.</p>\n\n<p>Change <code>interfaceModify(u)</code> to <code>interfaceModify(&amp;u)</code></p>\n\n<p><a href=\"https://play.golang.org/p/P_7GWyWP5c\" rel=\"nofollow\">playground</a></p>\n"}], "owner": {"reputation": 141, "user_id": 3050600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926d76ee00248433e07e0e8659d52be8?s=128&d=identicon&r=PG", "display_name": "didrocks", "link": "https://stackoverflow.com/users/3050600/didrocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 40829843, "answer_count": 2, "score": 3, "last_activity_date": 1480449637, "creation_date": 1480244412, "last_edit_date": 1480244897, "question_id": 40828156, "link": "https://stackoverflow.com/questions/40828156/why-interface-dont-implement-method-with-pointer-reference-while-direct-access", "title": "Why interface don&#39;t implement method with pointer reference while direct access is still possible?", "body": "<p>I do understand that interface don't implement method with pointer reference as per Go spec and FAQ, as T and *T have different method sets (<a href=\"https://golang.org/doc/faq#guarantee_satisfies_interface\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#guarantee_satisfies_interface</a>).</p>\n\n<p>So, this doesn't work:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype user struct {\n    name string\n}\n\ntype modifier interface {\n    modify()\n}\n\nfunc (u *user) modify() {\n    u.name = \"My name\"\n}\n\nfunc interfaceModify(m modifier) {\n    m.modify()\n}\n\nfunc main() {\n    u := user{\"Default Name\"}\n\n    interfaceModify(u)\n    fmt.Println(u.name)\n}\n</code></pre>\n\n<p>and returns:</p>\n\n<blockquote>\n  <p>./main.go:26: cannot use u (type user) as type modifier in argument to interfaceModify:\n    user does not implement modifier (modify method has pointer receiver)</p>\n</blockquote>\n\n<p>This is explained as:</p>\n\n<blockquote>\n  <p>[\u2026]there is no useful way for a method call to obtain a pointer.</p>\n  \n  <p>Even in cases where the compiler could take the address of a value to pass to the method, if the method modifies the value the changes will be lost in the caller.</p>\n</blockquote>\n\n<p>However, replacing <code>interfaceModify(u)</code> with a direct call like <code>u.modify()</code> does work: the compiler takes the address of <strong>u</strong>, and will modify its name property as Println() confirms.</p>\n\n<p>So, we are able to do that operation in that precise case, but not in the interface one. My only explanation of that difference is that in <code>interfaceModify(m modifier)</code>, we will have a direct copy of <strong>u</strong> to <strong>m</strong>, and no way for <strong>m</strong> to match corresponding address when calling <code>modify()</code>.\nAnd, so, declaring <code>u := &amp;user{\"Default Name\"}</code> would thus copy the pointer (so address) <strong>u</strong> to <strong>m</strong>, and that's why <code>m.modify()</code> is possible.\nAm I correct?</p>\n"}, {"tags": ["http", "go", "url", "url-scheme"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1480233124, "post_id": 40826664, "comment_id": 68871897, "body": "you may inspect <code>r.Proto</code> it will return HTTP/1.1 or HTTP/2 according with the documentation, but not sure if it will change for HTTPS"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1521171472, "post_id": 40826664, "comment_id": 85627327, "body": "@YandryPozo <code>r.Proto</code> will only be <code>HTTP&#47;2</code> if the Go application is terminating TLS itself, i.e. with <code>http.ListenAndServeTLS()</code>."}, {"owner": {"reputation": 1035, "user_id": 1767938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad1721754c58030fe7e9cab48a4f331?s=128&d=identicon&r=PG", "display_name": "Michael Kruglos", "link": "https://stackoverflow.com/users/1767938/michael-kruglos"}, "edited": false, "score": 2, "creation_date": 1539773261, "post_id": 40826664, "comment_id": 92621257, "body": "Since you use ListenAndServe and not ListenAndServeTLS, your scheme can be safely assumed as http. If you use both tls and non tls versions, you can use r.TLS and check it for null to know whether TLS was established. If your go app is running behind a reverse proxy, there&#39;s virtually no way to know what the scheme was."}, {"owner": {"reputation": 2140, "user_id": 282250, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c46229bf9048c284b0700a8f4ac813dd?s=128&d=identicon&r=PG", "display_name": "RavenHursT", "link": "https://stackoverflow.com/users/282250/ravenhurst"}, "reply_to_user": {"reputation": 1035, "user_id": 1767938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad1721754c58030fe7e9cab48a4f331?s=128&d=identicon&r=PG", "display_name": "Michael Kruglos", "link": "https://stackoverflow.com/users/1767938/michael-kruglos"}, "edited": false, "score": 0, "creation_date": 1570740633, "post_id": 40826664, "comment_id": 103019616, "body": "@MichaelKruglos your answer really is the only REAL valid answer here, considering many apps are now running behind webservices (like nginx) that may, or may not terminate TLS for the app, in a given environment."}], "answers": [{"comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1480243386, "post_id": 40827229, "comment_id": 68873985, "body": "<a href=\"http://stackoverflow.com/questions/6899069/why-are-request-url-host-and-scheme-blank-in-the-development-server\" title=\"why are request url host and scheme blank in the development server\">stackoverflow.com/questions/6899069/&hellip;</a> Just copied from the older answer."}], "tags": [], "owner": {"reputation": 261, "user_id": 1732600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNkL2.jpg?s=128&g=1", "display_name": "Brij", "link": "https://stackoverflow.com/users/1732600/brij"}, "is_accepted": false, "score": -2, "last_activity_date": 1480244139, "last_edit_date": 1480244139, "creation_date": 1480236812, "answer_id": 40827229, "question_id": 40826664, "link": "https://stackoverflow.com/questions/40826664/get-scheme-of-the-current-request-url/40827229#40827229", "title": "Get scheme of the current request URL", "body": "<p>It is because, you're accessing the HTTP server so:</p>\n\n<pre><code>GET / HTTP/1.1\nHost: localhost:8080\n</code></pre>\n\n<p>in this cases, based on parsing what you get is raw URL from Go's http.Request.URL. why you are getting this is because you are accessing the URL from a relative path, hence the lack of a Host or Scheme in the URL object.</p>\n\n<p>If you do want to get the HTTP host, you may have to access the Host attribute of the http.Request struct. See <a href=\"http://golang.org/pkg/http/#Request\" rel=\"nofollow noreferrer\">http://golang.org/pkg/http/#Request</a></p>\n\n<p>as it is not directly available, but you can still be able to assemble it:</p>\n\n<pre><code>u := r.URL\n\n// The scheme can be http/https because that's depends on protocol your server handles.\nu.Scheme = \"http\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 3, "creation_date": 1521171607, "post_id": 40828403, "comment_id": 85627359, "body": "This is true, but he is asking for the URL Scheme, not the Host."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 1, "last_activity_date": 1480246813, "last_edit_date": 1480246813, "creation_date": 1480246086, "answer_id": 40828403, "question_id": 40826664, "link": "https://stackoverflow.com/questions/40826664/get-scheme-of-the-current-request-url/40828403#40828403", "title": "Get scheme of the current request URL", "body": "<p>localhost is a special case for <code>URL</code> formation. It is going to be empty anyway if your client is localhost.</p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#ProxyFromEnvironment\" rel=\"nofollow noreferrer\">net.http package doc</a>:</p>\n\n<blockquote>\n  <p>As a special case, if req.URL.Host is \"localhost\" (with or without a port number), then a nil URL and nil error will be returned.</p>\n</blockquote>\n\n<p>The way to get required url/uri information is to get it from <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\"><code>http.Request</code></a> directly. For example:</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"%s\\n\", r.Host)                    \n}                                                     \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 5, "last_activity_date": 1521171119, "last_edit_date": 1592644375, "creation_date": 1521171119, "answer_id": 49312740, "question_id": 40826664, "link": "https://stackoverflow.com/questions/40826664/get-scheme-of-the-current-request-url/49312740#49312740", "title": "Get scheme of the current request URL", "body": "<p>A quick <code>grep</code> shows that <code>r.URL.Scheme</code> is never set to anything other than the empty string anywhere in <code>net/http</code>. Personally I think it should be, as far as possible, but apparently I have a minority opinion.</p>\n<hr />\n<p>If you opened a TLS listener yourself with <code>http.ListenAndServeTLS()</code> then presumably you know the scheme is https already. You can use a trivial middleware handler that fills in <code>r.URL.Scheme</code> in this case.</p>\n<pre><code>func AlwaysHTTPS(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        r.URL.Scheme = &quot;https&quot;\n\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n<p>If you're running behind a web server, then it may pass the request protocol in a header such as <code>X-Forwarded-Proto</code>. In this case, you can use a handler like gorilla's <a href=\"http://www.gorillatoolkit.org/pkg/handlers\" rel=\"noreferrer\">handlers</a>.<a href=\"http://www.gorillatoolkit.org/pkg/handlers#ProxyHeaders\" rel=\"noreferrer\">ProxyHeaders</a>() to fill in the missing fields.</p>\n<p>An example using gorilla mux:</p>\n<pre><code>package main\n\nimport (\n    &quot;log&quot;\n    &quot;net/http&quot;\n\n    &quot;github.com/gorilla/handlers&quot;\n    &quot;github.com/gorilla/mux&quot;\n)\n\nfunc main() {\n    r := mux.NewRouter()\n    r.Use(handlers.ProxyHeaders)\n\n    http.Handle(&quot;/&quot;, r)\n    log.Fatal(http.ListenAndServe(&quot;[::]:8009&quot;, nil))\n}\n</code></pre>\n<p>From its comments:</p>\n<blockquote>\n<p>ProxyHeaders inspects common reverse proxy headers and sets the corresponding fields in the HTTP request struct. These are X-Forwarded-For and X-Real-IP for the remote (client) IP address, X-Forwarded-Proto or X-Forwarded-Scheme for the scheme (http|https) and the RFC7239 Forwarded header, which may include both client IPs and schemes.</p>\n<p>NOTE: This middleware should only be used when behind a reverse proxy like nginx, HAProxy or Apache. Reverse proxies that don't (or are configured not to) strip these headers from client requests, or where these headers are accepted &quot;as is&quot; from a remote client (e.g. when Go is not behind a proxy), can manifest as a vulnerability if your application uses these headers for validating the 'trustworthiness' of a request.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1035, "user_id": 1767938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad1721754c58030fe7e9cab48a4f331?s=128&d=identicon&r=PG", "display_name": "Michael Kruglos", "link": "https://stackoverflow.com/users/1767938/michael-kruglos"}, "is_accepted": false, "score": 4, "last_activity_date": 1582491417, "last_edit_date": 1582491417, "creation_date": 1574336699, "answer_id": 58974230, "question_id": 40826664, "link": "https://stackoverflow.com/questions/40826664/get-scheme-of-the-current-request-url/58974230#58974230", "title": "Get scheme of the current request URL", "body": "<p>Since you use <code>ListenAndServe</code> and not <code>ListenAndServeTLS</code>, your scheme can be safely assumed as http. If you use both tls and non tls versions, you can use <code>r.TLS</code> and check it for null to know whether TLS was established. If your go app is running behind a reverse proxy, then you have to check the documentation on the web server which is forwarding the requests to your app, to learn how to configure it to pass this information as headers. Here's a link describing <a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/forwarded/#how-to-use-it-in-nginx\" rel=\"nofollow noreferrer\">nginx configuration</a> which accomplishes that. You can easily find configuration guides for other webservers as well.</p>\n\n<p>Better yet, configure <a href=\"https://www.troyhunt.com/understanding-http-strict-transport/\" rel=\"nofollow noreferrer\">HSTS</a> on your main web server, so that you don't have to worry about insecure connections altogether. There are very few, if any, legitimate uses to non-TLS http. For nginx you can find <a href=\"https://www.nginx.com/blog/http-strict-transport-security-hsts-and-nginx/\" rel=\"nofollow noreferrer\">this article</a> useful. And again for other web servers you will easily find configuration guides.</p>\n\n<p>If you're unsure if your site/application needs https I recommend reading <a href=\"https://doesmysiteneedhttps.com/\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2691, "user_id": 3115822, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/djEOC.png?s=128&g=1", "display_name": "borchvm", "link": "https://stackoverflow.com/users/3115822/borchvm"}, "edited": false, "score": 0, "creation_date": 1587979870, "post_id": 61446922, "comment_id": 108712458, "body": "While this code may provide a solution to the question, it&#39;s better to add context as to why/how it works. This can help future users learn, and apply that knowledge to their own code. You are also likely to have positive feedback from users in the form of upvotes, when the code is explained."}], "tags": [], "owner": {"reputation": 573, "user_id": 9100468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CmkMNlW2J6k/AAAAAAAAAAI/AAAAAAAAYbA/S66MIb_UIX0/photo.jpg?sz=128", "display_name": "Isaac Weingarten", "link": "https://stackoverflow.com/users/9100468/isaac-weingarten"}, "is_accepted": false, "score": 2, "last_activity_date": 1588080158, "last_edit_date": 1588080158, "creation_date": 1587929756, "answer_id": 61446922, "question_id": 40826664, "link": "https://stackoverflow.com/questions/40826664/get-scheme-of-the-current-request-url/61446922#61446922", "title": "Get scheme of the current request URL", "body": "<p>In order to serve <strong>http</strong> and <strong>https</strong> you will need to call both serve functions <br> \n<code>http.ListenAndServe()</code> and <code>http.ListenAndServeTLS()</code> with the same handler\nbecause if you are using only 1 of them like the questions example then you are only listing on 1 protocol <code>http.ListenAndServe()</code> for <strong>http</strong>, and <code>http.ListenAndServeTLS()</code> for <strong>https</strong>, if you will try to contact the server with a different protocol it will not go through,</p>\n\n<p>and because <strong>https</strong> is <a href=\"https://en.wikipedia.org/wiki/HTTPS\" rel=\"nofollow noreferrer\">HTTP over TLS</a> the <code>*http.Request</code> has a <code>TLS</code> property that will gives you beck a <code>*tls.ConnectionState</code> with info about the TLS that was used on this request, then if you want to know how the client contact your server you can check on the request <code>TLS</code> property, \nif the request was made with <strong>https</strong> it will not be nil,\nif the request was made with <strong>http</strong> then the <code>TLS</code> property will be <code>nil</code>,\nbecause the only way that a request was made with TLS is with the <strong>https</strong> protocol</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n   if r.TLS == nil {\n       // the scheme was http\n   } else {\n       // the scheme was https\n   }                 \n}  \n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    go func(){ \n        log.Fatal(http.ListenAndServeTLS(\":8443\",\"localhost.crt\", \"localhost.key\", nil)) \n    }()\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}                                                   \n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3921, "user_id": 2061684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ad823a3c12f55ee1103eeec268bc54?s=128&d=identicon&r=PG", "display_name": "jnovack", "link": "https://stackoverflow.com/users/2061684/jnovack"}, "edited": false, "score": 1, "creation_date": 1602495341, "post_id": 64300221, "comment_id": 113728455, "body": "While that is true, it&#39;s not a browser-header, it is a proxy-header, and will only be present when passing through a proxy or load-balancer if the defaults are selected for config.  One does not need to use the header, it is optional."}], "tags": [], "owner": {"reputation": 1, "user_id": 5123631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb793f4f8c2c65d00ee62597f8e7463?s=128&d=identicon&r=PG&f=1", "display_name": "VikasReddy Ncs", "link": "https://stackoverflow.com/users/5123631/vikasreddy-ncs"}, "is_accepted": false, "score": 0, "last_activity_date": 1602385109, "creation_date": 1602385109, "answer_id": 64300221, "question_id": 40826664, "link": "https://stackoverflow.com/questions/40826664/get-scheme-of-the-current-request-url/64300221#64300221", "title": "Get scheme of the current request URL", "body": "<p>http header X-Forwarded-Proto will have http or https</p>\n"}], "owner": {"reputation": 17710, "user_id": 265072, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bffb04386858bb26825e8791c41dd8f3?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/265072/ethan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14138, "favorite_count": 1, "answer_count": 6, "score": 8, "last_activity_date": 1602385109, "creation_date": 1480231299, "last_edit_date": 1563954063, "question_id": 40826664, "link": "https://stackoverflow.com/questions/40826664/get-scheme-of-the-current-request-url", "title": "Get scheme of the current request URL", "body": "<p>In Ruby/Rack, I'm able to <a href=\"http://www.rubydoc.info/gems/rack/Rack/Request/Helpers#scheme-instance_method\" rel=\"noreferrer\">get the scheme of the current request URL from <code>scheme#request</code></a>. However, in Go, <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"noreferrer\"><code>http.Request.URL.Scheme</code></a> returns an empty string:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"%#v\\n\", r.URL.Scheme) // Always shows empty string\n}\n</code></pre>\n\n<p>How do I get scheme of the current request URL?</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 373, "user_id": 1924721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ba12cccb8e7b9f1da05f7226a25521d2?s=128&d=identicon&r=PG", "display_name": "neclepsio", "link": "https://stackoverflow.com/users/1924721/neclepsio"}, "edited": false, "score": 0, "creation_date": 1480230562, "post_id": 40826521, "comment_id": 68871476, "body": "What you are asking is definetely something you can do. There is something in your template: you should post some simplified version of it."}, {"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "reply_to_user": {"reputation": 373, "user_id": 1924721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ba12cccb8e7b9f1da05f7226a25521d2?s=128&d=identicon&r=PG", "display_name": "neclepsio", "link": "https://stackoverflow.com/users/1924721/neclepsio"}, "edited": false, "score": 0, "creation_date": 1480230811, "post_id": 40826521, "comment_id": 68871510, "body": "template has no issue because even when I dont use CV in template it doesnt show anything. But if I edit out that CV variable from TweetView . it works again .. {{range .TweetSlice}} {{range .CV}} hello {{end}} {{end}}"}, {"owner": {"reputation": 373, "user_id": 1924721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ba12cccb8e7b9f1da05f7226a25521d2?s=128&d=identicon&r=PG", "display_name": "neclepsio", "link": "https://stackoverflow.com/users/1924721/neclepsio"}, "edited": false, "score": 0, "creation_date": 1480231479, "post_id": 40826521, "comment_id": 68871596, "body": "Are you sure the data you&#39;re passing is correct? (By the way, what is TweetSlice?). I think you should post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "reply_to_user": {"reputation": 373, "user_id": 1924721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ba12cccb8e7b9f1da05f7226a25521d2?s=128&d=identicon&r=PG", "display_name": "neclepsio", "link": "https://stackoverflow.com/users/1924721/neclepsio"}, "edited": false, "score": 0, "creation_date": 1480232200, "post_id": 40826521, "comment_id": 68871741, "body": "@neclepsio - thanks for your response. This is a workable code.. it has 3 layers structure slices. In fact, even if I add \t&quot;test          []int&quot; in comment structure.. it doesnt work. Please let me know where can I post my code? I am new in this"}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1480234593, "creation_date": 1480234593, "answer_id": 40827003, "question_id": 40826521, "link": "https://stackoverflow.com/questions/40826521/golang-not-supporting-struct-slice-depth-with-template/40827003#40827003", "title": "golang not supporting struct slice depth with template", "body": "<p>I was able to solve the problem. The problem was with datastore.Get query.</p>\n\n<p>It was giving below error when I was running </p>\n\n<pre><code>err := datastore.Get(ctx, tweetKey, &amp;tweetView[v])\n</code></pre>\n\n<blockquote>\n  <p>datastore: flattening nested structs leads to a slice of slices: field\n  \"CV\",</p>\n</blockquote>\n\n<p>So what I changed the query like this</p>\n\n<pre><code>var tweetTemp Tweet\ndatastore.Get(ctx, tweetKey, &amp;tweetTemp)\ntweetSlice[v].Tweet = tweetTemp\n</code></pre>\n\n<p>Please let me know if you see problem with this approach</p>\n"}], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480234593, "creation_date": 1480229798, "last_edit_date": 1480234067, "question_id": 40826521, "link": "https://stackoverflow.com/questions/40826521/golang-not-supporting-struct-slice-depth-with-template", "title": "golang not supporting struct slice depth with template", "body": "<p>I stuck with an unique problem. To learn golang, I created a twitter kind of website. It has tweets and each tweets can have comments and each comment can have sub-comments. </p>\n\n<p>Showing struct pd in homepage.html</p>\n\n<pre><code>Env.Tpl.ExecuteTemplate(w, \"homePage.html\", pd)\n</code></pre>\n\n<p>where pd is pagedata (I removed extra information for simplicity)</p>\n\n<pre><code>type PageData struct {\n    TweetView    []tweets.TweetView\n }\n</code></pre>\n\n<p>Where tweet.TweetView is </p>\n\n<pre><code>type TweetView struct {\n    Tweet\n    CV       []comments.Comment\n}\n</code></pre>\n\n<p>where comments.Comment is </p>\n\n<pre><code>type Comment struct {\n    TweetID         int64\n    ParentCommentID int64\n    CommentID       int64\n    CreatedAt     time.Time\n    Name          string\n    UserID        int64\n    CommentMsg string\n}\n</code></pre>\n\n<p>This works. but if I change the CV in tweetView with comment.CommentView .. template stop showing TweetView.</p>\n\n<p>comment.CommentView is </p>\n\n<p>type CommentView struct {\n    Comment\n    CC []Comment\n}</p>\n\n<p>the new TweetView would be defined as </p>\n\n<pre><code>type TweetView struct {\n        Tweet\n        CV       []comments.CommentView\n    }\n</code></pre>\n\n<p>Getting this error, when trying to make a datastore query to extract tweet object into Tweetview </p>\n\n<pre><code>err := datastore.Get(ctx, tweetKey, &amp;tweetView[v])\n</code></pre>\n\n<blockquote>\n  <p>datastore: flattening nested structs leads to a slice of slices: field\n  \"CV\",</p>\n</blockquote>\n\n<p>I think it is a limitation of golang. What should I do?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480222379, "post_id": 40825768, "comment_id": 68870135, "body": "But for the <code>GOTOOLDIR</code>, if it is in the go.exe, how can it know the installation location of go on my box? Or it infers it from the <code>GOROOT</code>?"}, {"owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480222535, "post_id": 40825768, "comment_id": 68870164, "body": "And the <code>set</code> part gives me an impression that it is adding those variables to my environment."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480264463, "post_id": 40825768, "comment_id": 68880115, "body": "I assume the go tool is calling the win32 api to get it&#39;s own location then computing a default path from there.  See example of that api here: <a href=\"http://stackoverflow.com/questions/2647429/c-windows-path-to-the-folder-where-the-executable-is-located\" title=\"c windows path to the folder where the executable is located\">stackoverflow.com/questions/2647429/&hellip;</a>"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 0, "creation_date": 1480264689, "post_id": 40825768, "comment_id": 68880196, "body": "as for the &quot;set&quot;, <code>go env</code> prints the environment as is appropriate to set it on the host platform.  ie: on a mac (via homebrew), it prints <code>GOTOOLDIR=&quot;&#47;usr&#47;local&#47;Cellar&#47;go&#47;1.7.3&#47;libexec&#47;pkg&#47;tool&#47;darwi&zwnj;&#8203;n_amd64&quot;</code>"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 8, "last_activity_date": 1480221208, "creation_date": 1480221208, "answer_id": 40825768, "question_id": 40825613, "link": "https://stackoverflow.com/questions/40825613/where-are-the-golang-environment-variables-stored/40825768#40825768", "title": "Where are the golang environment variables stored?", "body": "<p>Those are just the defaults for your platform.  Think of them as stored in the go.exe executable itself.</p>\n\n<p>You can override them by setting them to something else like any other env var.</p>\n"}, {"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1480264841, "post_id": 40826105, "comment_id": 68880236, "body": "I&#39;m assuming you don&#39;t literally do: <code>export GOPATH=&#47;home&#47;user&#47;go&#47;src</code>, but instead do: <code>export GOPATH=&#47;home&#47;user&#47;go</code>, otherwise you&#39;d have $HOME/go/src/src/STUFF YOU GO GET"}, {"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1480266961, "post_id": 40826105, "comment_id": 68880934, "body": "Yes, it was a mistake and you&#39;re right. The correct path is <code>export GOPATH=$HOME&#47;go</code> or <code>export GOPATH=&#47;user_path&#47;go</code>. I&#39;ll edit my answer."}], "tags": [], "owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "is_accepted": false, "score": 5, "last_activity_date": 1483581953, "last_edit_date": 1483581953, "creation_date": 1480225277, "answer_id": 40826105, "question_id": 40825613, "link": "https://stackoverflow.com/questions/40825613/where-are-the-golang-environment-variables-stored/40826105#40826105", "title": "Where are the golang environment variables stored?", "body": "<p>Like what @David Budworth says, those variables are the defaults for your platform.</p>\n\n<p>Most of case we change <code>$GOPATH</code> and <code>$GOROOT</code> variables. For example in my PC i use <code>export GOPATH=/home/user/go</code> and yours may be different from mine.</p>\n\n<p>Otherwise, if you look to find where other variables are stored you need to look at <code>/usr/lib/go-1.6/src</code> (sorry i'm using <code>Ubuntu</code> right now with go 1.6 and i don't know the path directory of go in Windows), you'll find there many <code>bash</code> <a href=\"https://git.ustclug.org/zhsso/go/tree/0ab3ea9738bb28211c156faf38923bb6c28952cb/src\" rel=\"nofollow noreferrer\">scripts</a> used when you built your <code>go executable</code>.</p>\n\n<p>For example:</p>\n\n<p>in the file: <a href=\"https://git.ustclug.org/zhsso/go/blob/0ab3ea9738bb28211c156faf38923bb6c28952cb/src/make.bash\" rel=\"nofollow noreferrer\">make.bash</a> you'll see: <code>$GROOT</code> was declared there and used to build the final <code>go executable</code>:</p>\n\n<pre><code>export GOROOT=\"$(cd .. &amp;&amp; pwd)\"\n</code></pre>\n\n<p>I saw, also, your comments about <code>GOTOOLDIR</code> and how it knows your installation location of go in your box. I would say, that the source code of go have the answer and you can find it <a href=\"https://git.ustclug.org/zhsso/go/blob/0ab3ea9738bb28211c156faf38923bb6c28952cb/src/pkg/go/build/path.go\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>// ToolDir is the directory containing build tools.\nvar ToolDir = filepath.Join(runtime.GOROOT(), \"pkg/tool/\"+runtime.GOOS+\"_\"+runtime.GOARCH)\n</code></pre>\n\n<p><strong>Edit:</strong> \nI found this good article about building go: <a href=\"https://dave.cheney.net/2013/06/04/how-go-uses-go-to-build-itself\" rel=\"nofollow noreferrer\">How GO uses to build itself</a></p>\n\n<p><strong>PS:</strong> Sorry for my english. I'm not a native english speaker.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 7672410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4147076fb1b66573b3ee4e572249ce?s=128&d=identicon&r=PG", "display_name": "Liu Hao", "link": "https://stackoverflow.com/users/7672410/liu-hao"}, "is_accepted": false, "score": 4, "last_activity_date": 1580456207, "last_edit_date": 1580456207, "creation_date": 1569761365, "answer_id": 58155352, "question_id": 40825613, "link": "https://stackoverflow.com/questions/40825613/where-are-the-golang-environment-variables-stored/58155352#58155352", "title": "Where are the golang environment variables stored?", "body": "<p>In go1.13, customized GOENVs are stored in GOENV, which is specified by system environment variable. If not specified, the default value for your platform will be used.</p>\n\n<p>To obtain default location for your platform, use <code>go env GOENV</code>: on Linux you'll get <code>$HOME/.config/go/env</code>, and on macOS you'll get <code>$HOME/Library/Application Support/go/env</code>.</p>\n\n<pre><code>$ go env\nGO111MODULE=\"\"\nGOARCH=\"amd64\"\nGOBIN=\"/home/leonardo/go/bin\"\nGOCACHE=\"/home/leonardo/.cache/go-build\"\nGOENV=\"/home/leonardo/.config/go/env\" # if system environment 'GOENV' is empty, the default value for your platform will be used.\nGOEXE=\"\"\nGOFLAGS=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGONOPROXY=\"\"\nGONOSUMDB=\"\"\nGOOS=\"linux\"\nGOPATH=\"/home/leonardo/go\"\nGOPRIVATE=\"\"\nGOPROXY=\"https://goproxy.cn,direct\" # default value is \"https://proxy.golang.org,direc\"\n</code></pre>\n\n<pre><code>$ cat ~/.config/go/env\nGOPROXY=https://goproxy.cn,direct\n</code></pre>\n\n<p>environment variables defined with form \"KEY=VALUE\" in this file will override the default value hard coded at <a href=\"https://github.com/golang/go/blob/57662b1575030aa09043cd7a48425abdc6e0e0a3/src/cmd/go/internal/cfg/cfg.go#L229\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/57662b1575030aa09043cd7a48425abdc6e0e0a3/src/cmd/go/internal/cfg/cfg.go#L229</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6550060, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155081971988009/picture?type=large", "display_name": "Jaehong Park", "link": "https://stackoverflow.com/users/6550060/jaehong-park"}, "is_accepted": false, "score": 0, "last_activity_date": 1588421270, "last_edit_date": 1588421270, "creation_date": 1588214753, "answer_id": 61515066, "question_id": 40825613, "link": "https://stackoverflow.com/questions/40825613/where-are-the-golang-environment-variables-stored/61515066#61515066", "title": "Where are the golang environment variables stored?", "body": "<p>by default, <code>env_file</code> does not exist on mac_os.</p>\n\n<pre><code>env_file: $HOME/Library/Application Support/go/env\n</code></pre>\n\n<p>after doing \"<code>go env -w $HOME/go</code>\", the <code>env_file</code> was created.</p>\n"}, {"tags": [], "owner": {"reputation": 3367, "user_id": 5281824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JEhRj.png?s=128&g=1", "display_name": "weaming", "link": "https://stackoverflow.com/users/5281824/weaming"}, "is_accepted": false, "score": 2, "last_activity_date": 1600923347, "last_edit_date": 1600923347, "creation_date": 1600839117, "answer_id": 64021609, "question_id": 40825613, "link": "https://stackoverflow.com/questions/40825613/where-are-the-golang-environment-variables-stored/64021609#64021609", "title": "Where are the golang environment variables stored?", "body": "<p>Please type the following command to your command prompt</p>\n<pre><code>&gt; go env GOENV\n/root/.config/go/env\n</code></pre>\n"}], "owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5062, "favorite_count": 2, "accepted_answer_id": 40825768, "answer_count": 5, "score": 9, "last_activity_date": 1600923347, "creation_date": 1480218992, "question_id": 40825613, "link": "https://stackoverflow.com/questions/40825613/where-are-the-golang-environment-variables-stored", "title": "Where are the golang environment variables stored?", "body": "<p>I am just started learning golang on Windows 7.</p>\n\n<p>With <code>go env</code>, I got this:</p>\n\n<pre><code>set GOARCH=amd64\nset GOBIN=\nset GOEXE=.exe\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=E:\\Workbench\\Go\nset GORACE=\nset GOROOT=C:\\DevTools\\Go\nset GOTOOLDIR=C:\\DevTools\\Go\\pkg\\tool\\windows_amd64\nset CC=gcc\nset GOGCCFLAGS=-m64 -mthreads -fmessage-length=0\nset CXX=g++\nset CGO_ENABLED=1\n</code></pre>\n\n<p>Then I checked with <code>echo %envVar%</code> in the command line, I found env vars like:</p>\n\n<pre><code>GOPATH\nGOROOT\n</code></pre>\n\n<p>But others are not found.</p>\n\n<p>So where are they stored? Some hidden configuration file?</p>\n"}, {"tags": ["pointers", "go", "methods", "interface"], "answers": [{"comments": [{"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1480527226, "post_id": 40824044, "comment_id": 69003161, "body": "Thanks for the extremely comprehensive answer. Sorry for responding late as strangely I didn&#39;t get the SO notification. One case that I searched, the answer was that the &quot;member functions&quot; should either be <i>all</i> pointer types, e.g., &quot;<code>func (m *MyType)</code>&quot;, or <i>none</i>. Is it so? Can I mix different types of &quot;member functions&quot;, e.g., <code>func (m *MyType)</code> &amp; <code>func (m MyType)</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 3, "creation_date": 1480537686, "post_id": 40824044, "comment_id": 69008815, "body": "@xpt You can mix pointer and non-pointer receivers, it&#39;s not a requirement to make all the same. It&#39;s just weird if you have 19 methods with pointer receiver and you make one with non-pointer receiver. It also makes it harder to track which methods are part of which types&#39; method sets if you start mixing them. More details in this answer: <a href=\"http://stackoverflow.com/questions/27775376/value-receiver-vs-pointer-receiver-in-golang/27775558#27775558\">Value receiver vs. Pointer receiver in Golang?</a>"}, {"owner": {"reputation": 261, "user_id": 1626192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2r6WA.jpg?s=128&g=1", "display_name": "Joel Edstr&#246;m", "link": "https://stackoverflow.com/users/1626192/joel-edstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1500228632, "post_id": 40824044, "comment_id": 77232970, "body": "How do you actually solve the issue mentioned at the end in &quot;Note:&quot; with an interface{} wrapping a value of <code>MyType</code>, if you can&#39;t change <code>MyType</code> to use value methods.   I tried something like this <code>(&amp;i).(*Stringer)</code> but its not working. Is it even possible?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 261, "user_id": 1626192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2r6WA.jpg?s=128&g=1", "display_name": "Joel Edstr&#246;m", "link": "https://stackoverflow.com/users/1626192/joel-edstr%c3%b6m"}, "edited": false, "score": 1, "creation_date": 1500368527, "post_id": 40824044, "comment_id": 77292482, "body": "@JoelEdstr&#246;m Yes, it&#39;s possible, but it makes little sense. For example you may type-assert the value of the non-pointer type and store it in a variable, e.g. <code>x := i.(MyType)</code>, and then you can call methods with pointer receiver on it, e.g. <code>i.String()</code>, which is a shorthand for <code>(&amp;i).String()</code> which succeeds because variables are addressable. But the pointer method changing the value (the pointed value) will not be reflected in the value wrapped in the interface value, that&#39;s why it makes little sense."}, {"owner": {"reputation": 261, "user_id": 1626192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2r6WA.jpg?s=128&g=1", "display_name": "Joel Edstr&#246;m", "link": "https://stackoverflow.com/users/1626192/joel-edstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1500496028, "post_id": 40824044, "comment_id": 77367951, "body": "@icza But what if you don&#39;t know its concrete type or if the same code should work for multiple types that implement <code>Stringer</code> using pointer methods? For example say you got the <code>interface{}</code> from reflection."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 261, "user_id": 1626192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2r6WA.jpg?s=128&g=1", "display_name": "Joel Edstr&#246;m", "link": "https://stackoverflow.com/users/1626192/joel-edstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1500498383, "post_id": 40824044, "comment_id": 77369189, "body": "@JoelEdstr&#246;m You could create a new pointer value using reflection, set the pointed value to the original, and use reflection to type assert the interface that contains the method you want to call, and call it. So yes, it&#39;s possible with reflection. It won&#39;t be a &quot;fast&quot; solution, but that&#39;s the price of being general on the cost of using reflection."}, {"owner": {"reputation": 72581, "user_id": 44852, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JbQbc.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/44852/tarik"}, "edited": false, "score": 0, "creation_date": 1505861827, "post_id": 40824044, "comment_id": 79583560, "body": "<b>Moral of the story:</b> Pointer types and non-pointers types are not the same things even if they use the same underlying type. So, treat them accordingly. That&#39;s why which one implements a method to satisfy an interface matters!"}, {"owner": {"reputation": 4341, "user_id": 155547, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1434873cda76f0c092fbe67db864ab93?s=128&d=identicon&r=PG", "display_name": "DeepNightTwo", "link": "https://stackoverflow.com/users/155547/deepnighttwo"}, "edited": false, "score": 0, "creation_date": 1506054356, "post_id": 40824044, "comment_id": 79673476, "body": "@icza Thanks for a detail explaination of this. After I practiced this, I wonder why it is designed so. Take the struct S and T for example. Why promoted methods with receiver *T  is not included in method sets of S? I suppose it is doable (just use &amp;S as the reciever when calll the method). Why Golang decided NOT to support this? Will it bring some potential issue or makes users make mistakes?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 4341, "user_id": 155547, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1434873cda76f0c092fbe67db864ab93?s=128&d=identicon&r=PG", "display_name": "DeepNightTwo", "link": "https://stackoverflow.com/users/155547/deepnighttwo"}, "edited": false, "score": 1, "creation_date": 1506066454, "post_id": 40824044, "comment_id": 79678577, "body": "@DeepNightTwo Methods of <code>*T</code> are not included in method set of <code>S</code> because <code>S</code> might not be addressable (e.g. function return value or result of map indexing), and also because often only a copy is present / received, and if taking its address is allowed, the method with pointer receiver could only modify the copy (confusion as you would assume the original is modified). See this answer for an example: <a href=\"https://stackoverflow.com/questions/44255344/using-reflection-setstring/44255582#44255582\">Using reflection SetString</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 423, "last_activity_date": 1550578267, "last_edit_date": 1592644375, "creation_date": 1480201388, "answer_id": 40824044, "question_id": 40823315, "link": "https://stackoverflow.com/questions/40823315/x-does-not-implement-y-method-has-a-pointer-receiver/40824044#40824044", "title": "X does not implement Y (... method has a pointer receiver)", "body": "<p>This compile-time error arises when you try to assign or pass (or convert) a <em>concrete</em> type to an interface type; and the type itself does not implement the interface, only a <em>pointer to the type</em>.</p>\n<p>Let's see an example:</p>\n<pre><code>type Stringer interface {\n    String() string\n}\n\ntype MyType struct {\n    value string\n}\n\nfunc (m *MyType) String() string { return m.value }\n</code></pre>\n<p>The <code>Stringer</code> interface type has one method only: <code>String()</code>. Any value that is stored in an interface value <code>Stringer</code> must have this method. We also created a <code>MyType</code>, and we created a method <code>MyType.String()</code> with <strong>pointer</strong> receiver. This means the <code>String()</code> method is in the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"noreferrer\">method set</a> of the <code>*MyType</code> type, but not in that of <code>MyType</code>.</p>\n<p>When we attempt to assign a value of <code>MyType</code> to a variable of type <code>Stringer</code>, we get the error in question:</p>\n<pre><code>m := MyType{value: &quot;something&quot;}\n\nvar s Stringer\ns = m // cannot use m (type MyType) as type Stringer in assignment:\n      //   MyType does not implement Stringer (String method has pointer receiver)\n</code></pre>\n<p>But everything is ok if we try to assign a value of type <code>*MyType</code> to <code>Stringer</code>:</p>\n<pre><code>s = &amp;m\nfmt.Println(s)\n</code></pre>\n<p>And we get the expected outcome (try it on the <a href=\"https://play.golang.org/p/TSaT30PRD0\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>something\n</code></pre>\n<p><strong>So the requirements to get this compile-time error:</strong></p>\n<ul>\n<li>A value of <em>non-pointer</em> concrete type being assigned (or passed or converted)</li>\n<li>An interface type being assigned to (or passed to, or converted to)</li>\n<li>The concrete type has the required method of the interface, but with a <em>pointer receiver</em></li>\n</ul>\n<p><strong>Possibilities to resolve the issue:</strong></p>\n<ul>\n<li>A pointer to the value must be used, whose method set will include the method with the pointer receiver</li>\n<li>Or the receiver type must be changed to <em>non-pointer</em>, so the method set of the non-pointer concrete type will also contain the method (and thus satisfy the interface). This may or may not be viable, as if the method has to modify the value, a non-pointer receiver is not an option.</li>\n</ul>\n<h2>Structs and embedding</h2>\n<p>When using <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"noreferrer\">structs and embedding</a>, often it's not &quot;you&quot; that implement an interface (provide a method implementation), but a type you embed in your <code>struct</code>. Like in this example:</p>\n<pre><code>type MyType2 struct {\n    MyType\n}\n\nm := MyType{value: &quot;something&quot;}\nm2 := MyType2{MyType: m}\n\nvar s Stringer\ns = m2 // Compile-time error again\n</code></pre>\n<p>Again, compile-time error, because the method set of <code>MyType2</code> does not contain the <code>String()</code> method of the embedded <code>MyType</code>, only the method set of <code>*MyType2</code>, so the following works (try it on the <a href=\"https://play.golang.org/p/3MuyevNpL8\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>var s Stringer\ns = &amp;m2\n</code></pre>\n<p>We can also make it work, if we embed <code>*MyType</code> and using only a <em>non-pointer</em> <code>MyType2</code> (try it on the <a href=\"https://play.golang.org/p/BMG5EctMVa\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>type MyType2 struct {\n    *MyType\n}\n\nm := MyType{value: &quot;something&quot;}\nm2 := MyType2{MyType: &amp;m}\n\nvar s Stringer\ns = m2\n</code></pre>\n<p>Also, whatever we embed (either <code>MyType</code> or <code>*MyType</code>), if we use a pointer <code>*MyType2</code>, it will always work (try it on the <a href=\"https://play.golang.org/p/3MuyevNpL8\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>type MyType2 struct {\n    *MyType\n}\n\nm := MyType{value: &quot;something&quot;}\nm2 := MyType2{MyType: &amp;m}\n\nvar s Stringer\ns = &amp;m2\n</code></pre>\n<p>Relevant section from the spec (from section <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"noreferrer\">Struct types</a>):</p>\n<blockquote>\n<p>Given a struct type <code>S</code> and a type named <code>T</code>, promoted methods are included in the method set of the struct as follows:</p>\n<ul>\n<li>If <code>S</code> contains an anonymous field <code>T</code>, the method sets of <code>S</code> and <code>*S</code> both include promoted methods with receiver <code>T</code>. The method set of <code>*S</code> also includes promoted methods with receiver <code>*T</code>.</li>\n<li>If <code>S</code> contains an anonymous field <code>*T</code>, the method sets of <code>S</code> and <code>*S</code> both include promoted methods with receiver <code>T</code> or <code>*T</code>.</li>\n</ul>\n</blockquote>\n<p>So in other words: if we embed a non-pointer type, the method set of the non-pointer embedder only gets the methods with non-pointer receivers (from the embedded type).</p>\n<p>If we embed a pointer type, the method set of the non-pointer embedder gets methods with both pointer and non-pointer receivers (from the embedded type).</p>\n<p>If we use a pointer value to the embedder, regardless of whether the embedded type is pointer or not, the method set of the pointer to the embedder always gets methods with both the pointer and non-pointer receivers (from the embedded type).</p>\n<p><strong>Note:</strong></p>\n<p>There is a very similar case, namely when you have an interface value which wraps a value of <code>MyType</code>, and you try to <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">type assert</a> another interface value from it, <code>Stringer</code>. In this case the assertion will not hold for the reasons described above, but we get a slightly different runtime-error:</p>\n<pre><code>m := MyType{value: &quot;something&quot;}\n\nvar i interface{} = m\nfmt.Println(i.(Stringer))\n</code></pre>\n<p>Runtime panic (try it on the <a href=\"https://play.golang.org/p/Mos344EWbH\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>panic: interface conversion: main.MyType is not main.Stringer:\n    missing method String\n</code></pre>\n<p>Attempting to convert instead of type assert, we get the compile-time error we're talking about:</p>\n<pre><code>m := MyType{value: &quot;something&quot;}\n\nfmt.Println(Stringer(m))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 750425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COaxk.jpg?s=128&g=1", "display_name": "karora", "link": "https://stackoverflow.com/users/750425/karora"}, "is_accepted": false, "score": 6, "last_activity_date": 1518548583, "last_edit_date": 1518548583, "creation_date": 1518547920, "answer_id": 48773671, "question_id": 40823315, "link": "https://stackoverflow.com/questions/40823315/x-does-not-implement-y-method-has-a-pointer-receiver/48773671#48773671", "title": "X does not implement Y (... method has a pointer receiver)", "body": "<p>Another case when I have seen this kind of thing happening is if I want to create an interface where some methods will modify an internal value and others will not.</p>\n\n<pre><code>type GetterSetter interface {\n   GetVal() int\n   SetVal(x int) int\n}\n</code></pre>\n\n<p>Something that then implements this interface could be like:</p>\n\n<pre><code>type MyTypeA struct {\n   a int\n}\n\nfunc (m MyTypeA) GetVal() int {\n   return a\n}\n\nfunc (m *MyTypeA) SetVal(newVal int) int {\n    int oldVal = m.a\n    m.a = newVal\n    return oldVal\n}\n</code></pre>\n\n<p>So the implementing type will likely have some methods which are pointer receivers and some which are not and since I have quite a variety of these various things that are GetterSetters I'd like to check in my tests that they are all doing the expected.</p>\n\n<p>If I were to do something like this:</p>\n\n<pre><code>myTypeInstance := MyType{ 7 }\n... maybe some code doing other stuff ...\nvar f interface{} = myTypeInstance\n_, ok := f.(GetterSetter)\nif !ok {\n    t.Fail()\n}\n</code></pre>\n\n<p>Then I won't get the aforementioned \"X does not implement Y (Z method has pointer receiver)\" error (since it is a compile-time error) but I <em>will</em> have a bad day chasing down exactly why my test is failing...</p>\n\n<p>Instead I have to make sure I do the type check using a pointer, such as:</p>\n\n<pre><code>var f interface{} = new(&amp;MyTypeA)\n ...\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>myTypeInstance := MyType{ 7 }\nvar f interface{} = &amp;myTypeInstance\n...\n</code></pre>\n\n<p>Then all is happy with the tests!</p>\n\n<p>But wait!  In my code, perhaps I have methods which accept a GetterSetter somewhere:</p>\n\n<pre><code>func SomeStuff(g GetterSetter, x int) int {\n    if x &gt; 10 {\n        return g.GetVal() + 1\n    }\n    return g.GetVal()\n}\n</code></pre>\n\n<p>If I call these methods from inside another type method, this will generate the error:</p>\n\n<pre><code>func (m MyTypeA) OtherThing(x int) {\n    SomeStuff(m, x)\n}\n</code></pre>\n\n<p>Either of the following calls will work:</p>\n\n<pre><code>func (m *MyTypeA) OtherThing(x int) {\n    SomeStuff(m, x)\n}\n\nfunc (m MyTypeA) OtherThing(x int) {\n    SomeStuff(&amp;m, x)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 473, "user_id": 1911041, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/905d60487080c37db3224023eeb19ed9?s=128&d=identicon&r=PG", "display_name": "Maxs728", "link": "https://stackoverflow.com/users/1911041/maxs728"}, "edited": false, "score": 11, "creation_date": 1552712069, "post_id": 50963179, "comment_id": 97125080, "body": "By far this was the easiest comment to understand. And directly solved the issue I was facing.."}, {"owner": {"reputation": 2775, "user_id": 2102748, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a1adcb8ed924ecd1045fd6252a7df18?s=128&d=identicon&r=PG", "display_name": "milosmns", "link": "https://stackoverflow.com/users/2102748/milosmns"}, "reply_to_user": {"reputation": 473, "user_id": 1911041, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/905d60487080c37db3224023eeb19ed9?s=128&d=identicon&r=PG", "display_name": "Maxs728", "link": "https://stackoverflow.com/users/1911041/maxs728"}, "edited": false, "score": 0, "creation_date": 1570285618, "post_id": 50963179, "comment_id": 102869025, "body": "@Maxs728 Agreed, quite uncommon in answers to the many many Go problems."}, {"owner": {"reputation": 398, "user_id": 10377640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tYnPVIRXnNo/AAAAAAAAAAI/AAAAAAAAAsM/TB3MdQBBB88/photo.jpg?sz=128", "display_name": "Alif Ramdani", "link": "https://stackoverflow.com/users/10377640/alif-ramdani"}, "edited": false, "score": 0, "creation_date": 1618656064, "post_id": 50963179, "comment_id": 118671351, "body": "to the point and easy to understand. What I need in the middle of the deadline"}], "tags": [], "owner": {"reputation": 3566, "user_id": 2877756, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YILQq.jpg?s=128&g=1", "display_name": "Saman", "link": "https://stackoverflow.com/users/2877756/saman"}, "is_accepted": false, "score": 43, "last_activity_date": 1529567507, "creation_date": 1529567507, "answer_id": 50963179, "question_id": 40823315, "link": "https://stackoverflow.com/questions/40823315/x-does-not-implement-y-method-has-a-pointer-receiver/50963179#50963179", "title": "X does not implement Y (... method has a pointer receiver)", "body": "<p>To keep it short, let say you have this code and you have a Loader interface and a WebLoader that implements this interface. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n// Loader defines a content loader\ntype Loader interface {\n    Load(src string) string\n}\n\n// WebLoader is a web content loader\ntype WebLoader struct{}\n\n// Load loads the content of a page\nfunc (w *WebLoader) Load(src string) string {\n    return fmt.Sprintf(\"I loaded this page %s\", src)\n}\n\nfunc main() {\n    webLoader := WebLoader{}\n    loadContent(webLoader)\n}\n\nfunc loadContent(loader Loader) {\n    loader.Load(\"google.com\")\n}\n</code></pre>\n\n<p>So this code will give you this compile time error</p>\n\n<blockquote>\n  <p>./main.go:20:13: cannot use webLoader (type WebLoader) as type Loader\n  in argument to loadContent:\n          WebLoader does not implement Loader (Load method has pointer receiver)</p>\n</blockquote>\n\n<p>So what you only need to do is to change <code>webLoader := WebLoader{}</code> to following:  </p>\n\n<pre><code>webLoader := &amp;WebLoader{} \n</code></pre>\n\n<p>So why it will fix because you define this function <code>func (w *WebLoader) Load</code> to accept a pointer receiver. For more explanation please read @icza and @karora answers </p>\n"}, {"tags": [], "owner": {"reputation": 739, "user_id": 4794649, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh6.googleusercontent.com/-Q0FdvS0ieJs/AAAAAAAAAAI/AAAAAAAAFuc/9cM1CX7uptw/photo.jpg?sz=128", "display_name": "\u912d\u5143\u5091", "link": "https://stackoverflow.com/users/4794649/%e9%84%ad%e5%85%83%e5%82%91"}, "is_accepted": false, "score": 1, "last_activity_date": 1616142405, "last_edit_date": 1616142405, "creation_date": 1616102553, "answer_id": 66699320, "question_id": 40823315, "link": "https://stackoverflow.com/questions/40823315/x-does-not-implement-y-method-has-a-pointer-receiver/66699320#66699320", "title": "X does not implement Y (... method has a pointer receiver)", "body": "<p>Extend from above answers (Thanks for all of your answers)<br />\nI think it would be more instinctive to show all the methods of pointer / non pointer struct.</p>\n<p>Here is the playground code.\n<a href=\"https://play.golang.org/p/jkYrqF4KyIf\" rel=\"nofollow noreferrer\">https://play.golang.org/p/jkYrqF4KyIf</a></p>\n<p>To summarize all the example.</p>\n<ol>\n<li>Pointer struct type would include all non pointer / pointer receiver methods</li>\n<li>Non pointer struct type would only include non pointer receiver methods.</li>\n</ol>\n<p>For embedded struct</p>\n<ol>\n<li>non pointer outer struct + non pointer embedded struct =&gt; only non pointer receiver methods.</li>\n<li>non pointer outer struct + pointer embedded struct / pointer outer struct + non pointer embedded struct / pointer outer struct + pointer embedded struct =&gt; all embedded methods</li>\n</ol>\n"}], "owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77779, "favorite_count": 81, "accepted_answer_id": 40824044, "answer_count": 4, "score": 238, "last_activity_date": 1616142405, "creation_date": 1480195472, "last_edit_date": 1536597608, "question_id": 40823315, "link": "https://stackoverflow.com/questions/40823315/x-does-not-implement-y-method-has-a-pointer-receiver", "title": "X does not implement Y (... method has a pointer receiver)", "body": "<p>There are already several Q&amp;As on this \"<em>X does not implement Y (... method has a pointer receiver)</em>\" thing, but to me, they seems to be talking about different things, and not applying to my specific case.</p>\n\n<p>So, instead of making the question very specific, I'm making it broad and abstract -- Seems like there are several different cases that can make this error happen, can someone summary it up please?</p>\n\n<p>I.e., how to avoid the problem, and if it occurs, what are the possibilities? Thx.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1480239535, "last_edit_date": 1480239535, "creation_date": 1480195821, "answer_id": 40823362, "question_id": 40823273, "link": "https://stackoverflow.com/questions/40823273/how-to-unmarshal-from-interface-to-interface-in-go/40823362#40823362", "title": "How to unmarshal from interface{} to interface{} in Go", "body": "<p>Unfortunately using the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package you can't, because type information is not transmitted, and JSON numbers by default are unmarshaled into values of <code>float64</code> type if type information is not present. You would need to define <code>struct</code> types where you explicitly state the field is of type <code>uint32</code>.</p>\n\n<p>Alternatively you may opt to use <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\"><code>encoding/gob</code></a> which does transmit and preserve type information. See this example:</p>\n\n<pre><code>m := map[string]interface{}{\"1\": uint32(1)}\n\nb := &amp;bytes.Buffer{}\ngob.NewEncoder(b).Encode(m)\n\nvar m2 map[string]interface{}\ngob.NewDecoder(b).Decode(&amp;m2)\nfmt.Printf(\"%T\\n%#v\\n\", m2[\"1\"], m2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/lMSh_vLUQR\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>uint32\nmap[string]interface {}{\"1\":0x1}\n</code></pre>\n\n<p>The downside of <code>gob</code> is that it's Go-specific unlike the language and platform independent JSON.</p>\n"}], "owner": {"reputation": 347, "user_id": 3143464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/61846a259282a88fce249311d3ebbf63?s=128&d=identicon&r=PG&f=1", "display_name": "surbhi", "link": "https://stackoverflow.com/users/3143464/surbhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1343, "favorite_count": 0, "accepted_answer_id": 40823362, "answer_count": 1, "score": 3, "last_activity_date": 1480239535, "creation_date": 1480195210, "last_edit_date": 1495540435, "question_id": 40823273, "link": "https://stackoverflow.com/questions/40823273/how-to-unmarshal-from-interface-to-interface-in-go", "title": "How to unmarshal from interface{} to interface{} in Go", "body": "<p>There are multiple nodes in my system which communicate through RPC. I am trying to send a map[string] interface{} to another node through RPC. Sender uses json.Marshal and receiver uses json.Unmarshal to get the map. \nLet us say at the sender side, map contains [1] => 2 where 2 is of type uint32.<br>\nThe problem is Unmarshal tries to find the type of underlying data and converts 2 to float64 type according to its default behavior as specified here <a href=\"https://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">https://blog.golang.org/json-and-go</a>. Later, casting float64 to uint32 causes panic. </p>\n\n<p>I refered to <a href=\"https://stackoverflow.com/questions/28254102/how-to-unmarshal-json-into-interface-in-golang\">How to unmarshal json into interface{} in golang?</a> . But for this, we need to know the type of data. In my case data can be of any type so I want to keep it as interface{}. How do I unmarshal from interface{} to interface{}? </p>\n"}, {"tags": ["curl", "go", "https"], "answers": [{"comments": [{"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1480195372, "post_id": 40823262, "comment_id": 68865399, "body": "Thanks for the tip about curl. I need to keep that line in my Go code because I need to pass in multiple tokens for my tests. But given what you said, I think I will just write a condition to exclude setting the header if I have no token. Thanks I will accept your answer shortly."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1480200477, "last_edit_date": 1480200477, "creation_date": 1480195176, "answer_id": 40823262, "question_id": 40823188, "link": "https://stackoverflow.com/questions/40823188/how-to-set-null-authorization-header-in-go/40823262#40823262", "title": "How to set null authorization header in Go?", "body": "<p>Your <code>curl</code> command does not set an empty <code>Authorization</code> header; that <code>curl</code> command <em>will exclude the <code>Authorization</code> header</em>. You can verify it by adding the <code>-v</code> parameter:</p>\n\n<pre><code>curl -H \"Authorization: \" -v \"https://api.github.com/repos/octocat/Hello-World/issues?state=open&amp;per_page=1&amp;page=1\"\n</code></pre>\n\n<p>That being said, you shouldn't set <code>Authorization</code> header in your Go code either. So just remove that line, and your code becomes working immediately.</p>\n"}], "owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 40823262, "answer_count": 1, "score": 1, "last_activity_date": 1480200477, "creation_date": 1480194628, "last_edit_date": 1495542650, "question_id": 40823188, "link": "https://stackoverflow.com/questions/40823188/how-to-set-null-authorization-header-in-go", "title": "How to set null authorization header in Go?", "body": "<p>I am writing a test suite for my program that fetches data from Github APIs. I need to set an empty authentication header. It works fine with <code>curl</code> but doesn't work in my Go program.</p>\n\n<p>I tried setting it to \"null\" as suggested <a href=\"https://stackoverflow.com/questions/35966549/golang-setting-header-to-null-for-a-file-to-http-request-not-working\">here</a>. I've also tried <code>nil</code>, <code>\"\"</code> which don't work.</p>\n\n<p>The output (too long to copy here but you can try it yourself) is as expected with <code>curl -H \"Authorization: \" \"https://api.github.com/repos/octocat/Hello-World/issues?state=open&amp;per_page=1&amp;page=1\"</code></p>\n\n<p>But here is the output with the same empty header set in Go:</p>\n\n<p><code>{\"message\":\"Bad credentials\",\"documentation_url\":\"https://developer.github.com/v3\"}</code></p>\n\n<p>Here is the code (please don't suggest that I just remove the <code>req.Header.Set()</code> line. I need to keep it in for my test suite)</p>\n\n<pre><code>func main() {\n\n        client := &amp;http.Client{}\n\n        //issues API from Github\n        req, err := http.NewRequest(\"GET\", \"https://api.github.com/repos/octocat/Hello-World/issues?state=open&amp;per_page=1&amp;page=1\", nil)\n        if err != nil {\n                log.Fatal(err)\n        }   \n\n        //set authorization header. I have tried nil, and \"\"\n        req.Header.Set(\"Authorization\", \"null\")\n\n        resp, err := client.Do(req)\n        if err != nil {\n                log.Fatal(err)\n        }   \n\n        defer resp.Body.Close()\n\n        //convert to a usable slice of bytes\n        body, err := ioutil.ReadAll(resp.Body)\n        if err != nil {\n                fmt.Println(\"couldn't read issues list\", err)\n        }   \n\n        fmt.Println(string(body))\n}\n</code></pre>\n"}, {"tags": ["performance", "function", "pointers", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480194486, "post_id": 40822745, "comment_id": 68865196, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31932822/why-should-constructor-of-go-return-address/31934189#31934189\">Why should constructor of Go return address?</a>; and <a href=\"http://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values\">Pointers vs. values in parameters and return values</a>."}], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 3152168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32de182081b9b54fd383d40fef3e079b?s=128&d=identicon&r=PG", "display_name": "AniSkywalker", "link": "https://stackoverflow.com/users/3152168/aniskywalker"}, "edited": false, "score": 0, "creation_date": 1480219874, "post_id": 40825665, "comment_id": 68869754, "body": "If I misunderstood the question, basically, pointers are when you need to modify the underlying data and values are when you need the value."}], "tags": [], "owner": {"reputation": 409, "user_id": 3152168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32de182081b9b54fd383d40fef3e079b?s=128&d=identicon&r=PG", "display_name": "AniSkywalker", "link": "https://stackoverflow.com/users/3152168/aniskywalker"}, "is_accepted": true, "score": 1, "last_activity_date": 1480219653, "creation_date": 1480219653, "answer_id": 40825665, "question_id": 40822745, "link": "https://stackoverflow.com/questions/40822745/golang-best-practices-to-pass-and-return-variables/40825665#40825665", "title": "Golang - best practices to pass and return variables", "body": "<p>It's usually redundant and better to eliminate pointless parameters. In fact, by having it as a parameter it's actually initialized to its nil value. Here are all valid ways to do this:</p>\n\n<pre><code>func GetStoreFromRequest(r *http.Request) (store *models.Store, err error) {\n    err = json.NewDecoder(r.Body).Decode(store)\n    return\n}\n\nfunc GetStoreFromRequest(r *http.Request, store *models.Store) error {\n    err := json.NewDecoder(r.Body).Decode(store)\n    return err\n}\n\nfunc GetStoreFromRequest(r *http.Request) (*models.Store, error) {\n    var store models.Store // or store := models.Store{}\n    err = json.NewDecoder(r.Body).Decode(&amp;store)\n    return &amp;store, err\n}\n</code></pre>\n\n<p>It's usually best practice to keep local variables local--imagine passing a parameter i to be used in a for loop. Doesn't make much sense, right? So for this situation, I'd recommend options 1 or 3 (which are essentially the same execution) and leave the local variable out of the function signature.</p>\n"}], "owner": {"reputation": 59, "user_id": 4740217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d6dd2425813fff8ef14b1386a64625?s=128&d=identicon&r=PG&f=1", "display_name": "jamgas", "link": "https://stackoverflow.com/users/4740217/jamgas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "accepted_answer_id": 40825665, "answer_count": 1, "score": 0, "last_activity_date": 1480219653, "creation_date": 1480191619, "question_id": 40822745, "link": "https://stackoverflow.com/questions/40822745/golang-best-practices-to-pass-and-return-variables", "title": "Golang - best practices to pass and return variables", "body": "<p>I am new to golang, I am trying to create a web project with the julienschmidt/httprouter. I am searching to create a well formatted and well structured project so I have two questions about performances passing and returning value or pointers.<br>\nIn my case I want to create a function that from the request returns an object so I have created it:</p>\n\n<pre><code>// StoreController\nfunc (storeController *StoreController) New(w http.ResponseWriter, r *http.Request) {\n    store, err := utilities.GetStoreFromRequest(r)\n    // other stuff\n    return\n}\n\n// Utilities package\nfunc GetStoreFromRequest(r *http.Request) (*models.Store, error) {\n    store := models.Store{}\n    err := json.NewDecoder(r.Body).Decode(&amp;store)\n    // return a pointer is better than returning an object?\n    return &amp;store, err\n}\n</code></pre>\n\n<p>Is it right or it is better to create a store object in the storeController and pass it to the function like:</p>\n\n<pre><code>// StoreController\nfunc (storeController *StoreController) New(w http.ResponseWriter, r *http.Request) {\n    store := models.Store{}\n    err := utilities.GetStoreFromRequest(r, &amp;store)\n    // other stuff\n    return\n}\n\n// Utilities package\nfunc GetStoreFromRequest(r *http.Request, store *models.Store) error {\n    err := json.NewDecoder(r.Body).Decode(store)\n    return err\n}\n</code></pre>\n\n<p>The other question is about the pointer, is too paranoid to pass and return always pointers instead of object and errors or not?\nThanks</p>\n"}, {"tags": ["go", "snmp", "net-snmp", "gosnmp"], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1480264225, "creation_date": 1480264225, "answer_id": 40831169, "question_id": 40821908, "link": "https://stackoverflow.com/questions/40821908/object-name-instead-of-oid-in-gosnmp/40831169#40831169", "title": "Object name instead of OID in GoSNMP", "body": "<p>The answer is simple - use <a href=\"https://en.wikipedia.org/wiki/Management_information_base\" rel=\"nofollow noreferrer\">MIB</a>s. GoSNMP doesn't have MIB support, but you can use the idea from <a href=\"https://github.com/soniah/gosnmp/issues/57\" rel=\"nofollow noreferrer\">https://github.com/soniah/gosnmp/issues/57</a></p>\n"}], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480264225, "creation_date": 1480186394, "question_id": 40821908, "link": "https://stackoverflow.com/questions/40821908/object-name-instead-of-oid-in-gosnmp", "title": "Object name instead of OID in GoSNMP", "body": "<p>Is it possible to return Object name instead of OID using <a href=\"https://godoc.org/github.com/soniah/gosnmp\" rel=\"nofollow noreferrer\">gosnmp</a></p>\n\n<p>For eg:</p>\n\n<p>Instead of</p>\n\n<pre><code>    \".1.3.6.1.2.1.25.2.3.1.1.1\": {\n        \"type\": \"2\",\n        \"val\": \"1\"\n    },\n</code></pre>\n\n<p>How can i get:</p>\n\n<pre><code>    \"hrStorageIndex\": {\n        \"type\": \"2\",\n        \"val\": \"1\"\n    },\n</code></pre>\n"}, {"tags": ["go", "type-safety"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 5, "creation_date": 1480186391, "post_id": 40821895, "comment_id": 68862822, "body": "Arrays DO have fixes lengths. Slices, on the other hand, do not, and you cannot enforce slice length via a function signature."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480194188, "post_id": 40821895, "comment_id": 68865120, "body": "Actually there&#39;s a way. Possible duplicate of <a href=\"http://stackoverflow.com/questions/37270743/is-it-possible-to-trigger-compile-time-error-with-custom-library-in-golang/37271129#37271129\">Is it possible to trigger compile time error with custom library in golang?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1480283009, "creation_date": 1480283009, "answer_id": 40834263, "question_id": 40821895, "link": "https://stackoverflow.com/questions/40821895/can-go-functions-specify-a-particular-array-length/40834263#40834263", "title": "Can Go functions specify a particular array length?", "body": "<p>For arrays it is more than possible, it is required. For slices it is impossible.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    d := [2]int{1, 2}\n    fmt.Println(sum(d))\n}\n\nfunc sum(data [2]int) int {\n    return data[0] + data[1]\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/-VMxyDvwUt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-VMxyDvwUt</a></p>\n"}], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 40834263, "answer_count": 1, "score": -1, "last_activity_date": 1480283009, "creation_date": 1480186333, "question_id": 40821895, "link": "https://stackoverflow.com/questions/40821895/can-go-functions-specify-a-particular-array-length", "title": "Can Go functions specify a particular array length?", "body": "<p>Does Go allow functions to add array length constraints to the signature, or would length still require a runtime check?</p>\n"}, {"tags": ["go", "switch-statement"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 6, "creation_date": 1480186338, "post_id": 40821855, "comment_id": 68862804, "body": "<a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow noreferrer\">&quot;In a case or default clause, the last non-empty statement may be a (possibly labeled) &quot;fallthrough&quot; statement to indicate that control should flow from the end of this clause to the first statement of the next clause. Otherwise control flows to the end of the &quot;switch&quot; statement.&quot;</a>"}, {"owner": {"reputation": 3641, "user_id": 3139595, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/r1GRx.png?s=128&g=1", "display_name": "Edwin O.", "link": "https://stackoverflow.com/users/3139595/edwin-o"}, "edited": false, "score": 1, "creation_date": 1520439147, "post_id": 40821855, "comment_id": 85317654, "body": "nope, but you can explicitly specify that, by using the <code>fallthrough</code> keyword"}], "answers": [{"comments": [{"owner": {"reputation": 3641, "user_id": 3139595, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/r1GRx.png?s=128&g=1", "display_name": "Edwin O.", "link": "https://stackoverflow.com/users/3139595/edwin-o"}, "edited": false, "score": 3, "creation_date": 1520439291, "post_id": 40822747, "comment_id": 85317742, "body": "NOTE; The &#39;fallthrough&#39; must be the last thing in the case; although you can workaround that using <a href=\"https://github.com/golang/go/wiki/Switch#fall-through\" rel=\"nofollow noreferrer\">labels</a>"}], "tags": [], "owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "is_accepted": true, "score": 56, "last_activity_date": 1480192090, "last_edit_date": 1480192090, "creation_date": 1480191640, "answer_id": 40822747, "question_id": 40821855, "link": "https://stackoverflow.com/questions/40821855/do-go-switch-cases-fallthrough-or-not/40822747#40822747", "title": "Do Go switch/cases fallthrough or not?", "body": "<p>No, Go switch statements do not fall through by default. If you <em>do</em> want it to fallthrough, you must explicitly use a \"fallthrough\" statement. From the <a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"noreferrer\">spec</a>:</p>\n\n<blockquote>\n  <p>In a case or default clause, the last non-empty statement may be a\n  (possibly labeled) \"fallthrough\" statement to indicate that control\n  should flow from the end of this clause to the first statement of the\n  next clause. Otherwise control flows to the end of the \"switch\"\n  statement. A \"fallthrough\" statement may appear as the last statement\n  of all but the last clause of an expression switch.</p>\n</blockquote>\n\n<p>For example (sorry, I could not for the life of me think of a real example):</p>\n\n<pre><code>switch 1 {\ncase 1:\n    fmt.Println(\"I will print\")\n    fallthrough\ncase 0:\n    fmt.Println(\"I will also print\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/va6R8Oj02z\" rel=\"noreferrer\">https://play.golang.org/p/va6R8Oj02z</a></p>\n"}, {"tags": [], "owner": {"reputation": 337, "user_id": 6214372, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P4q4PgzAizg/AAAAAAAAAAI/AAAAAAAAAJU/TFsurykvPhI/photo.jpg?sz=128", "display_name": "Milind Dhoke", "link": "https://stackoverflow.com/users/6214372/milind-dhoke"}, "is_accepted": false, "score": 2, "last_activity_date": 1592807837, "last_edit_date": 1592807837, "creation_date": 1565651180, "answer_id": 57469273, "question_id": 40821855, "link": "https://stackoverflow.com/questions/40821855/do-go-switch-cases-fallthrough-or-not/57469273#57469273", "title": "Do Go switch/cases fallthrough or not?", "body": "<p>Break is kept as a default but not fallthrough. If you want to get onto the next case for a match, you should explicitly mention fallthrough.</p>\n<pre><code>switch choice {\ncase &quot;optionone&quot;:\n    // some instructions \n    fallthrough // control will not come out from this case but will go to next case.\ncase &quot;optiontwo&quot;:\n   // some instructions \ndefault: \n   return \n}\n</code></pre>\n"}], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24644, "favorite_count": 4, "accepted_answer_id": 40822747, "answer_count": 2, "score": 30, "last_activity_date": 1592807837, "creation_date": 1480186164, "question_id": 40821855, "link": "https://stackoverflow.com/questions/40821855/do-go-switch-cases-fallthrough-or-not", "title": "Do Go switch/cases fallthrough or not?", "body": "<p>What happens when you reach the end of a Go case, does it fall through to the next, or assume that most applications don't want to fall through?</p>\n"}, {"tags": ["c", "go", "types", "unsigned", "signed"], "answers": [{"tags": [], "owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "is_accepted": false, "score": 2, "last_activity_date": 1480177665, "creation_date": 1480177665, "answer_id": 40820465, "question_id": 40820275, "link": "https://stackoverflow.com/questions/40820275/does-go-fix-or-share-cs-hazardous-implicit-unsigned-conversion/40820465#40820465", "title": "Does Go fix or share C&#39;s hazardous implicit -&gt; unsigned conversion?", "body": "<p>There are no implicit conversions in Go. In order to compare or do arithmetic with two values of different types, you must do manual and explicit type conversion.</p>\n\n<pre><code>a := 3          // numerical constant 3 defaults to int\nb := uint(2)\nc := a &lt; b      // compiler error\nd := a &lt; int(b) // OK\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 2, "last_activity_date": 1480193648, "last_edit_date": 1480193648, "creation_date": 1480179016, "answer_id": 40820672, "question_id": 40820275, "link": "https://stackoverflow.com/questions/40820275/does-go-fix-or-share-cs-hazardous-implicit-unsigned-conversion/40820672#40820672", "title": "Does Go fix or share C&#39;s hazardous implicit -&gt; unsigned conversion?", "body": "<p>Go uses only <a href=\"https://tour.golang.org/basics/13\" rel=\"nofollow\">explicit type conversions</a> for all the operations including comparison.</p>\n\n<pre><code>var a uint64\nvar b int64\n\na = 1\nb = 1\nif a == b {\n    fmt.Println(\"Equal\")\n}\n</code></pre>\n\n<p>This snippet is going to cause an error:</p>\n\n<blockquote>\n  <p>tmp/sandbox428200464/main.go:13: invalid operation: a == b (mismatched types uint64 and int64)</p>\n</blockquote>\n\n<p>To do the comparison you must cast the variables to the same type explicitly:</p>\n\n<pre><code>if int64(a) == b {...}\n</code></pre>\n\n<p>So, definitely <strong>yes</strong>, it is fixed if one can say so.</p>\n\n<p><a href=\"https://play.golang.org/p/fa3_4Dd4IC\" rel=\"nofollow\">Playgound</a> for the snippet.</p>\n"}], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1480193648, "creation_date": 1480176510, "question_id": 40820275, "link": "https://stackoverflow.com/questions/40820275/does-go-fix-or-share-cs-hazardous-implicit-unsigned-conversion", "title": "Does Go fix or share C&#39;s hazardous implicit -&gt; unsigned conversion?", "body": "<p>In \"21st Century C\", Ben Klemens describes how C automatically converts signed numbers to unsigned, in comparison expressions for example. Does Go share this same hazardous behavior, or does Go approach it differently?</p>\n"}, {"tags": ["api", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1480179358, "post_id": 40820004, "comment_id": 68860466, "body": "Possible duplicate: the answer is in this question: <a href=\"http://stackoverflow.com/questions/11123865/golang-format-a-string-without-printing/31742265#31742265\">Golang: format a string without printing?</a>"}, {"owner": {"reputation": 855, "user_id": 4786134, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/568608213301299/picture?type=large", "display_name": "0x01", "link": "https://stackoverflow.com/users/4786134/0x01"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480180497, "post_id": 40820004, "comment_id": 68860869, "body": "Well not really, I might not be detailed enough, but my goal here would be to build a function that would allow me to build custom URLs easily and in a sane/readable way"}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 1, "last_activity_date": 1480176573, "creation_date": 1480176573, "answer_id": 40820284, "question_id": 40820004, "link": "https://stackoverflow.com/questions/40820004/string-with-variable-inside-that-can-dynamically-change/40820284#40820284", "title": "String with variable inside that can dynamically change", "body": "<p>There are many ways, one which allows the URL to be configured from the environment, then to have the url configured dynamically at runtime, would be to use a template.</p>\n\n<p>You could expect a <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">template</a> from the ENV:</p>\n\n<pre><code>apiUrlFromEnv := \"https://{{.Subdomin}}.api.com/{{.Version}}/query\" // get from env\n</code></pre>\n\n<p>Modified From the docs:</p>\n\n<pre><code>type API struct {\n    Subdomain string\n    Version   string\n}\napi := API{\"testapi\", \"1.1\"}\ntmpl, err := template.New(\"api\").Parse(apiUrlFromEnv)\nif err != nil { panic(err) }\nerr = tmpl.Execute(os.Stdout, api) // write to buffer so you can get a string?\nif err != nil { panic(err) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1480180593, "creation_date": 1480180593, "answer_id": 40820929, "question_id": 40820004, "link": "https://stackoverflow.com/questions/40820004/string-with-variable-inside-that-can-dynamically-change/40820929#40820929", "title": "String with variable inside that can dynamically change", "body": "<p>The simplest way is to use <code>fmt.Sprintf</code>.</p>\n\n<p><code>fmt.Sprintf(format string, a ...interface{}) string</code></p>\n\n<p>As you see this function returns a new formatted <code>string</code> and this is built-in library. Furthermore you can use indexing to place arguments in a template:</p>\n\n<blockquote>\n  <p>In Printf, Sprintf, and Fprintf, the default behavior is for each formatting verb to format successive arguments passed in the call. However, the notation [n] immediately before the verb indicates that the nth one-indexed argument is to be formatted instead.</p>\n</blockquote>\n\n<p><code>fmt.Sprintf(\"%[2]d %[1]d %d[2]\\n\", 11, 22)</code></p>\n\n<p>But if you want to use named variables you should use <code>text/template</code> package.</p>\n"}], "owner": {"reputation": 855, "user_id": 4786134, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/568608213301299/picture?type=large", "display_name": "0x01", "link": "https://stackoverflow.com/users/4786134/0x01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480180593, "creation_date": 1480174814, "question_id": 40820004, "link": "https://stackoverflow.com/questions/40820004/string-with-variable-inside-that-can-dynamically-change", "title": "String with variable inside that can dynamically change", "body": "<p>I'm trying to setup an API in <code>golang</code>, for specific needs, I want to be able to have an environment variable that would contain an URL as string (i.e : \"https://<strong>subdomain</strong>.api.com/<strong>version</strong>/query\") and I want to be able to modify the bold parts within an API call. </p>\n\n<p>I have no clue on how I could achieve this.</p>\n\n<p>Thanks for your time,</p>\n\n<p>Paul</p>\n"}, {"tags": ["go", "glog"], "answers": [{"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1480184591, "post_id": 40820387, "comment_id": 68862219, "body": "That looks interesting. I&#39;ll remove glog dependencies. It uses a global."}], "tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 0, "last_activity_date": 1480177237, "creation_date": 1480177237, "answer_id": 40820387, "question_id": 40819833, "link": "https://stackoverflow.com/questions/40819833/how-to-shutdown-glog-completely-to-run-go-tests/40820387#40820387", "title": "How to shutdown glog completely to run go tests?", "body": "<p>You should be able to achieve it by programming to the <code>glog</code> interface.  I'm not sure what that is but it could look like</p>\n\n<pre><code>type Logger interface {\n  Fatal()\n  Info()\n  // etc...\n}\n</code></pre>\n\n<p>Then your packages/functions/structs etc, would have to require the interface opposed to including a global.</p>\n\n<pre><code>type SomeStruct struct {\n  log Logger\n}\n</code></pre>\n\n<p>Or on your top level modules:</p>\n\n<pre><code>func SomeFunc(log Logger) {}\n</code></pre>\n\n<p>Using an interface decouples your code from a loggers specific implementation. </p>\n\n<p>In your unit tests you can create a test specific logger, which is a stub, or a mock.</p>\n\n<pre><code>type TestLogger struct {}\nfunc (tl TestLogger) Fatal() {}\nfunc (tl TestLogger) Info() {}\n// etc....\n</code></pre>\n\n<p>Then your code has to be able to instantiate and configure the real <code>Glog</code> instance, in your production code.  To test this, it should be as simple as encapsulating \"creating\" a Glog instance.</p>\n\n<pre><code>func NewLogger Logger {\n  // configure `Glog` \n  // return `Glog`\n}\n</code></pre>\n\n<p>This way you should be able to unit test the <code>NewLogger</code> configures a logger correctly without actually having to make calls to the logger.</p>\n"}], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480177237, "creation_date": 1480173662, "question_id": 40819833, "link": "https://stackoverflow.com/questions/40819833/how-to-shutdown-glog-completely-to-run-go-tests", "title": "How to shutdown glog completely to run go tests?", "body": "<p>I'm writing test code for my code and would like to get 100% code coverage.</p>\n\n<p>This implies testing corner cases that calls <code>glog.Fatal()</code> for instance.</p>\n\n<p>So first thing I need is to disable any output by glog because I'm not testing glog. So I can run go test without generating files in <code>/tmp</code> or spittig messages to <code>stderr</code>. </p>\n\n<p>The second thing I need is that a call to <code>glog.Fatal()</code> which calls <code>os.Exit()</code> doesn't interfere with running the test. </p>\n\n<p>How could I achieve that ? </p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1480174543, "post_id": 40818853, "comment_id": 68859006, "body": "It is impossible to achieve with 1 Go regex. You will have to use <code>(keyword1)*\\W*(?:\\w+\\W+){0,6}(keyword2)\\W*(?:\\w+\\W+){0,6}(ke&zwnj;&#8203;yword3)*</code> and then add more programming logic."}, {"owner": {"reputation": 181, "user_id": 4453606, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/f22060487336c0de33d2f973806562cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4453606/david"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1480174916, "post_id": 40818853, "comment_id": 68859147, "body": "You mean adding programming logic to remove extra strings?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1480175269, "post_id": 40818853, "comment_id": 68859261, "body": "Something should be added to perform additional checks. Another way is to make the <code>keyword1</code> and <code>keyword3</code> obligatory in 2 alternatives, <code>(keyword1)\\W*(?:\\w+\\W+){0,6}(keyword2)\\W*(?:\\w+\\W+){0,6}(key&zwnj;&#8203;word3)*|(keyword1)*\\&zwnj;&#8203;W*(?:\\w+\\W+){0,6}(ke&zwnj;&#8203;yword2)\\W*(?:\\w+\\W+)&zwnj;&#8203;{0,6}(keyword3)</code>, but still it will require &quot;manual&quot; work later."}, {"owner": {"reputation": 181, "user_id": 4453606, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/f22060487336c0de33d2f973806562cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4453606/david"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1480195373, "post_id": 40818853, "comment_id": 68865401, "body": "Thank you for the comments"}, {"owner": {"reputation": 1928, "user_id": 1768033, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/v6dwN.jpg?s=128&g=1", "display_name": "Martin Cup", "link": "https://stackoverflow.com/users/1768033/martin-cup"}, "edited": false, "score": 0, "creation_date": 1480276156, "post_id": 40818853, "comment_id": 68883932, "body": "Someone had the pretty same question here: <a href=\"http://stackoverflow.com/questions/23968992/how-to-match-a-regex-with-backreference-in-go\" title=\"how to match a regex with backreference in go\">stackoverflow.com/questions/23968992/&hellip;</a> Because you need to use backreferences for that."}], "owner": {"reputation": 181, "user_id": 4453606, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/f22060487336c0de33d2f973806562cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4453606/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480172048, "creation_date": 1480167146, "last_edit_date": 1480172048, "question_id": 40818853, "link": "https://stackoverflow.com/questions/40818853/forcing-regex-to-match-exactly-optional-group-at-the-start-and-the-end-of-the-re", "title": "Forcing regex to match exactly optional group at the start and the end of the regex", "body": "<p>How to force regex to match for optional groups at the beginning and the end of the regex. Example:</p>\n\n<p><code>(keyword1)*\\W*(?:\\w+\\W+){0,6}(keyword2)\\W*(?:\\w+\\W+){0,6}(keyword3)*</code></p>\n\n<p>Here keyword1 and keywrod3 are at the start and the end of the regex respectively and are optional. I am looking for keyword1, keyword2 and keyword3 in this order.We can have up to 6 words between keywords but the matched string should start by one keyword and end by one of the keywords. No extra string is needed. Is there a way to do that. Any suggestion is welcome. Here is a code and a link to <a href=\"https://play.golang.org/p/h5mXISPCk8\" rel=\"nofollow noreferrer\">Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    //here ok as exact match. The matched string starts by one of the keyword and ends by one of them. \n    re := regexp.MustCompile(`(keyword1)\\W*(?:\\w+\\W+){0,6}(keyword2)\\W*(?:\\w+\\W+){0,6}(keyword3)`)\n    text := \"start text keyword1 optional word here then keyword2 again optional words then keyword3 others words after.\"\n        s := re.FindAllString(text, -1)\n    fmt.Println(s)\n\n    //Here not exact match as the result doesn't start by keyword1 and end by keyword3\n    re = regexp.MustCompile(`(keyword1)*\\W*(?:\\w+\\W+){0,6}(keyword2)\\W*(?:\\w+\\W+){0,6}(keyword3)*`)\n    text = \"start text keyword1 optional word then keyword2 optional words keyword3 others words after.\"\n    s = re.FindAllString(text, -1)\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["authentication", "go", "https", "proxy"], "answers": [{"comments": [{"owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "edited": false, "score": 0, "creation_date": 1480314792, "post_id": 40832745, "comment_id": 68893781, "body": "Thank you. I actually came across something like that but could not believe it."}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "edited": false, "score": 0, "creation_date": 1480376634, "post_id": 40832745, "comment_id": 68927482, "body": "@Gonzalez please, check update solution. In my tests this works."}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 3, "last_activity_date": 1480377476, "last_edit_date": 1480377476, "creation_date": 1480273374, "answer_id": 40832745, "question_id": 40817784, "link": "https://stackoverflow.com/questions/40817784/access-https-via-http-proxy-with-basic-authentication/40832745#40832745", "title": "Access HTTPS via HTTP proxy with basic authentication", "body": "<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"fmt\"\n    \"net/url\"\n    \"net/http\"\n)\n\nfunc main() {\n    req, err := http.NewRequest(\"GET\", \"https://api.ipify.org/\", nil)\n    proxyUrl, _ := url.Parse(\"http://username:password@127.0.0.1:9999\")\n    client := &amp;http.Client{\n        Transport: &amp;http.Transport{\n            TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n            Proxy:           http.ProxyURL(proxyUrl),\n        },\n    }\n    _, err = client.Do(req)\n    fmt.Println(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3562, "favorite_count": 1, "accepted_answer_id": 40832745, "answer_count": 1, "score": 0, "last_activity_date": 1541662913, "creation_date": 1480159011, "last_edit_date": 1480391475, "question_id": 40817784, "link": "https://stackoverflow.com/questions/40817784/access-https-via-http-proxy-with-basic-authentication", "title": "Access HTTPS via HTTP proxy with basic authentication", "body": "<p>I am trying to make a <code>GET</code> request against an HTTPS URL using proxy with username/password authorization (auth is required by the proxy not the website).\nHere's what I do:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"encoding/base64\"\n    \"fmt\"\n    \"net/http\"\n    \"net/http/httputil\"\n    \"net/url\"\n)\n\nfunc main() {\n    ua := \"Mozilla/5.0 (Windows NT 6.1\"\n    basic := \"Basic \" + base64.StdEncoding.EncodeToString([]byte(\"username:mypass\"))\n    req, err := http.NewRequest(\"GET\", \"https://api.ipify.org/\", nil)\n    proxyUrl, _ := url.Parse(\"http://myproxy.com:9999\")\n    fmt.Println(basic) // Basic dXNlcm5hbWU6bXlwYXNz\n    req.Header.Add(\"Proxy-Authorization\", basic)\n    req.Header.Add(\"User-Agent\", ua)\n    bb, _ := httputil.DumpRequest(req, false)\n    fmt.Println(string(bb))\n    /*\n    Get / HTTP/1.1\n    Host: api.ipify.org\n    Proxy-Authorization: Basic dXNlcm5hbWU6bXlwYXNz\n    User-Agent: Mozilla/5.0 (Windows NT 6.1\n    */\n    client := &amp;http.Client{\n        Transport: &amp;http.Transport{\n            TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n            Proxy:           http.ProxyURL(proxyUrl),\n        },\n    }\n    resp, err := client.Do(req)\n    fmt.Println(err)  // Proxy Authentication Required\n    fmt.Println(resp) // &lt;nil&gt;\n}\n</code></pre>\n\n<p>The catch is that when I try to do a request to an HTTP (not HTTPS) site it goes fine, but if I make HTTPS request it fails (see above the message).</p>\n\n<p>I tested the proxy with my browser (FireFox) and everything goes well, I looked for the headers through firebug and added everything relevant to the request (above). I've double-triple-checked the <code>basic</code> value and everything else but without any luck.</p>\n\n<p>So does some one have any idea why this happens or at least how do I research the problem?</p>\n\n<p>The last thing to add is that I can use a public HTTP proxy (that doesn't require any auth) in this case and problems seem to start when auth enters in this process (the error also suggests that).</p>\n\n<p>P.S. Unfortunately I cannot share the proxy IP, port and username cause it is against their policy.</p>\n"}, {"tags": ["nginx", "go", "https"], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 5, "last_activity_date": 1480155611, "creation_date": 1480155611, "answer_id": 40817273, "question_id": 40817027, "link": "https://stackoverflow.com/questions/40817027/golang-nginx-https/40817273#40817273", "title": "Golang + nginx + https", "body": "<p>Use <code>https</code> with the proxy_pass</p>\n\n<pre><code>location /\n{\n    proxy_pass https://localhost:9007;\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 114, "user_id": 6112580, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cOg1T0rjzr4/AAAAAAAAAAI/AAAAAAAABR0/LCBWRgtmh7w/photo.jpg?sz=128", "display_name": "Eric Zhou", "link": "https://stackoverflow.com/users/6112580/eric-zhou"}, "is_accepted": false, "score": 0, "last_activity_date": 1500174063, "last_edit_date": 1500174063, "creation_date": 1500172024, "answer_id": 45124404, "question_id": 40817027, "link": "https://stackoverflow.com/questions/40817027/golang-nginx-https/45124404#45124404", "title": "Golang + nginx + https", "body": "<p>nginx .config file should like this </p>\n\n<pre><code>server {\n        listen 443 ssl http2;\n        listen 80;\n        server_name www.mojotv.cn;\n        ssl_certificate     /home/go/src/my_go_web/ssl/**.pem; \n        ssl_certificate_key /home/go/src/my_go_web/ssl/**.key; \n        ssl_session_timeout 5m;\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_ciphers AESGCM:ALL:!DH:!EXPORT:!RC4:+HIGH:!MEDIUM:!LOW:!aNULL:!eNULL;\n        ssl_prefer_server_ciphers on;\n        location /(css|js|fonts|img)/ {\n            access_log off;\n            expires 1d;\n            root \"/home/go/src/my_go_web/static\";\n            try_files $uri @backend;\n        }\n        location / {\n            try_files /_not_exists_ @backend;\n        }\n        location @backend {\n           proxy_set_header X-Forwarded-For $remote_addr;\n           proxy_set_header Host $http_host;\n           proxy_pass http://127.0.0.1:********;\n        }\n        access_log  /home/wwwroot/www.mojotv.cn.log;## nginx log path\n}\n</code></pre>\n\n<p><a href=\"https://www.mojotv.cn\" rel=\"nofollow noreferrer\" title=\"the golang app with http2 ssl feature\">the golang web app with http2 ssl feature shiped with nginx </a></p>\n"}, {"tags": [], "owner": {"reputation": 6155, "user_id": 4378314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7935867003690df779b06563293f6293?s=128&d=identicon&r=PG", "display_name": "MarsAndBack", "link": "https://stackoverflow.com/users/4378314/marsandback"}, "is_accepted": false, "score": 0, "last_activity_date": 1513429221, "creation_date": 1513429221, "answer_id": 47845940, "question_id": 40817027, "link": "https://stackoverflow.com/questions/40817027/golang-nginx-https/47845940#47845940", "title": "Golang + nginx + https", "body": "<p>I get a similar error message to OP for a more basic Go server that doesn't have extra config.</p>\n\n<blockquote>\n  <p>tls: first record does not look like a TLS handshake</p>\n</blockquote>\n\n<p>My temp fix was simply to make sure the test URL includes both \"https://\" and the port number in the URL.</p>\n\n<p>didn't work - ipaddress</p>\n\n<p>didn't work - <a href=\"https://ipaddress\" rel=\"nofollow noreferrer\">https://ipaddress</a></p>\n\n<p>worked - <a href=\"https://ipaddress:8081\" rel=\"nofollow noreferrer\">https://ipaddress:8081</a></p>\n\n<p>It'll do for testing, until a more advanced setup. Just posting this to help others in troubleshooting.</p>\n"}], "owner": {"reputation": 590, "user_id": 2128025, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LXH24.jpg?s=128&g=1", "display_name": "Spouk", "link": "https://stackoverflow.com/users/2128025/spouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3724, "favorite_count": 2, "accepted_answer_id": 40817273, "answer_count": 3, "score": 3, "last_activity_date": 1513429221, "creation_date": 1480153912, "question_id": 40817027, "link": "https://stackoverflow.com/questions/40817027/golang-nginx-https", "title": "Golang + nginx + https", "body": "<p>I have - <strong>Go</strong> to the server as a listener <strong>http</strong> and <strong>https</strong>. <strong>Nginx</strong> configured to process incoming requests for http + https. Certificates in order.\nUsing separate servers runs perfectly on the results of queries to them on https protocol. However, when I use a proxying <strong>nginx</strong> https is not getting a response from the server and the server <strong>Go</strong></p>\n\n<blockquote>\n  <p>\"http: TLS handshake error from 127.0.0.1:54037: tls: first record\n  does not look like a TLS handshake</p>\n</blockquote>\n\n<p>What could be the problem?</p>\n\n<p>Client Go: </p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"log\"\n\n)\n\nfunc HelloSSLServer(w http.ResponseWriter, req *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/plain\")\n    w.Write([]byte(\"This is an example server.\\n\"))\n    // fmt.Fprintf(w, \"This is an example server.\\n\")\n    // io.WriteString(w, \"This is an example server.\\n\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", HelloSSLServer)\n    go http.ListenAndServe(\"192.168.1.2:80\", nil)\n    err := http.ListenAndServeTLS(\"localhost:9007\", \"/etc/letsencrypt/live/somedomain/fullchain.pem\", \"/etc/letsencrypt/live/somedomain/privkey.pem\", nil)\n\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n\n\n\n}\n</code></pre>\n\n<p>Nginx config:</p>\n\n<pre><code>server {\n    listen       192.168.1.2:80;\n    server_name   somedomain;\n    rewrite ^ https://$host$request_uri? permanent;    \n}\nserver {\n    listen        192.168.1.2:443 ssl;\n    server_name   somedomain;\n    access_log    /var/log/nginx/dom_access.log;\n    error_log     /var/log/nginx/dom_error.log;\n    ssl_certificate     /stuff/ssl/domain.cert;\n    ssl_certificate_key /stuff/ssl/private.cert;\n    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers         ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;\n\n\n    location /\n    {\n        proxy_pass http://localhost:9007;\n#       proxy_redirect    http://localhost:1500 http://site1;\n        proxy_cookie_domain localhost somedomain;\n        proxy_buffering off;\n\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header Client-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n    }\n}\n</code></pre>\n"}, {"tags": ["arrays", "json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "edited": false, "score": 1, "creation_date": 1480129433, "post_id": 40814477, "comment_id": 68849199, "body": "That JSON to GO Struct is incredible ! Thanks you"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 1, "last_activity_date": 1480128892, "creation_date": 1480128892, "answer_id": 40814477, "question_id": 40814338, "link": "https://stackoverflow.com/questions/40814338/unmarshalling-arrays-in-json-structure/40814477#40814477", "title": "Unmarshalling arrays in JSON structure", "body": "<p>For big json documents I recommend you to use this tool: <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a></p>\n\n<p>You will get something like:</p>\n\n<pre><code>type AutoGenerated struct {\n    EventID   string    `json:\"eventId\"`\n    SessionID string    `json:\"sessionId\"`\n    RequestID string    `json:\"requestId\"`\n    Published time.Time `json:\"published\"`\n    Action    struct {\n        Message    string   `json:\"message\"`\n        Categories []string `json:\"categories\"`\n        ObjectType string   `json:\"objectType\"`\n        RequestURI string   `json:\"requestUri\"`\n    } `json:\"action\"`\n    Actors []struct {\n        ID          string `json:\"id\"`\n        DisplayName string `json:\"displayName\"`\n        Login       string `json:\"login,omitempty\"`\n        ObjectType  string `json:\"objectType\"`\n        IPAddress   string `json:\"ipAddress,omitempty\"`\n    } `json:\"actors\"`\n    Targets []struct {\n        ID          string `json:\"id\"`\n        DisplayName string `json:\"displayName\"`\n        Login       string `json:\"login\"`\n        ObjectType  string `json:\"objectType\"`\n    } `json:\"targets\"`\n}\n</code></pre>\n\n<p>Full example: <a href=\"https://play.golang.org/p/Q8PwwtS_QZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Q8PwwtS_QZ</a></p>\n\n<p>Also you can always start with a <code>map[string]interface{}</code> instead of a struct.</p>\n"}, {"tags": [], "owner": {"reputation": 29341, "user_id": 6337748, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7Si7m.jpg?s=128&g=1", "display_name": "notionquest", "link": "https://stackoverflow.com/users/6337748/notionquest"}, "is_accepted": false, "score": 0, "last_activity_date": 1480128970, "creation_date": 1480128970, "answer_id": 40814488, "question_id": 40814338, "link": "https://stackoverflow.com/questions/40814338/unmarshalling-arrays-in-json-structure/40814488#40814488", "title": "Unmarshalling arrays in JSON structure", "body": "<p>Please change the struct as below.</p>\n\n<pre><code>type  zMessage  struct {\n        Message string `json:\"message\"`\n    }\n\n    type zTargets struct {\n        Idtarget string `json:\"id\"`\n    }\n\n\n    var  val  struct {       \n        Targets [] zTargets `json:\"targets\"`         \n\n    }\n</code></pre>\n\n<p>You will get the target id printed as you coded.</p>\n\n<pre><code>{[{00u34k73otQGIAFUALPR}]}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "is_accepted": false, "score": 0, "last_activity_date": 1480129541, "creation_date": 1480129541, "answer_id": 40814528, "question_id": 40814338, "link": "https://stackoverflow.com/questions/40814338/unmarshalling-arrays-in-json-structure/40814528#40814528", "title": "Unmarshalling arrays in JSON structure", "body": "<p>You need to modify your structs and use a code like this example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype MyJSON struct {\n    EventID   string      `json:\"eventID\"`\n    SessionID string      `json:\"sessionID\"`\n    Targets   []MyTargets `json:\"targets\"`\n}\n\ntype MyTargets struct {\n    Id          string `json:\"id\"`\n    DisplayName string `json:\"displayName\"`\n    Login       string `json:\"login\"`\n    ObjectType  string `json:\"objectType\"`\n}\n\nfunc main() {\n    myJson := []byte(`{ \n    \"eventId\": \"tevtNKIsHrFQTyyMeYDMc5jgQ1459184873000\", \n    \"sessionId\": \"1016Q-vnpnlQwCiLiyH7e_cNg\",\n    \"targets\": [\n         {\n             \"id\": \"00u34k73otQGIAFUALPR\",\n              \"displayName\": \"okta admin\",\n               \"login\":\"oktaadmin@okta.com\",\n                \"objectType\": \"User\" \n         } \n    ] \n}`)\n\n    myStruct := MyJSON{}\n    json.Unmarshal(myJson, &amp;myStruct)\n    fmt.Printf(`\n    eventId: %s\n    sessionID: %s\n    targets.id: %s\n    targets.displayName: %s\n    targets.login: %s\n    targets.objectType: %s\n\n`, myStruct.EventID, myStruct.SessionID,\n   myStruct.Targets[0].Id,\n   myStruct.Targets[0].DisplayName,\n   myStruct.Targets[0].Login,\n   myStruct.Targets[0].ObjectType)\n}\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>eventId: tevtNKIsHrFQTyyMeYDMc5jgQ1459184873000\nsessionID: 1016Q-vnpnlQwCiLiyH7e_cNg\ntargets.id: 00u34k73otQGIAFUALPR\ntargets.displayName: okta admin\ntargets.login: oktaadmin@okta.com\ntargets.objectType: User\n</code></pre>\n\n<p>Also you can check this code in <a href=\"https://play.golang.org/p/as9QJS4Cav\" rel=\"nofollow noreferrer\">https://play.golang.org/p/as9QJS4Cav</a></p>\n"}], "owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 40814477, "answer_count": 3, "score": 1, "last_activity_date": 1480129541, "creation_date": 1480127047, "question_id": 40814338, "link": "https://stackoverflow.com/questions/40814338/unmarshalling-arrays-in-json-structure", "title": "Unmarshalling arrays in JSON structure", "body": "<p>Stackoverflow:</p>\n\n<p>I've been struggling to unmarshal what I wouldn't consider an especially complex \nJSON response in GO. (which I'm fairly new to). Example below:</p>\n\n<pre><code>{ \"eventId\": \"tevtNKIsHrFQTyyMeYDMc5jgQ1459184873000\", \n  \"sessionId\": \"1016Q-vnpnlQwCiLiyH7e_cNg\", \n  \"targets\": \n     [ { \"id\": \"00u34k73otQGIAFUALPR\", \"displayName\": \"okta admin\", \"login\":       \"oktaadmin@okta.com\", \"objectType\": \"User\" } ] }\n</code></pre>\n\n<p>I tried representing this as an array of structs, but it never seems to connect.</p>\n\n<p>I put my code on the GO Lang playground, if anyone can take a look I'd be very\nappreciative.</p>\n\n<p><a href=\"https://play.golang.org/p/TVYeYe7e_I\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TVYeYe7e_I</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 984, "user_id": 3923525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d90a45bd3413a35bcc6286225d97c8b5?s=128&d=identicon&r=PG&f=1", "display_name": "jmm", "link": "https://stackoverflow.com/users/3923525/jmm"}, "edited": false, "score": 0, "creation_date": 1480124228, "post_id": 40814101, "comment_id": 68848453, "body": "Wow, that was a stupid mistake indeed. Thanks a lot!"}], "tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 1, "last_activity_date": 1480123843, "creation_date": 1480123843, "answer_id": 40814101, "question_id": 40813776, "link": "https://stackoverflow.com/questions/40813776/panic-error-when-trying-to-serve-a-gin-gonic-app/40814101#40814101", "title": "Panic error when trying to serve a Gin Gonic app", "body": "<p>Change the initialization on mappings</p>\n\n<pre><code>var Router *gin.Engine\n\nfunc CreateUrlMappings() {\n    Router = gin.Default()\n    // v1 of the API\n    v1 := Router.Group(\"/v1\")\n    {\n        v1.GET(\"/notes\", controllers.AllNotesEndpoint)\n    }\n}\n</code></pre>\n\n<p>You're creating a new local variable when you use \":=\" operator</p>\n\n<pre><code>Router := gin.Default()  // this is wrong if you are using a global var\n</code></pre>\n"}], "owner": {"reputation": 984, "user_id": 3923525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d90a45bd3413a35bcc6286225d97c8b5?s=128&d=identicon&r=PG&f=1", "display_name": "jmm", "link": "https://stackoverflow.com/users/3923525/jmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 0, "accepted_answer_id": 40814101, "answer_count": 1, "score": 0, "last_activity_date": 1480123843, "creation_date": 1480119705, "last_edit_date": 1495535580, "question_id": 40813776, "link": "https://stackoverflow.com/questions/40813776/panic-error-when-trying-to-serve-a-gin-gonic-app", "title": "Panic error when trying to serve a Gin Gonic app", "body": "<p>I'm trying to create a small API using <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">Gin framework for Go</a>, and I'm getting an error when trying to split it in many files. Since I'm an absolute beginner in Go, I'm probably doing some big stupid mistake, so please bear with me :)<br>\nMy project structure is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ijgnF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ijgnF.png\" alt=\"project structure\"></a></p>\n\n<p>models.go</p>\n\n<pre><code>package models\n\ntype Note struct {\n    Title   string `form:\"title\" json:\"title\" binding:\"required\"`\n    Body    string `form:\"body\" json:\"body\" binding:\"required\"`\n}\n\nvar Notes []Note\n\nfunc MockData() {\n    Notes = append(Notes, Note{Title: \"My first note\", Body: \"Brazil beated Argentina very badly :(\"})\n    Notes = append(Notes, Note{Title: \"Some more notes\", Body: \"I hope we can defeat Colombia\"})\n}\n</code></pre>\n\n<p>url_mappings.go</p>\n\n<pre><code>package mappings\n\nimport (\n    \"gopkg.in/gin-gonic/gin.v1\"\n    \"github.com/juanmougan/notepad/api/controllers\"\n)\n\nvar Router *gin.Engine\n\nfunc CreateUrlMappings() {\n    Router := gin.Default()\n    // v1 of the API\n    v1 := Router.Group(\"/v1\")\n    {\n        v1.GET(\"/notes\", controllers.AllNotesEndpoint)\n    }\n}\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/juanmougan/notepad/api/models\"\n    \"github.com/juanmougan/notepad/api/mappings\"\n)\n\nfunc main() {\n    // TODO eventually use a real DB\n    models.MockData()\n    mappings.CreateUrlMappings()\n    // Listen and server on 0.0.0.0:8080\n    mappings.Router.Run(\":8080\")\n}\n</code></pre>\n\n<p>notes_controllers.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"gopkg.in/gin-gonic/gin.v1\"\n    \"net/http\"\n    \"github.com/juanmougan/notepad/api/models\"\n)\n\nfunc AllNotesEndpoint(c *gin.Context) {\n    c.JSON(http.StatusOK, models.Notes)\n}\n</code></pre>\n\n<p>When I run the app, it seems to start Ok</p>\n\n<pre><code>MacBook-Pro-de-Juan:notepad juanma$ go run api/main/main.go \n[GIN-debug] [WARNING] Running in \"debug\" mode. Switch to \"release\" mode in production.\n - using env:   export GIN_MODE=release\n - using code:  gin.SetMode(gin.ReleaseMode)\n\n[GIN-debug] GET    /v1/notes                 --&gt; github.com/juanmougan/notepad/api/controllers.AllNotesEndpoint (3 handlers)\n[GIN-debug] Listening and serving HTTP on :8080\n</code></pre>\n\n<p>But when trying to navigate to <code>http://localhost:8080/v1/notes</code>, I get this error:</p>\n\n<pre><code>http: panic serving [::1]:50178: runtime error: invalid memory address or nil pointer dereference\ngoroutine 35 [running]:\nnet/http.(*conn).serve.func1(0xc420166400)\n    /usr/local/opt/go/libexec/src/net/http/server.go:1491 +0x12a\npanic(0x396220, 0xc42000c0b0)\n    /usr/local/opt/go/libexec/src/runtime/panic.go:458 +0x243\ngopkg.in/gin-gonic/gin%2ev1.(*Engine).ServeHTTP(0x0, 0x5a7c80, 0xc4201ec0d0, 0xc4200f0870)\n    /Users/juanma/.go/src/gopkg.in/gin-gonic/gin.v1/gin.go:260 +0x26\nnet/http.serverHandler.ServeHTTP(0xc420166380, 0x5a7c80, 0xc4201ec0d0, 0xc4200f0870)\n    /usr/local/opt/go/libexec/src/net/http/server.go:2202 +0x7d\nnet/http.(*conn).serve(0xc420166400, 0x5a83c0, 0xc420174440)\n    /usr/local/opt/go/libexec/src/net/http/server.go:1579 +0x4b7\ncreated by net/http.(*Server).Serve\n    /usr/local/opt/go/libexec/src/net/http/server.go:2293 +0x44d\nhttp: panic serving [::1]:50179: runtime error: invalid memory address or nil pointer dereference\ngoroutine 36 [running]:\nnet/http.(*conn).serve.func1(0xc420166600)\n    /usr/local/opt/go/libexec/src/net/http/server.go:1491 +0x12a\npanic(0x396220, 0xc42000c0b0)\n    /usr/local/opt/go/libexec/src/runtime/panic.go:458 +0x243\ngopkg.in/gin-gonic/gin%2ev1.(*Engine).ServeHTTP(0x0, 0x5a7c80, 0xc420214000, 0xc4200f0960)\n    /Users/juanma/.go/src/gopkg.in/gin-gonic/gin.v1/gin.go:260 +0x26\nnet/http.serverHandler.ServeHTTP(0xc420166380, 0x5a7c80, 0xc420214000, 0xc4200f0960)\n    /usr/local/opt/go/libexec/src/net/http/server.go:2202 +0x7d\nnet/http.(*conn).serve(0xc420166600, 0x5a83c0, 0xc420174600)\n    /usr/local/opt/go/libexec/src/net/http/server.go:1579 +0x4b7\ncreated by net/http.(*Server).Serve\n    /usr/local/opt/go/libexec/src/net/http/server.go:2293 +0x44d\n</code></pre>\n\n<p>Which is strange, because I don't see any reference to my own code. I have found some similar questions, <a href=\"https://stackoverflow.com/questions/35223285/golang-goroutines-panic-runtime-error-invalid-memory-address\">like this</a>, but all of them seem to have errors on their own code at the top of the stack trace. For I can see, I'm only getting framework errors.<br>\nAny ideas on what could be going wrong here?  </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-storage"], "comments": [{"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1484191569, "post_id": 40813640, "comment_id": 70411520, "body": "And the error is...?"}, {"owner": {"reputation": 1008, "user_id": 747917, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71129109baab1673748ad7e67724cf99?s=128&d=identicon&r=PG", "display_name": "Ahmad Muzakki", "link": "https://stackoverflow.com/users/747917/ahmad-muzakki"}, "edited": false, "score": 0, "creation_date": 1501605725, "post_id": 40813640, "comment_id": 77847561, "body": "the error is <code>unable to close bucket googleapi: Error 401: Invalid Credentials, authError</code>"}, {"owner": {"reputation": 377, "user_id": 2214818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/904dfd8f939241f50c468d2f27b25bd0?s=128&d=identicon&r=PG", "display_name": "Tiega", "link": "https://stackoverflow.com/users/2214818/tiega"}, "edited": false, "score": 0, "creation_date": 1526033684, "post_id": 40813640, "comment_id": 87596105, "body": "solved the issue?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 3272029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4702ff9851bb42dfc9fa1389254e76f?s=128&d=identicon&r=PG&f=1", "display_name": "slash-dev", "link": "https://stackoverflow.com/users/3272029/slash-dev"}, "is_accepted": false, "score": 1, "last_activity_date": 1547987983, "last_edit_date": 1547987983, "creation_date": 1547987448, "answer_id": 54276460, "question_id": 40813640, "link": "https://stackoverflow.com/questions/40813640/google-cloud-storage-error-401-invalid-credentials/54276460#54276460", "title": "Google Cloud Storage: Error 401: Invalid Credentials", "body": "<p>I got the same error and finally managed to solve the problem with the 2 simple following steps:</p>\n\n<p>Authenticate my application with my credentials to be able to write on it.\n$ gcloud auth application-default login </p>\n\n<p>Run dev_appserver with the dev bucket name:\n$ dev_appserver.py app --default_gcs_bucket_name [MY_DEV_BUCKET_NAME]</p>\n\n<p>Replace MY_DEV_BUCKET_NAME by your actual bucket. You can create a new bucket just for dev.</p>\n"}], "owner": {"reputation": 4176, "user_id": 26849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-tO7nkYt2C3Q/AAAAAAAAAAI/AAAAAAAAAr4/UstVddaB4E4/photo.jpg?sz=128", "display_name": "chris", "link": "https://stackoverflow.com/users/26849/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1547987983, "creation_date": 1480118395, "question_id": 40813640, "link": "https://stackoverflow.com/questions/40813640/google-cloud-storage-error-401-invalid-credentials", "title": "Google Cloud Storage: Error 401: Invalid Credentials", "body": "<p>I have tried running the dev server with <code>goapp serve</code> and <code>dev_appserver.py --default_gcs_bucket_name xxx.appspot.com  .</code>, but I always get the same error after calling <code>wc.Close()</code>.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>// test file\nb, err := ioutil.ReadFile(\"./files/me.jpg\")\nif err != nil {\n    return err\n}\n\nbucketName, err := file.DefaultBucketName(c)\nif err != nil {\n    return err\n}\n\nclient, err := storage.NewClient(c)\nif err != nil {\n    return err\n}\ndefer client.Close()\n\nbucket := client.Bucket(bucketName)\nwc := bucket.Object(\"me.jpg\").NewWriter(c)\n\nif _, err = wc.Write(b); err != nil {\n    return err\n}\n\nif err = wc.Close(); err != nil {\n    log.Errorf(c, \"Failed to close file\", err)\n    return err\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 461, "user_id": 2352214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516b7f833048dfafe630e0b584687620?s=128&d=identicon&r=PG", "display_name": "jcjones1515", "link": "https://stackoverflow.com/users/2352214/jcjones1515"}, "is_accepted": true, "score": 1, "last_activity_date": 1481050422, "last_edit_date": 1481050422, "creation_date": 1480690016, "answer_id": 40934885, "question_id": 40812153, "link": "https://stackoverflow.com/questions/40812153/google-appengine-datastore-filter-with-or-like-sql-golang/40934885#40934885", "title": "Google appengine datastore filter with OR like sql (golang)", "body": "<p>GQL provides many SQL-like features, but OR isn't one of them (see <a href=\"https://cloud.google.com/appengine/docs/python/datastore/gqlreference#Syntax\" rel=\"nofollow noreferrer\">GQL reference</a>).  You could do two queries and a set intersection on the results.  Alternatively you could denormalize a bit and add a UserAndMembers property which contained both and then just use an IN query.</p>\n"}], "owner": {"reputation": 51, "user_id": 1979569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0668ffac55c449e908b30ed48e72fe34?s=128&d=identicon&r=PG", "display_name": "Aymane Mzily", "link": "https://stackoverflow.com/users/1979569/aymane-mzily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 40934885, "answer_count": 1, "score": 2, "last_activity_date": 1481050422, "creation_date": 1480107219, "last_edit_date": 1480522175, "question_id": 40812153, "link": "https://stackoverflow.com/questions/40812153/google-appengine-datastore-filter-with-or-like-sql-golang", "title": "Google appengine datastore filter with OR like sql (golang)", "body": "<p>I have a struct</p>\n\n<pre><code>type Test struct{\nName      string\nCreation  time.Time\nUser      *datastore.Key\nMembres   []*datastore.Key\n}\n</code></pre>\n\n<p>I want equivalent of this sql query in datastore query</p>\n\n<pre><code>SELECT * FROM Test WHERE User=myOwnUser OR myOwnUser in(Membres)\n</code></pre>\n\n<p>Thank's</p>\n"}, {"tags": ["python", "string", "go"], "answers": [{"tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": false, "score": 18, "last_activity_date": 1480102338, "creation_date": 1480102338, "answer_id": 40811348, "question_id": 40811117, "link": "https://stackoverflow.com/questions/40811117/equivalent-of-python-string-format-in-go/40811348#40811348", "title": "Equivalent of Python string.format in Go?", "body": "<p>I don't know of any easy way of naming the parameters, but you can easily change the order of the arguments, using explicit argument indexes:</p>\n\n<p>From <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>In Printf, Sprintf, and Fprintf, the default behavior is for each formatting verb to format successive arguments passed in the call. However, the notation [n] immediately before the verb indicates that the nth one-indexed argument is to be formatted instead. The same notation before a '*' for a width or precision selects the argument index holding the value. After processing a bracketed expression [n], subsequent verbs will use arguments n+1, n+2, etc. unless otherwise directed.</p>\n</blockquote>\n\n<p>Then you can, ie:</p>\n\n<pre><code>fmt.Printf(\"File %[2]s had error %[1]s\", err, myfile)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "is_accepted": false, "score": 4, "last_activity_date": 1480103044, "creation_date": 1480103044, "answer_id": 40811473, "question_id": 40811117, "link": "https://stackoverflow.com/questions/40811117/equivalent-of-python-string-format-in-go/40811473#40811473", "title": "Equivalent of Python string.format in Go?", "body": "<p>The parameter can also be a map, so the following function would work if you don't mind parsing every error format every time you use it:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"text/template\"\n    \"fmt\"\n)\n\nfunc msg(fmt string, args map[string]interface{}) (str string) {\n    var msg bytes.Buffer\n\n    tmpl, err := template.New(\"errmsg\").Parse(fmt)\n\n    if err != nil {\n        return fmt\n    }\n\n    tmpl.Execute(&amp;msg, args)\n    return msg.String()\n}\n\nfunc main() {\n    fmt.Printf(msg(\"File {{.File}} has error {{.Error}}\\n\", map[string]interface{} {\n        \"File\": \"abc\",\n        \"Error\": \"def\",\n    }))\n}\n</code></pre>\n\n<p>It's still a little wordier than I would have liked, but it's better than some other options, I suppose. You could turn <code>map[string]interface{}</code> into a local type and reduce it further to:</p>\n\n<pre><code>type P map[string]interface{}\n\nfmt.Printf(msg(\"File {{.File}} has error {{.Error}}\\n\", P{\n        \"File\": \"abc\",\n        \"Error\": \"def\",\n    }))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1480105850, "post_id": 40811635, "comment_id": 68844175, "body": "I suppose that you could also combine the approach in my answer using a map, below, with your approach in log3, putting the args into a map instead of a string array and then formatting it as you do with log4. A lot of the complication in my example was to achieve returning a string. Could you modify log4 to accommodate that?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1480106554, "post_id": 40811635, "comment_id": 68844418, "body": "@ScottDeerwester Yes, added a <code>log33()</code> variant taking a <code>map</code> and returning the result as a <code>string</code>, also added a <code>log5()</code> variant returning the result instead of printing it to the standard output."}, {"owner": {"reputation": 11779, "user_id": 76664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b7dbe045b7c03fddda8ce6725e816?s=128&d=identicon&r=PG", "display_name": "elo80ka", "link": "https://stackoverflow.com/users/76664/elo80ka"}, "edited": false, "score": 0, "creation_date": 1509197205, "post_id": 40811635, "comment_id": 80926917, "body": "@icza: Thanks for an awesome answer. I wonder if, almost a year later, there&#39;s a better way of doing this? In the end, I went with <code>strings.Replacer</code>, and it seems to work fine."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11779, "user_id": 76664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b7dbe045b7c03fddda8ce6725e816?s=128&d=identicon&r=PG", "display_name": "elo80ka", "link": "https://stackoverflow.com/users/76664/elo80ka"}, "edited": false, "score": 0, "creation_date": 1509356902, "post_id": 40811635, "comment_id": 80970695, "body": "@elo80ka Not that I know of. You have the same options as a year before."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 41, "last_activity_date": 1480106215, "last_edit_date": 1495540008, "creation_date": 1480104085, "answer_id": 40811635, "question_id": 40811117, "link": "https://stackoverflow.com/questions/40811117/equivalent-of-python-string-format-in-go/40811635#40811635", "title": "Equivalent of Python string.format in Go?", "body": "<h2>With <code>strings.Replacer</code></h2>\n\n<p>Using <a href=\"https://golang.org/pkg/strings/#Replacer\" rel=\"noreferrer\"><code>strings.Replacer</code></a>, implementing a formatter of your desire is very easy and compact.</p>\n\n<pre><code>func main() {\n    file, err := \"/data/test.txt\", \"file not found\"\n\n    log(\"File {file} had error {error}\", \"{file}\", file, \"{error}\", err)\n}\n\nfunc log(format string, args ...string) {\n    r := strings.NewReplacer(args...)\n    fmt.Println(r.Replace(format))\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/sDVi-3NUiw\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>File /data/test.txt had error file not found\n</code></pre>\n\n<p>We can make it more pleasant to use by adding the brackets to the parameter names automatically in the <code>log()</code> function:</p>\n\n<pre><code>func main() {\n    file, err := \"/data/test.txt\", \"file not found\"\n\n    log2(\"File {file} had error {error}\", \"file\", file, \"error\", err)\n}\n\nfunc log2(format string, args ...string) {\n    for i, v := range args {\n        if i%2 == 0 {\n            args[i] = \"{\" + v + \"}\"\n        }\n    }\n    r := strings.NewReplacer(args...)\n    fmt.Println(r.Replace(format))\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/3Odo_LmM6c\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>File /data/test.txt had error file not found\n</code></pre>\n\n<p>Yes, you could say that this only accepts <code>string</code> parameter values. This is true. With a little more improvement, this won't be true:</p>\n\n<pre><code>func main() {\n    file, err := \"/data/test.txt\", 666\n\n    log3(\"File {file} had error {error}\", \"file\", file, \"error\", err)\n}\n\nfunc log3(format string, args ...interface{}) {\n    args2 := make([]string, len(args))\n    for i, v := range args {\n        if i%2 == 0 {\n            args2[i] = fmt.Sprintf(\"{%v}\", v)\n        } else {\n            args2[i] = fmt.Sprint(v)\n        }\n    }\n    r := strings.NewReplacer(args2...)\n    fmt.Println(r.Replace(format))\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/0KtRjDIFTN\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>File /data/test.txt had error 666\n</code></pre>\n\n<p>A variant of this to accept params as a <code>map[string]interface{}</code> and return the result as a <code>string</code>:</p>\n\n<pre><code>type P map[string]interface{}\n\nfunc main() {\n    file, err := \"/data/test.txt\", 666\n\n    s := log33(\"File {file} had error {error}\", P{\"file\": file, \"error\": err})\n    fmt.Println(s)\n}\n\nfunc log33(format string, p P) string {\n    args, i := make([]string, len(p)*2), 0\n    for k, v := range p {\n        args[i] = \"{\" + k + \"}\"\n        args[i+1] = fmt.Sprint(v)\n        i += 2\n    }\n    return strings.NewReplacer(args...).Replace(format)\n}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/i9XUTN9V3m\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<h2>With <code>text/template</code></h2>\n\n<p>Your template solution or proposal is also way too verbose. It can be written as compact as this (error checks omitted):</p>\n\n<pre><code>type P map[string]interface{}\n\nfunc main() {\n    file, err := \"/data/test.txt\", 666\n\n    log4(\"File {{.file}} has error {{.error}}\", P{\"file\": file, \"error\": err})\n}\n\nfunc log4(format string, p P) {\n    t := template.Must(template.New(\"\").Parse(format))\n    t.Execute(os.Stdout, p)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/D-hoAeCakq\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>File /data/test.txt has error 666\n</code></pre>\n\n<p>If you want to return the <code>string</code> (instead of printing it to the standard output), you may do it like this (try it on the <a href=\"https://play.golang.org/p/L9L9OerQYZ\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>func log5(format string, p P) string {\n    b := &amp;bytes.Buffer{}\n    template.Must(template.New(\"\").Parse(format)).Execute(b, p)\n    return b.String()\n}\n</code></pre>\n\n<h2>Using explicit argument indices</h2>\n\n<p>This was already mentioned in another answer, but to complete it, know that the same explicit argument index may be used arbitrary number of times and thus resulting in the same parameter substituted in multiple times. Read more about this in this question: <a href=\"https://stackoverflow.com/questions/37001449/replace-all-variables-in-sprintf-with-same-variable\">Replace all variables in Sprintf with same variable</a></p>\n"}, {"tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": false, "score": 1, "last_activity_date": 1480104324, "creation_date": 1480104324, "answer_id": 40811665, "question_id": 40811117, "link": "https://stackoverflow.com/questions/40811117/equivalent-of-python-string-format-in-go/40811665#40811665", "title": "Equivalent of Python string.format in Go?", "body": "<p>Alas, there's no built-in function in Go for string interpolation with named parameters (yet). But you are not the only one suffering out there :) Some packages should exist, for example: <a href=\"https://github.com/imkira/go-interpol\" rel=\"nofollow noreferrer\">https://github.com/imkira/go-interpol</a> . Or, if feeling adventurous, you could write such a helper yourself, as the concept is actually quite simple.</p>\n\n<p>Cheers,\nDennis</p>\n"}, {"tags": [], "owner": {"reputation": 24435, "user_id": 3191896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVtnn.png?s=128&g=1", "display_name": "Jossef Harush", "link": "https://stackoverflow.com/users/3191896/jossef-harush"}, "is_accepted": false, "score": 0, "last_activity_date": 1592513383, "last_edit_date": 1592644375, "creation_date": 1592513383, "answer_id": 62459186, "question_id": 40811117, "link": "https://stackoverflow.com/questions/40811117/equivalent-of-python-string-format-in-go/62459186#62459186", "title": "Equivalent of Python string.format in Go?", "body": "<p>You can get quite close to that sweet <strong>python formatting experience</strong>:</p>\n<pre><code>message := FormatString(&quot;File {file} had error {error}&quot;, Items{&quot;file&quot;=myfile, &quot;error&quot;=err})\n</code></pre>\n<p>Declare the following somewhere in your code:</p>\n<pre><code>type Items map[string]interface{}\n\nfunc FormatString(template string, items Items) string {\n    for key, value := range items {\n        template = strings.ReplaceAll(template, fmt.Sprintf(&quot;{%v}&quot;, key), fmt.Sprintf(&quot;%v&quot;, value))\n    }\n    return template\n}\n</code></pre>\n<ul>\n<li>\ud83d\udca1 note that my implementation is <strong>very naive and inefficient for high-performance needs</strong></li>\n</ul>\n<hr />\n<h1>sudo make me a package</h1>\n<p>Seeing the <strong>development experience</strong> potential with having a simple signature like this, I've got tempted and uploaded a go package called <code>format</code>.</p>\n<pre><code>package main\n\nimport (\n  &quot;fmt&quot;\n  &quot;github.com/jossef/format&quot;\n)\n\nfunc main() {\n  formattedString := format.String(`hello &quot;{name}&quot;. is lizard? {isLizard}`, format.Items{&quot;name&quot;: &quot;Mr Dude&quot;, &quot;isLizard&quot;: false})\n  fmt.Println(formattedString)\n}\n</code></pre>\n<p><a href=\"https://repl.it/@jossef/format\" rel=\"nofollow noreferrer\">https://repl.it/@jossef/format</a></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 8964181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z7ztp.png?s=128&g=1", "display_name": "tymonx", "link": "https://stackoverflow.com/users/8964181/tymonx"}, "is_accepted": false, "score": 0, "last_activity_date": 1603746608, "creation_date": 1603746608, "answer_id": 64545011, "question_id": 40811117, "link": "https://stackoverflow.com/questions/40811117/equivalent-of-python-string-format-in-go/64545011#64545011", "title": "Equivalent of Python string.format in Go?", "body": "<p>You can try the <a href=\"https://gitlab.com/tymonx/go-formatter\" rel=\"nofollow noreferrer\">Go Formatter</a> library that implements <strong>replacement fields</strong> surrounded by curly braces <code>{}</code> format strings similar to Python format.</p>\n<p>Working code example <a href=\"https://play.golang.org/p/ESkGy-TdGMj\" rel=\"nofollow noreferrer\">Go Playground</a>:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n\n    &quot;gitlab.com/tymonx/go-formatter/formatter&quot;\n)\n\nfunc main() {\n    formatted, err := formatter.Format(&quot;Named placeholders {file}:{line}:{function}():&quot;, formatter.Named{\n        &quot;line&quot;:     3,\n        &quot;function&quot;: &quot;func1&quot;,\n        &quot;file&quot;:     &quot;dir/file&quot;,\n    })\n\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(formatted)\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>Named placeholders dir/file:3:func1():\n</code></pre>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12559, "favorite_count": 12, "accepted_answer_id": 40811635, "answer_count": 6, "score": 33, "last_activity_date": 1603746608, "creation_date": 1480101031, "last_edit_date": 1540544741, "question_id": 40811117, "link": "https://stackoverflow.com/questions/40811117/equivalent-of-python-string-format-in-go", "title": "Equivalent of Python string.format in Go?", "body": "<p>In Python, you can do this:</p>\n\n<pre><code>\"File {file} had error {error}\".format(file=myfile, error=err)\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>\"File %(file)s had error %(error)s\" % {\"file\": myfile, \"error\": err}\n</code></pre>\n\n<p>In Go, the simplest option is:</p>\n\n<pre><code>fmt.Sprintf(\"File %s had error %s\", myfile, err)\n</code></pre>\n\n<p>which doesn't let you swap the order of the parameters in the format string, which you need to do for <a href=\"http://en.wikipedia.org/wiki/Internationalization_and_localization\" rel=\"noreferrer\">I18N</a>. Go <em>does</em> have the <code>template</code> package, which would require something like:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"text/template\"\n    \"os\"\n)\n\nfunc main() {\n    type Params struct {\n        File string\n        Error string\n    }\n\n    var msg bytes.Buffer\n\n    params := &amp;Params{\n        File: \"abc\",\n        Error: \"def\",\n    }\n\n    tmpl, _ := template.New(\"errmsg\").Parse(\"File {{.File}} has error {{.Error}}\")\n    tmpl.Execute(&amp;msg, params)\n    msg.WriteTo(os.Stdout)\n}\n</code></pre>\n\n<p>which seems like a long way to go for an error message. Is there a more reasonable option that allows me to give string parameters independent of order?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 283, "user_id": 1839929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54c8f86a5b842e01d9691ff065d2824?s=128&d=identicon&r=PG", "display_name": "gerad", "link": "https://stackoverflow.com/users/1839929/gerad"}, "edited": false, "score": 0, "creation_date": 1480442174, "post_id": 40810735, "comment_id": 68960389, "body": "I agree that using a buffered channel would work, I was trying to avoid that solution though the number of fetches isn&#39;t easily known in advance (the actual code is more complex than the example)."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 2, "last_activity_date": 1480098851, "creation_date": 1480098851, "answer_id": 40810735, "question_id": 40809504, "link": "https://stackoverflow.com/questions/40809504/idiomatic-goroutine-termination-and-error-handling/40810735#40810735", "title": "idiomatic goroutine termination and error handling", "body": "<p>As long as each goroutine completes, you won't leak anything. You should create the error channel as buffered with the buffer size equal to the number of goroutines so that the send operations on the channel won't block. Each goroutine should always send something on the channel when it finishes, whether it succeeds or fails. The loop at the bottom can then just iterate for the number of goroutines and return if it gets a non-nil error. You don't need the WaitGroup or the other goroutine that closes the channel.</p>\n\n<p>I think the reason it appears that goroutines are leaking is that you return when you get the first error, so some of them are still running.</p>\n\n<p>By the way, maps are not goroutine safe. If you share a map among goroutines and some of them are making changes to the map, you need to protect it with a mutex.</p>\n"}, {"comments": [{"owner": {"reputation": 283, "user_id": 1839929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54c8f86a5b842e01d9691ff065d2824?s=128&d=identicon&r=PG", "display_name": "gerad", "link": "https://stackoverflow.com/users/1839929/gerad"}, "edited": false, "score": 0, "creation_date": 1480443032, "post_id": 40811225, "comment_id": 68960796, "body": "the <code>ec := chan error(nil)</code> is interesting, i haven&#39;t seen this pattern before. I thought <code>select</code> causes were executed in random order. Is there a race condition where <code>done&lt;-true</code> gets sent before <code>ec&lt;-err</code>?"}, {"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "reply_to_user": {"reputation": 283, "user_id": 1839929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54c8f86a5b842e01d9691ff065d2824?s=128&d=identicon&r=PG", "display_name": "gerad", "link": "https://stackoverflow.com/users/1839929/gerad"}, "edited": false, "score": 0, "creation_date": 1480483078, "post_id": 40811225, "comment_id": 68976113, "body": "Good catch, there absolutely is a race! I wrote that in a hurry and like I mentioned, didn&#39;t test it (which you should always do). Luckily fixing the mistake only makes the entire code even simpler, and in this case, there&#39;s no need for the <code>chan error(nil)</code> trick (which is useful sometimes when you want to block out a send from a select statement so you don&#39;t have to write multiple conditional selects). Thanks for pointing out my mistake :)"}, {"owner": {"reputation": 1514, "user_id": 195383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/286ea349060105e596aec349da029a00?s=128&d=identicon&r=PG", "display_name": "Menno Smits", "link": "https://stackoverflow.com/users/195383/menno-smits"}, "edited": false, "score": 0, "creation_date": 1504581252, "post_id": 40811225, "comment_id": 79052600, "body": "This can be simplified further. You don&#39;t need separate done and error channels and there&#39;s a few other things than be improved. <a href=\"https://play.golang.org/p/1a0ZXuy3Dz\" rel=\"nofollow noreferrer\">play.golang.org/p/1a0ZXuy3Dz</a>"}, {"owner": {"reputation": 2664, "user_id": 787842, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/58ce85efba210120fb040e34cc445103?s=128&d=identicon&r=PG", "display_name": "cjauvin", "link": "https://stackoverflow.com/users/787842/cjauvin"}, "reply_to_user": {"reputation": 1514, "user_id": 195383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/286ea349060105e596aec349da029a00?s=128&d=identicon&r=PG", "display_name": "Menno Smits", "link": "https://stackoverflow.com/users/195383/menno-smits"}, "edited": false, "score": 0, "creation_date": 1510071164, "post_id": 40811225, "comment_id": 81274681, "body": "@MennoSmits Your simplification is interesting, and in fact I&#39;m wondering why we&#39;d even need the <code>quit</code> channel and the <code>select</code> statement anymore? <a href=\"https://play.golang.org/p/PmovudTviF\" rel=\"nofollow noreferrer\">play.golang.org/p/PmovudTviF</a>"}, {"owner": {"reputation": 1514, "user_id": 195383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/286ea349060105e596aec349da029a00?s=128&d=identicon&r=PG", "display_name": "Menno Smits", "link": "https://stackoverflow.com/users/195383/menno-smits"}, "edited": false, "score": 0, "creation_date": 1510258960, "post_id": 40811225, "comment_id": 81371053, "body": "The <code>quit</code> channel is necessary to stop all goroutines as soon as one of them fails. The OP&#39;s problem statement hinted at that. If it&#39;s OK that the other goroutines continue when one has failed then your solution is spot on."}], "tags": [], "owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "is_accepted": true, "score": 22, "last_activity_date": 1480483635, "last_edit_date": 1480483635, "creation_date": 1480101687, "answer_id": 40811225, "question_id": 40809504, "link": "https://stackoverflow.com/questions/40809504/idiomatic-goroutine-termination-and-error-handling/40811225#40811225", "title": "idiomatic goroutine termination and error handling", "body": "<p>All but one of your goroutines are leaked, because they're still waiting to send to the errs channel - you never finish the for-range that empties it. You're also leaking the goroutine who's job is to close the errs channel, because the waitgroup is never finished.</p>\n\n<p>(Also, as Andy pointed out, deleting from map is not thread-safe, so that'd need protection from a mutex.)</p>\n\n<p>However, I don't think maps, mutexes, waitgroups, contexts etc. are even necessary here. I'd rewrite the whole thing to just use basic channel operations, something like the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc fetchAll() error {\n    var N = 4\n    quit := make(chan bool)\n    errc := make(chan error)\n    done := make(chan error)\n    for i := 0; i &lt; N; i++ {\n        go func(i int) {\n            // dummy fetch\n            time.Sleep(time.Duration(rand.Intn(100)) * time.Millisecond)\n            err := error(nil)\n            if rand.Intn(2) == 0 {\n                err = fmt.Errorf(\"goroutine %d's error returned\", i)\n            }\n            ch := done // we'll send to done if nil error and to errc otherwise\n            if err != nil {\n                ch = errc\n            }\n            select {\n            case ch &lt;- err:\n                return\n            case &lt;-quit:\n                return\n            }\n        }(i)\n    }\n    count := 0\n    for {\n        select {\n        case err := &lt;-errc:\n            close(quit)\n            return err\n        case &lt;-done:\n            count++\n            if count == N {\n                return nil // got all N signals, so there was no error\n            }\n        }\n    }\n}\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    fmt.Println(fetchAll())\n}\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/mxGhSYYkOb\" rel=\"noreferrer\">https://play.golang.org/p/mxGhSYYkOb</a></p>\n\n<p>EDIT: There indeed was a silly mistake, thanks for pointing it out. I fixed the code above (I think...). I also added some randomness for added Realism\u2122.</p>\n\n<p>Also, I'd like to stress that there really are multiple ways to approach this problem, and my solution is but one way. Ultimately it comes down to personal taste, but in general, you want to strive towards \"idiomatic\" code - and towards a style that feels natural and easy to understand for you.</p>\n"}, {"comments": [{"owner": {"reputation": 3359, "user_id": 122727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b5e946def051f311e802140ecb9fbf?s=128&d=identicon&r=PG", "display_name": "kubanczyk", "link": "https://stackoverflow.com/users/122727/kubanczyk"}, "edited": false, "score": 4, "creation_date": 1576967119, "post_id": 55122595, "comment_id": 105064177, "body": "+1, this is brilliant. So clean and idiomatic. A small addendum though - the &quot;remaining&quot; goroutines are untouched by the errgroup. Errgroup just normally waits for their completion. For a fail-fast, each goroutine should have the same <code>ctx</code> and actively pay attention to <code>ctx.Done</code>. In other words, the verb &#39;cancel&#39; in Go lingo doesn&#39;t mean &#39;kill the goroutine&#39;."}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1585197996, "post_id": 55122595, "comment_id": 107679647, "body": "however we are not able to pass aruments to errs.Go"}, {"owner": {"reputation": 1124, "user_id": 5628642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cTRoG.jpg?s=128&g=1", "display_name": "chinmayan", "link": "https://stackoverflow.com/users/5628642/chinmayan"}, "edited": false, "score": 0, "creation_date": 1597853135, "post_id": 55122595, "comment_id": 112270763, "body": "@here, will there be any go routines leak, if there was a case like fetchAll() got returned before reaching <code>return errs.Wait()</code> - (it&#39;s a bad practise though)"}], "tags": [], "owner": {"reputation": 957, "user_id": 1361537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2af45a1a41e3390a2488a913f926083?s=128&d=identicon&r=PG", "display_name": "joth", "link": "https://stackoverflow.com/users/1361537/joth"}, "is_accepted": false, "score": 44, "last_activity_date": 1599347042, "last_edit_date": 1599347042, "creation_date": 1552397179, "answer_id": 55122595, "question_id": 40809504, "link": "https://stackoverflow.com/questions/40809504/idiomatic-goroutine-termination-and-error-handling/55122595#55122595", "title": "idiomatic goroutine termination and error handling", "body": "<p>Using <a href=\"http://golang.org/x/sync/errgroup\" rel=\"noreferrer\">Error Group</a> makes this even simpler. This automatically waits for all the supplied Go Routines to complete successfully, or cancels all those remaining in the case of any one routine returning an error (in which case that error is the one bubble back up to the caller).</p>\n<pre><code>package main\n\nimport (\n        &quot;context&quot;\n        &quot;fmt&quot;\n        &quot;math/rand&quot;\n        &quot;time&quot;\n\n        &quot;golang.org/x/sync/errgroup&quot;\n)\n\nfunc fetchAll(ctx context.Context) error {\n        errs, ctx := errgroup.WithContext(ctx)\n\n        // run all the http requests in parallel\n        for i := 0; i &lt; 4; i++ {\n                errs.Go(func() error {\n                        // pretend this does an http request and returns an error                                                  \n                        time.Sleep(time.Duration(rand.Intn(100)) * time.Millisecond)                                               \n                        return fmt.Errorf(&quot;error in go routine, bailing&quot;)                                                      \n                })\n        }\n\n        // Wait for completion and return the first error (if any)                                                                 \n        return errs.Wait()\n}\n\nfunc main() {\n        fmt.Println(fetchAll(context.Background()))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3359, "user_id": 122727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b5e946def051f311e802140ecb9fbf?s=128&d=identicon&r=PG", "display_name": "kubanczyk", "link": "https://stackoverflow.com/users/122727/kubanczyk"}, "edited": false, "score": 0, "creation_date": 1576970533, "post_id": 56906488, "comment_id": 105064831, "body": "That &quot;elegant way&quot; comment somehow made me nearly sure that extra goroutine is a race. Now I interpret it as just a small additional producer which only closes the door. This straightens out my intuition. As always, the producer closes and not the consumer."}], "tags": [], "owner": {"reputation": 6956, "user_id": 766172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f581bac48616fc169e922911e652c55?s=128&d=identicon&r=PG", "display_name": "syvex", "link": "https://stackoverflow.com/users/766172/syvex"}, "is_accepted": false, "score": 4, "last_activity_date": 1562343821, "creation_date": 1562343821, "answer_id": 56906488, "question_id": 40809504, "link": "https://stackoverflow.com/questions/40809504/idiomatic-goroutine-termination-and-error-handling/56906488#56906488", "title": "idiomatic goroutine termination and error handling", "body": "<p>Here's a more complete example using <a href=\"https://godoc.org/golang.org/x/sync/errgroup\" rel=\"nofollow noreferrer\">errgroup</a> suggested by <a href=\"https://stackoverflow.com/a/55122595/766172\">joth</a>. It shows processing successful data, and will exit on the first error.</p>\n\n<p><a href=\"https://play.golang.org/p/rU1v-Mp2ijo\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rU1v-Mp2ijo</a></p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"golang.org/x/sync/errgroup\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc fetchAll() error {\n    g, ctx := errgroup.WithContext(context.Background())\n    results := make(chan int)\n    for i := 0; i &lt; 4; i++ {\n        current := i\n        g.Go(func() error {\n            // Simulate delay with random errors.\n            time.Sleep(time.Duration(rand.Intn(100)) * time.Millisecond)\n            if rand.Intn(2) == 0 {\n                return fmt.Errorf(\"goroutine %d's error returned\", current)\n            }\n            // Pass processed data to channel, or receive a context completion.\n            select {\n            case results &lt;- current:\n                return nil\n            // Close out if another error occurs.\n            case &lt;-ctx.Done():\n                return ctx.Err()\n            }\n        })\n    }\n\n    // Elegant way to close out the channel when the first error occurs or\n    // when processing is successful.\n    go func() {\n        g.Wait()\n        close(results)\n    }()\n\n    for result := range results {\n        fmt.Println(\"processed\", result)\n    }\n\n    // Wait for all fetches to complete.\n    return g.Wait()\n}\n\nfunc main() {\n    fmt.Println(fetchAll())\n}\n\n</code></pre>\n"}], "owner": {"reputation": 283, "user_id": 1839929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54c8f86a5b842e01d9691ff065d2824?s=128&d=identicon&r=PG", "display_name": "gerad", "link": "https://stackoverflow.com/users/1839929/gerad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31541, "favorite_count": 13, "accepted_answer_id": 40811225, "answer_count": 4, "score": 28, "last_activity_date": 1599347042, "creation_date": 1480092664, "question_id": 40809504, "link": "https://stackoverflow.com/questions/40809504/idiomatic-goroutine-termination-and-error-handling", "title": "idiomatic goroutine termination and error handling", "body": "<p>I have a simple concurrency use case in go, and it's driving me nuts I can't figure out an elegant solution. Any help would be appreciated.</p>\n\n<p>I want to write a method <code>fetchAll</code> that queries an unspecified number of resources from remote servers in parallel. If any of the fetches fails, I want to return that first error immediately.</p>\n\n<p>My initial, naive implementation, leaks goroutines:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"math/rand\"\n  \"sync\"\n  \"time\"\n)\n\nfunc fetchAll() error {\n  wg := sync.WaitGroup{}\n  errs := make(chan error)\n  leaks := make(map[int]struct{})\n  defer fmt.Println(\"these goroutines leaked:\", leaks)\n\n  // run all the http requests in parallel\n  for i := 0; i &lt; 4; i++ {\n    leaks[i] = struct{}{}\n    wg.Add(1)\n    go func(i int) {\n      defer wg.Done()\n      defer delete(leaks, i)\n\n      // pretend this does an http request and returns an error\n      time.Sleep(time.Duration(rand.Intn(100)) * time.Millisecond)\n      errs &lt;- fmt.Errorf(\"goroutine %d's error returned\", i)\n    }(i)\n  }\n\n  // wait until all the fetches are done and close the error\n  // channel so the loop below terminates\n  go func() {\n    wg.Wait()\n    close(errs)\n  }()\n\n  // return the first error\n  for err := range errs {\n    if err != nil {\n      return err\n    }\n  }\n\n  return nil\n}\n\nfunc main() {\n  fmt.Println(fetchAll())\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Be93J514R5\" rel=\"noreferrer\">https://play.golang.org/p/Be93J514R5</a></p>\n\n<p>I know from reading <a href=\"https://blog.golang.org/pipelines\" rel=\"noreferrer\">https://blog.golang.org/pipelines</a> that I can create a signal channel to cleanup the other threads. Alternatively, I could probably use <code>context</code> to accomplish it. But it seems like such a simple use case should have a simpler solution that I'm missing.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "edited": false, "score": 0, "creation_date": 1480090135, "post_id": 40808869, "comment_id": 68838360, "body": "using go version go1.7 linux/amd64"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1480091330, "post_id": 40808869, "comment_id": 68838950, "body": "I have a feeling you&#39;ve removed the race in your simplified example. Can you make something that replicates the race, or provide the actual methods and types from your code?"}, {"owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480091414, "post_id": 40808869, "comment_id": 68838998, "body": "The code is quite inter-dependent. It would not help. But to be honest, there is actually no race really, except that it is being reported. This is why I am puzzled."}, {"owner": {"reputation": 1571, "user_id": 1587118, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cBN8s.jpg?s=128&g=1", "display_name": "SRC", "link": "https://stackoverflow.com/users/1587118/src"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480091624, "post_id": 40808869, "comment_id": 68839105, "body": "I agree with @JimB using your example code and setting -race flag I can not reproduce any race report."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1480091732, "post_id": 40808869, "comment_id": 68839165, "body": "The race detector is pretty much guaranteed to not have false positives. There must be some relation between the data structures triggering the race."}, {"owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "edited": false, "score": 0, "creation_date": 1480092131, "post_id": 40808869, "comment_id": 68839383, "body": "Well, good at least that it appears this is &quot;okay&quot;. I was afraid there would be some thing wrong with my struct and approach, but this seems valid. I will try to do more isolation. thanks for your comments. I will detail further as I dig deeper"}], "answers": [{"comments": [{"owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "edited": false, "score": 0, "creation_date": 1480339684, "post_id": 40829059, "comment_id": 68907712, "body": "perfectly what my issue was (methods were by value vs reference). Great suggestions. I wasnt aware of the vet tool or metaliner"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 1, "last_activity_date": 1480250486, "creation_date": 1480250486, "answer_id": 40829059, "question_id": 40808869, "link": "https://stackoverflow.com/questions/40808869/data-race-reported-from-two-distinct-mutexes/40829059#40829059", "title": "data race reported from two distinct mutexes", "body": "<p>Just going to take a guess, but one common cause of this issue is accidentally passing the struct which contains the pointers by value instead of by reference. For example:</p>\n\n<pre><code>type MyStruct struct {\n    dogMutex sync.RWMutex\n    dogMap   map[int]Dog // keyed by PID\n    catMutex sync.RWMutex\n    catMap   map[int]Cat // keyed by (localAddress + localPort)\n}\n\nfunc (s MyStruct) Example() {\n    // this lock doesn't actually work, but the map access does because its a \n    // reference type\n    s.catMutex.Lock()\n    s.catMap[1] = Cat{}\n    s.catMutex.Unlock()\n}\n</code></pre>\n\n<p>Another possibility is that perhaps you are passing the maps into your init:</p>\n\n<pre><code>func (s *MyStruct) Init(cats map[int]Cat) {\n    s.catMap = cats\n}\n</code></pre>\n\n<p>And then you are modifying the map somewhere outside of the struct. If that's the case you need to create a new map and copy all the values.</p>\n\n<p>Incidentally <code>go vet</code> can detect many of these issues, try running it on your code: <a href=\"https://golang.org/cmd/vet/\" rel=\"nofollow noreferrer\">https://golang.org/cmd/vet/</a>. (Also worth a try is the <a href=\"https://github.com/alecthomas/gometalinter\" rel=\"nofollow noreferrer\">metalinter</a>)</p>\n"}], "owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 40829059, "answer_count": 1, "score": 0, "last_activity_date": 1480250486, "creation_date": 1480090079, "last_edit_date": 1480090678, "question_id": 40808869, "link": "https://stackoverflow.com/questions/40808869/data-race-reported-from-two-distinct-mutexes", "title": "data race reported from two distinct mutexes", "body": "<p>An interesting issue has arisen today where I have code that contains more than one Mutex, each covering locking for distinct Maps.</p>\n\n<p>Here is a <strong>similar in struct</strong> of my source code that I am using: </p>\n\n<pre><code>type MyStruct struct {\n    dogMutex sync.RWMutex\n    dogMap   map[int]Dog // keyed by PID\n    catMutex sync.RWMutex\n    catMap   map[int]Cat // keyed by (localAddress + localPort)\n}\n</code></pre>\n\n<p>A more detailed example of the issue is here:\n<a href=\"https://play.golang.org/p/eic8q2VrNq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eic8q2VrNq</a></p>\n\n<p>After building the executable with 'go build -race ...\" the generated executable reports the following race</p>\n\n<p>As the code is way more complex than the example above, it is interesting to notice that the data race is reported on the areas indicated in the code. </p>\n\n<p>The following stack is from the real application. </p>\n\n<p>1) The <strong>write</strong> operation reported on wwww.go:95 is equivalent to my WRITE comment in the code (MethodOne)</p>\n\n<p>2) The <strong>previous read</strong> operattion reported on wwww.go:218 is equivalent to my READ comment in the code (MethodTwo)</p>\n\n<pre><code>=================\nWARNING: DATA RACE\nWrite at 0x00c420017890 by goroutine 97:\n  runtime.mapassign1()\n      /usr/local/go/src/runtime/hashmap.go:442 +0x0\n  main.(*NetworkManager).MethodOne()\n      /opt/doppler/src/xxx/yyy/wwww.go:95 +0x745\n\nPrevious read at 0x00c420017890 by goroutine 70:\n  runtime.mapiterinit()\n      /usr/local/go/src/runtime/hashmap.go:620 +0x0\n  main.NetworkManager.MethodTwo()\n      /opt/xxx/src/xxx/yyy/wwww.go:218 +0x1e9\n  main.(*NetworkManager).SomethingELse()\n      /opt/xxx/src/xxx/yyy/wwww.go:174 +0x99d\n  main.(*NetworkManager).SomethingFurther()\n      /opt/xxx/src/xxx/yyy/wwww.go:102 +0x3c\n</code></pre>\n\n<p>I am wondering if this is a proper way of using mutexes. My code has much concurrency, but I am focusing this question on the fact that the race detector is reporting based on Apples vs Bananas (two completely distinct mutexes)</p>\n"}, {"tags": ["debugging", "go", "grpc", "http2", "grpc-go"], "comments": [{"owner": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 2, "creation_date": 1480320889, "post_id": 40808467, "comment_id": 68896455, "body": "You can debug by setting the <code>GRPC_TRACE</code> environment variable to <code>all</code>. As for HTTP/2 I think it is due to security and reliability concerns. I could be wrong though"}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "reply_to_user": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 0, "creation_date": 1480321209, "post_id": 40808467, "comment_id": 68896597, "body": "Thanks @khuderm \u2026 so, is there an alternative write protocol available then?"}, {"owner": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 1, "creation_date": 1480321406, "post_id": 40808467, "comment_id": 68896698, "body": "Sorry I meant there isn&#39;t one but I am not 100% sure"}, {"owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "edited": false, "score": 2, "creation_date": 1480359324, "post_id": 40808467, "comment_id": 68919547, "body": "<a href=\"https://github.com/grpc/grpc-go/blob/master/transport/transport.go#L393\" rel=\"nofollow noreferrer\">github.com/grpc/grpc-go/blob/master/transport/transport.go#L&zwnj;&#8203;393</a> the library appears to be hardcoded to only use HTTP/2"}], "answers": [{"tags": [], "owner": {"reputation": 243, "user_id": 4918500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd905f22682e1f5a2ea10757ed3737b?s=128&d=identicon&r=PG&f=1", "display_name": "RyanD", "link": "https://stackoverflow.com/users/4918500/ryand"}, "is_accepted": true, "score": 2, "last_activity_date": 1505287425, "creation_date": 1505287425, "answer_id": 46191334, "question_id": 40808467, "link": "https://stackoverflow.com/questions/40808467/how-do-i-debug-grpc-go-services/46191334#46191334", "title": "How do I debug gRPC-Go services?", "body": "<p>Not sure if you've found a solution yet...but depending on how many services you have in your Application, you can use a distributed tracing system to record calls between services. Some of these systems include:</p>\n\n<ul>\n<li>Zipkin (<a href=\"http://zipkin.io/\" rel=\"nofollow noreferrer\">http://zipkin.io/</a>)  </li>\n<li>Dapper (<a href=\"https://research.google.com/pubs/pub36356.html\" rel=\"nofollow noreferrer\">https://research.google.com/pubs/pub36356.html</a>)</li>\n<li>Jaeger (<a href=\"https://uber.github.io/jaeger/\" rel=\"nofollow noreferrer\">https://uber.github.io/jaeger/</a>) </li>\n</ul>\n\n<p>If you use the opentracing project (<a href=\"http://opentracing.io/\" rel=\"nofollow noreferrer\">http://opentracing.io/</a>), you can abstract your tracing code in your client and server from the code that transmits information to the Tracing System. For example, you can instrument your client and servers with Trace statements from OpenTracing, and then you can switch out your trace implementation for a Zipkin or Jaeger Tracer that pushes traces in the correct format.</p>\n\n<p>There are opentracing bindings for gRPC reay to use. <a href=\"https://github.com/grpc-ecosystem/grpc-opentracing\" rel=\"nofollow noreferrer\">https://github.com/grpc-ecosystem/grpc-opentracing</a></p>\n"}], "owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2206, "favorite_count": 0, "accepted_answer_id": 46191334, "answer_count": 1, "score": 4, "last_activity_date": 1557642466, "creation_date": 1480088682, "last_edit_date": 1557642466, "question_id": 40808467, "link": "https://stackoverflow.com/questions/40808467/how-do-i-debug-grpc-go-services", "title": "How do I debug gRPC-Go services?", "body": "<p>Using <a href=\"https://github.com/grpc/grpc-go\" rel=\"nofollow noreferrer\">gRPC-Go</a> is certainly a good way to build resilient, performant and scalable distributed systems. What I don't quite get is how to actually debug services written with it. Also, is HTTP/2 the only <a href=\"http://www.grpc.io/docs/guides/wire.html\" rel=\"nofollow noreferrer\">wire protocol</a> supported?</p>\n"}, {"tags": [".htaccess", "heroku", "go"], "answers": [{"comments": [{"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1480369356, "post_id": 40853896, "comment_id": 68924642, "body": "Thanks @mpm. I know that apps with golang doesn`t use Apache or another web server, om fact my app is running since two months in heroku using Revel. Ok!! I Will check this library and search for a Revel auth library too. Thank you."}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 1, "creation_date": 1480424223, "post_id": 40853896, "comment_id": 68948198, "body": "OK!! done... finally I made an http authentication using as example this: <a href=\"https://github.com/revel/samples/tree/master/booking\" rel=\"nofollow noreferrer\">github.com/revel/samples/tree/master/booking</a> Thanks anyway @mpm"}], "tags": [], "owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "is_accepted": true, "score": 2, "last_activity_date": 1480368806, "creation_date": 1480368806, "answer_id": 40853896, "question_id": 40808154, "link": "https://stackoverflow.com/questions/40808154/golang-app-on-heroku-htaccess-basic-auth/40853896#40853896", "title": "Golang app on Heroku htaccess basic auth", "body": "<p>A Go web application is a server so no need to use Apache httpd server, especially on Heroku that has crystal clear deployment instructions for Go :</p>\n\n<p><a href=\"https://devcenter.heroku.com/categories/go\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/categories/go</a></p>\n\n<p>Follow these instruction closely and you'll find out there is no need for Apache. </p>\n\n<p>htaccess and htpasswd are related to Apache httpd server, they are Apache configuration files.</p>\n\n<p>Finally, Go standard library gives you all the tools you need to implement basic auth yourself :</p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#Request.BasicAuth\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Request.BasicAuth</a> </p>\n"}], "owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 40853896, "answer_count": 1, "score": 0, "last_activity_date": 1499350964, "creation_date": 1480087502, "last_edit_date": 1480268325, "question_id": 40808154, "link": "https://stackoverflow.com/questions/40808154/golang-app-on-heroku-htaccess-basic-auth", "title": "Golang app on Heroku htaccess basic auth", "body": "<p>Is possible use htaccess on golang application running in heroku??<br>\nI had read this <a href=\"https://gist.github.com/bbrewer97202/3316425#gistcomment-1833299\" rel=\"nofollow noreferrer\">link</a> but the solution doesn't work for me (also, the command htpasswd is not recognized in the heroku bash, but I made the htpasswd file usin <a href=\"http://www.htaccesstools.com/\" rel=\"nofollow noreferrer\">this tool</a>). </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["performance", "logging", "go", "runtime"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1480084940, "post_id": 40807281, "comment_id": 68835516, "body": "Of course there&#39;s a cost, it&#39;s just whether it matters for you. If you think it&#39;s causing a performance problem, profile and measure."}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1480368944, "post_id": 40807281, "comment_id": 68924447, "body": "I&#39;d  put runtime.Caller either behind a debug/logging flag or at least defer its call. It obviously has a big performance cost since it does some code introspection."}], "owner": {"reputation": 91, "user_id": 2452088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/650816a183f187e606e9ed448c2408a1?s=128&d=identicon&r=PG", "display_name": "Tinchogob", "link": "https://stackoverflow.com/users/2452088/tinchogob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 894, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1480084491, "creation_date": 1480084491, "question_id": 40807281, "link": "https://stackoverflow.com/questions/40807281/is-there-any-performance-cost-in-using-runtime-caller", "title": "Is there any performance cost in using runtime.Caller?", "body": "<p>I'm using <a href=\"https://golang.org/pkg/runtime/#Caller\" rel=\"nofollow noreferrer\">runtime.Caller</a> quite extensively in my app (for loggin purposes) and was curious as if there is any big performance issue because of it.</p>\n\n<p>Also, as far as I know, its the same api that the std lib log package uses if Lshortfile or Llongfile <a href=\"https://golang.org/pkg/log/#pkg-constants\" rel=\"nofollow noreferrer\">flags</a> are set.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 0, "creation_date": 1480081569, "post_id": 40806143, "comment_id": 68833650, "body": "Thanks @Thomas. I came across your question when I was trying to figure this out, but wondered if it is the same thing. I am not looking for generics (although you could argue that my <code>A</code> and <code>io.Reader</code> are just specialized cases of your <code>interface</code> generic), but rather to pass in <code>[]A</code> (whose implementations must implement <code>io.Reader</code>) to a function that expects <code>[]io.Reader</code>. I can pass <code>A</code> to a function that expects <code>io.Reader</code>, so why not the slice as well?"}, {"owner": {"reputation": 6600, "user_id": 2210667, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/65e361318ee533712efd7929d6e9977c?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2210667/thomas"}, "reply_to_user": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 0, "creation_date": 1480091528, "post_id": 40806143, "comment_id": 68839053, "body": "@deitch from my understanding of Go, a slice is a very special case. You can do a.(io.Reader) but not []a.([]io.Reader), they are unconvertible and Go is strongly typed"}, {"owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 0, "creation_date": 1480176341, "post_id": 40806143, "comment_id": 68859579, "body": "Reading through your other question, and the one flagged above, I was able to understand it. But you are right, and @icza is wrong in that (a) this isn&#39;t an exact duplicate (it has the same underlying principles, but not exactly the same question) and (b) this most certainly <i>is</i> a weakness."}, {"owner": {"reputation": 6600, "user_id": 2210667, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/65e361318ee533712efd7929d6e9977c?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2210667/thomas"}, "reply_to_user": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 0, "creation_date": 1480181260, "post_id": 40806143, "comment_id": 68861142, "body": "I think the -1 is hateful and should really be given to people who don&#39;t put effort in writing their question, etc. I have upvoted you to balance for that"}, {"owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 0, "creation_date": 1480194435, "post_id": 40806143, "comment_id": 68865178, "body": "Thanks @Thomas, but most especially appreciate your help."}], "tags": [], "owner": {"reputation": 6600, "user_id": 2210667, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/65e361318ee533712efd7929d6e9977c?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2210667/thomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1480080408, "last_edit_date": 1495542652, "creation_date": 1480080408, "answer_id": 40806143, "question_id": 40806029, "link": "https://stackoverflow.com/questions/40806029/in-go-how-do-i-pass-a-slice-of-interface-to-something-that-expects-slice-of-a-d/40806143#40806143", "title": "In Go, how do I pass a slice of interface to something that expects slice of a different compatible interface?", "body": "<p>I kind of asked something similar here\n<a href=\"https://stackoverflow.com/questions/38525874/in-go-how-can-i-make-a-generic-function-with-slices\">In Go, how can I make a generic function with slices?</a></p>\n\n<p>Sadly, this is definitely a weakness in Go. The only way for you to go around this is to make a new slice of type []io.Reader with elements from []A</p>\n"}], "owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1252, "favorite_count": 0, "closed_date": 1480081972, "accepted_answer_id": 40806143, "answer_count": 1, "score": 1, "last_activity_date": 1480080408, "creation_date": 1480080018, "question_id": 40806029, "link": "https://stackoverflow.com/questions/40806029/in-go-how-do-i-pass-a-slice-of-interface-to-something-that-expects-slice-of-a-d", "closed_reason": "Duplicate", "title": "In Go, how do I pass a slice of interface to something that expects slice of a different compatible interface?", "body": "<p>I have two interfaces, <code>A</code> and <code>B</code>. It happens that <code>A</code> includes <code>B</code>. Finally, I have a concrete implementation of <code>A</code> (call it <code>Impl</code>), which, by definition, also implements <code>B</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>type A interface {\n    Close() error\n    Read(b []byte) (int, error)\n}\n\ntype Impl struct {}\nfunc (I Impl) Read(b []byte) (int, error) {\n    fmt.Println(\"In read!\")\n    return 10, nil\n}\nfunc (I Impl) Close() error {\n    fmt.Println(\"I am here!\")\n    return nil\n}\n</code></pre>\n\n<p>Since <code>A</code> requires <code>Read()</code>, and <code>Impl</code> implements <code>A</code>, it also satisfies <code>io.Reader</code>.</p>\n\n<p>If I try to pass individual items across functions, it works fine. But if I try slices of <code>A</code> to functions expecting <code>io.Reader</code>, it fails.</p>\n\n<p>Example:</p>\n\n<pre><code>func single(r io.Reader) {\n    fmt.Println(\"in single\")\n}\nfunc slice(r []io.Reader) {\n    fmt.Println(\"in slice\")\n}\nim := &amp;Impl{}\n\n// works\nsingle(im)\n\n// FAILS!\nlist := []A{t}\nslice(list)\n</code></pre>\n\n<p>If I can pass an <code>A</code> to <code>single(r io.Reader)</code>, why can I not pass <code>[]A</code> to <code>slice(r []io.Reader)</code>, and how would I correct it?</p>\n\n<p>Actual implementation at <a href=\"https://play.golang.org/p/QOREQJTQhD\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QOREQJTQhD</a> just uncomment the last two lines in <code>main()</code> and the error shows:</p>\n\n<pre><code>main.go:38: cannot use list (type []A) as type []io.Reader in argument to slice\n</code></pre>\n"}, {"tags": ["go", "goclipse"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1480077281, "post_id": 40803659, "comment_id": 68831057, "body": "Put your <code>HelloWorld.go</code> into a folder under <code>src</code>, e.g. <code>src\\hello\\HelloWorld.go</code>. And you must start it with <code>package main</code> for it to be a runnable program."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4531702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a683150677cf3eda3b6bd40fe1b732c9?s=128&d=identicon&r=PG&f=1", "display_name": "Shreya Srivastava", "link": "https://stackoverflow.com/users/4531702/shreya-srivastava"}, "edited": false, "score": 0, "creation_date": 1480313367, "post_id": 40808171, "comment_id": 68893303, "body": "But when I add a new project the default location for the project comes as D:/Go and Not D;/go/src/TestProject But when I change the location to d:/Go/src/testProject the bin and pkg folders are not made and the Go file is not build."}, {"owner": {"reputation": 310, "user_id": 2178075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QBKQ.jpg?s=128&g=1", "display_name": "peiiion", "link": "https://stackoverflow.com/users/2178075/peiiion"}, "reply_to_user": {"reputation": 41, "user_id": 4531702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a683150677cf3eda3b6bd40fe1b732c9?s=128&d=identicon&r=PG&f=1", "display_name": "Shreya Srivastava", "link": "https://stackoverflow.com/users/4531702/shreya-srivastava"}, "edited": false, "score": 0, "creation_date": 1480430909, "post_id": 40808171, "comment_id": 68953014, "body": "I&#39;m not sure, but i think the default location for a project is based on the Workspace configuration from Eclipse.   About your compilation problems, can you provide the output for the <code>go build</code> or <code>go install</code> commands so we can see what&#39;s the problem and why the pkg/bin folders aren&#39;t being created?"}, {"owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "edited": false, "score": 0, "creation_date": 1480443152, "post_id": 40808171, "comment_id": 68960858, "body": "Did you check if bin and pkg folders where created in <code>D:&#47;Go</code>? (Not <code>D:&#47;Go&#47;src&#47;testProject</code>)"}], "tags": [], "owner": {"reputation": 310, "user_id": 2178075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QBKQ.jpg?s=128&g=1", "display_name": "peiiion", "link": "https://stackoverflow.com/users/2178075/peiiion"}, "is_accepted": true, "score": 0, "last_activity_date": 1480087560, "creation_date": 1480087560, "answer_id": 40808171, "question_id": 40803659, "link": "https://stackoverflow.com/questions/40803659/how-to-setup-go-in-goclipse/40808171#40808171", "title": "How to setup Go in GoClipse", "body": "<p>Your project path should be <code>D:\\GO\\src\\TestProject</code> in order to match the workspace expected as described in <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html</a></p>\n\n<p>Then, your GOPATH should point to <code>D:\\GO</code> (NOT <code>...\\src</code>)\nThe go tool will automatically use <code>$GOPATH/src</code>, <code>$GOPATH/bin</code> or <code>$GOPATH/pkg</code> when appropiate for each case. </p>\n\n<p>And as icza pointed out, your program should have a <code>package main</code> statement on the top of your go file to be recognized as an executable, unless you want to create a package, in that case, you should name your package as you want. </p>\n"}], "owner": {"reputation": 41, "user_id": 4531702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a683150677cf3eda3b6bd40fe1b732c9?s=128&d=identicon&r=PG&f=1", "display_name": "Shreya Srivastava", "link": "https://stackoverflow.com/users/4531702/shreya-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3402, "favorite_count": 0, "accepted_answer_id": 40808171, "answer_count": 1, "score": 2, "last_activity_date": 1531935754, "creation_date": 1480072253, "last_edit_date": 1531935754, "question_id": 40803659, "link": "https://stackoverflow.com/questions/40803659/how-to-setup-go-in-goclipse", "title": "How to setup Go in GoClipse", "body": "<p>I installed goclipse in my eclipse, and setup the preferences as follows : </p>\n\n<p><a href=\"https://i.stack.imgur.com/XhvdF.jpg\" rel=\"nofollow noreferrer\">Preferences->Go->Tools</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BbPiV.jpg\" rel=\"nofollow noreferrer\">ProjectExplorer</a></p>\n\n<p>Now when I create a new GoFile (HelloWorld.src), the file is saved in D:/GO/TestProject/src. But when I build the same file, the bin and pkg folders are empty and hence when I run the file the following error comes : </p>\n\n<p><strong>resource does not have a corresponding go package</strong></p>\n\n<p>Unable to run the code because of this error. </p>\n"}, {"tags": ["pointers", "go", "methods", "types"], "comments": [{"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "edited": false, "score": 0, "creation_date": 1480072821, "post_id": 40803654, "comment_id": 68828456, "body": "I know that the documentation explains it. But please do not downvote. If I ask, it is mean that I tried to understand, and did not success.  I know 2 things: <i>1.</i> People here like to downvote <code>golang</code> questions. <i>2.</i> People here have stronger ability to explain complicated things in Markdown language."}], "answers": [{"comments": [{"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "edited": false, "score": 0, "creation_date": 1480075154, "post_id": 40804236, "comment_id": 68829831, "body": "Thanks. Really helpful"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1495526114, "last_edit_date": 1495526114, "creation_date": 1480074122, "answer_id": 40804236, "question_id": 40803654, "link": "https://stackoverflow.com/questions/40803654/golang-why-selector-to-pointers-is-illegal-after-comparison/40804236#40804236", "title": "Golang: Why selector to pointers is illegal after comparison?", "body": "<blockquote>\n  <p>Why <code>q.M0()</code> is invalid. While <code>p.M0()</code> is valid and <code>q=p</code>. Very strange for me.</p>\n</blockquote>\n\n<p><code>q</code> is initialized like <code>var q Q = p</code>, but it does not mean they are equal. The <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">assignment</a> is valid because it does not violate the <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability</a> rules, but type of <code>q</code> is different than type of <code>p</code>.</p>\n\n<p>Type of <code>q</code> is <code>Q</code> (where <code>type Q *T2</code>), and type of <code>p</code> is <code>*T2</code>.</p>\n\n<p>In Go, methods belong to a specific type. When you do this:</p>\n\n<pre><code>type Q *T2\n</code></pre>\n\n<p>It creates a new type named <code>Q</code> (<code>*T2</code> being its underlying type). The new type will have 0 methods, it does not \"inherit\" any methods from <code>*T2</code>, hence <code>q.M0()</code> will be a compile-time error:</p>\n\n<blockquote>\n  <p>q.M0 undefined (type Q has no field or method M0)</p>\n</blockquote>\n\n<p><strong>Note:</strong></p>\n\n<p>You may still think it's strange because <code>M0()</code> is declared like this:</p>\n\n<pre><code>func (*T0) M0()\n</code></pre>\n\n<p>It has <code>*T0</code> receiver so it belongs to the type <code>*T0</code>, yet type of <code>p</code> is <code>*T2</code>, so <code>*T2</code> should not have this <code>M0()</code> method and therefore <code>p.M0()</code> should also be invalid. But <code>T2</code> is a struct which <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">embeds</a> <code>*T0</code>, and so methods of <code>*T0</code> are <em>promoted</em>, and they will be in the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> of <code>T2</code>.</p>\n\n<p>Also see this related question: <a href=\"https://stackoverflow.com/questions/40803654/golang-why-selector-to-pointers-is-illegal-after-comparison/40804236#40804236\">Golang: Why selector to pointers is illegal after comparison?</a></p>\n"}], "owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 40804236, "answer_count": 1, "score": 7, "last_activity_date": 1495526114, "creation_date": 1480072237, "last_edit_date": 1480075181, "question_id": 40803654, "link": "https://stackoverflow.com/questions/40803654/golang-why-selector-to-pointers-is-illegal-after-comparison", "title": "Golang: Why selector to pointers is illegal after comparison?", "body": "<p>I'm reading the spec about selectors: <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"noreferrer\">https://golang.org/ref/spec#Selectors</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/37hgD.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/37hgD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why <code>q.M0()</code> is invalid. While <code>p.M0()</code> is valid and <code>q=p</code>. Very strange for me.</p>\n\n<p>The relevant source code:</p>\n\n<pre><code>type T0 struct {\n    x int\n}\n\nfunc (*T0) M0()\n\ntype T1 struct {\n    y int\n}\n\nfunc (T1) M1()\n\ntype T2 struct {\n    z int\n    T1\n    *T0\n}\n\nfunc (*T2) M2()\n\ntype Q *T2\n\nvar t T2     // with t.T0 != nil\nvar p *T2    // with p != nil and (*p).T0 != nil\nvar q Q = p\n\np.M0()       // ((*p).T0).M0()      M0 expects *T0 receiver\nq.M0()       // (*q).M0 is valid but not a field selector\n</code></pre>\n"}, {"tags": ["c++", "c", "go", "dynamic", "libc"], "comments": [{"owner": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "edited": false, "score": 0, "creation_date": 1480064821, "post_id": 40801097, "comment_id": 68823593, "body": "I just want to link the static libc etc"}, {"owner": {"reputation": 452, "user_id": 5898372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s33No.gif?s=128&g=1", "display_name": "John Forkosh", "link": "https://stackoverflow.com/users/5898372/john-forkosh"}, "edited": false, "score": 1, "creation_date": 1480066155, "post_id": 40801097, "comment_id": 68824295, "body": "cc -static etc usually works for me. man cc for more details about the -static switch."}, {"owner": {"reputation": 437, "user_id": 7018835, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2309ee7ad6ccc069ed9145bb33078b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Anjaneyulu", "link": "https://stackoverflow.com/users/7018835/anjaneyulu"}, "edited": false, "score": 1, "creation_date": 1480066681, "post_id": 40801097, "comment_id": 68824589, "body": "You can&#39;t do that since different platforms have different architectures and also remember C is only source portable and not platform independent like java"}], "answers": [{"tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 2, "last_activity_date": 1480077592, "creation_date": 1480077592, "answer_id": 40805308, "question_id": 40801097, "link": "https://stackoverflow.com/questions/40801097/can-c-c-build-all-dynamic-libraries-into-one-bin-file/40805308#40805308", "title": "Can C/C++ build all dynamic libraries into one bin file?", "body": "<p>If you want to run on multiple Linux systems, all you really need is to build using the oldest glibc from any of them.  The easiest way is to simply download a virtual machine image from an old system like CentOS 5 and build there.  You don't need to worry about static linking, just building against an old version will mean you are mostly compatible with newer versions.</p>\n"}], "owner": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 40805308, "answer_count": 1, "score": 1, "last_activity_date": 1480077592, "creation_date": 1480064516, "last_edit_date": 1480070219, "question_id": 40801097, "link": "https://stackoverflow.com/questions/40801097/can-c-c-build-all-dynamic-libraries-into-one-bin-file", "title": "Can C/C++ build all dynamic libraries into one bin file?", "body": "<p>When I develop across different OS's I find that a program built on one Linux system can not be run on another system, due to the different libc version.</p>\n\n<p>How can I build in all the shared libraries just like golang did in c/c++?</p>\n\n<p>Including libc and libcxx</p>\n"}, {"tags": ["node.js", "go", "multiprocessing", "file-descriptor"], "answers": [{"comments": [{"owner": {"reputation": 11272, "user_id": 4954970, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cd55f03cb2048a05411472dd6ac1eab8?s=128&d=identicon&r=PG&f=1", "display_name": "kpimov", "link": "https://stackoverflow.com/users/4954970/kpimov"}, "edited": false, "score": 0, "creation_date": 1480084668, "post_id": 40802483, "comment_id": 68835366, "body": "Are there any specific directories it should be placed in or are commonly used?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 11272, "user_id": 4954970, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cd55f03cb2048a05411472dd6ac1eab8?s=128&d=identicon&r=PG&f=1", "display_name": "kpimov", "link": "https://stackoverflow.com/users/4954970/kpimov"}, "edited": false, "score": 0, "creation_date": 1480085020, "post_id": 40802483, "comment_id": 68835554, "body": "Are you asking about the name? I don&#39;t really know if name means anything. Try leaving it empty and see what happens."}, {"owner": {"reputation": 2382, "user_id": 6272277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/522db908ba9addc9a647f5c8a8f8421a?s=128&d=identicon&r=PG&f=1", "display_name": "Lassi", "link": "https://stackoverflow.com/users/6272277/lassi"}, "edited": false, "score": 0, "creation_date": 1540110334, "post_id": 40802483, "comment_id": 92737017, "body": "I believe the name is just displayed for debugging purposes for things that don&#39;t actually have a pathname in the filesystem (pipes, sockets, etc.). Hence <code>f</code> is not actually placed in the file system and it ought not to matter what name you use. Demonstration: <a href=\"https://play.golang.org/p/Oiq26HSV6kD\" rel=\"nofollow noreferrer\">play.golang.org/p/Oiq26HSV6kD</a>"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1480068897, "creation_date": 1480068897, "answer_id": 40802483, "question_id": 40800343, "link": "https://stackoverflow.com/questions/40800343/how-do-i-use-file-descriptor-4-or-its-equivalent-on-windows/40802483#40802483", "title": "How do I use file descriptor 4 (or its equivalent) on Windows?", "body": "<p>You can try <a href=\"https://golang.org/pkg/os/#NewFile\" rel=\"nofollow noreferrer\"><code>os.NewFile</code></a>:</p>\n\n<pre><code>f := os.NewFile(4, \"my_fd_4\")\n</code></pre>\n"}], "owner": {"reputation": 11272, "user_id": 4954970, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cd55f03cb2048a05411472dd6ac1eab8?s=128&d=identicon&r=PG&f=1", "display_name": "kpimov", "link": "https://stackoverflow.com/users/4954970/kpimov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480068897, "creation_date": 1480061427, "question_id": 40800343, "link": "https://stackoverflow.com/questions/40800343/how-do-i-use-file-descriptor-4-or-its-equivalent-on-windows", "title": "How do I use file descriptor 4 (or its equivalent) on Windows?", "body": "<p>I've been writing a Go server that acts as the child process of a chunk of Node.js.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\n// IPC delimiter\nconst EOT byte = 3\n\nfunc main() {\n    // Listen on stdin for messages sent from the parent process.\n    reader := bufio.NewReader(os.Stdin)\n    for {\n        input, err := reader.ReadString(EOT)\n        if err != nil {\n            fmt.Printf(\"sockets: failed to read from stdin: %v\", err)\n            if err == io.EOF {\n                return\n            }\n\n            continue\n        }\n\n        // Strip EOT bye\n        input = input[:len(input) - 1]\n\n        var payload Payload\n        if err := json.Unmarshal([]byte(input), &amp;payload); err != nil {\n            fmt.Printf(\"sockets: failed to read from stdin: %v\", err)\n            continue\n        }\n    }\n}\n</code></pre>\n\n<p>However, using stdin/stdout like this prevents this piece of the code from being able to log to console, as the parent process is using stdouts handle. Ideally I'd use file descriptor 4 for this to take advantage of how Node uses it, Only problem with this is I'm clueless with the nitty gritty details of Windows. How might I be able to use the equivalent (if any) of /dev/fd/4 for IPC on Windows?</p>\n\n<p>PS: if there's a better way to handle reading from stdin, that would also help me a lot.</p>\n"}, {"tags": ["xml", "parsing", "go", "struct"], "comments": [{"owner": {"reputation": 4122, "user_id": 3951525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/hix21.jpg?s=128&g=1", "display_name": "Starl1ght", "link": "https://stackoverflow.com/users/3951525/starl1ght"}, "edited": false, "score": 0, "creation_date": 1480059017, "post_id": 40799391, "comment_id": 68820867, "body": "There is a lot of non-necessary code pasted. I&#39;d recommend to edit it to include only &quot;problem&quot; parts"}], "answers": [{"tags": [], "owner": {"reputation": 3383, "user_id": 6808474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ETqWd.jpg?s=128&g=1", "display_name": "Prajwal", "link": "https://stackoverflow.com/users/6808474/prajwal"}, "is_accepted": false, "score": 1, "last_activity_date": 1480057787, "creation_date": 1480057787, "answer_id": 40799487, "question_id": 40799391, "link": "https://stackoverflow.com/questions/40799391/golang-undefined-field-in-struct-error/40799487#40799487", "title": "Golang: Undefined field in struct error", "body": "<pre><code>type AggInfoXml struct {\n    Percent     IntPercent  `xml:\"taskprogress,omitempty\"`\n    IpAddr      []Addr      `xml:\"host&gt;address,omitempty\"`\n}\n\n\n\n\ntype Addr struct {\n    Ip      string   `xml:\"addr,attr\"`\n    Hports  []Ports  `xml:\"host&gt;ports&gt;port,omitempty\"` //failing to be recognized\n}\n</code></pre>\n\n<p>IpAddr is an Array. It has no attribute called <code>Hports</code>. You will have to refer one of the elements of that array like this.</p>\n\n<pre><code>aggInfoXml.IpAddr[0].Hports \n</code></pre>\n\n<p>but if you want to access port of Hports, then you will have to do this.</p>\n\n<pre><code>aggInfoXml.IpAddr[0].Hports[0] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 310, "user_id": 2178075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QBKQ.jpg?s=128&g=1", "display_name": "peiiion", "link": "https://stackoverflow.com/users/2178075/peiiion"}, "is_accepted": false, "score": 0, "last_activity_date": 1480088021, "creation_date": 1480088021, "answer_id": 40808298, "question_id": 40799391, "link": "https://stackoverflow.com/questions/40799391/golang-undefined-field-in-struct-error/40808298#40808298", "title": "Golang: Undefined field in struct error", "body": "<p>I have upvoted the answer from Prajwal as it points to the problem, but actually, in your code it seems you should be replacing your <code>for</code> loops with something like this: </p>\n\n<pre><code>for _, ip := range aggInfoXml.IpAddr {\n    fmt.Printf(\"IpAdd: %s\\n\", ip.ipaddr())\n\n    for _, port := range ip.Hports {\n        fmt.Printf(\"Port: %s\\n\", port.ports())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7197274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d43d0a387994d31c6209dd463e261e7?s=128&d=identicon&r=PG&f=1", "display_name": "acer89", "link": "https://stackoverflow.com/users/7197274/acer89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1480088021, "creation_date": 1480057344, "last_edit_date": 1480057725, "question_id": 40799391, "link": "https://stackoverflow.com/questions/40799391/golang-undefined-field-in-struct-error", "title": "Golang: Undefined field in struct error", "body": "<p>I am trying to parse an xml file using golang. I have created my structs needed but when I try to compile the go file, I get an error saying the following:</p>\n\n<p><strong>./main_v4.go:146: aggInfoXml.IpAddr.Hports undefined (type []Addr has no field or method Hports)</strong></p>\n\n<p>I am stumped on this problem. Here is my code:</p>\n\n<pre><code>package main\n\nimport(\n    \"net/http\"\n    \"html/template\"\n    \"os/exec\"\n    \"io/ioutil\"\n    \"os\"\n    \"encoding/xml\"\n    \"encoding/json\"\n    \"fmt\"\n    \"bufio\"\n    \"github.com/gorilla/websocket\"\n    \"time\"\n    \"log\"\n\n)\n\ntype PercentInfo struct {\n    Percent IntPercent `xml:\"taskprogress,omitempty\"`\n} \n\ntype AggInfoXml struct {\n    Percent     IntPercent  `xml:\"taskprogress,omitempty\"`\n    IpAddr      []Addr      `xml:\"host&gt;address,omitempty\"`\n}\n\ntype IntPercent struct {\n    Value float64 `xml:\"percent,attr,omitempty\"` // works\n}\n\n\ntype Addr struct {\n    Ip      string   `xml:\"addr,attr\"`\n    Hports  []Ports  `xml:\"host&gt;ports&gt;port,omitempty\"` //failing to be recognized\n}\n\ntype Ports struct {\n    Port string `xml:\"portid,attr\"`\n}\n\nfunc (p *Addr) ipaddr() string {\n     return p.Ip\n}\n\nfunc (p *Ports) ports() string {\n     return p.Port\n}\n\nfunc (p *IntPercent) percent() float64 {\n    return p.Value\n}\n\nfunc (f *Test) Name() string {\n    return f.Value\n\n}\n\nvar upgrader = websocket.Upgrader{\n    ReadBufferSize: 1024,\n    WriteBufferSize: 1024,\n}\n\ntype Test struct {\n    Value string    \n}\n\n\nfunc wsHandler(w http.ResponseWriter, r *http.Request) {\n\n    conn, err := upgrader.Upgrade(w, r, nil)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    cmd := exec.Command(\"nmap\", \"-F\", \"-sS\", \"172.16.2.0/24\", \"-oX\", \"output.xml\", \"--stats-every\", \"1s\")\n\n    if err := cmd.Start(); err != nil {\n        log.Fatal(err)\n    }\n\n    time.Sleep( 1000 * time.Millisecond) \n\n    fp, err := os.Open(\"output.xml\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n\n    // create scanner on the output.xml file\n    in := bufio.NewScanner(fp)\n\n    // change this loop to buffer read the xml file...\n    aggInfoXml  := AggInfoXml{}\n\n    fmt.Printf(\"hello\")\n\n    for in.Scan() {\n\n        err = xml.Unmarshal([]byte(in.Text()), &amp;aggInfoXml.Percent) \n        if err != nil {\n            fmt.Printf(\"Could not unmarshal the line &lt;%v&gt;\", in.Text())\n        } else {\n            fmt.Printf(\"%+v\\n\", aggInfoXml.Percent.Value)\n        }\n\n        // bail out of slow loop if 100% reached\n        if aggInfoXml.Percent.Value == 100 {\n            break\n        }\n\n        time.Sleep(1000*time.Millisecond)\n\n        bytesArray, err := json.Marshal(aggInfoXml.Percent)\n\n        err = conn.WriteMessage(websocket.TextMessage, bytesArray)  // send JSON over\n        if err != nil {\n            panic(err)\n        }\n\n    }//this is the end of the in.Scan loop now\n\n    fmt.Println(\"After loop\")\n\n    if err := cmd.Wait(); err != nil {  \n        log.Fatal(err)\n    }\n\n    data, err := ioutil.ReadFile(\"output.xml\")\n\n    if err != nil {\n        panic(err)\n    }\n\n    err = xml.Unmarshal(data, &amp;aggInfoXml.IpAddr)\n    if err != nil {\n        log.Fatal(\"Could not unmarshal host\")\n    }\n\n    for _, port := range aggInfoXml.IpAddr.Hports {\n        fmt.Printf(\"Port: %s\\n\", port.ports())\n    }\n\n    for _, ip := range aggInfoXml.IpAddr {\n        fmt.Printf(\"IpAdd: %s\\n\", ip.ipaddr())\n    }\n\n    conn.Close()\n    fp.Close()\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n\n    t, _ := template.ParseFiles(\"index.html\")\n    t.Execute(w,nil)\n}\n\nfunc main() {\n\n    http.HandleFunc(\"/\", handler)\n    http.Handle(\"/layout/\", http.StripPrefix(\"/layout/\", http.FileServer(http.Dir(\"layout\"))))\n    http.HandleFunc(\"/websocket\", wsHandler)\n    http.ListenAndServe(\":8080\", nil) \n}\n</code></pre>\n\n<p>Any suggestions would be helpful.</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "edited": false, "score": 1, "creation_date": 1535985216, "post_id": 40798957, "comment_id": 91253809, "body": "Why is this question being downvoted?"}], "answers": [{"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1480056225, "post_id": 40799112, "comment_id": 68819795, "body": "Yep, that solved the problem. Though I wished there was a less verbose way to do so..."}], "tags": [], "owner": {"reputation": 460, "user_id": 2239170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dedf3480959680493d72414dcdeae4c9?s=128&d=identicon&r=PG", "display_name": "Alex P", "link": "https://stackoverflow.com/users/2239170/alex-p"}, "is_accepted": true, "score": 5, "last_activity_date": 1480056092, "creation_date": 1480056092, "answer_id": 40799112, "question_id": 40798957, "link": "https://stackoverflow.com/questions/40798957/how-to-get-a-field-by-index-in-template/40799112#40799112", "title": "How to get a field by index in template?", "body": "<p>The index function access the nth element of the specified array, so writing </p>\n\n<p><code>{{ index .articles.Content 0 }}</code> </p>\n\n<p>is essentially trying to write <code>articles.Content[0]</code></p>\n\n<p>You would want something akin to</p>\n\n<p><code>{{ with $n := index .articles 0 }}{{ $n.Content }}{{ end }}</code></p>\n"}, {"comments": [{"owner": {"reputation": 532, "user_id": 2428622, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e29412c1e1b191b964dd804d7d08793d?s=128&d=identicon&r=PG", "display_name": "pdbrito", "link": "https://stackoverflow.com/users/2428622/pdbrito"}, "edited": false, "score": 1, "creation_date": 1591391092, "post_id": 54470673, "comment_id": 110049157, "body": "I believe this can be shortened to {{(index .articles 0).Content }}!"}], "tags": [], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "is_accepted": false, "score": 2, "last_activity_date": 1548976710, "last_edit_date": 1548976710, "creation_date": 1548976597, "answer_id": 54470673, "question_id": 40798957, "link": "https://stackoverflow.com/questions/40798957/how-to-get-a-field-by-index-in-template/54470673#54470673", "title": "How to get a field by index in template?", "body": "<p>A more concise way is: </p>\n\n<pre><code>{{(index .articles.Content 0).Content }}\n</code></pre>\n\n<p>Which would be the equivalent of <code>articles[0].Content</code>.</p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1788, "favorite_count": 0, "accepted_answer_id": 40799112, "answer_count": 2, "score": 1, "last_activity_date": 1548976710, "creation_date": 1480055327, "last_edit_date": 1480055897, "question_id": 40798957, "link": "https://stackoverflow.com/questions/40798957/how-to-get-a-field-by-index-in-template", "title": "How to get a field by index in template?", "body": "<p>I send a slice of <code>articles</code> into template. Each <code>article</code>struct is like:</p>\n\n<pre><code>type Article struct {\n    ID        uint32        `db:\"id\" bson:\"id,omitempty\"` \n    Content   string        `db:\"content\" bson:\"content\"`\n    Author    string        `db:\"author\" bson:\"author\"`\n    ... \n}\n</code></pre>\n\n<p>I can loop over <code>articles</code> slice in a <code>{{range $n := articles}}</code> and get each <code>{{$n.Content}}</code> but what I want is to have only the first one (outside the range loop) to use in headline. \nWhat I tried is:</p>\n\n<pre><code>{{index .articles.Content 0}}\n</code></pre>\n\n<p>But  I get:</p>\n\n<blockquote>\n  <p>Template File Error: template: articles_list.tmpl:14:33: executing\n  \"content\" at &lt;.articles.Content>: can't evaluate field Content in type\n  interface {}</p>\n</blockquote>\n\n<p>If I just invoke </p>\n\n<pre><code>{{index .articles 0}}\n</code></pre>\n\n<p>It shows the whole article[0] object.</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["mongodb", "go", "pagination", "mgo"], "comments": [{"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1480043991, "post_id": 40796666, "comment_id": 68816258, "body": "Did the actual JSON you posted is your input data ?"}, {"owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "reply_to_user": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1480047076, "post_id": 40796666, "comment_id": 68817002, "body": "The json which i posted is what i get from my database to return the leave details when the front calls it to show the list of leave.When i add,first i add the employee details then when someone is applying for leave then  i push it inside the respective leave array.I will post how my structure look like in the database.Appreciate any help..."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 6, "last_activity_date": 1480098532, "last_edit_date": 1495535415, "creation_date": 1480061602, "answer_id": 40800384, "question_id": 40796666, "link": "https://stackoverflow.com/questions/40796666/need-to-use-pagination-in-mgo/40800384#40800384", "title": "Need to use pagination in mgo", "body": "<p>Being as it is, you can't really achieve a much more efficient pagination, since all the documents you want to list and paginate are in a single document, separated into multiple slices/arrays.</p>\n\n<p>To achieve efficient and simple pagination, I would refactor your model. First I would store all kinds of <code>XXLeave</code> documents as the same type, <code>Leave</code>, and add a property to it which tells you what kind of leave it is (e.g. <code>Annual</code>, <code>Medical</code> etc.). Next, I would not store this list in the <code>Employee</code> itself, but rather in a separate MongoDB collection, and it could have an <code>EmployeeID</code> field, telling to which employee a <code>Leave</code> document belongs to (owner).</p>\n\n<p>Having this model, you can easily list a specific type of <code>Leave</code> documents of an employee with a query like:</p>\n\n<pre><code>c := session.DB(\"\").C(\"leaves\")\nerr := c.Find(bson.M{\"empid\": eid, \"type\": LeaveAnnual}).All(&amp;result)\n</code></pre>\n\n<p>To list all <code>Leave</code> documents of an employee, simply don't use the <code>\"type\"</code> filter:</p>\n\n<pre><code>err := c.Find(bson.M{\"empid\": eid}).All(&amp;result)\n</code></pre>\n\n<p>Now on to pagination. If you have this model, pagination becomes a piece of cake:</p>\n\n<pre><code>q = c.Find(bson.M{\"empid\": eid}).Sort(\"applieddate\", \"status\")\n// Use Skip() and Limit() to denote the page you want to send, e.g.\nq = Skip((page-1) * 20).Limit(20)\nerr := q.All(&amp;result)\n</code></pre>\n\n<p>If you want to send and paginate over all <code>Leave</code> documents regardless of the <code>Employee</code> (the author), then also leave out the <code>EmpId</code> filter:</p>\n\n<pre><code>err := c.Find(nil).Sort(\"applieddate\", \"status\").\n    Skip((page-1) * 20).Limit(20).All(&amp;result)\n</code></pre>\n\n<p>Note that using <code>Skip()</code> and <code>Limit()</code> works great for \"small\" number of documents. But for large number of documents you should use pagination based on specifying starting index entry. See this question for more details and a ready-to-use library for it:</p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/40634865/efficient-paging-in-mongodb-using-mgo\">Efficient paging in MongoDB using mgo</a></strong></p>\n"}], "owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480098532, "creation_date": 1480039010, "last_edit_date": 1480098397, "question_id": 40796666, "link": "https://stackoverflow.com/questions/40796666/need-to-use-pagination-in-mgo", "title": "Need to use pagination in mgo", "body": "<p>I am using Go as the back end and MongoDB as the database and use beego framework to develop this application. I would like to do some pagination in my front end.</p>\n\n<p>My struct looks like this:</p>\n\n<pre><code>type Employee struct {\n        Name               string\n        EmpId              string\n        Password           string\n        PhoneNumber        int32\n        EmailAddress       string\n        Position           string\n        AccessLevel        string\n        Gender             string\n        MaritalStatus      string\n        Nationality        string\n        Department         string\n        ICNumber           string\n        JoinDate           time.Time\n        ConfirmationDate   time.Time\n        EndDate            time.Time\n        AnnualLeave        []*AnnualLeaveInfo\n        MedicalLeave       []*MedicalLeaveInfo\n        NopayLeave         []*NopayLeaveInfo\n        ChildcareLeave     []*ChildcareLeaveInfo\n    }\n\ntype AnnualLeaveInfo struct {\n        Id           int\n        Days         float64\n        Type         string\n        From         time.Time\n        To           time.Time\n        AppliedDate  time.Time\n        Status       string\n        Certificate  []*CertificateInfo\n    }\n</code></pre>\n\n<p>The other leave info as same as the annual leave info. I would like to show all the leaves of all the employee documents sorted by applied date and status. Right now I'm retrieving all the leave details and then appending in array and then I am using the cursor value (last retrieved index value of the array which I pass to the front end in the previous response) and finding the values from the array. I know that this is not a good function because for every request it needs to retrieve all the leave details for retrieving only 20 leave details which is requested by the front end.</p>\n\n<p>My Results after appending in the array is like this</p>\n\n<pre><code>  \"0\": {\n    \"LeaveEmpId\": \"rajeshk\",\n    \"Name\": \"rahul\",\n    \"LeaveId\": 8,\n    \"LeaveType\": \"annualleave\",\n    \"LeaveTotal\": 2,\n    \"LeaveDays\": 1,\n    \"LeaveFrom\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveTo\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveAppliedDate\": \"2016-11-21T10:29:33.713+08:00\",\n    \"LeaveStatus\": \"Processing\",\n    \"CertificateName\": [\n      \"1.pdf\",\n      \"2.pdf\"\n    ]\n  },\n  \"1\": {\n    \"LeaveEmpId\": \"rajeshk\",\n    \"LeaveName\": \"Rajesh\",\n    \"LeaveId\": 7,\n    \"LeaveType\": \"medicalleave\",\n    \"LeaveTotal\": 3,\n    \"LeaveDays\": 1,\n    \"LeaveFrom\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveTo\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveAppliedDate\": \"2016-11-21T10:27:06.12+08:00\",\n    \"LeaveStatus\": \"Processing\",\n    \"CertificateName\": [\n      \"1.pdf\",\n      \"2.pdf\"\n    ]\n  },\n  \"2\": {\n    \"LeaveEmpId\": \"kumar\",\n    \"LeaveName\": \"madia\",\n    \"LeaveId\": 6,\n    \"LeaveType\": \"nopayleave\",\n    \"LeaveTotal\": 4,\n    \"LeaveDays\": 1,\n    \"LeaveFrom\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveTo\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveAppliedDate\": \"2016-11-21T10:11:58.283+08:00\",\n    \"LeaveStatus\": \"Processing\",\n    \"CertificateName\": [\n      \"1.pdf\",\n      \"2.pdf\"\n    ]\n  },\n  \"3\": {\n    \"LeaveEmpId\": \"master\",\n    \"LeaveName\": \"kumar\",\n    \"LeaveId\": 5,\n    \"LeaveType\": \"nopayleave\",\n    \"LeaveTotal\": 5,\n    \"LeaveDays\": 1,\n    \"LeaveFrom\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveTo\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveAppliedDate\": \"2016-11-21T10:02:17.565+08:00\",\n    \"LeaveStatus\": \"Processing\",\n    \"CertificateName\": [\n      \"1.pdf\",\n      \"2.pdf\"\n    ]\n  },\n  \"4\": {\n    \"LeaveEmpId\": \"rajeshk\",\n    \"LeaveName\": \"Rajesh\",\n    \"LeaveId\": 4,\n    \"LeaveType\": \"medicalleave\",\n    \"LeaveTotal\": 6,\n    \"LeaveDays\": 1,\n    \"LeaveFrom\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveTo\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveAppliedDate\": \"2016-11-21T09:52:20.185+08:00\",\n    \"LeaveStatus\": \"Processing\",\n    \"CertificateName\": [\n      \"1.pdf\",\n      \"2.pdf\"\n    ]\n  },\n  \"5\": {\n    \"LeaveEmpId\": \"rajeshk\",\n    \"LeaveName\": \"Rajesh\",\n    \"LeaveId\": 3,\n    \"LeaveType\": \"annualleave\",\n    \"LeaveTotal\": 7,\n    \"LeaveDays\": 1,\n    \"LeaveFrom\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveTo\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveAppliedDate\": \"2016-11-21T09:49:18.702+08:00\",\n    \"LeaveStatus\": \"Processing\",\n    \"CertificateName\": [\n      \"1.pdf\",\n      \"2.pdf\"\n    ]\n  },\n  \"6\": {\n    \"LeaveEmpId\": \"india\",\n    \"LeaveName\": \"rahul\",\n    \"LeaveId\": 2,\n    \"LeaveType\": \"nopayleave\",\n    \"LeaveTotal\": 8,\n    \"LeaveDays\": 1,\n    \"LeaveFrom\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveTo\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveAppliedDate\": \"2016-11-21T09:30:14.99+08:00\",\n    \"LeaveStatus\": \"Processing\",\n    \"CertificateName\": [\n      \"1.pdf\",\n      \"2.pdf\"\n    ]\n  },\n  \"7\": {\n    \"LeaveEmpId\": \"rajeshk\",\n    \"LeaveName\": \"Rajesh\",\n    \"LeaveId\": 1,\n    \"LeaveType\": \"medicalleave\",\n    \"LeaveTotal\": 9,\n    \"LeaveDays\": 1,\n    \"LeaveFrom\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveTo\": \"2016-12-12T08:00:00+08:00\",\n    \"LeaveAppliedDate\": \"2016-11-21T09:28:02.785+08:00\",\n    \"LeaveStatus\": \"Processing\",\n    \"CertificateName\": [\n      \"1.pdf\",\n      \"2.pdf\"\n    ]\n }\n</code></pre>\n\n<p>In the database my empid is only index I use which is unique other values are not unique. Leave id is unique only with in the leave array. Can someone help  me how to do this efficiently. Appreciate any help. Thanks.</p>\n\n<p><strong>Added Info:</strong></p>\n\n<p>My Database Structure looks like this ...This is just the info of one employee. Like this I have lots of employee documents. What I need is to get the total leave details of all these employee documents with the limit of 20 for pagination sorted by applieddate and status. Thanks</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"58320cec720fed31a3243683\"),\n    \"name\" : \"Rajesh\",\n    \"empid\" : \"rajeshk\",\n    \"password\" : \"c1e1a43a3d65ff4d669f2831b9908acb9e2f755c48280e99f0d7a3e92592fa29\",\n    \"phonenumber\" : 0,\n    \"emailaddress\" : \"example@example.com.sg\",\n    \"position\" : \"string\",\n    \"accesslevel\" : \"string\",\n    \"gender\" : \"string\",\n    \"maritalstatus\" : \"string\",\n    \"nationality\" : \"india\",\n    \"department\" : \"it\",\n    \"icnumber\" : \"string\",\n    \"childcitizenship\" : \"string\",\n    \"joindate\" : ISODate(\"2015-11-21T00:00:00.000Z\"),\n    \"confirmationdate\" : Date(-62135596800000),\n    \"enddate\" : Date(-62135596800000),\n    \"totalchild\" : 0,\n    \"annualleave\" : [ \n        {\n\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"type\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificate\" : []\n        }\n    ],\n    \"medicalleave\" : [ \n        {\n\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"type\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificate\" : []\n        }\n    ],\n    \"nopayleave\" : [ \n        {\n            \"total\" : 10.0,\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"type\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificate\" : []\n        }, \n        {\n            \"total\" : 9.0,\n            \"id\" : 1,\n            \"days\" : 1.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"nopayleave\",\n            \"daytype\" : \"FullDay\",\n            \"from\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"to\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"applieddate\" : ISODate(\"2016-11-21T01:28:02.785Z\"),\n            \"status\" : \"Processing\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"\",\n            \"certificate\" : [ \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }, \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }\n            ]\n        }, \n        {\n            \"total\" : 8.0,\n            \"id\" : 2,\n            \"days\" : 1.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"nopayleave\",\n            \"daytype\" : \"FullDay\",\n            \"from\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"to\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"applieddate\" : ISODate(\"2016-11-21T01:30:14.990Z\"),\n            \"status\" : \"Processing\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"\",\n            \"certificate\" : [ \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }, \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }\n            ]\n        }, \n        {\n            \"total\" : 7.0,\n            \"id\" : 3,\n            \"days\" : 1.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"nopayleave\",\n            \"daytype\" : \"FullDay\",\n            \"from\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"to\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"applieddate\" : ISODate(\"2016-11-21T01:49:18.702Z\"),\n            \"status\" : \"Processing\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"\",\n            \"certificate\" : [ \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }, \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }\n            ]\n        }, \n        {\n            \"total\" : 6.0,\n            \"id\" : 4,\n            \"days\" : 1.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"nopayleave\",\n            \"daytype\" : \"FullDay\",\n            \"from\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"to\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"applieddate\" : ISODate(\"2016-11-21T01:52:20.185Z\"),\n            \"status\" : \"Processing\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"\",\n            \"certificate\" : [ \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }, \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }\n            ]\n        }, \n        {\n            \"total\" : 5.0,\n            \"id\" : 5,\n            \"days\" : 1.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"nopayleave\",\n            \"daytype\" : \"FullDay\",\n            \"from\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"to\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"applieddate\" : ISODate(\"2016-11-21T02:02:17.565Z\"),\n            \"status\" : \"Processing\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"\",\n            \"certificate\" : [ \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }, \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }\n            ]\n        }, \n        {\n            \"total\" : 4.0,\n            \"id\" : 6,\n            \"days\" : 1.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"nopayleave\",\n            \"daytype\" : \"FullDay\",\n            \"from\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"to\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"applieddate\" : ISODate(\"2016-11-21T02:11:58.283Z\"),\n            \"status\" : \"Processing\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"\",\n            \"certificate\" : [ \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }, \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }\n            ]\n        }, \n        {\n            \"total\" : 3.0,\n            \"id\" : 7,\n            \"days\" : 1.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"nopayleave\",\n            \"daytype\" : \"FullDay\",\n            \"from\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"to\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"applieddate\" : ISODate(\"2016-11-21T02:27:06.120Z\"),\n            \"status\" : \"Processing\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"\",\n            \"certificate\" : [ \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }, \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }\n            ]\n        }, \n        {\n            \"total\" : 2.0,\n            \"id\" : 8,\n            \"days\" : 1.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"nopayleave\",\n            \"daytype\" : \"FullDay\",\n            \"from\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"to\" : ISODate(\"2016-12-12T00:00:00.000Z\"),\n            \"applieddate\" : ISODate(\"2016-11-21T02:29:33.713Z\"),\n            \"status\" : \"Processing\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"\",\n            \"certificate\" : [ \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }, \n                {\n                    \"filename\" : \"Rajesh\",\n                    \"filetype\" : \".zip\",\n                    \"filesize\" : 1234\n                }\n            ]\n        }\n    ],\n    \"childcareleave\" : [ \n        {\n            \"total\" : 10.0,\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"type\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificate\" : []\n        }\n    ],\n    \"hospitalleave\" : [ \n        {\n            \"total\" : 10.0,\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"\",\n            \"daytype\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificatename\" : \"string\",\n            \"certificate\" : []\n        }\n    ],\n    \"maternityleave\" : [ \n        {\n            \"total\" : 10.0,\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"\",\n            \"daytype\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificate\" : []\n        }\n    ],\n    \"paternityleave\" : [ \n        {\n            \"total\" : 0.0,\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"mdays\" : 0.0,\n            \"type\" : \"\",\n            \"daytype\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificate\" : []\n        }\n    ],\n    \"compassionateleave\" : [ \n        {\n            \"total\" : 0.0,\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"type\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificate\" : []\n        }\n    ],\n    \"marriageleave\" : [ \n        {\n            \"total\" : 0.0,\n            \"id\" : 0,\n            \"days\" : 0.0,\n            \"type\" : \"\",\n            \"from\" : Date(-62135596800000),\n            \"to\" : Date(-62135596800000),\n            \"applieddate\" : Date(-62135596800000),\n            \"status\" : \"\",\n            \"approveddate\" : Date(-62135596800000),\n            \"certificate\" : []\n        }\n    ],\n    \"otherleave\" : []\n}\n</code></pre>\n"}, {"tags": ["go", "filesystems", "sparse-file"], "answers": [{"comments": [{"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1480107744, "post_id": 40808012, "comment_id": 68844689, "body": "Indeed it does. Thanks."}, {"owner": {"reputation": 195, "user_id": 4783551, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d255732d9e9fe0bfa7076fd7970be1c?s=128&d=identicon&r=PG&f=1", "display_name": "Varun V", "link": "https://stackoverflow.com/users/4783551/varun-v"}, "edited": false, "score": 0, "creation_date": 1557857239, "post_id": 40808012, "comment_id": 98903421, "body": "Why 512 and why not Blksize?"}, {"owner": {"reputation": 3156, "user_id": 319063, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cNlJZ.png?s=128&g=1", "display_name": "itisravi", "link": "https://stackoverflow.com/users/319063/itisravi"}, "reply_to_user": {"reputation": 195, "user_id": 4783551, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d255732d9e9fe0bfa7076fd7970be1c?s=128&d=identicon&r=PG&f=1", "display_name": "Varun V", "link": "https://stackoverflow.com/users/4783551/varun-v"}, "edited": false, "score": 0, "creation_date": 1558021898, "post_id": 40808012, "comment_id": 98971221, "body": "@VarunV st_blksize is not the same as 512. See man page for stat(2), gnu.org/software/libc/manual/html_node/Attribute-Meanings.ht&zwnj;&#8203;ml etc."}, {"owner": {"reputation": 195, "user_id": 4783551, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d255732d9e9fe0bfa7076fd7970be1c?s=128&d=identicon&r=PG&f=1", "display_name": "Varun V", "link": "https://stackoverflow.com/users/4783551/varun-v"}, "edited": false, "score": 0, "creation_date": 1558026761, "post_id": 40808012, "comment_id": 98973604, "body": "Thanks. Clarified now @itisravi"}], "tags": [], "owner": {"reputation": 3156, "user_id": 319063, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cNlJZ.png?s=128&g=1", "display_name": "itisravi", "link": "https://stackoverflow.com/users/319063/itisravi"}, "is_accepted": true, "score": 2, "last_activity_date": 1480086971, "creation_date": 1480086971, "answer_id": 40808012, "question_id": 40795488, "link": "https://stackoverflow.com/questions/40795488/get-the-actual-file-size-vs-apparent-size-in-go/40808012#40808012", "title": "Get the actual file size vs apparent size in GO", "body": "<p>Looks like the <a href=\"https://golang.org/pkg/syscall/#Stat_t\" rel=\"nofollow noreferrer\">Stat_t structure</a> filled using stat/fstat calls from the  <a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow noreferrer\">Syscall package</a> is all you need. Just multiply Blocks by 512 to get the disk space consumed.</p>\n"}], "owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 40808012, "answer_count": 1, "score": 1, "last_activity_date": 1480086971, "creation_date": 1480028005, "question_id": 40795488, "link": "https://stackoverflow.com/questions/40795488/get-the-actual-file-size-vs-apparent-size-in-go", "title": "Get the actual file size vs apparent size in GO", "body": "<p>\"<em>fs.sys.Size</em>\" (fs being <em>fileStat</em> in the <em>os</em> package) returns the apparent size of a file. This isn't ideal when dealing with sparse files.</p>\n\n<p>Is there a way to get the actual file size in GO? Or all applications are bound to get the converted metadata that represent empty blocks as real ones?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "edited": false, "score": 0, "creation_date": 1480019733, "post_id": 40793564, "comment_id": 68810488, "body": "Thank you; this confirms what I had expected... now on to my next problem."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 1, "creation_date": 1480029235, "post_id": 40793564, "comment_id": 68813296, "body": "I found this this post very useful: <a href=\"http://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">research.swtch.com/interfaces</a>"}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 2, "last_activity_date": 1480016435, "creation_date": 1480016435, "answer_id": 40793564, "question_id": 40793502, "link": "https://stackoverflow.com/questions/40793502/can-a-predeclared-type-implement-an-interface-in-go/40793564#40793564", "title": "Can a predeclared type implement an interface in Go?", "body": "<p>Any (non built-in) type can satisfy an interface, thus:</p>\n\n<pre><code>type IntKey int\n\nfunc (k IntKey) Hash() int { ... }\n</code></pre>\n\n<p>and ...</p>\n\n<pre><code>type Collection struct {\n    // fields\n}\n\nfunc (c Collection) Hash() int { ... }\n</code></pre>\n\n<p>Both satisfy your <code>Key</code> interface. Further reading: <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Interface_types</a></p>\n"}], "owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 40793564, "answer_count": 1, "score": 0, "last_activity_date": 1480016435, "creation_date": 1480016141, "question_id": 40793502, "link": "https://stackoverflow.com/questions/40793502/can-a-predeclared-type-implement-an-interface-in-go", "title": "Can a predeclared type implement an interface in Go?", "body": "<p>Let's say that I have an interface, <code>Key</code>, which has a method <code>Hash() int</code>, that I would like to use in a collection struct in Go.  I would like to be able to do things in my collection such as <code>(c *Collection) Set(key Key, value Value)</code>.  I would like my collection to be able to be keyed on predeclared types, such as <code>type IntKey int</code>, so that I can take advantage of some limited implicit typing while implementing <code>(k IntKey) Hash() int</code>.  Is this possible, or to I need to declare <code>IntKey</code> as a struct?</p>\n"}, {"tags": ["pointers", "go", "struct", "language-lawyer", "composite-literals"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 0, "creation_date": 1480015503, "post_id": 40793362, "comment_id": 68809005, "body": "Thank you, this is obviously the direct answer to my question. I will mark it as such soon."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1480015401, "creation_date": 1480015401, "answer_id": 40793362, "question_id": 40793289, "link": "https://stackoverflow.com/questions/40793289/go-struct-literals-why-is-this-one-addressable/40793362#40793362", "title": "Go struct literals, why is this one addressable?", "body": "<p>It's a special case for convenience.  The spec mentions the exception <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<blockquote>\n  <p>As an exception to the addressability requirement, x may also be a (possibly parenthesized) composite literal.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 0, "creation_date": 1480022013, "post_id": 40793798, "comment_id": 68811265, "body": "Thank you for adding to the accepted answer! Very useful info."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1480022334, "last_edit_date": 1495541237, "creation_date": 1480017675, "answer_id": 40793798, "question_id": 40793289, "link": "https://stackoverflow.com/questions/40793289/go-struct-literals-why-is-this-one-addressable/40793798#40793798", "title": "Go struct literals, why is this one addressable?", "body": "<p>Adding a little more detail to Mellow Marmot's answer:</p>\n\n<p><a href=\"https://golang.org/ref/spec#Variables\" rel=\"nofollow noreferrer\">Spec: Variables:</a></p>\n\n<blockquote>\n  <p>Calling the built-in function <a href=\"https://golang.org/ref/spec#Allocation\" rel=\"nofollow noreferrer\"><code>new</code></a> or taking the address of a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a> allocates storage for a variable at run time. Such an anonymous variable is referred to via a (possibly implicit) <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">pointer indirection</a>.</p>\n</blockquote>\n\n<p><code>Point{1, 1}</code> is a composite literal, taking its address will create an anonymous variable under the hood, and the result of the expression will be the address of this anonymous variable.</p>\n\n<p>So as you can see technically it's a <em>variable</em> that is addressed, so it does not violate this:</p>\n\n<blockquote>\n  <p>Only <em>\"variables\"</em> [GOPL's words] are addressable.</p>\n</blockquote>\n\n<p>Also check out this answer to see what other \"goodies\" or tricks you can do: <a href=\"https://stackoverflow.com/questions/30716354/how-do-i-do-a-literal-int64-in-go/30716481#30716481\">How do I do a literal *int64 in Go?</a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 0, "creation_date": 1480299807, "post_id": 40836095, "comment_id": 68889792, "body": "I really do enjoy it! Though I am reading it (in more or less in a hurry) because I will most likely land a job writing Go code full-time very soon. Must have missed this part. I think this is up there with K&amp;D.... I mean K&amp;R. ;-) Thanks again!"}, {"owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "edited": false, "score": 0, "creation_date": 1525934932, "post_id": 40836095, "comment_id": 87552032, "body": "Is it rather equivalent to <code>var pp *Point; *pp = Point{1, 2}</code> not <code>pp := new(Point)</code>? Newly created zero-valued <code>Point</code> object is overwritten by <code>Point{1, 2}</code>, isn&#39;t it? (Yes, yes, I dare to ask to author of the Go book :-) )"}], "tags": [], "owner": {"reputation": 384, "user_id": 845711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf1094156d3a2412d2e4a9b81e2578f?s=128&d=identicon&r=PG", "display_name": "Alan Donovan", "link": "https://stackoverflow.com/users/845711/alan-donovan"}, "is_accepted": true, "score": 4, "last_activity_date": 1480297952, "creation_date": 1480297952, "answer_id": 40836095, "question_id": 40793289, "link": "https://stackoverflow.com/questions/40793289/go-struct-literals-why-is-this-one-addressable/40836095#40836095", "title": "Go struct literals, why is this one addressable?", "body": "<p>The <code>&amp;T{}</code> notation is explained in Section 4.4.1, Struct Literals, on page 103:</p>\n\n<blockquote>\n  <p>Because structs are so commonly dealt with through pointers, it\u2019s possible to use this shorthand notation to create and initialize a struct variable and obtain its address:</p>\n\n<pre><code>pp := &amp;Point{1, 2}\n</code></pre>\n  \n  <p>It is exactly equivalent to</p>\n\n<pre><code>pp := new(Point)\n*pp = Point{1, 2}\n</code></pre>\n  \n  <p>but <code>&amp;Point{1, 2}</code> can be used directly within an expression, such as a function call.</p>\n</blockquote>\n\n<p>Glad you're otherwise enjoying the book.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 2, "accepted_answer_id": 40836095, "answer_count": 3, "score": 4, "last_activity_date": 1480297952, "creation_date": 1480015076, "last_edit_date": 1480018259, "question_id": 40793289, "link": "https://stackoverflow.com/questions/40793289/go-struct-literals-why-is-this-one-addressable", "title": "Go struct literals, why is this one addressable?", "body": "<p>I am reading the book \"The Go Programming Language\". It is very good for us (rather) experienced programmers and explains the differences between the intersection of other languages -- but I've found a case which I do not understand fully.</p>\n\n<p>I know C++ sufficiently good, and I understand that Go calls (what in C++ would be called) rvalues/xvalues \"non-addressable\". Only <em>\"variables\"</em> [GOPL's words] are addressable.</p>\n\n<p><strong>OK, fair enough; it makes sense.</strong></p>\n\n<p>And therefore, for instance, this is illegal (according to page 159 in the first printing)</p>\n\n<pre><code>Point{1, 2}.ScaleBy(2) // compile error: can't take address of Point literal\n</code></pre>\n\n<p>because <code>(*Point).ScaleBy</code> takes a <code>*Point</code> as a receiver argument, and a <code>Point</code> literal is non-addressable.</p>\n\n<p>(If you haven't read the book, <code>Point</code> is a struct with the fields <code>X, Y float64</code>.</p>\n\n<p><strong>However</strong>, on page 162, we have</p>\n\n<pre><code>type ColoredPoint struct {\n    *Point\n    Color color.RGBA\n}\n\np := ColoredPoint(&amp;Point{1, 1}, red)\n// ...more code ...\n</code></pre>\n\n<p>which apparently is valid and will compile.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Why is the <code>Point</code> literal in the second case addressable?</p>\n\n<p>Is it a special case for convenience, or am I missing something in the big picture?</p>\n"}, {"tags": ["go", "floating-point", "calculator"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1480013477, "post_id": 40792949, "comment_id": 68808230, "body": "Include the error output in your question."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1480020925, "post_id": 40792949, "comment_id": 68810907, "body": "Pack the different cases into their own function and test these functions in isolation. Once each function has all bugs shaken out: Combine into larger code."}], "owner": {"reputation": 9, "user_id": 7206656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4220ac8fc763883a157124cbb21c8b2d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Para", "link": "https://stackoverflow.com/users/7206656/michael-para"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 932, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480089036, "creation_date": 1480013255, "question_id": 40792949, "link": "https://stackoverflow.com/questions/40792949/go-lang-switch-statement-error", "title": "go lang switch statement error", "body": "<p>I'm brand new to both Go, and stack overflow so please bear with me. I'm building a simple calculator using go, and I'm trying to add functionality for floating point numbers.</p>\n\n<p>the program accepts a string (ex: \"2 + 3\") and displays the result. It can read and calculate integers just fine, but I hit a problem when the program encounters the decimal. It uses nested switch statements once it encounters a '.' it runs the nested switch statement until it hits whitespace. It's supposed to calculate the same as the integer values, only difference is that it divides the value by 10(moving the value to the values right to the thenths hundreths thousanths etc) but when I try to run it, it just stops, no errors or anything, it just hangs there and makes me force close the program.</p>\n\n<p>here's my code(my error occurs when i get to the case '.':, everything else runs fine):</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"stack\"\n    )\n\nvar operatorStack = stack.NewStack()\nvar operandStack = stack.NewStack()\n\nfunc precedence(op byte) uint8 {\nswitch op {\n    case '+', '-': return 0\n    case '*', '/': return 1\n    default: panic(\"illegal operator\")\n    }\n}\n\nfunc apply() {\nop := operatorStack.Pop().(byte)\nright := operandStack.Pop().(float64)\nleft := operandStack.Pop().(float64)\nswitch op {\n    case '+': operandStack.Push(left + right)\n    case '-': operandStack.Push(left - right)\n    case '*': operandStack.Push(left * right)\n    case '/': operandStack.Push(left / right)\n    default: panic(\"illegal operator\")\n}\n}\n\nfunc main() {\n// Read a from Stdin.\nscanner := bufio.NewScanner(os.Stdin)\nscanner.Scan()\nline := scanner.Text()\n//\nfor i := 0; i &lt; len(line); {\n    switch line[i] {\n        case '0', '1', '2', '3', '4', '5', '6', '7', '8', '9':\n            v := float64(0)\n            for {\n                v = v * 10 + float64(line[i] - '0')\n                i++\n                if i == len(line) || !('0' &lt;= line[i] &amp;&amp; line[i] &lt;= '9') {\n                    break\n                }\n            }\n            operandStack.Push(v)\n        case '+', '-', '*', '/':\n            for !operatorStack.IsEmpty() &amp;&amp; precedence(operatorStack.Top().(byte)) &gt;= precedence(line[i]) {\n                apply()\n            }\n            operatorStack.Push(line[i])\n            i++\n        case ' ': i++\n        case '.':\n            for b := line[i]; b != ' '; {\n                    switch line[i] {\n                        case '0', '1', '2', '3', '4', '5', '6', '7', '8', '9':\n                            v := float64(0)\n                            for {\n                                v = v / 10 + float64(line[i] - '0')\n                                i++\n                                if i == len(line) || !('0' &lt;= line[i] &amp;&amp; line[i] &lt;= '9') {\n                                    break\n                                }\n                            }\n                            operandStack.Push(v)\n                        case ' ': \n                        operatorStack.Push('+')\n                        break\n                        }\n\n            }\n        default: panic(\"illegal character\")\n    }\n}\nfor !operatorStack.IsEmpty() {\n    apply()\n}\nr := operandStack.Pop().(float64)\nfmt.Println(r)\n</code></pre>\n"}]