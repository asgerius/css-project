[{"tags": ["go", "hashicorp-vault", "two-factor-authentication", "totp"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1562198820, "post_id": 56879147, "comment_id": 100306921, "body": "What&#39;s the point to create a hash?"}, {"owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1562198997, "post_id": 56879147, "comment_id": 100306945, "body": "In this way, I can generate the secret for that specific user every time without using any external database or backend. I can only need to keep one secret safe  \u2013 zerkms"}, {"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1562199008, "post_id": 56879147, "comment_id": 100306948, "body": "Sounds reasonable (eg use SHA256 to generate user specific secret from master secret + user ID).  However, if the users secret is compromised you have to give them a <i>new ID</i> (prob not desireable).  Also if the master secret is compromised you have to give everyone a new secret (through QR or whatever). My question is why is it easier to store one secret than one per user?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1562216632, "post_id": 56879147, "comment_id": 100309798, "body": "You can use Vault&#39;s <a href=\"https://www.vaultproject.io/docs/secrets/transit/index.html\" rel=\"nofollow noreferrer\">Transit Backend</a> to derive keys for users (using the user ID as the context for data keys or HMACs, for instance), although I have to admit that I don&#39;t understand why you are trying to do that. Being able to reproduce an encryption key is generally bad, for the same reason that we don&#39;t store passwords in a reproducible fashion."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1562216740, "post_id": 56879147, "comment_id": 100309826, "body": "&quot;My idea was to store a specific secret somewhere safe.&quot; Isn&#39;t Vault that safe place though?"}, {"owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "edited": false, "score": 0, "creation_date": 1562244886, "post_id": 56879147, "comment_id": 100323797, "body": "I wanted to store the master secret somewhere safe like vault or k8s secret but generate one-way secret per user using SH256 with masterSecret+userId and generate the secret again when I need to verify user code. \u2013 Peter"}, {"owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "edited": false, "score": 0, "creation_date": 1562245236, "post_id": 56879147, "comment_id": 100324001, "body": "I believe that won&#39;t happen. Because if somebody can find a way to access to our VPC and k8s cluster and see the master password, in the same way, he&#39;ll have access to the Vault or DB as well. I think the security level will be the same. Thanks for your response \u2013 AJR"}], "answers": [{"tags": [], "owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "is_accepted": false, "score": 0, "last_activity_date": 1564606953, "creation_date": 1564606953, "answer_id": 57298792, "question_id": 56879147, "link": "https://stackoverflow.com/questions/56879147/using-one-secret-for-generating-totp-vs-multiple-secrets/57298792#57298792", "title": "Using one secret for generating totp vs multiple secrets", "body": "<p>Using a master secret and generating user secret with sha256 was a bad idea. Becuase generated secret and QR is always same. If the user lost hist phone and wants to delete the QR code and get a new QR that's not possible. Best practice would be generating random secrets and store them in the vault.</p>\n"}], "owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1564606953, "creation_date": 1562197807, "last_edit_date": 1562216765, "question_id": 56879147, "link": "https://stackoverflow.com/questions/56879147/using-one-secret-for-generating-totp-vs-multiple-secrets", "title": "Using one secret for generating totp vs multiple secrets", "body": "<p>I want to use google authenticator and totp algorithm for 2fa on my website. I have 2 questions for generating the QR secret.</p>\n\n<p>I planned to use vault to store the secrets to be more secure but my question is there any other way to generate the secret every time instead of storing it in some storage?</p>\n\n<p>I've read in tutorials that I need to use random secret per user and store that secret in DB for otp verification.</p>\n\n<p>My idea was to store a specific secret somewhere safe and generate a hash using that secret per user. For instance, generate the hash using mySecret+userId</p>\n\n<p>Is it a safe way?</p>\n"}, {"tags": ["json", "http", "go", "gorilla"], "comments": [{"owner": {"reputation": 74246, "user_id": 80911, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9e9b4f80c65dc6076d74cd421084e4fc?s=128&d=identicon&r=PG", "display_name": "Evert", "link": "https://stackoverflow.com/users/80911/evert"}, "edited": false, "score": 0, "creation_date": 1562190782, "post_id": 56877980, "comment_id": 100305307, "body": "Are you looking to get to the <code>{id}</code> parameter?"}, {"owner": {"reputation": 95, "user_id": 8556177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sCwe3.jpg?s=128&g=1", "display_name": "JamWill", "link": "https://stackoverflow.com/users/8556177/jamwill"}, "reply_to_user": {"reputation": 74246, "user_id": 80911, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9e9b4f80c65dc6076d74cd421084e4fc?s=128&d=identicon&r=PG", "display_name": "Evert", "link": "https://stackoverflow.com/users/80911/evert"}, "edited": false, "score": 0, "creation_date": 1562190826, "post_id": 56877980, "comment_id": 100305322, "body": "Yes. Looking to return Json entries that match the {id}"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562190873, "post_id": 56877980, "comment_id": 100305336, "body": "I guess you are using the gorilla mux.  Use <code>vars := mux.Vars(r)</code> and then vars[&quot;id&quot;] and read the examples <a href=\"https://github.com/gorilla/mux\" rel=\"nofollow noreferrer\">github.com/gorilla/mux</a>"}, {"owner": {"reputation": 95, "user_id": 8556177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sCwe3.jpg?s=128&g=1", "display_name": "JamWill", "link": "https://stackoverflow.com/users/8556177/jamwill"}, "reply_to_user": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562191557, "post_id": 56877980, "comment_id": 100305529, "body": "Yes using the mux package. I managed to get that part out of some guides @georgeok but how would i apply the vars to the url to only return the entries with the matching id"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562192327, "post_id": 56877980, "comment_id": 100305678, "body": "If I get it correctly you want to use the ID instead of the name. So replace <code>http:&#47;&#47;pokeapi.co&#47;api&#47;v2&#47;pokedex&#47;kanto&#47;</code> with <code>http:&#47;&#47;pokeapi.co&#47;api&#47;v2&#47;pokedex&#47;2</code>"}, {"owner": {"reputation": 95, "user_id": 8556177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sCwe3.jpg?s=128&g=1", "display_name": "JamWill", "link": "https://stackoverflow.com/users/8556177/jamwill"}, "edited": false, "score": 0, "creation_date": 1562192867, "post_id": 56877980, "comment_id": 100305786, "body": "I want localhost:8080/games/1 to return entry number 1, and localhost:8080/games/2 to return entry number 2, as per the router."}], "owner": {"reputation": 95, "user_id": 8556177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sCwe3.jpg?s=128&g=1", "display_name": "JamWill", "link": "https://stackoverflow.com/users/8556177/jamwill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 664, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562228002, "creation_date": 1562188293, "last_edit_date": 1562228002, "question_id": 56877980, "link": "https://stackoverflow.com/questions/56877980/how-to-return-specific-json-data-by-an-id-parameter-in-golang-server", "title": "How to return specific JSON data by an ID parameter in Golang server", "body": "<p>I am working on a project I've tasked to myself.</p>\n\n<p>I'm trying to set up a Golang server that displays JSON data from a remote json file based on a parameter (ID) passed by the user.</p>\n\n<p>I can find plenty of guides that show how to consume ALL the data from the json API, but I don't know how to pass a parameter to the function so it only returns the required data.</p>\n\n<p>Here is what I have so far:</p>\n\n<p>Setting up the basic server and routes</p>\n\n<pre><code>func main() {\n\n    //Initialises basic router and endpoints\n    r := mux.NewRouter()\n    r.HandleFunc(\"/\", home).Methods(\"GET\")\n    r.HandleFunc(\"/games/all\", getAll).Methods(\"GET\")\n    r.HandleFunc(\"/games/{id}\", getGame).Methods(\"POST\")\n    r.HandleFunc(\"/games/report\", getReport).Methods(\"GET\")\n\n    fmt.Println(\"Listening on port 8080\")\n    http.ListenAndServe(\":8080\", r)\n\n}\n</code></pre>\n\n<p>This is my getAll method that sends the GET request (Using the pokedex api for now until i host my json file).</p>\n\n<pre><code>func getAll(w http.ResponseWriter, r *http.Request) {\n    response, err := http.Get(\"http://pokeapi.co/api/v2/pokedex/kanto/\")\n\n    if err != nil {\n        fmt.Print(err.Error())\n        os.Exit(1)\n    }\n\n    responseData, err := ioutil.ReadAll(response.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(responseData))\n}\n</code></pre>\n\n<p>Have also built the structs for the data. But i cant, for the life of me, find a way to pass the parameter to do the getGame method to handle that route. Please, if anybody could point me in the right direction.</p>\n"}, {"tags": ["git", "go", "git-bash"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1562198769, "post_id": 56877926, "comment_id": 100306912, "body": "where possible always issue a command manually before automating it ... saves time and effort"}], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 1054114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc175ba42a40a2cd3d3ba24910f9bfa1?s=128&d=identicon&r=PG", "display_name": "orirawlings", "link": "https://stackoverflow.com/users/1054114/orirawlings"}, "is_accepted": true, "score": 2, "last_activity_date": 1562188836, "creation_date": 1562188836, "answer_id": 56878081, "question_id": 56877926, "link": "https://stackoverflow.com/questions/56877926/using-golang-exec-library-to-pass-gitconfig-arguments-into-git-bash/56878081#56878081", "title": "Using golang exec library to pass gitconfig arguments into git bash", "body": "<p>You probably shouldn't include the <code>-C</code> option without also giving it a path. If you are trying to add something to the global config, you probably don't need the <code>-C</code> option at all.</p>\n"}], "owner": {"reputation": 91, "user_id": 9367249, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Raw4ka1TOyQ/AAAAAAAAAAI/AAAAAAAAATM/_mE6S8xylZ0/photo.jpg?sz=128", "display_name": "TheJet 1", "link": "https://stackoverflow.com/users/9367249/thejet-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 56878081, "answer_count": 1, "score": 1, "last_activity_date": 1562188836, "creation_date": 1562187992, "question_id": 56877926, "link": "https://stackoverflow.com/questions/56877926/using-golang-exec-library-to-pass-gitconfig-arguments-into-git-bash", "title": "Using golang exec library to pass gitconfig arguments into git bash", "body": "<p>I am trying to write a go script to setup the user's name in the gitconfig file. </p>\n\n<p>I tried the following arguments shown in the code below in the terminal and it works when I manually input the arguments sequentially, but it does not work from golang.</p>\n\n<pre><code>cl := exec.Command(\"git\", \"-C\", \"config\", \"--global\", \"user.name\", \n\"myname\")\nstdout, err := cl.CombinedOutput()\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Printf(\"%s\", stdout)\n</code></pre>\n\n<p>From the code snippet I expect the code to generate a .gitconfig file and for the file to contain the name of the user. When I run the code I get exit status 128.</p>\n"}, {"tags": ["windows", "go", "pixel"], "comments": [{"owner": {"reputation": 387, "user_id": 7447711, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/06fc8aa94e57d803061286afdcd0f309?s=128&d=identicon&r=PG&f=1", "display_name": "Mikael", "link": "https://stackoverflow.com/users/7447711/mikael"}, "edited": false, "score": 1, "creation_date": 1562183943, "post_id": 56877105, "comment_id": 100302862, "body": "You could take a screenshot with something like <a href=\"https://github.com/vova616/screenshot\" rel=\"nofollow noreferrer\">github.com/vova616/screenshot</a> and then try to get the RGB values at the exact pixel."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562187864, "post_id": 56877105, "comment_id": 100304354, "body": "For which operating system?"}, {"owner": {"reputation": 11, "user_id": 7987191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2555587ac8f4088db44b26a39d6762b?s=128&d=identicon&r=PG&f=1", "display_name": "D. Andrews", "link": "https://stackoverflow.com/users/7987191/d-andrews"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562198518, "post_id": 56877105, "comment_id": 100306876, "body": "@Flimzy it is for windows"}], "owner": {"reputation": 11, "user_id": 7987191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2555587ac8f4088db44b26a39d6762b?s=128&d=identicon&r=PG&f=1", "display_name": "D. Andrews", "link": "https://stackoverflow.com/users/7987191/d-andrews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562224955, "creation_date": 1562183676, "last_edit_date": 1562224955, "question_id": 56877105, "link": "https://stackoverflow.com/questions/56877105/how-can-i-get-pixel-data-from-a-window-with-golang", "title": "How can I get pixel data from a window with Golang", "body": "<p>I want to make a program where I can read the pixel data from a window, for example a browser window or game window. Is there a way I can implement this with Golang? Probably the format I would like it in would be a 2d array of some sort that gives RGB values too.</p>\n"}, {"tags": ["go", "reflection", "reflect"], "comments": [{"owner": {"reputation": 387, "user_id": 7447711, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/06fc8aa94e57d803061286afdcd0f309?s=128&d=identicon&r=PG&f=1", "display_name": "Mikael", "link": "https://stackoverflow.com/users/7447711/mikael"}, "edited": false, "score": 0, "creation_date": 1562183756, "post_id": 56876979, "comment_id": 100302788, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39866503/get-all-fields-from-an-interface\">Get all fields from an interface</a>"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562190275, "post_id": 56876979, "comment_id": 100305165, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/56588337/how-to-write-a-function-to-process-two-types-of-input-data-in-golang\">how to write a function to process two types of input data in golang</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1562195362, "creation_date": 1562195362, "answer_id": 56878921, "question_id": 56876979, "link": "https://stackoverflow.com/questions/56876979/generic-attribution-to-field-x-present-across-multiples-types/56878921#56878921", "title": "Generic attribution to field X, present across multiples types", "body": "<p>Use anonymous fields, methods and interfaces. You can define a new struct that contains all the common properties to all other structs. Then, an interface could be defined over this shared struct, that lists all the methods to handle the common properties. Finally, in the previous structs you only need to replace all the common fields with this new interface. At this point, you are able to write generic functions that take the interface as input and handle internal common fields through exposed methods.</p>\n\n<pre><code>type SettableA interface{\n    SetA(int)\n    A() int\n}\n\ntype sharedA struct {\n    a int\n}\n\nfunc (s *sharedA) SetA(val int) {\n    s.a = val\n}\n\nfunc (s *sharedA) A() int {\n    return s.a\n}\n\ntype v1 struct {\n    SettableA \n}\n\ntype v2 struct {\n    SettableA \n    b string\n}\n\nfunc foo(root SettableA) {\n    root.SetA(5)\n}\n\nfunc main() {\n    v1var := v1{\n        SettableA: &amp;sharedA{},\n    }\n    foo(v1var)\n    v2var := v2{\n        SettableA: &amp;sharedA{},\n        b: \"test\",\n    }\n    foo(v2var)\n    fmt.Printf(\"V1: %v\\nV2: %v\\n\", v1var.A(), v2var.A())\n}\n</code></pre>\n\n<p>Here the interface is not strictly necessary, but it allows you to write a generic function that handles different concrete types.</p>\n\n<p><a href=\"https://play.golang.org/p/BgxYrbGE426\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BgxYrbGE426</a> </p>\n"}], "owner": {"reputation": 11, "user_id": 5991510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wZicJ.jpg?s=128&g=1", "display_name": "Jubilu", "link": "https://stackoverflow.com/users/5991510/jubilu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562250831, "creation_date": 1562183005, "last_edit_date": 1562250831, "question_id": 56876979, "link": "https://stackoverflow.com/questions/56876979/generic-attribution-to-field-x-present-across-multiples-types", "title": "Generic attribution to field X, present across multiples types", "body": "<p>Currently, I'm working with a set of structures, which define multiple versions of a document. Most of the fields are shared across these different versions, and the actual differences are pretty subtle. What I'm trying to do is refactor the code that parses this document. For that, it would be really good if I could generalize some attributions, where I don't need to know exactly what type I'm working to know that the type will have a specific field.</p>\n\n<p>I've thought about using reflection but if I can avoid it I would.</p>\n\n<p>Lets say we have:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type v1 struct{\n  a int\n}\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type v2 struct{\n a int\n b string\n}\n</code></pre>\n\n<p>what I would like to do is something like</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n var v1 v1\n var v2 v2\n\n foo(v1)\n foo(v2)\n}\n\n\nfunc foo (root interface{}){\n  root.a = x\n}\n</code></pre>\n\n<p>is it possible? or is there any other way?</p>\n\n<p>edit: \n1 - this is not a duplicate of \"Get all fields from an interface\" as my problem is not to figure out what type I'm dealing with, but to manipulate/treat different types the same way.\n2 - this could be a duplicate of \"how to write a function to process two types of input data in golang\" but the answer provided fails to solve my issue.</p>\n"}, {"tags": ["mongodb", "go", "mongo-go"], "answers": [{"comments": [{"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1562285457, "post_id": 56884619, "comment_id": 100336565, "body": "You&#39;re welcome, and welcome to StackOverflow. Here&#39;s the link to the post in group as well. <a href=\"https://groups.google.com/forum/#!topic/mongodb-go-driver/lcpnxzraZVU\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/mongodb-go-driver/lcpnxzraZV&zwnj;&#8203;U</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 10562672, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQlai5QD09Y/AAAAAAAAAAI/AAAAAAAAAJc/i7QWTEb0r_k/photo.jpg?sz=128", "display_name": "Dinamis", "link": "https://stackoverflow.com/users/10562672/dinamis"}, "is_accepted": false, "score": 0, "last_activity_date": 1562231921, "creation_date": 1562231921, "answer_id": 56884619, "question_id": 56875529, "link": "https://stackoverflow.com/questions/56875529/updateone-replaceone-findoneandreplace-patternmatch-but-no-upd-data/56884619#56884619", "title": "UpdateOne, ReplaceOne, FindOneAndReplace - patternmatch, but no upd data", "body": "<p>Thanks @Wan Bachtiar for answering this in official MongoDB-go-adapter group.</p>\n\n<blockquote>\n  <p>By default queries in MongoDB is case sensitive on the field name. In\n  your struct you defined the field to be Name, but in your filter to\n  specify name. This would result in no documents matching the query\n  predicates for the the update operation. For example, if you have a\n  document as below:</p>\n</blockquote>\n\n<pre><code>{ \"_id\": ObjectId(\"...\"), \"Name\": \"Dinamis\", \"Coins\": 1 }\n</code></pre>\n\n<blockquote>\n  <p>You can perform an update to increment the number of Coins using below\n  snippet:</p>\n</blockquote>\n\n<pre><code>collection := client.Database(\"Nothing\").Collection(\"dataUser\")\nfilter := bson.M{\"Name\": \"Dinamis\"}\nupdate := bson.D{{\"$inc\", bson.M{\"Coins\": 1}}}\nresult, err := collection.UpdateOne(context.TODO(), filter, update)\n</code></pre>\n\n<blockquote>\n  <p>Also, note that you have a typo on the bson tag in your struct. It\u2019s\n  supposed to be bson:\"Name\" not bosn:\"Name\". You may find Query\n  Documents as a useful reference (Select the Go tab to show examples in\n  Go)</p>\n  \n  <p>Regards, Wan.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 10562672, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQlai5QD09Y/AAAAAAAAAAI/AAAAAAAAAJc/i7QWTEb0r_k/photo.jpg?sz=128", "display_name": "Dinamis", "link": "https://stackoverflow.com/users/10562672/dinamis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562231921, "creation_date": 1562176097, "last_edit_date": 1562187256, "question_id": 56875529, "link": "https://stackoverflow.com/questions/56875529/updateone-replaceone-findoneandreplace-patternmatch-but-no-upd-data", "title": "UpdateOne, ReplaceOne, FindOneAndReplace - patternmatch, but no upd data", "body": "<p>I'm Using Mongo Go Adapter: github.com/mongodb/mongo-go-driver/</p>\n\n<p>I'm trying different patterns but none of them working for me.</p>\n\n<p>//ref struct</p>\n\n<pre><code>type userbase struct {\n    Name  string `bosn:\"Name\"`\n    Coins int    `bson:\"Coins\"`\n}\n</code></pre>\n\n<p>//ref code, it's updating _id, but not updating a value </p>\n\n<pre><code>filter := bson.M{\"name\": \"Dinamis\"}\nupdate := bson.D{{\"$inc\", bson.M{\"Coins\": 1}}}\ndb := Client.Database(\"Nothing\").Collection(\"dataUser\")\ndb.UpdateOne(context.Background(), filter, update)\n</code></pre>\n\n<p>//update filters that i also used</p>\n\n<pre><code>update := bson.D{{\"$inc\", bson.D{{\"Coins\", 1},}},}\n</code></pre>\n\n<p>//simple ways was tryed also</p>\n\n<pre><code>update := &amp;userbase{name, amount} //should i try *userbase{} ?\n</code></pre>\n\n<p>//Also i'm tryed</p>\n\n<pre><code>ReplaceOne() \nFindOneAndReplace()\nFindOneAndUpdate()\n</code></pre>\n\n<p>it's hard to dig deeper b-cuz of luck of actual documentation: <a href=\"https://docs.mongodb.com/ecosystem/drivers/go/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/ecosystem/drivers/go/</a></p>\n"}, {"tags": ["json", "go", "kubernetes"], "comments": [{"owner": {"reputation": 519, "user_id": 6680332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bkTG-Ocx05o/AAAAAAAAAAI/AAAAAAAAA2c/n6WLPcA4z5A/photo.jpg?sz=128", "display_name": "codenio", "link": "https://stackoverflow.com/users/6680332/codenio"}, "edited": false, "score": 0, "creation_date": 1562174993, "post_id": 56874251, "comment_id": 100299086, "body": "<code>The universalDeserializer asks me the type, but I can&#39;t know the type with the AdmissionRequest.</code>   -&gt;   Did you try review.AdmissionRequest.kind to get the object kind..?"}, {"owner": {"reputation": 31, "user_id": 11735346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe301e84240312c4a40d236ac6ca6de?s=128&d=identicon&r=PG&f=1", "display_name": "panicked", "link": "https://stackoverflow.com/users/11735346/panicked"}, "reply_to_user": {"reputation": 519, "user_id": 6680332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bkTG-Ocx05o/AAAAAAAAAAI/AAAAAAAAA2c/n6WLPcA4z5A/photo.jpg?sz=128", "display_name": "codenio", "link": "https://stackoverflow.com/users/6680332/codenio"}, "edited": false, "score": 0, "creation_date": 1562178731, "post_id": 56874251, "comment_id": 100300705, "body": "Yes, I&#39;ve tried it but this gives me a panic with null pointer dereference. Can you please show me how to use this? Thank you!"}, {"owner": {"reputation": 519, "user_id": 6680332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bkTG-Ocx05o/AAAAAAAAAAI/AAAAAAAAA2c/n6WLPcA4z5A/photo.jpg?sz=128", "display_name": "codenio", "link": "https://stackoverflow.com/users/6680332/codenio"}, "edited": false, "score": 0, "creation_date": 1562211085, "post_id": 56874251, "comment_id": 100308800, "body": "I guess the implementation described here would be helpful. <a href=\"https://github.com/ContainerSolutions/go-validation-admission-controller/blob/67e52fd923334478600222ef4e395e83122de48a/server/server.go#L30\" rel=\"nofollow noreferrer\">github.com/ContainerSolutions/&hellip;</a>  Related Article: <a href=\"https://container-solutions.com/a-gentle-intro-to-validation-admission-webhooks-in-kubernetes/\" rel=\"nofollow noreferrer\">container-solutions.com/&hellip;</a>"}], "owner": {"reputation": 31, "user_id": 11735346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe301e84240312c4a40d236ac6ca6de?s=128&d=identicon&r=PG&f=1", "display_name": "panicked", "link": "https://stackoverflow.com/users/11735346/panicked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562170234, "creation_date": 1562170234, "question_id": 56874251, "link": "https://stackoverflow.com/questions/56874251/how-to-deserialize-an-admissionrequest-raw-object-into-a-kubernetes-object-witho", "title": "How to deserialize an AdmissionRequest.Raw object into a Kubernetes Object without knowing it&#39;s GroupVersionKind?", "body": "<p>I'm currently writing a validating webhook for Kubernetes. I'm facing a problem trying to deserialize a admission request coming from the Kubernetes API into a Kubernetes Object. The resource could be any of: pods, deployments, statefulsets, ingresses, services. The universalDeserializer asks me the type, but I can't know the type with the AdmissionRequest.\nThere's any Decoder that takes just the Raw object and decodes it in a valid object?</p>\n\n<p>I've tried to deserialize an AdmissionRequest.Request.Object.Raw and received that error:</p>\n\n<pre><code>panic: Object 'Kind' is missing in '{\"metadata\":{\"name\":\"gac\",\"namespace\":\"all\",\"uid\":\"2b38b994-9cf4-11e9-bb40-0800270c8766\",\"generation\":1,\"creationTimestamp\":\"2019-07-02T18:06:52Z\",\"labels\":{\"app\":\"gac\",\"release\":\"nao_pode_essa\"}},\"spec\":{\"replicas\":1,\"selector\":{\"matchLabels\":{\"app\":\"gac\",\"release\":\"2\"}},\"template\":{\"metadata\":{\"creationTimestamp\":null,\"labels\":{\"app\":\"gac\",\"release\":\"2\"}},\"spec\":{\"containers\":'...\n</code></pre>\n\n<p>But there was Kind in my object.</p>\n\n<p>I've tried to deserialize this using the JSON representation of the object and it worked.</p>\n\n<p>This is my code:</p>\n\n<pre><code>func main() {\n\n    review := v1beta1.AdmissionReview{}\n    body := `{\"kind\":\"AdmissionReview\",\"apiVersion\":\"admission.k8s.io/v1beta1\",\"request\":{\"uid\":\"2b38c0e2-9cf4-11e9-bb40-0800270c8766\",\"kind\":{\"group\":\"apps\",\"version\":\"v1\",\"kind\":\"Deployment\"},\"resource\":{\"group\":\"apps\",\"version\":\"v1\",\"resource\":\"deployments\"},\"namespace\":\"all\",\"operation\":\"CREATE\",\"userInfo\":{\"username\":\"minikube-user\",\"groups\":[\"system:masters\",\"system:authenticated\"]},\"object\":{\"metadata\":{\"name\":\"gac\",\"namespace\":\"all\",\"uid\":\"2b38b994-9cf4-11e9-bb40-0800270c8766\",\"generation\":1,\"creationTimestamp\":\"2019-07-02T18:06:52Z\",\"labels\":{\"app\":\"gac\",\"release\":\"nao_pode_essa\"}},\"spec\":{\"replicas\":1,\"selector\":{\"matchLabels\":{\"app\":\"gac\",\"release\":\"2\"}},\"template\":{\"metadata\":{\"creationTimestamp\":null,\"labels\":{\"app\":\"gac\",\"release\":\"2\"}},\"spec\":{\"containers\":[{\"name\":\"erickkkkk\",\"image\":\"erickfaustino/gac:v0.1.0\",\"ports\":[{\"name\":\"http\",\"containerPort\":8443,\"protocol\":\"TCP\"}],\"resources\":{\"limits\":{\"cpu\":\"1\",\"memory\":\"1Gi\"},\"requests\":{\"cpu\":\"200m\",\"memory\":\"200Mi\"}},\"terminationMessagePath\":\"/dev/termination-log\",\"terminationMessagePolicy\":\"File\",\"imagePullPolicy\":\"Always\"}],\"restartPolicy\":\"Always\",\"terminationGracePeriodSeconds\":30,\"dnsPolicy\":\"ClusterFirst\",\"securityContext\":{},\"schedulerName\":\"default-scheduler\"}},\"strategy\":{\"type\":\"RollingUpdate\",\"rollingUpdate\":{\"maxUnavailable\":\"25%\",\"maxSurge\":\"25%\"}},\"revisionHistoryLimit\":10,\"progressDeadlineSeconds\":600},\"status\":{}},\"oldObject\":null,\"dryRun\":false}}`\n    bbyte := []byte(body)\n    ud := scheme.Codecs.UniversalDeserializer()\n    _, _, err := ud.Decode(bbyte, nil, &amp;review)\n    if err != nil {\n        panic(err)\n    }\n    raw := review.Request.Object.Raw\n    lero, _, err := ud.Decode(raw, nil, nil)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(lero)\n\n}\n</code></pre>\n"}, {"tags": ["docker", "go", "docker-compose", "containers", "minio"], "owner": {"reputation": 83, "user_id": 1452642, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/14f82f3a7e1860c3fd3f157d53f5a357?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/1452642/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1562167374, "creation_date": 1562167374, "question_id": 56873391, "link": "https://stackoverflow.com/questions/56873391/minio-presigned-get-url-403-signaturedoesnotmatch", "title": "minio presigned get url 403 SignatureDoesNotMatch", "body": "<p>The presigned url (which's generated by my golang server side code) of getting object failed with 403 (SignatureDoesNotMatch), but the presigned url i got from minio browser (https:domain.com:9000/) works as expected (can download image from server)</p>\n\n<p>This issue exists in my staging server, where have several services run by docker-compose: frontend, restful api, mysql and minio, they are run in isolated container. </p>\n\n<p>Below is the docker-compose configuration for the minio service:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>  minio:\n    container_name: minio\n    image: minio/minio:RELEASE.2019-06-11T00-44-33Z\n    volumes:\n      - \"./.minio/data:/data\"\n    #      - \"./.minio/conf/minio.cnf:/root/.minio\"\n    ports:\n      - \"9000:9000\"\n    restart: always\n    environment:\n      MINIO_ACCESS_KEY: W2SPAEGFUKISFTZ53EW2\n      MINIO_SECRET_KEY: +uzhExt04MPooPa+j+PBijzC7HOdrpJHFaQK7PSG\n      TZ: Asia/Shanghai\n    command: server /data\n</code></pre>\n\n<p>When i access the presigned url (generated by my golang code) in browser, i got below error message, however, if i use the presigned url get from minio browser, it works (i can download the image i uploaded in minio server)</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Error&gt;\n&lt;Code&gt;SignatureDoesNotMatch&lt;/Code&gt;\n&lt;Message&gt;\nThe request signature we calculated does not match the signature you provided. Check your key and signing method.\n&lt;/Message&gt;\n&lt;Key&gt;1NVUCVJPLyS2okhlqtENB47bmFy.JPG&lt;/Key&gt;\n&lt;BucketName&gt;picture&lt;/BucketName&gt;\n&lt;Resource&gt;/picture/1NVUCVJPLyS2okhlqtENB47bmFy.JPG&lt;/Resource&gt;\n&lt;RequestId&gt;15ADED649D847B74&lt;/RequestId&gt;\n&lt;HostId&gt;4b5e8cee-8cc3-466c-8fda-441ac2ca0d79&lt;/HostId&gt;\n&lt;/Error&gt;\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1562181061, "post_id": 56873028, "comment_id": 100301754, "body": "your runtime error is, because &amp;count is not initialized, which means a nil pointer."}, {"owner": {"reputation": 742, "user_id": 8398116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vlhgs.jpg?s=128&g=1", "display_name": "Abhilash Gopalakrishna", "link": "https://stackoverflow.com/users/8398116/abhilash-gopalakrishna"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1562181229, "post_id": 56873028, "comment_id": 100301826, "body": "@apxp forgot to include that in the question. I have initialized it!! :)"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1562217492, "post_id": 56873028, "comment_id": 100310029, "body": "Your code is not readable! It seams that you are not initializing <code>tb</code>, <code>columname</code>,.... You should not use <code>init()</code>. Just move everything inside <code>main()</code> that makes your debugging much easier."}, {"owner": {"reputation": 742, "user_id": 8398116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vlhgs.jpg?s=128&g=1", "display_name": "Abhilash Gopalakrishna", "link": "https://stackoverflow.com/users/8398116/abhilash-gopalakrishna"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1562218471, "post_id": 56873028, "comment_id": 100310352, "body": "@apxp apologies for the poor formatting, I&#39;m using a mobile. Have updated the code :)"}], "owner": {"reputation": 742, "user_id": 8398116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vlhgs.jpg?s=128&g=1", "display_name": "Abhilash Gopalakrishna", "link": "https://stackoverflow.com/users/8398116/abhilash-gopalakrishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 688, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562218261, "creation_date": 1562166114, "last_edit_date": 1562218261, "question_id": 56873028, "link": "https://stackoverflow.com/questions/56873028/gorm-count-returns-0", "title": "GORM Count returns 0", "body": "<p><strong>Problem Statement</strong></p>\n\n<p><strong><em>Problem 1</em></strong></p>\n\n<p>I am getting a 0 when trying to retrieve the count.\nThe query expression is perfect, by which I assume that the query being built is correct.</p>\n\n<p>However, the result is 0 irrespective of the query.</p>\n\n<p><strong><em>Problem 2</em></strong></p>\n\n<p>I am required to specify the db name in the Table clause as Table(dbname.tbname)</p>\n\n<p>This isn't required in the any other queries and is required only when using Count()</p>\n\n<p>What might I be missing?</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/mssql\"\n    _ \"github.com/jinzhu/gorm/dialects/mysql\"\n    _ \"github.com/jinzhu/gorm/dialects/postgres\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n)\n\nvar db *gorm.DB\nvar err error\n\n\nfunc main() {\n\n  db, err = gorm.Open(\"mysql\",  \"gorm:gorm@tcp(localhost:9910)/gorm?charset=utf8&amp;parseTime=True\")\n\n if err != nil {\n         panic(err)\n    }\n\n    db.LogMode(true)\n\n      var count int\n      var  db = \"db\"\n      var  tb  = \"tb\"\n      var columnname = \"somecol\"\n      var date = \"2014-01-02\"\n\n      err := db.Table(db+\".\"+tb).Where(\"? &gt;= ?\", columnname, date+\" 00:01:00\").Count(&amp;count)\n\n        if err != nil {\n                Error.Println(err.Error.Error())\n       }\n         fmt.Println(\"The Count is \\n\", count)\n\n}\n</code></pre>\n\n<p><strong><em>Update 1</em></strong></p>\n\n<p>The following works.</p>\n\n<p>But this is as per my understanding using the result as *sql.Row and then retrieving  the result using scan.</p>\n\n<p>But I don't understand,why  <code>...Count(&amp;count)</code> is giving a run time error?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1562163239, "creation_date": 1562163239, "answer_id": 56872083, "question_id": 56871627, "link": "https://stackoverflow.com/questions/56871627/intialize-a-complex-json-struct-into-a-map-in-golang/56872083#56872083", "title": "Intialize a complex JSON struct into a map in Golang", "body": "<p>I succeed with this, that I find quite ugly.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>        // Prepare the data\n        var data = make(map[string]interface{})\n        var comments []map[string]map[string]string\n        var comment = make(map[string]map[string]string)\n        comment[\"add\"] = map[string]string{\n            \"body\": \"Test\",\n        }\n        comments = append(comments, comment)\n        var update = make(map[string]interface{})\n        update[\"comment\"] = comments\n        data[\"update\"] = update\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1562231173, "post_id": 56873892, "comment_id": 100316144, "body": "Thanks, saw some interesting stuff !"}], "tags": [], "owner": {"reputation": 362, "user_id": 11646003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2o1eJ.jpg?s=128&g=1", "display_name": "ladygremlin", "link": "https://stackoverflow.com/users/11646003/ladygremlin"}, "is_accepted": false, "score": 1, "last_activity_date": 1562169046, "creation_date": 1562169046, "answer_id": 56873892, "question_id": 56871627, "link": "https://stackoverflow.com/questions/56871627/intialize-a-complex-json-struct-into-a-map-in-golang/56873892#56873892", "title": "Intialize a complex JSON struct into a map in Golang", "body": "<p>Usually folks use <code>interface{}</code> and <code>Unmarshal()</code> for this!</p>\n\n<p>Check out some examples </p>\n\n<ul>\n<li><a href=\"https://blog.serverbooter.com/post/parsing-nested-json-in-go/\" rel=\"nofollow noreferrer\">here, for \"Parsing Deeply Nested JSON in Go\"</a></li>\n<li><a href=\"https://stackoverflow.com/questions/21268000/unmarshaling-nested-json-objects-in-golang\">here, for \"Unmarshaling nested JSON objects in Golang\"</a></li>\n<li><a href=\"https://endophage.com/post/golang-parse-to-interface/\" rel=\"nofollow noreferrer\">here, for \"Golang Parsing JSON into Interfaces\"</a></li>\n</ul>\n\n<p>Hope this helps! :)</p>\n"}, {"comments": [{"owner": {"reputation": 519, "user_id": 6680332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bkTG-Ocx05o/AAAAAAAAAAI/AAAAAAAAA2c/n6WLPcA4z5A/photo.jpg?sz=128", "display_name": "codenio", "link": "https://stackoverflow.com/users/6680332/codenio"}, "reply_to_user": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1562237812, "post_id": 56874597, "comment_id": 100319898, "body": "You could create a new map of type <code>map[string]Object</code> and assign the initialised <code>obj</code> var to it."}], "tags": [], "owner": {"reputation": 519, "user_id": 6680332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bkTG-Ocx05o/AAAAAAAAAAI/AAAAAAAAA2c/n6WLPcA4z5A/photo.jpg?sz=128", "display_name": "codenio", "link": "https://stackoverflow.com/users/6680332/codenio"}, "is_accepted": false, "score": 1, "last_activity_date": 1562239190, "last_edit_date": 1562239190, "creation_date": 1562171607, "answer_id": 56874597, "question_id": 56871627, "link": "https://stackoverflow.com/questions/56871627/intialize-a-complex-json-struct-into-a-map-in-golang/56874597#56874597", "title": "Intialize a complex JSON struct into a map in Golang", "body": "<p>You could create and initialise json object using the following format.</p>\n\n<pre><code>import (\n   \"fmt\",\n   \"encoding/json\"\n)\n\n\ntype Object struct {\n     Update Update `json:\"update\"`\n}\n\ntype Update struct {\n    Comments []Comment `json:\"comments\"`\n}\n\ntype Comment struct {\n    Add Add `json:\"add\"`\n}\n\ntype Add struct {\n    Body Body `json:\"body\"`\n}\n\ntype Body string\n\nfunc main() {\n    obj := make(map[string]Object)\n    obj[\"buzz\"] = Object{\n        Update: Update{\n            Comments: []Comment{\n                Comment{\n                    Add: Add{\n                         Body: \"foo\",\n                    },\n                },\n            },\n        },\n    }\n\n    fmt.Printf(\"%+v\\n\", obj)\n    obj2B, _ := json.Marshal(obj[\"buzz\"])\n    fmt.Println(string(obj2B))\n}\n</code></pre>\n\n<p>Initialised object obj would be</p>\n\n<pre><code>map[buzz:{Update:{Comments:[{Add:{Body:foo}}]}}]\n</code></pre>\n\n<p>Try this code available <a href=\"https://play.golang.org/p/rVBbc2T7z45\" rel=\"nofollow noreferrer\">here</a> \n.  For more detail, do refer this <a href=\"https://gobyexample.com/json\" rel=\"nofollow noreferrer\">article</a></p>\n"}], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562239190, "creation_date": 1562161623, "last_edit_date": 1562162905, "question_id": 56871627, "link": "https://stackoverflow.com/questions/56871627/intialize-a-complex-json-struct-into-a-map-in-golang", "title": "Intialize a complex JSON struct into a map in Golang", "body": "<p>I need to provide a <code>map[string]interface{}</code> to a function. The JSON that is behind is this one :</p>\n\n<pre><code>\n{\n   \"update\": {\n     \"comment\": [\n         {\n            \"add\": {\n               \"body\": \"this is a body\"\n            }\n         }\n      ]\n   }\n}\n</code></pre>\n\n<p>I am completely stuck. I tried with nested structs, with maps, with a mix of both, I just cannot see the solution of this simple thing..</p>\n\n<p>My last attempt is :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    // Prepare the data\n    var data = make(map[string]interface{})\n    var comments []map[string]map[string]string\n    var comment = make(map[string]map[string]string)\n    comment[\"add\"] = map[string]string{\n        \"body\": \"Test\",\n    }\n    comments = append(comments, comment)\n    data[\"update\"][\"comment\"] = comments\n</code></pre>\n"}, {"tags": ["docker", "ssl", "go", "proxy", "grpc"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1562159605, "post_id": 56870402, "comment_id": 100290661, "body": "Think about this objectively: if one could place a server in between a client and server TLS connection - relaying traffic in both directions - this would be the very definition of a man-in-middle. A TLS handshake cannot work through a proxy without knowing each party&#39;s private keys. And at that point end-to-end encryption is not guaranteed."}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1562159816, "post_id": 56870402, "comment_id": 100290800, "body": "Now that you say it out loud, that makes a lot of sense. I am, however, not skilled enough to understand now how to solve this. The proxy server also has the private key already so shouldn&#39;t it at least work, without guaranteed encryption?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1562160151, "post_id": 56870402, "comment_id": 100291033, "body": "I have run a reverse-proxy https server. Your client needs to use the trust cert, not of the the <i>server</i>, but of the <i>proxy</i> in the middle. And the proxy when relaying  to the server needs to have the trust cert of the server."}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1562160328, "post_id": 56870402, "comment_id": 100291155, "body": "@colminator havent heard of trust certificates before. Do i generate those too using openssl?"}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1562165301, "post_id": 56870402, "comment_id": 100294165, "body": "I created my own CA certificate and re-created the certs  against the CA. However, now I get the error <code>Transport: authentication handshake failed: context deadline exceeded</code>"}], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "edited": false, "score": 0, "creation_date": 1562173177, "post_id": 56872989, "comment_id": 100298290, "body": "Its starting to make a lot more sense to me. However I just cant figure out which certificates go where, it has all become a maze to me. Ill keep trying and mark this as answer later. Sounds and looks like the good answer, i just cant figure it out"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "edited": false, "score": 1, "creation_date": 1562179628, "post_id": 56872989, "comment_id": 100301100, "body": "This classic <a href=\"https://goodriddlesnow.com/riddles/view/605\" rel=\"nofollow noreferrer\">puzzle</a> helped me finally understand a TLS-handshake. Public &amp; private key terms are confusing. Within the context of the puzzle: if you think of a public-key as being the Lock; and the private key unlocks it; the concept becomes clearer.  If your client already has the server&#39;s Lock (public cert) - when it sends it a message - only that server can unlock it (as it has the private key for that lock)."}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "edited": false, "score": 1, "creation_date": 1562324649, "post_id": 56872989, "comment_id": 100348488, "body": "Just wanted to let you know, and others reading this. The code above solves my issues exactly as described, I was just as dumb as an egg to provide the wrong certificates (aka provide server key when CA was required). Thanks a bunch"}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 4, "last_activity_date": 1565123420, "last_edit_date": 1565123420, "creation_date": 1562165979, "answer_id": 56872989, "question_id": 56870402, "link": "https://stackoverflow.com/questions/56870402/gprc-behind-goproxy-returns-certificate-error-works-fine-without-proxy/56872989#56872989", "title": "gPRC behind goproxy returns certificate error, works fine without proxy", "body": "<p><strong><em>Background:</em></strong></p>\n\n<p>Each end of a TLS connection needs a pre-arranged trust. Most clients use the system trust chain when connecting to a remote host (GeoTrust, DigiCert CA's trusted certs are all listed there and allow you to safely get to sites like <a href=\"https://facebook.com\" rel=\"nofollow noreferrer\">https://facebook.com</a>, <a href=\"https://google.com\" rel=\"nofollow noreferrer\">https://google.com</a> etc.)</p>\n\n<p><code>go</code>, when using TLS, will default to the system-trust-chain when contacting servers. When developing custom solutions, chances are your application server's public cert is <em>not</em> in this system-trust-chain. So you have two options:</p>\n\n<ul>\n<li>Disable trust via <code>InsecureSkipVerify: true</code> (<a href=\"https://stackoverflow.com/a/47169975/1218512\">DON'T</a> do this!)</li>\n<li>add a custom trust to your client</li>\n</ul>\n\n<p>Most likely you application server has a self-signed certificate, so it's <a href=\"https://stackoverflow.com/a/10271238/1218512\">easy</a> to get the public cert portion of this.\nYou can also see a server's public certs using tools like <a href=\"https://superuser.com/a/176721/417258\">openssl</a> - using the linked solution you can grab public certs for not only your own development servers but any other remote service - just provide the hostname and port.</p>\n\n<hr>\n\n<p>So just to summarize your situation. You have:</p>\n\n<pre><code>Client &lt;- TLS -&gt; Server\n</code></pre>\n\n<p>But want:</p>\n\n<pre><code>Client &lt;-TLS-&gt; Proxy &lt;-TLS-&gt; Server\n</code></pre>\n\n<p>So your client now, instead of trusting the Server now needs to just trust the proxy instead - as it is only ever talking directly to the proxy.\nThe proxy will most likely have a self-signed cert (see above on how to extract the trust cert).\nOnce you have this, update your <code>go</code> code to use this custom trust-file like so:</p>\n\n<pre><code>// Get the SystemCertPool, continue with an empty pool on error\nrootCAs, err := x509.SystemCertPool() // &lt;- probably not needed, if we're only ever talking to this single proxy\nif err != nil || rootCAs == nil {\n    rootCAs = x509.NewCertPool()\n}\n\n// Read in the custom trust file\ncerts, err := ioutil.ReadFile(localTrustFile)\nif err != nil {\n    log.Fatalf(\"Failed to append %q to RootCAs: %v\", localTrustFile, err)\n}\n\n// Append our cert to the system pool\nif ok := rootCAs.AppendCertsFromPEM(certs); !ok {\n    log.Fatalf(\"failed to append custom cert\")\n}\n\ntlsConfig := &amp;tls.Config{\n    RootCAs: rootCAs,\n}\n</code></pre>\n\n<p>The proxy also will need to trust the server - so if the server's cert is not in the system-trust-chain, then it will need a similar tls.Config setup like above.</p>\n"}], "owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "accepted_answer_id": 56872989, "answer_count": 1, "score": 3, "last_activity_date": 1565123420, "creation_date": 1562157681, "question_id": 56870402, "link": "https://stackoverflow.com/questions/56870402/gprc-behind-goproxy-returns-certificate-error-works-fine-without-proxy", "title": "gPRC behind goproxy returns certificate error, works fine without proxy", "body": "<p>I have a gRPC client and server, both secured with an ssl certificate. Without a proxy inbetween these work great. As a test, when I purposely create faulty certificates it fails. Proving later in this post it's not a certificate issue.</p>\n\n<p>gRPC server code:</p>\n\n<pre><code>// Creates a new gRPC server\n// Create the TLS credentials\ncreds, err := credentials.NewServerTLSFromFile(\"configs/cert/servercert.pem\", \"configs/cert/serverkey.pem\")\nif err != nil {\n    log.Fatalf(\"could not load TLS keys: %s\", err)\n}\n// Create an array of gRPC options with the credentials\nopts := []grpc.ServerOption{grpc.Creds(creds)}\n// create a gRPC server object\ns := grpc.NewServer(opts...)\n</code></pre>\n\n<p>gRPC client code:</p>\n\n<pre><code>// Create the client TLS credentials\ncreds, err := credentials.NewClientTLSFromFile(\"configs/cert/servercert.pem\", \"\")\nif err != nil {\n    log.Fatalf(\"could not load tls cert: %s\", err)\n}\n\nconn, err := grpc.Dial(grpcUri, grpc.WithTransportCredentials(creds))\nif err != nil {\n    log.Fatalf(\"Unable to connect: %v\", err)\n}\n</code></pre>\n\n<p>now I am trying to use a forward proxy (which ive tested and works fine on normal HTTP api requests). However it constantly fails on gRPC requests through the proxy.</p>\n\n<p>I am using <a href=\"https://github.com/mrkschan/cuttle\" rel=\"nofollow noreferrer\">cuttle</a> which internally uses <a href=\"https://github.com/elazarl/goproxy\" rel=\"nofollow noreferrer\">goproxy</a> with the following setup. Do note that the <code>InsecureSkipVerify</code> boolean has been tried both <code>true</code> and <code>false</code>. With my (limited) understanding of SSL that this needs to be <code>false</code> as it will check online for the certificate, and these are self-signed so naturally it would fail. However, again, i tried both <code>true</code> and <code>false</code></p>\n\n<pre><code>// Config proxy.\nproxy := goproxy.NewProxyHttpServer()\nproxy.Tr = &amp;http.Transport{\n    // Config TLS cert verification.\n    TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: !cfg.TLSVerify},\n    Proxy:           http.ProxyFromEnvironment,\n}\n</code></pre>\n\n<p>Running a proxy between the gRPC client and server results in the following error: </p>\n\n<blockquote>\n  <p>transport: authentication handshake failed: x509: certificate signed\n  by unknown authority (possibly because of \"x509: invalid signature:\n  parent certificate cannot sign this kind of certificate\" while trying\n  to verify candidate authority certificate \"test server\"</p>\n</blockquote>\n\n<p>Which would indicate it's a certificate issue, however, gRPC works flawless without the proxy, as stated and tested earlier.</p>\n\n<p>also note: I dont want to run gRPC behind a proxy but am forced to due to development environment. The gRPC server and proxy run on the same docker machine. Having the same IP address would result in the following configuration which would just cancel each other out (trust me i tried anyway). </p>\n\n<pre><code>ENV http_proxy 192.168.99.100:3128\nENV https_proxy 192.168.99.100:3128\nENV no_proxy 192.168.99.100 # &lt;- this would be the gRPC server IP, which is the same as the proxy. resulting in nothing being run through a proxy.\n</code></pre>\n\n<p>Splitting the ip addressed in docker would solve this issue, however, I would learn nothing and would like to solve this. I tried configs like answered <a href=\"https://unix.stackexchange.com/questions/457953/how-to-specifiy-a-static-ip-address-with-docker-compose-yml-version-3?rq=1\">here</a> to set different docker internal IP's however, the ip would remain empty (only the network would be set) and accessing on the new IP would just timeout.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1562156962, "post_id": 56868675, "comment_id": 100288945, "body": "Have you tried: <code>bee pack -v -ba=&quot;-ldflags=&#39;-s -w&#39;&quot; </code>?"}, {"owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "reply_to_user": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1562157140, "post_id": 56868675, "comment_id": 100289039, "body": "@GiulioMicheloni see my update. Nothing changed"}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1562158128, "creation_date": 1562158128, "answer_id": 56870550, "question_id": 56868675, "link": "https://stackoverflow.com/questions/56868675/cant-use-ldflags-with-bee-pack-command/56870550#56870550", "title": "Can&#39;t use ldflags with bee pack command", "body": "<p>I checked the source code of bee tool. It should be a bug and I would open an issue into their GitHub repo.</p>\n\n<p>Here is the link to the relevant <a href=\"https://github.com/beego/bee/blob/10bb0454f641a6dcf9ebc9ce9efcc89822586012/cmd/commands/pack/pack.go#L511\" rel=\"nofollow noreferrer\">code</a>. Please, take a look at the comments below.</p>\n\n<pre><code>    args := []string{\"build\", \"-o\", binPath}\n    if len(buildArgs) &gt; 0 {\n        //Giulio: Here they split the input arguments using whitespace as delimiter.\n        //In your case it would become: \"-ldflags='-s -w'\" =&gt; [\"-ldflags='-s\", \"-w'\"]\n        args = append(args, strings.Fields(buildArgs)...)\n    }\n\n    if verbose {\n        //Giulio: The print is fine, reconstruct the same string with strings.Join\n        fmt.Fprintf(output, \"\\t%s%s+ go %s%s%s\\n\", \"\\x1b[32m\", \"\\x1b[1m\", strings.Join(args, \" \"), \"\\x1b[21m\", \"\\x1b[0m\")\n    }\n    //Giulio: but, here, they use the slice with splitted flags, i.e. [\"-ldflags='-s\", \"-w'\"], which is the real problem.\n    execmd := exec.Command(\"go\", args...)\n</code></pre>\n"}], "owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562158128, "creation_date": 1562151749, "last_edit_date": 1562157116, "question_id": 56868675, "link": "https://stackoverflow.com/questions/56868675/cant-use-ldflags-with-bee-pack-command", "title": "Can&#39;t use ldflags with bee pack command", "body": "<p>I'm trying to compile beego with ldflags options:</p>\n\n<pre><code>bee pack\u00a0-v -ba=\"-ldflags\u00a0'-s -w'\" \n</code></pre>\n\n<p>And go complains about it:</p>\n\n<pre><code>go build -o /var/folders/XXX/XXX/T/beePack-4329015000/XXXX -ldflags='-s -w'\ninvalid value \"'-s\" for flag -ldflags: missing =&lt;value&gt; in &lt;pattern&gt;=&lt;value&gt;\n</code></pre>\n\n<p>I'm using latest beego with go1.12.6. Looks like beego is separating the command line with <code>space</code> and added some checks.</p>\n\n<p>Any ideas?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>With -ldflags='-s -w'</p>\n\n<pre><code>GOOS=linux bee pack -v -exr=vendor -ba=\"-ldflags='-s -w'\"\n</code></pre>\n\n<p>I got:</p>\n\n<pre><code>+ go build -o /var/folders/xxx/xxx/T/beePack-2277518000/xxx -ldflags='-s -w'\ninvalid value \"'-s\" for flag -ldflags: missing =&lt;value&gt; in &lt;pattern&gt;=&lt;value&gt;\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code", "delve"], "comments": [{"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562269949, "post_id": 56868227, "comment_id": 100333567, "body": "I don\u2019t use vs code, but I would try <a href=\"https://medium.com/average-coder/how-to-debug-a-running-go-app-with-vscode-76e3eac45bd\" rel=\"nofollow noreferrer\">medium.com/average-coder/&hellip;</a> and <a href=\"https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl\" rel=\"nofollow noreferrer\">marketplace.visualstudio.com/&hellip;</a>"}, {"owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "reply_to_user": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562321511, "post_id": 56868227, "comment_id": 100347090, "body": "thanks, tried it for a few hours again but couldnt get it working yet. Not sure why but it seems to have something to do with VSCode messing up the cwd of the go program itself in WSL"}, {"owner": {"reputation": 422, "user_id": 1104688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b6d502a458eaf661e75953cc9eeb8a?s=128&d=identicon&r=PG", "display_name": "Nikhil Mittal", "link": "https://stackoverflow.com/users/1104688/nikhil-mittal"}, "edited": false, "score": 0, "creation_date": 1562445603, "post_id": 56868227, "comment_id": 100377636, "body": "Hi, I am also facing similar issue. Not able to connect to Delve debugger. the debugger console shows API server listening at: 127.0.0.1:2345 but nothing after that. Were you able to debug with Goland ?"}, {"owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "edited": false, "score": 0, "creation_date": 1562565526, "post_id": 56868227, "comment_id": 100399162, "body": "No it&#39;s not working yet. Will try sometimes when I find the time"}, {"owner": {"reputation": 3298, "user_id": 3394884, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/LqQhR.png?s=128&g=1", "display_name": "kuskmen", "link": "https://stackoverflow.com/users/3394884/kuskmen"}, "reply_to_user": {"reputation": 422, "user_id": 1104688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b6d502a458eaf661e75953cc9eeb8a?s=128&d=identicon&r=PG", "display_name": "Nikhil Mittal", "link": "https://stackoverflow.com/users/1104688/nikhil-mittal"}, "edited": false, "score": 0, "creation_date": 1573165436, "post_id": 56868227, "comment_id": 103803149, "body": "@NikhilMittal, I have the same issue, did you guys find out what is going on, are we missing something?"}, {"owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "edited": false, "score": 0, "creation_date": 1573197198, "post_id": 56868227, "comment_id": 103810541, "body": "updated answer. Any time now that WSL2 is released"}], "answers": [{"tags": [], "owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "is_accepted": true, "score": 3, "last_activity_date": 1573197132, "creation_date": 1573197132, "answer_id": 58762009, "question_id": 56868227, "link": "https://stackoverflow.com/questions/56868227/debugging-go-code-in-visual-studio-code-wsl/58762009#58762009", "title": "Debugging Go code in Visual Studio Code WSL", "body": "<p>Old post, but its not possible to get delve to work on WSL</p>\n\n<p><a href=\"https://github.com/go-delve/delve/issues/1235\" rel=\"nofollow noreferrer\">https://github.com/go-delve/delve/issues/1235</a></p>\n\n<p>There was a better resource that explains fully why it doesnt work, cant find it now</p>\n\n<p>Apparently it has something to do with WSL not implementing Linux fully...but it will in WSL2!</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux</a></p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1587053697, "creation_date": 1587053697, "answer_id": 61254952, "question_id": 56868227, "link": "https://stackoverflow.com/questions/56868227/debugging-go-code-in-visual-studio-code-wsl/61254952#61254952", "title": "Debugging Go code in Visual Studio Code WSL", "body": "<p>If you can switch to WSL2, <a href=\"https://github.com/microsoft/vscode-go/issues/2505#issuecomment-599800248\" rel=\"nofollow noreferrer\"><code>microsoft/vscode-go</code> issue 2505</a> confirms:</p>\n\n<blockquote>\n  <p>Since WSL2 is working with this, I think we can close the bug</p>\n</blockquote>\n\n<p>And <a href=\"https://devblogs.microsoft.com/commandline/wsl2-will-be-generally-available-in-windows-10-version-2004/\" rel=\"nofollow noreferrer\">WSL2 will be generally available in Windows 10, version 2004</a>.<br>\n<a href=\"https://www.neowin.net/news/windows-10-version-2004-is-coming---heres-what-you-need-to-know-about-it/\" rel=\"nofollow noreferrer\">Windows 10 version 2004 is \"20H1\"</a>, because it's being released in the first half of the year 2020.</p>\n"}], "owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2772, "favorite_count": 4, "accepted_answer_id": 58762009, "answer_count": 2, "score": 8, "last_activity_date": 1587053697, "creation_date": 1562150267, "last_edit_date": 1562681783, "question_id": 56868227, "link": "https://stackoverflow.com/questions/56868227/debugging-go-code-in-visual-studio-code-wsl", "title": "Debugging Go code in Visual Studio Code WSL", "body": "<p>I have a Visual Studio Code environment with the Linux Subsystem for windows running and it's compiling and running a Go project just fine.</p>\n\n<p>Now I'm trying to get the delve debugger running following this link:</p>\n\n<p><a href=\"https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code\" rel=\"noreferrer\">https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code</a></p>\n\n<p>But I can't get it running, neither remote nor local.</p>\n\n<p>Tried all kind of configurations in launch.json but breakpoints just arent hit and no error message is printed. </p>\n\n<p>Has anyone got go debugging running on VSCode using the WSL? </p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 1, "creation_date": 1562148519, "post_id": 56867536, "comment_id": 100284187, "body": "Have you tried putting AckRequest and DataRequest in the struct at same level as Version?  I the the Unmarshal will just fill in the ones that are there leaving the other zero (or if you use pointers to the structs they are left as nil pointers)."}, {"owner": {"reputation": 33, "user_id": 9333830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a6d46418b5979ec1a3ea0b57d6e7b2?s=128&d=identicon&r=PG&f=1", "display_name": "mocle", "link": "https://stackoverflow.com/users/9333830/mocle"}, "reply_to_user": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1562148926, "post_id": 56867536, "comment_id": 100284410, "body": "Thanks for the suggestion. This works in principle, but then I have to add all sorts of possible child elements at the level of <code>Version</code> (in real far more than 20) and when using the struct i need to querie every single one to find out which child element was present. Is there no better way? :("}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562196587, "post_id": 56867536, "comment_id": 100306570, "body": "There is. You can define the proper <code>UnmarshalXML</code> method on your outer tupe, <code>Request</code>\u2014to make it satisfy the <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshaler\" rel=\"nofollow noreferrer\"><code>Unmarshaler</code> interface</a>, and in it, use the lower-level <code>Decoder</code> interface to read the XML by tokens and dynamically switch processing based on the opening tag of a contained element."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9333830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a6d46418b5979ec1a3ea0b57d6e7b2?s=128&d=identicon&r=PG&f=1", "display_name": "mocle", "link": "https://stackoverflow.com/users/9333830/mocle"}, "edited": false, "score": 0, "creation_date": 1562327830, "post_id": 56867853, "comment_id": 100349886, "body": "Thanks for the suggestion. This works in principle, however, as written above, instead of the two possible child elements  (<code>DataRequest</code> and <code>AckRequest</code>), I actually have well over 20. With this suggestions I have to add all sorts of possible child elements as variables to the <code>Request</code> struct and when using the struct i need to querie every single variable to find out which child element was present."}], "tags": [], "owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "is_accepted": true, "score": 0, "last_activity_date": 1562148967, "last_edit_date": 1592644375, "creation_date": 1562148967, "answer_id": 56867853, "question_id": 56867536, "link": "https://stackoverflow.com/questions/56867536/how-to-unmarshaling-dynamic-xml-in-go/56867853#56867853", "title": "How to Unmarshaling dynamic XML in GO", "body": "<p>You can embed the <code>DataRequest</code> and <code>AckRequest</code> as pointers in the <code>Request</code> struct. This way you can check later if they are <code>nil</code> or not.</p>\n<pre><code>// XML: REQUEST.DATA\ntype DataRequest struct {\n    LData string `xml:&quot;DATA-L&quot;`\n}\n\n// XML: REQUEST.ACK\ntype AckRequest struct {\n    AckId int `xml:&quot;ACK-ID&quot;`\n}\n\ntype Request struct {\n    Version float32      `xml:&quot;version,attr&quot;`\n    Ack     *AckRequest  `xml:&quot;REQUEST.ACK&quot;`\n    Data    *DataRequest `xml:&quot;REQUEST.DATA&quot;`\n}\n\nfunc main() {\n    message := `&lt;PROTO version=&quot;1.00&quot;&gt;&lt;REQUEST.ACK&gt;&lt;ACK-ID&gt;1&lt;/ACK-ID&gt;&lt;/REQUEST.ACK&gt;&lt;/PROTO&gt;`\n    proto := &amp;Request{}\n    err := xml.Unmarshal([]byte(message), &amp;proto)\n    if err != nil {\n        fmt.Printf(&quot;error: %v&quot;, err)\n        return\n    }\n    // if proto.Ack == nil {\n    //   fmt.Println(&quot;Ack is nil&quot;)\n    // }\n    fmt.Printf(&quot;data %+v\\n&quot;, proto)\n    fmt.Printf(&quot;data %+v\\n&quot;, proto.Ack)\n}\n</code></pre>\n<blockquote>\n<p>data &amp;{Version:1 Ack:0xc0000b6050 Data:}</p>\n<p>data &amp;{AckId:1}</p>\n</blockquote>\n<p>You can also implement your own decoder and do dynamic type switching <a href=\"https://stackoverflow.com/a/33517875/1199408\">https://stackoverflow.com/a/33517875/1199408</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 9333830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a6d46418b5979ec1a3ea0b57d6e7b2?s=128&d=identicon&r=PG&f=1", "display_name": "mocle", "link": "https://stackoverflow.com/users/9333830/mocle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 56867853, "answer_count": 1, "score": -1, "last_activity_date": 1562328060, "creation_date": 1562147992, "last_edit_date": 1562328060, "question_id": 56867536, "link": "https://stackoverflow.com/questions/56867536/how-to-unmarshaling-dynamic-xml-in-go", "title": "How to Unmarshaling dynamic XML in GO", "body": "<p>I try to parse XML using Go, which is used to exchange data with another system. I am aware how parsing with the xml.Unmarshal function works in principle. However, in the protocol the child element of the root element <code>&lt;PROTO&gt;</code> vary (see the examples below). For the child elements (<code>REQUEST.DATA</code>, <code>REQUEST.ACL</code>, <code>REQUEST.NAC</code>, ... - far more than twenty different) I have defined structs with <code>xml:...</code>-syntax so far - the parsing of these single child elements works. </p>\n\n<p>But, is there a nice way to parse the whole message as a struct, where one varible type depends on the child element? For example with using an interface?</p>\n\n<p>Example of possible XML messages:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;PROTO\n   version=\"1.00\"&gt;\n  &lt;REQUEST.DATA&gt;\n    &lt;DATA-L&gt;Some information&lt;/DATA-L&gt;\n  &lt;/REQUEST.DATA&gt;\n&lt;/PROTO&gt;\n</code></pre>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;PROTO\n   version=\"1.00\"&gt;\n  &lt;REQUEST.ACK&gt;\n    &lt;ACK-ID&gt;1&lt;/ACK-ID&gt;\n  &lt;REQUEST.ACK&gt;\n&lt;/PROTO&gt;\n</code></pre>\n\n<p>Snippets from my Go application:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// XML: REQUEST.DATA\ntype DataRequest struct {\n    LData string `xml:\"DATA-L\"`\n}\n\n// XML: REQUEST.ACK\ntype AckRequest struct {\n    AckId int `xml:\"ACK-ID\"`\n}\n\n// XML: PROTO  &lt;============= ??\ntype Request struct {\n    Version float32  `xml:\"version,attr\"`\n    RemoteRequest {AckRequest, DataRequest, ...} ????\n}\n\nfunc main() {\n    message := `&lt;PROTO version=\"1.00\"&gt;&lt;REQUEST.ACK&gt;&lt;ACK-ID&gt;1&lt;/ACK-ID&gt;&lt;REQUEST.ACK&gt;&lt;/PROTO&gt;`\n    data := `&lt;REQUEST.ACK&gt;&lt;ACK-ID&gt;1&lt;/ACK-ID&gt;&lt;REQUEST.ACK&gt;`\n    doc := &amp;AckRequest{}\n    err := xml.Unmarshal([]byte(data), &amp;doc)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        return\n    }\n    fmt.Printf(\"data %+v\", doc)\n}\n</code></pre>\n\n<p>Instead of just parsing the child element <code>data</code> I want to parse the whole document <code>message</code> (<code>&lt;PROTO&gt;</code> involved). And want have a structure that contains the information of the respective child element.</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-helm", "helmfile"], "comments": [{"owner": {"reputation": 519, "user_id": 6680332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bkTG-Ocx05o/AAAAAAAAAAI/AAAAAAAAA2c/n6WLPcA4z5A/photo.jpg?sz=128", "display_name": "codenio", "link": "https://stackoverflow.com/users/6680332/codenio"}, "edited": false, "score": 0, "creation_date": 1562175693, "post_id": 56867201, "comment_id": 100299398, "body": "It is not advisable to store BD passwords inside helm values.yaml file. instead create a secret object containing DB passwords in their respective namspaces and attach them to the pods."}], "answers": [{"tags": [], "owner": {"reputation": 3237, "user_id": 9741769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b0913fe3d348f510777caaf5540169?s=128&d=identicon&r=PG&f=1", "display_name": "Blokje5", "link": "https://stackoverflow.com/users/9741769/blokje5"}, "is_accepted": false, "score": 1, "last_activity_date": 1562154881, "creation_date": 1562154881, "answer_id": 56869575, "question_id": 56867201, "link": "https://stackoverflow.com/questions/56867201/is-there-a-way-to-include-the-namespace-inside-a-value/56869575#56869575", "title": "Is there a way to include the namespace inside a value?", "body": "<p>As Helm is based on the Go-template language, the functions availabe in the go-template language can be of help:</p>\n\n<pre><code>{{ index .Values.db .Release.Namespace }}\n</code></pre>\n\n<p>From the docs (go-template docs):</p>\n\n<blockquote>\n  <p>index\n      Returns the result of indexing its first argument by the\n      following arguments. Thus \"index x 1 2 3\" is, in Go syntax,\n      x[1][2][3]. Each indexed item must be a map, slice, or array.</p>\n</blockquote>\n\n<p>so in this case you index <code>.Values.db</code> with the key <code>.Release.Namespace</code></p>\n"}], "owner": {"reputation": 21, "user_id": 11733522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8S9845MKk_E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKHjOtDz1Ig_E4u5JfCNu-eZfH3A/photo.jpg?sz=128", "display_name": "Anthony Roux", "link": "https://stackoverflow.com/users/11733522/anthony-roux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562154881, "creation_date": 1562146808, "last_edit_date": 1562154510, "question_id": 56867201, "link": "https://stackoverflow.com/questions/56867201/is-there-a-way-to-include-the-namespace-inside-a-value", "title": "Is there a way to include the namespace inside a value?", "body": "<p>I have got several namespaces (iso, dev, sandbox, etc.) which correspond to my different environments. For each environment and thus namespace, there is an associated db.\nWhen I deploy my pod with Helm, I would like to inject the namespace inside a value to get the appropriate password . </p>\n\n<p>In my values file I have something that looks like this :</p>\n\n<pre><code>db:\n  iso: passwordISO\n  dev: passwordDEV\n  sandbox: passwordSANDBOX\n  spec: passwordSPEC\n  val: passwordVAL\n</code></pre>\n\n<p>and in my consumer_config file I have this :</p>\n\n<pre><code>  db_host: DB_HOST-{{ .Release.Namespace }}\n  db_port: DB_PORT\n  db_name: DB_NAME\n  db_user: DB_PORT\n  db_password: {{ .Values.db.iso }}\n</code></pre>\n\n<p>I already tried to use the <code>{{- include }}</code> pattern but with no success. I also tried <code>{{ .Values.db.{{ .Release.Namespace }}}}</code> giving me the following error <code>unexpected &lt;.&gt; in operand</code></p>\n\n<p>Any insight on how to do this or any workaround ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 1, "creation_date": 1562147934, "post_id": 56864169, "comment_id": 100283809, "body": "Since the dawn of time (1/1/1970) C programmers have been using <code>printf(s)</code> rather than printf(&quot;%s&quot;, s) or just puts(s).  In Go you can use os.Stdout.WriteString(b)."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1562150620, "post_id": 56864345, "comment_id": 100285277, "body": "@jibin-mathews, notice the naming pattern of the functions in <code>fmt</code>: they are named like <code>[f|s]print[f|ln]</code> (modulo title character casing); the root verb is obviously &quot;print&quot;, the prefix, if present, designates where the result is output: means &quot;file&quot; when it&#39;s &quot;f&quot; and &quot;string&quot; when it&#39;s &quot;s&quot;; if the prefix is absent, the output is the standard output stream of the running process. The suffix, if present, controls treatment ot the input: &quot;f&quot; stands for &quot;formatted&quot; and means the 1st argument\u2014the string\u2014is not taken verbatim but is scanned for specal placeholders\u2026"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562150705, "post_id": 56864345, "comment_id": 100285310, "body": "\u2026 &quot;ln&quot; means &quot;line&quot; and makes sure a full line, terminated with the line feed character is output. The naming of the scanning family of functions basically follows the same pattern. All-in-all, contemplating <code>go doc fmt</code> is highly advised."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 7, "last_activity_date": 1562136215, "creation_date": 1562136215, "answer_id": 56864345, "question_id": 56864169, "link": "https://stackoverflow.com/questions/56864169/make-fmt-sprintf-not-to-replace-s-in-variables/56864345#56864345", "title": "Make fmt.sprintf not to replace %s in variables", "body": "<pre><code>a := \"%shello%s\"\nb:= fmt.Sprintf(\"%sWorld\",a)\n</code></pre>\n\n<p>This works just fine, it results in a string being <code>\"%shello%sWorld\"</code>.</p>\n\n<p>The problem is with how you print it:</p>\n\n<pre><code>fmt.Printf(b)\n</code></pre>\n\n<p><strong><a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"noreferrer\"><code>fmt.Printf()</code></a> treats <code>b</code> as a format string</strong>, and since <code>b</code>'s value contains <code>%s</code>, this expects you to also pass arguments (which you haven't), so the actual output contains error messages.</p>\n\n<p>Instead print it with <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"noreferrer\"><code>fmt.Println()</code></a>:</p>\n\n<pre><code>fmt.Println(b)\n</code></pre>\n\n<p>And output will be (try it on the <a href=\"https://play.golang.org/p/bRbaVAIkEPd\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>%shello%sWorld\n</code></pre>\n"}], "owner": {"reputation": 923, "user_id": 4735706, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/550c63615be76b768e5b8b271f2657e0?s=128&d=identicon&r=PG&f=1", "display_name": "Jibin Mathews", "link": "https://stackoverflow.com/users/4735706/jibin-mathews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1562156136, "creation_date": 1562135441, "last_edit_date": 1562156136, "question_id": 56864169, "link": "https://stackoverflow.com/questions/56864169/make-fmt-sprintf-not-to-replace-s-in-variables", "title": "Make fmt.sprintf not to replace %s in variables", "body": "<p>If I wanted to do the following:</p>\n\n<pre><code>    a := \"%shello%s\"\n    b:= fmt.Sprintf(\"%sWorld\",a)\n    fmt.Printf(b)\n</code></pre>\n\n<p>I want to print</p>\n\n<pre><code> %shello%sWorld\n</code></pre>\n\n<p>ie  %s is replaced only in %sWorld.</p>\n\n<p>How can i do that? </p>\n\n<p>I do not want to replace a with <code>%%shello%%s</code></p>\n"}, {"tags": ["sockets", "unix", "go", "file-descriptor"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 2, "creation_date": 1562130752, "post_id": 56862705, "comment_id": 100275657, "body": "<code>net.Listen(&quot;unix&quot;, &quot;.&#47;my.sock&quot;)</code> perfectly creates <code>my.sock</code> in the working directory, whereas <code>net.Dial(&quot;unix&quot;, &quot;&#47;path&#47;to&#47;my.sock&quot;)</code> perfectly connects too said socket. While you imho correctly assume that <code>os.ModeSocket</code> is intended for low level operations - why make your life harder by using them?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562161397, "post_id": 56862705, "comment_id": 100291839, "body": "<i>Why</i> do you want to implement it using <code>OpenFile</code>, when <code>Listen</code>/<code>Dial</code> is the provided mechanism for this purpose?"}, {"owner": {"reputation": 193, "user_id": 1477586, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8015f8f4bb13e606054262a84610c7fb?s=128&d=identicon&r=PG", "display_name": "fuzzybear3965", "link": "https://stackoverflow.com/users/1477586/fuzzybear3965"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562172889, "post_id": 56862705, "comment_id": 100298130, "body": "@MarkusWMahlberg and @Adrian, it&#39;s not that  <i>want</i> to use <code>OpenFile</code> to generate a socket as much as I <i>expected</i> that <code>OpenFile</code> would return a socket that I could write to and read from. But, that didn&#39;t work. I&#39;m just wondering what the effect of <code>os.ModeSocket</code> is in creating the file if it&#39;s not to set the flag on a file that the OS uses to determine whether or not that flag is a UNIX domain socket."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562175071, "post_id": 56862705, "comment_id": 100299128, "body": "Dig into the source code of <code>Listen</code> and <code>Dial</code>, respectively,then. It usually is a rather interesting journey."}, {"owner": {"reputation": 193, "user_id": 1477586, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8015f8f4bb13e606054262a84610c7fb?s=128&d=identicon&r=PG", "display_name": "fuzzybear3965", "link": "https://stackoverflow.com/users/1477586/fuzzybear3965"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562175401, "post_id": 56862705, "comment_id": 100299286, "body": "Honestly, that&#39;s what prompted this question. I dug into the call stacks of both methods, saw no relationship between them (independent <code>syscall</code>s), got confused, got on StackOverflow, started talking with @MarkusWMahlberg and co."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 1477586, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8015f8f4bb13e606054262a84610c7fb?s=128&d=identicon&r=PG", "display_name": "fuzzybear3965", "link": "https://stackoverflow.com/users/1477586/fuzzybear3965"}, "edited": false, "score": 0, "creation_date": 1562174716, "post_id": 56868093, "comment_id": 100298958, "body": "As <code>OpenFile</code> is a generalized API for opening files, is there a way to use <code>OpenFile</code> with <code>os.ModeSocket</code> in order to work with a UNIX socket? You can cast my question in the frame of an academic problem requiring you to author a <code>func Listen(name string)</code> that depends only on <code>os</code> and not on <code>net</code>."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 193, "user_id": 1477586, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8015f8f4bb13e606054262a84610c7fb?s=128&d=identicon&r=PG", "display_name": "fuzzybear3965", "link": "https://stackoverflow.com/users/1477586/fuzzybear3965"}, "edited": false, "score": 0, "creation_date": 1562185189, "post_id": 56868093, "comment_id": 100303295, "body": "@fuzzybear3965 From an academic approach, one could argue (and I strongly agree), that Unix domain sockets provide network like communications without the necessity of having a network stack involved."}, {"owner": {"reputation": 193, "user_id": 1477586, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8015f8f4bb13e606054262a84610c7fb?s=128&d=identicon&r=PG", "display_name": "fuzzybear3965", "link": "https://stackoverflow.com/users/1477586/fuzzybear3965"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562194524, "post_id": 56868093, "comment_id": 100306142, "body": "@MarkusWMahlberg I completely agree. The question remains, then, as to why I need to use <code>net.Listen</code> in order to implement a UNIX domain socket since, as you said, UNIX domain sockets provide network-like communications without requiring TCP. I would think I could rely solely on file descriptors and the OS file API implemented in the <code>os</code> package in order to implement and use UNIX domain sockets."}], "tags": [], "owner": {"reputation": 1041, "user_id": 2660313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7f4cadd6658af696e1d975eda49c49?s=128&d=identicon&r=PG", "display_name": "owlwalks", "link": "https://stackoverflow.com/users/2660313/owlwalks"}, "is_accepted": true, "score": 3, "last_activity_date": 1562149838, "creation_date": 1562149838, "answer_id": 56868093, "question_id": 56862705, "link": "https://stackoverflow.com/questions/56862705/using-os-openfile-instead-of-net-listen/56868093#56868093", "title": "Using os.OpenFile() instead of net.Listen()", "body": "<ol>\n<li><p>No. <code>OpenFile</code> is a generalized api for opening file, use <code>net.Listen(\"unixpacket\", \"f.sock\")</code> or <code>net.Dial(\"unixpacket\", \"f.sock\")</code> if you wanna work with unix socket</p></li>\n<li><p><code>os.ModeSocket</code> is just a *nix registered flag for socket fd, use when you want to filter fd types</p></li>\n</ol>\n"}], "owner": {"reputation": 193, "user_id": 1477586, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8015f8f4bb13e606054262a84610c7fb?s=128&d=identicon&r=PG", "display_name": "fuzzybear3965", "link": "https://stackoverflow.com/users/1477586/fuzzybear3965"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 56868093, "answer_count": 1, "score": -2, "last_activity_date": 1562149838, "creation_date": 1562126133, "question_id": 56862705, "link": "https://stackoverflow.com/questions/56862705/using-os-openfile-instead-of-net-listen", "title": "Using os.OpenFile() instead of net.Listen()", "body": "<p>I've dived into the call stack of both <code>os.OpenFile</code> and <code>net.Listen</code> to see if I can make a UNIX domain socket using <code>os.OpenFile</code>. Below is my attempt. But, after tracing both call stacks (<code>os.OpenFile</code>'s and <code>net.Listen</code>'s) I'm still confused. The below code doesn't read from the file, apparently, and stores the data to the filesystem.</p>\n\n<ol>\n<li>How can I implement a UNIX domain socket using <code>os.OpenFile</code>? </li>\n<li>What is the purpose of <code>os.ModeSocket</code> if it's not to be used with <code>os.OpenFile</code> to create a UNIX socket?</li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    sock, err := os.OpenFile(\"f.sock\", os.O_RDWR|os.O_CREATE, os.ModeSocket|os.ModePerm)\n    defer sock.Close()\n    if err != nil {\n        log.Panic(err)\n    }\n    n, err := sock.WriteString(\"hello\\n\")\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Println(n)\n    }\n    b := make([]byte, 10)\n    n, err = sock.Read(b)\n    fmt.Println(n)\n    if err != nil {\n        fmt.Println(\"error reading: \", err)\n    }\n    fmt.Println(b)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1562132262, "post_id": 56861677, "comment_id": 100276052, "body": "BYO listener or <code>for { c, err := dial(addr);  if err != nil { c.Close(); break; }; time.Sleep(time.Second&#47;10) }</code>"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 1, "creation_date": 1562157164, "post_id": 56861677, "comment_id": 100289049, "body": "I made a utility to help poll services (inter-process) in order to detect when they are ready <a href=\"https://github.com/dm03514/wait-for\" rel=\"nofollow noreferrer\">github.com/dm03514/wait-for</a>,  This is similar to the solution that Agis suggests"}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1562223449, "post_id": 56865986, "comment_id": 100312191, "body": "This is what I ended up adopting: I was working to avoid a non-deterministic sleep (e.g. sleeping for 5 * time.Second), but I implemented a simple wait w/ an exponential back-off before returning a usable test server type. Thanks!"}], "tags": [], "owner": {"reputation": 29080, "user_id": 1242778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKoAV.jpg?s=128&g=1", "display_name": "Agis", "link": "https://stackoverflow.com/users/1242778/agis"}, "is_accepted": true, "score": 2, "last_activity_date": 1562143089, "last_edit_date": 1562143089, "creation_date": 1562142679, "answer_id": 56865986, "question_id": 56861677, "link": "https://stackoverflow.com/questions/56861677/synchronizing-a-test-server-during-tests/56865986#56865986", "title": "Synchronizing a Test Server During Tests", "body": "<p>You can just attempt to connect to the server <em>before</em> starting the test suite, as part of the initialization process.</p>\n\n<p>For example, I usually have a function like this in my tests:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// waitForServer attempts to establish a TCP connection to localhost:&lt;port&gt;\n// in a given amount of time. It returns upon a successful connection; \n// ptherwise exits with an error.\nfunc waitForServer(port string) {\n    backoff := 50 * time.Millisecond\n\n    for i := 0; i &lt; 10; i++ {\n        conn, err := net.DialTimeout(\"tcp\", \":\"+port, 1*time.Second)\n        if err != nil {\n            time.Sleep(backoff)\n            continue\n        }\n        err = conn.Close()\n        if err != nil {\n            log.Fatal(err)\n        }\n        return\n    }\n    log.Fatalf(\"Server on port %s not up after 10 attempts\", port)\n}\n</code></pre>\n\n<p>Then in my <a href=\"https://golang.org/pkg/testing/#hdr-Main\" rel=\"nofollow noreferrer\"><code>TestMain()</code></a> I do:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func TestMain(m *testing.M) {\n    go startServer()\n    waitForServer(serverPort)\n\n    // run the suite\n    os.Exit(m.Run())\n}\n</code></pre>\n"}], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 56865986, "answer_count": 1, "score": 1, "last_activity_date": 1562143089, "creation_date": 1562115992, "last_edit_date": 1562116671, "question_id": 56861677, "link": "https://stackoverflow.com/questions/56861677/synchronizing-a-test-server-during-tests", "title": "Synchronizing a Test Server During Tests", "body": "<p><strong>Summary</strong>: I'm running into a race condition during testing where my server is not reliably ready to serve requests before making client requests against it. How can I block only until the listener is ready, and still maintain composable public APIs without requiring users to BYO <code>net.Listener</code>?</p>\n\n<p>We see the following error as the goroutine that spins up our (blocking) server in the background isn't listening before we call <code>client.Do(req)</code> in the <code>TestRun</code> test function.</p>\n\n<pre><code>--- FAIL: TestRun/Server_accepts_HTTP_requests (0.00s)\n        /home/matt/repos/admission-control/server_test.go:64: failed to make a request: Get https://127.0.0.1:37877: dial tcp 127.0.0.1:37877: connect: connection refused\n</code></pre>\n\n<ul>\n<li>I'm not using <code>httptest.Server</code> directly as I'm attempting to test the blocking &amp; cancellation characteristics of my own server componenent.</li>\n<li>I create an <code>httptest.NewUnstartedServer</code>, clone its <code>*tls.Config</code> into a new <code>http.Server</code> after starting it with <code>StartTLS()</code>, and then close it, before calling <code>*AdmissionServer.Run()</code>. This also has the benefit of giving me a <code>*http.Client</code> with the matching RootCAs configured.</li>\n<li>Testing TLS is important here as the daemon this exposes lives in a TLS-only environment.</li>\n</ul>\n\n<pre><code>func newTestServer(ctx context.Context, t *testing.T) *httptest.Server {\n    testHandler := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        fmt.Fprintln(w, \"OK\")\n    })\n\n    testSrv := httptest.NewUnstartedServer(testHandler)\n    admissionServer, err := NewServer(nil, &amp;noopLogger{})\n    if err != nil {\n        t.Fatalf(\"admission server creation failed: %s\", err)\n        return nil\n    }\n\n    // We start the test server, copy its config out, and close it down so we can\n    // start our own server. This is because httptest.Server only generates a\n    // self-signed TLS config after starting it.\n    testSrv.StartTLS()\n    admissionServer.srv = &amp;http.Server{\n        Addr:      testSrv.Listener.Addr().String(),\n        Handler:   testHandler,\n        TLSConfig: testSrv.TLS.Clone(),\n    }\n    testSrv.Close()\n\n    // We need a better synchronization primitive here that doesn't block\n    // but allows the underlying listener to be ready before \n    // serving client requests.\n    go func() {\n        if err := admissionServer.Run(ctx); err != nil {\n            t.Fatalf(\"server returned unexpectedly: %s\", err)\n        }\n    }()\n\n    return testSrv\n}\n</code></pre>\n\n<pre><code>// Test that we can start a minimal AdmissionServer and handle a request.\nfunc TestRun(t *testing.T) {\n    testSrv := newTestServer(context.TODO(), t)\n\n    t.Run(\"Server accepts HTTP requests\", func(t *testing.T) {\n        client := testSrv.Client()\n        req, err := http.NewRequest(http.MethodGet, testSrv.URL, nil)\n        if err != nil {\n            t.Fatalf(\"request creation failed: %s\", err)\n        }\n\n        resp, err := client.Do(req)\n        if err != nil {\n            t.Fatalf(\"failed to make a request: %s\", err)\n        }\n\n    // Later sub-tests will test cancellation propagation, signal handling, etc.\n</code></pre>\n\n<hr>\n\n<p>For posterity, this is our composable <code>Run</code> function, that listens in a goroutine and then blocks on our cancellation &amp; error channels in a <code>for-select</code>:</p>\n\n<pre><code>type AdmissionServer struct {\n    srv         *http.Server\n    logger      log.Logger\n    GracePeriod time.Duration\n}\n\nfunc (as *AdmissionServer) Run(ctx context.Context) error {\n    sigChan := make(chan os.Signal, 1)\n    defer close(sigChan)\n    signal.Notify(sigChan, os.Interrupt, syscall.SIGTERM)\n\n    // run in goroutine\n    errs := make(chan error)\n    defer close(errs)\n    go func() {\n        as.logger.Log(\n            \"msg\", fmt.Sprintf(\"admission control listening on '%s'\", as.srv.Addr),\n        )\n        if err := as.srv.ListenAndServeTLS(\"\", \"\"); err != nil &amp;&amp; err != http.ErrServerClosed {\n            errs &lt;- err\n            as.logger.Log(\n                \"err\", err.Error(),\n                \"msg\", \"the server exited\",\n            )\n            return\n        }\n        return\n    }()\n\n    // Block indefinitely until we receive an interrupt, cancellation or error\n    // signal.\n    for {\n        select {\n        case sig := &lt;-sigChan:\n            as.logger.Log(\n                \"msg\", fmt.Sprintf(\"signal received: %s\", sig),\n            )\n            return as.shutdown(ctx, as.GracePeriod)\n        case err := &lt;-errs:\n            as.logger.Log(\n                \"msg\", fmt.Sprintf(\"listener error: %s\", err),\n            )\n            // We don't need to explictly call shutdown here, as\n            // *http.Server.ListenAndServe closes the listener when returning an error.\n            return err\n        case &lt;-ctx.Done():\n            as.logger.Log(\n                \"msg\", fmt.Sprintf(\"cancellation received: %s\", ctx.Err()),\n            )\n            return as.shutdown(ctx, as.GracePeriod)\n        }\n    }\n}\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>There is a (simple) constructor for an <code>*AdmissionServer</code>: I've left it out for brevity. The <code>AdmissionServer</code> is composable and accepts a <code>*http.Server</code> so that it can be plugged into existing applications easily.</li>\n<li>The wrapped <code>http.Server</code> type that we create a listener from doesn't itself expose any way to tell if its listening; at best we can try to listen again and catch the error (e.g. port already bound to another listener), which does not seem robust as the <code>net</code> package doesn't expose a useful typed error for this.</li>\n</ul>\n"}, {"tags": ["sorting", "go"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "edited": false, "score": 0, "creation_date": 1562117618, "post_id": 56861711, "comment_id": 100273139, "body": "Thank you! I&#39;ll definitely look into those!"}, {"owner": {"reputation": 362, "user_id": 11646003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2o1eJ.jpg?s=128&g=1", "display_name": "ladygremlin", "link": "https://stackoverflow.com/users/11646003/ladygremlin"}, "reply_to_user": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "edited": false, "score": 0, "creation_date": 1562125357, "post_id": 56861711, "comment_id": 100274421, "body": "If this answer ends up helping/working, can you mark it as accepted for thoroughness&#39;s sake? :)"}], "tags": [], "owner": {"reputation": 362, "user_id": 11646003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2o1eJ.jpg?s=128&g=1", "display_name": "ladygremlin", "link": "https://stackoverflow.com/users/11646003/ladygremlin"}, "is_accepted": true, "score": 3, "last_activity_date": 1562116429, "creation_date": 1562116429, "answer_id": 56861711, "question_id": 56861610, "link": "https://stackoverflow.com/questions/56861610/how-to-sort-a-list-of-structs-based-on-the-lastname-variable-of-the-struct/56861711#56861711", "title": "How to sort a list of structs based on the lastName variable of the struct", "body": "<p>So since you <em>have</em> to use a golang list, I'd recommend looking into</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/container/list/\" rel=\"nofollow noreferrer\">The <code>list</code> documentation for Go</a>, especially the functions that move elements</li>\n<li><a href=\"http://www.golangprograms.com/golang-program-for-implementation-of-linked-list.html\" rel=\"nofollow noreferrer\">Linked lists in Go</a></li>\n<li>Different ways to sort linked lists, like <a href=\"https://www.geeksforgeeks.org/merge-sort-for-linked-list/\" rel=\"nofollow noreferrer\">merge sort</a></li>\n</ul>\n\n<p>Solutions involving slices likely won't help you since you'll have to do linked list comparisons (and Go's implementation of lists is a little complicated!) Another hint: you'll likely have to do <code>for loop</code> iterations, so expect some O(n^2) complexity. </p>\n\n<p>Hope this helps! :)</p>\n"}], "owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56861711, "answer_count": 1, "score": 2, "last_activity_date": 1562116429, "creation_date": 1562115167, "question_id": 56861610, "link": "https://stackoverflow.com/questions/56861610/how-to-sort-a-list-of-structs-based-on-the-lastname-variable-of-the-struct", "title": "How to sort a list of structs based on the lastName variable of the struct", "body": "<p>Before you ask, yes, I must use a list. I can not use a slice or anything else.\nSo, I have a list full of structures, but the list needs to be sorted based on the lastname variable of the struct. I've tinkered with things but ultimately have nothing to show for it. I'm not asking for an answer, but just some guidance in the right direction. Any help would be appreciated!</p>\n"}, {"tags": ["go", "tcplistener"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562118731, "post_id": 56861556, "comment_id": 100273304, "body": "Start a reading and writing goroutine for each connection.  See <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"nofollow noreferrer\">gorilla chat</a> for an example.  The example uses WebSockets, but can easily be converted to use TCP."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1562150779, "post_id": 56861556, "comment_id": 100285353, "body": "Related: <a href=\"https://stackoverflow.com/questions/38565654/golang-net-conn-write-in-parallel\" title=\"golang net conn write in parallel\">stackoverflow.com/questions/38565654/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1562150559, "creation_date": 1562150559, "answer_id": 56868310, "question_id": 56861556, "link": "https://stackoverflow.com/questions/56861556/relay-data-between-two-different-tcp-clients-in-golang/56868310#56868310", "title": "Relay data between two different tcp clients in golang", "body": "<p><a href=\"https://golang.org/pkg/net/#Conn\" rel=\"nofollow noreferrer\">The documentation for net.Conn</a> clearly states: </p>\n\n<blockquote>\n  <p>Multiple goroutines may invoke methods on a Conn simultaneously.</p>\n</blockquote>\n\n<p>So yes, it is okay to simply Write to the connections. You should take care to issue a single Write call per message you want to send. If you call Write more than once you risk interleaving messages from different mobile devices. This implies calling Write directly and not via some other API (in other words don't wrap the connection). For instance, the following would <em>not</em> be safe:</p>\n\n<pre><code>json.NewEncoder(conn).Encode(myValue) // use json.Marshal(myValue) instead\nio.Copy(conn, src)                    // use io.ReadAll(src) instead\n</code></pre>\n"}], "owner": {"reputation": 15271, "user_id": 133747, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6703c5e8fecd2b0d0d3e137bcff7c61e?s=128&d=identicon&r=PG", "display_name": "huggie", "link": "https://stackoverflow.com/users/133747/huggie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 56868310, "answer_count": 1, "score": 1, "last_activity_date": 1562150559, "creation_date": 1562114580, "last_edit_date": 1562115088, "question_id": 56861556, "link": "https://stackoverflow.com/questions/56861556/relay-data-between-two-different-tcp-clients-in-golang", "title": "Relay data between two different tcp clients in golang", "body": "<p>I'm writing a TCP server which simultaneously accepts multiple connections from mobile devices and some WiFi devices (IOT). The connections needs to be maintained once established, with the 30 seconds timeout if there is no heartbeat received. So it is something like the following:</p>\n\n<pre><code>// clientsMap map[string] conn\n\nfunc someFunction() {\n    conn, err := s.listener.Accept()\n    // I store the conn in clientsMap\n    // so I can access it, for brevity not \n    // shown here, then:\n    go serve(connn)\n}\n\nfunc serve(conn net.Conn) {\n    timeoutDuration := 30 * time.Second\n    conn.SetReadDeadline(time.Now().Add(timeoutDuration))\n    for {\n        msgBuffer := make([]byte, 2048)\n        msgBufferLen, err := conn.Read(msgBuffer)\n        // do something with the stuff\n    }\n}\n</code></pre>\n\n<p>So there is one goroutine for each client. And each client, once connected to the server, is pending on the read. The server then processes the stuff read.</p>\n\n<p>The problem is that I sometimes need to read things off one client, and then pass data to another (Between a mobile device and a WiFi device). I have stored the connections in <code>clientsMap</code>. So I can always access that. But since each client is handled by one goroutine, shall I be passing the data from one client to another by using a channel? But if the goroutine is blocked waiting for a pending read, how do I make it also wait for data from a channel? Or shall I just obtain the connection for the other party from the clientsMap and write to it?</p>\n"}, {"tags": ["xml", "go", "google-api", "content-type", "atom-feed"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562092587, "post_id": 56858346, "comment_id": 100266649, "body": "Yes, I was in the middle of composing my answer hinting at, e.g. <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/406\" rel=\"nofollow noreferrer\">this</a>. Basically, if you tell the server you <code>Accept</code> response in certain formats, and it&#39;s unable to provide its answer in one of them, it fails with 406 (if ti&#39;s compliant, which is, I admit, a rare thing in itself)."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562092691, "post_id": 56858346, "comment_id": 100266686, "body": "Note that the document you linked to says, among other things: &#171;The Google server creates a contact using the entry you sent, then returns an HTTP 201 CREATED status code, along with a copy of the new contact in the form of an <code>&lt;entry&gt;</code> element.&#187;. This sort of hints at that it wants to return some XML back to you."}], "tags": [], "owner": {"reputation": 357, "user_id": 1461333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22507765e19c12febc06a97816c8632?s=128&d=identicon&r=PG&f=1", "display_name": "Schparky", "link": "https://stackoverflow.com/users/1461333/schparky"}, "is_accepted": false, "score": 1, "last_activity_date": 1562092481, "creation_date": 1562092481, "answer_id": 56858346, "question_id": 56858231, "link": "https://stackoverflow.com/questions/56858231/what-is-the-correct-content-type-for-the-google-data-syntax-as-used-in-the-googl/56858346#56858346", "title": "What is the correct Content-Type for the Google Data syntax as used in the Google Contacts API?", "body": "<p>Barely a minute after posting the question I spotted the problem. Sure enough, it wasn't the <code>Content-Type</code> header, but the <code>Accept</code> header. Removing that solved the problem. To be specific, Google was complaining that I requested <code>application/json</code> as a response type. The <code>Accept</code> header is apparently not even required.</p>\n"}], "owner": {"reputation": 357, "user_id": 1461333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22507765e19c12febc06a97816c8632?s=128&d=identicon&r=PG&f=1", "display_name": "Schparky", "link": "https://stackoverflow.com/users/1461333/schparky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562092481, "creation_date": 1562091956, "question_id": 56858231, "link": "https://stackoverflow.com/questions/56858231/what-is-the-correct-content-type-for-the-google-data-syntax-as-used-in-the-googl", "title": "What is the correct Content-Type for the Google Data syntax as used in the Google Contacts API?", "body": "<p>I need to read and update the Google Shared Contacts in a G Suite domain using Golang. Since there is no existing Go client library for this API, I'm having to interact with the API at the http level. Presently, I'm stuck on sending the correct <code>Content-Type</code> header.</p>\n\n<p>Since the documentation at <a href=\"https://developers.google.com/admin-sdk/domain-shared-contacts#Creating\" rel=\"nofollow noreferrer\">https://developers.google.com/admin-sdk/domain-shared-contacts#Creating</a> says to use <code>application/atom+xml</code> that was naturally what I tried. However, the response I receive is a <code>406 Not Acceptable</code> with a body message of \"No acceptable type available\". Omitting the <code>Content-Type</code> returns a 400 \"Response contains no content type\". Using <code>text/xml</code> returns a 415 with \"Content-Type text/xml is not a valid input type.\"</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    req, err := http.NewRequest(\"POST\", href, bytes.NewBuffer([]byte(body)))\n    if err != nil {\n        return \"\", err\n    }\n\n    req.Header.Set(\"GData-Version\", \"3.0\")\n    req.Header.Set(\"Accept\", \"application/json\")\n    req.Header.Set(\"User-Agent\", \"personnel-sync\")\n    req.Header.Set(\"Content-Type\", \"text/xml\")\n\n    resp, err := g.Client.Do(req)\n    if err != nil {\n        return \"\", err\n    }\n    defer resp.Body.Close()\n\n    bodyBytes, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    bodyString := string(bodyBytes)\n    log.Println(bodyString)\n    log.Println(resp.Status)\n\n    return bodyString, nil\n</code></pre>\n\n<p>The body I'm sending is the example in the documentation (link above) but it doesn't seem to matter at this point because an empty body gives the same response.</p>\n"}, {"tags": ["javascript", "http", "go", "cors", "fetch"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1562093525, "post_id": 56858003, "comment_id": 100267020, "body": "Seems like there&#39;s probably some application logic that looks at <code>X-APIKEY</code> and skips setting <code>Access-Control-Allow-Origin</code> on the response based on that logic. Without seeing the relevant code there&#39;s no way for us to know."}, {"owner": {"reputation": 346, "user_id": 10006645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d4f64e6f346eb97ed2e9df4de0b63e?s=128&d=identicon&r=PG", "display_name": "Tobi696", "link": "https://stackoverflow.com/users/10006645/tobi696"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562096637, "post_id": 56858003, "comment_id": 100268155, "body": "I just added the whole middleware function. It&#39;s 100% sure it&#39;s being called (tested with print before and after). I hope this is what you meant."}, {"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1562276882, "post_id": 56858003, "comment_id": 100335253, "body": "Adding the custom header means the browser issues an OPTIONS verb request before sending the GET. Your server may not be responding to OPTIONS."}], "answers": [{"tags": [], "owner": {"reputation": 346, "user_id": 10006645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d4f64e6f346eb97ed2e9df4de0b63e?s=128&d=identicon&r=PG", "display_name": "Tobi696", "link": "https://stackoverflow.com/users/10006645/tobi696"}, "is_accepted": true, "score": 1, "last_activity_date": 1562349451, "creation_date": 1562349451, "answer_id": 56907480, "question_id": 56858003, "link": "https://stackoverflow.com/questions/56858003/custom-http-header-breaks-cors/56907480#56907480", "title": "Custom http Header breaks CORS", "body": "<p>I've now fixed it like this:<br>\nI misuse the http Accept header for my API-Token.<br><br>\nExample:<br></p>\n\n<pre><code>fetch('http://10.0.0.11:8013/lopm@htl/usage',\n{\"headers\":{ \"Accept\": \"fdfdsf5df6d541cd6++\" }})\n.then(response =&gt; response.json())\n.then(console.log)\n</code></pre>\n\n<p><br>\nOf course, this isn't a really nice solution, but it does its job.<br><br>\nThanks for all of you for giving me helpful tips!</p>\n"}], "owner": {"reputation": 346, "user_id": 10006645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d4f64e6f346eb97ed2e9df4de0b63e?s=128&d=identicon&r=PG", "display_name": "Tobi696", "link": "https://stackoverflow.com/users/10006645/tobi696"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 2, "accepted_answer_id": 56907480, "answer_count": 1, "score": 0, "last_activity_date": 1562349451, "creation_date": 1562090999, "last_edit_date": 1562269955, "question_id": 56858003, "link": "https://stackoverflow.com/questions/56858003/custom-http-header-breaks-cors", "title": "Custom http Header breaks CORS", "body": "<p>My API has following CORS setup:<br>\n(I am the owner, I can change these settings)<br><br>\nMiddleware function:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// HeaderMiddleware ...\nfunc HeaderMiddleware(next httprouter.Handle) httprouter.Handle {\n    return httprouter.Handle(func(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n        w.Header().Set(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept, X-APIKEY\")\n        // ! Production\n        // if r.Header.Get(\"X-APIKEY\") != \"fdfdsf5df6d541cd6\" || r.RemoteAddr != frontendURL {\n        //  w.WriteHeader(http.StatusForbidden)\n        //  json.NewEncoder(w).Encode(NoContentResponse{Success: false, Error: \"You aren't allowed to request the api here.\"})\n        //  return\n        // }\n        // ! Production\n\n        next(w, r, p)\n    })\n}\n</code></pre>\n\n<p>The X-APIKEY header is not necessary yet, a request without it just works fine:</p>\n\n<pre><code>fetch('http://localhost:8013/tobi@gmx.at/usage', { headers: { } })\n.then(response =&gt; response.json())\n.then(console.log)\n</code></pre>\n\n<p>returns <code>{used: false}</code> (expected response)</p>\n\n<p>However, if I add the X-APIKEY header:</p>\n\n<pre><code>fetch('http://localhost:8013/tobi@gmx.at/usage', { headers: { 'X-APIKEY': 'sdfsdfsafsf' } })\n.then(response =&gt; response.json())\n.then(console.log)\n</code></pre>\n\n<p>following error is thrown:<br>\n<code>Access to fetch at 'http://localhost:8013/tobiwibu@gmx.at/usage' from origin 'http://localhost:8080' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource. If an opaque response serves your needs, set the request's mode to 'no-cors' to fetch the resource with CORS disabled.</code>\n<br><br>\nIf I do the request with the X-APIKEY header in Postman, it says that the Access-Control-Allow-Origin header is sent along:\n<a href=\"https://i.stack.imgur.com/nTMxG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nTMxG.png\" alt=\"Postman says the header is sent along\"></a>\n<br><br>\nP.S.: I already tried other headers, it works!\nIf I do the request with chrome (without X-APIKEY header), the Access-Control-Allow-Origin header is sent.\n<br><br>\nThanks for your help!</p>\n"}, {"tags": ["azure", "go", "azure-eventhub"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562089682, "post_id": 56857396, "comment_id": 100265406, "body": "Impossible to say - please include the relevant code in the body of your question."}, {"owner": {"reputation": 1, "user_id": 1383924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e286475a800d70ece31d1208c8d916f?s=128&d=identicon&r=PG", "display_name": "user1383924", "link": "https://stackoverflow.com/users/1383924/user1383924"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562093124, "post_id": 56857396, "comment_id": 100266856, "body": "My client is quite simple, and there doesn&#39;t appear to be much opportunity for mis-configuration on that end. It seems to pull every event from the event hub. I&#39;d like to identify any issues configuring the Event Hub in the UI before diving into potential issues with the client."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562093420, "post_id": 56857396, "comment_id": 100266970, "body": "If it&#39;s not a programming question, try Server Fault instead of Stack Overflow."}], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 1416835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc7b57b106da50dc58a75fba5e6f16f9?s=128&d=identicon&r=PG", "display_name": "Sebastian Roether", "link": "https://stackoverflow.com/users/1416835/sebastian-roether"}, "edited": false, "score": 0, "creation_date": 1562608186, "post_id": 56874481, "comment_id": 100420464, "body": "You might also be interested in <a href=\"https://github.com/MicrosoftDocs/azure-docs/blob/master/articles/azure-monitor/platform/activity-log-schema.md\" rel=\"nofollow noreferrer\">this document explaining the property mapping</a>. Activity log category can be extracted from the operation name after exporting"}], "tags": [], "owner": {"reputation": 1, "user_id": 1383924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e286475a800d70ece31d1208c8d916f?s=128&d=identicon&r=PG", "display_name": "user1383924", "link": "https://stackoverflow.com/users/1383924/user1383924"}, "is_accepted": false, "score": 0, "last_activity_date": 1562171117, "creation_date": 1562171117, "answer_id": 56874481, "question_id": 56857396, "link": "https://stackoverflow.com/questions/56857396/azure-monitor-activitylogs-not-reaching-event-hub/56874481#56874481", "title": "Azure Monitor ActivityLogs not reaching Event Hub", "body": "<p>It turns out the Activity Logs are actually mutated before they are sent to the event hub. There is a small reference to this in the documentation (<a href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/platform/activity-log-export#activity-log-schema\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/azure/azure-monitor/platform/activity-log-export#activity-log-schema</a>). I was expecting Activity Logs to be sent to the event hub as they appear in the JSON pane of the Activity Monitor, but that appears to not be how the \"Export to Event Hub\" feature works. The Activity Log is converted into several smaller \"Action\" logs that describe each stage of the Activity, i.e. whether it was \"Started\", \"Succeeded\", or \"Failed\". These together represent one Activity Log, but the schema is different.</p>\n"}], "owner": {"reputation": 1, "user_id": 1383924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e286475a800d70ece31d1208c8d916f?s=128&d=identicon&r=PG", "display_name": "user1383924", "link": "https://stackoverflow.com/users/1383924/user1383924"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612866516, "creation_date": 1562088253, "question_id": 56857396, "link": "https://stackoverflow.com/questions/56857396/azure-monitor-activitylogs-not-reaching-event-hub", "title": "Azure Monitor ActivityLogs not reaching Event Hub", "body": "<p>I've created a Free Tier Azure account. I have events in my Azure Monitor Activity Log (Get Namespace Listkeys, etc) and clicking on these events allows me to see their JSON. I have selected \"Export to Event Hub\", selected \"All regions\", checked \"Export to an event hub\" and set up the namespace and policy name. The policy is the Root shared policy which has Manage, Send, Listen checked. This creates the \"insights-operational-logs\" event hub automatically.</p>\n\n<p>I'm using the azure golang client (<a href=\"https://github.com/Azure/azure-event-hubs-go\" rel=\"nofollow noreferrer\">https://github.com/Azure/azure-event-hubs-go</a>) to query this event hub but I'm not seeing the ActivityLog events in the client. I do receive diagnostic logs with categories like \"Action\", and \"Write\" but not the logs I can see in the ActivityLog monitor with categories like \"Administrative\".</p>\n\n<p>What am I missing? Why are these events not reaching my client?</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 1041, "user_id": 2660313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7f4cadd6658af696e1d975eda49c49?s=128&d=identicon&r=PG", "display_name": "owlwalks", "link": "https://stackoverflow.com/users/2660313/owlwalks"}, "edited": false, "score": 0, "creation_date": 1562150942, "post_id": 56857223, "comment_id": 100285450, "body": "your code works, are u sure u on the right db and collection"}], "answers": [{"comments": [{"owner": {"reputation": 1482, "user_id": 33483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/955323838b1c111c5e9b1936dc44d9fd?s=128&d=identicon&r=PG", "display_name": "Tom Opgenorth", "link": "https://stackoverflow.com/users/33483/tom-opgenorth"}, "edited": false, "score": 1, "creation_date": 1562163040, "post_id": 56868786, "comment_id": 100292742, "body": "Thanks for feedback. I&#39;ll try with <code>bson.M</code> and hopefully that fixes things.   I double checked, and I&#39;m 100% certain I&#39;m in the correct collection (thanks for the suggestion @owlwalks)."}, {"owner": {"reputation": 1733, "user_id": 754471, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ec0cac01b6d505b2bbb2951a722e202?s=128&d=identicon&r=PG", "display_name": "Mobilpadde", "link": "https://stackoverflow.com/users/754471/mobilpadde"}, "reply_to_user": {"reputation": 1482, "user_id": 33483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/955323838b1c111c5e9b1936dc44d9fd?s=128&d=identicon&r=PG", "display_name": "Tom Opgenorth", "link": "https://stackoverflow.com/users/33483/tom-opgenorth"}, "edited": false, "score": 0, "creation_date": 1562163355, "post_id": 56868786, "comment_id": 100292900, "body": "Great! Let me know how it goes, @TomOpgenorth"}, {"owner": {"reputation": 1482, "user_id": 33483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/955323838b1c111c5e9b1936dc44d9fd?s=128&d=identicon&r=PG", "display_name": "Tom Opgenorth", "link": "https://stackoverflow.com/users/33483/tom-opgenorth"}, "edited": false, "score": 1, "creation_date": 1563214632, "post_id": 56868786, "comment_id": 100618032, "body": "Using <code>bson.M</code> worked.  We also found out that my query wasn&#39;t using the correct index, which resulted in it being super inefficient and incredibly slow."}], "tags": [], "owner": {"reputation": 1733, "user_id": 754471, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ec0cac01b6d505b2bbb2951a722e202?s=128&d=identicon&r=PG", "display_name": "Mobilpadde", "link": "https://stackoverflow.com/users/754471/mobilpadde"}, "is_accepted": true, "score": 2, "last_activity_date": 1562152829, "last_edit_date": 1562152829, "creation_date": 1562152107, "answer_id": 56868786, "question_id": 56857223, "link": "https://stackoverflow.com/questions/56857223/creating-a-filter-in-mongo-go-driver-for-findone/56868786#56868786", "title": "Creating a filter in mongo-go-driver for .FindOne", "body": "<p>Not quite sure, but have you tried with <code>bson.M</code> instead of <code>bson.D</code>?</p>\n\n<p>It seems like it's working for me at least.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>query := &amp;bson.M{\n  \"event.eventType\": \"OSR\",\n  \"context.vehicleId\": 919514, \n}\n</code></pre>\n\n<p>Please refer to the <a href=\"https://godoc.org/labix.org/v2/mgo/bson#M\" rel=\"nofollow noreferrer\">docs</a> for more information.</p>\n\n<p>Also, like @owlwalks said, are you sure, you're in the right collection?</p>\n"}], "owner": {"reputation": 1482, "user_id": 33483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/955323838b1c111c5e9b1936dc44d9fd?s=128&d=identicon&r=PG", "display_name": "Tom Opgenorth", "link": "https://stackoverflow.com/users/33483/tom-opgenorth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1966, "favorite_count": 0, "accepted_answer_id": 56868786, "answer_count": 1, "score": 2, "last_activity_date": 1562152829, "creation_date": 1562087377, "question_id": 56857223, "link": "https://stackoverflow.com/questions/56857223/creating-a-filter-in-mongo-go-driver-for-findone", "title": "Creating a filter in mongo-go-driver for .FindOne", "body": "<p>I'm trying to check a collection to see if there is at least one documents that match a specific set of values. </p>\n\n<p>I've tried reading the documentation at <a href=\"https://github.com/mongodb/mongo-go-driver#usage\" rel=\"nofollow noreferrer\">https://github.com/mongodb/mongo-go-driver#usage</a>, but I can't seem to find much help there. I'm pretty new to MongoDB &amp; Go, I believe that this is more a problem of my lack of experience.</p>\n\n<p>Here is a sample query from Studio 3T that I'm trying to run with mongo-go-driver:</p>\n\n<pre><code>db.getCollection(\"events\").find(\n    { \n        \"event.eventType\" : \"OSR\", \n        \"context.vehicleId\" : NumberInt(919514), \n        \"ts\" : {\n            \"$gte\" : ISODate(\"2019-06-21T21:38:43.022+0000\")\n        }\n    }\n).limit(1);\n</code></pre>\n\n<p>It seems that the <code>context.FindOne</code> method will do what I want (and eliminating the need for the <code>.limit(1)</code>). I thought that it would be straight forward to \"port\" this to Go and the mongo-go-driver.</p>\n\n<p>I can sort of make this work, for example I have the following which will find me all the OSR:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var query = &amp;bson.D{\n        {\"event.eventType\", \"OSR\"},\n    }\n\nresult := bson.D{}\ne := collection.FindOne(context.TODO(), query).Decode(&amp;result)\n</code></pre>\n\n<p>This will return me one document. Now, if I want to include the <code>vehicleId</code> value, and I update the <code>query</code> to:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var query = &amp;bson.D{\n        {\"event.eventType\", \"OSR\"},\n        {\"context.vehicleId\", 919514}, \n    }\n</code></pre>\n\n<p>No documents are returned. I haven't bother to expand <code>query</code> to include the <code>ts</code> field yet.</p>\n\n<p>I would expect at to still have at least one document returned, but nothing is showing up.  Does anybody have some tips, suggestions or guidance on what I'm doing wrong (or perhaps how I can do this better)?</p>\n"}, {"tags": ["go", "dns", "cname"], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1562084580, "post_id": 56856437, "comment_id": 100263333, "body": "I&#39;m surprised the standard library doesn&#39;t provide the functionality I was looking for. Thanks for this!"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 9, "last_activity_date": 1562088205, "last_edit_date": 1562088205, "creation_date": 1562083934, "answer_id": 56856437, "question_id": 56856075, "link": "https://stackoverflow.com/questions/56856075/how-can-i-get-the-cname-of-a-host-for-which-dns-resolution-fails-nxdomain-in-g/56856437#56856437", "title": "How can I get the CNAME of a host for which DNS resolution fails (NXDOMAIN) in Go?", "body": "<p>Go's LookupCNAME function tries to follow a CNAME chain all the way to its end. This means it considers a DNS name without both CNAME and A records an error:</p>\n\n<blockquote>\n  <p>A canonical name is the final name after following zero or more CNAME records. LookupCNAME does not return an error if host does not contain DNS \"CNAME\" records, as long as host resolves to address records.</p>\n</blockquote>\n\n<p>Go does not provide a low-level DNS API in the standard library. The de-facto standard package to use for that is <a href=\"https://godoc.org/github.com/miekg/dns\" rel=\"noreferrer\">github.com/miekg/dns</a> (error handling and type checking elided for brevity):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/miekg/dns\"\n)\n\nfunc main() {\n    config, _ := dns.ClientConfigFromFile(\"/etc/resolv.conf\")\n    c := new(dns.Client)\n    m := new(dns.Msg)\n\n    // Note the trailing dot. miekg/dns is very low-level and expects canonical names.\n    m.SetQuestion(\"tst1crmapps.starbucks.com.\", dns.TypeCNAME)\n    m.RecursionDesired = true\n    r, _, _ := c.Exchange(m, config.Servers[0]+\":\"+config.Port)\n\n    fmt.Println(r.Answer[0].(*dns.CNAME).Target) // bigip-tst1crmapps-starbucks.oracle.com.\n}\n\n</code></pre>\n"}], "owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 1, "accepted_answer_id": 56856437, "answer_count": 1, "score": 4, "last_activity_date": 1562689191, "creation_date": 1562082528, "last_edit_date": 1562689191, "question_id": 56856075, "link": "https://stackoverflow.com/questions/56856075/how-can-i-get-the-cname-of-a-host-for-which-dns-resolution-fails-nxdomain-in-g", "title": "How can I get the CNAME of a host for which DNS resolution fails (NXDOMAIN) in Go?", "body": "<p>I'm looking for a way (in Go) to get the CNAME (if any) of a given host, <strong>whether that host's DNS resolution fails or not</strong>.</p>\n\n<p>The DNS resolution of a host may fail and yield <code>NXDOMAIN</code>, but the host in question may still have a CNAME record. At the time of writing this question, <code>tst1crmapps.starbucks.com</code> is an example of such a host:</p>\n\n<pre><code>$ dig tst1crmapps.starbucks.com | grep -E 'NXDOMAIN|CNAME'\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 50444\ntst1crmapps.starbucks.com. 86400 IN CNAME   bigip-tst1crmapps-starbucks.oracle.com.\n</code></pre>\n\n<p>(run on macOS)</p>\n\n<p>Function <a href=\"https://golang.org/pkg/net/#LookupCNAME\" rel=\"nofollow noreferrer\"><code>net.LookupCNAME</code></a> seems to be right up my alley, but it fails to return the CNAME if the host's DNS resolution fails. Running</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net\"\n)\n\nfunc main() {\n    cname, err := net.LookupCNAME(\"tst1crmapps.starbucks.com\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Println(cname)\n}\n</code></pre>\n\n<p>yields</p>\n\n<pre><code>yyyy/MM/dd hh:mm:ss lookup tst1crmapps.starbucks.com: no such host\n</code></pre>\n\n<p>Am I misunderstanding <code>net.LookupCNAME</code>? Or am I using the wrong function?</p>\n"}, {"tags": ["xml", "go", "httprequest"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1562082590, "post_id": 56855948, "comment_id": 100262364, "body": "<a href=\"https://golang.org/pkg/net/http/#Post\" rel=\"nofollow noreferrer\">Read the manual</a>: <code>func Post(url, contentType string, body io.Reader) (resp *Response, err error)</code>. The second argument is the content type, not a filename. The third argument is the body. &quot;piecing together the xml in a string builder&quot; is almost certainly incorrect. Use <a href=\"https://golang.org/pkg/encoding/xml/\" rel=\"nofollow noreferrer\">the xml package</a> instead."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562084441, "post_id": 56855948, "comment_id": 100263275, "body": "What does &quot;about tho port an http request&quot; mean? There&#39;s apparently a typo in there, but I can&#39;t make sense of it to correct the typo."}, {"owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1562313516, "post_id": 56855948, "comment_id": 100343142, "body": "edited to make clear"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 4, "last_activity_date": 1562083724, "last_edit_date": 1562083724, "creation_date": 1562082753, "answer_id": 56856141, "question_id": 56855948, "link": "https://stackoverflow.com/questions/56855948/how-do-i-post-my-xml-string-to-web-service-rather-than-an-xml-file/56856141#56856141", "title": "How do I post my XML string to web service rather than an xml file", "body": "<p>I'm not sure where you took</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>resp, err := http.Post(\"http://xxx.xxx.xx.xxx:8080/webservice/\", \"c:\\\\xml\\\\test.xml\", nil)\n</code></pre>\n\n<p>from. <a href=\"https://golang.org/pkg/net/http/#Post\" rel=\"nofollow noreferrer\">The docs</a> say the signature of <code>net/http.Post</code> is</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Post(url, contentType string, body io.Reader) (resp *Response, err error)\n</code></pre>\n\n<p>That is, the second parameter is the <a href=\"https://en.wikipedia.org/wiki/MIME#Content-Type\" rel=\"nofollow noreferrer\">content type</a> of the payload to be sent, and the third is the source from which to read the data to be sent.</p>\n\n<p>Hence, if you have a string containing the XML data\n(building an XML document using string operations is almost always a wrong thing to do but let's not digress for now),\nyou can have an <code>io.Reader</code> to read data from it by calling\n<code>strings.NewReader()</code> on your string.</p>\n\n<p>So the call would become</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>resp, err := http.Post(\"http://xxx.xxx.xx.xxx:8080/webservice/\", \"application/xml\", strings.NewReader(yourStringWithXML))\n</code></pre>\n"}], "owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56856141, "answer_count": 1, "score": -5, "last_activity_date": 1562313491, "creation_date": 1562082058, "last_edit_date": 1562313491, "question_id": 56855948, "link": "https://stackoverflow.com/questions/56855948/how-do-i-post-my-xml-string-to-web-service-rather-than-an-xml-file", "title": "How do I post my XML string to web service rather than an xml file", "body": "<p>I have sucessfully posted an http request to a web service running on one of our servers.</p>\n\n<p>Please note I did not write the web service and have no access to the source code.</p>\n\n<p>Working code:</p>\n\n<pre><code>resp, err := http.Post(\"http://xxx.xxx.xx.xxx:8080/webservice/\", \"c:\\\\xml\\\\test.xml\", nil)\n</code></pre>\n\n<p>I now instead of using an xml file need to build up the xml from a list of values.</p>\n\n<p>I have written a function that does this, it basically pieces together the xml in a string builder. and my output string looks correct. </p>\n\n<p>What I am not sure of is how do I post the xml as the post function seems to take the path to a file rather than a string?</p>\n\n<p>Also is building it together as a string the correct method or should I approach it differently?</p>\n"}, {"tags": ["postgresql", "go", "go-gin"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1562081026, "post_id": 56855368, "comment_id": 100261458, "body": "That measurement probably includes the time it takes to transfer the json over the wire as well. How large are the responses in terms of bytes? You should also add the definition of AlertJson to the question."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1562081539, "post_id": 56855368, "comment_id": 100261783, "body": "In this situation I would also try to implement this without gorm and instead use the stdlib&#39;s <code>database&#47;sql</code> package. It may very well be that under the hood gorm is relying too much on reflection."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562084691, "post_id": 56855368, "comment_id": 100263381, "body": "You could also speed things up by not using gorm or gin, and instead begin streaming your JSON response as soon as you get your first result from the database."}, {"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1562087181, "post_id": 56855368, "comment_id": 100264419, "body": "If you want to know how long the query took <b>on the server</b> run <code>explain (analyze) select ...</code>"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1562094767, "post_id": 56855368, "comment_id": 100267503, "body": "Using <code>pprof</code> you can profile a request to see exactly where your service is spending its time <a href=\"https://golang.org/pkg/net/http/pprof/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/pprof</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11729918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfb8ad44134e2556e13fdeaf32ea3bd?s=128&d=identicon&r=PG&f=1", "display_name": "jeydan12", "link": "https://stackoverflow.com/users/11729918/jeydan12"}, "is_accepted": false, "score": 0, "last_activity_date": 1562251069, "creation_date": 1562251069, "answer_id": 56890180, "question_id": 56855368, "link": "https://stackoverflow.com/questions/56855368/very-slow-from-query-to-c-json/56890180#56890180", "title": "Very slow from query to c.JSON", "body": "<p>There was immense lag on my server provider and just in fact the 10 second is indeed the delay for me to receive the data as mentioned by peter.</p>\n"}], "owner": {"reputation": 1, "user_id": 11729918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfb8ad44134e2556e13fdeaf32ea3bd?s=128&d=identicon&r=PG&f=1", "display_name": "jeydan12", "link": "https://stackoverflow.com/users/11729918/jeydan12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562251069, "creation_date": 1562079973, "last_edit_date": 1562084986, "question_id": 56855368, "link": "https://stackoverflow.com/questions/56855368/very-slow-from-query-to-c-json", "title": "Very slow from query to c.JSON", "body": "<p>I'm querying my database using Gorm and then using gin's c.JSON to marshal the structs to json.</p>\n\n<p>It's a large query with not so much result ( &lt; 100k ) and i'm having an issue with the time it takes ( 6-10 seconds ) to marshal the data.</p>\n\n<p>I have no idea where to start to resolve the issue.</p>\n\n<pre><code>    [2019-07-02 14:41:04]  [946.63ms]   SELECT  big slow query\n    [62861 rows affected or returned ]\n    [GIN] 2019/07/02 - 14:41:11 | 200 |   7.92347114s |  ip | GET      /api/date/2019-05-30\n\n\n    [2019-07-02 14:40:44]  [660.47ms]   SELECT big slow query\n    [7583 rows affected or returned ]\n    [GIN] 2019/07/02 - 14:40:54 | 200 | 10.841096216s |  ip | GET      /api/dailies\n\n    [2019-07-02 14:43:49]  [154.13ms]   SELECT simple query\n    [11 rows affected or returned ]\n    [GIN] 2019/07/02 - 14:43:49 | 200 |  158.256792ms |  ip | GET      /api/dailycount\n</code></pre>\n\n<p>As you can see query 1 and 2 resolve in 600-900 ms , it's slow but it can be optimised separately.\nThe issue is that the response of the server take 7.9 and 10.8s ..!\nFor the smaller query there isn't much difference but i'm not getting why this is happening. </p>\n\n<p>The go code for one of the route is pretty straightforward and similare for all routes :</p>\n\n<pre><code>    var alertList []AlertJson\n    dbInstance.Debug().Raw(\"SELECT big query\").Scan(&amp;alertList)\n    c.JSON(http.StatusOK, gin.H{\"alerts\": alertList}) \n</code></pre>\n\n<p>10.2 second for the second query with 7583rows to marshal seem pretty insane to me. </p>\n"}, {"tags": ["go", "apache-kafka", "kafka-consumer-api", "sarama"], "comments": [{"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 1, "creation_date": 1562071099, "post_id": 56852305, "comment_id": 100255268, "body": "When you are using the oldest offset you will get the messages from the oldest one that you haven&#39;t commit. Could you please share the consuming phase of your code?"}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1562076537, "post_id": 56852305, "comment_id": 100258739, "body": "What is your server retention policy? And does your group identification change in rebalance?"}], "answers": [{"tags": [], "owner": {"reputation": 765, "user_id": 1773471, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ef9230d2cad16eeaef167c2b782ebe36?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/1773471/steve"}, "is_accepted": true, "score": 1, "last_activity_date": 1565398568, "creation_date": 1565398568, "answer_id": 57438533, "question_id": 56852305, "link": "https://stackoverflow.com/questions/56852305/possible-reasons-of-reconsuming-kafka-messages/57438533#57438533", "title": "Possible Reasons of Reconsuming Kafka Messages", "body": "<p>By reading the source code of both golang saram client and kafka server, finally I found the reason as below</p>\n\n<ol>\n<li><p><strong>Consumer group offset</strong> retention time is <strong>24hours</strong>, which is a default setting by kafka, while <strong>log</strong> retention is <strong>7days</strong> explicitly set by us.     </p></li>\n<li><p>My server app is running in test environment where few people can visit, which means there may be few messages produced by kafka producer, and then the consumer group has few messages to consumes, thus the consumer may not commit any offset for long time. </p></li>\n<li><p>When the consume offset is not updated for more than 24hours, due to the offset config, the kafka broker/coordinator will remove the consume offset from partitions. Next time the saram queries from kafka broker where the offset is, of course client gets nothing. Notice we are using <strong>sarama.OffsetOldest</strong> as initial value, then sarama client will consume messages from the start of messages kept by kafka broker, which results in messages reconsuming, and this is likely to happen because log retention is <strong>7days</strong></p></li>\n</ol>\n"}], "owner": {"reputation": 765, "user_id": 1773471, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ef9230d2cad16eeaef167c2b782ebe36?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/1773471/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "accepted_answer_id": 57438533, "answer_count": 1, "score": 0, "last_activity_date": 1565398568, "creation_date": 1562069889, "last_edit_date": 1565397082, "question_id": 56852305, "link": "https://stackoverflow.com/questions/56852305/possible-reasons-of-reconsuming-kafka-messages", "title": "Possible Reasons of Reconsuming Kafka Messages", "body": "<p>Yesterday I found from log the kafka was reconsuming some messages after the Kafka group coordinator initiated a group rebalance. These messages had been consumed two days ago (confirmed from log). </p>\n\n<p>There were two other rebalancing reported in the log, but they didn't reconsume messages anymore. So why the first time reblancing would cause reconsuming messages?  What were the problems? </p>\n\n<p>I am using the golang kafka client. here are the code</p>\n\n<pre><code>config := sarama.NewConfig()\nconfig.Version = version\nconfig.Consumer.Offsets.Initial = sarama.OffsetOldest \n</code></pre>\n\n<p>and we are handling messges before claiming messages, so seems we are using the Send At Least Once strategy for kafka. We have three brokers in one machine, and only one consumer thread (go routine) in the other machine.</p>\n\n<p>Any explanations for this phoenomenon? \nI think the messages must have been committed, coz they were consumed two days ago, or why would kafka keep offsets for more than two days without committing?</p>\n\n<p>Consuming Code sample:</p>\n\n<pre><code>func (consumer *Consumer) ConsumeClaim(session \nsarama.ConsumerGroupSession, claim sarama.ConsumerGroupClaim) error {\n\nfor message := range claim.Messages() {\n    realHanlder(message)   // consumed data here\n    session.MarkMessage(message, \"\") // mark offset\n}\n\nreturn nil\n}\n</code></pre>\n\n<p>Added:    </p>\n\n<ol>\n<li><p>Rebalancing happened after app restarted. There were two other restarts which didn't cuase reconnsume   </p></li>\n<li><p>configs of kafka   </p>\n\n<p>log.retention.check.interval.ms=300000<br>\nlog.retention.hours=168<br>\nzookeeper.connection.timeout.ms=6000<br>\ngroup.initial.rebalance.delay.ms=0<br>\ndelete.topic.enable = true<br>\nauto.create.topics.enable=false       </p></li>\n</ol>\n"}, {"tags": ["mongodb", "go", "mongo-go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562069819, "post_id": 56852036, "comment_id": 100254494, "body": "What happens if you use <code>bson.M</code> as the filter? <code>filter := bson.M{&quot;name&quot;, &quot; !hello&quot;}</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1562069902, "post_id": 56852036, "comment_id": 100254549, "body": "Also use <code>bson</code> <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">struct tags</a> to map between struct fields and fields of your MongoDB documents."}, {"owner": {"reputation": 1, "user_id": 10562672, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQlai5QD09Y/AAAAAAAAAAI/AAAAAAAAAJc/i7QWTEb0r_k/photo.jpg?sz=128", "display_name": "Dinamis", "link": "https://stackoverflow.com/users/10562672/dinamis"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562070247, "post_id": 56852036, "comment_id": 100254741, "body": "@icza hey, i belive <code>bson.M{&quot;name&quot;, &quot; !hello&quot;}</code> - will contain cmpile error, missing type in composite literal. but i was tryed: <code>filter := bson.M{&quot;name&quot;: &quot; !hello&quot;}</code> and it&#39;s have the same result. {  0}"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1562070956, "post_id": 56852481, "comment_id": 100255169, "body": "Also you must use exported field names, e.g. <code>Name string `bson:&quot;name&quot;`</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 10562672, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQlai5QD09Y/AAAAAAAAAAI/AAAAAAAAAJc/i7QWTEb0r_k/photo.jpg?sz=128", "display_name": "Dinamis", "link": "https://stackoverflow.com/users/10562672/dinamis"}, "is_accepted": false, "score": 0, "last_activity_date": 1562070450, "creation_date": 1562070450, "answer_id": 56852481, "question_id": 56852036, "link": "https://stackoverflow.com/questions/56852036/mongodb-go-adapter-findone-spits-out-and-0/56852481#56852481", "title": "Mongodb-go-adapter FindOne spits out { } and { 0}", "body": "<pre><code>type userModel struct {\n    name    string `bson:\"name\"`\n    Value   string `bson:\"Value\"`\n    Counter int    `bson:\"Counter\"`\n}\nvar result userModel\nfilter := bson.M{\"name\": \" !hello\"}\ndb := Client.Database(\"Nothing\").Collection(\"databaseC\")\ndb.FindOne(context.Background(), filter).Decode(&amp;result)\nfmt.Println(result)\nfmt.Println(result.Value)\n</code></pre>\n\n<p>Outputs an actual value.\nThanks @icza</p>\n"}], "owner": {"reputation": 1, "user_id": 10562672, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQlai5QD09Y/AAAAAAAAAAI/AAAAAAAAAJc/i7QWTEb0r_k/photo.jpg?sz=128", "display_name": "Dinamis", "link": "https://stackoverflow.com/users/10562672/dinamis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1562078268, "creation_date": 1562068980, "last_edit_date": 1562078268, "question_id": 56852036, "link": "https://stackoverflow.com/questions/56852036/mongodb-go-adapter-findone-spits-out-and-0", "title": "Mongodb-go-adapter FindOne spits out { } and { 0}", "body": "<p>In general FindOne fmt.print result { }. I need to output Value.</p>\n\n<p>I'm using pretty much standard setup from documentation: <a href=\"https://docs.mongodb.com/ecosystem/drivers/go/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/ecosystem/drivers/go/</a></p>\n\n<p>I have problems with creating query because most of examples are different; I've tried to follow this pattern: <a href=\"https://github.com/ruanbekker/code-examples/blob/master/mongodb/golang/examples.go\" rel=\"nofollow noreferrer\">https://github.com/ruanbekker/code-examples/blob/master/mongodb/golang/examples.go</a></p>\n\n<p>Reference object:</p>\n\n<pre><code>_id:5d1a8829cf5042c071458db6\nname:\" !hello\"\nValue:\" World %c end\"\nCounter:0 \n</code></pre>\n\n<p>Code examples:</p>\n\n<pre><code>type userModel struct {\n    Uname string\n    Url   string\n}\n\nvar result userModel\nfilter := bson.D{{\"name\", \" !hello\"}}\ndb := Client.Database(\"Nothing\").Collection(\"databaseC\")\ndb.FindOne(context.Background(), filter).Decode(&amp;result)\nfmt.Println(result)\nfmt.Println(result.Url)\n</code></pre>\n\n<p>// Output { 0}\n// Output empty</p>\n\n<pre><code>type userModel struct {\n    Name    string\n    Value   string\n    Counter int\n}\nvar result userModel\nfindOneOptions := options.FindOne()\nfindOneOptions.SetProjection(bson.D{{\"name\", \"!new\"}})\n\nfilter := bson.D{{}}\ndb := Client.Database(\"Nothing\").Collection(\"databaseC\")\ndb.FindOne(context.TODO(), filter, findOneOptions).Decode(&amp;result)\nfmt.Println(result)\n</code></pre>\n\n<p>// Output nothing</p>\n\n<p>// different collection with simple struct</p>\n\n<pre><code>type userModel struct {\n    Uname string\n    Url   string\n}\nvar result userModel\nfilter := bson.D{{\"name\", \"object\"}}\ndb := Client.Database(\"Nothing\").Collection(\"Video\")\ndb.FindOne(context.Background(), filter).Decode(&amp;result)\nfmt.Println(result)\nfmt.Println(result.Url)\n</code></pre>\n\n<p>// Output { }\n// Output empty</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1562061297, "post_id": 56849762, "comment_id": 100250018, "body": "Relative paths are always resolved to the working directory. Make sure you provide a relative path based on that. See <a href=\"https://stackoverflow.com/questions/31059023/how-to-reference-a-relative-file-from-code-and-tests/31059125#31059125\">how to reference a relative file from code and tests</a>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1562062031, "post_id": 56849762, "comment_id": 100250424, "body": "&quot;But, I want the file (a.go) to be read into (b.go) without using the entire system path.&quot; You cannot do this. The running program does not know about your source code."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1562063878, "post_id": 56849762, "comment_id": 100251350, "body": "What makes you think that <code>a.go</code> will even be available where the program is executed?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1562063945, "post_id": 56849762, "comment_id": 100251389, "body": "This looks like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>. What are you actually trying to <i>accomplish</i>? Explain your goal, and we can help you solve that, rather than this wild goose chase for something you probably shouldn&#39;t do."}], "answers": [{"tags": [], "owner": {"reputation": 3448, "user_id": 230264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64319d2344224d2242f11e2c94792a9?s=128&d=identicon&r=PG", "display_name": "Simon Zimmermann", "link": "https://stackoverflow.com/users/230264/simon-zimmermann"}, "is_accepted": false, "score": -4, "last_activity_date": 1562061880, "creation_date": 1562061880, "answer_id": 56849981, "question_id": 56849762, "link": "https://stackoverflow.com/questions/56849762/how-to-read-a-file-present-in-a-package-into-another-file-belonging-to-the-same/56849981#56849981", "title": "How to read a file present in a package into another file belonging to the same package?", "body": "<p>You can get the path of the current file by using this technique. </p>\n\n<pre><code>_, srcpath, _, _ := runtime.Caller(0)\ndirpath := filepath.Dir(srcpath)\nerr, fp := os.Open(filepath.Join(dirpath, \"a.go\"))\nif err != nil {\n     // err\n}\n...\nfp.Close()\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11311150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61cba350b2788d3c046fb7f7de74a28b?s=128&d=identicon&r=PG&f=1", "display_name": "Saketh Bv", "link": "https://stackoverflow.com/users/11311150/saketh-bv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1562061880, "creation_date": 1562061105, "last_edit_date": 1562061348, "question_id": 56849762, "link": "https://stackoverflow.com/questions/56849762/how-to-read-a-file-present-in-a-package-into-another-file-belonging-to-the-same", "title": "How to read a file present in a package into another file belonging to the same package?", "body": "<p>I'm trying to a read a file (a.go) present in a package into another file (b.go) which is also present in the same package. I used <strong>os.Open()</strong> method but it is working only when i give the complete system path of the file(ex: home/bin/xyz/a.go).</p>\n\n<p>But, I want the file (a.go) to be read into (b.go) <em>without using the entire system path</em>. Can anyone please help?</p>\n\n<p>Folder</p>\n\n<pre><code>  -- a.go\n\n  -- b.go\n</code></pre>\n\n<p>//Inside b.go we have a function//</p>\n\n<pre><code>func (xyz){\n\nx:= os.Open(\"--path to a.go--\") // This path shouldn't be the system path\n\n}\n</code></pre>\n"}, {"tags": ["python", "xml", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1562059773, "post_id": 56849147, "comment_id": 100249210, "body": "You could start by buffering your file io. For the rest: Different languages and different libraries."}, {"owner": {"reputation": 1153, "user_id": 5097372, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/06e375ba700f4ca573c0d5b12dd7012b?s=128&d=identicon&r=PG&f=1", "display_name": "Gabor", "link": "https://stackoverflow.com/users/5097372/gabor"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1562061856, "post_id": 56849147, "comment_id": 100250330, "body": "xml.NewDecoder already creates bufio.Reader. So the file reading is buffered."}, {"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 3, "creation_date": 1562065154, "post_id": 56849147, "comment_id": 100252044, "body": "Go isn&#39;t necessarily faster than other languages. If you want to adopt Go you are probably looking for other features rather than only execution time. Features like: channels, goroutines, type safety, and so on."}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 1, "creation_date": 1562074678, "post_id": 56849147, "comment_id": 100257575, "body": "This is a comparison between an optimized C library (<code>lxml</code>, which the Python module is a thin wrapper of) and a native Go library. <code>lxml</code> is written in &quot;cython&quot; which is essentially a Pythonish DSL over C. It should be possible to get similar performance by wrapping a C XML parser with CGO or some such"}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 3, "last_activity_date": 1563799266, "last_edit_date": 1563799266, "creation_date": 1562075045, "answer_id": 56853903, "question_id": 56849147, "link": "https://stackoverflow.com/questions/56849147/reading-large-xml-file-go-encoding-xml-is-twice-as-slow-as-python-lxml/56853903#56853903", "title": "reading large xml file: go encoding/xml is twice as slow as python lxml", "body": "<p>To expand upon my comment - <em>this is expected</em>.</p>\n\n<p>Go's <code>encoding/xml</code> is written in pure Go, whereas <code>lxml</code> is written in C, essentially. It's using Cython, which generates C code from a Python-like DSL.</p>\n\n<p>2x is not a huge performance difference IMHO, but if every last drop of performance matters to you, consider using another Go package - one that wraps an optimized C implementation.</p>\n\n<p>For example, libxml (one of the most popular C implementations) has several wrappers:</p>\n\n<ul>\n<li><a href=\"https://github.com/moovweb/gokogiri\" rel=\"nofollow noreferrer\">https://github.com/moovweb/gokogiri</a></li>\n<li><a href=\"https://github.com/lestrrat-go/libxml2\" rel=\"nofollow noreferrer\">https://github.com/lestrrat-go/libxml2</a></li>\n</ul>\n\n<p>I expect these will be much faster than <code>encoding/xml</code>.</p>\n\n<hr>\n\n<p>Edid (2019-07-22): This question inspired me to <a href=\"https://eli.thegreenplace.net/2019/faster-xml-stream-processing-in-go/\" rel=\"nofollow noreferrer\">write more about streaming XML performance in Go</a>, and <a href=\"https://github.com/eliben/gosax\" rel=\"nofollow noreferrer\">a new wrapper for the libxml SAX interface</a>.</p>\n"}], "owner": {"reputation": 1153, "user_id": 5097372, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/06e375ba700f4ca573c0d5b12dd7012b?s=128&d=identicon&r=PG&f=1", "display_name": "Gabor", "link": "https://stackoverflow.com/users/5097372/gabor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1563799266, "creation_date": 1562059055, "question_id": 56849147, "link": "https://stackoverflow.com/questions/56849147/reading-large-xml-file-go-encoding-xml-is-twice-as-slow-as-python-lxml", "title": "reading large xml file: go encoding/xml is twice as slow as python lxml", "body": "<p>I was considering to adapt go for my future projects for performance reason but there is a big surprise: go's running time is 13.974427s while pythons elapsed time is just 6.593028783798218s\nLess then a half!</p>\n\n<p>The XML file size is over 300 MB.\nHere is the pythons's code:</p>\n\n<pre><code>from lxml import objectify\nimport time\n\nmost = time.time()\n\nroot = objectify.parse(open(r\"c:\\temp\\myfile.xml\", 'rb')).getroot()\n\nif hasattr(root, 'BaseData'):\n    if hasattr(root.BaseData, 'SzTTs'):\n        total_records = 0\n        for sztt in root.BaseData.SzTTs.sztt:\n            total_records += 1\nprint(\"total_records\", total_records)\nprint(\"Time elapsed: \", time.time()-most)\n</code></pre>\n\n<p>and here is the simplified go code:</p>\n\n<pre><code>package main\n\n// An example streaming XML parser.\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"time\"\n)\n\nvar inputFile = \"c:\\\\temp\\\\myfile.xml\"\n\ntype SzTTs struct {\n    Sztt []sztt\n}\n\ntype sztt struct {\n}\n\nfunc main() {\n    xmlFile, err := os.Open(inputFile)\n    if err != nil {\n        fmt.Println(\"Error opening file:\", err)\n        return\n    }\n    defer xmlFile.Close()\n\n    d := xml.NewDecoder(xmlFile)\n    total1 := 0\n    total2 := 0\n    start := time.Now()\n    for {\n        // Read tokens from the XML document in a stream.\n        t, err := d.Token()\n        // If we are at the end of the file, we are done\n        if t == nil || err == io.EOF {\n            fmt.Println(\"The end\")\n            break\n        } else if err != nil {\n            log.Fatalf(\"Error decoding token: %s\", err)\n        }\n\n        // Inspect the type of the token just read.\n        switch se := t.(type) {\n        case xml.StartElement:\n\n            if se.Name.Local == \"SzTTs\" {\n                var p SzTTs\n                // decode a whole chunk of following XML into the\n                // variable p which is a Page (se above)\n                if err = d.DecodeElement(&amp;p, &amp;se); err != nil {\n                    log.Fatalf(\"Error decoding item: %s\", err)\n                }\n                for i := range p.Sztt {\n                    total1 = i\n                }\n            }\n        default:\n        }\n    }\n\n    fmt.Printf(\"Total sztt: %d \\n\", total1)\n    fmt.Printf(\"Elapsed time %s\", time.Since(start))\n}\n</code></pre>\n\n<p>Why is this big difference?</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562059542, "post_id": 56849101, "comment_id": 100249083, "body": "First: check <b>all</b> your errors (<code>mongo.NewClient()</code>). Next: <code>mongo.Connect()</code> does not block for server discovery. It may return with no error even if you can&#39;t connect. Use <code>Client.Ping()</code> to verify that the client can connect to the topology."}, {"owner": {"reputation": 165, "user_id": 9394149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u6728\u6728\u7684\u6728\u5934", "link": "https://stackoverflow.com/users/9394149/%e6%9c%a8%e6%9c%a8%e7%9a%84%e6%9c%a8%e5%a4%b4"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562060027, "post_id": 56849101, "comment_id": 100249322, "body": "@icza Client.ping()  output &quot;client is disconnected&quot;,why disconnected?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562061101, "post_id": 56849101, "comment_id": 100249908, "body": "You probably can&#39;t connect at all. There may be several reasons, e.g. wrong URI, no MongoDB server running etc..."}, {"owner": {"reputation": 165, "user_id": 9394149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u6728\u6728\u7684\u6728\u5934", "link": "https://stackoverflow.com/users/9394149/%e6%9c%a8%e6%9c%a8%e7%9a%84%e6%9c%a8%e5%a4%b4"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562062641, "post_id": 56849101, "comment_id": 100250708, "body": "@icza But I have updated some data.I build MongoDB  by docker with official image ."}], "answers": [{"tags": [], "owner": {"reputation": 52, "user_id": 8838954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02a773b565464411738691f1e1802511?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Cani", "link": "https://stackoverflow.com/users/8838954/jonathan-cani"}, "is_accepted": true, "score": 2, "last_activity_date": 1572258735, "last_edit_date": 1572258735, "creation_date": 1572240795, "answer_id": 58586153, "question_id": 56849101, "link": "https://stackoverflow.com/questions/56849101/golang-reports-context-deadline-exceeded-with-mongodb/58586153#58586153", "title": "Golang reports &quot;context deadline exceeded&quot; with MongoDB", "body": "<p><strong>Change</strong> <code>mongodb://localhost:27017</code> <strong>to</strong> <code>mongodb://127.0.0.1:27017/</code></p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12353045, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAplRQ3d6rTIjPFJPKKH5BfjmU78FB9KgnfRmUOMg=k-s128", "display_name": "Peter Wu", "link": "https://stackoverflow.com/users/12353045/peter-wu"}, "is_accepted": false, "score": 0, "last_activity_date": 1581320215, "creation_date": 1581320215, "answer_id": 60145927, "question_id": 56849101, "link": "https://stackoverflow.com/questions/56849101/golang-reports-context-deadline-exceeded-with-mongodb/60145927#60145927", "title": "Golang reports &quot;context deadline exceeded&quot; with MongoDB", "body": "<p>Your URI is wrong, because you were using docker.</p>\n\n<p>If your containers of mongoDB called <code>mongoContainer</code>,\nyou should:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>client, _ := mongo.NewClient(options.Client().ApplyURI(\"mongodb://mongoContainer\"))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2401, "user_id": 12695027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i74ZG.png?s=128&g=1", "display_name": "Scratte", "link": "https://stackoverflow.com/users/12695027/scratte"}, "edited": false, "score": 0, "creation_date": 1587408355, "post_id": 61302031, "comment_id": 108495545, "body": "This reads as a comment asking for clarification. Please edit it into an answer."}], "tags": [], "owner": {"reputation": 703, "user_id": 1180302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0b1e363abcc1a95055341dc5733c690f?s=128&d=identicon&r=PG", "display_name": "neoerol", "link": "https://stackoverflow.com/users/1180302/neoerol"}, "is_accepted": false, "score": 0, "last_activity_date": 1587287956, "creation_date": 1587287956, "answer_id": 61302031, "question_id": 56849101, "link": "https://stackoverflow.com/questions/56849101/golang-reports-context-deadline-exceeded-with-mongodb/61302031#61302031", "title": "Golang reports &quot;context deadline exceeded&quot; with MongoDB", "body": "<p>Which mongodb version do you use \nGo mongo driver doesn't support Mongo 2.4 <a href=\"https://jira.mongodb.org/browse/GODRIVER-1571\" rel=\"nofollow noreferrer\">https://jira.mongodb.org/browse/GODRIVER-1571</a></p>\n"}], "owner": {"reputation": 165, "user_id": 9394149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u6728\u6728\u7684\u6728\u5934", "link": "https://stackoverflow.com/users/9394149/%e6%9c%a8%e6%9c%a8%e7%9a%84%e6%9c%a8%e5%a4%b4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6681, "favorite_count": 2, "accepted_answer_id": 58586153, "answer_count": 3, "score": 5, "last_activity_date": 1587287956, "creation_date": 1562058899, "last_edit_date": 1562059292, "question_id": 56849101, "link": "https://stackoverflow.com/questions/56849101/golang-reports-context-deadline-exceeded-with-mongodb", "title": "Golang reports &quot;context deadline exceeded&quot; with MongoDB", "body": "<p>I wrote an update function, but multiple executions will give the error <code>context deadline exceeded</code>.</p>\n\n<p>My function:</p>\n\n<pre><code>func Update(link string, m bson.M) {\n    configInfo := config.Config()\n\n    // client := GetInstance().client\n    // ctx := GetInstance().ctx\n\n    client, _ := mongo.NewClient(options.Client().ApplyURI(\"mongodb://localhost:27017\"))\nctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)\n    defer cancel()\n    err := client.Connect(ctx)\n    if err != nil {\n        fmt.Print(\"connect error!\")\n        fmt.Println(err)\n    }\n    db := client.Database(\"test\")\n    lianjia := db.Collection(\"test\")\n    _, err = lianjia.UpdateOne(ctx, bson.M{\"Link\": link}, bson.M{\"$set\": m})\n    if err != nil {\n        fmt.Print(\"update error!\")\n        fmt.Println(err)\n    }\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>update error!context deadline exceeded\n</code></pre>\n"}, {"tags": ["go", "apache-kafka", "opentracing", "jaeger"], "answers": [{"comments": [{"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1613409609, "post_id": 56927362, "comment_id": 117060960, "body": "you saved my life with this answer. Thank you."}], "tags": [], "owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "is_accepted": true, "score": 1, "last_activity_date": 1562549178, "creation_date": 1562549178, "answer_id": 56927362, "question_id": 56847558, "link": "https://stackoverflow.com/questions/56847558/tracing-kafka-bus-in-distributed-app-using-jaeger/56927362#56927362", "title": "Tracing Kafka bus in distributed app using Jaeger", "body": "<p>So, answering my own question. Jaeger does not support cross system spans. Every sub-system is responsible for its own span in the whole system. \nFor reference, check this answer <a href=\"https://github.com/opentracing/specification/issues/143\" rel=\"nofollow noreferrer\">https://github.com/opentracing/specification/issues/143</a></p>\n"}], "owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 2, "accepted_answer_id": 56927362, "answer_count": 1, "score": 2, "last_activity_date": 1562549178, "creation_date": 1562053124, "question_id": 56847558, "link": "https://stackoverflow.com/questions/56847558/tracing-kafka-bus-in-distributed-app-using-jaeger", "title": "Tracing Kafka bus in distributed app using Jaeger", "body": "<p>I have distribute application that consists of several Go services. Some of those use Kafka as data bus. I was able trace down calls between services using <code>opentracing</code> with Jaeger. I have problem plotting Kafka spans on graph, them appear as gaps. </p>\n\n<p>Here is what i was able to do. \nInitial spans been created by gRPC middleware. Producer side: </p>\n\n<pre><code>...    \nkafkaMsg := kafka.Message{Key: []byte(key), Value: msgBytes}\nheaders:=make(map[string]string)\nif span := opentracing.SpanFromContext(ctx); span != nil {\n    opentracing.GlobalTracer().Inject(\n        span.Context(),\n        opentracing.TextMap,\n        opentracing.TextMapCarrier(headers))\n}\nfor headerKey, headerValue:=range headers{\n    msg.Headers = append(msg.Headers, kafka.Header{\n        Key: headerKey,\n        Value: []byte(headerValue),\n    })\n}\n// Write message to Kafka\n...\n</code></pre>\n\n<p>Consumer side:</p>\n\n<pre><code>...\n// read headers from Kafka message\nheaders := make(map[string]string)\nfor _, header := range kafkaMessage.Headers{\n    headers[header.Key]=string(header.Value)\n}\nspanContext, _ := opentracing.GlobalTracer().Extract(opentracing.TextMap, opentracing.TextMapCarrier(headers))\nspan := opentracing.StartSpan(\n    \"Consumer\",\n    opentracing.FollowsFrom(spanContext))\ndefer span.Finish()\n...\n</code></pre>\n\n<p>How should i modify this to plot span on graph when message was in Kafka?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 1, "creation_date": 1562049308, "post_id": 56845382, "comment_id": 100243976, "body": "It looks like you only want to execute a <i>single</i> command, <code>docker</code>, with some arguments. Or which is the second command?!"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1562052034, "post_id": 56845382, "comment_id": 100245208, "body": "You can execute multiple commands with <code>exec.Command</code> by calling <code>exec.Command</code> more than once. If you&#39;re trying to pipe data between commands, like in the shell, you have to do that manually. But I don&#39;t see any evidence that you&#39;re trying to even execute two commands, let alone pipe them together. What is your actual problem?"}, {"owner": {"reputation": 123, "user_id": 7017277, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/126fe2db99a033095642278b216357aa?s=128&d=identicon&r=PG&f=1", "display_name": "sampat nayak", "link": "https://stackoverflow.com/users/7017277/sampat-nayak"}, "edited": false, "score": 0, "creation_date": 1562052223, "post_id": 56845382, "comment_id": 100245301, "body": "When i will try to execute. Output: exit status 127: docker exec requires at least 2 argument"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1562052614, "post_id": 56845382, "comment_id": 100245519, "body": "So pass two arguments. That has nothing to do with two commands."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7017277, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/126fe2db99a033095642278b216357aa?s=128&d=identicon&r=PG&f=1", "display_name": "sampat nayak", "link": "https://stackoverflow.com/users/7017277/sampat-nayak"}, "edited": false, "score": 0, "creation_date": 1562045621, "post_id": 56845600, "comment_id": 100242653, "body": "Output: exit status 127: docker exec requires at least 2 arguments"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 123, "user_id": 7017277, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/126fe2db99a033095642278b216357aa?s=128&d=identicon&r=PG&f=1", "display_name": "sampat nayak", "link": "https://stackoverflow.com/users/7017277/sampat-nayak"}, "edited": false, "score": 0, "creation_date": 1562051305, "post_id": 56845600, "comment_id": 100244883, "body": "@sampatnayak If you have copy-pasted my answer, I had an extra double-quotes that I have removed. I have also added another example."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1562051274, "last_edit_date": 1562051274, "creation_date": 1562043555, "answer_id": 56845600, "question_id": 56845382, "link": "https://stackoverflow.com/questions/56845382/is-there-any-way-we-can-execute-a-multiple-commands-in-exec-command/56845600#56845600", "title": "Is there any way we can execute a multiple commands in exec.Command?", "body": "<p>Since you have used <code>sh -c</code>, the next parameter should be the full command or commands:</p>\n\n<pre><code>SystemdockerCommand := exec.Command(\"sh\", \"-c\", \"docker exec 9aa1124 gluster peer detach 192.168.1.1 force\")\n</code></pre>\n\n<p>More generally, <a href=\"https://stackoverflow.com/a/34459037/6309\">as in here</a>:</p>\n\n<pre><code>cmd := exec.Command(\"/bin/sh\", \"-c\", \"command1 param1; command2 param2; command3; ...\")\nerr := cmd.Run()       \n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/a/52773195/6309\">this example</a>:</p>\n\n<pre><code>sh := os.Getenv(\"SHELL\") //fetch default shell\n//execute the needed command with `-c` flag\ncmd := exec.Command(sh, \"-c \", `docker exec 9aa1124 ...`)\n</code></pre>\n\n<p>Or <a href=\"https://stackoverflow.com/a/30329351/6309\">this one</a>, putting your commands in a string first:</p>\n\n<pre><code>cmd := \"cat /proc/cpuinfo | egrep '^model name' | uniq | awk '{print substr($0, index($0,$4))}'\"\nout, err := exec.Command(\"bash\",\"-c\",cmd).Output()\nif err != nil {\n    return fmt.Sprintf(\"Failed to execute command: %s\", cmd)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1562046042, "creation_date": 1562046042, "answer_id": 56846002, "question_id": 56845382, "link": "https://stackoverflow.com/questions/56845382/is-there-any-way-we-can-execute-a-multiple-commands-in-exec-command/56846002#56846002", "title": "Is there any way we can execute a multiple commands in exec.Command?", "body": "<blockquote>\n  <p>Is there any way we can execute a multiple commands in exec.Command</p>\n</blockquote>\n\n<p>No.</p>\n"}], "owner": {"reputation": 123, "user_id": 7017277, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/126fe2db99a033095642278b216357aa?s=128&d=identicon&r=PG&f=1", "display_name": "sampat nayak", "link": "https://stackoverflow.com/users/7017277/sampat-nayak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 1, "accepted_answer_id": 56845600, "answer_count": 2, "score": -6, "last_activity_date": 1562051274, "creation_date": 1562042064, "last_edit_date": 1562046719, "question_id": 56845382, "link": "https://stackoverflow.com/questions/56845382/is-there-any-way-we-can-execute-a-multiple-commands-in-exec-command", "title": "Is there any way we can execute a multiple commands in exec.Command?", "body": "<p>I am trying to execute set of commands in Go using <code>exec.Command()</code>. Where I am trying to detach Gluster peer using Docker Exec.</p>\n\n<pre><code>fmt.Println(\"About to execute gluster peer detach\")\n\nSystemdockerCommand := exec.Command(\"sh\", \"-c\", \"docker exec \", \"9aa1124\", \" gluster peer detach \", \"192.168.1.1\", \" force\")\nvar out bytes.Buffer\nvar stderr bytes.Buffer\nSystemdockerCommand.Stdout = &amp;out\nSystemdockerCommand.Stderr = &amp;stderr\nerr := SystemdockerCommand.Run()\nif err != nil {\n    fmt.Println(fmt.Sprint(err) + \": \" + stderr.String())\n}\nfmt.Println(\"System Docker exec : \" + out.String())\n</code></pre>\n\n<p>I was expecting a result as \"no peer to detatch\". But got \nexit status 1: \"docker exec\" requires at least 2 arguments.</p>\n"}, {"tags": ["list", "go"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 2, "creation_date": 1562033465, "post_id": 56844401, "comment_id": 100240337, "body": "Do you <i>need</i> to be using <code>containers&#47;list</code>? Did someone ask you to? Is it purely a curiosity thing? Because it&#39;s probably a pretty bad idea. Just use a slice."}, {"owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1562033860, "post_id": 56844401, "comment_id": 100240417, "body": "@hobbs unfortunately its for an assignment where we must use lists"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "edited": false, "score": 0, "creation_date": 1562033834, "post_id": 56844448, "comment_id": 100240409, "body": "unfortunately it is for an assignment that specifically says to use lists. Thanks for the help! I&#39;ll see what I can make of it"}, {"owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "edited": false, "score": 0, "creation_date": 1562034228, "post_id": 56844448, "comment_id": 100240483, "body": "now ive got test:=studentList.Front() \t\tfmt.Println(test) and its printing &amp;{0xc0000644b0 0xc000064390 0xc000064390 {Chris Millsap 77 71}}"}], "tags": [], "owner": {"reputation": 451, "user_id": 6192034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1d1065e25fc0d226168e89562610278?s=128&d=identicon&r=PG&f=1", "display_name": "Zzyzx", "link": "https://stackoverflow.com/users/6192034/zzyzx"}, "is_accepted": false, "score": 1, "last_activity_date": 1562033935, "last_edit_date": 1562033935, "creation_date": 1562033527, "answer_id": 56844448, "question_id": 56844401, "link": "https://stackoverflow.com/questions/56844401/how-to-print-values-of-a-list-in-go/56844448#56844448", "title": "How to print values of a list in Go", "body": "<p>A quick read through the code. You are pushing <code>studentCount</code> into the list which is an int variable according to your declaration. I think what you are trying to achieve is pushing in the <code>student</code> struct instead. Typo?</p>\n\n<p>P.S. If this is not a piece of homework or something with specific requirements, just use a slice instead. Always use a slice.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "edited": false, "score": 0, "creation_date": 1562034777, "post_id": 56844556, "comment_id": 100240578, "body": "It gave me  invalid type assertion: test.(Student) (non-interface type *list.Element on left)"}, {"owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "reply_to_user": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "edited": false, "score": 1, "creation_date": 1562034940, "post_id": 56844556, "comment_id": 100240611, "body": "use <code>test.Value.(Student)</code> instead, plz chk updated answer"}, {"owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "edited": false, "score": 0, "creation_date": 1562035204, "post_id": 56844556, "comment_id": 100240651, "body": "Whoops I guess I accidentally deleted that part before I ran it (its been a long day). That seems to have fixed it. Thank you so very much"}], "tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": true, "score": 2, "last_activity_date": 1562034971, "last_edit_date": 1562034971, "creation_date": 1562034517, "answer_id": 56844556, "question_id": 56844401, "link": "https://stackoverflow.com/questions/56844401/how-to-print-values-of-a-list-in-go/56844556#56844556", "title": "How to print values of a list in Go", "body": "<p>Seems like you don't have the object type handy. you can use assertion to get the actual object type, something like the following: </p>\n\n<pre><code>  test:=studentList.Front()\n  if actualStudent, ok := test.Value.(Student); ok {\n      fmt.Println(actualStudent.FirstName)\n  }\n</code></pre>\n\n<p>If it doesn't help, please leave a comment with the issue you face and I will be more than happy to assist you. </p>\n"}], "owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 56844556, "answer_count": 2, "score": -2, "last_activity_date": 1562034971, "creation_date": 1562033025, "last_edit_date": 1562034219, "question_id": 56844401, "link": "https://stackoverflow.com/questions/56844401/how-to-print-values-of-a-list-in-go", "title": "How to print values of a list in Go", "body": "<p>I've got some values in a list in Go. I just need to be able to print them but every time I try it tells me test.FirstName undefined (type *list.Element has no field or method FirstName). </p>\n\n<p>So how to I appropriately access the members of the list? Its the last couple of lines that are giving me trouble.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"strconv\"\n    \"strings\"\n    \"os\"\n    \"container/list\"\n)\n\ntype Student struct {\n    FirstName string\n    LastName  string\n    testScore int\n    homeworkScore int\n}\n\nfunc main() {\n\n    fmt.Println(\"What is the name of your file?\\n\") \n    var filename string \n    fmt.Scan(&amp;filename)\n\n    file, err := os.Open(filename)\n    if err != nil {\n     log.Fatal(err)\n    }\n    scanner := bufio.NewScanner(file)\n    //var numLineCount int = 0\n    var gradeCount = 0\n\n    var student Student\n    var studentList list.List\n    var studentCount int = 1\n\n    for scanner.Scan() {\n        line := scanner.Text()\n\n        fields := strings.Fields(line)\n        student.FirstName = fields[0]\n\n        student.LastName = fields[1]\n\n        scanner.Scan()\n        line2 := scanner.Text()\n        sum := 0\n        gradeCount = 0\n        for _, field := range strings.Fields(line2) {\n            n, err := strconv.Atoi(field)\n            if err != nil {\n                        log.Fatal(err)\n                    }\n            gradeCount++\n            sum += n\n        }\n        student.testScore = sum/gradeCount\n        gradeCount = 0\n\n        scanner.Scan()\n        line3 := scanner.Text()\n        sum2 := 0\n        for _, field := range strings.Fields(line3) {\n            n, err := strconv.Atoi(field)\n            if err != nil {\n                        log.Fatal(err)\n                    }\n            gradeCount++\n            sum2 += n\n        }\n        student.homeworkScore = sum2/gradeCount\n        studentList.PushBack(studentCount)\n        studentCount++\n\n        fmt.Println(\"First:\", student.FirstName, \"Last:\", student.LastName, \"Test Avg:\", student.testScore, \"Homework Avg:\", student.homeworkScore)\n        }\n        test:=studentList.Front()\n        fmt.Println(test.FirstName)\n\n    }\n</code></pre>\n\n<p>update: so I figured out i can't use test.FirstName in the println part, just Println(test) works and prints everything. but I still need to be able to access each element of the list. How can I do so?</p>\n"}, {"tags": ["go", "mux"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1562031997, "post_id": 56844095, "comment_id": 100240102, "body": "What is <code>imageOutput.Name()</code> file?"}, {"owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1562071801, "post_id": 56844095, "comment_id": 100255774, "body": "It is the name of the file I am adding"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1562075042, "post_id": 56844095, "comment_id": 100257802, "body": "This code copies the contents of a file on disk to another location on disk. Afterward, I would expect to have two copies of the file (the one at path <code>imageOutput.Name()</code> and the one at path <code>.&#47;images&#47;...</code>). The code shown will not make any <i>more</i> copies than that."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1562097310, "post_id": 56844095, "comment_id": 100268420, "body": "I think you make a error where in the line io.copy. You name dst as the source and imageSave as the destination. While imageSave is the file you are reading."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1562103476, "post_id": 56844095, "comment_id": 100270542, "body": "@Dippo <code>os.Create</code> may not be an image source, it&#39;s empty"}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1562104562, "post_id": 56844095, "comment_id": 100270823, "body": "@zerkms Yes you are right, i wanted also to say that, but i think the question is wrong, but also, the code is confusing. So, fix the code, will fix the problem. Or, make the problem easier to understand."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1562104977, "post_id": 56844095, "comment_id": 100270938, "body": "@zerkms Also, i forgot to mention, the io,copy function is confusing. I would also think that you first need the source followed by the destination. But, it&#39;s the other way around. Silly mistake made by Google if you ask me."}, {"owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1562112189, "post_id": 56844095, "comment_id": 100272366, "body": "@Dippo, I was going to say that io.Copy() takes destination first then source, then I saw your latest comment haha. The problem is that the file that I want to save (imageSave) is being saved in the root of the project folder <i>in addition</i> to the folder it is supposed to be saved in (./images). os.Create will create an empty file (dst) and io.Copy() will copy the contents of imageSave into dst."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1562115251, "post_id": 56844095, "comment_id": 100272790, "body": "@Sasank Ganapathiraju True, but the code is not correct. ImageSave is the source, while the name states it&#39;s the destination. If you rename it to imageLoad, it make more sense."}, {"owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1562115430, "post_id": 56844095, "comment_id": 100272820, "body": "@Dippo Do you mean the variable names are confusing? or that the use of imageSave itself is causing the problem"}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1562116139, "post_id": 56844095, "comment_id": 100272916, "body": "@Sasank Ganapathiraju Yes, only confusing. If you rename it, you also see that the line with the file.Copy is not correct."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1562121897, "post_id": 56844095, "comment_id": 100273780, "body": "&quot; (imageSave) is being saved&#39; --- it&#39;s not &quot;being saved&quot; , it <b>already</b> is there."}], "owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562029400, "creation_date": 1562029400, "question_id": 56844095, "link": "https://stackoverflow.com/questions/56844095/file-being-copied-into-root-directory-as-well-as-target-directory", "title": "File being copied into root directory as well as target directory", "body": "<p>I recently started working with Go and ran into a small problem. Below is my code for saving a file into the \"./images\" directory. While the code works and the files are being saved into \"./images\", the file is also being saved into the root directory of the project simultaneously. TL;DR: File is being saved twice (into root, as well as target) when it should only be saved once in the target directory</p>\n\n<pre><code>// Save\nimageSave, err := os.Open(imageOutput.Name())\nif err != nil {\n    log.Fatal(err)\n}\n\ndefer imageSave.Close()\n\ndir := \"./images\"\ndst, err := os.Create(filepath.Join(dir, filepath.Base(imageOutput.Name())))\nif err != nil {\n    log.Fatal(err)\n}\ndefer dst.Close()\ndefer imageOutput.Close()\n\n_, err = io.Copy(dst, imageSave)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["go", "data-structures", "binary-tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1562026147, "post_id": 56843662, "comment_id": 100239131, "body": "You need to decide which side of the tree then if the node isn&#39;t nil recurse, else just add it there. Note that you need to make sure you handle the case where the data values are equal."}, {"owner": {"reputation": 328, "user_id": 8414454, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rEJ6wpSY5_k/AAAAAAAAAAI/AAAAAAAAAIw/paPqUdlmWAA/photo.jpg?sz=128", "display_name": "Ikechukwu Anude", "link": "https://stackoverflow.com/users/8414454/ikechukwu-anude"}, "reply_to_user": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1562027243, "post_id": 56843662, "comment_id": 100239304, "body": "Thank you for responding. I need to decide which side of the tree to add the node on (is that what you are asking)? Values lower than the node should insert on the left while values higher than a node should insert on the right."}, {"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1562027845, "post_id": 56843662, "comment_id": 100239407, "body": "Sorry I didn&#39;t explain well. The first things is to decide which side of the node it goes - so you need a 2 way branch (if) not 3 way as you have.  Within each side: if the branch is nil just add it there otherwise recursively add it to that sub-tree.  I added some code in the answer below. (I did it off the top of my head and it had a bug but is fixed now)."}, {"owner": {"reputation": 328, "user_id": 8414454, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rEJ6wpSY5_k/AAAAAAAAAAI/AAAAAAAAAIw/paPqUdlmWAA/photo.jpg?sz=128", "display_name": "Ikechukwu Anude", "link": "https://stackoverflow.com/users/8414454/ikechukwu-anude"}, "reply_to_user": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1562081087, "post_id": 56843662, "comment_id": 100261498, "body": "Okay, your solution works! Thank you very very much!"}], "answers": [{"tags": [], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "is_accepted": true, "score": 1, "last_activity_date": 1562027996, "last_edit_date": 1562027996, "creation_date": 1562026390, "answer_id": 56843836, "question_id": 56843662, "link": "https://stackoverflow.com/questions/56843662/how-to-implement-inorder-traversal-in-a-binary-tree-in-golang/56843836#56843836", "title": "How to implement Inorder Traversal in a Binary Tree in Golang", "body": "<p>This code will insert duplicate on the right.  You may want to ignore duplicates (with commented out line).</p>\n\n<pre><code>func (n *Node) insert(newNode *Node){\n    if newNode.data &lt; n.data {\n        if n.left == nil {\n            n.left = newNode\n        } else {\n            n.left.insert(newNode)\n        }\n    } else {\n    //} else if newNode.data &gt; n.data {\n        if n.right == nil {\n            n.right = newNode\n        } else {\n            n.right.insert(newNode)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 8414454, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rEJ6wpSY5_k/AAAAAAAAAAI/AAAAAAAAAIw/paPqUdlmWAA/photo.jpg?sz=128", "display_name": "Ikechukwu Anude", "link": "https://stackoverflow.com/users/8414454/ikechukwu-anude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 56843836, "answer_count": 1, "score": 1, "last_activity_date": 1562027996, "creation_date": 1562024366, "question_id": 56843662, "link": "https://stackoverflow.com/questions/56843662/how-to-implement-inorder-traversal-in-a-binary-tree-in-golang", "title": "How to implement Inorder Traversal in a Binary Tree in Golang", "body": "<p>I am trying to implement a simple binary tree in Golang in order to understand concepts being taught in class.</p>\n\n<p>I'm a bit new to Golang but at the same time, I'm having a hard time wrapping my head around the concepts of recursion and where to insert the next node. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Node struct {\n    data int\n    right *Node\n    left *Node\n}\n\nfunc main(){\n\n    //driver code\n\n    //this is the root of the tree\n    root := Node{data:6}\n\n    //set the data to the int\n    //set the right and left pointers to null\n    /*\n     6\n   /   \\\n nil   nil\n\n */\n\n n1 := Node{data: 8}\n n2 := Node{data: 4}\n n3 := Node{data: 10}\n root.insert(&amp;n1)\n root.insert(&amp;n2)\n root.insert(&amp;n3)\n\n inorder(&amp;root)\n\n}\n\nfunc (n *Node) insert(newNode *Node){\n    if n.left == nil &amp;&amp; newNode.data &lt; n.data {\n        fmt.Println(\"added to the left\")\n    }else if n.right == nil &amp;&amp; newNode.data &gt; n.data {\n        fmt.Println(\"added to the right\")\n    }else{\n        print(\"recurse\")\n        n.insert(newNode)\n    }\n}\n\nfunc inorder(rt *Node){\n    if rt == nil {\n        fmt.Print(\"|\")\n        return\n    }\n\n    inorder(rt.left)\n    fmt.Print(rt.data)\n    inorder(rt.right)\n}\n</code></pre>\n\n<p>The output I am getting is:</p>\n\n<pre><code>added to the right\nadded to the left\nadded to the right\n|6|\n</code></pre>\n\n<p>The expected output should be:</p>\n\n<pre><code>added to the right\nadded to the left\nrecurse\nadded to the right\n4 6 8 10\n</code></pre>\n\n<p>Any help is greatly appreciated. </p>\n"}, {"tags": ["loops", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562020254, "post_id": 56843108, "comment_id": 100238084, "body": "Show what you tried so far."}, {"owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562020678, "post_id": 56843108, "comment_id": 100238165, "body": "@CeriseLim&#243;n edited it. I&#39;ve tried more than this but to no avail, this is just kind of a test so far"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "edited": false, "score": 0, "creation_date": 1562022226, "post_id": 56843362, "comment_id": 100238475, "body": "Wow this looks great. Thank you so much. I&#39;ve done pretty much this exact assignment in java before but I&#39;m just really struggling with learning Go. Thanks again"}], "tags": [], "owner": {"reputation": 36, "user_id": 11726581, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/39378872423c9623ca83e9cb435c344e?s=128&d=identicon&r=PG", "display_name": "JohnSimith360", "link": "https://stackoverflow.com/users/11726581/johnsimith360"}, "is_accepted": true, "score": 2, "last_activity_date": 1562021520, "creation_date": 1562021520, "answer_id": 56843362, "question_id": 56843108, "link": "https://stackoverflow.com/questions/56843108/how-to-loop-through-a-text-file-with-lines-consisting-of-multiple-numbers-while/56843362#56843362", "title": "How to loop through a text file with lines consisting of multiple numbers, while counting the numbers", "body": "<p>The easiest approach is to loop through the file by lines. Something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype Student struct {\n    FirstName string\n    LastName  string\n}\n\nfunc main() {\n    fmt.Println(\"What is the name of your file?\\n\") var filename string \n    fmt.Scan(&amp;filename)\n\n    file, err := os.Open(filename)\n    if err != nil {\n     log.Fatal(err)\n    }\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n        line := scanner.Text()\n        if len(line) == 0 {\n            // skip blank lines\n            continue\n        }\n        if '0' &lt;= line[0] &amp;&amp; line[0] &lt;= '9' {\n            sum := 0\n            for _, field := range strings.Fields(line) {\n                n, err := strconv.Atoi(field)\n                if err != nil {\n                    log.Fatal(err)\n                }\n                sum += n\n            }\n            fmt.Println(sum)\n        } else {\n            fields := strings.Fields(line)\n            if len(fields) != 2 {\n                log.Fatal(\"don't know how to get first name last name\")\n            }\n            fmt.Println(\"First:\", fields[0], \"Last:\", fields[1])\n        }\n    }\n    if err := scanner.Err(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/tRv-ahQSxvL\" rel=\"nofollow noreferrer\">See it on the playgrOund</a>.</p>\n"}], "owner": {"reputation": 63, "user_id": 8930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11e879b50e956299366989f01570f6?s=128&d=identicon&r=PG&f=1", "display_name": "dcalvert", "link": "https://stackoverflow.com/users/8930163/dcalvert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 56843362, "answer_count": 1, "score": 0, "last_activity_date": 1562051476, "creation_date": 1562019345, "last_edit_date": 1562051476, "question_id": 56843108, "link": "https://stackoverflow.com/questions/56843108/how-to-loop-through-a-text-file-with-lines-consisting-of-multiple-numbers-while", "title": "How to loop through a text file with lines consisting of multiple numbers, while counting the numbers", "body": "<p>The file looks something like:</p>\n\n<pre><code>John Smith\n100 90 80 90\n50 60 80 99 40 20\n</code></pre>\n\n<p>But there can be any number of people/grades in the file. I know how to loop through and get the first and last name of the person, but how can I loop through the first line of numbers, add them to their own total, then loop through the second line and add them to another total? </p>\n\n<p>I've not found a way to check for the end of a line in Go, so I don't know how to distinguish the first line of numbers from the second line.</p>\n\n<p>This is what I've tried:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\" \n    \"os\"\n    \"log\"\n    \"bufio\"\n    //\"unicode\"\n    //\"container/list\"\n)\n\ntype Student struct {\n    FirstName string\n    LastName string\n}\n\n\nfunc main(){\n    fmt.Println(\"What is the name of your file?\\n\")\n    var filename string\n    fmt.Scan(&amp;filename)\n\n    file, err := os.Open(filename)\n    if err != nil {\n        log.Fatal(err)\n    }\n    scanner := bufio.NewScanner(file)\n    scanner.Split(bufio.ScanWords)\n    //var scanCount int = 0\n    //var studentCount = 1\n    //var gradeSum = 0\n    //var gradeAvg = 0\n\n    var students [100]Student\n\n    for scanner.Scan() {\n        students[0].FirstName = scanner.Text()\n        students[0].LastName = scanner.Text()\n        fmt.Println(students[0].FirstName)\n\n        //count ++\n\n    }\n\n}\n</code></pre>\n\n<p>This is what I have so far. Everything I've tried involving the numbers has not worked so I've removed it.</p>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 1, "creation_date": 1562016111, "post_id": 56842385, "comment_id": 100237049, "body": "Have you tried disabling modules when installing tools? For example, <code>GO111MODULE=off GO111MODULE=off go get -v golang.org&#47;x&#47;text</code>"}, {"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "reply_to_user": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562016459, "post_id": 56842385, "comment_id": 100237144, "body": "This could work, but I\u2019m assuming it\u2019s not a long-term fix. Isn\u2019t GO111MODULE will be ignored at some point in a newer go version when Go Modules are widely used?"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 1, "creation_date": 1562016721, "post_id": 56842385, "comment_id": 100237233, "body": "I think that&#39;s far away in the horizon until everyone adapts modules. One other solution would be to change directories before installing tools. <code>go.mod</code> won&#39;t be in the current directory and modules will be disabled."}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 0, "creation_date": 1564676913, "post_id": 56842385, "comment_id": 101118795, "body": "Just to clarify, it is not true that modules will be disabled if you change directories to somewhere without a <code>go.mod</code>. More details in <a href=\"https://stackoverflow.com/a/57313319/11210494\">answer</a> below."}], "answers": [{"comments": [{"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1562024933, "post_id": 56842890, "comment_id": 100238966, "body": "1. Sadly <code>go get -mod=readonly github.com&#47;mitchellh&#47;gox</code> still updates <code>go.mod</code>. This could be a legit golang issue, however. 2. rest of the sentence you quoted goes like <code>...Instead, it fails when any changes to go.mod are needed.</code>"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562062789, "post_id": 56842890, "comment_id": 100250783, "body": "<code>go get -mod=readonly</code> will be fixed in 1.13 <a href=\"https://github.com/golang/go/issues/30667\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/30667</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562074561, "post_id": 56842890, "comment_id": 100257509, "body": "@georgeok that issue is unrelated."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1562017851, "last_edit_date": 1592644375, "creation_date": 1562017851, "answer_id": 56842890, "question_id": 56842385, "link": "https://stackoverflow.com/questions/56842385/using-go-get-to-download-binaries-without-adding-them-to-go-mod/56842890#56842890", "title": "Using &quot;go get&quot; to download binaries without adding them to go.mod", "body": "<p>Per <code>go help build</code>:</p>\n<blockquote>\n<p>The -mod build flag provides additional control over updating and use of go.mod.</p>\n<p>If invoked with -mod=readonly, the go command is disallowed from the implicit automatic updating of go.mod</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2088, "user_id": 3309046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ce388de97238b3147f3d4ba62b17cb?s=128&d=identicon&r=PG", "display_name": "nishanthshanmugham", "link": "https://stackoverflow.com/users/3309046/nishanthshanmugham"}, "edited": false, "score": 0, "creation_date": 1610706283, "post_id": 57313319, "comment_id": 116222553, "body": "The suggested edit queue is full, so I&#39;m adding a comment instead. <a href=\"https://github.com/golang/go/issues/40276\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/40276</a> tracks the proposal, which is implemented in CL <a href=\"https://go-review.googlesource.com/c/go/+/254365\" rel=\"nofollow noreferrer\">go-review.googlesource.com/c/go/+/254365</a>. This will most likely be included in Go 1.16, and you can run <code>go install github.com&#47;foo&#47;bar@latest</code> to install a command without changing go.mod."}], "tags": [], "owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "is_accepted": true, "score": 4, "last_activity_date": 1564700424, "last_edit_date": 1564700424, "creation_date": 1564676768, "answer_id": 57313319, "question_id": 56842385, "link": "https://stackoverflow.com/questions/56842385/using-go-get-to-download-binaries-without-adding-them-to-go-mod/57313319#57313319", "title": "Using &quot;go get&quot; to download binaries without adding them to go.mod", "body": "<p>Hopefully in Go 1.14 there will be a new flag for <code>go get</code> that does exactly what you are asking. This is tracked in issue <a href=\"https://github.com/golang/go/issues/30515\" rel=\"nofollow noreferrer\">#30515</a> \"cmd/go: offer a consistent global install command\".</p>\n\n<p>Prior to that, you have a few different options.</p>\n\n<h3>Go 1.12 and 1.13: change directory</h3>\n\n<p>If you are using Go 1.12 or later, the simplest solution is probably to move outside your current module to a directory without a <code>go.mod</code> prior to doing the <code>go get</code>, such as:</p>\n\n<pre><code>$ cd /tmp                              \n$ go get github.com/foo/bar@v1.2.3\n$ cd -                                # return to prior directory\n</code></pre>\n\n<h3>Go 1.11, 1.12, 1.13+: gobin</h3>\n\n<p><a href=\"https://github.com/myitcv/gobin\" rel=\"nofollow noreferrer\">gobin</a> is a module-aware command to install or run binaries that provides additional flexibility, including the ability to install without altering your current module's <code>go.mod</code>. See the <code>gobin</code> <a href=\"https://github.com/myitcv/gobin#usage\" rel=\"nofollow noreferrer\">README</a> and <a href=\"https://github.com/myitcv/gobin/wiki/FAQ\" rel=\"nofollow noreferrer\">FAQ</a> for more details.</p>\n\n<h3>Go 1.11: temporary module</h3>\n\n<p>If you are using Go 1.11 with modules, the first step is probably to upgrade to Go 1.12 or 1.13 given there are many improvements in modules. If you are required to use Go 1.11 and want to use the <code>@version</code> syntax without updating your current module's <code>go.mod</code>, then one approach is to create a temporary module:</p>\n\n<pre><code>cd $(mktemp -d) &amp;&amp; go mod init tempmod &amp;&amp; go get github.com/foo/bar@v1.2.3\n</code></pre>\n\n<p>This is because in Go 1.11, you can't use the <code>@version</code> syntax unless you are in a module, which was relaxed in Go 1.12. This approach has been automated by a <a href=\"https://gist.github.com/rogpeppe/7de05eef4dd774056e9cf175d8e6a168\" rel=\"nofollow noreferrer\">simple shell script</a> by <a href=\"https://github.com/rogpeppe\" rel=\"nofollow noreferrer\">@rogpeppe</a>.</p>\n\n<h3>Additional Details</h3>\n\n<p>In general, the <code>go</code> command in module-module always determines what module it is \"in\", which is based on the current working directory when you invoke the <code>go</code> command.  (You could make an analogy to how <code>make</code> without any args will look for a makefile in the current working directory, or how historically <code>go build</code> without any args will build the current working directory, etc.).  </p>\n\n<p>With modules, <code>go get</code> looks for a <code>go.mod</code> file in the current working directory or any of its parents, and <code>go get</code> will use the constraints listed in any <code>go.mod</code> as part of solving for versions, as well as update the <code>go.mod</code> if needed based on doing the <code>go get</code>. That is why your <code>go.mod</code> file is updated if you run <code>go get</code> from within an existing module.</p>\n\n<p>On the other hand, starting with Go 1.12, if you are in a directory that is not part of any module (that is, the directory does not have a <code>go.mod</code>, nor do any of its parents), then there is no <code>go.mod</code> to update, but the <code>go</code> command is still able to operate in module mode and use the <code>@version</code> syntax.</p>\n\n<p>From the <a href=\"https://golang.org/doc/go1.12#modules\" rel=\"nofollow noreferrer\">Go 1.12 release notes</a>:</p>\n\n<blockquote>\n  <p>When GO111MODULE is set to on, the go command now supports module-aware operations outside of a module directory, provided that those operations do not need to resolve import paths relative to the current directory or explicitly edit the go.mod file. Commands such as go get, go list, and go mod download behave as if in a module with initially-empty requirements. In this mode, go env GOMOD reports the system's null device (/dev/null or NUL).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "edited": false, "score": 1, "creation_date": 1619095554, "post_id": 65734439, "comment_id": 118804767, "body": "Note, <code>@latest</code> or similar is required for this to work"}], "tags": [], "owner": {"reputation": 2088, "user_id": 3309046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ce388de97238b3147f3d4ba62b17cb?s=128&d=identicon&r=PG", "display_name": "nishanthshanmugham", "link": "https://stackoverflow.com/users/3309046/nishanthshanmugham"}, "is_accepted": false, "score": 6, "last_activity_date": 1615210763, "last_edit_date": 1615210763, "creation_date": 1610706593, "answer_id": 65734439, "question_id": 56842385, "link": "https://stackoverflow.com/questions/56842385/using-go-get-to-download-binaries-without-adding-them-to-go-mod/65734439#65734439", "title": "Using &quot;go get&quot; to download binaries without adding them to go.mod", "body": "<h1>Go 1.16 onwards</h1>\n<p>Go 1.16 (released February 2021) includes a change that makes it possible to install a binary without affecting <code>go.mod</code>.</p>\n<p>Issue <a href=\"https://github.com/golang/go/issues/40276\" rel=\"nofollow noreferrer\">40276</a> tracks the proposal:</p>\n<blockquote>\n<p>cmd/go: 'go install' should install executables in module mode outside a module</p>\n</blockquote>\n<p>This was implemented in CL <a href=\"https://go-review.googlesource.com/c/go/+/254365\" rel=\"nofollow noreferrer\">254365</a>. As part of this change, if I understand correctly, you can run:</p>\n<pre><code>go install github.com/foo/bar@latest \n</code></pre>\n<p>to install a command without affecting <code>go.mod</code>.</p>\n"}], "owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6956, "favorite_count": 5, "accepted_answer_id": 57313319, "answer_count": 3, "score": 10, "last_activity_date": 1615210763, "creation_date": 1562014653, "last_edit_date": 1562025214, "question_id": 56842385, "link": "https://stackoverflow.com/questions/56842385/using-go-get-to-download-binaries-without-adding-them-to-go-mod", "title": "Using &quot;go get&quot; to download binaries without adding them to go.mod", "body": "<p>I'm using Go modules in my project and in my build system (e.g. Travis CI) I'm downloading a command-line utility (written in Go) with <code>go get</code> to assist with my build process, e.g.:</p>\n\n<pre><code>go get github.com/mitchellh/gox\n</code></pre>\n\n<p>However, this <code>go get</code> causes the file to be added to my <code>go.mod</code> file. This is contaminating the build environment, causing it to be \"dirty\" (since there are changes to some files tracked in git, in this case go.mod and go.sum), and I use <code>git describe --always --dirty --tag</code> to describe my build, which shows up as \"dirty\".</p>\n\n<p>Is there a way to \"go get\" a binary just to download it, without adding it to the go.mod/go.sum?</p>\n\n<p>I've tried setting GOPATH to somewhere else, even then, <code>go get</code> updates the go.mod/go.sum to add this as an <code>// indirect</code> dependency.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>dir=\"$(mktemp -d)\"; \\\n  env GOPATH=\"$dir\" go get github.com/mitchellh/gox &amp;&amp; \\\n  mv \"$dir/bin/gox\" \"$(go env GOPATH)\"/bin/gox\n</code></pre>\n"}, {"tags": ["sockets", "go", "zeromq"], "comments": [{"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 0, "creation_date": 1562177227, "post_id": 56840871, "comment_id": 100300065, "body": "Welcome to the StackOverflow. Would you mind to complete the problem definition so as to allow it to become the Community preferred MCVE? The <b>M</b>inimum <b>C</b>omplete <b>V</b>erifiable <b>E</b>xample of the problem representation. Both the dimension-C and dimension-V are not met. Maybe complete the MCVE using the  prototyped, run-able MCVE to demonstrate your problem representation, as was sketched in <a href=\"https://tio.run/##S8///z8ztyC/qESDSwEIlNJyS5QgrPxiCKMqt1BBKT2zJKM0SS85P1e/IDUpKVUfKGqixKXJpaen9/8/AA\" rel=\"nofollow noreferrer\">tio.run/##S8///z8ztyC/&hellip;</a> and post here a note, once the MCVE is live and running a <b>V</b>erifiable mode of the problem above"}, {"owner": {"reputation": 2350, "user_id": 3924566, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100006525577404/picture?type=large", "display_name": "Deepak Saini", "link": "https://stackoverflow.com/users/3924566/deepak-saini"}, "edited": false, "score": 0, "creation_date": 1589363085, "post_id": 56840871, "comment_id": 109261162, "body": "Hi, have you been able to solve this issue? I am facing a similar issue"}, {"owner": {"reputation": 31, "user_id": 11725623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7586ce7005681f1ef0129a760ca173a1?s=128&d=identicon&r=PG&f=1", "display_name": "mikerubbertoe", "link": "https://stackoverflow.com/users/11725623/mikerubbertoe"}, "edited": false, "score": 0, "creation_date": 1589481523, "post_id": 56840871, "comment_id": 109319702, "body": "What I found out was that zeromq does not play well with different threads. If you define a socket in one thread and use it in another thread, the results are undefined and weird things can happen (like not receive messages). In the post above, the problem wasnt with the one api, it was with the amount of data that we were receiving. After around 20,000 messages came through on the socket, the socket just stopped receiving messages. After we read and wrote from the socket in one thread, it fixed the problem"}], "owner": {"reputation": 31, "user_id": 11725623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7586ce7005681f1ef0129a760ca173a1?s=128&d=identicon&r=PG&f=1", "display_name": "mikerubbertoe", "link": "https://stackoverflow.com/users/11725623/mikerubbertoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1562013016, "creation_date": 1562006574, "last_edit_date": 1562013016, "question_id": 56840871, "link": "https://stackoverflow.com/questions/56840871/zeromq-socket-doesnt-receive-data-when-in-a-goroutine", "title": "ZeroMQ socket doesn&#39;t receive data when in a goroutine", "body": "<p>I am setting up a socket in Go to send and receive data to and from an API which uses ZeroMQ for communication. We need to use goroutines. I understand that ZMQ sockets are extremely not thread safe and to make sure they function properly, all sending and receiving should be done in the same thread.</p>\n\n<p>I can receive all data from all API requests except for one piece of data from one specific API call, a heartbeat that we need to respond to in order to keep the connection alive.</p>\n\n<p>In this API, there are multiple requests that can be made that can result in data being sent back as well as a heartbeat request. Every other API request will send back the data, wait around 5 seconds, then send the heartbeat request needed to keep the connection alive. When the code is run using a single thread, we can receive the heartbeat from every API call. However, when I run that same function through a goroutine, I get back the heartbeat request from every API function EXCEPT for one of them. </p>\n\n<p>Setting up the socket</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import(\n    \"fmt\"\n    \"os\"\n    zmq \"github.com/pebbe/zmq4\"\n)\n\nfunc testCode() {\n    context, err := zmq.NewContext()\n\n    if err != nil {\n        fmt.Println(\"context err: \", err)\n        return\n    }\n\n    //create Request Socket to talk to Request Server\n    fmt.Fprint(os.Stdout,\"Attempting to connect to Request Server...\")\n    sock, err := context.NewSocket(zmq.DEALER)\n    if err != nil {\n        fmt.Println(\"socket err: \", err)\n        return\n    }\n\n    connection.RequestSocket = sock\n\n    err = connection.RequestSocket.Connect(REQUEST_URL)\n    if err != nil {\n        fmt.Println(\"connect err: \", err)\n        return\n    }\n}\n\n\n//build the data to be sent up here\n\n    ...\n\n    _, err := socket.SendBytes(bufToSend, 0)\n    if err != nil {\n        fmt.Println(\"send err: \", err)\n        return\n    }\n\n//receive all necessary data from the server\n    for mask &amp; info == 0 { \n        reply, err := socket.RecvBytes(0)\n        if err != nil {\n            fmt.Println(\"err: \", err)\n            return\n        }\n        //process the data\n        ...\n}\n</code></pre>\n\n<p>So, when I run this main function in a different file, we receive all the correct data and heartbeat requests from every API request</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    testCode()\n    for {\n    }\n}\n</code></pre>\n\n<p>However, when I make testCode() a goroutine (as shown below), I fail to receive a heartbeat request for only one of the API calls</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    go testCode()\n    for {\n    }\n}\n</code></pre>\n\n<p>What is also interesting is that I monitored all TCP coming in and out of the port we talk to via and have confirmed that the heartbeat requests <strong>are</strong> being sent by the API. So, the heartbeat request is being sent, the data is being recognized by Wireshark as a message coming back from the API but I am not receiving it through the socket for one specific API call. Every other API call sends the heartbeat request and I can see in my program that I received them.</p>\n\n<p>I have made sure that all creation, sending, and receiving for the socket has been done within one thread. I am confused as to why this problem is happening and why it only occurs for only one of the API calls and not all of them.</p>\n\n<p>UPDATE: Apparently for the API call that doesn't receive the heartbeat, I do not receive all the data from the API. I receive about 18910 messages out of the 36872 messages that need to be sent. I don't know why after some time it just stops sending messages when in a goroutine</p>\n"}, {"tags": ["go", "go-modules", "go-build"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 10, "creation_date": 1561999993, "post_id": 56839174, "comment_id": 100231369, "body": "You can&#39;t run <code>go build</code> in <code>example.com&#47;my-project</code>, because there&#39;s nothing to build. The main package you&#39;re building is called <code>example.com&#47;my-project&#47;main</code>"}, {"owner": {"reputation": 499, "user_id": 9903859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8956511dc438a5e2302451a556171723?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/9903859/nicholas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1562009426, "post_id": 56839174, "comment_id": 100234836, "body": "Oh, I see! If you make that into an answer I&#39;ll vote for it."}, {"owner": {"reputation": 12759, "user_id": 2263631, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/WC0BS.jpg?s=128&g=1", "display_name": "Script47", "link": "https://stackoverflow.com/users/2263631/script47"}, "edited": false, "score": 1, "creation_date": 1562314518, "post_id": 56839174, "comment_id": 100343608, "body": "<a href=\"https://meta.stackoverflow.com/questions/386846/how-can-i-improve-this-downvoted-question\">This question is being discussed on meta.</a>"}], "answers": [{"tags": [], "owner": {"reputation": 673, "user_id": 1595262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82cb7b22459aaa7eae5f8a3a0c6bf91?s=128&d=identicon&r=PG", "display_name": "Itamar Lavender", "link": "https://stackoverflow.com/users/1595262/itamar-lavender"}, "is_accepted": true, "score": 2, "last_activity_date": 1563468773, "creation_date": 1563468773, "answer_id": 57099345, "question_id": 56839174, "link": "https://stackoverflow.com/questions/56839174/how-to-fix-go-build-error-cant-load-package-with-go-modules/57099345#57099345", "title": "How to fix Go build error &quot;can&#39;t load package&quot; with Go modules?", "body": "<p>no need for the directory main,\njust move your main.go and go.mod to example.com/my-project and it will work.</p>\n\n<p>Project root should look like:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 go.mod\n\u2514\u2500\u2500 main.go\n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 9903859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8956511dc438a5e2302451a556171723?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/9903859/nicholas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11694, "favorite_count": 1, "accepted_answer_id": 57099345, "answer_count": 1, "score": 17, "last_activity_date": 1563468773, "creation_date": 1561998547, "last_edit_date": 1562239041, "question_id": 56839174, "link": "https://stackoverflow.com/questions/56839174/how-to-fix-go-build-error-cant-load-package-with-go-modules", "title": "How to fix Go build error &quot;can&#39;t load package&quot; with Go modules?", "body": "<p>I'm setting up a new project using Go modules with <a href=\"https://bogotobogo.com/GoLang/GoLang_Modules_1_Creating_a_new_module.php\" rel=\"noreferrer\">this tutorial</a>, and then trying to build it.</p>\n\n<p>The module is located in a folder outside of the $GOPATH with the following structure:</p>\n\n<pre><code>example.com\n\u251c\u2500\u2500 my-project\n\u251c\u2500\u2500 \u251c\u2500\u2500 main\n\u251c\u2500\u2500 \u251c\u2500\u2500 \u251c\u2500\u2500 main.go\n\u251c\u2500\u2500 \u251c\u2500\u2500 go.mod\n</code></pre>\n\n<p>I've run <code>go mod init example.com/my-project</code> in directory <code>example.com/my-project</code> and created the go.mod file shown above.</p>\n\n<p><code>main.go</code> has basic contents:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n\"fmt\"\n)\nfunc main(){\n fmt.Println(\"Hello, world!\")\n}\n</code></pre>\n\n<p>After attempting to run <code>go build</code> in directory <code>example.com/my-project</code>, I receive the following error message:</p>\n\n<p><code>can't load package: package example.com/my-project: unknown import path \"example.com/my-project\": cannot find module providing package example.com/my-project</code>.</p>\n\n<p>I've also attempted to run <code>go build</code> in directory <code>/</code>, outside of <code>example.com/my-project</code>, and I get similar, failing results:</p>\n\n<p><code>can't load package: package .: no Go files in ...</code></p>\n\n<p>I'm probably getting some basic thing wrong, so thanks for your patience and any help you can give.</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-sdk-go", "amazon-comprehend"], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 5745183, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d8e4f639f9ca90ecdc6fc836e6313d72?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/5745183/saurabh-sharma"}, "edited": false, "score": 0, "creation_date": 1562344081, "post_id": 56863557, "comment_id": 100357719, "body": "I was able to solve this with comprehend.Entity. Thanks"}], "tags": [], "owner": {"reputation": 56, "user_id": 3741211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/642fc6f3513174c0bf482a957462229a?s=128&d=identicon&r=PG&f=1", "display_name": "thegreyd", "link": "https://stackoverflow.com/users/3741211/thegreyd"}, "is_accepted": true, "score": 1, "last_activity_date": 1562132364, "creation_date": 1562132364, "answer_id": 56863557, "question_id": 56837285, "link": "https://stackoverflow.com/questions/56837285/how-to-filter-only-organization-entities-in-detectentitiesoutput/56863557#56863557", "title": "How to filter Only Organization entities in DetectEntitiesOutput?", "body": "<p>The compiler cannot find definition of <code>Entity</code> struct. Make sure it's present in the same package or if it's from a different package you would replace <code>Entity</code> with <code>packageName.Entity</code>.</p>\n"}], "owner": {"reputation": 195, "user_id": 5745183, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d8e4f639f9ca90ecdc6fc836e6313d72?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/5745183/saurabh-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56863557, "answer_count": 1, "score": 0, "last_activity_date": 1586235620, "creation_date": 1561990605, "last_edit_date": 1586235620, "question_id": 56837285, "link": "https://stackoverflow.com/questions/56837285/how-to-filter-only-organization-entities-in-detectentitiesoutput", "title": "How to filter Only Organization entities in DetectEntitiesOutput?", "body": "<p>I am new to Go language and trying picking it up , so pardon for any obvious issues but need some help.. </p>\n\n<p>Question : I am trying to filter only Organization Entities returned in by Comprehend in DetectEntitiesOutput.. </p>\n\n<p>My imports are following</p>\n\n<pre><code>    \"errors\"\n    \"fmt\"\n    \"strings\"\n\n    \"github.com/aws/aws-lambda-go/lambda\"\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/comprehend\"\n\n    func Filter(vs []Entity, f func(Entity) bool) []Entity {\n    vsf := make([]Entity, 0)\n    for _, v := range vs {\n    if f(v) {\n    vsf = append(vsf, v)\n    }\n    }\n    return vsf\n    }\n\n    func isOrg(vs Entity) bool {\n    return strings.EqualFold(Entity.Type, \"ORGANIZATION\")\n    }```\n\n\nBut i am getting following error ./main.go:52:18: undefined: Entity\n./main.go:53:16: undefined: Entity\n./main.go:62:15: undefined: Entity\n./main.go:63:27: undefined: Entity\n\nCan someone help?\n</code></pre>\n"}, {"tags": ["docker", "go", "docker-api", "docker-engine"], "comments": [{"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1562014543, "post_id": 56835435, "comment_id": 100236609, "body": "Can you do curl from wherever your go program is running?"}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1562076032, "post_id": 56835435, "comment_id": 100258422, "body": "Why not? Start an ubuntu container or something and run curl from inside of it"}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1562076062, "post_id": 56835435, "comment_id": 100258441, "body": "Or use something like this <a href=\"https://hub.docker.com/r/pstauffer/curl/\" rel=\"nofollow noreferrer\">hub.docker.com/r/pstauffer/curl</a>"}], "owner": {"reputation": 89, "user_id": 8303572, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/29250047cb69a82e142c1dbbd2abf226?s=128&d=identicon&r=PG&f=1", "display_name": "MLGonc", "link": "https://stackoverflow.com/users/8303572/mlgonc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1561982902, "creation_date": 1561982902, "question_id": 56835435, "link": "https://stackoverflow.com/questions/56835435/docker-engine-api-connection-reset-by-peer", "title": "Docker Engine API - Connection reset by peer", "body": "<p>I'm trying to make requests to the Docker API remotely.</p>\n\n<p>I have the docker engine running on virtual machine, and I'm making the requests from docker containers. </p>\n\n<p>Firstly, I've done this to make the Docker daemon listen on a specific IP and port:</p>\n\n<pre><code>edit /lib/systemd/system/docker.service \nExecStart=/usr/bin/docker -H fd:// -H=tcp://0.0.0.0:5555\nsystemctl daemon-reload\nsudo service docker restart\n</code></pre>\n\n<p>I configured to listen on 0.0.0.0, so it will be reachable at any IPv4 address.</p>\n\n<p>When I test this via curl on host, it works fine. e.g: curl localhost:5555/services</p>\n\n<p>However, my goal is to make requests from containers. Here is how I construct the docker client inside my go program:</p>\n\n<pre><code>cli, err := client.NewClientWithOpts(\n     client.WithHost(\"tcp://192.168.56.1:5555\"),\n)\nif err != nil {\n     panic(err)\n}\n\nnetworkFilters := filters.NewArgs()\nnetworkFilters.Add(\"driver\", \"overlay\")\nnetworks, err := cli.NetworkList(context.Background(), types.NetworkListOptions{Filters: networkFilters})\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>The error I'm having:</p>\n\n<pre><code>http: panic serving 10.255.0.2:39632: error during connect: Get http://192.168.56.1:5555/v1.40/networks?filters=%7B%22driver%22%3A%7B%22overlay%22%3Atrue%7D%7D: read tcp 172.18.0.3:36126-&gt;192.168.56.1:5555: read: connection reset by peer\n</code></pre>\n\n<p>Any ideas? Thanks</p>\n"}, {"tags": ["go", "concurrency", "atomic"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1561975102, "post_id": 56833406, "comment_id": 100219279, "body": "Huh, why not atomic? This type of situation is <i>why it exists</i>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1561976165, "post_id": 56833406, "comment_id": 100219816, "body": "If you have multiple goroutines where at least one writes a value which others read, without explicit synchronization, that is a data race and therefore undefined behavior. Don&#39;t try to find logic in what will happen, it&#39;s <b>undefined</b>. Use proper synchronization. See <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">The Go Memory Model</a>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1561977953, "post_id": 56833406, "comment_id": 100220637, "body": "You can by &quot;without atomic&quot;, but not without <b>some</b> synchronization."}], "answers": [{"comments": [{"owner": {"reputation": 567, "user_id": 1424105, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/1e35c1d2f8a7213275a0bc576c01c603?s=128&d=identicon&r=PG", "display_name": "Dean Winchester", "link": "https://stackoverflow.com/users/1424105/dean-winchester"}, "edited": false, "score": 0, "creation_date": 1561994999, "post_id": 56836505, "comment_id": 100229242, "body": "yeah about share memory by communicating, there&#39;s also <a href=\"https://blog.acolyer.org/2019/05/17/understanding-real-world-concurrency-bugs-in-go/\" rel=\"nofollow noreferrer\">blog.acolyer.org/2019/05/17/&hellip;</a>. Anyway that&#39;s not my point. About <code>go run -race</code>, it did report data race, but not detailed enough for me."}], "tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1561987437, "creation_date": 1561987437, "answer_id": 56836505, "question_id": 56833406, "link": "https://stackoverflow.com/questions/56833406/golang-assignment-safety-with-single-reader-and-single-writer/56836505#56836505", "title": "Golang assignment safety with single reader and single writer", "body": "<p>Go's motto: <a href=\"https://blog.golang.org/share-memory-by-communicating\" rel=\"nofollow noreferrer\">Do not communicate by sharing memory; instead, share memory by communicating</a>. Which is an effective best-practice most of the time.</p>\n\n<ol>\n<li>If you care about ordering, you care about synchronizing the two goroutines. </li>\n<li>I don't think they are possible. Anyway, those are not things you should worry about if you properly design the synchronization.</li>\n<li>The same as above.</li>\n</ol>\n\n<p>Luckily, Go has a <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">data race detector</a> integrated. Try to run your example with <code>go run -race</code>. You will probably see the race condition happening on <code>sequence</code> variable. </p>\n"}], "owner": {"reputation": 567, "user_id": 1424105, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/1e35c1d2f8a7213275a0bc576c01c603?s=128&d=identicon&r=PG", "display_name": "Dean Winchester", "link": "https://stackoverflow.com/users/1424105/dean-winchester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1561987437, "creation_date": 1561974377, "question_id": 56833406, "link": "https://stackoverflow.com/questions/56833406/golang-assignment-safety-with-single-reader-and-single-writer", "title": "Golang assignment safety with single reader and single writer", "body": "<p>Say I have two go routines:</p>\n\n<pre><code>var sequence int64\n\n// writer\nfor i := sequence; i &lt; max; i++ {\n  doSomethingWithSequence(i)\n  sequence = i\n}\n\n// reader\nfor {\n  doSomeOtherThingWithSequence(sequence)\n}\n</code></pre>\n\n<p>So can I get by without <code>atomic</code>?</p>\n\n<p>Some potential risks I can think of:</p>\n\n<ol>\n<li><p>reorder (for the writer, updating <code>sequence</code> happens before <code>doSomething</code>) could happen, but I can live with that.</p></li>\n<li><p><code>sequence</code> is not properly aligned in memory so the reader might observe a partially updated <code>i</code>. Running on (recent kernel) linux with x86_64,\ncan we rule that out?</p></li>\n<li><p>go compiler 'cleverly optimizes' the reader, so the access to <code>i</code> never goes to memory but <code>cached</code> in a register. Is that possible in go?</p></li>\n<li><p>Anything else?</p></li>\n</ol>\n"}, {"tags": ["sql", "database", "go", "data-migration"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1561973184, "post_id": 56833084, "comment_id": 100218253, "body": "SQL isn&#39;t a database. Do you mean SQL Server? Please update tags accordingly. What cache are you using? You&#39;d need to refresh it. Updating 5 million records one at a time via REST API will take you years. You definitely need to run a script to do it"}, {"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1561973235, "post_id": 56833084, "comment_id": 100218298, "body": "Every relational database is a &quot;SQL database&quot;"}], "owner": {"reputation": 642, "user_id": 1531942, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/9KSFO.jpg?s=128&g=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/1531942/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561973007, "creation_date": 1561973007, "question_id": 56833084, "link": "https://stackoverflow.com/questions/56833084/sql-data-migration-directly-updating-the-db-cache-vs-updating-via-rest-api-call", "title": "SQL Data Migration: directly updating the DB/Cache vs updating via REST API calls", "body": "<p>We have come across a situation where we need to separate one column (<code>old_col</code>) into 3 different columns (<code>new_col1, new_col2, new_col3</code>) in the SQL db.</p>\n\n<p><em>We have already come up with a business logic of separating the value inside <code>old_col</code> into the <code>new_cols</code>.</em></p>\n\n<p><strong>Current Data Migration Strategy:-</strong></p>\n\n<p>Use existing REST API to update(PUT) all the rows. The <code>update</code> API has the business logic built in it. </p>\n\n<p>Cons:</p>\n\n<ul>\n<li><p>taking too long</p></li>\n<li><p>unnecessary load on the server</p></li>\n</ul>\n\n<p><strong>Proposed Strategy:-</strong> </p>\n\n<p>Directly update the DB values using a script</p>\n\n<p>Cons:</p>\n\n<ul>\n<li>Need to invalidate the cache</li>\n<li>Multiple services reading from the DB</li>\n</ul>\n\n<p><em>I know this is very little information, but in general what is the best strategy to go ahead with the problem statement and what else can we do/explore to reduce our risks?</em></p>\n\n<p>Backend: GoLang</p>\n\n<p>DB: SQL</p>\n\n<p>No of Records: 5 million</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 1013, "user_id": 2754195, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tNP72.jpg?s=128&g=1", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/2754195/mehdi"}, "edited": false, "score": 0, "creation_date": 1561973504, "post_id": 56833046, "comment_id": 100218442, "body": "thanks, that exactly the solution, but do you know  is it possible to automate the process of preloading?"}, {"owner": {"reputation": 1013, "user_id": 2754195, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tNP72.jpg?s=128&g=1", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/2754195/mehdi"}, "edited": false, "score": 0, "creation_date": 1561973597, "post_id": 56833046, "comment_id": 100218490, "body": "I tried <code>gorm:&quot;PRELOAD:true&quot;</code> tag but it doesn&#39;t work."}, {"owner": {"reputation": 1013, "user_id": 2754195, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tNP72.jpg?s=128&g=1", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/2754195/mehdi"}, "edited": false, "score": 0, "creation_date": 1561973860, "post_id": 56833046, "comment_id": 100218619, "body": "find the <a href=\"https://stackoverflow.com/questions/50873996/auto-preloading-with-gorm-not-working-as-expected?rq=1\">soulotuin</a> : \t<code>db = db.Set(&quot;gorm:auto_preload&quot;, true)</code>, thanks for Preloading idea."}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 0, "last_activity_date": 1561972854, "creation_date": 1561972854, "answer_id": 56833046, "question_id": 56832529, "link": "https://stackoverflow.com/questions/56832529/gorm-many-to-one-returns-empty/56833046#56833046", "title": "gorm many to one returns empty", "body": "<p>Your problem is probably in Preloading: <a href=\"http://gorm.io/docs/preload.html#Preload\" rel=\"nofollow noreferrer\">http://gorm.io/docs/preload.html#Preload</a></p>\n\n<p>Try the following:</p>\n\n<pre><code>var book models.Book\ndb.Preload(\"Chapters\").First(&amp;book, \"id = ?\", 4)\nfmt.Println(book.ID, book.Chapters)\n</code></pre>\n"}], "owner": {"reputation": 1013, "user_id": 2754195, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tNP72.jpg?s=128&g=1", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/2754195/mehdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 56833046, "answer_count": 1, "score": 0, "last_activity_date": 1561972854, "creation_date": 1561970588, "question_id": 56832529, "link": "https://stackoverflow.com/questions/56832529/gorm-many-to-one-returns-empty", "title": "gorm many to one returns empty", "body": "<p>I want to use <code>gorm</code> the use a many to one relationship in my project. \nMy <code>struct</code>s are like this:</p>\n\n<pre><code>type Book struct {\n    ID          uint\n    Title       string\n    Subtitle    string\n    Chapters    []Chapter `gorm:\"foreignkey:BookID;association_foreignkey:ID\"`\n</code></pre>\n\n<p>}\n    }</p>\n\n<pre><code>// TableName is book\nfunc (Book) TableName() string {\n    return \"book\"\n}\n\n// Chapter of books\ntype Chapter struct {\n    ID      uint\n    BookID  string\n    Chapter string\n}\n</code></pre>\n\n<p>What I want is to get chapters of a book by using this command:<code>book.chapters</code>.\nI use the following codes to get books and chapters:</p>\n\n<pre><code>var book models.Book\n    db.First(&amp;book, \"id = ?\", 4)\n    fmt.Println(book.ID, book.Chapters) // returns []\n</code></pre>\n\n<p>when I query chapters with book_id = 4, I get 11 results:</p>\n\n<pre><code>   var chapters []models.Chapter\n   db.Find(&amp;chapters, \"book_id = ? \", 4)\n   fmt.Println(\"len(chapters) = \", len(chapters)) // len(chapters) =11\n</code></pre>\n\n<p>and when I set db.LogMode(true) and see what happens in the code I see that querying <code>book</code> only queries the books not joining that with <code>chapters</code>:</p>\n\n<p><code>SELECT * FROM \"book\"  WHERE (id = 4) ORDER BY \"book\".\"id\" ASC LIMIT 1</code></p>\n\n<p>Is there something that I missed from the documentation? how should I make the book struct the get non-empty <code>book.chapters</code>.</p>\n"}, {"tags": ["mysql", "go", "phpmyadmin"], "comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1561970757, "post_id": 56832405, "comment_id": 100216999, "body": "There will be a password. Do you have an application that uses this database successfully? You can probably find a password, though maybe not the root password, in that app&#39;s config. Worst case you can stop mysql and restart it <code>--skip-grant-tables</code> then change the password to something you do know."}, {"owner": {"reputation": 1, "user_id": 11716381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be101079c62536ac650d7faa40455ace?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet Jindal", "link": "https://stackoverflow.com/users/11716381/puneet-jindal"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1561972464, "post_id": 56832405, "comment_id": 100217879, "body": "@rup But I didn&#39;t setup any password on mysql. So what password I would have to change"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1561972673, "post_id": 56832405, "comment_id": 100217973, "body": "It might either be <a href=\"https://stackoverflow.com/a/5818385/243245\">empty (just hit return) or &#39;password&#39;</a>. But whether you know it or not <a href=\"https://askubuntu.com/a/766908/24979\">you can follow these steps to change it</a>."}, {"owner": {"reputation": 1, "user_id": 11716381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be101079c62536ac650d7faa40455ace?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet Jindal", "link": "https://stackoverflow.com/users/11716381/puneet-jindal"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1561972934, "post_id": 56832405, "comment_id": 100218110, "body": "@rup I have checked in user account see in the given screen shot: <a href=\"https://nimb.ws/suN974\" rel=\"nofollow noreferrer\">nimb.ws/suN974</a>   there is no password in the user account"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1561974654, "post_id": 56832405, "comment_id": 100219044, "body": "Sorry, I don&#39;t know my mysql behaves with no passwords set. I&#39;ve put your screenshot in the question so hopefully someone else will recognise what&#39;s happening here."}, {"owner": {"reputation": 1, "user_id": 11716381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be101079c62536ac650d7faa40455ace?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet Jindal", "link": "https://stackoverflow.com/users/11716381/puneet-jindal"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1561975361, "post_id": 56832405, "comment_id": 100219436, "body": "@rup okay thankyou for the links. Anyone other will give me the solution for this?"}, {"owner": {"reputation": 21453, "user_id": 1839439, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/agMKZ.png?s=128&g=1", "display_name": "Dharman", "link": "https://stackoverflow.com/users/1839439/dharman"}, "edited": false, "score": 0, "creation_date": 1562004424, "post_id": 56832405, "comment_id": 100233072, "body": "Why is this question tagged with phpmyadmin?"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 5345748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gxk4b.jpg?s=128&g=1", "display_name": "Nawa Augustine", "link": "https://stackoverflow.com/users/5345748/nawa-augustine"}, "is_accepted": false, "score": 0, "last_activity_date": 1561982576, "creation_date": 1561982576, "answer_id": 56835358, "question_id": 56832405, "link": "https://stackoverflow.com/questions/56832405/how-to-solve-the-mysqldump-got-error-1044-access-denied-for-user-localhos/56835358#56835358", "title": "How to solve the mysqldump Got error: 1044: &quot;Access denied for user &#39;&#39;@&#39;localhost&#39; to database &#39;db_name&#39;&quot; when selecting the database", "body": "<p>It is prompting you to specify a password because you asked it to. </p>\n\n<p>First skip <em>-p</em> in your command. </p>\n\n<p>Use</p>\n\n<blockquote>\n  <p>--skip-password</p>\n</blockquote>\n\n<p>To explicitly specify that there is no password and that mysqldump should not prompt for one.</p>\n"}, {"tags": [], "owner": {"reputation": 470, "user_id": 9219620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7bddbf0c416e48b5224e84c43caf022?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet", "link": "https://stackoverflow.com/users/9219620/puneet"}, "is_accepted": true, "score": 0, "last_activity_date": 1578326568, "last_edit_date": 1578326568, "creation_date": 1562038870, "answer_id": 56845014, "question_id": 56832405, "link": "https://stackoverflow.com/questions/56832405/how-to-solve-the-mysqldump-got-error-1044-access-denied-for-user-localhos/56845014#56845014", "title": "How to solve the mysqldump Got error: 1044: &quot;Access denied for user &#39;&#39;@&#39;localhost&#39; to database &#39;db_name&#39;&quot; when selecting the database", "body": "<p>I have also faced this same problem. I think you will have to make a new user in your <code>PHPMyAdmin -&gt; users_account</code> with a valid <code>username</code> and <code>password</code>. Also, check all the privileges. Hope it will help you.</p>\n"}], "owner": {"reputation": 1, "user_id": 11716381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be101079c62536ac650d7faa40455ace?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet Jindal", "link": "https://stackoverflow.com/users/11716381/puneet-jindal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2370, "favorite_count": 1, "accepted_answer_id": 56845014, "answer_count": 2, "score": -3, "last_activity_date": 1578326568, "creation_date": 1561970008, "last_edit_date": 1561974601, "question_id": 56832405, "link": "https://stackoverflow.com/questions/56832405/how-to-solve-the-mysqldump-got-error-1044-access-denied-for-user-localhos", "title": "How to solve the mysqldump Got error: 1044: &quot;Access denied for user &#39;&#39;@&#39;localhost&#39; to database &#39;db_name&#39;&quot; when selecting the database", "body": "<p>I use mysqldump command to dump the some information from the sql tables. To do this I read about mysqldump. Then for a test I made a direct command which will run able in the terminal shell. That command were successfully produces the result which I needed. Then after that I have to implemented the command in my application code. My application is in the golang. Using <code>exec.Command()</code> I will able to run that command. But there is a run time error while the command will executed. The error I'm facing in terminal is: </p>\n\n<blockquote>\n  <p>exit status 2: mysqldump: Got error: 1044: \"Access denied for user ''@'localhost' to database 'db_name'\" when selecting the database</p>\n</blockquote>\n\n<p>Command which I used:</p>\n\n<p>direct command which produce success result\n<code>sudo mysqldump -h 127.0.0.1 --no-create-info db_name table_name --where='id=1121' &gt; /path/of/file/php1_dump.sql</code></p>\n\n<p>code I'm using in golang:</p>\n\n<pre><code>cmd := exec.Command(\"sh\", \"-c\", \"mysqldump -h 127.0.0.1 --no-create-info db_name table_name --where='id=1121' &gt; /home/iron/go/php1_dump.sql\")\nvar out bytes.Buffer\nvar stderr bytes.Buffer\ncmd.Stdout = &amp;out\ncmd.Stderr = &amp;stderr\n\nerr := cmd.Run() // give the above error I mentioned\n\nif err != nil {\n    fmt.Println(fmt.Sprint(err) + \": \" + stderr.String())\n    fmt.Println(\"errrrrrrrrrrrrrrrrrrrr\", err) // exit status 2\n}\nfmt.Println(\"Result: \" + out.String())\n</code></pre>\n\n<p>I also tried the below commands:</p>\n\n<p><code>sudo mysqldump -h 127.0.0.1 -u root -p --no-create-info bk_admin wp_merchants --where='id=1121' &gt; /home/iron/go/php1_dump.sql</code></p>\n\n<p>The above command ask to enter the password. But I didn't setup any password of phpmysqladmin:</p>\n\n<p><a href=\"https://s.nimbusweb.me/share/3036094/uwlp8cbkwrdx5omeiywc\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y6NJm.png\" alt=\"User accounts overview page: all accounts have Password: No\"></a></p>\n\n<p>Please tell me that where I'm doing this wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1561981314, "post_id": 56832207, "comment_id": 100222224, "body": "If your question is &quot;What does memory allocation mean?&quot; please ask that question. Your question is otherwise a duplicate of the one you linked to."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1561981585, "post_id": 56832207, "comment_id": 100222338, "body": "The reason your allocs/op is 0, is probably because your for loop is a no-op, so gets optimized away by the compiler, so no memory is allocated."}, {"owner": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562025924, "post_id": 56832207, "comment_id": 100239099, "body": "Hi @Flimzy I have changed the title of this question based on your suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1561969524, "post_id": 56832256, "comment_id": 100216444, "body": "Dave Cheney is not the author of Go."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1561971825, "post_id": 56832256, "comment_id": 100217565, "body": "This is a long list. And while maybe legally correct it is nothing to state."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1561981744, "post_id": 56832256, "comment_id": 100222413, "body": "It&#39;s more accurate to say that Dave Cheney is a Go contributor. But then anyone can be, so that&#39;s not very meaningful, either. He currently has <a href=\"https://github.com/golang/go/commits?author=davecheney\" rel=\"nofollow noreferrer\">476</a> commits to his name, most recently in 2017, in contrast with the 40,632 total commits. So perhaps you can say Dave Cheney authored 1.17% of Go."}], "tags": [], "owner": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "is_accepted": false, "score": -2, "last_activity_date": 1562026022, "last_edit_date": 1562026022, "creation_date": 1561969446, "answer_id": 56832256, "question_id": 56832207, "link": "https://stackoverflow.com/questions/56832207/what-is-allocs-op-zero-in-golang-benchmark/56832256#56832256", "title": "What is allocs/op zero in Golang benchmark?", "body": "<h2>Possible Answer</h2>\n\n<p>From Dave Cheney, one of the Go contributors:</p>\n\n<p>The benchmark tool only reports heap allocations. Stack allocations via escape analysis are less costly, possibly free, so are not reported.</p>\n\n<h2>Reference</h2>\n\n<p><a href=\"https://groups.google.com/forum/#!topic/golang-nuts/3uVS3wxAmzI\" rel=\"nofollow noreferrer\">Why is this simple benchmark showing zero allocations?</a></p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1562075694, "last_edit_date": 1562075694, "creation_date": 1562067272, "answer_id": 56851536, "question_id": 56832207, "link": "https://stackoverflow.com/questions/56832207/what-is-allocs-op-zero-in-golang-benchmark/56851536#56851536", "title": "What is allocs/op zero in Golang benchmark?", "body": "<blockquote>\n  <p>Why is this metric allocs/ops zero?</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n<pre><code>package main\n\nimport (\n  \"testing\"\n)\n\nfunc BenchmarkHello(b *testing.B) {\n  for i := 0; i &lt; b.N; i++ {\n      a := 1\n      a++\n  }\n}\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>The allocs/ops average only counts heap allocations, not stack allocations.</p>\n\n<p>The allocs/ops average is rounded down to the nearest integer value.</p>\n\n<p>The Go gc compiler is an optimizing compiler. Since</p>\n\n<pre><code>{\n    a := 1\n    a++\n}\n</code></pre>\n\n<p>doesn't accomplish anything, it is elided.</p>\n"}], "owner": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1315, "favorite_count": 1, "answer_count": 2, "score": -3, "last_activity_date": 1562122222, "creation_date": 1561969192, "last_edit_date": 1562122222, "question_id": 56832207, "link": "https://stackoverflow.com/questions/56832207/what-is-allocs-op-zero-in-golang-benchmark", "title": "What is allocs/op zero in Golang benchmark?", "body": "<p>Here I have a benchmark test:</p>\n\n<pre><code>// bench_test.go\n\npackage main\n\nimport (\n    \"testing\"\n)\n\nfunc BenchmarkHello(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        a := 1\n        a++\n    }\n}\n</code></pre>\n\n<p>The test result are strange. The metric <code>allocs/op</code> shows zero. I know variable <code>a</code> is a int type and doesn't take too much memory, but it's not zero.</p>\n\n<pre><code>&gt; go test -bench=. -benchmem\ngoos: darwin\ngoarch: amd64\npkg: a\nBenchmarkHello-4    2000000000           0.26 ns/op        0 B/op          0 allocs/op\nPASS\nok      a   0.553s\n</code></pre>\n\n<h2>Questions</h2>\n\n<p>This <a href=\"https://stackoverflow.com/questions/35588474/what-does-allocs-op-and-b-op-mean-in-go-benchmark\">post</a> points that <code>allocs/op</code> means how many distinct memory allocations occurred per op (single iteration).</p>\n\n<ul>\n<li><p>But what does <code>memory allocation</code> mean? does that mean <code>set a value for a variable? Is it kind of</code>malloc in C` ?</p></li>\n<li><p>Why is this metric <code>allocs/ops</code> zero? </p></li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "edited": false, "score": 0, "creation_date": 1561984838, "post_id": 56832149, "comment_id": 100224004, "body": "You can even stop checking for same number of fields by setting FieldsPerRecord to negative value : <a href=\"https://play.golang.org/p/uFmRpYIbskX\" rel=\"nofollow noreferrer\">play.golang.org/p/uFmRpYIbskX</a>.       After ignoring FieldPerRecord Your csv will parsed successfully, you can then just skip row one in your for loop"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "edited": false, "score": 1, "creation_date": 1561985294, "post_id": 56832149, "comment_id": 100224253, "body": "@mchampaneri: Removing an error check is not a good idea."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "edited": false, "score": 0, "creation_date": 1561970342, "post_id": 56832197, "comment_id": 100216818, "body": "It&#39;s not working for my csv file, I just want to skip first row when I&#39;m reading csv file. by this way it is giving me empty []"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "edited": false, "score": 1, "creation_date": 1561970419, "post_id": 56832197, "comment_id": 100216859, "body": "@MortezaHasanabadi As you can see, I provided a working example where it <i>does</i> work. If it doesn&#39;t work for you, you should post the code you tried and a minimal example input it doesn&#39;t  work with for you but it should."}, {"owner": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "edited": false, "score": 0, "creation_date": 1561971286, "post_id": 56832197, "comment_id": 100217276, "body": "I tried my csv file with the code that you provided. can you please try your code with my file?  <a href=\"http://s8.picofile.com/file/8365291018/PM_IG30014_15_201906292000_01.csv.html\" rel=\"nofollow noreferrer\">s8.picofile.com/file/8365291018/&hellip;</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "edited": false, "score": 1, "creation_date": 1561971346, "post_id": 56832197, "comment_id": 100217309, "body": "Just post the first few lines of your file in the question. Also post what errors you get if any."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1561983221, "post_id": 56832197, "comment_id": 100223114, "body": "@icza: In the question, the error was &quot;record on line 2: wrong number of fields.&quot;. For example, <code>src := &quot;one,two,three,four\\n1,2,3\\n4,5,6&quot;</code>.: <a href=\"https://play.golang.org/p/9RqHUVwbkJP\" rel=\"nofollow noreferrer\">play.golang.org/p/9RqHUVwbkJP</a>. See my answer."}, {"owner": {"reputation": 137, "user_id": 1164535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDIOE.png?s=128&g=1", "display_name": "ffox003", "link": "https://stackoverflow.com/users/1164535/ffox003"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1562072493, "post_id": 56832197, "comment_id": 100256203, "body": "@peterSO use <code>r.FieldsPerRecord = -1</code> if you do not have the same number of fields in rows: <a href=\"https://play.golang.org/p/KT8qOzjdnyY\" rel=\"nofollow noreferrer\">play.golang.org/p/KT8qOzjdnyY</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 137, "user_id": 1164535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDIOE.png?s=128&g=1", "display_name": "ffox003", "link": "https://stackoverflow.com/users/1164535/ffox003"}, "edited": false, "score": 0, "creation_date": 1562072725, "post_id": 56832197, "comment_id": 100256347, "body": "@ffox003: <code>FieldsPerRecord = -1</code> bypasses the check that all but the first record have the same number of fields. Bypassing error checks is not a good idea."}, {"owner": {"reputation": 137, "user_id": 1164535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDIOE.png?s=128&g=1", "display_name": "ffox003", "link": "https://stackoverflow.com/users/1164535/ffox003"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1562088202, "post_id": 56832197, "comment_id": 100264794, "body": "@peterSO then why not just disabling it for the first line? <a href=\"https://play.golang.org/p/Pdx-z1LM83Y\" rel=\"nofollow noreferrer\">play.golang.org/p/Pdx-z1LM83Y</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1561969125, "creation_date": 1561969125, "answer_id": 56832197, "question_id": 56832149, "link": "https://stackoverflow.com/questions/56832149/how-to-skip-the-first-row-when-reading-a-csv-file/56832197#56832197", "title": "How to skip the first row when reading a csv file?", "body": "<p>Simply call <a href=\"https://golang.org/pkg/encoding/csv/#Reader.Read\" rel=\"nofollow noreferrer\"><code>Reader.Read()</code></a> to read a line, then proceed to read the rest with <a href=\"https://golang.org/pkg/encoding/csv/#Reader.ReadAll\" rel=\"nofollow noreferrer\"><code>Reader.ReadAll()</code></a>.</p>\n\n<p>See this example:</p>\n\n<pre><code>src := \"one,two,three\\n1,2,3\\n4,5,6\"\n\nr := csv.NewReader(strings.NewReader(src))\nif _, err := r.Read(); err != nil {\n    panic(err)\n}\n\nrecords, err := r.ReadAll()\nif err != nil {\n    panic(err)\n}\nfmt.Println(records)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/UgAA3VyEKP-\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[[1 2 3] [4 5 6]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1561989776, "last_edit_date": 1561989776, "creation_date": 1561982713, "answer_id": 56835389, "question_id": 56832149, "link": "https://stackoverflow.com/questions/56832149/how-to-skip-the-first-row-when-reading-a-csv-file/56835389#56835389", "title": "How to skip the first row when reading a csv file?", "body": "<blockquote>\n  <p>skip the first row when reading a csv file</p>\n</blockquote>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"encoding/csv\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\nfunc readSample(rs io.ReadSeeker) ([][]string, error) {\n    // Skip first row (line)\n    row1, err := bufio.NewReader(rs).ReadSlice('\\n')\n    if err != nil {\n        return nil, err\n    }\n    _, err = rs.Seek(int64(len(row1)), io.SeekStart)\n    if err != nil {\n        return nil, err\n    }\n\n    // Read remaining rows\n    r := csv.NewReader(rs)\n    rows, err := r.ReadAll()\n    if err != nil {\n        return nil, err\n    }\n    return rows, nil\n}\n\nfunc main() {\n    f, err := os.Open(\"sample.csv\")\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n    rows, err := readSample(f)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(rows)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ cat sample.csv\none,two,three,four\n1,2,3\n4,5,6\n$ go run sample.go\n[[1 2 3] [4 5 6]]\n$ \n\n$ cat sample.csv\nPTN Ethernet-Port RMON Performance,PORT_BW_UTILIZATION,2019-06-29 20:00:00,33366     \nDeviceID,DeviceName,ResourceName,CollectionTime,GranularityPeriod,PORT_RX_BW_UTILIZATION,PORT_TX_BW_UTILIZATION,RXGOODFULLFRAMESPEED,TXGOODFULLFRAMESPEED,PORT_RX_BW_UTILIZATION_MAX,PORT_TX_BW_UTILIZATION_MAX\n3174659,H1095,H1095-11-ISM6-1(to ZJBSC-V1),2019-06-29 20:00:00,15,22.08,4.59,,,30.13,6.98\n3174659,H1095,H1095-14-ISM6-1(to T6147-V),2019-06-29 20:00:00,15,2.11,10.92,,,4.43,22.45\n$ go run sample.go\n[[DeviceID DeviceName ResourceName CollectionTime GranularityPeriod PORT_RX_BW_UTILIZATION PORT_TX_BW_UTILIZATION RXGOODFULLFRAMESPEED TXGOODFULLFRAMESPEED PORT_RX_BW_UTILIZATION_MAX PORT_TX_BW_UTILIZATION_MAX] [3174659 H1095 H1095-11-ISM6-1(to ZJBSC-V1) 2019-06-29 20:00:00 15 22.08 4.59   30.13 6.98] [3174659 H1095 H1095-14-ISM6-1(to T6147-V) 2019-06-29 20:00:00 15 2.11 10.92   4.43 22.45]]\n$\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5153, "favorite_count": 2, "accepted_answer_id": 56835389, "answer_count": 2, "score": 6, "last_activity_date": 1561989776, "creation_date": 1561968886, "last_edit_date": 1561989502, "question_id": 56832149, "link": "https://stackoverflow.com/questions/56832149/how-to-skip-the-first-row-when-reading-a-csv-file", "title": "How to skip the first row when reading a csv file?", "body": "<p>I have an awkward csv file and I need to skip the first row to read it.</p>\n\n<p>I'm doing this easily with python/pandas</p>\n\n<pre><code>df = pd.read_csv(filename, skiprows=1)\n</code></pre>\n\n<p>but I don't know how to do it in Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\ntype mwericsson struct {\n    id     string\n    name   string\n    region string\n}\n\nfunc main() {\n\n    rows := readSample()\n\n    fmt.Println(rows)\n    //appendSum(rows)\n    //writeChanges(rows)\n}\n\nfunc readSample() [][]string {\n    f, err := os.Open(\"D:/in/20190629/PM_IG30014_15_201906290015_01.csv\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    rows, err := csv.NewReader(f).ReadAll()\n    f.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n    return rows\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>2019/07/01 12:38:40 record on line 2: wrong number of fields\n</code></pre>\n\n<p><code>PM_IG30014_15_201906290015_01.csv</code>:</p>\n\n<pre><code>PTN Ethernet-Port RMON Performance,PORT_BW_UTILIZATION,2019-06-29 20:00:00,33366     \nDeviceID,DeviceName,ResourceName,CollectionTime,GranularityPeriod,PORT_RX_BW_UTILIZATION,PORT_TX_BW_UTILIZATION,RXGOODFULLFRAMESPEED,TXGOODFULLFRAMESPEED,PORT_RX_BW_UTILIZATION_MAX,PORT_TX_BW_UTILIZATION_MAX\n3174659,H1095,H1095-11-ISM6-1(to ZJBSC-V1),2019-06-29 20:00:00,15,22.08,4.59,,,30.13,6.98\n3174659,H1095,H1095-14-ISM6-1(to T6147-V),2019-06-29 20:00:00,15,2.11,10.92,,,4.43,22.45\n</code></pre>\n"}, {"tags": ["go", "go-get"], "comments": [{"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1561966188, "post_id": 56831348, "comment_id": 100215109, "body": "Have you already got this package before?  If so you may need to go to the local directory and run <code>git pull origin master</code>"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 2, "last_activity_date": 1561966025, "creation_date": 1561966025, "answer_id": 56831542, "question_id": 56831348, "link": "https://stackoverflow.com/questions/56831348/why-does-go-get-ask-me-to-pick-a-branch/56831542#56831542", "title": "Why does Go-get ask me to pick a branch?", "body": "<p>Probably because you've already checked out that repo into your Go path, and have changed to a non-default branch.  The simplest way to correct it would be to remove that repo, and start from scratch.</p>\n\n<pre><code>rm -rf $(go env GOPATH)/src/go.mongodb.org/mongo-driver\n</code></pre>\n\n<p>Of course, this will lose any changes you've made in that repo.</p>\n"}], "owner": {"reputation": 165, "user_id": 9394149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u6728\u6728\u7684\u6728\u5934", "link": "https://stackoverflow.com/users/9394149/%e6%9c%a8%e6%9c%a8%e7%9a%84%e6%9c%a8%e5%a4%b4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 56831542, "answer_count": 1, "score": 0, "last_activity_date": 1561966025, "creation_date": 1561965118, "question_id": 56831348, "link": "https://stackoverflow.com/questions/56831348/why-does-go-get-ask-me-to-pick-a-branch", "title": "Why does Go-get ask me to pick a branch?", "body": "<p>I want to install mongoDB-driver. When I type this command</p>\n\n<pre><code>go get go.mongodb.org/mongo-driver/mongo\n</code></pre>\n\n<p>I got :</p>\n\n<pre><code>    #  cd /Users/jiangwei/go/src/go.mongodb.org/mongo-driver; git pull --ff-only\n    There is no tracking information for the current branch.\n    Please specify which branch you want to merge with.\n    See git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\n    If you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\n    package go.mongodb.org/mongo-driver/mongo: exit status 1\n</code></pre>\n"}, {"tags": ["go", "stripe-payments"], "comments": [{"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1561939930, "post_id": 56828863, "comment_id": 100210187, "body": "I think <a href=\"https://stripe.com/docs/api/charges/object#charge_object-amount\" rel=\"nofollow noreferrer\">this</a> will help you."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1561940003, "post_id": 56828863, "comment_id": 100210195, "body": "It is the exact amount, and it&#39;s in that format <i>so that</i> it will be exact."}], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 2, "last_activity_date": 1561939854, "creation_date": 1561939854, "answer_id": 56828884, "question_id": 56828863, "link": "https://stackoverflow.com/questions/56828863/how-to-get-the-exact-amount-due-instead-of-the-integer-amount-for-a-stripe-invoi/56828884#56828884", "title": "How to get the exact amount due instead of the integer amount for a Stripe Invoice, using the Go API?", "body": "<p>The AmountDue field is in cents, as are all the Stripe fields, so they should be stored as an integer. This is quite common when dealing with money. Never use floats for currency.</p>\n\n<p><a href=\"https://stripe.com/docs/api/invoices/object#invoice_object-amount_due\" rel=\"nofollow noreferrer\">https://stripe.com/docs/api/invoices/object#invoice_object-amount_due</a></p>\n"}], "owner": {"reputation": 93, "user_id": 8453461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944177efb85a2df8fba245fdaa6b900a?s=128&d=identicon&r=PG&f=1", "display_name": "David Roussov", "link": "https://stackoverflow.com/users/8453461/david-roussov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1561966276, "accepted_answer_id": 56828884, "answer_count": 1, "score": 0, "last_activity_date": 1561939854, "creation_date": 1561939511, "question_id": 56828863, "link": "https://stackoverflow.com/questions/56828863/how-to-get-the-exact-amount-due-instead-of-the-integer-amount-for-a-stripe-invoi", "closed_reason": "Duplicate", "title": "How to get the exact amount due instead of the integer amount for a Stripe Invoice, using the Go API?", "body": "<p>Using the Stripe Go library, when listing the invoices for a particular customer, the amount due for that invoice is $1000 when it should be $10.00 (which is seen in the Stripe dashboard). </p>\n\n<p>I'm assuming it's because the AmountDue field in the Invoice struct is an int64 (<a href=\"https://github.com/stripe/stripe-go/blob/master/invoice.go#L204\" rel=\"nofollow noreferrer\">https://github.com/stripe/stripe-go/blob/master/invoice.go#L204</a>), and it's losing the decimal component during a cast, but is there a way to get the exact amount?</p>\n\n<p>This is how I'm querying the invoices:</p>\n\n<pre><code>  params := &amp;stripe.InvoiceListParams{}\n  params.Filters.AddFilter(\"limit\", \"\", \"100\")\n  params.Filters.AddFilter(\"customer\", \"\", stripeCustomerId)\n  i := invoice.List(params)\n  for i.Next() {\n    i := i.Invoice()\n\n    invoice := BillingModels.Transaction{\n      Id:         i.ID,\n      Amount:     i.AmountDue,\n    }   \n\n    invoices = append(invoices, invoice)\n  }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1561931851, "post_id": 56828260, "comment_id": 100209121, "body": "I&#39;d vote for the <code>HasID</code> but also consider the approach implemented by various <code>Null*</code> types of <code>database&#47;sql</code>. I mean, you could have your <code>NullID</code> type with proper semantics."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1561939959, "post_id": 56828260, "comment_id": 100210191, "body": "You covered three approaches: pointer, separate field, distinguished value (-1 in your example).  The only other approach that I&#39;ve seen is the <a href=\"https://godoc.org/database/sql#NullInt64\" rel=\"nofollow noreferrer\">SQL null types</a> mentioned by kostix.  A JSON specific null type can be written with <a href=\"https://godoc.org/encoding/json#Marshaler.MarshalJSON\" rel=\"nofollow noreferrer\">MarshalJSON</a> and <a href=\"https://godoc.org/encoding/json#Unmarshaler.UnmarshalJSON\" rel=\"nofollow noreferrer\">UnmarshalJSON</a> methods to handle the <code>Valid</code> field."}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1561951682, "post_id": 56828260, "comment_id": 100211658, "body": "I would vote for the <code>*int</code> and it has used in <a href=\"http://github.com/jinzhu/gorm\" rel=\"nofollow noreferrer\">gorm</a> soft delete where some fields don&#39;t have <code>deleted_at</code> and some of them do."}, {"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1561967141, "post_id": 56828260, "comment_id": 100215468, "body": "I don&#39;t think Go has an idiom for that, except maybe the database stuff mentioned above.  However, if you have a large number of these value and they are typically null then I would use a pointer (as long as you&#39;re sure the integer don&#39;t escape to the heap when it&#39;s there).  If you have a lot typically <i>not</i> null and you are sure you can never have -ve values then I&#39;d use integer with -1."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1561977265, "post_id": 56828260, "comment_id": 100220336, "body": "Note that pointers are not friendly to GC and CPU cache locality, so if processing of these chunks of data are on a hot path or you just churn <i>lots</i> of them, using pointers may be suboptimal. Still, it&#39;s just and observation; as usually, do not do premature optimizations\u2014measure first."}], "owner": {"reputation": 1551, "user_id": 146054, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/6ccd86f1a8077148e1fd436e73ad8fa8?s=128&d=identicon&r=PG", "display_name": "ElephantHunter", "link": "https://stackoverflow.com/users/146054/elephanthunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561931200, "creation_date": 1561930815, "last_edit_date": 1561931200, "question_id": 56828260, "link": "https://stackoverflow.com/questions/56828260/idiomatic-alternative-to-zero-value-if-you-need-the-zero-value", "title": "Idiomatic alternative to zero value if you need the zero value", "body": "<p>I'm trying to normalize data from a number of sources. One of those sources is JSON with a nullable ID.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Entry struct {\n  ID *int // Can be null\n}\n</code></pre>\n\n<p>What's Go's idiomatic way to deal with a nullable ID, where the number 0 might be a valid ID? I'm torn between what I see as three options.</p>\n\n<p>Do I normalize by passing possibly-nil pointer around?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type NormalizedEntry struct {\n  ID *int\n}\n</code></pre>\n\n<p>Do I add a separate HasID property?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type NormalizedEntry struct {\n  HasID bool\n  ID    int\n}\n</code></pre>\n\n<p>Do I pass -1 instead of 0 to represent the \"zero value\"? (Like how strings.Index returns -1 if a value is not found)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type NormalizedEntry struct {\n  ID int\n}\n</code></pre>\n\n<p>Or is there some other, better, method that I'm not yet aware of?</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda"], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "edited": false, "score": 0, "creation_date": 1561980219, "post_id": 56828213, "comment_id": 100221703, "body": "I would like to allow both synchronous and asynchronous invocations. For example, I would like for my Lambda to be invoked as Rest API if needed, or to be invoked asynchronously with some JSON Payload. In order to achieve that, do I need to create <code>InvokeInput</code> object and pass it to <code>Invoke()</code> function?"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1570110721, "post_id": 56828213, "comment_id": 102817029, "body": "You should probably use API Gateway in front of the Lambdas. For async requests (where the request is queued and immediately acknowledged), include an HTTP header X-Amz-Invocation-Type=Event."}], "tags": [], "owner": {"reputation": 4901, "user_id": 6485881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4NDn3.jpg?s=128&g=1", "display_name": "Maurice", "link": "https://stackoverflow.com/users/6485881/maurice"}, "is_accepted": false, "score": 4, "last_activity_date": 1561930285, "creation_date": 1561930285, "answer_id": 56828213, "question_id": 56828134, "link": "https://stackoverflow.com/questions/56828134/using-aws-api-in-order-to-invoke-lambda-functions-asynchronously/56828213#56828213", "title": "Using AWS API in order to invoke Lambda functions Asynchronously", "body": "<p>Lambda really is about event-driven-computing. This means Lambda always gets triggered in response to an <strong>event</strong>. This event can originate from a wide <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/lambda-services.html?shortFooter=true\" rel=\"nofollow noreferrer\">range of AWS Services</a> as well as the AWS CLI and SDK.</p>\n\n<p>All of these events invoke the Lambda function and pass some kind of information in the form of an <code>event</code> and <code>context</code> object. How this event looks like depends on the service that triggered lambda. You can find more information about the context in <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/running-lambda-code.html?shortFooter=true\" rel=\"nofollow noreferrer\">this documentation</a>.</p>\n\n<p>There is no real \"best\" way to invoke Lambda - this mostly depends on your use case - if you're building a webservice, let API Gateway invoke Lambda for you. If you want to process new files on S3 - let S3 trigger Lambda. If you're just testing the Lambda function you can invoke it via the CLI. If you have custom software that needs to trigger a Lambda function you can use the SDK. If you want to run Lambda on a schedule, configure CloudWatch events...</p>\n\n<p>Please provide more information about your use case if you require a more detailed evaluation of the available options - right now this is very broad.</p>\n"}], "owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570107882, "creation_date": 1561929389, "last_edit_date": 1570107882, "question_id": 56828134, "link": "https://stackoverflow.com/questions/56828134/using-aws-api-in-order-to-invoke-lambda-functions-asynchronously", "title": "Using AWS API in order to invoke Lambda functions Asynchronously", "body": "<p>I have been researching AWS Documentation on how to invoke lambda functions, and I've come across different ways to do that. Mainly, Lambda invocation is done by calling <code>Invoke()</code> function which can be used to invoke lambda functions synchronously or asynchronously. </p>\n\n<p>Currently I am invoking my Lambda functions via HTTP Request (as REST API), but, HTTP Request times out after 30 seconds, while asynchronous calls as far as I know times out after 15min.</p>\n\n<p>What are the advantages, besides time that I have already mentioned, of asynchronous lambda invocation compared to invoking lambda with HTTP Request. Also, what are best (recommended) ways to invoke lambdas in production? On AWS docs (SDK for Go - <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/lambda/#InvokeAsyncInput\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/lambda/#InvokeAsyncInput</a>) I see that <code>InvokeAsyncInput</code> and <code>InvokeAsyncOutput</code> have been depricated. So I am wondering how async implementation would actually look like.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb"], "comments": [{"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 2, "creation_date": 1561940304, "post_id": 56827932, "comment_id": 100210224, "body": "What is the Primary Key of the table? It is likely that you are not including the primary key in <code>PutItem</code>, so the record cannot be created."}, {"owner": {"reputation": 108, "user_id": 3226398, "user_type": "registered", "profile_image": "https://graph.facebook.com/825608468/picture?type=large", "display_name": "Nihanth Dara", "link": "https://stackoverflow.com/users/3226398/nihanth-dara"}, "edited": false, "score": 0, "creation_date": 1561958200, "post_id": 56827932, "comment_id": 100212702, "body": "You are missing the key named &#39;id&#39; in the item struct."}, {"owner": {"reputation": 141, "user_id": 9867528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gautam Sardana", "link": "https://stackoverflow.com/users/9867528/gautam-sardana"}, "edited": false, "score": 0, "creation_date": 1561984444, "post_id": 56827932, "comment_id": 100223786, "body": "id is my primary key. I have made the changes you guys mentioned, still getting the same error. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 2157, "user_id": 843150, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AAl98.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/843150/joe"}, "edited": false, "score": 0, "creation_date": 1598742232, "post_id": 59139413, "comment_id": 112559042, "body": "This is what a colleague of mine would call &quot;unnatural acts&quot;.  This works but it is frustrating that languages use capitalization or lack-thereof as indicators for encapsulation visibility."}, {"owner": {"reputation": 2345, "user_id": 1459079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6affa4807c0ffe5466edb2ad3458c8e1?s=128&d=identicon&r=PG", "display_name": "Marcello Romani", "link": "https://stackoverflow.com/users/1459079/marcello-romani"}, "reply_to_user": {"reputation": 2157, "user_id": 843150, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AAl98.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/843150/joe"}, "edited": false, "score": 0, "creation_date": 1599642280, "post_id": 59139413, "comment_id": 112833360, "body": "Go is opinionated by design, people tend to like it or hate it for that reason :)"}], "tags": [], "owner": {"reputation": 2345, "user_id": 1459079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6affa4807c0ffe5466edb2ad3458c8e1?s=128&d=identicon&r=PG", "display_name": "Marcello Romani", "link": "https://stackoverflow.com/users/1459079/marcello-romani"}, "is_accepted": false, "score": 6, "last_activity_date": 1575295464, "last_edit_date": 1575295464, "creation_date": 1575291517, "answer_id": 59139413, "question_id": 56827932, "link": "https://stackoverflow.com/questions/56827932/one-or-more-parameter-values-were-invalid-missing-the-key-id-in-the-item-status/59139413#59139413", "title": "One or more parameter values were invalid: Missing the key id in the item status code: 400, request id: 71CT--", "body": "<p>Struct fields must be public in order for <code>MarshalMap</code> to do its magic.</p>\n\n<p>Add a <code>fmt.Printf(\"marshalled struct: %+v\", av)</code> to see the output of that function.</p>\n\n<p>That will in turn require the DynamoDB fields to be capitalised, unless you add a <code>json:\"field-name\"</code> directive to the struct fields.</p>\n\n<p>The result would be:</p>\n\n<pre><code>type Item struct {\n    Id                 int    `json:\"id\"`\n    Content            string `json:\"content\"`\n    Bodycontentversion string `json:\"bodycontentversion\"`\n    Claps              int    `json:\"claps\"`\n    Comments           int    `json:\"comments\"`\n    Imageid            int    `json:\"imageid\"`\n    Title              string `json:\"title\"`\n    Views              int    `json:\"views\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4443, "user_id": 7950592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c6EsH.png?s=128&g=1", "display_name": "Nebulastic", "link": "https://stackoverflow.com/users/7950592/nebulastic"}, "is_accepted": false, "score": 1, "last_activity_date": 1577031274, "creation_date": 1577031274, "answer_id": 59445907, "question_id": 56827932, "link": "https://stackoverflow.com/questions/56827932/one-or-more-parameter-values-were-invalid-missing-the-key-id-in-the-item-status/59445907#59445907", "title": "One or more parameter values were invalid: Missing the key id in the item status code: 400, request id: 71CT--", "body": "<p>I had the same error when putting an item with the boto3 Python package.</p>\n\n<pre><code>ClientError: An error occurred (ValidationException) when calling the PutItem operation: One or more parameter values were invalid: Missing the key id in the item\n</code></pre>\n\n<p>The problem was that I did not specify the partition key correctly when inserting. I incorrectly specified PARTITION_KEY below. I misspelled the variable name (first line below), which caused the error which was not immediately visible from the error message.</p>\n\n<pre><code>PARTTION_KEY = 'hello'\nSORT_KEY = 'world'\n\ndynamodb = boto3.client('dynamodb')\ndynamodb.put_item(\n    TableName=TABLE,\n    Item={\n        PARTITION_KEY: {'S': 'my-part-key'},\n        SORT_KEY: {'S': 'my-sort-key'},\n    }\n)\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 9867528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gautam Sardana", "link": "https://stackoverflow.com/users/9867528/gautam-sardana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10902, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1577031274, "creation_date": 1561927223, "last_edit_date": 1561984287, "question_id": 56827932, "link": "https://stackoverflow.com/questions/56827932/one-or-more-parameter-values-were-invalid-missing-the-key-id-in-the-item-status", "title": "One or more parameter values were invalid: Missing the key id in the item status code: 400, request id: 71CT--", "body": "<p>I have made a table \"Blog\" in <code>dynamodb</code>.</p>\n\n<p>I want to insert the 2 parameters <strong>\"title\"</strong> and <strong>\"content\"</strong> in it which I am fetching from a HTML form.</p>\n\n<p>The parameters <strong>\"blogContent\"</strong> and <strong>\"blogTitle\"</strong> seem to be valid when I print these 2 in the console.</p>\n\n<p>But when I am inserting them in the table i get the error: </p>\n\n<blockquote>\n  <p>\"One or more parameter values were invalid: Missing the key id in the item\n          status code: 400, request id: 71CT5IPM1SIDKSDVUGWGUCSJ77VV4KQNSO5ZAMVJF66Q9ASUAAJG\"</p>\n</blockquote>\n\n<pre><code>type Item struct {\n    id                 int\n    content            string\n    bodycontentversion string\n    claps              int\n    comments           int\n    imageid            int\n    title              string\n    views              int\n}\n\n\nfunc awsblog() {\n\n    sess, err := session.NewSession(&amp;aws.Config{\n        Region: aws.String(\"us-east-1\")},\n    )\n\n    svc := dynamodb.New(sess)\n\n    item := Item{\n        id:                 1234,\n        content:            blogContent,\n        bodycontentversion: \"abcd\",\n        claps:              5,\n        comments:           10,\n        imageid:            1234,\n        title:              blogTitle,\n        views:              10,\n    }\n\n    av, err := dynamodbattribute.MarshalMap(item)\n    if err != nil {\n        fmt.Println(\"Got error marshalling new item:\")\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n\n    tableName := \"Blog\"\n\n    input := &amp;dynamodb.PutItemInput{\n        Item:      av,\n        TableName: aws.String(tableName),\n    }\n\n    _, err = svc.PutItem(input)\n    if err != nil {\n        fmt.Println(\"Got error calling PutItem:\")\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n\n    fmt.Println(\"Successfully updated '\")\n}\n\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ZuyE9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZuyE9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "distributed", "rate-limiting"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1561927190, "post_id": 56827726, "comment_id": 100208277, "body": "What happens if you go over 600? Presumably you get a 429 response or similar? What if you just handle 429s in a reasonable way?"}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1561931575, "post_id": 56827726, "comment_id": 100209088, "body": "We are using a leaky bucket rate limiter available here: <a href=\"https://github.com/jwells131313/danaides\" rel=\"nofollow noreferrer\">github.com/jwells131313/danaides</a>.  I&#39;m not really sure it meets your use case, but in our team we found it extremely good for streaming use cases (we were limiting the rate over a websocket).  Not sure it would be as good in your use case.  Disclaimer:  I wrote the library but it is being used by production software in the Oracle cloud"}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1561933935, "post_id": 56827726, "comment_id": 100209432, "body": "@Flimzy I can catch the error probably but some services are more critical and tied to a user request, cant have the user wait till the limit finally resets."}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "reply_to_user": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1561934201, "post_id": 56827726, "comment_id": 100209467, "body": "@jwells131313 sounds good. Can you give me more details? The code on your github seems to be client only, dont see how it shares the rate limit with other running instances."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1561934681, "post_id": 56827726, "comment_id": 100209550, "body": "But you&#39;re already requiring your user to wait until the timer resets. The only logical difference between rate limiting yourself, and retrying on 429, is the number of network requests. Granted, that can be non-trivial, but if you expect to usually be under the limit, handling 429s could be much easier."}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1561934943, "post_id": 56827726, "comment_id": 100209595, "body": "@Flimzy i expect to hit the cap every minute. handling the errors would take more resources than limiting them"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1561959081, "post_id": 56827726, "comment_id": 100212928, "body": "Not sure what kind of answers you get, but is it really necessary to make them from several machines? Sounds to me like you would rather like a single (HA) instance to poll and fan out the processing, which can be easily done via one of the various message queues."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1561987530, "post_id": 56827726, "comment_id": 100225456, "body": "This seems to me like a job for a proxy or API gateway in front of your service instances, responsible for throttling. Nginx for example can do this."}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "edited": false, "score": 0, "creation_date": 1562017645, "post_id": 56827726, "comment_id": 100237486, "body": "@YSTai and Adrian lead me to the probable solution (still working it out) found a forward proxy called Cuttle which is a golang proxy designed for centralized rate limiting. Ill be working out this solution, when i got it working i will update with an answer."}], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "edited": false, "score": 1, "creation_date": 1562330760, "post_id": 56828694, "comment_id": 100351362, "body": "Using a forward proxy with a rate limiter is exactly what i was looking for. in my solution I am now using Cuttle which is based on Goproxy."}], "tags": [], "owner": {"reputation": 88, "user_id": 968024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dddc33e0c442a45d4f144ade5342add?s=128&d=identicon&r=PG", "display_name": "YSTai", "link": "https://stackoverflow.com/users/968024/ystai"}, "is_accepted": true, "score": 0, "last_activity_date": 1561936908, "creation_date": 1561936908, "answer_id": 56828694, "question_id": 56827726, "link": "https://stackoverflow.com/questions/56827726/distributed-outbound-http-rate-limiter/56828694#56828694", "title": "Distributed outbound http rate limiter", "body": "<p>if you want a global rate limiter, you need a place to maintain distributed state, such as zookeeper. Usually, we don't want to pay the overhead. Alternatively, you can set up a forward proxy (<a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/httputil/#ReverseProxy</a>), do rate limit in it. </p>\n"}, {"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1561970794, "creation_date": 1561970794, "answer_id": 56832582, "question_id": 56827726, "link": "https://stackoverflow.com/questions/56827726/distributed-outbound-http-rate-limiter/56832582#56832582", "title": "Distributed outbound http rate limiter", "body": "<p>I can't speak to the libraries you found, but a <a href=\"https://en.wikipedia.org/wiki/Leaky_bucket\" rel=\"nofollow noreferrer\">leaky bucket</a> rate limiter is quite simple. You need some kind of shared transactional storage. Each bucket (or rate limiter) is then simply an integer and a time value. The integer is the number of drops in the bucket at the particular time. Every time you have to apply the rate limit, subtract the number of drops that leaked since the last update, then add one, then check if the number of drops is within the capacity of the bucket.</p>\n\n<p>We are using Redis for this sort of thing. To make this transactional in Redis a script is required (see <a href=\"https://redis.io/commands/script-load\" rel=\"nofollow noreferrer\">SCRIPT LOAD</a> and <a href=\"https://redis.io/commands/evalsha\" rel=\"nofollow noreferrer\">EVALSHA</a>). In an SQL database a <code>SELECT FOR UPDATE</code> followed by an <code>UPDATE</code> statement would achieve the same thing, for instance. This is our Redis script:</p>\n\n<pre class=\"lang-lua prettyprint-override\"><code>-- replicate_commands allows us to use the TIME command. We depend on accurate\n-- (and reasonably consistent) timestamps. Multiple clients may have\n-- inacceptable clock drift.\nredis.replicate_commands()\n\nlocal rate = tonumber(ARGV[1]) -- how many drops leak away in one second\nlocal cap = tonumber(ARGV[2]) -- how many drops fit in the bucket\nlocal now, _ = unpack(redis.call('TIME'))\n\n-- A bucket is represented by a hash with two keys, n and t. n is the number of\n-- drops in the bucket at time t (seconds since epoch).\nlocal xs = redis.call('HMGET', KEYS[1], 'n', 't')\nlocal n = tonumber(xs[1])\nlocal t = tonumber(xs[2])\n\nif type(n) ~= \"number\" or type(t) ~= \"number\" then\n    -- The bucket doesn't exist yet (n and t are false), or someone messed with\n    -- our hash values. Either way, pretend the bucket is empty.\n    n, t = 0, now\nend\n\n-- remove drops that leaked since t\nn = n - (now-t)*rate\nif n &lt; 0 then\n    n = 0\nend\n\n-- add one drop if it fits\nif n &lt; cap then\n    n = n + 1\nelse\n    n = cap\nend\n\nredis.call('HMSET', KEYS[1], 'n', n, 't', now)\nredis.call('EXPIRE', KEYS[1], math.floor(n/rate) + 1)\n\nreturn n\n</code></pre>\n\n<p>Example call for 10 drops per second with a capacity of 10 drops:</p>\n\n<pre><code>EVALSHA &lt;SHA_IN_HEX&gt; 1 rate-limit:my-bucket 10 10 \n</code></pre>\n\n<p>The script returns the number of drops in the bucket. If that number is equal to the capacity, you can either sleep for a short duration and try again, or reject the request outright, depending on your requirements.</p>\n\n<p>Note the the script never returns a value larger than the capacity, resulting in a recovery time of no more than a tenth of a second in your case. That may not be what you need since you are trying to match a third-party rate limiter. I.e. you may be okay with overflowing the bucket, resulting in a longer recovery time after a burst of requests.</p>\n"}], "owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 0, "accepted_answer_id": 56828694, "answer_count": 2, "score": 1, "last_activity_date": 1561970794, "creation_date": 1561925356, "last_edit_date": 1561927154, "question_id": 56827726, "link": "https://stackoverflow.com/questions/56827726/distributed-outbound-http-rate-limiter", "title": "Distributed outbound http rate limiter", "body": "<p>I have a microservice architecture application with multiple services polling an external API. The external API has a rate limiter of 600 requests per minute. How can I have all of my instances together stay below the shared 600 rate limit?</p>\n\n<p>Google only brought me 3 solutions, the most promising being:</p>\n\n<ul>\n<li><a href=\"https://github.com/myntra/golimit\" rel=\"nofollow noreferrer\">myntra/golimit</a> the most promising of the three, but I literally do not have a clue how to set that up.</li>\n<li><a href=\"https://github.com/wallstreetcn/rate\" rel=\"nofollow noreferrer\">wallstreetcn/rate</a> which only seems to reject when limit has been reached (my app needs to wait till it can make the request) and the <code>Every</code> function in the <code>rate.NewLimiter</code> func seems to be a different import / dependency which i cannot figure out  which it is</li>\n<li><a href=\"https://github.com/manavo/go-rate-limiter\" rel=\"nofollow noreferrer\">manavo/go-rate-limiter</a> has a \"soft\" limit which, obviously, could get me over the limit. Some endpoints I dont really mind if I cant access them for a few seconds, but other endpoint requests should work as much as possible.</li>\n</ul>\n\n<p>Currently I have an amateur solution. The code below allows to me set a limit per minute and it sleeps in between requests to spread the requests over the minute. This client rate limit is per instance, thus I would have to hardcode divide the 600 requests by the amount of instances.</p>\n\n<pre><code>var semaphore = make(chan struct{}, 5)\nvar rate = make(chan struct{}, 10)\n\nfunc init(){\n    // leaky bucket\n    go func() {\n        ticker := time.NewTicker(100 * time.Millisecond)\n        defer ticker.Stop()\n        for range ticker.C {\n            _, ok := &lt;-rate\n            // if this isn't going to run indefinitely, signal\n            // this to return by closing the rate channel.\n            if !ok {\n                return\n            }\n        }\n}()\n</code></pre>\n\n<p>And inside the function that makes the http API requests. </p>\n\n<pre><code>rate &lt;- struct{}{}\n\n    // check the concurrency semaphore\n    semaphore &lt;- struct{}{}\n    defer func() {\n        &lt;-semaphore\n}()\n</code></pre>\n\n<p>How can I have all of my instances together stay below the shared 600 rate limit?</p>\n\n<p>Preferences: \n - Rate limit counter based on a key, so multiple counters can be set.\n - Spread the requests over the set duration, so that 600 requests are not sent in the first 30 seconds but rather the full minute duration.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 2, "creation_date": 1561918114, "post_id": 56826731, "comment_id": 100206355, "body": "The issue is that you are <code>return</code> from the loop, it causes your function to return immediately and doesn&#39;t traverse the array."}], "answers": [{"tags": [], "owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "is_accepted": true, "score": 1, "last_activity_date": 1561918251, "creation_date": 1561918251, "answer_id": 56827015, "question_id": 56826731, "link": "https://stackoverflow.com/questions/56826731/iterate-over-recursive-struct-with-recursion-function/56827015#56827015", "title": "Iterate over recursive struct with recursion function", "body": "<p>I think this should work for you.</p>\n\n<pre><code>    type Sitemap struct {\n        XMLName        xml.Name `xml:\"urlset\"`\n        Namespace      string   `xml:\"xmlns,attr\"`\n        Schema         string   `xml:\"xmlns:xsi,attr\"`\n        SchemaLocation string   `xml:\"xsi:schemaLocation,attr\"`\n        Root           *URLItem\n    }\n\n    type URLItem struct {\n        XMLName xml.Name `xml:\"url\"`\n        Loc     string   `xml:\"loc\"`\n        LastMod string   `xml:\"lastmod,omitempty\"`\n        Urls    []*URLItem\n    }\n\n    func (s *Sitemap) AddURL(key string, url string) {\n        node, found := findURLItemRecursive(s.Root, key)\n        if found {\n            node.Urls = append(node.Urls, &amp;URLItem{Loc: url})\n        }\n    }\n\n\n    func findURLItemRecursive(urlItem *URLItem, key string) (*URLItem, bool) {\n        if urlItem.Loc == key {\n            return urlItem, true\n        }\n\n        for _, urlItem := range urlItem.Urls {\n            item, found := findURLItemRecursive(urlItem, key)\n            if found {\n                return item, found\n            }\n        }\n\n        return nil, false\n    }\n</code></pre>\n"}], "owner": {"reputation": 11185, "user_id": 1055637, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8a8b9e4daac99ea95aa3e8e246716e73?s=128&d=identicon&r=PG", "display_name": "Mazzy", "link": "https://stackoverflow.com/users/1055637/mazzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 56827015, "answer_count": 1, "score": 0, "last_activity_date": 1561918251, "creation_date": 1561915653, "question_id": 56826731, "link": "https://stackoverflow.com/questions/56826731/iterate-over-recursive-struct-with-recursion-function", "title": "Iterate over recursive struct with recursion function", "body": "<p>I have the following struct</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    type Sitemap struct {\n        XMLName        xml.Name `xml:\"urlset\"`\n        Namespace      string   `xml:\"xmlns,attr\"`\n        Schema         string   `xml:\"xmlns:xsi,attr\"`\n        SchemaLocation string   `xml:\"xsi:schemaLocation,attr\"`\n        Root           *URLItem\n    }\n\n    type URLItem struct {\n        XMLName xml.Name `xml:\"url\"`\n        Loc     string   `xml:\"loc\"`\n        LastMod string   `xml:\"lastmod,omitempty\"`\n        Urls    []*URLItem\n    }\n\n    func (s *Sitemap) AddURL(key string, url string) {\n        node, found := findURLItemRecursive(s.Root, key)\n        if found {\n            node.Urls = append(node.Urls, &amp;URLItem{Loc: url})\n        }\n    }\n\n\n    func findURLItemRecursive(urlItem *URLItem, key string) (*URLItem, bool) {\n        if urlItem.Loc == key {\n            return urlItem, true\n        }\n\n        for _, urlItem := range urlItem.Urls {\n            return findURLItemRecursive(urlItem, key)\n        }\n\n        return nil, false\n    }\n</code></pre>\n\n<p>where the <code>key</code> is the parent URL and <code>url</code> is the child URL that is linked to the parent for the fact that the children it is found on the page of the parent.</p>\n\n<p>For some unknown reasons <code>findURLItemRecursive</code> is buggy. </p>\n\n<p>The issue is that I can't attach more <code>UrlItem</code>(s) at the second level.</p>\n\n<p>I mean I can create the <code>Root</code> item create the <code>Urls</code> slices for the <code>Root</code> item but then I can't create nested slices. So I can't go more than the first level. </p>\n\n<p>I'm wondering if the function <code>findURLItemRecursive</code> has any obvious bugs in Go that I can't spot.</p>\n"}, {"tags": ["php", "mysql", "go"], "comments": [{"owner": {"reputation": 1858, "user_id": 3939512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151419a72bc96e2b52de539fa524fbc4?s=128&d=identicon&r=PG&f=1", "display_name": "kicken", "link": "https://stackoverflow.com/users/3939512/kicken"}, "edited": false, "score": 1, "creation_date": 1561917040, "post_id": 56826859, "comment_id": 100206117, "body": "Check the code to see if it&#39;s running the query in a loop. It&#39;s not uncommon to see that in poorly coded applications. A 300ms query run 300 times in a loop would take 90 seconds."}, {"owner": {"reputation": 88, "user_id": 3989343, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6370a39a9e665255498e8113ff8c5d3a?s=128&d=identicon&r=PG&f=1", "display_name": "emul", "link": "https://stackoverflow.com/users/3989343/emul"}, "reply_to_user": {"reputation": 1858, "user_id": 3939512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151419a72bc96e2b52de539fa524fbc4?s=128&d=identicon&r=PG&f=1", "display_name": "kicken", "link": "https://stackoverflow.com/users/3939512/kicken"}, "edited": false, "score": 0, "creation_date": 1561918633, "post_id": 56826859, "comment_id": 100206473, "body": "The code has nothing to do with this sadly. I used a pure script what only contains the two version of the query and the measurement of execution time"}, {"owner": {"reputation": 1858, "user_id": 3939512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151419a72bc96e2b52de539fa524fbc4?s=128&d=identicon&r=PG&f=1", "display_name": "kicken", "link": "https://stackoverflow.com/users/3939512/kicken"}, "edited": false, "score": 0, "creation_date": 1561932590, "post_id": 56826859, "comment_id": 100209244, "body": "Try running the query in both places with <a href=\"https://dev.mysql.com/doc/refman/5.7/en/using-explain.html\" rel=\"nofollow noreferrer\">EXPLAIN</a> and see if there are any differences that might cause the issue."}, {"owner": {"reputation": 392, "user_id": 15440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e815c803f08729d19e99a91709ee3b6?s=128&d=identicon&r=PG", "display_name": "Zsolt Szeberenyi", "link": "https://stackoverflow.com/users/15440/zsolt-szeberenyi"}, "edited": false, "score": 0, "creation_date": 1561933858, "post_id": 56826859, "comment_id": 100209419, "body": "We have run both queries with EXPLAIN, the execution plans are identical except one of the tables having the <code>Uses index condition;</code> Extra on it for the prepared version. Also the query is executed only once, nothing is in a loop, the only difference is the prepared statement part. There are not an insane number of parameters either (9 in total), they are also simple (5 ints with values of 0, 1 and 2, and 3 short strings). When checking performance it was clear that all the load is in mysql, which maxes out the CPU. For most of the time the query is in <code>sending data</code> state."}], "answers": [{"tags": [], "owner": {"reputation": 392, "user_id": 15440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e815c803f08729d19e99a91709ee3b6?s=128&d=identicon&r=PG", "display_name": "Zsolt Szeberenyi", "link": "https://stackoverflow.com/users/15440/zsolt-szeberenyi"}, "is_accepted": false, "score": 2, "last_activity_date": 1561968038, "creation_date": 1561968038, "answer_id": 56831981, "question_id": 56826859, "link": "https://stackoverflow.com/questions/56826859/mysql-queries-run-slow-in-php-when-run-as-prepared-statements-in-code-but-run-qu/56831981#56831981", "title": "MySQL queries run slow in PHP when run as prepared statements in code but run quickly via direct MySQL queries", "body": "<p>So as it turns out, this was caused by a slightly different execution plan. MySQL seems to create the execution plan purely based on the statement, not including the parameter values when using prepared statements via <code>mysqli</code> or <code>PDO</code> , which kind of makes sense. However when it's provided with the full query, in our case it introduced an optimisation on one of the tables which made a huge difference.</p>\n\n<p>One of the tables (with 5.5 million rows) had the <code>Using join buffer (Block Nested Loop)</code> Extra on it when running with the non prepared statement, while with the prepared statement it didn't. This seems to have made a close to 1000x performance difference for us.</p>\n\n<p>I am still not sure why this has not an issue via PHPStorm or the CLI <code>mysql</code> client, my best guess is, that certain APIs in MySQL expect the execution plan to be complete when a statement is prepared, while other APIs, and the CLI client don't.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1561916922, "question_id": 1454653}, "owner": {"reputation": 88, "user_id": 3989343, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6370a39a9e665255498e8113ff8c5d3a?s=128&d=identicon&r=PG&f=1", "display_name": "emul", "link": "https://stackoverflow.com/users/3989343/emul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561968038, "creation_date": 1561914420, "last_edit_date": 1561917315, "question_id": 56826859, "link": "https://stackoverflow.com/questions/56826859/mysql-queries-run-slow-in-php-when-run-as-prepared-statements-in-code-but-run-qu", "title": "MySQL queries run slow in PHP when run as prepared statements in code but run quickly via direct MySQL queries", "body": "<p>A PHP application I\u2019m trying to debug runs several badly designed queries on a bigger MySQL database.</p>\n\n<p>A few pages are really slow and it turned out that it is because of a few queries. I started to check every query one by one and though they are slow they are not that slow on their own.</p>\n\n<p>After some further debugging it turned out that they are only slow when they are being run by the application as prepared statements.</p>\n\n<ul>\n<li>If I run the query by hand via MySQL client it takes about 300 ms. If I run create a prepared statement via MySQL client and set the parameters and run it, it takes about 300 ms.</li>\n<li>If I run the simple query from PHP (mysqli) it takes about 300 ms.</li>\n<li>If I run it like the application does\u2014via <a href=\"https://www.php.net/manual/en/book.mysqli.php\" rel=\"nofollow noreferrer\"><code>mysqli</code></a>\u2014as prepared statement it takes 100 seconds.</li>\n</ul>\n\n<p>I thought maybe it's <code>mysqli</code> so I tried it with PDO, the result is the same. Tried different PHP versions (5.6, 7.2, 7.3) and get the same result.</p>\n\n<p>So I gave a last chance and wrote a small Go script to test, and I get the same results and things improved.</p>\n\n<p>Now if I run the prepared statement version of the query from MySQL client or MySQL Workbench or PHPStorms Database client it's fast. And if I run the query from code it's freaking fast.</p>\n\n<p>Any help would be really appreciated about what should I look after, where should I continue my debugging.</p>\n"}, {"tags": ["go", "pprof"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1561987784, "post_id": 56826026, "comment_id": 100225561, "body": "<a href=\"https://golang.org/pkg/runtime/pprof/#WriteHeapProfile\" rel=\"nofollow noreferrer\">golang.org/pkg/runtime/pprof/#WriteHeapProfile</a>"}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": true, "score": 3, "last_activity_date": 1561909405, "creation_date": 1561909405, "answer_id": 56826137, "question_id": 56826026, "link": "https://stackoverflow.com/questions/56826026/how-to-continously-profile-my-go-application/56826137#56826137", "title": "How to continously profile my go application?", "body": "<p>I was hoping that there would be a cool flag to pprof dump on exception (like core dump) but can't find anything.  Pending this there are two options that come to mind:</p>\n\n<ul>\n<li>External: curl pprof regularly using cron or some other driver</li>\n<li>Internal: write pprof regularly from inside the program</li>\n</ul>\n\n<p><strong>External</strong></p>\n\n<pre><code>$ curl http://localhost:8080/debug/pprof/heap &gt; heap.0.pprof\n</code></pre>\n\n<p><strong>Internal</strong></p>\n\n<pre><code>ticker := time.NewTicker(1 * time.Hour)\ngo func() {\n    for {\n       select {\n        case &lt;- ticker.C:\nif err := pprof.WriteHeapProfile(f); err != nil {\n            log.Fatal(\"could not write memory profile: \", err)\n        }\n\n       }\n    }\n}()\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://medium.com/dm03514-tech-blog/sre-debugging-simple-memory-leaks-in-go-e0a9e6d63d4d\" rel=\"nofollow noreferrer\">The external curl is a strategy I often take in order to get heap profiles at regular intervals in order to track/compare memory growth</a>.</p>\n"}], "owner": {"reputation": 467, "user_id": 6084322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbngT.jpg?s=128&g=1", "display_name": "Jeffy Mathew", "link": "https://stackoverflow.com/users/6084322/jeffy-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 56826137, "answer_count": 1, "score": 2, "last_activity_date": 1561918731, "creation_date": 1561908338, "last_edit_date": 1561918731, "question_id": 56826026, "link": "https://stackoverflow.com/questions/56826026/how-to-continously-profile-my-go-application", "title": "How to continously profile my go application?", "body": "<p>My application is having some memory leaks which makes the application crash often. So I started profiling my application with pprof, but I can get the profile only at the instance I hit the url. Are there any ways to find the profile at some intervals so that I can analyze what's happening with the application?</p>\n"}, {"tags": ["c++", "go", "gcc", "linker"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1561903753, "post_id": 56825218, "comment_id": 100203261, "body": "&quot;What should I do get this fixed?&quot; - Why don&#39;t you try what the error message so helpfully told you &quot;recompile with -fPIC&quot; ?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1561914591, "post_id": 56825218, "comment_id": 100205615, "body": "I did a bit of research and found <a href=\"https://bugs.debian.org/823014\" rel=\"nofollow noreferrer\">this</a> (since Ubuntu pulls most of the packages from Debian testing, it is very likely to be relevant). Basically this means on your new OS release you may have Go stdlib built in PIE mode and so it naturally cannot link with the code of the non-compatible link mode. All-in-all, I think this question is unfit for SO as it apparently requires lots of backs-and-forth to get to the root of the problem. Hence could you please post a message <a href=\"https://groups.google.com/group/golang-nuts/\" rel=\"nofollow noreferrer\">to the mailing list</a> instead?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1561914734, "post_id": 56825218, "comment_id": 100205640, "body": "Please be sure to also include the following: 1) &quot;what Go&quot; are you using for bulding\u2014whether it&#39;s the Go compiler provided by GCC of the reference Go implementation (that is, you&#39;ve installed the <code>golang-go</code> package). 2) include the output of <code>go version</code> and <code>go env</code>. 3) Version of your OS and GCC."}, {"owner": {"reputation": 11, "user_id": 11720202, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mcwT06dWSFE/AAAAAAAAAAI/AAAAAAAAAOI/pXRVndO5mtA/photo.jpg?sz=128", "display_name": "Charly Z", "link": "https://stackoverflow.com/users/11720202/charly-z"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1561938629, "post_id": 56825218, "comment_id": 100210040, "body": "@kostix thank you for advice! I have already posted this question to the group alias. btw: I don&#39;t have the c++ source code so I am not able to recompile it."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 1878701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb137db470bcbeffc627cb94736f883?s=128&d=identicon&r=PG", "display_name": "nju04zq", "link": "https://stackoverflow.com/users/1878701/nju04zq"}, "is_accepted": false, "score": 2, "last_activity_date": 1575542776, "last_edit_date": 1575542776, "creation_date": 1575541164, "answer_id": 59192924, "question_id": 56825218, "link": "https://stackoverflow.com/questions/56825218/golang-gcc-c-existing-static-library-can-not-be-used-when-making-a-pie-object/59192924#59192924", "title": "golang gcc c++ existing static library can not be used when making a PIE object; recompile with -fPIC", "body": "<p>I also run into this problem these days. Finally, I found that adding below lines  </p>\n\n<pre><code>\"env CGO_LDFLAGS=-no-pie\"\n</code></pre>\n\n<p>to go build command line could solve this problem. For example, </p>\n\n<pre><code>\"env CGO_LDFLAGS=-no-pie go build -o main main.go\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11720202, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mcwT06dWSFE/AAAAAAAAAAI/AAAAAAAAAOI/pXRVndO5mtA/photo.jpg?sz=128", "display_name": "Charly Z", "link": "https://stackoverflow.com/users/11720202/charly-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575542776, "creation_date": 1561901386, "last_edit_date": 1561914144, "question_id": 56825218, "link": "https://stackoverflow.com/questions/56825218/golang-gcc-c-existing-static-library-can-not-be-used-when-making-a-pie-object", "title": "golang gcc c++ existing static library can not be used when making a PIE object; recompile with -fPIC", "body": "<p>I tried to link an existing C++ library to go code. The C++ library only has a static library and a header file, no source code. </p>\n\n<p>I used swigc to generate a libfoo.go and I wrote a simple libb.go to build this library. This worked well on ubuntu 16.04 with gcc-6 earlier. </p>\n\n<p>However, once I upgraded to ubuntu 18, and even with older go1.9 and gcc-6, which used to work, I am hitting the following error:</p>\n\n<pre><code>/usr/bin/ld: ./lib/libfoo.a(parser.o): relocation R_X86_64_32S against symbol `xmlSAX2IgnorableWhitespace' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: ./lib/libfoo.a(tree.o): relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a PIE object; recompile with -fPIC\n</code></pre>\n\n<p>I have downgraded both go compiler and gcc to the version that used to work. </p>\n\n<p>The following is the libb.go that used to work</p>\n\n<pre><code>/*\n#cgo CXXFLAGS: -std=c++11 -D_GLIBCXX_USE_CXX11_ABI=0 -w\n#cgo CFLAGS: -I${SRCDIR}/include -w\n#cgo LDFLAGS: -Wl -rpath,./lib, -L${SRCDIR}/lib -l:libfoo.a  -l:libxml2.a \n*/\nimport \"C\"\n</code></pre>\n\n<p>What should I do get this fixed? I searched and it seems that I have to recompile that static library, which is mission impossible in my case. I tried to pass the -no-pie parameter to LDFLAGS, that didn't work either.</p>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1561901187, "post_id": 56824953, "comment_id": 100202682, "body": "&quot;I am not able to reference local-packages.&quot; What&#39;s stopping you? Modules in now way have to consist of a single package."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1561917367, "post_id": 56824953, "comment_id": 100206183, "body": "You should elaborate on that &quot;\u2026not able to reference local packages&quot;. That is, what exactly are you doing to build your code (including all the <code>cd</code>s, and calls to <code>go build</code>/<code>go install</code>), how this fails\u2014with precise error messages, and how the relevant bits of your code look like\u2014the import sections of the affected files are of the most interest."}], "owner": {"reputation": 11, "user_id": 5778004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9fuod.jpg?s=128&g=1", "display_name": "Raffael Rehberger", "link": "https://stackoverflow.com/users/5778004/raffael-rehberger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561900946, "creation_date": 1561898813, "last_edit_date": 1561900946, "question_id": 56824953, "link": "https://stackoverflow.com/questions/56824953/dealing-with-multi-language-repository-including-go-code", "title": "Dealing with Multi-Language Repository (including Go Code)", "body": "<p>I am currently intending to maintain a single Git-Repository that contains multiple services written in different languages. So far no problem - lately I discovered Go and loved it - so I decided to create a new service in Go and put it into the same repository.</p>\n\n<pre><code>src/\n   | pythonService/\n     &gt; main.py\n   | golangService/\n     | localGoPackage/\n       &gt; someLib.go\n     &gt; main.go\n     &gt; go.mod\n     &gt; go.sum\n   | csharpService/\n     &gt; some.cs\n</code></pre>\n\n<p>my workflow so far was cloning the Repository to let's say <code>~/repos/</code> and copying the Service written in Go to the GOPATH. When changes on code were made, I just copied the changed files back to the Repository and commited the changes. I really wish there was a better way to deal with this. </p>\n\n<p>Then I heard about Go-Modules, which sounded like they would solve this once and for all. However when using GoModules I am not able to reference local-packages inside the goService anymore. </p>\n\n<p>Any recommendations or suggestions from your site on how one could achieve this?</p>\n"}, {"tags": ["go", "reactive", "go-swagger"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11719710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2a7ziJD2C1c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdVyUB_Z18rBWMGWKqE5fwg5GBjlg/photo.jpg?sz=128", "display_name": "Tony Manior", "link": "https://stackoverflow.com/users/11719710/tony-manior"}, "edited": false, "score": 0, "creation_date": 1561965386, "post_id": 56828828, "comment_id": 100214814, "body": "But bases on this example i cant middleware.ResponderFunc i must return the value as part of my Nexthandler which is impossible , is there i way that i can write response with out return the  middleware"}, {"owner": {"reputation": 1, "user_id": 11719710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2a7ziJD2C1c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdVyUB_Z18rBWMGWKqE5fwg5GBjlg/photo.jpg?sz=128", "display_name": "Tony Manior", "link": "https://stackoverflow.com/users/11719710/tony-manior"}, "edited": false, "score": 0, "creation_date": 1561966464, "post_id": 56828828, "comment_id": 100215210, "body": "I tried the link and implement the method x := middleware.ResponderFunc with dummy string &quot;hello&quot; but stil not able to see it as part of the response"}], "tags": [], "owner": {"reputation": 1159, "user_id": 23418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39a948a58f4569c53d971c2e120920?s=128&d=identicon&r=PG", "display_name": "Casual Jim", "link": "https://stackoverflow.com/users/23418/casual-jim"}, "is_accepted": false, "score": 0, "last_activity_date": 1561939053, "creation_date": 1561939053, "answer_id": 56828828, "question_id": 56823834, "link": "https://stackoverflow.com/questions/56823834/go-swagger-ability-to-write-response-for-async-reactive-code/56828828#56828828", "title": "Go Swagger ability to write response for async reactive code", "body": "<p>the middleware.Responder is a simple one method interface that gives you full access to the response and the serializers for that response content type.</p>\n\n<p>You can take a look at this example: <a href=\"https://github.com/go-swagger/go-swagger/blob/master/examples/stream-server/restapi/configure_countdown.go#L43-L47\" rel=\"nofollow noreferrer\">https://github.com/go-swagger/go-swagger/blob/master/examples/stream-server/restapi/configure_countdown.go#L43-L47</a></p>\n\n<p>It streams a counter but it's the same use case.</p>\n"}], "owner": {"reputation": 1, "user_id": 11719710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2a7ziJD2C1c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdVyUB_Z18rBWMGWKqE5fwg5GBjlg/photo.jpg?sz=128", "display_name": "Tony Manior", "link": "https://stackoverflow.com/users/11719710/tony-manior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561966348, "creation_date": 1561887779, "last_edit_date": 1561966348, "question_id": 56823834, "link": "https://stackoverflow.com/questions/56823834/go-swagger-ability-to-write-response-for-async-reactive-code", "title": "Go Swagger ability to write response for async reactive code", "body": "<p>I am using goswagger to generate my restAPI code and as part of this generated code for writing responses I should return middleware.Responder.\nI would like to have the option to write the response directly using the API client as I am using the gorx reactive extension, which is impossible to return a value as its running in async mode.</p>\n\n<pre><code>Code Example:\n\n//Handle which is generated by goswagger\napi.TodosFindTodosHandler = todos.FindTodosHandlerFunc(func(params todos.FindTodosParams) middleware.Responder {\n        return getToListHandler(api)\n\n    })\n\n\n//goRx code which iterate over all items and handle it using observer model\n  func getToListHandler(api *operations.TodoListAPI) middleware.Responder {\n    watcher := observer.Observer{\n        NextHandler: func(item interface{}) {\n            ms, ok := item.(*models.Item)\n            if ok {\n                 //How can write the response here i tried this but didnt work\n                result := middleware.ResponderFunc(func(rw \n                http.ResponseWriter, p runtime.Producer) {\n                rw.Write([]byte(\"hello\"))\n                rw.WriteHeader(200)\n            })\n             //message just to use the result value to skip error\n            fmt.Println(\"result value of method '%v'\", x)\n                })\n\n            }\n        },\n        // Register a handler for any emitted error.\n        ErrHandler: func(err error) {\n             //How can write the response here\n        },\n\n        // Register a handler when a stream is completed.\n        DoneHandler: func() {\n         //How can write the response here\n        },\n    }\n    it, _ := iterable.New(getAllTGoListMode())\n    source := observable.From(it)\n    sub := source.Subscribe(watcher)\n    &lt;-sub\n    return middleware.NotImplemented(\"DONE....\")\n  } \n</code></pre>\n\n<p>As part of my code I would like to write the response directly as part of the NextHandler, NextHandler, DoneHandler</p>\n\n<p>Thanks </p>\n\n<p>Tony.</p>\n"}, {"tags": ["go", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 904, "user_id": 1967239, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ab12cb18e11faa9245a222f656325319?s=128&d=identicon&r=PG", "display_name": "Banoona", "link": "https://stackoverflow.com/users/1967239/banoona"}, "edited": false, "score": 1, "creation_date": 1561924506, "post_id": 56825009, "comment_id": 100207729, "body": "Thank you for such a comprehensive answer."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1561899471, "creation_date": 1561899471, "answer_id": 56825009, "question_id": 56823390, "link": "https://stackoverflow.com/questions/56823390/how-to-output-json-format-errors-in-golang-rest-specifically-referencing-the-ba/56825009#56825009", "title": "How to output json format errors in Golang rest, specifically referencing the bad fields", "body": "<p>The <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package doesn't provide validation for \"blank\", nor \"silly\" values. It will return an error only if the data in the body is <em>not</em> a valid json, or if the field types in the json do not, according to the package's spec, match the field types of the structure into which you're trying to decode that json.</p>\n\n<p>The 1st type of error would be the <a href=\"https://golang.org/pkg/encoding/json/#SyntaxError\" rel=\"nofollow noreferrer\"><code>json.SyntaxError</code></a>, if you get this it is not always possible to satisfy your requirements since there may be <em>no</em> actual fields which you could use in your response, or if there are json fields, they, and their values, may be perfectly valid json, but the cause of the error may lie elsewhere (see <a href=\"https://play.golang.com/p/N3kTumeEN_2\" rel=\"nofollow noreferrer\">example</a>).</p>\n\n<p>In cases where the data holds actual json fields but it has, for example, non-json values you could use the <code>Offset</code> field of the <code>SyntaxError</code> type to find the closest preceding field in the data stream. Using <a href=\"https://golang.org/pkg/strings/#LastIndex\" rel=\"nofollow noreferrer\"><code>strings.LastIndex</code></a> you can implement a <em>naive</em> solution to look backwards for the field.</p>\n\n<pre><code>data := []byte(`{\"foobar\": i'm not json}`)\n\nerr := json.Unmarshal(data, &amp;T{})\nse, ok := err.(*json.SyntaxError)\nif !ok {\n    panic(err)\n}\n\nfield := string(data[:se.Offset])\nif i := strings.LastIndex(field, `\":`); i &gt;= 0 {\n    field = field[:i]\n    if j := strings.LastIndex(field, `\"`); j &gt;= 0 {\n        field = field[j+1:]\n    }\n}\nfmt.Println(field) // outputs foobar\n</code></pre>\n\n<p><a href=\"https://play.golang.com/p/idxyW76oEWq\" rel=\"nofollow noreferrer\">Playground link</a></p>\n\n<p><em>NOTE:</em> As you can see, for you to be able to look for the field, you need to have access to the data, but when you're using <code>json.NewDecoder</code> and passing it the request's body directly, without first storing its contents somewhere, you'll loose access to that data once the decoder's <code>Decode</code> method is done. This is because the body is a stream of bytes wrapped in a <code>io.ReadCloser</code> that does not support \"rewinding\", i.e. you cannot <em>re-read</em> bytes that the decoder already read. To avoid this you can use <a href=\"https://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"nofollow noreferrer\"><code>ioutil.ReadAll</code></a> to read the full contents of the body and then <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal</code></a> to do the decoding.</p>\n\n<hr>\n\n<p>The 2nd type of error would be the <a href=\"https://golang.org/pkg/encoding/json/#UnmarshalTypeError\" rel=\"nofollow noreferrer\"><code>json.UnmarshalTypeError</code></a>. If you look at the documentation of the error type and its fields you'll know that all you need to do is to type assert the returned value and you're done. <a href=\"https://play.golang.com/p/hJqNReYMGIm\" rel=\"nofollow noreferrer\">Example</a></p>\n\n<hr>\n\n<p>Validation against \"blank\" and \"silly\" values would be done after the json has been successfully decoded into your structure. How you do that is up to you. For example you could use a 3rd party package that's designed for validating structs, or you can implement an in-house solution yourself, etc. I actually don't have an opinion on which one of them is the \"best\" so I can't help you with that.</p>\n\n<p>What I can say is that the most <em>basic</em> approach would be to simply look at each field of the structure and check if its value is valid or not according to the requirements for that field.</p>\n"}], "owner": {"reputation": 904, "user_id": 1967239, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ab12cb18e11faa9245a222f656325319?s=128&d=identicon&r=PG", "display_name": "Banoona", "link": "https://stackoverflow.com/users/1967239/banoona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 56825009, "answer_count": 1, "score": -1, "last_activity_date": 1561899471, "creation_date": 1561882393, "question_id": 56823390, "link": "https://stackoverflow.com/questions/56823390/how-to-output-json-format-errors-in-golang-rest-specifically-referencing-the-ba", "title": "How to output json format errors in Golang rest, specifically referencing the bad fields", "body": "<p>I have the following requirement: return errors from a REST API in the following format: </p>\n\n<pre><code>Error format\n422\n{\n    \"name-of-field\": [\n        \"can't be blank\",\n        \"is too silly\"\n    ]\n}\n</code></pre>\n\n<p>My code looks like this: </p>\n\n<pre><code>var PostFeedback = func(w http.ResponseWriter, r *http.Request) {\n    params := mux.Vars(r)\n    surveyId := params[\"id\"]\n    feedback := &amp;models.Feedback{}\n    err := json.NewDecoder(r.Body).Decode(feedback)\n    if err != nil {\n        jsonError := fmt.Sprintf(`{\n            \"%s\": [\n                \"%s\"\n            ]\n        }`, \"errors\", err)\n        log.Printf(\"invalid input format, %v\", jsonError)\n        resp := map[string]interface{}{\"error\": jsonError}\n        u.Respond(w, resp)\n        return\n    }\n</code></pre>\n\n<p><strong>Questions:</strong></p>\n\n<p>How do I get the names of the offending fields?<br>\nHow do I satisfy the requirement best?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": true, "score": 3, "last_activity_date": 1561864570, "last_edit_date": 1592644375, "creation_date": 1561864570, "answer_id": 56822180, "question_id": 56822134, "link": "https://stackoverflow.com/questions/56822134/syntax-error-non-declaration-statement-outside-function-body-but-everything-th/56822180#56822180", "title": "Syntax error: Non-declaration statement outside function body, but everything there is declaration", "body": "<p>Per the <a href=\"https://golang.org/ref/spec#Source_file_organization\" rel=\"nofollow noreferrer\">Go specification</a>:</p>\n<blockquote>\n<p>Each source file consists of a package clause defining the package to\nwhich it belongs, followed by a possibly empty set of import\ndeclarations that declare packages whose contents it wishes to use,\nfollowed by a possibly empty set of declarations of functions, types,\nvariables, and constants.</p>\n<pre><code>SourceFile       = PackageClause &quot;;&quot; { ImportDecl &quot;;&quot; } { TopLevelDecl &quot;;&quot; } .\n</code></pre>\n</blockquote>\n<p>This means that top-level declarations such as <code>var formatter string = &quot;fmt&quot; </code> must come <em>after</em> any import declarations, if any import declarations are present. Technically, you're getting this error because the definition of <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">declaration</a> does not include import declarations (despite the name), and your source code has an import declaration after a top-level declaration, where an import declaration is not allowed to be.</p>\n<p>Furthermore, the <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">Import declarations section</a> shows that import paths must be string literals, so even if it weren't for the ordering issue, you still wouldn't be able to do what you're attempting.</p>\n"}], "owner": {"reputation": 5628, "user_id": 342293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3127caeaad3e4eb8d20e2589356567c8?s=128&d=identicon&r=PG", "display_name": "Ron", "link": "https://stackoverflow.com/users/342293/ron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 56822180, "answer_count": 1, "score": -3, "last_activity_date": 1561864570, "creation_date": 1561863810, "last_edit_date": 1561864563, "question_id": 56822134, "link": "https://stackoverflow.com/questions/56822134/syntax-error-non-declaration-statement-outside-function-body-but-everything-th", "title": "Syntax error: Non-declaration statement outside function body, but everything there is declaration", "body": "<p>This doesn't work:</p>\n\n<pre><code>package main\n\nvar formatter string = \"fmt\"\n\nimport (\n    formatter\n)\n\nfunc main() {\n    fmt.Println(formatter)\n}\n</code></pre>\n\n<p>I got: <code>syntax error: non-declaration statement outside function body</code></p>\n\n<p>Even though everything there is declaration.</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 467, "user_id": 6084322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbngT.jpg?s=128&g=1", "display_name": "Jeffy Mathew", "link": "https://stackoverflow.com/users/6084322/jeffy-mathew"}, "edited": false, "score": 0, "creation_date": 1561876434, "post_id": 56821426, "comment_id": 100198480, "body": "Have you tried <code>`sql:&quot;DEFAULT:nextval(&#39;sequence_name&#39;)&quot;`</code> By changing the tagging from gorm to sql"}, {"owner": {"reputation": 77, "user_id": 1271257, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9cb7a8800c84b03e579af22c00417eee?s=128&d=identicon&r=PG", "display_name": "Guy", "link": "https://stackoverflow.com/users/1271257/guy"}, "reply_to_user": {"reputation": 467, "user_id": 6084322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbngT.jpg?s=128&g=1", "display_name": "Jeffy Mathew", "link": "https://stackoverflow.com/users/6084322/jeffy-mathew"}, "edited": false, "score": 0, "creation_date": 1562031914, "post_id": 56821426, "comment_id": 100240090, "body": "Oh I forgot to mention I also need  <code>gorm:&quot;many2many:relationship_table;&quot;</code>"}], "owner": {"reputation": 77, "user_id": 1271257, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9cb7a8800c84b03e579af22c00417eee?s=128&d=identicon&r=PG", "display_name": "Guy", "link": "https://stackoverflow.com/users/1271257/guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563992777, "creation_date": 1561849992, "last_edit_date": 1563992777, "question_id": 56821426, "link": "https://stackoverflow.com/questions/56821426/setting-default-value-as-custom-sequence", "title": "Setting default value as custom sequence", "body": "<p>Question regarding the declaration of primary key with default value.</p>\n\n<p>Using cockroachDB, we can create sequence to basically have ID starting from 1, with regular increment of 1.</p>\n\n<p><a href=\"https://www.cockroachlabs.com/docs/stable/create-sequence.html\" rel=\"nofollow noreferrer\">create sequence for cockroachdb</a></p>\n\n<p>Trying to create my model with default value <code>nextval('sequence_name')</code></p>\n\n<blockquote>\n  <p>`gorm:\"DEFAULT:nextval('sequence_name')\"`</p>\n</blockquote>\n\n<p>Tried this one above, but it's not working (edited) </p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1561835436, "post_id": 56820192, "comment_id": 100193314, "body": "You have a strange definition of &quot;nothing happens.&quot; It sounds like your program is successfully executing to completion."}, {"owner": {"reputation": 904, "user_id": 1967239, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ab12cb18e11faa9245a222f656325319?s=128&d=identicon&r=PG", "display_name": "Banoona", "link": "https://stackoverflow.com/users/1967239/banoona"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1561884137, "post_id": 56820192, "comment_id": 100199692, "body": "I set a breakpoint.  VS Code is not catching the breakpoint and entering debug step-through.  Also, nothing is printed to the console."}, {"owner": {"reputation": 1041, "user_id": 2660313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7f4cadd6658af696e1d975eda49c49?s=128&d=identicon&r=PG", "display_name": "owlwalks", "link": "https://stackoverflow.com/users/2660313/owlwalks"}, "edited": false, "score": 1, "creation_date": 1561909138, "post_id": 56820192, "comment_id": 100204463, "body": "Ctrl + shift + p, cmd box opens, type in go: install/update tools, install them all, then run debug again"}], "answers": [{"tags": [], "owner": {"reputation": 904, "user_id": 1967239, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ab12cb18e11faa9245a222f656325319?s=128&d=identicon&r=PG", "display_name": "Banoona", "link": "https://stackoverflow.com/users/1967239/banoona"}, "is_accepted": true, "score": 0, "last_activity_date": 1562401715, "creation_date": 1562401715, "answer_id": 56912446, "question_id": 56820192, "link": "https://stackoverflow.com/questions/56820192/unable-to-debug-go-in-visual-studio-code/56912446#56912446", "title": "Unable to debug Go in visual studio code", "body": "<p>Here is the answer:</p>\n\n<p>Ctrl+Shift+P ==> Open Launch.json ==> Save ==> Voila! </p>\n\n<p>(It works.  I am now able to step through and debug a simple application with one main.go file in Visual Studio Code)</p>\n\n<p>Note that I have installed all of the dev tools (as per @owlwalks above), as well as dlv (see here: <a href=\"https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code</a>)</p>\n"}], "owner": {"reputation": 904, "user_id": 1967239, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ab12cb18e11faa9245a222f656325319?s=128&d=identicon&r=PG", "display_name": "Banoona", "link": "https://stackoverflow.com/users/1967239/banoona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56912446, "answer_count": 1, "score": -4, "last_activity_date": 1562402008, "creation_date": 1561835320, "last_edit_date": 1562402008, "question_id": 56820192, "link": "https://stackoverflow.com/questions/56820192/unable-to-debug-go-in-visual-studio-code", "title": "Unable to debug Go in visual studio code", "body": "<p>I have a folder, D:\\Data\\Git\\go\\src\\demo containing one file, main.go.\nI have installed go1.12.6 windows/amd64. (I am running Windows 10)\nI am unable to debug the application - the debugger flashes on the screen then disappears ==> nothing happens ==>  even though I have set a breakpoint, it does not break into the code for interactive step-through!\nI can run the app from the commandline ==> go run main.go (current directory is where main.go is located)</p>\n\n<p>My launch.json looks like this: </p>\n\n<pre><code>{\n    // Use IntelliSense to learn about possible attributes.\n    // Hover to view descriptions of existing attributes.\n    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Launch\",\n            \"type\": \"go\",\n            \"request\": \"launch\",\n            \"mode\": \"auto\",\n            \"program\": \"${fileDirname}\",\n            \"env\": {},\n            \"args\": []\n        }\n    ]\n}\n</code></pre>\n\n<p>Here is my app: </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := []int{2, 3, 5, 7, 11, 13}\n    s = s[1:4]\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>How do I get to debug in VS Code? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1561825532, "post_id": 56818948, "comment_id": 100191361, "body": "It&#39;s dependent on perl and shell to do what those files do, which is generate some source files. The runtime is not dependent on those if that&#39;s what you&#39;re asking."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1561854797, "post_id": 56821025, "comment_id": 100196209, "body": "You don&#39;t need perl to build Go, those scripts are for regenerating some source files.  You do need an existing Go install for bootstrapping and one of the supported shells to start the process."}], "tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": true, "score": 0, "last_activity_date": 1561915821, "last_edit_date": 1561915821, "creation_date": 1561844307, "answer_id": 56821025, "question_id": 56818948, "link": "https://stackoverflow.com/questions/56818948/is-go-dependent-on-perl-sh/56821025#56821025", "title": "Is Go dependent on Perl &amp; sh", "body": "<p>Yes, you need a shell to build Go itself. But your system already has some sort of shell, so that's not really relevant. You need Perl to regenerate some of the source files, but that's not something you would normally do even if building Go, as the files are already generated there.</p>\n\n<p>You do not necessarily need them to build your own programs written in Go, though as mentioned already, you already have a shell of some sort.</p>\n"}], "owner": {"reputation": 6242, "user_id": 1772898, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6d4dd3f6cc6759c972ec92d819001495?s=128&d=identicon&r=PG&f=1", "display_name": "blueray", "link": "https://stackoverflow.com/users/1772898/blueray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56821025, "answer_count": 1, "score": -2, "last_activity_date": 1561915821, "creation_date": 1561823982, "last_edit_date": 1561828437, "question_id": 56818948, "link": "https://stackoverflow.com/questions/56818948/is-go-dependent-on-perl-sh", "title": "Is Go dependent on Perl &amp; sh", "body": "<p>I checked the <a href=\"https://golang.org/src/syscall/\" rel=\"nofollow noreferrer\">source code of the <code>syscall</code> package</a>.</p>\n\n<p>I found that there are files like mkall.sh, mkerrors.sh, mksyscall.pl, mksyscall_libc.pl etc.</p>\n\n<p>It arouse the question - Is Go dependent on Perl and sh?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "is_accepted": false, "score": 7, "last_activity_date": 1561816955, "creation_date": 1561816955, "answer_id": 56818150, "question_id": 56818094, "link": "https://stackoverflow.com/questions/56818094/how-do-i-debug-a-dependency-package-if-i-have-its-source-code/56818150#56818150", "title": "How do I debug a dependency package? If I have its source code", "body": "<p>Go module fetches packages into <code>$GOPATH/pkg/mod</code> you can change the source code there or using the vendor option of go mod to pull the packages into vendor folder and then start coding there.</p>\n"}, {"comments": [{"owner": {"reputation": 18855, "user_id": 404264, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6ff3f136c340de6931974e710bf30f89?s=128&d=identicon&r=PG", "display_name": "Dagang", "link": "https://stackoverflow.com/users/404264/dagang"}, "edited": false, "score": 0, "creation_date": 1561826892, "post_id": 56818680, "comment_id": 100191593, "body": "Thanks, but how do I specify only the desired package? no others."}, {"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "reply_to_user": {"reputation": 18855, "user_id": 404264, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6ff3f136c340de6931974e710bf30f89?s=128&d=identicon&r=PG", "display_name": "Dagang", "link": "https://stackoverflow.com/users/404264/dagang"}, "edited": false, "score": 1, "creation_date": 1561827069, "post_id": 56818680, "comment_id": 100191633, "body": "You don&#39;t need to. Vendor folder will contain all packages but you will only change the one you want to debug."}, {"owner": {"reputation": 18855, "user_id": 404264, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6ff3f136c340de6931974e710bf30f89?s=128&d=identicon&r=PG", "display_name": "Dagang", "link": "https://stackoverflow.com/users/404264/dagang"}, "edited": false, "score": 0, "creation_date": 1561830721, "post_id": 56818680, "comment_id": 100192357, "body": "It worked perfectly. After debugging, I can simply delete the vendor/ folder, right?"}, {"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "reply_to_user": {"reputation": 18855, "user_id": 404264, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6ff3f136c340de6931974e710bf30f89?s=128&d=identicon&r=PG", "display_name": "Dagang", "link": "https://stackoverflow.com/users/404264/dagang"}, "edited": false, "score": 0, "creation_date": 1561833043, "post_id": 56818680, "comment_id": 100192834, "body": "Correct, delete the vendor folder and build/run your project as usual (i.e. just <code>go build</code> or <code>go run</code>)."}], "tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": true, "score": 14, "last_activity_date": 1561830807, "last_edit_date": 1561830807, "creation_date": 1561821656, "answer_id": 56818680, "question_id": 56818094, "link": "https://stackoverflow.com/questions/56818094/how-do-i-debug-a-dependency-package-if-i-have-its-source-code/56818680#56818680", "title": "How do I debug a dependency package? If I have its source code", "body": "<p>First fetch all the dependency packages into the <code>vendor</code> folder.</p>\n\n<pre><code>go mod vendor\n</code></pre>\n\n<p>Then, change the source code in that and build your project by specifying to look into <code>vendor</code> folder.</p>\n\n<pre><code>go build -mod=vendor\n</code></pre>\n\n<p>or</p>\n\n<pre><code>go run -mode=vendor myapp.go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1041, "user_id": 2660313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7f4cadd6658af696e1d975eda49c49?s=128&d=identicon&r=PG", "display_name": "owlwalks", "link": "https://stackoverflow.com/users/2660313/owlwalks"}, "is_accepted": false, "score": 8, "last_activity_date": 1561874333, "creation_date": 1561874333, "answer_id": 56822748, "question_id": 56818094, "link": "https://stackoverflow.com/questions/56818094/how-do-i-debug-a-dependency-package-if-i-have-its-source-code/56822748#56822748", "title": "How do I debug a dependency package? If I have its source code", "body": "<p>You can use <a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"noreferrer\">replace directive</a>:</p>\n\n<pre><code>replace example.com/original/import/path =&gt; /your/forked/import/path\n</code></pre>\n"}], "owner": {"reputation": 18855, "user_id": 404264, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6ff3f136c340de6931974e710bf30f89?s=128&d=identicon&r=PG", "display_name": "Dagang", "link": "https://stackoverflow.com/users/404264/dagang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1575, "favorite_count": 1, "accepted_answer_id": 56818680, "answer_count": 3, "score": 13, "last_activity_date": 1561874333, "creation_date": 1561816462, "last_edit_date": 1561818946, "question_id": 56818094, "link": "https://stackoverflow.com/questions/56818094/how-do-i-debug-a-dependency-package-if-i-have-its-source-code", "title": "How do I debug a dependency package? If I have its source code", "body": "<p>My Go project depends on package <code>example.com/foo</code>. I am using Go 1.12, so the dependency is automatically pulled in by Go modules. Now, there is an error happening inside of the dependency, I want to debug it by adding log or step by step execution. I can find the source code of the  dependency on GitHub but I don't know how to fit it into my project, so that it replaces the dependency which was pulled in by Go modules.</p>\n"}, {"tags": ["go", "gitlab", "godeps"], "comments": [{"owner": {"reputation": 9, "user_id": 8103271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aef68d83c2ccdeeda40fa252051f39e?s=128&d=identicon&r=PG&f=1", "display_name": "Ubik", "link": "https://stackoverflow.com/users/8103271/ubik"}, "edited": false, "score": 0, "creation_date": 1600327772, "post_id": 56817601, "comment_id": 113054049, "body": "Solution for SSH: <a href=\"https://stackoverflow.com/q/63932562/8103271\">stackoverflow.com/q/63932562/8103271</a>"}], "answers": [{"tags": [], "owner": {"reputation": 586, "user_id": 8580266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911ad9fb565b3ce8c460014df914b3bf?s=128&d=identicon&r=PG&f=1", "display_name": "alexzimmer96", "link": "https://stackoverflow.com/users/8580266/alexzimmer96"}, "is_accepted": false, "score": 0, "last_activity_date": 1561875660, "creation_date": 1561875660, "answer_id": 56822842, "question_id": 56817601, "link": "https://stackoverflow.com/questions/56817601/how-to-use-go-dep-with-gitlab-subgroups/56822842#56822842", "title": "How to use Go dep with GitLab subgroups", "body": "<p>I think the best solution would be to use a proxy-server like <a href=\"https://github.com/gomods/athens\" rel=\"nofollow noreferrer\">athens</a>. You could add your Gitlab-Credentials and use it as proxy-server. Athens then would handle authentication.</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 2, "last_activity_date": 1600326376, "last_edit_date": 1600326376, "creation_date": 1563469714, "answer_id": 57099566, "question_id": 56817601, "link": "https://stackoverflow.com/questions/56817601/how-to-use-go-dep-with-gitlab-subgroups/57099566#57099566", "title": "How to use Go dep with GitLab subgroups", "body": "<p>This issue is discussed at length on the <a href=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/37832\" rel=\"nofollow noreferrer\">GitLab support tracker</a>.</p>\n<p>TL;DR; It's (intentionally) <a href=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/37832#note_53668438\" rel=\"nofollow noreferrer\">broken for private repos</a>:</p>\n<blockquote>\n<p>Is [your group] private? If so, this is expected behavior, and I would recommend reading the discussion from <a href=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/1337#note_36293613\" rel=\"nofollow noreferrer\">#1337 (comment 36293613)</a> onwards. In this case, we have decided to maximize security/privacy at the slight expense of usability. The recommended workaround is to specifically add .git to your URL.</p>\n</blockquote>\n<p>The only solution I've found is to use <a href=\"https://github.com/golang/dep/blob/master/docs/FAQ.md#how-do-i-get-dep-to-consume-private-git-repos-using-a-github-token\" rel=\"nofollow noreferrer\"><code>go get</code>'s support for <code>.netrc</code></a>, which solves this both for <code>dep</code>, as well as modern Go modules.</p>\n<ol>\n<li><p>Create a Personal Access token on GitLab with <strong>api</strong> scope:\n<a href=\"https://i.stack.imgur.com/ijiPG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ijiPG.png\" alt=\"enter image description here\" /></a></p>\n</li>\n<li><p>Create a <code>~/.netrc</code> file:</p>\n<pre><code> machine gitlab.com\n     login &lt;your gitlab username&gt;\n     password &lt;the token created in step 1&gt;\n</code></pre>\n</li>\n<li><p>Protect your <code>.netrc</code> file a bit:</p>\n<pre><code> chmod 600 ~/.netrc\n</code></pre>\n</li>\n<li><p>Profit</p>\n</li>\n</ol>\n<p>This should now work:</p>\n<pre><code>    dep ensure -add gitlab.com/&lt;company&gt;/&lt;subgroup&gt;/&lt;project&gt;\n</code></pre>\n<p>If you're using a private GitLab installation, I trust you to replace <code>gitlab.com</code> with the appropriate hostname where applicable.</p>\n"}], "owner": {"reputation": 887, "user_id": 3789634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pPNmf.jpg?s=128&g=1", "display_name": "srimaln91", "link": "https://stackoverflow.com/users/3789634/srimaln91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 1, "accepted_answer_id": 57099566, "answer_count": 2, "score": 1, "last_activity_date": 1600326376, "creation_date": 1561811977, "last_edit_date": 1577781104, "question_id": 56817601, "link": "https://stackoverflow.com/questions/56817601/how-to-use-go-dep-with-gitlab-subgroups", "title": "How to use Go dep with GitLab subgroups", "body": "<p>I have a Go project that requires some dependencies from a private GitLab repository like git.mydomain.com/myteam/category/subcategory/project.git.\nBut I'm getting this error.</p>\n\n<pre><code>ensure Solve(): remote repository at https://git.mydomain.com/myteam/category.git does not exist or is inaccessible: : exit status 128\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 4420958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212cadd0a6448c307c19ac240248efd7?s=128&d=identicon&r=PG", "display_name": "Denis Volin", "link": "https://stackoverflow.com/users/4420958/denis-volin"}, "is_accepted": true, "score": 4, "last_activity_date": 1561811467, "creation_date": 1561811467, "answer_id": 56817557, "question_id": 56817469, "link": "https://stackoverflow.com/questions/56817469/how-can-convert-hex-to-int-using-go/56817557#56817557", "title": "How can convert hex to int using go", "body": "<p>Maximum value for uint64 is 0xFFFF FFFF FFFF FFFF, thus to use overflowing value you have to resort to package math/big of the standard library:</p>\n\n<pre><code>import \"math/big\"\n\n...\n\nn := new(big.Int)\nn.SetString(numberStr, 16)\n</code></pre>\n\n<p>Continue with the package <a href=\"https://golang.org/pkg/math/big\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 10378494, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_A0thozSJeI/AAAAAAAAAAI/AAAAAAAABIg/em1RYt8Vdjw/photo.jpg?sz=128", "display_name": "Sarath Kumar", "link": "https://stackoverflow.com/users/10378494/sarath-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2526, "favorite_count": 0, "closed_date": 1561813357, "accepted_answer_id": 56817557, "answer_count": 1, "score": 1, "last_activity_date": 1561813344, "creation_date": 1561810708, "last_edit_date": 1561813344, "question_id": 56817469, "link": "https://stackoverflow.com/questions/56817469/how-can-convert-hex-to-int-using-go", "closed_reason": "Duplicate", "title": "How can convert hex to int using go", "body": "<p>I converting hex value to decimal using go using below mentioned code</p>\n\n<pre><code>numberStr := strings.Replace(s, \"0x\", \"\", -1)\n    numberStr = strings.Replace(numberStr, \"0X\", \"\", -1)\n    n, err := strconv.ParseUint(numberStr, 16, 64)\n    if err != nil {\n        panic(err)\n    }\n    return n \n</code></pre>\n\n<p>Hexa value is : <code>0x340aad21b3b700000</code></p>\n\n<p>but thrown error : <code>strconv.ParseUint: parsing \"340aad21b3b700000\": value out of range</code></p>\n\n<p>Can you suggest any alternate solution.</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "edited": false, "score": 0, "creation_date": 1561798637, "post_id": 56816075, "comment_id": 100186057, "body": "can you give me an example using related query and how to fetch the data? I test your code but i didn&#39;t know how to fetch data event reviews"}], "tags": [], "owner": {"reputation": 2862, "user_id": 10115847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Okv0j.jpg?s=128&g=1", "display_name": "Or Yaacov", "link": "https://stackoverflow.com/users/10115847/or-yaacov"}, "is_accepted": false, "score": 0, "last_activity_date": 1561800495, "last_edit_date": 1561800495, "creation_date": 1561796169, "answer_id": 56816075, "question_id": 56815932, "link": "https://stackoverflow.com/questions/56815932/how-to-get-data-association-many-to-many/56816075#56816075", "title": "How to get data association many to many", "body": "<p>use the related method: </p>\n\n<pre><code>db.Model(&amp;dm.User{}).Related(&amp;dm.EventReview{}, \"user_id\")\nres:=QueryByStructExample(dm.User{Email: \"email@example.com})\n\n\n\n func QueryByStructExample(userStruct User) []User {\n        var results []dm.User\n        GormDB.Where(userStruct).Find(&amp;results)\n        return results\n    }\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1561800495, "creation_date": 1561794453, "last_edit_date": 1561795936, "question_id": 56815932, "link": "https://stackoverflow.com/questions/56815932/how-to-get-data-association-many-to-many", "title": "How to get data association many to many", "body": "<p>I'm new in Go gorm association. I have code like that: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    _ \"database/sql\"\n    \"fmt\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n    \"github.com/jinzhu/gorm\"\n)\n\ntype User struct {\n    ID   uint `gorm:\"primary_key\"`\n    Name string\n}\n\ntype Event struct {\n    ID        uint `gorm:\"primary_key\"`\n    EventName string\n    Users     []User `gorm:\"many2many:event_reviews;\"`\n}\n\ntype EventReview struct {\n    UserID  uint\n    EventID uint\n    Rating  float64\n    Review  string\n}\n\nfunc main() {\n    db, _ := gorm.Open(\"mysql\", \"root:@tcp(127.0.0.1:3306)/test1?charset=utf8&amp;parseTime=True\")\n    defer db.Close()\n    db.DropTableIfExists(&amp;EventReview{}, &amp;Event{}, &amp;User{})\n    db.AutoMigrate(&amp;User{}, &amp;Event{}, &amp;EventReview{})\n\n    //All foreign keys need to define here\n    db.Model(EventReview{}).AddForeignKey(\"user_id\", \"users(id)\", \"CASCADE\", \"CASCADE\")\n    db.Model(EventReview{}).AddForeignKey(\"event_id\", \"events(id)\", \"CASCADE\", \"CASCADE\")\n\n    user := User{Name: \"John\"}\n    db.Create(&amp;user)\n    event := Event{EventName: \"Learning Go\"}\n    db.Create(&amp;event)\n    eventReview := EventReview{UserID: user.ID, EventID: event.ID, Rating: 2.5, Review: \"ExcelentEvent\"}\n    db.Create(&amp;eventReview)\n\n    //Fetching\n    eventFetch := &amp;Event{}\n    db.Preload(\"Users\").First(&amp;eventFetch)\n    fmt.Println(eventFetch)\n}\n\n</code></pre>\n\n<p>I have struct User, Event, Event Review. Event has relationship many to many with user. i have read gorm docs associaton <a href=\"http://gorm.io/docs/many_to_many.html\" rel=\"nofollow noreferrer\">Gorm associaton many to many</a> but i confuse to get data from event review. </p>\n\n<p>Result Println:</p>\n\n<pre><code>&amp;{1 Learning Go [{1 John}]}\n</code></pre>\n\n<p>Result Expected:</p>\n\n<pre><code>&amp;{1 Learning Go [{1 John 2.5 ExcelentEvent}]}\n</code></pre>\n\n<p>How to get result like result expected? Am i wrong with using many to many relationship table?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1561791947, "post_id": 56815597, "comment_id": 100185000, "body": "I have tested the program locally and it works great. I have used the gorilla/mux as a mux. which mux did you use?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1561793463, "post_id": 56815597, "comment_id": 100185223, "body": "Start by using proper struct tags. (no newlines!)."}, {"owner": {"reputation": 1, "user_id": 11030186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-lodymU9MY/AAAAAAAAAAI/AAAAAAAABfc/gy3HVUhQdXY/photo.jpg?sz=128", "display_name": "ravi sankar", "link": "https://stackoverflow.com/users/11030186/ravi-sankar"}, "reply_to_user": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1561794227, "post_id": 56815597, "comment_id": 100185333, "body": "@ParhamAlvani same &quot;github.com/gorilla/mux&quot;"}, {"owner": {"reputation": 1, "user_id": 11030186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-lodymU9MY/AAAAAAAAAAI/AAAAAAAABfc/gy3HVUhQdXY/photo.jpg?sz=128", "display_name": "ravi sankar", "link": "https://stackoverflow.com/users/11030186/ravi-sankar"}, "reply_to_user": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1561794448, "post_id": 56815597, "comment_id": 100185368, "body": "@ParhamAlvani the program works fine for this &quot;localhost:8080/api/books&quot;, which displays all books that I have stored, but when I pass a parameter(id) &quot;localhost:8080/api/books/1&quot; it doesn&#39;t show up anything."}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1561795479, "post_id": 56815597, "comment_id": 100185507, "body": "@ravisankar I have check the <code>getBook</code> API and its work fine for me. I will post the code I have run here."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11030186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-lodymU9MY/AAAAAAAAAAI/AAAAAAAABfc/gy3HVUhQdXY/photo.jpg?sz=128", "display_name": "ravi sankar", "link": "https://stackoverflow.com/users/11030186/ravi-sankar"}, "edited": false, "score": 0, "creation_date": 1561814520, "post_id": 56816078, "comment_id": 100188972, "body": "thanks for your help your code works great, may I know what was the problem with my code and why it didn&#39;t work for me in my browser."}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "reply_to_user": {"reputation": 1, "user_id": 11030186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-lodymU9MY/AAAAAAAAAAI/AAAAAAAABfc/gy3HVUhQdXY/photo.jpg?sz=128", "display_name": "ravi sankar", "link": "https://stackoverflow.com/users/11030186/ravi-sankar"}, "edited": false, "score": 0, "creation_date": 1561816524, "post_id": 56816078, "comment_id": 100189394, "body": "@ravisankar I think it didn&#39;t work because of <code>WriteHeader</code> and using new lines in JSON tags."}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "reply_to_user": {"reputation": 1, "user_id": 11030186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-lodymU9MY/AAAAAAAAAAI/AAAAAAAABfc/gy3HVUhQdXY/photo.jpg?sz=128", "display_name": "ravi sankar", "link": "https://stackoverflow.com/users/11030186/ravi-sankar"}, "edited": false, "score": 0, "creation_date": 1561816574, "post_id": 56816078, "comment_id": 100189407, "body": "@ravisankar If it has solved your problem please mark it as an answer."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1561839560, "post_id": 56816078, "comment_id": 100194162, "body": "You cannot write the header after the body because the header comes first. <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow noreferrer\">The WriteHeader calls do absolutely nothing</a>."}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1561839830, "post_id": 56816078, "comment_id": 100194214, "body": "@Peter you are right. It is my mistake. I have corrected it."}], "tags": [], "owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "is_accepted": false, "score": 0, "last_activity_date": 1561839881, "last_edit_date": 1561839881, "creation_date": 1561796213, "answer_id": 56816078, "question_id": 56815597, "link": "https://stackoverflow.com/questions/56815597/how-to-retrieve-particular-data-from-json-using-attributes-that-are-available/56816078#56816078", "title": "How to retrieve particular data from json using attributes that are available", "body": "<p>I just format the code as below and it works fine (pay attention to <code>WriteHeader</code> function).</p>\n\n<pre><code>package main\n\nimport (\n        \"encoding/json\"\n        \"fmt\"\n        \"log\"\n        \"net/http\"\n\n        \"github.com/gorilla/mux\"\n)\n\ntype Book struct {\n        ID     string  `json:\"id\"`\n        Isbn   string  `json:\"isbn\"`\n        Title  string  `json:\"title\"`\n        Author *Author `json:\"author\"`\n}\n\n//Author struct\ntype Author struct {\n        Firstname string `json:\"firstname\"`\n        Lastname  string `json:\"lastname\"`\n}\n\n//variables\n\n//slice-&gt; variable link to array\nvar books []Book\n\n// Get single book\nfunc getBook(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        params := mux.Vars(r) // Gets params\n        // Loop through books and find one with the id from the params\n        for _, item := range books {\n                if item.ID == params[\"id\"] {\n                        w.WriteHeader(http.StatusOK)\n                        json.NewEncoder(w).Encode(item)\n                        return\n                }\n        }\n        w.WriteHeader(http.StatusNotFound)\n        json.NewEncoder(w).Encode(&amp;Book{})\n}\n\nfunc main() {\n        fmt.Println(\"Listening on :8080\")\n\n        // initialize mux router\n        r := mux.NewRouter()\n\n        // mock data\n        books = append(books, Book{ID: \"1\", Isbn: \"32123\", Title: \"Book one\", Author: &amp;Author{Firstname: \"J.K.\", Lastname: \"Rowling\"}})\n        books = append(books, Book{ID: \"2\", Isbn: \"45434\", Title: \"Book two\", Author: &amp;Author{Firstname: \"P.K.\", Lastname: \"Rowling\"}})\n\n        // router handler\n        r.HandleFunc(\"/api/books/{id}\", getBook).Methods(\"GET\")\n\n        log.Fatal(http.ListenAndServe(\":8080\", r))\n}\n</code></pre>\n\n<p>After running the above program. The following command on the console:</p>\n\n<pre><code>curl 127.0.0.1:8080/api/books/1\n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>{\"id\":\"1\",\"isbn\":\"32123\",\"title\":\"Book one\",\"author\":{\"firstname\":\"J.K.\",\"lastname\":\"Rowling\"}}\n</code></pre>\n\n<p>Finally, as a recommendation for implementing the ReST API with Golang, you can check <a href=\"https://github.com/xesina/golang-echo-realworld-example-app\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11030186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-lodymU9MY/AAAAAAAAAAI/AAAAAAAABfc/gy3HVUhQdXY/photo.jpg?sz=128", "display_name": "ravi sankar", "link": "https://stackoverflow.com/users/11030186/ravi-sankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1561839881, "creation_date": 1561790342, "last_edit_date": 1561796901, "question_id": 56815597, "link": "https://stackoverflow.com/questions/56815597/how-to-retrieve-particular-data-from-json-using-attributes-that-are-available", "title": "How to retrieve particular data from json using attributes that are available", "body": "<p>I was asked to do a simple RESTful service using Go, that has to retrieve all the data about a particular book using its ID value.</p>\n\n<pre><code>type Book struct {\n    ID     string  `json:\"id\"`\n    Isbn   string  `json:\"isbn\"`\n    Title  string  `json:\"title\"`\n    Author *Author `json:\"author\"`\n}\n\n//Author struct\ntype Author struct{\n    Firstname string `json:\"firstname\"`\n    Lastname  string `json:\"lastname\"`\n}\n\n//variables\n\n//slice-&gt; variable link to array\nvar books []Book\n\n\n\n// Get single book\nfunc getBook(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    params := mux.Vars(r) // Gets params\n    // Loop through books and find one with the id from the params\n    for _, item := range books {\n        if item.ID == params[\"id\"] {\n            json.NewEncoder(w).Encode(item)\n            return\n        }\n    }\n    json.NewEncoder(w).Encode(&amp;Book{})\n}\n\nfunc main() {\n    // r := mux.NewRouter()\n    fmt.Println(\"hello api\")\n    //initialize mux router\n    r := mux.NewRouter()\n    //mock data\n    books=append(books,Book{ID:\"1\",Isbn:\"32123\",Title:\"Book   one\",Author:&amp;Author{Firstname:\"J.K.\", Lastname:\"Rowling\"}})\n    books=append(books,Book{ID:\"2\",Isbn:\"45434\",Title:\"Book two\", Author:&amp;Author{Firstname:\"P.K.\",Lastname:\"Rowling\"}})\n\n    //router handler\n    r.HandleFunc(\"/api/books\",getBooks).Methods(\"GET\")\n    r.HandleFunc(\"/api/books/{id}\",getBook).Methods(\"GET\")\n    r.HandleFunc(\"/api/books\",createBook).Methods(\"POST\")\n    r.HandleFunc(\"/api/books/{id}\",updateBook).Methods(\"PUT\")\n    r.HandleFunc(\"/api/books/{id}\",deleteBook).Methods(\"DELETE\")\n\n    log.Fatal(http.ListenAndServe(\":8080\",r))    \n}\n</code></pre>\n\n<p>expected output\nif i enter -> <a href=\"http://localhost:8080/api/books/1\" rel=\"nofollow noreferrer\">http://localhost:8080/api/books/1</a>\nthis has to return me</p>\n\n<pre><code>{\n    \"id\": \"1\",\n    \"isbn\": \"32123\",\n    \"title\": \"Book one\",\n    \"author\": {\n        \"firstname\": \"J.K.\",\n        \"lastname\": \"Rowling\"\n    }\n}\n</code></pre>\n\n<p>instead, I'm getting nothing in my browser</p>\n"}, {"tags": ["multithreading", "loops", "go", "optimization", "goroutine"], "comments": [{"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1561792313, "post_id": 56815363, "comment_id": 100185052, "body": "I think you can create and use another wait group in <code>printKeys</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1561797772, "post_id": 56815363, "comment_id": 100185902, "body": "Please format your code using gofmt. It&#39;s impossible to read right now."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1561893507, "post_id": 56815363, "comment_id": 100201322, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 2, "last_activity_date": 1561805761, "last_edit_date": 1561805761, "creation_date": 1561804738, "answer_id": 56816853, "question_id": 56815363, "link": "https://stackoverflow.com/questions/56815363/proper-way-to-optimize-multi-threading-with-waitgroups-and-goroutines/56816853#56816853", "title": "Proper way to optimize multi-threading with WaitGroups and goroutines?", "body": "<p>I would not use a global <code>sync.WaitGroup</code>, it is hard to understand what is happening. Instead, just define it wherever you need.</p>\n\n<p>You are calling <code>wg.Wait()</code> inside the loop block. That is basically blocking the loop every iteration waiting for goroutine to complete. What you really want is to spawn all the goroutines and only then wait for their completition.</p>\n\n<pre><code>if ok {\n    cmd := exec.Command(\"clear\")\n    cmd.Stdout = os.Stdout\n    cmd.Run()\n    var wg sync.WaitGroup //I am about to spawn goroutines, I need to wait for them\n    for i.Cmp(bignum) &lt; 0 {\n        wg.Add(1)\n        go func(i *big.Int) {\n            defer wg.Done()\n            go printKeys(i.String(), kpp)\n            i.Add(i, big.NewInt(1))\n            pages_queried += 1\n            infofunc(i)\n        }(i)\n    }\n    wg.Wait() //Now that all goroutines are working, let's wait\n}\n</code></pre>\n\n<p>You cannot avoid the print overlap when you have multiple goroutines. If that's a problem you might think of using the Go's <a href=\"https://golang.org/pkg/log/\" rel=\"nofollow noreferrer\">log</a> stdlib, which will add timestamps for you. Then, you should be able to sort them in chronological order. </p>\n\n<p>Anyway, split the code in more goroutines does not ensure a speed up. If the problem you are trying to solve is intrinsically sequential, then more goroutines will just add more contention and pressure on Go scheduler, leading to the opposite result. <a href=\"https://blog.golang.org/concurrency-is-not-parallelism\" rel=\"nofollow noreferrer\">More details here.</a> Thus, a goroutine for <code>infofunc</code> will not help. But it can be improved by using a logger library instead of plain <code>fmt</code> package.  </p>\n\n<pre><code>func infofunc(i *big.Int) {\n    duration := time.Since(start_time).Seconds()\n    if duration != 0 {\n        log.Printf(\"\\033[5;0H\")\n        log.Printf(\"Started at %s. Found: %d. Elapsed: %s. Queried: %d pages. Current page: %s. Rate: %d/s\", start_time.String(), found, elapsed.String(), pages_queried, i.String(), (pages_queried / duration2))\n    }\n}\n</code></pre>\n\n<p>For <code>printKeys</code>, I would not create so many goroutines, they are not going to help if work they need to perform is CPU bound, which seems to be the case here.</p>\n\n<pre><code>func printKeys(pageNumber string, keysPerPage int) {\n    keys := generateKeys(pageNumber, keysPerPage)\n    length := len(keys)\n    var addressesLen = len(addresses)\n    var wg sync.WaitGroup //Local WaitGroup\n    for i := 0; i &lt; length; i++ {\n        wg.Add(1)\n        go func(i int) {  //This goroutine could be removed, in my opinion.\n            defer wg.Done()\n            for ii := 0; ii &lt; addressesLen; ii++ {\n                for _, v := range addresses {\n                    if set[keys[i].compressed] || set[keys[i].uncompressed] {\n                        log.Printf(\"Found an address: %v\\n\", v)\n                        log.Printf(\"%v\", keys[i])\n                        log.Printf(\"\\n\")\n                        foundAddresses += 1\n                        found += 1\n                    }\n                }\n            }\n        }(i)\n        foundAddresses = 0\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>I would suggest to write a benchmark on these functions and then enable tracing. In this way you should get an idea where your code is spending most of the time.</p>\n"}], "owner": {"reputation": 145, "user_id": 9189132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mWeAp.png?s=128&g=1", "display_name": "Autumn Rowan", "link": "https://stackoverflow.com/users/9189132/autumn-rowan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561818270, "creation_date": 1561787350, "last_edit_date": 1561818270, "question_id": 56815363, "link": "https://stackoverflow.com/questions/56815363/proper-way-to-optimize-multi-threading-with-waitgroups-and-goroutines", "title": "Proper way to optimize multi-threading with WaitGroups and goroutines?", "body": "<p>I am trying to make my application run as fast as possible. I purchased a semi-powerful container off of Google Cloud and I am just itching to see how many iterations per second I can get out of this program. However, I am new to Go and so far my implementation is showing to be very messy and not working well.</p>\n\n<p>The way I have it set up now, it will start out at a high rate (around 11,000 iterations per second) but then quickly dwindle down to 2,000. My goal is for a far bigger number than even 11,000. Also, the <code>infofunc(i)</code> function can't seem to keep up with fast speeds and using a goroutine for that function causes overlap of the printing to the console. Also, it will on occasion reuse the WaitGroup before the Wait has returned.</p>\n\n<p>I don't like to be the person to ask to be spoon-fed code, but I am at a loss as to how to implement this. There seems to be so many different methods when it comes to parallelism, multithreading, etc. and it is confusing to me.</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"math/big\"\n    \"os\"\n    \"os/exec\"\n    \"sync\"\n    \"time\"\n)\n\nvar found = 0\nvar pages_queried = 0\nvar start_time = time.Now()\nvar bignum = new(big.Int)\nvar foundAddresses = 0\nvar wg sync.WaitGroup\nvar set = make(map[string]bool)\nvar addresses = []string{\"6ab42gyr\", \"lo08n4g6\"}\n\nfunc main() {\n    bignum.SetString(\"1000000000000000000000000000\", 10)\n    pick := os.Args[1]\n    kpp := 128\n    switch pick {\n    case \"btc\":\n        i := new(big.Int)\n        i, ok := i.SetString(os.Args[2], 10)\n        if ok {\n            cmd := exec.Command(\"clear\")\n            cmd.Stdout = os.Stdout\n            cmd.Run()\n            for i.Cmp(bignum) &lt; 0 {\n                wg.Add(1)\n                go func(i *big.Int) {\n                    defer wg.Done()\n                    go printKeys(i.String(), kpp)\n                    i.Add(i, big.NewInt(1))\n                    pages_queried += 1\n                    infofunc(i)\n                }(i)\n                wg.Wait()\n            }\n        }\n    }\n}\n\nfunc infofunc(i *big.Int) {\n    elapsed := time.Now().Sub(start_time)\n    duration, _ := time.ParseDuration(elapsed.String())\n    duration2 := int(duration.Seconds())\n    if duration2 != 0 {\n        fmt.Printf(\"\\033[5;0H\")\n        fmt.Printf(\"Started at %s. Found: %d. Elapsed: %s. Queried: %d pages. Current page: %s. Rate: %d/s\", start_time.String(), found, elapsed.String(), pages_queried, i.String(), (pages_queried / duration2))\n    }\n}\n\nfunc printKeys(pageNumber string, keysPerPage int) {\n    keys := generateKeys(pageNumber, keysPerPage)\n    length := len(keys)\n    var addressesLen = len(addresses)\n\n    for i := 0; i &lt; length; i++ {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            for ii := 0; ii &lt; addressesLen; ii++ {\n                wg.Add(1)\n                go func(i int, ii int, keys []key) {\n                    defer wg.Done()\n                    for _, v := range addresses {\n                        if set[keys[i].compressed] || set[keys[i].uncompressed] {\n                            fmt.Print(\"Found an address: \" + v + \"!\\n\")\n                            fmt.Printf(\"%v\", keys[i])\n                            fmt.Print(\"\\n\")\n                            foundAddresses += 1\n                            found += 1\n                        }\n                    }\n                }(i, ii, keys)\n            }\n        }(i)\n        foundAddresses = 0\n    }\n}\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "go"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1561782953, "post_id": 56815087, "comment_id": 100183920, "body": "Check also, as in <a href=\"https://github.com/tediousjs/tedious/issues/869#issuecomment-467982487\" rel=\"nofollow noreferrer\">github.com/tediousjs/tedious/issues/869#issuecomment-4679824&zwnj;&#8203;87</a>, if the decimal precision can be an issue."}, {"owner": {"reputation": 318, "user_id": 2507262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e60b9190b4c90084a737a7b3c4b4a4?s=128&d=identicon&r=PG", "display_name": "ozfive", "link": "https://stackoverflow.com/users/2507262/ozfive"}, "edited": false, "score": 0, "creation_date": 1561785563, "post_id": 56815087, "comment_id": 100184153, "body": "I will try this now! Standby!"}, {"owner": {"reputation": 318, "user_id": 2507262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e60b9190b4c90084a737a7b3c4b4a4?s=128&d=identicon&r=PG", "display_name": "ozfive", "link": "https://stackoverflow.com/users/2507262/ozfive"}, "edited": false, "score": 0, "creation_date": 1561791717, "post_id": 56815087, "comment_id": 100184964, "body": "I tried what you said to do and there was no change. I also included the errorx library and edited my question to include the stack trace. It doesn&#39;t like the rows next statement and seems to return nil? Or am I making the reference wrong to TotalTax Parameter?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1561782876, "creation_date": 1561782876, "answer_id": 56815087, "question_id": 56814502, "link": "https://stackoverflow.com/questions/56814502/how-to-fix-error-mssql-error-converting-data-type-decimal-to-nvarchar-in-go-us/56815087#56815087", "title": "How to fix error mssql: Error converting data type decimal to nvarchar. in Go using go-mssqldb", "body": "<p>Check if this is an order issue.</p>\n\n<p>Meaning: try and call <code>db.QueryContext(ctx,</code> with <code>sql.Named()</code> parameters listed in the same order as your sql stored procedure parameters are defined.</p>\n"}], "owner": {"reputation": 318, "user_id": 2507262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e60b9190b4c90084a737a7b3c4b4a4?s=128&d=identicon&r=PG", "display_name": "ozfive", "link": "https://stackoverflow.com/users/2507262/ozfive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1561828642, "creation_date": 1561771715, "last_edit_date": 1561828642, "question_id": 56814502, "link": "https://stackoverflow.com/questions/56814502/how-to-fix-error-mssql-error-converting-data-type-decimal-to-nvarchar-in-go-us", "title": "How to fix error mssql: Error converting data type decimal to nvarchar. in Go using go-mssqldb", "body": "<p>I am having trouble figuring out why I am not able to execute a stored procedure with the parameters that I have defined while using the go-mssqldb driver. If someone would be so kind as to point out where I have gone wrong in defining the values that I am passing as parameters which results in receiving the error from the microsoft sql server database \"mssql: Error converting data type decimal to nvarchar.\" in Go using go-mssqldb it would be very much appreciated!</p>\n\n<p>I have included the code that I am using and even the parameter definitions in the stored procedure below.</p>\n\n<p>Go code:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"database/sql\"\n    \"flag\"\n    \"fmt\"\n    _ \"github.com/denisenkom/go-mssqldb\"\n    \"github.com/shopspring/decimal\"\n    \"log\"\n)\n\nvar (\n    debug         = flag.Bool(\"debug\", true, \"enable debugging\")\n    userid        = flag.String(\"U\", \"user\", \"the database user\")\n    password      = flag.String(\"P\", \"password\", \"the database password\")\n    server        = flag.String(\"S\", \"address\", \"the database server\")\n    port     *int = flag.Int(\"port\", 1433, \"the database port\")\n    database      = flag.String(\"d\", \"database\", \"the database\")\n    encrypt       = flag.String(\"e\", \"disable\", \"the encryption flag\")\n)\n\nfunc main() {\n\n    flag.Parse()\n\n    if *debug {\n        fmt.Printf(\" port:%d\\n\", *port)\n        fmt.Printf(\" server:%s\\n\", *server)\n        fmt.Printf(\" user:%s\\n\", *userid)\n        fmt.Printf(\" database:%s\\n\", *database)\n    }\n\n    ctx, cancel := context.WithCancel(context.Background())\n    defer cancel()\n\n    connString := fmt.Sprintf(\"server=%s;port=%d;user id=%s;password=%s;database=%s;encrypt=%s;\", *server, *port, *userid, *password, *database, *encrypt)\n    if *debug {\n        fmt.Printf(\" connString:%s\\n\", connString)\n    }\n    db, err := sql.Open(\"sqlserver\", connString)\n    if err != nil {\n        log.Fatal(\"Open connection failed:\", err.Error())\n    }\n\n    defer db.Close()\n\n    // bigint\n    WarehouseID := 1\n\n    // nvarchar(7)\n    TaxCode := \"Vertex\"\n\n    // nvarchar(max)\n    LineItemTotals := \"16.35\"\n\n    // decimal(19,5)\n    TotalTax, _ := decimal.NewFromString(\"00.00\")\n\n    // nvarchar(50)\n    ShipToAddress1 := \"Address1\"\n\n    // nvarchar(50)\n    ShipToAddress2 := \"Address2\"\n\n    // nvarchar(40)\n    ShipToCity := \"Seattle\"\n\n    // nvarchar(5)\n    ShipToState := \"WA\"\n\n    // nvarchar(10)\n    ShipToZip := \"zip\"\n\n    // nchar(3)\n    ISOCountryCode := \"USA\"\n\n    // decimal(19,5)\n    FreightCharge, _ := decimal.NewFromString(\"12.10\")\n\n    // bigInt\n    CustomerID := 456118\n\n    // bigint\n    Timeout := 5000\n\n    rows, err := db.QueryContext(ctx, \"EAPI_CalculateTax\",\n\n        sql.Named(\"WarehouseID\", WarehouseID),\n\n        sql.Named(\"TaxCode\", TaxCode),\n\n        sql.Named(\"LineItemTotals\", LineItemTotals),\n        sql.Named(\"ShipToAddress1\", ShipToAddress1),\n        sql.Named(\"ShipToAddress2\", ShipToAddress2),\n        sql.Named(\"ShipToCity\", ShipToCity),\n        sql.Named(\"ShipToState\", ShipToState),\n        sql.Named(\"ShipToZip\", ShipToZip),\n        sql.Named(\"ISOCountryCode\", ISOCountryCode),\n        sql.Named(\"FreightCharge\", FreightCharge),\n        sql.Named(\"CustomerID\", CustomerID),\n        sql.Named(\"Timeout\", Timeout),\n        sql.Named(\"TotalTax\", sql.Out{Dest: &amp;TotalTax}),\n    )\n\n    if err != nil {\n        log.Fatal(\"Prepare failed: \", err.Error())\n    }\n    defer rows.Close()\n\n    var strrow string\n    for rows.Next() {\n        err = rows.Scan(&amp;strrow)\n    }\n    fmt.Printf(\"TotalTax is %d\", TotalTax)\n}\n</code></pre>\n\n<p>sql stored procedure parameters:</p>\n\n<pre><code>@WarehouseID bigint,\n@TaxCode nvarchar(7),\n@LineItemTotals nvarchar(max),\n@TotalTax decimal(19,5) OUTPUT,\n@ShipToAddress1 nvarchar(50) = '', \n@ShipToAddress2 nvarchar(50) = '', \n@ShipToCity nvarchar(40) = '', \n@ShipToState nvarchar(5) = '', \n@ShipToZip nvarchar(10) = '', \n@ISOCountryCode nchar(3) = 'USA',\n@FreightCharge decimal(19,5) = 0,\n@CustomerID bigInt = 0,\n@Timeout bigint = 0\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I added in the errorx library and recieved a better stack trace. The stack trace is below:</p>\n\n<pre><code>mssql: Error converting data type decimal to nvarchar.\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x0 pc=0x4cd337]\n\ngoroutine 1 [running]:\ndatabase/sql.(*Rows).Next(0x0, 0xc0000468a0)\n        C:/Go/src/database/sql/sql.go:2640 +0x37\nmain.main()\n        C:/Users/chris/go/src/RAPI/main.go:99 +0xc18\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1561773670, "post_id": 56813956, "comment_id": 100183094, "body": "We need data for the benchmark."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1561774058, "post_id": 56813956, "comment_id": 100183120, "body": "Have you tried pre-computing the map key as a single string and storing it as an additional field when the row object is created or modified?"}], "owner": {"reputation": 822, "user_id": 2185740, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f93e2686d04a6aa2387c52bdc0a8f2f8?s=128&d=identicon&r=PG", "display_name": "dhythhsba", "link": "https://stackoverflow.com/users/2185740/dhythhsba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1561763311, "creation_date": 1561763311, "question_id": 56813956, "link": "https://stackoverflow.com/questions/56813956/best-way-to-implement-aggregation-in-go-like-group-by-in-sql", "title": "Best way to implement aggregation in Go (like GROUP BY in SQL)?", "body": "<p>Let's say I have a struct</p>\n\n<pre><code>type row struct {\n    f1, f2, f3 string\n    v int64\n}\n</code></pre>\n\n<p>We can imagine it as a row in a table.</p>\n\n<p>Also, I need to implement a function which does aggregation like this query:</p>\n\n<pre><code>SELECT f1, f2, f3, SUM(v) FROM table GROUP BY f1, f2, f3\n</code></pre>\n\n<p>So, I have to implement function:</p>\n\n<pre><code>type key struct {\n    f1, f2, f3 string\n}\nfunc aggregate(t []row) map[key]int64\n</code></pre>\n\n<p>or if can be</p>\n\n<pre><code>func aggregate(t []row) map[string]row\n</code></pre>\n\n<p>where map key is, for instance, f1+f2+f3</p>\n\n<pre><code>func aggregate(t []row)  []row\n</code></pre>\n\n<p>also works if result will include unique f1, f2, f3 combinations (DISTINCT f1, f2, f3)</p>\n\n<p>I have two variants:</p>\n\n<pre><code>func aggregate1(t []row) map[key]int64 {\n    res := map[key]int64{}\n    for _, r := range t {\n        res[key{r.f1, r.f2, r.f3}] += r.v\n    }\n    return res\n}\nfunc aggregate2(t []row) map[string]*row {\n    res := map[string]*row{}\n    for _, r := range t {\n        var sb strings.Builder\n        sb.WriteString(r.f1)\n        sb.WriteString(\"#\")\n        sb.WriteString(r.f2)\n        sb.WriteString(\"#\")\n        sb.WriteString(r.f3)\n        id := sb.String()\n        t := res[id]\n        if t == nil {\n            t = &amp;row{f1: r.f1, f2: r.f2, f3: r.f3, v: 0}\n            res[id] = t\n        }\n        t.v += r.v\n    }\n    return res\n}\n</code></pre>\n\n<p>The first variant spends too much time in <a href=\"https://golang.org/pkg/runtime/?m=all#mapassign\" rel=\"nofollow noreferrer\">https://golang.org/pkg/runtime/?m=all#mapassign</a> (runtime.mapassign)</p>\n\n<p>The idea of the second variant is to use faster <a href=\"https://golang.org/pkg/runtime/?m=all#mapassign_faststr\" rel=\"nofollow noreferrer\">https://golang.org/pkg/runtime/?m=all#mapassign_faststr</a> (runtime.mapassign_faststr), but strings.Builder.WriteString eliminates all benefits from runtime.mapassign_faststr :(</p>\n\n<p>So, can you suggest more ideas about how to implement this aggregation?</p>\n\n<p>I am thinking about how to efficiently calculate \"id\" in the second variant. It should be unique. My variant is unique because f1, f2 and f3 can't include \"#\" character. </p>\n"}, {"tags": ["go", "goroutine", "cloudfiles", "rackspace-cloudfiles"], "comments": [{"owner": {"reputation": 836, "user_id": 2971839, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae42092534f65bffafcc85cc02e7d35b?s=128&d=identicon&r=PG&f=1", "display_name": "Keozon", "link": "https://stackoverflow.com/users/2971839/keozon"}, "edited": false, "score": 2, "creation_date": 1561757223, "post_id": 56813189, "comment_id": 100180865, "body": "I would recommend reducing the problem to an example that is complete, and doesn&#39;t rely on foreign APIs. This will possibly answer your question for you, as you work to replicate the problem with something simpler, but also, it will make your question general, and more applicable to future users who aren&#39;t using this exact library, in this exact way. It will also attract more attention if its shorter. See this <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a> for more information."}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 0, "last_activity_date": 1561758859, "creation_date": 1561758859, "answer_id": 56813510, "question_id": 56813189, "link": "https://stackoverflow.com/questions/56813189/how-to-make-goroutines-work-with-anonymous-functions-returning-value-in-a-loop/56813510#56813510", "title": "How to make goroutines work with anonymous functions returning value in a loop", "body": "<pre><code>for _, c := range &lt;-objListChan {\n    fmt.Println(urlPrefix, c, \"\\t\", count)\n}\n</code></pre>\n\n<p>Your async worker pops one list from the channel, iterates it and exits. You need to have two loops: one reading the channel (<code>range objListChan</code>), the other - reading the (just retrieved) object list.</p>\n"}], "owner": {"reputation": 169, "user_id": 1213542, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OMRch.jpg?s=128&g=1", "display_name": "Mudasir Mirza", "link": "https://stackoverflow.com/users/1213542/mudasir-mirza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56813510, "answer_count": 1, "score": -1, "last_activity_date": 1561758859, "creation_date": 1561755967, "question_id": 56813189, "link": "https://stackoverflow.com/questions/56813189/how-to-make-goroutines-work-with-anonymous-functions-returning-value-in-a-loop", "title": "How to make goroutines work with anonymous functions returning value in a loop", "body": "<p>I am working on a custom script to fetch data from RackSpace cloudfiles container and make a list of all the files in a given container (container has around 100 million files) and I have been working on parallelizing the code and currently stuck.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\n// function to read data from channel and display\n// currently just displaying, but there will be allot of processing done on this data\nfunc extractObjectItemsFromList(objListChan &lt;-chan []string) {\n    fmt.Println(\"ExtractObjectItemsFromList\")\n    for _, c := range &lt;-objListChan {\n        fmt.Println(urlPrefix, c, \"\\t\", count)\n    }\n}\n\n\nfunc main()\n\n// fetching data using flags\nao := gophercloud.AuthOptions{\n    Username: *userName,\n    APIKey:   *apiKey,\n}\n\nprovider, err := rackspace.AuthenticatedClient(ao)\nclient, err := rackspace.NewObjectStorageV1(provider,gophercloud.EndpointOpts{\n    Region: *region,\n})\nif err != nil {\n    logFatal(err)\n}\n\n// We have the option of filtering objects by their attributes\nopts := &amp;objects.ListOpts{\n    Full:   true,\n    Prefix: *prefix,\n}\n\nvar objectListChan = make(chan []string)\ngo extractObjectItemsFromList(objectListChan)\n\n// Retrieve a pager (i.e. a paginated collection)\npager := objects.List(client, *containerName, opts)\n\n\n// Not working\n// By default EachPage contains 10000 records\n// Define an anonymous function to be executed on each page's iteration\nlerr := pager.EachPage(func(page pagination.Page) (bool, error) {       // Get a slice of objects.Object structs\n    objectList, err := objects.ExtractNames(page)\n    if err != nil {\n        logFatal(err)\n    }\n    for _, o := range objectList {\n        _ = o\n    }\n    objectListChan &lt;- objectList\n    return true, nil\n})\nif lerr != nil {\n    logFatal(lerr)\n}\n//---------------------------------------------------\n//       below code is working\n//---------------------------------------------------\n\n// working, but only works inside the loop, this keeps on fetching new pages and showing new records, 10000 per page\n// By default EachPage contains 10000 records\n// Define an anonymous function to be executed on each page's iteration\nlerr := pager.EachPage(func(page pagination.Page) (bool, error) {       // Get a slice of objects.Object structs\n    objectList, err := objects.ExtractNames(page)\n    if err != nil {\n        logFatal(err)\n    }\n    for _, o := range objectList {\n        fmt.Println(o)\n    }\n    return true, nil\n})\nif lerr != nil {\n    logFatal(lerr)\n}\n\n</code></pre>\n\n<p>The first 10000 records are displayed but then it stuck and nothing happens. If I do not use channel and just run the plain loop it works perfectly fine, which kills the purpose of parallelizing.</p>\n"}, {"tags": ["json", "go", "swagger"], "comments": [{"owner": {"reputation": 86, "user_id": 5715068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o9dzJNgSvKE/AAAAAAAAAAI/AAAAAAAAAQ0/14GkM4SsL8M/photo.jpg?sz=128", "display_name": "Bogdan Daragan", "link": "https://stackoverflow.com/users/5715068/bogdan-daragan"}, "edited": false, "score": 0, "creation_date": 1561800498, "post_id": 56812312, "comment_id": 100186358, "body": "I haven&#39;t worked with that lib. But my suggestion is using <code>-</code> in json tag: <code>ID int64 `json:&quot;-&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 11405059, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ka68I6fwFBI/AAAAAAAAAAI/AAAAAAAAAAc/-GwLYLXFCCI/photo.jpg?sz=128", "display_name": "Marcelo Gon&#231;alves", "link": "https://stackoverflow.com/users/11405059/marcelo-gon%c3%a7alves"}, "reply_to_user": {"reputation": 86, "user_id": 5715068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o9dzJNgSvKE/AAAAAAAAAAI/AAAAAAAAAQ0/14GkM4SsL8M/photo.jpg?sz=128", "display_name": "Bogdan Daragan", "link": "https://stackoverflow.com/users/5715068/bogdan-daragan"}, "edited": false, "score": 0, "creation_date": 1561980114, "post_id": 56812312, "comment_id": 100221655, "body": "@BogdanDaragan I can&#39;t use it because the other route (get all calcs). But if you know some way to change this tag before use the struct it can be helpful I think. Thanks"}, {"owner": {"reputation": 309, "user_id": 6553708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce70b67461bfe55b67505cbeb2786e6d?s=128&d=identicon&r=PG&f=1", "display_name": "SANDEEP MACHIRAJU", "link": "https://stackoverflow.com/users/6553708/sandeep-machiraju"}, "edited": false, "score": 0, "creation_date": 1605223692, "post_id": 56812312, "comment_id": 114593402, "body": "Is there any solution for this? Did you find any? @MarceloGon&#231;alves"}, {"owner": {"reputation": 13, "user_id": 11405059, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ka68I6fwFBI/AAAAAAAAAAI/AAAAAAAAAAc/-GwLYLXFCCI/photo.jpg?sz=128", "display_name": "Marcelo Gon&#231;alves", "link": "https://stackoverflow.com/users/11405059/marcelo-gon%c3%a7alves"}, "reply_to_user": {"reputation": 309, "user_id": 6553708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce70b67461bfe55b67505cbeb2786e6d?s=128&d=identicon&r=PG&f=1", "display_name": "SANDEEP MACHIRAJU", "link": "https://stackoverflow.com/users/6553708/sandeep-machiraju"}, "edited": false, "score": 1, "creation_date": 1605526043, "post_id": 56812312, "comment_id": 114667831, "body": "@SANDEEPMACHIRAJU I have used two different structs on the routes. But another solution (not so efficient) is use comments: if you comment into the struct, it&#39;ll be in model specification on swag"}], "answers": [{"tags": [], "owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "is_accepted": true, "score": 0, "last_activity_date": 1609478688, "creation_date": 1609478688, "answer_id": 65527439, "question_id": 56812312, "link": "https://stackoverflow.com/questions/56812312/how-can-i-omit-some-fields-on-swaggo-documentation/65527439#65527439", "title": "How can I omit some fields on swaggo documentation", "body": "<pre><code>type calc struct {\n   ID int64 `json:&quot;id&quot; swaggerignore:&quot;true&quot;`\n   Value1 int64 `json:&quot;value1&quot; `\n   Value2 int64 `json:&quot;value2&quot;`\n   Result int64 `json:&quot;result&quot; swaggerignore:&quot;true&quot;`\n}\n</code></pre>\n<p>will omit these fields from your swagger documentation</p>\n"}], "owner": {"reputation": 13, "user_id": 11405059, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ka68I6fwFBI/AAAAAAAAAAI/AAAAAAAAAAc/-GwLYLXFCCI/photo.jpg?sz=128", "display_name": "Marcelo Gon&#231;alves", "link": "https://stackoverflow.com/users/11405059/marcelo-gon%c3%a7alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 65527439, "answer_count": 1, "score": 1, "last_activity_date": 1609478688, "creation_date": 1561750192, "last_edit_date": 1561980319, "question_id": 56812312, "link": "https://stackoverflow.com/questions/56812312/how-can-i-omit-some-fields-on-swaggo-documentation", "title": "How can I omit some fields on swaggo documentation", "body": "<p>I'm doing a golang API and need to documentate it. So I'm using swaggo</p>\n\n<p>This a example struct like mine's:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type calc struct {\n   ID int64 `json:\"id\"`\n   Value1 int64 `json:\"value1\"`\n   Value2 int64 `json:\"value2\"`\n   Result int64 `json:\"result\"`\n}\n</code></pre>\n\n<p>Pretend I have two routes:</p>\n\n<ul>\n<li>Get all calcs (a list)</li>\n<li>Do a calc</li>\n</ul>\n\n<p>Whem doing the docs I specify that the 'Do a calc' route get a json object like calc.</p>\n\n<p><strong>The problem is</strong>: I'm using this struct to 'read' and 'write', so whem I documentate in the 'Do a calc' route, it means that I need a 'json calc obejct', but <strong>I don't know how to omit the ID and RESULT fields</strong> from the specification (I don't need use this fields on this route, of course).</p>\n"}, {"tags": ["go", "cookies", "server", "safari", "localhost"], "comments": [{"owner": {"reputation": 187, "user_id": 10484525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5777df4baf6f1c458b98e853c327236d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/10484525/abhinav"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1561791734, "post_id": 56812095, "comment_id": 100184970, "body": "@CeriseLim&#243;n this didn&#39;t work. What other information do you need?"}, {"owner": {"reputation": 187, "user_id": 10484525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5777df4baf6f1c458b98e853c327236d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/10484525/abhinav"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1561815267, "post_id": 56812095, "comment_id": 100189129, "body": "@CeriseLim&#243;n the problem is with safari only every other browser is working fine."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 10484525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5777df4baf6f1c458b98e853c327236d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/10484525/abhinav"}, "edited": false, "score": 0, "creation_date": 1561964797, "post_id": 56821524, "comment_id": 100214602, "body": "Thank you @user11718744 your suggestion worked. I transferred the backend code to the same server on which frontend code was running. Thanks again :)"}], "tags": [], "owner": {"reputation": 26, "user_id": 11718744, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b6ff11873aae02c3432bd99dfe998054?s=128&d=identicon&r=PG", "display_name": "user11718744", "link": "https://stackoverflow.com/users/11718744/user11718744"}, "is_accepted": true, "score": 1, "last_activity_date": 1561851616, "creation_date": 1561851616, "answer_id": 56821524, "question_id": 56812095, "link": "https://stackoverflow.com/questions/56812095/set-cookie-working-in-safari-with-localhost-but-not-with-server/56821524#56821524", "title": "Set-Cookie working in Safari with localhost but not with server", "body": "<p>Unlike other browsers, Safari does not set cookies on cross domain requests from XHR or fetch.  Serve the front end and back end from the same hOst.</p>\n"}], "owner": {"reputation": 187, "user_id": 10484525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5777df4baf6f1c458b98e853c327236d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/10484525/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 1, "accepted_answer_id": 56821524, "answer_count": 1, "score": -1, "last_activity_date": 1561851616, "creation_date": 1561748831, "last_edit_date": 1561815352, "question_id": 56812095, "link": "https://stackoverflow.com/questions/56812095/set-cookie-working-in-safari-with-localhost-but-not-with-server", "title": "Set-Cookie working in Safari with localhost but not with server", "body": "<p>I am using React.js in the frontend and Golang API in the backend. Earlier when I tested with localhost development environment Set-Cookie was working fine with Safari but when I deployed my apps (frontend and backend running separately) on the servers for testing, the Set-Cookie is not working only with Safari. SSL certificates are not installed and I am just using the IP address for accessing the website and API. When I checked the console I saw that cookie is being issued successfully and received by Safari but it is not storing it.</p>\n\n<p>Below is cookie configuration</p>\n\n<pre><code>jwtCookie := &amp;http.Cookie{\n    Name:     \"jwtToken\",\n    Secure:   false,\n    HttpOnly: true,\n    Value:    tokenString,\n    Expires:  expiryTime,\n}\n</code></pre>\n\n<p>The problem is with Safari only.</p>\n"}, {"tags": ["go", "cgo"], "owner": {"reputation": 128, "user_id": 3314573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmOgC.jpg?s=128&g=1", "display_name": "Damian S.", "link": "https://stackoverflow.com/users/3314573/damian-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561748185, "creation_date": 1561748185, "question_id": 56811977, "link": "https://stackoverflow.com/questions/56811977/how-can-i-share-c-code-between-go-packages", "title": "How can I share c code between go packages?", "body": "<p>how to share C code between packages? When I'm trying to include header file from another package I get:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n  \"_module2_c_func\", referenced from:\n      __cgo_b9b83c92221d_Cfunc_module2_c_func in _x002.o\n     (maybe you meant: __cgo_b9b83c92221d_Cfunc_module2_c_func)\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>My code:</p>\n\n<p>main.go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\nimport (\n    \"cgo_sample/module1\"\n    \"cgo_sample/module2\"\n)\nfunc main() {\n    module1.Module1_invoke_c_func()\n    module2.Module2_invoke_c_func()\n}\n</code></pre>\n\n<p>module1/module1.go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package module1\n/*\n    #include \"../module2/module2.h\"\n */\nimport \"C\"\nfunc Module1_invoke_c_func() int {\n    return int(C.module2_c_func())\n}\n</code></pre>\n\n<p>module2/module2.go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package module2\n/*\n  #cgo CFLAGS: -g -Wall\n  #include \"module2.h\"\n*/\nimport \"C\"\nfunc Module2_invoke_c_func() int {\n    return int(C.module2_c_func())\n}\n</code></pre>\n\n<p>module2/module2.h:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code> #ifndef _MODULE1_H_\n #define _MODULE1_H_\n   int module2_c_func();\n #endif\n</code></pre>\n\n<p>module2/module2.c:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code> #include \"module2.h\"\nint module2_c_func() {\n    return 12;\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 1, "creation_date": 1561751374, "post_id": 56811922, "comment_id": 100179174, "body": "I would step back a bit and see if this can be better solved using an interface that you provide the concrete class for in the condition statement."}], "answers": [{"tags": [], "owner": {"reputation": 2615, "user_id": 2480468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNCmN.jpg?s=128&g=1", "display_name": "Tim Brown", "link": "https://stackoverflow.com/users/2480468/tim-brown"}, "is_accepted": false, "score": 3, "last_activity_date": 1561748256, "creation_date": 1561748256, "answer_id": 56811987, "question_id": 56811922, "link": "https://stackoverflow.com/questions/56811922/go-package-selector-based-on-condition/56811987#56811987", "title": "Go package selector based on condition", "body": "<p>This isn't quite what you asked, but this is how I would accomplish the goal if I were you:</p>\n\n<pre><code>// I assumed both package functions have the same signature, so you can use a type\n// TODO: Actual function signature you want to use here\ntype myFn func() error\n\nvar fnToUse myFn\nif someCondition {\n    fnToUse = packageA.Func1\n} else {\n    fnToUse = packageB.Func2\n}\n\nfnToUse()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1561752786, "post_id": 56812569, "comment_id": 100179645, "body": "Actually, it usually works the other way around. You have heterogenous libraries, say a database &quot;driver&quot; and you define an interface for db interaction and then implement wrappers utilizing the respective database and implementing said interface."}, {"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1561752938, "post_id": 56812569, "comment_id": 100179708, "body": "Yes, it seemed like OP had exactly matching func signatures, etc here, though, so there seemed to be no need for a wrapper, just have to tie things up a bit? Maybe I misunderstood."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1561753034, "post_id": 56812569, "comment_id": 100179736, "body": "My comment was not meant as a contradiction of your example, just as additional information."}], "tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": false, "score": 0, "last_activity_date": 1561752226, "last_edit_date": 1561752226, "creation_date": 1561751839, "answer_id": 56812569, "question_id": 56811922, "link": "https://stackoverflow.com/questions/56811922/go-package-selector-based-on-condition/56812569#56812569", "title": "Go package selector based on condition", "body": "<p>Following up a bit on comment about using an interface</p>\n\n<blockquote>\n  <p>I would step back a bit and see if this can be better solved using an\n  interface that you provide the concrete class for in the condition\n  statement.</p>\n</blockquote>\n\n<pre><code>package packageA \n\ntype Thing struct {\n\n}\n\nfunc (t Thing) DoSomething() {\n}\n</code></pre>\n\n<p>--   </p>\n\n<pre><code>package packageB\n\ntype Thing struct {\n\n}\n\nfunc (t Thing) DoSomething() {\n}\n</code></pre>\n\n<p>--</p>\n\n<pre><code>package main \n\nimport (\n  \"packageA\"\n  \"packageB\"\n)\n\ntype PackageUser interface {\n  DoSomething()\n}\n\nfunc main() {\n  var pu PackageUser \n  if (condition) {\n    pu := packageA.Thing{}\n  } else {\n    pu := packageB.Thing{}\n  }\n  pu.DoSomething()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 4, "last_activity_date": 1561752338, "last_edit_date": 1561752338, "creation_date": 1561752005, "answer_id": 56812595, "question_id": 56811922, "link": "https://stackoverflow.com/questions/56811922/go-package-selector-based-on-condition/56812595#56812595", "title": "Go package selector based on condition", "body": "<p>It is very much a pattern - aside from the dynamic import. It is called <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">\u201eInterfaces\u201c</a>.</p>\n\n<p>Given an interface definition like</p>\n\n<pre><code>type Stringer interface{\n  String() string\n}\n</code></pre>\n\n<p>and the type Foo implementing said interface</p>\n\n<pre><code>type foo int\nfunc(f foo)String() string{\n  return fmt.Sprintf(\u201d%d\u201d,f)\n}\n</code></pre>\n\n<p>as well as Bar implementing said interface</p>\n\n<pre><code>type bar string\nfunc (b bar) String()string {\n  return string(b)\n}\n</code></pre>\n\n<p>one can actually use both as a parameter for a function baz</p>\n\n<pre><code>func baz(s Stringer){\n  fmt.Println(s.String())\n}\n</code></pre>\n\n<p>Note that unlike other languages, you do not have to declare the interfaces a type implements - as long as a type happens to factually  implement an interface, the go compiler is ok with it. <strong><kbd><a href=\"https://play.golang.org/p/9h1YobFp4dx\" rel=\"nofollow noreferrer\">Run on Playground</a></kbd></strong></p>\n\n<p>So, with regards to your question of package imports: Unless you have ginormous dependency trees to import, it really is not worth the hassle.</p>\n\n<p>Say we talk of an application using either BBolt or etcd and for good measure some MongoDB. The resulting size to include <em>all</em> of them, while relatively speaking is quite astonishing, is negligible. I compiled a go program with imports of bbolt, bbolt &amp; etcd and bbolt, etcd &amp; mongodb. These are the results in bytes.</p>\n\n<pre><code>11734884  size_all \n2455544   size_bolt\n10307700  size_boltetcd\n</code></pre>\n\n<p>We are talking of a few megabytes in file size. So say you use either Bolt <strong>or</strong> etcd <strong>or</strong> MongoDB, do you <em>really</em> want to jump through all the hoops and loops required to get dynamic imports done properly? I for my part would neither want to do it nor would I want Go to provide such a feature.</p>\n\n<blockquote>\n  <p><em>\"Premature optimization is the root of all evil (or at least most of it) in programming.\"</em></p>\n  \n  <p>&ndash; Donald Knuth</p>\n</blockquote>\n"}], "owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1561752338, "creation_date": 1561747883, "question_id": 56811922, "link": "https://stackoverflow.com/questions/56811922/go-package-selector-based-on-condition", "title": "Go package selector based on condition", "body": "<p>We have 2 packages that implement the same function signatures.  In my main I need to switch out the package being used based on a condition:</p>\n\n<pre><code>    import (\npackageA \"deployment/sdk/packageA\"\npackageB \"deployment/sdk/packageB\"\n)\n\nsomeCondition := true\nvar packageToUse ?\n\nif someCondition {\n    packageToUse = packageA\n} else {\n    packageToUse = packageB\n}\n\npackageToUse.DoSomething()\n</code></pre>\n\n<p>Of course, this doesn't compile. I don't know what type to use for packageToUse. This approach is probably an anti-pattern.  I'm just not sure the approach I should be taking. </p>\n\n<p>any suggestions?</p>\n\n<p>The error I get is <code>use of package without selector</code></p>\n"}, {"tags": ["go", "struct", "slice"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1561749827, "post_id": 56811384, "comment_id": 100178667, "body": "<a href=\"https://play.golang.com/p/CCzvpnZSOLQ\" rel=\"nofollow noreferrer\">play.golang.com/p/CCzvpnZSOLQ</a> is this what you looking for?"}, {"owner": {"reputation": 161, "user_id": 10064749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04da77e6fc1761a318e17dac6a6d10d?s=128&d=identicon&r=PG", "display_name": "Vinicius Gabriel", "link": "https://stackoverflow.com/users/10064749/vinicius-gabriel"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1561750479, "post_id": 56811384, "comment_id": 100178875, "body": "@mkopriva So, I tried to use <code>.Addr()</code> just now, but your return is not accepted by <code>.Scan()</code>. It returns the following error:  <code>sql: Scan error on column index 0: destination not a pointer</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1561755350, "post_id": 56811384, "comment_id": 100180429, "body": "My bad, <code>Addr</code> still wraps that pointer in a <code>reflect.Value</code> and returns that, so to make it a valid argument for scan you need to &quot;unwrap&quot; it, ie get the value contained in the <code>reflect.Value</code>, to do that you can call the <code>Interface</code> method on that. i.e. <code>val.Field(i).Addr().Interface()</code>"}, {"owner": {"reputation": 161, "user_id": 10064749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04da77e6fc1761a318e17dac6a6d10d?s=128&d=identicon&r=PG", "display_name": "Vinicius Gabriel", "link": "https://stackoverflow.com/users/10064749/vinicius-gabriel"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1561987346, "post_id": 56811384, "comment_id": 100225372, "body": "@mkopriva that was it, thank you!"}], "owner": {"reputation": 161, "user_id": 10064749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04da77e6fc1761a318e17dac6a6d10d?s=128&d=identicon&r=PG", "display_name": "Vinicius Gabriel", "link": "https://stackoverflow.com/users/10064749/vinicius-gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1613843903, "creation_date": 1561744795, "last_edit_date": 1613843903, "question_id": 56811384, "link": "https://stackoverflow.com/questions/56811384/fill-a-slice-with-field-pointers-of-a-struct", "title": "Fill a slice with field pointers of a struct", "body": "<p>I'm creating a function which receives an <code>interface{}</code>, which will always be a struct, but it could be any struct.</p>\n<p>I need to fill one slice with pointers of all the fields of the struct received. The place in the code below where I need to pick the field pointer is flagged with <code>**FIELD POINTER**</code></p>\n<p>My final goal is create a function to receive a <strong>struct</strong> equivalent to the return of the query sent in the parameter <strong>sqlQuery</strong>. I want to create a dynamic function to perform any type of query to select, always using the struct received for <code>.Scan</code>.</p>\n<p>It may be that I'm thinking the wrong way, I'm still starting Golang.</p>\n<pre><code>func QuerySelect(entity interface{}, sqlQuery string) {\n    val := reflect.Indirect(reflect.ValueOf(entity))\n \n    psqlInfo := fmt.Sprintf(&quot;host=%s port=%d user=%s &quot;+\n        &quot;password=%s dbname=%s sslmode=disable&quot;,\n        host, port, user, password, dbname)\n\n    // Validate database params\n    db, err := sql.Open(driver, psqlInfo)\n\n    // If returned any error\n    if err != nil {\n        panic(err)\n    }\n\n    // Validate connection with database\n    err = db.Ping()\n    if err != nil {\n        panic(err)\n    }\n\n    // Execute query\n    rows, err := db.Query(sqlQuery)\n\n    countColumns := val.Type().NumField()\n\n    var allRows []interface{}\n\n    for rows.Next() {\n        columnsPointers := make([]interface{}, countColumns)\n\n        for i := 0; i &lt; countColumns; i++ {\n           columnsPointers[i] = **FIELD POINTER (entity struct)**\n        }\n\n        if err := rows.Scan(columnsPointers...); err != nil {\n            log.Fatal(err)\n        }\n\n        allRows = append(allRows, entity)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "go-git"], "comments": [{"owner": {"reputation": 2231, "user_id": 7994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/quW1N.jpg?s=128&g=1", "display_name": "ParthS007", "link": "https://stackoverflow.com/users/7994074/parths007"}, "edited": false, "score": 0, "creation_date": 1561741130, "post_id": 56810719, "comment_id": 100175590, "body": "What it has to do with <code>go-lang</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1561743775, "creation_date": 1561743775, "answer_id": 56811203, "question_id": 56810719, "link": "https://stackoverflow.com/questions/56810719/how-to-checkout-a-specific-sha-in-a-git-repo-using-golang/56811203#56811203", "title": "How to checkout a specific SHA in a git repo using golang", "body": "<p>This is actually a Go question since it is referring to the <code>go-git</code> <a href=\"https://github.com/src-d/go-git\" rel=\"nofollow noreferrer\">library</a>.</p>\n\n<p>As such, you could do something like the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n     git \"gopkg.in/src-d/go-git.v4\"\n     \"gopkg.in/src-d/go-git.v4/plumbing\"\n)\n\n// Basic example of how to checkout a specific commit.\nfunc main() {\n    // Clone the given repository to the given directory\n    r, err := git.PlainClone(\"your-local-repo-name\", false, &amp;git.CloneOptions{\n        URL: \"your-repo-clone-URL\",\n    })\n    // handle error\n\n    // ... retrieving the commit being pointed by HEAD\n    ref, err := r.Head()\n    // handle error\n\n    w, err := r.Worktree()\n    // handle error\n\n    // ... checking out to commit\n    err = w.Checkout(&amp;git.CheckoutOptions{\n        Hash: plumbing.NewHash(\"your-specific-commit-hash\"),\n    })\n    // handle error\n\n    // ... retrieving the commit being pointed by HEAD, it shows that the\n    // repository is pointing to the giving commit in detached mode\n    ref, err = r.Head()\n    // handle error\n\n    fmt.Println(ref.Hash())\n}\n</code></pre>\n\n<p><strong>Note:</strong> <em>the majority of this code was taken from the <code>go-git</code> library <a href=\"https://github.com/src-d/go-git/blob/master/_examples/checkout/main.go\" rel=\"nofollow noreferrer\">examples</a> directory and starts the entire process by cloning the repository into a new local directory; skip this step if not applicable to your use case.</em></p>\n"}], "owner": {"reputation": 1, "user_id": 10951590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38dc3737b5334f00ad7262df2a6b8d1e?s=128&d=identicon&r=PG&f=1", "display_name": "Susai", "link": "https://stackoverflow.com/users/10951590/susai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1561743775, "creation_date": 1561741056, "question_id": 56810719, "link": "https://stackoverflow.com/questions/56810719/how-to-checkout-a-specific-sha-in-a-git-repo-using-golang", "title": "How to checkout a specific SHA in a git repo using golang", "body": "<p>I need help in check out the code upto a specific SHA number of git repo using golang</p>\n"}, {"tags": ["mongodb", "go", "mongo-go"], "comments": [{"owner": {"reputation": 836, "user_id": 2971839, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae42092534f65bffafcc85cc02e7d35b?s=128&d=identicon&r=PG&f=1", "display_name": "Keozon", "link": "https://stackoverflow.com/users/2971839/keozon"}, "edited": false, "score": 1, "creation_date": 1561744501, "post_id": 56810143, "comment_id": 100176894, "body": "Hello, mkiuchi, and welcome to stack overflow. Please update your question to be a complete and verifiable example. I should be able to run your code and reproduce the result. In the process of creating a complete example, please ensure that it is as simple as can be -- this can be hard, but in the process you will frequently find the answer. Please see here <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a> for more information."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1561745569, "post_id": 56810143, "comment_id": 100177288, "body": "can you run <code>db.rec.getIndexes()</code> and share the output?"}, {"owner": {"reputation": 508, "user_id": 11950764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8213f0ffc9106d7663c4b5f29f4ec9e5?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/11950764/joe"}, "edited": false, "score": 0, "creation_date": 1593969736, "post_id": 56810143, "comment_id": 110956352, "body": "Potentially related: <a href=\"https://stackoverflow.com/questions/29305405/mongodb-impossible-e11000-duplicate-key-error-dup-key-when-upserting\" title=\"mongodb impossible e11000 duplicate key error dup key when upserting\">stackoverflow.com/questions/29305405/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 3576336, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9be3fd96679fd7861a5f6ab3c520714b?s=128&d=identicon&r=PG&f=1", "display_name": "user3576336", "link": "https://stackoverflow.com/users/3576336/user3576336"}, "is_accepted": false, "score": 1, "last_activity_date": 1562083905, "creation_date": 1562083905, "answer_id": 56856432, "question_id": 56810143, "link": "https://stackoverflow.com/questions/56810143/updateone-failed-with-e11000-duplicate-key-error/56856432#56856432", "title": "UpdateOne failed with E11000 duplicate key error", "body": "<p>It seems as if there are records where your object mapping already exists for the id, I would encourage you to read the relevant documentation about <a href=\"https://docs.mongodb.com/manual/core/index-unique/\" rel=\"nofollow noreferrer\">unique indexes</a> and <a href=\"https://docs.mongodb.com/manual/core/index-sparse/\" rel=\"nofollow noreferrer\">sparse indexes</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11713902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f364ccd87447cf6d6ad5eab0aa61d30?s=128&d=identicon&r=PG&f=1", "display_name": "mkiuchi", "link": "https://stackoverflow.com/users/11713902/mkiuchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562083905, "creation_date": 1561738444, "last_edit_date": 1561738984, "question_id": 56810143, "link": "https://stackoverflow.com/questions/56810143/updateone-failed-with-e11000-duplicate-key-error", "title": "UpdateOne failed with E11000 duplicate key error", "body": "<p>I'm trying to update document of MongoDB from go.</p>\n\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\ndefer cancel()\nc, _ := mongo.Connect(ctx, options.Client().ApplyURI(\"mongodb://localhost:27017\"))\ncol := c.Database(\"epgrec\").Collection(\"rec\")\nfilter := bson.M{\"_id\": r.Mid}\nupdate := bson.M{\n    \"$set\": bson.M{\n        \"rid\":        r.Rid,\n        \"channel\":    r.Channel,\n        \"sid\":        r.Sid,\n        \"pid\":        r.Pid,\n        \"start\":      r.Start,\n        \"duration\":   r.Duration,\n        \"title\":      r.Title,\n        \"status\":     r.Status,\n        \"cmdarray\":   r.CmdArray,\n        \"workingdir\": r.WorkingDir,\n    },\n}\nres, err := col.UpdateOne(ctx, filter, update)\n</code></pre>\n\n<p>I've got error below.</p>\n\n<pre><code>multiple write errors: [{write errors: [{E11000 duplicate key error collection: epgrec.rec index: _id_ dup key: { : ObjectId('5d163936ead22a4f85f1e607') }}]}, {&lt;nil&gt;}]\nexit status 1\n</code></pre>\n\n<p>using MongoDB Driver v1.0.3 (from go.mongodb.org/mongo-driver/mongo)</p>\n\n<p>How do I avoid this error? Please help.</p>\n"}, {"tags": ["go", "clickhouse"], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1561735818, "creation_date": 1561735818, "answer_id": 56809593, "question_id": 56809352, "link": "https://stackoverflow.com/questions/56809352/in-password-clickhouse-driver/56809593#56809593", "title": "# in Password clickhouse driver", "body": "<p>The second parameter is a URL (in this context often called a DSN), so you have to URL-encode the parameter, unsurprisingly.</p>\n\n<p>Use the <a href=\"https://golang.org/pkg/net/url/#URL\" rel=\"nofollow noreferrer\">url.URL</a> and <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\">url.Values</a> types to build the URL in a robust way:</p>\n\n<pre><code>q := make(url.Values)\nq.Set(\"username\", \"default\")\nq.Set(\"password\", `Dsd0@*E)0#jsdpAS)DJD*!)d0@*d`)\nq.Set(\"database\", \"database\")\nq.Set(\"read_timeout\", \"10\")\nq.Set(\"write_timeout\", \"20\")\n\ndsn := (&amp;url.URL{\n    Scheme:   \"tcp\",\n    Host:     \"127.0.0.1:9000\",\n    RawQuery: q.Encode(),\n}).String()\n\nconnect, err := sql.Open(\"clickhouse\", dsn)\n</code></pre>\n\n<p>Now go and change your password!</p>\n"}], "owner": {"reputation": 69, "user_id": 7273356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ac4fd00e566cfa1a02bbbfe031511bd?s=128&d=identicon&r=PG&f=1", "display_name": "valera", "link": "https://stackoverflow.com/users/7273356/valera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 56809593, "answer_count": 1, "score": 0, "last_activity_date": 1561739187, "creation_date": 1561734806, "last_edit_date": 1561739187, "question_id": 56809352, "link": "https://stackoverflow.com/questions/56809352/in-password-clickhouse-driver", "title": "# in Password clickhouse driver", "body": "<p>I use <a href=\"https://github.com/kshvakov/clickhouse/issues/185\" rel=\"nofollow noreferrer\">this driver</a></p>\n\n<p>how to send a password?\n If it is difficult\n\"Dsd0@E)0#jsdpAS)DJD!)d0@*d\"  </p>\n\n<pre><code>  connect, err := sql.Open(\"clickhouse\", \"tcp://127.0.0.1:9000?username=default&amp;password=Dsd0@*E)0#jsdpAS)DJD*!)d0@*d&amp;database=database&amp;read_timeout=10&amp;write_timeout=20\")\n</code></pre>\n\n<p>they correct but get error \"[193] Wrong password for user default \"</p>\n"}, {"tags": ["go", "apache-kafka", "kafka-producer-api", "confluent-platform"], "answers": [{"tags": [], "owner": {"reputation": 23213, "user_id": 7131757, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wvEUE.jpg?s=128&g=1", "display_name": "Giorgos Myrianthous", "link": "https://stackoverflow.com/users/7131757/giorgos-myrianthous"}, "is_accepted": true, "score": 2, "last_activity_date": 1561732177, "creation_date": 1561732177, "answer_id": 56808752, "question_id": 56808537, "link": "https://stackoverflow.com/questions/56808537/kafka-producer-not-distributing-messages-over-partitions/56808752#56808752", "title": "Kafka producer not distributing messages over partitions", "body": "<p>Messages with the same key are being added to the same partition. If this is not the case, then try to include <code>Partition: kafka.PartitionAny</code>:</p>\n\n<pre><code>for _, message := range bigslice {\n\n    topic := \"test6\"\n        p.Produce(&amp;kafka.Message{\n            TopicPartition: kafka.TopicPartition{Topic: &amp;topic, Partition: kafka.PartitionAny},\n            Value: []byte(message),\n        }, nil)\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 1103, "user_id": 5502866, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg=k-s128", "display_name": "Kingindanord", "link": "https://stackoverflow.com/users/5502866/kingindanord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 56808752, "answer_count": 1, "score": 2, "last_activity_date": 1561732177, "creation_date": 1561731183, "last_edit_date": 1561731755, "question_id": 56808537, "link": "https://stackoverflow.com/questions/56808537/kafka-producer-not-distributing-messages-over-partitions", "title": "Kafka producer not distributing messages over partitions", "body": "<p>I am creating kafka topic as following:</p>\n\n<pre><code>kafka-topics --create --zookeeper xx.xxx.xx:2181 --replication-factor 2 --partitions 200 --topic test6 --config retention.ms=900000\n</code></pre>\n\n<p>and then I produce messages with golang using the following library:</p>\n\n<pre><code>    \"gopkg.in/confluentinc/confluent-kafka-go.v1/kafka\"\n</code></pre>\n\n<p>the producer configuration looks like this:</p>\n\n<pre><code>    for _, message := range bigslice {\n\n    topic := \"test6\"\n        p.Produce(&amp;kafka.Message{\n            TopicPartition: kafka.TopicPartition{Topic: &amp;topic},\n            Value:          []byte(message),\n        }, nil)\n\n        }\n</code></pre>\n\n<p>the problem that I've sent more than 200K messages but they all lands in partition 0.</p>\n\n<p>what could be wrong in this situation?</p>\n"}, {"tags": ["arrays", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1561746592, "last_edit_date": 1561746592, "creation_date": 1561721280, "answer_id": 56806112, "question_id": 56806051, "link": "https://stackoverflow.com/questions/56806051/why-cap-does-not-print-the-length-of-the-underlying-array/56806112#56806112", "title": "Why cap does not print the length of the underlying array?", "body": "<blockquote>\n  <p>In the Go docs, the <strong>cap</strong> is the length of the underlying array, why it's value is not 6?</p>\n</blockquote>\n\n<p>Because the capacity is <strong>not</strong> the size of the backing array (there may be special cases when they are equal, but in general they are not). When a slice is created by slicing a backing array, using <code>0</code> for the low index (or omitting it), and the array length for the high index (or omitting it), then yes, the capacity will be equal to the array's length.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Length_and_capacity\" rel=\"nofollow noreferrer\">Spec: Length and capacity:</a></p>\n\n<blockquote>\n  <p>The capacity of a slice is the number of elements for which there is space allocated in the underlying array.</p>\n</blockquote>\n\n<p>So the capacity starts at the first element of the slice, and if that is not the same as the first element of the backing array, they won't be equal. This is also stated explicitly in the <a href=\"https://tour.golang.org/moretypes/11\" rel=\"nofollow noreferrer\">Tour page</a> you linked:</p>\n\n<blockquote>\n  <p>The capacity of a slice is the number of elements in the underlying array, <strong>counting from the first element in the slice</strong>.</p>\n</blockquote>\n\n<p>There is also a <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">full slice expression</a> which has the form of:</p>\n\n<pre><code>a[low : high : max]\n</code></pre>\n\n<p>Where you can control the resulting slice's capacity, you can limit how far future slicing may extend the slice. The <code>max</code> index may point to an element <em>before</em> the last element of the array.</p>\n\n<p>See this example:</p>\n\n<pre><code>a := [10]int{}\n\ns := a[:] // len=10, cap=10\nfmt.Printf(\"len=%d, cap=%d\\n\", len(s), cap(s))\n\ns = a[2:] // len=8, cap=8\nfmt.Printf(\"len=%d, cap=%d\\n\", len(s), cap(s))\n\ns = a[2:7] // len=5, cap=8\nfmt.Printf(\"len=%d, cap=%d\\n\", len(s), cap(s))\n\ns = a[2:7:8] // len=5, cap=6\nfmt.Printf(\"len=%d, cap=%d\\n\", len(s), cap(s))\n</code></pre>\n\n<p>Outputs (try it on the <a href=\"https://play.golang.org/p/LtvU96mRRWL\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>len=10, cap=10\nlen=8, cap=8\nlen=5, cap=8\nlen=5, cap=6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4589, "user_id": 5612096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51821186ffde540f4d10b86544ca1a7d?s=128&d=identicon&r=PG", "display_name": "Adirio", "link": "https://stackoverflow.com/users/5612096/adirio"}, "is_accepted": false, "score": 1, "last_activity_date": 1561721292, "creation_date": 1561721292, "answer_id": 56806113, "question_id": 56806051, "link": "https://stackoverflow.com/questions/56806051/why-cap-does-not-print-the-length-of-the-underlying-array/56806113#56806113", "title": "Why cap does not print the length of the underlying array?", "body": "<p>When you drop the two first values, you stay with just the last 4 remaining items in the underlying array.</p>\n\n<p><code>[2 3 5 7 11 13]</code></p>\n\n<p>When you do <code>s = [:0]</code> the slice will have length 0 and cap 6: <code>[]2 3 5 7 11 13</code></p>\n\n<p>When you do <code>s = [:4]</code> the slice will have length 4 and cap 6: <code>[2 3 5 7] 11 13</code></p>\n\n<p>When you do <code>s = [2:]</code> the slice will have length 2 and cap 4: <code>2 3 [5 7] 11 13</code></p>\n\n<p>This is because that array has no access to the first two values anymore while the last two can still be accessed if the length of the slice is extended.</p>\n"}], "owner": {"reputation": 3944, "user_id": 893898, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/cbb75897ee67011990d4706fad19e38b?s=128&d=identicon&r=PG", "display_name": "Hantsy", "link": "https://stackoverflow.com/users/893898/hantsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 56806112, "answer_count": 2, "score": -1, "last_activity_date": 1561746592, "creation_date": 1561721008, "last_edit_date": 1561721624, "question_id": 56806051, "link": "https://stackoverflow.com/questions/56806051/why-cap-does-not-print-the-length-of-the-underlying-array", "title": "Why cap does not print the length of the underlying array?", "body": "<p>I am reading the A Tour of GO, in the <a href=\"https://tour.golang.org/moretypes/11\" rel=\"nofollow noreferrer\">Slice length and capacity</a> section, I ran the example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := []int{2, 3, 5, 7, 11, 13}\n    printSlice(s)\n\n    // Slice the slice to give it zero length.\n    s = s[:0]\n    printSlice(s)\n\n    // Extend its length.\n    s = s[:4]\n    printSlice(s)\n\n    // Drop its first two values.\n    s = s[2:]\n    printSlice(s)\n}\n\nfunc printSlice(s []int) {\n    fmt.Printf(\"len=%d cap=%d %v\\n\", len(s), cap(s), s)\n}\n</code></pre>\n\n<p>When I build the app and run it, it prints like this:</p>\n\n<pre><code>len=6 cap=6 [2 3 5 7 11 13]\nlen=0 cap=6 []\nlen=4 cap=6 [2 3 5 7]\nlen=2 cap=4 [5 7]\n</code></pre>\n\n<p>In the Go docs, the <strong>cap</strong> is the length of the underlying array, why it's value is not 6?</p>\n"}, {"tags": ["go", "browser", "command-line", "youtube-dl", "download-manager"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1561725361, "post_id": 56805314, "comment_id": 100168054, "body": "&#171;I could not even open the file.&#187; That&#39;s because you have no idea what happens when you run <code>youtube-dl</code> from your code, and that&#39;s <i>bad.</i> Have you at least try to glance into the tool&#39;s manual to understand what it&#39;s <code>-o</code> command-line option controls, and what passing the tool <code>-o -</code> actually enables? If you want to become proficient in programming, you <i>have to</i> work on developing your problem-solving skills, and understanding what happens in <i>your</i> code is a crucial thing for that."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1561725706, "post_id": 56805314, "comment_id": 100168236, "body": "@kostix, doesn&#39;t seem to me that they don&#39;t know what that flag does. The problem is almost certainly that stderr is intermingled with the video stream. Replacing CombinedOutput with Output would make this work, albeit horribly inefficiently."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1561728083, "post_id": 56805314, "comment_id": 100169486, "body": "@Peter, may be you&#39;re correct. I interpreted the &#171;I could not even open the file&#187; remark as &quot;I failed to locate it on the server&quot;. Regarding your remark on <code>CombinedOutput</code> vs <code>Output</code>\u2014why do you think doing that would be inefficient? In fact, I&#39;d say that&#39;s the only way forward: you connect <code>Stdout</code> of the spawned process to the response writer and let Stderr be written somewhere (like <code>bytes.Buffer</code>), and then check its contents if the process fails. The contents may be used for logging or be sent to the user somehow. What do you think?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1561729720, "post_id": 56805314, "comment_id": 100170326, "body": "@kostix, it&#39;s inefficient because calling Output reads the whole video into memory before it can be written to the ResponseWriter. Writing Stderr to a buffer is a good idea though. I&#39;ll add that to my answer."}, {"owner": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1561730631, "post_id": 56805314, "comment_id": 100170863, "body": "Hi @kostix,  I do know what I am doing and what the command do.  Of course I have tried these commands to see what youtube-dl is capable of. You make judgement and that is not ethical."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1561808615, "post_id": 56805314, "comment_id": 100187864, "body": "@AknKplnoglu, I see. Let me apologize! (But I hope my other suggestions to Peter helped to improve the resulting solution.)"}], "answers": [{"comments": [{"owner": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "edited": false, "score": 0, "creation_date": 1561730863, "post_id": 56805894, "comment_id": 100170978, "body": "Thanks @Peter. I think it should be w.Context() instead of r.Context()."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "edited": false, "score": 0, "creation_date": 1561731203, "post_id": 56805894, "comment_id": 100171141, "body": "@AknKplnoglu, ResponseWriter has no Context method. r.Context() is correct."}, {"owner": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "edited": false, "score": 0, "creation_date": 1561731806, "post_id": 56805894, "comment_id": 100171447, "body": "Thanks. I will check asap."}, {"owner": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "edited": false, "score": 0, "creation_date": 1561908552, "post_id": 56805894, "comment_id": 100204324, "body": "Hi @Peter. I have just one question. Can I get the total size of the file that will be downloaded? Because I want to get the content length and use it in header."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "edited": false, "score": 1, "creation_date": 1561916874, "post_id": 56805894, "comment_id": 100206082, "body": "@AknKplnoglu, I doubt that, but you&#39;ll have to check the docs for youtube-dl. The Content-Length header isn&#39;t required, though. Go will use chunked transfer encoding automatically."}, {"owner": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "edited": false, "score": 0, "creation_date": 1561921410, "post_id": 56805894, "comment_id": 100207109, "body": "Thanks @Peter, It downloads correctly to the browser but client does not know the total size and can not precise the download time."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1561730214, "last_edit_date": 1561730214, "creation_date": 1561720418, "answer_id": 56805894, "question_id": 56805314, "link": "https://stackoverflow.com/questions/56805314/youtube-dl-download-to-client-browser-directly/56805894#56805894", "title": "Youtube-dl download to client browser directly", "body": "<p>Simply assign the ResponseWriter to the command's Stdout field. I also suggest to use <a href=\"https://golang.org/pkg/os/exec/#CommandContext\" rel=\"nofollow noreferrer\">exec.CommandContext</a> with the request context so that youtube-dl gets terminated quickly if the client aborts the request.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func SearchHandler(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Disposition\", \"attachment; filename=BigBuckBunny.mp4\")\n    w.Header().Set(\"Content-Type\", \"application/octet-stream\") \n    // or more precisely: w.Header().Set(\"Content-Type\", \"video/mp4\") \n\n    url := r.FormValue(\"entry-domain\")\n\n    stderr := &amp;bytes.Buffer{}\n\n    cmd := exec.CommandContext(r.Context(), \"youtube-dl.exe\", \"-o\", \"-\", url)\n    cmd.Stdout = w\n    cmd.Stderr = stderr\n\n    if err := cmd.Run(); err != nil {\n        log.Println(err)\n        log.Println(\"stderr:\", buf.String())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1409, "favorite_count": 1, "accepted_answer_id": 56805894, "answer_count": 1, "score": 2, "last_activity_date": 1561730214, "creation_date": 1561717883, "question_id": 56805314, "link": "https://stackoverflow.com/questions/56805314/youtube-dl-download-to-client-browser-directly", "title": "Youtube-dl download to client browser directly", "body": "<p>I want to use <a href=\"https://ytdl-org.github.io/youtube-dl/index.html\" rel=\"nofollow noreferrer\">youtube-dl</a> exe file in Windows for downloading the videos to the client's browser with Golang Web App. </p>\n\n<p>I have a page that contains an input for the website url (For example a youtube url) and I want to call youtube.dl exe file with this url in my server with Golang. But I could not download the file to the client's browser directly.</p>\n\n<p>I don't want to download the video itself to my server. I want it to be downloaded to client's browser directly.</p>\n\n<p>I tried many things on the web and here where I am. You can find my code snippet below.</p>\n\n<pre><code>func SearchHandler(w http.ResponseWriter, r *http.Request) {\n\n// - --------------------------------------------------------------------------------------------------------------\n// - Retrieve the HTML form parameter of POST method\n// - --------------------------------------------------------------------------------------------------------------\nurl := r.FormValue(\"entry-domain\")\n\nlogger.Printf(\"SearchHandler started to research the IP and MX data from %s domain\", url)\nfmt.Println(\"starting download................\")\ncmd := exec.Command(\"youtube-dl.exe\", \"-o\", \"-\", url)\nfmt.Println(\"downloading started...............\")\n\n\nout, err := cmd.CombinedOutput()\nif err != nil {\n    log.Fatalf(\"cmd.Run() failed with %s\\n\", err)\n}\n\n// //copy the relevant headers. If you want to preserve the downloaded file name, extract it with go's url parser.\nw.Header().Set(\"Content-Disposition\", \"attachment; filename=BigBuckBunny.mp4\")\nw.Header().Set(\"Content-Type\", \"application/octet-stream\")\n\n//stream the body to the client without fully loading it into memory\nreader := bytes.NewReader(out)\n//w.Write(out)\nio.Copy(w, reader)\nfmt.Println(\"written to file.....................\")\nreturn}\n</code></pre>\n\n<p>I could download a file but it did not work as expected. I could not even open the file.</p>\n"}, {"tags": ["rest", "go", "cron", "dropbox", "resty"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1561717230, "post_id": 56805083, "comment_id": 100164396, "body": "can you share the value of environment variable <code>schedules</code>?"}, {"owner": {"reputation": 1496, "user_id": 3159714, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6plcB.png?s=128&g=1", "display_name": "Abhinab Kanrar", "link": "https://stackoverflow.com/users/3159714/abhinab-kanrar"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1561717413, "post_id": 56805083, "comment_id": 100164464, "body": "for 3:53PM &amp; 3:55PM i have set it as 15:53,15:55"}, {"owner": {"reputation": 1496, "user_id": 3159714, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6plcB.png?s=128&g=1", "display_name": "Abhinab Kanrar", "link": "https://stackoverflow.com/users/3159714/abhinab-kanrar"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1561717449, "post_id": 56805083, "comment_id": 100164480, "body": "One point to mention is that the schduler is working fine, i mean it&#39;s triggeing the job as it should"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1561717792, "post_id": 56805083, "comment_id": 100164609, "body": "so invoking the method manually is working fine, and scheduler is also working fine. sorry what was the problem again?"}, {"owner": {"reputation": 1496, "user_id": 3159714, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6plcB.png?s=128&g=1", "display_name": "Abhinab Kanrar", "link": "https://stackoverflow.com/users/3159714/abhinab-kanrar"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1561718014, "post_id": 56805083, "comment_id": 100164695, "body": "You are correct. The method is working fine and the scheduler is working fine too(meaning it&#39;s invoking the upload method successfully). But the rest api call inside the method is failing without providing any response or error"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1561894258, "post_id": 56805083, "comment_id": 100201455, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It is not obvious which cron implementation you are using. Assuming it is <a href=\"https://github.com/mileusna/crontab\" rel=\"nofollow noreferrer\">github.com/mileusna/crontab</a> -  worked with it yet, so just a wild guess, bit you are putting the code to be executed (which will most likely be run in a goroutine) inside another goroutine (<code>go service.Upload...</code>). Without the code, however, it is not easy to debug."}, {"owner": {"reputation": 1496, "user_id": 3159714, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6plcB.png?s=128&g=1", "display_name": "Abhinab Kanrar", "link": "https://stackoverflow.com/users/3159714/abhinab-kanrar"}, "edited": false, "score": 0, "creation_date": 1561896612, "post_id": 56805083, "comment_id": 100201885, "body": "I got the solution actually....in the main method I used for to block the shutdown which was causing the issue....now after using select instead of for it&#39;s working fine.Anyway, thanks for your points"}], "owner": {"reputation": 1496, "user_id": 3159714, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6plcB.png?s=128&g=1", "display_name": "Abhinab Kanrar", "link": "https://stackoverflow.com/users/3159714/abhinab-kanrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561718706, "creation_date": 1561716948, "last_edit_date": 1561718706, "question_id": 56805083, "link": "https://stackoverflow.com/questions/56805083/unable-to-resty-v2-post-call-via-cron-tab", "title": "Unable to resty.v2 POST call via cron tab", "body": "<p>I'm creating a scheduler using Golang's crontab and resty.v2 to call a POST api(Dropbox file upload api).<br>\nWhen I'm invoking the file upload method manually its working fine. But when the same method is invoked via the crontab scheduler its not making the rest call.<br>\nInteresting fact is that, it's neither throwing any error nor providing any rest call response.<br>\nPFB the scheduler code to invoke the upload method:</p>\n\n<pre><code>func StartJob() {\nctab := crontab.New()\n\nfor _, v := range strings.Split(os.Getenv(\"schedules\"), commaSeparator) {\n    match, _ := regexp.MatchString(regex, v)\n    if match == true {\n        hhmm := strings.Split(v, colonSeparator)\n        expresion := fmt.Sprintf(cronExpression, hhmm[1], hhmm[0])\n        ctab.MustAddJob(expresion, func() {\n            go service.Upload(dropboxEndpoint, dropboxAccessToken, os.Getenv(\"hkpath\"))\n        })\n    } else {\n        fmt.Printf(\"Not acceptable time-format : %s\\n\", v)\n    }\n}}\n</code></pre>\n\n<p>And here is the upload method code:</p>\n\n<pre><code>func Upload(dropboxEndpoint string, dropboxAccessToken string, path string) {\n_, fileName := filepath.Split(path)\nfileBytes, fileErr := ioutil.ReadFile(path)\n\nif fileErr == nil {\n    fmt.Println(path)\n    resp, restErr := client.R().\n        SetBody(fileBytes).\n        SetContentLength(true).\n        SetHeader(\"Authorization\", fmt.Sprintf(\"Bearer %s\", dropboxAccessToken)).\n        SetHeader(\"Dropbox-API-Arg\", fmt.Sprintf(\"{\\\"path\\\": \\\"/home/f1/%s/%s\\\",\\\"mode\\\": \\\"add\\\",\\\"autorename\\\": true,\\\"mute\\\": false,\\\"strict_conflict\\\": false}\", os.Getenv(\"name\"), fileName)).\n        SetHeader(\"Content-Type\", \"application/octet-stream\").\n        Post(dropboxEndpoint)\n\n    if restErr != nil {\n        log.Fatal(restErr)\n    } else {\n        fmt.Println(resp)\n    }\n} else {\n    log.Fatal(fileErr)\n}}\n</code></pre>\n\n<p>Any idea what's the wrong I'm doing?</p>\n"}, {"tags": ["sql", "go", "concurrency"], "comments": [{"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 2, "creation_date": 1561714350, "post_id": 56803984, "comment_id": 100162960, "body": "sql.DB type is safe for concurrent use. Look at <a href=\"https://stackoverflow.com/questions/24951543/database-connection-best-practice\" title=\"database connection best practice\">stackoverflow.com/questions/24951543/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": true, "score": 2, "last_activity_date": 1561729484, "last_edit_date": 1561729484, "creation_date": 1561729162, "answer_id": 56808036, "question_id": 56803984, "link": "https://stackoverflow.com/questions/56803984/concurrency-safe-access-to-database-in-golang/56808036#56808036", "title": "Concurrency safe access to database in golang", "body": "<p>There are two components to consider with this:</p>\n\n<ul>\n<li>Thread-safety of go language client </li>\n<li><a href=\"https://www.postgresql.org/docs/9.1/transaction-iso.html\" rel=\"nofollow noreferrer\">Database Transaction Isolation Levels</a></li>\n</ul>\n\n<p><strong>Thread-safety of go language client</strong> </p>\n\n<p>The first one requires <a href=\"https://medium.com/dm03514-tech-blog/golang-candidates-and-contexts-a-heuristic-approach-to-race-condition-detection-e2b230e70d08#1610\" rel=\"nofollow noreferrer\">auditing</a>, hopefully it is easy to find this information through the community without having to drop down into code level audits.  I see that concurrent (thread) safety is <a href=\"https://golang.org/pkg/database/sql/#Conn.Close\" rel=\"nofollow noreferrer\">mentioned for a number of the abstractions on the official go documentation</a> so it should be easy to find which structs and methods are safe for concurrent use from a language level perspective (go).</p>\n\n<p><strong><a href=\"https://www.postgresql.org/docs/9.1/transaction-iso.html\" rel=\"nofollow noreferrer\">Database Transaction Isolation Levels</a></strong></p>\n\n<p>The second is consideration starts to get into database and the guarantees that your specific DB offers (and just general distributed systems fun :) ) The default isolation level for postgres/mysql allow for 2 concurrent reads to see the same data, and then have each one overwrite the other (on a write).\nThe postgres documentation provides an <a href=\"https://www.postgresql.org/docs/9.1/transaction-iso.html#XACT-READ-COMMITTED\" rel=\"nofollow noreferrer\">excellent example of this case</a>:</p>\n\n<blockquote>\n  <p>Because of the above rule, it is possible for an updating command to\n  see an inconsistent snapshot: it can see the effects of concurrent\n  updating commands on the same rows it is trying to update, but it does\n  not see effects of those commands on other rows in the database. This\n  behavior makes Read Committed mode unsuitable for commands that\n  involve complex search conditions; however, it is just right for\n  simpler cases. For example, consider updating bank balances with\n  transactions like:</p>\n</blockquote>\n\n<pre><code>BEGIN;\nUPDATE accounts SET balance = balance + 100.00 WHERE acctnum = 12345;\nUPDATE accounts SET balance = balance - 100.00 WHERE acctnum = 7534;\nCOMMIT;\n</code></pre>\n\n<blockquote>\n  <p>If two such transactions concurrently try to change the balance of\n  account 12345, we clearly want the second transaction to start with\n  the updated version of the account's row. Because each command is\n  affecting only a predetermined row, letting it see the updated version\n  of the row does not create any troublesome inconsistency.</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 11581685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d968dde1d9e21812319d25b2a37ccf?s=128&d=identicon&r=PG&f=1", "display_name": "Proto_type", "link": "https://stackoverflow.com/users/11581685/proto-type"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2976, "favorite_count": 0, "accepted_answer_id": 56808036, "answer_count": 1, "score": 1, "last_activity_date": 1561729484, "creation_date": 1561712721, "question_id": 56803984, "link": "https://stackoverflow.com/questions/56803984/concurrency-safe-access-to-database-in-golang", "title": "Concurrency safe access to database in golang", "body": "<p>i'm need some recomendation about concurrency work database golang. For example, i've database with payment info. How could i get actual inforamtion about payments, if it have more than 1 connection which all time update database?</p>\n\n<p>I'm tried to use transaction with gorm but i'm not sure its work or not. Also i'm trying to use mutex, but if my app has more than 1 instance it doesn't work correctly. Also i'm trying to use sql like Update payment set someinfo = someinfo || \" addition info\" where some condition.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4589, "user_id": 5612096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51821186ffde540f4d10b86544ca1a7d?s=128&d=identicon&r=PG", "display_name": "Adirio", "link": "https://stackoverflow.com/users/5612096/adirio"}, "edited": false, "score": 0, "creation_date": 1561715925, "post_id": 56803469, "comment_id": 100163755, "body": "Why do you want to do this? If you are developping in Linux/any-non-windows-OS for Windows, cross-compilation will handle this for you, as when cross-compiled, <code>filepath.Join()</code> will use the target OS separator, not the building OS one."}, {"owner": {"reputation": 6043, "user_id": 793961, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/367cd54226af527423507c1f89abb25a?s=128&d=identicon&r=PG", "display_name": "muffel", "link": "https://stackoverflow.com/users/793961/muffel"}, "reply_to_user": {"reputation": 4589, "user_id": 5612096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51821186ffde540f4d10b86544ca1a7d?s=128&d=identicon&r=PG", "display_name": "Adirio", "link": "https://stackoverflow.com/users/5612096/adirio"}, "edited": false, "score": 0, "creation_date": 1561716244, "post_id": 56803469, "comment_id": 100163933, "body": "@Adirio I am creating a client for an existing SOAP service I don&#39;t have any influence on, and the remote service accepts a Windows path only."}, {"owner": {"reputation": 4589, "user_id": 5612096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51821186ffde540f4d10b86544ca1a7d?s=128&d=identicon&r=PG", "display_name": "Adirio", "link": "https://stackoverflow.com/users/5612096/adirio"}, "edited": false, "score": 0, "creation_date": 1561716382, "post_id": 56803469, "comment_id": 100164003, "body": "Okey, sounds legit. I was wondering if it was just a missunderstanding about cross-compilation."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1561724864, "last_edit_date": 1561724864, "creation_date": 1561710923, "answer_id": 56803563, "question_id": 56803469, "link": "https://stackoverflow.com/questions/56803469/join-paths-with-backslash-separator-independent-of-the-underlying-os-with-the-st/56803563#56803563", "title": "join paths with backslash separator independent of the underlying os with the standard library", "body": "<p>No, not with the standard lib's <a href=\"https://golang.org/pkg/path/filepath/\" rel=\"nofollow noreferrer\"><code>path/filepath</code></a> package. You have to use <a href=\"https://golang.org/pkg/strings/#Join\" rel=\"nofollow noreferrer\"><code>strings.Join()</code></a> instead.</p>\n\n<p>If you do rely on \"side-effects\" of <a href=\"https://golang.org/pkg/path/filepath/#Join\" rel=\"nofollow noreferrer\"><code>filepath.Join()</code></a> (e.g. adding a separator if necessary, calling <code>Clean()</code> etc.), then easiest would be to call <code>filepath.Join()</code>, then replace slashes with backslashes, e.g. using <a href=\"https://golang.org/pkg/strings/#ReplaceAll\" rel=\"nofollow noreferrer\"><code>strings.ReplaceAll()</code></a>.</p>\n\n<p>Note that the replace-all method works because slash <code>/</code> is a reserved character and cannot appear in names other than separating folders and files. For details, see <a href=\"https://docs.microsoft.com/en-us/windows/desktop/FileIO/naming-a-file\" rel=\"nofollow noreferrer\">Naming Files, Paths, and Namespaces</a>.</p>\n\n<p>See related <a href=\"https://stackoverflow.com/questions/51669486/filepath-join-removes-dot/51670536#51670536\">filepath.Join removes dot</a>.</p>\n"}], "owner": {"reputation": 6043, "user_id": 793961, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/367cd54226af527423507c1f89abb25a?s=128&d=identicon&r=PG", "display_name": "muffel", "link": "https://stackoverflow.com/users/793961/muffel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56803563, "answer_count": 1, "score": 2, "last_activity_date": 1561724864, "creation_date": 1561710538, "last_edit_date": 1561713473, "question_id": 56803469, "link": "https://stackoverflow.com/questions/56803469/join-paths-with-backslash-separator-independent-of-the-underlying-os-with-the-st", "title": "join paths with backslash separator independent of the underlying os with the standard library", "body": "<p><a href=\"https://golang.org/pkg/path/filepath/#Join\" rel=\"nofollow noreferrer\">filepath.Join</a> allows to join paths by using the path separator of the underlying os (basically <code>\\</code> on Windows, <code>/</code> everywhere else).</p>\n\n<p>Is there a way to <strong>force</strong> using the Windows path separator <code>\\</code> for joining paths with the Go standard library no matter what the actual running operating system is?</p>\n"}, {"tags": ["api", "go", "mux"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1561697129, "post_id": 56800387, "comment_id": 100156439, "body": "The call <code>mux.Vars(r)</code> returns a map, <code>[&quot;ID&quot;]</code> attempts to retrieve a value from the map using the key <code>&quot;ID&quot;</code>. Indexing into a map in Go can <i>optionally</i> return two values, (1) the one that&#39;s mapped to the provided key, (2) a boolean that indicates whether or not a value was actually mapped to the key."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1561697253, "post_id": 56800387, "comment_id": 100156462, "body": "... then <code>!Ok</code> would trigger when the map does not contain an <code>ID</code> key-value."}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 1, "last_activity_date": 1561702720, "last_edit_date": 1561702720, "creation_date": 1561701568, "answer_id": 56801616, "question_id": 56800387, "link": "https://stackoverflow.com/questions/56800387/golang-mux-syntax-question-if-id-ok-mux-varsrid-ok/56801616#56801616", "title": "GoLang/Mux syntax question: if ID, Ok = mux.Vars(r)[&quot;ID&quot;]; !ok", "body": "<p>I assume you are using goriila mux. I checked on the <a href=\"https://github.com/gorilla/mux/blob/master/mux.go#L430-L435\" rel=\"nofollow noreferrer\">source code</a>, the <code>mux.Vars()</code> returns a value with type is <code>map[string]string</code>.</p>\n\n<p>In a nutshell, a <code>map</code> datatype can optionally return two values.</p>\n\n<ol>\n<li>The first one is the actual value as per requested key</li>\n<li>The second one is an indicator whether item with requested key is exist or not (a boolean value).</li>\n</ol>\n\n<p>Please take a look at example below:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>vars := map[string]string{\n    \"one\": \"1\",\n    \"two\": \"\",\n}\n\nvalue1, ok1 := vars[\"one\"]\nfmt.Println(\"value:\", value1, \"is exists:\", ok1)\n// value: 1 is exists: true\n\nvalue2, ok2 := vars[\"two\"]\nfmt.Println(\"value:\", value2, \"is exists:\", ok2)\n// value:  is exists: true\n\nvalue3, ok3 := vars[\"three\"]\nfmt.Println(\"value:\", value3, \"is exists:\", ok3)\n// value:  is exists: false\n</code></pre>\n\n<p>From example above we can clearly see, if requested item does not exists, then the 2nd return will be <code>false</code>.</p>\n\n<p>If the item is exists even though the value is zero value, then 2nd return will still be <code>true</code>, because the item is indeed exist, doesn't necessarily important what the value is.</p>\n"}], "owner": {"reputation": 332, "user_id": 9801467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7c6480111fa3f1d213a5f83836a0a6?s=128&d=identicon&r=PG&f=1", "display_name": "lee.edward01", "link": "https://stackoverflow.com/users/9801467/lee-edward01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 56801616, "answer_count": 1, "score": -1, "last_activity_date": 1561702720, "creation_date": 1561690447, "question_id": 56800387, "link": "https://stackoverflow.com/questions/56800387/golang-mux-syntax-question-if-id-ok-mux-varsrid-ok", "title": "GoLang/Mux syntax question: if ID, Ok = mux.Vars(r)[&quot;ID&quot;]; !ok", "body": "<p>I am very new to Golang and I am reading someone's code for an API using gorilla/mux and I came across this block of code. </p>\n\n<pre><code>func heroGet(w http.ResponseWriter, r *http.Request) {\n    var ID string\n    var Ok bool\n    if ID, Ok = mux.Vars(r)[\"ID\"]; !Ok{\n        //do something\n    }\n</code></pre>\n\n<p>I am having trouble understanding what Ok does in this specific situation and when <code>!Ok</code> would trigger. </p>\n\n<p>Note that this function is <code>GET</code> endpoint. </p>\n\n<p>(<code>r.HandleFunc(\"/hero/{ID}\", heroGet).Methods(\"GET\")</code>)</p>\n"}, {"tags": ["loops", "go", "text-files"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1561677353, "post_id": 56799155, "comment_id": 100153469, "body": "Use a <a href=\"https://golang.org/pkg/sync#WaitGroup\" rel=\"nofollow noreferrer\">sync.WaitGroup</a>."}], "answers": [{"comments": [{"owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "edited": false, "score": 0, "creation_date": 1561699804, "post_id": 56799986, "comment_id": 100157064, "body": "thanks! I ended up using option 1, as it made sense and there were not additional/complicated args added causing slow downs, etc..."}], "tags": [], "owner": {"reputation": 36, "user_id": 11711172, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CGgpyEUY72A/AAAAAAAAAAI/AAAAAAAAAA8/TcPWA0sidHA/photo.jpg?sz=128", "display_name": "RJC", "link": "https://stackoverflow.com/users/11711172/rjc"}, "is_accepted": true, "score": 2, "last_activity_date": 1561685387, "creation_date": 1561685387, "answer_id": 56799986, "question_id": 56799155, "link": "https://stackoverflow.com/questions/56799155/remove-file-after-2-goroutines-are-done/56799986#56799986", "title": "Remove file after 2 goroutines are done", "body": "<p>Provided I haven't misunderstood your explanation:</p>\n\n<ul>\n<li>option 1, from what you've said, you'll probably want to keep the loop and maintain a coroutine for each /dest. </li>\n<li>option 2, don't do that. If you're trying to share information between a fork and main/other fork you'll want to use a (sync.)waitgroup or better yet, (sync.)condition. If you leave a for exp {} in a coroutine waiting for some shared resource to change, this will eat cpu and cause a whole lot of slowdown. Even if you use a sleep in there, it trades off wasted cpu for wasted runtime and lack of coordination. Sync.condition wait() use will actually suspend the routine--allowing other routines to run in its stead, and waitgroup is a perfectly reasonable option as well. </li>\n</ul>\n\n<p>Maybe I'm misunderstanding, but hopefully I was of some help.</p>\n"}], "owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56799986, "answer_count": 1, "score": -3, "last_activity_date": 1561699961, "creation_date": 1561674918, "last_edit_date": 1561699961, "question_id": 56799155, "link": "https://stackoverflow.com/questions/56799155/remove-file-after-2-goroutines-are-done", "title": "Remove file after 2 goroutines are done", "body": "<p>I have a simple goroutine, that calls a local binary (rsync) that points to a temporary text file containing list of files to operate on, with a destination directory. At the end of the routine, I remove the tempfile. No issues here.</p>\n\n<p>But in certain cases the same temp file needs to be used, when there are two destinations that are called in a range loop, e.g.:</p>\n\n<pre><code>destDirs := []string{\"dir1/\", \"dir2/\"}\nfor _, dest := range destDirs {\n  go launchRoutine(tempfile.Name(), dest)\n}\n</code></pre>\n\n<p>Since launchRoutine can take a while to run, and since this is a web app, waiting until the routine finishes is not an option. </p>\n\n<p>Question is, where it be best to place the os.Remove(tempfile) code?</p>\n\n<p>Option 1 - send launchRoutine a slice instead of a string, and loop over it in launchRoutine, and remove the file then. </p>\n\n<p>Option 2 - send a bool to launchRoutine to remove the file when the range loop is at last iteration.</p>\n\n<p>Option 3 - No idea? Any idiomatic ways I haven't thought of?</p>\n\n<p>Solution I went with, @RJS's comments seem to validate the solution:</p>\n\n<pre><code>destDirs := []string{\"dir1/\", \"dir2/\"}\nfor _, dest := range destDirs {\n  go launchRoutine(tempfile.Name(), dest)\n}\nos.Remove(tempfile.Name())\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["regex", "go", "regex-group", "regex-greedy"], "comments": [{"owner": {"reputation": 4510, "user_id": 6224823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-eVoU_E2fMho/AAAAAAAAAAI/AAAAAAAAAC4/7qlAOwlIJkM/photo.jpg?sz=128", "display_name": "Olian04", "link": "https://stackoverflow.com/users/6224823/olian04"}, "edited": false, "score": 1, "creation_date": 1561671968, "post_id": 56798776, "comment_id": 100152240, "body": "why not split on the dot character then discard the first element (since it would always be <code>Exactfoobar</code>)? That way you don&#39;t need regex, which should be a lot faster and more readable."}], "answers": [{"comments": [{"owner": {"reputation": 1367, "user_id": 596990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/w1ssn.png?s=128&g=1", "display_name": "Sumitk", "link": "https://stackoverflow.com/users/596990/sumitk"}, "edited": false, "score": 1, "creation_date": 1561692336, "post_id": 56798809, "comment_id": 100155656, "body": "thanks @Wiktor! this worked like I was thinking. What does <code>?:</code> mean"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 1367, "user_id": 596990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/w1ssn.png?s=128&g=1", "display_name": "Sumitk", "link": "https://stackoverflow.com/users/596990/sumitk"}, "edited": false, "score": 0, "creation_date": 1561704353, "post_id": 56798809, "comment_id": 100158584, "body": "@Sumitk See <a href=\"https://stackoverflow.com/questions/3512471/what-is-a-non-capturing-group-what-does-do\">What is a non-capturing group? What does (?:) do?</a>."}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1561671956, "creation_date": 1561671956, "answer_id": 56798809, "question_id": 56798776, "link": "https://stackoverflow.com/questions/56798776/regex-for-string-after-string-pattern/56798809#56798809", "title": "Regex for string after string pattern", "body": "<p>You may use</p>\n\n<pre><code>^Exactfoobar(?:\\.[a-z0-9][a-z0-9_-]*){2}(?:\\.[a-zA-Z0-9][a-zA-Z0-9_-]*)+$\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/r5mufX/3\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<ul>\n<li><code>^</code> - Start of string</li>\n<li><code>Exactfoobar</code> - some word</li>\n<li><code>(?:\\.[a-z0-9][a-z0-9_-]*){2}</code> - two repetitions of a <code>.</code>, then a lowercase letter or digit and then 0+ lowercase letters or digits, <code>_</code> or <code>-</code></li>\n<li><code>(?:\\.[a-zA-Z0-9][a-zA-Z0-9_-]*)+</code> - 1 or more repetitions of\n\n<ul>\n<li><code>\\.</code> - dot</li>\n<li><code>[a-zA-Z0-9]</code> - a letter or digit</li>\n<li><code>[a-zA-Z0-9_-]*</code> - 0+ letters, digits or <code>_</code> or <code>-</code></li>\n</ul></li>\n<li><code>$</code> - end of string.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1561672510, "post_id": 56798866, "comment_id": 100152392, "body": "This is a wrong solution, see <a href=\"https://regex101.com/r/8ebzJv/1\" rel=\"nofollow noreferrer\">your regex demo</a>. The words must begin with a letter or digit."}, {"owner": {"reputation": 828, "user_id": 1550361, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6989fbcb6bb5c7d7f23f34bb58e7f713?s=128&d=identicon&r=PG&f=1", "display_name": "danielb", "link": "https://stackoverflow.com/users/1550361/danielb"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1561674062, "post_id": 56798866, "comment_id": 100152756, "body": "I guess you&#39;re right, although that wasn&#39;t an explicit requirement"}], "tags": [], "owner": {"reputation": 828, "user_id": 1550361, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6989fbcb6bb5c7d7f23f34bb58e7f713?s=128&d=identicon&r=PG&f=1", "display_name": "danielb", "link": "https://stackoverflow.com/users/1550361/danielb"}, "is_accepted": false, "score": 0, "last_activity_date": 1561672340, "creation_date": 1561672340, "answer_id": 56798866, "question_id": 56798776, "link": "https://stackoverflow.com/questions/56798776/regex-for-string-after-string-pattern/56798866#56798866", "title": "Regex for string after string pattern", "body": "<pre><code>^Exactfoobar(?:\\.[a-z0-9_\\-]+){2}(?:\\.[A-Za-z0-9_\\-]+)+$\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/PJ9V0L/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/PJ9V0L/1</a></p>\n"}], "owner": {"reputation": 1367, "user_id": 596990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/w1ssn.png?s=128&g=1", "display_name": "Sumitk", "link": "https://stackoverflow.com/users/596990/sumitk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 56798809, "answer_count": 2, "score": 0, "last_activity_date": 1561672340, "creation_date": 1561671699, "question_id": 56798776, "link": "https://stackoverflow.com/questions/56798776/regex-for-string-after-string-pattern", "title": "Regex for string after string pattern", "body": "<p>I have a string like this (4 words separated by dot) </p>\n\n<pre><code>Exactfoobar.foobar-_nocaps.foobar-_nocaps.foobar-_caps\n</code></pre>\n\n<p>I need to write a regex to find the pattern as above. </p>\n\n<ol>\n<li>There could be 4 or more fields separated by a dot </li>\n<li>The first word should be exactly <code>Exactfoobar.</code></li>\n<li>The 2nd and 3rd word can't have caps but can have -_</li>\n<li>The 4th word and so on can have caps with -_</li>\n</ol>\n\n<p>I was thinking of using groups but its not working here:</p>\n\n<pre><code>^Exactfoobar\\.([a-z0-9][a-z0-9_\\-.])+([a-z0-9][a-zA-Z0-9_\\-.])+$\n</code></pre>\n\n<p>How should I think about matching a string after another string. Is it possible?</p>\n\n<p>Trying this in golang but cant seem to get the above regex right</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n\n    var validID = regexp.MustCompile(`^ Exactfoobar\\.([a-z0-9][a-z0-9_\\-.])+([a-z0-9][a-z0-9_\\-.])+$`)\n\n    fmt.Println(validID.MatchString(\"Exactfoobar.somestring.some_other-string.someStringwithCaps\"))\n\n\n}\n\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>false\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["unit-testing", "go", "testing", "random"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1561673591, "post_id": 56798459, "comment_id": 100152660, "body": "There&#39;s a difference between unit testing and fuzz testing. Each has value but it&#39;s important not to conflate the two."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1561677259, "post_id": 56798459, "comment_id": 100153450, "body": "This question seems basically opinion-based, but see <a href=\"https://softwareengineering.stackexchange.com/q/221632\">Testing: deterministic or non-deterministic?</a> on Software Engineering, or <a href=\"https://stackoverflow.com/q/3441686\">What are the downsides using random values in Unit Testing?</a> and <a href=\"https://stackoverflow.com/q/32458\">Random data in Unit Tests?</a> here."}], "answers": [{"tags": [], "owner": {"reputation": 7395, "user_id": 228371, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3b903cad68504ad4cb4df51b8e8636b7?s=128&d=identicon&r=PG", "display_name": "Freiheit", "link": "https://stackoverflow.com/users/228371/freiheit"}, "is_accepted": true, "score": 2, "last_activity_date": 1561670075, "creation_date": 1561670075, "answer_id": 56798546, "question_id": 56798459, "link": "https://stackoverflow.com/questions/56798459/using-random-numbers-vs-hardcoded-values-in-unit-tests/56798546#56798546", "title": "Using random numbers vs hardcoded values in unit tests", "body": "<p>Your question is not specific to Go. This applies to any language and really any kind of unit testing.</p>\n\n<blockquote>\n  <p>the expected value for the test needs to be calculated from the random values.</p>\n</blockquote>\n\n<p>That is the major problem. If you have even moderately complicated application logic when the logic changes in the application, you also have to change that same logic in your tests. You have to implement those changes TWICE.</p>\n\n<p>Presumably each one is equally complex <em>and</em> each one is implemented somewhat differently because if you're just copy-pasting or reusing code from your app in your test to compute the expected value, then they're going to agree and the test is pointless.</p>\n\n<p>Testing with fixed values in your unit tests keeps the tests simple and exercises the code.</p>\n\n<p>Testing with random values is done, its called <a href=\"https://en.wikipedia.org/wiki/Fuzzing\" rel=\"nofollow noreferrer\">fuzzing</a>. I am not an expert in fuzzing in tests. Testing with random values is one aspect of fuzzing but the nuance is in testing random values that are likely to find edge cases, catch bugs, exercise unused code branches, or uncover leaks. </p>\n"}], "owner": {"reputation": 5142, "user_id": 169252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f87a0e2badc0703de4d0a171a9bb4fa5?s=128&d=identicon&r=PG&f=1", "display_name": "transient_loop", "link": "https://stackoverflow.com/users/169252/transient-loop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "closed_date": 1561677967, "accepted_answer_id": 56798546, "answer_count": 1, "score": -4, "last_activity_date": 1561677992, "creation_date": 1561669525, "question_id": 56798459, "link": "https://stackoverflow.com/questions/56798459/using-random-numbers-vs-hardcoded-values-in-unit-tests", "closed_reason": "Duplicate", "title": "Using random numbers vs hardcoded values in unit tests", "body": "<p>When I write tests, I like to use random numbers to calculate things.</p>\n\n<p>e.g.</p>\n\n<pre><code> func init() {\n   rand.Seed(time.Now().UnixNano())\n }\n\n  func TestXYZ(t *testing.T) {\n     amount := rand.Intn(100)\n     cnt := 1 + rand.Intn(10)\n     for i := 0; i &lt; cnt; i++ {\n       doSmth(amount)\n     }\n     //more stuff\n  }\n</code></pre>\n\n<p>which of course has the disadvantage that </p>\n\n<pre><code>expected := calcExpected(amount, cnt)\n</code></pre>\n\n<p>in that the expected value for the test needs to be calculated from the random values.</p>\n\n<p>If have received criticism for this approach:</p>\n\n<ul>\n<li>It makes the test unnecessarily complex</li>\n<li>Less reproduceable due to randomness</li>\n</ul>\n\n<p>I think though that without randomness, I could actually:</p>\n\n<ul>\n<li>Make up my results, e.g. the test only works for a specific value. Randomness proves my test is \"robust\"</li>\n<li>Catch more edge cases (debatable as edge cases are usually specific, e.g. 0,1,-1)</li>\n</ul>\n\n<p>Is it really that bad to use random numbers?</p>\n\n<p>(I realize this is a bit of an opinion question, but I am very much interested in people's point of views, don't mind downvotes).</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5017196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082c943310fdd05d1d0fb195e8889aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5017196/max"}, "edited": false, "score": 0, "creation_date": 1561672534, "post_id": 56798842, "comment_id": 100152398, "body": "Thanks iokevins! I am sorry I forgot to mention the file is processing logs, which could be in TB. Is there a way to use less memory just like grep?"}, {"owner": {"reputation": 1203, "user_id": 182742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/441ebb2aff0bbfed3949bef6cf573e5a?s=128&d=identicon&r=PG", "display_name": "iokevins", "link": "https://stackoverflow.com/users/182742/iokevins"}, "reply_to_user": {"reputation": 29, "user_id": 5017196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082c943310fdd05d1d0fb195e8889aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5017196/max"}, "edited": false, "score": 0, "creation_date": 1561676069, "post_id": 56798842, "comment_id": 100153228, "body": "@Max Answer updated to show line-by-line streaming scan using bufio.Scanner. Note: By default, Text() returns each line of text, stripped of any trailing end-of-line marker (either LF or CRLF)."}, {"owner": {"reputation": 29, "user_id": 5017196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082c943310fdd05d1d0fb195e8889aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5017196/max"}, "edited": false, "score": 0, "creation_date": 1561676113, "post_id": 56798842, "comment_id": 100153234, "body": "Cool! that is exactly what I need. Thanks!"}, {"owner": {"reputation": 29, "user_id": 5017196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082c943310fdd05d1d0fb195e8889aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5017196/max"}, "edited": false, "score": 0, "creation_date": 1561677750, "post_id": 56798842, "comment_id": 100153530, "body": "Sounds great! based on the output, I can use io.seek to read any part of the large file. Is it the best practice?"}, {"owner": {"reputation": 1203, "user_id": 182742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/441ebb2aff0bbfed3949bef6cf573e5a?s=128&d=identicon&r=PG", "display_name": "iokevins", "link": "https://stackoverflow.com/users/182742/iokevins"}, "reply_to_user": {"reputation": 29, "user_id": 5017196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082c943310fdd05d1d0fb195e8889aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5017196/max"}, "edited": false, "score": 0, "creation_date": 1561731385, "post_id": 56798842, "comment_id": 100171227, "body": "@Max Either that or bufio package, which has additional reader helper functions: <a href=\"https://golang.org/pkg/bufio/\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio</a>"}], "tags": [], "owner": {"reputation": 1203, "user_id": 182742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/441ebb2aff0bbfed3949bef6cf573e5a?s=128&d=identicon&r=PG", "display_name": "iokevins", "link": "https://stackoverflow.com/users/182742/iokevins"}, "is_accepted": true, "score": 1, "last_activity_date": 1561731143, "last_edit_date": 1561731143, "creation_date": 1561672161, "answer_id": 56798842, "question_id": 56798431, "link": "https://stackoverflow.com/questions/56798431/find-byte-offset-of-a-pattern-in-golang/56798842#56798842", "title": "Find byte offset of a pattern in Golang", "body": "<p><a href=\"https://golang.org/pkg/regexp/#Regexp.FindAllStringIndex\" rel=\"nofollow noreferrer\">FindAllStringIndex(s string, n int)</a> returns byte start/finish indexes (i.e., slices) of all successive matches of the expression:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"io/ioutil\"\nimport \"regexp\"\n\nfunc main() {\n    fname := \"C:\\\\Users\\\\UserName\\\\go\\\\src\\\\so56798431\\\\fname\"\n    b, err := ioutil.ReadFile(fname)\n    if err != nil {\n      panic(err)\n    }\n\n    re, err := regexp.Compile(\"findme\")\n    if err != nil {\n      // handle error\n    }\n    fmt.Println(re.FindAllStringIndex(string(b), -1))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>[[12 18] [32 38]]</p>\n</blockquote>\n\n<p>Note: I did this on Microsoft Windows, but saved the file in UNIX format (linefeed); if input file saved in Windows format (carriage return &amp; linefeed) the byte offsets would increment to 13 and 35, respectively.</p>\n\n<p>UPDATE: for large files, use <a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow noreferrer\">bufio.Scanner</a>; for example:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"regexp\"\n)\n\nfunc main() {\n    fname, err := os.Open(\"C:\\\\Users\\\\UserName\\\\go\\\\src\\\\so56798431\\\\fname\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer fname.Close()\n\n    re, err := regexp.Compile(\"findme\")\n    if err != nil {\n      // handle error\n    }\n\n    scanner := bufio.NewScanner(fname)\n    bytesRead := 0\n    for scanner.Scan() {\n        b := scanner.Text()\n        //fmt.Println(b)\n        results := re.FindAllStringIndex(b, -1)\n        for _, result := range results {\n            fmt.Println(bytesRead + result[0])\n        }\n        // account for UNIX EOL marker\n        bytesRead += len(b) + 1\n    }\n\n    if err := scanner.Err(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>12 </p>\n  \n  <p>32</p>\n</blockquote>\n"}], "owner": {"reputation": 29, "user_id": 5017196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082c943310fdd05d1d0fb195e8889aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5017196/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 56798842, "answer_count": 1, "score": 0, "last_activity_date": 1561731143, "creation_date": 1561669331, "last_edit_date": 1561672607, "question_id": 56798431, "link": "https://stackoverflow.com/questions/56798431/find-byte-offset-of-a-pattern-in-golang", "title": "Find byte offset of a pattern in Golang", "body": "<p>We can find the byte offset of a pattern from file by\n\"grep -ob pattern filename\";\nHowever, <code>grep</code> is not <code>utf8</code> safe. \nHow do I find byte offset of a pattern in Go? The file is process log, which can be in TB. </p>\n\n<p>This is what I want to get in Go:</p>\n\n<pre><code>$ cat fname\nhello world\nfindme\nhello \u4e16\u754c\nfindme again\n</code></pre>\n\n<p>...</p>\n\n<pre><code>$ grep -ob findme fname\n\n12:findme\n32:findme\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 1, "creation_date": 1561667727, "post_id": 56798096, "comment_id": 100150883, "body": "Hi @Jhon, trying to figure out what you need here - is <code>cfg</code> another map of string? Are you trying to take a part of the <code>abc:9, bar:3</code> and put it into some key of the <code>lsd</code> variable? is <code>abc:9, bar:3</code> a representation of a <code>map[string]int</code> perhaps?"}, {"owner": {"reputation": 659, "user_id": 11154975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80600b309fa55c4e26eec31d7e083fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Jhon D", "link": "https://stackoverflow.com/users/11154975/jhon-d"}, "reply_to_user": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1561667861, "post_id": 56798096, "comment_id": 100150935, "body": "@Slabgorb , hi, <code>cfg</code> is type <code>cfg := map[string]string{}</code>"}, {"owner": {"reputation": 659, "user_id": 11154975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80600b309fa55c4e26eec31d7e083fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Jhon D", "link": "https://stackoverflow.com/users/11154975/jhon-d"}, "reply_to_user": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1561668067, "post_id": 56798096, "comment_id": 100150996, "body": "@Slabgorb - im trying to put inside the <code>lsd</code> the value from <code>&quot;abc:9, bar:3&quot;</code>"}, {"owner": {"reputation": 659, "user_id": 11154975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80600b309fa55c4e26eec31d7e083fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Jhon D", "link": "https://stackoverflow.com/users/11154975/jhon-d"}, "reply_to_user": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1561669229, "post_id": 56798096, "comment_id": 100151395, "body": "@Slabgorb - please see my update"}], "answers": [{"comments": [{"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 1, "creation_date": 1561670431, "post_id": 56798561, "comment_id": 100151774, "body": "Some gotchas: I am splitting on &quot;, &quot;, if you are not sure whether you will get a space or not, you may need to split on &quot;,&quot; then <code>strings.TrimSpace</code> before you split on &quot;:&quot;."}], "tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": true, "score": 2, "last_activity_date": 1561670166, "creation_date": 1561670166, "answer_id": 56798561, "question_id": 56798096, "link": "https://stackoverflow.com/questions/56798096/update-mapstringint-from-string-value/56798561#56798561", "title": "update map[string]int from string value", "body": "<p>This is a tiny bit cheesy but I was having trouble making fmt.Sscanf grok the pattern, so I am just splitting again. And you may have been missing <code>strconv</code> - <code>strconv.Atoi</code> is a quick converter.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    lsd := make(map[string]int)\n    toParse := \"abc:5, foo:5\"\n    parts := strings.Split(toParse, \", \")\n    for _, p := range parts {\n\n        results := strings.SplitN(p, \":\", 2)\n        val, err := strconv.Atoi(results[1])\n        if err != nil {\n            panic(err)  //probably want to do somethig better\n        }\n        lsd[results[0]] = val\n    }\n\n    fmt.Printf(\"%#v\", lsd)\n}\n</code></pre>\n\n<blockquote>\n  <p>map[string]int{\"abc\":5, \"foo\":5}</p>\n</blockquote>\n\n<p><a href=\"https://play.golang.org/p/UadibEzTXWU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/UadibEzTXWU</a></p>\n"}], "owner": {"reputation": 659, "user_id": 11154975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80600b309fa55c4e26eec31d7e083fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Jhon D", "link": "https://stackoverflow.com/users/11154975/jhon-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "closed_date": 1561718978, "accepted_answer_id": 56798561, "answer_count": 1, "score": -3, "last_activity_date": 1561731899, "creation_date": 1561667299, "last_edit_date": 1561731899, "question_id": 56798096, "link": "https://stackoverflow.com/questions/56798096/update-mapstringint-from-string-value", "closed_reason": "Needs details or clarity", "title": "update map[string]int from string value", "body": "<p>I am trying to parse a json-like string which looks like this.</p>\n\n<p><code>\"abc:9, bar:3\"</code></p>\n\n<p>What I would like to have at the end is a <code>map[string]int</code> which looks like this:</p>\n\n<p><code>map[string]int{\"abc\":9, \"bar\":3}</code></p>\n\n<p>I have gotten as far as splitting it into a set of 'pairs', like so:</p>\n\n<p>`[\"abc:9\", \"bar:3\"] </p>\n\n<p>I am struggling with how to get that structure into the final <code>map[string]int</code>. I have tried ranging over the slice, but I am missing how to actually get it into the map.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>        val := \"abc:9, bar:3\"\n        lsd := make(map[string]int)\n        c := strings.Split(val, \",\")\n        for k, v := range c {\n            lsd = v[k] // where I am struggling, I know this is wrong, but I can't seem to find the proper syntax and tools for this\n        }\n</code></pre>\n\n<p>Can anyone point me in the right direction to end up with the map[string]int I am looking for here?</p>\n"}, {"tags": ["go", "kubernetes", "kubectl"], "comments": [{"owner": {"reputation": 19477, "user_id": 684908, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/18c7c8d0b7809e307991bfacc16470d0?s=128&d=identicon&r=PG", "display_name": "Andy Shinn", "link": "https://stackoverflow.com/users/684908/andy-shinn"}, "edited": false, "score": 1, "creation_date": 1561658380, "post_id": 56796352, "comment_id": 100147417, "body": "I&#39;d like to point out that STDERR shouldn&#39;t necessarily be considered <i>wrong</i> here. Consider this: You are using a tool in which users may process the output (STDOUT). They may be piping the output to or from scripts. If your prompted information was sent to STDOUT it would not only get swallowed by the script / pipe but possibly cause downstream script issues. When prompted on STDERR it allows the user to see it, enter the required information, and let the command continue in the script / pipe as it would normally without extra information in the stream."}, {"owner": {"reputation": 198, "user_id": 617122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4301f34f9b322cdcc901e680c0cd81e4?s=128&d=identicon&r=PG", "display_name": "distortedsignal", "link": "https://stackoverflow.com/users/617122/distortedsignal"}, "reply_to_user": {"reputation": 19477, "user_id": 684908, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/18c7c8d0b7809e307991bfacc16470d0?s=128&d=identicon&r=PG", "display_name": "Andy Shinn", "link": "https://stackoverflow.com/users/684908/andy-shinn"}, "edited": false, "score": 1, "creation_date": 1561665717, "post_id": 56796352, "comment_id": 100150203, "body": "I&#39;ll profess to being ignorant in the field of &quot;which output mechanism to use for user prompts&quot; - STDERR may be correct here. This makes me curious as to why the designers of many command line tools don&#39;t, then, provide four output mechanisms - pipe out to users (or one level above), err out to users (or one level above), pipe out to me, and err out to me. This seems far more... dev friendly?  Eh, spare-time PR target."}, {"owner": {"reputation": 4962, "user_id": 11560878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ESrYf.png?s=128&g=1", "display_name": "Wytrzyma\u0142y Wiktor", "link": "https://stackoverflow.com/users/11560878/wytrzyma%c5%82y-wiktor"}, "edited": false, "score": 0, "creation_date": 1561985572, "post_id": 56796352, "comment_id": 100224405, "body": "@distortedsignal Is Andy&#39;s comment satisfactory enough to consider it an answer to your question?"}, {"owner": {"reputation": 198, "user_id": 617122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4301f34f9b322cdcc901e680c0cd81e4?s=128&d=identicon&r=PG", "display_name": "distortedsignal", "link": "https://stackoverflow.com/users/617122/distortedsignal"}, "reply_to_user": {"reputation": 4962, "user_id": 11560878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ESrYf.png?s=128&g=1", "display_name": "Wytrzyma\u0142y Wiktor", "link": "https://stackoverflow.com/users/11560878/wytrzyma%c5%82y-wiktor"}, "edited": false, "score": 0, "creation_date": 1562477162, "post_id": 56796352, "comment_id": 100381742, "body": "@OhHiMark - Not really? Andy&#39;s answer is a good workaround, but &quot;asking for a password is an error&quot; isn&#39;t a great answer (since, in my example, it&#39;s in the expected workflow). Does that make sense?"}, {"owner": {"reputation": 31937, "user_id": 2642204, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AIjBF.jpg?s=128&g=1", "display_name": "BartoszKP", "link": "https://stackoverflow.com/users/2642204/bartoszkp"}, "edited": false, "score": 0, "creation_date": 1567072235, "post_id": 56796352, "comment_id": 101857164, "body": "Could you make the example complete, self-contained so it compiles? It would be much easier to reproduce for people who know Kubernetes but are not fluent in Go."}, {"owner": {"reputation": 198, "user_id": 617122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4301f34f9b322cdcc901e680c0cd81e4?s=128&d=identicon&r=PG", "display_name": "distortedsignal", "link": "https://stackoverflow.com/users/617122/distortedsignal"}, "reply_to_user": {"reputation": 31937, "user_id": 2642204, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AIjBF.jpg?s=128&g=1", "display_name": "BartoszKP", "link": "https://stackoverflow.com/users/2642204/bartoszkp"}, "edited": false, "score": 0, "creation_date": 1567097126, "post_id": 56796352, "comment_id": 101871156, "body": "@BartoszKP There&#39;s a lot left out here because kubectl plugins are large. Check <a href=\"https://github.com/kubernetes/sample-cli-plugin\" rel=\"nofollow noreferrer\">github.com/kubernetes/sample-cli-plugin</a> for an example of the structure.  If you want to try this out for yourself, I would recommend making a kubectl plugin in Python and putting in a <code>print()</code> call. That should get you <i>most</i> of what I&#39;m trying to get at here.  EDIT: I had the dumb and hit &quot;Enter&quot; prematurely. Sorry about that."}, {"owner": {"reputation": 31937, "user_id": 2642204, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AIjBF.jpg?s=128&g=1", "display_name": "BartoszKP", "link": "https://stackoverflow.com/users/2642204/bartoszkp"}, "edited": false, "score": 1, "creation_date": 1567691975, "post_id": 56796352, "comment_id": 102045977, "body": "@distortedsignal Thanks! I&#39;ve reproduced the problem. I will give it a try."}, {"owner": {"reputation": 31937, "user_id": 2642204, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AIjBF.jpg?s=128&g=1", "display_name": "BartoszKP", "link": "https://stackoverflow.com/users/2642204/bartoszkp"}, "edited": false, "score": 0, "creation_date": 1568016361, "post_id": 56796352, "comment_id": 102126693, "body": "@distortedsignal Hm, actually this works for me on GKE. Will try to verify again for OSS K8s."}], "answers": [{"comments": [{"owner": {"reputation": 31937, "user_id": 2642204, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AIjBF.jpg?s=128&g=1", "display_name": "BartoszKP", "link": "https://stackoverflow.com/users/2642204/bartoszkp"}, "reply_to_user": {"reputation": 198, "user_id": 617122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4301f34f9b322cdcc901e680c0cd81e4?s=128&d=identicon&r=PG", "display_name": "distortedsignal", "link": "https://stackoverflow.com/users/617122/distortedsignal"}, "edited": false, "score": 0, "creation_date": 1568708771, "post_id": 57960045, "comment_id": 102350599, "body": "@distortedsignal Sorry for that - in the first version I needed to verify that this is indeed k8s version, not the GKE version I was trying before. I wanted to remove it from the answer because it&#39;s irrelevant, but forgot to remove it from the code."}], "tags": [], "owner": {"reputation": 31937, "user_id": 2642204, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AIjBF.jpg?s=128&g=1", "display_name": "BartoszKP", "link": "https://stackoverflow.com/users/2642204/bartoszkp"}, "is_accepted": true, "score": 1, "last_activity_date": 1568708709, "last_edit_date": 1592644375, "creation_date": 1568647597, "answer_id": 57960045, "question_id": 56796352, "link": "https://stackoverflow.com/questions/56796352/inside-kubectl-plugin-prompt-for-input/57960045#57960045", "title": "Inside kubectl plugin, prompt for input?", "body": "<p>Sorry I have no better answer than &quot;Works for me&quot; :-) Here are the steps:</p>\n<ul>\n<li><p><code>git clone https://github.com/kubernetes/kubernetes.git</code></p>\n</li>\n<li><p>duplicate <code>sample-cli-plugin</code> as <code>test-cli-plugin</code> (this involves fixing import-restrictions.yaml, rules-godeps.yaml and rules.yaml under staging/publishing - maybe not necessary, but it's safer this way)</p>\n</li>\n<li><p>change kubectl-ns.go to kubectl-test.go:</p>\n</li>\n</ul>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n        &quot;os&quot;\n\n        &quot;github.com/spf13/pflag&quot;\n\n        &quot;k8s.io/cli-runtime/pkg/genericclioptions&quot;\n        &quot;k8s.io/test-cli-plugin/pkg/cmd&quot;\n)\n\nfunc main() {\n        flags := pflag.NewFlagSet(&quot;kubectl-test&quot;, pflag.ExitOnError)\n        pflag.CommandLine = flags\n\n        root := cmd.NewCmdTest(genericclioptions.IOStreams{In: os.Stdin, \n                                                           Out: os.Stdout,\n                                                           ErrOut: os.Stderr})\n        if err := root.Execute(); err != nil {\n                os.Exit(1)\n        }\n}\n</code></pre>\n<ul>\n<li>change ns.go to test.go:</li>\n</ul>\n<pre class=\"lang-golang prettyprint-override\"><code>package cmd\n\nimport (\n        &quot;fmt&quot;\n        &quot;os&quot;\n\n        &quot;github.com/spf13/cobra&quot;\n\n        &quot;k8s.io/cli-runtime/pkg/genericclioptions&quot;\n)\n\ntype TestOptions struct {\n        configFlags *genericclioptions.ConfigFlags\n        genericclioptions.IOStreams\n}\n\nfunc NewTestOptions(streams genericclioptions.IOStreams) *TestOptions {\n        return &amp;TestOptions{\n                configFlags: genericclioptions.NewConfigFlags(true),\n                IOStreams:   streams,\n        }\n}\n\nfunc NewCmdTest(streams genericclioptions.IOStreams) *cobra.Command {\n        o := NewTestOptions(streams)\n\n        cmd := &amp;cobra.Command{\n                Use:          &quot;test&quot;,\n                Short:        &quot;Test plugin&quot;,\n                SilenceUsage: true,\n                RunE: func(c *cobra.Command, args []string) error {\n                        o.Run()\n                        return nil\n                },\n        }\n\n        return cmd\n}\n\nfunc (o *TestOptions) Run() error {\n        fmt.Fprintf(os.Stderr, &quot;Testing Fprintf Stderr\\n&quot;)\n        fmt.Fprintf(os.Stdout, &quot;Testing Fprintf Stdout\\n&quot;)\n        fmt.Printf(&quot;Testing Printf\\n&quot;)\n        fmt.Fprintf(o.IOStreams.Out, &quot;Testing Fprintf o.IOStreams.Out\\n&quot;)\n        return nil\n}\n</code></pre>\n<ul>\n<li>fix BUILD files accordingly</li>\n<li>build the plugin</li>\n<li>run <code>make</code></li>\n<li>copy <code>kubectl-test</code> to /usr/local/bin</li>\n<li>run the compiled <code>kubectl</code> binary:</li>\n</ul>\n<blockquote>\n<p>~/k8s/_output/bin$ ./kubectl test</p>\n<p>Testing Fprintf Stderr</p>\n<p>Testing Fprintf Stdout</p>\n<p>Testing Printf</p>\n<p>Testing Fprintf o.IOStreams.Out</p>\n</blockquote>\n"}], "owner": {"reputation": 198, "user_id": 617122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4301f34f9b322cdcc901e680c0cd81e4?s=128&d=identicon&r=PG", "display_name": "distortedsignal", "link": "https://stackoverflow.com/users/617122/distortedsignal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 57960045, "answer_count": 1, "score": 0, "last_activity_date": 1568708709, "creation_date": 1561657899, "question_id": 56796352, "link": "https://stackoverflow.com/questions/56796352/inside-kubectl-plugin-prompt-for-input", "title": "Inside kubectl plugin, prompt for input?", "body": "<p>I'm writing a <code>kubectl</code> plugin to authenticate users, and I would like to prompt the user for a password after the plugin is invoked. From what I understand, it's fairly trivial to get input from STDIN, but I'm struggling seeing messages written to STDOUT. Currently my code looks like this:</p>\n\n<p>In cmd/kubectl-myauth.go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// This is mostly boilerplate, but it's needed for the MRE\n// https://stackoverflow.com/help/minimal-reproducible-example\npackage myauth\nimport (...)\nfunc main() {\n    pflag.CommandLine = pflag.NewFlagSet(\"kubectl-myauth\", pflag.ExitOnError)\n    root := cmd.NewCmdAuthOp(genericclioptions.IOStreams{In: os.Stdin, Out: os.Stdout, ErrOut: os.Stderr})\n    if err := root.Execute(); err != nil {\n        os.Exit(1)\n    }\n}\n</code></pre>\n\n<p>In pkg/cmd/auth.go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package cmd\n...\ntype AuthOpOptions struct {\n    configFlags *genericclioptions.ConfigFlags\n    resultingContext *api.Context\n    rawConfig       api.Config\n    args            []string\n    ...\n    genericclioptions.IOStreams\n}\nfunc NewAuthOpOptions(streams genericclioptions.IOStreams) *AuthOpOptions {\n    return &amp;AuthOpOptions{\n        configFlags: genericclioptions.NewConfigFlags(true),\n        IOStreams: streams,\n    }\n}\nfunc NewCmdAuthOp(streams genericclioptions.IOStreams) *cobra.Command {\n    o := NewAuthOpOptions(streams)\n    cmd := &amp;cobra.Command{\n        RunE: func(c *cobra.Command, args []string) error {\n            return o.Run()\n        },\n    }\n    return cmd\n}\nfunc (o *AuthOpOptions) Run() error {\n    pass, err := getPassword(o)\n    if err != nil {\n        return err\n    }\n    // Do Auth Stuff\n    // Eventually print an ExecCredential to STDOUT\n    return nil\n}\nfunc getPassword(o *AuthOpOptions) (string, error) {\n    var reader *bufio.Reader\n    reader = nil\n    pass := \"\"\n    for pass == \"\" {\n        // THIS IS AN IMPORTANT LINE [1]\n        fmt.Fprintf(o.IOStreams.Out, \"Password with which to authenticate:\\n\")\n        // THE REST OF THIS IS STILL IMPORTANT, BUT LESS SO [2]\n        if reader == nil {\n            // The first time through, initialize the reader\n            reader = bufio.NewReader(o.IOStreams.In)\n        }\n        pass, err := reader.ReadString('\\n')\n        if err != nil {\n            return nil, err\n        }\n        pass = strings.Trim(pass, \"\\r\\n\")\n        if pass == \"\" {\n            // ALSO THIS LINE IS IMPORTANT [3]\n            fmt.Fprintf(o.IOStreams.Out, `Read password was empty string.\nPlease input a valid password.\n`)\n        }\n    }\n    return pass, nil\n}\n</code></pre>\n\n<p>This works the way that I expect when running from outside of the <code>kubectl</code> context - namely, it prints the string, prompts for input, and continues. However, from inside the <code>kubectl</code> context, I believe the print between the first two all-caps comments ([1] and [2]) is being swallowed by <code>kubectl</code> listening on STDOUT. I can get around this by printing to STDERR, but that feels... wrong. Is there a way that I can bypass <code>kubectl</code>'s consumption of STDOUT to communicate with the user?</p>\n\n<p>TL;DR: <code>kubectl</code> appears to be swallowing all of STDOUT for <code>kubectl</code> plugins, but I want to prompt the user for input - is there a simple way to do this?</p>\n"}, {"tags": ["go", "url", "mux"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 3, "creation_date": 1561652493, "post_id": 56795139, "comment_id": 100144934, "body": "GET request contains no body, are you trying to fetch params from URL ?"}, {"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1561658254, "post_id": 56795139, "comment_id": 100147366, "body": "Have you tried to check error returned by <code>func (r *Request) ParseForm() error</code>?"}, {"owner": {"reputation": 6744, "user_id": 4142753, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/9ynfx.png?s=128&g=1", "display_name": "BilalReffas", "link": "https://stackoverflow.com/users/4142753/bilalreffas"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1561665587, "post_id": 56795139, "comment_id": 100150159, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 Well it\u2018s still possible that req.Form is parsing the content when using ?a=b for example as a query"}], "answers": [{"comments": [{"owner": {"reputation": 6744, "user_id": 4142753, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/9ynfx.png?s=128&g=1", "display_name": "BilalReffas", "link": "https://stackoverflow.com/users/4142753/bilalreffas"}, "edited": false, "score": 0, "creation_date": 1561665505, "post_id": 56797770, "comment_id": 100150135, "body": "Thanks!:) So I have to parse it to get the id of an user right?"}, {"owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "reply_to_user": {"reputation": 6744, "user_id": 4142753, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/9ynfx.png?s=128&g=1", "display_name": "BilalReffas", "link": "https://stackoverflow.com/users/4142753/bilalreffas"}, "edited": false, "score": 0, "creation_date": 1561667913, "post_id": 56797770, "comment_id": 100150953, "body": "@BilalReffas, right, see here: <a href=\"https://stackoverflow.com/questions/34314975/go-get-path-parameters-from-http-request\" title=\"go get path parameters from http request\">stackoverflow.com/questions/34314975/&hellip;</a> Or there are many libraries out there that can make this much easier"}, {"owner": {"reputation": 6744, "user_id": 4142753, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/9ynfx.png?s=128&g=1", "display_name": "BilalReffas", "link": "https://stackoverflow.com/users/4142753/bilalreffas"}, "edited": false, "score": 0, "creation_date": 1561667955, "post_id": 56797770, "comment_id": 100150965, "body": "Thanks! Going to build my own then :)"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 1, "last_activity_date": 1561665264, "creation_date": 1561665264, "answer_id": 56797770, "question_id": 56795139, "link": "https://stackoverflow.com/questions/56795139/request-form-is-returning-nil/56797770#56797770", "title": "Request Form is returning nil", "body": "<p>According to the documentation, <code>req.Form</code> should always be updated if you call <code>req.ParseForm</code>.</p>\n\n<blockquote>\n  <p>For all requests, ParseForm parses the raw query from the URL and updates r.Form.</p>\n</blockquote>\n\n<p>Moreover, if you take a look at the implementation of ParseForm, it does not seem to be possible for it to be <code>nil</code> after the method is executed.</p>\n\n<p><a href=\"https://github.com/golang/go/blob/master/src/net/http/request.go#L1238\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/net/http/request.go#L1238</a></p>\n\n<p>What can indeed happen is that <code>req.Form</code> ends up being an empty map, perhaps that's what you are seeing there.</p>\n\n<p>It makes sense for it to be empty if you are doing:</p>\n\n<p><code>GET http://localhost:8080/users/3</code></p>\n\n<p>Since that has no params for <code>ParseForm</code> to actually parse, so <code>req.Form</code> will end up being an empty map.</p>\n\n<p>If you try this for example:</p>\n\n<p><code>GET http://localhost:8080/users/3?a=b</code></p>\n\n<p>Then you should get an entry in the map with <code>\"a\"</code> as a key and <code>[\"b\"]</code> as the value.</p>\n"}], "owner": {"reputation": 6744, "user_id": 4142753, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/9ynfx.png?s=128&g=1", "display_name": "BilalReffas", "link": "https://stackoverflow.com/users/4142753/bilalreffas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 56797770, "answer_count": 1, "score": 0, "last_activity_date": 1561665264, "creation_date": 1561652308, "question_id": 56795139, "link": "https://stackoverflow.com/questions/56795139/request-form-is-returning-nil", "title": "Request Form is returning nil", "body": "<p>I'm learning golang and tried to implement a custom mix to get familiar with the language, unfortunately <code>req.Form</code> is returning <code>nil</code>.</p>\n\n<p>Of course I'm running before <code>req.ParseForm()</code>.</p>\n\n<pre><code>func (r *Router) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    req.ParseForm()\n    params := req.Form\n    node, _ := r.tree.findNode(strings.Split(req.URL.Path, \"/\")[1:], params)\n    if handler := node.methods[req.Method]; handler != nil {\n        handler(w, req, params)\n    }\n}\n</code></pre>\n\n<p>This is the example URL I'm using via <code>GET http://localhost:8080/users/3</code></p>\n"}, {"tags": ["docker", "go", "environment-variables", "gitlab"], "answers": [{"comments": [{"owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1561648933, "post_id": 56794080, "comment_id": 100143053, "body": "thanks but... - env=&quot;root:rootroot@tcp(mysql:3306)/TESTDB&quot; i changed it like that but  still get the error."}, {"owner": {"reputation": 519, "user_id": 5724776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9426a681b8caf7e8c70dfbc9caf737?s=128&d=identicon&r=PG", "display_name": "seddikomar", "link": "https://stackoverflow.com/users/5724776/seddikomar"}, "reply_to_user": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1561650244, "post_id": 56794080, "comment_id": 100143823, "body": "The error is it the same ? Are you creating TESTDB during CI ?"}, {"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1561661836, "post_id": 56794080, "comment_id": 100148836, "body": "does the error still include <code>dial tcp 127.0.0.1:3306</code> ?"}, {"owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1561704772, "post_id": 56794080, "comment_id": 100158744, "body": "yes but i do not know where :( it is getting that from"}], "tags": [], "owner": {"reputation": 519, "user_id": 5724776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9426a681b8caf7e8c70dfbc9caf737?s=128&d=identicon&r=PG", "display_name": "seddikomar", "link": "https://stackoverflow.com/users/5724776/seddikomar"}, "is_accepted": false, "score": 1, "last_activity_date": 1561710566, "last_edit_date": 1561710566, "creation_date": 1561648285, "answer_id": 56794080, "question_id": 56793930, "link": "https://stackoverflow.com/questions/56793930/my-pipeline-will-not-let-me-connect-via-golang-although-it-works-in-dev-environ/56794080#56794080", "title": "My pipeline will not let me connect via golang, although it works in dev environment", "body": "<p>You should use:</p>\n\n<blockquote>\n  <p>mysql</p>\n</blockquote>\n\n<p>instead of:</p>\n\n<blockquote>\n  <p>localhost</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1561706414, "post_id": 56794772, "comment_id": 100159463, "body": "Thanks, however i tried all 4 of these and i still get exact same error :("}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1561710110, "post_id": 56794772, "comment_id": 100160956, "body": "That&#39;s a problem with your code then. If you look at the output of <a href=\"https://linux.die.net/man/1/env\" rel=\"nofollow noreferrer\"><code>env</code></a> you&#39;ll see it&#39;s there. If the tests are still trying to connect to localhost there&#39;s something else going on."}, {"owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1561712007, "post_id": 56794772, "comment_id": 100161843, "body": "ok my environment var was called in &quot;MCS&quot; in my code i was using env as i thought is was Linux command to set an environment variable no idea why i thought i could not give it  a name :-|"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1561650880, "creation_date": 1561650880, "answer_id": 56794772, "question_id": 56793930, "link": "https://stackoverflow.com/questions/56793930/my-pipeline-will-not-let-me-connect-via-golang-although-it-works-in-dev-environ/56794772#56794772", "title": "My pipeline will not let me connect via golang, although it works in dev environment", "body": "<p>As Seddik pointed out already, localhost isn't the host that the MySQL server will be listening on; it will be available under the name <code>mysql</code>.</p>\n\n<p>Additionally, the command <code>env=\"root:rootroot@tcp(localhost:3306)/TESTDB\"</code> sets a local variable in the shell. It does not affect the environment variables.</p>\n\n<p>To set an environment variable either </p>\n\n<ul>\n<li><code>export</code> the local variable</li>\n<li>or use the <code>variables</code> dictionary</li>\n<li>or set the variable specifically for the <code>go test</code> command:</li>\n</ul>\n\n<pre><code>variables:\n  # Set your variable here for all jobs ...\n  env: root:rootroot@tcp(mysql:3306)/TESTDB \n\nbefore_script:\n  # ... or export it here ...\n  - export env=root:rootroot@tcp(mysql:3306)/TESTDB\n\ntest:\n  services:\n    - mysql:5.7\n  variables:\n    # ... or set it here for this job only ...\n    env: root:rootroot@tcp(mysql:3306)/TESTDB\n\n  script:\n    # ... or set it here for the go command only\n    - env=root:rootroot@tcp(mysql:3306)/TESTDB go test ./...\n\n\n</code></pre>\n"}], "owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 56794772, "answer_count": 2, "score": 0, "last_activity_date": 1561710566, "creation_date": 1561647805, "question_id": 56793930, "link": "https://stackoverflow.com/questions/56793930/my-pipeline-will-not-let-me-connect-via-golang-although-it-works-in-dev-environ", "title": "My pipeline will not let me connect via golang, although it works in dev environment", "body": "<p>I have a .gitlab-ci.yml file that uses the golang image and the MySql image later as a service...</p>\n\n<p>gilab-ci.yml...</p>\n\n<pre><code>stages:\n  - test\n  - build\n  - art\n\nimage: golang:1.9.2  \n\n\n\nvariables:\n  BIN_NAME: alltools\n  ARTIFACTS_DIR: artifacts\n  GO_PROJECT: alltools\n  GOPATH: /go\n\n\nbefore_script:\n  - mkdir -p ${GOPATH}/src/${GO_PROJECT}\n  - mkdir -p ${CI_PROJECT_DIR}/${ARTIFACTS_DIR}\n  - go get -u github.com/golang/dep/cmd/dep\n  - go get -u github.com/fatih/color\n  - go get -u github.com/go-sql-driver/mysql\n  - cp -r ${CI_PROJECT_DIR}/* ${GOPATH}/src/${GO_PROJECT}/\n  - cd ${GOPATH}/src/${GO_PROJECT}\n  - env=\"root:rootroot@tcp(localhost:3306)/TESTDB\"\n\ntest:\n  stage: test\n  services:\n    - mysql:5.7\n  variables:\n    # Configure mysql environment variables (https://hub.docker.com/_/mysql/)\n    # MYSQL_DATABASE: mydb\n    MYSQL_ROOT_PASSWORD: rootroot\n\n  script:\n    # Run all tests         \n\n    go test ./...\n\n\nbuild:\n  stage: build\n\n  script:\n    # Compile and name the binary as `hello`\n    - go build -o alltools\n    - pwd\n    - ls -l alltools\n    # Execute the binary\n    - ./alltools\n    # Move to gitlab build directory\n    - mv ./alltools ${CI_PROJECT_DIR}\n  artifacts:\n    paths:\n      - ./alltools\n</code></pre>\n\n<p>I also have a test in my go app which works fine on my dev machine, As you will see above I have set and enviroment varable in the gitlab-ci.yml file(this matches my dev enviroment.</p>\n\n<blockquote>\n  <ul>\n  <li>env=\"root:rootroot@tcp(localhost:3306)/TESTDB\" </li>\n  </ul>\n</blockquote>\n\n<p>But When i run my pipeline i get the following error...</p>\n\n<blockquote>\n  <p>$ env=\"root:rootroot@tcp(localhost:3306)/TESTDB\" $ go test ./... ?<br>\n    alltools    [no test files] ?       alltools/BBData [no test files] dial\n  tcp 127.0.0.1:3306: getsockopt: connection refused</p>\n</blockquote>\n\n<p>Do I need to change the environment variable in the gitlab-ci.yml file?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1561641842, "post_id": 56791811, "comment_id": 100138510, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42022392/go-template-use-nested-structs-field-and-range-tag-together\">Go Template : Use nested struct&#39;s field and {{range}} tag together</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 11635848, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lASQJQa3FXM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdUi2GVxCUmZy9a5vwCjCmVVg08RQ/mo/photo.jpg?sz=128", "display_name": "Tilemachos Valkaniotis", "link": "https://stackoverflow.com/users/11635848/tilemachos-valkaniotis"}, "is_accepted": true, "score": 0, "last_activity_date": 1561701861, "creation_date": 1561701861, "answer_id": 56801662, "question_id": 56791811, "link": "https://stackoverflow.com/questions/56791811/i-want-to-get-a-data-session-and-title-but-it-is-outside-the-loop-when-retrievin/56801662#56801662", "title": "I want to get a data session and title but it is outside the loop when retrieving data from the database", "body": "<p>Put all your data in a map and pass the map to the template. Something like this.</p>\n\n<pre><code>datamap := make(map[string]interface{})\ndatamap[\"title\"] = &lt;your title&gt;\ndatamap[\"session\"] = &lt;your session&gt;\ndatamap[\"sk\"] = &lt;your sk array&gt;\n</code></pre>\n\n<p>Then, on the template, access the fields like this.</p>\n\n<pre><code>&lt;p&gt;{{.title}}&lt;/p&gt;\n&lt;p&gt;{{.session}}&lt;/p&gt;\n{{range .sk}}\n&lt;p&gt;{{.Nama}}&lt;/p&gt;\n{{end}}\n</code></pre>\n\n<p>Note. This code is untested but i have solved your exact problem on a previous project of mine. Cheers</p>\n"}], "owner": {"reputation": 3, "user_id": 7367501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MWOOY.jpg?s=128&g=1", "display_name": "zhen_mubarak", "link": "https://stackoverflow.com/users/7367501/zhen-mubarak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56801662, "answer_count": 1, "score": 0, "last_activity_date": 1561701861, "creation_date": 1561641112, "question_id": 56791811, "link": "https://stackoverflow.com/questions/56791811/i-want-to-get-a-data-session-and-title-but-it-is-outside-the-loop-when-retrievin", "title": "I want to get a data session and title but it is outside the loop when retrieving data from the database", "body": "<p>I have taken all the data from the database then the data is in a loop. Apart from the looping that happened, I want to insert other data such as Session, and Title. Then I put it into the template.</p>\n\n<p>I have a guess for using struct or slice, but I can't find a solution after learning it.</p>\n\n<pre><code>type Sekolah struct {\n  Id int\n  Nama string\n  Alamat string\n  Telp string \n}\n</code></pre>\n\n<p>I have a struct like the one above, then I make the handle function</p>\n\n<pre><code>http.HandleFunc(\"/sekolah\", func(w http.ResponseWriter, r *http.Request) {\n\n//THIS IS THE DATA I WANT TO SERVE IN TEMPLATE\nvar title := \"Some Title\"\nvar session := \"MySession\"\n\n    db, errdb := sql.Open(\"postgres\", koneksi)\n    if errdb != nil {\n        fmt.Println(errdb)\n    }\n\n    rows, err := db.Query(\"SELECT id, nama, alamat, telp FROM public.m_sekolah\")\n    if err != nil {\n        fmt.Println(err)\n        http.Error(w, \"there was an error\", http.StatusInternalServerError)\n        return\n    }\n\n    var id int\n    var nama string\n    var alamat string\n    var telp string\n    var sk []Sekolah\n\n    for rows.Next(){\n        err = rows.Scan(&amp;id, &amp;nama, &amp;alamat, &amp;telp)\n        if err != nil {\n            fmt.Println(err)\n            http.Error(w, \"There was an error\", http.StatusInternalServerError)\n            return\n        }\n\n        sk = append(sk, Sekolah{Id: id, Nama: nama, Alamat: alamat, Telp: telp})\n    }\n\n    err = tmpl.ExecuteTemplate(w, \"data_sekolah\", sk)\n    if err != nil {\n        fmt.Println(err)\n    }\n})\n</code></pre>\n\n<p>I want to enter Title and Session data into the SK data but do not participate in the loop, then I want to paste it into the template. Can anyone help me?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1561635107, "post_id": 56790009, "comment_id": 100134388, "body": "Just do not embed pointer  types."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1561637700, "post_id": 56790009, "comment_id": 100135772, "body": "You seem to have a problem with the <code>mealResponse</code> type, why haven&#39;t you included its definition in the question?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 1, "creation_date": 1561638150, "post_id": 56790009, "comment_id": 100136050, "body": "I assume <code>mealResponse</code> is actually <code>mealMain</code> struct, correct?"}, {"owner": {"reputation": 408, "user_id": 9826697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pu78FyghZgI/AAAAAAAAAAI/AAAAAAAAAIE/AM4Xk2-XPaU/photo.jpg?sz=128", "display_name": "Rizki Hadiaturrasyid", "link": "https://stackoverflow.com/users/9826697/rizki-hadiaturrasyid"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1561640354, "post_id": 56790009, "comment_id": 100137493, "body": "@mkopriva I made a mistake when writing the question, it should have been mealMain"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1561641878, "post_id": 56790009, "comment_id": 100138535, "body": "@RizkiHadiaturrasyid: adjusted my answer accordingly"}], "answers": [{"comments": [{"owner": {"reputation": 408, "user_id": 9826697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pu78FyghZgI/AAAAAAAAAAI/AAAAAAAAAIE/AM4Xk2-XPaU/photo.jpg?sz=128", "display_name": "Rizki Hadiaturrasyid", "link": "https://stackoverflow.com/users/9826697/rizki-hadiaturrasyid"}, "edited": false, "score": 0, "creation_date": 1561646770, "post_id": 56790990, "comment_id": 100141724, "body": "Thank you. I ended up removing the * from Meal inside mealMain struct and it works fine. Also tried your solution and it works too. I think I need to learn more about pointers and initialization."}, {"owner": {"reputation": 408, "user_id": 9826697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pu78FyghZgI/AAAAAAAAAAI/AAAAAAAAAIE/AM4Xk2-XPaU/photo.jpg?sz=128", "display_name": "Rizki Hadiaturrasyid", "link": "https://stackoverflow.com/users/9826697/rizki-hadiaturrasyid"}, "edited": false, "score": 0, "creation_date": 1561701061, "post_id": 56790990, "comment_id": 100157440, "body": "Oh, I&#39;m wondering what is this assignment for? Meal: &amp;Meal{}, because when I use it like this Meal: &amp;model.Meal{}, it works but this model.Meal: &amp;model.Meal{}, does not work?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 408, "user_id": 9826697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pu78FyghZgI/AAAAAAAAAAI/AAAAAAAAAIE/AM4Xk2-XPaU/photo.jpg?sz=128", "display_name": "Rizki Hadiaturrasyid", "link": "https://stackoverflow.com/users/9826697/rizki-hadiaturrasyid"}, "edited": false, "score": 0, "creation_date": 1562015963, "post_id": 56790990, "comment_id": 100237006, "body": "If you want to pull it out you need to do <code>model.Meal = &amp;model.Meal{}</code>. Is that what you meant?"}, {"owner": {"reputation": 408, "user_id": 9826697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pu78FyghZgI/AAAAAAAAAAI/AAAAAAAAAIE/AM4Xk2-XPaU/photo.jpg?sz=128", "display_name": "Rizki Hadiaturrasyid", "link": "https://stackoverflow.com/users/9826697/rizki-hadiaturrasyid"}, "edited": false, "score": 0, "creation_date": 1562064528, "post_id": 56790990, "comment_id": 100251716, "body": "I&#39;m talking about this func newMealMain() mealMain {     return mealMain{         Meal: &amp;Meal{},     } } In my code it is like this Meal: &amp;model.Meal{}, but if I write model.Meal: &amp;model.Meal{} it errors."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 408, "user_id": 9826697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pu78FyghZgI/AAAAAAAAAAI/AAAAAAAAAIE/AM4Xk2-XPaU/photo.jpg?sz=128", "display_name": "Rizki Hadiaturrasyid", "link": "https://stackoverflow.com/users/9826697/rizki-hadiaturrasyid"}, "edited": false, "score": 0, "creation_date": 1562166175, "post_id": 56790990, "comment_id": 100294689, "body": "Ah, it must be: <code>Meal: &amp;model.Meal{}</code>, not <code>model.Meal: &amp;model.Meal{}</code>"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 408, "user_id": 9826697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pu78FyghZgI/AAAAAAAAAAI/AAAAAAAAAIE/AM4Xk2-XPaU/photo.jpg?sz=128", "display_name": "Rizki Hadiaturrasyid", "link": "https://stackoverflow.com/users/9826697/rizki-hadiaturrasyid"}, "edited": false, "score": 0, "creation_date": 1562166247, "post_id": 56790990, "comment_id": 100294741, "body": "The first <code>Meal</code> is the name of the field which defaults to the name of the struct (without the package name)."}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 2, "last_activity_date": 1561641853, "last_edit_date": 1561641853, "creation_date": 1561638370, "answer_id": 56790990, "question_id": 56790009, "link": "https://stackoverflow.com/questions/56790009/appending-value-to-struct-of-struct-in-golang-returns-invalid-memory-address/56790990#56790990", "title": "Appending value to struct of struct in Golang returns invalid memory address", "body": "<p>If you don't want to change the model:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    var meal = mealMain{\n        Meal: &amp;Meal{},\n    }\n    meal.ID = 1\n</code></pre>\n\n<p>The point is that in the following struct <code>*Meal</code> is set to <code>nil</code> if you don't initialize it.</p>\n\n<pre><code>type mealMain struct {\n    *Meal\n    Components []mealComponent `json:\"components\"`\n}\n</code></pre>\n\n<p>I'd probably create a function to never have to worry about the correct initialization ever again:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func newMealMain() mealMain {\n    return mealMain{\n        Meal: &amp;Meal{},\n    }\n}\n</code></pre>\n\n<p>Then your code would be:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    var meal = newMealMain()\n    meal.ID = 1\n</code></pre>\n"}], "owner": {"reputation": 408, "user_id": 9826697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pu78FyghZgI/AAAAAAAAAAI/AAAAAAAAAIE/AM4Xk2-XPaU/photo.jpg?sz=128", "display_name": "Rizki Hadiaturrasyid", "link": "https://stackoverflow.com/users/9826697/rizki-hadiaturrasyid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56790990, "answer_count": 1, "score": -2, "last_activity_date": 1561641853, "creation_date": 1561634795, "last_edit_date": 1561640297, "question_id": 56790009, "link": "https://stackoverflow.com/questions/56790009/appending-value-to-struct-of-struct-in-golang-returns-invalid-memory-address", "title": "Appending value to struct of struct in Golang returns invalid memory address", "body": "<p>I have a meal struct that \"appends\" another struct, except I want to add another struct \"mealComponents\".</p>\n\n<pre><code>type mealMain struct {\n    *model.Meal\n    Components []mealComponent `json:\"components\"`\n}\n\ntype mealComponent struct {\n    *model.MealComponent\n}\n</code></pre>\n\n<p>Where *model.Meal is as follows</p>\n\n<pre><code>type Meal struct {\n    ID               int64     `json:\"id\"`\n}\n</code></pre>\n\n<p>What I want is basically for \"mealMain\" struct to act like \"Meal\" struct, so that I can assign values and somehow append mealComponent as child (or maybe this is not a good idea? I'm open to suggestions)</p>\n\n<p>However when I do something like this</p>\n\n<pre><code>var meal mealMain\nmeal.ID = 1\n</code></pre>\n\n<p>It throws <code>runtime error: invalid memory address or nil pointer dereference</code> at meal.ID assignment.</p>\n\n<p>But if I do it like this:</p>\n\n<pre><code>type mealMain struct {\n    MealMain *model.Meal `json:\"meal_main\"`\n    Components []mealComponent `json:\"components\"`\n}\n</code></pre>\n\n<p>Then assign it this way:</p>\n\n<pre><code>var meal mealMain\nmeal.mealMain.ID = 1\n</code></pre>\n\n<p>It works properly, but I have the return json even deeper like this:</p>\n\n<pre><code>{\n    \"MealModel\": {\n        \"id\": 1\n    }\n}\n</code></pre>\n\n<p>What I want is this:</p>\n\n<pre><code>{\n    \"id\": 1\n}\n</code></pre>\n\n<p>Note: I want to avoid changing the model.</p>\n"}]