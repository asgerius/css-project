[{"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1564611799, "post_id": 57299253, "comment_id": 101092926, "body": "The <code>routes</code> method needs access to a router. Either add a router argument or create one in the <code>routes</code> method and return it.  Once that issue is fixed, simply call the method: <code>services.routes(routers)</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564643730, "post_id": 57299253, "comment_id": 101100149, "body": "&quot;Currently I have a class here&quot; -- No, Go doesn&#39;t have classes, and thinking of Go as having classes will only lead to confusion."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1564643768, "post_id": 57299253, "comment_id": 101100164, "body": "&quot;But how can I call these routes.go from my main.go?&quot; -- Exactly the same way you would if it were in <code>main.go</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1564668411, "post_id": 57299253, "comment_id": 101114031, "body": "You don&#39;t include <i>files</i> in Go, you include <i>packages</i>. Since these are in the same package together, you needn&#39;t do anything to access types/functions/variables declared in one from the other."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3270428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d0e23c08f35b17db5a4ccf4e30a3a2?s=128&d=identicon&r=PG", "display_name": "lerox", "link": "https://stackoverflow.com/users/3270428/lerox"}, "is_accepted": false, "score": 0, "last_activity_date": 1564626368, "creation_date": 1564626368, "answer_id": 57301094, "question_id": 57299253, "link": "https://stackoverflow.com/questions/57299253/how-can-i-easily-include-a-routes-go/57301094#57301094", "title": "How can I easily include a routes.go?", "body": "<p>I am not sure if I get it... but try something like the following:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ tree\n.\n\u2514\u2500\u2500 cmd\n    \u2514\u2500\u2500 src\n        \u251c\u2500\u2500 main.go\n        \u2514\u2500\u2500 routes.go\n\n2 directories, 2 files\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// $ cat cmd/src/main.go\npackage main\n\nfunc main() {\n    println(\"hello world\")\n\n    muxRouter := \"SuperRouter\"\n\n    myService := &amp;MyService{}\n\n    myService.routes(muxRouter)\n}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// $ cat cmd/src/routes.go\npackage main\n\nimport \"fmt\"\n\n// MyService ...\ntype MyService struct {\n    // deps\n}\n\n// routes ...\nfunc (ms *MyService) routes(router string) { //\n    // register here your endpoints &amp; handlers\n    fmt.Printf(\"routes - router: %s &amp; GetServices: %s \\n\", router, ms.GetServices())\n}\n\n// GetServices ...\nfunc (ms *MyService) GetServices() string {\n    return \"baz\"\n}\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ go run cmd/src/*.go\nhello world\nroutes - router: SuperRouter &amp; GetServices: baz\n</code></pre>\n\n<p>Best,</p>\n"}, {"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1564644145, "creation_date": 1564644145, "answer_id": 57303747, "question_id": 57299253, "link": "https://stackoverflow.com/questions/57299253/how-can-i-easily-include-a-routes-go/57303747#57303747", "title": "How can I easily include a routes.go?", "body": "<p>The actual problem here is that your service knows best what it can provide and your router does not. Since your Services methods are handler functions anyway, you can delegate the setup of the router to the Services. In the example below this is done in <code>BaseRoutes</code>.</p>\n\n<p>Then, all you have to do is to get a router and let the instance of your Service modify the behavior of said router.</p>\n\n<p>This does not prevent you from setting up addition routes, say for providing an HTMl GUI, as shown by the usage of <code>HelloRoute</code> as a variadic arg in <code>NewRouter</code>.</p>\n\n<p>At the end of the day, you hand your Services instance and the additional routes you might want (this is optional!) over to the <code>NewRouter</code> wrapper and can use the result as usual.</p>\n\n<p><strong>NOTE</strong>: I did not do any error handling in the Services, as this highly depends on what you actually wanna do. Please put proper though into error handling anyway.</p>\n\n<pre><code>// Services are a dummy for the actual implementation.\n// However, using an interface might well make sense if you have multiple Services.\ntype Services interface {\n    GetServices(w http.ResponseWriter, r *http.Request)\n    GetAssetStatus(w http.ResponseWriter, r *http.Request)\n    UpdateEncoderConfigForLid(w http.ResponseWriter, r *http.Request)\n    BaseRoutes(router *mux.Router) error\n}\n\n// MyServices is dummy implementation of Services.\ntype MyServices struct {\n}\n\n// GetServices implements the Services interface for MyServices\nfunc (s MyServices) GetServices(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"GetServices\"))\n\n}\n\n// GetAssetStatus implements the Services interface for MyServices\nfunc (s MyServices) GetAssetStatus(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"GetAssetStatus\"))\n}\n\n// UpdateEncoderConfigForLid implements the Services interface for MyServices\nfunc (s MyServices) UpdateEncoderConfigForLid(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"UpdateEncoderConfigForLid\"))\n}\n\n// BaseRoutes will set up the routes\nfunc (s *MyServices) BaseRoutes(router *mux.Router) error {\n\n    router.HandleFunc(\"/api/services\", s.GetServices).Methods(http.MethodGet)\n    router.HandleFunc(\"/api/services/status\", s.GetAssetStatus).Methods(http.MethodGet)\n    router.HandleFunc(\"/api/services/{lid}/encoders\", s.UpdateEncoderConfigForLid).Methods(http.MethodPut)\n\n    return nil\n}\n\n// HelloRoute is an example for an additional route you might want to set up\nfunc HelloRoute(router *mux.Router) error {\n    router.HandleFunc(\"/hello\", func(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"Hello, World!\"))\n    })\n    return nil\n}\n\ntype stdRoute func(router *mux.Router) error\n\n// NewRouter wraps the setup of your service routes and additional routes\n// We use the Services interface here to make it more generic.\nfunc NewRouter(s Services, additionalRoutes ...stdRoute) *mux.Router {\n    r := mux.NewRouter()\n\n    var err error\n    if err = s.BaseRoutes(r); err != nil {\n        log.Printf(\"setting up service routes: %s =&gt; HANDLE THIS!\", err)\n    }\n    for _, route := range additionalRoutes {\n        if err = route(r); err != nil {\n            log.Printf(\"setting up additional routes: %s =&gt; HANDLE THIS!\", err)\n        }\n    }\n\n    return r\n}\n\n// Of course, if you have additional services, you can use variadic args again.\nfunc web(s Services) {\n    router := NewRouter(s, HelloRoute)\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n</code></pre>\n"}], "owner": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1566504285, "creation_date": 1564609707, "last_edit_date": 1566504285, "question_id": 57299253, "link": "https://stackoverflow.com/questions/57299253/how-can-i-easily-include-a-routes-go", "title": "How can I easily include a routes.go?", "body": "<p>I would like to put all my routes in a routes.go file. Currently I have a class here:</p>\n\n<p>cmd-> src -> main.go</p>\n\n<p>Where I have this line of code: </p>\n\n<pre><code>func startServer(port string, services Services, stop chan os.Signal, psFact *ps.Factory, logger log.Logger) *http.Server {\n    router := mux.NewRouter()\n\n    apiHandler.RegisterRoutes(router)\n    router.HandleFunc\n\n    srv := &amp;http.Server{Addr: fmt.Sprintf(\":%v\", port), Handler: router}\n    go func() {\n        if err := srv.ListenAndServe(); err != nil {\n            if strings.HasPrefix(err.Error(), \"listen tcp :5002: bind\") {\n                stop &lt;- syscall.SIGTERM\n            }\n            log.Log.Error(\"error shutting down server\", zap.Error(err))\n        }\n    }()\n    return srv\n}\n</code></pre>\n\n<p>I would like to throw all my router.HandleFuncs in a separate file called routes.go in the cmd ->src -> routes.go, but am having trouble figuring out how I can do that. Currently, what I have is this:</p>\n\n<pre><code>package main\n\nimport \"net/http\"\n\nfunc (services Services) routes() {\n}\n</code></pre>\n\n<p>But how can I call these routes.go from my main.go?</p>\n"}, {"tags": ["multithreading", "go", "concurrency", "race-condition", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1564607415, "post_id": 57298304, "comment_id": 101091686, "body": "This is a good example of how atomics don&#39;t provide synchronization, they only provide safe concurrent access."}], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1564606907, "post_id": 57298536, "comment_id": 101091500, "body": "but even if GOMAXPROCS is 1, how come 1000 concurrent threads do not cause a race condition? say counter=100, thread1 loads counter into v, increments it, so v=101. then context switch, thread2 loads counter into v, increments it, so v=101, and stores 101 in memory, then context switch back to thread1, and it stores 101 as well"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 3, "creation_date": 1564607046, "post_id": 57298536, "comment_id": 101091556, "body": "@mangusta Theoretically you could get less than 1000 with 1 thread too, but the current goroutine scheduler does not put goroutines to park arbitrarily. So the &quot;context switches&quot; you anticipate are not there."}, {"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1564607330, "post_id": 57298536, "comment_id": 101091655, "body": "could you elaborate this a bit: &quot;but the current goroutine scheduler does not put goroutines to park arbitrarily&quot; ? the scheduler does not perform a context switch in the middle of goroutine ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1564607637, "post_id": 57298536, "comment_id": 101091776, "body": "The only assumptions you can make are those presented in the language  and memory model specifications. The compiler is free to optimize the order of operations within that model. You have no synchronization providing any &quot;happens before&quot; relationship between the goroutines, so the code and runtime is free to reorder the operations according to the spec, even within a single thread."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1564607661, "post_id": 57298536, "comment_id": 101091783, "body": "@mangusta I&#39;m not familiar with the exact implementation, but yes, a goroutine is not interrupted only when certain events happen, such as a blocking IO or syscall is encountered, a channel send/receive would block, or <a href=\"https://golang.org/pkg/runtime/#Gosched\" rel=\"nofollow noreferrer\"><code>runtime.Gosched()</code></a> is called intentionally to yield, among others."}, {"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1564607984, "post_id": 57298536, "comment_id": 101091862, "body": "I see. Still this &quot;-race&quot; utility has to provide some warning in case of the situation described. The end user might be unaware about the value of GOMAXPROCS. After all, the fact that the program ocassionally yields outputs other that 1000 is nothing else but a 100% race condition"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 3, "creation_date": 1564608270, "post_id": 57298536, "comment_id": 101091945, "body": "@mangusta: the race detector only detects data races, and this is absolutely not a data race. You could consider it a &quot;logical&quot; race of sorts, but the program is executing exactly as it was intended. In fact even <code>1</code> is valid output here, if the goroutines all yield at the same point between the load and store."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1564656874, "last_edit_date": 1564656874, "creation_date": 1564605670, "answer_id": 57298536, "question_id": 57298304, "link": "https://stackoverflow.com/questions/57298304/why-is-the-race-detector-not-detecting-this-race-condition/57298536#57298536", "title": "Why is the race detector not detecting this race condition?", "body": "<p>There is nothing racy in your code, so that's why the race detector detects nothing. Your <code>counter</code> variable is always accessed via the <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"nofollow noreferrer\"><code>atomic</code></a> package from the launched goroutines and not directly.</p>\n\n<p>The reason why sometimes you get 1000 and sometimes less is due to the number of active threads that run goroutines: <a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\"><code>GOMAXPROCS</code></a>. On the Go Playground it's 1, so at any time you have one active goroutine (so basically your app is executed sequentially, without any parallelism). And the current goroutine scheduler does not put goroutines to park arbitrarily.</p>\n\n<p>On your local machine you probably have a multicore CPU, and <code>GOMAXPROCS</code> defaults to the number of available logical CPUs, so <code>GOMAXPROCS</code> is greater than 1, so you have multiple goroutines running <em>parallel</em> (truly parallel, not just <em>concurrent</em>).</p>\n\n<p>See this fragment:</p>\n\n<pre><code>v := atomic.LoadInt64(&amp;counter)\nv++\natomic.StoreInt64(&amp;counter, v)\n</code></pre>\n\n<p>You load <code>counter</code>'s value and assign it to <code>v</code>, you increment <code>v</code>, and you store back the value of the incremented <code>v</code>. What happens if 2 parallel goroutines do this at the same time? Let's say both load the value <code>100</code>. Both increment their local copy: <code>101</code>. Both write back <code>101</code>, even though it should be at <code>102</code>.</p>\n\n<p>Yes, the proper way to increment counters atomically would be to use <a href=\"https://golang.org/pkg/sync/atomic/#AddInt64\" rel=\"nofollow noreferrer\"><code>atomic.AddInt64()</code></a> like this:</p>\n\n<pre><code>for i := 0; i &lt; num; i++ {\n    go func() {\n        atomic.AddInt64(&amp;counter, 1)\n        wg.Done()\n    }()\n}\n</code></pre>\n\n<p>This way you'll always get 1000, no matter what <code>GOMAXPROCS</code> is.</p>\n"}], "owner": {"reputation": 687, "user_id": 6138942, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zEF_d3b2Gck/AAAAAAAAAAI/AAAAAAAAAGw/bABfaZfEngc/photo.jpg?sz=128", "display_name": "Gijs de Jong", "link": "https://stackoverflow.com/users/6138942/gijs-de-jong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 57298536, "answer_count": 1, "score": 1, "last_activity_date": 1564656874, "creation_date": 1564604496, "last_edit_date": 1564605794, "question_id": 57298304, "link": "https://stackoverflow.com/questions/57298304/why-is-the-race-detector-not-detecting-this-race-condition", "title": "Why is the race detector not detecting this race condition?", "body": "<p>I am currently learning the Go programming language and I am now experimenting with the <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"nofollow noreferrer\">atomic</a> package.</p>\n\n<p>In this example, I am spawning a number of Goroutines that all need to increment a package level variable. There are several methods to avoid race conditions but for now I want to solve this using the <code>atomic</code> package.</p>\n\n<p>When running the following code on my Windows PC (<code>go run main.go</code>) the results are not what I expect them to be (I expect the final result to be 1000). The final number is somewhere between 900 and 1000. When running the code in the Go Playground the value is 1000.</p>\n\n<p>Here is the code I am using: <a href=\"https://play.golang.org/p/8gW-AsKGzwq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8gW-AsKGzwq</a></p>\n\n<pre><code>var counter int64\nvar wg sync.WaitGroup\n\nfunc main() {\n    num := 1000\n    wg.Add(num )\n    for i := 0; i &lt; num ; i++ {\n        go func() {\n            v := atomic.LoadInt64(&amp;counter)\n            v++\n            atomic.StoreInt64(&amp;counter, v)\n\n            // atomic.AddInt64(&amp;counter, 1)\n\n            // fmt.Println(v)\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n    fmt.Println(\"final\", counter)\n}\n</code></pre>\n\n<pre><code>go run main.go\nfinal 931\n\ngo run main.go\nfinal 960\n\ngo run main.go\nfinal 918\n</code></pre>\n\n<p>I would have expected the race detector to give an error, but it doesn't:</p>\n\n<pre><code>go run -race main.go\nfinal 1000\n</code></pre>\n\n<p>And it outputs the correct value (1000).</p>\n\n<p>I am using go version <code>go1.12.7 windows/amd64</code> (latest version at this moment)</p>\n\n<p>My questions:</p>\n\n<ul>\n<li>Why is the race detector not giving an error, but am I seeing different values when running the code without the race detector?</li>\n<li>My theory why the Load/Store combination is not working is that the two atomic calls are not atomic as a whole. In this case I should be using the <code>atomic.AddInt64</code> method, is that right?</li>\n</ul>\n\n<p>Any help would be greatly appreciated :)</p>\n"}, {"tags": ["amazon-web-services", "docker", "go", "amazon-s3", "docker-compose"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1564604432, "post_id": 57297867, "comment_id": 101090598, "body": "Your <code>nil</code> panic stems from <a href=\"https://github.com/jpskgc/article/blob/3dda7fb4f96d04085fbb0241d185fc73a3016b7a/api/main.go#L171-L172\" rel=\"nofollow noreferrer\">this code</a>. Your creating a zero-value <code>ec2rolecreds.EC2RoleProvider{}</code> which has a field <code>Client</code> of type <code>*ec2metadata.EC2Metadata</code>. Since you&#39;re not setting it, it&#39;s <code>nil</code>, so somewhere in the call stack for <code>creds.Get()</code> something is trying to dereference that <code>nil</code> pointer..."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1564604540, "post_id": 57297867, "comment_id": 101090640, "body": "...  Since you&#39;re mounting your local <code>credentials.properties</code> into your container, you could use <a href=\"https://godoc.org/github.com/aws/aws-sdk-go/aws/credentials#NewSharedCredentials\" rel=\"nofollow noreferrer\"><code>credentials.NewSharedCredentials(...)</code></a> instead of <code>credentials.NewCredentials(&amp;ec2rolecreds.EC2RoleProvider{})</code>. Ultimately mounting credentials file from your local workstation into your production server container isn&#39;t going to be a great idea, and you should look into the other ways of constructing a <code>*credentials.Credentials</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11869113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1ErXTDExMAI/AAAAAAAAAAI/AAAAAAAAHmw/WV2nIR8u-4k/photo.jpg?sz=128", "display_name": "Quentin Raimbault", "link": "https://stackoverflow.com/users/11869113/quentin-raimbault"}, "is_accepted": false, "score": 0, "last_activity_date": 1564661661, "creation_date": 1564661661, "answer_id": 57308823, "question_id": 57297867, "link": "https://stackoverflow.com/questions/57297867/how-to-get-aws-credentials-and-access-to-s3-on-docker/57308823#57308823", "title": "How to get AWS credentials and access to S3 on Docker", "body": "<p>You can pass your credentials using environment variables like this:</p>\n\n<pre><code>AWS_ACCESS_KEY_ID=xxx\nAWS_SECRET_ACCESS_KEY=yyy\n</code></pre>\n\n<p>So your docker-compose will look like:</p>\n\n<pre><code>version: '3'\nservices:\n  api:\n    build:\n      dockerfile: Dockerfile.dev\n      context: ./api\n    volumes:\n      - ./api:/app\n    environment:\n      AWS_ACCESS_KEY_ID: YOUR-ACCESS-KEY-ID\n      AWS_SECRET_ACCESS_KEY: YOUR-SECRET-KEY\n    ports:\n      - 2345:2345\n    depends_on:\n      - db\n    tty: true\n</code></pre>\n\n<p>You shouldn't do this in production and use IAM profiles instead both for the simplicity of not having a ton of keys everywhere, and for security to avoid leaking you keys in logs or anywhere, but it works well for development purpose.</p>\n\n<p>Is you use this method, you can remove the credentials part of your code, more informations here: <a href=\"https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-credentials\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-credentials</a></p>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 2147, "user_id": 3484824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b4eb1b1e3184c6fdf1568eb5a6b71f0?s=128&d=identicon&r=PG", "display_name": "Can Rau", "link": "https://stackoverflow.com/users/3484824/can-rau"}, "edited": false, "score": 0, "creation_date": 1603568518, "post_id": 57310270, "comment_id": 114080961, "body": "You can use the provided &quot;helper&quot; <code>creds := credentials.NewEnvCredentials()</code>. Might be a new addition, not sure \ud83e\udd37\u200d\u2642\ufe0f"}], "tags": [], "owner": {"reputation": 193, "user_id": 11766408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec295cea34bc4a92fe14a67082d53407?s=128&d=identicon&r=PG&f=1", "display_name": "jpskgc", "link": "https://stackoverflow.com/users/11766408/jpskgc"}, "is_accepted": true, "score": 1, "last_activity_date": 1564666475, "creation_date": 1564666475, "answer_id": 57310270, "question_id": 57297867, "link": "https://stackoverflow.com/questions/57297867/how-to-get-aws-credentials-and-access-to-s3-on-docker/57310270#57310270", "title": "How to get AWS credentials and access to S3 on Docker", "body": "<p>I set environment variable in <code>docker-compose.yml</code> and set value in console.</p>\n\n<pre><code>    environment:\n      - AWS_ACCESS_KEY_ID\n      - AWS_SECRET_ACCESS_KEY\n</code></pre>\n\n<pre><code>$ export AWS_ACCESS_KEY_ID=$(aws --profile default configure get aws_access_key_id)\n$ export AWS_SECRET_ACCESS_KEY=$(aws --profile default configure get aws_secret_access_key)\n</code></pre>\n\n<pre><code>creds := credentials.NewStaticCredentials(os.Getenv(\"AWS_ACCESS_KEY_ID\"), os.Getenv(\"AWS_SECRET_ACCESS_KEY\"), \"\")\n\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 11766408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec295cea34bc4a92fe14a67082d53407?s=128&d=identicon&r=PG&f=1", "display_name": "jpskgc", "link": "https://stackoverflow.com/users/11766408/jpskgc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "accepted_answer_id": 57310270, "answer_count": 2, "score": 0, "last_activity_date": 1564666475, "creation_date": 1564602103, "last_edit_date": 1564603699, "question_id": 57297867, "link": "https://stackoverflow.com/questions/57297867/how-to-get-aws-credentials-and-access-to-s3-on-docker", "title": "How to get AWS credentials and access to S3 on Docker", "body": "<p>I'm setting up Docker containers. </p>\n\n<p>On the server side, files are uploaded to S3. </p>\n\n<p>It succeeded to upload under my local environment. </p>\n\n<p>However, it fails to upload under Docker environment.</p>\n\n<ul>\n<li>client: React/axios</li>\n<li>server: Golang/gin</li>\n<li>db: mysql</li>\n<li>source code: <a href=\"https://github.com/jpskgc/article\" rel=\"nofollow noreferrer\">https://github.com/jpskgc/article</a></li>\n</ul>\n\n<pre><code>article\n\u3000\u251c client\n\u3000\u251c api  \n\u3000\u2514 docker-compose.yml\n</code></pre>\n\n<p>Here is the docker-compose.yml:</p>\n\n<pre><code>version: '3'\nservices:\n  api:\n    build:\n      dockerfile: Dockerfile.dev\n      context: ./api\n    volumes:\n      - ./api:/app\n    ports:\n      - 2345:2345\n    depends_on:\n      - db\n    tty: true\n    volumes:\n      - $HOME/.aws/credentials.properties:/home/api/.aws/credentials.properties\n</code></pre>\n\n<p>Here is the server side code to access to S3.</p>\n\n<pre><code>api := router.Group(\"/api\")\n{\n    api.POST(\"/post/image\", func(c *gin.Context) {\n        var creds *credentials.Credentials\n        var err error\n\n        creds = credentials.NewSharedCredentials(\"\", \"default\")\n        _, err = creds.Get()\n\n        if err != nil {\n            creds = credentials.NewCredentials(&amp;ec2rolecreds.EC2RoleProvider{})\n            _, err = creds.Get()\n        }\n\n        cfg := aws.NewConfig().WithRegion(\"ap-northeast-1\").WithCredentials(creds)\n        svc := s3.New(session.New(), cfg)\n\n        form, _ := c.MultipartForm()\n\n        files := form.File[\"images[]\"]\n\n        var imageNames []ImageName\n        imageName := ImageName{}\n\n        for _, file := range files {\n\n            f, err := file.Open()\n\n            if err != nil {\n                log.Println(err)\n            }\n\n            defer f.Close()\n\n            size := file.Size\n            buffer := make([]byte, size)\n\n            f.Read(buffer)\n            fileBytes := bytes.NewReader(buffer)\n            fileType := http.DetectContentType(buffer)\n            path := \"/media/\" + file.Filename\n            params := &amp;s3.PutObjectInput{\n                Bucket:        aws.String(\"article-s3-jpskgc\"),\n                Key:           aws.String(path),\n                Body:          fileBytes,\n                ContentLength: aws.Int64(size),\n                ContentType:   aws.String(fileType),\n            }\n            resp, err := svc.PutObject(params)\n\n            fmt.Printf(\"response %s\", awsutil.StringValue(resp))\n\n            imageName.NAME = file.Filename\n\n            imageNames = append(imageNames, imageName)\n        }\n\n        c.JSON(http.StatusOK, imageNames)\n    })\n}\n</code></pre>\n\n<p>I expect images are uploaded in server side to S3. </p>\n\n<p>But in actuality they're not. </p>\n\n<p>Here are some logs:</p>\n\n<pre><code>api_1     | 2019/07/31 14:58:53 [Recovery] 2019/07/31 - 14:58:53 panic recovered:\napi_1     | POST /api/post/image HTTP/1.1\napi_1     | Host: localhost:2345\napi_1     | Accept: application/json, text/plain, */*\napi_1     | Accept-Encoding: gzip, deflate, br\napi_1     | Accept-Language: en-US,en;q=0.9\napi_1     | Connection: keep-alive\napi_1     | Content-Length: 92267\napi_1     | Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryYx6aOI06AYceIHnU\napi_1     | Origin: http://localhost:3000\napi_1     | Referer: http://localhost:3000/post/finish\napi_1     | User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36\napi_1     | \napi_1     | \napi_1     | runtime error: invalid memory address or nil pointer dereference\napi_1     | /usr/local/go/src/runtime/panic.go:82 (0x4427f0)\napi_1     |     panicmem: panic(memoryError)\napi_1     | /usr/local/go/src/runtime/signal_unix.go:390 (0x44261f)\napi_1     |     sigpanic: panicmem()\napi_1     | /go/src/github.com/aws/aws-sdk-go/aws/ec2metadata/api.go:26 (0xa01a35)\napi_1     |     (*EC2Metadata).GetMetadata: req := c.NewRequest(op, nil, output)\napi_1     | /go/src/github.com/aws/aws-sdk-go/aws/credentials/ec2rolecreds/ec2_role_provider.go:134 (0xa05607)\napi_1     |     requestCredList: resp, err := client.GetMetadata(iamSecurityCredsPath)\napi_1     | /go/src/github.com/aws/aws-sdk-go/aws/credentials/ec2rolecreds/ec2_role_provider.go:90 (0xa05159)\napi_1     |     (*EC2RoleProvider).Retrieve: credsList, err := requestCredList(m.Client)\napi_1     | /go/src/github.com/aws/aws-sdk-go/aws/credentials/credentials.go:241 (0x945246)\napi_1     |     (*Credentials).Get: creds, err := c.provider.Retrieve()\napi_1     | /app/main.go:172 (0xb1dde1)\napi_1     |     main.func5: _, err = creds.Get()\napi_1     | /go/src/github.com/gin-gonic/gin/context.go:147 (0x8f97c9)\napi_1     |     (*Context).Next: c.handlers[c.index](c)\napi_1     | /go/src/github.com/gin-gonic/gin/recovery.go:83 (0x90d259)\napi_1     |     RecoveryWithWriter.func1: c.Next()\napi_1     | /go/src/github.com/gin-gonic/gin/context.go:147 (0x8f97c9)\napi_1     |     (*Context).Next: c.handlers[c.index](c)\napi_1     | /go/src/github.com/gin-gonic/gin/logger.go:240 (0x90c300)\napi_1     |     LoggerWithConfig.func1: c.Next()\napi_1     | /go/src/github.com/gin-gonic/gin/context.go:147 (0x8f97c9)\napi_1     |     (*Context).Next: c.handlers[c.index](c)\napi_1     | /go/src/github.com/gin-gonic/gin/gin.go:391 (0x9036c9)\napi_1     |     (*Engine).handleHTTPRequest: c.Next()\napi_1     | /go/src/github.com/gin-gonic/gin/gin.go:352 (0x902dbd)\napi_1     |     (*Engine).ServeHTTP: engine.handleHTTPRequest(c)\napi_1     | /usr/local/go/src/net/http/server.go:2774 (0x6dcc77)\napi_1     |     serverHandler.ServeHTTP: handler.ServeHTTP(rw, req)\napi_1     | /usr/local/go/src/net/http/server.go:1878 (0x6d8860)\napi_1     |     (*conn).serve: serverHandler{c.server}.ServeHTTP(w, w.req)\napi_1     | /usr/local/go/src/runtime/asm_amd64.s:1337 (0x45a090)\napi_1     |     goexit: BYTE    $0x90   // NOP\napi_1     | \napi_1     | [GIN] 2019/07/31 - 14:58:53 | 500 |    695.0698ms |      172.18.0.1 | POST     /api/post/image\n</code></pre>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 9265302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b77bcdae5046bd2d71a6c01f1223ca?s=128&d=identicon&r=PG&f=1", "display_name": "wineinlib", "link": "https://stackoverflow.com/users/9265302/wineinlib"}, "is_accepted": false, "score": 1, "last_activity_date": 1565262519, "last_edit_date": 1565262519, "creation_date": 1564623261, "answer_id": 57300773, "question_id": 57297817, "link": "https://stackoverflow.com/questions/57297817/how-to-use-the-kubernetes-go-client-to-get-the-same-pod-status-info-that-kubectl/57300773#57300773", "title": "How to use the kubernetes go-client to get the same Pod status info that kubectl gives", "body": "<p>I think you need to re-calculate it. See <a href=\"https://github.com/kubernetes/kubernetes/blob/master/pkg/printers/internalversion/printers.go#L558\" rel=\"nofollow noreferrer\">this</a></p>\n"}, {"comments": [{"owner": {"reputation": 2298, "user_id": 4840922, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh6.googleusercontent.com/-DRTPNKbcFGc/AAAAAAAAAAI/AAAAAAAAAV8/ujmQnfQDZv4/photo.jpg?sz=128", "display_name": "Janshair Khan", "link": "https://stackoverflow.com/users/4840922/janshair-khan"}, "edited": false, "score": 0, "creation_date": 1593641169, "post_id": 57318349, "comment_id": 110855697, "body": "Most of the links you defined are broken."}, {"owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "reply_to_user": {"reputation": 2298, "user_id": 4840922, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh6.googleusercontent.com/-DRTPNKbcFGc/AAAAAAAAAAI/AAAAAAAAAV8/ujmQnfQDZv4/photo.jpg?sz=128", "display_name": "Janshair Khan", "link": "https://stackoverflow.com/users/4840922/janshair-khan"}, "edited": false, "score": 0, "creation_date": 1593641683, "post_id": 57318349, "comment_id": 110855834, "body": "Thanks, I&#39;ll take a look. Stuff changes."}, {"owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "reply_to_user": {"reputation": 2298, "user_id": 4840922, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh6.googleusercontent.com/-DRTPNKbcFGc/AAAAAAAAAAI/AAAAAAAAAV8/ujmQnfQDZv4/photo.jpg?sz=128", "display_name": "Janshair Khan", "link": "https://stackoverflow.com/users/4840922/janshair-khan"}, "edited": false, "score": 0, "creation_date": 1593642727, "post_id": 57318349, "comment_id": 110856096, "body": "Updated the links... seems like the moved the code."}, {"owner": {"reputation": 2298, "user_id": 4840922, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh6.googleusercontent.com/-DRTPNKbcFGc/AAAAAAAAAAI/AAAAAAAAAV8/ujmQnfQDZv4/photo.jpg?sz=128", "display_name": "Janshair Khan", "link": "https://stackoverflow.com/users/4840922/janshair-khan"}, "edited": false, "score": 0, "creation_date": 1593892628, "post_id": 57318349, "comment_id": 110938011, "body": "Thank you Rico."}, {"owner": {"reputation": 2298, "user_id": 4840922, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh6.googleusercontent.com/-DRTPNKbcFGc/AAAAAAAAAAI/AAAAAAAAAV8/ujmQnfQDZv4/photo.jpg?sz=128", "display_name": "Janshair Khan", "link": "https://stackoverflow.com/users/4840922/janshair-khan"}, "edited": false, "score": 0, "creation_date": 1593894660, "post_id": 57318349, "comment_id": 110938714, "body": "How can we simply get a notification if all the containers in a Pod finish and Pod life-cycle becomes <code>COMPLETED</code>? Any example would be appreciated."}], "tags": [], "owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "is_accepted": false, "score": 6, "last_activity_date": 1593642692, "last_edit_date": 1593642692, "creation_date": 1564703676, "answer_id": 57318349, "question_id": 57297817, "link": "https://stackoverflow.com/questions/57297817/how-to-use-the-kubernetes-go-client-to-get-the-same-pod-status-info-that-kubectl/57318349#57318349", "title": "How to use the kubernetes go-client to get the same Pod status info that kubectl gives", "body": "<p>The short answer is typically you don't have to calculate the 'Status' on the client since it's calculated at the server level.</p>\n<p>To illustrate:</p>\n<p>The standard way that you are trying to print with <code>kubectl get pods</code>, in the Kubernetes code base it's called <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/kubectl/pkg/cmd/get/humanreadable_flags.go\" rel=\"nofollow noreferrer\">Human Readable</a>. This method uses <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/kubectl/pkg/cmd/get/get.go#L265\" rel=\"nofollow noreferrer\">ServerPrint</a>, which defaults to the <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/kubectl/pkg/cmd/get/get.go#L266\" rel=\"nofollow noreferrer\">Kubernetes TablePrinter</a>. The <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/kubectl/pkg/cmd/get/table_printer.go#L33\" rel=\"nofollow noreferrer\">TablePrinter type is defined here</a>.</p>\n<p>As you can see the <code>PrintObj</code> function for the TablePrinter gets delegated <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/kubectl/pkg/cmd/get/table_printer.go#L33\" rel=\"nofollow noreferrer\">here</a>, but that delegation comes from configuring the HumanPrintFlags and saving the original <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/kubectl/pkg/cmd/get/get.go#L254\" rel=\"nofollow noreferrer\">printer</a>.</p>\n<p>Also, you see that in <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/kubectl/pkg/cmd/get/humanreadable_flags.go\" rel=\"nofollow noreferrer\">humanreadable_glags.go</a> it's including <code>k8s.io/cli-runtime/pkg/printers</code>, and you see that it's instantiating a <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/kubectl/pkg/cmd/get/humanreadable_flags.go#L88\" rel=\"nofollow noreferrer\">printers.NewTablePrinter</a> which is defined in <code>k8s.io/kubernetes/pkg/printers</code>.</p>\n<p>The actual function to print that gets called is this <a href=\"https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/cli-runtime/pkg/printers/tableprinter.go#L94\" rel=\"nofollow noreferrer\">PrintObj</a> and you can see that it handles 3 cases since in some cases the server returns a table and some not (looks like &lt; 1.16 cases).</p>\n<p>You also see that in the above case none of the code in <a href=\"https://github.com/kubernetes/kubernetes/tree/master/pkg/printers/internalversion\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/kubernetes/tree/master/pkg/printers/internalversion</a> is used, so that <a href=\"https://github.com/kubernetes/kubernetes/blob/master/pkg/printers/internalversion/printers.go#L580\" rel=\"nofollow noreferrer\">calculation</a> happens behind the kube-apiserver side.</p>\n<p>Keep in mind that this is the Human Readable printer and there other types of printers defined here (depending on the options): <a href=\"https://github.com/kubernetes/kubernetes/tree/master/staging/src/k8s.io/cli-runtime/pkg/printers\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/kubernetes/tree/master/staging/src/k8s.io/cli-runtime/pkg/printers</a></p>\n"}], "owner": {"reputation": 13015, "user_id": 42754, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d43ffadeb6cbac3532a40cfedad2831?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/42754/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2522, "favorite_count": 2, "answer_count": 2, "score": 11, "last_activity_date": 1593642692, "creation_date": 1564601855, "last_edit_date": 1564609463, "question_id": 57297817, "link": "https://stackoverflow.com/questions/57297817/how-to-use-the-kubernetes-go-client-to-get-the-same-pod-status-info-that-kubectl", "title": "How to use the kubernetes go-client to get the same Pod status info that kubectl gives", "body": "<p>Using the kubernetes go-client (<code>k8s.io/client-go/kubernetes</code>), I know how to get <code>pod.Status</code> and I find the <code>pod.Status.Phase</code> useful (<a href=\"https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-phase\" rel=\"noreferrer\">docs</a>). For example, I can output the Pod Status Phase of all Pods using this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    ...\n    api := clientset.CoreV1()\n    pods, err := api.Pods(\"\").List(metav1.ListOptions{})\n    for i, pod := range pods.Items {\n        podstatusPhase := string(pod.Status.Phase)\n        podCreationTime := pod.GetCreationTimestamp()\n        age := time.Since(podCreationTime.Time).Round(time.Second)\n\n        podInfo := fmt.Sprintf(\"[%d] Pod: %s, Phase: %s , Created: %s, Age: %s\", i, pod.GetName(), podstatusPhase, podCreationTime, age.String())\n        fmt.Println(podInfo)\n    }\n</code></pre>\n\n<p>However, the <code>phase</code> is a little simplistic in that it only ever shows 5 values (<code>Pending</code>, <code>Running</code>, <code>Succeeded</code>, <code>Failed</code>, <code>Unknown</code>). I'd rather get the same info that <code>kubectl get pods</code> gives in the <em>Status</em> column, for example: </p>\n\n<pre><code>$ kubectl get pods\n\nNAME                                        READY   STATUS              RESTARTS   AGE     IP             NODE                           NOMINATED NODE   READINESS GATES\nmoby-dick-cron-scheduler-1564578660-bg4sb   0/2     ContainerCreating   0          178m    &lt;none&gt;         ip-10-30-13-151.ec2.internal   &lt;none&gt;           &lt;none&gt;\nnotifications-missed-calls-1564564740-js762 0/2     Init:0/1            0          6h49m   &lt;none&gt;         ip-10-30-13-6.ec2.internal     &lt;none&gt;           &lt;none&gt;\nantivirus-scanner-cron-1564576740-sd6hh     0/2     Completed           0          3h30m   10.30.13.169   ip-10-30-13-151.ec2.internal   &lt;none&gt;           &lt;none&gt;\n</code></pre>\n\n<p>In particular, I'm interested in <code>Init:0/1</code> and <code>PodInitializing</code> statuses. The Pods in these statuses just show as \"Pending\" when using <code>pod.Status.Phase</code>.</p>\n\n<ul>\n<li><code>Init:0/1</code> means the Pod has 1 Init containers and 0 have completed successfully so far. <a href=\"https://kubernetes.io/docs/concepts/workloads/pods/init-containers/\" rel=\"noreferrer\">init containers</a> run before app containers are started.</li>\n<li><code>PodInitializing</code> means the Pod has already finished executing Init Containers.</li>\n</ul>\n\n<p>Is there a way to get a Status such as <code>Init:0/1</code> using <code>k8s.io/client-go/kubernetes</code>? or is there no short-cut, and I'd need to re-calculate it the same way kubectl does? I guess it uses Pod Status <a href=\"https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-conditions\" rel=\"noreferrer\">Conditions</a> and <a href=\"https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-and-container-status\" rel=\"noreferrer\">container statuses</a> to build the info. If I need to re-calculate it, maybe I can use <a href=\"https://github.com/kubernetes/kubernetes/tree/master/pkg/kubectl\" rel=\"noreferrer\">the kubectl sourcecode</a>? Does anyone know where I can find the relevant bit? (I have very limited golang experience)</p>\n"}, {"tags": ["go", "gcc", "shared-libraries", "cython", "cgo"], "comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564597262, "post_id": 57296694, "comment_id": 101087700, "body": "The cgo docs only show this working with single line comments <code>&#47;&#47;</code>, have you tried that?"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1564597478, "post_id": 57296694, "comment_id": 101087787, "body": "That question is way too broad. Let\u2019s start with the fact that cythonized files .c/.h aren\u2019t shared objects. Then you need too embed the python interpreter - the list goes on and on..."}, {"owner": {"reputation": 31, "user_id": 10050531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kRx5HefG3wU/AAAAAAAAAAI/AAAAAAAAABM/2w-qwEKNht0/photo.jpg?sz=128", "display_name": "hamid ghadery", "link": "https://stackoverflow.com/users/10050531/hamid-ghadery"}, "reply_to_user": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564597744, "post_id": 57296694, "comment_id": 101087907, "body": "@Jesse thanks for feedback &lt;3. Do you mean?       ...     //#include &lt;/usr/include/python3.7m/Python.h&gt;     //#include &quot;pylib.h&quot;     import &quot;C&quot;     ...  so I have same problem too."}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1564598824, "post_id": 57296694, "comment_id": 101088388, "body": "I think you should read - in detail - the section of the Cython documentation describing how to call a Cython module from C and then reproduce that in Go as closely as possible."}, {"owner": {"reputation": 31, "user_id": 10050531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kRx5HefG3wU/AAAAAAAAAAI/AAAAAAAAABM/2w-qwEKNht0/photo.jpg?sz=128", "display_name": "hamid ghadery", "link": "https://stackoverflow.com/users/10050531/hamid-ghadery"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1564599117, "post_id": 57296694, "comment_id": 101088525, "body": "@ead first I tried import go lib to python, It done with ctypes in python and I wanted to do the opposite, And I read documents from various sites that said I should do it. I got help from these:  <a href=\"https://stackoverflow.com/questions/45419532/use-generated-header-file-from-cython\">this</a> and any more that I can&#39;t finde them.  I thought be import to go like import to c.  I had a similar output, of course."}, {"owner": {"reputation": 31, "user_id": 10050531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kRx5HefG3wU/AAAAAAAAAAI/AAAAAAAAABM/2w-qwEKNht0/photo.jpg?sz=128", "display_name": "hamid ghadery", "link": "https://stackoverflow.com/users/10050531/hamid-ghadery"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1564599433, "post_id": 57296694, "comment_id": 101088658, "body": "@davidw I couldn&#39;t find anything to helpful, Can you find it to help me?or something."}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 1, "creation_date": 1564599823, "post_id": 57296694, "comment_id": 101088819, "body": "<a href=\"https://cython.readthedocs.io/en/latest/src/userguide/external_C_code.html#using-cython-declarations-from-c\" rel=\"nofollow noreferrer\">This is the relevant section</a>; it follows the same pattern as ead&#39;s answer from the question you link above and for example the &quot;main&quot; function includes a number of things that you ignore here."}, {"owner": {"reputation": 31, "user_id": 10050531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kRx5HefG3wU/AAAAAAAAAAI/AAAAAAAAABM/2w-qwEKNht0/photo.jpg?sz=128", "display_name": "hamid ghadery", "link": "https://stackoverflow.com/users/10050531/hamid-ghadery"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1564600555, "post_id": 57296694, "comment_id": 101089111, "body": "@DavidW so thanks, I have to study it now. &lt;3"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1564601507, "post_id": 57296694, "comment_id": 101089502, "body": "@hamidghadery as you work with Python3.7 please take my last edit into consideration: <a href=\"https://stackoverflow.com/posts/45424720/revisions\">stackoverflow.com/posts/45424720/revisions</a>"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1564601748, "post_id": 57296694, "comment_id": 101089614, "body": "@hamidghadery Btw, don&#39;t mind the downvotes - the question isn&#39;t bad - it is just too broad : it would take hours to answer it propertly. I think you will be able to handle it with links provided by DavidW - and then you can write an answer yourself. If not, you can come back with a more specific question."}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1564606050, "post_id": 57296694, "comment_id": 101091199, "body": "@ead I don&#39;t actually think it is that broad - I&#39;d guess that someone familiar with (C)Go could translate the working C examples in the documentation really quite quickly. That person definitely isn&#39;t me. (My problem with this question is that it doesn&#39;t seem to have started from those examples so there&#39;s a lot wrong, but hopefully OP can fix that...)"}], "answers": [{"comments": [{"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1564606784, "post_id": 57298650, "comment_id": 101091447, "body": "Actually, because the Python interpreter must be embeded there is a little bit more to it. We need a &quot;translation&quot; to go of <a href=\"https://stackoverflow.com/questions/45419532/use-generated-header-file-from-cython\" title=\"use generated header file from cython\">stackoverflow.com/questions/45419532/&hellip;</a> or <a href=\"https://cython.readthedocs.io/en/latest/src/userguide/external_C_code.html#using-cython-declarations-from-c\" rel=\"nofollow noreferrer\">cython.readthedocs.io/en/latest/src/userguide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1564607610, "last_edit_date": 1564607610, "creation_date": 1564606208, "answer_id": 57298650, "question_id": 57296694, "link": "https://stackoverflow.com/questions/57296694/import-c-shared-library-that-generated-by-cython-to-go-with-cgo/57298650#57298650", "title": "import c-shared library that generated by cython to go with cgo", "body": "<blockquote>\n  <p>I run go run test.go: I have the following output:</p>\n\n<pre><code># command-line-arguments\n/usr/bin/ld: $WORK/b001/_x002.o: in function `_cgo_51159acd5c8e_Cfunc_hello':\n/tmp/go-build/cgo-gcc-prolog:48: undefined reference to `hello'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>We can generate an equivalent error message with the following code.</p>\n\n<pre><code>package main\n\n/*\n#include &lt;math.h&gt;\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n    cube2 := C.pow(2.0, 3.0)\n    fmt.Println(cube2)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run cube2.go\n# command-line-arguments\n/usr/bin/ld: $WORK/b001/_x002.o: in function `_cgo_f6c6fa139eda_Cfunc_pow':\n/tmp/go-build/cgo-gcc-prolog:53: undefined reference to `pow'\ncollect2: error: ld returned 1 exit status\n$ \n</code></pre>\n\n<p>In both cases, <code>ld</code> (the linker) can't find a C function after looking in the usual places: <code>undefined reference to 'pow'</code> or <code>undefined reference to 'hello'</code>.</p>\n\n<p>Let's tell <code>cgo</code> where to find the C <code>pow</code> function in the C <code>math</code> library: <code>m</code>. </p>\n\n<p>For <code>cgo</code>, using <code>ld</code> flags,</p>\n\n<pre><code>#cgo LDFLAGS: -lm\n</code></pre>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html\" rel=\"nofollow noreferrer\">GCC: 3.14 Options for Linking</a></p>\n\n<blockquote>\n<pre><code>-llibrary\n    Search the library named library when linking.\n</code></pre>\n</blockquote>\n\n<p>Updating the previous code,</p>\n\n<pre><code>package main\n\n/*\n#cgo LDFLAGS: -lm\n#include &lt;math.h&gt;\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n    cube2 := C.pow(2.0, 3.0)\n    fmt.Println(cube2)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run cube2.go\n8\n$\n</code></pre>\n\n<hr>\n\n<p>This illustrates a basic <code>cgo</code> principle: include a C header file for your C library and point to the location of the C library.</p>\n\n<hr>\n\n<p>References:</p>\n\n<p><a href=\"https://www.datadoghq.com/blog/engineering/cgo-and-python/\" rel=\"nofollow noreferrer\">Cgo and Python</a> : <a href=\"https://www.datadoghq.com/blog/engineering/cgo-and-python/#embedding-cpython-a-primer\" rel=\"nofollow noreferrer\">Embedding CPython: a primer</a></p>\n"}], "owner": {"reputation": 31, "user_id": 10050531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kRx5HefG3wU/AAAAAAAAAAI/AAAAAAAAABM/2w-qwEKNht0/photo.jpg?sz=128", "display_name": "hamid ghadery", "link": "https://stackoverflow.com/users/10050531/hamid-ghadery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 2, "accepted_answer_id": 57298650, "answer_count": 1, "score": -1, "last_activity_date": 1564607610, "creation_date": 1564596670, "last_edit_date": 1564600897, "question_id": 57296694, "link": "https://stackoverflow.com/questions/57296694/import-c-shared-library-that-generated-by-cython-to-go-with-cgo", "title": "import c-shared library that generated by cython to go with cgo", "body": "<p>I wanna import a c-shared-library to go that generated by Cython in python 3.7, try do it by cgo.</p>\n\n<p>in this case:</p>\n\n<blockquote>\n  <p>go version go1.12.7 linux/amd64</p>\n  \n  <p>Python 3.7.3</p>\n  \n  <p>Cython version 0.29.12</p>\n  \n  <p>os: Manjaro 18.0.4</p>\n  \n  <p>Kernel: x86_64 Linux 5.1.19-1</p>\n</blockquote>\n\n<p>I will continue:\nmake a python file <code>vim pylib.pyx</code>:</p>\n\n<pre><code>#!python\ncdef public void hello():\n     print(\"hello world!\")\n</code></pre>\n\n<p>and run <code>python -m cython pylib.pyx</code> for generate the c-shared-library, I have two files, <code>pylib.c</code> and <code>pylib.h</code>.\nnow, try import these to golang, so make a go file <code>vim test.go</code>:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;/usr/include/python3.7m/Python.h&gt;\n#include \"pylib.h\"\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n   C.hello()\n   fmt.Println(\"done\")\n}\n</code></pre>\n\n<p>finaly, I run <code>go run test.go</code>:\nI have the following output:</p>\n\n<blockquote>\n<pre><code># command-line-arguments\n/usr/bin/ld: $WORK/b001/_x002.o: in function `_cgo_51159acd5c8e_Cfunc_hello':\n/tmp/go-build/cgo-gcc-prolog:48: undefined reference to `hello'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n</blockquote>\n\n<p>I try import it to c too but I encountered a similar output like this:</p>\n\n<blockquote>\n<pre><code>undefined reference to `hello'\nld returned 1 exit status\n</code></pre>\n</blockquote>\n\n<p>I don't know what to do, help me, please. \n:(</p>\n"}, {"tags": ["go", "x509certificate", "pfx"], "comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 1, "creation_date": 1564596626, "post_id": 57296455, "comment_id": 101087432, "body": "Can you show us the code you&#39;ve tried so far?"}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 2, "creation_date": 1564596842, "post_id": 57296455, "comment_id": 101087511, "body": "Have a look at <a href=\"https://github.com/FiloSottile/mkcert\" rel=\"nofollow noreferrer\">github.com/FiloSottile/mkcert</a>"}, {"owner": {"reputation": 1, "user_id": 11865306, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Przoi9_6ICc/AAAAAAAAAAI/AAAAAAAAB2Y/vvG0YSL84dQ/photo.jpg?sz=128", "display_name": "Jonathan Innis", "link": "https://stackoverflow.com/users/11865306/jonathan-innis"}, "edited": false, "score": 0, "creation_date": 1564604531, "post_id": 57296455, "comment_id": 101090635, "body": "Added the attempted code to the description"}], "owner": {"reputation": 1, "user_id": 11865306, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Przoi9_6ICc/AAAAAAAAAAI/AAAAAAAAB2Y/vvG0YSL84dQ/photo.jpg?sz=128", "display_name": "Jonathan Innis", "link": "https://stackoverflow.com/users/11865306/jonathan-innis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564604515, "creation_date": 1564595593, "last_edit_date": 1564604515, "question_id": 57296455, "link": "https://stackoverflow.com/questions/57296455/how-to-create-and-store-a-self-signed-certificate-with-private-key-on-windows-us", "title": "How to create and store a self-signed certificate with private key on Windows using Go", "body": "<p>I am trying to create a self-signed certificate (including a private key) that I can store in the cert store without the help of Powershell. I am ok leveraging Windows API libraries using C but I am unfamiliar with how they work. I need to know how to create a certificate using Go and store that certificate in the certificate store on Windows.</p>\n\n<p>I have tried building a certificate using Go libraries and have tried using Windows APIs a little bit</p>\n\n<pre><code>certificate.PrivateKey, certificate.Err = rsa.GenerateKey(rand.Reader, 2048)\nif certificate.Err != nil {\n    logger.Lg.Errorf(certificate.Err, \"Failed to generate the private key\")\n    return\n}\n\nvar serialNumber *big.Int\nnotBefore := time.Now()\nnotAfter := notBefore.Add(365 * 24 * time.Hour)\n\nserialNumberLimit := new(big.Int).Lsh(big.NewInt(1), 128)\nserialNumber, certificate.Err = rand.Int(rand.Reader, serialNumberLimit)\nif certificate.Err != nil {\n    logger.Lg.Errorf(certificate.Err, \"Failed to generate the serial number\")\n    return\n}\n\ntemplate := x509.Certificate{\n    SerialNumber: serialNumber,\n    Subject: pkix.Name{\n        Organization: []string{\"\"},\n    },\n    NotBefore: notBefore,\n    NotAfter:  notAfter,\n\n    KeyUsage:              x509.KeyUsageKeyEncipherment | x509.KeyUsageDigitalSignature | x509.KeyUsageCertSign,\n    ExtKeyUsage:           []x509.ExtKeyUsage{x509.ExtKeyUsageServerAuth},\n    BasicConstraintsValid: true,\n    IsCA:                  true,\n}\n\ncertificate.DerBytes, certificate.Err = x509.CreateCertificate(rand.Reader, &amp;template, &amp;template, &amp;certificate.PrivateKey.PublicKey, certificate.PrivateKey)\nif certificate.Err != nil {\n    logger.Lg.Errorf(certificate.Err, \"Failed to create the certificate\")\n    return\n}\n\ninfo, _ := pkcs12.Encode(rand.Reader, certificate.PrivateKey, &amp;template, nil, \"\")\nioutil.WriteFile(\"a.pfx\", info, 0644)\nout := base64.StdEncoding.EncodeToString(info)\nfmt.Println(out)\n</code></pre>\n"}, {"tags": ["mongodb", "performance", "go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 2, "creation_date": 1564590107, "post_id": 57294734, "comment_id": 101084549, "body": "probably a <a href=\"https://en.wikipedia.org/wiki/Lazy_initialization\" rel=\"nofollow noreferrer\">lazy connection</a>?"}, {"owner": {"reputation": 21, "user_id": 11863947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rdotdnwAv98/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdrZ-VPKllU0qeGRhWwSldzCgEVKg/photo.jpg?sz=128", "display_name": "StorQL", "link": "https://stackoverflow.com/users/11863947/storql"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1564591226, "post_id": 57294734, "comment_id": 101085107, "body": "I don&#39;t think so. The official MongoDB driver documentation doesn&#39;t mention any lazy connection, nor any way to configure a non-lazy connection; besides, even if you prepend a call to <code>client.Ping(context.TODO(), nil)</code> - which would force the connection to be established - the first InsertOne remains slow."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1564591340, "post_id": 57294734, "comment_id": 101085152, "body": "Most DB drivers do a lazy connect. Try using a bad password. The connection will create just fine, but the first query will fail (as the lazy connect kicks in)."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1564591442, "post_id": 57294734, "comment_id": 101085203, "body": "To force a connect with a noop operation, try Ping()."}, {"owner": {"reputation": 21, "user_id": 11863947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rdotdnwAv98/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdrZ-VPKllU0qeGRhWwSldzCgEVKg/photo.jpg?sz=128", "display_name": "StorQL", "link": "https://stackoverflow.com/users/11863947/storql"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1564591706, "post_id": 57294734, "comment_id": 101085323, "body": "You guys were right. I added Ping() but I did it the wrong way, ending up with 2 database connection objects, only one of which was &quot;pinged&quot;. Ping() the right object solved the problem. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1564645577, "post_id": 57295781, "comment_id": 101101138, "body": "Furthermore, this gives you an opportunity to handle connection problems as early as possible."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 2, "last_activity_date": 1564593032, "last_edit_date": 1564593032, "creation_date": 1564592457, "answer_id": 57295781, "question_id": 57294734, "link": "https://stackoverflow.com/questions/57294734/why-is-collection-insertone-so-slow-at-inserting-the-first-element/57295781#57295781", "title": "Why is collection.InsertOne so slow at inserting the first element?", "body": "<p>Just to close out the question from the comments:</p>\n\n<p>The MongoDB driver uses a <a href=\"https://en.wikipedia.org/wiki/Lazy_initialization\" rel=\"nofollow noreferrer\">lazy connection</a>. See the <a href=\"https://github.com/mongodb/mongo-go-driver\" rel=\"nofollow noreferrer\">MongoDB docs</a>, specifically:</p>\n\n<blockquote>\n  <p>Calling Connect does not block for server discovery. If you wish to\n  know if a MongoDB server has been found and connected to, use the Ping\n  method:</p>\n</blockquote>\n\n<pre><code>ctx, _ = context.WithTimeout(context.Background(), 2*time.Second)\nerr = client.Ping(ctx, readpref.Primary())\n</code></pre>\n\n<p>This will force a connect and remove the insert delay from your first insert.</p>\n"}], "owner": {"reputation": 21, "user_id": 11863947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rdotdnwAv98/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdrZ-VPKllU0qeGRhWwSldzCgEVKg/photo.jpg?sz=128", "display_name": "StorQL", "link": "https://stackoverflow.com/users/11863947/storql"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1564593032, "creation_date": 1564588450, "question_id": 57294734, "link": "https://stackoverflow.com/questions/57294734/why-is-collection-insertone-so-slow-at-inserting-the-first-element", "title": "Why is collection.InsertOne so slow at inserting the first element?", "body": "<p>I'm testing the new official MongoDB driver for Go, and I noticed that the first call to collection.InsertOne always takes a ton of time, while all subsequent calls to it are blazingly fast. Why? And how to avoid this disruptive behavior?</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"log\"\n    \"time\"\n\n    \"go.mongodb.org/mongo-driver/mongo\"\n    \"go.mongodb.org/mongo-driver/mongo/options\"\n)\n\ntype Trainer struct {\n    Name string\n    Age  int\n    City string\n}\n\nfunc main() {\n\n    t1 := time.Now()\n\n    // Set client options\n    clientOptions := options.Client().ApplyURI(\"mongodb://localhost:27017\")\n\n    log.Println(\"Setting client options took\", time.Now().Sub(t1))\n    t1 = time.Now()\n\n    // Connect to MongoDB\n    client, err := mongo.Connect(context.TODO(), clientOptions)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    log.Println(\"Connecting took\", time.Now().Sub(t1))\n    t1 = time.Now()\n\n    // Some dummy data to add to the Database\n    ash := Trainer{\"Ash\", 30, \"Pallet Town\"}\n\n    // Get a handle for your collection\n    collection := client.Database(\"test\").Collection(\"trainers\")\n    // Insert a single document\n\n    log.Println(\"Getting the collection took\", time.Now().Sub(t1))\n    t1 = time.Now()\n\n    for i := 0; i &lt; 10; i++ {\n        _, err := collection.InsertOne(context.TODO(), ash)\n        if err != nil {\n            log.Fatal(err)\n        }\n        log.Println(\"Inserting document took\", time.Now().Sub(t1))\n        t1 = time.Now()\n    }\n\n    err = client.Disconnect(context.TODO())\n\n}\n</code></pre>\n\n<p>I expected all insert operations to take milliseconds or nanoseconds, while the first one takes about 0.6 seconds. Here's the log with timing:</p>\n\n<pre><code>2019/07/31 17:41:39 Setting client options took 0s\n2019/07/31 17:41:39 Connecting took 0s\n2019/07/31 17:41:39 Getting the collection took 0s\n2019/07/31 17:41:40 Inserting document took 606.0339ms\n2019/07/31 17:41:40 Inserting document took 0s\n2019/07/31 17:41:40 Inserting document took 0s\n2019/07/31 17:41:40 Inserting document took 0s\n2019/07/31 17:41:40 Inserting document took 0s\n2019/07/31 17:41:40 Inserting document took 0s\n2019/07/31 17:41:40 Inserting document took 875.2\u00b5s\n2019/07/31 17:41:40 Inserting document took 0s\n2019/07/31 17:41:40 Inserting document took 0s\n2019/07/31 17:41:40 Inserting document took 0s\n</code></pre>\n"}, {"tags": ["go", "testing", "visual-studio-code"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1564586798, "post_id": 57294130, "comment_id": 101082752, "body": "Why are your tests <i>actually</i> writing to disk? Why not create a buffer that implements a <code>ReadWriter</code> interface, and just keep it in memory instead?"}, {"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564586884, "post_id": 57294130, "comment_id": 101082802, "body": "For the project root I usually just set it as an environment var (e.g. <code>PROJECT_ROOT=$(pwd)</code> and then I can reference that in the code. Alternatively you can check if the dir ends in &quot;test/&quot; and if so go up one, though using the env var is much more foolproof."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1564587346, "post_id": 57294130, "comment_id": 101083057, "body": "Tests always execute with the working directory set to the directory containing the source code for that test. That&#39;s behavior of <code>go test</code> and not VSCode. The location of the test binary on the other hand is not defined (but typically the systems temporary directory). Consequently you can and should rely on relative paths in tests, if you really need the filesystem."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1564588114, "post_id": 57294130, "comment_id": 101083506, "body": "As an aside, <a href=\"https://godoc.org/os#Executable\" rel=\"nofollow noreferrer\">os.Executable</a> is the preferred function for getting the path to the executable.  As noted in the previous comment, use paths relative to the current working directory, not the executable."}], "answers": [{"comments": [{"owner": {"reputation": 2249, "user_id": 5766143, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ztzpE.jpg?s=128&g=1", "display_name": "relief.melone", "link": "https://stackoverflow.com/users/5766143/relief-melone"}, "edited": false, "score": 0, "creation_date": 1564600217, "post_id": 57295535, "comment_id": 101088962, "body": "thanks that&#39;s a good approach. just started with go after several years of type and javascript and my alternative would have been to switch to dependency injection but I&#39;m dearly missing the default values for parameters from typescript"}], "tags": [], "owner": {"reputation": 4661, "user_id": 1692706, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GyaAv.png?s=128&g=1", "display_name": "Debosmit Ray", "link": "https://stackoverflow.com/users/1692706/debosmit-ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1564591467, "creation_date": 1564591467, "answer_id": 57295535, "question_id": 57294130, "link": "https://stackoverflow.com/questions/57294130/how-to-make-go-tests-work-with-filesystem/57295535#57295535", "title": "How to make Go tests Work with Filesystem", "body": "<p>Instead of having tests write directly to a file on disk (potential for concurrency issues with this model), you should use a layer of abstraction on top of the filesystem (not <code>ioutil</code>).</p>\n\n<p><a href=\"https://github.com/spf13/afero\" rel=\"nofollow noreferrer\"><code>github.com/spf13/afero</code></a> is a great library to use for this purpose. For your test cases, you can simply pass a MemFs layer instead of the OsFs (instructions <a href=\"https://github.com/spf13/afero#step-2-declare-a-backend\" rel=\"nofollow noreferrer\">here</a>).</p>\n"}], "owner": {"reputation": 2249, "user_id": 5766143, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ztzpE.jpg?s=128&g=1", "display_name": "relief.melone", "link": "https://stackoverflow.com/users/5766143/relief-melone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 57295535, "answer_count": 1, "score": 1, "last_activity_date": 1564591467, "creation_date": 1564586496, "last_edit_date": 1564588061, "question_id": 57294130, "link": "https://stackoverflow.com/questions/57294130/how-to-make-go-tests-work-with-filesystem", "title": "How to make Go tests Work with Filesystem", "body": "<p>I'm experiencing some problems testing my Go application with VsCode. This is my launch.json</p>\n\n<pre><code>\n{\n  \"name\": \"Test\",\n  \"type\": \"go\",\n  \"request\": \"launch\",\n  \"mode\": \"test\",\n  \"program\": \"${workspaceFolder}/test\",\n  \"env\": {},\n  \"args\": []\n}\n</code></pre>\n\n<p>Now i have the problem that my application is supposed to write files in a subfolder (atm it's ./temp). To do this i have 2 functions the first one is to determine the filepath</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func getFilePath() string {\n    dir, err := filepath.Abs(filepath.Dir(os.Args[0]))\n    if err != nil {\n        panic(err)\n    }\n    return dir + \"/temp/ocicd-config.yaml\"\n}\n\n</code></pre>\n\n<p>and another one to Save the file</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func SaveToYaml(Config Structs.Project) {\n    fmt.Println(\"Saving Config\")\n    yaml, err := yaml.Marshal(Config)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(yaml))\n    ioutil.WriteFile(getFilePath(), yaml, 0644)\n}\n</code></pre>\n\n<p>as well as to load the file</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Load() Structs.Project {\n    fmt.Println(\"Loading Config\")\n    file, err := ioutil.ReadFile(getFilePath())\n    if err != nil {\n        panic(err)\n    }\n    project := Structs.Project{}\n    err = yaml.Unmarshal(file, &amp;project)\n    if err != nil {\n        panic(err)\n    }\n    return project\n}\n</code></pre>\n\n<p>Now the problem is that VsCode makes the application run in the ./test subfolder which makes my application try to load from and save to ./test/temp which is not what i want. I tried to change my launch.json to actually use ${workspace} as program and use \"./test\" as an argument but that makes the tests stop working alltogether. Now I am pretty lost. Any ideas how I could solve this problem?</p>\n"}, {"tags": ["google-app-engine", "go", "travis-ci"], "comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564585847, "post_id": 57293783, "comment_id": 101082235, "body": "You have it configured to build your app but is there anything telling GAE how to run it?"}, {"owner": {"reputation": 24749, "user_id": 365738, "user_type": "registered", "accept_rate": 98, "profile_image": "https://lh4.googleusercontent.com/-BOj_FEcSw24/AAAAAAAAAAI/AAAAAAAAAD8/sDXPt5Ijxc4/photo.jpg?sz=128", "display_name": "sethvargo", "link": "https://stackoverflow.com/users/365738/sethvargo"}, "edited": false, "score": 0, "creation_date": 1564586001, "post_id": 57293783, "comment_id": 101082318, "body": "Doesn&#39;t push to GAE, but github.com/GoogleCloudPlatform/berglas has some good Cloud Build + GCR stuff to look at."}, {"owner": {"reputation": 1, "user_id": 8605808, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jooaUiHppuQ/AAAAAAAAAAI/AAAAAAAAABE/RYT3ATrlSHo/photo.jpg?sz=128", "display_name": "John Forstmeier", "link": "https://stackoverflow.com/users/8605808/john-forstmeier"}, "reply_to_user": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564588805, "post_id": 57293783, "comment_id": 101083867, "body": "@user2896976 No, and I think that&#39;s my gap in understanding. Where/how would that be invoked?"}, {"owner": {"reputation": 1, "user_id": 8605808, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jooaUiHppuQ/AAAAAAAAAAI/AAAAAAAAABE/RYT3ATrlSHo/photo.jpg?sz=128", "display_name": "John Forstmeier", "link": "https://stackoverflow.com/users/8605808/john-forstmeier"}, "reply_to_user": {"reputation": 24749, "user_id": 365738, "user_type": "registered", "accept_rate": 98, "profile_image": "https://lh4.googleusercontent.com/-BOj_FEcSw24/AAAAAAAAAAI/AAAAAAAAAD8/sDXPt5Ijxc4/photo.jpg?sz=128", "display_name": "sethvargo", "link": "https://stackoverflow.com/users/365738/sethvargo"}, "edited": false, "score": 0, "creation_date": 1564588807, "post_id": 57293783, "comment_id": 101083871, "body": "@sethvargo Seems like a good resource and you&#39;re right, I can&#39;t see anything related to GAE pushes."}, {"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564593298, "post_id": 57293783, "comment_id": 101086016, "body": "These docs should lead you in the right direction. In the Deploying Artifacts section select &quot;App Engine&quot;. <a href=\"https://cloud.google.com/cloud-build/docs/configuring-builds/build-test-deploy-artifacts\" rel=\"nofollow noreferrer\">cloud.google.com/cloud-build/docs/configuring-builds/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8605808, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jooaUiHppuQ/AAAAAAAAAAI/AAAAAAAAABE/RYT3ATrlSHo/photo.jpg?sz=128", "display_name": "John Forstmeier", "link": "https://stackoverflow.com/users/8605808/john-forstmeier"}, "reply_to_user": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564618742, "post_id": 57293783, "comment_id": 101094267, "body": "@Jesse I&#39;ve tried a couple different variations of what I found in that resource but I&#39;m not able to get it to work. I assume I would keep my <code>.travis.yml</code> file as is: <a href=\"https://github.com/forstmeier/watchmyrepo/blob/gae-standard/.travis.yml\" rel=\"nofollow noreferrer\">github.com/forstmeier/watchmyrepo/blob/gae-standard/.travis.&zwnj;&#8203;yml</a>. I&#39;m still not seeing artifacts/files appearing in GAE either."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8605808, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jooaUiHppuQ/AAAAAAAAAAI/AAAAAAAAABE/RYT3ATrlSHo/photo.jpg?sz=128", "display_name": "John Forstmeier", "link": "https://stackoverflow.com/users/8605808/john-forstmeier"}, "edited": false, "score": 0, "creation_date": 1564698666, "post_id": 57311838, "comment_id": 101126885, "body": "The first point yes, I could try configuring that option as well. I tried it previously but it didn&#39;t yield any real results and I was basically where I am now. Regarding the second point, if you look at the <a href=\"https://cloud.google.com/free/docs/gcp-free-tier\" rel=\"nofollow noreferrer\">Always Free usage limits</a> section, it seems to indicate that only standard environment is free whereas flexible is not."}], "tags": [], "owner": {"reputation": 459, "user_id": 8210931, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207555656569550/picture?type=large", "display_name": "Enrique Del Valle", "link": "https://stackoverflow.com/users/8210931/enrique-del-valle"}, "is_accepted": false, "score": 0, "last_activity_date": 1564671437, "creation_date": 1564671437, "answer_id": 57311838, "question_id": 57293783, "link": "https://stackoverflow.com/questions/57293783/how-can-i-configure-my-repository-and-travisci-to-automate-deployments-to-gae-st/57311838#57311838", "title": "How can I configure my repository and TravisCI to automate deployments to GAE standard environment?", "body": "<p>It seems that you have 2 main questions here.</p>\n\n<p>1- How automatically deployed on pushes to master on GitHub?\n   For this you can use Running builds on GitHub[1].\n   Google Cloud Build lets you create fast, consistent, reliable builds across all \n   languages. Automatically build containers or non-container artifacts on commits to \n   your GitHub repository. Get complete control over defining custom workflows for \n   building, testing, and deploying across multiple environments such as VMs, \n   serverless, Kubernetes, or Firebase.</p>\n\n<p>2.-How to set-up Google App Engine's flexible environment to take advantage of the free tier?\n  From my point of view you where well addressed by @Jesse</p>\n\n<p>[1] <a href=\"https://cloud.google.com/cloud-build/docs/run-builds-on-github\" rel=\"nofollow noreferrer\">https://cloud.google.com/cloud-build/docs/run-builds-on-github</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8605808, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jooaUiHppuQ/AAAAAAAAAAI/AAAAAAAAABE/RYT3ATrlSHo/photo.jpg?sz=128", "display_name": "John Forstmeier", "link": "https://stackoverflow.com/users/8605808/john-forstmeier"}, "is_accepted": false, "score": 0, "last_activity_date": 1565017805, "creation_date": 1565017805, "answer_id": 57361412, "question_id": 57293783, "link": "https://stackoverflow.com/questions/57293783/how-can-i-configure-my-repository-and-travisci-to-automate-deployments-to-gae-st/57361412#57361412", "title": "How can I configure my repository and TravisCI to automate deployments to GAE standard environment?", "body": "<p>I think the <code>watchmyrepo.db</code> file was exactly the problem or at least that's what it looks like in the logs (which I failed to find/review). I'm planning on migrating this over two Datastore or something else and moving off of BoltDB so that should alleviate the issue.</p>\n\n<p></p>\n\n<p>It was all just coding issues on my part that were generating 500/502 errors and those have now all been resolved - thanks!</p>\n"}], "owner": {"reputation": 1, "user_id": 8605808, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jooaUiHppuQ/AAAAAAAAAAI/AAAAAAAAABE/RYT3ATrlSHo/photo.jpg?sz=128", "display_name": "John Forstmeier", "link": "https://stackoverflow.com/users/8605808/john-forstmeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565017805, "creation_date": 1564585312, "question_id": 57293783, "link": "https://stackoverflow.com/questions/57293783/how-can-i-configure-my-repository-and-travisci-to-automate-deployments-to-gae-st", "title": "How can I configure my repository and TravisCI to automate deployments to GAE standard environment?", "body": "<p>I'm in the process of configuring my Go app to be able to be automatically deployed on pushes to <code>master</code> on GitHub.</p>\n\n<p>So far, I've been able to set it up using Google App Engine's flexible environment but I'm unable to take advantage of the free tier by doing so. I'm pretty sure what I'm doing wrong is misconfiguring my <code>cloudbuild.yml</code> file since it <em>seems</em> like the code is actually getting to GAE but it will not run when it gets there.</p>\n\n<p>Here's my <code>app.yaml</code>:</p>\n\n<pre><code>runtime: go112\n</code></pre>\n\n<p>Here's my <code>cloudbuild.yaml</code>:</p>\n\n<pre><code>steps:\n  - name: 'golang'\n    args: ['go', 'build', '.']\n    env: ['GO111MODULE=on']\n</code></pre>\n\n<p>The Go app itself is relatively standard in its layout/design and can be found <a href=\"https://github.com/forstmeier/watchmyrepo/tree/gae-standard\" rel=\"nofollow noreferrer\">here where I'm working on the \"gae-standard\" branch</a>.</p>\n\n<p>I'd ideally love to have:\n- TravisCI run tests/deploy code to GAE\n- GAE running the code in the standard environment</p>\n\n<p>If anyone has a good example to point me at, or some insight into what I'm doing wrong, I'd appreciate it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564585463, "post_id": 57293097, "comment_id": 101082004, "body": "You can simplify this a bit by moving <code>iDetail</code> and <code>iKey</code> into the for loop itself, e.g. <code>for iDetail, detail := range apiMain.Details</code>"}, {"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 1, "creation_date": 1564585510, "post_id": 57293097, "comment_id": 101082038, "body": "As for the index out of range error, you&#39;re looping over apiMain.Details but accessing dataGrouped.Details which has not been set yet. Probably what you want is to make a new Details object and append it to dataGrouped.Details"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 1329558, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e1115144eaaee3a3df72abbb777f751?s=128&d=identicon&r=PG", "display_name": "CSKR", "link": "https://stackoverflow.com/users/1329558/cskr"}, "is_accepted": false, "score": -1, "last_activity_date": 1564587770, "creation_date": 1564587770, "answer_id": 57294526, "question_id": 57293097, "link": "https://stackoverflow.com/questions/57293097/transform-a-data-structure-in-go-panic-runtime-error-index-out-of-range/57294526#57294526", "title": "Transform a data structure in go: panic: runtime error: index out of range", "body": "<p>My two cents: Could you please whether the object is null or not, because the panic error clearly says \"index out of range\", and also check for the lower and upper boundaries in the for loop.</p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 3, "last_activity_date": 1564592670, "last_edit_date": 1564592670, "creation_date": 1564589558, "answer_id": 57295054, "question_id": 57293097, "link": "https://stackoverflow.com/questions/57293097/transform-a-data-structure-in-go-panic-runtime-error-index-out-of-range/57295054#57295054", "title": "Transform a data structure in go: panic: runtime error: index out of range", "body": "<h2>The problem</h2>\n\n<p>The reason is simple:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var dataGrouped DataGroupedByTS\n</code></pre>\n\n<p>initializes the fields of <code>dataGrouped</code> to the so-called\nzero value for the type <code>DataGroupedByTS</code>.</p>\n\n<p>The zero value of any compound type <code>T</code> consists of\nthe zero-values for types corresponding to each of the fields of <code>T</code>.</p>\n\n<p>So, for</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type DataGroupedByTS struct {\n    CodeConv string    `json:\"codeConv\"`\n    Start    time.Time `json:\"start\"`\n    End      time.Time `json:\"end\"`\n    Details  []struct {\n        Timestamp time.Time `json:\"timestamp\"`\n        Keys      []struct {\n            IDPrm string  `json:\"idPrm\"`\n            Value float64 `json:\"value\"`\n        } `json:\"keys\"`\n    } `json:\"details\"`\n}\n</code></pre>\n\n<p>the zero value would be</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type DataGroupedByTS struct {\n    CodeConv: \"\",\n    Start:    time.Time(0),\n    End:      time.Time(0),\n    Details:  nil,           // watch this!\n}\n</code></pre>\n\n<p>That's because the type of <code>Details</code> is <code>[]struct{ ... }</code>,\nthat is, a slice of some structs, and the zero-value of any slice is <code>nil</code>.</p>\n\n<p>You then go on and attempt to write at some index into a non-existing slice (well, the slice without any backing array allocated to hold its data).\nThis reasonably fails with \"panic: runtime error: index out of range\": an unallocated slice has zero elements, so there is no element at index 0, and there is nothing to assign to.</p>\n\n<h2>The fix</h2>\n\n<p>Two ways:</p>\n\n<ol>\n<li><p>Preallocate the destination slice:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    var dataGrouped DataGroupedByTS\n    // ...\n    dataGrouped.Details = make([]struct{...}, len(apiMain.Details))\n    for _, detail := range apiMain.Details {\n    // ...\n</code></pre></li>\n<li><p>Append to a slice, rather than updating its elements in place:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    var dataGrouped DataGroupedByTS\n    // ...\n    for _, detail := range apiMain.Details {\n        dataGrouped.Details = append(dataGrouped.Details, detail)\n        // ...\n</code></pre>\n\n<p>It's OK to <code>append</code> to a <code>nil</code> slice.</p></li>\n</ol>\n"}], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 57295054, "answer_count": 2, "score": -1, "last_activity_date": 1564592670, "creation_date": 1564583135, "last_edit_date": 1564583440, "question_id": 57293097, "link": "https://stackoverflow.com/questions/57293097/transform-a-data-structure-in-go-panic-runtime-error-index-out-of-range", "title": "Transform a data structure in go: panic: runtime error: index out of range", "body": "<p>I have a data structure in go: </p>\n\n<pre><code>type APIMain struct {\n    CodeConv string    `json:\"codeConv\"`\n    Start    time.Time `json:\"start\"`\n    End      time.Time `json:\"end\"`\n    Details  []struct {\n        IDPrm string `json:\"idPrm\"`\n        Keys  []struct {\n            Timestamp time.Time `json:\"timestamp\"`\n            Value     float64   `json:\"value\"`\n        } `json:\"keys\"`\n    } `json:\"details\"`\n}\n</code></pre>\n\n<p>that I need to transform to:</p>\n\n<pre><code>type DataGroupedByTS struct {\n    CodeConv string    `json:\"codeConv\"`\n    Start    time.Time `json:\"start\"`\n    End      time.Time `json:\"end\"`\n    Details  []struct {\n        Timestamp time.Time `json:\"timestamp\"`\n        Keys      []struct {\n            IDPrm string  `json:\"idPrm\"`\n            Value float64 `json:\"value\"`\n        } `json:\"keys\"`\n    } `json:\"details\"`\n}\n</code></pre>\n\n<p>I get: </p>\n\n<pre><code> panic: runtime error: index out of range\n</code></pre>\n\n<p>Here is my method but it is failing on the first line of loop:</p>\n\n<pre><code>func groupByTimestamp(apiMain datacheck.APIMain) DataGroupedByTS {\n    var dataGrouped DataGroupedByTS\n    dataGrouped.CodeConv = apiMain.CodeConv\n    dataGrouped.Start = apiMain.Start\n    dataGrouped.Start = apiMain.Start\n    dataGrouped.End = apiMain.End\n\n    var iDetail = 0\n    var iKey = 0\n    for _, detail := range apiMain.Details {\n        for _, key := range detail.Keys {\n            dataGrouped.Details[iDetail].Timestamp = key.Timestamp  // &lt;-- failing here\n            dataGrouped.Details[iDetail].Keys[iKey].IDPrm = detail.IDPrm\n            dataGrouped.Details[iDetail].Keys[iKey].Value = key.Value\n            iKey++\n        }\n        iDetail++\n    }\n\n    return dataGrouped\n}\n</code></pre>\n\n<p>Basically, data originally comes grouped by <code>IDPrm</code>, and I need to group it by timestamp.</p>\n\n<p>How should I do that ? Is there any helpers that could help doing it ?</p>\n"}, {"tags": ["json", "go", "get"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1564579596, "post_id": 57291498, "comment_id": 101078064, "body": "The response JSON is not an array but an object, so if you&#39;re passing <code>result</code> which is an array according to your comment (<i>&quot;result is empty array&quot;</i>) then that&#39;s your problem."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1564579672, "post_id": 57291498, "comment_id": 101078118, "body": "... it would be easier to help you if you show the declaration of the <code>result</code> variable."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564579764, "post_id": 57291498, "comment_id": 101078171, "body": "You shouldn&#39;t use or print <code>result</code> without checking the error return <code>err</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "is_accepted": false, "score": 0, "last_activity_date": 1564579861, "creation_date": 1564579861, "answer_id": 57291989, "question_id": 57291498, "link": "https://stackoverflow.com/questions/57291498/issue-parsing-json-file-with-go/57291989#57291989", "title": "Issue parsing JSON file with Go", "body": "<p>I fixed it using: <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a></p>\n\n<p>which generated this structure: </p>\n\n<pre><code>type AutoGenerated struct {\n    CodeConv string    `json:\"codeConv\"`\n    Start    time.Time `json:\"start\"`\n    End      time.Time `json:\"end\"`\n    Details  []struct {\n        IDPrm string `json:\"idPrm\"`\n        Keys  []struct {\n            Timestamp time.Time `json:\"timestamp\"`\n            Value     float64   `json:\"value\"`\n        } `json:\"keys\"`\n    } `json:\"details\"`\n}\n</code></pre>\n\n<p>Thanks for your comments</p>\n\n<p>Great time saver !</p>\n"}], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1564588075, "creation_date": 1564578471, "question_id": 57291498, "link": "https://stackoverflow.com/questions/57291498/issue-parsing-json-file-with-go", "title": "Issue parsing JSON file with Go", "body": "<p>I make a GET request, and receive a JSON file, that I cannot parse.</p>\n\n<p>Here is the data I have to parse</p>\n\n<pre><code>{\n    \"codeConv\": \"ACC00000321\",\n    \"start\": \"2019-07-01T00:00:00Z\",\n    \"end\": \"2019-08-21T00:00:00Z\",\n    \"details\": [\n        {\n            \"idPrm\": \"30000000123456\",\n            \"keys\": [\n                {\n                    \"timestamp\": \"2019-07-01T00:00:00Z\",\n                    \"value\": 0\n                },\n                {\n                    \"timestamp\": \"2019-07-01T00:30:00Z\",\n                    \"value\": 0\n                },\n                ...\n            ]\n        }, \n        {\n            \"idPrm\": \"30000000123457\",\n            \"keys\": [\n                {\n                    \"timestamp\": \"2019-07-01T00:00:00Z\",\n                    \"value\": 1\n                },\n                {\n                    \"timestamp\": \"2019-07-01T00:30:00Z\",\n                    \"value\": 2\n                },\n                ...\n            ]\n        }\n    ]\n}\n</code></pre>\n\n<p>Here are my objects:</p>\n\n<pre><code>type APIMain struct {\n    CodeConv string          `json:\"codeConv\"`\n    Start    string          `json:\"start\"`\n    End      []Keys          `json:\"end\"`\n    Details  []APIData `json:\"details\"`\n}\n\n//APIData match the data we receive from api\ntype APIData struct {\n    Prm  string `json:\"idPrm\"`\n    Keys []Keys `json:\"keys\"`\n}\n\ntype Keys struct {\n    Timestamp string `json:\"timestamp\"`\n    Value     string `json:\"value\"`\n}\n</code></pre>\n\n<p>and here is the method to get data with basic auth:</p>\n\n<pre><code>tr := &amp;http.Transport{\n        TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n    }\n    client := &amp;http.Client{Transport: tr}\n    req, err := http.NewRequest(\"GET\", url, nil)\n\n    if err != nil {\n        return nil, err\n    }\n    if login != \"\" &amp;&amp; password != \"\" {\n        req.SetBasicAuth(login, password)\n    }\n\n    response, err := client.Do(req)\n    //defer response.Body.Close()\n    if err != nil {\n        return nil, err\n    }\n    if response.StatusCode != 200 {\n        fmt.Println(response.Body)\n        panic(response.Status)\n    }\n\n    err = json.NewDecoder(response.Body).Decode(&amp;result)\n    fmt.Println(\"result\", result) // result is empty array\n</code></pre>\n\n<p>How can I see if the problem is in a request, or if the problem is in parsing ?</p>\n\n<p>I have get a <code>response.Body</code> object, but it needs to be decoded.</p>\n"}, {"tags": ["go", "discord"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1564577421, "post_id": 57290894, "comment_id": 101076725, "body": "Nowhere in that code is <code>SessionFunc</code> handling <code>bareSession</code>. <code>bareSession</code> is set once <a href=\"https://github.com/jonas747/dshardmanager/blob/9e4282faed43932341980f0e5f11fa88e73b04a2/dshardmanager.go#L78\" rel=\"nofollow noreferrer\">here</a> and from then on it&#39;s only read from. It seems to be intended not to be touched. Using <code>reflect</code> and <code>unsafe</code> you could set it&#39;s fields however that is something you should avoid doing at all cost."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1564577599, "post_id": 57290894, "comment_id": 101076841, "body": "... if there isn&#39;t any other 3rd party package that allows you to do what you need, you have the option to fork the project and simply export the <code>bareSession</code> field."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1564592256, "post_id": 57290894, "comment_id": 101085566, "body": "&quot;I&#39;d like to learn the best practices approach to doing this&quot; - is not to. The &quot;best practice&quot; is don&#39;t tinker with unexported members. That&#39;s why unexported members exist."}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1564577779, "creation_date": 1564577779, "answer_id": 57291265, "question_id": 57290894, "link": "https://stackoverflow.com/questions/57290894/unsure-how-to-overwrite-a-callback-to-adjust-unexported-field/57291265#57291265", "title": "Unsure how to overwrite a callback to adjust unexported field", "body": "<p>This will not allow you to change <code>bareSession</code>. But if you need to derive a new <code>*discordgo.Session</code> with custom parameters you can do something similar to as follows.</p>\n\n<pre><code>func MySessionFunc(m *dshardmanager.Manager) dshardmanager.SessionFunc {\n    return func(token string) (*discordgo.Session, error) {\n        //Call default Session allocator\n        s, err := m.StdSessionFunc(token)\n        if err != nil {\n            return nil, err\n        }\n        //Then, change its exported fields\n        s.State.TrackRoles = false\n        s.TrackPresences = false\n        return s, nil\n    }\n}\n\nfunc main() {\n    manager := dshardmanager.New(\"Bot \" + token)\n    manager.SessionFunc = MySessionFunc(manager)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55556, "user_id": 197606, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/14da0a77145571d61cee03ac6bb0fb35?s=128&d=identicon&r=PG", "display_name": "Webnet", "link": "https://stackoverflow.com/users/197606/webnet"}, "edited": false, "score": 0, "creation_date": 1564602561, "post_id": 57291295, "comment_id": 101089931, "body": "This is super helpful, thanks.  Is there a way for me to &quot;extend&quot; <code>SessionFunc</code> without having to duplicate the logic in my code?"}, {"owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "reply_to_user": {"reputation": 55556, "user_id": 197606, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/14da0a77145571d61cee03ac6bb0fb35?s=128&d=identicon&r=PG", "display_name": "Webnet", "link": "https://stackoverflow.com/users/197606/webnet"}, "edited": false, "score": 1, "creation_date": 1564662078, "post_id": 57291295, "comment_id": 101110196, "body": "I just checked the code for dshardmanager, there&#39;s the function StdSessionFunc which contains the default implementation for SessionFunc, so you can call it inside your own custom function (i.e. s, err := manager.StdSessionFunc(token) ... )"}], "tags": [], "owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "is_accepted": true, "score": 1, "last_activity_date": 1564577867, "creation_date": 1564577867, "answer_id": 57291295, "question_id": 57290894, "link": "https://stackoverflow.com/questions/57290894/unsure-how-to-overwrite-a-callback-to-adjust-unexported-field/57291295#57291295", "title": "Unsure how to overwrite a callback to adjust unexported field", "body": "<p>I don't know the context of that library, so I'm not sure if what I'll write here makes sense for you :) But by looking at the API, <code>SessionFunc</code> is a <code>func(token string) (*discordgo.Session, error)</code>, i.e., a function which receives a <code>string</code> and returns a <code>Session</code> and an <code>error</code>. So you can make something like this to override it:</p>\n\n<pre><code>func main() {\n    manager := dshardmanager.New(\"Bot \" + token)\n    manager.SessionFunc = func(token string) (*discordgo.Session, error) {\n        // use \"token\"\n\n        // if invalid:\n        if token == \"\" {\n            // return an error\n            return nil, fmt.Errorf(\"invalid token\")\n        }\n\n        // otherwise, return a valid session\n        return &amp;discordgo.Session{}\n    }\n\n    // more stuff happens down here\n}\n</code></pre>\n\n<p>The code is obviously very generic, but the main idea is that you need to define that function with that exact header, and implement it. I don't know how you can, for example, evaluate the token parameter or create a <code>discordgo.Session</code>. Or how you can configure the <code>TrackRoles</code> or <code>TrackPresences</code> values by using <code>SessionFunc</code>. That's very specific for that library only, but I guess it makes more sense to you than to me :)</p>\n\n<p>You could also define a regular function elsewhere with that exact header:</p>\n\n<pre><code>func createNewSession(token string) (*discordgo.Session, error) {\n    // use \"token\"\n\n    // if invalid:\n    if token == \"\" {\n        // return an error\n        return nil, fmt.Errorf(\"invalid token\")\n    }\n\n    // otherwise, return a valid session\n    return &amp;discordgo.Session{}\n}\n</code></pre>\n\n<p>And set it with:</p>\n\n<pre><code>func main() {\n    manager := dshardmanager.New(\"Bot \" + token)\n    manager.SessionFunc = createNewSession\n\n    // more stuff happens down here\n}\n</code></pre>\n\n<p>Both approaches work the same way.</p>\n\n<p>Reflection is [almost] never the recommended way to do those things, if the library creators made those properties private, they shouldn't be changed/accessed from outside.</p>\n"}], "owner": {"reputation": 55556, "user_id": 197606, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/14da0a77145571d61cee03ac6bb0fb35?s=128&d=identicon&r=PG", "display_name": "Webnet", "link": "https://stackoverflow.com/users/197606/webnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57291295, "answer_count": 2, "score": -3, "last_activity_date": 1564577867, "creation_date": 1564576563, "last_edit_date": 1564577059, "question_id": 57290894, "link": "https://stackoverflow.com/questions/57290894/unsure-how-to-overwrite-a-callback-to-adjust-unexported-field", "title": "Unsure how to overwrite a callback to adjust unexported field", "body": "<p>What I'd like to do is overwrite some boolean values on a given object, such as:</p>\n\n<pre><code>func main() {\n    manager := dshardmanager.New(\"Bot \" + token)\n    manager.bareSession.State.TrackRoles = false;\n    manager.bareSession.State.TrackPresences = false;\n\n    // more stuff happens down here\n}\n</code></pre>\n\n<p>However <code>bareSession</code> is an unexported field, so I need to do this differently from what I'm gathering.  I've come across some approaches using reflection but I'd like to learn the <em>best practices</em> approach to doing this.</p>\n\n<p>In my specific case, it looks like the <a href=\"https://github.com/jonas747/dshardmanager/blob/master/dshardmanager.go#L53\" rel=\"nofollow noreferrer\">library I'm using offers a method to accomplish this</a>.  I've been tinkering with how to overwrite/define such a method but can't seem to figure out how to go about this.</p>\n\n<p><strong>What's the ideal approach to defining <a href=\"https://github.com/jonas747/dshardmanager/blob/master/dshardmanager.go#L53\" rel=\"nofollow noreferrer\">this <code>SessionFunc()</code></a> to customize the session the way I'm trying to?</strong></p>\n"}, {"tags": ["go", "visual-studio-code", "delve", "go-cobra"], "comments": [{"owner": {"reputation": 3237, "user_id": 9741769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b0913fe3d348f510777caaf5540169?s=128&d=identicon&r=PG&f=1", "display_name": "Blokje5", "link": "https://stackoverflow.com/users/9741769/blokje5"}, "edited": false, "score": 0, "creation_date": 1564574623, "post_id": 57290306, "comment_id": 101075118, "body": "Can you add your .vscode settings?"}], "answers": [{"comments": [{"owner": {"reputation": 2153, "user_id": 7003331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kBN0r.jpg?s=128&g=1", "display_name": "Deepak Patankar", "link": "https://stackoverflow.com/users/7003331/deepak-patankar"}, "edited": false, "score": 0, "creation_date": 1564579349, "post_id": 57291324, "comment_id": 101077901, "body": "Thanks Blokje5, the solution worked for me. I added the above given line in launch.json."}], "tags": [], "owner": {"reputation": 3237, "user_id": 9741769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b0913fe3d348f510777caaf5540169?s=128&d=identicon&r=PG&f=1", "display_name": "Blokje5", "link": "https://stackoverflow.com/users/9741769/blokje5"}, "is_accepted": true, "score": 3, "last_activity_date": 1564577970, "creation_date": 1564577970, "answer_id": 57291324, "question_id": 57290306, "link": "https://stackoverflow.com/questions/57290306/debug-file-other-than-main-go-in-vs-code/57291324#57291324", "title": "Debug file other than main.go in VS Code", "body": "<p>You can add flags to the <code>\"args\": []</code> array in your vscode settings like this:</p>\n\n<pre><code>\"args\": [\"login\", \"-u\", \"username\", \"-p\", \"password\"]\n</code></pre>\n\n<p>This will make sure when you run debug you end up in the login command with the given flags.</p>\n"}, {"comments": [{"owner": {"reputation": 2153, "user_id": 7003331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kBN0r.jpg?s=128&g=1", "display_name": "Deepak Patankar", "link": "https://stackoverflow.com/users/7003331/deepak-patankar"}, "edited": false, "score": 1, "creation_date": 1564579623, "post_id": 57291423, "comment_id": 101078090, "body": "Hey Ali thanks for the answer. Using your suggestion now I don&#39;t need to move to main.go before starting the debugger."}, {"owner": {"reputation": 2021, "user_id": 6536335, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-buZs4yDMhtE/AAAAAAAAAAI/AAAAAAAAABI/4apuEbD4X3c/photo.jpg?sz=128", "display_name": "Ali David", "link": "https://stackoverflow.com/users/6536335/ali-david"}, "reply_to_user": {"reputation": 2153, "user_id": 7003331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kBN0r.jpg?s=128&g=1", "display_name": "Deepak Patankar", "link": "https://stackoverflow.com/users/7003331/deepak-patankar"}, "edited": false, "score": 0, "creation_date": 1564579882, "post_id": 57291423, "comment_id": 101078244, "body": "glad that it helped you"}], "tags": [], "owner": {"reputation": 2021, "user_id": 6536335, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-buZs4yDMhtE/AAAAAAAAAAI/AAAAAAAAABI/4apuEbD4X3c/photo.jpg?sz=128", "display_name": "Ali David", "link": "https://stackoverflow.com/users/6536335/ali-david"}, "is_accepted": false, "score": 6, "last_activity_date": 1564578273, "creation_date": 1564578273, "answer_id": 57291423, "question_id": 57290306, "link": "https://stackoverflow.com/questions/57290306/debug-file-other-than-main-go-in-vs-code/57291423#57291423", "title": "Debug file other than main.go in VS Code", "body": "<p>Modify your <code>launch.json</code> as below:</p>\n\n<pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Launch\",\n            \"type\": \"go\",\n            \"request\": \"launch\",\n            \"mode\": \"debug\",\n            \"program\": \"${workspaceRoot}\",\n            \"env\": {},\n            \"args\": [],\n            \"port\": 8080,\n            \"host\": \"127.0.0.1\"\n        }\n    ]\n}\n</code></pre>\n\n<p>You'll learn that some differences are there from yours.</p>\n\n<pre><code>...\n\"mode\": \"debug\",\n\"program\": \"${workspaceRoot}\",\n...\n</code></pre>\n"}], "owner": {"reputation": 2153, "user_id": 7003331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kBN0r.jpg?s=128&g=1", "display_name": "Deepak Patankar", "link": "https://stackoverflow.com/users/7003331/deepak-patankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2595, "favorite_count": 0, "accepted_answer_id": 57291324, "answer_count": 2, "score": 0, "last_activity_date": 1564578273, "creation_date": 1564574532, "last_edit_date": 1564577792, "question_id": 57290306, "link": "https://stackoverflow.com/questions/57290306/debug-file-other-than-main-go-in-vs-code", "title": "Debug file other than main.go in VS Code", "body": "<p>I am writing a CLI in go using VS code editor. I am not able to figure out how to debug a code section.</p>\n\n<p>My directory structure is : </p>\n\n<pre><code>- test\n  - main.go\n  - cmd\n    - login.go\n    - root.go\n</code></pre>\n\n<ol>\n<li>I have set breakpoints in login.go but if I run \"Start Debugging\" in this file, I get error </li>\n</ol>\n\n<pre><code>Can not debug non-main package\nProcess exiting with code: 1\n</code></pre>\n\n<ol start=\"2\">\n<li>I tried running debugger in main.go but the debugger won't go to login.go file as I we have not explicitly written <code>test login</code></li>\n</ol>\n\n<pre><code>API server listening at: 127.0.0.1:48423\nA longer description that spans multiple lines and likely contains\nexamples and usage of using your application. For example:\ncd .\nCobra is a CLI library for Go that empowers applications.\nThis application is a tool to generate the needed files\nto quickly create a Cobra application.\n\nUsage:\n  test [command]\n\nAvailable Commands:\n  help        Help about any command\n  login       A brief description of your command\n\nFlags:\n      --config string   config file (default is $HOME/.test.yaml)\n  -h, --help            help for test\n  -t, --toggle          Help message for toggle\n\nUse \"test [command] --help\" for more information about a command.\n</code></pre>\n\n<ol>\n<li><code>main.go</code> file</li>\n</ol>\n\n<pre><code>package main\n\nimport \"test/cmd\"\n\nfunc main() {\n  cmd.Execute()\n}\n</code></pre>\n\n<ol start=\"2\">\n<li><code>login.go</code> file </li>\n</ol>\n\n<pre><code>package cmd\n\nimport (\n    \"fmt\"\n    \"github.com/spf13/cobra\"\n)\n\n// loginCmd represents the login command\nvar loginCmd = &amp;cobra.Command{\n    Run: func(cmd *cobra.Command, args []string) {\n        fmt.Println(\"login called\")\n        name, _ := cmd.Flags().GetString(\"username\")\n        pwd, _ := cmd.Flags().GetString(\"password\")\n        userInfo := name + \":\" + pwd\n    },\n}\n\nfunc init() {\n    rootCmd.AddCommand(loginCmd)\n\n    // Here you will define your flags and configuration settings.\n    loginCmd.Flags().StringP(\"username\", \"u\", \"\", \"Specifies the user\")\n    loginCmd.Flags().StringP(\"password\", \"p\", \"\", \"Specifies the password for the user\")\n    loginCmd.Flags().StringP(\"manager\", \"m\", \"\", \"Specifies the environement where user wants to login\")\n}\n</code></pre>\n\n<ol start=\"3\">\n<li><code>settings.json</code></li>\n</ol>\n\n<pre><code>{\n    \"go.gopath\":\"/Users/deepakpatankar/go\"\n}\n</code></pre>\n\n<ol start=\"4\">\n<li><code>launch.json</code></li>\n</ol>\n\n<pre><code>{\n    // Use IntelliSense to learn about possible attributes.\n    // Hover to view descriptions of existing attributes.\n    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Launch\",\n            \"type\": \"go\",\n            \"request\": \"launch\",\n            \"mode\": \"auto\",\n            \"program\": \"${fileDirname}\",\n            \"env\": {},\n            \"args\": []\n        }\n    ]\n}\n</code></pre>\n\n<p>Please guide me how I can see the variable values in debug mode like for variable name. Though using Println is fine, but this source code is part of a bigger project, so I want to see how I can use the debugger ?</p>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1564569583, "post_id": 57288760, "comment_id": 101072273, "body": "What does &quot;yaml in json format&quot; mean? YAML and JSON are distinct formats."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1564569891, "post_id": 57288760, "comment_id": 101072446, "body": "But more relevant to your question: What have you tried? Include all relevant code. What problems did you encounter that you need help with?"}], "answers": [{"tags": [], "owner": {"reputation": 6258, "user_id": 11032044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bz8vL.jpg?s=128&g=1", "display_name": "Kamol Hasan", "link": "https://stackoverflow.com/users/11032044/kamol-hasan"}, "is_accepted": false, "score": 0, "last_activity_date": 1564579072, "creation_date": 1564579072, "answer_id": 57291721, "question_id": 57288760, "link": "https://stackoverflow.com/questions/57288760/how-to-apply-kubernetes-workload/57291721#57291721", "title": "How to apply kubernetes workload", "body": "<p>You need kubernetes <code>client-go</code> to create <code>pod</code> or <code>deployment</code>.</p>\n\n<p>import <code>\"k8s.io/client-go/kubernetes\"</code></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>clientset, err := kubernetes.NewForConfig(cfg) // cfg is  the *config \n\n//    .... ... .. create deployment\nresult, err := clientset.AppsV1().Deployments(namespaceName).Create(deployment) // deployment object\n\n//    ... .... ... create pod\nresult, err := clientset.CoreV1().Pods(namespaceName).Create(Pod) // Pod object\n</code></pre>\n"}], "owner": {"reputation": 262, "user_id": 8970894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9OxfB.png?s=128&g=1", "display_name": "David Wer", "link": "https://stackoverflow.com/users/8970894/david-wer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1564579072, "creation_date": 1564569218, "last_edit_date": 1564569571, "question_id": 57288760, "link": "https://stackoverflow.com/questions/57288760/how-to-apply-kubernetes-workload", "title": "How to apply kubernetes workload", "body": "<p>I'm writing a Go program that will run in a kubernetes cluster. </p>\n\n<p>I want the program to apply a kubernetes workload using a yaml (yaml in json format)</p>\n\n<pre><code>\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    corev1 \"k8s.io/api/core/v1\"\n)\nvar (\n    workload = `{\n        \"apiVersion\": \"v1\",\n        \"kind\": \"Pod\",\n        \"metadata\": {\n            \"name\": \"sleep\",\n        },\n        \"spec\": {\n            \"containers\": [\n                {\n                    \"name\": \"sleep2\",\n                    \"image\": \"tutum/curl\",\n                    \"command\": [\n                        \"/bin/sleep\",\n                        \"infinity\"\n                    ],\n                    \"imagePullPolicy\": \"Always\",\n                    \"env\": [\n                        {\n                            \"name\": \"ENV_VAR\",\n                            \"value\": \"i/love/sleeping\"\n                        }\n                    ]\n                }\n            ]\n        }\n    }`\n)\n\nfunc ApplyWorkload(){\n    pod := corev1.Pod{}\n    if err := json.Unmarshal(workload, &amp;pod); err != nil {\n        fmt.Errorf(\"%v\", err)\n    }\n    // apply pod here\n\n}\n</code></pre>\n\n<p>How can I apply the workload in Go?</p>\n\n<p>What can I do if my workload is a deployment, should I run a switch-case for each possible workload?</p>\n"}, {"tags": ["go", "ssl", "tls1.2"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1564567802, "post_id": 57288177, "comment_id": 101071274, "body": "<a href=\"https://golang.org/pkg/crypto/tls/#Config.VerifyPeerCertificate\" rel=\"nofollow noreferrer\">golang.org/pkg/crypto/tls/#Config.VerifyPeerCertificate</a>"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 4, "creation_date": 1564567930, "post_id": 57288177, "comment_id": 101071363, "body": "<i>&quot;...I have a requirement where only server&#39;s certificate chain verification is required and servername verification not needed ...&quot;</i> - please question this requirement since it likely leads to insecure behavior: any certificate issued by a trusted CA can be used to MITM connections to arbitrary destinations. If this requirement is only because the name in the certificate does not match the name you connect to then you might provide the expected name in <code>tlsConfig.ServerName</code> instead."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1564571962, "post_id": 57288177, "comment_id": 101073620, "body": "@SteffenUllrich, the intent here is clearly to check for a valid chain rooted at a specific CA, not to accept any valid chain (which would be equivalent to InsecureSkipVerify). If the root CA is controlled and properly protected by the OP I see no issue, although I agree that it&#39;s unusual to not know the server name."}], "owner": {"reputation": 1986, "user_id": 4511560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/X7lzw.jpg?s=128&g=1", "display_name": "Tinkaal Gogoi", "link": "https://stackoverflow.com/users/4511560/tinkaal-gogoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1565096812, "creation_date": 1564567377, "last_edit_date": 1565096812, "question_id": 57288177, "link": "https://stackoverflow.com/questions/57288177/tls-client-servers-certificate-chain-verification-without-servername-verificati", "title": "TLS client server&#39;s certificate chain verification without servername verification", "body": "<p>Is it possible to do server's certificate chain verification without verifying servername in Go TLS client from <code>crypto/tls</code> package?</p>\n\n<p>As shown in the below code snippet, if we don't provide any servername we get error like </p>\n\n<blockquote>\n  <p>tls: either ServerName or InsecureSkipVerify must be specified in the\n  tls.Config</p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>rootCA := x509.NewCertPool()\ncaCert, _ := ioutil.ReadFile(\"/path/to/ca_cert.pem\")\nrootCA.AppendCertsFromPEM(caCert)\n\ntlsConfig = tls.Config{\n    RootCAs:    rootCA,\n    ServerName: \"xyz.com\",\n}\n\nconn, _ := net.Dial(\"tcp\", \"ip:port\")\n\nc := tls.Client(conn, &amp;tlsConfig)\nc.Handshake()\n</code></pre>\n\n<p>I have a requirement where only server's certificate chain verification is required and servername verification not needed but with Go's <code>crypto/tls</code> package both verification is coupled as an unit.</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1564569233, "post_id": 57288132, "comment_id": 101072101, "body": "What for? I&#39;ve removed my comment since you&#39;ve solved your issue, however there isn&#39;t anything in the question&#39;s tags that would answer the question in that comment."}, {"owner": {"reputation": 101, "user_id": 8953708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbaf29d1d406c556a25dbfd0e98276?s=128&d=identicon&r=PG&f=1", "display_name": "TiPSY", "link": "https://stackoverflow.com/users/8953708/tipsy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1564569361, "post_id": 57288132, "comment_id": 101072159, "body": "@mkopriva sorry my bad, didn&#39;t want to get anybody confused"}], "answers": [{"comments": [{"owner": {"reputation": 672, "user_id": 11825478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/741b2573e44a266ee90d46f50a3501f1?s=128&d=identicon&r=PG&f=1", "display_name": "Y.K.", "link": "https://stackoverflow.com/users/11825478/y-k"}, "edited": false, "score": 0, "creation_date": 1564567629, "post_id": 57288206, "comment_id": 101071153, "body": "I think you need to change join places also"}, {"owner": {"reputation": 672, "user_id": 11825478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/741b2573e44a266ee90d46f50a3501f1?s=128&d=identicon&r=PG&f=1", "display_name": "Y.K.", "link": "https://stackoverflow.com/users/11825478/y-k"}, "edited": false, "score": 0, "creation_date": 1564567729, "post_id": 57288206, "comment_id": 101071219, "body": "but description is incorrect <code>you shall join with the game_platforms first then with the games</code>"}, {"owner": {"reputation": 101, "user_id": 8953708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbaf29d1d406c556a25dbfd0e98276?s=128&d=identicon&r=PG&f=1", "display_name": "TiPSY", "link": "https://stackoverflow.com/users/8953708/tipsy"}, "edited": false, "score": 1, "creation_date": 1564568022, "post_id": 57288206, "comment_id": 101071418, "body": "From doesn&#39;t work, because <b>Find</b> in query add From"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 1, "last_activity_date": 1564568075, "last_edit_date": 1564568075, "creation_date": 1564567448, "answer_id": 57288206, "question_id": 57288132, "link": "https://stackoverflow.com/questions/57288132/how-to-fix-missing-from-clause-entry-for-table-error/57288206#57288206", "title": "How to fix &quot;missing FROM-clause entry for table&quot; error", "body": "<p>You query is missing the <code>FROM</code> clause.</p>\n\n<p>I assume you wanted to select the data from <code>platforms</code> table. If it is, then (as per your code) you shall join with the <code>game_platforms</code> first then with the <code>games</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>query = postgres.Db().Select(\"name\").\n    Find(\"platforms\"). // &lt;------ this one\n    Joins(\"JOIN game_platforms ON game_platforms.platform_id = platforms.id\").\n    Joins(\"JOIN games ON games.id = game_platforms.game_id\").\n    Where(\"games.id = 1\").Find(&amp;name)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 8953708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbaf29d1d406c556a25dbfd0e98276?s=128&d=identicon&r=PG&f=1", "display_name": "TiPSY", "link": "https://stackoverflow.com/users/8953708/tipsy"}, "is_accepted": true, "score": 1, "last_activity_date": 1564569013, "creation_date": 1564569013, "answer_id": 57288696, "question_id": 57288132, "link": "https://stackoverflow.com/questions/57288132/how-to-fix-missing-from-clause-entry-for-table-error/57288696#57288696", "title": "How to fix &quot;missing FROM-clause entry for table&quot; error", "body": "<p>So answer to my question wasn't without of support of @novalagung<br>\nCredit to him, so i need to change query to look like this</p>\n\n<pre><code>query = postgres.Db().Select(\"name\").\n    Joins(\"JOIN game_platforms ON game_platforms.platform_id = platforms.id\").\n    Joins(\"JOIN games ON games.id = game_platforms.game_id\").\n    Where(\"games.id = 1\").Find(&amp;name)\n</code></pre>\n\n<p>However I had an error that said <strong>pq: column reference \"name\" is ambiguous</strong><br>\nBut it is my fault because I didn't specified in question all tables, so small changes need to be done to solve this error is <strong><em>Select(\"platforms.name\").</em></strong></p>\n"}], "owner": {"reputation": 101, "user_id": 8953708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbaf29d1d406c556a25dbfd0e98276?s=128&d=identicon&r=PG&f=1", "display_name": "TiPSY", "link": "https://stackoverflow.com/users/8953708/tipsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1780, "favorite_count": 0, "accepted_answer_id": 57288696, "answer_count": 2, "score": -4, "last_activity_date": 1564573107, "creation_date": 1564567244, "last_edit_date": 1564573107, "question_id": 57288132, "link": "https://stackoverflow.com/questions/57288132/how-to-fix-missing-from-clause-entry-for-table-error", "title": "How to fix &quot;missing FROM-clause entry for table&quot; error", "body": "<p>I'm trying to get the name of platforms based on games id.</p>\n\n<p>I have three tables as below and I'm trying to JOIN them to get result that needed:</p>\n\n<pre><code>      Games\n\nId | .....| .....|\n---|------ ------|\n1  | .    | .    |\n2  | .    | .    |\n3  | .    | .    |\n4  | .    | .    |\n\n      Game_Platforms\n\nId |....|game_id| platform_id|...|\n---------------------------------\n1  | .  | 1     |   1        |.. |\n2  | .  | 1     |   2        |.. |\n3  | .  | 3     |   3        |.. |\n.. | .  | 4     |   4        |.. |\n\n    Platforms\nId| ...|...| name    |\n---------------------|\n1 | .  | . | iOS     |\n2 | .  | . | Android |\n3 | .  | . | Windows |\n4 | .  | . | SteamOS |\n</code></pre>\n\n<pre><code>type Platforms struct {\n   Name string\n}\n\nvar name []Platforms\n\nquery = postgres.Db().Select(\"name\").\n        Joins(\"JOIN games ON games.id = game_platforms.game_id\").\n        Joins(\"JOIN game_platforms ON game_platforms.platform_id = platforms.id\").\n        Where(\"games.id = 1\").Find(&amp;name)\n</code></pre>\n\n<p>I expect to get the Platforms name, but get the error:</p>\n\n<blockquote>\n  <p>pq: missing FROM-clause entry for table \"game_platforms\"</p>\n</blockquote>\n\n<p>I think that I wrote Joins commands incorrect, but it seems logical, maybe I'm wrong.</p>\n"}, {"tags": ["regex", "go", "re2"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564573958, "post_id": 57287887, "comment_id": 101074753, "body": "If you really want to check for &quot;a string without spaces&quot; you can do that with <code>strings.ContainsAny</code> or <code>strings.IndexFunc</code>. E.g. <a href=\"https://play.golang.org/p/oTCqcPrJkcb\" rel=\"nofollow noreferrer\">play.golang.org/p/oTCqcPrJkcb</a>"}, {"owner": {"reputation": 39, "user_id": 3442754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2add5026ffd8db813a61f45b23d30378?s=128&d=identicon&r=PG&f=1", "display_name": "user3442754", "link": "https://stackoverflow.com/users/3442754/user3442754"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564579965, "post_id": 57287887, "comment_id": 101078299, "body": "I stripped down the problem to illustrate the issue I was facing w.r.t end of line. Basically needed to use \\pM as mentioned in the answer below. I understand the issue now."}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1564566660, "creation_date": 1564566660, "answer_id": 57287962, "question_id": 57287887, "link": "https://stackoverflow.com/questions/57287887/how-to-match-a-complete-string-containing-unicode-characters/57287962#57287962", "title": "How to match a complete string containing unicode characters?", "body": "<p>You may use</p>\n\n<pre><code>^[\\p{L}\\p{M}]+$\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/3dGZZQgnx68\" rel=\"nofollow noreferrer\">Go demo</a>.</p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>[</code> -  start of a character class that matches \n\n<ul>\n<li><code>\\p{L}</code> - any BMP letter</li>\n<li><code>\\p{M}</code> - any diacritic</li>\n</ul></li>\n<li><code>]+</code> - end of the character class, repeat 1+ times</li>\n<li><code>$</code> - end of string.</li>\n</ul>\n\n<p>If you plan to also match digits and <code>_</code> as <code>\\w</code> does, add them to the character class, <code>^[\\p{L}\\p{M}0-9_]+$</code> or <code>^[\\p{L}\\p{M}\\p{N}_]+$</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 3442754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2add5026ffd8db813a61f45b23d30378?s=128&d=identicon&r=PG&f=1", "display_name": "user3442754", "link": "https://stackoverflow.com/users/3442754/user3442754"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 57287962, "answer_count": 1, "score": 0, "last_activity_date": 1564566660, "creation_date": 1564566447, "question_id": 57287887, "link": "https://stackoverflow.com/questions/57287887/how-to-match-a-complete-string-containing-unicode-characters", "title": "How to match a complete string containing unicode characters?", "body": "<p>I want to validate a string for e.g. name. A string without spaces. For normal Ascii a following regex would suffice \"^\\w+$\" where ^ and $ takes the whole string into consideration.  I tried to achieve the same result for unicode characters for supporting multiple languages using the \\pL character class. But for some reason $ doesn't help match end of string. What am I doing wrong? </p>\n\n<p>Code sample is here: <a href=\"https://play.golang.org/p/SPDEbWmqx0N\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SPDEbWmqx0N</a></p>\n\n<p>I copy pasted random characters from: <a href=\"http://www.columbia.edu/~fdc/utf8/\" rel=\"nofollow noreferrer\">http://www.columbia.edu/~fdc/utf8/</a></p>\n\n<p>go version <strong>go1.12.5 darwin/amd64</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n\n    // Unicode character class\n\n    fmt.Println(regexp.MatchString(`^\\pL+$`, \"testuser\"))  // expected true\n    fmt.Println(regexp.MatchString(`^\\pL+$`, \"user with space\")) // expected false \n\n\n    // Hindi script\n    fmt.Println(regexp.MatchString(`^\\pL+$`, \"\u0938\u0915\u0924\u093e\")) // expected true doesn't match end of line\n\n    // Hindi script\n    fmt.Println(regexp.MatchString(`^\\pL+`, \"\u0938\u0915\u0924\u093e\")) // expected true\n\n    // Chinese\n    fmt.Println(regexp.MatchString(`^\\pL+$`, \"\u6211\u80fd\")) // expected true\n\n    //French\n    fmt.Println(regexp.MatchString(`^\\pL+$`, \"\u00e6githalesh\u00e2tifs\")) // expected true \n\n}\n</code></pre>\n\n<pre><code>actual result:\ntrue  &lt;nil&gt;\nfalse &lt;nil&gt;\nfalse &lt;nil&gt;\ntrue &lt;nil&gt;\ntrue &lt;nil&gt;\ntrue &lt;nil&gt;\n\nexpected result:\ntrue &lt;nil&gt;\nfalse &lt;nil&gt;\ntrue &lt;nil&gt;\ntrue &lt;nil&gt;\ntrue &lt;nil&gt;\ntrue &lt;nil&gt;\n</code></pre>\n"}, {"tags": ["for-loop", "go"], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1564558325, "post_id": 57285422, "comment_id": 101065929, "body": "Then you could also run <code>worker.setIdle()</code> as a deferred function within <code>doSomething</code>"}, {"owner": {"reputation": 1, "user_id": 6715877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24deb315898606c9c4452464c5b6c11?s=128&d=identicon&r=PG&f=1", "display_name": "Klaymen", "link": "https://stackoverflow.com/users/6715877/klaymen"}, "edited": false, "score": 0, "creation_date": 1564574196, "post_id": 57285422, "comment_id": 101074873, "body": "You&#39;re right, I also had this idea before, and the fenction can probably even be anonymous, so it can access closure variables - thanks"}], "tags": [], "owner": {"reputation": 4408, "user_id": 152400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6b411b6d3bc5fa6a01d98ef739efb2f?s=128&d=identicon&r=PG", "display_name": "gregor", "link": "https://stackoverflow.com/users/152400/gregor"}, "is_accepted": false, "score": 2, "last_activity_date": 1564558311, "last_edit_date": 1564558311, "creation_date": 1564558102, "answer_id": 57285422, "question_id": 57285345, "link": "https://stackoverflow.com/questions/57285345/can-final-statements-added-after-each-iteration-in-a-for-range-loops-like/57285422#57285422", "title": "Can final statements added after each iteration in a &#39;for .. range&#39; loops (like in standard for loop)?", "body": "<p>An easy way to achieve this to extract the body of the loop to a function and restructure your code like this:</p>\n\n<pre><code>for task := range ch {\n  doSomething(task)\n  worker.setIdle()\n}\n\nfunc doSomething(task Task) {\n   if (...) {\n     ...\n     return\n   }\n   if (...) {\n     ...\n     return\n   }\n   ...\n}\n</code></pre>\n\n<p>This may lead to a better seperation of concerns: One function to handle incoming tasks and the worker and on function to do the actual work.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1564574108, "creation_date": 1564574108, "answer_id": 57290172, "question_id": 57285345, "link": "https://stackoverflow.com/questions/57285345/can-final-statements-added-after-each-iteration-in-a-for-range-loops-like/57290172#57290172", "title": "Can final statements added after each iteration in a &#39;for .. range&#39; loops (like in standard for loop)?", "body": "<p>Use a for loop without the range clause. Receive on the channel in the loop and break from the loop when the channel is closed. </p>\n\n<pre><code>for {\n    worker.setIdle()\n    task, ok := &lt;-ch\n    if !ok {\n        break\n    }\n    if (...) {\n       ...\n       continue\n    }\n    ...\n    if (...) {\n       ...\n       continue\n    }\n    ...\n    if (...) {\n       ...\n       continue\n    }\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6715877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24deb315898606c9c4452464c5b6c11?s=128&d=identicon&r=PG&f=1", "display_name": "Klaymen", "link": "https://stackoverflow.com/users/6715877/klaymen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1564575099, "creation_date": 1564557823, "last_edit_date": 1564575099, "question_id": 57285345, "link": "https://stackoverflow.com/questions/57285345/can-final-statements-added-after-each-iteration-in-a-for-range-loops-like", "title": "Can final statements added after each iteration in a &#39;for .. range&#39; loops (like in standard for loop)?", "body": "<p>In a <code>for task := range ch {..}</code> loop (iterating over a channel), I have several places where I want to step forward to the next element (<code>continue</code>); however, I need to execute an additional statement before the continue (setting a flag to mark the worker routine is currently idle), but before the next element is received from the channel - see code sample below. </p>\n\n<p>Currently, I have to repeat this statement before every <code>continue</code>. This works, but is not very elegant, and a <code>worker.setIdle()</code> can easily be forgotten. It would be nice if I could set up such a \"finalizer\" statement at the entry of the loop, something like you could expect of a <code>for task := range ch; worker.setIdle() {...}</code> construct, but of course that is syntactically incorrect. It would be like a <code>defer</code> in a loop, which is executed at the end of each loop iteration instead at the end of the function. Is there a way to express this in Go?</p>\n\n<pre><code>for task := range ch {\n  ...\n  if (...) {\n    ...\n    worker.setIdle()\n    continue\n  }\n  ...\n  if (...) {\n    ...\n    worker.setIdle()\n    continue\n  }\n  ...\n  if (...) {\n    ...\n    worker.setIdle()\n    continue\n  }\n  ...\n  worker.setIdle()\n}\n</code></pre>\n\n<p>EDIT: Thanks for the replies - I think the best solution (or at least another alternative) might be an anonymous function as follows:</p>\n\n<pre><code>for task := range ch {\n  func () {\n    ...\n    if (...) {\n      ...\n      return\n    }\n    ...\n  } ()\n  worker.setIdle()\n}\n</code></pre>\n\n<p>Only drawback is that the return statements might be misleading, they should probably be commented. A \"defer\" statement on basic block granularity (or also whole loop granularity) would be nice to have :-)</p>\n"}, {"tags": ["windows", "go", "time"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1564557727, "post_id": 57285292, "comment_id": 101065618, "body": "Which hardware architecture are you running on?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1564558107, "post_id": 57285292, "comment_id": 101065804, "body": "Are you running this on Windows?"}, {"owner": {"reputation": 69, "user_id": 2758119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4b6fcf051f5a9d402e8eebf6e02030?s=128&d=identicon&r=PG&f=1", "display_name": "wayne", "link": "https://stackoverflow.com/users/2758119/wayne"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1564558268, "post_id": 57285292, "comment_id": 101065890, "body": "@icza Yes, it&#39;s running on Windows."}, {"owner": {"reputation": 69, "user_id": 2758119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4b6fcf051f5a9d402e8eebf6e02030?s=128&d=identicon&r=PG&f=1", "display_name": "wayne", "link": "https://stackoverflow.com/users/2758119/wayne"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1564558401, "post_id": 57285292, "comment_id": 101065961, "body": "@icza In the VSCode Editor actually."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1564558475, "post_id": 57285292, "comment_id": 101065999, "body": "There&#39;s nothing wrong with your code. On windows the resolution of time is often higher than 1 ms. Meaning if you query the actual time twice within a millisecond, you often get the same value. Your operation sometimes yields <code>t = 2997600ns = 0.3\u03bcs</code>, which could explain this. Blame it on Windows."}, {"owner": {"reputation": 69, "user_id": 2758119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4b6fcf051f5a9d402e8eebf6e02030?s=128&d=identicon&r=PG&f=1", "display_name": "wayne", "link": "https://stackoverflow.com/users/2758119/wayne"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564558488, "post_id": 57285292, "comment_id": 101066008, "body": "@Flimzy 64bit version of Windows 10."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564558688, "post_id": 57285292, "comment_id": 101066115, "body": "Related: <a href=\"https://stackoverflow.com/q/21262821/13860\">stackoverflow.com/q/21262821/13860</a> <a href=\"https://stackoverflow.com/q/3744032/13860\">stackoverflow.com/q/3744032/13860</a>"}, {"owner": {"reputation": 69, "user_id": 2758119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4b6fcf051f5a9d402e8eebf6e02030?s=128&d=identicon&r=PG&f=1", "display_name": "wayne", "link": "https://stackoverflow.com/users/2758119/wayne"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1564559010, "post_id": 57285292, "comment_id": 101066282, "body": "@icza You are right! I run it on Linux, and there is no zero result. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1564572954, "post_id": 57285684, "comment_id": 101074173, "body": "The system time has 100 ns precision, but it&#39;s only updated by the system timer interrupt every 15 ms or so. The timer resolution can be lowered to a millisecond or less, but this affects the scheduler and causes a significant increase in power consumption. If we need to measure precise intervals, as opposed to logging a system timestamp, we use the system performance counter instead, i.e. whatever way Go exposes WINAPI <code>QueryPerformanceCounter</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1564574534, "last_edit_date": 1564574534, "creation_date": 1564559094, "answer_id": 57285684, "question_id": 57285292, "link": "https://stackoverflow.com/questions/57285292/why-does-time-now-unixnano-returns-the-same-result-after-an-io-operation/57285684#57285684", "title": "Why does time.Now().UnixNano() returns the same result after an IO operation?", "body": "<p>There's nothing wrong with your code. On Windows, the system time is often only updated once every 10-15 ms or so, which means if you query the current time twice within this period, you get the same value.</p>\n\n<p>Your operation sometimes yields <code>t = 2997600ns = 3ms</code>, which could explain this. Blame it on Windows.</p>\n\n<p>Related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14610459/how-precise-is-gos-time-really\">How precise is Go&#39;s time, really?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/21262821/how-to-determine-the-current-windows-timer-resolution\">How to determine the current Windows timer resolution?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/13062345/measuring-time-differences-using-system-currenttimemillis/13062443#13062443\">Measuring time differences using System.currentTimeMillis()</a></p>\n"}], "owner": {"reputation": 69, "user_id": 2758119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4b6fcf051f5a9d402e8eebf6e02030?s=128&d=identicon&r=PG&f=1", "display_name": "wayne", "link": "https://stackoverflow.com/users/2758119/wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 57285684, "answer_count": 1, "score": 2, "last_activity_date": 1564574534, "creation_date": 1564557638, "last_edit_date": 1564559142, "question_id": 57285292, "link": "https://stackoverflow.com/questions/57285292/why-does-time-now-unixnano-returns-the-same-result-after-an-io-operation", "title": "Why does time.Now().UnixNano() returns the same result after an IO operation?", "body": "<p>I use <code>time.Now().UnixNano()</code> to calculate the execution time for some part of my code, but I find an interesting thing. The elapsed time is sometimes zero after an IO operation! What's wrong with it?</p>\n\n<p>The code is running in Go 1.11, and use the standard library <code>\"time\"</code>. Redis library is <code>\"github.com/mediocregopher/radix.v2/redis\"</code>. The redis server version is 3.2. I'm running this on Windows, with VSCode Editor.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>isGatherTimeStat = false\nif rand.Intn(100) &lt; globalConfig.TimeStatProbability { // Here I set TimeStatProbability 100\n    isGatherTimeStat = true\n}\nif isGatherTimeStat {\n    timestampNano = time.Now()\n}\nglobalLogger.Info(\"time %d\", time.Now().UnixNano())\nresp := t.redisConn.Cmd(\"llen\", \"log_system\")\nglobalLogger.Info(\"time %d\", time.Now().UnixNano())\nif isGatherTimeStat {\n    currentTimeStat.time = time.Since(timestampNano).Nanoseconds()\n    currentTimeStat.name = \"redis_llen\"\n    globalLogger.Info(\"redis_llen time sub == %d\", currentTimeStat.time)\n    select {\n    case t.chTimeStat &lt;- currentTimeStat:\n    default:\n    }\n}\n</code></pre>\n\n<p>Here are some logs:</p>\n\n<pre><code>[INFO ][2019-07-31][14:47:53] time 1564555673269444200\n[INFO ][2019-07-31][14:47:53] time 1564555673269444200\n[INFO ][2019-07-31][14:47:53] redis_llen time sub == 0\n[INFO ][2019-07-31][14:47:58] time 1564555678267691700\n[INFO ][2019-07-31][14:47:58] time 1564555678270689300\n[INFO ][2019-07-31][14:47:58] redis_llen time sub == 2997600\n[INFO ][2019-07-31][14:48:03] time 1564555683268195600\n[INFO ][2019-07-31][14:48:03] time 1564555683268195600\n[INFO ][2019-07-31][14:48:03] redis_llen time sub == 0\n[INFO ][2019-07-31][14:48:08] time 1564555688267631100\n[INFO ][2019-07-31][14:48:08] time 1564555688267631100\n[INFO ][2019-07-31][14:48:08] redis_llen time sub == 0\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1564539946, "post_id": 57282227, "comment_id": 101060528, "body": "I&#39;m not sure exactly what you&#39;re asking - <i>why</i> is it possible or <i>how</i>?"}, {"owner": {"reputation": 2035, "user_id": 4415502, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/1026723693/picture?type=large", "display_name": "Mox", "link": "https://stackoverflow.com/users/4415502/mox"}, "reply_to_user": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1564540047, "post_id": 57282227, "comment_id": 101060545, "body": "@LukeJoshuaPark, both actually"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1564541138, "post_id": 57282227, "comment_id": 101060730, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52996452/returning-pointer-from-a-local-variable-in-function\">returning pointer from a local variable in function</a>, <a href=\"https://stackoverflow.com/questions/38234487/go-returning-a-pointer-on-stack\">Go - returning a pointer on stack</a>"}, {"owner": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 0, "creation_date": 1565681170, "post_id": 57282227, "comment_id": 101418204, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52996452/returning-pointer-from-a-local-variable-in-function\">returning pointer from a local variable in function</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2035, "user_id": 4415502, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/1026723693/picture?type=large", "display_name": "Mox", "link": "https://stackoverflow.com/users/4415502/mox"}, "edited": false, "score": 0, "creation_date": 1564540091, "post_id": 57282351, "comment_id": 101060555, "body": "interesting. thanks for sharing."}], "tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": true, "score": 5, "last_activity_date": 1564540094, "last_edit_date": 1564540094, "creation_date": 1564539986, "answer_id": 57282351, "question_id": 57282227, "link": "https://stackoverflow.com/questions/57282227/why-are-functions-able-to-return-a-local-variable/57282351#57282351", "title": "Why are functions able to return a local variable?", "body": "<p>Yes, exactly. The compiler performs something called \"escape analysis\" to determine if the variable's scope exceeds the function's, in which case it automatically gets placed on the heap instead. See <a href=\"http://www.agardner.me/golang/garbage/collection/gc/escape/analysis/2015/10/18/go-escape-analysis.html\" rel=\"noreferrer\">http://www.agardner.me/golang/garbage/collection/gc/escape/analysis/2015/10/18/go-escape-analysis.html</a> for more details, although I believe more modern versions of go are a bit smarter now than what's described there.</p>\n\n<p>This is also touched on (a bit confusingly in my opinion) in the official Go FAQ: <a href=\"https://golang.org/doc/faq#stack_or_heap\" rel=\"noreferrer\">https://golang.org/doc/faq#stack_or_heap</a></p>\n"}], "owner": {"reputation": 2035, "user_id": 4415502, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/1026723693/picture?type=large", "display_name": "Mox", "link": "https://stackoverflow.com/users/4415502/mox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1565681170, "accepted_answer_id": 57282351, "answer_count": 1, "score": -2, "last_activity_date": 1564561113, "creation_date": 1564538934, "last_edit_date": 1564561113, "question_id": 57282227, "link": "https://stackoverflow.com/questions/57282227/why-are-functions-able-to-return-a-local-variable", "closed_reason": "Needs details or clarity", "title": "Why are functions able to return a local variable?", "body": "<p>This is just something that caught my curiosity. </p>\n\n<p>While we know that in C/C++ returning a local non-pointer type variable declared in a function is illegal, this is perfectly legal in Golang. Why is that so? Does the compiler determines whether to allocate the variable to stack/heap during compile time based on the usage of the variable?</p>\n\n<p>for example</p>\n\n<pre><code>func getVal() *int {\n    x := 1\n    return &amp;x\n}\n</code></pre>\n"}, {"tags": ["http", "go", "server"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1564527371, "post_id": 57281010, "comment_id": 101058293, "body": "You&#39;ll need to add on <code>.html</code>, test if the file exists, and if so, serve that."}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 1, "last_activity_date": 1564536101, "last_edit_date": 1564536101, "creation_date": 1564530700, "answer_id": 57281420, "question_id": 57281010, "link": "https://stackoverflow.com/questions/57281010/remove-the-html-extension-from-every-file-in-a-simple-http-server/57281420#57281420", "title": "Remove the .html extension from every file in a simple HTTP server", "body": "<p>It's possible, but it cannot be done by serving the files using <code>http.FileServer()</code>.</p>\n\n<p>Instead, create a custom handler for the <code>/</code> route. Inside the handler, serve the requested file directly using <code>http.ServeFile()</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>viewPath := \"public/\"\nhttp.Handle(\"/\", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n\n    // hack, if requested url is / then point towards /index\n    if r.URL.Path == \"/\" {\n        r.URL.Path = \"/index\"\n    }\n\n    requestedPath := strings.TrimLeft(filepath.Clean(r.URL.Path), \"/\")\n    filename := fmt.Sprintf(\"%s/%s.html\", viewPath, requestedPath)\n    http.ServeFile(w, r, filename)\n}))\nhttp.ListenAndServe(\":8000\", nil)\n</code></pre>\n\n<p>The <code>.html</code> suffix is added to every request path, so it'll point correctly towards the html files.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>path / -&gt; ./public/index.html\npath /index -&gt; ./public/index.html\npath /some/folder/about -&gt; ./public/some/folder/about.html\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 8317886, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP2zW.png?s=128&g=1", "display_name": "Marton", "link": "https://stackoverflow.com/users/8317886/marton"}, "edited": false, "score": 0, "creation_date": 1564560863, "post_id": 57281956, "comment_id": 101067227, "body": "Thank you very much, I am quite new in go, so this helped me a lot"}], "tags": [], "owner": {"reputation": 76, "user_id": 11861310, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/13d172c645c6b2ef65d86af419042eb4?s=128&d=identicon&r=PG", "display_name": "nhooory", "link": "https://stackoverflow.com/users/11861310/nhooory"}, "is_accepted": true, "score": 6, "last_activity_date": 1564536387, "creation_date": 1564536387, "answer_id": 57281956, "question_id": 57281010, "link": "https://stackoverflow.com/questions/57281010/remove-the-html-extension-from-every-file-in-a-simple-http-server/57281956#57281956", "title": "Remove the .html extension from every file in a simple HTTP server", "body": "<p>One option is to implement <a href=\"https://godoc.org/net/http#FileSystem\" rel=\"noreferrer\">http.FileSystem</a> using <a href=\"https://godoc.org/net/http#Dir\" rel=\"noreferrer\">http.Dir</a>.  The advantage of this approach is that it takes advantage of the carefully written code in http.FileServer.</p>\n\n<p>It will look something like this:</p>\n\n<pre><code>type HTMLDir struct {\n    d http.Dir\n}\n\nfunc main() {\n  fs := http.FileServer(HTMLDir{http.Dir(\"public/\")})\n  http.Handle(\"/\", http.StripPrefix(\"/\", fs))\n  http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>The implementation of the <a href=\"https://godoc.org/net/http#FileSystem.Open\" rel=\"noreferrer\">Open</a> method depends on the application requirements. </p>\n\n<p>If you always want to tack on the .html extension, then use this code:</p>\n\n<pre><code>func (d HTMLDir) Open(name string) (http.File, error) {\n    return d.d.Open(name + \".html\")\n}\n</code></pre>\n\n<p>If you want to fallback to the .html extension, then use this code:</p>\n\n<pre><code>func (d HTMLDir) Open(name string) (http.File, error) {\n    // Try name as supplied\n    f, err := d.d.Open(name)\n    if os.IsNotExist(err) {\n        // Not found, try with .html\n        if f, err := d.d.Open(name + \".html\"); err == nil {\n            return f, nil\n        }\n    }\n    return f, err\n}\n</code></pre>\n\n<p>Flip the previous one around to start with the .html extension and fallback to the name as supplied:</p>\n\n<pre><code>func (d HTMLDir) Open(name string) (http.File, error) {\n    // Try name with added extension\n    f, err := d.d.Open(name + \".html\")\n    if os.IsNotExist(err) {\n        // Not found, try again with name as supplied.\n        if f, err := d.d.Open(name); err == nil {\n            return f, nil\n        }\n    }\n    return f, err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1564559882, "last_edit_date": 1564559882, "creation_date": 1564556035, "answer_id": 57284864, "question_id": 57281010, "link": "https://stackoverflow.com/questions/57281010/remove-the-html-extension-from-every-file-in-a-simple-http-server/57284864#57284864", "title": "Remove the .html extension from every file in a simple HTTP server", "body": "<p>So basically you want the <code>http.FileServer</code> functionality, but you don't want clients having to enter the trailing <code>.html</code> extension.</p>\n\n<p>Another simple solution is to add it yourself, at the server side. This is how it can be done:</p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"public\"))\nhttp.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    r.URL.Path += \".html\"\n    fs.ServeHTTP(w, r)\n})\n\npanic(http.ListenAndServe(\":8000\", nil))\n</code></pre>\n\n<p>And that's all.</p>\n\n<p>If you want this file server to also serve other files (such as images and CSS files), only append the <code>.html</code> extension if it has no extension:</p>\n\n<pre><code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    if ext := path.Ext(r.URL.Path); ext == \"\" {\n        r.URL.Path += \".html\"\n    }\n    fs.ServeHTTP(w, r)\n})\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 8317886, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP2zW.png?s=128&g=1", "display_name": "Marton", "link": "https://stackoverflow.com/users/8317886/marton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 57281956, "answer_count": 3, "score": 3, "last_activity_date": 1564574926, "creation_date": 1564526978, "last_edit_date": 1564574926, "question_id": 57281010, "link": "https://stackoverflow.com/questions/57281010/remove-the-html-extension-from-every-file-in-a-simple-http-server", "title": "Remove the .html extension from every file in a simple HTTP server", "body": "<p>I want to make it so when someone visits a page on my Go HTTP server, they won't see the <code>.html</code> extension.\nE.g.\u00a0when they visit <code>https://example.org/test</code> they will see the content of <code>https://example.org/test.html</code>.</p>\n\n<p>My code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    fs := http.FileServer(http.Dir(\"public/\"))\n\n    http.Handle(\"/\", http.StripPrefix(\"/\", fs))\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n"}, {"tags": ["datetime", "go", "iso8601"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 4, "creation_date": 1564525901, "post_id": 57280566, "comment_id": 101057935, "body": "First, read the documentation: <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">Package time</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1564526197, "post_id": 57280566, "comment_id": 101058006, "body": "<code>&quot;6&#47;16&#47;2019 3:07:53 PM&quot;</code> is not a valid format string. A format string must format the canonical date, as clearly described in the docs."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564575305, "post_id": 57280566, "comment_id": 101075492, "body": "Also, never ignore errors. <code>time.Parse</code> returns an error and in your case it would have told you: parsing time &quot;8/16/2019 8:01:35 PM&quot; as &quot;6/16/2019 3:07:53 PM&quot;: cannot parse &quot;8/16/2019 8:01:35 PM&quot; as &quot;6/&quot;"}, {"owner": {"reputation": 1, "user_id": 11127737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/229fa65fdcfe64b222c3a7b9ac541375?s=128&d=identicon&r=PG&f=1", "display_name": "Prady", "link": "https://stackoverflow.com/users/11127737/prady"}, "edited": false, "score": 0, "creation_date": 1564755910, "post_id": 57280566, "comment_id": 101146900, "body": "Thanks all. I was just getting started with go and I did not understand much about how to look up for details in the documentation, my bad!"}], "answers": [{"tags": [], "owner": {"reputation": 573, "user_id": 9100468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CmkMNlW2J6k/AAAAAAAAAAI/AAAAAAAAYbA/S66MIb_UIX0/photo.jpg?sz=128", "display_name": "Isaac Weingarten", "link": "https://stackoverflow.com/users/9100468/isaac-weingarten"}, "is_accepted": false, "score": 1, "last_activity_date": 1564575474, "last_edit_date": 1564575474, "creation_date": 1564526019, "answer_id": 57280878, "question_id": 57280566, "link": "https://stackoverflow.com/questions/57280566/i-am-looking-for-a-method-that-can-take-string-and-format-it-to-iso-8601-timesta/57280878#57280878", "title": "I am looking for a method that can take string and format it to ISO 8601 timestamp", "body": "<p>the numbers on the example date can only be as follows</p>\n\n<p>month: 1, 01, jan, January<br>\nday: 2, 02<br>\nyear: 06, 2006,<br>\nhour: 3, 03, or for 24hour 15,<br>\nminutes: 4, 04<br>\nseconds 5, 05, 05.000, 05.000000<br>\ntimezone -0700, MST<br></p>\n\n<pre><code>input := \"8/16/2019 8:01:35 PM\"\nlayout := \"1/02/2006 3:04:05 PM\"\nt, err := time.Parse(layout, input)\nfmt.Println(t, err)\nfmt.Println(t.Format(\"1/02/2006 3:04:05 PM\")) // 31-Aug-2017\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/dQuN8n30HgM\" rel=\"nofollow noreferrer\">go playground</a></p>\n\n<p>for more details <a href=\"https://programming.guide/go/format-parse-string-time-date-example.html\" rel=\"nofollow noreferrer\">checkout</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11127737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/229fa65fdcfe64b222c3a7b9ac541375?s=128&d=identicon&r=PG&f=1", "display_name": "Prady", "link": "https://stackoverflow.com/users/11127737/prady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1564575474, "creation_date": 1564523828, "last_edit_date": 1564575136, "question_id": 57280566, "link": "https://stackoverflow.com/questions/57280566/i-am-looking-for-a-method-that-can-take-string-and-format-it-to-iso-8601-timesta", "title": "I am looking for a method that can take string and format it to ISO 8601 timestamp", "body": "<p>I am trying to take a string and convert that string into <strong>ISO8601</strong> timestamp format using Go.</p>\n\n<p>I read a few StackOverflow posts and tried them, none of them worked for me. I might be doing it wrong?</p>\n\n<p>My datetime string is something like</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>date := \"8/16/2019 8:01:35 PM\"\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    date := \"8/16/2019 8:01:35 PM\"\n    t, _ := time.Parse(\"6/16/2019 3:07:53 PM\", date)\n    fmt.Println(t) // getting 0001-01-01 00:00:00 +0000 UTC\n}\n</code></pre>\n\n<p>I am expecting to get a parsed DateTime value which is something like <code>2019-8-16T20:01:35</code> from the above code and then convert it to <strong>ISO8601</strong> format, like <code>2019-8-16T20:01:35.000Z</code> as an end result.</p>\n"}, {"tags": ["amazon-web-services", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1564523182, "post_id": 57280342, "comment_id": 101057166, "body": "You say you&#39;re <code>trying de-referencing like in c++</code>, but you&#39;re not dereferencing anything. Do you need to work with a <code>[]string</code> or a <code>[]*string</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11831953"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1564523412, "post_id": 57280342, "comment_id": 101057241, "body": "<code>[]*string</code> to let it know what to assign the var to"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1564523823, "post_id": 57280342, "comment_id": 101057370, "body": "Sorry, I don&#39;t understand what that means. <code>fmt</code> is obviously not going to print <code>[]*string</code> in the way to want, so if you want to print it you need to iterate over the pointers. Is the end goal just to print, or are you going to marshal this into something else?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11831953"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1564523896, "post_id": 57280342, "comment_id": 101057392, "body": "using it for a lambda caller"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1564524522, "post_id": 57280342, "comment_id": 101057553, "body": "What does that mean? Do you need to format it as a string? Do you need to format it as json? If that&#39;s the case, why do you have a <code>[]*string</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1564526140, "creation_date": 1564526140, "answer_id": 57280896, "question_id": 57280342, "link": "https://stackoverflow.com/questions/57280342/is-it-possible-to-change-the-output-to-be-an-actual-string-of-characters/57280896#57280896", "title": "Is it possible to change the output to be an actual string of characters?", "body": "<p>You're taking <code>*string</code>s when you really only need <code>string</code>s. It's a simple change to derefernce the pointers you get back from AWS SDK (it uses pointers for everything for nullability):</p>\n\n<pre><code>var accountList []string\n\nfor _, accountId := range result.Accounts {\n    accountList = append(accountList, *accountId.Id)\n}\nfmt.Println(accountList)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11831953"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 57280896, "answer_count": 1, "score": -6, "last_activity_date": 1564526140, "creation_date": 1564522500, "question_id": 57280342, "link": "https://stackoverflow.com/questions/57280342/is-it-possible-to-change-the-output-to-be-an-actual-string-of-characters", "title": "Is it possible to change the output to be an actual string of characters?", "body": "<p>I created this function to output all account IDs for my aws accounts cross regions but the output I am getting is quite unintelligible </p>\n\n<p>trying de-referencing like in c++</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n\n    //\"github.com/aws/aws-lambda-go/lambda\"\n   // \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/awserr\"\n    //\"github.com/aws/aws-sdk-go/aws/credentials/stscreds\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/organizations\"\n)\n\nfunc main()  {\n    listAccounts()\n}\n\nfunc listAccounts() {\n    sess := session.Must(session.NewSession())\n    svc := organizations.New(sess)\n    input := &amp;organizations.ListAccountsInput{}\n\n\n    result, err := svc.ListAccounts(input)\n    if err != nil {\n        if aerr, ok := err.(awserr.Error); ok {\n            switch aerr.Code() {\n            case organizations.ErrCodeAccessDeniedException:\n                fmt.Println(organizations.ErrCodeAccessDeniedException, aerr.Error())\n            case organizations.ErrCodeAWSOrganizationsNotInUseException:\n                fmt.Println(organizations.ErrCodeAWSOrganizationsNotInUseException, aerr.Error())\n            case organizations.ErrCodeInvalidInputException:\n                fmt.Println(organizations.ErrCodeInvalidInputException, aerr.Error())\n            case organizations.ErrCodeServiceException:\n                fmt.Println(organizations.ErrCodeServiceException, aerr.Error())\n            case organizations.ErrCodeTooManyRequestsException:\n                fmt.Println(organizations.ErrCodeTooManyRequestsException, aerr.Error())\n            default:\n                fmt.Println(aerr.Error())\n            }\n        } else {\n        // Print the error, cast err to awserr.Error to get the Code and\n        // Message from an error.\n        fmt.Println(err.Error())\n        }\n    return\n}\n    // fmt.Println(result.Accounts)\n    var accountList []*string\n\n    for _, accountId := range result.Accounts {\n        accountList = append(accountList, accountId.Id)\n    }\n    fmt.Println(accountList)\n\n}\n</code></pre>\n\n<p>go run id.go\n[0xc0002387e0 0xc000238840 0xc0002388a0 0xc000238900 0xc000238960 0xc0002389c0 0xc000238a20 0xc000238a80 0xc000238ae0 0xc000238b40 0xc000238ba0 0xc000238c00 0xc000238c60 0xc000238cc0 0xc000238d20 0xc000238d80 0xc000238de0 0xc000238e40 0xc000238ea0 0xc000238f00]</p>\n"}, {"tags": ["go", "string-literals"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1564520129, "post_id": 57279530, "comment_id": 101056205, "body": "Use <code>bot := DigitalAssistant{input, &quot;teamAwesome&quot;....</code> to replace a string literal with a variable.  There&#39;s no need for a string-template feature."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1564520145, "post_id": 57279530, "comment_id": 101056216, "body": "That&#39;s the opposite of a string literal, it&#39;s what&#39;s often called a template or interpolation. In this case, if <code>input</code> is a string, you don&#39;t need any of that - just use <code>DigitalAssistant{input, &quot;teamAwesome&quot;,...</code>. But there&#39;s not enough code shown to say what you actually need here."}, {"owner": {"reputation": 133, "user_id": 9362384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Me5D7ndvXKM/AAAAAAAAAAI/AAAAAAAAADg/noEOiJQPv-E/photo.jpg?sz=128", "display_name": "Melody Anoni", "link": "https://stackoverflow.com/users/9362384/melody-anoni"}, "edited": false, "score": 0, "creation_date": 1564534509, "post_id": 57279530, "comment_id": 101059582, "body": "I cannot just put <code>input</code> because go gives the error <code>cannot use input (type []byte) as type string in field value</code>"}, {"owner": {"reputation": 9968, "user_id": 114900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZGjf9.jpg?s=128&g=1", "display_name": "msanford", "link": "https://stackoverflow.com/users/114900/msanford"}, "edited": false, "score": 1, "creation_date": 1564535418, "post_id": 57279530, "comment_id": 101059742, "body": "You can trivially <a href=\"https://stackoverflow.com/questions/28757340/go-using-using-a-string-in-a-byte-function-type-argument\">convert a byte slice it to a string</a>."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 9362384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Me5D7ndvXKM/AAAAAAAAAAI/AAAAAAAAADg/noEOiJQPv-E/photo.jpg?sz=128", "display_name": "Melody Anoni", "link": "https://stackoverflow.com/users/9362384/melody-anoni"}, "edited": false, "score": 0, "creation_date": 1564534833, "post_id": 57279847, "comment_id": 101059640, "body": "I had the same question, seems like such a straightforward thing, but I&#39;m filling variables in a struct to write to a template so I need to pass strings. I was aware of this method but it seemed a bit much compared to what es6 can do, so I wanted to ask."}, {"owner": {"reputation": 133, "user_id": 9362384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Me5D7ndvXKM/AAAAAAAAAAI/AAAAAAAAADg/noEOiJQPv-E/photo.jpg?sz=128", "display_name": "Melody Anoni", "link": "https://stackoverflow.com/users/9362384/melody-anoni"}, "edited": false, "score": 0, "creation_date": 1564549708, "post_id": 57279847, "comment_id": 101062380, "body": "Thank you, I&#39;m making such basic mistakes in this new language. I like it, just have to go through growing pains I guess."}, {"owner": {"reputation": 133, "user_id": 9362384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Me5D7ndvXKM/AAAAAAAAAAI/AAAAAAAAADg/noEOiJQPv-E/photo.jpg?sz=128", "display_name": "Melody Anoni", "link": "https://stackoverflow.com/users/9362384/melody-anoni"}, "edited": false, "score": 0, "creation_date": 1564578306, "post_id": 57279847, "comment_id": 101077265, "body": "Another question, why can&#39;t I do the same if the value is an int? So for the values in the brackets <code>1</code> and <code>8000</code> I can&#39;t just do <code>int(numberinput)</code> or <code>int(portinput)</code> or I&#39;ll get the error <code>cannot use numberinput (type []byte) as the type int in field value</code>"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 133, "user_id": 9362384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Me5D7ndvXKM/AAAAAAAAAAI/AAAAAAAAADg/noEOiJQPv-E/photo.jpg?sz=128", "display_name": "Melody Anoni", "link": "https://stackoverflow.com/users/9362384/melody-anoni"}, "edited": false, "score": 1, "creation_date": 1564582033, "post_id": 57279847, "comment_id": 101079723, "body": "@MelodyAnoni I put my updated answer. explaining in comment will be harder. please take a look"}, {"owner": {"reputation": 133, "user_id": 9362384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Me5D7ndvXKM/AAAAAAAAAAI/AAAAAAAAADg/noEOiJQPv-E/photo.jpg?sz=128", "display_name": "Melody Anoni", "link": "https://stackoverflow.com/users/9362384/melody-anoni"}, "edited": false, "score": 0, "creation_date": 1564588807, "post_id": 57279847, "comment_id": 101083870, "body": "Thank you, you&#39;ve helped me a lot"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 9, "last_activity_date": 1564582644, "last_edit_date": 1564582644, "creation_date": 1564519885, "answer_id": 57279847, "question_id": 57279530, "link": "https://stackoverflow.com/questions/57279530/how-to-use-string-literals-in-go/57279847#57279847", "title": "How to use string literals in go", "body": "<p>In go, there is no such thing as string template literals like on es6. But you can definitely do something similar using <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\">fmt.Sprintf</a>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>fmt.Sprintf(\"hello %s! happy coding.\", input)\n</code></pre>\n\n<p>In your case it would be something like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>bot := DigitalAssistant{fmt.Sprintf(\"%s\", input), \"teamAwesome\", \"awesomebotimagename\", \"0.1.0\", 1, 8000, \"health\", \"fakeperson@gmail.com\"}\n</code></pre>\n\n<hr>\n\n<p>A curious question by the way. Why tho you need to use string template literals on a very straightforward string like <code>${input}</code>? why not just <code>input</code>?</p>\n\n<hr>\n\n<h1>EDIT 1</h1>\n\n<blockquote>\n  <p>I cannot just put input because go gives the error cannot use input (type []byte) as type string in field value</p>\n</blockquote>\n\n<p><code>[]byte</code> is convertible into string. If your <code>input</code> type is <code>[]byte</code>, simply write it as <code>string(input)</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>bot := DigitalAssistant{string(input), \"teamAwesome\", \"awesomebotimagename\", \"0.1.0\", 1, 8000, \"health\", \"fakeperson@gmail.com\"}\n</code></pre>\n\n<hr>\n\n<h1>EDIT 2</h1>\n\n<blockquote>\n  <p>why can't I do the same if the value is an int? So for the values in the brackets 1 and 8000 I can't just do <code>int(numberinput)</code> or <code>int(portinput)</code> or I'll get the error <code>cannot use numberinput (type []byte) as the type int in field value</code></p>\n</blockquote>\n\n<p>Conversion from <code>string</code> to <code>[]byte</code> or vice versa can be achieved by using the <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">explicit conversion <code>T(v)</code></a>. However, this method is not applicable across all types.</p>\n\n<p>For example to convert <code>[]byte</code> into <code>int</code>, it requires more than one step. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// convert `[]byte` into `string` using explicit conversion\nvalueInString := string(bytesData) \n\n// then use `strconv.Atoi()` to convert `string` into `int`\nvalueInInteger, _ := strconv.Atoi(valueInString) \n\nfmt.Println(valueInInteger)\n</code></pre>\n\n<p>I suggest to take a look at <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">go spec: conversion</a>.</p>\n"}], "owner": {"reputation": 133, "user_id": 9362384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Me5D7ndvXKM/AAAAAAAAAAI/AAAAAAAAADg/noEOiJQPv-E/photo.jpg?sz=128", "display_name": "Melody Anoni", "link": "https://stackoverflow.com/users/9362384/melody-anoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6243, "favorite_count": 1, "accepted_answer_id": 57279847, "answer_count": 1, "score": -2, "last_activity_date": 1564582644, "creation_date": 1564518308, "question_id": 57279530, "link": "https://stackoverflow.com/questions/57279530/how-to-use-string-literals-in-go", "title": "How to use string literals in go", "body": "<p>In a go template I want to replace the the strings below with variables:</p>\n\n<pre><code>bot := DigitalAssistant{\"bobisyouruncle\", \"teamAwesome\", \"awesomebotimagename\", \"0.1.0\", 1, 8000, \"health\", \"fakeperson@gmail.com\"}\n</code></pre>\n\n<p>Say I want to replace <code>bobisyouruncle</code> with the variable <code>input</code></p>\n\n<h2>How can I do this?</h2>\n\n<p>In js this is simply:</p>\n\n<pre><code>bot := DigitalAssistant{`${input}`, \"teamAwesome\", \"awesomebotimagename\", \"0.1.0\", 1, 8000, \"health\", \"fakeperson@gmail.com\"}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 5, "creation_date": 1564515606, "post_id": 57278920, "comment_id": 101054492, "body": "&quot;but the whole array it is still an <code>[]interface{}</code>&quot; - yes. That&#39;s how &quot;a slice of any type&quot; is expressed in go. What is the question, again?"}, {"owner": {"reputation": 57, "user_id": 10980799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc22d5faefe27f32cdc4359533600cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Soto", "link": "https://stackoverflow.com/users/10980799/javier-soto"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1564516100, "post_id": 57278920, "comment_id": 101054704, "body": "I need it to return the slice with the respective type i send, in this case int or string"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1564516496, "last_edit_date": 1564516496, "creation_date": 1564515798, "answer_id": 57278981, "question_id": 57278920, "link": "https://stackoverflow.com/questions/57278920/how-to-return-a-slice-of-an-specific-type-depending-on-the-variable-i-send-to-th/57278981#57278981", "title": "How to return a slice of an specific type depending on the variable i send to the function in Go", "body": "<p>The <code>tempArray</code> in the question has the slice you want.  Return it instead of copying the values to the <code>[]interface{}</code> that you don't want.</p>\n\n<p>Use this code:</p>\n\n<pre><code>func testingInterface(x interface{}) (interface{}, interface{}) {\n    var result interface{}\n    switch x.(type) {\n    case int:\n        result = make([]int, 3)\n    case string:\n        result = make([]string, 3)\n    }\n    return result, x\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10980799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc22d5faefe27f32cdc4359533600cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Soto", "link": "https://stackoverflow.com/users/10980799/javier-soto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1564517285, "creation_date": 1564515435, "last_edit_date": 1564517285, "question_id": 57278920, "link": "https://stackoverflow.com/questions/57278920/how-to-return-a-slice-of-an-specific-type-depending-on-the-variable-i-send-to-th", "title": "How to return a slice of an specific type depending on the variable i send to the function in Go", "body": "<p>I have a function, that takes an empty interface (any type, which im looking for 2 in specific) and then returning a slice of the selected type.</p>\n\n<pre><code>func testingInterface(temp interface{}) (interface{}, interface{}) {\nvar doc interface{}\n\narray := make([]interface{}, 3)\n\nswitch x := temp.(type) {\ncase int:\n    doc = x\n    tempArray := make([]string, 3)\n    for i, v := range tempArray {\n        array[i] = string(v)\n    }\n    fmt.Printf(\"Int to string %T, %T \", doc, tempArray)\ncase string:\n    doc = x\n    tempArray := make([]int, 3)\n\n    for i, v := range tempArray {\n        array[i] = int(v)\n    }\n    fmt.Printf(\"String to int %T, %T \", doc, tempArray)\n}\n\n  return array, doc\n}\n</code></pre>\n\n<p>So what happens, it is that the doc variable indeed changes the type of it, but the slice when i return it, it stays as []interface{}\nWhen i test an element individual, it changes the type but the whole array it is still an []interface{}</p>\n"}, {"tags": ["go", "grpc"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1564517928, "post_id": 57278822, "comment_id": 101055427, "body": "Why do you care about the client-side&#39;s port number?  What is the larger problem you are trying to solve here?"}, {"owner": {"reputation": 5320, "user_id": 1185576, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/57ef1b774399e777c88bbfe24c205f0c?s=128&d=identicon&r=PG", "display_name": "JTApps", "link": "https://stackoverflow.com/users/1185576/jtapps"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1564518115, "post_id": 57278822, "comment_id": 101055503, "body": "Server A knows the address and port of Server B, but not the inverse. Somehow, I need to inform Server B of the address and port of Server A so that Server B may in the future communicate with Server A. So, I am attempting to scrape that information from the context provided by the incoming communication from Server A to Server B, however, the port number is inaccurate, thus this post."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1564518616, "post_id": 57278822, "comment_id": 101055660, "body": "why not have a gRPC service hosted on serverA on a well known port, so that server B can talk back directly?  Are you trying to do this to handle a particular transaction and need to maintain transaction state? If so, I&#39;d use some token exchange rather than involving some potentially complicated communication pathway."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8374916, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d48ec9fb9f737dbfd4959bd4428e298b?s=128&d=identicon&r=PG&f=1", "display_name": "yongguangl", "link": "https://stackoverflow.com/users/8374916/yongguangl"}, "edited": false, "score": 0, "creation_date": 1576949691, "post_id": 57281481, "comment_id": 105060778, "body": "Hello,that&#39;s great! But... how do I specify the source port on the java-client channel = ManagedChannelBuilder.forAddress(host, port).build();"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 4, "last_activity_date": 1564531186, "creation_date": 1564531186, "answer_id": 57281481, "question_id": 57278822, "link": "https://stackoverflow.com/questions/57278822/sending-grpc-communications-over-a-specific-port/57281481#57281481", "title": "Sending GRPC communications over a specific port", "body": "<p>You can specify the source port like this:</p>\n\n<pre><code>cc, err := grpc.Dial(\"127.0.0.1:6001\", grpc.WithInsecure(),\n    grpc.WithContextDialer(func(ctx context.Context, addr string) (net.Conn, error) {\n        dst, err := net.ResolveTCPAddr(\"tcp\", addr)\n        if err != nil {\n            return nil, err\n        }\n        src := &amp;net.TCPAddr{\n            IP:   net.ParseIP(\"127.0.0.1\"),\n            Port: 6000,\n        }\n        return net.DialTCP(\"tcp\", src, dst)\n    }))\n</code></pre>\n\n<p>However if your server is listening on the same port this will result in an error:</p>\n\n<pre><code>panic: dial tcp 127.0.0.1:6000-&gt;127.0.0.1:6001: bind: address already in use\n</code></pre>\n\n<p>A different approach would be to pass the address as metadata. On the client you do:</p>\n\n<pre><code>ctx := context.Background()\nctx = metadata.NewOutgoingContext(ctx, metadata.Pairs(\"address\", \"127.0.0.1:6000\"))\nres, err := grpc_health_v1.NewHealthClient(cc).Check(ctx, &amp;grpc_health_v1.HealthCheckRequest{\n    Service: \"test\",\n})\n</code></pre>\n\n<p>And on the server:</p>\n\n<pre><code>func (s *server) Check(ctx context.Context, req *grpc_health_v1.HealthCheckRequest) (*grpc_health_v1.HealthCheckResponse, error) {\n    if md, ok := metadata.FromIncomingContext(ctx); ok {\n        addr := md.Get(\"address\")\n        // addr == \"127.0.0.1:6000\"\n    }\n\n    return &amp;grpc_health_v1.HealthCheckResponse{\n        Status: grpc_health_v1.HealthCheckResponse_SERVING,\n    }, nil\n}\n</code></pre>\n\n<p>And a third approach would be to use <a href=\"https://github.com/grpc/grpc/blob/master/CONCEPTS.md#streaming\" rel=\"nofollow noreferrer\">streaming</a>.</p>\n"}], "owner": {"reputation": 5320, "user_id": 1185576, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/57ef1b774399e777c88bbfe24c205f0c?s=128&d=identicon&r=PG", "display_name": "JTApps", "link": "https://stackoverflow.com/users/1185576/jtapps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1446, "favorite_count": 3, "accepted_answer_id": 57281481, "answer_count": 1, "score": 2, "last_activity_date": 1564531186, "creation_date": 1564514937, "last_edit_date": 1564518170, "question_id": 57278822, "link": "https://stackoverflow.com/questions/57278822/sending-grpc-communications-over-a-specific-port", "title": "Sending GRPC communications over a specific port", "body": "<p>I am running a GRPC server (Server A) listening on a specific port. I want to be able to send a communication to another server (Server B), and have Server B record the incoming address of Server A's connection so that it may later contact Server A.</p>\n\n<p>On Server A, I listen on a port and create a context like such:</p>\n\n<pre><code>lis, err := net.Listen(\"tcp\", \"0.0.0.0:6000\")\nctx, cancel := context.WithTimeout(context.Background(),\n    10000*time.Millisecond)\n</code></pre>\n\n<p>Then create a connection like so:</p>\n\n<pre><code>connection, err = grpc.DialContext(ctx, server2Address,\ngrpc.WithInsecure(), grpc.WithBlock())\n</code></pre>\n\n<p>Before finally sending a message to an endpoint on Server B, which attempts to read the IP address of Server A's incoming connection</p>\n\n<pre><code>info, _ := peer.FromContext(ctx)\nfmt.Printf(info.Addr.String()) // Returns a random port, NOT 6000,\n</code></pre>\n\n<p>However, the resulting port printed by Server B is random, like 62056 as opposed to 6000 as intended. My assumption is that, on Server A, GRPC dials from a random port - is it possible to force GRPC to dial from port 6000 as opposed to a random port? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 5, "creation_date": 1564512920, "post_id": 57278341, "comment_id": 101053330, "body": "There&#39;s no such thing in Go."}, {"owner": {"reputation": 5838, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "edited": false, "score": 1, "creation_date": 1564513111, "post_id": 57278341, "comment_id": 101053421, "body": "Your example is misleading, in <code>python</code> <code>else</code> part of the <code>while</code> loop will not be executed in case of <code>break</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1564513256, "post_id": 57278341, "comment_id": 101053481, "body": "Wow. I&#39;ve never run into a &#39;for-else&#39; or &#39;while-else&#39;... and so glad. I can&#39;t figure out what it even means. So completely unintuitive."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1564513781, "post_id": 57278341, "comment_id": 101053685, "body": "@Flimzy  You might have run into this construct before. See range-else in text/template and html/template."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564513819, "post_id": 57278341, "comment_id": 101053706, "body": "@CeriseLim&#243;n: :/"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1564520901, "creation_date": 1564520901, "answer_id": 57280060, "question_id": 57278341, "link": "https://stackoverflow.com/questions/57278341/how-to-do-a-for-else-loop-while-else-in-other-languages/57280060#57280060", "title": "How to do a For-Else loop (While-Else in other languages)?", "body": "<blockquote>\n  <p><a href=\"https://docs.python.org/3/index.html\" rel=\"nofollow noreferrer\">Python 3.7.4 documentation</a></p>\n  \n  <p><a href=\"https://docs.python.org/3/reference/compound_stmts.html#the-while-statement\" rel=\"nofollow noreferrer\">8.2. The while statement</a></p>\n  \n  <p>The while statement is used for repeated execution as long as an\n  expression is true:</p>\n\n<pre><code>while_stmt ::=  \"while\" expression \":\" suite\n                [\"else\" \":\" suite]\n</code></pre>\n  \n  <p>This repeatedly tests the expression and, if it is true, executes the\n  first suite; if the expression is false (which may be the first time\n  it is tested) the suite of the else clause, if present, is executed\n  and the loop terminates.</p>\n  \n  <p>A break statement executed in the first suite terminates the loop\n  without executing the else clause\u2019s suite.</p>\n</blockquote>\n\n<hr>\n\n<p>Your code:</p>\n\n<pre><code>while myVar &lt;= 10 :\n     myVar == myNum :\n             print 'Breaking out of the loop'\n             break\n     print 'This number = ' + str(myVar)\n     myVar += 1\n else:\n     print 'Break statement is executed, printing \"else\" block'\n</code></pre>\n\n<hr>\n\n<p>Your example, in Go,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    var myNum int = 7\n    var myVar int = 0\n    for {\n        if myVar &lt;= 10 {\n            if myVar == myNum {\n                fmt.Println(\"Breaking out of the loop\")\n                break\n            }\n            fmt.Println(\"This number = \" + strconv.Itoa(myVar))\n            myVar++\n        } else {\n            fmt.Println(`\"while\" \"else\" block`)\n            break\n        }\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/MkwhWfL4cr6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MkwhWfL4cr6</a></p>\n\n<p>Output:</p>\n\n<pre><code>This number = 0\nThis number = 1\nThis number = 2\nThis number = 3\nThis number = 4\nThis number = 5\nThis number = 6\nBreaking out of the loop\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2894826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87042715d9859964f6c25b2815bd71d?s=128&d=identicon&r=PG&f=1", "display_name": "spooky", "link": "https://stackoverflow.com/users/2894826/spooky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1564542951, "creation_date": 1564512817, "last_edit_date": 1564542951, "question_id": 57278341, "link": "https://stackoverflow.com/questions/57278341/how-to-do-a-for-else-loop-while-else-in-other-languages", "title": "How to do a For-Else loop (While-Else in other languages)?", "body": "<p>A while back I have read/seen that you can do a For-Else loop in Go, but now I cannot find the correct syntax anymore. I find it a very useful construct, and would like to have it in my toolbelt.</p>\n\n<p>For a python example of what I mean see <a href=\"http://www.yourownlinux.com/2016/12/python-while-else-loop-break-continue-statement.html\" rel=\"nofollow noreferrer\">http://www.yourownlinux.com/2016/12/python-while-else-loop-break-continue-statement.html</a> .</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>while myVar &lt;= 10 :\n     myVar == myNum :\n             print 'Breaking out of the loop'\n             break\n     print 'This number = ' + str(myVar)\n     myVar += 1\n else:\n     print 'Break statement is executed, printing \"else\" block'\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564510197, "post_id": 57277634, "comment_id": 101051999, "body": "What output size do you expect?"}, {"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564510244, "post_id": 57277634, "comment_id": 101052018, "body": "I&#39;m not sure what the output size should be, but for a picture thats only a few hundred KB, an output of []uint8 that&#39;s 30 MB seems way too large."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1564510563, "post_id": 57277634, "comment_id": 101052169, "body": "It&#39;s not impossible that an 8 megapixel image (e.g 4000x2000) is compressed into a 300 KB JPEG (depends on the compression level). If you take this example, 8 megapixel each having 3 byte (RGB), that results in 24 million bytes =&gt; 24 MB. If there&#39;s an alpha channel, that is 32 MB. I see nothing unusal here."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1564511025, "post_id": 57277634, "comment_id": 101052411, "body": "Also if the source is not a photo (but e.g. a generated image), if it has wide areas having the same pixel, formats such as PNG can make it really small, yet if you decode it, it will have the same amount of pixels,,,"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564514431, "post_id": 57277634, "comment_id": 101053993, "body": "The code converts the data bytes to space separated decimal values.  Is that your actual goal, or did you intend to write the bytes as is to the file?"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1564514583, "post_id": 57278145, "comment_id": 101054061, "body": "Yes, the rest is right, the stuff about runes is a red herring."}], "tags": [], "owner": {"reputation": 196, "user_id": 678463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3213da6ebb48d08e4c87370fa62af512?s=128&d=identicon&r=PG", "display_name": "autophage", "link": "https://stackoverflow.com/users/678463/autophage"}, "is_accepted": true, "score": 1, "last_activity_date": 1564515306, "last_edit_date": 1564515306, "creation_date": 1564511970, "answer_id": 57278145, "question_id": 57277634, "link": "https://stackoverflow.com/questions/57277634/trouble-coverting-image-to-uint8/57278145#57278145", "title": "Trouble coverting image to []uint8", "body": "<p>The size on an 8-bit integer is, by definition, 8 bits (or 1 byte).</p>\n\n<p>(Editing to remove erroneous information, which I'll repost for posterity below.)</p>\n\n<p>The string representation being output is not one character per number - it's several (for example, the int you list first - <code>65</code> - is being represented by <em>three</em> characters - a 6, a 5, and a space.  That would increase the expected size threefold, from 300k to 900k.</p>\n\n<p>As for the rest, I would think that (as <a href=\"https://stackoverflow.com/users/1705598/icza\">icza</a> said in a comment) image compression may be the culprit.</p>\n\n<hr>\n\n<p>(The irrelevant information I'd initially posted as part of my answer was:</p>\n\n<blockquote>\n  <p>Go has two character types, <code>byte</code> and <code>rune</code>.  A byte being used to store a character is the same size as a byte being used to store an integer - both are 8 bits.  But a character being stored as a <code>rune</code> is going to be 32 bits (see <a href=\"https://www.callicoder.com/golang-basic-types-operators-type-conversion/\" rel=\"nofollow noreferrer\">https://www.callicoder.com/golang-basic-types-operators-type-conversion/</a>).  So, if the characters being written out are <code>rune</code>s, that would explain a four-fold increase in size (because 32 / 8 = 4)...</p>\n</blockquote>\n"}], "owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 57278145, "answer_count": 1, "score": -4, "last_activity_date": 1564588507, "creation_date": 1564510034, "last_edit_date": 1564588507, "question_id": 57277634, "link": "https://stackoverflow.com/questions/57277634/trouble-coverting-image-to-uint8", "title": "Trouble coverting image to []uint8", "body": "<p>How can I extract raw []uint8 from an image?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564509915, "post_id": 57276191, "comment_id": 101051881, "body": "Google has an API for getting location and review information from maps."}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564511778, "post_id": 57276191, "comment_id": 101052813, "body": "I may be wrong but you can take only the last 5 reviews. Or maybe you have other info?"}], "owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564576375, "creation_date": 1564504363, "last_edit_date": 1564576375, "question_id": 57276191, "link": "https://stackoverflow.com/questions/57276191/how-to-scroll-with-chromedp-go-parser", "title": "How to scroll with Chromedp Go parser?", "body": "<p>I am parsing Google reviews from Google maps. They have an interface where you get eight reviews and then you need to scroll and they lazy-load the rest of them. </p>\n\n<p>I have been stuck for three days with this issue and cannot make things work. I tried to <code>Scrollintoview</code> all of the DOM nodes but to no effect.</p>\n\n<p>Here is the page and I need to scroll left panel.</p>\n\n<p><a href=\"https://www.google.com/maps/place/Starbucks/@42.040939,-87.7331847,17z/data=!3m1!4b1!4m5!3m4!1s0x880fcf9be1d47233:0xfe201c7e7e5b1ed5!8m2!3d42.040935!4d-87.730996\" rel=\"nofollow noreferrer\">https://www.google.com/maps/place/Starbucks/@42.040939,-87.7331847,17z/data=!3m1!4b1!4m5!3m4!1s0x880fcf9be1d47233:0xfe201c7e7e5b1ed5!8m2!3d42.040935!4d-87.730996</a></p>\n\n<p>Can someone give me a direction to continue my research?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 3, "creation_date": 1564503341, "post_id": 57275858, "comment_id": 101049721, "body": "The information tells you that it can store an int in the range of an 32bit int, but that it\u2019s size can be larger then 32bit if this will have performance benefits. Even if it is larger then 32bit you should not expect that it can represent a larger numeric range."}], "answers": [{"comments": [{"owner": {"reputation": 2204, "user_id": 1089063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ddcb2f712209d5d79a5fee8edb2a6d37?s=128&d=identicon&r=PG", "display_name": "Yad Smood", "link": "https://stackoverflow.com/users/1089063/yad-smood"}, "edited": false, "score": 0, "creation_date": 1564503411, "post_id": 57275892, "comment_id": 101049759, "body": "I know I can use int64. I&#39;m just curious about the edge case. And they are lacking doc for that. I just want at least one real example when it will be larger than int32. This is not a question asking for best practice."}, {"owner": {"reputation": 18299, "user_id": 2648811, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee5af60b10a2d5fd8c864437a2062f0a?s=128&d=identicon&r=PG", "display_name": "Green Cloak Guy", "link": "https://stackoverflow.com/users/2648811/green-cloak-guy"}, "reply_to_user": {"reputation": 2204, "user_id": 1089063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ddcb2f712209d5d79a5fee8edb2a6d37?s=128&d=identicon&r=PG", "display_name": "Yad Smood", "link": "https://stackoverflow.com/users/1089063/yad-smood"}, "edited": false, "score": 0, "creation_date": 1564503779, "post_id": 57275892, "comment_id": 101049934, "body": "The docs are pretty clear that it&#39;s implementation-defined - the best way to figure out actual examples would be to actually run a bunch of tests on various different environments (similar to <a href=\"http://ivbel.blogspot.com/2012/02/size-of-primitive-types-in-c-language.html\" rel=\"nofollow noreferrer\">what this person did for C</a>)."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 2204, "user_id": 1089063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ddcb2f712209d5d79a5fee8edb2a6d37?s=128&d=identicon&r=PG", "display_name": "Yad Smood", "link": "https://stackoverflow.com/users/1089063/yad-smood"}, "edited": false, "score": 1, "creation_date": 1564503835, "post_id": 57275892, "comment_id": 101049959, "body": "@YadSmood there is no edge case. <code>int</code> is whatever is the most convenient sized integer for the platform. It will normally be 32 bits on a 32-bit machine, and 64 bits on a 64-bit machine."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1564503983, "post_id": 57275892, "comment_id": 101050027, "body": "You should use it whenever you&#39;re counting things, and there&#39;s no requirement to go above 2^32, but there&#39;s also no requirement that it is exactly 32 bits (no reliance on bit representation, overflow/wrapping, etc.). This lets the compiler choose whatever will be most efficient."}], "tags": [], "owner": {"reputation": 18299, "user_id": 2648811, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee5af60b10a2d5fd8c864437a2062f0a?s=128&d=identicon&r=PG", "display_name": "Green Cloak Guy", "link": "https://stackoverflow.com/users/2648811/green-cloak-guy"}, "is_accepted": false, "score": 5, "last_activity_date": 1564504230, "last_edit_date": 1564504230, "creation_date": 1564503091, "answer_id": 57275892, "question_id": 57275858, "link": "https://stackoverflow.com/questions/57275858/when-will-int-be-64-bits/57275892#57275892", "title": "When will int be 64 bits?", "body": "<p>The size of an <code>int</code> is implementation-defined, presumably, meaning it would vary from platform to platform depending on the operating system and kernel architecture. This is the case in most programming languages (C, for example). </p>\n\n<p>If you <em>must</em> have a 64-bit integer exactly, then, well, the <code>int64</code> type exists, which will guarantee that there are exactly 64 bits in your integer. Same with <code>int32</code>, <code>int16</code>, etc. Otherwise, the documentation recommends using <code>int</code>, as the compiler can then optimize the code more easily.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1564518742, "last_edit_date": 1564518742, "creation_date": 1564508392, "answer_id": 57277243, "question_id": 57275858, "link": "https://stackoverflow.com/questions/57275858/when-will-int-be-64-bits/57277243#57277243", "title": "When will int be 64 bits?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"nofollow noreferrer\">Numeric types</a></p>\n  \n  <p>There is also a set of predeclared numeric types with\n  implementation-specific sizes:</p>\n\n<pre><code>uint     either 32 or 64 bits\nint      same size as uint\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>The size of <code>int</code> depends on the compiler writer. It's typically a natural, efficient size for the host machine. For example, 64 bits on amd64 and 32 bits on 386 architectures. </p>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"strconv\"\n)\n\nfunc main() {\n    fmt.Println(runtime.GOARCH, strconv.IntSize)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ uname -p\nx86_64\n$ go run intsize.go\namd64 64\n$ \n</code></pre>\n\n<hr>\n\n<p>Playground: <a href=\"https://play.golang.org/p/wyNm2Hyzl6W\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wyNm2Hyzl6W</a></p>\n\n<p>Output:</p>\n\n<pre><code>amd64p32 32\n</code></pre>\n\n<p><a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">The Go Blog: Inside the Go Playground</a></p>\n\n<hr>\n\n<p>Go inherited this from C.</p>\n\n<blockquote>\n  <p><a href=\"https://www.pearson.com/us/higher-education/program/Kernighan-C-Programming-Language-2nd-Edition/PGM54487.html\" rel=\"nofollow noreferrer\">The C Programming Language, 2nd Edition, Brian W. Kernighan and\n  Dennis Ritchie</a></p>\n  \n  <p><code>int</code>  an integer, typically reflecting the natural size of integers on\n  the host machine</p>\n</blockquote>\n"}], "owner": {"reputation": 2204, "user_id": 1089063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ddcb2f712209d5d79a5fee8edb2a6d37?s=128&d=identicon&r=PG", "display_name": "Yad Smood", "link": "https://stackoverflow.com/users/1089063/yad-smood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 1, "accepted_answer_id": 57277243, "answer_count": 2, "score": -3, "last_activity_date": 1564730423, "creation_date": 1564502980, "last_edit_date": 1564730423, "question_id": 57275858, "link": "https://stackoverflow.com/questions/57275858/when-will-int-be-64-bits", "title": "When will int be 64 bits?", "body": "<p>According to the <a href=\"https://golang.org/pkg/builtin/#int\" rel=\"nofollow noreferrer\">doc</a>:</p>\n\n<blockquote>\n  <p>int is a signed integer type that is at least 32 bits in size. It is a distinct type, however, and not an alias for, say, int32.</p>\n</blockquote>\n\n<p>But it doesn't say which platform or when it will be larger than int32.</p>\n\n<p>Can anyone give me more details about it? Or where is the source code to handle it? Can I force the compiler to make int 64 bits?</p>\n\n<p>I know I can use int64. This is not a question asking for best practice.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 1, "creation_date": 1564500907, "post_id": 57275285, "comment_id": 101048475, "body": "What is the status code? How about the output of <code>fmt.Sprintf(&quot;%s&#47;upload&quot;, config.Host)</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1564501134, "post_id": 57275285, "comment_id": 101048599, "body": "It&#39;s generally a fruitless line of thinking to start by assuming that a core function of a language used extensively in production by multiple major companies is faulty. It is extremely unlikely to be <code>http.Post</code> that isn&#39;t working, and far more likely to be either your code, your operating environment, or the remote host. Whenever an HTTP request doesn&#39;t work as expected, it&#39;s always a good idea to at least check the response code."}, {"owner": {"reputation": 553, "user_id": 546791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa2c6acbe2fcbd4897bea2c255aade5?s=128&d=identicon&r=PG", "display_name": "Anthony Green", "link": "https://stackoverflow.com/users/546791/anthony-green"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1564502247, "post_id": 57275285, "comment_id": 101049174, "body": "@Adrian, the only assumption I&#39;m making is that I&#39;m doing something wrong, which is why I posted that code fragment.  I&#39;ll check the response code... thanks."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1564542321, "post_id": 57275285, "comment_id": 101060890, "body": "<a href=\"https://golang.org/pkg/net/http/httputil/#DumpResponse\" rel=\"nofollow noreferrer\">httputil.DumpResponse</a> is very useful for debugging. Wild guess: the server expects a multiparty form but you are sending the file itself in the body. Also try <a href=\"https://mholt.github.io/curl-to-go/\" rel=\"nofollow noreferrer\">curl-to-go</a>, but note that not all curl options are supported."}], "answers": [{"tags": [], "owner": {"reputation": 553, "user_id": 546791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa2c6acbe2fcbd4897bea2c255aade5?s=128&d=identicon&r=PG", "display_name": "Anthony Green", "link": "https://stackoverflow.com/users/546791/anthony-green"}, "is_accepted": false, "score": 0, "last_activity_date": 1564569211, "creation_date": 1564569211, "answer_id": 57288757, "question_id": 57275285, "link": "https://stackoverflow.com/questions/57275285/http-post-in-go-not-working/57288757#57288757", "title": "http.Post in go not working?", "body": "<p>Thanks for the pointers.  I never thought to check the status code.  I was getting a 307 (Temporary Redirect), not 200.  My solution is to loop around, following 'location', up to a max redirect count.  I've read that the default http client code in go follows redirects, so I'm a little surprised that I have to do this.  Both go and http programming are new to me, and I appreciate the help!</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1436881020, "open_beta_date": 1296068400, "closed_beta_date": 1295463600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon@2.png", "twitter_account": "StackCodeReview", "favicon_url": "https://cdn.sstatic.net/Sites/codereview/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon.png", "audience": "peer programmer code reviews", "site_url": "https://codereview.stackexchange.com", "api_site_parameter": "codereview", "logo_url": "https://cdn.sstatic.net/Sites/codereview/Img/logo.png", "name": "Code Review", "site_type": "main_site"}, "on_date": 1564500817, "question_id": 225204}, "owner": {"reputation": 553, "user_id": 546791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa2c6acbe2fcbd4897bea2c255aade5?s=128&d=identicon&r=PG", "display_name": "Anthony Green", "link": "https://stackoverflow.com/users/546791/anthony-green"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1564569211, "creation_date": 1564500149, "question_id": 57275285, "link": "https://stackoverflow.com/questions/57275285/http-post-in-go-not-working", "title": "http.Post in go not working?", "body": "<p>I'm trying to hit a file upload API with this bit of go code in a cli tool.  The post doesn't seem to even hit the server, but this code runs with no error, and the result message is an empty string.</p>\n\n<p>curl works.<br>\nOther Posts work.</p>\n\n<p>Any advice?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>file, err := os.Open(c.Args().Get(0))\n\nif err != nil {\n    exitErr(err)\n}\n\ndefer file.Close()\n\nfmt.Print(\"About to upload file \", c.Args().Get(0), \"\\n\");\nres, err := http.Post(fmt.Sprintf(\"%s/upload\", config.Host), \"application/octet-stream\", file)\nif err != nil {\n    exitErr(err)\n}\n\ndefer res.Body.Close()\n\nmessage, err := ioutil.ReadAll(res.Body)\n\nif err != nil {\n    exitErr(err)\n}\n\nfmt.Print(\"Uploaded result: \", string(message), \"\\n\")\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 6, "creation_date": 1564499404, "post_id": 57274824, "comment_id": 101047663, "body": "Value of <code>x</code> &quot;resets&quot; every time you call <i><code>foo()</code></i> (or more precisely you get a new instance of <code>x</code>), but you only call <code>foo()</code> once. Later you call the function value it returns, which is a closure, closing over a single instance of <code>x</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1564499990, "post_id": 57274824, "comment_id": 101047975, "body": "To plainly demonstrate @icza&#39;s point: <a href=\"https://play.golang.org/p/C0OkKffYqGf\" rel=\"nofollow noreferrer\">play.golang.org/p/C0OkKffYqGf</a>"}], "answers": [{"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 1, "last_activity_date": 1564501639, "creation_date": 1564501639, "answer_id": 57275490, "question_id": 57274824, "link": "https://stackoverflow.com/questions/57274824/why-value-to-variable-x-increasing-in-function/57275490#57275490", "title": "Why Value To Variable X Increasing In Function?", "body": "<p>Your function <code>foo</code> returns a new function each time it's called. <code>foo</code> doesn't <em>just</em> create that function though, it also allocates memory for a variable called <code>x</code> of type <code>int</code>. That variable is declared in the scope of <code>foo</code>, and as such, the function <code>foo</code> returns has access to that variable.</p>\n\n<p>In essence, you're returning what is often referred to as a <em>closure</em>. A function that has access to a scope (variables) that are invisible to any other code. To visually represent this, maybe thing of it like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nu0b8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nu0b8.png\" alt=\"closure\"></a></p>\n\n<p>The function is what you return, the <em>\"environment record\"</em> it holds on to is the function body of <code>foo</code>, and all of the variables declared there (in your case <code>x</code>). The next environment record would be the package (variables declared outside functions with <code>var</code>).</p>\n\n<p>So what happens exactly:</p>\n\n<pre><code>a := foo()\n</code></pre>\n\n<p>Here, <code>foo</code> allocates variable <code>x</code>, and returns a function that holds on to this new variable.</p>\n\n<pre><code>a() // returns 1\na() // returns 2\n</code></pre>\n\n<p>The <code>x</code> variable created by <code>foo</code> is incremented, and its new value is returned each time.</p>\n\n<p>Now that you know this, you should be able to work out what the output here will be:</p>\n\n<pre><code>a, b := foo(), foo() // creates 2 functions, 2 variables called x\n_ = a()\n_ = a()\nfmt.Printf(\"a call returned %d\\nb call returned %d\\n\", a(), b())\n</code></pre>\n\n<p>The output should be <em>\"a call returned 3 b call returned 1\"</em></p>\n"}], "owner": {"reputation": 17, "user_id": 11746824, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ij08wBfvA_Y/AAAAAAAAAAI/AAAAAAAAAow/9Wa5OeYg374/photo.jpg?sz=128", "display_name": "M A D H U R", "link": "https://stackoverflow.com/users/11746824/m-a-d-h-u-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1564501639, "creation_date": 1564499301, "last_edit_date": 1564499368, "question_id": 57274824, "link": "https://stackoverflow.com/questions/57274824/why-value-to-variable-x-increasing-in-function", "title": "Why Value To Variable X Increasing In Function?", "body": "<p>I am unable to understand to why value of x increase even after scope end for varaiable \u2018x\u2019 in function foo(). It\u2019s must reset to zero everytime I called a function. This this not happening why?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := foo()\n\n    fmt.Printf(\"%d\\n\", a())\n    fmt.Printf(\"%d\\n\", a())\n    fmt.Printf(\"%d\\n\", a())\n\n}\n\nfunc foo() func() int {\n\n    var x int //  value should reset to zero\n    return func() int {\n        x++\n        return x\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/RSl3uNv6bBo\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}, {"tags": ["go", "testing"], "comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 1, "creation_date": 1564499921, "post_id": 57274734, "comment_id": 101047944, "body": "Can you look at the value of the <code>Location</code> header in the response?"}, {"owner": {"reputation": 45871, "user_id": 451969, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EuJtr.jpg?s=128&g=1", "display_name": "Jared Farrish", "link": "https://stackoverflow.com/users/451969/jared-farrish"}, "edited": false, "score": 1, "creation_date": 1564499992, "post_id": 57274734, "comment_id": 101047977, "body": "I&#39;m not sure about this relating to the seg error, however if I were testing, I would be inspecting the header <code>Location</code> (and status code) in the http response and not the url per se, unless <code>httptest</code> is setup to follow redirects and you receive the followed destination. From a pure point of view, you made a request and received headers back."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1564500234, "post_id": 57274734, "comment_id": 101048112, "body": "<a href=\"https://golang.org/pkg/net/http/#Response\" rel=\"nofollow noreferrer\">Per the documentation</a>, <code>Request.Response</code> &quot;is the request that was sent to obtain this Response.&quot; It has nothing to do with any redirect response received. To check for a redirect response, look at the response status code and <code>Location</code> header."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 11793831, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-751jCoubJ7s/AAAAAAAAAAI/AAAAAAAAAAc/azwXD7qEUS4/photo.jpg?sz=128", "display_name": "Sam Costley", "link": "https://stackoverflow.com/users/11793831/sam-costley"}, "is_accepted": false, "score": 0, "last_activity_date": 1564502281, "creation_date": 1564502281, "answer_id": 57275671, "question_id": 57274734, "link": "https://stackoverflow.com/questions/57274734/how-to-test-that-http-redirect-uses-correct-redirect-uri/57275671#57275671", "title": "How to test that http.Redirect uses correct redirect URI?", "body": "<p>Thanks to the comments, I have found that I was looking for the redirect url in the wrong place. The correct way to evaluate this is to capture the url from the <code>Location</code> header.</p>\n\n<pre><code>w := httptest.NewRecorder()\nMyRouterMux().ServeHTTP(w, req)\nresp := w.Result()\n\nredirectUrl, err := resp.Location()\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11793831, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-751jCoubJ7s/AAAAAAAAAAI/AAAAAAAAAAc/azwXD7qEUS4/photo.jpg?sz=128", "display_name": "Sam Costley", "link": "https://stackoverflow.com/users/11793831/sam-costley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564577538, "creation_date": 1564499007, "last_edit_date": 1564577538, "question_id": 57274734, "link": "https://stackoverflow.com/questions/57274734/how-to-test-that-http-redirect-uses-correct-redirect-uri", "title": "How to test that http.Redirect uses correct redirect URI?", "body": "<p>I have a Go backend that uses the <code>net/http</code> package. I have an endpoint that is meant to redirect using <code>http.Redirect</code> to a provided redirect URI with some generated GET parameters. I simply want to test using <code>net/http/httptest</code> and <code>testing</code> that my endpoint is redirecting to the proper URL.</p>\n\n<p>I have executed the request using <code>ServeHTTP</code> and can verify that it does return the correct status code (303 in this case). I then tried accessing the Request URL to find the most recent URL that was accessed (what I assumed to be the redirect URL), but I was unable to access this variable.</p>\n\n<pre><code>req, _ := http.NewRequest(\"GET\", \"https://www.urlthatredirects.com\"), nil)\nw := httptest.NewRecorder()\nMyRouterMux().ServeHTTP(w, req)\nresp := w.Result()\n\nredirectUrl := resp.Request.URL\n</code></pre>\n\n<p>In this example, I would expect the <code>redirectUrl</code> variable to contain the URL that was redirected to, but instead I receive <code>[signal SIGSEGV: segmentation violation ...]</code></p>\n\n<p>Any idea what could be going on? I know from manual testing that the endpoint works as intended, but I simply need to prove through the tests that it does.</p>\n"}, {"tags": ["go", "cql", "scylla", "gocql"], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 6860936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2120bfc961d4a3068c63520577224ca?s=128&d=identicon&r=PG&f=1", "display_name": "Shlomi Livne", "link": "https://stackoverflow.com/users/6860936/shlomi-livne"}, "edited": false, "score": 3, "creation_date": 1564574341, "post_id": 57278486, "comment_id": 101074938, "body": "You should use a tokenaware and a dcaware policy <a href=\"https://github.com/gocql/gocql/blob/76e94bbd190c5e89be4d470502a27bb175c2f0f5/policies.go#L782\" rel=\"nofollow noreferrer\">github.com/gocql/gocql/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 506, "user_id": 7093982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264505d54129e976e6f998b03583af00?s=128&d=identicon&r=PG&f=1", "display_name": "Tzach Livyatan", "link": "https://stackoverflow.com/users/7093982/tzach-livyatan"}, "is_accepted": true, "score": 5, "last_activity_date": 1564513478, "creation_date": 1564513478, "answer_id": 57278486, "question_id": 57273857, "link": "https://stackoverflow.com/questions/57273857/how-to-optimize-cross-shard-queries-for-scylla-db-using-gocql/57278486#57278486", "title": "How to optimize cross shard queries for scylla db using gocql", "body": "<p>First, there is an issue with this metric, and it was removed in the latest dashboard\n<a href=\"https://github.com/scylladb/scylla-monitoring/issues/659\" rel=\"noreferrer\">https://github.com/scylladb/scylla-monitoring/issues/659</a></p>\n\n<p>Second, the way to reduce cross-shard messages is using Token Aware drivers, if you can. There are two Token Aware drivers at the moment: Go and Java\n<a href=\"https://docs.scylladb.com/using-scylla/scylla_drivers/\" rel=\"noreferrer\">https://docs.scylladb.com/using-scylla/scylla_drivers/</a></p>\n"}], "owner": {"reputation": 609, "user_id": 3575408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33c85f915c91cd01b6e782b36205530?s=128&d=identicon&r=PG&f=1", "display_name": "SilentCanon", "link": "https://stackoverflow.com/users/3575408/silentcanon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 57278486, "answer_count": 1, "score": 3, "last_activity_date": 1564513478, "creation_date": 1564496283, "question_id": 57273857, "link": "https://stackoverflow.com/questions/57273857/how-to-optimize-cross-shard-queries-for-scylla-db-using-gocql", "title": "How to optimize cross shard queries for scylla db using gocql", "body": "<p>I'm using a scylla cluster with 9 nodes and replication factor to be 3.\nOne application opens one connections to it, reading and writing data.</p>\n\n<p>However, I notice in the scylla CQL optimization monitoring dashboard, the percentage for cross shard is very high, around 150%.</p>\n\n<p>Is that normal or how can I optimize it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 1, "creation_date": 1564494961, "post_id": 57273249, "comment_id": 101044727, "body": "Instead of increasing the stack size can you allocate some of this memory ahead of time and store it on the heap?"}, {"owner": {"reputation": 9564, "user_id": 743188, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/gPyaY.jpg?s=128&g=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/743188/tommy"}, "reply_to_user": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564495343, "post_id": 57273249, "comment_id": 101045008, "body": "@user2896976 I could, if I have to, but I have a machine with 64GB I&#39;m running this on so if I don&#39;t have to, I would prefer not to."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1564495636, "post_id": 57273249, "comment_id": 101045229, "body": "Try <a href=\"https://golang.org/pkg/runtime/debug#SetMaxStack\" rel=\"nofollow noreferrer\"><code>debug.SetMaxStack</code></a> (found via <a href=\"https://rosettacode.org/wiki/Find_limit_of_recursion#Go\" rel=\"nofollow noreferrer\">a RosettaCode post</a>)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1564499828, "post_id": 57273249, "comment_id": 101047885, "body": "1GB is a very large stack, regardless of the physical memory available. I&#39;d be very concerned about any code that can consume that much stack memory outside of an infinite recursion. Why do you say you would &quot;prefer not to&quot; allocate to the heap? Can you provide any more details about the implementation?"}], "owner": {"reputation": 9564, "user_id": 743188, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/gPyaY.jpg?s=128&g=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/743188/tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564494420, "creation_date": 1564494354, "last_edit_date": 1564494420, "question_id": 57273249, "link": "https://stackoverflow.com/questions/57273249/how-to-increase-stack-limit-from-1gb", "title": "How to increase stack limit from 1GB", "body": "<p>I purposely want to increase the stacksize beyond 1GB for a large problem. I do not have an infinite recursive loop. </p>\n\n<p>Currently, I get:</p>\n\n<pre><code>runtime: goroutine stack exceeds 1000000000-byte limit\nfatal error: stack overflow\n</code></pre>\n\n<p>How do I increase it to 2GB?</p>\n"}, {"tags": ["linux", "go", "seccomp"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564494347, "post_id": 57273008, "comment_id": 101044301, "body": "Why not use the <a href=\"https://godoc.org/github.com/seccomp/libseccomp-golang\" rel=\"nofollow noreferrer\"><code>github.com&#47;seccomp&#47;libseccomp-golang</code></a> Go package?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564495064, "post_id": 57273008, "comment_id": 101044792, "body": "The normal unix way to run an arbitrary command with some special setup without doing it in the command&#39;s code path is via a helper utility that does the setup before <code>exec</code>ing the actual command. Examples of such helper tools include <a href=\"https://linux.die.net/man/1/env\" rel=\"nofollow noreferrer\"><code>env</code></a>, <a href=\"https://linux.die.net/man/1/daemonize\" rel=\"nofollow noreferrer\"><code>daemonize</code></a>, <a href=\"https://linux.die.net/man/1/stdbuf\" rel=\"nofollow noreferrer\"><code>stdbuf</code></a>, etc; I don&#39;t know if such a helper exists for seccomp."}, {"owner": {"reputation": 33, "user_id": 11857495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc660a846509df7ec91efd824bf8cae?s=128&d=identicon&r=PG&f=1", "display_name": "boxjan", "link": "https://stackoverflow.com/users/11857495/boxjan"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564496713, "post_id": 57273008, "comment_id": 101045937, "body": "I have been check  about libsccomp-golang, the package will limit parent to limit child, but parent should not be limit, it will collect the resource usage or other things. So maybe not a good way."}], "owner": {"reputation": 33, "user_id": 11857495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc660a846509df7ec91efd824bf8cae?s=128&d=identicon&r=PG&f=1", "display_name": "boxjan", "link": "https://stackoverflow.com/users/11857495/boxjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1564494640, "creation_date": 1564493594, "last_edit_date": 1564494640, "question_id": 57273008, "link": "https://stackoverflow.com/questions/57273008/is-there-ways-to-load-seccomp-filter-after-exec-start-and-before-the-command-s", "title": "Is there ways to load seccomp filter after exec.Start() and before the command starts", "body": "<p>I'm writing a simple sandbox using Go code as a module, and I need load seccomp rules to limit the system call for the command.</p>\n\n<p>I use <code>os/exec</code> to run the command but I can't find anyway to load the filter before the command really starts. </p>\n\n<p>I found Docker uses a call to fork, it needs to add code in the program's <code>main</code>, but if the sandbox is a module, I don't think this is a good way.</p>\n\n<p>In C we can use seccomp like:</p>\n\n<pre><code>int main() {\n    int pid = fork();\n    if (pid &gt; 0) {\n        children();\n    } else if (pid == 0) {\n        struct rusage usage{};\n        int status;\n        if (wait4(pid, &amp;status, WSTOPPED, &amp;usage) == -1) {\n           kill(pid, SIGKILL);\n        }\n    }\n}\n\nvoid children() {\n    /* load seccomp filter */\n    scmp_filter_ctx ctx = seccomp_init(SCMP_ACT_KILL &amp; SCMP_ACT_LOG);\n    seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(read), 0);\n    seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(write), 0);\n    seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(exit), 0);\n    seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(sigreturn), 0);\n    seccomp_load(ctx);\n\n    execvp(\"bash\", {\"bash\"});\n}\n</code></pre>\n\n<p>In Go, I don't have any idea how to do it.</p>\n\n<p>English is not my first language.</p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 36561, "user_id": 2395796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8786484468219bcf403bbdce5eb37c8d?s=128&d=identicon&r=PG", "display_name": "Kevin Christopher Henry", "link": "https://stackoverflow.com/users/2395796/kevin-christopher-henry"}, "edited": false, "score": 0, "creation_date": 1564489104, "post_id": 57270894, "comment_id": 101040975, "body": "The <a href=\"https://redis.io/commands/mget\" rel=\"nofollow noreferrer\">documentation</a> explicitly says O(N)."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5033983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/879846482087930/picture?type=large", "display_name": "Manav Jain", "link": "https://stackoverflow.com/users/5033983/manav-jain"}, "edited": false, "score": 0, "creation_date": 1564490951, "post_id": 57271545, "comment_id": 101042143, "body": "so mget is faster in <a href=\"https://github.com/wuxibin89/redis-go-cluster\" rel=\"nofollow noreferrer\">github.com/wuxibin89/redis-go-cluster</a>  then in <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">github.com/go-redis/redis</a>"}, {"owner": {"reputation": 137, "user_id": 1592177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ae1273dbd6cc27d2d7805b74521e1762?s=128&d=identicon&r=PG", "display_name": "kabanek", "link": "https://stackoverflow.com/users/1592177/kabanek"}, "reply_to_user": {"reputation": 37, "user_id": 5033983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/879846482087930/picture?type=large", "display_name": "Manav Jain", "link": "https://stackoverflow.com/users/5033983/manav-jain"}, "edited": false, "score": 0, "creation_date": 1564493279, "post_id": 57271545, "comment_id": 101043606, "body": "I&#39;m not sure, you have to measure it :)"}], "tags": [], "owner": {"reputation": 137, "user_id": 1592177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ae1273dbd6cc27d2d7805b74521e1762?s=128&d=identicon&r=PG", "display_name": "kabanek", "link": "https://stackoverflow.com/users/1592177/kabanek"}, "is_accepted": false, "score": 0, "last_activity_date": 1564489252, "creation_date": 1564489252, "answer_id": 57271545, "question_id": 57270894, "link": "https://stackoverflow.com/questions/57270894/what-is-the-time-complexity-of-mget-in-redis/57271545#57271545", "title": "What is the time complexity of mget() in redis?", "body": "<p>Here is the implementation of the method in the library you sent: <a href=\"https://github.com/wuxibin89/redis-go-cluster/blob/222d81891f1d3fa7cf8b5655020352c3e5b4ec0f/multi.go#L99\" rel=\"nofollow noreferrer\">https://github.com/wuxibin89/redis-go-cluster/blob/222d81891f1d3fa7cf8b5655020352c3e5b4ec0f/multi.go#L99</a></p>\n\n<p>it looks like it executes every task concurrently to every node <a href=\"https://github.com/wuxibin89/redis-go-cluster/blob/222d81891f1d3fa7cf8b5655020352c3e5b4ec0f/multi.go#L144\" rel=\"nofollow noreferrer\">https://github.com/wuxibin89/redis-go-cluster/blob/222d81891f1d3fa7cf8b5655020352c3e5b4ec0f/multi.go#L144</a> and waits for the response</p>\n\n<p>I think that it should work differently - the library sends the request to master Redis cluster and the cluster should deal with replication etc. It's probably the case of the decreased performance.</p>\n\n<p>Please consider another library like <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">https://github.com/go-redis/redis</a>.</p>\n"}], "owner": {"reputation": 37, "user_id": 5033983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/879846482087930/picture?type=large", "display_name": "Manav Jain", "link": "https://stackoverflow.com/users/5033983/manav-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1564489252, "creation_date": 1564487120, "question_id": 57270894, "link": "https://stackoverflow.com/questions/57270894/what-is-the-time-complexity-of-mget-in-redis", "title": "What is the time complexity of mget() in redis?", "body": "<p>this library has mget implementation <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">https://github.com/go-redis/redis</a> .It seems like the time complexity is O(N),where n is the number of keys</p>\n\n<p><a href=\"https://github.com/wuxibin89/redis-go-cluster\" rel=\"nofollow noreferrer\">https://github.com/wuxibin89/redis-go-cluster</a> Here the time complexity is O(N /total nodes in cluster)</p>\n\n<p>How is the default mget() implemented in redis in terms of time complexity ?</p>\n"}, {"tags": ["go", "php-7", "php-openssl"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1564498458, "post_id": 57270775, "comment_id": 101047073, "body": "&quot;I think maybe php-openssl lacks streaming.&quot; Correct. So you have to build your input into a single string (<code>bin2Hex(openssl_decrypt(&quot;\\xf1\\xf1&quot;, &#39;rc4&#39;, $rc4key, OPENSSL_RAW_DATA))</code>), or find a different library. Obligatory PSA: Neither RC4 nor MD5 are cryptographically secure."}, {"owner": {"reputation": 1, "user_id": 11857049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa97e442413aadeba04197140ff78ba1?s=128&d=identicon&r=PG&f=1", "display_name": "DzJoJo", "link": "https://stackoverflow.com/users/11857049/dzjojo"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1564631940, "post_id": 57270775, "comment_id": 101096511, "body": "I really appreciate your help."}], "owner": {"reputation": 1, "user_id": 11857049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa97e442413aadeba04197140ff78ba1?s=128&d=identicon&r=PG&f=1", "display_name": "DzJoJo", "link": "https://stackoverflow.com/users/11857049/dzjojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564489182, "creation_date": 1564486667, "last_edit_date": 1564489182, "question_id": 57270775, "link": "https://stackoverflow.com/questions/57270775/php-and-go-rc4-decrypt", "title": "PHP and Go RC4-Decrypt", "body": "<p>I want PHP and Go to produce the same output.\nGo's encryption code should be RC4-MD5\nI tried to decrypt it with py-openssl, and the result was the same as Go.\nI think maybe php-openssl lacks streaming.</p>\n\n<p>this is my Go code. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    iv, _ := hex.DecodeString(\"8ec07bf03d8c5eaf37619aaac1cb305c\") // iv\n\n    key := evpBytesToKey(\"123456\", 16) // build Key\n fmt.Println(hex.EncodeToString(key))//e10adc3949ba59abbe56e057f20f883e\n    h := md5.New()\n    h.Write(key)\n    h.Write(iv)\n    rc4key := h.Sum(nil)\n    fmt.Println(hex.EncodeToString(rc4key)) //fd0eb4cfd6b0174968d9979781d95670\n    cipher, _ := rc4.NewCipher(rc4key) // rc4key\n\n    text, _ := hex.DecodeString(\"f1\")\n    dist := make([]byte, len(text))\n    cipher.XORKeyStream(dist, text);\n    fmt.Println(hex.EncodeToString(dist)) // 03\n\n    text, _ = hex.DecodeString(\"f1\")\n    dist = make([]byte, len(text))\n    cipher.XORKeyStream(dist, text);\n    fmt.Println(hex.EncodeToString(dist)) // 0e\n</code></pre>\n\n<p>Output </p>\n\n<pre><code>e10adc3949ba59abbe56e057f20f883e\nfd0eb4cfd6b0174968d9979781d95670\n03\n0e\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func evpBytesToKey(password string, keyLen int) (key []byte) {\n    const md5Len = 16\n\n    cnt := (keyLen-1)/md5Len + 1\n    m := make([]byte, cnt*md5Len)\n    copy(m, md5sum([]byte(password)))\n\n    // Repeatedly call md5 until bytes generated is enough.\n    // Each call to md5 uses data: prev md5 sum + password.\n    d := make([]byte, md5Len+len(password))\n    start := 0\n    for i := 1; i &lt; cnt; i++ {\n        start += md5Len\n        copy(d, m[start-md5Len:start])\n        copy(d[md5Len:], password)\n        copy(m[start:], md5sum(d))\n    }\n    return m[:keyLen]\n}\n\nfunc md5sum(d []byte) []byte {\n    h := md5.New()\n    h.Write(d)\n    return h.Sum(nil)\n}\n</code></pre>\n\n<p>this is my php code. </p>\n\n<pre class=\"lang-php prettyprint-override\"><code>\n//base64_decode('jsB78D2MXq83YZqqwcswXA==') == hex.DecodeString(\"8ec07bf03d8c5eaf37619aaac1cb305c\")\n$iv = base64_decode('jsB78D2MXq83YZqqwcswXA==');\n$key = evpBytesToKey(\"123456\", 16);\nvar_dump(binToHex($key));\n$rc4key = md5($key . $iv, true);\nvar_dump(binToHex($rc4key));\n//base64_decode('8Q==') == hex.DecodeString(\"f1\")\nvar_dump(binToHex(openssl_decrypt('8Q==', 'rc4', $rc4key, 0)));\nvar_dump(binToHex(openssl_decrypt('8Q==', 'rc4', $rc4key, 0)));\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>string(32) \"e10adc3949ba59abbe56e057f20f883e\"\nstring(32) \"fd0eb4cfd6b0174968d9979781d95670\"\nstring(2) \"03\"\nstring(2) \"03\"\n</code></pre>\n\n<pre class=\"lang-php prettyprint-override\"><code>function evpBytesToKey(string $password, int $keyLen)\n{\n    $md5Len = 16;\n    $cnt = (int)(($keyLen - 1) / $md5Len + 1);\n    $m = md5($password, true);\n    $start = 0;\n    for ($i = 1; $i &lt; $cnt; $i++) {\n        //Todo\n    }\n    return substr($m, 0, $keyLen);\n}\n\nfunction binToHex(string $src)\n{\n    //from go/src/encoding/hex/hex.go\n    $dst = '';\n    $hextable = '0123456789abcdef';\n    $len = strlen($src);\n    for ($i = 0; $i &lt; $len; $i++) {\n        $v = ord($src[$i]);\n        $dst[$i * 2] = $hextable[$v &gt;&gt; 4];\n        $dst[$i * 2 + 1] = $hextable[$v &amp; 0x0f];\n    }\n    return $dst;\n}\n</code></pre>\n\n<p>I expect php output to be the same as Go's.</p>\n"}, {"tags": ["go", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 3690, "user_id": 2963109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/693072790/picture?type=large", "display_name": "wizulus", "link": "https://stackoverflow.com/users/2963109/wizulus"}, "edited": false, "score": 0, "creation_date": 1598465497, "post_id": 57270840, "comment_id": 112471106, "body": "How do you convert <code>*gin.Context</code> to <code>*context.Context</code>?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 3690, "user_id": 2963109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/693072790/picture?type=large", "display_name": "wizulus", "link": "https://stackoverflow.com/users/2963109/wizulus"}, "edited": false, "score": 0, "creation_date": 1598468979, "post_id": 57270840, "comment_id": 112472597, "body": "@wizulus: You don&#39;t. <code>*context.Context</code> doesn&#39;t make sense. <code>*gin.Context</code> already is a <code>context.Context</code>, so don&#39;t do any conversion."}, {"owner": {"reputation": 3690, "user_id": 2963109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/693072790/picture?type=large", "display_name": "wizulus", "link": "https://stackoverflow.com/users/2963109/wizulus"}, "edited": false, "score": 0, "creation_date": 1598547090, "post_id": 57270840, "comment_id": 112501629, "body": "If we weren&#39;t talking about pointers, I would agree. But my compiler seems to complain about this. A <code>pointer to gin.Context</code> is not a <code>pointer to context.Context</code>, even though <code>gin.Context</code> implements the <code>context.Context</code> interface. In my code, I had to de-reference the first pointer into a new variable, then use a pointer to that variable. I wonder if there&#39;s a way to do that without an intermediate variable, and preserve the memory location."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 3690, "user_id": 2963109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/693072790/picture?type=large", "display_name": "wizulus", "link": "https://stackoverflow.com/users/2963109/wizulus"}, "edited": false, "score": 1, "creation_date": 1598547216, "post_id": 57270840, "comment_id": 112501702, "body": "Yes, don&#39;t use a pointer to <code>context.Context</code>. pointers to interfaces practically never make any sense. If you&#39;re using <code>*context.Context</code> in your code, that is the bug."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 14, "last_activity_date": 1564486914, "creation_date": 1564486914, "answer_id": 57270840, "question_id": 57270597, "link": "https://stackoverflow.com/questions/57270597/transform-gin-context-to-context-context/57270840#57270840", "title": "Transform gin.Context to context.Context", "body": "<p>The standard library's <a href=\"https://golang.org/pkg/context/#Context\" rel=\"noreferrer\"><code>context.Context</code></a> type is an interface, with the following methods:</p>\n\n<ul>\n<li><code>Deadline() (deadline time.Time, ok bool)</code></li>\n<li><code>Done() &lt;-chan struct{}</code></li>\n<li><code>Err() error</code></li>\n<li><code>Value(key interface{}) interface{}</code></li>\n</ul>\n\n<p>So any type that has these methods <em>is</em> a <code>context.Context</code>.</p>\n\n<p>Looking at the <a href=\"https://godoc.org/github.com/gin-gonic/gin\" rel=\"noreferrer\">gin documentation</a>, we see that the <code>gin.Context</code> type has all of these methods:</p>\n\n<ul>\n<li><a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.Deadline\" rel=\"noreferrer\"><code>Deadline</code></a></li>\n<li><a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.Done\" rel=\"noreferrer\"><code>Done</code></a></li>\n<li><a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.Err\" rel=\"noreferrer\"><code>Err</code></a></li>\n<li><a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.Value\" rel=\"noreferrer\"><code>Value</code></a></li>\n</ul>\n\n<p>So it's already a <code>context.Context</code>. No conversion or transformation necessary.</p>\n"}], "owner": {"reputation": 964, "user_id": 2575021, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f1ec1e86e45198215f91498d3d2c4134?s=128&d=identicon&r=PG", "display_name": "Vishal R", "link": "https://stackoverflow.com/users/2575021/vishal-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2171, "favorite_count": 0, "accepted_answer_id": 57270840, "answer_count": 1, "score": 2, "last_activity_date": 1564488276, "creation_date": 1564486058, "last_edit_date": 1564488276, "question_id": 57270597, "link": "https://stackoverflow.com/questions/57270597/transform-gin-context-to-context-context", "title": "Transform gin.Context to context.Context", "body": "<p>Is there a way to transform\n<a href=\"https://godoc.org/github.com/gin-gonic/gin#Context\" rel=\"nofollow noreferrer\"><code>gin.Context</code></a>\nto <a href=\"https://golang.org/pkg/context/#Context\" rel=\"nofollow noreferrer\"><code>context.Context</code></a>\nin Go?\nWhat should be used in building a Go microservice?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1564485299, "post_id": 57270344, "comment_id": 101038775, "body": "This isn&#39;t a code-writing service. What have you tried? Include your code. What problems did you encounter that you need help with?"}], "answers": [{"tags": [], "owner": {"reputation": 6258, "user_id": 11032044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bz8vL.jpg?s=128&g=1", "display_name": "Kamol Hasan", "link": "https://stackoverflow.com/users/11032044/kamol-hasan"}, "is_accepted": true, "score": 0, "last_activity_date": 1564486321, "creation_date": 1564486321, "answer_id": 57270667, "question_id": 57270344, "link": "https://stackoverflow.com/questions/57270344/how-to-check-words-with-the-same-characters-where-the-words-in-one-variable/57270667#57270667", "title": "How to check words with the same characters where the words in one variable", "body": "<p>One solution can be the use of go <code>map[]</code> to track the taken characters. </p>\n\n<p>sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    s := \"abcdaabcefgahccij\"\n    newS := \"\"\n    taken := make(map[rune]int)\n    for _, value := range s {\n        if _, ok := taken[value]; !ok {\n            taken[value] = 1\n            newS += string(value)\n        }\n    }\n    fmt.Println(newS)\n}\n\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>abcdefghij\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11857151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c74fe07cabc3beaa590902cf6ade0c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hello446", "link": "https://stackoverflow.com/users/11857151/hello446"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "closed_date": 1564494344, "accepted_answer_id": 57270667, "answer_count": 1, "score": -5, "last_activity_date": 1564486321, "creation_date": 1564485222, "last_edit_date": 1564485692, "question_id": 57270344, "link": "https://stackoverflow.com/questions/57270344/how-to-check-words-with-the-same-characters-where-the-words-in-one-variable", "closed_reason": "Needs more focus", "title": "How to check words with the same characters where the words in one variable", "body": "<p>I'm thinking up about how I find the same characters in one variable looks like this:</p>\n\n<pre><code>var words string = \"abab\"\n</code></pre>\n\n<p>and then I want's to eliminate the same characters in that one variable and here's the output to be</p>\n\n<p>Output:</p>\n\n<pre><code>ab\n</code></pre>\n\n<p>have any solution about this?</p>\n"}, {"tags": ["performance", "go", "newrelic", "newrelic-platform"], "comments": [{"owner": {"reputation": 129, "user_id": 448266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce973d04c8a663398081f5f440344518?s=128&d=identicon&r=PG", "display_name": "Bondhan Novandy", "link": "https://stackoverflow.com/users/448266/bondhan-novandy"}, "edited": false, "score": 0, "creation_date": 1607851605, "post_id": 57269104, "comment_id": 115397838, "body": "We found out that at that time the new relic SDK was still underdevelopment, it was fixed after we followed up with new relic engineering team directly and did update on the sdk once it was updated."}], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 7352523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4367b1ac2085d7f5e4846447c6330734?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Kan", "link": "https://stackoverflow.com/users/7352523/joshua-kan"}, "is_accepted": false, "score": 2, "last_activity_date": 1586775767, "creation_date": 1586775767, "answer_id": 61186465, "question_id": 57269104, "link": "https://stackoverflow.com/questions/57269104/client-timeout-exceeded-while-awaiting-headers/61186465#61186465", "title": "Client timeout exceeded while awaiting headers", "body": "<p>I think it is due to DNS network timeout.</p>\n\n<p>You can easily test this out by using the following steps (in Ubuntu) </p>\n\n<ol>\n<li>Select the IPv4 Settings tab.</li>\n<li><p>Disable the \u201cAutomatic\u201d toggle switch and enter the DNS resolvers' IP addresses, separated by a comma. We\u2019ll use the Google DNS nameservers: </p>\n\n<p>8.8.8.8,8.8.4.4</p></li>\n</ol>\n\n<p>If it works, then you may be able to reset the DNS to \"Automatic\"</p>\n"}, {"tags": [], "owner": {"reputation": 1444, "user_id": 1994646, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a39a16d537f49e340f938c0a34f099d?s=128&d=identicon&r=PG&f=1", "display_name": "Sasi Kumar M", "link": "https://stackoverflow.com/users/1994646/sasi-kumar-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1602577530, "creation_date": 1602577530, "answer_id": 64331414, "question_id": 57269104, "link": "https://stackoverflow.com/questions/57269104/client-timeout-exceeded-while-awaiting-headers/64331414#64331414", "title": "Client timeout exceeded while awaiting headers", "body": "<p>On Windows OS, Running Linux Containers with WSL2, i followed the following steps,</p>\n<ol>\n<li>Ran the command docker logout</li>\n<li>Ran the command, docker network prune, so as to remove all the preconfigured settings of the network.</li>\n<li>From Docker Settings, Enabled the DNS server configuration with 8.8.8.8</li>\n<li>Restarted the Docker</li>\n<li>Now executed login command with registry to login, docker login {registry}</li>\n</ol>\n"}], "owner": {"reputation": 129, "user_id": 448266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce973d04c8a663398081f5f440344518?s=128&d=identicon&r=PG", "display_name": "Bondhan Novandy", "link": "https://stackoverflow.com/users/448266/bondhan-novandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12758, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1602577530, "creation_date": 1564480935, "last_edit_date": 1564481593, "question_id": 57269104, "link": "https://stackoverflow.com/questions/57269104/client-timeout-exceeded-while-awaiting-headers", "title": "Client timeout exceeded while awaiting headers", "body": "<p>I got below error, I am using go v1.10.4 linux/amd64.</p>\n\n<p>I am not behind any firewall or whatsoever. New Relic in java server (same network segment) that we have runs fine.</p>\n\n<p>We have tried:</p>\n\n<ul>\n<li>Increasing the timeout to 60 seconds</li>\n<li>Use http2 in the server</li>\n<li>Using Postman return 503 with response: \n\n<blockquote>\n  <p>{\"exception\":{\"message\":\"Server Error\",\"error_type\":\"RuntimeError\"}}</p>\n</blockquote></li>\n<li>troubleshooting with ./nrdiag says \u201cNo Issues Found\u201d</li>\n</ul>\n\n<p>Below is our code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    config := newrelic.NewConfig(os.Getenv(\"NEW_RELIC_APP_NAME\"), os.Getenv(\"NEW_RELIC_KEY\"))\n\n    config.Logger = newrelic.NewDebugLogger(os.Stdout)\n\n    app, err := newrelic.NewApplication(config)\n    if err != nil {\n        fmt.Println(\"Failed to create newrelic application\", err)\n        os.Exit(1)\n    }\n\n.................\n\n        httpListener, err := net.Listen(\"tcp\", *httpAddr)\n        if err != nil {\n            oldlog.Print(\"Error: \", err)\n            logger.Log(\"transport\", \"HTTP\", \"during\", \"Listen\", \"err\", err)\n            os.Exit(1)\n        }\n        g.Add(func() error {\n            logger.Log(\"transport\", \"HTTP\", \"addr\", *httpAddr)\n            return http.Serve(httpListener, nrgorilla.InstrumentRoutes(httpHandler, app))\n        }, func(error) {\n            httpListener.Close()\n        })\n    }\n</code></pre>\n\n<p>However this what we got,note some_key was removed:</p>\n\n<blockquote>\n  <p>(28422) 2019/07/29 18:08:50.058559 {\"level\":\"warn\",\"msg\":\"application connect failure\",\"context\":{\"error\":\"Post <a href=\"https://collector-001.eu01.nr-data.net/agent_listener/invoke_raw_method?license_key=some_key\" rel=\"noreferrer\">https://collector-001.eu01.nr-data.net/agent_listener/invoke_raw_method?license_key=some_key</a>\\u0026marshal_format=json\\u0026method=connect\\u0026protocol_version=17: net/http: request canceled (Client.Timeout exceeded while awaiting headers)\"}}</p>\n</blockquote>\n"}, {"tags": ["json", "parsing", "go", "linkedin", "linkedin-api"], "comments": [{"owner": {"reputation": 1635, "user_id": 5480147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a4c467c7c34e0e9162535a801ae21a?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5480147/tom"}, "edited": false, "score": 3, "creation_date": 1564481251, "post_id": 57268953, "comment_id": 101036587, "body": "Made something similar in another question. Maybe it can help here too: <a href=\"https://stackoverflow.com/questions/57014004/how-to-map-a-string-that-contains-key-values-separated-by-to-json/57071922#57071922\" title=\"how to map a string that contains key values separated by to json\">stackoverflow.com/questions/57014004/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/57014004/how-to-map-a-string-that-contains-key-values-separated-by-to-json/57038554#57038554\" title=\"how to map a string that contains key values separated by to json\">stackoverflow.com/questions/57014004/&hellip;</a>"}, {"owner": {"reputation": 32481, "user_id": 2270041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cn7rq.jpg?s=128&g=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/2270041/matteo"}, "reply_to_user": {"reputation": 1635, "user_id": 5480147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a4c467c7c34e0e9162535a801ae21a?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5480147/tom"}, "edited": false, "score": 0, "creation_date": 1564481629, "post_id": 57268953, "comment_id": 101036816, "body": "thanks @Tom for sharing"}], "owner": {"reputation": 32481, "user_id": 2270041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cn7rq.jpg?s=128&g=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/2270041/matteo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1564568731, "creation_date": 1564480490, "last_edit_date": 1564568731, "question_id": 57268953, "link": "https://stackoverflow.com/questions/57268953/parsing-string-containing-complex-struct", "title": "Parsing string containing complex struct", "body": "<p>I'm receiving a third-party API payload response like:</p>\n\n<pre><code>{\n    \"message\": \"Validation failed because [{reason=CONDITIONAL_INVALID_VALUE, field=/targetingCriteria, batchIndex=0, type=INVALID_VALUE, message=/locale cannot be set to en if urn:li:adTargetingFacet:interfaceLocales is set to urn:li:locale:it_IT, parameters={field1=/locale, value2=urn:li:locale:it_IT, value1=en, field2=urn:li:adTargetingFacet:interfaceLocales, key=}}, {reason=FIELD_VALUE_TOO_LOW, field=dailyBudget, batchIndex=0, type=INVALID_VALUE, message=/dailyBudget/amount value 1 cannot be lower than 10.00, parameters={min=10.00, field=/dailyBudget/amount, costType=CPM, type=SPONSORED_UPDATES, value=1, key=}}]\",\n    \"status\": 400\n}\n</code></pre>\n\n<p>and I'd like to transform in something like:</p>\n\n<pre><code>{\n    \"errors\": [{\n            \"reason\": \"CONDITIONAL_INVALID_VALUE\",\n            \"field\": \"/targetingCriteria\",\n            \"batchIndex\": \"0\",\n            \"type\": \"INVALID_VALUE\",\n            \"message\": \"/locale cannot be set to en if urn:li:adTargetingFacet:interfaceLocales is set to urn:li:locale:it_IT\",\n            \"parameters\": \"{field1=/locale, value2=urn:li:locale:it_IT, value1=en, field2=urn:li:adTargetingFacet:interfaceLocales, key=}\"\n        },\n        {\n            \"reason\": \"FIELD_VALUE_TOO_LOW\",\n            \"field\": \"dailyBudget\",\n            \"batchIndex\": \"0\",\n            \"type\": \"INVALID_VALUE\",\n            \"message\": \"/dailyBudget/amount value 1 cannot be lower than 10.00\",\n            \"parameters\": \"{min=10.00, field=/dailyBudget/amount, costType=CPM, type=SPONSORED_UPDATES, value=1, key=}\"\n        }\n    ]\n}\n</code></pre>\n\n<p>But I'm struggling to find a clear golang approach to this problem, the main problems are:</p>\n\n<ol>\n<li>no valid json is available: word are not correctly quoted with \"</li>\n<li><code>=</code> symbol instead of <code>:</code></li>\n<li>nested graphs bracket</li>\n</ol>\n\n<p>I'm currently try to transform in a valid json string and then parse as json but I have various problem with nested elements</p>\n\n<p>Any idea?</p>\n\n<p><strong>EDIT:</strong> This is what I've done right now: <a href=\"https://play.golang.org/p/B7bdPCJoHc2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/B7bdPCJoHc2</a></p>\n"}, {"tags": ["amazon-web-services", "go", "proxy", "activemq", "squid"], "comments": [{"owner": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1565523032, "post_id": 57268172, "comment_id": 101374408, "body": "AMQ usually connects via TCP or similar (OpenWire etc) so squid wouldn&#39;t care about those. Have you checked your AWS security/firewall settings as they usually block most things unless enabled specifically."}, {"owner": {"reputation": 7127, "user_id": 247002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f494e0363428b11d080c35ec3d199ff?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/247002/mark"}, "reply_to_user": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1587648399, "post_id": 57268172, "comment_id": 108598041, "body": "Thank you for your comment. I finally came up with a socks5 proxy. This works fine."}], "owner": {"reputation": 7127, "user_id": 247002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f494e0363428b11d080c35ec3d199ff?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/247002/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564477983, "creation_date": 1564477983, "question_id": 57268172, "link": "https://stackoverflow.com/questions/57268172/using-mqtt-aws-mq-via-squid-proxy", "title": "Using MQTT (AWS MQ) via Squid Proxy", "body": "<p>I got several devices coming from an IPSec Tunnel into a public subnet. \nNow I set up a squid proxy to allow the devices to access http/https resources. </p>\n\n<p>Another part of the devices is a <a href=\"https://github.com/eclipse/paho.mqtt.golang\" rel=\"nofollow noreferrer\">MQTT Client</a> that should connect to the MQ Server at AWS. </p>\n\n<p>The MQ Server is in the same subnet and is generally publicly available. \nFrom an EC2 instance inside the subnet and from the public internet, I am able to ping the MQ server.</p>\n\n<p>It seems that the address resolution is working. Nevertheless, the connection is refused.</p>\n\n<p><code>Network Error: dial tcp xx.xx.xx.xx:8883: i/o timeout</code></p>\n\n<p>I tried it with and without setting the proxy in the programm:</p>\n\n<pre><code>os.Setenv(\"http_proxy\", \"http://10.0.1.XXX:3129\"),\nos.Setenv(\"https_proxy\", \"http://10.0.1.XXX:3129\"),\n</code></pre>\n\n<p>The permissions are set to allow traffic from all sources to port 8883. </p>\n\n<p>The first question is if MQTT is able to communicate over a squid proxy. </p>\n\n<p>Next question would be if I misconfigured something in the proxy.</p>\n\n<pre><code>\n# Ports\nacl SSL_ports port 443\nacl SSL-ports port 8883\n\nacl Safe_ports port 80      # http\nacl Safe_ports port 443     # https\nacl Safe_ports port 8883\n\nacl CONNECT method CONNECT\nacl SSL method CONNECT\n\nacl all src all\nhttp_access allow all\n\nhttp_port 10.0.1.XXX:3129\n</code></pre>\n\n<p>If MQTT isn't abe to communicate via SSL is there a supported protocoll that may be used? OpenWire, AMQP, STOMP, WSS</p>\n\n<p>Are there alternative ways for the device to get their way to the public internet? </p>\n"}, {"tags": ["go", "gnupg", "pgp", "openpgp"], "comments": [{"owner": {"reputation": 6258, "user_id": 11032044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bz8vL.jpg?s=128&g=1", "display_name": "Kamol Hasan", "link": "https://stackoverflow.com/users/11032044/kamol-hasan"}, "edited": false, "score": 0, "creation_date": 1564481216, "post_id": 57267780, "comment_id": 101036568, "body": "You can take a look on <a href=\"https://gist.github.com/ayubmalik/a83ee23c7c700cdce2f8c5bf5f2e9f20\" rel=\"nofollow noreferrer\">this sample code</a> ."}, {"owner": {"reputation": 69, "user_id": 11543210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cffb47d958bc7493214bc5460f597?s=128&d=identicon&r=PG&f=1", "display_name": "jsdtLin", "link": "https://stackoverflow.com/users/11543210/jsdtlin"}, "reply_to_user": {"reputation": 6258, "user_id": 11032044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bz8vL.jpg?s=128&g=1", "display_name": "Kamol Hasan", "link": "https://stackoverflow.com/users/11032044/kamol-hasan"}, "edited": false, "score": 0, "creation_date": 1564539656, "post_id": 57267780, "comment_id": 101060473, "body": "Thank you very much, Kamol Hasan. This example solved my problem perfectly!"}], "owner": {"reputation": 69, "user_id": 11543210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cffb47d958bc7493214bc5460f597?s=128&d=identicon&r=PG&f=1", "display_name": "jsdtLin", "link": "https://stackoverflow.com/users/11543210/jsdtlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564476658, "creation_date": 1564476658, "question_id": 57267780, "link": "https://stackoverflow.com/questions/57267780/how-to-encrypt-a-file-using-gpg-key-from-files-in-go", "title": "How to encrypt a file using gpg key from files in Go?", "body": "<p>I'm doing some works about secure communication. I generated a gpg key in the bash. It is easy to encrypt a file in the bash, however, I want to do that in Go. </p>\n\n<p>The go package openpgp seems not having relative functions, so how can I do that?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "dependency-management", "go-modules"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1564470661, "post_id": 57266010, "comment_id": 101030877, "body": "Use the &quot;replace&quot; directive."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1564473969, "last_edit_date": 1564473969, "creation_date": 1564470825, "answer_id": 57266178, "question_id": 57266010, "link": "https://stackoverflow.com/questions/57266010/how-to-override-a-dependency-in-go-modules/57266178#57266178", "title": "How to override a dependency in go modules?", "body": "<p>This is what the <code>replace</code> directive is for.</p>\n\n<p>Quoting from wiki <a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"noreferrer\">Go 1.11 Modules: When should I use the replace directive?</a></p>\n\n<blockquote>\n  <p>The <code>replace</code> directive allows you to supply another import path that might be another module located in VCS (GitHub or elsewhere), or on your local filesystem with a relative or absolute file path. The new import path from the <code>replace</code> directive is used without needing to update the import paths in the actual source code.</p>\n</blockquote>\n\n<p>So add this to the <code>go.mod</code> file of your main module:</p>\n\n<pre><code>replace (\n    github.com/golang/glog =&gt; github.com/kubermatic/glog-logrus v0.0.0\n)\n</code></pre>\n\n<p>You can also instruct the <code>go</code> tool to make this edit for you:</p>\n\n<pre><code>go mod edit -replace github.com/golang/glog=github.com/kubermatic/glog-logrus@v0.0.0\n</code></pre>\n\n<p>(Use the version you're interested in.)</p>\n\n<p>After this when you import <code>github.com/golang/glog</code>, <code>github.com/kubermatic/glog-logrus</code> will be used (without having to change import statements).</p>\n"}], "owner": {"reputation": 645, "user_id": 3891733, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7f6392b706d2eeff54c4b6656f9d4225?s=128&d=identicon&r=PG&f=1", "display_name": "Nimrodshn", "link": "https://stackoverflow.com/users/3891733/nimrodshn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5312, "favorite_count": 3, "accepted_answer_id": 57266178, "answer_count": 1, "score": 2, "last_activity_date": 1564473969, "creation_date": 1564470069, "question_id": 57266010, "link": "https://stackoverflow.com/questions/57266010/how-to-override-a-dependency-in-go-modules", "title": "How to override a dependency in go modules?", "body": "<p>In <code>dep</code> you have the option to override a dependency and have it point to a different repo for example in the following <a href=\"https://github.com/kubermatic/glog-logrus\" rel=\"nofollow noreferrer\">https://github.com/kubermatic/glog-logrus</a> library one needs to add the following lines to the Gopkg.toml file:</p>\n\n<pre><code>[[override]]\n  name = \"github.com/golang/glog\"\n  source = \"github.com/kubermatic/glog-logrus\"\n</code></pre>\n\n<p>Then in the codebase you <code>import \"github.com/golang/glog</code>. However, in go modules I don't see such an option? which leads me to think the only solution is to change the import to <code>github.com/kubermatic/glog-logrus</code>.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "containers", "buildah"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1564470397, "post_id": 57265196, "comment_id": 101030745, "body": "A compiled binary Go app is self-contained, so it has no dependency. If you use syscalls to load external libraries, or you open and read external files, then it will obviously need those, but other than that, nothing will be required."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564471213, "post_id": 57265196, "comment_id": 101031162, "body": "You might need these external files used by the Go standard packages:  root certificates, time zone info."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1564490464, "post_id": 57265196, "comment_id": 101041842, "body": "The <code>ldd</code> command should tell you what shared libraries a dynamically linked executable needs. As already mentioned there may also be files referenced/needed (e.g. in /etc)."}], "answers": [{"comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 1, "creation_date": 1564473722, "post_id": 57266757, "comment_id": 101032395, "body": "This is an image to build the app, right? To just run it, it would not need anything except the resulting binary, I think."}, {"owner": {"reputation": 630, "user_id": 5485232, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/cz2UJ.jpg?s=128&g=1", "display_name": "Bryon", "link": "https://stackoverflow.com/users/5485232/bryon"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1564476050, "post_id": 57266757, "comment_id": 101033672, "body": "@Thilo that is correct. The binary is built externally. A simple microservice listening and sending on a TCP port. I just want to containerise it. Buildah has awesome features to build minimal images - but to do that you need to understand what types of dependencies you need to include. (Hence the question)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1564500842, "post_id": 57266757, "comment_id": 101048443, "body": "This is a great answer, just not to the question that was asked."}], "tags": [], "owner": {"reputation": 1, "user_id": 6505259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZEkl__yUmNY/AAAAAAAAAAI/AAAAAAAAAHo/pSJKwWiPTvI/photo.jpg?sz=128", "display_name": "Yashish Dua", "link": "https://stackoverflow.com/users/6505259/yashish-dua"}, "is_accepted": false, "score": -2, "last_activity_date": 1564490553, "last_edit_date": 1564490553, "creation_date": 1564473026, "answer_id": 57266757, "question_id": 57265196, "link": "https://stackoverflow.com/questions/57265196/building-a-minimal-container-for-a-go-program/57266757#57266757", "title": "Building a minimal container for a Go program", "body": "<p>I am assuming you have included the app dependencies in your docker image.</p>\n\n<p>You won't require any external dependency to build a docker image. Just base image from Go is sufficient to build and run on Linux machines.</p>\n\n<pre><code># Start from the latest Go base image\nFROM golang:latest\n\n# Set the Current Working Directory inside the container\nWORKDIR /app\n\n# Copy go mod and sum files\nCOPY go.mod go.sum ./\n\n# Download all dependencies. Dependencies will be cached if the go.mod and go.sum files are not changed\nRUN go mod download\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 630, "user_id": 5485232, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/cz2UJ.jpg?s=128&g=1", "display_name": "Bryon", "link": "https://stackoverflow.com/users/5485232/bryon"}, "is_accepted": true, "score": 2, "last_activity_date": 1564638622, "last_edit_date": 1564638622, "creation_date": 1564638201, "answer_id": 57302474, "question_id": 57265196, "link": "https://stackoverflow.com/questions/57265196/building-a-minimal-container-for-a-go-program/57302474#57302474", "title": "Building a minimal container for a Go program", "body": "<p>@Dave C gave the information to correctly answer this. Using ldd with the test app returned:</p>\n\n<pre><code>[bryon@localhost resttest]$ ldd restest\n    linux-vdso.so.1 (0x00007fff139fe000)\n    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007fbad6ce2000)\n    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fbad691f000)\n    /lib64/ld-linux-x86-64.so.2 (0x00007fbad6f02000)\n[bryon@localhost resttest]$ \n</code></pre>\n\n<p>So for those looking to build a minimal container with Buildah, the BASH script to generate it would look like this:</p>\n\n<pre><code>#!/bin/bash\n#\n# Run this shell script after you have run the command: \"buildah unshare\"\n#\ngit clone https://github.com/bryonbaker/resttest.git\ncd resttest\ngo build restest.go\n\ncontainer=$(buildah from scratch)\nmnt=$(buildah mount $container)\nmkdir $mnt/bin\nmkdir $mnt/lib64\nbuildah config --workingdir /bin $container\nbuildah copy $container restest /bin/restest\nbuildah copy $container /lib64/libpthread.so.0 /lib64\nbuildah copy $container /lib64/libc.so.6 /lib64\nbuildah copy $container /lib64/ld-linux-x86-64.so.2 /lib64\nbuildah config --port 8000 $container\n#\n# This step is not working properly.\n# Need to run with podman -p 8000:8000 --entrypoint /bin/restest restest:latest\nbuildah config --entrypoint /bin/restest $container\nbuildah commit --format docker $container restest:latest\n</code></pre>\n\n<p><strong>This generates a 14MB container for a simple microservice!</strong> There are no additional files to be worrying about for vulnerabilities etc. </p>\n\n<p>I have a small defect I can't work out on entrypoints so I am overriding the entrypoint on start, but to test it run:</p>\n\n<pre><code>podman -p8000:8000 --entrypoint /bin/restest restest:latest\n</code></pre>\n\n<p>Then just type the following in a Terminal session:</p>\n\n<pre><code>curl http://localhost:8000\n</code></pre>\n\n<p>So thanks Dave C!</p>\n"}], "owner": {"reputation": 630, "user_id": 5485232, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/cz2UJ.jpg?s=128&g=1", "display_name": "Bryon", "link": "https://stackoverflow.com/users/5485232/bryon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 2, "accepted_answer_id": 57302474, "answer_count": 2, "score": -3, "last_activity_date": 1564638622, "creation_date": 1564466461, "last_edit_date": 1564490355, "question_id": 57265196, "link": "https://stackoverflow.com/questions/57265196/building-a-minimal-container-for-a-go-program", "title": "Building a minimal container for a Go program", "body": "<p>I want to build a tiny container image from scratch using Buildah to run a Go app.\nApart from the app itself, what other libraries etc need to be included. I am thinking that glibc is needed - is there anything else?</p>\n\n<p>So in summary, I think I am asking \"what are all the external dependencies that a compiled Go app needs on Linux?\"</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 16400, "user_id": 112877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1de60d98bb69f4a0e2bbad6cd4726e9f?s=128&d=identicon&r=PG", "display_name": "Eugene Ryzhikov", "link": "https://stackoverflow.com/users/112877/eugene-ryzhikov"}, "edited": false, "score": 0, "creation_date": 1564457902, "post_id": 57263889, "comment_id": 101026796, "body": "You have to use <code>f.Sync()</code> to flush writes to stable storage. Otherwise file is not fully saved."}, {"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "reply_to_user": {"reputation": 16400, "user_id": 112877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1de60d98bb69f4a0e2bbad6cd4726e9f?s=128&d=identicon&r=PG", "display_name": "Eugene Ryzhikov", "link": "https://stackoverflow.com/users/112877/eugene-ryzhikov"}, "edited": false, "score": 0, "creation_date": 1564458474, "post_id": 57263889, "comment_id": 101026896, "body": "Updated code, adding in the f.Sync(), gives me an EOF error at  <code>filetype, err := client.GetFileContentType(f) \tif err != nil { \t\treturn err \t}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1564465757, "last_edit_date": 1564465757, "creation_date": 1564462851, "answer_id": 57264578, "question_id": 57263889, "link": "https://stackoverflow.com/questions/57263889/trouble-getting-content-type-of-file-in-go/57264578#57264578", "title": "Trouble getting content type of file in Go", "body": "<p>The problem is that <code>GetFileContentType</code> reads from the end of the file.  Fix this be seeking back to the beginning of the file before calling calling <code>GetFileContentType</code>:</p>\n\n<pre><code> if _, err := f.Seek(io.SeekStart, 0); err != nil {\n     return err\n }\n</code></pre>\n\n<p>A better fix is to use the file data that's already in memory. This simplifies the code to the point where there's no need for the <code>GetFileContentType</code> function.</p>\n\n<pre><code>func ConvertToJPEGBase64(\n    src string,\n    dst string,\n) error {\n\n    b, err := ioutil.ReadFile(src)\n    if err != nil {\n        return err\n    }\n    str := string(b)\n\n    byteArray, err := base64.StdEncoding.DecodeString(str)\n    if err != nil {\n        return err\n    }\n\n    f, err := os.Create(dst)\n    if err != nil {\n        return err\n    }\n    defer f.Close() // &lt;-- Close the file on return.\n\n    if _, err := f.Write(byteArray); err != nil {\n        return err\n    }\n\n    fileType := http.DetectContentType(byteArray) // &lt;-- use data in memory\n    if strings.Contains(fileType, \"jpeg\") {\n             // do something\n    } else {\n            // do something else\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>More code can be eliminated by using <code>ioutil.WriteFile</code>:</p>\n\n<pre><code>func ConvertToJPEGBase64(src, dst string) error {\n    b, err := ioutil.ReadFile(src)\n    if err != nil {\n        return err\n    }\n\n    byteArray, err := base64.StdEncoding.DecodeString(string(b))\n    if err != nil {\n        return err\n    }\n\n    if err := ioutil.WriteFile(dst, byteArray, 0666); err != nil {\n        return err\n    }\n\n    fileType := http.DetectContentType(byteArray)\n    if strings.Contains(fileType, \"jpeg\") {\n        // do something\n    } else {\n        // do something else\n    }\n\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 57264578, "answer_count": 1, "score": 0, "last_activity_date": 1564465757, "creation_date": 1564456953, "last_edit_date": 1564458456, "question_id": 57263889, "link": "https://stackoverflow.com/questions/57263889/trouble-getting-content-type-of-file-in-go", "title": "Trouble getting content type of file in Go", "body": "<p>I have a function in which I take in a base64 string and get the content of it (PDF or JPEG).\nI read in the base64 content, convert it to bytes and decode it into the file that it is.\nI then create a file where I will output the decoded file (JPEG or PDF).\nThen I write the bytes to it.\nThen I call my GetFileContentType on it and it returns to me an empty string.\nIf I run the functions separately, as in I first the first function to create the decoded file, and end it.  And then call the second function to get the content type, it works and returns it as JPEG or PDF.\nWhat am I doing wrong here?\nAnd is there a better way to do this?</p>\n\n<pre><code>func ConvertToJPEGBase64(\n    src string,\n    dst string,\n) error {\n\n    b, err := ioutil.ReadFile(src)\n    if err != nil {\n        return err\n    }\n    str := string(b)\n\n    byteArray, err := base64.StdEncoding.DecodeString(str)\n    if err != nil {\n        return err\n    }\n\n    f, err := os.Create(dst)\n    if err != nil {\n        return err\n    }\n\n    if _, err := f.Write(byteArray); err != nil {\n        return err\n    }\n\n    f.Sync()\n    filetype, err := client.GetFileContentType(f)\n    if err != nil {\n        return err\n    }\n    if strings.Contains(filetype, \"jpeg\") {\n             // do something\n    } else {\n            // do something else\n    }\n\n    return nil\n}\n\n// GetFileContentType tells us the type of file\nfunc GetFileContentType(out *os.File) (string, error) {\n\n    // Only the first 512 bytes are used to sniff the content type.\n    buffer := make([]byte, 512)\n    _, err := out.Read(buffer)\n    if err != nil {\n        return \"\", err\n    }\n    contentType := http.DetectContentType(buffer)\n\n    return contentType, nil\n}\n</code></pre>\n"}, {"tags": ["go", "import", "package"], "comments": [{"owner": {"reputation": 3985, "user_id": 1134902, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pSWiM.jpg?s=128&g=1", "display_name": "Iggy", "link": "https://stackoverflow.com/users/1134902/iggy"}, "edited": false, "score": 1, "creation_date": 1564448667, "post_id": 57263011, "comment_id": 101025159, "body": "What is your <code>GOPATH</code> set to?"}, {"owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "reply_to_user": {"reputation": 3985, "user_id": 1134902, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pSWiM.jpg?s=128&g=1", "display_name": "Iggy", "link": "https://stackoverflow.com/users/1134902/iggy"}, "edited": false, "score": 0, "creation_date": 1564452663, "post_id": 57263011, "comment_id": 101025891, "body": "@lggy <code>GOPATH=&quot;&#47;home&#47;sachith&#47;go&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "edited": false, "score": 0, "creation_date": 1564483897, "post_id": 57264373, "comment_id": 101038071, "body": "Tried, but still no luck."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1564461483, "creation_date": 1564461483, "answer_id": 57264373, "question_id": 57263011, "link": "https://stackoverflow.com/questions/57263011/golang-package-import-failed/57264373#57264373", "title": "golang package import failed", "body": "<blockquote>\n  <p>Is there a way to solve this problem? Without moving my project into [GOPATH]?</p>\n</blockquote>\n\n<p>Yes: Use Go modules by turning <code>GO111MODULE=on</code>.</p>\n"}], "owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1564461483, "creation_date": 1564448397, "question_id": 57263011, "link": "https://stackoverflow.com/questions/57263011/golang-package-import-failed", "title": "golang package import failed", "body": "<p>I have following folder structure in my project folder. <code>vendor</code> folder added as <a href=\"https://stackoverflow.com/questions/35480623/how-to-import-local-packages-in-go\">suggested here</a>.</p>\n\n<pre><code>my_project\n   |\n   main.go\n   - vendor\n       |\n       - user_register\n           | \n           - user_register.go\n</code></pre>\n\n<p>In <code>user_register.go</code> I have following function</p>\n\n<pre><code>\nfunc getEmail(register_response http.ResponseWriter, register_request *http.Request) {\n...\n}\n</code></pre>\n\n<p>When I try to import <code>user_register</code> package in my <code>main.go</code>, it gives an error.</p>\n\n<p>I tried <code>go install</code> from my project folder, and I got </p>\n\n<blockquote>\n  <p>go install: no install location for directory\n  /home/sachith/Documents/Personal/Projects/my_project outside\n  GOPATH</p>\n</blockquote>\n\n<p>Is there a way to solve this problem? Without moving my project into <code>/home/sachith/go</code> directory?</p>\n\n<p>I have refereed following SO threads, but they didnt solve my problem.\n<a href=\"https://stackoverflow.com/questions/34101360/golang-import-package-inside-package\">Golang import package inside package</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/41190032/golang-import-package-error\">Golang import package error</a></p>\n"}, {"tags": ["go", "recursion", "struct", "recursive-datastructures"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 5, "creation_date": 1564446740, "post_id": 57262813, "comment_id": 101024867, "body": "Show the code that you tried."}, {"owner": {"reputation": 103, "user_id": 9012846, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uhf8GeL5x4o/AAAAAAAAAAI/AAAAAAAAC4A/w8A4dGDR4ss/photo.jpg?sz=128", "display_name": "Geremachek2", "link": "https://stackoverflow.com/users/9012846/geremachek2"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564451333, "post_id": 57262813, "comment_id": 101025635, "body": "I&#39;ve added the code!"}, {"owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "edited": false, "score": 0, "creation_date": 1564460506, "post_id": 57262813, "comment_id": 101027344, "body": "your code and explanation making me confuse. can you give full example with groups and path? like given group Group{...}, path = ..., expected  Group{...}"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1564491167, "post_id": 57262813, "comment_id": 101042277, "body": "An important distinction: <code>[]string</code> is a &quot;slice of strings&quot; not an &quot;array of strings&quot; (which would be written something like <code>[5]string</code>). If this wasn&#39;t just a typo and the distinction is unclear, I&#39;d suggest reading <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a> and/or <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">Arrays, slices (and strings): The mechanics of &#39;append&#39;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 468, "user_id": 450333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11263845c2ece6187c3b87b2be66f60a?s=128&d=identicon&r=PG", "display_name": "Kent", "link": "https://stackoverflow.com/users/450333/kent"}, "is_accepted": true, "score": 1, "last_activity_date": 1564476290, "creation_date": 1564476290, "answer_id": 57267673, "question_id": 57262813, "link": "https://stackoverflow.com/questions/57262813/how-to-edit-an-array-that-is-buried-in-a-recursive-struct/57267673#57267673", "title": "How to edit an array that is buried in a recursive struct", "body": "<p>I guess you could pass the group to addItem function as a pointer, and ignore the return value for the function</p>\n\n<p>A bit like</p>\n\n<pre><code>func addItem(list *Group, newItem string, path string) Group {\n    var currentGroup *Group = list\n    if path == \"\" {\n        currentGroup.Item = append(currentGroup.Item, newItem)\n    } else {\n        for _, elem := range strings.Split(path, \"/\") {\n            in, index := in(elem, currentGroup.Groups)\n            if in {\n                currentGroup = &amp;currentGroup.Groups[index]\n            }\n        }\n        currentGroup.Item = append(currentGroup.Item, newItem)\n    }\n\n    return *currentGroup\n}\n</code></pre>\n\n<p>Complete example at:\n<a href=\"https://play.golang.org/p/_1BSF2LDQrE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_1BSF2LDQrE</a></p>\n"}], "owner": {"reputation": 103, "user_id": 9012846, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uhf8GeL5x4o/AAAAAAAAAAI/AAAAAAAAC4A/w8A4dGDR4ss/photo.jpg?sz=128", "display_name": "Geremachek2", "link": "https://stackoverflow.com/users/9012846/geremachek2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 2, "accepted_answer_id": 57267673, "answer_count": 1, "score": 0, "last_activity_date": 1564476290, "creation_date": 1564446512, "last_edit_date": 1564469996, "question_id": 57262813, "link": "https://stackoverflow.com/questions/57262813/how-to-edit-an-array-that-is-buried-in-a-recursive-struct", "title": "How to edit an array that is buried in a recursive struct", "body": "<p>I have this struct (notice that it is recursive!):</p>\n\n<pre><code>type Group struct {\n  Name string\n  Item []string\n  Groups []Group\n}\n</code></pre>\n\n<p>And I want to append a string to the <code>Item</code> array that is buried deep in the hierarchy of the Group array. The only information I have about the path of this new item is the names of the groups that it's in. Let's say the path is \"foo/bar/far\". I want to modify bar without overwriting foo, bar or the \"root\" array. Basically, I want to write a function that returns a new Group variable that is identical to the original variable but with the new string appended.</p>\n\n<p>So far I've tried the following method:</p>\n\n<p>Looping through an array that contains all the group names of the path and if they are in the current group set a current group variable to that new group. Once the loop has finished, append the string to the array and return current group. The only problem is, of course, that the rest of the root group is deleted and replaced with the new, modified group.</p>\n\n<p>The code:</p>\n\n<pre><code>func in(item string, array []Group) (bool, int) {\n        for i, elem := range array {\n                if item == elem.Name {\n                        return true, i\n                } else {\n                        continue\n                }\n        }\n\n        return false, 0\n}\n\nfunc addItem(list Group, newItem string, path string) Group {\n        var currentGroup Group = list\n        if path == \"\" {\n                currentGroup.Items = append(currentGroup.Items, newItem)\n        } else {\n                for _, elem := range strings.Split(path, \"/\") {\n                        in, index := in(elem, currentGroup.Groups)\n                        if in {\n                                currentGroup = currentGroup.Groups[index]\n                        }\n                }\n                currentGroup.Items = append(currentGroup.Items, newItem)\n        }\n\n        return currentGroup\n}\n</code></pre>\n"}, {"tags": ["linux", "go", "exec", "ls", "gvfs"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11759203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CamqN7-h8fE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdc1LgEXrnzjema7_PF-Bitl47gVQ/photo.jpg?sz=128", "display_name": "Silent Gopher Lnx", "link": "https://stackoverflow.com/users/11759203/silent-gopher-lnx"}, "edited": false, "score": 0, "creation_date": 1564442853, "post_id": 57262216, "comment_id": 101024080, "body": "this solved my problem:  f, err0 := os.Open(path) if err0 == nil { \tfor { \t\tfiles, err1 := f.Readdir(10) /* any number &gt;=1*/ \t\tif err1 == nil { \t\t\tif files[j].IsDir() { \t\t\t\tPrln(files[j].Name()+&quot;/&quot;) \t\t\t} else { \t\t\t\tPrln(files[j].Name()) \t\t\t} \t\t} else { \t\t\tbreak \t\t} \t} \tf.Close() }"}], "tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": true, "score": 3, "last_activity_date": 1564440205, "creation_date": 1564440205, "answer_id": 57262216, "question_id": 57262062, "link": "https://stackoverflow.com/questions/57262062/get-directory-entries-for-slow-protocols-asynchronously/57262216#57262216", "title": "Get directory entries for &quot;slow protocols&quot; asynchronously", "body": "<p>Try <code>ls -U -a -p 1 | cat</code> to see if you get line-by-line output.</p>\n\n<p>Go doesn't control <code>ls</code>; <code>ls</code> does line-by-line writing if <em><code>ls</code></em> chooses to do so, and <code>ls</code> chooses <em>not</em> to do that when its output is a pipe.  You could allocate a pty pair and use that, but that's the wrong way to do this.</p>\n\n<p><code>ioutil.ReadDir</code> first reads the entire directory (by calling <code>Readdir(-1)</code>), then sorts the file names.  If you use <code>os.Open</code> to open the directory, then call the <a href=\"https://golang.org/pkg/os/#File.Readdir\" rel=\"nofollow noreferrer\"><code>Readdir</code></a> or <a href=\"https://golang.org/pkg/os/#File.Readdirnames\" rel=\"nofollow noreferrer\"><code>Readdirnames</code></a> function with a small (but not negative) number, you should get something more to your liking.</p>\n"}], "owner": {"reputation": 23, "user_id": 11759203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CamqN7-h8fE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdc1LgEXrnzjema7_PF-Bitl47gVQ/photo.jpg?sz=128", "display_name": "Silent Gopher Lnx", "link": "https://stackoverflow.com/users/11759203/silent-gopher-lnx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 57262216, "answer_count": 1, "score": 0, "last_activity_date": 1564491690, "creation_date": 1564438940, "last_edit_date": 1564491690, "question_id": 57262062, "link": "https://stackoverflow.com/questions/57262062/get-directory-entries-for-slow-protocols-asynchronously", "title": "Get directory entries for &quot;slow protocols&quot; asynchronously", "body": "<p>I want a function for getting directory entries on Linux. I use <a href=\"https://golang.org/pkg/io/ioutil/#ReadDir\" rel=\"nofollow noreferrer\"><code>ioutil.ReadDir</code></a> and usually it is fast.\nBut if I want to read some mounted virtual file system on <code>/run/user/1000/gvfs/</code>, this function becomes slow. If the directory has many file entries I need to wait a long time.</p>\n\n<p>I can use the <code>ls</code> command in a terminal and result will be the same.\nWhen I tried <code>ls -U -a -p -1</code> I got line by line output immediately.\nI tried running this in Go with <code>exec.Command</code>, but it didn't work asynchronously. Go is waiting for full program output. What did I do wrong? </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>m.cmd = exec.Command(\"ls\", \"-U\", \"-a\", \"-p\", \"-1\")\n// for example some \"slow\" directory:\nm.cmd.Dir = \"/run/user/1000/gvfs/dav:host=webdav.yandex.ru,ssl=true,user=...../\" \nreader, _ := m.cmd.StdoutPipe()\nbufReader := bufio.NewReader(reader)\ngo func() {\n  m.cmd.Start()\n  for {\n    line, _, err := bufReader.ReadLine()\n    if err != nil {\n      break\n    }\n    linestr := string(line)\n    if linestr != \"./\" &amp;&amp; linestr != \"../\" {\n      fmt.Println(linestr)\n    }\n  }\n}()\n</code></pre>\n\n<p>I need line by line printing immediately in Go.</p>\n"}, {"tags": ["go", "ssh"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4375437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WfOOM.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/4375437/cameron"}, "edited": false, "score": 0, "creation_date": 1564501685, "post_id": 57263993, "comment_id": 101048897, "body": "It seems like the goroutine there should be internal to <code>session.Wait()</code>. The documentation suggests that it should return no matter how the connection was closed, just that under non-graceful terminations the err value will be populated.   Do you know of a way to get into the raw mode with the ssh package? I&#39;d be interested in trying that. Sending the EOF to the remote end should cause bash to exit out nicely."}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "reply_to_user": {"reputation": 1, "user_id": 4375437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WfOOM.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/4375437/cameron"}, "edited": false, "score": 0, "creation_date": 1564508423, "post_id": 57263993, "comment_id": 101051305, "body": "Not sure which goroutine you mean\u2014there&#39;s already one that looks similar to the one above (but lacks the <code>session.Close()</code> part) that handles copying from the input stream to the other end of the session. As for getting raw mode, I don&#39;t know if there&#39;s anything convenient."}], "tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": false, "score": 0, "last_activity_date": 1564458113, "creation_date": 1564458113, "answer_id": 57263993, "question_id": 57261738, "link": "https://stackoverflow.com/questions/57261738/how-to-handle-eof-ctrld-in-go-crypto-ssh-session-wait/57263993#57263993", "title": "How to handle EOF / Ctrl+D in Go crypto/ssh session.Wait()", "body": "<p>I was able to reproduce this (with a bunch of additional framework code) but am not sure why it happens.  It is possible to terminate the session by adding a <code>session.Close</code> call if you encounter EOF on stdin:</p>\n\n<pre><code>        session.Stdout = os.Stdout\n        session.Stderr = os.Stderr\n        // session.Stdin = os.Stdin\n        ip, err := session.StdinPipe()\n        if err != nil {\n                return err\n        }\n        go func() {\n                io.Copy(ip, os.Stdin)\n                fmt.Println(\"stdin ended\")\n                time.Sleep(1 * time.Second)\n                fmt.Println(\"issuing ip.Close() now\")\n                ip.Close()\n                time.Sleep(1 * time.Second)\n                fmt.Println(\"issuing session.Close() now\")\n                err = session.Close()\n                if err != nil {\n                        fmt.Printf(\"close: %v\\n\", err)\n                }\n        }()\n</code></pre>\n\n<p>You'll see that the session shuts down (not very nicely) after the <code>session.Close()</code>.  Calling <code>ip.Close()</code> <em>should</em> have shut down the stdin channel, and it seems like this <em>should</em> happen when just using <code>os.Stdin</code> directly too, but for some reason it does not work.  Debugging shows an ssh-channel-close message going to the other end (for both cases), but the other end doesn't close the return-data ssh channels, so your end continues to wait for more output from them.</p>\n\n<p>Worth noting: you have not put the local tty into raw-ish character-at-a-time mode.  A regular ssh session does, so ^D does not actually <em>close</em> the connection, it just sends a literal control-D to the pty on the other side.  It's the other end that turns that control-D into a (soft) EOF signal on the pty.</p>\n"}], "owner": {"reputation": 1, "user_id": 4375437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WfOOM.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/4375437/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564458113, "creation_date": 1564436391, "question_id": 57261738, "link": "https://stackoverflow.com/questions/57261738/how-to-handle-eof-ctrld-in-go-crypto-ssh-session-wait", "title": "How to handle EOF / Ctrl+D in Go crypto/ssh session.Wait()", "body": "<p>When I use <code>session.Shell()</code> to start a new shell on a remote server and then <code>session.Wait()</code> to run the session until the remote end exits the session does not gracefully handle using Ctrl+D to end the session.</p>\n\n<p>I can make this work using <code>os/exec</code> to launch a local child process to run whatever copy of the ssh client is available locally, but I would prefer to do this with native Go.</p>\n\n<p>Examle code snippet:</p>\n\n<pre><code>conn, err := ssh.Dial(\"tcp\", \"some-server.fqdn\", sshConfig)\nif err != nil {\n  return err\n}\ndefer conn.Close()\n\nsession, err := conn.NewSession()\nif err != nil {\n  return err\n}\ndefer session.Close()\n\nsession.Stdout = os.Stdout\nsession.Stderr = os.Stderr\nsession.Stdin = os.Stdin\n\nmodes := ssh.TerminalModes{\n  ssh.ECHO:          0,\n  ssh.TTY_OP_ISPEED: 14400,\n  ssh.TTY_OP_OSPEED: 14400,\n}\n\nerr = session.RequestPty(\"xterm\", 80, 40, modes)\nif err != nil {\n  return err\n}\n\nerr = session.Shell()\nif err != nil {\n  return err\n}\nsession.Wait()\n</code></pre>\n\n<p>Running <code>exit</code> on the remote server gracefully hangs up the remote end and <code>session.Wait()</code> returns as expected, but sending an EOF with Ctrl+D causes the remote end to hang up but the call to <code>session.Wait()</code> is stuck blocking. I have to use Ctrl+C to SIGINT the Go program.\nI would like to get both to gracefully exit the <code>session.Wait()</code> call as that is expected behavior for most interactive ssh sessions.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1564433726, "post_id": 57261053, "comment_id": 101021668, "body": "You don&#39;t build multiple files with <code>.&#47;...</code>, the <code>...</code> is a wildcard to reference multiple <i>packages</i>.  The <code>go</code> commands reference packages, and packages can have as many files as you want. See <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> for the basics (and <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Modules</a> if you&#39;re starting with modules)"}, {"owner": {"reputation": 585, "user_id": 6693067, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e041d77282408e4be2718dcb892c7041?s=128&d=identicon&r=PG&f=1", "display_name": "Bram z", "link": "https://stackoverflow.com/users/6693067/bram-z"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1564434983, "post_id": 57261053, "comment_id": 101022104, "body": "All files in the package have the same package name. Is this what you mean with having as many files as you want?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1564435237, "post_id": 57261053, "comment_id": 101022175, "body": "I mean that you can have as many files in a package as you want (within system limits). Yes, all files in the same package have the same package name of course, and a single package is contained in a directory. The compiler has no notion of individual source files, and compiles the aggregate source for each package. You will have to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in order for someone to help diagnose whatever problem you&#39;re facing."}, {"owner": {"reputation": 585, "user_id": 6693067, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e041d77282408e4be2718dcb892c7041?s=128&d=identicon&r=PG&f=1", "display_name": "Bram z", "link": "https://stackoverflow.com/users/6693067/bram-z"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1564503970, "post_id": 57261053, "comment_id": 101050020, "body": "I think I&#39;m facing a circular dependency issue. Go does not accept this, am I right?"}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 0, "creation_date": 1564701489, "post_id": 57261053, "comment_id": 101127443, "body": "Go does not allow circular imports of <i>packages</i>. This has always been the case, or at least since before Go 1.0.  I would echo the suggestion to read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">&quot;How to Write Go Code&quot;</a>, which covers a lot of what you are asking about in terms of the older GOPATH-based system."}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 0, "creation_date": 1564701995, "post_id": 57261053, "comment_id": 101127548, "body": "Also, question: have you opted-in to the new Go modules system? You are saying &quot;modules/packages&quot;, but I suspect you might not actually mean the new Go modules system? (It is new as of Go 1.11, and opt-in only, so if you are new to Go and haven&#39;t consciously tried to enable the new Go modules system, there is a healthy chance you are not using modules, and instead are using the older GOPATH-based system)."}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 0, "creation_date": 1564703561, "post_id": 57261053, "comment_id": 101127820, "body": "Also, what is the exact error message you are seeing?"}], "answers": [{"tags": [], "owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "is_accepted": false, "score": 0, "last_activity_date": 1564703668, "last_edit_date": 1564703668, "creation_date": 1564703028, "answer_id": 57318281, "question_id": 57261053, "link": "https://stackoverflow.com/questions/57261053/splitting-a-single-package-module-into-multiple-many-files-gives-undefined-err/57318281#57318281", "title": "Splitting a single package/module into multiple (many) files gives undefined error on go build ./", "body": "<p>You can have as many <code>.go</code> files in a single directory as you'd like.  </p>\n\n<p>A Go package consists of all of the <code>.go</code> files in a single directory. Each <code>.go</code> file in a single directory should have the same <code>package foo</code> declaration as the other <code>.go</code> files in the same directory.</p>\n\n<p>Your source code imports code from another package (another directory) via an <em>import path</em> supplied in an import statement such as <code>import \"github.com/my/repo/pkg1\"</code>. </p>\n\n<p>To build a package, you can <code>cd</code> to the directory and issue <code>go build .</code> (where <code>.</code> means build all the files in the current directory, or you can also just issue <code>go build</code> in that directory without any arguments because the default is <code>.</code>).</p>\n\n<p>Code within the same package (the same directory) can reference code in other files in the same package (same directory) without needing to import the other files, and without needing the symbols to be exported (uppercase first character).</p>\n\n<p>It is well worth the time to read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">\"How to Write Go Code\"</a>, which includes an overview of these concepts, including:</p>\n\n<blockquote>\n  <p>Go programmers typically keep all their Go code in a single <em>workspace</em>.</p>\n  \n  <ul>\n  <li>A workspace contains many version control repositories (managed by Git, for example).</li>\n  <li>Each repository contains one or more <em>packages</em>.</li>\n  <li>Each package consists of one or more Go source files in a single directory.</li>\n  <li>The path to a package's directory determines its <em>import path</em>.</li>\n  </ul>\n</blockquote>\n\n<p>and a bit later it describes the relationship between \"workspace\" and GOPATH:</p>\n\n<blockquote>\n  <p>The GOPATH environment variable specifies the location of your workspace. It defaults to a directory named go inside your home directory, so $HOME/go on Unix, $home/go on Plan 9, and %USERPROFILE%\\go (usually C:\\Users\\YourName\\go) on Windows.</p>\n</blockquote>\n\n<p>Regarding your more specific concerns:</p>\n\n<p><em>Splitting a single package into multiple (many) files gives undefined error on go build ./</em></p>\n\n<p>Splitting a package across multiple individual <code>.go</code> files in the same directory (same package) should not cause a problem in and of itself, but of course it needs to be done properly (e.g., all <code>.go</code> files in the same directory (same package) need to have the same <code>package foo</code> declaration near the top; files in the same directory should not attempt to use <code>import</code> statements to import other files in the same directory; etc.).</p>\n\n<p><em>My gut feeling says that this is because of the build order.</em></p>\n\n<p>Build order shouldn't matter here.</p>\n\n<p><em>My second gut feeling is that file 'a.go' contains a reference to a function inside file 'b.go' and the same vice-versa. So file 'b.go' also has reference to a function in file 'a.go'.</em></p>\n\n<p>This is fine if <code>a.go</code> and <code>b.go</code> are in the same package (the same directory).</p>\n\n<p>On the other hand, this is not allowed if <code>a.go</code> and <code>b.go</code> are in the different packages (different directories). This is because Go does not allow circular dependencies at the package level.  If this is the problem, the simplest solution is to move <code>a.go</code> and <code>b.go</code> into the same directory, or refactor to introduce a third package to break the cycle so that <code>a</code> and <code>b</code> can both depend on the third package, or use interfaces, or other possible solutions, but given you say you are new to Go, the simplest solution might be best while you are learning.</p>\n"}], "owner": {"reputation": 585, "user_id": 6693067, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e041d77282408e4be2718dcb892c7041?s=128&d=identicon&r=PG&f=1", "display_name": "Bram z", "link": "https://stackoverflow.com/users/6693067/bram-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1564703668, "creation_date": 1564432617, "last_edit_date": 1564434085, "question_id": 57261053, "link": "https://stackoverflow.com/questions/57261053/splitting-a-single-package-module-into-multiple-many-files-gives-undefined-err", "title": "Splitting a single package/module into multiple (many) files gives undefined error on go build ./", "body": "<p>I like splitting my modules/packages into many files (e.g. a bigger function file and a coupled helpers file). Now a module can have many bigger functions as it grows. Let's say my modules/packages each consist of around 30 files.</p>\n\n<p>When I started working with Go a few days ago, I was a bit confused about the module pattern. I have a JavaScript (ES6+) background. After some research, I found you could build packages consisting of multiple files by running the following command <code>go build ./...</code>. This worked out pretty well, until my package consisted of about 10 files. All of a sudden I saw errors about functions being undefined. Meanwhile those functions where clearly defined in the src of the module/package (and properly capitalized).</p>\n\n<p>My gut feeling says that this is because of the build order. Say we have 2 files 'a.go' and 'b.go'. file 'a.go' got a reference to a function in file 'b.go'. When file 'a.go' is build before 'b.go', an undefined error appears. My second gut feeling is that file 'a.go' contains a reference to a function inside file 'b.go' and the same vice-versa. So file 'b.go' also has reference to a function in file 'a.go'.</p>\n\n<ol>\n<li>Is my first of my second gut feeling correct?</li>\n<li>How do people commonly tackle this problem, or even better, what is the best practice?</li>\n<li>What is the proper way creating a single module which consists out of many files?</li>\n</ol>\n"}, {"tags": ["go", "go-cobra"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564426417, "post_id": 57259762, "comment_id": 101018885, "body": "By calling <code>run()</code>. Every command in Cobra just calls a function. You can call the same function from multiple cobra commands."}, {"owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564426499, "post_id": 57259762, "comment_id": 101018925, "body": "As I&#39;ve done? That only honors the root command arguments, but not the run command&#39;s arguments :/"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1616661518, "creation_date": 1616661518, "answer_id": 66795805, "question_id": 57259762, "link": "https://stackoverflow.com/questions/57259762/how-can-i-invoke-a-default-subcommand-with-cobra/66795805#66795805", "title": "How can I invoke a default subcommand with cobra?", "body": "<p>You might consider a workaround as the one presented in <a href=\"https://github.com/spf13/cobra/issues/823#issuecomment-617863653\" rel=\"nofollow noreferrer\"><code>spf13/cobra</code> issue 823</a></p>\n<pre class=\"lang-golang prettyprint-override\"><code>func subCommands() (commandNames []string) {\n    for _, command := range cmd.Commands() {\n        commandNames = append(commandNames, append(command.Aliases, command.Name())...)\n    }\n    return\n}\n\nfunc setDefaultCommandIfNonePresent() {\n    if len(os.Args) &gt; 1 { \n        potentialCommand := os.Args[1]\n        for _, command := range subCommands() {\n            if command == potentialCommand {\n                return\n            }\n        }\n        os.Args = append([]string{os.Args[0], &quot;&lt;default subcommand&gt;&quot;}, os.Args[1:]...)\n    }\n\n}\n\nfunc main() {\n    setDefaultCommandIfNonePresent()\n    if err := cmd.Execute(); err != nil {\n        zap.S().Error(err)\n        os.Exit(1)\n    }\n}\n</code></pre>\n<blockquote>\n<p>The difference here is that it checks if <code>len(os.Args) &gt; 1</code> before changing the default subcommand.</p>\n<p>This means that, if ran without any arguments, it will print the default help command (with all of the subcommands).<br />\nOtherwise, if supplied any arguments, it will use the subcommand.</p>\n<p>So, it will display the main '<code>help</code>' without arguments, and the subcommand's help if supplied '<code>-h</code>'/'<code>--help</code>'.</p>\n</blockquote>\n"}], "owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1616661518, "creation_date": 1564425824, "last_edit_date": 1564426759, "question_id": 57259762, "link": "https://stackoverflow.com/questions/57259762/how-can-i-invoke-a-default-subcommand-with-cobra", "title": "How can I invoke a default subcommand with cobra?", "body": "<p>Using cobra, if my app is invoked without a specific action (but arguments), I'd like to run a default command:</p>\n\n<pre><code>// rootCmd represents the base command when called without any subcommands\nvar rootCmd = &amp;cobra.Command{\n    Use:   \"mbmd\",\n    Short: \"ModBus Measurement Daemon\",\n    Long:  \"Easily read and distribute data from ModBus meters and grid inverters\",\n\n    Run: func(cmd *cobra.Command, args []string) {\n        run(cmd, args)\n    },\n}\n</code></pre>\n\n<p>However, since the root command doesn't have all arguments the child command has this fails as it's apparently now aware of the child command's arguments:</p>\n\n<pre><code>\u276f go run main.go -d sma:126@localhost:5061 --api 127.1:8081 -v\nError: unknown shorthand flag: 'd' in -d\n</code></pre>\n\n<p>as opposed to:</p>\n\n<pre><code>\u276f go run main.go run -d sma:126@localhost:5061 --api 127.1:8081 -v\n2019/07/29 20:58:10 mbmd unknown version (unknown commit)\n</code></pre>\n\n<p>How can I programmatically instantiate/invoke a child command?</p>\n"}, {"tags": ["go", "ssl", "server", "x509", "pkcs#12"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1564464610, "post_id": 57259755, "comment_id": 101028467, "body": "Judging from the error messages you a) should swap the cert and key variables, and b) don&#39;t need to load the keypair with the tls package because pkcs12.Decode already does that. You just have to initialize a value of type tls.Certificate directly. If you want concrete help let us know which package pkcs12 is."}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1564606748, "post_id": 57259755, "comment_id": 101091436, "body": "I added the import so you van see the pkcs12 package.  I&#39;m a bit confused by what you are saying.  Could you show ma an example in the form of an answer rather than in a comment please?"}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1564644696, "creation_date": 1564644696, "answer_id": 57303901, "question_id": 57259755, "link": "https://stackoverflow.com/questions/57259755/how-do-i-load-a-x509-keypair-from-a-pkcs12-store/57303901#57303901", "title": "How do I load a x509 keypair from a pkcs12 store?", "body": "<p>You don't need to load the keypair with the tls package because pkcs12.Decode already does that. Simply initialize a value of type tls.Certificate:</p>\n\n<pre><code>p12_data, err := ioutil.ReadFile(\"../identify.p12\")\nif err != nil {\n    log.Fatal(err)\n}\n\nkey, cert, err := pkcs12.Decode(p12_data, \"123456\") // Note the order of the return values.\nif err != nil {\n    log.Fatal(err)\n}\n\ntlsCert := tls.Certificate{\n    Certificate: [][]byte{cert.Raw},\n    PrivateKey:  key.(crypto.PrivateKey),\n    Leaf:        cert,\n}\n</code></pre>\n\n<p>Quoting <a href=\"https://godoc.org/golang.org/x/crypto/pkcs12#Decode\" rel=\"nofollow noreferrer\">the documentation</a>:</p>\n\n<blockquote>\n  <p>This function assumes that there is only one certificate and only one private key in the pfxData; if there are more use ToPEM instead.</p>\n</blockquote>\n\n<p>The documentation contains an example that shows how to use ToPEM to initialize a tls.Certificate.</p>\n"}], "owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 57303901, "answer_count": 1, "score": 0, "last_activity_date": 1564644696, "creation_date": 1564425809, "last_edit_date": 1564606671, "question_id": 57259755, "link": "https://stackoverflow.com/questions/57259755/how-do-i-load-a-x509-keypair-from-a-pkcs12-store", "title": "How do I load a x509 keypair from a pkcs12 store?", "body": "<p>I have a script that creates a PKCS12 store on a server via OpenSSL.  I am developing a TLS/SSL server in Go and need to load the key pair from the created PKCS12 store.  How do I pull the keypair from the PCKS12 store and load them?</p>\n\n<p>Here is my code snippet, which is giving me an error: </p>\n\n<pre><code>src/server.go:59:19: cannot use cert (type interface {}) as type []byte in argument to ioutil.WriteFile: need type assertion\nsrc/server.go:60:19: cannot use key (type *x509.Certificate) as type []byte in argument to ioutil.WriteFile\n</code></pre>\n\n<pre><code> import \"golang.org/x/crypto/pkcs12\"\n\n\n // Read byte data from pkcs12 keystore\n p12_data, err := ioutil.ReadFile(\"../identify.p12\")\n if err != nil {\n     log.Fatal(err)\n }\n\n // Extract cert and key from pkcs keystore\n cert, key, err := pkcs12.Decode(p12_data, \"123456\")\n    if err != nil {\n        log.Println(err)\n        return\n    }\n\n//Write cert and key out to filepath\nioutil.WriteFile(\"cert.pem\", cert, 777)\nioutil.WriteFile(\"key.pem\", key, 777)\n\nlog.SetFlags(log.Lshortfile)\ncer, err := tls.LoadX509KeyPair(\"cert.pem\", \"key.pem\")\nif err != nil {\n    log.Println(err)\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "google-cloud-dataflow", "apache-beam"], "answers": [{"tags": [], "owner": {"reputation": 1525, "user_id": 5265589, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3mz8EIhsgoA/AAAAAAAAAAI/AAAAAAAABFI/erxuMDLdMis/photo.jpg?sz=128", "display_name": "Alex Amato", "link": "https://stackoverflow.com/users/5265589/alex-amato"}, "is_accepted": false, "score": 0, "last_activity_date": 1564435464, "creation_date": 1564435464, "answer_id": 57261604, "question_id": 57259610, "link": "https://stackoverflow.com/questions/57259610/apache-beam-golang-dataflow-run-keep-on-hold/57261604#57261604", "title": "Apache Beam Golang Dataflow run keep on hold", "body": "<p>Dataflow doesn't officially support the Apache Beam Go SDK. Some users have had been able to use it though. I suspect that this release may have had issues. You may be able to try a different version.</p>\n\n<p>You may be able to discuss with other users on the <a href=\"https://beam.apache.org/community/contact-us/\" rel=\"nofollow noreferrer\">Beam mailing list</a> about which versions have worked for them (though, unsupported).</p>\n"}], "owner": {"reputation": 51, "user_id": 1879475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6e2d5d0f1bf7461faa6cadcf41ef78?s=128&d=identicon&r=PG", "display_name": "Wei", "link": "https://stackoverflow.com/users/1879475/wei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1602844246, "creation_date": 1564425169, "last_edit_date": 1602844246, "question_id": 57259610, "link": "https://stackoverflow.com/questions/57259610/apache-beam-golang-dataflow-run-keep-on-hold", "title": "Apache Beam Golang Dataflow run keep on hold", "body": "<p>I'm using the Apache Beam Go SDK, and runner as dataflow. However, still stuck on</p>\n<pre><code>failed to \\&quot;StartContainer\\&quot; for \\&quot;sdk\\&quot; with CrashLoopBackOff:\n</code></pre>\n<p>I try to rebuild the container by following the Apache Beam [suggestion]: <a href=\"https://github.com/apache/beam/blob/master/sdks/CONTAINERS.md\" rel=\"nofollow noreferrer\">https://github.com/apache/beam/blob/master/sdks/CONTAINERS.md</a></p>\n<p>I push the new build container to Google Container registry.</p>\n<p>However, this problem still remains.</p>\n<p>Could someone provide information relative to this?</p>\n"}, {"tags": ["go", "drone", "drone.io"], "answers": [{"tags": [], "owner": {"reputation": 350, "user_id": 2799974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymMDn.jpg?s=128&g=1", "display_name": "Thiago Valentim", "link": "https://stackoverflow.com/users/2799974/thiago-valentim"}, "is_accepted": false, "score": 1, "last_activity_date": 1564419246, "creation_date": 1564419246, "answer_id": 57258255, "question_id": 57257842, "link": "https://stackoverflow.com/questions/57257842/is-the-service-of-drone-io-isolated-for-each-build-or-shared/57258255#57258255", "title": "Is the service of drone.io isolated for each build or shared?", "body": "<p>I am including the Brad Rydzewski's answer and I hope this help someone.</p>\n\n<p>\"each pipeline execution gets its own dedicated network. The network is created when a pipeline starts ,and destroyed when the pipeline completes\"\n - Brad Rydzewski</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 9485498, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KXuOKPoEk48/AAAAAAAAAAI/AAAAAAAAAQ8/cvvmdEuOu7A/photo.jpg?sz=128", "display_name": "Rohit", "link": "https://stackoverflow.com/users/9485498/rohit"}, "is_accepted": false, "score": 0, "last_activity_date": 1564678721, "creation_date": 1564678721, "answer_id": 57313777, "question_id": 57257842, "link": "https://stackoverflow.com/questions/57257842/is-the-service-of-drone-io-isolated-for-each-build-or-shared/57313777#57313777", "title": "Is the service of drone.io isolated for each build or shared?", "body": "<p>Services are isolated for each build but they are shared by the steps in a pipeline. They are only started when your build starts and killed when all the steps complete.</p>\n\n<p>Services are like steps only but they get detached and drone doesn't care about their success/failure. You can also manually detach a step <a href=\"https://docs.drone.io/user-guide/pipeline/services/#detached-steps\" rel=\"nofollow noreferrer\">https://docs.drone.io/user-guide/pipeline/services/#detached-steps</a></p>\n"}], "owner": {"reputation": 350, "user_id": 2799974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymMDn.jpg?s=128&g=1", "display_name": "Thiago Valentim", "link": "https://stackoverflow.com/users/2799974/thiago-valentim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1578402765, "creation_date": 1564417361, "last_edit_date": 1578402765, "question_id": 57257842, "link": "https://stackoverflow.com/questions/57257842/is-the-service-of-drone-io-isolated-for-each-build-or-shared", "title": "Is the service of drone.io isolated for each build or shared?", "body": "<p>The <a href=\"https://docs.drone.io/examples/service/postgres/\" rel=\"nofollow noreferrer\">service</a> of drone.io is a way to include some dependent service into the pipeline.</p>\n\n<p><strong>I would like to know if the services will be created for each build, so Is the service isolated for each build or shared?</strong></p>\n\n<p>I already tried to find it via documentation of services but there is not this information there.</p>\n\n<pre><code>services:\n  postgres:\n    image: postgres\n    environment:\n      - POSTGRES_PASSWORD=pass\n      - POSTGRES_USER=user\n      - POSTGRES_DB=db\n\n</code></pre>\n\n<p>I expect that each build creates its own service to keep the things separated.</p>\n\n<p>After I had talked to the core developers I discoreved the answer and now I am sharing here as well</p>\n\n<blockquote>\n  <p>\"each pipeline execution gets its own dedicated network. The network\n  is created when a pipeline starts ,and destroyed when the pipeline\n  completes\" - Brad Rydzewski</p>\n</blockquote>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1564413063, "post_id": 57256550, "comment_id": 101012891, "body": "Or use a multi-line match with <code>m</code>"}, {"owner": {"reputation": 1094, "user_id": 111148, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ea21c8fb2c0cf7b6bfffa97c9266d173?s=128&d=identicon&r=PG&f=1", "display_name": "zuraff", "link": "https://stackoverflow.com/users/111148/zuraff"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564413764, "post_id": 57256550, "comment_id": 101013322, "body": "@Flimzy - I&#39;d like my ultimate regex to span over many lines, so splitting is not quite suitable for me."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564496845, "post_id": 57256824, "comment_id": 101046025, "body": "Note <a href=\"https://golang.org/pkg/regexp/syntax\" rel=\"nofollow noreferrer\"><code>regexp&#47;syntax</code></a> documents the supported syntax and says of the <code>m</code> flag: &quot;multi-line mode: ^ and $ match begin/end line in addition to begin/end text (default false)&quot;"}], "tags": [], "owner": {"reputation": 66, "user_id": 6574392, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0GH6vWWA6g/AAAAAAAAAAI/AAAAAAAAF30/z-FkpSRBt-w/photo.jpg?sz=128", "display_name": "Greg", "link": "https://stackoverflow.com/users/6574392/greg"}, "is_accepted": true, "score": 5, "last_activity_date": 1564413592, "creation_date": 1564413592, "answer_id": 57256824, "question_id": 57256550, "link": "https://stackoverflow.com/questions/57256550/regular-expression-with-beginning-of-line/57256824#57256824", "title": "Regular expression with beginning of line", "body": "<p>You have to enable multi line mode flag for regex evaluation. Try this:</p>\n\n<pre><code>func TestNewLine(t *testing.T) {\n    re := regexp.MustCompile(\"(?m)^(bar)\")\n    match := re.FindString(\"foo\\nbar\\nbaz\")\n    assert.Equal(t, \"bar\", match)\n}\n</code></pre>\n"}], "owner": {"reputation": 1094, "user_id": 111148, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ea21c8fb2c0cf7b6bfffa97c9266d173?s=128&d=identicon&r=PG&f=1", "display_name": "zuraff", "link": "https://stackoverflow.com/users/111148/zuraff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 57256824, "answer_count": 1, "score": 1, "last_activity_date": 1564414452, "creation_date": 1564412711, "last_edit_date": 1564414452, "question_id": 57256550, "link": "https://stackoverflow.com/questions/57256550/regular-expression-with-beginning-of-line", "title": "Regular expression with beginning of line", "body": "<p>I'd like to use a regular expression which matches the beginning of a line in a text. For some reason, <code>^</code> does not work, see this failing test:</p>\n\n<pre><code>func TestNewLine(t *testing.T) {\n    re := regexp.MustCompile(\"^bar\")\n    match := re.FindString(\"foo\\nbar\\nbaz\")\n    assert.Equal(t, \"bar\", match)\n}\n</code></pre>\n\n<p>What do I miss?</p>\n"}, {"tags": ["go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 7309431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f457a69f8a216dbd92a363d51ec6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijet", "link": "https://stackoverflow.com/users/7309431/abhijet"}, "edited": false, "score": 0, "creation_date": 1564463437, "post_id": 57255077, "comment_id": 101028098, "body": "I changed the maxReceiveMessageSize  as well as send message size to 20MB in both server and client and still the problem exists."}, {"owner": {"reputation": 115, "user_id": 7309431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f457a69f8a216dbd92a363d51ec6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijet", "link": "https://stackoverflow.com/users/7309431/abhijet"}, "edited": false, "score": 0, "creation_date": 1564468415, "post_id": 57255077, "comment_id": 101029851, "body": "I guess you are correct about the message length because now when i don&#39;t send list of results in summary the message is successfully sent. What should I do if I need to send the list of results. I have tried sending in streams as well but no success."}], "tags": [], "owner": {"reputation": 1041, "user_id": 2660313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7f4cadd6658af696e1d975eda49c49?s=128&d=identicon&r=PG", "display_name": "owlwalks", "link": "https://stackoverflow.com/users/2660313/owlwalks"}, "is_accepted": false, "score": 1, "last_activity_date": 1564407417, "creation_date": 1564407417, "answer_id": 57255077, "question_id": 57253797, "link": "https://stackoverflow.com/questions/57253797/grpc-server-stops-receiving-messages-after-sending-many-messages-simultaneously/57255077#57255077", "title": "grpc server stops receiving messages after sending many messages simultaneously", "body": "<p>grpc default maxReceiveMessageSize is 4MB, your grpc client probably went over that limit. </p>\n\n<p>grpc uses h2 in transport layer which opens only one tcp conn and multiplex \"requests\" over that, reduce significant overhead compare to h1, I wouldn't worry too much for batching and will just make individual calls to grpc server.</p>\n"}], "owner": {"reputation": 115, "user_id": 7309431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f457a69f8a216dbd92a363d51ec6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijet", "link": "https://stackoverflow.com/users/7309431/abhijet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1564407417, "creation_date": 1564402927, "last_edit_date": 1564403236, "question_id": 57253797, "link": "https://stackoverflow.com/questions/57253797/grpc-server-stops-receiving-messages-after-sending-many-messages-simultaneously", "title": "grpc server stops receiving messages after sending many messages simultaneously", "body": "<p>I am implementing a simple grpc service where the summary of a task is to be sent to the grpc server. Everything works fine if I send less number of messages but when I begin to send like 5000 messages the server stops and gets deadline exceeded message in client side. I also tried to reconnect again but found the error message as.</p>\n\n<pre><code>rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: timed out waiting for server handshake\n</code></pre>\n\n<p>The server shows no error and is alive.</p>\n\n<p>I tried setting GRPC_GO_REQUIRE_HANDSHAKE=off as well but the error still prevails. I also implemented sending summary in batch but same scenerio repeated. </p>\n\n<p>Is there any limitations to number of messages to be sent in grpc?</p>\n\n<p>Here is my service proto</p>\n\n<pre class=\"lang-proto prettyprint-override\"><code>\n// The Result service definition.\nservice Result {\n  rpc ConntectMaster(ConnectionRequest) returns (stream ExecutionCommand) {}\n  rpc postSummary(Summary) returns(ExecutionCommand) {}\n}\n\nmessage Summary{\n\n  int32 successCount = 1;\n  int32 failedCount = 2;\n  int32 startTime = 3;\n  repeated TaskResult results = 4;\n  bool isLast = 5;\n  string id = 6;\n}\n</code></pre>\n\n<p>postSummary implementation in sever</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// PostSummary posts the summary to the master\nfunc (server *Server) PostSummary(ctx context.Context, in *pb.Summary) (*pb.ExecutionCommand, error) {\n\n    for i := 0; i &lt; len(in.Results); i++ {\n\n        res := in.Results[i]\n        log.Printf(\"%s --&gt; %d Res :: %s, len : %d\", in.Id, i, res.Id, len(in.Results))\n\n    }\n    return &amp;pb.ExecutionCommand{Type: stopExec}, nil\n}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func postSummaryInBatch(executor *Executor, index int) {\n    summary := pb.Summary{\n        SuccessCount: int32(executor.summary.successCount),\n        FailedCount:  int32(executor.summary.failedCount),\n        Results:      []*pb.TaskResult{},\n        IsLast:       false,\n    }\n\n    if index &gt;= len(executor.summary.TaskResults) {\n        summary.IsLast = true\n        return\n    }\n\n    var to int\n    batch := 500\n    if (index + batch) &lt;= len(executor.summary.TaskResults) {\n        to = index + batch\n    } else {\n        to = len(executor.summary.TaskResults)\n    }\n    for i := index; i &lt; to; i++ {\n        result := executor.summary.TaskResults[i]\n        taskResult := pb.TaskResult{\n            Id:   result.id,\n            Msg:  result.msg,\n            Time: result.time,\n        }\n        // log.Printf(\"adding res : %s \", taskResult.Id)\n\n        if result.err != nil {\n            taskResult.IsError = true\n        }\n        summary.Results = append(summary.Results, &amp;taskResult)\n    }\n    summary.Id = fmt.Sprintf(\"%d-%d\", index, to)\n    log.Printf(\"sent from  %d to %d \", index, to)\n    postSummary(executor, &amp;summary, 0)\n    postSummaryInBatch(executor, to)\n}\n\nfunc postSummary(executor *Executor, summary *pb.Summary, retryCount int) {\n    ctx, cancel := context.WithTimeout(context.Background(), 3*time.Second)\n    defer cancel()\n\n    cmd, err := client.PostSummary(ctx, summary)\n    if err != nil {\n        if retryCount &lt; 3 {\n            reconnect(executor)\n            postSummary(executor, summary, retryCount+1)\n        }\n        log.Printf(err.Error())\n        // log.Fatal(\"cannot send summary report\")\n    } else {\n        processServerCommand(executor, cmd)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "interface", "grpc", "go-micro"], "answers": [{"comments": [{"owner": {"reputation": 5203, "user_id": 1061008, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1465c4d9e6e9a18c5b0f8bf8e2f93b09?s=128&d=identicon&r=PG&f=1", "display_name": "Alireza", "link": "https://stackoverflow.com/users/1061008/alireza"}, "edited": false, "score": 0, "creation_date": 1564403140, "post_id": 57253813, "comment_id": 101007345, "body": "I forgot to run it like you said and it works, thank you. Isn&#39;t there any other way to run just <code>main.go</code> and it automatically fetches <code>SRVService</code>?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1564403201, "post_id": 57253813, "comment_id": 101007373, "body": "Or simply <code>go run .</code>, then you don&#39;t have to list all the files all the time."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1564402996, "creation_date": 1564402996, "answer_id": 57253813, "question_id": 57253756, "link": "https://stackoverflow.com/questions/57253756/how-to-import-go-interface-package-in-my-main-go/57253813#57253813", "title": "How to import go interface package in my main.go?", "body": "<p>If they're in the same folder, they're part of the same package (their package declaration must reflect that). If they are part of the same package, you don't need to import anything. You can refer to all identifiers (being exported or not) from the package.</p>\n\n<p>The <code>main</code> package is special though. If your <code>main</code> package consists of multiple files, you have to list all when running or building the app, e.g.:</p>\n\n<pre><code>go run srv_service.go main.go\n</code></pre>\n"}], "owner": {"reputation": 5203, "user_id": 1061008, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1465c4d9e6e9a18c5b0f8bf8e2f93b09?s=128&d=identicon&r=PG&f=1", "display_name": "Alireza", "link": "https://stackoverflow.com/users/1061008/alireza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 57253813, "answer_count": 1, "score": -1, "last_activity_date": 1564402996, "creation_date": 1564402779, "question_id": 57253756, "link": "https://stackoverflow.com/questions/57253756/how-to-import-go-interface-package-in-my-main-go", "title": "How to import go interface package in my main.go?", "body": "<p>For clarity most of the code is removed to focus more on the question. I have a <code>go-micro</code> server file called <code>main.go</code> with the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n\n    \"github.com/micro/go-micro\"\n    \"github.com/micro/go-micro/server\"\n\n    proto \"mypkg/proto\"\n)\n\nconst serviceName = \"SRV\"\n\nfunc main() {\n    service := micro.NewService(\n        micro.Name(strings.ToLower(serviceName)),\n        micro.Server(\n            server.NewServer(\n                server.Name(strings.ToLower(serviceName))\n            ),\n        ),\n    )\n\n    service.Init()\n\n    if err := proto.RegisterSRVServiceHandler(service.Server(), new(SRVService)); err != nil {\n        panic(err)\n    }\n\n    if err := service.Run(); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><strong>SRVService</strong> is in another file called <code>srv_service.go</code> (with the same package name) and I don't know how to import it:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    proto \"mypkg/proto\"\n)\n\ntype SRVService struct{}\n\nfunc (g *SRVService) AddUser(ctx context.Context, req *proto.AddUserRequest, rsp *proto.AddUserResponse) error {\n    rsp.UserId = \"12312331231\"\n    return nil\n}\n</code></pre>\n\n<p>How should I access <code>SRVService</code> in <code>main.go</code>?</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1564402654, "post_id": 57253605, "comment_id": 101007096, "body": "This is not possible in Go. If you need to know about who embeds a value, you must maintain that value yourself (e.g. the embedded value must have a parent field)."}, {"owner": {"reputation": 41, "user_id": 11824919, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tjTIuT5LaZI/AAAAAAAAAAI/AAAAAAAAAAc/G7jK39pptcc/photo.jpg?sz=128", "display_name": "A\u015btar Sheran", "link": "https://stackoverflow.com/users/11824919/a%c5%9btar-sheran"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1564402939, "post_id": 57253605, "comment_id": 101007247, "body": "Ok, then I&#39;ll have to go with some other solution. Thank you for super-fast response and linking to similar question"}], "owner": {"reputation": 41, "user_id": 11824919, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tjTIuT5LaZI/AAAAAAAAAAI/AAAAAAAAAAc/G7jK39pptcc/photo.jpg?sz=128", "display_name": "A\u015btar Sheran", "link": "https://stackoverflow.com/users/11824919/a%c5%9btar-sheran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "closed_date": 1564402414, "answer_count": 0, "score": 0, "last_activity_date": 1564402211, "creation_date": 1564402211, "question_id": 57253605, "link": "https://stackoverflow.com/questions/57253605/is-there-a-way-to-read-top-level-struct-type-using-method-defined-in-embedded-st", "closed_reason": "Duplicate", "title": "Is there a way to read top-level struct type using method defined in embedded struct?", "body": "<p>To satisfy some interface, I need to add a method to every object, kind of like adding trait in object oriented languages. </p>\n\n<p>The plan is to create <em>base struct</em> with such method and to embed it into other structs, which are sometimes embedded to another structs and so on.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype BaseStruct struct {\n}\n\nfunc (this BaseStruct) InterfaceMethod() {\n    str := reflect.TypeOf(this).String()\n    fmt.Println(fmt.Sprintf(\"%s\", str))\n}\n\ntype StructA struct {\n    BaseStruct\n}\n\nfunc main() {\n    baseStruct := BaseStruct{}\n    structA := StructA{}\n\n    baseStruct.InterfaceMethod()\n    structA.InterfaceMethod()\n\n}\n</code></pre>\n\n<p>Current output:</p>\n\n<pre><code>main.BaseStruct\nmain.BaseStruct\n</code></pre>\n\n<p>Desired output:</p>\n\n<pre><code>main.BaseStruct\nmain.StructA \n</code></pre>\n\n<p>Is there any way to check if struct is embedded in other struct, traverse through them up the top and read top-level struct name?</p>\n\n<p>Go playground link:\n<a href=\"https://play.golang.org/p/794lneEtByS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/794lneEtByS</a></p>\n"}, {"tags": ["mysql", "sql", "database", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1564403650, "post_id": 57252655, "comment_id": 101007633, "body": "Your example code and your question are out of sync because Go does not allow declaring methods on imported types, so the code you are showing can <i>not</i> possibly compile nor run, and therefore cannot possibly create any kind of connection to anything."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1564410310, "post_id": 57252655, "comment_id": 101011367, "body": "sql.DB represents a connection pool. It&#39;s not surprising at all that the exec methods create new connections. Use transactions if you want to guarantee that queries execute on the same connection."}, {"owner": {"reputation": 17, "user_id": 10144687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86473e93198ba5dc37332b2c0f247af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Sharma", "link": "https://stackoverflow.com/users/10144687/ishan-sharma"}, "edited": false, "score": 0, "creation_date": 1564463100, "post_id": 57252655, "comment_id": 101028009, "body": "I had written it wrongly but now I have corrected it"}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 10144687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86473e93198ba5dc37332b2c0f247af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Sharma", "link": "https://stackoverflow.com/users/10144687/ishan-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1564463430, "creation_date": 1564463430, "answer_id": 57264668, "question_id": 57252655, "link": "https://stackoverflow.com/questions/57252655/db-querycontextctx-query-args-is-making-new-connection-for-same-db-variable/57264668#57264668", "title": "db.QueryContext(ctx, query, args) is making new connection for same db variable", "body": "<p>So what was happening is I was doing </p>\n\n<pre><code>A(){\n    rows, _ := db.ExecContext()\n    defer rows.close()\n\n    for rows.Next(){\n\n        B()\n\n    }\n}\n</code></pre>\n\n<p>So this B() was called before the defer could close  that previous connection made by \"ExecContext\" and started making new connections.\nI had to call B() in a separate loop after all the rows are fetched.</p>\n"}], "owner": {"reputation": 17, "user_id": 10144687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86473e93198ba5dc37332b2c0f247af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Sharma", "link": "https://stackoverflow.com/users/10144687/ishan-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564463430, "creation_date": 1564398885, "last_edit_date": 1564463065, "question_id": 57252655, "link": "https://stackoverflow.com/questions/57252655/db-querycontextctx-query-args-is-making-new-connection-for-same-db-variable", "title": "db.QueryContext(ctx, query, args) is making new connection for same db variable", "body": "<p>I am using a variable <code>\"db *sql.DB\"</code> on which I have defined 2 methods <code>A()</code> and <code>B()</code>. <code>B()</code> is called inside <code>A()</code> with same <code>\"db\"</code> variable used to call <code>A()</code>.\n(--CHECK CODE--)\nNow the <code>db.ExecContext()</code> func is creating a new DB connection in <code>B()</code> even though the same variable is passed into <code>B()</code>.\nIt should have used same connection made in its call in <code>A()</code>.\nPlease tell a solution..</p>\n\n<pre><code>type caller struct{\n    db *sql.DB\n}\nfunc (caller) A(){\n    db.ExecContext()\n    db.B()\n}\n\nfunc (caller) B(){\n    db.ExecContext()\n}\n</code></pre>\n"}, {"tags": ["go", "io", "system-calls", "unix-socket"], "answers": [{"comments": [{"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1609028269, "post_id": 57254806, "comment_id": 115734016, "body": "Net? What about files? I need to write multiple pieces of data with <code>writev()</code> syscall to disk"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1564406477, "creation_date": 1564406477, "answer_id": 57254806, "question_id": 57252423, "link": "https://stackoverflow.com/questions/57252423/go-support-for-scatter-gather-io-operations/57254806#57254806", "title": "Go support for Scatter-Gather IO operations", "body": "<p>Use <a href=\"https://godoc.org/net#Buffers\" rel=\"nofollow noreferrer\">net.Buffers</a> for optimized batch write using <code>writev</code> or similar.</p>\n\n<p>For read, slurp the data up into a single buffer and <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">slice</a> the buffer as needed.</p>\n"}], "owner": {"reputation": 97, "user_id": 3267749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4948c4a158e29762bbf2b7a883ed29e1?s=128&d=identicon&r=PG&f=1", "display_name": "kfertakis", "link": "https://stackoverflow.com/users/3267749/kfertakis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 57254806, "answer_count": 1, "score": 1, "last_activity_date": 1564406477, "creation_date": 1564398007, "question_id": 57252423, "link": "https://stackoverflow.com/questions/57252423/go-support-for-scatter-gather-io-operations", "title": "Go support for Scatter-Gather IO operations", "body": "<p>I want to develop a high-performance client-server communication protocol over Unix Domain Sockets in Go. Specifically, I was thinking of employing Vector-IO operations (writev/readv system calls) in order to avoid the overhead of structured data serialization. However, I think Go doesn't fully support the use of scatter-gather io operations. I have found some attempts in providing Go support for writev operations but not readv. Is there a way to implement this in Go and/or what would the alternative be performance-wise?</p>\n"}, {"tags": ["mongodb", "go", "memory-leaks", "bulkinsert"], "comments": [{"owner": {"reputation": 1041, "user_id": 2660313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7f4cadd6658af696e1d975eda49c49?s=128&d=identicon&r=PG", "display_name": "owlwalks", "link": "https://stackoverflow.com/users/2660313/owlwalks"}, "edited": false, "score": 1, "creation_date": 1564386450, "post_id": 57248864, "comment_id": 100998716, "body": "Can u share the code? Could be go runtime dynamic stack grows or goroutine heap alloc"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1564389892, "post_id": 57248864, "comment_id": 101000370, "body": "do you configure the slice capacity ?"}, {"owner": {"reputation": 31, "user_id": 7554036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b370d930b337d1cb6d643b50cd6ca454?s=128&d=identicon&r=PG&f=1", "display_name": "Siddhant Sharma", "link": "https://stackoverflow.com/users/7554036/siddhant-sharma"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1564390441, "post_id": 57248864, "comment_id": 101000666, "body": "@mh-cbon a new slice is allocated each time we try to save the data to DB. You can refer to the code above."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1564407024, "post_id": 57248864, "comment_id": 101009561, "body": "@mh-cbon read the code again - it&#39;s all new slices for each 1000 row batch, so unless you can point out some other place where a slice might be growing unbounded, I don&#39;t see how that&#39;s relevant."}], "answers": [{"tags": [], "owner": {"reputation": 1041, "user_id": 2660313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7f4cadd6658af696e1d975eda49c49?s=128&d=identicon&r=PG", "display_name": "owlwalks", "link": "https://stackoverflow.com/users/2660313/owlwalks"}, "is_accepted": false, "score": 0, "last_activity_date": 1564409680, "creation_date": 1564409680, "answer_id": 57255707, "question_id": 57248864, "link": "https://stackoverflow.com/questions/57248864/mongodb-bulkwrite-memory-cost/57255707#57255707", "title": "MongoDB BulkWrite Memory Cost", "body": "<p>below are <a href=\"https://github.com/golang/go/wiki/SliceTricks#copy\" rel=\"nofollow noreferrer\">copy</a> in disguise:</p>\n\n<pre><code>    if len(insert) &gt; 0 {\n        writes = append(writes, m.getInsertWrites(insert)...)\n    }\n    if len(update) &gt; 0 {\n        writes = append(writes, m.getUpdateWrites(update)...)\n    }\n    if len(delete) &gt; 0 {\n        writes = append(writes, m.getDeleteWrites(delete)...)\n    }\n</code></pre>\n\n<p>Very low hanging fruit: remove those lines above, change BulkWrite to accept <code>writes</code> as <code>interface{}</code> so that you can reuse <strong>the same backing array</strong>, that should save you some memory.</p>\n"}], "owner": {"reputation": 31, "user_id": 7554036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b370d930b337d1cb6d643b50cd6ca454?s=128&d=identicon&r=PG&f=1", "display_name": "Siddhant Sharma", "link": "https://stackoverflow.com/users/7554036/siddhant-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1564409680, "creation_date": 1564384763, "last_edit_date": 1564395417, "question_id": 57248864, "link": "https://stackoverflow.com/questions/57248864/mongodb-bulkwrite-memory-cost", "title": "MongoDB BulkWrite Memory Cost", "body": "<p>I'm using the official <code>mongodb</code> driver for Go. I take a CSV and read it line by line till I reach 1000 lines, I then parse the data and insert it into the db. I assumed it'd take a constant memory as the data that goes to bulk write is always the same (1000 contacts). However, that is not the case as the memory increases significantly. Here's some data regarding the above query:</p>\n\n<pre><code>batchSize = 1000\n\nContacts - Memory consumed by bulkwrite\n10k - 14 MB\n20K - 30MB\n30K - 59MB\n40K - 137 MB\n50K -241 MB\n</code></pre>\n\n<p>Can anyone explain why?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>func (c *csvProcessor) processCSV(r io.Reader, headerMap map[string]int, emailDB *mongo.Database) error {\n    //some code...\n    csvReader := csv.NewReader(r)\n    for {\n        eofReached, err := c.processCSVBatch(csvReader, emailHash, smsHash, headerMap, emailDB)\n        if err != nil {\n            return errors.Wrap(err, \"process CSV batch\")\n        }\n        if eofReached {\n            break\n        }\n    }\n    return nil\n}\n\nfunc (c *csvProcessor) processCSVBatch(csvReader *csv.Reader, emailHash map[string]*userData, smsHash map[string]*userData, headerMap map[string]int, emailDB *mongo.Database) (bool, error) {\n    var insertUsers, updateUsers, deleteUsers []interface{}\n    var isEOFReached bool\n    for i := 0; i &lt; processCSVBatchSize; i++ {\n        line, err := csvReader.Read()\n        if err != nil {\n            if err != io.EOF {\n                return false, errors.Wrap(err, \"read from input\")\n            }\n            isEOFReached = true\n            break\n        }\n        //some code\n        insert, update, delete := c.dataMerger.mergeData(\n            c.parseUser(line, headerMap),\n            emailHash[stringToMD5(line[headerMap[\"email\"]])],\n            smsHashVal,\n        )\n        if insert != nil {\n            insertUsers = append(insertUsers, insert)\n        }\n        if update != nil {\n            updateUsers = append(updateUsers, update)\n        }\n        if delete != nil {\n            deleteUsers = append(deleteUsers, delete)\n        }\n    }\n    //update DB\n    err := c.mongoDBUserHandler.saveUsers(emailDB, insertUsers, updateUsers, deleteUsers)\n    if err != nil {\n        return false, errors.Wrap(err, \"save users\")\n    }\n    return isEOFReached, nil\n}\n\nfunc (m *mongoDBUserHandler) saveUsers(emailDB *mongo.Database, insert, update, delete []interface{}) error {\n    ctx := context.Background()\n    // create the slice of write models\n    var writes []mongo.WriteModel\n    if len(insert) &gt; 0 {\n        writes = append(writes, m.getInsertWrites(insert)...)\n    }\n    if len(update) &gt; 0 {\n        writes = append(writes, m.getUpdateWrites(update)...)\n    }\n    if len(delete) &gt; 0 {\n        writes = append(writes, m.getDeleteWrites(delete)...)\n    }\n    if len(writes) == 0 {\n        return nil\n    }\n    // run bulk write\n    _, err := emailDB.\n        Collection(userCollection).\n        BulkWrite(ctx, writes, options.BulkWrite().SetOrdered(false))\n    if err != nil {\n        return errors.Wrap(err, \"bulk write\")\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": ["html", "css", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1564384042, "post_id": 57248461, "comment_id": 100997544, "body": "So what is the problem? What output are you hoping for?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564384067, "post_id": 57248461, "comment_id": 100997555, "body": "Questions seeking debugging help must also include the relevant code."}, {"owner": {"reputation": 126, "user_id": 3266376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SzX0u.png?s=128&g=1", "display_name": "ywwy", "link": "https://stackoverflow.com/users/3266376/ywwy"}, "edited": false, "score": 1, "creation_date": 1564384802, "post_id": 57248461, "comment_id": 100997891, "body": "Please show us in code where and how you used html.Unescape()."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1564392877, "post_id": 57248461, "comment_id": 101001932, "body": "i recently used this lib to manipulate html markups <a href=\"https://github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">github.com/PuerkitoBio/goquery</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1564407240, "post_id": 57248461, "comment_id": 101009677, "body": "<a href=\"https://github.com/microcosm-cc/bluemonday\" rel=\"nofollow noreferrer\">bluemonday</a> can also be used to strip HTML tags."}], "answers": [{"tags": [], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "is_accepted": false, "score": 0, "last_activity_date": 1564500567, "last_edit_date": 1564500567, "creation_date": 1564416818, "answer_id": 57257711, "question_id": 57248461, "link": "https://stackoverflow.com/questions/57248461/how-to-unescape-css/57257711#57257711", "title": "How to unescape CSS", "body": "<p>This seems simple but requires you to do 3 things:</p>\n\n<ol>\n<li>Strip all HTML tags like <code>&lt;p&gt;</code> and <code>&lt;style type=\"text/css\"&gt;</code></li>\n<li>Unescape HTML entities like <code>&amp;nbsp;</code></li>\n<li>Replace newlines, multiple spaces, and non-breaking spaces (<code>U+00A0</code>) with single spaces</li>\n</ol>\n\n<p>You can do this with the following with <a href=\"https://github.com/microcosm-cc/bluemonday\" rel=\"nofollow noreferrer\"><code>github.com/microcosm-cc/bluemonday</code></a>, <code>html</code> and <code>strings</code>:</p>\n\n<pre><code>// Your input text\ninput := `&lt;p&gt;ABC&amp;nbsp;&amp;nbsp;| Min. XYZ&amp;nbsp;\n&lt;style type=\"text/css\"&gt;&lt;!--td {border: 1px solid #ccc;}br {mso-data-placement:same-cell;}--&gt;\n&lt;/style&gt;\n&lt;span data-sheets-userformat=\"{&amp;quot;2&amp;quot;:3011,&amp;quot;3&amp;quot;:{&amp;quot;1&amp;quot;:0},&amp;quot;4&amp;quot;:[null,2,16777215],&amp;quot;9&amp;quot;:1,&amp;quot;10&amp;quot;:1,&amp;quot;11&amp;quot;:4,&amp;quot;12&amp;quot;:0,&amp;quot;14&amp;quot;:[null,2,0]}\" data-sheets-value=\"{&amp;quot;1&amp;quot;:2,&amp;quot;2&amp;quot;:&amp;quot;PQR&amp;quot;}\" style=\"font-size: 10pt; font-family: Arial; color: rgb(0, 0, 0); text-align: center;\"&gt;PQR&lt;/span&gt;&lt;/p&gt;`\n\n// Strip all HTML tags\np := bluemonday.StrictPolicy()\n\noutput := p.Sanitize(input)\n\n// Unescape HTML entities\noutput = html.UnescapeString(output)\n\n// Condense whitespace\noutput = strings.Join(strings.Fields(strings.TrimSpace(output)), \" \")\n</code></pre>\n\n<p>output is now <code>ABC | Min. XYZ PQR</code></p>\n\n<p>For the last step, using <code>strings.Fields</code> looks cleaner than using a regexp since <code>\\s</code> doesn't cover non-breaking spaces (<code>U+00A0</code>) and thus requires the following:</p>\n\n<pre><code>// Leading and trailing spaces\noutput = regexp.MustCompile(`^[\\s\\p{Zs}]+|[\\s\\p{Zs}]+$`).ReplaceAllString(output, \"\")\n// middle spaces\noutput = regexp.MustCompile(`[\\s\\p{Zs}]{2,}`).ReplaceAllString(output, \" \")\n</code></pre>\n\n<p>See more on matching whitespace here: <a href=\"https://stackoverflow.com/questions/37290693/how-to-remove-redundant-spaces-whitespace-from-a-string-in-golang\">How to remove redundant spaces/whitespace from a string in Golang?</a></p>\n\n<p>Finally, you can combine the above into a function as follows in <a href=\"https://github.com/grokify/gotilla/blob/master/html/htmlutil/htmlutil.go\" rel=\"nofollow noreferrer\"><code>github.com/grokify/gotilla/html/htmlutil</code></a></p>\n\n<pre><code>var bluemondayStrictPolicy = bluemonday.StrictPolicy()\n\nfunc HTMLToTextCondensed(s string) string {\n    return strings.Join(\n        strings.Fields(\n            strings.TrimSpace(\n                html.UnescapeString(\n                    bluemondayStrictPolicy.Sanitize(s),\n                ),\n            )),\n        \" \",\n    )\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5333976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f934515080261cab791c6866508ba7d?s=128&d=identicon&r=PG&f=1", "display_name": "Tushar Das", "link": "https://stackoverflow.com/users/5333976/tushar-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564500567, "creation_date": 1564382885, "last_edit_date": 1564383975, "question_id": 57248461, "link": "https://stackoverflow.com/questions/57248461/how-to-unescape-css", "title": "How to unescape CSS", "body": "<p>The text being stored in the database also includes the CSS styling.</p>\n\n<pre><code>&lt;p&gt;ABC&amp;nbsp;&amp;nbsp;| Min. XYZ&amp;nbsp;\n&lt;style type=\"text/css\"&gt;&lt;!--td {border: 1px solid #ccc;}br {mso-data-placement:same-cell;}--&gt;\n&lt;/style&gt;\n&lt;span data-sheets-userformat=\"{&amp;quot;2&amp;quot;:3011,&amp;quot;3&amp;quot;:{&amp;quot;1&amp;quot;:0},&amp;quot;4&amp;quot;:[null,2,16777215],&amp;quot;9&amp;quot;:1,&amp;quot;10&amp;quot;:1,&amp;quot;11&amp;quot;:4,&amp;quot;12&amp;quot;:0,&amp;quot;14&amp;quot;:[null,2,0]}\" data-sheets-value=\"{&amp;quot;1&amp;quot;:2,&amp;quot;2&amp;quot;:&amp;quot;PQR&amp;quot;}\" style=\"font-size: 10pt; font-family: Arial; color: rgb(0, 0, 0); text-align: center;\"&gt;PQR&lt;/span&gt;&lt;/p&gt;\n</code></pre>\n\n<p>To get rid of &amp;nbsp I have used html.Unescape() and it works perfectly fine.</p>\n\n<p>When fetched from database I want to display it in this format : <code>ABC | Min. XYZ PQR</code></p>\n\n<p>But the actual result (after using <code>html.Unescape()</code>) is : </p>\n\n<pre><code>ABC | Min. XYZ\n&lt;style type=\"text/css\"&gt;\n    &lt;!--td {border: 1px solid #ccc;}br {mso-data-placement:same-cell;}--&gt;\n&lt;/style&gt;\n&lt;span data-sheets-userformat=\"{&amp;quot;2&amp;quot;:3011,&amp;quot;3&amp;quot;:{&amp;quot;1&amp;quot;:0},&amp;quot;4&amp;quot;:[null,2,16777215],&amp;quot;9&amp;quot;:1,&amp;quot;10&amp;quot;:1,&amp;quot;11&amp;quot;:4,&amp;quot;12&amp;quot;:0,&amp;quot;14&amp;quot;:[null,2,0]}\" data-sheets-value=\"{&amp;quot;1&amp;quot;:2,&amp;quot;2&amp;quot;:&amp;quot;PQR&amp;quot;}\" style=\"font-size: 10pt; font-family: Arial; color: rgb(0, 0, 0); text-align: center;\"&gt;PQR&lt;/span&gt;&lt;/p&gt;\n</code></pre>\n"}, {"tags": ["go", "webserver"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1564382239, "post_id": 57248208, "comment_id": 100996802, "body": "You&#39;ll have to use <a href=\"https://golang.org/pkg/net/http/#StripPrefix\" rel=\"nofollow noreferrer\"><code>StripPrefix</code></a> since your index file lives in <code>&quot;.&#47;my-project&#47;dist&#47;&quot;</code> and not in <code>&quot;.&#47;my-project&#47;dist&#47;mypath&#47;&quot;</code>. Example: <a href=\"https://golang.org/pkg/net/http/#example_FileServer_stripPrefix\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#example_FileServer_stripPrefix</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1564387072, "post_id": 57248208, "comment_id": 100999012, "body": "Also see <a href=\"https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files/27946132#27946132\">Why do I need to use http.StripPrefix to access my static files?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 0, "last_activity_date": 1564382930, "creation_date": 1564382930, "answer_id": 57248469, "question_id": 57248208, "link": "https://stackoverflow.com/questions/57248208/how-to-serve-index-html-on-non-root-path-using-golang/57248469#57248469", "title": "How to serve index.html on non root path using golang", "body": "<p>Remove the <code>/</code> handler, and change the <code>/mypath/</code> handler into code below:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>http.Handle(\"/mypath/\", http.StripPrefix(\"/mypath/\", http.FileServer(http.Dir(\"./my-project/dist/\"))))\n</code></pre>\n\n<hr>\n\n<p>The <code>http.StripPrefix()</code> function is used to remove the prefix of requested path. On your current <code>/mypath</code> handler, every request will be prefixed with <code>/mypath/</code>. Take a look at example below.</p>\n\n<pre><code>/mypath/index.html\n/mypath/some/folder/style.css\n...\n</code></pre>\n\n<p>If the requested url path is not stripped, then (as per above example) it'll point into below respective locations, <strong>which is INVALID</strong> path and will result file not found error.</p>\n\n<pre><code>./my-project/dist/mypath/index.html\n./my-project/dist/mypath/some/folder/style.css\n...\n</code></pre>\n\n<p>By stripping the <code>/mypath</code>, it'll point into below locations, the correct one.</p>\n\n<pre><code>./my-project/dist/index.html\n./my-project/dist/some/folder/style.css\n...\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 10714010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1de8ea4503b597aab9c31e5654c197?s=128&d=identicon&r=PG&f=1", "display_name": "user10714010", "link": "https://stackoverflow.com/users/10714010/user10714010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564382930, "creation_date": 1564381640, "question_id": 57248208, "link": "https://stackoverflow.com/questions/57248208/how-to-serve-index-html-on-non-root-path-using-golang", "title": "How to serve index.html on non root path using golang", "body": "<p>I want to serve my angular app <code>index.html</code> under <code>localhost:3000/mypath/</code> is there a way to accomplish that?</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    // This works\n    http.Handle(\"/\", http.FileServer(http.Dir(\"./my-project/dist/\")))\n\n    // This doesn't work, you get 404 page not found\n    http.Handle(\"/mypath/\", http.FileServer(http.Dir(\"./my-project/dist/\")))\n    http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1564377075, "post_id": 57247394, "comment_id": 100995364, "body": "Thank you for your answer. In my case I decided to use such statement: <code>entry := &amp;Entry{}</code>."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1564376210, "creation_date": 1564376210, "answer_id": 57247394, "question_id": 57247355, "link": "https://stackoverflow.com/questions/57247355/how-to-correctly-scan-pq-arrays/57247394#57247394", "title": "How to correctly Scan pq arrays?", "body": "<p>The nil pointer dereference is on <code>entry</code>.  Fix by changing <code>entry</code> from a pointer to a value:</p>\n\n<pre><code>for rows.Next() {\n    var entry Entry  // &lt;--- change on this line\n    ... remaining code as in question\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1592, "user_id": 7251967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-al-If026iHU/AAAAAAAAAAI/AAAAAAAAABE/9lsheyH-V9Q/photo.jpg?sz=128", "display_name": "negi Yogi", "link": "https://stackoverflow.com/users/7251967/negi-yogi"}, "is_accepted": false, "score": -1, "last_activity_date": 1566286038, "last_edit_date": 1566286038, "creation_date": 1564385036, "answer_id": 57248954, "question_id": 57247355, "link": "https://stackoverflow.com/questions/57247355/how-to-correctly-scan-pq-arrays/57248954#57248954", "title": "How to correctly Scan pq arrays?", "body": "<p>It was panicking because of the these &amp;entry.OrganizationID, &amp;entry.FactorIDS, &amp;entry.CalculationValues. As entry is of pointer type and you haven't initialize the memory to it. If you want the  struct of pointer type you can initialize it like this:</p>\n\n<pre><code>for rows.Next() {\n    entry:=new(Entry)\n\n    if err = rows.Scan(&amp;entry.OrganizationID, &amp;entry.FactorIDS, &amp;entry.CalculationValues); err != nil {\n        utils.Logger().Println(err) // &lt;- RAISE ERROR\n        return\n    }\n\n    if entry.FactorIDS != nil {\n        for index, value := range factorID {\n            // some code here\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 57247394, "answer_count": 2, "score": 3, "last_activity_date": 1566303816, "creation_date": 1564375819, "last_edit_date": 1566303816, "question_id": 57247355, "link": "https://stackoverflow.com/questions/57247355/how-to-correctly-scan-pq-arrays", "title": "How to correctly Scan pq arrays?", "body": "<p>In a PostgreSQL database I have a table:</p>\n\n<pre><code>| ORGANIZATION_ID | FACTOR_IDS   | CALCULATION_VALUES  |\n|-----------------|--------------|---------------------|\n| 1               | {1,2,3,4,5}  | {0,66.66,50,100,80} |\n| 2               | NULL         | NULL                |\n| 1               | {6,7,8,9,10} | {0,77.77,60,110,90} |\n</code></pre>\n\n<p>In Go I make a query to that table and then try to use the <code>Scan</code> method. Unfortunately I get an error:</p>\n\n<pre><code>Trace: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>type Entry struct {\n    OrganizationID int\n    FactorIDS pq.Int64Array\n    CalculationValues pq.Float64Array\n}\n\nrows, err = database.DBGORM.Raw(`SELECT * FROM ANALYTICS`, ID).Rows()\n\nif err != nil {\n    utils.Logger().Println(err)\n    return\n}\n\ndefer rows.Close()\n\nfor rows.Next() {\n    var entry *Entry\n\n    if err = rows.Scan(&amp;entry.OrganizationID, &amp;entry.FactorIDS, &amp;entry.CalculationValues); err != nil {\n        utils.Logger().Println(err) // &lt;- RAISE ERROR\n        return\n    }\n\n    if entry.FactorIDS != nil {\n        for index, value := range factorID {\n            // some code here\n        }\n    }\n}\n</code></pre>\n\n<p>How can I fix this problem?</p>\n\n<p>Also if I change the type from <code>pq.Int64Array</code> to <code>*pq.Int64Array</code> the Go compiler gives the error: <code>Cannot range over data *pq.Int64Array</code> for the code above.</p>\n"}, {"tags": ["http", "go", "curl", "postman"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1564371671, "post_id": 57246852, "comment_id": 100994373, "body": "Re context. Pass r.Context() to any subtask e.g. SQL query; http/gRPC call etc. - and that will chain context cancelation per design. The sub tasks will chain a cancellation error as a result. If you want to poll the request context in your own code e.g. a wait-loop then use <code>select</code> on the context channel along with your wait-timer channel."}, {"owner": {"reputation": 1408, "user_id": 7658313, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d71486222cefe1935ac81e02fc0f2f51?s=128&d=identicon&r=PG", "display_name": "lnshi", "link": "https://stackoverflow.com/users/7658313/lnshi"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1564372321, "post_id": 57246852, "comment_id": 100994475, "body": "@colminator thanks for the reply, i understood that, above code is just build for reproducing the problem i encountered: i am NOT able to capture the cancellation signal in the POST request case."}], "answers": [{"comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1564374431, "post_id": 57247158, "comment_id": 100994815, "body": "I tried to find any notes about this on go doc, but I found nothing, yet it does solve OP&#39;s problem. do you have a link or documentation related to this one?"}, {"owner": {"reputation": 1408, "user_id": 7658313, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d71486222cefe1935ac81e02fc0f2f51?s=128&d=identicon&r=PG", "display_name": "lnshi", "link": "https://stackoverflow.com/users/7658313/lnshi"}, "edited": false, "score": 0, "creation_date": 1564374780, "post_id": 57247158, "comment_id": 100994889, "body": "ah, ic, excellent \ud83d\udc4d\ud83d\udc4d\ud83d\udc4d, spent me two three hours to try to understand this behaviour!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1564375439, "post_id": 57247158, "comment_id": 100994992, "body": "I do not know of any documentation for this. The behaviour follows from the fact that read or write is the only way to detect a closed connection in Go."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1564373944, "creation_date": 1564373944, "answer_id": 57247158, "question_id": 57246852, "link": "https://stackoverflow.com/questions/57246852/go-http-context-not-able-to-capture-cancellation-signal-when-request-has-body-c/57247158#57247158", "title": "Go http context not able to capture cancellation signal when request has body (curl, postman)", "body": "<p>Read the request body to detect when the client closes the connection:</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    go func(done &lt;-chan struct{}) {\n        &lt;-done\n        fmt.Println(\"message\", \"client connection has gone away, request got cancelled\")\n    }(r.Context().Done())\n\n    io.Copy(ioutil.Discard, r.Body) // &lt;-- read the body\n    time.Sleep(30 * time.Second)\n    fmt.Fprintf(w, \"Hi there, I love %s!\\n\", r.URL.Path[1:])\n}\n</code></pre>\n\n<p>The net/http server checks for closed connections by reading the connection.  No reads are started until the application starts reading the request body (if any).</p>\n"}], "owner": {"reputation": 1408, "user_id": 7658313, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d71486222cefe1935ac81e02fc0f2f51?s=128&d=identicon&r=PG", "display_name": "lnshi", "link": "https://stackoverflow.com/users/7658313/lnshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 2, "accepted_answer_id": 57247158, "answer_count": 1, "score": 2, "last_activity_date": 1564373944, "creation_date": 1564370671, "question_id": 57246852, "link": "https://stackoverflow.com/questions/57246852/go-http-context-not-able-to-capture-cancellation-signal-when-request-has-body-c", "title": "Go http context not able to capture cancellation signal when request has body (curl, postman)", "body": "<p>The problem can be reproduced with the below simple go code snippet\uff1a</p>\n\n<p>Simple go http server:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    go func(done &lt;-chan struct{}) {\n        &lt;-done\n        fmt.Println(\"message\", \"client connection has gone away, request got cancelled\")\n    }(r.Context().Done())\n\n    time.Sleep(30 * time.Second)\n    fmt.Fprintf(w, \"Hi there, I love %s!\\n\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>Start above http server, if i send one simple <code>GET</code> request with curl(postman also) like:</p>\n\n<pre><code>curl -X GET http://localhost:8080/\n</code></pre>\n\n<p>then press <code>Ctrl+C</code> to terminate the request, then i am able to see the printed message at server side:</p>\n\n<pre><code>message client connection has gone away, request got cancelled\n</code></pre>\n\n<p><strong>above is the correct behaviour i expect</strong>: to simulate the situation that when client is gone the server can capture it and then cancel all the unnecessary work as early as it can.</p>\n\n<p>But when i send one POST request with request body, this expected behaviour <strong>doesn't</strong> happen, the <code>&lt;-done</code> signal was captured until the request deadline meet.</p>\n\n<pre><code>curl -X POST http://localhost:8080/ -H 'Content-Type: application/json' -d '{}'\n</code></pre>\n\n<p>To summarize my questions:</p>\n\n<ol>\n<li>Why and how the curl(postman) <code>GET</code>, <code>POST</code> (with or without request body) request make such a difference?</li>\n<li>How should i handle this case properly with go context package, i mean to capture the client is gone signal as soon as it can, and so further to cancel the server side unnecessary work to release the resources as early as it can.</li>\n</ol>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 99, "user_id": 11847127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f8a2069db6a4b7cb19863e46a76af?s=128&d=identicon&r=PG&f=1", "display_name": "sat1017", "link": "https://stackoverflow.com/users/11847127/sat1017"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1564363919, "post_id": 57246203, "comment_id": 100993229, "body": "Could you explain? I am following a tutorial so this code isn&#39;t my original. Also, I didn&#39;t get any errors."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1564364094, "post_id": 57246203, "comment_id": 100993257, "body": "It&#39;s not obvious what surprises you. It takes some time because you need to send an http request and get a response back."}, {"owner": {"reputation": 99, "user_id": 11847127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f8a2069db6a4b7cb19863e46a76af?s=128&d=identicon&r=PG&f=1", "display_name": "sat1017", "link": "https://stackoverflow.com/users/11847127/sat1017"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1564364734, "post_id": 57246203, "comment_id": 100993357, "body": "Any way to optimize this? I only make 2 get requests so I am afraid what will happen as I add code, more http requests, and scale. I understand its the client-side that is slow."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564365095, "post_id": 57246203, "comment_id": 100993407, "body": "The application makes 12 total requests.  The server is slow respond."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1564365475, "post_id": 57246203, "comment_id": 100993467, "body": "&quot;I understand its the client-side that is slow&quot; --- why do you think so?"}, {"owner": {"reputation": 99, "user_id": 11847127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f8a2069db6a4b7cb19863e46a76af?s=128&d=identicon&r=PG&f=1", "display_name": "sat1017", "link": "https://stackoverflow.com/users/11847127/sat1017"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564366226, "post_id": 57246203, "comment_id": 100993571, "body": "@CeriseLim&#243;n Ah you are right. I forgot the other sub-categories it parses through."}, {"owner": {"reputation": 99, "user_id": 11847127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f8a2069db6a4b7cb19863e46a76af?s=128&d=identicon&r=PG&f=1", "display_name": "sat1017", "link": "https://stackoverflow.com/users/11847127/sat1017"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1564366583, "post_id": 57246203, "comment_id": 100993627, "body": "@zerkms Maybe I don&#39;t but here is what I think is happening. Please correct me. The first http.Get loads the index.xml page and reads all the data as bytes. xml.Unmarshal converts those bytes into strings and then the Locations that match the xml:sitemap&gt;loc are saved to the slice of an array. So maybe the converting all the xml into bytes and then printing them to the screen is the choke point and not the 12 http.Get calls?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1564367221, "post_id": 57246203, "comment_id": 100993733, "body": "&quot;So maybe&quot; --- measure it."}, {"owner": {"reputation": 99, "user_id": 11847127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f8a2069db6a4b7cb19863e46a76af?s=128&d=identicon&r=PG&f=1", "display_name": "sat1017", "link": "https://stackoverflow.com/users/11847127/sat1017"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564367314, "post_id": 57246203, "comment_id": 100993751, "body": "Working on editing my code. Found a post from @CeriseLim&#243;n on how to time execute time. I like going down the rabbit hole of understanding how. Thanks for making me think."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564371502, "post_id": 57246203, "comment_id": 100994345, "body": "This program and curl are  slow compared to fetching the page using a browser.  The server may be throttling automated access to the site."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1564407370, "post_id": 57247420, "comment_id": 101009747, "body": "Load testing someone else&#39;s sites/services is bad form and can get your IP blocked, with good reason. Don&#39;t do it."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1564421402, "last_edit_date": 1564421402, "creation_date": 1564376415, "answer_id": 57247420, "question_id": 57246203, "link": "https://stackoverflow.com/questions/57246203/why-is-my-code-taking-so-long-to-return-results/57247420#57247420", "title": "Why is my code taking so long to return results?", "body": "<blockquote>\n  <p>Tips on how to troubleshoot this would be helpful.</p>\n</blockquote>\n\n<hr>\n\n<p>Start with the simple things, measuring one thing at a time, a scientific experiment.</p>\n\n<hr>\n\n<p>Use <code>curl</code> to measure basic response time.</p>\n\n<pre><code>$ curl https://www.google.com/robots.txt -o /dev/null\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  7246    0  7246    0     0  94103      0 --:--:-- --:--:-- --:--:-- 94103\n$ curl https://www.nytimes.com/robots.txt -o /dev/null\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   934  100   934    0     0     61      0  0:00:15  0:00:15 --:--:--   230\n$ curl https://www.washingtonpost.com/robots.txt -o /dev/null\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  3360  100  3360    0     0    133      0  0:00:25  0:00:25 --:--:--   869\n$\n</code></pre>\n\n<p>Google has no delay. The New York Times has a 15 second delay. The Washington Post has a 25 second delay.</p>\n\n<p>In Go, confirm that The Washington Post has a 25 second delay. </p>\n\n<pre><code>$ go run wapo.go\n25.174366651s\n$ cat wapo.go\npackage main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n    resp, err := http.Get(\"https://www.washingtonpost.com/news-sitemaps/index.xml\")\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    _, err = ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    resp.Body.Close()\n    fmt.Fprintln(os.Stderr, time.Since(start))\n}\n$\n</code></pre>\n\n<hr>\n\n<p>Next, try a different ISP from a different computer.</p>\n\n<pre><code>$ curl https://www.google.com/robots.txt -o /dev/null\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  7246    0  7246    0     0  27343      0 --:--:-- --:--:-- --:--:-- 27343\n$ curl https://www.nytimes.com/robots.txt -o /dev/null\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   934  100   934    0     0   2017      0 --:--:-- --:--:-- --:--:--  2017\n$ curl https://www.washingtonpost.com/robots.txt -o /dev/null\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  3360  100  3360    0     0    356      0  0:00:09  0:00:09 --:--:--   840\n$ curl https://www.washingtonpost.com/news-sitemaps/index.xml -o /dev/null\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  1101  100  1101    0     0    104      0  0:00:10  0:00:10 --:--:--   266\n$ \n\n$ go run wapo.go\n8.378458882s\n$ \n</code></pre>\n\n<p>Google has no delay. The New York Times has a small delay. The Washington Post has a 9 second delay.</p>\n\n<hr>\n\n<p>The Go code and compiler are the same:</p>\n\n<pre><code>$ go version\ngo version devel +a25c2878c7 Sat Jul 27 23:29:18 2019 +0000 linux/amd64\n$ cat wapo.go\npackage main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n    resp, err := http.Get(\"https://www.washingtonpost.com/news-sitemaps/index.xml\")\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    resp.Body.Close()\n    fmt.Fprintln(os.Stderr, time.Since(start))\n}\n$\n</code></pre>\n\n<p>Therefore, focus on network and site factors.</p>\n\n<hr>\n"}], "owner": {"reputation": 99, "user_id": 11847127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f8a2069db6a4b7cb19863e46a76af?s=128&d=identicon&r=PG&f=1", "display_name": "sat1017", "link": "https://stackoverflow.com/users/11847127/sat1017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "accepted_answer_id": 57247420, "answer_count": 1, "score": 0, "last_activity_date": 1564421402, "creation_date": 1564363212, "question_id": 57246203, "link": "https://stackoverflow.com/questions/57246203/why-is-my-code-taking-so-long-to-return-results", "title": "Why is my code taking so long to return results?", "body": "<p>When running this code I have to wait 10 seconds for s.Locations to print and 60+ seconds for n.Titles to print. What is causing this?</p>\n\n<p>Tips on how to troubleshoot this would be helpful i.e. seeing how long it takes for certain lines of code to complete. New to Go so not sure how to exactly do this. </p>\n\n<p>I've made sure I close my connections. Since everything else on my computer loads blazing fast I don't think to access the internet via http.Get should be slow.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"strings\"\n)\n\n// SitemapIndex is the root xml\ntype SitemapIndex struct {\n    Locations []string `xml:\"sitemap&gt;loc\"`\n}\n\n// News is the individual categories\ntype News struct {\n    Titles    []string `xml:\"url&gt;news&gt;title\"`\n    Keywords  []string `xml:\"url&gt;news&gt;keywords\"`\n    Locations []string `xml:\"url&gt;loc\"`\n}\n\n// NewsMap is the\ntype NewsMap struct {\n    Keywords string\n    Location string\n}\n\nfunc main() {\n    var s SitemapIndex\n    var n News\n    // np := make(map[string]NewsMap)\n    resp, _ := http.Get(\"https://www.washingtonpost.com/news-sitemaps/index.xml\")\n    bytes, _ := ioutil.ReadAll(resp.Body)\n    xml.Unmarshal(bytes, &amp;s)\n    resp.Body.Close()\n\n    for i := range s.Locations {\n        s.Locations[i] = strings.TrimSpace(s.Locations[i])\n    }\n\n    fmt.Println(s.Locations) // slice of data\n\n    for _, Location := range s.Locations {\n        resp, _ := http.Get(Location)\n        bytes, _ := ioutil.ReadAll(resp.Body)\n        xml.Unmarshal(bytes, &amp;n)\n        resp.Body.Close()\n    }\n\n    fmt.Println(n.Titles)\n}\n</code></pre>\n\n<p>I get the output but I have to wait 10 seconds for s.Locations and 60+ seconds for n.Titles</p>\n"}, {"tags": ["http", "go", "server"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1564351594, "post_id": 57245294, "comment_id": 100991240, "body": "The code you have here is not sufficient to diagnose the problem. Try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 54, "user_id": 9831564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc63ed4324c7ac999cf3486b1022e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Eskombro", "link": "https://stackoverflow.com/users/9831564/eskombro"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1564352689, "post_id": 57245294, "comment_id": 100991445, "body": "@JimB thanks, you are right. Turns out, while I was trying to create a  minimal reproducible example, I found out server was launched inside a goroutine, and that seems to be a problem. removed the &#39;go&#39; keyword before, and haven&#39;t had the bug again"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1564358636, "post_id": 57245430, "comment_id": 100992387, "body": "That should have no effect itself, it\u2019s something after that which must be the cause."}], "tags": [], "owner": {"reputation": 54, "user_id": 9831564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc63ed4324c7ac999cf3486b1022e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Eskombro", "link": "https://stackoverflow.com/users/9831564/eskombro"}, "is_accepted": false, "score": -1, "last_activity_date": 1564352886, "creation_date": 1564352886, "answer_id": 57245430, "question_id": 57245294, "link": "https://stackoverflow.com/questions/57245294/why-do-this-go-http-server-stop-responding-after-several-requests/57245430#57245430", "title": "Why do this go http server stop responding after several requests?", "body": "<p>The call to start server was done as a go routine call:</p>\n\n<pre><code>go StartServer()\n</code></pre>\n\n<p>Removing that seems to fix the problem, but why would that be a problem anyway? (Asuming the routine doesn't hit its last instruction, of course)</p>\n"}], "owner": {"reputation": 54, "user_id": 9831564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc63ed4324c7ac999cf3486b1022e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Eskombro", "link": "https://stackoverflow.com/users/9831564/eskombro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564358343, "creation_date": 1564351417, "last_edit_date": 1564358343, "question_id": 57245294, "link": "https://stackoverflow.com/questions/57245294/why-do-this-go-http-server-stop-responding-after-several-requests", "title": "Why do this go http server stop responding after several requests?", "body": "<p>I'm building a Go http server which listens to port 4242. Every request triggers a function of my program. Everything works fine, but after 30/40 requests, It just stops answering.</p>\n\n<p>I Already run the whole program without server (interacting with it via stdin/stdout) and there is no problem or bug. Problem comes only when I trigger it from http requests.</p>\n\n<p>Also, when I add some workload in those functions, I run into the bug faster. I was suspecting a memory problem, but then again, if there is no server, there is no bug.</p>\n\n<p>Server doens't crash, and there is no error message. My function code actually stops being executed at a random line (tried debugging the code and saw that the routine actually stops going through my code and stops at a random place every time)</p>\n\n<pre><code>package server\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"strconv\"\n    \"time\"\n\n    \"github.com/gogogomoku/gomoku/internal/brain\"\n    \"github.com/gorilla/mux\"\n)\n\ntype SimpleResponse struct {\n    ResCode int    `json:\"code\" xml:\"code\"`\n    Message string `json:\"message\" xml:\"message\"`\n}\n\nfunc home(w http.ResponseWriter, r *http.Request) {\n    // ..\n}\n\nfunc startGame(w http.ResponseWriter, r *http.Request) {\n    // ..\n}\n\nfunc restartGame(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"Request\")\n    fmt.Println(r)\n    InitializeValues()\n    StartRound()\n    json.NewEncoder(w).Encode(GameRound)\n    fmt.Println(\"Response\")\n    fmt.Println(w)\n}\n\nfunc MakeMove(w http.ResponseWriter, r *http.Request) {\n    // ...\n}\n\nfunc StartServer() {\n    router := mux.NewRouter().StrictSlash(true)\n    router.Use(commonMiddleware)\n    router.HandleFunc(\"/\", home)\n    router.HandleFunc(\"/start\", startGame)\n    router.HandleFunc(\"/restart\", restartGame)\n    router.HandleFunc(\"/move/{pos}/id/{id}\", MakeMove)\n    logger := log.New(os.Stdout, \"http: \", log.LstdFlags)\n    logger.Println(\"Server is starting...\")\n    srv := &amp;http.Server{\n        Handler:      router,\n        Addr:         \"localhost:4242\",\n        WriteTimeout: 5 * time.Second,\n        ReadTimeout:  10 * time.Second,\n        IdleTimeout:  15 * time.Second,\n        ErrorLog:     logger,\n    }\n    if err := srv.ListenAndServe(); err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n\nfunc commonMiddleware(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n        w.Header().Add(\"Content-Type\", \"application/json\")\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>For example, if I do http requests on <a href=\"http://localhost:4242/restart\" rel=\"nofollow noreferrer\">http://localhost:4242/restart</a> they work fine and I get the json. After 30/35 requests, server seems to freeze, and I get no response, no crash, no message, anything.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 11853614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hRRQb.jpg?s=128&g=1", "display_name": "Dave Johnson", "link": "https://stackoverflow.com/users/11853614/dave-johnson"}, "is_accepted": true, "score": 0, "last_activity_date": 1564436502, "last_edit_date": 1564436502, "creation_date": 1564433744, "answer_id": 57261270, "question_id": 57245129, "link": "https://stackoverflow.com/questions/57245129/cant-set-up-has-many-association-in-gorm/57261270#57261270", "title": "Can&#39;t set up has-many association in GORM", "body": "<p>I'll have to Check <code>Related()</code> when I get home, but I think what you're looking for is <code>Preload()</code> This is my example that works with what you want. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/mysql\"\n    \"log\"\n)\n\nvar DB *gorm.DB\n\nfunc init() {\n    var err error\n\n    DB, err = gorm.Open(\"mysql\", fmt.Sprintf(\"%s:%s@tcp(%s:3306)/%s?&amp;parseTime=True&amp;loc=Local\", \"root\", \"root\", \"localhost\", \"testing\"))\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    DB.DropTableIfExists(&amp;User{}, &amp;PredictionsBag{})\n    DB.AutoMigrate(&amp;User{}, &amp;PredictionsBag{})\n    user := User{Email:\"dave@example.com\"}\n    user.Bags = append(user.Bags, PredictionsBag{OwnerID: user.ID, NotesPrivate: \"1\", NotesPublic: \"1\"})\n    DB.Create(&amp;user)\n}\n\nfunc main()  {\n\n    user := User{Email:\"dave@example.com\"}\n    err := user.ByEmail()\n    if err != nil {\n        log.Println(err)\n    }\n    fmt.Println(user.ID, user.Email, \"Bags:\", len(user.Bags))\n\n    DB.Close()\n}\n\n\ntype User struct {\n    gorm.Model\n    //  We\u2019ll try not using usernames for now\n\n    Email        string `gorm:\"not null;unique_index\"`\n    Password     string `gorm:\"-\"`\n    PasswordHash string `gorm:\"not null\"`\n    Remember     string `gorm:\"-\"` // A user\u2019s remember token.\n    RememberHash string `gorm:\"not null;unique_index\"`\n\n    Bags []PredictionsBag `gorm:\"foreignkey:OwnerID\"`\n}\n\ntype PredictionsBag struct {\n    gorm.Model\n    OwnerID uint\n\n    Title        string\n    NotesPublic  string `gorm:\"not null\"` // Markdown field. May be published.\n    NotesPrivate string `gorm:\"not null\"` // Markdown field. Only for (private) viewing and export.\n\n}\n\nfunc (ug *User) ByEmail() error {\n\n    DB.Where(\"email = ?\", ug.Email).Preload(\"Bags\").Limit(1).Find(&amp;ug)\n    if ug.ID == 0 {\n        return errors.New(\"no user found\")\n    }\n    return nil\n}\n\n</code></pre>\n\n<p>Using this might work with related, but I'm not sure what else needs to be changed:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    Bags []PredictionsBag `gorm:\"foreignkey:OwnerID;association_foreignkey:ID\"`\n\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>I can get the <code>Related()</code> method to work, if you state the ForeignKey like the following:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    DB.Where(\"email = ?\", ug.Email).Limit(1).Find(&amp;ug)\n    if ug.ID == 0 {\n        return errors.New(\"no user found\")\n    }\n    if err := DB.Model(&amp;ug).Related(&amp;ug.Bags, \"owner_id\").Error; err != nil {\n        return err\n    }\n\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 326457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee7e6929b3d680c589a590323735f3c8?s=128&d=identicon&r=PG", "display_name": "adiabatic", "link": "https://stackoverflow.com/users/326457/adiabatic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 57261270, "answer_count": 1, "score": 0, "last_activity_date": 1564436502, "creation_date": 1564349626, "question_id": 57245129, "link": "https://stackoverflow.com/questions/57245129/cant-set-up-has-many-association-in-gorm", "title": "Can&#39;t set up has-many association in GORM", "body": "<p>I'm trying to set up an association between <code>User</code>s and <code>PredictionsBag</code>s. My problem is that everything works OK if I use GORM's assumed names for referring objects, but I'd like to change the names a bit.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type User struct {\n    gorm.Model\n    //  We\u2019ll try not using usernames for now\n\n    Email        string `gorm:\"not null;unique_index\"`\n    Password     string `gorm:\"-\"`\n    PasswordHash string `gorm:\"not null\"`\n    Remember     string `gorm:\"-\"` // A user\u2019s remember token.\n    RememberHash string `gorm:\"not null;unique_index\"`\n\n    Bags []PredictionsBag\n}\n</code></pre>\n\n<p>Every user, of course, owns zero or more <code>PredictionsBag</code>s:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type PredictionsBag struct {\n    gorm.Model\n\n    UserID uint // I want this to be \"OwnerID\"\n\n    Title        string\n    NotesPublic  string `gorm:\"not null\"` // Markdown field. May be published.\n    NotesPrivate string `gorm:\"not null\"` // Markdown field. Only for (private) viewing and export.\n\n    Predictions []Prediction\n}\n</code></pre>\n\n<p>And I'd like to have <code>.Related()</code> work in the usual way:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (ug *userGorm) ByEmail(email string) (*User, error) {\n    var ret User\n\n    matchingEmail := ug.db.Where(\"email = ?\", email)\n\n    err := first(matchingEmail, &amp;ret)\n    if err != nil {\n        return nil, err\n    }\n\n    var bags []PredictionsBag\n    if err := ug.db.Model(&amp;ret).Related(&amp;bags).Error; err != nil {\n        return nil, err\n    }\n    ret.Bags = bags\n\n    return &amp;ret, nil\n}\n</code></pre>\n\n<p>My problem is that I can't find a way to change <code>PredictionsBag.UserID</code> to anything else and still have GORM figure out the relationships involved. I've been reading <a href=\"http://gorm.io/docs/has_many.html#Foreign-Key\" rel=\"nofollow noreferrer\">http://gorm.io/docs/has_many.html#Foreign-Key</a> and if I change the relevant lines to</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type User struct {\n    // \u2026\n    Bags []PredictionsBag `gorm:\"foreignkey:OwnerID\"`\n}\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type PredictionsBag struct {\n    // \u2026\n    OwnerID uint\n    // \u2026\n}\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>[2019-07-28 14:23:49]  invalid association [] \n</code></pre>\n\n<p>What am I doing wrong? I've also been reading <a href=\"http://gorm.io/docs/belongs_to.html\" rel=\"nofollow noreferrer\">http://gorm.io/docs/belongs_to.html</a>, but I'm not sure which page to follow more closely.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1564338328, "post_id": 57243794, "comment_id": 100988297, "body": "Delete the second line <code>}{</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1564338554, "post_id": 57243794, "comment_id": 100988349, "body": "And you can leave out the <code>&amp;</code> operator and the struct type when listing the elements\u2013it&#39;s known from the literal type."}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 2, "last_activity_date": 1564338546, "creation_date": 1564338546, "answer_id": 57243845, "question_id": 57243794, "link": "https://stackoverflow.com/questions/57243794/initiliazing-a-slice-of-structs-of-a-third-party-library/57243845#57243845", "title": "Initiliazing a slice of structs of a third party library", "body": "<p>You have an extra <code>}{</code> you shouldn't have, the code should look like this:</p>\n\n<pre><code>rr := []*gcp.ResourceRecordSet {\n    &amp;gcp.ResourceRecordSet{\n        Name:    \"example.gcp.com\",\n        Ttl:     21600,\n        Type:    \"NS\",\n        Rrdatas: []string{\"ns-cloud-c1.googledomains.com.\", \"ns-cloud-c2.googledomains.com.\", \"ns-cloud-c3.googledomains.com.\", \"ns-cloud-c4.googledomains.com.\"},\n    },\n    &amp;gcp.ResourceRecordSet{\n        Name:    \"example.gcp.com\",\n        Ttl:     21600,\n        Type:    \"NS\",\n        Rrdatas: []string{\"ns-cloud-c1.googledomains.com.\", \"ns-cloud-c2.googledomains.com.\", \"ns-cloud-c3.googledomains.com.\", \"ns-cloud-c4.googledomains.com.\"},\n    },\n}\n</code></pre>\n\n<p>You're creating a slice literal with elements that are (addresses of) struct literals.  A slice literal looks like:</p>\n\n<pre><code>rr := []TYPE{\n  element,\n  element,\n}\n</code></pre>\n\n<p>You instead had</p>\n\n<pre><code>rr := []TYPE{\n}{\n  element,\n  element,\n}\n</code></pre>\n"}], "owner": {"reputation": 659, "user_id": 6845084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253b377ee6c971f363de927136d30117?s=128&d=identicon&r=PG", "display_name": "Palash Nigam", "link": "https://stackoverflow.com/users/6845084/palash-nigam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 57243845, "answer_count": 1, "score": -2, "last_activity_date": 1564338546, "creation_date": 1564338117, "question_id": 57243794, "link": "https://stackoverflow.com/questions/57243794/initiliazing-a-slice-of-structs-of-a-third-party-library", "title": "Initiliazing a slice of structs of a third party library", "body": "<p>I want to initialize a slice of structs (the structs are of type <code>&amp;dns.ResourceRecordSet</code> ) where dns is the google cloud dns library. I am trying something like this</p>\n\n<pre><code>    rr := []*gcp.ResourceRecordSet {\n    }{\n        &amp;gcp.ResourceRecordSet{\n            Name:    \"example.gcp.com\",\n            Ttl:     21600,\n            Type:    \"NS\",\n            Rrdatas: []string{\"ns-cloud-c1.googledomains.com.\", \"ns-cloud-c2.googledomains.com.\", \"ns-cloud-c3.googledomains.com.\", \"ns-cloud-c4.googledomains.com.\"},\n        },\n        &amp;gcp.ResourceRecordSet{\n            Name:    \"example.gcp.com\",\n            Ttl:     21600,\n            Type:    \"NS\",\n            Rrdatas: []string{\"ns-cloud-c1.googledomains.com.\", \"ns-cloud-c2.googledomains.com.\", \"ns-cloud-c3.googledomains.com.\", \"ns-cloud-c4.googledomains.com.\"},\n        },\n    }\n</code></pre>\n\n<p>But I get an error saying <code>expected ';', found '{'</code> on the opening braces in the second line.</p>\n\n<p>What is the correct syntax?</p>\n"}, {"tags": ["c", "go"], "comments": [{"owner": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "edited": false, "score": 0, "creation_date": 1564337366, "post_id": 57243667, "comment_id": 100988040, "body": "Is copying the lib to the docker image not possible?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1564338141, "post_id": 57243667, "comment_id": 100988244, "body": "Do you have a copy of <code>librandom_c.a</code>?"}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "reply_to_user": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "edited": false, "score": 0, "creation_date": 1564352509, "post_id": 57243667, "comment_id": 100991411, "body": "@Nick not really, as I use <code>scratch</code> as docker image and it has literally nothing. Meaning there is no <code>LD_LIBRARY_PATH</code> concept etc... Even putting my lib here, the program will still try to find it using dynamic strategies that don&#39;t exist in <code>scratch</code>."}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1564352589, "post_id": 57243667, "comment_id": 100991426, "body": "@JL2210 I do have a copy of <code>librandom_c.a</code>, can this help in some way ?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1564352648, "post_id": 57243667, "comment_id": 100991439, "body": "@JonaRodrigues Place it in <code>&#47;usr&#47;local&#47;lib&#47;</code>."}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "edited": false, "score": 0, "creation_date": 1564353408, "post_id": 57243667, "comment_id": 100991572, "body": "I placed <code>librandom_c.a</code> into my <code>&#47;use&#47;local&#47;lib&#47;</code> and it now complains like crazy with a bunch of <code>undefined reference to &lt;some_random_function_here&gt;</code> and ends with <code>collect 2: error: ld returned 1 exit status</code>. Really I have no clue of what it means (I am not the author of the lib neither the go bindings to it)."}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "edited": false, "score": 0, "creation_date": 1564353824, "post_id": 57243667, "comment_id": 100991635, "body": "I don&#39;t know if that means my issue is &quot;solved&quot; and the issue is now on the go package side (maybe linking things incorrectly) or if that&#39;s a compiler Error... Muy doubt is maybe I should use some kind of magic flags in the <code>go build</code> to instruct go where to look. In fact, maybe my reasoning doesn&#39;t makes sense, but I assume that if <code>go run</code> works, there should be a way to tell <code>go build</code> to kinda sniff all dependencies found while using <code>go run</code> and include them. I have read a lot about this but I can&#39;t find the magic flags..."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1564358838, "post_id": 57243667, "comment_id": 100992418, "body": "If you run <code>ldd &#47;usr&#47;local&#47;lib&#47;librandom_c.so</code>, does it have other library dependencies?  (You intrinsically can&#39;t statically link to a dynamic-link library; the ordering of the C compiler <code>-l</code> options is extremely order-sensitive for static libraries.  You could also build a dynamically linked binary and use an <code>alpine</code> or <code>ubuntu</code> Docker base image with the infrastructure required to use it.)"}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "edited": false, "score": 0, "creation_date": 1564369428, "post_id": 57243667, "comment_id": 100994052, "body": "Yeah actually there are some 10 other libraries <code>librandom_c.so</code> depends on as I see using <code>ldd</code> (thanks by the way, I didn&#39;t know that command). I tried to use <code>alpine</code> but the library depends on <code>libgcc</code> and <code>ld-linux-x86-64.so.2</code> which are not supported by <code>musl</code> (compiler used by <code>alpine</code>)... Ubuntu + gcc would make the trick but then it would defeat the purpose of what I am trying to do which is create a standalone portable program. I am quite not sure of what you mean by &quot;you can&#39;t statically link to a dynamic-link library&quot; since I happen to see go programs doing it."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1570637324, "creation_date": 1570637324, "answer_id": 58308196, "question_id": 57243667, "link": "https://stackoverflow.com/questions/57243667/statically-link-shared-library-using-go-build/58308196#58308196", "title": "Statically link shared library using go build", "body": "<p><a href=\"https://github.com/golang/go/issues/26492\" rel=\"nofollow noreferrer\">CL 26492</a> shows that it might be as simple (possible for Go 1.14 Q1 2020, not confirmed yet) as to do:</p>\n\n<pre><code>go build -static\n</code></pre>\n\n<p>That would encapsulate the magic incantations of:</p>\n\n<ul>\n<li>windows: <code>-tags netgo -ldflags '-H=windowsgui -extldflags \"-static\"'</code></li>\n<li>linux/bsd: <code>-tags netgo -ldflags '-extldflags \"-static\"'</code></li>\n<li>macos: <code>-ldflags '-s -extldflags \"-sectcreate __TEXT __info_plist Info.plist\"'</code></li>\n<li>android: <code>-ldflags -s</code></li>\n</ul>\n"}], "owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1570637324, "creation_date": 1564337217, "last_edit_date": 1564577315, "question_id": 57243667, "link": "https://stackoverflow.com/questions/57243667/statically-link-shared-library-using-go-build", "title": "Statically link shared library using go build", "body": "<p>I need to create a static library to run it in a docker container. When running my code with <code>go run main.go</code> it just runs smoothly. However, things get complicated when I try to build my code as a <strong>static</strong> program (re-compile all dynamic dependencies into a standalone lib, including shared libraries).</p>\n\n<p>My app depends on a C shared library located in my <code>/usr/local/lib/librandom_c.so</code>, while my app source code is located in <code>$GOPATH/src/github.com/&lt;user&gt;/myapp</code>.</p>\n\n<p>When I build the app <strong>without</strong> trying to statically link the shared library, it works without complaining:</p>\n\n<pre><code>go build -a -o hello .\n</code></pre>\n\n<p>...but then docker complains that the shared library does not exist (using from scratch).</p>\n\n<p>So far I have tried many combinations to statically build my app:</p>\n\n<pre><code>go build -a -ldflags '-linkmode \"external\" -extldflags \"-static\"' -o hello .\n</code></pre>\n\n<p>gives an error:</p>\n\n<blockquote>\n  <p>cannot find -lrandom_c</p>\n</blockquote>\n\n<p>How do I statically link my lib?</p>\n"}, {"tags": ["debugging", "go"], "comments": [{"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "edited": false, "score": 0, "creation_date": 1564329130, "post_id": 57241766, "comment_id": 100986015, "body": "@kostix already gives the great answer, but it will be better if you post stack traces."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1564398037, "post_id": 57241766, "comment_id": 101004711, "body": "Ouch, this is exactly one of those unlikely cases where deep runtime innards panicked! Looks very close to <a href=\"https://github.com/golang/go/issues/23576\" rel=\"nofollow noreferrer\">#23576</a> which was filed for 1.10rc1. Are you sure you have release build of Go 1.10? Can you try building with a more up-to-date version (1.12.7 is the latest stable now, and 1.13 will be released in August)?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1564398221, "post_id": 57241766, "comment_id": 101004810, "body": "There&#39;s a more fresh <a href=\"https://github.com/golang/go/issues/25602\" rel=\"nofollow noreferrer\">#25602</a> which supposedly happens due to some external C code linked via <code>cgo</code> doing random memory damage. Does your full stack dump include the occurences of the word &quot;<i>cgo</i>&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 8, "last_activity_date": 1564328347, "last_edit_date": 1564328347, "creation_date": 1564327992, "answer_id": 57242367, "question_id": 57241766, "link": "https://stackoverflow.com/questions/57241766/go-program-runtime-error-and-prints-out-everything/57242367#57242367", "title": "Go program runtime error and prints out everything", "body": "<p>It actually makes it easy to debug by dumping those stacks.\nYou might not be familiar with this approach to post-mortem analysis but this can be fixed ;-)</p>\n\n<p>The first thing to note is that in normal Go code the panic/recover mechanism is not used for control flow, and so when some goroutine panics, it usually has a pretty grave reason to do that. In turn, this means, such reason is usually restricted to a not too broad set of possible reasons, and in 100% of such cases it signalizes a <em>logical</em> error in the program: an attempt to dereference an unitialized (<code>nil</code>) pointer, an attempt to send to a closed channel and so on.\n(Of course, the problem may be with the 3rd-party code, or with the way you're using it.)</p>\n\n<p>OK, so to start analysing what has happened, the first thing is to stop considering this as \"something awry happened\": instead, some <em>particular</em> error has happened, and the Go runtime displayed you the state of all of your goroutines at that instant in time.</p>\n\n<p>So, the first thing to do is to actually read and understand the very error displayed. It contains the immediate reason which caused the Go runtime to crash your program \u2014 it may be <code>nil</code> pointer derefernce, memory exhaustion, an attempt to close a closed channel and so on.</p>\n\n<p>The second thing to do \u2014 once the essense of the error was clearly understood \u2014 is to analyse whether the stack trace dump will be of use. It's simple: all runtime errors can be classified into the two broad groups: \"low-level\" or \"high-level\". The former are those happening deep in the Go runtime itself. A failure to allocate memory is the best example. Such errors might even indicate bugs in the runtime (though this is very unlikely to see in practice unless you're using a bleeding edge build of the Go toolset to build your program). The chief property of such errors is that they may have little to do with the exact place the error occured at. Say, a failure to allocate memory may be triggered by some innocent allocation while some real memory hog leaking memory successfully managed to get a big chunk of memory just before.</p>\n\n<p>But such errors are rare, and the high-level errors occur far, far more often. And with them, inspecting stack traces helps a lot.</p>\n\n<p>In these cases, you roll like this.\nA stack trace dump consists of the descriptions of the <em>stack frames</em> of the callchain leading to the error: the stack frame of the function in which the error occured is at the top, its caller is just below, the caller of the caller is the next down the line, and so on and so on \u2014 right until the <em>entry point</em> of the executing goroutine.\nEach stack frame's description includes the name of the function and the name of the file that function is defined in <em>and the line number</em> of the statement the error occured in.</p>\n\n<p>That is super useful in itself: you find that statement in the source code of your program, squint at it while keeping in mind that the indicated error happened <em>there</em> and then start to analyse \"backwards\" how it may so happened such that it occured in there. If it's not clear with the code of the function preceding that statement, it may help to analyze the caller's stack frame (whcih also includes the file name and the line number) and so on.</p>\n\n<p>In most cases the above suffices.\nIn rare cases when it does not, analysing the arguments to the functions \u2014 also captured by their dumped stack frames \u2014 may help.</p>\n\n<p>The values of the arguments are listed in their source code order \u2014 from left to right; the only problem with interpreiting them is \"decoding\" those of the arguments which are of \"compound\" types \u2014 such as strings, slices, used-defined <code>struct</code> types etc.</p>\n\n<p>Say, a string is a <code>struct</code> of two fields, and in the list of arguments these fields will come one after the other, \"unwrapped\".</p>\n\n<p>But let's not dig too deeper for now. There are other things to explore here (say, I've touched on the memory exhaustion errors but did not explain how to approach them) but you're better off actually trying to learn your way here by practice.</p>\n\n<p>If you have any <em>concrete</em> questions while dealing with such problems, \u2014 ask away, but be sure to include the stack trace of the crashed goroutine and describe what your own attempt at analysis yielded, and what exactly you have problem with.</p>\n\n<hr>\n\n<p>There exists another approach you can use.</p>\n\n<p>The <a href=\"https://golang.org/pkg/runtime/#hdr-Environment_Variables\" rel=\"noreferrer\"><code>GOTRACEBACK</code></a> environment variable may be assigned a special value to tell the Go runtime to crash your program in a way friendly to a \"regular\" interactive debugger capable of working with <a href=\"https://en.wikipedia.org/wiki/Core_dump\" rel=\"noreferrer\">core dumps</a> \u2014 such as <code>gdb</code>.</p>\n\n<p>For instance, you may enable dumping of core files and then allow the Go runtime to crash your process in such a way so that the OS dumps its core:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ ulimit -c unlimited\n$ export GOTRACEBACK=crash\n$ ./your_program\n...\n... your_program crashes\n...\n$ ls *core*\ncore\n$ gdb -e ./your_program core\n(gdb) thread apply all bt\n   * tracebacks follow *\n</code></pre>\n\n<p>(Actual debugging of the state captured by a core file is what your IDE or whatever should take care of, I suppose; I demonstrated how to run the <code>gdb</code> debugger.</p>\n\n<p>Run <code>help ulimit</code> in <code>bash</code> to see what that <code>ulimit</code> encantation above was about.)</p>\n"}], "owner": {"reputation": 47, "user_id": 10644581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7062244df47416e59a7ac2d96d49bce1?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/10644581/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1564332915, "creation_date": 1564323472, "last_edit_date": 1564332915, "question_id": 57241766, "link": "https://stackoverflow.com/questions/57241766/go-program-runtime-error-and-prints-out-everything", "title": "Go program runtime error and prints out everything", "body": "<p>My Go code uses several hundreds of goroutines. A runtime error could occur from time to time. But when error occurs, it will simply print out the stack traces of all goroutines, making it impossible to debug?</p>\n\n<p>How to locate where the program breaks?</p>\n\n<p>Sry I didn't post stack traces earlier, I didn't know how to print stderr to stack and the output is too long so I can't view all of it.</p>\n\n<pre><code>fatal error: unexpected signal during runtime execution\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x141edce pc=0x141edce]\n\nruntime stack:\nruntime: unexpected return pc for runtime.sigpanic called from 0x141edce\nstack: frame={sp:0x7ffbffffa9f0, fp:0x7ffbffffaa40} stack=[0x7ffbff7fbb80,0x7ffbffffabb0)\n00007ffbffffa8f0:  00007ffbffffa960  000000000042b58c &lt;runtime.dopanic_m+540&gt; \n00007ffbffffa900:  000000000042b031 &lt;runtime.throw+129&gt;  00007ffbffffa9d0 \n00007ffbffffa910:  0000000000000000  000000000097f880 \n00007ffbffffa920:  010000000042bae8  0000000000000004 \n00007ffbffffa930:  000000000000001f  000000000141edce \n00007ffbffffa940:  000000000141edce  0000000000000001 \n00007ffbffffa950:  00000000007996e6  000000c420302180 \n00007ffbffffa960:  00007ffbffffa988  00000000004530ac &lt;runtime.dopanic.func1+60&gt; \n00007ffbffffa970:  000000000097f880  000000000042b031 &lt;runtime.throw+129&gt; \n00007ffbffffa980:  00007ffbffffa9d0  00007ffbffffa9c0 \n00007ffbffffa990:  000000000042af5a &lt;runtime.dopanic+74&gt;  00007ffbffffa9a0 \n00007ffbffffa9a0:  0000000000453070 &lt;runtime.dopanic.func1+0&gt;  000000000097f880 \n00007ffbffffa9b0:  000000000042b031 &lt;runtime.throw+129&gt;  00007ffbffffa9d0 \n00007ffbffffa9c0:  00007ffbffffa9e0  000000000042b031 &lt;runtime.throw+129&gt; \n00007ffbffffa9d0:  0000000000000000  000000000000002a \n00007ffbffffa9e0:  00007ffbffffaa30  000000000043fb1e &lt;runtime.sigpanic+654&gt; \n00007ffbffffa9f0: &lt;000000000079dce7  000000000000002a \n00007ffbffffaa00:  00007ffbffffaa30  000000000041f08e &lt;runtime.greyobject+302&gt; \n00007ffbffffaa10:  000000c420029c70  000000000097f880 \n00007ffbffffaa20:  000000000045247d &lt;runtime.markroot.func1+109&gt;  000000c420a69b00 \n00007ffbffffaa30:  00007ffbffffaad8 !000000000141edce \n00007ffbffffaa40: &gt;000000c42160ca40  000000c4206d8000 \n00007ffbffffaa50:  0000000000000c00  000000c41ff4f9ad \n00007ffbffffaa60:  000000c400000000  00007efbff5188f8 \n00007ffbffffaa70:  000000c420029c70  0000000000000052 \n00007ffbffffaa80:  0000000021e84000  00007ffbffffaab0 \n00007ffbffffaa90:  0000000000002000  0000000000000c00 \n00007ffbffffaaa0:  000000c422b00000  000000c420000000 \n00007ffbffffaab0:  00007ffbffffaad8  0000000000421564 &lt;runtime.(*gcWork).tryGet+164&gt; \n00007ffbffffaac0:  000000c41ffc939f  000000c4226eb000 \n00007ffbffffaad0:  000000c4226e9000  00007ffbffffab30 \n00007ffbffffaae0:  000000000041e527 &lt;runtime.gcDrain+567&gt;  000000c4206d8000 \n00007ffbffffaaf0:  000000c420029c70  0000000000000000 \n00007ffbffffab00:  7ffffffffff8df47  00007ffc0001fc30 \n00007ffbffffab10:  00007ffbffffab70  0000000000000000 \n00007ffbffffab20:  000000c420302180  0000000000000000 \n00007ffbffffab30:  00007ffbffffab70  00000000004522c0 &lt;runtime.gcBgMarkWorker.func2+128&gt; \nruntime.throw(0x79dce7, 0x2a)\n    /usr/lib/go-1.10/src/runtime/panic.go:616 +0x81\nruntime: unexpected return pc for runtime.sigpanic called from 0x141edce\nstack: frame={sp:0x7ffbffffa9f0, fp:0x7ffbffffaa40} stack=[0x7ffbff7fbb80,0x7ffbffffabb0)\n00007ffbffffa8f0:  00007ffbffffa960  000000000042b58c &lt;runtime.dopanic_m+540&gt; \n00007ffbffffa900:  000000000042b031 &lt;runtime.throw+129&gt;  00007ffbffffa9d0 \n00007ffbffffa910:  0000000000000000  000000000097f880 \n00007ffbffffa920:  010000000042bae8  0000000000000004 \n00007ffbffffa930:  000000000000001f  000000000141edce \n00007ffbffffa940:  000000000141edce  0000000000000001 \n00007ffbffffa950:  00000000007996e6  000000c420302180 \n00007ffbffffa960:  00007ffbffffa988  00000000004530ac &lt;runtime.dopanic.func1+60&gt; \n00007ffbffffa970:  000000000097f880  000000000042b031 &lt;runtime.throw+129&gt; \n00007ffbffffa980:  00007ffbffffa9d0  00007ffbffffa9c0 \n00007ffbffffa990:  000000000042af5a &lt;runtime.dopanic+74&gt;  00007ffbffffa9a0 \n00007ffbffffa9a0:  0000000000453070 &lt;runtime.dopanic.func1+0&gt;  000000000097f880 \n00007ffbffffa9b0:  000000000042b031 &lt;runtime.throw+129&gt;  00007ffbffffa9d0 \n00007ffbffffa9c0:  00007ffbffffa9e0  000000000042b031 &lt;runtime.throw+129&gt; \n00007ffbffffa9d0:  0000000000000000  000000000000002a \n00007ffbffffa9e0:  00007ffbffffaa30  000000000043fb1e &lt;runtime.sigpanic+654&gt; \n00007ffbffffa9f0: &lt;000000000079dce7  000000000000002a \n00007ffbffffaa00:  00007ffbffffaa30  000000000041f08e &lt;runtime.greyobject+302&gt; \n00007ffbffffaa10:  000000c420029c70  000000000097f880 \n00007ffbffffaa20:  000000000045247d &lt;runtime.markroot.func1+109&gt;  000000c420a69b00 \n00007ffbffffaa30:  00007ffbffffaad8 !000000000141edce \n00007ffbffffaa40: &gt;000000c42160ca40  000000c4206d8000 \n00007ffbffffaa50:  0000000000000c00  000000c41ff4f9ad \n00007ffbffffaa60:  000000c400000000  00007efbff5188f8 \n00007ffbffffaa70:  000000c420029c70  0000000000000052 \n00007ffbffffaa80:  0000000021e84000  00007ffbffffaab0 \n00007ffbffffaa90:  0000000000002000  0000000000000c00 \n00007ffbffffaaa0:  000000c422b00000  000000c420000000 \n00007ffbffffaab0:  00007ffbffffaad8  0000000000421564 &lt;runtime.(*gcWork).tryGet+164&gt; \n00007ffbffffaac0:  000000c41ffc939f  000000c4226eb000 \n00007ffbffffaad0:  000000c4226e9000  00007ffbffffab30 \n00007ffbffffaae0:  000000000041e527 &lt;runtime.gcDrain+567&gt;  000000c4206d8000 \n00007ffbffffaaf0:  000000c420029c70  0000000000000000 \n00007ffbffffab00:  7ffffffffff8df47  00007ffc0001fc30 \n00007ffbffffab10:  00007ffbffffab70  0000000000000000 \n00007ffbffffab20:  000000c420302180  0000000000000000 \n00007ffbffffab30:  00007ffbffffab70  00000000004522c0 &lt;runtime.gcBgMarkWorker.func2+128&gt; \nruntime.sigpanic()\n    /usr/lib/go-1.10/src/runtime/signal_unix.go:372 +0x28e\n</code></pre>\n"}, {"tags": ["python", "google-app-engine", "go", "google-cloud-platform"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564333309, "post_id": 57241365, "comment_id": 100986981, "body": "See <a href=\"https://cloud.google.com/appengine/docs/standard/go/microservices-on-app-engine/standard/python/microservices-on-app-engine\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/standard/go/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15554, "user_id": 328036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db101b3a812b0464c53e5409c12ea94?s=128&d=identicon&r=PG", "display_name": "Dustin Ingram", "link": "https://stackoverflow.com/users/328036/dustin-ingram"}, "is_accepted": true, "score": 1, "last_activity_date": 1564328190, "creation_date": 1564328190, "answer_id": 57242397, "question_id": 57241365, "link": "https://stackoverflow.com/questions/57241365/golang-app-on-google-app-engine-calling-python-scripts/57242397#57242397", "title": "Golang App On Google App Engine Calling Python Scripts", "body": "<p>I don't think you'll find good support for Python in the Go runtime, or vice versa. </p>\n\n<p>Your best bet would be to define a custom runtime via <a href=\"https://cloud.google.com/run\" rel=\"nofollow noreferrer\">Cloud Run</a> -- this will have all the same serverless benefits of App Engine, but will allow you to run code in both languages in the same service.</p>\n"}], "owner": {"reputation": 89, "user_id": 7225224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2879466c066c16ad6406a4df49a2a60?s=128&d=identicon&r=PG&f=1", "display_name": "RobinW2", "link": "https://stackoverflow.com/users/7225224/robinw2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 57242397, "answer_count": 1, "score": 1, "last_activity_date": 1564328205, "creation_date": 1564320564, "last_edit_date": 1564328205, "question_id": 57241365, "link": "https://stackoverflow.com/questions/57241365/golang-app-on-google-app-engine-calling-python-scripts", "title": "Golang App On Google App Engine Calling Python Scripts", "body": "<p>I would like to build an app written in Go and host it on Google App Engine. I would like it to call some Python scripts which were written for another app (and therefore not need to rewrite that code in Go).</p>\n\n<p>As far as I have seen, the Google App Engine specifies the language of the app (i.e. runtime Go in that case) but it is not clear if that app could also run some Python script. Could anyone let me know if this would be possible? If not, what would be the best process? Have a separate Python service called by the Go app - ideally I would like both services to use the same domain name?</p>\n\n<p>Thanks a lot for your help!</p>\n"}, {"tags": ["go", "tcp"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1564317335, "post_id": 57240898, "comment_id": 100983075, "body": "The server logs when a new connection is accepted. Does the client dial more than one connection?  Show more of the client code."}, {"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564318052, "post_id": 57240898, "comment_id": 100983258, "body": "@ceriselimon The client only dials one connection.I think I narrowed down by problem, will update the post now."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564320492, "post_id": 57240898, "comment_id": 100983933, "body": "The application is discarding buffered data. Create one bufio.Reader and reuse it. Please post all of the relevant code."}, {"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564321025, "post_id": 57240898, "comment_id": 100984053, "body": "@ceriselimon updated the post again"}], "answers": [{"comments": [{"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1564321166, "post_id": 57241395, "comment_id": 100984092, "body": "Is this the correct way to do it? I updated the post again maybe you can help me."}, {"owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "reply_to_user": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1564321248, "post_id": 57241395, "comment_id": 100984115, "body": "@ninesalt Yes it is."}], "tags": [], "owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "is_accepted": false, "score": 0, "last_activity_date": 1564322129, "last_edit_date": 1564322129, "creation_date": 1564320818, "answer_id": 57241395, "question_id": 57240898, "link": "https://stackoverflow.com/questions/57240898/sending-more-than-one-request-to-a-tcp-server-fails/57241395#57241395", "title": "Sending more than one request to a TCP server fails", "body": "<p>In <code>handleRequest()</code>, you call <code>ReadString()</code> on the bufio Reader. Let's look at the <a href=\"https://godoc.org/bufio#Reader.ReadString\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>ReadString reads until the first occurrence of delim in the input,\n  returning a string containing the data up to and including the\n  delimiter. If ReadString encounters an error before finding a\n  delimiter, it returns the data read before the error and the error\n  itself (often io.EOF). ReadString returns err != nil if and only if\n  the returned data does not end in delim. For simple uses, a Scanner\n  may be more convenient.</p>\n</blockquote>\n\n<p>Considering the packets you're sending are terminated by a <code>\\n</code>, you must call <code>ReadString()</code> twice on the same reader. You probably want to call <code>ReadString()</code> in a loop until it returns an error. Make sure to distinguish <code>io.EOF</code>, then.</p>\n\n<p>Here's a <a href=\"https://play.golang.org/p/pFrK_j8KMR1\" rel=\"nofollow noreferrer\">playground</a> with some inspiration. Note: it appears the playground does not allow TCP sockets, so you will have to run this elsewhere.</p>\n"}, {"comments": [{"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1564401990, "post_id": 57245121, "comment_id": 101006736, "body": "This works however I had to change the scanner so that it uses the connection instead of <code>os.Stdin</code>."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1564405741, "last_edit_date": 1564405741, "creation_date": 1564349540, "answer_id": 57245121, "question_id": 57240898, "link": "https://stackoverflow.com/questions/57240898/sending-more-than-one-request-to-a-tcp-server-fails/57245121#57245121", "title": "Sending more than one request to a TCP server fails", "body": "<p>The server should read multiple lines given that the client sends multiple lines.  Use <a href=\"https://godoc.org/bufio#Scanner\" rel=\"nofollow noreferrer\">bufio.Scanner</a> to read lines:</p>\n\n<pre><code>func handleRequest(conn net.Conn) {\n   defer conn.Close()\n   scanner := bufio.NewScanner(conn)\n   for scanner.Scan() {\n      fmt.Printf(\"Got message: %s\\n\", scanner.Bytes())\n      conn.Write([]byte(\"Message received.\"))\n   }\n   if err := scanner.Err(); err != nil {\n      fmt.Printf(\"error reading connection: %v\\n\", err)\n   }\n}\n</code></pre>\n\n<p>Some notes about the code:</p>\n\n<ul>\n<li>To prevent a resource leak, the function closes the connection on return.</li>\n<li>The scanner loop breaks on error reading the connection. If the error is not io.EOF, then the function logs the error.</li>\n<li><code>bufio.Reader</code> can also be used to read lines, but bufio.Scanner is easier to use.</li>\n</ul>\n"}], "owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57245121, "answer_count": 2, "score": -2, "last_activity_date": 1564405741, "creation_date": 1564316912, "last_edit_date": 1564320998, "question_id": 57240898, "link": "https://stackoverflow.com/questions/57240898/sending-more-than-one-request-to-a-tcp-server-fails", "title": "Sending more than one request to a TCP server fails", "body": "<p>I'm trying to send more than one request to a TCP server in Go but for some reason the second request is never sent, even if it is identical to the first one. </p>\n\n<p>This is the server:</p>\n\n<pre><code>func StartServer(host string) {\n\n    l, err := net.Listen(\"tcp\", host)\n    log.Println(\"Starting server on:\", host)\n\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    defer l.Close()\n    log.Println(\"Server is running...\")\n\n    for {\n        // Listen for an incoming connection.\n        conn, err := l.Accept()\n        if err != nil {\n            log.Fatal(\"Error accepting: \", err.Error())\n        }\n        // Handle connections in a new goroutine.\n        fmt.Println(\"got a request\")\n        go handleRequest(conn)\n    }\n}\n</code></pre>\n\n<p>And this is the function in the client that sends the requests to the server:</p>\n\n<pre><code>func (u *User) ConnectToServer(host string, partner string) {\n    conn, _ := net.Dial(\"tcp\", host)\n    fmt.Fprintf(conn, \"message1\\n\")\n    fmt.Fprintf(conn, \"message2\\n\")\n}\n</code></pre>\n\n<p><strong>EDIT</strong>: In the handleRequest function I read the input as follows:</p>\n\n<pre><code> // Handles incoming requests.\nfunc handleRequest(conn net.Conn) {\n\n    rec, err := bufio.NewReader(conn).ReadString('\\n')\n\n    if err != nil {\n        log.Println(\"Error reading:\", err.Error())\n    }\n\n    log.Println(\"Got message: \", rec)\n\n    // Send a response back to person contacting us.\n    conn.Write([]byte(\"Message received.\"))\n    // conn.Close()\n}\n</code></pre>\n\n<p>Which according to the documentation only takes the first part before the first line break detected so I believe the second message is ignored because of this. How can I read both messages? Should I change the delimiter in the client maybe?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 1699, "user_id": 2613150, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2349ff6d3d2259f4aa77a7a0850ba443?s=128&d=identicon&r=PG", "display_name": "Zobayer Hasan", "link": "https://stackoverflow.com/users/2613150/zobayer-hasan"}, "edited": false, "score": 0, "creation_date": 1599463412, "post_id": 57240348, "comment_id": 112771704, "body": "Were you able to solve this problem? Did you look into presigned post url?"}, {"owner": {"reputation": 1081, "user_id": 1185148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bhzy9.jpg?s=128&g=1", "display_name": "meshkati", "link": "https://stackoverflow.com/users/1185148/meshkati"}, "reply_to_user": {"reputation": 1699, "user_id": 2613150, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2349ff6d3d2259f4aa77a7a0850ba443?s=128&d=identicon&r=PG", "display_name": "Zobayer Hasan", "link": "https://stackoverflow.com/users/2613150/zobayer-hasan"}, "edited": false, "score": 0, "creation_date": 1599628290, "post_id": 57240348, "comment_id": 112827862, "body": "@ZobayerHasan I couldn&#39;t solve the problem with pre-signed urls, so I forced to make a service to do the partial upload itself. It generates some custom urls for the client and uploads each part with S3 SDK."}], "owner": {"reputation": 1081, "user_id": 1185148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bhzy9.jpg?s=128&g=1", "display_name": "meshkati", "link": "https://stackoverflow.com/users/1185148/meshkati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1564559230, "creation_date": 1564312852, "last_edit_date": 1564559230, "question_id": 57240348, "link": "https://stackoverflow.com/questions/57240348/partial-upload-on-s3-using-pre-signed-url", "title": "Partial upload on S3 using pre-signed URL", "body": "<p>I'm going to partially upload a file, on S3 using pre-signed URLs. My problem is not about the 5GB limit of the S3. Actually, my files are about 100MB.</p>\n\n<p>But the problem is that I want to break the file into chunks and upload each part separately, to handle failed \"part uploads\" better and give a better experience to the client user.</p>\n\n<p>So I'm looking for a way like how we download a file partially, using the byte-range headers. I know that there is no \"byte-range\" like header for the <code>PUT</code> method :(</p>\n\n<p>I also can't use S3 SDK directly into my clients and I'm forced to use pre-signed URLs. I have a service that generates the pre-signed URLs using go SDK and then all of the other works are done by the clients using the URLs.</p>\n\n<p>I'm also wandered is it right to upload a 100mb file ( or even smaller ) partially? Why the AWS and others didn't consider this option to upload partially with one pre-signed URL?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564317140, "post_id": 57240224, "comment_id": 100983026, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21786624/go-language-golang-struct-variable-not-being-updated\" title=\"go language golang struct variable not being updated\">stackoverflow.com/questions/21786624/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/46536687/property-in-golang-struct-not-getting-modified\" title=\"property in golang struct not getting modified\">stackoverflow.com/questions/46536687/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/6476343/in-go-using-a-setter-for-a-struct-type-does-not-work-as-anticipated\" title=\"in go using a setter for a struct type does not work as anticipated\">stackoverflow.com/questions/6476343/&hellip;</a>, and more."}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 2, "last_activity_date": 1564319369, "last_edit_date": 1564319369, "creation_date": 1564313289, "answer_id": 57240415, "question_id": 57240224, "link": "https://stackoverflow.com/questions/57240224/why-is-a-field-in-my-struct-always-nil-where-i-set-value-at-other-function/57240415#57240415", "title": "Why is a field in my struct always nil where I set value at other function?", "body": "<p>Even though inside <code>getSession()</code> you assigned new value on <code>mu.session</code>, the session will always be <code>nil</code> if it's accessed from outside <code>getSession()</code> function.</p>\n\n<p>It's because the <code>getSession()</code> method has <strong>value receiver</strong>, not a pointer receiver.</p>\n\n<p>Try to change your code from:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (mu MongoUtil) getSession() (err error) {\n    // ...\n}\n</code></pre>\n\n<p>To:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (mu *MongoUtil) getSession() (err error) {\n    // ...\n}\n</code></pre>\n\n<hr>\n\n<p>I suggest to take <a href=\"https://tour.golang.org/methods/4\" rel=\"nofollow noreferrer\">a tour of go about methods with pointer receivers</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2672, "user_id": 1288818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CfkE.jpg?s=128&g=1", "display_name": "Oleg Butuzov", "link": "https://stackoverflow.com/users/1288818/oleg-butuzov"}, "is_accepted": false, "score": 1, "last_activity_date": 1564313324, "creation_date": 1564313324, "answer_id": 57240422, "question_id": 57240224, "link": "https://stackoverflow.com/questions/57240224/why-is-a-field-in-my-struct-always-nil-where-i-set-value-at-other-function/57240422#57240422", "title": "Why is a field in my struct always nil where I set value at other function?", "body": "<p>There are two ways to pass data to function - by copy (literally copying value) or by reference (passing pointer to value). If you going to mutate struct properties, pass a value by reference, If you only do read operations, you can pass a value as a copy.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype My struct {\n    session string\n}\n\nfunc (m My) Set() {\n    m.session = \"yeah!\"\n    fmt.Println(\"inside set method\", m.session)\n}\n\nfunc (m *My) SetByRef() {\n    m.session = \"yeah!\"\n    fmt.Println(\"inside set method\", m.session)\n}\n\nfunc main() {\n    var m = My{}\n    m.Set()\n    fmt.Println(\"outside set method\", m.session)\n    m.SetByRef()\n    fmt.Println(\"outside set method\", m.session)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11847961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909b10cbbc04a63a59127df6dfd99150?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousX", "link": "https://stackoverflow.com/users/11847961/curiousx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "closed_date": 1564384811, "answer_count": 2, "score": -6, "last_activity_date": 1564384869, "creation_date": 1564311806, "last_edit_date": 1564384658, "question_id": 57240224, "link": "https://stackoverflow.com/questions/57240224/why-is-a-field-in-my-struct-always-nil-where-i-set-value-at-other-function", "closed_reason": "Duplicate", "title": "Why is a field in my struct always nil where I set value at other function?", "body": "<p>I'm setting a field value for a struct at other method.I took a breakpoint, the session is have a value, but when <code>getSession</code> return, and the session is nil. I'm feeling lost.</p>\n\n<p>Like the code,the <code>newMongoUtil</code> create a <code>MongoUtil</code>,And the <code>mu.getSession</code> give <code>MongoUtil.session</code> a value if it's <code>nil</code></p>\n\n<pre><code>package mongo\n\nimport (\n    \"fmt\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"sync\"\n)\n\ntype MongoUtil struct {\n    DBURL       string\n    DBName      string\n    Collections map[string]string\n\n    session *mgo.Session\n}\n\nvar once sync.Once\nvar instance *MongoUtil\n\nfunc (mu MongoUtil) getSession() (err error){\n    // fmt.Println(\"%v\",&amp;mu)\n    if mu.session==nil{\n        var session *mgo.Session\n        session, err = mgo.Dial(mu.DBURL)\n        if err==nil {\n            mu.session = session\n        }\n    }\n\n    return\n}\n\nfunc GetInstance() *MongoUtil {\n    once.Do(func() {\n        instance = newMongoUtil()\n    })\n\n    return instance\n}\n\nfunc newMongoUtil() *MongoUtil {\n    var mu  MongoUtil\n    mu.DBURL = \"mongodb://127.0.0.1:27017\"\n    mu.DBName = \"blog\"\n    mu.Collections = map[string]string{}\n\n    // fmt.Println(\"%v\",&amp;mu)\n    if mu.session == nil{\n        e := mu.getSession()\n        fmt.Println(e)\n    }\n\n    return &amp;mu\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2859, "user_id": 6225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqBej.jpg?s=128&g=1", "display_name": "Shalauddin Ahamad Shuza", "link": "https://stackoverflow.com/users/6225565/shalauddin-ahamad-shuza"}, "edited": false, "score": 0, "creation_date": 1564312789, "post_id": 57240085, "comment_id": 100981993, "body": "Can you share full code?"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1564312997, "creation_date": 1564312997, "answer_id": 57240371, "question_id": 57240085, "link": "https://stackoverflow.com/questions/57240085/cleaner-way-to-keep-a-connection-session-alive-in-discordgo/57240371#57240371", "title": "Cleaner way to keep a connection/session alive in discordgo?", "body": "<p>You didn't provide a link to your example, so we can only guess. For example, my guess,</p>\n\n<blockquote>\n  <p>the last bit of code in our main function:</p>\n  \n  <p><code>&lt;-make(chan struct{})</code></p>\n  \n  <p>We're creating a channel that takes an empty struct that waits for\n  input. This is a SUPER hacky way of making our main function sit and\n  wait forever while not using any CPU.</p>\n  \n  <p><a href=\"https://boostlog.io/@cuken/writing-a-simple-discord-bot-in-go-part-1-5ae6a1d647018500491f42bb\" rel=\"nofollow noreferrer\">https://boostlog.io/@cuken/writing-a-simple-discord-bot-in-go-part-1-5ae6a1d647018500491f42bb</a></p>\n</blockquote>\n\n<hr>\n\n<p>Have you tried this?</p>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">Select statements</a></p>\n\n<pre><code>select {}  // block forever\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 11847950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd0b2f408ff3a5881a66e5433462527?s=128&d=identicon&r=PG&f=1", "display_name": "vetale", "link": "https://stackoverflow.com/users/11847950/vetale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1564333939, "creation_date": 1564310510, "last_edit_date": 1564333939, "question_id": 57240085, "link": "https://stackoverflow.com/questions/57240085/cleaner-way-to-keep-a-connection-session-alive-in-discordgo", "title": "Cleaner way to keep a connection/session alive in discordgo?", "body": "<p>I'm using the <a href=\"https://github.com/bwmarrin/discordgo\" rel=\"nofollow noreferrer\">github.com/bwmarrin/discordgo</a> package\nand I've seen in the examples that the way to keep a connection or a \"session\" alive is to use the following:</p>\n\n<pre><code>&lt;-make(chan struct{})\n</code></pre>\n\n<p>But it looks kinda messy, is this the best way of keeping it alive or is there another method.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1564308127, "post_id": 57239639, "comment_id": 100981036, "body": "Receive from a nil channel blocks forever. The range statement isn&#39;t skipped, it never terminates because the &quot;channel&quot; is never closed. <a href=\"https://dave.cheney.net/2014/03/19/channel-axioms\" rel=\"nofollow noreferrer\">dave.cheney.net/2014/03/19/channel-axioms</a>"}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1564310056, "post_id": 57239811, "comment_id": 100981435, "body": "&quot;In Go, reading from a nil channel will always block. I haven&#39;t been able to find any official documentation on this behaviour.&quot; <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a>: Receiving from a nil channel blocks forever. <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">Receive operator</a>."}, {"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1564312997, "post_id": 57239811, "comment_id": 100982037, "body": "@peterSO Thanks for providing the link to the spec! I&#39;ve updated the answer accordingly."}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 4, "last_activity_date": 1564312960, "last_edit_date": 1564312960, "creation_date": 1564308244, "answer_id": 57239811, "question_id": 57239639, "link": "https://stackoverflow.com/questions/57239639/why-this-goroutine-leaks/57239811#57239811", "title": "Why this goroutine leaks?", "body": "<blockquote>\n  <p>As strings is nil range-loop just skipped.</p>\n</blockquote>\n\n<p>This assumption is not correct. In Go, reading from a <code>nil</code> channel will always block. This is defined in the <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">language specification</a> (thanks to @peterSO for digging out the link):</p>\n\n<blockquote>\n  <p>Receiving from a nil channel blocks forever.</p>\n</blockquote>\n\n<p>There's also <a href=\"https://www.godesignpatterns.com/2014/05/nil-channels-always-block.html\" rel=\"nofollow noreferrer\">a post on the Go Design Patterns blog</a> that further elaborates on this behaviour and highlights some cases in which it is useful.</p>\n\n<p>Anyhow, this behaviour can easily be reproduced with a minimal example (<a href=\"https://play.golang.org/p/v-zLfWKDVgg\" rel=\"nofollow noreferrer\">playground</a>):</p>\n\n<pre><code>func main() {\n    var s chan string\n    &lt;- s\n}\n</code></pre>\n\n<p>This program will never finish (in the playground, it will crash with <code>all goroutines are asleep - deadlock</code>).</p>\n\n<p>Because reading from a nil channel (in the case of your example, <code>strings</code>) will block (forever, since nothing can be written into a nil channel), the <code>doWork</code> goroutine will never complete, and thus, leak.</p>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 57239811, "answer_count": 1, "score": 1, "last_activity_date": 1564312960, "creation_date": 1564306931, "last_edit_date": 1564307999, "question_id": 57239639, "link": "https://stackoverflow.com/questions/57239639/why-this-goroutine-leaks", "title": "Why this goroutine leaks?", "body": "<p>I am reading 'Concurrency in Go' and have found this example of goroutine leaks:</p>\n\n<pre><code>func main() {\n\n    var wg sync.WaitGroup\n\n    doWork := func(strings &lt;-chan string) &lt;-chan interface{} {\n        completed := make(chan interface{})\n        go func() {\n            defer fmt.Println(\"doWork exited.\")\n            defer close(completed)\n            defer wg.Done()\n            fmt.Println(\"a\")\n            for s := range strings {\n                fmt.Println(s)\n            }\n            fmt.Println(\"b\")\n        }()\n        return completed\n    }\n\n    wg.Add(1)\n    doWork(nil)\n    fmt.Println(\"Waiting\")\n    wg.Wait()\n\n    fmt.Println(\"Done.\")\n}\n</code></pre>\n\n<blockquote>\n  <p>The <code>strings</code> channel will never gets any strings written onto it, and the goroutine containing <code>doWork</code> will remain in memory for the life time of process.</p>\n</blockquote>\n\n<p>I don't understand - why ?</p>\n\n<p>How I understand this code:</p>\n\n<ul>\n<li><p>As <code>strings</code> is <code>nil</code> <code>range</code>-loop just skipped. As any range over <code>nil</code>:</p>\n\n<pre><code>slice := []int{10, 20, 30, 40, 50}\nslice = nil\nfor i := range slice {\n   fmt.Println(i)\n}\nfmt.Println(\"Done\")\n</code></pre></li>\n<li><p><code>fmt.Println(\"doWork exited.\")</code> will be executed </p></li>\n<li><code>close(completed)</code> will be executed</li>\n</ul>\n\n<p>But I see it works like that. Why ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 322, "user_id": 2939041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/748a0100ad69d148ef651ec35bfdb889?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sheshadri", "link": "https://stackoverflow.com/users/2939041/vinay-sheshadri"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1564272099, "post_id": 57236845, "comment_id": 100976037, "body": "Just true of false indicating the presence of a duplicate value. I am used to using set in python and then checking the lengths. But golang does not support sets."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1564407760, "post_id": 57236845, "comment_id": 101009970, "body": "You can use a map as a set. <code>map[string]struct{}</code> would be the most efficient <code>string</code> set type, as the empty struct values will use no memory."}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 2939041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/748a0100ad69d148ef651ec35bfdb889?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sheshadri", "link": "https://stackoverflow.com/users/2939041/vinay-sheshadri"}, "edited": false, "score": 0, "creation_date": 1564896761, "post_id": 57237165, "comment_id": 101176199, "body": "Can you please explain the meaning of struct{}{}"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "reply_to_user": {"reputation": 322, "user_id": 2939041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/748a0100ad69d148ef651ec35bfdb889?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sheshadri", "link": "https://stackoverflow.com/users/2939041/vinay-sheshadri"}, "edited": false, "score": 1, "creation_date": 1564903373, "post_id": 57237165, "comment_id": 101177341, "body": "This is a literal of an anonymous empty struct type. To break that down, you&#39;re probably familiar with something like <code>type myStruct struct{myField string}; x := myStruct{myField: &quot;foo&quot;}</code>. The empty struct is a struct type with no fields, so you could also imagine something like <code>type emptyStruct struct{}; x := emptyStruct{}</code>. Rather than creating an explicitly-named <code>emptyStruct</code> struct, I can inline the type in which case it will be anonymous (i.e. it has no name), like so: <code>x := struct{}{}</code>. You can also do this with non-empty structs, e.g. <code>x := struct{myField string}{myField: &quot;foo&quot;}</code>."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 8, "last_activity_date": 1564275080, "creation_date": 1564275080, "answer_id": 57237165, "question_id": 57236845, "link": "https://stackoverflow.com/questions/57236845/checking-if-map-has-duplicate-values-in-go/57237165#57237165", "title": "Checking if map has duplicate values in Go", "body": "<p>If you just need true/false of whether there are dupes, without needing to know which values are dupes or how many dupes there are, the most efficient structure to use to track existing values is a map with empty struct values.</p>\n\n<p>See <a href=\"https://play.golang.org/p/mOeIF4qf0Qm\" rel=\"noreferrer\">here</a> (pasted below for convenience):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc hasDupes(m map[string]string) bool {\n    x := make(map[string]struct{})\n\n    for _, v := range m {\n        if _, has := x[v]; has {\n            return true\n        }\n        x[v] = struct{}{}\n    }\n\n    return false\n}\n\nfunc main() {\n    mapWithDupes := make(map[string]string)\n    mapWithDupes[\"a\"] = \"one\"\n    mapWithDupes[\"b\"] = \"two\"\n    mapWithDupes[\"c\"] = \"one\"\n\n    fmt.Println(hasDupes(mapWithDupes)) // prints true\n\n    mapWithoutDupes := make(map[string]string)\n    mapWithoutDupes[\"a\"] = \"one\"\n    mapWithoutDupes[\"b\"] = \"two\"\n    mapWithoutDupes[\"c\"] = \"three\"\n\n    fmt.Println(hasDupes(mapWithoutDupes)) // prints false\n}\n</code></pre>\n"}], "owner": {"reputation": 322, "user_id": 2939041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/748a0100ad69d148ef651ec35bfdb889?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sheshadri", "link": "https://stackoverflow.com/users/2939041/vinay-sheshadri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1549, "favorite_count": 1, "accepted_answer_id": 57237165, "answer_count": 1, "score": 2, "last_activity_date": 1564334428, "creation_date": 1564270567, "last_edit_date": 1564334428, "question_id": 57236845, "link": "https://stackoverflow.com/questions/57236845/checking-if-map-has-duplicate-values-in-go", "title": "Checking if map has duplicate values in Go", "body": "<p>Consider the following map </p>\n\n<pre><code>mymap := make(map[string]string)\nmymap[\"a\"] = \"one\"\nmymap[\"b\"] = \"two\"\nmymap[\"c\"] = \"one\"\n</code></pre>\n\n<p>How to determine if the values are unique?</p>\n\n<p>One strategy is to iterate through the map, create a slice of the values. Then iterate through the slice to find duplicates. Is there a better way?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 480, "user_id": 9448870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ckK5P.jpg?s=128&g=1", "display_name": "Daniel Sch&#252;tte", "link": "https://stackoverflow.com/users/9448870/daniel-sch%c3%bctte"}, "is_accepted": false, "score": 1, "last_activity_date": 1564272642, "last_edit_date": 1564272642, "creation_date": 1564271335, "answer_id": 57236897, "question_id": 57236837, "link": "https://stackoverflow.com/questions/57236837/embedding-struct-vs-pointer-to-struct-in-struct-used-as-pointer/57236897#57236897", "title": "Embedding struct vs pointer to struct in struct used as pointer", "body": "<p>Consider a simple example program. A <code>structAPtr</code> embeds a pointer, a <code>structAVal</code> embeds a struct <code>structB</code> directly:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype structB struct {\n    foo int\n}\n\ntype structAPtr struct {\n    bar *structB\n}\n\ntype structAVal struct {\n    bar structB\n}\n\nfunc main() {\n    // referencing bStruct\n    b1 := structB{foo: 12}\n\n    aPtr := structAPtr{bar: &amp;b1}\n    fmt.Println(\"Before assignment:\")\n    fmt.Printf(\"aPtr.bar.foo = %d, b.foo = %d\\n\", aPtr.bar.foo, b1.foo)\n\n    aPtr.bar.foo = 42\n    fmt.Println(\"After assignment:\")\n    fmt.Printf(\"aPtr.bar.foo = %d, b.foo = %d\\n\", aPtr.bar.foo, b1.foo)\n\n    // copying bStruct\n    b2 := structB{foo: 12}\n\n    aVal := structAVal{bar: b2}\n    fmt.Println(\"Before assignment:\")\n    fmt.Printf(\"aVal.bar.foo = %d, b.foo = %d\\n\", aVal.bar.foo, b2.foo)\n\n    aVal.bar.foo = 42\n    fmt.Println(\"After assignment:\")\n    fmt.Printf(\"aVal.bar.foo = %d, b.foo = %d\\n\", aVal.bar.foo, b2.foo)\n}\n</code></pre>\n\n<p>The int <code>structB.foo</code> is used to demonstrate whether <code>structB</code> changes when manipulated inside of <code>structAPtr</code> or <code>structAVal</code>.</p>\n\n<p>This program outputs:</p>\n\n<pre><code>Before assignment:\naPtr.bar.foo = 12, b.foo = 12\nAfter assignment:\naPtr.bar.foo = 42, b.foo = 42 &lt;------------ both changed\nBefore assignment:\naVal.bar.foo = 12, b.foo = 12\nAfter assignment:\naVal.bar.foo = 42, b.foo = 12 &lt;------------ only assignee changed\n</code></pre>\n\n<p>Looking at the result shows:</p>\n\n<ul>\n<li><p>changing the value of the <em>pointer</em> to <code>structB</code> changes <code>structB</code></p></li>\n<li><p>changing the value of the copied version <code>structB</code> in <code>structAVal</code> leaves <code>structB</code> unaffected (it is still <code>5</code>, even after <code>42</code> was assigned to <code>aVal</code>)</p></li>\n</ul>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>If your <code>structB</code> has only pointer receivers anyways, the intended behavior is probably such that changing <code>structB</code> in <code>strucA</code> updated both of them. That's scenario 1 in my example and requires a pointer for sure. From <strong>A Tour of Go</strong>:</p>\n\n<blockquote>\n  <p>Methods with pointer receivers can modify the value to which the receiver points [...]. Since methods often need to modify their receiver, pointer receivers are more common than value receivers. </p>\n</blockquote>\n\n<hr>\n\n<p>Hope that helps!</p>\n"}, {"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 2, "last_activity_date": 1564272811, "creation_date": 1564272811, "answer_id": 57236993, "question_id": 57236837, "link": "https://stackoverflow.com/questions/57236837/embedding-struct-vs-pointer-to-struct-in-struct-used-as-pointer/57236993#57236993", "title": "Embedding struct vs pointer to struct in struct used as pointer", "body": "<p>The zero values of the two structures are different, which can be a significant ergonomic difference.</p>\n\n<p>Consider an embedded type</p>\n\n<pre><code>type B struct {\n    X int\n}\n\nfunc (b *B) Print() { fmt.Printf(\"%d\\n\", b.X) }\n</code></pre>\n\n<p>If we embed this directly as an object</p>\n\n<pre><code>type AObj struct {\n    B\n}\n</code></pre>\n\n<p>then the zero value of type <code>AObj</code> includes an embedded <em>object</em> of type <code>B</code>, which also has its zero value, and therefore we can safely</p>\n\n<pre><code>var aObj AObj\naObj.Print() // prints 0\n</code></pre>\n\n<p>But if we instead embed a pointer</p>\n\n<pre><code>type APtr struct {\n    *B\n}\n</code></pre>\n\n<p>the zero value of this struct has a nil pointer value, and we can't really use it directly.</p>\n\n<pre><code>var aPtr APtr\naPtr.Print() // panics\n</code></pre>\n\n<p>Objects get copied in hopefully the way you might expect.  If you create a new <code>AObj</code> object, it gets a copy of the embedded <code>B</code>.</p>\n\n<pre><code>aObj2 := aObj\naObj.X = 1\naObj2.Print() // prints 0, because it has a copy\n</code></pre>\n\n<p>If you create a new <code>APtr</code> object, it gets a copy of the <code>*B</code>, which means it shares the underlying concrete object.</p>\n\n<pre><code>aPtr.B = &amp;B{}\naPtr2 := aPtr\naPtr.X = 1\naPtr2.Print() // prints 1, because both objects point at the same B\n</code></pre>\n\n<p>Runnable example at <a href=\"https://play.golang.org/p/XmOgegwVFeE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/XmOgegwVFeE</a></p>\n"}], "owner": {"reputation": 570, "user_id": 5017282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dc704a7526f6681e51eccba8fbd00e07?s=128&d=identicon&r=PG&f=1", "display_name": "RobertR", "link": "https://stackoverflow.com/users/5017282/robertr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 57236993, "answer_count": 2, "score": 0, "last_activity_date": 1564272811, "creation_date": 1564270501, "question_id": 57236837, "link": "https://stackoverflow.com/questions/57236837/embedding-struct-vs-pointer-to-struct-in-struct-used-as-pointer", "title": "Embedding struct vs pointer to struct in struct used as pointer", "body": "<p>If I have a struct type <code>A</code> which is used as a pointer (has pointer receivers only, the constructor returns <code>*A</code>, etc.), what is the difference between embedding a struct type <code>B</code> as <code>B</code> versus <code>*B</code>?</p>\n\n<p>That is, what is the difference between</p>\n\n<pre><code>type B struct {...}\ntype A struct {\n    B\n    // ...\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type B struct {...}\ntype A struct {\n    *B\n    // ...\n}\n</code></pre>\n\n<p>For example, is there ever copying of the embedded field?</p>\n\n<p>Edit: I should also mention that the embedded struct <code>B</code> only has pointer receivers.</p>\n"}, {"tags": ["go", "continuous-integration"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 4, "creation_date": 1564272967, "post_id": 57236804, "comment_id": 100976127, "body": "<code>go test .&#47;...</code> will test everything in or under the current directory.  See <a href=\"https://golang.org/cmd/go/#hdr-Package_lists_and_patterns\" rel=\"nofollow noreferrer\">Package lists and patterns</a> in the <code>go</code> command documentation."}, {"owner": {"reputation": 1002, "user_id": 10638608, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dabljues", "link": "https://stackoverflow.com/users/10638608/dabljues"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1564274764, "post_id": 57236804, "comment_id": 100976309, "body": "Wow, that is the thing I was looking for I guess. Make it an answer and I can accept it, @DavidMaze!"}, {"owner": {"reputation": 1002, "user_id": 10638608, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dabljues", "link": "https://stackoverflow.com/users/10638608/dabljues"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1564332517, "post_id": 57236804, "comment_id": 100986818, "body": "Btw I don&#39;t know why my question is getting so many downvotes"}], "answers": [{"comments": [{"owner": {"reputation": 1002, "user_id": 10638608, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dabljues", "link": "https://stackoverflow.com/users/10638608/dabljues"}, "edited": false, "score": 0, "creation_date": 1564274673, "post_id": 57236856, "comment_id": 100976297, "body": "As I said - I can&#39;t, because i.e <code>go build .&#47;array</code> doesn&#39;t work, cuz the paths is relative to project root. <code>go build github.com&#47;dabljues&#47;project_name&#47;array</code> works, cuz it&#39;s the relative path to <code>$GOPATH&#47;src</code> and I won&#39;t have it on docker container"}], "tags": [], "owner": {"reputation": 322, "user_id": 2939041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/748a0100ad69d148ef651ec35bfdb889?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sheshadri", "link": "https://stackoverflow.com/users/2939041/vinay-sheshadri"}, "is_accepted": false, "score": -3, "last_activity_date": 1564270802, "creation_date": 1564270802, "answer_id": 57236856, "question_id": 57236804, "link": "https://stackoverflow.com/questions/57236804/build-all-go-packages-in-project/57236856#57236856", "title": "Build all go packages in project", "body": "<p>Use a Makefile. Define the targets and instruction to compile them.</p>\n\n<p>For example define the following in a Makefile</p>\n\n<pre><code>build:\n    go build -o bin/main main.go\n\nrun:\n    go run main.go\n</code></pre>\n\n<p>To run just invoke : <code>make build</code></p>\n"}], "owner": {"reputation": 1002, "user_id": 10638608, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dabljues", "link": "https://stackoverflow.com/users/10638608/dabljues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1564270802, "creation_date": 1564269962, "question_id": 57236804, "link": "https://stackoverflow.com/questions/57236804/build-all-go-packages-in-project", "title": "Build all go packages in project", "body": "<p>I am making a Go project containing a few packages. Those are data structures (and there will be algorithms as well). My project root looks like this:</p>\n\n<pre><code>C:.\n\u251c\u2500\u2500\u2500array\n\u251c\u2500\u2500\u2500binary_tree\n\u251c\u2500\u2500\u2500heap\n\u2514\u2500\u2500\u2500list\n</code></pre>\n\n<p>The thing is, I want to add like a CI. So I would have a job checking if all packages build and if all tests pass. </p>\n\n<p>Unfortunately, I can't run <code>go build</code> on project root. I have to pass whole path to it. I mean I could write a script which calls <code>go build X/Y/foo</code> and then <code>go build X/Y/bar</code>, but the CI on GitLab (docker image) won't have those paths, it will just <code>git clone</code> my repo and that's it (cuz I cannot run it on a relative path from project root, but a relative path from <code>GOPATH</code>, so like <code>github.com/dabljues/project_name/array</code>). And what about the test?</p>\n\n<p>So the question there would be: Can I somehow run <code>go build</code> and <code>go test</code> for all the packages in the Go project? (located in separate folders)</p>\n"}, {"tags": ["go", "math"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1564258072, "post_id": 57235618, "comment_id": 100973725, "body": "I think it&#39;s <a href=\"https://floating-point-gui.de/\" rel=\"nofollow noreferrer\">floating-point-gui.de</a>"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 7, "creation_date": 1564258102, "post_id": 57235618, "comment_id": 100973730, "body": "The <code>360</code> is a full circle in degrees which means that you calculate the angle in degrees and then put it into <code>math.Cos</code>. But <code>math.Cos</code> expects radian, i.e. you need to use <code>2*pi</code> instead of <code>360</code>. Essentially you then input <code>pi</code> to compute <code>pi</code>. <i>&quot;... but there was a problem with using cosine law on degrees instead of rad in python that messed it up.&quot;</i> - yup, exactly the same problem here."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 2, "creation_date": 1564258298, "post_id": 57235618, "comment_id": 100973780, "body": "As @SteffenUllrich wrote, you would have to write <code>math.Cos(2*math.Pi&#47;n)</code> to convert degrees to radians. This will result in iterations converging to Pi for a <i>while</i>, after that it will divert probably due to reasons inclined by @kostix."}], "answers": [{"comments": [{"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1566597479, "post_id": 57263728, "comment_id": 101720075, "body": "Can&#39;t you use <code>math.Sqrt()</code> instead of <code>math.Pow(..., 0.5)</code>?"}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "reply_to_user": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1566599576, "post_id": 57263728, "comment_id": 101720523, "body": "Yes, you could. I was deliberately making this code as similar to the original code as possible."}], "tags": [], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1564455389, "creation_date": 1564455389, "answer_id": 57263728, "question_id": 57235618, "link": "https://stackoverflow.com/questions/57235618/trying-to-calculate-pi-in-go-what-am-i-doing-wrong-possibly-problem-with-math/57263728#57263728", "title": "Trying to calculate pi in go, what am I doing wrong? Possibly problem with math.Cos?", "body": "<p>Don't use the standard function <code>Cos</code> - as many people have said, to use that you need to already know the value of pi because it takes its argument in radians.</p>\n\n<p><strong>Most computer languages' trigonometric functions use radians as their arguments</strong>. This is because there are nice, simple formulas for approximating trig. functions if you use radians.</p>\n\n<p>In any case though, here you don't need it! You're doubling the value of <code>n</code> each time, so you can use the well-known half-angle formula for cosine:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n    cosVal := float64(-1) // Start at cosine of 180 degrees\n    for n := 4 ; n &lt; 5000; n *= 2 {\n        fmt.Println(n)\n        cosVal = math.Sqrt(0.5 * (cosVal + 1.0))\n        c := math.Pow(0.5 - 0.5*cosVal, 0.5)\n        fmt.Println(c * float64(n))\n    }\n\n}\n</code></pre>\n\n<p>This converges as desired.</p>\n\n<hr>\n\n<p>Incidentally, note that initially you wanted something that converged to half a circle in radians (that is, to pi), but instead got something that converged to half a circle in degrees (that is, to 180). This is precisely because you handed degrees to <code>Cos</code> when you should have handed it radians.</p>\n"}], "owner": {"reputation": 1, "user_id": 9584078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79598df19e86ae8260b79dc0362f1a5d?s=128&d=identicon&r=PG&f=1", "display_name": "sdfasdfasdf", "link": "https://stackoverflow.com/users/9584078/sdfasdfasdf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": -9, "last_activity_date": 1564455389, "creation_date": 1564257506, "last_edit_date": 1564257663, "question_id": 57235618, "link": "https://stackoverflow.com/questions/57235618/trying-to-calculate-pi-in-go-what-am-i-doing-wrong-possibly-problem-with-math", "title": "Trying to calculate pi in go, what am I doing wrong? Possibly problem with math.Cos?", "body": "<p>I'm drawing a square inside a circle of diameter 1, the diagonal of the square is the diameter of the circle. I then split this square into 4 right angled triangles, using cosine law and knowing that the lengths of a and b on the triangle are 0.5, I create 4 triangles whose hypotenuses add together to form the perimeter of the square. Giving us the equation perimeter = number of sides * (a^2 + b^2 -2abcos(360 / number of sides)) By increasing the number of sides on this shape the perimeter gets closer and closer to the perimeter of the circle (3.14).</p>\n\n<p>I've done this in python before, and it worked, but there was a problem with using cosine law on degrees instead of rad in python that messed it up.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n\n    for n := float64(4) ; n == n; n *= 2 {\n        fmt.Println(n)\n        c := math.Pow(0.5 - (0.5 * math.Cos(360 / n)), 0.5)\n        fmt.Println(c * n)\n    }\n\n}\n</code></pre>\n\n<p>The answer should start at about 3, and go up approaching 3.14, but instead the answer goes up to 180 instead. I've checked my math over and over again, but I think it's a problem with the language not what I am doing.</p>\n"}, {"tags": ["go", "radial-gradients"], "comments": [{"owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "edited": false, "score": 1, "creation_date": 1564288063, "post_id": 57235442, "comment_id": 100977614, "body": "Seems likely to be due to excessive rounding error in the <code>Lerp</code> function. Can you share that function body?"}, {"owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "reply_to_user": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "edited": false, "score": 0, "creation_date": 1564358810, "post_id": 57235442, "comment_id": 100992416, "body": "@bcmills added to the question. Thanks!"}, {"owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "edited": false, "score": 0, "creation_date": 1564424748, "post_id": 57235442, "comment_id": 101018216, "body": "Wait, why are you passing a constant <code>t</code> at all?  That seems like it would make the <code>Lerp</code> call equivalent to just <code>v1</code>, in which case you may as well write the call site as <code>v = 1 - (d &#47; float64(radius))</code>"}], "owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564358651, "creation_date": 1564255951, "last_edit_date": 1564358651, "question_id": 57235442, "link": "https://stackoverflow.com/questions/57235442/banding-in-radial-gradient", "title": "Banding in radial gradient", "body": "<p>I generate a radial gradient with this code:</p>\n\n<pre><code>func GenerateGradient(center ds.Coord, radius int, dMethod string) *[]GradientRecord {\nvar r []GradientRecord\nfor y := center.Y - radius; y &lt;= center.Y+radius; y++ {\n    for x := center.X - radius; x &lt;= center.X+radius; x++ {\n        d := float64(DCalc(center, ds.Coord{X: x, Y: y}, dMethod))\n        p := ds.Coord{X: x, Y: y}\n        var v float64\n        v = Lerp(float64(radius), d, 1)\n        record := GradientRecord{Point: p.Wrap(\"t\"), Value: v}\n        r = append(r, record)\n    }\n}\nreturn &amp;r\n</code></pre>\n\n<p>}</p>\n\n<p>DCalc is using the Euclidean distance.</p>\n\n<p>Producing this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lq4IK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lq4IK.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, it's smooth. But I want the gradient to finish where the radious, so in the Lerp line I change it to:</p>\n\n<pre><code>    v = 1 - Lerp(float64(radius), d/float64(radius), 1)\n</code></pre>\n\n<p>Producing this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wywAQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wywAQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see there is a cross shaped banding. Wonder if there is a way to remove it? I actually do not need to generate an image, just a smooth gradient transition array for other stuff. I made a picture to expain better the issue..</p>\n\n<p>Thanks!</p>\n\n<pre><code>func Lerp(v0, v1, t float64) float64 {\nreturn (1-t)*v0 + t*v1\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["mongodb", "go", "heroku", "mongodb-atlas"], "comments": [{"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 1, "creation_date": 1564703602, "post_id": 57235190, "comment_id": 101127830, "body": "Could you try upgrading to Go 1.12 and see if you still see the problem ?"}, {"owner": {"reputation": 251, "user_id": 10897835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fad722ff71d6330172fc91a8118022f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10897835/alex"}, "reply_to_user": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1564761634, "post_id": 57235190, "comment_id": 101149994, "body": "@WanBachtiar I will try when i get home from work. Any reason why you think this may work? It works locally for me so I initially ruled out the go version being the culprit. But certainly worth a try"}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 1, "creation_date": 1564967157, "post_id": 57235190, "comment_id": 101190304, "body": "This is because as of Go 1.12, CA certs in Keychains are supported if correctly installed. Just wanted to rule that out."}, {"owner": {"reputation": 251, "user_id": 10897835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fad722ff71d6330172fc91a8118022f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10897835/alex"}, "reply_to_user": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1565187717, "post_id": 57235190, "comment_id": 101274905, "body": "@WanBachtiar You saved me from going nuts. I upgraded to 1.12 and it was able to connect via Heroku!"}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1565221613, "post_id": 57235190, "comment_id": 101288479, "body": "Speaking about going nuts,  worth mentioning that there is also Go Nuts mailing list <a href=\"https://golang.org/help/#mailinglist\" rel=\"nofollow noreferrer\">golang.org/help/#mailinglist</a> ;)"}], "answers": [{"tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 1, "last_activity_date": 1565216977, "creation_date": 1565216977, "answer_id": 57403022, "question_id": 57235190, "link": "https://stackoverflow.com/questions/57235190/official-mongodb-go-driver-heroku-connection-to-mongodb-atlas-sandbox/57403022#57403022", "title": "official mongodb go-driver heroku connection to mongodb atlas sandbox", "body": "<p>This is related to issue <a href=\"https://github.com/golang/go/issues/24652\" rel=\"nofollow noreferrer\">crypto/x509: root_cgo_darwin and root_nocgo_darwin omit some system certs</a>. The issue where some CA certs in keychains are omitted. </p>\n\n<p>The fix was released in Go v1.12, and also back-ported to Go v1.11.6. </p>\n"}], "owner": {"reputation": 251, "user_id": 10897835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fad722ff71d6330172fc91a8118022f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10897835/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 57403022, "answer_count": 1, "score": 0, "last_activity_date": 1565216977, "creation_date": 1564253769, "last_edit_date": 1564254815, "question_id": 57235190, "link": "https://stackoverflow.com/questions/57235190/official-mongodb-go-driver-heroku-connection-to-mongodb-atlas-sandbox", "title": "official mongodb go-driver heroku connection to mongodb atlas sandbox", "body": "<p><strong>go version:</strong> go1.11.2</p>\n\n<p><strong>connnection string:</strong> <code>mongodb+srv://&lt;username&gt;:&lt;pw&gt;@&lt;host&gt;/test?replicaSet=&lt;replicaSetName&gt;&amp;retryWrites=true&amp;w=majority</code></p>\n\n<p><strong>MongoDB Atlas:</strong> Network access is currently set to <code>0.0.0.0/0</code></p>\n\n<p><strong>MongoDB Atlas:</strong> Sandbox M0 MongoDB version <code>4.0.10</code></p>\n\n<p><strong>Heroku MongoDB addon:</strong> Sandbox</p>\n\n<p>I am attempting to connect from a heroku app to a MongoDB Atlas cluster with the above connection string. This works fine locally so I know the connection string is valid. \nHowever, whenever the app (golang app) starts up on heroku side I am getting the following errors.</p>\n\n<pre><code>2019/07/27 16:18:49 server selection error: server selection timeout\ncurrent topology: Type: ReplicaSetNoPrimary\nServers:\nAddr: rapi0-shard-00-02- \nyqd60.mongodb.net:27017, Type: Unknown, State: Connected, Average RTT: \n0, Last error: connection() : x509: certificate signed by unknown \nauthority\nAddr: rapi0-shard-00-00- \nyqd60.mongodb.net:27017, Type: Unknown, State: Connected, Average RTT: \n0, Last error: connection() : x509: certificate signed by unknown \nauthority\nAddr: rapi0-shard-00-01- \nyqd60.mongodb.net:27017, Type: Unknown, State: Connected, Average RTT: \n0, Last error: connection() : x509: certificate signed by unknown \nauthority\n</code></pre>\n\n<p>The errors seem to be TLS certificate related. I am using the <a href=\"https://github.com/mongodb/mongo-go-driver\" rel=\"nofollow noreferrer\">Official MongoDB Go Driver</a></p>\n\n<p>If this is TLS related why am I not getting this error locally?\nI found this issue which seems to be the same as mine, but I am not sure what to make of it .... <a href=\"https://jira.mongodb.org/browse/GODRIVER-835\" rel=\"nofollow noreferrer\">Related Issue</a></p>\n\n<p>Has anyone else had similar issues with connecting to MongoDB Atlas from Heroku using Golang?</p>\n\n<p>Please let me know if you need any more info. I am at a loss. I have tried various combinations of connection strings and nothing seems to work. </p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6601945, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767739936848222/picture?type=large", "display_name": "Bishwajeet Kumar", "link": "https://stackoverflow.com/users/6601945/bishwajeet-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1564400825, "creation_date": 1564400825, "answer_id": 57253215, "question_id": 57234111, "link": "https://stackoverflow.com/questions/57234111/create-a-record-with-associations-in-gorm/57253215#57253215", "title": "Create a record with Associations in GORM?", "body": "<p>Gorm is and object-relational mapping (ORM) framework for Go.\nTo create a record with association use something like this:</p>\n\n<pre><code>type (\n    Task struct {\n        Title       string    `gorm:\"column:title\"`\n        Description string    `gorm:\"column:description\"`\n        PriorityID  int64     `gorm:\"column:priority_id\"`\n        Priority    Priority  `gorm:\"foreignkey:PriorityID\"`\n    }\n\n    Priority struct {\n        ID        int64      `gorm:\"primary_key\"`\n        Name      string     `gorm:\"column:name\"`\n    }\n)\n</code></pre>\n\n<p>Then try to add </p>\n\n<pre><code>\ntask := Task{\n    Title:       \"Test Task!\",\n    Description: \"Test Task Description\",\n    Priority:    Priority{ID: 1},\n}\ndb.Create(&amp;task)\n\n</code></pre>\n\n<p>Please use this link for refer :\n<a href=\"https://gorm.io/docs/models.html\" rel=\"nofollow noreferrer\">Gorm Documentation</a></p>\n"}], "owner": {"reputation": 117, "user_id": 2080986, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6fa2b13793834c2a094a802bb0973201?s=128&d=identicon&r=PG", "display_name": "Moorani", "link": "https://stackoverflow.com/users/2080986/moorani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1241, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564628227, "creation_date": 1564245491, "last_edit_date": 1564628227, "question_id": 57234111, "link": "https://stackoverflow.com/questions/57234111/create-a-record-with-associations-in-gorm", "title": "Create a record with Associations in GORM?", "body": "<p>I am working on a project and relatively new to Golang. I am using <code>GORM</code> for my Database ORM. I don't know what I am doing wrong but I can't get to create records with associations. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type (\n    Task struct {\n        gorm.Model\n        Title       string    `json:\"title\"`\n        Description string    `json:\"description\"`\n        Priority    Priority  `json:\"priority_id\" validate:\"required\" gorm:\"foreignkey:PriorityID\"`\n        PriorityID  uint\n    }\n\n    Priority struct {\n        gorm.Model\n        Name      string     `json:\"name\"`\n    }\n)\n\n</code></pre>\n\n<p>And when I do</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>task := Task{\n    Title:       \"Test Task!\",\n    Description: \"Test Task Description\",\n    Priority:    Priority{ID: 1},\n}\ndb.Create(&amp;task)\n</code></pre>\n\n<p>It throws me this error:</p>\n\n<blockquote>\n  <p>[2019-07-27 18:34:35]  sql: converting argument $7 type:\n  unsupported type models.Priority, a struct</p>\n</blockquote>\n\n<p>I had a look at <a href=\"http://gorm.io/docs/associations.html\" rel=\"nofollow noreferrer\">GORM Associations</a> but couldn't really find any solution which could make it work.</p>\n"}, {"tags": ["go", "visual-studio-code", "gofmt"], "answers": [{"comments": [{"owner": {"reputation": 1002, "user_id": 10638608, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dabljues", "link": "https://stackoverflow.com/users/10638608/dabljues"}, "edited": false, "score": 0, "creation_date": 1564243899, "post_id": 57233849, "comment_id": 100970305, "body": "So basically everything is fine? I meet like the code guidelines? It&#39;s just how my editor renders the tab character, right? I also got Tab Width set to 4"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1002, "user_id": 10638608, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dabljues", "link": "https://stackoverflow.com/users/10638608/dabljues"}, "edited": false, "score": 1, "creation_date": 1564244067, "post_id": 57233849, "comment_id": 100970338, "body": "If you or your IDE runs <code>go fmt</code> on your code, everything will be fine."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1564244007, "last_edit_date": 1564244007, "creation_date": 1564243626, "answer_id": 57233849, "question_id": 57233737, "link": "https://stackoverflow.com/questions/57233737/vscode-go-input-tabs-of-size-4-instead-8/57233849#57233849", "title": "vscode-go input tabs of size 4 instead 8", "body": "<p><code>go fmt</code> uses tab characters (\"<code>\\t</code>\") to indent the beginning of a line. How a tab is displayed (tab width) is up to your text editor or IDE. I have Tab Width set to 4 in my text editors. My terminal program uses a tab width of 8.</p>\n\n<p>For example, for xed,</p>\n\n<blockquote>\n  <p>Editor Preferences</p>\n  \n  <p>Tabs</p>\n  \n  <p>Use the Tab width spin box to specify the width of the space that xed\n  inserts when you press the Tab key.</p>\n  \n  <p>Select the Insert spaces instead of tabs option to specify that xed\n  inserts spaces instead of a tab character when you press the Tab key.</p>\n</blockquote>\n"}], "owner": {"reputation": 1002, "user_id": 10638608, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dabljues", "link": "https://stackoverflow.com/users/10638608/dabljues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 1, "accepted_answer_id": 57233849, "answer_count": 1, "score": 1, "last_activity_date": 1564244007, "creation_date": 1564242747, "question_id": 57233737, "link": "https://stackoverflow.com/questions/57233737/vscode-go-input-tabs-of-size-4-instead-8", "title": "vscode-go input tabs of size 4 instead 8", "body": "<p>I have <code>Visual Studio Code Insiders</code> installed. Basically I've installed <code>Go</code> extension from Microsoft and written simple hello world app. Now I always use spaces to indent my code, but I saw that it changed to tabs of size 4. So I thought: yay, what a nice extension, now I can start to write my code. </p>\n\n<p>Then I remembered, that the default code indent from <code>gofmt</code> should be 8 as tabs. And I checked. <code>gofmt main.go</code> indeed outputs my code with tabs of size 8. But vscode keeps doing tabs of size 4. I thought maybe it doesn't even call <code>gofmt</code> but when I go RPM->Format document with - it actually does. But still, tabs of size 4. What am I doing wrong in this scenario?</p>\n\n<pre><code>    \"editor.renderWhitespace\": \"all\",\n    \"editor.fontFamily\": \"Hack\",\n    \"editor.fontSize\": 12,\n    \"editor.minimap.enabled\": false,\n    \"editor.fontLigatures\": true,\n    \"workbench.editor.enablePreview\": false,\n    \"editor.formatOnSave\": true,\n    \"editor.formatOnPaste\": true,\n    \"editor.cursorSmoothCaretAnimation\": true,\n    \"editor.detectIndentation\": false\n</code></pre>\n\n<p>Those my only editor settings and I dont have any custom settings regarding <code>Go</code> extension</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87, "user_id": 7164418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7a540e091ce26f50a7a48c120c6a87e4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian Wysocki", "link": "https://stackoverflow.com/users/7164418/damian-wysocki"}, "edited": false, "score": 0, "creation_date": 1564238086, "post_id": 57233041, "comment_id": 100968807, "body": "My question is how to avoid new line character from XML file not how to remove it. I wonder if it can be avoided, maybe I did something wrong."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564238922, "post_id": 57233041, "comment_id": 100969020, "body": "The code is missing a backslash. Use this: <code>strings.Replace(Location, &quot;\\n&quot;, &quot;&quot;, -1)</code>"}, {"owner": {"reputation": 87, "user_id": 7164418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7a540e091ce26f50a7a48c120c6a87e4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian Wysocki", "link": "https://stackoverflow.com/users/7164418/damian-wysocki"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564239036, "post_id": 57233041, "comment_id": 100969048, "body": "@CeriseLim&#243;n I already used this in code and It works but why I need to do this?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1564239483, "post_id": 57233041, "comment_id": 100969153, "body": "@DamianWysocki looking at the raw XML from the washingtonpost URL you give it contains things like &quot;&lt;sitemap&gt;\\n&lt;loc&gt;\\nhttps://\u2026\\n&lt;/loc&gt;\\n&lt;/sitemap&gt;\\n&quot;. In other words it seems to have a ton of extraneous newlines and in particular each <code>loc</code> element is &quot;\\nDATA\\n&quot;. I&#39;d probably use <code>strings.Trim(Location, &quot;\\n&quot;)</code> (or <code>strings.TrimSpace</code>) rather than replacing within the entire string."}, {"owner": {"reputation": 87, "user_id": 7164418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7a540e091ce26f50a7a48c120c6a87e4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian Wysocki", "link": "https://stackoverflow.com/users/7164418/damian-wysocki"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564240538, "post_id": 57233041, "comment_id": 100969449, "body": "@DaveC I missed that. What a shame. I thought that my Code are doing something wrong. Thanks for explemantion"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564330971, "post_id": 57233041, "comment_id": 100986478, "body": "The question is regarding this tutorial: <a href=\"https://pythonprogramming.net/go/parsing-xml-go-language-programming-tutorial/\" rel=\"nofollow noreferrer\">pythonprogramming.net/go/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564254950, "post_id": 57234098, "comment_id": 100973017, "body": "Just to clarify, <code>TrimSpace</code> only removes leading and trailing whitespace. It won&#39;t remove whitespace in the middle of a string."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 1, "creation_date": 1564318010, "post_id": 57234098, "comment_id": 100983243, "body": "@user2896976, correct but since it only needs to look at the start/end of the string it&#39;ll be faster. It already appears the source data is &quot;broken&quot; and it&#39;s a matter of how broken you expect it to ever be... is it just adding extraneous \\n at the begining and end (probable) or adding random whitespace at any old point within the URL (unlikely). Also note, the Trim functions can always just return a sub-string where-as Replace may need to allocate a new string (and may do so even in cases where it could just trim)."}, {"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1564412902, "post_id": 57234098, "comment_id": 101012802, "body": "Yes, I wanted to clarify because &quot;This will handle all extraneous whitespace that might be present in the file&quot; can easily be misinterpreted to mean, &quot;This will remove all whitespace present in the file&quot;"}], "tags": [], "owner": {"reputation": 46, "user_id": 11845915, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7e722c8dc4a6e1bbdd3634e20b796922?s=128&d=identicon&r=PG", "display_name": "nehoory", "link": "https://stackoverflow.com/users/11845915/nehoory"}, "is_accepted": true, "score": 3, "last_activity_date": 1564245367, "creation_date": 1564245367, "answer_id": 57234098, "question_id": 57233041, "link": "https://stackoverflow.com/questions/57233041/how-to-avoid-special-characters-in-string/57234098#57234098", "title": "How to avoid special characters in string", "body": "<p>The XML text contains newlines as mentioned by Dave C in a comment.  Because newline is not allowed in URLs, you must remove the newlines.</p>\n\n<p>Fix by replacing newline (instead of n) with \"\".  Note the backslash.</p>\n\n<pre><code>tempURL := strings.Replace(Location, \"\\n\", \"\", -1) \n</code></pre>\n\n<p>A better fix is to use strings.TrimSpace (also mentioned by Dave C). This will handle all extraneous whitespace that might be present in the file:</p>\n\n<pre><code>tempURL := strings.TrimSpace(Location) \n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7164418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7a540e091ce26f50a7a48c120c6a87e4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian Wysocki", "link": "https://stackoverflow.com/users/7164418/damian-wysocki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 57234098, "answer_count": 1, "score": 2, "last_activity_date": 1564245367, "creation_date": 1564237651, "last_edit_date": 1564237846, "question_id": 57233041, "link": "https://stackoverflow.com/questions/57233041/how-to-avoid-special-characters-in-string", "title": "How to avoid special characters in string", "body": "<p>I'm parsing XML which contains URLs and I want to iterate over this XML to get all URLs and make a request to each URL, but the strings contain new line character <code>\\n</code>. How can I avoid this new lines in URL?</p>\n\n<p>Go version is go1.12.7 darwin/amd64. I have solution for this problem I just removing this characters from string.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"strings\"\n)\n\n\n\ntype SitemapIndex struct {\n    Locations []string `xml:\"sitemap&gt;loc\"`\n}\n\ntype NewsMap struct {\n    Keyword  string\n    Location string\n}\n\ntype News struct {\n    Titles    []string `xml:\"url&gt;news&gt;title\"`\n    Keywords  []string `xml:\"url&gt;news&gt;keywords\"`\n    Locations []string `xml:\"url&gt;loc\"`\n}\n\n\nfunc main() {\n    var s SitemapIndex\n    var n News\n    newsMap := make(map[string]NewsMap)\n    resp, _ := http.Get(\"https://washingtonpost.com/news-sitemaps/index.xml\")\n    bytes, _ := ioutil.ReadAll(resp.Body)\n\n    xml.Unmarshal(bytes, &amp;s)\n\n    for _, Location := range s.Locations {\n        tempURL := strings.Replace(Location, \"n\", \"\", -1) // how to avoid new lines character in url?\n        resp, err := http.Get(tempURL)\n                // do some stuff...\n}\n\n</code></pre>\n\n<p>Without this replace method on Location Im getting an error\n<code>parse\nhttps://www.washingtonpost.com/news-sitemaps/politics.xml\n: net/url: invalid control character in URL\nexit status 1</code></p>\n\n<p>Here is example XML file <a href=\"https://www.washingtonpost.com/news-sitemaps/politics.xml\" rel=\"nofollow noreferrer\">https://www.washingtonpost.com/news-sitemaps/politics.xml</a></p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 1845404, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uwuMz.jpg?s=128&g=1", "display_name": "gbenroscience", "link": "https://stackoverflow.com/users/1845404/gbenroscience"}, "edited": false, "score": 0, "creation_date": 1564236825, "post_id": 57232931, "comment_id": 100968463, "body": "Wow. I cant believe I missed that. It was well hidden in plain sight.  Thanks a bunch.  Will test and revert"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 821, "user_id": 1845404, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uwuMz.jpg?s=128&g=1", "display_name": "gbenroscience", "link": "https://stackoverflow.com/users/1845404/gbenroscience"}, "edited": false, "score": 1, "creation_date": 1564236958, "post_id": 57232931, "comment_id": 100968505, "body": "I missed it at first, too, obviously. Easy mistake to make :)"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 1, "last_activity_date": 1564236756, "creation_date": 1564236756, "answer_id": 57232931, "question_id": 57232712, "link": "https://stackoverflow.com/questions/57232712/html-template-stored-in-map-crashes-on-first-invocation/57232931#57232931", "title": "Html template stored in map crashes on first invocation", "body": "<p>The problem is that <code>t</code> is undefined, due to variable shadowing:</p>\n\n<pre><code>t, ok := res.FetchTemplate(name)\nif !ok{\n    t := template.New(name) // &lt;---- The problem is here\n    t, err := t.ParseFiles(res.Assets + path)\n</code></pre>\n\n<p>Within your <code>if</code> block, you're re-defining <code>t</code> with <code>t := ...</code>. This means you have a new, locally-scoped <code>t</code>, and once you leave the <code>if</code> block, you still have the outer <code>t</code> which is still `nils.</p>\n\n<p>Change the marked line to:</p>\n\n<pre><code>    t = template.New(name)\n</code></pre>\n"}], "owner": {"reputation": 821, "user_id": 1845404, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uwuMz.jpg?s=128&g=1", "display_name": "gbenroscience", "link": "https://stackoverflow.com/users/1845404/gbenroscience"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 57232931, "answer_count": 1, "score": 1, "last_activity_date": 1564236756, "creation_date": 1564235215, "last_edit_date": 1564235860, "question_id": 57232712, "link": "https://stackoverflow.com/questions/57232712/html-template-stored-in-map-crashes-on-first-invocation", "title": "Html template stored in map crashes on first invocation", "body": "<p>I am using the function below to parse and save a Go template to a map the first time the template is invoked.</p>\n\n<p>Subsequently, the template is loaded from the map for optimization.</p>\n\n<pre><code>// Resource ...\ntype Resource struct {\n    Templates map[string]template.Template\n}\n\nfunc (res *Resource) FetchTemplate(templateName string) (template.Template, bool) {\n    tmpl, ok := res.Templates[templateName]\n    return tmpl, ok\n}\n\nfunc (res *Resource) ExecTemplate(w http.ResponseWriter, name, path string, model interface{}) error {\n    t, ok := res.FetchTemplate(name)\n    if !ok{\n        t := template.New(name)\n        t, err := t.ParseFiles(res.Assets + path)\n\n        t = template.Must(t, err)\n\n        if err != nil {\n            return err\n        }\n\n        res.Templates[name] = *t\n    }\n\n    if err := t.Execute(w, model); err != nil {\n        w.WriteHeader(http.StatusBadGateway)\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>The first time the code is invoked on a template however, it panics on the <code>t.Execute</code> call.</p>\n\n<p>It always works subsequently.</p>\n\n<p>Here are the error logs.</p>\n\n<pre><code>  /usr/local/go/src/net/http/server.go:1746 +0xd0\npanic(0x15b3ac0, 0x1b1c8d0)\n        /usr/local/go/src/runtime/panic.go:513 +0x1b9\nhtml/template.(*Template).escape(0xc000127088, 0x0, 0x0)\n        /usr/local/go/src/html/template/template.go:95 +0x32\nhtml/template.(*Template).Execute(0xc000127088, 0x4a90200, 0xc000374680, 0x15ed6c0, 0xc000370a20, 0x0, 0x0)\n        /usr/local/go/src/html/template/template.go:119 +0x2f\ngit.imaxinacion.net/uoe/anssid/app/resource.(*Resource).ExecTemplate(0xc0002ee120, 0x4a901b0, 0xc000374680, 0x16577a3, 0x5, 0x1660b7a, 0x10, 0x15ed6c0, 0xc000370a20, 0x145de5e, ...)\n        /Users/gbemirojiboye/go/src/git.imaxinacion.net/uoe/anssid/app/resource/resource.go:110 +0x1ef\n</code></pre>\n\n<p>What could be the cause of this?</p>\n\n<p>When I was creating a new template for each call, this was not happening.</p>\n"}, {"tags": ["go", "server"], "comments": [{"owner": {"reputation": 10261, "user_id": 295004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29d6038e4dcb7fac98ef41c002975e1?s=128&d=identicon&r=PG", "display_name": "Morrison Chang", "link": "https://stackoverflow.com/users/295004/morrison-chang"}, "edited": false, "score": 1, "creation_date": 1564207715, "post_id": 57229527, "comment_id": 100962908, "body": "Please do some research into the existing cloud hosting vendors, they have documentation and some have free tiers which will help in any decision you make."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1564217526, "post_id": 57229638, "comment_id": 100964517, "body": "Works with go flawlessly too"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1564221632, "post_id": 57229638, "comment_id": 100965268, "body": "Please do not answer opinion-based questions with opinionated answers. The question will soon be closed and deleted."}], "tags": [], "owner": {"reputation": 190, "user_id": 10052794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-h4z46BCniPY/AAAAAAAAAAI/AAAAAAAAAAk/a2EFo2xr2rg/photo.jpg?sz=128", "display_name": "Aleksandr Melnikov", "link": "https://stackoverflow.com/users/10052794/aleksandr-melnikov"}, "is_accepted": false, "score": 1, "last_activity_date": 1564207865, "creation_date": 1564207865, "answer_id": 57229638, "question_id": 57229527, "link": "https://stackoverflow.com/questions/57229527/how-to-host-a-backend-server/57229638#57229638", "title": "How to host a Backend Server?", "body": "<p>I recommend you <a href=\"https://devcenter.heroku.com/articles/getting-started-with-go\" rel=\"nofollow noreferrer\">heroku</a> service. This service give you free plan for start and give you some advices about uploading your app. I used it with Java/Kotlin, it worked fine.</p>\n"}], "owner": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "closed_date": 1564237363, "answer_count": 1, "score": -5, "last_activity_date": 1564219864, "creation_date": 1564206719, "last_edit_date": 1564219864, "question_id": 57229527, "link": "https://stackoverflow.com/questions/57229527/how-to-host-a-backend-server", "closed_reason": "Needs more focus", "title": "How to host a Backend Server?", "body": "<p>I created a backend application using golang which accept requests and send responses for my Android app which I also created. I'm able to use the server at home because we are connected to the same network. My question is how do I host the server so that I will be able to send requests anywhere. Is it possible to use hosting sites like hostgator? so it means that the ip of the server will be accessible to everyone? ex: 192.168.149.1:8888/api/getData. I hope this make sense, I have no experience in this cause I've always hosted my apps locally.  </p>\n"}, {"tags": ["go", "rabbitmq", "goroutine", "worker"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11044402"}, "edited": false, "score": 0, "creation_date": 1564216347, "post_id": 57229440, "comment_id": 100964256, "body": "I don&#39;t quite understand why you create five <i>new</i> workers as soon as <code>len(jobs)</code> is 1,000. Why do you want to do this? Why don&#39;t you keep the channel <code>jobs</code> and the five workers?"}, {"owner": {"reputation": 211, "user_id": 5498340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2473e3de554f0eb68d10fb35d3d9fa62?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Mohsenifar", "link": "https://stackoverflow.com/users/5498340/majid-mohsenifar"}, "edited": false, "score": 0, "creation_date": 1564220272, "post_id": 57229440, "comment_id": 100965018, "body": "you can ignore that, in my case since the jobs were not sent to workers,I though maybe it is because the channel is full so i create new workers with new channel, but besides that (removing that line of code) the problem exists"}, {"owner": {"reputation": 15060, "user_id": 7636961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7387f1ccd1200dc8dfb3b49aa0bc7a95?s=128&d=identicon&r=PG", "display_name": "Egor Stambakio", "link": "https://stackoverflow.com/users/7636961/egor-stambakio"}, "edited": false, "score": 0, "creation_date": 1564238881, "post_id": 57229440, "comment_id": 100969006, "body": "I&#39;m not sure it&#39;s relevant, but here <a href=\"https://godoc.org/github.com/streadway/amqp#Channel.Consume\" rel=\"nofollow noreferrer\">godoc.org/github.com/streadway/amqp#Channel.Consume</a> I read <code>call Delivery.Ack</code> ... <code>any unacknowledged deliveries will be requeued at the end of the same queue</code> - maybe this is the case?"}, {"owner": {"reputation": 211, "user_id": 5498340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2473e3de554f0eb68d10fb35d3d9fa62?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Mohsenifar", "link": "https://stackoverflow.com/users/5498340/majid-mohsenifar"}, "edited": false, "score": 0, "creation_date": 1564308436, "post_id": 57229440, "comment_id": 100981085, "body": "autoAck parameter is set to true, so ack happens automatically"}], "owner": {"reputation": 211, "user_id": 5498340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2473e3de554f0eb68d10fb35d3d9fa62?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Mohsenifar", "link": "https://stackoverflow.com/users/5498340/majid-mohsenifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564206065, "creation_date": 1564205641, "last_edit_date": 1564206065, "question_id": 57229440, "link": "https://stackoverflow.com/questions/57229440/data-are-missed-sending-through-channel-to-worker", "title": "data are missed sending through channel to worker", "body": "<p>I am using go as a cosumer of rabbitmq , I run 5 worker and send the data received from rabbitmq to them trough a channel, when the producer send data to rabbit the first 1000 (cap of channel) messages handled correctly but when the next batch of messages comes from rabbitmq only 5 of them (number of workers) sent to workers, when the other 1000 messages come the number of messages sent to workers reaches 1000 again.it seems some messages(in my case 995 are missing) is there anything I am misunderstanding about using worker in go? or could you please help me to solve the problem</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"github.com/streadway/amqp\"\n    \"log\"\n)\n\ntype job struct {\n    Receiver    string `json:\"receiver\"`\n    Subject     string `json:\"subject\"`\n    Content     string `json:\"content\"`\n    Priority    int    `json:\"priority\"`\n    ScheduledAt string `json:\"scheduledAt\"`\n    status      string\n}\n\nfunc newJob(data []byte) job {\n    job := job{}\n    json.Unmarshal(data, &amp;job)\n    job.status = \"pending\"\n    return job\n}\n\nvar count = 1\n\nconst url = \"amqp://rabbitmquser:some_password@rabbitmq:5672/\"\nconst queueName = \"email_queue_1\"\n\nfunc worker(id int, jobs &lt;-chan job, results chan&lt;- string, errors chan&lt;- string) {\n    for j := range jobs {\n        println(\"worker\", id, \"processed job\")\n        sendMessage(&amp;j)\n        saveJob(&amp;j)\n        results &lt;- \"done\"\n    }\n}\n\nfunc failOnError(err error, msg string) {\n    if err != nil {\n        log.Fatalf(\"%s: %s\", msg, err)\n    }\n}\n\nfunc main() {\n\n    con, err := amqp.Dial(url)\n    failOnError(err, \"failed to  connect to rabbitMq broker\")\n    defer con.Close()\n\n    ch, err := con.Channel()\n    failOnError(err, \"failed to open a channel\")\n    defer ch.Close()\n\n    q, err := ch.QueueDeclare(\n        queueName,\n        true,\n        false,\n        false,\n        false,\n        nil,\n    )\n\n    failOnError(err, \"Failed to declare a queue\")\n    msgs, err := ch.Consume(\n        q.Name,\n        \"\",\n        true,\n        false,\n        false,\n        false,\n        nil,\n    )\n    failOnError(err, \"Failed to register a consumer\")\n    forever := make(chan bool)\n\n\n    jobs, _, _ := createWorkers(5)\n\n    go func() {\n        for d := range msgs {\n            //log.Printf(\"here\")\n            job := newJob(d.Body)\n            //fmt.Println(job.status)\n            //fmt.Println(err)\n            jobs &lt;- job\n            if len(jobs) == 1000  {\n                jobs, _, _ = createWorkers(5)\n            }\n        }\n    }()\n\n    log.Printf(\" [*] Waiting for messages. To exit press CTRL+C\")\n    &lt;-forever\n}\n\nfunc createWorkers(i int) (chan job, chan string, chan string) {\n    jobs := make(chan job, 1000)\n    results := make(chan string, 1000)\n    errors := make(chan string, 1000)\n    for w := 1; w &lt;= i; w++ {\n        go worker(w, jobs, results, errors)\n    }\n    return jobs, results, errors\n}\n\nfunc sendMessage(job *job) {\n    //here we should send message to user\n    println(count)\n    count++\n    //send(*job)\n\n}\n\nfunc saveJob(job *job) {\n    //here we should save data with statuses in database\n}\n</code></pre>\n"}, {"tags": ["windows", "go", "cmd", "double-quotes", "backslash"], "comments": [{"owner": {"reputation": 7173, "user_id": 230550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b03741e14802e4e398974fc5e826a791?s=128&d=identicon&r=PG", "display_name": "Bodman", "link": "https://stackoverflow.com/users/230550/bodman"}, "edited": false, "score": 0, "creation_date": 1564206060, "post_id": 57229382, "comment_id": 100962653, "body": "Can we see how you are declaring &quot;command&quot;."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1564249404, "post_id": 57229382, "comment_id": 100971605, "body": "Totally wrong as unnecessary quoting. Thats all."}], "answers": [{"tags": [], "owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "is_accepted": true, "score": 1, "last_activity_date": 1564218594, "creation_date": 1564218594, "answer_id": 57230723, "question_id": 57229382, "link": "https://stackoverflow.com/questions/57229382/how-to-stop-golang-from-replacing-double-quotes-with-backslashes-when-executing/57230723#57230723", "title": "How to stop Golang from replacing double-quotes with backslashes when executing a Windows command?", "body": "<p>Your problem likely is that every separate string passed to <code>exec.Command</code> is passed on (without parsing it) as a single argument to <code>cmd.exe</code>, which does probably not split given strings either, so you have to do it yourself.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/13013520/6266540\">this example</a> where the argument is being split up too. You should be able to leave \" out since you split it up manually anyway, or write a program for it or run it with an interpreter which does the splitting.</p>\n\n<pre><code>func do() {\n    args := []string{\n        \"/C\",\n        \"start\",\n        \"\",\n        `C:\\Program Files (x86)\\Mozilla Thunderbird\\thunderbird.exe`,\n        \"-compose\",\n        \"to=\" + toAddress + \",subject=Subject1,body=Hello\",\n        \"-offline\",\n    }\n    cmd := exec.Command(\"cmd.exe\", args...)\n}\n</code></pre>\n"}], "owner": {"reputation": 1341, "user_id": 2488340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBH2R.jpg?s=128&g=1", "display_name": "Sean H. Worthington", "link": "https://stackoverflow.com/users/2488340/sean-h-worthington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 57230723, "answer_count": 1, "score": -3, "last_activity_date": 1564237200, "creation_date": 1564205069, "last_edit_date": 1564237200, "question_id": 57229382, "link": "https://stackoverflow.com/questions/57229382/how-to-stop-golang-from-replacing-double-quotes-with-backslashes-when-executing", "title": "How to stop Golang from replacing double-quotes with backslashes when executing a Windows command?", "body": "<p>I am writing a program in Golang that will use Mozilla's Thunderbird email client to send email. The Windows command that should be executed is: </p>\n\n<pre><code> start \"\" \"C:\\Program Files (x86)\\Mozilla Thunderbird\\thunderbird.exe\" -compose \"to='CloudCoin@Protonmail.com',subject='Subject1',body='Hello'\" -offline\n</code></pre>\n\n<p>My Go code looks like this (command is the one listed above) :</p>\n\n<pre><code>    var command string\n    command = `start \"\" \"C:\\Program Files (x86)\\Mozilla Thunderbird\\thunderbird.exe\"`\n    command += ` -compose \"to='` + toAddress + `',`\n    command += `subject='Subject1',`\n    command += `body='Hello'\"`\n    command += ` -offline`\n\n    cmd := exec.Command(\"cmd.exe\", \"/C\", command)\n</code></pre>\n\n<p>But I get an error: </p>\n\n<pre><code>Windows cannot find '\\\\'. Make sure you typed the name correctly, and then try again. \n</code></pre>\n\n<p>If I change the code to this (moving the word start):</p>\n\n<pre><code>    var command string\n    command = ` \"\" \"C:\\Program Files (x86)\\Mozilla Thunderbird\\thunderbird.exe\"`\n    command += ` -compose \"to='` + toAddress + `',`\n    command += `subject='Subject1',`\n    command += `body='Hello'\"`\n    command += ` -offline`\n\n    fmt.Println(\"Command: \" + command)\n\n    cmd := exec.Command(\"cmd.exe\", \"/C\", \"start\", command)\n</code></pre>\n\n<p>Then I get another error: </p>\n\n<pre><code>Windows cannot find 'Files'. Make sure you typed the name correctly, and then try again. \n</code></pre>\n\n<p>It seems that instead of trying to start \"\" it is trying to start \\\\. How can I keep my double-quotes?</p>\n"}, {"tags": ["go", "package"], "comments": [{"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564201982, "post_id": 57229041, "comment_id": 100962133, "body": "Ok. I missed it. But even after correcting that, there are errors - pl see edit in my question above."}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 1, "last_activity_date": 1564214818, "last_edit_date": 1564214818, "creation_date": 1564204653, "answer_id": 57229346, "question_id": 57229041, "link": "https://stackoverflow.com/questions/57229041/why-function-in-my-package-is-not-working/57229346#57229346", "title": "Why function in my package is not working", "body": "<p>You need to do few things</p>\n\n<ol>\n<li>I suggest to use a package name that the name is same with the folder name.</li>\n<li>The <code>myfn()</code> function need to be exported. How to do it: simply set the first character of the function name to uppercase.</li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package mysrc // &lt;-- 1\n\nimport (\n    \"fmt\"\n)\n\nfunc Myfn() { // &lt;-- 2\n    fmt.Println(\"My own fn\")\n}\n</code></pre>\n\n<ol start=\"3\">\n<li><p>The <code>func</code> keyword is required before <code>main()</code> statement.</p></li>\n<li><p>To access a function from other package, you need to write down the package name before the function name. In this context it'll be <code>mysrc.Myfn()</code>.</p></li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"mysrc\"\n)\n\nfunc main() { // &lt;-- 3\n    mysrc.Myfn() // &lt;-- 4\n}\n</code></pre>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57229346, "answer_count": 1, "score": -4, "last_activity_date": 1564214818, "creation_date": 1564200373, "last_edit_date": 1564202020, "question_id": 57229041, "link": "https://stackoverflow.com/questions/57229041/why-function-in-my-package-is-not-working", "title": "Why function in my package is not working", "body": "<p>I have put a small code file in <code>$GOPATH</code> which is <code>~/go/src</code>. Here I have made a folder <code>mysrc</code> and there I have kept a file <code>mytest.go</code>, which is as follows:</p>\n\n<pre><code>package mytest\nimport (\"fmt\")\nfunc myfn(){\n  fmt.Println(\"My own fn\")\n}\n</code></pre>\n\n<p>I try to import above code with following file: </p>\n\n<pre><code>package main\nimport (\"mysrc\")\nmain(){\n    myfn()\n}\n</code></pre>\n\n<p>When I try to run above file, I get error: </p>\n\n<pre><code># command-line-arguments\n./useMyfn.go:3:1: syntax error: non-declaration statement outside function body\n</code></pre>\n\n<p>Where is the problem and how can it be solved? Thanks for your help.</p>\n\n<p>Edit: I corrected the main fn to <code>func main()</code> but now the errors are:</p>\n\n<pre><code># command-line-arguments\n./useMyfn.go:2:9: imported and not used: \"mysrc\" as mytest\n./useMyfn.go:4:2: undefined: myfn\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 1, "creation_date": 1564201936, "post_id": 57228990, "comment_id": 100962130, "body": "where do you place the file?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1564202116, "post_id": 57228990, "comment_id": 100962143, "body": "are you sure you perform <code>go run</code> on correct file? because I tried your code in my local, I got no issues"}, {"owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "edited": false, "score": 0, "creation_date": 1564225521, "post_id": 57228990, "comment_id": 100966021, "body": "This is weird since <a href=\"https://godoc.org/internal/cpu?imports\" rel=\"nofollow noreferrer\">internal/cpu</a> imports  do not show importing runtime. Do you use an official Golang installation?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1564247559, "post_id": 57228990, "comment_id": 100971149, "body": "There&#39;s something wrong with your Go installation. Clean it out and install an up to date version of Go."}, {"owner": {"reputation": 197, "user_id": 11041613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM5ik.png?s=128&g=1", "display_name": "Dull Bananas", "link": "https://stackoverflow.com/users/11041613/dull-bananas"}, "edited": false, "score": 0, "creation_date": 1564247930, "post_id": 57228990, "comment_id": 100971250, "body": "I just found out that I accidentally set GOBIN instead of GOARCH; I just changed GOBIN to ~/.local/go/bin but it still doesn&#39;t work"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1564248190, "post_id": 57228990, "comment_id": 100971309, "body": "No, that&#39;s not relevant to the error (your source should not be in <code>~&#47;go</code> either, but that&#39;s also not the cause of the error). You&#39;re going to be much better off if you start with a current release, and use the defaults until you understand how things work."}, {"owner": {"reputation": 197, "user_id": 11041613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM5ik.png?s=128&g=1", "display_name": "Dull Bananas", "link": "https://stackoverflow.com/users/11041613/dull-bananas"}, "edited": false, "score": 0, "creation_date": 1564249120, "post_id": 57228990, "comment_id": 100971536, "body": "I just fixed it. I&#39;m using PythonAnywhere, which has an old version of Go installed at /usr/bin/go. I moved ~/.local/go/bin to the beginning of PATH instead of the end, and now I have a working program that advertises Trivago :)"}, {"owner": {"reputation": 197, "user_id": 11041613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM5ik.png?s=128&g=1", "display_name": "Dull Bananas", "link": "https://stackoverflow.com/users/11041613/dull-bananas"}, "edited": false, "score": 0, "creation_date": 1571452897, "post_id": 57228990, "comment_id": 103256672, "body": "Lesson learned here: Place new paths at the end of PATH instead of at the beginning"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 11041613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM5ik.png?s=128&g=1", "display_name": "Dull Bananas", "link": "https://stackoverflow.com/users/11041613/dull-bananas"}, "edited": false, "score": 0, "creation_date": 1564495515, "post_id": 57237995, "comment_id": 101045141, "body": "package main, imports fmt, imports errors, <b>imports runtime</b>, imports internal/bytealg, imports internal/cpu, <b>imports runtime</b>"}, {"owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "reply_to_user": {"reputation": 197, "user_id": 11041613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM5ik.png?s=128&g=1", "display_name": "Dull Bananas", "link": "https://stackoverflow.com/users/11041613/dull-bananas"}, "edited": false, "score": 0, "creation_date": 1564513820, "post_id": 57237995, "comment_id": 101053707, "body": "You should still file an issue with steps to reproduce. On every <code>go</code> release I&#39;m aware of, the <code>internal&#47;cpu</code> package does not import <code>runtime</code>."}, {"owner": {"reputation": 197, "user_id": 11041613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM5ik.png?s=128&g=1", "display_name": "Dull Bananas", "link": "https://stackoverflow.com/users/11041613/dull-bananas"}, "edited": false, "score": 0, "creation_date": 1565555255, "post_id": 57237995, "comment_id": 101381291, "body": "I was using an old version of the <code>go</code> program with the new version of everything else that usually goes in <code>&#47;usr&#47;local&#47;go</code>"}], "tags": [], "owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "is_accepted": false, "score": 1, "last_activity_date": 1564288777, "creation_date": 1564288777, "answer_id": 57237995, "question_id": 57228990, "link": "https://stackoverflow.com/questions/57228990/import-cycle-not-allowed-error-in-go-program/57237995#57237995", "title": "&quot;Import cycle not allowed&quot; error in Go program", "body": "<p>That error message seems wrong: the <code>import cycle not allowed</code> message is supposed to begin and end with the same package path.</p>\n\n<p>Please file an issue by filling out the template at <a href=\"https://golang.org/issue/new\" rel=\"nofollow noreferrer\">https://golang.org/issue/new</a>.</p>\n"}], "owner": {"reputation": 197, "user_id": 11041613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM5ik.png?s=128&g=1", "display_name": "Dull Bananas", "link": "https://stackoverflow.com/users/11041613/dull-bananas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1564288777, "creation_date": 1564199496, "last_edit_date": 1564205437, "question_id": 57228990, "link": "https://stackoverflow.com/questions/57228990/import-cycle-not-allowed-error-in-go-program", "title": "&quot;Import cycle not allowed&quot; error in Go program", "body": "<p>I am new to Go and I am trying to make a program that shows the current time and some other stuff:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// A terrible program.\npackage main\nimport (\n        \"fmt\"\n        \"time\"\n)\n// greeting returns a greeting with some info.\nfunc greeting() string {\n        return \"Hello flat world, the time is: \" + time.Now().String()\n}\nfunc main() {\n        hotelName := \"Trivag\"\n        hotelName += \"o\"\n        fmt.Println(greeting())\n        fmt.Println(\"Hotel: \" + hotelName)\n}\n</code></pre>\n\n<p>When I try running it with <code>go run</code>, it shows an import cycle error:</p>\n\n<pre><code>import cycle not allowed\npackage main\n        imports fmt\n        imports errors\n        imports runtime\n        imports internal/bytealg\n        imports internal/cpu\n        imports runtime\n</code></pre>\n\n<p>These are my Go environment variables from <code>go env</code>:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"amd64\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/dullgo/go\"\nGORACE=\"\"\nGOROOT=\"/home/dullgo/.local/go\"\nGOTOOLDIR=\"/home/dullgo/.local/go/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Edit: The .go file was placed directly in the ~/go directory.</p>\n"}, {"tags": ["google-app-engine", "go", "serialization", "datastore", "google-app-engine-go"], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1564239362, "post_id": 57229970, "comment_id": 100969126, "body": "The function in the answer is very similar to the function in the question.  Describe in words the difference between the functions or add a comment to the code calling out the fix."}], "tags": [], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "is_accepted": true, "score": 1, "last_activity_date": 1564289271, "last_edit_date": 1564289271, "creation_date": 1564211373, "answer_id": 57229970, "question_id": 57228805, "link": "https://stackoverflow.com/questions/57228805/how-to-implement-google-datastore-propertyloadsaver-with-arrays-of-structs/57229970#57229970", "title": "How to implement google datastore propertyloadsaver with arrays of structs", "body": "<p>After some amount of experimentation it turns out here is how to implement a <code>Save()</code> method for an object that has structs. The datastore.Property must store an array of <code>[]interface{}</code> holding <code>[]*datastore.Entity</code> rather than a pure <code>[]*datastore.Entity</code>: </p>\n\n<pre><code>func (p *Person) Save() ([]datastore.Property, error) {\n    props := []datastore.Property{\n        {\n            Name:  \"Name\",\n            Value: p.Name,\n        },\n    }\n\n    var n []interface{}\n    for _, x := range p.Phone {\n        i1 := datastore.Property{Name: \"Type\", Value: x.Type}\n        i2 := datastore.Property{Name: \"Number\", Value: x.Number}\n        e := &amp;datastore.Entity{Properties: []datastore.Property{i1, i2}}\n        n = append(n, e)\n    }\n    props = append(props, datastore.Property{Name:\"Phone\",Value:n})\n\n    return props, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 57229970, "answer_count": 1, "score": 0, "last_activity_date": 1564289271, "creation_date": 1564196383, "last_edit_date": 1564211534, "question_id": 57228805, "link": "https://stackoverflow.com/questions/57228805/how-to-implement-google-datastore-propertyloadsaver-with-arrays-of-structs", "title": "How to implement google datastore propertyloadsaver with arrays of structs", "body": "<p>How do you implement Load() and Save() for googles datastore when you have an array of structs? It is clearly possible, but how?</p>\n\n<p>Firstly, when you allow the datastore itself to serialise a <code>Person</code> with a list of <code>Phone</code> objects, you can use reflection to see it internally creates a list of <code>*datastore.Entity</code> objects:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n\n    \"cloud.google.com/go/datastore\"\n)\n\ntype Phone struct {\n    Type   string\n    Number string\n}\n\ntype Person struct {\n    Name  string\n    Phone []Phone\n}\n\nfunc main() {\n    person := Person{Name: \"Bob\", Phone: []Phone{Phone{\"a\", \"b\"}, Phone{\"c\", \"d\"}}}\n\n    // save here\n\n    }\n}\n</code></pre>\n\n<p>Here is my work so far, this saves the name field, but causes an error on the <code>*datastore.Entity</code> objects. here is my attempt:</p>\n\n<pre><code>func (p *Person) Save() ([]datastore.Property, error) {\n    props := []datastore.Property{\n        {\n            Name:  \"Name\",\n            Value: p.Name,\n        },\n    }\n\n    var n []*datastore.Entity\n    for _, x := range p.Phone {\n        i1 := datastore.Property{Name: \"Type\", Value: x.Type}\n        i2 := datastore.Property{Name: \"Number\", Value: x.Number}\n        e := &amp;datastore.Entity{Properties: []datastore.Property{i1, i2}}\n        n = append(n, e)\n    }\n    props = append(props, datastore.Property{Name:\"Phone\",Value:n})\n\n    return props, nil\n}\n</code></pre>\n\n<p>Datastore itself complains with the following error:</p>\n\n<pre><code>invalid Value type []*datastore.Entity for a Property with Name \"Phone\"\n</code></pre>\n\n<p>I wonder if anyone can elucidate where I am going wrong? How do I save an array of structs in datastore in the same way datastore itself does?</p>\n\n<p>Sample code above is on go playground: <a href=\"https://play.golang.org/p/AP1oFnlo1jm\" rel=\"nofollow noreferrer\">https://play.golang.org/p/AP1oFnlo1jm</a></p>\n"}, {"tags": ["go", "statistics"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1564196401, "post_id": 57228795, "comment_id": 100961539, "body": "As <code>go list</code> reports, there is no package with path &quot;stats&quot;.  Perhaps you intended to import &quot;github.com/montanaflynn/stats&quot;."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564196494, "post_id": 57228795, "comment_id": 100961557, "body": "Oh, you want to import &quot;golang.org/x/perf/internal/stats&quot;.  You cannot access this package because it&#39;s an internal package."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564197342, "post_id": 57228795, "comment_id": 100961622, "body": "Yes, this function is part of &quot;golang.org/x/perf/internal/stats&quot;. Why it is not being found? Should I delete <code>~&#47;go&#47;src&#47;golang.org&#47;x</code> folder?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564197756, "post_id": 57228795, "comment_id": 100961660, "body": "There are two issues.  The first is that the package is an internal package.  See <a href=\"https://golang.org/cmd/go/#hdr-Internal_Directories\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-Internal_Directories</a> for the rules about importing internal packages.   The second issue is that the application does not import &quot;golang.org/x/perf/internal/stats&quot;.  The fix is to change the &quot;stats&quot; import to&quot;golang.org/x/perf/internal/stats&quot;, but there&#39;s no point in doing this given the internal issue."}, {"owner": {"reputation": 150, "user_id": 1371385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4266a14462d1abdc4acbc4cec8fe4d75?s=128&d=identicon&r=PG", "display_name": "dotybear", "link": "https://stackoverflow.com/users/1371385/dotybear"}, "edited": false, "score": 0, "creation_date": 1610591242, "post_id": 57228795, "comment_id": 116184453, "body": "&quot;golang.org/x/perf/internal/stats&quot; looks like a really useful package. Why is it restricted to internal use?"}], "answers": [{"comments": [{"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1564199862, "post_id": 57229009, "comment_id": 100961889, "body": "Is there no way possible to use this function: <a href=\"https://godoc.org/golang.org/x/perf/internal/stats#MannWhitneyUTest\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/perf/internal/stats#MannWhitneyUTest</a> ?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 1, "creation_date": 1564199998, "post_id": 57229009, "comment_id": 100961906, "body": "importing internal packages is not allowed, so there is no other <i>correct</i> way. but maybe you can copy the code into your own codebase"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1564200786, "post_id": 57229009, "comment_id": 100961987, "body": "@rnso tested on my local, you can copy the stats folder into your codebase and use it, it&#39;s working fine."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1564202216, "post_id": 57229009, "comment_id": 100962151, "body": "I have copied the folder to <code>~&#47;go&#47;src&#47;stats</code>. It is still not working. What should I put for import. Currently it is just &quot;stats&quot;"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1564202365, "post_id": 57229009, "comment_id": 100962169, "body": "@rnso I assume you are new to Go. I suggest to take a look at <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> first. but anyway I&#39;ll update the answer shortly"}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1564214794, "post_id": 57229009, "comment_id": 100963989, "body": "Thanks for the link. With above changes, <code>MannWhitneyUTest</code> is found but<code>e</code> is still not found. Error is:  <code>undefined: e</code>"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1564214978, "post_id": 57229009, "comment_id": 100964020, "body": "@rnso if you take a look closely in my example, I changed your <code>e, _ =</code> code into <code>e, _ :=</code>"}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 1, "creation_date": 1564215264, "post_id": 57229009, "comment_id": 100964068, "body": "Yes, it works now. This is what happens when one tries to change languages. Thanks for your help."}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 2, "last_activity_date": 1564203567, "last_edit_date": 1564203567, "creation_date": 1564199753, "answer_id": 57229009, "question_id": 57228795, "link": "https://stackoverflow.com/questions/57228795/how-to-use-statistical-function-mannwhitneyutest-from-go-internal-packages/57229009#57229009", "title": "How to use statistical function (MannWhitneyUTest) from go internal packages", "body": "<p>The error occurs because your import path is incorrect, it should be:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"fmt\"\n    \"golang.org/x/perf/internal/stats\" \n)\n</code></pre>\n\n<p>But even though import path issue is fixed, you'll get another <a href=\"https://golang.org/doc/go1.4#internalpackages\" rel=\"nofollow noreferrer\">error for trying to use internal package</a>.</p>\n\n<blockquote>\n  <p>stats.go:4:5: use of internal package golang.org/x/perf/internal/stats not allowed</p>\n</blockquote>\n\n<p>I suggest try to find another alternative library.</p>\n\n<hr>\n\n<h1>EDIT #1:</h1>\n\n<p>If you insist, there is a workaround. Try to copy the <code>$GOPATH/src/golang.org/x/perf/internal/stats</code> folder directly into your project, then import it. It worked, please see screenshot below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Zn3KU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zn3KU.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h1>EDIT 2:</h1>\n\n<blockquote>\n  <p>I have copied the folder to ~/go/src/stats. It is still not working. What should I put for import. Currently it is just \"stats\"</p>\n</blockquote>\n\n<p>I think you are doing it wrong. First, you need to create what-so-called <strong>project</strong>, it's a folder placed inside <code>$GOPATH/src</code>.</p>\n\n<p>For example in image below I created a project called <code>my-example-app</code>, placed under <code>$GOPATH/src</code>. So the full path of the project will be <code>$GOPATH/src/my-example-app</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ayjBp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ayjBp.png\" alt=\"enter image description here\"></a></p>\n\n<p>Inside my project, I created <code>main.go</code> file. This file contains the code (I copied from yours).</p>\n\n<p>Also, I copied the <code>$GOPATH/src/golang.org/x/perf/internal/stats</code> folder into my project, so the <code>stats</code> folder will be on the same level with my <code>main.go</code>.</p>\n\n<p>The import of <code>stats</code> folder need to be happen relative to the project name, so the correct import path would be:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import \"my-example-app/stats\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OhQW4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OhQW4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is content of my <code>main.go</code> (copied from yours with some syntax error fix addition).</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"my-example-app/stats\"\n)\n\nfunc main() {\n    e, _ := stats.MannWhitneyUTest([]float64{1, 2, 3, 4, 5},\n        []float64{1, 2, 3, 5, 6},\n        0)\n    fmt.Println(\"Mann-WhitneyUTest: \", e)\n}\n</code></pre>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 57229009, "answer_count": 1, "score": -1, "last_activity_date": 1564215506, "creation_date": 1564196206, "last_edit_date": 1564215506, "question_id": 57228795, "link": "https://stackoverflow.com/questions/57228795/how-to-use-statistical-function-mannwhitneyutest-from-go-internal-packages", "title": "How to use statistical function (MannWhitneyUTest) from go internal packages", "body": "<p>I am trying to run <a href=\"https://godoc.org/golang.org/x/perf/internal/stats#MannWhitneyUTest\" rel=\"nofollow noreferrer\">Mann-Whiteney-U test</a> with following code: </p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"stats\" \n)\nfunc main() {\n    e, _ = MannWhitneyUTest([]float64{1, 2, 3, 4, 5}, \n                            []float64{1, 2, 3, 5, 6}, \n                            0) \n    fmt.Println(\"Mann-WhitneyUTest: \", e)\n}\n</code></pre>\n\n<p>However, this gives me this error: </p>\n\n<pre><code>$ go run mainstats2.go \nmainstats2.go:5:2: cannot find package \"stats\" in any of:\n        /usr/local/go/src/stats (from $GOROOT)\n        /home/iuser/go/src/stats (from $GOPATH)\n</code></pre>\n\n<p>I have following stats packages installed:</p>\n\n<pre><code>$ go list all | grep stats\ngithub.com/montanaflynn/stats\ngithub.com/montanaflynn/stats/examples\ngolang.org/x/perf/internal/stats\ngolang.org/x/perf/vendor/github.com/aclements/go-moremath/stats\ngolang.org/x/perf/vendor/google.golang.org/grpc/stats\n</code></pre>\n\n<p>I need stats package golang.org/x/perf/ which I had installed by command: <code>go get golang.org/x/perf/internal/stats</code></p>\n\n<p>I believe this package is already there in go installation and was not needed to be installed separately. </p>\n\n<p>How do I solve this problem? Thanks for your help.</p>\n"}, {"tags": ["postgresql", "go", "crud"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 12640, "user_id": 3583500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4ce1d8bc75165d4a798eea02c091e91?s=128&d=identicon&r=PG&f=1", "display_name": "khampson", "link": "https://stackoverflow.com/users/3583500/khampson"}, "edited": false, "score": 0, "creation_date": 1564200302, "post_id": 57228578, "comment_id": 100961937, "body": "Just to add to @khampson&#39;s answer, you are nowhere actually calling <code>CreateRate</code>, so even if you create the table, without first inserting something into it the <code>Test</code> would still fail. And one more thing, the way you handle errors in your <code>Test</code> handler is just wrong, first you&#39;re ignoring the error returned from <code>Open</code>, and then, when you call <code>First</code>, instead of checking if that produced an error you check the one returned from <code>Open</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1564223421, "post_id": 57228809, "comment_id": 100965624, "body": "To expand on this: <a href=\"https://stackoverflow.com/a/22572463/1296707\">using any ORM for database change management is a Very Bad Idea\u2122</a>."}], "tags": [], "owner": {"reputation": 12640, "user_id": 3583500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4ce1d8bc75165d4a798eea02c091e91?s=128&d=identicon&r=PG&f=1", "display_name": "khampson", "link": "https://stackoverflow.com/users/3583500/khampson"}, "is_accepted": false, "score": 2, "last_activity_date": 1564196466, "creation_date": 1564196466, "answer_id": 57228809, "question_id": 57228578, "link": "https://stackoverflow.com/questions/57228578/how-to-create-something-in-postgresql-database/57228809#57228809", "title": "How to create something in PostgreSQL Database", "body": "<p>The error is saying that the table <code>cryptos</code> does not currently exist, which is why the insert is not working and there's nothing in the database.</p>\n\n<p>I have not previously used <em>GORM</em> specifically, but if it's similar to other ORMs, you would need to create a data model representing the table, and then it could create the table using that model. A quick scan of its doc shows <em>GORM</em> has a function called <a href=\"https://godoc.org/github.com/jinzhu/gorm#DB.CreateTable\" rel=\"nofollow noreferrer\">CreateTable</a> that can be called against a <a href=\"https://godoc.org/github.com/jinzhu/gorm#DB.Model\" rel=\"nofollow noreferrer\">Model</a>.</p>\n\n<p>You could also create the table outside of <em>GORM</em> using regular <em>SQL</em> via a tool such as <em>psql</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "is_accepted": false, "score": 0, "last_activity_date": 1564326562, "creation_date": 1564326562, "answer_id": 57242154, "question_id": 57228578, "link": "https://stackoverflow.com/questions/57228578/how-to-create-something-in-postgresql-database/57242154#57242154", "title": "How to create something in PostgreSQL Database", "body": "<p>Addition to @khampson, you can use <code>AutoMigrate</code> feature:</p>\n\n<pre><code>type Product struct {\n  gorm.Model\n  Code string\n  Price uint\n}\n\n// Migrate the schema\ndb.AutoMigrate(&amp;Product{})\n</code></pre>\n\n<p><a href=\"https://gorm.io/docs/index.html\" rel=\"nofollow noreferrer\">Full example</a>.</p>\n"}], "owner": {"reputation": 81, "user_id": 11809258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddacbb88d051a0412d3947798845cec?s=128&d=identicon&r=PG&f=1", "display_name": "DonPepemon", "link": "https://stackoverflow.com/users/11809258/donpepemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1601425916, "answer_count": 2, "score": -1, "last_activity_date": 1564326562, "creation_date": 1564192635, "last_edit_date": 1564196618, "question_id": 57228578, "link": "https://stackoverflow.com/questions/57228578/how-to-create-something-in-postgresql-database", "closed_reason": "Duplicate", "title": "How to create something in PostgreSQL Database", "body": "<p>I'm learning to use PostgreSQL and GORM. I'm creating a struct, connecting to database, and trying to write in to database. </p>\n\n<p>Source code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>db, err := gorm.Open(\"postgres\",\"user=superuser password=ojcafizp123 dbname=gorm sslmode=disable\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    database := db.DB()\n\n    err = database.Ping()\n\n    if err != nil {\n        panic(err.Error())\n    }\n\n    fmt.Println(\"Connection to PostgreSQL was successful!\")\n\n    port := \":3000\"\n    r := chi.NewRouter()\n    r.Get(\"/api/test\",Test)\n    http.ListenAndServe(port, r)\n}\n\n\n\nfunc CreateRate (w http.ResponseWriter, r *http.Request) {\n    db, err := gorm.Open(\"postgres\",\"user=superuser password=ojcafizp123 dbname=gorm sslmode=disable\")\n    cure := Crypto{\"BTC\",\"USD\",10000,100}\n    if db.NewRecord(cure) {\n        err = db.Create(&amp;cure).Error\n        if err != nil{\n            panic(err.Error())\n\n        }\n    }\n}\n</code></pre>\n\n<p>Struct:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Crypto struct {\n    Cur1 string `json:\"cur1\"`\n    Cur2 string `json:\"cur2\"`\n    Rate float64 `json:\"rate\"`\n    Timestamp int64 `json:\"timestamp\"`\n}\n</code></pre>\n\n<p>Trying to find my record in the database:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Test (w http.ResponseWriter, r *http.Request) {\n    db, err := gorm.Open(\"postgres\",\"user=superuser password=ojcafizp123 dbname=gorm sslmode=disable\")\n    var testcur Crypto\n    db.First(&amp;testcur)\n    fmt.Println(testcur)\n    if err != nil {\n        fmt.Println(\"No testcur detected\")\n    }\n\n}\n</code></pre>\n\n<p>But got this:</p>\n\n<blockquote>\n  <p>Connection to PostgreSQL was successful! {  0 0}</p>\n  \n  <p>(/home/superuser/go/src/CryptoProject/main.go:97)  [2019-07-27\n  05:09:10]  pq: relation \"cryptos\" does not exist</p>\n</blockquote>\n\n<p>The connection is working, but the base is still empty.</p>\n"}, {"tags": ["go", "registry"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11843721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rXfR1dkccEg/AAAAAAAAAAI/AAAAAAAAAAc/7yRwMywsroM/photo.jpg?sz=128", "display_name": "n3stro", "link": "https://stackoverflow.com/users/11843721/n3stro"}, "edited": false, "score": 0, "creation_date": 1564229723, "post_id": 57228599, "comment_id": 100966857, "body": "Thanks for answer, but this not helped"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 0, "last_activity_date": 1564193710, "last_edit_date": 1564193710, "creation_date": 1564192947, "answer_id": 57228599, "question_id": 57228321, "link": "https://stackoverflow.com/questions/57228321/how-to-get-value-from-registry-on-x86-application-running-on-64bit-system-via-go/57228599#57228599", "title": "How to get value from registry on x86 application running on 64bit system via go programming language?", "body": "<p>You need to run the application with administrator privilege.</p>\n\n<ol>\n<li>Open <code>CMD</code> as Administrator</li>\n<li>Go to your project folder, then run the application</li>\n</ol>\n"}], "owner": {"reputation": 17, "user_id": 11843721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rXfR1dkccEg/AAAAAAAAAAI/AAAAAAAAAAc/7yRwMywsroM/photo.jpg?sz=128", "display_name": "n3stro", "link": "https://stackoverflow.com/users/11843721/n3stro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564229799, "creation_date": 1564188076, "last_edit_date": 1564229799, "question_id": 57228321, "link": "https://stackoverflow.com/questions/57228321/how-to-get-value-from-registry-on-x86-application-running-on-64bit-system-via-go", "title": "How to get value from registry on x86 application running on 64bit system via go programming language?", "body": "<p>I can't get values from keys in windows registry.\nI compile my application with this settings </p>\n\n<pre><code>GOOS=windows GOARCH=386 go build -o test.exe test.go &amp;&amp; ./test.exe\n</code></pre>\n\n<p>via go version go1.12.7 windows/amd64\nrunning on 64-bit OS Windows 10</p>\n\n<p>i getting value of key via this code</p>\n\n<pre><code>k, err := registry.OpenKey(registry.LOCAL_MACHINE, &lt;my_key_path_variable&gt;, registry.QUERY_VALUE|registry.WOW64_32KEY)\n...\nvalue, _, err := k.GetStringValue(`Path`)\n</code></pre>\n\n<p>I successfully getting value from \n<em>HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node</em>, but when i get key (not value) from <em>HKEY_LOCAL_MACHINE\\SOFTWARE</em> i'm getting error \"The system cannot find the file specified.\", but key is 100% exists in registry. Please help. Thanks.</p>\n"}, {"tags": ["go", "protobuf-go"], "answers": [{"comments": [{"owner": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1567549528, "post_id": 57330636, "comment_id": 101993598, "body": "Please, can you be more explicit on how did you fix this, Would appreciate your help. I want to know how did you fix the dependencies."}, {"owner": {"reputation": 31, "user_id": 9206431, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mAJGeoxDYWE/AAAAAAAAAAI/AAAAAAAAgRo/YAiLlUDIhRU/photo.jpg?sz=128", "display_name": "ntalcus", "link": "https://stackoverflow.com/users/9206431/ntalcus"}, "reply_to_user": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1573447038, "post_id": 57330636, "comment_id": 103872366, "body": "Hi, Invictus. I was a bit imprecise in my wording. We fixed the versioning of dependencies that we were using in our repository to a set we knew had worked in the past."}], "tags": [], "owner": {"reputation": 31, "user_id": 9206431, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mAJGeoxDYWE/AAAAAAAAAAI/AAAAAAAAgRo/YAiLlUDIhRU/photo.jpg?sz=128", "display_name": "ntalcus", "link": "https://stackoverflow.com/users/9206431/ntalcus"}, "is_accepted": false, "score": 0, "last_activity_date": 1564764450, "creation_date": 1564764450, "answer_id": 57330636, "question_id": 57228215, "link": "https://stackoverflow.com/questions/57228215/marshaltosizedbuffer-for-structs-undefined-when-compiling-protobuf-and-attemptin/57330636#57330636", "title": "MarshalToSizedBuffer for structs undefined when compiling protobuf and attempting to use it in other packages", "body": "<p>We resolved this issue by fixing the dependencies to a prior working version and upping our different golang repo's to be in the same major version.</p>\n"}], "owner": {"reputation": 31, "user_id": 9206431, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mAJGeoxDYWE/AAAAAAAAAAI/AAAAAAAAgRo/YAiLlUDIhRU/photo.jpg?sz=128", "display_name": "ntalcus", "link": "https://stackoverflow.com/users/9206431/ntalcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 997, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1564764450, "creation_date": 1564186710, "question_id": 57228215, "link": "https://stackoverflow.com/questions/57228215/marshaltosizedbuffer-for-structs-undefined-when-compiling-protobuf-and-attemptin", "title": "MarshalToSizedBuffer for structs undefined when compiling protobuf and attempting to use it in other packages", "body": "<p>I'm using gogo/protobuf to generate protobufs for gRPC calls but recently they started failing due a marshalling method not being correctly generated. The error looks like this:</p>\n\n<pre><code>service/v1/service.pb.go:1347:27: m.ListMeta.MarshalToSizedBuffer undefined (type *\"k8s.io/apimachinery/pkg/apis/meta/v1\".ListMeta has no field or method MarshalToSizedBuffer)\n</code></pre>\n\n<p>I've tried reinstalling go and goenv, using a different gvm, and reverting changes to the proto files. The issue seems to resolve on our last stable branch of our proto files but if I make any changes the issue recurs. This is across two repos, one (proto files repo) using golang 1.11.1 and the other using golang 1.12.5.</p>\n\n<p>I expected all methods that the protobufs needed to be generated in using the package.</p>\n"}, {"tags": ["go", "base64", "gmail-api", "base64url"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1564189494, "post_id": 57227829, "comment_id": 100960929, "body": "The base64 encoder handles all byte values including newline.  Use &quot;Show Original&#39; in Gmail to view the raw message bytes received. It&#39;s possible that newlines were sent as you expect, but the message is rendered as HTML."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564241043, "post_id": 57227829, "comment_id": 100969581, "body": "Unrelated to your problem, but I&#39;m pretty sure you want to use <code>base64.RawURLEncoding</code> if you don&#39;t want padding (your function uses the padded version and then appears to manually strip out the padding)."}, {"owner": {"reputation": 1691, "user_id": 9609442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bC135.jpg?s=128&g=1", "display_name": "Gabe", "link": "https://stackoverflow.com/users/9609442/gabe"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564264420, "post_id": 57227829, "comment_id": 100975017, "body": "@CeriseLim&#243;n where is the option to &#39;Show Original&#39; in Gmail, and how do I do it?"}, {"owner": {"reputation": 1691, "user_id": 9609442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bC135.jpg?s=128&g=1", "display_name": "Gabe", "link": "https://stackoverflow.com/users/9609442/gabe"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1564265680, "post_id": 57227829, "comment_id": 100975193, "body": "@DaveC can you include a code example of how to use <code>base64.RawURLEncoding</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1564267694, "post_id": 57227829, "comment_id": 100975498, "body": "&quot;Show Original&quot; is in the more menu (three vertical dots) in the message view.  Show the code the sets the message headers.  I suspect that the application is not setting or incorrectly setting the content type."}], "answers": [{"tags": [], "owner": {"reputation": 1691, "user_id": 9609442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bC135.jpg?s=128&g=1", "display_name": "Gabe", "link": "https://stackoverflow.com/users/9609442/gabe"}, "is_accepted": true, "score": 0, "last_activity_date": 1564267673, "creation_date": 1564267673, "answer_id": 57236623, "question_id": 57227829, "link": "https://stackoverflow.com/questions/57227829/adding-newline-to-base64url-string/57236623#57236623", "title": "Adding newline to base64url string", "body": "<p>I finally fixed it. I had to change the content type from <code>text/html</code> to <code>text/plain</code>, and now the newlines show properly on the email client</p>\n"}], "owner": {"reputation": 1691, "user_id": 9609442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bC135.jpg?s=128&g=1", "display_name": "Gabe", "link": "https://stackoverflow.com/users/9609442/gabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 57236623, "answer_count": 1, "score": 0, "last_activity_date": 1564267673, "creation_date": 1564181980, "last_edit_date": 1564265433, "question_id": 57227829, "link": "https://stackoverflow.com/questions/57227829/adding-newline-to-base64url-string", "title": "Adding newline to base64url string", "body": "<p>I have a program that is sending a base64url encoded string, but I read in places that the '\\' character isn't supported by base64. My purpose is to send emails with the <a href=\"https://developers.google.com/gmail/api/v1/reference/\" rel=\"nofollow noreferrer\">Gmail API</a> in Go. The body part consists of the following:</p>\n\n<pre><code>\"Name: \\n\\nThis is the body of the email\\n\\nSincerely,\\nSenderName\"\n</code></pre>\n\n<p>When I <a href=\"https://developers.google.com/gmail/api/guides/sending\" rel=\"nofollow noreferrer\">send emails through the Gmail API</a>, I need to pass it a base64url string.\nI have the following function to handle that:</p>\n\n<pre><code>func encodeWeb64String(b []byte) string {\n\n    s := base64.URLEncoding.EncodeToString(b)\n\n    var i = len(s) - 1\n    for s[i] == '=' {\n        i--\n    }\n\n    return s[0 : i+1]\n}\n</code></pre>\n\n<p>I have already added the header information to msg following this <a href=\"https://stackoverflow.com/questions/25382821/how-to-send-email-through-gmail-go-sdk\">post</a>, and have set the content type to <code>text/html; charset=\\\"utf-8\\\"</code>. I then create the Gmail message using this:</p>\n\n<pre><code>gmsg := gmail.Message{\n    Raw: encodeWeb64String([]byte(msg)),\n}\n</code></pre>\n\n<p>When the email comes through, it looks like this:</p>\n\n<blockquote>\n  <p>Name: This is the body of the email Sincerely, SenderName</p>\n</blockquote>\n\n<p>But I want each '\\n' to put in actual newline. Thanks for any help, I am new with the Gmail API for Go.</p>\n"}]