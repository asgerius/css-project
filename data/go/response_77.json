[{"tags": ["http", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467238328, "post_id": 38110875, "comment_id": 63655331, "body": "<code>AddForm</code> isn&#39;t a full html page, it&#39;s just the form fragment. Plus you&#39;re returning <code>Content-Type: text&#47;plain</code>. Is there more to the example? This would never have worked wit the Go std lib."}, {"owner": {"reputation": 1069, "user_id": 3806343, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/tzFZo.png?s=128&g=1", "display_name": "cookieisaac", "link": "https://stackoverflow.com/users/3806343/cookieisaac"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467246224, "post_id": 38110875, "comment_id": 63657770, "body": "The book is <a href=\"https://ia800702.us.archive.org/8/items/TheWayToGo/The_Way_To_Go.pdf\" rel=\"nofollow noreferrer\">here</a> and reading at Page 517. There are some other code, but definitely unrelated to html render here. The code is <a href=\"https://sites.google.com/site/thewaytogo2012/Downhome/Topic3\" rel=\"nofollow noreferrer\">here</a>, in the zip file, in chapter19/goto_v1/main.go"}], "answers": [{"tags": [], "owner": {"reputation": 1069, "user_id": 3806343, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/tzFZo.png?s=128&g=1", "display_name": "cookieisaac", "link": "https://stackoverflow.com/users/3806343/cookieisaac"}, "is_accepted": true, "score": 17, "last_activity_date": 1467249365, "creation_date": 1467249365, "answer_id": 38112462, "question_id": 38110875, "link": "https://stackoverflow.com/questions/38110875/how-to-display-html-string-as-a-web-page-using-golang-http-responsewriter/38112462#38112462", "title": "How to display HTML string as a web page using Golang http.ResponseWriter?", "body": "<p>After reading through the doc, in current version of golang, http.ResponseWriter has a default Content-type as <code>text/plain</code>, and after manually set the content type as <code>text/html</code>, things are working as expected. </p>\n\n<pre><code>if url == \"\" {\n    w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n    fmt.Fprint(w, AddForm)\n    return\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 3782299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a9f74eaa9e78675a676e67db5b1b46?s=128&d=identicon&r=PG&f=1", "display_name": "user3782299", "link": "https://stackoverflow.com/users/3782299/user3782299"}, "is_accepted": false, "score": 0, "last_activity_date": 1467451578, "creation_date": 1467451578, "answer_id": 38158581, "question_id": 38110875, "link": "https://stackoverflow.com/questions/38110875/how-to-display-html-string-as-a-web-page-using-golang-http-responsewriter/38158581#38158581", "title": "How to display HTML string as a web page using Golang http.ResponseWriter?", "body": "<p>If you use HTML templates it is better.  Template checks your HTML for errors too.</p>\n\n<p><a href=\"https://play.golang.org/p/l9bUoWC4PZ\" rel=\"nofollow\">https://play.golang.org/p/l9bUoWC4PZ</a></p>\n\n<p>In Execute if you used w instaed of stdout in my example the content type would automatically be set</p>\n"}], "owner": {"reputation": 1069, "user_id": 3806343, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/tzFZo.png?s=128&g=1", "display_name": "cookieisaac", "link": "https://stackoverflow.com/users/3806343/cookieisaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11507, "favorite_count": 2, "accepted_answer_id": 38112462, "answer_count": 2, "score": 12, "last_activity_date": 1467451578, "creation_date": 1467238141, "question_id": 38110875, "link": "https://stackoverflow.com/questions/38110875/how-to-display-html-string-as-a-web-page-using-golang-http-responsewriter", "title": "How to display HTML string as a web page using Golang http.ResponseWriter?", "body": "<p>I'm following along the example in Chapter 19 from <em>The Way to Go</em>.</p>\n\n<p>This is the content of my <code>main.go</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nconst AddForm = `\n&lt;form method=\"POST\" action=\"/add\"&gt;\nURL: &lt;input type=\"text\" name=\"url\"&gt;\n&lt;input type=\"submit\" value=\"Add\"&gt;\n&lt;/form&gt;\n`\n\nfunc main() {\n    http.HandleFunc(\"/add\", Add)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc Add(w http.ResponseWriter, r *http.Request) {\n    url := r.FormValue(\"url\")\n    if url == \"\" {\n        fmt.Fprint(w, AddForm)\n        return\n    }\n    key := \"Placeholder\"\n    fmt.Fprintf(w, \"http://localhost:8080/%s\", key)\n}\n</code></pre>\n\n<p>According to the book and its screenshot, I should see a valid form rendered in my browser. But right now, I can only see the raw string.</p>\n\n<p>I'm very new to go, so I'm not sure if the language has evolved a lot since the example was written. My go version is <code>go version go1.6.2 linux/amd64</code> and I think the book is written in 2012 with older version of go. </p>\n\n<p>How do I modify it to make it render as a form in the browser? Thanks.</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": true, "score": 6, "last_activity_date": 1467232616, "creation_date": 1467232616, "answer_id": 38109605, "question_id": 38109507, "link": "https://stackoverflow.com/questions/38109507/golang-how-can-i-make-sql-row-a-string/38109605#38109605", "title": "Golang how can I make sql row a string", "body": "<p>Rows is a sql.Rows type. In order to use the data returned by your database query you will have to iterated over the \"rows\".</p>\n\n<p>An example from <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"noreferrer\">the docs</a></p>\n\n<pre><code>age := 27\nrows, err := db.Query(\"SELECT name FROM users WHERE age=?\", age)\nif err != nil {\n        log.Fatal(err)\n}\ndefer rows.Close()\nfor rows.Next() {\n        var name string\n        if err := rows.Scan(&amp;name); err != nil {\n                log.Fatal(err)\n        }\n        fmt.Printf(\"%s is %d\\n\", name, age)\n}\nif err := rows.Err(); err != nil {\n        log.Fatal(err)\n}\n</code></pre>\n\n<p>You should instead use <a href=\"https://golang.org/pkg/database/sql/#DB.QueryRow\" rel=\"noreferrer\">QueryRow</a> because you are expecting the database to return one result. In either case once you have used \"Scan\" to put the data into your own variable then you can either parse the JSON or print it out.</p>\n"}], "owner": {"reputation": 1821, "user_id": 5025978, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e0592a69df972d842ea313bacdee7f81?s=128&d=identicon&r=PG&f=1", "display_name": "Ignacio Perez", "link": "https://stackoverflow.com/users/5025978/ignacio-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5996, "favorite_count": 1, "accepted_answer_id": 38109605, "answer_count": 1, "score": 3, "last_activity_date": 1467232616, "creation_date": 1467232255, "question_id": 38109507, "link": "https://stackoverflow.com/questions/38109507/golang-how-can-i-make-sql-row-a-string", "title": "Golang how can I make sql row a string", "body": "<p>I am using Golang and Postgres, Postgres has an advance feature where it can return your queries in Json format. What I want to do is get that Json query results and return it but I am having trouble since it has to be a String in order to return it. This is my code</p>\n\n<pre><code> package main\n\n    import(\n        \"fmt\"\n        \"database/sql\"\n        _ \"github.com/lib/pq\"\n\n        \"log\"\n    )\n\n    func HelloServer(w http.ResponseWriter, req *http.Request) {\n\n     db, err := sql.Open(\"postgres\", \"user=postgres password=password dbname=name sslmode=disable\")\n\n        if err != nil {\n            log.Fatal(err)\n        }\n\n         defer db.Close()\n        rows, err := db.Query(\"select To_Json(t) (SELECT * from cars)t\")\n\n    io.WriteString(w, \"hello, world!\\n\")\n}\n\n\n func main() {\n    http.HandleFunc(\"/hello\", HelloServer)\n    log.Fatal(http.ListenAndServe(\":12345\", nil))\n}\n</code></pre>\n\n<p>The <code>Rows</code> element returns a Json array how can I turn that Rows element into a String ? For C# and Java I would just append the <strong>.ToString()</strong> method to it and it would make it a string . As you can see from the code above the <strong>io.WriteString</strong> takes a <strong>String</strong> as a second parameter so I want to make the <strong>Rows</strong> variable a String after it has the Json returned so that I can display it in the browser by passing it to the method. I want to replace the Hello World with the String Rows.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467225413, "post_id": 38107565, "comment_id": 63648829, "body": "What uuid package are you using? The 16 bytes of uuid data aren&#39;t going to match that string format. Also, if you know the type is a uuid.UUID, then why try to validate again if it&#39;s a uuid?"}, {"owner": {"reputation": 357, "user_id": 1100765, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/37522facc8f6a42a2907ff8e4627a1ca?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1100765/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467225928, "post_id": 38107565, "comment_id": 63649133, "body": "@JimB Goa seems to have their own uuid implementation.  Moreover, their package imports github.com/satori/go.uuid.  You make a valid point about the validation, what I want is basically to make sure a valid uuid is existent in the payload before the request is sent.  Is this logic the wrong way to go about it?"}], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 1100765, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/37522facc8f6a42a2907ff8e4627a1ca?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1100765/alex"}, "edited": false, "score": 0, "creation_date": 1467233431, "post_id": 38107976, "comment_id": 63653125, "body": "ctx.MemberID is of type github.com/goadesign/goa/uuid and not github.com/satori/go.uuid so the RFC variant and version are undefined."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 357, "user_id": 1100765, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/37522facc8f6a42a2907ff8e4627a1ca?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1100765/alex"}, "edited": false, "score": 0, "creation_date": 1467234200, "post_id": 38107976, "comment_id": 63653523, "body": "@Alex, (sorry, realized my connection failed, and the doc page was still on satori/go.uuid). The functions from the satori/go.uuid package are small and easy to copy. There&#39;s not a lot of benefit to checking though, since for the purpose of a unique identifier, checking that almost 16 bytes of random data have a couple non-random bits doesn&#39;t gain much."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1467236089, "last_edit_date": 1467236089, "creation_date": 1467226595, "answer_id": 38107976, "question_id": 38107565, "link": "https://stackoverflow.com/questions/38107565/type-assertion-on-goa-package-uuid-uuid/38107976#38107976", "title": "Type assertion on Goa package (uuid.UUID)", "body": "<p>If you want to validate the uuid, you can check the bits directly. There's not much to verify, since most of the 16 bytes are random, but you can check the top 4 bits of the 6th byte for the version number, or the top 3 bits of the 8th byte for the variant. </p>\n\n<pre><code>// enforce only V4 uuids\nif ctx.MemberID[6] &gt;&gt; 4 != 4 {\n    log.Fatal(\"not a V4 UUID\")\n}\n\n// enforce only RFC4122 type UUIDS\nif (ctx.MemberID[8]&amp;0xc0)|0x80 != 0x80 {\n    log.Fatal(\"not an RFC4122 UUID\")\n}\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 1100765, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/37522facc8f6a42a2907ff8e4627a1ca?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1100765/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467236089, "creation_date": 1467225220, "last_edit_date": 1467225305, "question_id": 38107565, "link": "https://stackoverflow.com/questions/38107565/type-assertion-on-goa-package-uuid-uuid", "title": "Type assertion on Goa package (uuid.UUID)", "body": "<p>I'm testing out <a href=\"https://github.com/goadesign/goa\" rel=\"nofollow\">Goa</a> for an API.  I want to use uuid as an ID data type.  I modified the following function in controller.go:</p>\n\n<pre><code>// Show runs the show action.\nfunc (c *PersonnelController) Show(ctx *app.ShowPersonnelContext) error {\n    // v4 UUID validate regex\n    var validate = `^[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[8|9|aA|bB][a-f0-9]{3}-[a-f0-9]{12}$`\n    uuidValidator := regexp.MustCompile(validate)\n    if !uuidValidator.Match(ctx.MemberID) {\n        return ctx.NotFound()\n    }\n    // Build the resource using the generated data structure\n    personnel := app.GoaCrewWorkforce{\n        MemberID:  ctx.MemberID,\n        FirstName: fmt.Sprintf(\"First-Name #%s\", ctx.MemberID),\n        LastName:  fmt.Sprintf(\"Last-Name #%s\", ctx.MemberID),\n    }\n</code></pre>\n\n<p>What I would like to do is validate a v4 uuid in my controller using Regexp so that it does not poll the server if it does not validate. It's my understanding a uuid is a [16]byte slice.  Regexp has a  <code>Match</code> []byte function.  Yet I can't seem to understand why I get the following error: </p>\n\n<pre><code>cannot use ctx.MemberID (type uuid.UUID) as type []byte in argument to uuidValidator.Match\n</code></pre>\n\n<p>How can I type assert ctx.MemberID?  I don't think its possible to do a cast conversion in this case?  Any guidance is appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467220181, "post_id": 38105859, "comment_id": 63645636, "body": "I haven&#39;t used cobra; does <a href=\"https://godoc.org/github.com/spf13/cobra#MarkFlagRequired\" rel=\"nofollow noreferrer\">MarkFlagRequired</a> not do what you want?"}, {"owner": {"reputation": 118578, "user_id": 421223, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9906fd74f88c426d7d370e877e1f3cbb?s=128&d=identicon&r=PG", "display_name": "KingCrunch", "link": "https://stackoverflow.com/users/421223/kingcrunch"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1485380165, "post_id": 38105859, "comment_id": 70907914, "body": "Hi @JimB I just found out the hard way, that MarkFlagRequired is only a hint and does not enforce a flag ... <a href=\"https://github.com/spf13/cobra/issues/206\" rel=\"nofollow noreferrer\">github.com/spf13/cobra/issues/206</a>"}], "answers": [{"tags": [], "owner": {"reputation": 363, "user_id": 392753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a587f4914e137b7c8c9e655abba964?s=128&d=identicon&r=PG", "display_name": "Francesco Pasa", "link": "https://stackoverflow.com/users/392753/francesco-pasa"}, "is_accepted": false, "score": 3, "last_activity_date": 1487317046, "creation_date": 1487317046, "answer_id": 42292062, "question_id": 38105859, "link": "https://stackoverflow.com/questions/38105859/make-a-cobra-command-flag-required/42292062#42292062", "title": "Make a cobra Command flag required", "body": "<p>No, you have to check yourself whether the input is correct for your program.</p>\n\n<p>Note that this makes sense, since you may want to check if the input is correct at the same time. In your example you should check if the input exists AND if the input is a valid ip-address. </p>\n"}, {"comments": [{"owner": {"reputation": 6670, "user_id": 3625317, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/sTfWL.png?s=128&g=1", "display_name": "Eugen Mayer", "link": "https://stackoverflow.com/users/3625317/eugen-mayer"}, "edited": false, "score": 1, "creation_date": 1516454409, "post_id": 48329029, "comment_id": 83699723, "body": "It is completely inaccurate today, thus wrong. Stack does not reflect the history, but what is correct today. Answers are adjusted overtime"}, {"owner": {"reputation": 6670, "user_id": 3625317, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/sTfWL.png?s=128&g=1", "display_name": "Eugen Mayer", "link": "https://stackoverflow.com/users/3625317/eugen-mayer"}, "edited": false, "score": 1, "creation_date": 1517383705, "post_id": 48329029, "comment_id": 84068347, "body": "As a real example, implemented it here <a href=\"https://github.com/EugenMayer/opnsense-cli/blob/master/cmd/openvpn_ccd_create.go#L27\" rel=\"nofollow noreferrer\">github.com/EugenMayer/opnsense-cli/blob/master/cmd/&hellip;</a> .. <a href=\"https://github.com/EugenMayer/opnsense-cli/blob/master/cmd/unbound_hostentry_show.go#L20\" rel=\"nofollow noreferrer\">github.com/EugenMayer/opnsense-cli/blob/master/cmd/&hellip;</a> .. and so on"}], "tags": [], "owner": {"reputation": 3931, "user_id": 2244081, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2a084ed5223858de201a3ebaf53c4fa8?s=128&d=identicon&r=PG", "display_name": "Ignacio Vergara Kausel", "link": "https://stackoverflow.com/users/2244081/ignacio-vergara-kausel"}, "is_accepted": true, "score": 17, "last_activity_date": 1516304131, "creation_date": 1516304131, "answer_id": 48329029, "question_id": 38105859, "link": "https://stackoverflow.com/questions/38105859/make-a-cobra-command-flag-required/48329029#48329029", "title": "Make a cobra Command flag required", "body": "<p>A few months ago this behavior was changed in <code>cobra</code>, although the documentation is not very clear on this. Now if you mark a flag as <code>MarkFlagRequired(\"primary-ip\")</code> and you don't supply such a flag, running the command will print the help plus </p>\n\n<pre><code>required flag(s) \"primary-ip\"\nexit status 1\n</code></pre>\n\n<p>at the end where the missing required flags are stated.</p>\n"}, {"tags": [], "owner": {"reputation": 599, "user_id": 7207673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CrIYf.png?s=128&g=1", "display_name": "Juan-Kabbali", "link": "https://stackoverflow.com/users/7207673/juan-kabbali"}, "is_accepted": false, "score": 4, "last_activity_date": 1595241091, "creation_date": 1595241091, "answer_id": 62993477, "question_id": 38105859, "link": "https://stackoverflow.com/questions/38105859/make-a-cobra-command-flag-required/62993477#62993477", "title": "Make a cobra Command flag required", "body": "<p>Late but i hope this help you !</p>\n<p>First of all, we need to know that <code>cobra</code> defines two types of flags.</p>\n<p><strong><a href=\"https://github.com/spf13/cobra#persistent-flags\" rel=\"nofollow noreferrer\">Persistent flags</a></strong>: they will be available to the command and every sub-command under it.</p>\n<p><strong><a href=\"https://github.com/spf13/cobra#local-flags\" rel=\"nofollow noreferrer\">Local flags</a></strong>: they will available only to the specific command which define them.</p>\n<hr />\n<p>So <code>cobra</code> provides two approaches to make flags required regarding the type of the flag.</p>\n<p>On the <code>init</code> function of your command, it could be the <code>root</code> or any other command or sub-command. Lets create a cli app called <code>my-cmd</code> with a sub-command called xD <code>sub-command</code></p>\n<pre class=\"lang-golang prettyprint-override\"><code>// root.go file\n\nvar Foo bool\n\nfunc init() {\n    cobra.OnInitialize(initConfig)\n\n    // define required persistent flag\n    myCmd.PersistentFlags().BoolVarP(&amp;Foo, &quot;foo&quot;, &quot;f&quot;, false, &quot;set foo (*)&quot;)\n    myCmd.MarkPersistentFlagRequired(&quot;foo&quot;)\n}\n</code></pre>\n<pre class=\"lang-golang prettyprint-override\"><code>// subCommand.go file\n\nvar Bar string\n\nfunc init() {\n    // just add subCmd as a sub-command of my-cmd\n    myCmd.AddCommand(subCmd)\n\n    // define required local flag\n    subCmd.Flags().StringVarP(&amp;Bar, &quot;bar&quot;, &quot;b&quot;, &quot;&quot;, &quot;set bar (*)&quot;)\n    subCmd.MarkFlagRequired(&quot;bar&quot;)\n}\n\n</code></pre>\n<p>When you call your command in the CLI</p>\n<pre class=\"lang-sh prettyprint-override\"><code># if you don't pass a value for 'foo' flag\n&gt; my-cmd\n    required flag(s) &quot;foo&quot; not set\n    exit status 1\n\n# here you must pass a value for 'foo' because is persistent as well as 'bar' because is local for sub-cmd\n&gt; my-cmd sub-cmd\n    required flag(s) &quot;foo&quot;, &quot;bar&quot; not set\n    exit status 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1615928714, "post_id": 66648034, "comment_id": 117843628, "body": "<a href=\"https://stackoverflow.com/questions/38105859/make-a-cobra-command-flag-required/66648034#comment70907914_38105859\">This old comment</a> from <a href=\"https://stackoverflow.com/users/421223/kingcrunch\">KingCrunch</a>: stated <i>I just found out the hard way, that MarkFlagRequired is only a hint and does not enforce a flag ... <a href=\"https://github.com/spf13/cobra/issues/206\" rel=\"nofollow noreferrer\">github.com/spf13/cobra/issues/206</a></i>.  Looks like this may be fixed, see <a href=\"https://github.com/spf13/cobra/pull/502\" rel=\"nofollow noreferrer\">enforce required flags #502</a>, is this now working for you?"}, {"owner": {"reputation": 147, "user_id": 3344422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258744afef2f197d1cd46a2a9d28cf4a?s=128&d=identicon&r=PG&f=1", "display_name": "ladder", "link": "https://stackoverflow.com/users/3344422/ladder"}, "reply_to_user": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 1, "creation_date": 1616256074, "post_id": 66648034, "comment_id": 117947430, "body": "Hey @dbc it is working for me. I tried running my command without the name flag and got  <code>Error: required flag(s) &quot;name&quot; not set</code>"}], "tags": [], "owner": {"reputation": 147, "user_id": 3344422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258744afef2f197d1cd46a2a9d28cf4a?s=128&d=identicon&r=PG&f=1", "display_name": "ladder", "link": "https://stackoverflow.com/users/3344422/ladder"}, "is_accepted": false, "score": 1, "last_activity_date": 1615859340, "creation_date": 1615859340, "answer_id": 66648034, "question_id": 38105859, "link": "https://stackoverflow.com/questions/38105859/make-a-cobra-command-flag-required/66648034#66648034", "title": "Make a cobra Command flag required", "body": "<pre><code>cmd.Flags().StringVarP(&amp;var, &quot;var&quot;, &quot;r&quot;, &quot;&quot;, &quot;&quot;)\ncmd.MarkFlagRequired(&quot;var&quot;)\n</code></pre>\n"}], "owner": {"reputation": 938, "user_id": 264567, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/EJgqq.png?s=128&g=1", "display_name": "frederix", "link": "https://stackoverflow.com/users/264567/frederix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7484, "favorite_count": 2, "accepted_answer_id": 48329029, "answer_count": 4, "score": 12, "last_activity_date": 1615859340, "creation_date": 1467219511, "question_id": 38105859, "link": "https://stackoverflow.com/questions/38105859/make-a-cobra-command-flag-required", "title": "Make a cobra Command flag required", "body": "<p>I've created a cobra command and added a flag:</p>\n\n<pre><code>cmd.Flags().StringVarP(&amp;primaryIP, \"primary-ip\", \"p\", \"\", \"Help text\")\n</code></pre>\n\n<p>Is there a way to make it required other than checking the value myself and returning an error?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 4, "last_activity_date": 1467218805, "creation_date": 1467218805, "answer_id": 38105631, "question_id": 38105543, "link": "https://stackoverflow.com/questions/38105543/reassigning-in-pointer-method-receiver/38105631#38105631", "title": "Reassigning in pointer method receiver", "body": "<p>In this example you're changing the address that is stored in <code>s</code> to a different value; </p>\n\n<pre><code>func (s *student) update() {\n    s = &amp;student{\"unknown\", 0}\n}\n</code></pre>\n\n<p>While using a pointer is regarded as 'passing by reference' the reference itself is a value like any other that is pushed onto the call stack. When you return to main, the value of <code>s</code> is whatever it was in that scope. So to give something more concrete, you called main with <code>s = 1</code> (calling the addresses 1 and 2 for simplicity), in the method you allocate a new <code>student</code> located at address 2 and you set <code>s = 2</code>, when you return that version of <code>s</code> is popped from the stack and the <code>s</code> in main points to <code>1</code> which is unchanged.</p>\n\n<p>In this latter example;</p>\n\n<pre><code>func (s *student) update() {\n    *s = student{\"unknown\", 0}\n}\n</code></pre>\n\n<p>You're dereferencing <code>s</code> and assigning a new object to that location, overwriting the existing memory. When you return the pointer in main is still pointing to the same location but you have different data at that location in memory. So in this example you're writing a new <code>student</code> instance to address <code>1</code> so when you return you see the new value in the calling scope.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 44, "last_activity_date": 1467249278, "last_edit_date": 1467249278, "creation_date": 1467218981, "answer_id": 38105687, "question_id": 38105543, "link": "https://stackoverflow.com/questions/38105543/reassigning-in-pointer-method-receiver/38105687#38105687", "title": "Reassigning in pointer method receiver", "body": "<p>In the first example:</p>\n\n<pre><code>func (s *student) update() {\n    s = &amp;student{\"unknown\", 0}\n}\n</code></pre>\n\n<p>You are assigning an entirely new \"pointer value\" to <code>s</code>, and the new <code>*s</code> points at a new <code>student</code> value. The variable <code>s</code> is scoped only to the method body, so there are no side effects after this returns.</p>\n\n<p>In the second example</p>\n\n<pre><code>func (s *student) update() {\n    *s = student{\"unknown\", 0}\n}\n</code></pre>\n\n<p>You are dereferencing <code>s</code>, and changing the value of <code>*s</code> to point to a new <code>student</code> value, or to put it differently, you are putting a new <code>student</code> value at the address where <code>s</code> points. </p>\n"}, {"comments": [{"owner": {"reputation": 134715, "user_id": 67, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3e9f1629fd4cb4a5ce9fbd27b13e862d?s=128&d=identicon&r=PG", "display_name": "Rex M", "link": "https://stackoverflow.com/users/67/rex-m"}, "edited": false, "score": 9, "creation_date": 1527023386, "post_id": 38110494, "comment_id": 87966504, "body": "Your answer would be a lot better without the first sentence."}, {"owner": {"reputation": 298, "user_id": 2935870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1652437319/picture?type=large", "display_name": "Agniswar Bakshi", "link": "https://stackoverflow.com/users/2935870/agniswar-bakshi"}, "edited": false, "score": 0, "creation_date": 1558506550, "post_id": 38110494, "comment_id": 99118563, "body": "Agreed, there was no reason to say the first sentence, we all are learning."}], "tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": -4, "last_activity_date": 1467236369, "creation_date": 1467236369, "answer_id": 38110494, "question_id": 38105543, "link": "https://stackoverflow.com/questions/38105543/reassigning-in-pointer-method-receiver/38110494#38110494", "title": "Reassigning in pointer method receiver", "body": "<p>I think, your main problem is that you don't understand well neither one of two concepts that appear in your question.</p>\n\n<p>Let start with pointers. When you don't use pointers, assigning of value means create a simple copy of previous value. The new value is not bound any way with previous one. That means if you change the old value or new, it does not influence the second one. This is normal for primitive types (like ints, bool, string) and structures.</p>\n\n<pre><code>a := 1\nb := a\na++   // a was changed, but value of b does not change at all\n</code></pre>\n\n<p>And now the pointers - it is something that points to some space into memory. For simplicity we create two pointers and both will point to same place.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    type student struct {\n        name string\n        age  int\n    }\n    p1 := &amp;student{\"hongseok\", 13} // this mean create a new student, but we want only address of student, not value\n    p2 := p1\n    (*p1).age = 15      // because p1 and p2 point to same memory (*p2).age also changed\n    fmt.Println(\"1.\", p2.age) // 15\n    p2.age = 32         // in golang I could write (*p2).ago or p2.ago this is the same\n    fmt.Println(\"2.\", p1.age) // 32\n    fmt.Println(\"3.\",p1, \"==\", p2)\n    fmt.Printf(\"4. %p == %p\\n\", p1, p2)\n    // But now I force point p2 to new place\n    p2 = &amp;student{\"another student\", 12}\n    fmt.Println(\"5.\", p1, \"!=\", p2)\n    fmt.Printf(\"6. %p == %p\\n\", p1, p2)\n    p1.age = 14    // does it influce p2.age? no! Why? Because it is in different address\n    fmt.Println(\"7.\", p1, \"!=\", p2)\n        // but could is somehow force that point to same address ? Of course\n    p2 = p1 // p2 will point to same place as p1 and old value of p2 will be freed by garbage collector \n}\n</code></pre>\n\n<p>And don't be confused - pointer can also points named value.</p>\n\n<pre><code>a := 42  // means allocate memory for integer, and we give that memory name \"a\" \np := &amp;a\n*p++     // it change value of a\na = 5    // and of course this change value of *p\n</code></pre>\n\n<p>And now back to methods, that receiver is/is not a pointer. If receiver of method is pointer, that means you can change it value - the same way as I did few lines ago.</p>\n\n<p>If method receiver is not a pointer, that means - before calling a method, it will be created a copy of struct and method will be called on that copy. You of course can change value of copy, but it does not influence original value.</p>\n"}], "owner": {"reputation": 2766, "user_id": 1145208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c92287ad4532c0faf7197093a4693a9?s=128&d=identicon&r=PG", "display_name": "Hongseok Yoon", "link": "https://stackoverflow.com/users/1145208/hongseok-yoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10708, "favorite_count": 11, "accepted_answer_id": 38105687, "answer_count": 3, "score": 18, "last_activity_date": 1560166262, "creation_date": 1467218548, "last_edit_date": 1560166262, "question_id": 38105543, "link": "https://stackoverflow.com/questions/38105543/reassigning-in-pointer-method-receiver", "title": "Reassigning in pointer method receiver", "body": "<p>What I understand about pointer method receiver and non-pointer method receiver is first one can be modified in the method and next one isn't.</p>\n\n<p>So, following worked exactly as I expected.</p>\n\n<pre><code>type student struct {\n    name string\n    age  int\n}\n\nfunc (s *student) update() {\n    s.name = \"unknown\"\n    s.age = 0\n}\n\nfunc main() {\n    s := student{\"hongseok\", 13}\n    fmt.Println(s)\n\n    s.update()\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>It prints <strong>hongseok/13</strong> and <strong>unknown/0</strong>.</p>\n\n<p>But, I want to replace whole <strong>s</strong> in update method at once with reassigning. So, I've just altered update method as bellow.</p>\n\n<pre><code>func (s *student) update() {\n    s = &amp;student{\"unknown\", 0}\n}\n</code></pre>\n\n<p>And it doesn't change <strong>s</strong> in main method and prints double <strong>hongseok/13</strong>.</p>\n\n<pre><code>func (s *student) update() {\n    *s = student{\"unknown\", 0}\n}\n</code></pre>\n\n<p>Above change fix the problem.</p>\n\n<p>I think there's no semantic difference. What am I missing?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467218512, "post_id": 38105471, "comment_id": 63644620, "body": "Don&#39;t set GOROOT, set GOPATH with the full path, and then show what you are doing to get the error above."}, {"owner": {"reputation": 11, "user_id": 6175388, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204882104846602/picture?type=large", "display_name": "Minahil Ikram", "link": "https://stackoverflow.com/users/6175388/minahil-ikram"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467218690, "post_id": 38105471, "comment_id": 63644709, "body": "by full path do you mean \\bin?  I&#39;ve tried removing GOROOT but keeping everything else, still same error"}, {"owner": {"reputation": 2061, "user_id": 335363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XUNr2.jpg?s=128&g=1", "display_name": "Ricardo Smania", "link": "https://stackoverflow.com/users/335363/ricardo-smania"}, "edited": false, "score": 1, "creation_date": 1467218847, "post_id": 38105471, "comment_id": 63644791, "body": "EDIT: please post the full command you are trying to execute (go get -u WHAT GOES HERE?)"}, {"owner": {"reputation": 11, "user_id": 6175388, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204882104846602/picture?type=large", "display_name": "Minahil Ikram", "link": "https://stackoverflow.com/users/6175388/minahil-ikram"}, "edited": false, "score": 0, "creation_date": 1467218885, "post_id": 38105471, "comment_id": 63644832, "body": "just running go get -u, not trying to build or anything"}, {"owner": {"reputation": 2061, "user_id": 335363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XUNr2.jpg?s=128&g=1", "display_name": "Ricardo Smania", "link": "https://stackoverflow.com/users/335363/ricardo-smania"}, "edited": false, "score": 1, "creation_date": 1467219031, "post_id": 38105471, "comment_id": 63644928, "body": "Yeah, sorry, hadn&#39;t noticed the title. Please post the full command."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467219239, "post_id": 38105471, "comment_id": 63645060, "body": "If <code>Go_Projects</code> has <code>bin</code>, <code>pkg</code> and <code>src</code> directories, you&#39;ve gotten something to install at some point. GOPATH should be a fully qualified path."}], "answers": [{"tags": [], "owner": {"reputation": 2061, "user_id": 335363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XUNr2.jpg?s=128&g=1", "display_name": "Ricardo Smania", "link": "https://stackoverflow.com/users/335363/ricardo-smania"}, "is_accepted": false, "score": 1, "last_activity_date": 1467219497, "creation_date": 1467219497, "answer_id": 38105854, "question_id": 38105471, "link": "https://stackoverflow.com/questions/38105471/trying-to-run-go-get-u-getting-error-package-xxx-unrecognized-import-path/38105854#38105854", "title": "Trying to run go get -u getting error: package XXX: unrecognized import path &quot;_/XXX&quot; (import path does not begin with hostname)", "body": "<p>I reproduced the error by trying go get -u without specifying the path. Go get -u fetches a remote repository and builds it, so you should pass a path, like this:</p>\n\n<pre><code>go get -u github.com/gorilla/mux\n</code></pre>\n\n<p>If you don't specify a path, it will consider the path to be the current working dir, which is probably not what you want to do.</p>\n\n<p>And GOPATH is not a valid path for a go get, you could do it from a child directory though, but usually you pass the whole path as I mentioned above.</p>\n"}], "owner": {"reputation": 11, "user_id": 6175388, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204882104846602/picture?type=large", "display_name": "Minahil Ikram", "link": "https://stackoverflow.com/users/6175388/minahil-ikram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1855, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1467219497, "creation_date": 1467218261, "last_edit_date": 1467218600, "question_id": 38105471, "link": "https://stackoverflow.com/questions/38105471/trying-to-run-go-get-u-getting-error-package-xxx-unrecognized-import-path", "title": "Trying to run go get -u getting error: package XXX: unrecognized import path &quot;_/XXX&quot; (import path does not begin with hostname)", "body": "<p>I'm working in Windows.</p>\n\n<p>Full Error: package <em>/C</em>/Go_Projects: unrecognized import path \"<em>/C</em>/Go_Projects\" (import path does not begin with hostname)</p>\n\n<p><code>GOPATH=C:\\Go_Projects\nGOROOT=C:\\Go\npath=path;C:\\Go_Projects\\bin</code></p>\n\n<p>Go_Projects contains: bin, src, pkg and some .bat files but that's it.</p>\n\n<p>I've tried changing GOROOT/GOPATH to:</p>\n\n<p><code>GOPATH=\\\\Go_Projects\nGOROOT=C:\\Go\\bin, \\\\Go\\bin, \\\\Go</code></p>\n\n<p>I'm not sure how to fix this, I keep getting errors and my GOPATH is never set properly.</p>\n"}, {"tags": ["unit-testing", "pointers", "go", "parameter-passing", "stub"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 6197006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pg9b.jpg?s=128&g=1", "display_name": "arq", "link": "https://stackoverflow.com/users/6197006/arq"}, "edited": false, "score": 0, "creation_date": 1467219433, "post_id": 38104568, "comment_id": 63645176, "body": "Maybe it&#39;s my java experience, where for the sake of automated testing almost everything goes through methods handling references to different interfaces. If you could elaborate why interface pointers are never needed or could point me to a good read, please do, but I&#39;m going to accept this answer as the most helpful for now."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 95, "user_id": 6197006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pg9b.jpg?s=128&g=1", "display_name": "arq", "link": "https://stackoverflow.com/users/6197006/arq"}, "edited": false, "score": 0, "creation_date": 1467219980, "post_id": 38104568, "comment_id": 63645501, "body": "@arq: An interface itself describes a set of methods; a pointer to an interface is just a pointer to some value, it doesn&#39;t have any behavior or methods. Just like an <a href=\"https://golang.org/pkg/os/#File\" rel=\"nofollow noreferrer\"><code>*os.File</code></a> has the methods to fulfill an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> interface, but an <code>**os.File</code> has no methods, nor does an <code>*io.Reader</code>."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1467217668, "last_edit_date": 1467217668, "creation_date": 1467215619, "answer_id": 38104568, "question_id": 38104359, "link": "https://stackoverflow.com/questions/38104359/stubb-interface-pointer-parameters-in-golang/38104568#38104568", "title": "Stubb interface pointer parameters in Golang", "body": "<p><a href=\"https://golang.org/pkg/net/#Conn\" rel=\"nofollow\"><code>net.Conn</code></a> is an interface. There is almost never a need to use a pointer to an interface, and you aren't going to find any functions that take a pointer to an interface. </p>\n\n<p>Use a <code>net.Conn</code> value in the map. </p>\n\n<pre><code>conns map[int]net.Conn\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6197006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pg9b.jpg?s=128&g=1", "display_name": "arq", "link": "https://stackoverflow.com/users/6197006/arq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 38104568, "answer_count": 1, "score": 0, "last_activity_date": 1467217668, "creation_date": 1467215031, "last_edit_date": 1467215637, "question_id": 38104359, "link": "https://stackoverflow.com/questions/38104359/stubb-interface-pointer-parameters-in-golang", "title": "Stubb interface pointer parameters in Golang", "body": "<p>Say that I have a Storage which maps client id's to net.Conns (interface). For the sake of simplicity, it's just hides a map inside it and gets map key as a parameter.</p>\n\n<p>I want to eliminate the need for value copying, and I come from the land of Java, so it seems logical that the map should map id's to net.Conn pointers.</p>\n\n<pre><code>type Storage struct {\n     conns map[int]*net.Conn\n}\n\nfunc (s *Storage) Add(id int, conn *net.Conn){\n   s.conns[id] = conn\n}\n\n... methods for initialising new storage, getting, deleting, \nmaybe giving list of user id's etc.\n</code></pre>\n\n<p>Now I want to write automatic tests for the code, but without actual Conns, so I write my own StubbConn and Stubb all the net.Conn -interface methods.</p>\n\n<pre><code>type StubConn struct{}\n\nfunc (s *StubConn) Read(b []byte) (n int, err error)   { return 0, nil }\nfunc (s *StubConn) Write(b []byte) (n int, err error)  { return 0, nil }\netc..\n</code></pre>\n\n<p>And then I try to use this StubbConn in testing...</p>\n\n<pre><code>func TestAddOneClient(t *testing.T) {\n    clients := GetStorage()\n    conn := new(StubConn)\n    clients.Add(5, conn)\n    if len(clients.conns) != 1 {\n        t.Error(\"Expected client adding to increment storage map size\")\n    }\n}\n</code></pre>\n\n<p>It results in compilation error:</p>\n\n<pre><code>cannot use conn (type *StubConn) as type *net.Conn in argument to clients.Add:\n*net.Conn is pointer to interface, not interface\n</code></pre>\n\n<p>But it works if the add function takes parameters as <code>conn net.Conn</code> (values) and make the map hold values instead. So it seems that even if Stubb the interface, the Stubb pointer isn't going to pass as a pointer to the real interface.</p>\n\n<p>Is there a way to pass my StubbConn pointer acting as a pointer to Conn for functions that take pointer to an interface as a parameter? </p>\n\n<p>Even if I'm completely lost and should chance my map to hold actual Conn-values instead of pointers (and please do tell me if I should be doing that), the question holds for unit testing other functions that take pointers to interfaces as params.</p>\n"}, {"tags": ["json", "go", "amazon-dynamodb", "aws-sdk", "aws-sdk-go"], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "edited": false, "score": 0, "creation_date": 1467210169, "post_id": 38101479, "comment_id": 63638714, "body": "you can&#39;t do that it&#39;s invalid type assertion because data is not an interface."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 0, "last_activity_date": 1467207879, "creation_date": 1467207879, "answer_id": 38101479, "question_id": 38101208, "link": "https://stackoverflow.com/questions/38101208/how-to-save-json-response-in-dynamodb-in-go/38101479#38101479", "title": "How to save JSON response in dynamodb in GO", "body": "<p>You should use type assertion in this case.</p>\n\n<p>Give it a try to this:</p>\n\n<pre><code>func (e *DB) saveToDynamodb(data map[string]interface{}){\n  params := &amp;dynamodb.PutItemInput{\n      Item: map[string]*dynamodb.AttributeValue{\n          \"Key\": {\n              M: data.(map[string]*dynamodb.AttributeValue), // assert interface to *dynamodb.AttributeValue\n          },\n      },\n      TableName: aws.String(\"Asset_Data\"),\n  }\n  resp, err := e.dynamodb.PutItem(params)\n\n  if err != nil {\n      fmt.Println(err.Error())\n      return\n  }\n  fmt.Println(resp)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "is_accepted": true, "score": 0, "last_activity_date": 1467218521, "creation_date": 1467218521, "answer_id": 38105537, "question_id": 38101208, "link": "https://stackoverflow.com/questions/38101208/how-to-save-json-response-in-dynamodb-in-go/38105537#38105537", "title": "How to save JSON response in dynamodb in GO", "body": "<p>To put JSON in aws-dynamodb we first need to iterate through each attribute of JSON struct and convert it to dynamodb.AttributeValue in the following manner:</p>\n\n<pre><code>func (e *DB) saveToDynamodb(data map[string]interface{}){\nvar vv=make(map[string]*dynamodb.AttributeValue)\n\nfor k,v:=range data{\n    x:=(v.(string)) //assert string type\n    xx:=&amp;(x)\n    vv[k]=&amp;dynamodb.AttributeValue{S: xx,}\n}\n//s:=data[\"asset_id\"].(string)\nparams := &amp;dynamodb.PutItemInput{\n    Item: vv,\n    TableName: aws.String(\"Asset_Data\"), // Required\n}\nresp, err := e.dynamodb.PutItem(params)\n\nif err != nil {\n    // Print the error, cast err to awserr.Error to get the Code and\n    // Message from an error.\n    fmt.Println(err.Error())\n    return\n}\n\n// Pretty-print the response data.\nfmt.Println(resp)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22932, "user_id": 793454, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d2f7eec19f8c465b7515e234f8110899?s=128&d=identicon&r=PG", "display_name": "Homan", "link": "https://stackoverflow.com/users/793454/homan"}, "edited": false, "score": 0, "creation_date": 1513878391, "post_id": 39475780, "comment_id": 82828925, "body": "where is dynamodbattribute defined?"}, {"owner": {"reputation": 318, "user_id": 1579459, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/pnV0I.jpg?s=128&g=1", "display_name": "Xibz", "link": "https://stackoverflow.com/users/1579459/xibz"}, "reply_to_user": {"reputation": 22932, "user_id": 793454, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d2f7eec19f8c465b7515e234f8110899?s=128&d=identicon&r=PG", "display_name": "Homan", "link": "https://stackoverflow.com/users/793454/homan"}, "edited": false, "score": 0, "creation_date": 1513907627, "post_id": 39475780, "comment_id": 82839387, "body": "<a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/dynamodbattribute/\" rel=\"nofollow noreferrer\">package</a>"}], "tags": [], "owner": {"reputation": 318, "user_id": 1579459, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/pnV0I.jpg?s=128&g=1", "display_name": "Xibz", "link": "https://stackoverflow.com/users/1579459/xibz"}, "is_accepted": false, "score": 5, "last_activity_date": 1473787591, "creation_date": 1473787591, "answer_id": 39475780, "question_id": 38101208, "link": "https://stackoverflow.com/questions/38101208/how-to-save-json-response-in-dynamodb-in-go/39475780#39475780", "title": "How to save JSON response in dynamodb in GO", "body": "<p>The best way to put json into DynamoDB is to use the helper functions.</p>\n\n<pre><code>func ExampleMarshal() (map[string]*dynamodb.AttributeValue, error) {                                                                                                    \n  type Record struct {                                                                                                     \n    Bytes   []byte                                                                                                         \n    MyField string                                                                                                         \n    Letters []string                                                                                                       \n    Numbers []int                                                                                                          \n  }                                                                                                                        \n\n  r := Record{                                                                                                             \n    Bytes:   []byte{48, 49},                                                                                               \n    MyField: \"MyFieldValue\",                                                                                               \n    Letters: []string{\"a\", \"b\", \"c\", \"d\"},                                                                                 \n    Numbers: []int{1, 2, 3},                                                                                               \n  }                                                                                                                        \n  av, err := dynamodbattribute.Marshal(r)\n  return map[string]*dynamodb.AttributeValue{\"object\":av}, err\n}\n</code></pre>\n"}], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3256, "favorite_count": 0, "accepted_answer_id": 38105537, "answer_count": 3, "score": 5, "last_activity_date": 1489201108, "creation_date": 1467207269, "last_edit_date": 1489201108, "question_id": 38101208, "link": "https://stackoverflow.com/questions/38101208/how-to-save-json-response-in-dynamodb-in-go", "title": "How to save JSON response in dynamodb in GO", "body": "<p>I want to save a JSON response in aws-dynamodb, I am using <a href=\"https://godoc.org/github.com/aws/aws-sdk-go/service/dynamodb\" rel=\"nofollow\">aws-dynamodb-sdk</a>. What I'm currently doing is:</p>\n\n<pre><code>func (e *DB) saveToDynamodb(data map[string]interface{}){\nparams := &amp;dynamodb.PutItemInput{\n    Item: map[string]*dynamodb.AttributeValue{\n        \"Key\": {\n            M: data,\n        },\n    },\n    TableName: aws.String(\"Asset_Data\"),\n}\nresp, err := e.dynamodb.PutItem(params)\n\nif err != nil {\n    fmt.Println(err.Error())\n    return\n}\nfmt.Println(resp)\n}\n</code></pre>\n\n<p>But as you can see <strong>data</strong> is of <strong>map[string]interface{}</strong> type while the expected type is <strong>map[string]*AttributeValue</strong> that's why giving compilation error.</p>\n\n<p>Is there any workaround to save a json response?</p>\n"}, {"tags": ["go", "size", "response"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1467197591, "post_id": 38097201, "comment_id": 63629287, "body": "FYI responses are often chunked, and don&#39;t have a Content-Length at all"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1467205723, "post_id": 38097201, "comment_id": 63634993, "body": "There&#39;s no easy way to do it with net/http, but what use would the info be? It&#39;s likely not the exact transfer size, since the request may be TLS/HTTP2. You could approximate it with <a href=\"https://golang.org/pkg/net/http/httputil/#DumpRequest\" rel=\"nofollow noreferrer\">httputil.DumpRequest</a>"}, {"owner": {"reputation": 2295, "user_id": 510091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/125e5dbc8d42f8766ddf2702ab99e8ce?s=128&d=identicon&r=PG", "display_name": "Mark Larter", "link": "https://stackoverflow.com/users/510091/mark-larter"}, "edited": false, "score": 1, "creation_date": 1467208205, "post_id": 38097201, "comment_id": 63637018, "body": "Would checking from the receiving end of the connection satisfy your needs?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1467225041, "post_id": 38097201, "comment_id": 63648611, "body": "I think you could, in theory, implement an <a href=\"https://golang.org/pkg/net/http/#Transport\" rel=\"nofollow noreferrer\"><code>http.Transport</code></a> that wraps the built-in <code>net.Conn</code> with one that precisely counts bytes transferred. But <a href=\"https://golang.org/pkg/net/http/httputil/#DumpResponse\" rel=\"nofollow noreferrer\"><code>httputil.DumpResponse</code></a> similar to what JimB&#39;s saying sounds much more practical."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1494505118, "creation_date": 1494505118, "answer_id": 43915208, "question_id": 38097201, "link": "https://stackoverflow.com/questions/38097201/how-to-get-the-size-of-http-response/43915208#43915208", "title": "How to get the size of HTTP Response?", "body": "<p>You can implement an <code>http.ResponseWriter</code> that counts the bytes it writes.  It should be pretty simple to create your own, or you can use an existing library like <a href=\"https://github.com/miolini/datacounter\" rel=\"nofollow noreferrer\">this one</a>.</p>\n"}], "owner": {"reputation": 49, "user_id": 6477586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QhObm.jpg?s=128&g=1", "display_name": "Mike.Lee", "link": "https://stackoverflow.com/users/6477586/mike-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4907, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1494505118, "creation_date": 1467196842, "last_edit_date": 1494505062, "question_id": 38097201, "link": "https://stackoverflow.com/questions/38097201/how-to-get-the-size-of-http-response", "title": "How to get the size of HTTP Response?", "body": "<p>I want to determine the size of the response. it's easy way to get the contentsize by resp.ContentLength. But, Size is the combined size of the response headers (usually a few hundred bytes) plus the response body, as delivered by the server.  how can I get the size of the response headers ? Or Is there anyway to get the size of the response directly?  </p>\n"}, {"tags": ["go", "sublimetext", "sublime-build", "gosublime"], "answers": [{"tags": [], "owner": {"reputation": 89500, "user_id": 1426065, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/476e67c92121154e7910301e56cdfc4c?s=128&d=identicon&r=PG", "display_name": "MattDMo", "link": "https://stackoverflow.com/users/1426065/mattdmo"}, "is_accepted": false, "score": 3, "last_activity_date": 1467207145, "creation_date": 1467207145, "answer_id": 38101161, "question_id": 38095857, "link": "https://stackoverflow.com/questions/38095857/how-to-make-sublime-text-build-execute-on-numpad-enter/38101161#38101161", "title": "How to make Sublime text build execute on numpad enter?", "body": "<p>The only suggestion I can give is to try using <kbd>numpad_enter</kbd> both with <kbd>NumLock</kbd> on and off, and see if it makes a difference. I'm running OS X and using the standard wired Apple keyboard with a numpad, and I'm also running Linux in a virtual machine. When I open up the console (<kbd>Ctrl</kbd><kbd>`</kbd>) and run the command</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>sublime.log_input(True)\n</code></pre>\n\n<p>then refocus the file I'm working on, pressing <kbd>Return</kbd> (the <kbd>Enter</kbd> equivalent on the main keyboard) yields</p>\n\n<pre><code>key evt: enter\n</code></pre>\n\n<p>in the console, whereas hitting <kbd>Enter</kbd> on the keypad yields</p>\n\n<pre><code>key evt: keypad_enter\n</code></pre>\n\n<p>This behavior does not change in OS X or Linux (I haven't tried in my Windows VM yet) regardless of how <kbd>NumLock</kbd> is set. If you're on Windows or Linux with a Windows keyboard, it <em>may</em> change, but I doubt it.</p>\n\n<hr>\n\n<p>The reason Sublime does this is because <kbd>numpad_enter</kbd> and <kbd>Enter</kbd>/<kbd>Return</kbd> send different keycodes to the program. Sublime is looking for a certain keycode (the one sent by <kbd>Enter</kbd>) to submit the contents of popup menus and whatnot, and ignores the code sent by <kbd>numpad_enter</kbd>. Unfortunately, because this is built-in behavior, there is no setting or key binding that can be set to override it.</p>\n\n<p>The only other possibility I can think of is to use a utility for your OS to reprogram you <kbd>numpad_enter</kbd> to send the same keycode as <kbd>Enter</kbd>. I'm not terribly familiar with it, but for Windows I've heard that <a href=\"https://autohotkey.com/\" rel=\"nofollow\">AutoHotKey</a> is a pretty useful utility, and as far as I can tell is free. You can <a href=\"https://autohotkey.com/docs/misc/Remap.htm\" rel=\"nofollow\">remap</a> keys with it rather easily. You'll have to google for other utilities if you're on OS X or Linux.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 111, "user_id": 1980477, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/c33bL.jpg?s=128&g=1", "display_name": "Cute Tom", "link": "https://stackoverflow.com/users/1980477/cute-tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467207145, "creation_date": 1467193317, "last_edit_date": 1467205735, "question_id": 38095857, "link": "https://stackoverflow.com/questions/38095857/how-to-make-sublime-text-build-execute-on-numpad-enter", "title": "How to make Sublime text build execute on numpad enter?", "body": "<p>I use GoSublime inside sublime text for Golang development.\nPressing <code>Ctrl + B</code> gives me the build pane, then I need to type a command e.g., <code>go run main.go</code> and press <code>Enter</code>. When I want to execute a command using <code>numpad Enter</code> it doesn't work. How to make it work with <code>numpad Enter</code> too?</p>\n\n<p>I checked the default keymap in sublime text it provides only the following key bindings for build tool</p>\n\n<pre><code>    { \"keys\": [\"f7\"], \"command\": \"build\" },\n    { \"keys\": [\"ctrl+b\"], \"command\": \"build\" },\n    { \"keys\": [\"ctrl+shift+b\"], \"command\": \"build\", \"args\": {\"select\": true} },\n    { \"keys\": [\"ctrl+break\"], \"command\": \"exec\", \"args\": {\"kill\": true} },\n</code></pre>\n\n<p>Thank You!</p>\n"}, {"tags": ["database", "postgresql", "go", "postgresql-9.4"], "answers": [{"comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "edited": false, "score": 1, "creation_date": 1467195900, "post_id": 38096154, "comment_id": 63628190, "body": "I just realized you are never returning from the function. It&#39;s an infinite loop. Defers only fire when you exit the function. Change the defers to explicit <code>db.Close()</code> at the end of the <code>for</code> loop. Leave the defers describe above since they&#39;ll close the db in case of errors."}, {"owner": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "edited": false, "score": 0, "creation_date": 1467198306, "post_id": 38096154, "comment_id": 63629751, "body": "if i forget to close the prepare statement but closing the connection means  that connection will be in idle state or connection will get close .??"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "edited": false, "score": 1, "creation_date": 1467203639, "post_id": 38096154, "comment_id": 63633438, "body": "You should always ensure that each connection is closed. Don&#39;t assume anything and make sure that once a file or a connection is open, you close it either explicitly or by using defers. In your case closing the connection will close it but prepare statement might not get closed automatically and may leak resources. Refer to postgres api docs."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 4, "last_activity_date": 1467203434, "last_edit_date": 1467203434, "creation_date": 1467194019, "answer_id": 38096154, "question_id": 38095541, "link": "https://stackoverflow.com/questions/38095541/golang-postgres-closing-database-connection-not-working-for-particular-query/38096154#38096154", "title": "Golang-Postgres ..Closing database connection not working for particular query", "body": "<p>The <code>for</code> loop is an infinite loop and it will never return. This means that defers will never be executed and the connections won't be closed. You need to add explicit <code>db.Close()</code> at the end of the loop.</p>\n\n<p>Also move the initialization of <code>db</code> out of the loop if you don't need a new connection every time you perform the task. You can just create a single connection and reuse it. If you do this, move <code>defer</code> statement just below the initialization of <code>db</code>. If the database operations return some errors then defers will close the connection.</p>\n\n<pre><code>db, err := database.GetNewConnection(dbname)\nif err != nil {\n    return fmt.Errorf(\"Error in creating database connection: %+v\", err)\n}\ndefer db.Close()\nfor {\n\n    // ...\n\n    db.Close()\n}\n</code></pre>\n\n<p>By doing this you ensure that the connection gets closed on every return path put of the function (<a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow\">https://blog.golang.org/defer-panic-and-recover</a>)</p>\n\n<p>If you still leave <code>db</code> initialization in the loop, remove the <code>defers</code> since they'll only add to the defer stack while the db connection will be closed explicitly.</p>\n"}, {"tags": [], "owner": {"reputation": 1467, "user_id": 517783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9rdPU.jpg?s=128&g=1", "display_name": "Sameer Azazi", "link": "https://stackoverflow.com/users/517783/sameer-azazi"}, "is_accepted": false, "score": 2, "last_activity_date": 1467197333, "creation_date": 1467197333, "answer_id": 38097398, "question_id": 38095541, "link": "https://stackoverflow.com/questions/38095541/golang-postgres-closing-database-connection-not-working-for-particular-query/38097398#38097398", "title": "Golang-Postgres ..Closing database connection not working for particular query", "body": "<p>As @abhink has pointed out, your defer statement is not being called due to forever running <code>for</code> loop. Your implementation for scheduled execution of a piece of code using <code>for</code> loop is not optimal.</p>\n\n<p>You should be using golang channels instead. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    //You can configure your tick for 10 mnts.\n    tick := time.Tick(100 * time.Millisecond)\n    //some exit condition\n    exit := time.After(1000 * time.Millisecond)\n    for {\n        select {\n        case &lt;-tick:\n            poke()\n        case &lt;-exit:\n            fmt.Println(\"Exit\")\n            return\n        default:\n            fmt.Println(\"    .\")\n            time.Sleep(50 * time.Millisecond)\n        }\n    }\n}\n\nfunc poke() {\n    fmt.Println(\"Opening connection\")\n    defer fmt.Println(\"Closing connection\")\n    fmt.Println(\"Inserting into Database\")\n}\n</code></pre>\n\n<p>You can change <code>pock()</code> function to insert record into database. And you can configure ticker to tick at every 10 mnts. Since every tick triggers a new function call, your defer will be called once <code>pock()</code> function execution completes. </p>\n\n<p>Refer this go playground snippet <a href=\"https://play.golang.org/p/1fQgbmI9LY\" rel=\"nofollow\">https://play.golang.org/p/1fQgbmI9LY</a></p>\n"}, {"tags": [], "owner": {"reputation": 1942, "user_id": 1209272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e49723c518649025bd10ea6bf113b5?s=128&d=identicon&r=PG", "display_name": "Chief", "link": "https://stackoverflow.com/users/1209272/chief"}, "is_accepted": false, "score": 1, "last_activity_date": 1467209379, "last_edit_date": 1467209379, "creation_date": 1467208990, "answer_id": 38101979, "question_id": 38095541, "link": "https://stackoverflow.com/questions/38095541/golang-postgres-closing-database-connection-not-working-for-particular-query/38101979#38101979", "title": "Golang-Postgres ..Closing database connection not working for particular query", "body": "<p><code>defer</code> functions are only called when the function returns. In your loop the <code>defer db.Close()</code> are never executed while the loop is active, hence the functions never called.</p>\n\n<p>You can wrap the logic in the <code>for</code> in a <strong>closure</strong> to effect the defers:</p>\n\n<pre><code>for{\n   func(){\n       // inner code \n   }()\n   time.Sleep(10 * 60 * time.Second)\n}\n</code></pre>\n"}], "owner": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4434, "favorite_count": 0, "accepted_answer_id": 38096154, "answer_count": 3, "score": 1, "last_activity_date": 1467209379, "creation_date": 1467192429, "question_id": 38095541, "link": "https://stackoverflow.com/questions/38095541/golang-postgres-closing-database-connection-not-working-for-particular-query", "title": "Golang-Postgres ..Closing database connection not working for particular query", "body": "<p>I am using golang to access postgresql. \nThis is my function </p>\n\n<pre><code>for {\n    db, err := database.GetNewConnection(dbname)\n\n    err = db.QueryRow(\"SELECT COALESCE(COUNT(1),0) FROM table\").Scan(&amp;count)\n\n    if count == 0 {\n\n        var insert = \"INSERT INTO table(last_update_time,next_update_time,schedule_frequency)\" +\n            \"VALUES($1,$2,$3)\"\n        prep_ins, err := db.Prepare(insert)\n        if err != nil {\n            return\n        }\n        _, err = prep_ins.Exec(cur_time, 1464718530, 86400)\n        if err != nil {\n            return\n        }\n        defer prep_ins.Close()\n        defer db.Close()\n    } else {\n        var sel_str = \"SELECT next_update_time FROM table\"\n        prep_update, err := db.Prepare(sel_str)\n        if err != nil {\n\n            return\n        }\n        _, err = prep_update.Exec()\n        if err != nil {\n            defer prep_update.Close()\n            return\n        }\n        defer prep_update.Close()\n        defer db.Close()\n    }\n    time.Sleep(10 * 60 * time.Second)\n}\n</code></pre>\n\n<p>Every 10 mins , this function will run and execute those statement. Its working fine but the connection will be in idle state. I am checking using <code>pg_stat_activity</code>, the state is idle only. Every 10 mins, new connection will be created and went to idle state.so its keep on increasing. i don't know why its happening. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["memory", "optimization", "go"], "answers": [{"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 8, "last_activity_date": 1467192499, "last_edit_date": 1467192499, "creation_date": 1467192104, "answer_id": 38095380, "question_id": 38095210, "link": "https://stackoverflow.com/questions/38095210/minimize-memory-allocations-for-go-map/38095380#38095380", "title": "Minimize memory allocations for go map", "body": "<p>A map is not an array. You can't preallocate space in it because you can't know where in the map the elements will be inserted. In <code>make(map..., X)</code> X is just a capacity <em>hint</em>, it doesn't bound the map and definitely doesn't guarantee that the keys will hash perfectly into it. As such it will do a best effort of minimizing the number of future allocations, but there's no way to eliminate all of them.</p>\n\n<p>In this particular example you should just use an array rather than a map if you want perfect control over allocations. With a proper array you'd have just one allocation.</p>\n"}], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 1, "accepted_answer_id": 38095380, "answer_count": 1, "score": 3, "last_activity_date": 1467192499, "creation_date": 1467191701, "question_id": 38095210, "link": "https://stackoverflow.com/questions/38095210/minimize-memory-allocations-for-go-map", "title": "Minimize memory allocations for go map", "body": "<p>I am currently digging into optimising some highly used code in go. My Question boils down to the following code snippet (copied with memory allocations from pprof list command). As you can see all the allocations are done in the line where map is being filled (line 959).</p>\n\n<pre><code>ROUTINE ======================== cart.BenchmarkMapWithOutCapacityFixVal in /.../cart_test.go\n   3328966    3328966 (flat, cum) 15.50% of Total\n         .          .    954:\n         .          .    955:func BenchmarkMapWithOutCapacityFixVal(b *testing.B) {\n         .          .    956:   for i := 0; i &lt; b.N; i++ {\n         .          .    957:       m := make(map[int]float32)\n         .          .    958:       for k := 0; k &lt; 10; k++ {\n   3328966    3328966    959:           m[k] = 0.434295723423\n         .          .    960:       }\n         .          .    961:   }\n         .          .    962:}\n</code></pre>\n\n<p>Here what I am trying to do: I am trying to allocate the memory before the (inner) loop so there are no unnecessary allocations happening:</p>\n\n<pre><code>ROUTINE ======================== cart.BenchmarkMapWithCapacityFixVal in /.../cart_test.go\n   3214263    3214263 (flat, cum) 14.97% of Total\n         .          .    963:\n         .          .    964:func BenchmarkMapWithCapacityFixVal(b *testing.B) {\n         .          .    965:   for i := 0; i &lt; b.N; i++ {\n   3048075    3048075    966:       m := make(map[int]float32, 10)\n         .          .    967:       for k := 0; k &lt; 10; k++ {\n    166188     166188    968:           m[k] = 0.434295723423\n         .          .    969:       }\n         .          .    970:   }\n         .          .    971:}\n</code></pre>\n\n<p>Why are there still allocations happening in line 968 (second sample) and how can I correctly allocate the map before the inner loop?</p>\n"}, {"tags": ["go", "configuration", "12factor", "viper"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1467199035, "post_id": 38095207, "comment_id": 63630203, "body": "I haven&#39;t read files with viper, I&#39;ve only used it behind cobra for parsing config flags. However I use it like <code>serverCmd.Flags().StringVarP(&amp;Cfg.BindAddress, &quot;bind&quot;, &quot;b&quot;, &quot;0.0.0.0&quot;, &quot;the listen interface&quot;)</code>, maybe you can similarly write the values of both configs into shared pointers?"}], "owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1467192517, "creation_date": 1467191697, "last_edit_date": 1467192517, "question_id": 38095207, "link": "https://stackoverflow.com/questions/38095207/config-file-masks", "title": "Config file masks", "body": "<p>We deploy services as docker containers using Marathon.  The containers include a base config file, Marathon pulls an environment config file (which has a subset of the base keys) at deployment time so when the app starts it has;</p>\n\n<ul>\n<li>environment.toml</li>\n<li>config.toml</li>\n</ul>\n\n<p>when reading the config we need to conflate the values in both files to a single set, effectively masking/shadowing the values present in both files with those in the environment file.</p>\n\n<p>I didn't find this functionality in the Viper docs.  Unless I have missed something it seems my options are;</p>\n\n<ul>\n<li>Write a package that uses Viper to read both files and perform the conflation.</li>\n<li>Extend Viper</li>\n</ul>\n\n<p>Before I start writing code, is there already a mechanism for doing this?</p>\n"}, {"tags": ["go", "gorilla", "fasthttp"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467205999, "post_id": 38094739, "comment_id": 63635189, "body": "Probably not, but you&#39;d have to show a specific example. For example, the signature for an http.Handler contains the concrete type <code>*http.Request</code>, which won&#39;t be the same as a <code>*fasthttp.Request</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1575, "user_id": 549529, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/c6d37b088a99ad744492e4e16b857c86?s=128&d=identicon&r=PG", "display_name": "ginad", "link": "https://stackoverflow.com/users/549529/ginad"}, "is_accepted": false, "score": 1, "last_activity_date": 1527010564, "last_edit_date": 1527010564, "creation_date": 1467277047, "answer_id": 38118360, "question_id": 38094739, "link": "https://stackoverflow.com/questions/38094739/combining-net-http-and-fasthttp/38118360#38118360", "title": "Combining net/http and fasthttp", "body": "<p>I was checking the Iris framework and I saw in the documentation that it's possible use net/http with the framework.</p>\n\n<p><a href=\"https://kataras.gitbooks.io/iris/content/using-native-httphandler.html\" rel=\"nofollow noreferrer\">https://kataras.gitbooks.io/iris/content/using-native-httphandler.html</a></p>\n\n<p>The framework is using the following to convert native net/http handler to fasthttp handler.</p>\n\n<p><a href=\"https://github.com/valyala/fasthttp/tree/master/fasthttpadaptor\" rel=\"nofollow noreferrer\">https://github.com/valyala/fasthttp/tree/master/fasthttpadaptor</a></p>\n"}, {"tags": [], "owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "is_accepted": false, "score": 0, "last_activity_date": 1567270301, "creation_date": 1567270301, "answer_id": 57739958, "question_id": 38094739, "link": "https://stackoverflow.com/questions/38094739/combining-net-http-and-fasthttp/57739958#57739958", "title": "Combining net/http and fasthttp", "body": "<p>I think that replace from a scratch file will be the best solution. Here an example that show differences between default net/http and fasthttp</p>\n\n<p>Example for setup net/http default package.\nBasic not efficient approach</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>/* Global var */\nvar logcfg = initConfigurationData(\"test/\")\nvar fileList = initLogFileData(logcfg)\n\nfunc main() {\n    channel := make(chan bool)\n    /* Run coreEngine in background, parameter not necessary */\n    go coreEngine(fileList, logcfg, channel)\n    log.Println(\"Started!\")\n    handleRequests()\n    &lt;-channel\n    log.Println(\"Finished!\")\n}\n</code></pre>\n\n<p>After, you can declare a 'wrapper' that contains all of your 'API' like the following 'handleRequest' method</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func handleRequests() {\n    // Map the endoint to the function\n    http.HandleFunc(\"/\", homePage)\n    http.HandleFunc(\"/listAllFile\", listAllFilesHTTP)\n    http.HandleFunc(\"/getFile\", getFileHTTP)\n    log.Fatal(http.ListenAndServe(\":8081\", nil))\n}\n</code></pre>\n\n<p>Here is the list the API, each one bind as the first argument of the HandleFunc and managed with the core functionalities provided by the method (example):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Example of function for print a list of file\nfunc listAllFilesHTTP(w http.ResponseWriter, r *http.Request) {\n    tmp := make([]string, len(fileList))\n    for i := 0; i &lt; len(fileList); i++ {\n        tmp[i] = fileList[i].name\n    }\n    fmt.Fprintf(w, strings.Join(tmp, \"\\n\"))\n    log.Println(\"Endpoint Hit: listFile\")\n}\n</code></pre>\n\n<p>From the other side, with fasthttp, you have to change your handleRequest method as following</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func handleRequests() {\n    m := func(ctx *fasthttp.RequestCtx) {\n        switch string(ctx.Path()) {\n        case \"/\":\n            fastHomePage(ctx)\n        case \"/listAllFile\":\n            fastListAllFilesHTTP(ctx)\n        case \"/getFile\":\n            fastGetFileHTTP(ctx)\n        default:\n            ctx.Error(\"not found\", fasthttp.StatusNotFound)\n        }\n    }\n    fasthttp.ListenAndServe(\":8081\", m)\n}\n</code></pre>\n\n<p>Than, the core function will be the following:<br>\nNOTE: You can pass other variable too other from the context to the method.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// NOTE: The signature have changed!\nfunc fastListAllFilesHTTP(ctx *fasthttp.RequestCtx) {\n    ctx.Response.Header.Set(\"GoLog-Viewer\", \"v0.1$/alpha\")\n    tmp := make([]string, len(fileList))\n    for i := 0; i &lt; len(fileList); i++ {\n        tmp[i] = fileList[i].name\n    }\n    fmt.Fprintf(ctx, strings.Join(tmp, \"\\n\"))\n    log.Println(\"Endpoint Hit: listFile\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1575, "user_id": 549529, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/c6d37b088a99ad744492e4e16b857c86?s=128&d=identicon&r=PG", "display_name": "ginad", "link": "https://stackoverflow.com/users/549529/ginad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2521, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1567270301, "creation_date": 1467190503, "last_edit_date": 1526958829, "question_id": 38094739, "link": "https://stackoverflow.com/questions/38094739/combining-net-http-and-fasthttp", "title": "Combining net/http and fasthttp", "body": "<p>I was looking for a fast framework for go and I stumbled upon fasthttp <a href=\"https://github.com/valyala/fasthttp\" rel=\"nofollow\">https://github.com/valyala/fasthttp</a> which is according to the developer and the benchmark is 10x faster than Golang net/http package. I'm already familiar with gorilla toolkit and other net/http based frameworks like gin-gonic, goji, and gocraft.</p>\n\n<p><strong>My question is: Is it possible to mix net/http framework / toolkits with fasthttp for example I would like to use some gorilla packages with echo / iris (fasthttp frameworks)?</strong></p>\n"}, {"tags": ["input", "go", "stdin"], "answers": [{"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 3, "last_activity_date": 1467195115, "last_edit_date": 1467195115, "creation_date": 1467191864, "answer_id": 38095273, "question_id": 38094555, "link": "https://stackoverflow.com/questions/38094555/golang-read-os-stdin-input-but-dont-echo-it/38095273#38095273", "title": "Golang - Read Os.stdin input but don&#39;t echo it", "body": "<p>I cannot think to other methods than to use <a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code\" rel=\"nofollow\">ANSI escape codes</a> to clear the terminal and move the cursor to a specific location (in your case to column 1:row 1).</p>\n\n<pre><code>var screen *bytes.Buffer = new(bytes.Buffer)\nvar output *bufio.Writer = bufio.NewWriter(os.Stdout)\n</code></pre>\n\n<p>And here are some basic helper methods to ease your job working with terminal.</p>\n\n<pre><code>// Move cursor to given position\nfunc moveCursor(x int, y int) {\n    fmt.Fprintf(screen, \"\\033[%d;%dH\", x, y)\n}\n\n// Clear the terminal\nfunc clearTerminal() {\n    output.WriteString(\"\\033[2J\")\n}\n</code></pre>\n\n<p>Then inside your function you need to clear the terminal and move the cursor to the first column and first row of the terminal window. At the end you have to output the computed result.</p>\n\n<pre><code>for {\n    outgoing, err := input.ReadString('\\n')\n\n    if err != nil {\n        break\n    }\n\n    if _, err := fmt.Sscanf(outgoing, \"%f\", input); err != nil {\n        fmt.Println(\"Input error!\")\n        continue\n    }\n\n    // Clear console\n    clearTerminal()\n    moveCursor(1,1)\n\n    fmt.Println(outs) // prints the computed result\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2977, "user_id": 6756, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/43f2aadf6e9f8d017ff453b7a8dbf507?s=128&d=identicon&r=PG", "display_name": "GodEater", "link": "https://stackoverflow.com/users/6756/godeater"}, "edited": false, "score": 0, "creation_date": 1509986225, "post_id": 38101693, "comment_id": 81233120, "body": "This doesn&#39;t work on Windows if you&#39;re running the go generated .exe from within something like Cygwin, or an Msys2 bash prompt.  Is there another way?"}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "reply_to_user": {"reputation": 2977, "user_id": 6756, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/43f2aadf6e9f8d017ff453b7a8dbf507?s=128&d=identicon&r=PG", "display_name": "GodEater", "link": "https://stackoverflow.com/users/6756/godeater"}, "edited": false, "score": 0, "creation_date": 1509990492, "post_id": 38101693, "comment_id": 81235654, "body": "@GodEater That&#39;s either a bug on the Go library or a bug in how Cygwin or Msys2 implement bash in Windows. Besides that I have no clue, sorry."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1533775223, "post_id": 38101693, "comment_id": 90474195, "body": "According to the docs, you&#39;re supposed to put the terminal into raw mode first, and the terminal package has a MakeRaw() function, but it takes a file descriptor... Presumably the file descriptor is for os.Stdin in this case, but I&#39;ve no clue how to get that..."}], "tags": [], "owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "is_accepted": false, "score": 1, "last_activity_date": 1467208362, "creation_date": 1467208362, "answer_id": 38101693, "question_id": 38094555, "link": "https://stackoverflow.com/questions/38094555/golang-read-os-stdin-input-but-dont-echo-it/38101693#38101693", "title": "Golang - Read Os.stdin input but don&#39;t echo it", "body": "<p>It seems you are looking for a terminal-specific function to disable echo. This is usually used when writing passwords on the terminal (you can type but you don't see the characters).</p>\n\n<p>I suggest you give a try to <a href=\"https://godoc.org/golang.org/x/crypto/ssh/terminal#Terminal.ReadPassword\" rel=\"nofollow\">terminal.ReadPassword</a> it should work nicely and probably in the most cross-platform compatible way.</p>\n\n<pre><code>prompt := \"\"\nt := terminal.NewTerminal(os.Stdin, prompt)\nfor {\n    outgoing, err := t.ReadPassword(prompt)\n    if err != nil {\n        log.Fatalln(err)\n    }\n    outs &lt;- outgoing\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5849, "user_id": 657703, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/208ba006821bf4ab078692204d23ceee?s=128&d=identicon&r=PG", "display_name": "\u042f\u0440\u043e\u0441\u043b\u0430\u0432 \u0420\u0430\u0445\u043c\u0430\u0442\u0443\u043b\u043b\u0438\u043d", "link": "https://stackoverflow.com/users/657703/%d0%af%d1%80%d0%be%d1%81%d0%bb%d0%b0%d0%b2-%d0%a0%d0%b0%d1%85%d0%bc%d0%b0%d1%82%d1%83%d0%bb%d0%bb%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1591371108, "post_id": 48524979, "comment_id": 110039935, "body": "great geek factor, but very flimsy and *nix centric"}], "tags": [], "owner": {"reputation": 1350, "user_id": 5277071, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jT4bNbzKK7E/AAAAAAAAAAI/AAAAAAAAUMc/h4yiKAr93wQ/photo.jpg?sz=128", "display_name": "Rafael Quintela", "link": "https://stackoverflow.com/users/5277071/rafael-quintela"}, "is_accepted": false, "score": 0, "last_activity_date": 1517326041, "creation_date": 1517326041, "answer_id": 48524979, "question_id": 38094555, "link": "https://stackoverflow.com/questions/38094555/golang-read-os-stdin-input-but-dont-echo-it/48524979#48524979", "title": "Golang - Read Os.stdin input but don&#39;t echo it", "body": "<p>other than crypto/ssh/terminal;</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc raw(start bool) error {\n    r := \"raw\"\n    if !start {\n        r = \"-raw\"\n    }\n\n    rawMode := exec.Command(\"stty\", r)\n    rawMode.Stdin = os.Stdin\n    err := rawMode.Run()\n    if err != nil {\n        return err\n    }\n\n    return rawMode.Wait()\n}\n\n// http://tldp.org/HOWTO/Bash-Prompt-HOWTO/x361.html\nfunc main() {\n    var rs []rune\n    raw(true)\n    for {\n        inp := bufio.NewReader(os.Stdin)\n        r, _, err := inp.ReadRune()\n        if err != nil {\n            raw(false)\n            panic(err)\n        }\n\n        if r == '\\x03' { // ctrl+c\n            break\n        } else if r == '\\r' { // enter\n            fmt.Print(string(rs), \"\\n\\r\")\n            rs = []rune{}\n            continue\n        } else if r == '\\u007f' { // backspace\n            fmt.Printf(\"\\033[1D\\033[K\")\n            continue\n        }\n\n        rs = append(rs, r)\n    }\n\n    raw(false)\n}\n</code></pre>\n"}], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4728, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1517326041, "creation_date": 1467189978, "last_edit_date": 1467218021, "question_id": 38094555, "link": "https://stackoverflow.com/questions/38094555/golang-read-os-stdin-input-but-dont-echo-it", "title": "Golang - Read Os.stdin input but don&#39;t echo it", "body": "<p>In a golang program I'm reading the Os.Stdin input from a bufio.Reader. </p>\n\n<p>After enter is pressed, the program reads the input and it is then printed onto the console. Is it possible to not print the input onto the console? After reading it, I process the input and reprint it (and no longer need the original input).</p>\n\n<p>I read the data like this:</p>\n\n<pre><code>inputReader := bufio.NewReader(os.Stdin)\nfor {\n    outgoing, _ := inputReader.ReadString('\\n')\n    outs &lt;- outgoing\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "edited": false, "score": 0, "creation_date": 1467187543, "post_id": 38093609, "comment_id": 63622545, "body": "So I changed to <a href=\"https://play.golang.org/p/syEqU159Ut\" rel=\"nofollow noreferrer\">play.golang.org/p/syEqU159Ut</a> and it&#39;s work. How I should use this code to achieve same result for current code but with interfaces?"}, {"owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "edited": false, "score": 1, "creation_date": 1467188333, "post_id": 38093609, "comment_id": 63623050, "body": "I need to use Pb  by link(pointer) not value  <a href=\"https://play.golang.org/p/dLMK5WKBa3\" rel=\"nofollow noreferrer\">play.golang.org/p/dLMK5WKBa3</a>"}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "reply_to_user": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "edited": false, "score": 0, "creation_date": 1467191574, "post_id": 38093609, "comment_id": 63625179, "body": "Your <code>NewD</code> can just <code>return res</code> Go will handle pointer dereferences for you in most cases. You only need to care about how you create <code>ImplPBifaceT</code> because it can be a value or a pointer. In most cases a pointer is just fine and will work as you expect it."}], "tags": [], "owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "is_accepted": false, "score": 1, "last_activity_date": 1467191456, "last_edit_date": 1467191456, "creation_date": 1467187054, "answer_id": 38093609, "question_id": 38093171, "link": "https://stackoverflow.com/questions/38093171/how-to-implement-interfaces-in-following-code/38093609#38093609", "title": "How to implement interfaces in following code?", "body": "<p>Do not use <em>pointer to interface</em> unless you are sure that's what you want, see <code>Pb *PBifaceT</code> inside <code>TestDialogUiT</code>. If you change it to just <code>Pb PBifaceT</code> your playground link just works.</p>\n\n<p>An interface is already a pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "reply_to_user": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "edited": false, "score": 0, "creation_date": 1467191476, "post_id": 38093766, "comment_id": 63625106, "body": "@ValeriySolovyov why do you really <i>need</i> to have an interface pointer?"}], "tags": [], "owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "is_accepted": false, "score": 2, "last_activity_date": 1467191552, "last_edit_date": 1495539855, "creation_date": 1467187533, "answer_id": 38093766, "question_id": 38093171, "link": "https://stackoverflow.com/questions/38093171/how-to-implement-interfaces-in-following-code/38093766#38093766", "title": "How to implement interfaces in following code?", "body": "<p>Are you sure you need your <code>Pb</code>\u00a0field as a <code>*PBifaceT</code>.</p>\n\n<p>If you keep it as a </p>\n\n<pre><code>type TestDialogUiT struct {\n    Pb *PBifaceT\n}\n</code></pre>\n\n<p>and you do </p>\n\n<pre><code>x := TestDialogUiT{}\n\nPbPb := ImplPBifaceT{}\nx.Pb = PBifaceT(PbPb)\n\nparentId := x.Pb.Step()\nfmt.Printf(\"%v\", parentId)\n</code></pre>\n\n<p>It works properly..</p>\n\n<p>Take a look at this <a href=\"https://play.golang.org/p/-RqbG9-8VO\" rel=\"nofollow noreferrer\">playground</a> and see if it can help.</p>\n\n<p>I'd suggest you to take a look at this <a href=\"http://golangtutorials.blogspot.it/2011/06/interfaces-in-go.html\" rel=\"nofollow noreferrer\">tutorial</a> and <a href=\"https://golang.org/doc/effective_go.html#interface_methods\" rel=\"nofollow noreferrer\">this doc</a>.</p>\n\n<p>I'd suggest you also to read <a href=\"https://stackoverflow.com/a/21283083/3119050\">this SO answer</a> which explains a bit of how you shouldn't want to use <em>interface pointers</em>.</p>\n\n<blockquote>\n  <p>Background: In Go you pass around a pointer to something because of two reasons: </p>\n  \n  <p>1) You want because your struct is really large and you want to avoid copying </p>\n  \n  <p>2) you need to because the calee wants to modify the original (this is typical for methods with a pointer receiver). Now an interface value is really tiny (just two words) so reason 1 to pass a pointer to an interface value does not apply. </p>\n  \n  <p>Reason 2 does not apply in most cases as passing a pointer to an interface value will allow you to change the interface value itself, but most often you would like to modify the value stored inside the interface value. This value stored inside the interface value often is a pointer value which allows to change the value of a struct by calling methods on an interface value which wrapps a pointer to this struct. This sounds complicated but isn't: The novice Go programmer just doesn't use pointers to interfaces (as this won't do any good) and the experienced Go programmer doesn't use pointers to interfaces (as it won't do much good) unless he needs to modify an interface value, typically during reflection.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1467, "user_id": 517783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9rdPU.jpg?s=128&g=1", "display_name": "Sameer Azazi", "link": "https://stackoverflow.com/users/517783/sameer-azazi"}, "is_accepted": false, "score": 1, "last_activity_date": 1467189653, "creation_date": 1467189653, "answer_id": 38094451, "question_id": 38093171, "link": "https://stackoverflow.com/questions/38093171/how-to-implement-interfaces-in-following-code/38094451#38094451", "title": "How to implement interfaces in following code?", "body": "<p>You can use Pb by link, you were just missing pointer reference while assigning.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype PBifaceT interface {\n    Step() int\n}\n\ntype TestDialogUiT struct {\n    Pb PBifaceT\n}\ntype ImplPBifaceT struct {\n}\n\nfunc (m *ImplPBifaceT) Step() int {\n    return 0\n}\n\nfunc main() {\n    x := TestDialogUiT{}\n    PbPb := &amp;ImplPBifaceT{}\n    x.Pb = PbPb\n\n    parentId := x.Pb.Step()\n    fmt.Printf(\"%v\", parentId)\n}\n</code></pre>\n\n<p>Please refer this playground link: <a href=\"https://play.golang.org/p/N7quQFpYU0\" rel=\"nofollow\">https://play.golang.org/p/N7quQFpYU0</a>\nChanges were at line 12, 17, 23 &amp; 27.</p>\n"}], "owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1467198918, "creation_date": 1467185729, "last_edit_date": 1467198918, "question_id": 38093171, "link": "https://stackoverflow.com/questions/38093171/how-to-implement-interfaces-in-following-code", "title": "How to implement interfaces in following code?", "body": "<p>I have the following code and I want to use interfaces:</p>\n\n<p>Current code:</p>\n\n<pre><code>import (        \n    \"github.com/dorzheh/deployer/ui/dialog_ui\"\n    . \"github.com/dorzheh/go-dialog\"\n)\n\n// all methods in https://github.com/dorzheh/deployer/blob/master/ui/dialog_ui/dialog_ui.go#L28\ntype Pb struct {\n    sleep time.Duration\n    step  int\n}\n\ntype DialogUi struct {\n    *Dialog //The source is https://github.com/dorzheh/go-dialog/blob/master/dialog.go#L34\n    Pb *Pb\n}\n</code></pre>\n\n<p>I am trying to implement interfaces this way:</p>\n\n<pre><code>import (\n    \"testing\"\n    // . \"github.com/dorzheh/go-dialog\"\n    //\"github.com/dorzheh/deployer/ui/dialog_ui\"\n)\n\n\ntype PBifaceT interface {\n    Step() int\n}\n\ntype TestDialogUiT struct {\n    Pb *PBifaceT\n}\n\nfunc TestUiValidateUser(t *testing.T) {\n    x := dialog_ui.TestDialogUiT{}\n    PbPb := ImplPBifaceT{}\n    x.Pb = PbPb\n\n    parentId := x.Pb.Step()\n    t.Logf(fmt.Sprintf(\"%v\", parentId))\n}\n</code></pre>\n\n<p>I've made a <a href=\"https://play.golang.org/p/2Uwe-D7uWI\" rel=\"nofollow\">playground</a>. As you can see it runs in the following error:</p>\n\n<pre><code>prog.go:23: cannot use PbPb (type ImplPBifaceT) as type *PBifaceT in assignment:\n    *PBifaceT is pointer to interface, not interface\nprog.go:25: x.Pb.Step undefined (type *PBifaceT is pointer to interface, not interface)\n</code></pre>\n\n<p>I tried to convert them <a href=\"https://play.golang.org/p/44Dhz-Zh37\" rel=\"nofollow\">in this playground</a>:</p>\n\n<pre><code>func NewD() *PBifaceT {\n    // var err error\n    var res =new(ImplPBifaceT)\n    return (*PBifaceT)(res)\n}\n\nfunc main() {\n    x := TestDialogUiT{}\n    x.Pb = NewD()\n    parentId := x.Pb.Step()\n    fmt.Sprintf(\"%v\", parentId)\n\n}\n</code></pre>\n\n<p>The issue:</p>\n\n<pre><code>prog.go:23: cannot convert res (type *ImplPBifaceT) to type *PBifaceT\nprog.go:30: x.Pb.Step undefined (type *PBifaceT is pointer to interface, not interface)\n</code></pre>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 2, "last_activity_date": 1467330005, "last_edit_date": 1467330005, "creation_date": 1467203169, "answer_id": 38099499, "question_id": 38093081, "link": "https://stackoverflow.com/questions/38093081/golang-effective-test-of-multiple-packages/38099499#38099499", "title": "Golang - Effective test of multiple packages", "body": "<p>This is the nature of <code>go test</code>: it builds a special runtime with addition code to execute (this is how it tracks code coverage).</p>\n\n<p>If it isnt fast enough, you have two options:</p>\n\n<p>1) use bash tooling to compile a list of packages (e.g. using <code>ls</code>), and then execute them each individually in parallel.  There exists many ways to do this in bash.</p>\n\n<p>The problem with this approach is that the output will be interleaved and difficult to track down failures.</p>\n\n<p>2) use the <code>t.Parallel()</code> flag with each of your tests to allow the test runtime to execute in parallel.  Since Go 1.5, <code>go test</code> runs with <code>GOMAXPROCS</code> set to the number of cores on your CPU which allows for concurrently running tests. Tests are still ran synchronously by default.  You have to set the <code>t.Parallel()</code> flag for each test, telling the runtime it is OK to execute this test in parallel.</p>\n\n<p>The problem with this approach being that it assumes you followed best practices and have used SoC/decoupling, don't have global states that would mutate in the middle of another test, no mutex locks (or very few of them), no race condition issues (use <code>-race</code>), etc.</p>\n\n<p>--</p>\n\n<p>Opinion: Personally, I setup my IDE to run <code>gofmt</code> and <code>go test -cover -short</code> on every Save.  that way, my code is always formatted and my tests are run, only within the package I am in, telling me if something failed.  The <code>-cover</code> flag works with my IDE to show me the lines of code that have been tested versus not tested. The <code>-short</code> flag allows me to write tests that I know will take a while to run, and within those tests I can check <code>t.Short()</code> bool to see if I should <code>t.Skip()</code> that test.  There should be packages available for your favorite IDE to set this up (I did it in Sublime, VIM and now Atom).</p>\n\n<p>That way, I have instant feedback within the package I m editing.</p>\n\n<p>Before I commit the code, I then run all tests across all packages.  Or, I can just have the C.I. server do it.</p>\n\n<p>Alternatively, you can make use of the <code>-short</code> flag and <code>build tags</code> (e.g. <code>go test -tags integration</code>) to refactor your tests to separate your Unit tests from Integration tests.  This is how I write my tests:</p>\n\n<ul>\n<li><p>test that are fast and can run in parallel &lt;- I make these tests run by default with <code>go test</code> and <code>go test -short</code>.</p></li>\n<li><p>slow tests or tests that require external components, I require addition input to run, like <code>go test -tags integration</code> is required to run them. This pattern does not run the integration tests with a normal <code>go test</code>, you have to specify the additional tag. I don't run the integration tests across the board either.  That's what my CI servers are for.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "is_accepted": false, "score": 0, "last_activity_date": 1467208905, "last_edit_date": 1592644375, "creation_date": 1467208905, "answer_id": 38101952, "question_id": 38093081, "link": "https://stackoverflow.com/questions/38093081/golang-effective-test-of-multiple-packages/38101952#38101952", "title": "Golang - Effective test of multiple packages", "body": "<p>If you follow a consistent name scheme for your tests you can easily reduce the number of them you execute by using the <code>-run</code> flag.</p>\n<p>Quoting from <code>go help testflag</code>:</p>\n<blockquote>\n<p>-run regexp</p>\n<p>Run only those tests and examples matching the regular expression.</p>\n</blockquote>\n<p>So let's say you have 3 packages: <code>foo</code>, <code>bar</code> and <code>qux</code>. Tests of those packages are all named like <code>TestFoo..</code>, <code>TestBar..</code> and <code>TestQux..</code> respectively.</p>\n<p>You could do <code>go test -run '^Test(Foo|Bar)*' ./...</code> to run only tests from <code>foo</code> and <code>bar</code> package.</p>\n"}], "owner": {"reputation": 2745, "user_id": 1268294, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qymw2.jpg?s=128&g=1", "display_name": "Pawe\u0142 Adamski", "link": "https://stackoverflow.com/users/1268294/pawe%c5%82-adamski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1370, "favorite_count": 0, "accepted_answer_id": 38099499, "answer_count": 2, "score": 0, "last_activity_date": 1467330005, "creation_date": 1467185438, "question_id": 38093081, "link": "https://stackoverflow.com/questions/38093081/golang-effective-test-of-multiple-packages", "title": "Golang - Effective test of multiple packages", "body": "<p>I want to execute all tests from my application, now I do it with command:</p>\n\n<pre><code>go test ./app/... \n</code></pre>\n\n<p>Unfortunately it takes quite a long time, despite that single tests run quite fast. I think that the problem is that <code>go</code> needs to compile every package (with its dependence) before it runs tests.</p>\n\n<p>I tried to use <code>-i</code> flag, it help a bit but still I'm not satisfied with the testing time.</p>\n\n<pre><code>go test -i ./app/... \ngo test ./app/... \n</code></pre>\n\n<p>Do you have any better idea how to efficiently test multiple packages.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1467187748, "post_id": 38093041, "comment_id": 63622676, "body": "What is unclear in the documentation you get from <code>go help run</code>, <code>go help build</code> and <code>go help install</code>?"}, {"owner": {"reputation": 2713, "user_id": 3664629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cd0e689accf22b71e7b020f321538a0?s=128&d=identicon&r=PG&f=1", "display_name": "Kumaran", "link": "https://stackoverflow.com/users/3664629/kumaran"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1467202098, "post_id": 38093041, "comment_id": 63632419, "body": "@Volker I am not able to understand the usecase"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1467202413, "post_id": 38093041, "comment_id": 63632620, "body": "<code>go install</code> compiles packages and binaries and stores them in $GOPATH/pkg and $GOPATH/bin. <code>go build</code> builds packages and discards the result, for binaries it builds and keeps the executable. <code>go run</code> is a handy shortcut to build some code and run it directly."}, {"owner": {"reputation": 596, "user_id": 8413106, "user_type": "registered", "profile_image": "https://graph.facebook.com/1636436336400839/picture?type=large", "display_name": "Harsh Nagarkar", "link": "https://stackoverflow.com/users/8413106/harsh-nagarkar"}, "edited": false, "score": 0, "creation_date": 1606518021, "post_id": 38093041, "comment_id": 114993279, "body": "Checkout all command official documentation on <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">golang.org/cmd/go</a>"}], "owner": {"reputation": 2713, "user_id": 3664629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cd0e689accf22b71e7b020f321538a0?s=128&d=identicon&r=PG&f=1", "display_name": "Kumaran", "link": "https://stackoverflow.com/users/3664629/kumaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3927, "favorite_count": 0, "closed_date": 1467207993, "answer_count": 0, "score": 4, "last_activity_date": 1467185273, "creation_date": 1467185273, "question_id": 38093041, "link": "https://stackoverflow.com/questions/38093041/difference-between-go-run-go-build-and-go-install", "closed_reason": "Duplicate", "title": "Difference between &quot;go run&quot;, &quot;go build&quot; and &quot;go install&quot;", "body": "<p>What are the differences between \"go run\", \"go build\" and \"go install\" and in which cases I should use them?</p>\n"}, {"tags": ["json", "go", "encoding"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467186056, "post_id": 38093109, "comment_id": 63621644, "body": "@SaidSaifi Please see edited answer. You have to start the field name with an uppercase letter, as you can see in the code I included."}, {"owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 0, "creation_date": 1467186302, "post_id": 38093109, "comment_id": 63621781, "body": "Thank you, I upgraded and accepted your answer but it will only appear when I reach 15 reputations :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1467185932, "last_edit_date": 1467185932, "creation_date": 1467185540, "answer_id": 38093109, "question_id": 38093012, "link": "https://stackoverflow.com/questions/38093012/printing-empty-json-as-a-result/38093109#38093109", "title": "Printing Empty Json as a result", "body": "<p>The <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"noreferrer\"><code>encoding/json</code></a> package uses reflection (<a href=\"https://golang.org/pkg/reflect/\" rel=\"noreferrer\"><code>reflect</code></a> package) to access fields of structs. You need to export the fields of your struct to make it work (start them with an uppercase letter):</p>\n\n<pre><code>type Book struct {\n    Isbn   string\n    Title  string\n    Author string\n    Price  float32\n}\n</code></pre>\n\n<p>And when scanning:</p>\n\n<pre><code>err := rows.Scan(&amp;bk.Isbn, &amp;bk.Title, &amp;bk.Author, &amp;bk.Price)\n</code></pre>\n\n<p>Quoting from <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"noreferrer\"><code>json.Marshal()</code></a>:</p>\n\n<blockquote>\n  <p>Struct values encode as JSON objects. Each <strong>exported struct field</strong> becomes a member of the object...</p>\n</blockquote>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 0, "closed_date": 1562845088, "accepted_answer_id": 38093109, "answer_count": 1, "score": 4, "last_activity_date": 1467185964, "creation_date": 1467185203, "last_edit_date": 1467185964, "question_id": 38093012, "link": "https://stackoverflow.com/questions/38093012/printing-empty-json-as-a-result", "closed_reason": "Duplicate", "title": "Printing Empty Json as a result", "body": "<p>I am trying to retrieve some data from my postgres db and printing them to <code>localhost/db</code> as json. I am succeeding in printing them without json but I need them in json.</p>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n\n    _ \"github.com/lib/pq\"\n)\n\ntype Book struct {\n    isbn   string\n    title  string\n    author string\n    price  float32\n}\n\nvar b []Book\n\nfunc main() {\n\n    db, err := sql.Open(\"postgres\", \"postgres://****:****@localhost/postgres?sslmode=disable\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n    rows, err := db.Query(\"SELECT * FROM books\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer rows.Close()\n\n    var bks []Book\n    for rows.Next() {\n        bk := new(Book)\n        err := rows.Scan(&amp;bk.isbn, &amp;bk.title, &amp;bk.author, &amp;bk.price)\n        if err != nil {\n            log.Fatal(err)\n        }\n        bks = append(bks, *bk)\n    }\n    if err = rows.Err(); err != nil {\n        log.Fatal(err)\n    }\n\n    b = bks\n\n    http.HandleFunc(\"/db\", getBooksFromDB)\n    http.ListenAndServe(\"localhost:1337\", nil)\n\n}\n\nfunc getBooksFromDB(w http.ResponseWriter, r *http.Request) {\n\n    fmt.Println(b)\n    response, err := json.Marshal(b)\n    if err != nil {\n        panic(err)\n\n    }\n\n    fmt.Fprintf(w, string(response))\n}\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/8kefD.png\" rel=\"nofollow\">This is what I get when I access localhost:1337/db</a></p>\n\n<p>And this is the output on the terminal:</p>\n\n<pre><code> [{978-1503261969 Emma Jayne Austen 9.44} {978-1505255607 The Time Machine H. G. Wells 5.99} {978-1503379640 The Prince Niccol\u00f2 Machiavelli 6.99}]\n</code></pre>\n\n<p>Anyone knows what is the problem?</p>\n"}, {"tags": ["go", "udp"], "comments": [{"owner": {"reputation": 48, "user_id": 6526794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4sBV.jpg?s=128&g=1", "display_name": "TheHan", "link": "https://stackoverflow.com/users/6526794/thehan"}, "edited": false, "score": 0, "creation_date": 1467191640, "post_id": 38092388, "comment_id": 63625228, "body": "Thanks to icza and my colleague, flags means things like MSG_DONTROUTE, MSG_EOR, MSG_TRUNC,etc, in C."}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 6526794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4sBV.jpg?s=128&g=1", "display_name": "TheHan", "link": "https://stackoverflow.com/users/6526794/thehan"}, "edited": false, "score": 0, "creation_date": 1467191067, "post_id": 38092625, "comment_id": 63624830, "body": "Thank you very much! Though godoc also needs to have access to Go&#39;s website, I copied it from my colleague. And it works now!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 48, "user_id": 6526794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4sBV.jpg?s=128&g=1", "display_name": "TheHan", "link": "https://stackoverflow.com/users/6526794/thehan"}, "edited": false, "score": 0, "creation_date": 1467191436, "post_id": 38092625, "comment_id": 63625083, "body": "@TheHan Pages presented by <code>godoc</code> may include content from the official Go home page, but if you don&#39;t have access, those content will simply not be displayed. It works without internet connection (or having no connection to Go&#39;s home page)."}, {"owner": {"reputation": 48, "user_id": 6526794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4sBV.jpg?s=128&g=1", "display_name": "TheHan", "link": "https://stackoverflow.com/users/6526794/thehan"}, "edited": false, "score": 0, "creation_date": 1467192136, "post_id": 38092625, "comment_id": 63625569, "body": "Content from sites such as github, golang-china,etc, will help a lot. I will try vpn to visit google when these sites have no information I want afterwards."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1467184353, "last_edit_date": 1467184353, "creation_date": 1467184018, "answer_id": 38092625, "question_id": 38092388, "link": "https://stackoverflow.com/questions/38092388/what-does-the-return-parameter-flags-mean-in-readmsgudp/38092625#38092625", "title": "What does the return parameter &quot;flags&quot; mean in ReadMsgUDP?", "body": "<p>You don't need to have access to Go's website to read the documentation. The distributions include a tool called <a href=\"https://godoc.org/golang.org/x/tools/cmd/godoc\" rel=\"nofollow\"><code>godoc</code></a> which can start a local HTTP server and host a similar website you see on Go's home page. You can start it locally by running the following command:</p>\n\n<pre><code>godoc -http=:6060\n</code></pre>\n\n<p>Then visit the following local URL in your browser:</p>\n\n<pre><code>http://localhost:6060/\n</code></pre>\n\n<p>Documentation of <a href=\"https://golang.org/pkg/net/#UDPConn.ReadMsgUDP\" rel=\"nofollow\"><code>UDPConn.ReadMsgUDP()</code></a>:</p>\n\n<pre><code>http://localhost:6060/pkg/net/#UDPConn.ReadMsgUDP\n</code></pre>\n\n<p>Quoting the relevant part:</p>\n\n<pre><code>func (c *UDPConn) ReadMsgUDP(b, oob []byte) (n, oobn, flags int, addr *UDPAddr, err error)\n</code></pre>\n\n<blockquote>\n  <p>ReadMsgUDP reads a packet from c, copying the payload into b and the associated out-of-band data into oob. It returns the number of bytes copied into b, the number of bytes copied into oob, <strong>the flags that were set on the packet and the source address of the packet</strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 48, "user_id": 6526794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4sBV.jpg?s=128&g=1", "display_name": "TheHan", "link": "https://stackoverflow.com/users/6526794/thehan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 38092625, "answer_count": 1, "score": 2, "last_activity_date": 1467185242, "creation_date": 1467183356, "last_edit_date": 1467185242, "question_id": 38092388, "link": "https://stackoverflow.com/questions/38092388/what-does-the-return-parameter-flags-mean-in-readmsgudp", "title": "What does the return parameter &quot;flags&quot; mean in ReadMsgUDP?", "body": "<p>I'm using the function <code>ReadMsgUDP</code> in connectionless-oriented UDP, and it goes well so far. But I have no idea about the return parameter <code>flags</code>, anyone knows it?</p>\n\n<p>Moreover, I'm Chinese and cannot visit the official Go website in Google, can anyone send me some official documents of Go via mail?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 1582, "user_id": 4604899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WyuD9.jpg?s=128&g=1", "display_name": "Julien Chien", "link": "https://stackoverflow.com/users/4604899/julien-chien"}, "is_accepted": true, "score": 12, "last_activity_date": 1468124681, "creation_date": 1468124681, "answer_id": 38288570, "question_id": 38091816, "link": "https://stackoverflow.com/questions/38091816/packages-type-cannot-be-used-as-the-vendored-packages-type/38288570#38288570", "title": "package&#39;s type cannot be used as the vendored package&#39;s type", "body": "<p>The solution here seems to be that the library I'm trying to use needs to be reworked to prevent this kind of thing from happening.</p>\n\n<p>The two possible ways to change the library seem to be </p>\n\n<p>1) not vendor at all - this works if the dependency does not need to be a specific version.</p>\n\n<p>2) vendored, but do not expose the vendored library to the public. Create some wrapper functions in the library so that people can create the types indirectly.</p>\n\n<p>See <a href=\"https://www.reddit.com/r/golang/comments/49w33f/how_do_you_handle_vendoring_in_libraries/\" rel=\"noreferrer\">this discussion about vendoring on reddit for more ideas/reasons why.</a></p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 5592733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qa7WM.jpg?s=128&g=1", "display_name": "Randy Yuan", "link": "https://stackoverflow.com/users/5592733/randy-yuan"}, "is_accepted": false, "score": 10, "last_activity_date": 1501026348, "creation_date": 1501026348, "answer_id": 45315194, "question_id": 38091816, "link": "https://stackoverflow.com/questions/38091816/packages-type-cannot-be-used-as-the-vendored-packages-type/45315194#45315194", "title": "package&#39;s type cannot be used as the vendored package&#39;s type", "body": "<p>I had the same issue. As a work around, I deleted the associated package's vendor folder and moved their content to my $GOPATH folder.</p>\n\n<p>Source of answer: <a href=\"https://github.com/prometheus/prometheus/issues/1720\" rel=\"noreferrer\">https://github.com/prometheus/prometheus/issues/1720</a></p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 1869260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba787365684280f8e6f8e71089e74e9e?s=128&d=identicon&r=PG", "display_name": "Viktor Yarmak", "link": "https://stackoverflow.com/users/1869260/viktor-yarmak"}, "is_accepted": false, "score": 4, "last_activity_date": 1526584365, "creation_date": 1526584365, "answer_id": 50398949, "question_id": 38091816, "link": "https://stackoverflow.com/questions/38091816/packages-type-cannot-be-used-as-the-vendored-packages-type/50398949#50398949", "title": "package&#39;s type cannot be used as the vendored package&#39;s type", "body": "<p>Just had a similar issue. Putting both libraries in <code>/vendor</code> resolved. Using <code>govendor get xxxx</code></p>\n"}, {"tags": [], "owner": {"reputation": 9831, "user_id": 455642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scI3g.png?s=128&g=1", "display_name": "Aldo &#39;xoen&#39; Giambelluca", "link": "https://stackoverflow.com/users/455642/aldo-xoen-giambelluca"}, "is_accepted": false, "score": 1, "last_activity_date": 1539022376, "creation_date": 1539022376, "answer_id": 52707931, "question_id": 38091816, "link": "https://stackoverflow.com/questions/38091816/packages-type-cannot-be-used-as-the-vendored-packages-type/52707931#52707931", "title": "package&#39;s type cannot be used as the vendored package&#39;s type", "body": "<p>Had a similar issue while using Godep and I resolved by deleting <code>/vendor</code> and re-running <code>godep save ./...</code> - Hope it helps.</p>\n"}], "owner": {"reputation": 1582, "user_id": 4604899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WyuD9.jpg?s=128&g=1", "display_name": "Julien Chien", "link": "https://stackoverflow.com/users/4604899/julien-chien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12089, "favorite_count": 6, "accepted_answer_id": 38288570, "answer_count": 4, "score": 33, "last_activity_date": 1558915811, "creation_date": 1467181443, "question_id": 38091816, "link": "https://stackoverflow.com/questions/38091816/packages-type-cannot-be-used-as-the-vendored-packages-type", "title": "package&#39;s type cannot be used as the vendored package&#39;s type", "body": "<p>I'm trying to use this <a href=\"https://github.com/JustinBeckwith/go-yelp/tree/master/yelp\" rel=\"noreferrer\">Golang Yelp API package</a>. In some of its structs, it uses types defined in <a href=\"http://github.com/guregu/null\" rel=\"noreferrer\">guregu's null package</a>.</p>\n\n<p>I want to declare a struct defined in the Yelp API package, where some of its fields have <code>null.Float</code> as a value (<a href=\"https://github.com/JustinBeckwith/go-yelp/blob/master/yelp/coordinate_options.go#L14\" rel=\"noreferrer\">i.e. this struct, which im trying to use</a>). So in my program, I import both the Yelp API package and guregu's null package and try to declare the struct, with ip.Lat and ip.Lat being float64s. <a href=\"https://github.com/guregu/null/blob/master/float.go#L29\" rel=\"noreferrer\">(<code>null.FloatFrom</code> definition)</a>:</p>\n\n<pre><code> 33         locationOptions := yelp.LocationOptions{\n 34                 ip.Zip,\n 35                 &amp;yelp.CoordinateOptions{\n 36                         Latitude: null.FloatFrom(ip.Lat),\n 37                         Longitude: null.FloatFrom(ip.Lon),\n 38                 },\n 39         }\n</code></pre>\n\n<p>But when I run the program, it tells me:</p>\n\n<pre><code>./cli.go:36: cannot use \"github.com/guregu/null\".FloatFrom(ip.Lat) (type\n\"github.com/guregu/null\".Float) as type \"github.com/JustinBeckwith/go-\nyelp/yelp/vendor/github.com/guregu/null\".Float in field value\n</code></pre>\n\n<p>I tried 2 things: </p>\n\n<p>1) I did not import the <code>null</code> package, which caused Go to complain about <code>null</code> being undefined. 2) I also tried importing the vendored package directly, which caused Go to tell me <code>use of vendored package not allowed</code>.</p>\n\n<p>Any Ideas on how to fix this?</p>\n"}, {"tags": ["session", "cookies", "go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 927, "user_id": 1174972, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21f35146c9eedc7b990c367ec86dcdc?s=128&d=identicon&r=PG", "display_name": "shicky", "link": "https://stackoverflow.com/users/1174972/shicky"}, "edited": false, "score": 0, "creation_date": 1467180463, "post_id": 38091192, "comment_id": 63618496, "body": "So gorilla/sessions persists data into securecookie but also keeps copy in context for access? Looks like it caches session into context upon Save()"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1467178765, "creation_date": 1467178765, "answer_id": 38091192, "question_id": 38091039, "link": "https://stackoverflow.com/questions/38091039/why-would-you-use-gorilla-context-instead-of-session-for-user-authentication/38091192#38091192", "title": "Why would you use gorilla/context instead of session for user authentication?", "body": "<p>The <a href=\"https://godoc.org/github.com/gorilla/sessions\" rel=\"nofollow\">gorilla/sessions</a> package uses <a href=\"https://godoc.org/github.com/gorilla/context\" rel=\"nofollow\">gorilla/context</a> in its implementation.</p>\n\n<p>If the application uses session data to store id of the authenticated user, then the application does not need use the gorilla/context package directly.</p>\n"}], "owner": {"reputation": 927, "user_id": 1174972, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21f35146c9eedc7b990c367ec86dcdc?s=128&d=identicon&r=PG", "display_name": "shicky", "link": "https://stackoverflow.com/users/1174972/shicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467178765, "creation_date": 1467178067, "last_edit_date": 1467178398, "question_id": 38091039, "link": "https://stackoverflow.com/questions/38091039/why-would-you-use-gorilla-context-instead-of-session-for-user-authentication", "title": "Why would you use gorilla/context instead of session for user authentication?", "body": "<p>I understand the difference between <strong>context</strong> and <strong>session</strong> in <code>golang</code>.</p>\n\n<p><code>gorilla/context</code> stores values shared during a request lifetime whereas <code>gorilla/session</code> data persists across multiple requests through secure cookie.</p>\n\n<p>Some blogs claim that <strong>context is required</strong> to pass user data from one middleware to another.</p>\n\n<p>For user authentication, you would have to store user data in session <strong>anyways</strong> and <strong>why</strong> would you store user data into context as well?</p>\n\n<p>I suppose it is so that you don't have to get user data from <strong>session (cookie)</strong> again but it seems redundant.</p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1467178543, "post_id": 38091000, "comment_id": 63617666, "body": "So the write to the channel blocks, even though the channel is out of scope and can never be read from again. I wonder if that&#39;s a bug or a feature."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1467179691, "post_id": 38091000, "comment_id": 63618132, "body": "Yes, send will block even though there is no receiver. The runtime could be written to detect when the application is done receiving on a channel in this specific example, but it&#39;s not something that the runtime can detect in general."}, {"owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "edited": false, "score": 1, "creation_date": 1480504210, "post_id": 38091000, "comment_id": 68987519, "body": "As a note, there is a &quot;non-blocking send&quot; available as well, which solves this exact problem - you&#39;d set the buffer on the channel to 1 and each would send without blocking.  Described in more detail here: <a href=\"https://blog.golang.org/go-concurrency-patterns-timing-out-and\" rel=\"nofollow noreferrer\">blog.golang.org/go-concurrency-patterns-timing-out-and</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1480512765, "last_edit_date": 1480512765, "creation_date": 1467177885, "answer_id": 38091000, "question_id": 38090545, "link": "https://stackoverflow.com/questions/38090545/are-goroutines-garbage-collected-together-with-their-channels/38091000#38091000", "title": "Are goroutines garbage collected together with their channels?", "body": "<p>If the channel is unbuffered, then one of the anonymous functions will not return.  The program leaks a goroutine and channel.</p>\n\n<p>If the channel has a buffer size greater than or equal to one, then both of the  anonymous functions will return. The resources used by the goroutines and channel will be reclaimed.</p>\n\n<p>A buffer size of one is sufficient to prevent the leak. The function <code>waitForOneOfTwoProcesses</code> receives one of the values sent to <code>c</code>.  The second value sent to <code>c</code> is buffered in the channel (which is collected by the GC).</p>\n\n<p>Another way to ensure that the goroutines return is to use non-blocking send. Replace the <code>c &lt;- true</code> lines with:</p>\n\n<pre><code> select {\n case c &lt;- true:\n default:\n }\n</code></pre>\n"}], "owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2257, "favorite_count": 0, "accepted_answer_id": 38091000, "answer_count": 1, "score": 6, "last_activity_date": 1480512765, "creation_date": 1467175340, "question_id": 38090545, "link": "https://stackoverflow.com/questions/38090545/are-goroutines-garbage-collected-together-with-their-channels", "title": "Are goroutines garbage collected together with their channels?", "body": "<p>Imagine the following code:</p>\n\n<pre><code>func waitForOneOfTwoProcesses() {\n\n    c := make(chan bool)\n    go func() {\n        time.Sleep(1 * time.Second)\n        c&lt;-true\n    }()\n    go func() {\n        time.Sleep(2 * time.Second)\n        c&lt;-true\n    }()\n    &lt;-c\n\n}\n</code></pre>\n\n<p>Does this leak a channel and a goroutine or does Go recognize that <code>c</code> is gone and the goroutine can exit?</p>\n\n<p>Would the answer be any different if the channel had a buffer size of 2?</p>\n"}, {"tags": ["dictionary", "go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1467174288, "post_id": 38090277, "comment_id": 63616212, "body": "<code>all[0] = map[string]string{&quot;hello&quot;: &quot;world&quot;}</code>. Take the Tour of Go (once more)."}], "answers": [{"comments": [{"owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "edited": false, "score": 0, "creation_date": 1467257231, "post_id": 38090422, "comment_id": 63660224, "body": "This works. But I was asking to see if there is any other simpler, more native go like method to deep initialize. Thanks anyways :)"}], "tags": [], "owner": {"reputation": 27792, "user_id": 1830293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6prVF.jpg?s=128&g=1", "display_name": "DAXaholic", "link": "https://stackoverflow.com/users/1830293/daxaholic"}, "is_accepted": false, "score": 3, "last_activity_date": 1467174697, "creation_date": 1467174697, "answer_id": 38090422, "question_id": 38090277, "link": "https://stackoverflow.com/questions/38090277/how-to-initialize-a-slice-of-maps-correctly/38090422#38090422", "title": "How to initialize a slice of maps correctly", "body": "<p>I think the author wants to pre-init the slice with default instances like so</p>\n\n<pre><code>func main() {\n    all := make([]map[string]string, 3)\n    for idx, _ := range all {\n      all[idx] = map[string]string{}\n    }\n    first := all[0]\n    first[\"hello\"] = \"world\"\n    fmt.Println(all)\n}\n</code></pre>\n"}], "owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467174697, "creation_date": 1467173816, "question_id": 38090277, "link": "https://stackoverflow.com/questions/38090277/how-to-initialize-a-slice-of-maps-correctly", "title": "How to initialize a slice of maps correctly", "body": "<p>So I want to be able to create a slice of maps such that when I access any element of the slice, I get a not-nil map.</p>\n\n<p>Here is my code so far. But I get the error of <code>panic: assignment to entry in nil map</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    all := make([]map[string]string, 3)\n    first := all[0]\n    first[\"hello\"] = \"world\"\n    fmt.Println(all)\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "edited": false, "score": 0, "creation_date": 1467173794, "post_id": 38089577, "comment_id": 63616090, "body": "Thank you that helped towards the answer."}], "tags": [], "owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "is_accepted": false, "score": 1, "last_activity_date": 1467168794, "creation_date": 1467168794, "answer_id": 38089577, "question_id": 38089524, "link": "https://stackoverflow.com/questions/38089524/golang-postgres-connection-string-not-opening-return-null/38089577#38089577", "title": "Golang Postgres connection string not opening return null", "body": "<p>Your </p>\n\n<pre><code> rows, err := db.Query(\"SELECT city FROM streams WHERE id=69\", age)\n</code></pre>\n\n<p>has to be:</p>\n\n<pre><code> rows, err := db.Query(\"SELECT city FROM streams WHERE id = ?\", age)\n</code></pre>\n\n<p>also </p>\n\n<pre><code> defer db.Close()\n</code></pre>\n\n<p>goes after you execute the query.</p>\n"}, {"comments": [{"owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "edited": false, "score": 0, "creation_date": 1467173864, "post_id": 38089620, "comment_id": 63616109, "body": "Thank you it was the lack of the dollar sign that gave out the nil."}], "tags": [], "owner": {"reputation": 824, "user_id": 4412661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aXJT6.jpg?s=128&g=1", "display_name": "Steve C", "link": "https://stackoverflow.com/users/4412661/steve-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1467169090, "creation_date": 1467169090, "answer_id": 38089620, "question_id": 38089524, "link": "https://stackoverflow.com/questions/38089524/golang-postgres-connection-string-not-opening-return-null/38089620#38089620", "title": "Golang Postgres connection string not opening return null", "body": "<p>Could you add the ping code and see what error is returned?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"database/sql\"\n    _ \"github.com/lib/pq\"\n\n    \"log\"\n)\n\nfunc main() {\n\n    db, err := sql.Open(\"postgres\", \"user=postgres password=password dbname=name sslmode=disable\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err = db.Ping()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer db.Close()\n    age := 21\n    rows, err := db.Query(\"SELECT city FROM streams WHERE id=$1\", age)\n\n    fmt.Println(rows)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2561, "favorite_count": 0, "accepted_answer_id": 38089620, "answer_count": 2, "score": 0, "last_activity_date": 1467169090, "creation_date": 1467168442, "question_id": 38089524, "link": "https://stackoverflow.com/questions/38089524/golang-postgres-connection-string-not-opening-return-null", "title": "Golang Postgres connection string not opening return null", "body": "<p>I am sure that there is something with the connectionString as the values I am giving are the same values that I use in Java to log into the same database. This is my code</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"database/sql\"\n    _ \"github.com/lib/pq\"\n\n    \"log\"\n)\n\n\n\n\nfunc main() {\n\n\n    db, err := sql.Open(\"postgres\", \"user=postgres password=password dbname=name sslmode=disable\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n     defer db.Close()\n    age := 21\n    rows, err := db.Query(\"SELECT city FROM streams WHERE id=69\", age)\n\n    fmt.Println(rows)\n\n}\n</code></pre>\n\n<p>I am using what I found here <a href=\"https://godoc.org/github.com/lib/pq\" rel=\"nofollow\">https://godoc.org/github.com/lib/pq</a> my postgres version is 9.4 and my Go Version is 1.6 . I have no idea why it is happening.</p>\n"}, {"tags": ["go", "escaping"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467181925, "post_id": 38089510, "comment_id": 63619192, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13820280/encode-decode-urls\">Encode / decode URLs</a>"}, {"owner": {"reputation": 349, "user_id": 4335421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b2107f9e50d9f9d78282260b581011?s=128&d=identicon&r=PG", "display_name": "alienth", "link": "https://stackoverflow.com/users/4335421/alienth"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467189835, "post_id": 38089510, "comment_id": 63624015, "body": "I did review that question before posting. It is not a duplicate, as the question and solution provided does not account for or work with escaping of forward slashes in the URI components."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467204274, "post_id": 38089510, "comment_id": 63633922, "body": "What do you want exactly? The <i>exact</i> equivalent of JavaScript&#39;s <code>encodeURIComponent()</code>?"}, {"owner": {"reputation": 349, "user_id": 4335421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b2107f9e50d9f9d78282260b581011?s=128&d=identicon&r=PG", "display_name": "alienth", "link": "https://stackoverflow.com/users/4335421/alienth"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467224152, "post_id": 38089510, "comment_id": 63648064, "body": "Something which will appropriately encode a URI component which includes forward slashes and spaces. I was hoping there was a standard lib out there to do so, but apparently there isn&#39;t - I created this as an issue on Golang&#39;s GH and it was tagged with Go1.8."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467228708, "post_id": 38089510, "comment_id": 63650743, "body": "For those who want to follow the progress of the github issue, here&#39;s the link: <a href=\"https://github.com/golang/go/issues/16207\" rel=\"nofollow noreferrer\">net/url: No adequate method exists for encoding a URI component #16207</a>"}], "answers": [{"tags": [], "owner": {"reputation": 376, "user_id": 899843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2156758e4d22a4dc2a4df09d51931e8e?s=128&d=identicon&r=PG", "display_name": "Josh Lubawy", "link": "https://stackoverflow.com/users/899843/josh-lubawy"}, "is_accepted": false, "score": 1, "last_activity_date": 1484823246, "creation_date": 1484823246, "answer_id": 41740025, "question_id": 38089510, "link": "https://stackoverflow.com/questions/38089510/is-there-a-standard-way-to-encode-a-uri-component-containing-both-forward-slashe/41740025#41740025", "title": "Is there a standard way to encode a URI component containing both forward-slashes and whitespace in Go?", "body": "<p>Apparently a version of your issue made it in <a href=\"https://go-review.googlesource.com/#/c/31322/\" rel=\"nofollow noreferrer\">go1.8</a> as <code>url.PathEscape</code>.</p>\n\n<p>In go1.8 the code you're looking for would be as simple as:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n)\n\nconst expected = \"/object/test%2Fbar%20baz\"\n\nfunc main() {\n    uri := \"/object/\"\n    name := \"test/bar baz\"\n\n    fmt.Printf(\"%-25s %s\\n\", \"Expected:\", expected)\n    fmt.Printf(\"%-25s %s\\n\", \"Actual  :\", uri+url.PathEscape(name))\n}\n</code></pre>\n\n<p>Good question.</p>\n"}], "owner": {"reputation": 349, "user_id": 4335421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b2107f9e50d9f9d78282260b581011?s=128&d=identicon&r=PG", "display_name": "alienth", "link": "https://stackoverflow.com/users/4335421/alienth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1484823246, "creation_date": 1467168378, "question_id": 38089510, "link": "https://stackoverflow.com/questions/38089510/is-there-a-standard-way-to-encode-a-uri-component-containing-both-forward-slashe", "title": "Is there a standard way to encode a URI component containing both forward-slashes and whitespace in Go?", "body": "<p>I'm interacting with an API which takes URI components that may contain both forward-slashes and spaces. I need to percent-encode this URI component so that both the forward-slashes and spaces are properly encoded. Example Go code can be found <strong><a href=\"https://play.golang.org/p/loaa8vvCli\" rel=\"nofollow\">here</a></strong>.</p>\n\n<p>I turned to <code>net/url</code> to tackle this, but turns out it doesn't do what I want, apparently.</p>\n\n<ul>\n<li><code>url.QueryEscape()</code> is intended for query strings, and as such it turns whitespace into <code>+</code> rather than <code>%20</code>.</li>\n<li><code>url.Parse()</code> and <code>url.ParseRequestUri()</code> will turn whitespace into <code>%20</code>, but it will ignore <code>/</code>, as it should.</li>\n</ul>\n\n<p>Since I'm very likely to muck this up (escaping is <a href=\"https://golang.org/src/net/url/url.go?s=6331:6364#L97\" rel=\"nofollow\">non-trivial</a>), I'd prefer I relied upon some standard library out there to do this for me. Does such a standard method exist in a well-tested Go library?</p>\n\n<p>Side note: The behaviour I'm seeking is identical to JS's <code>encodeURIcomponent</code>.</p>\n"}, {"tags": ["go", "timeout"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6429699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Y2z.jpg?s=128&g=1", "display_name": "Pimptech", "link": "https://stackoverflow.com/users/6429699/pimptech"}, "edited": false, "score": 0, "creation_date": 1467702708, "post_id": 38163481, "comment_id": 63819027, "body": "I edited my question with the sample code. I spent some time on it and i can&#39;t see how to make it faster o0.. I don&#39;t know HOW CodeEval stops due to timeout. Only if they have a TXT file with a HUGE iterations, but even though it will request a huge time to do a huge iterations in almost any machine."}, {"owner": {"reputation": 77, "user_id": 6429699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Y2z.jpg?s=128&g=1", "display_name": "Pimptech", "link": "https://stackoverflow.com/users/6429699/pimptech"}, "edited": false, "score": 0, "creation_date": 1467705401, "post_id": 38163481, "comment_id": 63820494, "body": "Few punches in the head and it works, following the logic on this link. Thanks!"}], "tags": [], "owner": {"reputation": 1066, "user_id": 1212526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11badd2a99cfb8290ade0313673b5d5d?s=128&d=identicon&r=PG", "display_name": "Tan&#233; Tachyon", "link": "https://stackoverflow.com/users/1212526/tan%c3%a9-tachyon"}, "is_accepted": true, "score": 1, "last_activity_date": 1467485614, "creation_date": 1467485614, "answer_id": 38163481, "question_id": 38088721, "link": "https://stackoverflow.com/questions/38088721/codeevalgo-codeeval-error-process-was-aborted-due-to-timeout/38163481#38163481", "title": "[CodeEval][GO] CodeEval Error: Process was aborted due to timeout", "body": "<p>There's a certain edge case you are probably missing in your code. See <a href=\"https://getsatisfaction.com/codeeval/topics/bubble-sort-iterations-are-too-high-causing-solution-to-be-aborted-in-java\" rel=\"nofollow\">https://getsatisfaction.com/codeeval/topics/bubble-sort-iterations-are-too-high-causing-solution-to-be-aborted-in-java</a></p>\n"}], "owner": {"reputation": 77, "user_id": 6429699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6Y2z.jpg?s=128&g=1", "display_name": "Pimptech", "link": "https://stackoverflow.com/users/6429699/pimptech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 38163481, "answer_count": 1, "score": -1, "last_activity_date": 1467705353, "creation_date": 1467162733, "last_edit_date": 1467705353, "question_id": 38088721, "link": "https://stackoverflow.com/questions/38088721/codeevalgo-codeeval-error-process-was-aborted-due-to-timeout", "title": "[CodeEval][GO] CodeEval Error: Process was aborted due to timeout", "body": "<p>I was trying to submit my solution of <a href=\"https://www.codeeval.com/open_challenges/158/\" rel=\"nofollow\">https://www.codeeval.com/open_challenges/158/</a> it's a bubble sort. I code in GO lang and on my PC it runs fine and fast! I tried utilize code example of go's input and I tried my own piece of code too.</p>\n\n<p>Anyone can help me ? I tried change the code in somehow, but nothing worked.\nThanks in advance.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1467167896, "last_edit_date": 1467167896, "creation_date": 1467166983, "answer_id": 38089304, "question_id": 38088691, "link": "https://stackoverflow.com/questions/38088691/insert-into-mongodb-and-store-the-objectid/38089304#38089304", "title": "Insert into MongoDB and store the ObjectID?", "body": "<p>Create an id with <a href=\"https://godoc.org/labix.org/v2/mgo/bson#NewObjectId\" rel=\"nofollow\">NewObjectId</a>. The bson package ensures that the id is unique.</p>\n\n<pre><code>id := bson.NewObjectId()\n</code></pre>\n\n<p>Set the id in the document before inserting it. Store the field with the name \"_id\".</p>\n\n<pre><code>struct MyDoc {\n   ID bson.ObjectId `bson:\"_id\"`\n   // other fields\n}\n\nd := &amp;MyDoc{ID: bson.NewObjectId(), /* set other fields */ }\n\nif err := c.Insert(d); err != nil {\n    // handle error\n}\n</code></pre>\n\n<p>The inserted document has the identifier <code>id</code>.</p>\n"}], "owner": {"reputation": 105, "user_id": 4201010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UBzJY.jpg?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/4201010/jean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 38089304, "answer_count": 1, "score": 1, "last_activity_date": 1467167896, "creation_date": 1467162445, "question_id": 38088691, "link": "https://stackoverflow.com/questions/38088691/insert-into-mongodb-and-store-the-objectid", "title": "Insert into MongoDB and store the ObjectID?", "body": "<p>So I have a problem, and a few leads on how to fix it. I need help figuring out which one will actually work, and how to execute it.</p>\n\n<p>I'm programming in GoLang and using the <code>mgo</code> package to interact with MongoDB. At a basic level, I need to insert an entry into a collection in Mongo and also have access to that entry's ObjectID.</p>\n\n<p>My first solution would be to search for the entry that matches all the data that I just inserted, but there may be duplicates. I need the EXACT entry.</p>\n\n<p>Second, I would make a field in each entry that's unique, but I don't want useless data in there and I'm also running this concurrently, which can cause problems if I'm trying to make things unique yadda yadda.</p>\n\n<p>Third, there's a <code>NewObjectID()</code> function in <code>mgo</code>, but I don't know how to ensure that it's a Unique ID.</p>\n\n<p>Is there potential in any of these leads or how else can I tackle this?</p>\n"}, {"tags": ["math", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 5, "creation_date": 1467156423, "post_id": 38087868, "comment_id": 63611982, "body": "The the <a href=\"https://godoc.org/math/big\" rel=\"nofollow noreferrer\"><code>math&#47;big</code> package</a> might be what you&#39;re looking for."}, {"owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1467156642, "post_id": 38087868, "comment_id": 63612034, "body": "Well thanks for the suggestion, but I did indeed take a look at that package but I could not find anything to help me with those byte arrays. As I&#39;ve seen,  it&#39;s possible to reach those huge numbers by slowly doing operations with little numbers."}], "answers": [{"comments": [{"owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "edited": false, "score": 0, "creation_date": 1467160938, "post_id": 38088315, "comment_id": 63613135, "body": "Omg you sir are a genius! I got stuck at this problem for quite a while. Thank you very much."}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 4, "last_activity_date": 1467159500, "creation_date": 1467159500, "answer_id": 38088315, "question_id": 38087868, "link": "https://stackoverflow.com/questions/38087868/go-how-to-divide-huge-numbers/38088315#38088315", "title": "Go: how to divide huge numbers?", "body": "<p><a href=\"https://play.golang.org/p/T5R8fB8q60\" rel=\"nofollow\">https://play.golang.org/p/T5R8fB8q60</a></p>\n\n<pre><code>package main\n\nimport (\n    \"math/big\"\n    \"fmt\"\n)\n\nfunc divideByteArrays(A, B []byte) []byte {\n    var AI, BI, R big.Int\n    AI.SetBytes(A)\n    BI.SetBytes(B)\n    R.Div(&amp;AI, &amp;BI)\n    return R.Bytes()\n}\n\nfunc main() {\n    a_array := make([]byte, 64)\n    b_array := make([]byte, 64)\n\n    for i := 0; i &lt; 64; i++ {\n        a_array[i] = 4\n        b_array[i] = 2\n    }\n\n    fmt.Println(divideByteArrays(a_array, b_array))\n}\n</code></pre>\n"}], "owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 38088315, "answer_count": 1, "score": 0, "last_activity_date": 1467159500, "creation_date": 1467156373, "last_edit_date": 1467157069, "question_id": 38087868, "link": "https://stackoverflow.com/questions/38087868/go-how-to-divide-huge-numbers", "title": "Go: how to divide huge numbers?", "body": "<p>I'm new in Golang and my problem is:</p>\n\n<p>I have two byte arrays of 64 elements each, let's name them \"A\" and \"B\". Each of those arrays represent an unsigned integer.</p>\n\n<p>I wish to produce another 64-bytes array \"R\" representing the result of (A / B).</p>\n\n<p>Any ideas?</p>\n\n<pre><code>// pre-condition: A and B have 64 bytes each\n// A and B each represent an unsigned integer\n// R = (A / B)\n\nfunc divideByteArrays(A, B []byte) []byte {\n    R := make([]byte, 64)\n    // ... do something ...\n    return R\n}\n</code></pre>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:</p>\n\n<p>is it possible to use \"math/big\" to achieve that goal ?</p>\n"}, {"tags": ["git", "go", "build", "version"], "comments": [{"owner": {"reputation": 752, "user_id": 7496656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMGuk.jpg?s=128&g=1", "display_name": "Jan Zerebecki", "link": "https://stackoverflow.com/users/7496656/jan-zerebecki"}, "edited": false, "score": 0, "creation_date": 1500390478, "post_id": 38087256, "comment_id": 77309389, "body": "Not according to the documentation. However you can use the <a href=\"https://git-scm.com/docs/gitattributes#__code_ident_code\" rel=\"nofollow noreferrer\">ident git attribute</a> to at least add the git hash of a file into the file."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1566481143, "post_id": 38087256, "comment_id": 101676643, "body": "With Go 1.13: <code>go version -- myExecutable</code> will print dependencies version information."}], "answers": [{"tags": [], "owner": {"reputation": 318, "user_id": 4571878, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VBABu.jpg?s=128&g=1", "display_name": "Grigorii Sokolik", "link": "https://stackoverflow.com/users/4571878/grigorii-sokolik"}, "is_accepted": false, "score": -2, "last_activity_date": 1505317623, "creation_date": 1505317623, "answer_id": 46201833, "question_id": 38087256, "link": "https://stackoverflow.com/questions/38087256/dynamic-version-from-git-with-go-get/46201833#46201833", "title": "Dynamic version from git with go get", "body": "<p>Is the following that you want?</p>\n\n<pre><code>VERSION=`git describe --always --dirty`; \\\n    CGO_ENABLED=0 GOOS=linux \\\n    go build -a \\\n        -ldflags=\"-X main.version=$(VERSION)\" \\\n        -installsuffix cgo -o github_pki main.go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 7, "last_activity_date": 1566481109, "last_edit_date": 1566481109, "creation_date": 1547894148, "answer_id": 54266186, "question_id": 38087256, "link": "https://stackoverflow.com/questions/38087256/dynamic-version-from-git-with-go-get/54266186#54266186", "title": "Dynamic version from git with go get", "body": "<p>From <a href=\"https://github.com/golang/go/issues/22147#issuecomment-455684492\" rel=\"noreferrer\">issue 22147 <code>cmd/go</code>: Make it easier to embed compiled git SHA into binary </a>, you now have (with Go 1.12+, Q1 2019, 2+ years later) an alternative for the dependencies (not yet for your main program).</p>\n\n<p>So you still need <code>-ldflags</code> to record the version of your sources.<br>\nBut not to record the version of your dependencies: that is now available.</p>\n\n<blockquote>\n  <p>As of Go 1.12, you can get the versions of all modules compiled into the binary (in module mode) using <a href=\"https://tip.golang.org/pkg/runtime/debug/#BuildInfo\" rel=\"noreferrer\"><code>runtime/debug.BuildInfo</code></a>.</p>\n  \n  <p>If the version in use is a pseudo-version, it also includes the first dozen or so characters of the VCS commit ID.</p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// BuildInfo represents the build information read from the running binary.\n\ntype BuildInfo struct {\n    Path string    // The main package path\n    Main Module    // The main module information\n    Deps []*Module // Module dependencies\n}\n\n// ReadBuildInfo returns the build information embedded in the running binary. \n   The information is available only in binaries built with module support. \n\nfunc ReadBuildInfo() (info *BuildInfo, ok bool)\n</code></pre>\n\n<p>This comes from <a href=\"https://github.com/golang/go/commit/45e9c5538b3956d98ef0337fc19ed8d45eb17090\" rel=\"noreferrer\">commit 45e9c55</a>:</p>\n\n<blockquote>\n  <h2>runtime/debug: add API to read module info in binary</h2>\n  \n  <p>When module is enabled, the go tool embeds build information related to the module in the binary including the dependencies and the replace information (See\n  <a href=\"https://github.com/golang/go/blob/5538a9a34fc4e395967c0233aab5bdde0cebbf9b/src/cmd/go/internal/modload/build.go#L186\" rel=\"noreferrer\"><code>src/cmd/go/internal/modload#PackageBuildInfo()</code></a>, from <a href=\"https://github.com/golang/go/commit/f7248f05946c1804b5519d0b3eb0db054dc9c5d6\" rel=\"noreferrer\">commit f7248f0</a>).</p>\n  \n  <p>The newly introduced <code>ReadBuildInfo</code> reads the information and makes it accessible programmatically.</p>\n</blockquote>\n\n<p>You can see it used in <a href=\"https://github.com/golang/go/issues/26404\" rel=\"noreferrer\">issue 26404: \"cmd/go: export module information for binaries programmatically\"</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"log\"\n    \"runtime/debug\"\n\n    \"github.com/kr/pretty\"\n)\n\nfunc main() {\n    bi, ok := debug.ReadBuildInfo()\n    if !ok {\n        log.Fatal(\"!ok\")\n    }\n    pretty.Println(bi)\n}\n</code></pre>\n\n<p>You get:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>&amp;debug.BuildInfo{\n    Path: \"foo.to/v\",\n    Main: debug.Module{\n        Path:    \"foo.to/v\",\n        Version: \"(devel)\",\n        Sum:     \"\",\n        Replace: (*debug.Module)(nil),\n    },\n    Deps: {\n        &amp;debug.Module{\n            Path:    \"github.com/kr/pretty\",\n            Version: \"v0.1.0\",\n            Sum:     \"h1:L/CwN0zerZDmRFUapSPitk6f+Q3+0za1rQkzVuMiMFI=\",\n            Replace: (*debug.Module)(nil),\n        },\n        &amp;debug.Module{\n            Path:    \"github.com/kr/text\",\n            Version: \"v0.1.0\",\n            Sum:     \"h1:45sCR5RtlFHMR4UwH9sdQ5TC8v0qDQCHnXt+kaKSTVE=\",\n            Replace: (*debug.Module)(nil),\n        },\n    },\n}\n</code></pre>\n\n<blockquote>\n  <p>If you build the binary in module mode from outside of a module using 1.12 (<a href=\"https://github.com/golang/go/issues/24250\" rel=\"noreferrer\">#24250</a>), then you'll pick up all of its version information.</p>\n  \n  <p>but the reported version of the binary is always <strong><code>(devel)</code></strong> at the moment. Even if it is committed and tagged</p>\n</blockquote>\n\n<p>So the main issue remains: <a href=\"https://github.com/golang/go/issues/29814\" rel=\"noreferrer\">issues/29814 \"<code>cmd/go</code>: use version control to discover the main module's version? \"</a>.</p>\n\n<blockquote>\n  <p>When a binary is build from within a module's source tree, the output from <code>runtime/debug.ReadBuildInfo</code> currently reports that module as having version <strong><code>(devel)</code></strong>.</p>\n  \n  <p>If the source tree is a pristine checkout from a version-control system \u2014 or is within the (read-only) module cache \u2014 we could instead interrogate the version-control system to find the corresponding version or pseudo-version to embed.</p>\n  \n  <p>However, that has a couple of caveats:</p>\n  \n  <ol>\n  <li>It would require us to run VCS commands within the user's source tree. Historically, running VCS commands has been a source of entirely too many go command vulnerabilities, so we would really like to avoid issuing VCS commands except when they are absolutely necessary.</li>\n  <li>Given a commit, we can produce a pseudo-version for that commit, but we can't tell whether that commit has been published to the origin.<br>\n  It would be nice to preserve the invariant that only published versions are advertised in debug info, but that may incur an extra network fetch.</li>\n  <li>Within a module, we apply that module's replacements and exclusions, and the user's VCS checkout may also have applied some transformations.<br>\n  <code>(devel)</code> currently provides a clue that those module-specific changes are in effect: if we were to indicate an explicit version instead, we would need to provide some way to indicate that replacements and exclusions were applied.</li>\n  </ol>\n</blockquote>\n\n<hr>\n\n<p><a href=\"https://tip.golang.org/doc/go1.13#go-version-exe\" rel=\"noreferrer\">Go 1.13</a> (Q3 2019) includes:</p>\n\n<blockquote>\n  <p>The <a href=\"https://tip.golang.org/cmd/go/#hdr-Print_Go_version\" rel=\"noreferrer\"><code>go version</code></a> command now accepts arguments naming executable and directories.  </p>\n  \n  <ul>\n  <li>When invoked on an executable, <code>go version</code> prints the version of Go used to build the executable.  </li>\n  <li><strong>If the <code>-m</code> flag is used, <code>go version</code> prints the executable's embedded module version information, if available.</strong> (<a href=\"https://golang.org/pkg/runtime/debug/#BuildInfo\" rel=\"noreferrer\"><code>runtime/debug#BuildInfo</code></a>)    </li>\n  <li>When invoked on a directory, <code>go version</code> prints information about executable contained in the directory and its subdirectories.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 3465, "user_id": 232250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/df589218079514d46c56905ca8c6aa0b?s=128&d=identicon&r=PG", "display_name": "\u211daphink", "link": "https://stackoverflow.com/users/232250/%e2%84%9daphink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1702, "favorite_count": 2, "answer_count": 2, "score": 11, "last_activity_date": 1566481109, "creation_date": 1467152588, "question_id": 38087256, "link": "https://stackoverflow.com/questions/38087256/dynamic-version-from-git-with-go-get", "title": "Dynamic version from git with go get", "body": "<p>I'm using git tags to inject versions in my go programs, e.g. in a <code>Makefile</code>:</p>\n\n<pre><code>VERSION = $(shell git describe --always --dirty)\n\ngithub_pki: main.go\n    CGO_ENABLED=0 GOOS=linux \\\n      go build -a \\\n          -ldflags=\"-X main.version=$(VERSION)\" \\\n        -installsuffix cgo -o $@ $&lt;\n</code></pre>\n\n<p>Where <code>version</code> is defined in <code>main.go</code> as:</p>\n\n<pre><code>var version = \"undefined\"\n</code></pre>\n\n<p>This works great using <code>make</code>, but not when using <code>go get</code> or <code>go build</code>. Is there a way to make this <code>ldflags</code> work without using an external build system (i.e. with <code>go build</code>/<code>go get</code>)?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1467185840, "creation_date": 1467185840, "answer_id": 38093195, "question_id": 38086702, "link": "https://stackoverflow.com/questions/38086702/belongs-to-association-golang-gorm-not-being-found-with-explicit-foreignkey/38093195#38093195", "title": "Belongs To Association Golang Gorm not being found with explicit ForeignKey", "body": "<p>Define your <code>Trade</code> struct like this</p>\n\n<pre><code>type Trade struct {\n    ID              uint\n    BuyExecution    Execution `gorm:\"ForeignKey:BuyExecutionID\"`\n    BuyExecutionID  int\n    SellExecution   Execution `gorm:\"ForeignKey:SellExecutionID\"`\n    SellExecutionID int\n    Px              int\n    Shares          int\n}\n</code></pre>\n\n<p>Or even</p>\n\n<pre><code>type Trade struct {\n    ID              uint\n    BuyExecution    Execution\n    BuyExecutionID  int\n    SellExecution   Execution\n    SellExecutionID int\n    Px              int\n    Shares          int\n}\n</code></pre>\n"}], "owner": {"reputation": 3554, "user_id": 3233810, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1135890448/picture?type=large", "display_name": "daino3", "link": "https://stackoverflow.com/users/3233810/daino3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1322, "favorite_count": 0, "accepted_answer_id": 38093195, "answer_count": 1, "score": 0, "last_activity_date": 1467185840, "creation_date": 1467149710, "question_id": 38086702, "link": "https://stackoverflow.com/questions/38086702/belongs-to-association-golang-gorm-not-being-found-with-explicit-foreignkey", "title": "Belongs To Association Golang Gorm not being found with explicit ForeignKey", "body": "<p>I have a Trade struct like so:</p>\n\n<pre><code>type Trade struct {\n    ID            uint\n    BuyExecution  Execution `gorm:\"ForeignKey:BuyExecution\"`\n    SellExecution Execution `gorm:\"ForeignKey:SellExecution\"`\n    Px            int\n    Shares        int\n}\n</code></pre>\n\n<p>And an execution struct like so:</p>\n\n<pre><code>type Execution struct {\n    ID                uint\n    Side              string\n    Symbol            string\n    Trade             *Trade\n}\n</code></pre>\n\n<p>Schema:</p>\n\n<pre><code>CREATE TABLE `executions` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `side` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `symbol` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `trade_id` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,\n  PRIMARY KEY (`id`),\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;\n\n\n\nCREATE TABLE `trades` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `buy_execution_id` int(11) NOT NULL,\n  `sell_execution_id` int(11) NOT NULL,\n  `px` int(11) NOT NULL,\n  `shares` int(11) NOT NULL,\n  `trade_id` varchar(255) COLLATE utf8_unicode_ci NOT NULL,\n  PRIMARY KEY (`id`),\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;\n</code></pre>\n\n<p>However, when creating executions and then the trade from yaml fixtures with the appropriate relationships, I'm getting an error:</p>\n\n<pre><code>[2016-06-28 21:17:50]  sql: converting Exec argument #0's type: unsupported type models.Execution, a struct \n</code></pre>\n\n<p>Which points to the <code>Preload</code> call I make here:</p>\n\n<pre><code>var trade Trade\ndb.Preload(\"BuyExecution\").First(&amp;trade)\n</code></pre>\n\n<p>Debugging this has been difficult so trying to get some help on it.         </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "is_accepted": true, "score": 1, "last_activity_date": 1467149219, "creation_date": 1467149219, "answer_id": 38086595, "question_id": 38086377, "link": "https://stackoverflow.com/questions/38086377/golang-routing-in-different-controllers/38086595#38086595", "title": "Golang routing in different controllers", "body": "<p>I suppose you run the <code>tim.go</code> file to start the server.</p>\n\n<p>If so, the problem is you don't have the route you're calling <code>/new</code>, you should have an answer with <code>/home</code>.</p>\n\n<p>To do it, you should move your <code>HomeHandler</code> function to <code>Controllers</code> package and then import this package in your main ad instantiate the routes you need.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1490, "favorite_count": 0, "accepted_answer_id": 38086595, "answer_count": 1, "score": 0, "last_activity_date": 1467149219, "creation_date": 1467148307, "question_id": 38086377, "link": "https://stackoverflow.com/questions/38086377/golang-routing-in-different-controllers", "title": "Golang routing in different controllers", "body": "<p>I am new to Golang and I am trying to learn how to do efficient routing. For instance I have a controller folder/directory and inside that controller I want to have different Func/methods with their own unique routes but I do not know how to do that. I have downloaded the <strong>github.com/gorilla/mux</strong> package and my application looks like this\n<a href=\"https://i.stack.imgur.com/KslfK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KslfK.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The main section of my application looks like this and it is working perfectly: <strong><em>tim.go</em></strong></p>\n\n<pre><code>package main\n\nimport(\n    \"net/http\"\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n)\n\n\nfunc HomeHandler(writer http.ResponseWriter, req *http.Request) {\n    writer.WriteHeader(200)\n    fmt.Fprintf(writer, \"Home!!!\\n\")\n}\nfunc main() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/home\", HomeHandler).Name(\"bob\")\n         http.Handle(\"/\",r)\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>The issue is how can I get the func/methods inside my Controller file(s) to also display on the browser. My <strong>sample.go</strong> file does not show in the browser when I go to that URL</p>\n\n<pre><code>package Controllers\n\n\n\nimport(\n    \"net/http\"\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n)\n\n\nfunc HomeHandler(writer http.ResponseWriter, req *http.Request) {\n    writer.WriteHeader(200)\n    fmt.Fprintf(writer, \"New Home\")\n}\nfunc main() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/new\", HomeHandler).Name(\"bob\")\n    http.Handle(\"/\",r)\n    http.ListenAndServe(\":8000/new\", nil)\n}\n</code></pre>\n\n<p>When I go into my browser and type <strong>localhost:8000/new</strong> it says file not found. Any suggestions would be great</p>\n"}, {"tags": ["select", "go", "client", "chat"], "answers": [{"comments": [{"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1467147602, "post_id": 38085581, "comment_id": 63608732, "body": "You put the goroutines outside of the for loop. Does this mean that the goroutines don&#39;t close? And the channel continuously gets filled as if it was a for loop? When I wrote this out, the client works only  if I put the goroutines in the for loop."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 1, "creation_date": 1467148241, "post_id": 38085581, "comment_id": 63608993, "body": "Well, there&#39;s no need to recreate the goroutines on each loop iteration, as that would also involve recreating the readers, and you&#39;d leave a lot of orphaned routines behind.  Note that the goroutines shown have a for loop within them, so they loop endlessly, filling the channel as the Reader reads.  If you want to close them, the optimal way is to use a quit channel that all 3 (the two goroutines and the main routine) listen to, and abort their for loops (generally via <code>return</code>) when that quit channel is closed.  Example: <a href=\"https://play.golang.org/p/vxK6kU21Ya\" rel=\"nofollow noreferrer\">play.golang.org/p/vxK6kU21Ya</a>"}, {"owner": {"reputation": 1362, "user_id": 18703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/45b0ee94acfbcc06f333f2daf03d4c91?s=128&d=identicon&r=PG", "display_name": "Hace", "link": "https://stackoverflow.com/users/18703/hace"}, "edited": false, "score": 0, "creation_date": 1585750696, "post_id": 38085581, "comment_id": 107872586, "body": "Thanks @Kaedys a very nice example of how to work around and use channels for blocking routines."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 7, "last_activity_date": 1618231746, "last_edit_date": 1618231746, "creation_date": 1467145225, "answer_id": 38085581, "question_id": 38085356, "link": "https://stackoverflow.com/questions/38085356/golang-use-two-reader-returned-lines-for-select-statement/38085581#38085581", "title": "Golang - use two Reader returned lines for select statement", "body": "<p>You need to run them in goroutines or they can't simultaneously occur:</p>\n<pre><code>conn, _ := net.Dial(&quot;tcp&quot;, &quot;localhost:8998&quot;)\n\n// Make outgoing reader routine\noutgoing := make(chan string)\ngo func() {\n    inputReader := bufio.NewReader(os.Stdin)\n    for {\n        o, err := inputReader.ReadString('\\n')\n        if err != nil {\n            fmt.Printf(&quot;outgoing error: %v&quot;, err)\n            return\n        }\n        outgoing &lt;- o\n    }\n}()\n\n// Make incoming reader routine\nincoming := make(chan string)\ngo func() {\n    connReader := bufio.NewReader(conn)\n    for {\n        i, err := connReader.ReadString('\\n')\n        if err != nil {\n            fmt.Printf(&quot;incoming error: %v&quot;, err)\n            return\n        }\n        incoming &lt;- i\n    }\n}()\n\nfor {\n    select {\n    case out := &lt;-outgoing:\n        fmt.Print(&quot;&gt; &quot;)\n        fmt.Fprintf(conn, out+&quot;\\n&quot;)\n    case in := &lt;-incoming:\n        fmt.Print(in)\n    }\n}\n</code></pre>\n<h2>Edit</h2>\n<p>To further elaborate: your first example won't work because <code>select</code> requires each case to be either a channel read or channel send operation, and the function call <code>bufio.Reader.ReadString()</code> is neither.</p>\n<p>Your second example won't work because the line <code>outgoing &lt;- o</code> will block indefinitely.  It is trying to send <code>o</code> over the channel <code>outgoing</code>, but <code>outgoing</code> is not buffered, and nothing is listening on it.  Furthermore, since neither <code>ReadString()</code> call will return until a line is read, your <code>for</code> loop will only proceed once a line is read from <em>BOTH</em> readers in turn (and will then block on the channel send).</p>\n<p>That's why you need each Reader to have its own goroutine, so each can independently read off its Reader as input allows, and store it to the relevant channel as lines are read, and your <code>select</code> statement can then react to each line as it comes in from the individual goroutines.</p>\n"}], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4330, "favorite_count": 2, "accepted_answer_id": 38085581, "answer_count": 1, "score": 3, "last_activity_date": 1618231746, "creation_date": 1467144426, "last_edit_date": 1467150418, "question_id": 38085356, "link": "https://stackoverflow.com/questions/38085356/golang-use-two-reader-returned-lines-for-select-statement", "title": "Golang - use two Reader returned lines for select statement", "body": "<p>For a simple golang chat/telnet client, I want to pass strings received from two bufio Readers to a select statement, so I can either send the user input to the server, or print the server sent data.</p>\n\n<pre><code>conn, _ := net.Dial(\"tcp\", \"localhost:8998\")\nfor {\n    select{\n    case line, _ := bufio.NewReader(os.Stdin).ReadString('\\n'):\n        fmt.Print(\"&gt; \")\n        fmt.Fprintf(conn, line + \"\\n\")\n    case data, _ := bufio.NewReader(conn).ReadString('\\n'):\n        fmt.Print(data)\n    }\n}\n</code></pre>\n\n<p>The compiler gives me back this error</p>\n\n<pre><code>select case must be receive, send or assign recv\n</code></pre>\n\n<p>I suspect I should be using channels. But </p>\n\n<pre><code>conn, _ := net.Dial(\"tcp\", \"localhost:8998\")\noutgoing := make(chan string)\nincoming := make(chan string)\nfor {\n    inputReader := bufio.NewReader(os.Stdin)\n    connReader := bufio.NewReader(conn)\n\n    o, _ := inputReader.ReadString('\\n')\n    i, _ := connReader.ReadString('\\n')\n    outgoing &lt;- o\n    incoming &lt;- i\n\n    select{\n    case out := &lt;-outgoing:\n        fmt.Print(\"&gt; \")\n        fmt.Fprintf(conn, out + \"\\n\")\n    case in := &lt;-incoming:\n        fmt.Print(in)\n    }\n}\n</code></pre>\n\n<p>But the code doesn't accept or receive data. Finally, I suspect I should be using two go routines to check for the Reader return value? </p>\n"}, {"tags": ["function", "templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 4740600, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2bcd0926efa9791249665e98f7162d28?s=128&d=identicon&r=PG&f=1", "display_name": "user4740600", "link": "https://stackoverflow.com/users/4740600/user4740600"}, "is_accepted": false, "score": 2, "last_activity_date": 1467139862, "creation_date": 1467139862, "answer_id": 38084094, "question_id": 38083810, "link": "https://stackoverflow.com/questions/38083810/use-function-return-in-if-statement-or-variable-in-go-template/38084094#38084094", "title": "Use function return in if statement or variable in go template", "body": "<p>If anyone ever needs it, </p>\n\n<pre><code>{{if $service | regexMatch \"^[-a-z0-9]{1,}$\"}} \n</code></pre>\n\n<p>from <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow\">https://golang.org/pkg/text/template/</a>.</p>\n\n<p>specifically:</p>\n\n<p>{{pipeline}}\n    The default textual representation of the value of the pipeline\n    is copied to the output.</p>\n\n<p>{{if pipeline}} T1 {{end}}\n    If the value of the pipeline is empty, no output is generated;\n    otherwise, T1 is executed.  The empty values are false, 0, any\n    nil pointer or interface value, and any array, slice, map, or\n    string of length zero.\n    Dot is unaffected.</p>\n"}], "owner": {"reputation": 57, "user_id": 4740600, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2bcd0926efa9791249665e98f7162d28?s=128&d=identicon&r=PG&f=1", "display_name": "user4740600", "link": "https://stackoverflow.com/users/4740600/user4740600"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467139862, "creation_date": 1467138974, "question_id": 38083810, "link": "https://stackoverflow.com/questions/38083810/use-function-return-in-if-statement-or-variable-in-go-template", "title": "Use function return in if statement or variable in go template", "body": "<p>I'm using a go template to filter out improperly named services with consul-template. I am provided a function regexMatch from consul-template that works like this:</p>\n\n<pre><code>{{\"foo.bar\" | regexMatch \"foo([.a-z]+)\"}}\n</code></pre>\n\n<p>It returns true or false depending on the string. I'd like to use this conditionally in an if statement, similar to other code I have that filters out services with the name \"consul\". That works like this:</p>\n\n<pre><code>{{range services}} {{$service:=.Name}} {{if not (eq $service \"consul\")}}\n</code></pre>\n\n<p>The problem is that I can't nest the function call inside that if statement or a variable declaration. I have tried </p>\n\n<pre><code>{{if {$service | regexMatch \"^[-a-z0-9]{1,}$\"}}}}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>{{$syntax= {$service | regexMatch \"^[-a-z0-9]{1,}$\"}}}}\n</code></pre>\n\n<p>but I get these errors:</p>\n\n<pre><code>unexpected \"{\" in if\nunexpected bad character U+003D '='\n</code></pre>\n\n<p>How can I use the regexMatch function in an if statement in this go template?</p>\n"}, {"tags": ["string", "go", "boxing", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467135858, "post_id": 38082838, "comment_id": 63602208, "body": "You can&#39;t directly take the address of the string data. Why not just keep the data in a <code>[]byte</code> which is addressable?"}, {"owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467135993, "post_id": 38082838, "comment_id": 63602295, "body": "@JimB can I pass an address of <code>bytearray[0]</code> to C code? What if Go decided to garbage-collect the <code>[]bytearray</code> while my C code is still executing?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467136140, "post_id": 38082838, "comment_id": 63602361, "body": "It&#39;s up to you to keep the value alive while the call is executing, and the same thing would apply even if it was a string. The C code isn&#39;t allowed to keep a copy of the pointer after the call returns, so keeping the value in scope is usually trivial."}, {"owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467136336, "post_id": 38082838, "comment_id": 63602457, "body": "@JimB as I understand, it is enough to keep a reference to <code>[]byte</code> in scope of calling my C code to prevent it to be GC&#39;d?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467136490, "post_id": 38082838, "comment_id": 63602548, "body": "yes, that is correct, and again, the same would apply for a string. <code>[]byte</code> isn&#39;t collected and differently from <code>string</code>"}, {"owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467137387, "post_id": 38082838, "comment_id": 63603074, "body": "@JimB Ok, but string -&gt; []byte conversion implies the copying I wanted to avoid. So I should change my interfaces for working with []byte as more general-purpose."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467138039, "post_id": 38082838, "comment_id": 63603415, "body": "yes, if you want to avoid copying. If the strings are relatively small, the cgo call is going to dominate the time far more than copying."}, {"owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467138260, "post_id": 38082838, "comment_id": 63603538, "body": "@JimB do you mean go -&gt; C call is heavier than C -&gt; C_library code? Why?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467138702, "post_id": 38082838, "comment_id": 63603822, "body": "Go isn&#39;t C, and they have different calling conventions. Saving the Go stack and switching to the C stack takes more time than calling a function directly."}], "owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467135862, "creation_date": 1467135495, "last_edit_date": 1467135862, "question_id": 38082838, "link": "https://stackoverflow.com/questions/38082838/cgo-pointer-to-go-stringss-contents", "title": "cgo: pointer to go strings&#39;s contents", "body": "<p>I need to pass Go string to C code, but I don't want to copy the string by using the <code>func C.CString(string) *C.char</code> My C code doesn't change the string, so I wanted to avoid useless copying for my read-only code and save some CPU cycles.</p>\n\n<p>P.S.:\nIt seems my idea is dangerous: <a href=\"https://groups.google.com/d/msg/golang-nuts/iWGS09kWKbQ/Wx8cB7WyOSQJ\" rel=\"nofollow\">https://groups.google.com/d/msg/golang-nuts/iWGS09kWKbQ/Wx8cB7WyOSQJ</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1467133143, "post_id": 38081807, "comment_id": 63600644, "body": "For reference, <i>all</i> questions like this can be answered in the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">language spec</a>.  For example, you don&#39;t even need to scroll or search to find the spec for this, I clicked through <code>For statement</code>-&gt;<code>ForClause</code>-&gt;<code>SimpleStmt</code>-&gt;<code>Assignment</code>"}, {"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1467134103, "post_id": 38081807, "comment_id": 63601211, "body": "Raising the bar for asking qualified questions is great. The upvotes to the answers also show the quality of this very question."}, {"owner": {"reputation": 920, "user_id": 6890234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-aKC2DR_lnUc/AAAAAAAAAAI/AAAAAAAAABE/2KLbaG2ZxVU/photo.jpg?sz=128", "display_name": "Nikhil Wagh", "link": "https://stackoverflow.com/users/6890234/nikhil-wagh"}, "edited": false, "score": 3, "creation_date": 1514655422, "post_id": 38081807, "comment_id": 83042622, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27802873/multiple-variables-in-for-loop-in-go\">Multiple variables in for loop in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 908, "user_id": 8084731, "user_type": "registered", "profile_image": "https://graph.facebook.com/1653815704646436/picture?type=large", "display_name": "princebillyGK", "link": "https://stackoverflow.com/users/8084731/princebillygk"}, "edited": false, "score": 0, "creation_date": 1608950093, "post_id": 38081920, "comment_id": 115718298, "body": "So we can&#39;t use something like this i++ or  i*=2 in this case?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 908, "user_id": 8084731, "user_type": "registered", "profile_image": "https://graph.facebook.com/1653815704646436/picture?type=large", "display_name": "princebillyGK", "link": "https://stackoverflow.com/users/8084731/princebillygk"}, "edited": false, "score": 1, "creation_date": 1609017368, "post_id": 38081920, "comment_id": 115731911, "body": "@princebillyGK Correct. If you&#39;re trying to update two variables you&#39;re stuck with <code>i, j = expr1, expr2</code>, and increments and <code>*=</code> are statements not expressions."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 139, "last_activity_date": 1467132322, "creation_date": 1467132322, "answer_id": 38081920, "question_id": 38081807, "link": "https://stackoverflow.com/questions/38081807/for-loop-of-two-variables-in-go/38081920#38081920", "title": "For loop of two variables in Go", "body": "<p>You don't have a comma operator to join multiple statements, but you do have multiple assignment, so <a href=\"https://play.golang.org/p/FRk4cccaQN\">this works</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    for i, j := 0, 1; i &lt; 10; i, j = i+1, j+1 {\n        fmt.Println(\"Hello, playground\")\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 404, "user_id": 6692196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vV1ew.png?s=128&g=1", "display_name": "Gene S", "link": "https://stackoverflow.com/users/6692196/gene-s"}, "edited": false, "score": 0, "creation_date": 1546111731, "post_id": 53388887, "comment_id": 94782959, "body": "<code>i,j := 0</code> is wrong: <a href=\"https://play.golang.org/p/-mAV-unCOp4\" rel=\"nofollow noreferrer\">play.golang.org/p/-mAV-unCOp4</a> <code>assignment mismatch: 2 variables but 1 values</code>"}, {"owner": {"reputation": 1858, "user_id": 1644457, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/91e199a53c0fa95ebc6a9376d147ddc4?s=128&d=identicon&r=PG", "display_name": "Abdul Rehman", "link": "https://stackoverflow.com/users/1644457/abdul-rehman"}, "reply_to_user": {"reputation": 404, "user_id": 6692196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vV1ew.png?s=128&g=1", "display_name": "Gene S", "link": "https://stackoverflow.com/users/6692196/gene-s"}, "edited": false, "score": 0, "creation_date": 1546118495, "post_id": 53388887, "comment_id": 94784510, "body": "its like this for i,j := 0,1;  please copy and paste code in playland. you missed second value which is 1 after comma."}, {"owner": {"reputation": 404, "user_id": 6692196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vV1ew.png?s=128&g=1", "display_name": "Gene S", "link": "https://stackoverflow.com/users/6692196/gene-s"}, "edited": false, "score": 0, "creation_date": 1546188657, "post_id": 53388887, "comment_id": 94796426, "body": "No, you missed the second value in your answer:  &quot;but we use short hand in for loop so we can do this for initializing them with same value    i,j := 0&quot;"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1552332346, "post_id": 53388887, "comment_id": 96960896, "body": "(I changed the example in the post to match @AbdulRehman&#39;s comment because that fixes the syntax error and the comment suggests that was what the example was intended to be.)"}], "tags": [], "owner": {"reputation": 1858, "user_id": 1644457, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/91e199a53c0fa95ebc6a9376d147ddc4?s=128&d=identicon&r=PG", "display_name": "Abdul Rehman", "link": "https://stackoverflow.com/users/1644457/abdul-rehman"}, "is_accepted": false, "score": 15, "last_activity_date": 1552325575, "last_edit_date": 1552325575, "creation_date": 1542702374, "answer_id": 53388887, "question_id": 38081807, "link": "https://stackoverflow.com/questions/38081807/for-loop-of-two-variables-in-go/53388887#53388887", "title": "For loop of two variables in Go", "body": "<p>Although above Answer is accepted, and it fully satisfy the need. But I would like to contribute some further explanation to it. </p>\n\n<p>Golang Does not support many things which could be done in simple terms. For loop is a most common example of this. The beauty of Go's For loop is that it merges many modern style of looping into one keyword. </p>\n\n<p>Similarly Golang do with Multiple Variable declaration and assignment. According to above mentioned problem, We could solve multi-variable for loop with this simple tool which Golang provides us. If you want to look into further explanation, this question provide further details and way of <a href=\"https://stackoverflow.com/questions/21071507/can-you-declare-multiple-variables-at-once-in-go\">declaring multiple variables in one statement</a>.   </p>\n\n<p>Coming back to for loop, If we want to declare variable of same datatype we can declare them with this</p>\n\n<pre><code>var a,b,c string\n</code></pre>\n\n<p>but we use short hand in for loop so we can do this for initializing them with same value</p>\n\n<pre><code>  i,j := 0,1\n</code></pre>\n\n<p><strong>Different Datatypes and Different Values</strong></p>\n\n<p>and if we want to declare different type of variables and want to assign different values we can do this by separating variables names and after := different values by comma as well. for example</p>\n\n<pre><code> c,i,f,b := 'c',23423,21.3,false\n</code></pre>\n\n<p><strong>Usage of Assignment Operator</strong></p>\n\n<p>Later on, we can assign values to multiple variables with the same approach. </p>\n\n<pre><code>    x,y := 10.3, 2\n    x,y = x+10, y+1\n</code></pre>\n\n<p><strong>Mixing Struct and Normal types in single statement</strong></p>\n\n<p>Even we can use struct types or pointers the same way. Here is a function to iterate Linked list which is defined as a struct </p>\n\n<pre><code>func (this *MyLinkedList) Get(index int) int {\n    for i,list := 0,this; list != nil; i,list = i+1,list.Next{\n        if(i==index){\n            return list.Val\n        }\n    }\n    return -1\n}\n</code></pre>\n\n<p>This list is defined as </p>\n\n<pre><code>type MyLinkedList struct {\n      Val int\n      Next *MyLinkedList\n\n }\n</code></pre>\n\n<p><strong>Answering to Original Problem</strong></p>\n\n<p>Coming to the origin Question, Simply it could be done </p>\n\n<pre><code>for i, j := 0, 1; i &lt; 10; i, j = i+1, j+1 {\n        fmt.Println(\"i,j\",i,j)\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "is_accepted": false, "score": -1, "last_activity_date": 1572439345, "creation_date": 1572439345, "answer_id": 58625643, "question_id": 38081807, "link": "https://stackoverflow.com/questions/38081807/for-loop-of-two-variables-in-go/58625643#58625643", "title": "For loop of two variables in Go", "body": "<p>As pointed by Mr. Abdul, for iterate among two variable you can use the following construct:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var step int = 4\nfor row := 0; row &lt; rowMax; row++ {\n        for col := 0; col &lt; colMax; col++ {\n            for rIndex, cIndex := row, col; rIndex &lt;= row+step &amp;&amp; cIndex &lt;= col; rIndex, cIndex = rIndex+1, cIndex+1 {\n            }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36608, "favorite_count": 8, "accepted_answer_id": 38081920, "answer_count": 3, "score": 69, "last_activity_date": 1572439345, "creation_date": 1467131959, "question_id": 38081807, "link": "https://stackoverflow.com/questions/38081807/for-loop-of-two-variables-in-go", "title": "For loop of two variables in Go", "body": "<p>The following for loop in Go isn't allowed,</p>\n\n<pre><code>for i := 0, j := 1; i &lt; 10; i++, j++ {...}\n</code></pre>\n\n<p>What's the correct equivalent of the for-loop of two variables below?</p>\n\n<pre><code>for (int i = 0, j = 1; i &lt; 10; i ++ , j ++) {...} \n</code></pre>\n"}, {"tags": ["windows", "debugging", "go", "visual-studio-code"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4710450"}, "edited": false, "score": 2, "creation_date": 1467128587, "post_id": 38080105, "comment_id": 63597806, "body": "What does the compiler(debugger) complain about?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1467137490, "post_id": 38080105, "comment_id": 63603123, "body": "We need to know what step in that guide failed and how, or any steps you couldn&#39;t do. Right now you&#39;re asking us to write another tutorial, and if we did that it still might not work for you."}, {"owner": {"reputation": 67, "user_id": 5482710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143b817f35ef65e9028619fcfad50ba9?s=128&d=identicon&r=PG&f=1", "display_name": "A-kay", "link": "https://stackoverflow.com/users/5482710/a-kay"}, "edited": false, "score": 0, "creation_date": 1467296094, "post_id": 38080105, "comment_id": 63682557, "body": "this is what i get when i start debugger : can&#39;t load package: package .: no buildable Go source files in c:\\dev\\go exit status 1"}, {"owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "edited": false, "score": 0, "creation_date": 1519984635, "post_id": 38080105, "comment_id": 85138466, "body": "Very similar to this. <a href=\"https://ethereum.stackexchange.com/a/41135/7044\">ethereum.stackexchange.com/a/41135/7044</a>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5482710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143b817f35ef65e9028619fcfad50ba9?s=128&d=identicon&r=PG&f=1", "display_name": "A-kay", "link": "https://stackoverflow.com/users/5482710/a-kay"}, "edited": false, "score": 0, "creation_date": 1467295829, "post_id": 38081023, "comment_id": 63682355, "body": "Thanks mate. My bad , i forgot to write &quot;CODE&quot; with Visual Studio. I have installed Delve. but i get this error in when i start to debug. <b>can&#39;t load package: package .: no buildable Go source files in c:\\dev\\go</b> exit status 1"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 67, "user_id": 5482710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143b817f35ef65e9028619fcfad50ba9?s=128&d=identicon&r=PG&f=1", "display_name": "A-kay", "link": "https://stackoverflow.com/users/5482710/a-kay"}, "edited": false, "score": 0, "creation_date": 1467297247, "post_id": 38081023, "comment_id": 63683537, "body": "Again, look for packages within VS Code that are built specifically to do the debugging.  They may install their other version of delve, or have instructions on how to do it that is compatible with that package."}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 7, "last_activity_date": 1533582968, "last_edit_date": 1533582968, "creation_date": 1467129527, "answer_id": 38081023, "question_id": 38080105, "link": "https://stackoverflow.com/questions/38080105/running-golang-in-visual-studio-code/38081023#38081023", "title": "Running Golang in Visual Studio Code", "body": "<p>First of all, debuggers are not part of Go.  C#, F# and other managed languages under the Microsoft stack have debuggers as that's part of the .NET stack.</p>\n\n<p>Second, Visual Studio Code != Visual Studio.  VS Code is a light(er) weight IDE that is geared towards extensibility to support a wide range of languages by creating runners.  But that's the thing: someone else needs to write the runners and hopefully they created a seamless experience with a Debugger (if available).  This is why you have multiple versions of language runners.</p>\n\n<p>In other words: <strong>if you want a VSCode-compatible Debugger+Runner for X language, read up on X language about how to debug it.</strong></p>\n\n<p>Go is no exception.  <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">You must read the language spec, and specifically I recommend Effective Go as it explains why you don't need a Debugger</a>.</p>\n\n<p>--</p>\n\n<p>Now with all of that said, the community has come together and created somewhat of a debugger for GoLang.  <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow noreferrer\">It is called Delve</a>.</p>\n\n<p>Learning how to install it for VS Code is beyond this post.  I recommend finding a VSCode package that supports Go coding with Delve (there is at least one out there, as I have used it).</p>\n\n<p>Opinion: it's an Ok experience in VSCode to debug Go.  I've experimented with it.  While visually pleasing, I went back to Atom for it's large package support of many other Go utilities and Linters - most of which is missing in VSCode (and some packages didn't allow me to modify the config to exclude certain Go workflows). </p>\n\n<p>EDIT 2018: After a few years, VSCode has matured nicely!  I've since switched 100% to VSCode as my primary editor.</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 5482710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143b817f35ef65e9028619fcfad50ba9?s=128&d=identicon&r=PG&f=1", "display_name": "A-kay", "link": "https://stackoverflow.com/users/5482710/a-kay"}, "edited": false, "score": 0, "creation_date": 1467296064, "post_id": 38082863, "comment_id": 63682532, "body": "You mean the location where my go code is. My code is at <b>C:\\dev\\go\\src\\github.com\\golang\\game\\game.go</b>.  Error i am getting is :  can&#39;t load package: package .: no buildable Go source files in c:\\dev\\go exit status 1"}, {"owner": {"reputation": 7891, "user_id": 1737201, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9d553e4eece2656148b5d0e2a613e53e?s=128&d=identicon&r=PG", "display_name": "mezoni", "link": "https://stackoverflow.com/users/1737201/mezoni"}, "reply_to_user": {"reputation": 67, "user_id": 5482710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143b817f35ef65e9028619fcfad50ba9?s=128&d=identicon&r=PG&f=1", "display_name": "A-kay", "link": "https://stackoverflow.com/users/5482710/a-kay"}, "edited": false, "score": 1, "creation_date": 1467297126, "post_id": 38082863, "comment_id": 63683442, "body": "@A-kay Please, try read this information: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>   and this <a href=\"https://talks.golang.org/2014/organizeio.slide#1\" rel=\"nofollow noreferrer\">talks.golang.org/2014/organizeio.slide#1</a>. In vscode the <code>workspaceRoot</code> in &quot;program&quot;: &quot;${workspaceRoot}&quot; means a your current project workspace."}], "tags": [], "owner": {"reputation": 7891, "user_id": 1737201, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9d553e4eece2656148b5d0e2a613e53e?s=128&d=identicon&r=PG", "display_name": "mezoni", "link": "https://stackoverflow.com/users/1737201/mezoni"}, "is_accepted": false, "score": 2, "last_activity_date": 1467136014, "last_edit_date": 1467136014, "creation_date": 1467135606, "answer_id": 38082863, "question_id": 38080105, "link": "https://stackoverflow.com/questions/38080105/running-golang-in-visual-studio-code/38082863#38082863", "title": "Running Golang in Visual Studio Code", "body": "<p>One possible option to install Debugger for Go language on Windows is:</p>\n\n<pre><code>go get github.com/derekparker/delve/cmd/dlv\n</code></pre>\n\n<p>After that the Visual Studio Code (vscode) will be able to run (debug) launch configuration.  </p>\n\n<p>By default, file <code>launch.json</code> points to the root of the project:</p>\n\n<pre><code>\"program\": \"${workspaceRoot}\"\n</code></pre>\n\n<p>If you want configure it to the another location (eg. your/package/foo/dir) then  edit it as the following:</p>\n\n<pre><code>\"program\": \"${workspaceRoot}/foo/dir\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2165, "user_id": 4200050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4BAiJ.jpg?s=128&g=1", "display_name": "Vladimir Nul", "link": "https://stackoverflow.com/users/4200050/vladimir-nul"}, "edited": false, "score": 1, "creation_date": 1470175249, "post_id": 38730824, "comment_id": 64838681, "body": "Please consider pointing the relevant parts of the link you provided as part of the answer. A link-only answer might be not that useful at the end."}], "tags": [], "owner": {"reputation": 105, "user_id": 2566060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0672beb359fc1153eeabfe84e117e310?s=128&d=identicon&r=PG", "display_name": "dbenque", "link": "https://stackoverflow.com/users/2566060/dbenque"}, "is_accepted": false, "score": 1, "last_activity_date": 1470173547, "creation_date": 1470173547, "answer_id": 38730824, "question_id": 38080105, "link": "https://stackoverflow.com/questions/38080105/running-golang-in-visual-studio-code/38730824#38730824", "title": "Running Golang in Visual Studio Code", "body": "<p>In case you want to debug a Go module running inside an application server you can have a look at <a href=\"https://medium.com/@dbenque/debugging-golang-appengine-module-with-visual-studio-code-85b3aa59e0f\" rel=\"nofollow\">debugging golang appengine module with visual studio code</a>.</p>\n\n<p>Explanations are for Appengine server, but you can easily understand how to do remote debugging from vscode using Delve.</p>\n"}], "owner": {"reputation": 67, "user_id": 5482710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143b817f35ef65e9028619fcfad50ba9?s=128&d=identicon&r=PG&f=1", "display_name": "A-kay", "link": "https://stackoverflow.com/users/5482710/a-kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10195, "favorite_count": 2, "answer_count": 3, "score": 2, "last_activity_date": 1533582968, "creation_date": 1467126955, "last_edit_date": 1467128387, "question_id": 38080105, "link": "https://stackoverflow.com/questions/38080105/running-golang-in-visual-studio-code", "title": "Running Golang in Visual Studio Code", "body": "<p>Can anyone tell me how can I run and use debugger in Visual Studio for a simple go program in Windows step by step?</p>\n\n<p>I took a reference from this page: </p>\n\n<p><a href=\"https://marketplace.visualstudio.com/items?itemName=lukehoban.Go\" rel=\"nofollow\">https://marketplace.visualstudio.com/items?itemName=lukehoban.Go</a></p>\n\n<p>But I was not able to run the code. My current GOPATH is C:\\dev\\go.\nPlease let me know if any other details are required. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 590, "user_id": 2128025, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LXH24.jpg?s=128&g=1", "display_name": "Spouk", "link": "https://stackoverflow.com/users/2128025/spouk"}, "edited": false, "score": 0, "creation_date": 1467126256, "post_id": 38079468, "comment_id": 63596152, "body": "+1 I like the concept revolved in his mind, he could not specify it. You have given a perfect shape to this idea. Thank you."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1467128229, "post_id": 38079468, "comment_id": 63597599, "body": "It&#39;s also a relatively common idiom to pass in, by reference, the destination as an interface argument to the function, in a similar manner to <code>io.Read()</code> and <code>sql.Scan()</code>.  If your <code>Get()</code> function accepts an argument <code>dest interface{}</code> that must be a pointer, it can pass that <code>dest</code> directly to your <code>rows.All()</code> (or the base <code>sql.Scan()</code>, or <code>sqlx.Get()</code>, etc) without having to know what type it is at all, and without having to have a specific code block in <code>Get()</code> for each domain model type."}], "tags": [], "owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "is_accepted": true, "score": 2, "last_activity_date": 1467125283, "last_edit_date": 1495542160, "creation_date": 1467125283, "answer_id": 38079468, "question_id": 38079036, "link": "https://stackoverflow.com/questions/38079036/golang-refactoring-pattern-any-solution/38079468#38079468", "title": "Golang. Refactoring || Pattern || any solution", "body": "<p>I can see you have a lot of redundancy in your code. Few months back I had a same problem and have great answer. Take a look at here: <a href=\"https://stackoverflow.com/questions/35657362/how-to-return-dynamic-type-struct-in-golang\">How to return dynamic type struct in Golang?</a>.</p>\n\n<p>Basically you will have same three functions(add/edit/delete/count) like this (i do not know what db are you using I use NoSql Rethinkdb, but the principle is same):</p>\n\n<pre><code>func (c Main) Get(modelname string) interface{} {\n\n   //your query here for getting stuff from model name and return interface\n\n   rows, err := rethink.Table(modelname).OrderBy(rethink.Asc(\"sortNo\")).Run(c.DB)\n   if err != nil {\n       log.Println(err)\n       return nil\n   }\n\n   if (modelType == \"brand\") {\n\n       var brands  []*models.Brand\n       rows.All(&amp;brands)\n\n       return brands\n\n   }\n   //rest of your models here or use some switch\n})\n</code></pre>\n\n<p>I usually put all my functions that are doing stuff with database in some helper (this is mostly because of tests). </p>\n\n<p>I think this is good directions because like this you code is easy to maintain and you will be changing only helper functions instead of going to million fictions that are doing add/delete/update for every model.  </p>\n"}, {"tags": [], "owner": {"reputation": 590, "user_id": 2128025, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LXH24.jpg?s=128&g=1", "display_name": "Spouk", "link": "https://stackoverflow.com/users/2128025/spouk"}, "is_accepted": false, "score": 0, "last_activity_date": 1467130523, "creation_date": 1467130523, "answer_id": 38081337, "question_id": 38079036, "link": "https://stackoverflow.com/questions/38079036/golang-refactoring-pattern-any-solution/38081337#38081337", "title": "Golang. Refactoring || Pattern || any solution", "body": "<p>I implemented this idea in the code. It turned out great.</p>\n\n<p><strong>Refactoring code</strong></p>\n\n<pre><code>//------------------------------------------------------------------------\n//  REFACTORING\n//-----------------------------------------------------------------------\nfunc (d *Database)Create(model string, params interface{}) *Answer {\n    //variables\n    answer := d.initCall(\"Create\")\n    tableType := d.Mapper[model]\n    var (\n        errorExists interface{}\n        flag bool\n    )\n\n    //logic switch types\n    switch tableType.(type) {\n    case User:\n        params := params.(UserUpdate)\n        if errorExists = d.DB.Find(&amp;User{}, &amp;User{Email:params.Email}).Error; errorExists == nil {\n            flag = false\n        } else {\n            flag = true\n            //variables\n            user := new(User)\n            userinfo := UserInfo{Data:time.Now()}\n            session := Session{Data:time.Now()}\n            cook := Cook{}\n\n            //make support  tables object\n            //userinfo object\n            userinfo.Password = params.Password\n            userinfo.Username = params.Username\n            //cook object\n            cook.SessionID = session.ID\n            cook.Cookie = d.cookgeneratenew(\"somesaltforcooksgenerate\")\n            cook.Status = true\n            cook.Lastconnect = time.Now()\n            cook.CountConnect += 1\n\n            //user object\n            user.Email = params.Email\n            user.Session = session\n            user.UserInfo = userinfo\n            user.Cook = cook\n            user.Role = int64(params.Role)\n\n            //assign ready model for create\n            tableType = user\n        }\n\n    case Category:\n        params := params.(CategoryUpdate)\n        if errorExists = d.DB.Find(&amp;Category{}, &amp;Category{Name:params.Name}).Error; errorExists == nil {\n            //set logic switcher\n            flag = false\n        } else {\n            //set logic switcher\n            flag = true\n\n            //speciffic functional\n            cat := new(Category)\n            cat.Name = params.Name\n\n            //assign ready model for create\n            tableType = cat\n    }\n    default:\n        fmt.Printf(\"Wrong type table\\n\")\n    }\n\n    //call function create model\n    if flag {\n        if err := d.DB.Create(tableType).Error; err != nil {\n            answer.AnswerJSON.ErrorAnswer.Message = err.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            answer.AnswerJSON.Result = tableType\n            answer.AnswerJSON.Status = true\n        }\n    } else {\n        answer.AnswerJSON.ErrorAnswer.Message = \"object already exist\"\n        answer.AnswerJSON.Result = nil\n        answer.AnswerJSON.Status = false\n    }\n    //make answer\n    d.serilize(answer)\n    return answer\n}\n</code></pre>\n"}], "owner": {"reputation": 590, "user_id": 2128025, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LXH24.jpg?s=128&g=1", "display_name": "Spouk", "link": "https://stackoverflow.com/users/2128025/spouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 38079468, "answer_count": 2, "score": 2, "last_activity_date": 1467130523, "creation_date": 1467124223, "question_id": 38079036, "link": "https://stackoverflow.com/questions/38079036/golang-refactoring-pattern-any-solution", "title": "Golang. Refactoring || Pattern || any solution", "body": "<p>Problem: There is a list of tables associated keys. It is necessary to implement CRUD for each table + some functional on the specifics of the table (pagination, etc.).\nTroubles: duplicated in each of the functional implementation for each table About 50% of the code.\nQuestion: What are the ways on the specifics of the language, of the optimization / refactoring / use similar code patterns?</p>\n\n<p><strong>Example code part</strong>\n</p>\n\n<pre><code>//------------------------------------------------------------------\n//  user\n//----------------------------------------------------------------------\nfunc (d *Database) UserCreate(email, password, username string, role int) *Answer {\n    //variables\n    answer := d.initCall(\"UserCreate\")\n    user := new(User)\n    //check exist user\n    if userExist := d.DB.Find(&amp;User{}, &amp;User{Email:email}).Error; userExist == nil {\n        answer.AnswerJSON.ErrorAnswer.Message = \"[usercreate] user already exist\"\n        answer.AnswerJSON.Result = nil\n        answer.AnswerJSON.Status = false\n    } else {\n\n        userinfo := UserInfo{Data:time.Now()}\n        session := Session{Data:time.Now()}\n        cook := Cook{}\n\n        //make support  tables object\n        //userinfo object\n        userinfo.Password = password\n        userinfo.Username = username\n        //cook object\n        cook.SessionID = session.ID\n        cook.Cookie = d.cookgeneratenew(\"somesaltforcooksgenerate\")\n        cook.Status = true\n        cook.Lastconnect = time.Now()\n        cook.CountConnect += 1\n\n        //user object\n        user.Email = email\n        user.Session = session\n        user.UserInfo = userinfo\n        user.Cook = cook\n        user.Role = int64(role)\n\n        //make request + //serizlizations to json answer\n        if err := d.DB.Create(user).Error; err != nil {\n            answer.AnswerJSON.ErrorAnswer.Message = err.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            answer.AnswerJSON.Result = user\n            answer.AnswerJSON.Status = true\n        }\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) UserDelete(userid int64) *Answer {\n    answer := d.initCall(\"UserDelete\")\n    user := new(User)\n    //check exists\n    if userExists := d.DB.Find(user, \"ID = ?\", userid).Error; userExists == nil {\n        if userDelete := d.DB.Delete(user).Error; userDelete != nil {\n            answer.AnswerJSON.ErrorAnswer.Message = userExists.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            answer.AnswerJSON.Status = true\n            answer.AnswerJSON.ErrorAnswer = nil\n        }\n    } else {\n        answer.AnswerJSON.ErrorAnswer.Message = userExists.Error()\n        answer.AnswerJSON.Status = false\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) UserRead(userid int64) *Answer {\n    answer := d.initCall(\"UserRead\")\n    user := new(User)\n    if userExists := d.DB.Find(user, \"ID = ?\", userid).Error; userExists != nil {\n        answer.AnswerJSON.ErrorAnswer.Message = userExists.Error()\n        answer.AnswerJSON.Status = false\n    } else {\n        if rel := d.DB.Model(user).Related(&amp;user.Session).Error; rel != nil {\n            answer.AnswerJSON.Result = nil\n            answer.AnswerJSON.ErrorAnswer.Message = rel.Error()\n            answer.AnswerJSON.Status = false\n        } else if rel = d.DB.Model(user).Related(&amp;user.UserInfo).Error; rel != nil {\n            answer.AnswerJSON.Result = nil\n            answer.AnswerJSON.ErrorAnswer.Message = rel.Error()\n            answer.AnswerJSON.Status = false\n        } else if rel = d.DB.Model(user).Related(&amp;user.Cook).Error; rel != nil {\n            answer.AnswerJSON.Result = nil\n            answer.AnswerJSON.ErrorAnswer.Message = rel.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            answer.AnswerJSON.Result = user\n            answer.AnswerJSON.ErrorAnswer = nil\n            answer.AnswerJSON.Status = true\n        }\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) UserReadAll() *Answer {\n    answer := d.initCall(\"UserReadAll\")\n    users := []User{}\n\n    if usersGet := d.DB.Find(&amp;users).Error; usersGet != nil {\n        answer.AnswerJSON.ErrorAnswer.Message = usersGet.Error()\n        answer.AnswerJSON.Status = false\n    } else {\n        for _, user := range users {\n            d.DB.Model(user).Related(&amp;user.Session)\n            d.DB.Model(user).Related(&amp;user.UserInfo)\n            d.DB.Model(user).Related(&amp;user.Cook)\n        }\n        answer.AnswerJSON.Result = users\n        answer.AnswerJSON.ErrorAnswer = nil\n        answer.AnswerJSON.Status = true\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) UserUpdate(userid int64, uu *UserUpdateStruct) *Answer {\n    answer := d.initCall(\"UserUpdate\")\n    user := new(User)\n\n    if userExists := d.DB.Find(user, \"ID = ?\", userid).Error; userExists != nil {\n        answer.AnswerJSON.ErrorAnswer.Message = userExists.Error()\n        answer.AnswerJSON.Status = false\n    } else {\n        //get relevating struct info\n        d.DB.Model(user).Related(&amp;user.Session)\n        d.DB.Model(user).Related(&amp;user.UserInfo)\n        d.DB.Model(user).Related(&amp;user.Cook)\n\n        //update columns\n        if uu.Email != \"\" {\n            user.Email = uu.Email\n        }\n        if uu.Avatar &gt; 0 {\n            user.UserInfo.Avatar = uu.Avatar\n        }\n        if uu.Birthday != \"\" {\n            user.UserInfo.Birthday = uu.Birthday\n        }\n        if uu.Location != \"\" {\n            user.UserInfo.Location = uu.Location\n        }\n        if uu.Male != \"\" {\n            user.UserInfo.Male = uu.Male\n        }\n        if uu.Password != \"\" {\n            user.UserInfo.Password = uu.Password\n        }\n        if uu.Role &gt; 0 {\n            if roleErr := d.DB.Find(&amp;Role{}).Error; roleErr != nil {\n                //role not found\n                fmt.Printf(\"[userupdate] role not found `%d`\\n\", uu.Role)\n            } else {\n                user.Role = uu.Role\n            }\n        }\n\n        //update\n        if errUpdate := d.DB.Save(user).Error; errUpdate != nil {\n            answer.AnswerJSON.ErrorAnswer.Message = errUpdate.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            answer.AnswerJSON.Result = user\n            answer.AnswerJSON.ErrorAnswer = nil\n            answer.AnswerJSON.Status = true\n        }\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) UserPaginate(page, countPage int) *Answer {\n    answer := d.initCall(\"UserPaginate\")\n    result := []*User{}\n    if errPag := d.DB.Limit(countPage).Offset((page * countPage) - countPage).Find(&amp;result).Error; errPag != nil {\n        answer.AnswerJSON.ErrorAnswer.Message = errPag.Error()\n        answer.AnswerJSON.Status = false\n    } else {\n        for _, user := range result {\n            d.DB.Model(&amp;user).Related(&amp;user.Session)\n            d.DB.Model(&amp;user).Related(&amp;user.UserInfo)\n            d.DB.Model(&amp;user).Related(&amp;user.Cook)\n        }\n        answer.AnswerJSON.Result = result\n        answer.AnswerJSON.ErrorAnswer = nil\n        answer.AnswerJSON.Status = true\n    }\n    d.serilize(answer)\n    return answer\n}\n//-------------------------------------------------------------------\n//  category\n//--------------------------------------------------------------------\nfunc (d *Database) CategoryCreate(name string) *Answer {\n    //variables\n    answer := d.initCall(\"CategoryCreate\")\n    cat := new(Category)\n    //check exist user\n    if catExist := d.DB.Find(&amp;Category{}, &amp;Category{Name:name}).Error; catExist == nil {\n        answer.AnswerJSON.ErrorAnswer.Message = \"[categorycreate] category already exist\"\n        answer.AnswerJSON.Result = nil\n        answer.AnswerJSON.Status = false\n    } else {\n        cat.Name = name\n        //make request + //serizlizations to json answer\n        if err := d.DB.Create(cat).Error; err != nil {\n            answer.AnswerJSON.ErrorAnswer.Message = err.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            answer.AnswerJSON.Result = cat\n            answer.AnswerJSON.Status = true\n        }\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) CategoryDelete(catid int64) *Answer {\n    answer := d.initCall(\"CategoryDelete\")\n    cat := new(Category)\n    //check exists\n    if catExists := d.DB.Find(cat, \"ID = ?\", catid).Error; catExists == nil {\n        if catDelete := d.DB.Delete(cat).Error; catDelete != nil {\n            answer.AnswerJSON.ErrorAnswer.Message = catExists.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            answer.AnswerJSON.Status = true\n            answer.AnswerJSON.ErrorAnswer = nil\n        }\n    } else {\n        answer.AnswerJSON.ErrorAnswer.Message = catExists.Error()\n        answer.AnswerJSON.Status = false\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) CategoryRead(catid int64) *Answer {\n    answer := d.initCall(\"CategoryRead\")\n    cat := new(Category)\n    if catExists := d.DB.Find(cat, \"ID = ?\", catid).Error; catExists != nil {\n        answer.AnswerJSON.ErrorAnswer.Message = catExists.Error()\n        answer.AnswerJSON.Status = false\n    } else {\n        if rel := d.DB.Model(cat).Related(&amp;cat.Post).Error; rel != nil {\n            answer.AnswerJSON.Result = nil\n            answer.AnswerJSON.ErrorAnswer.Message = rel.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            for x, p := range cat.Post {\n                d.DB.Model(&amp;p).Related(&amp;p.Comment)\n                d.DB.Model(&amp;p).Related(&amp;p.PostSeo)\n                cat.Post[x] = p\n            }\n            answer.AnswerJSON.Result = cat\n            answer.AnswerJSON.ErrorAnswer = nil\n            answer.AnswerJSON.Status = true\n        }\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) CategoryReadAll() *Answer {\n    answer := d.initCall(\"CategoryReadAll\")\n    cats := []Category{}\n\n    if catsGet := d.DB.Find(&amp;cats).Error; catsGet != nil {\n        answer.AnswerJSON.ErrorAnswer.Message = catsGet.Error()\n        answer.AnswerJSON.Status = false\n    } else {\n        //categorys\n        for _, cat := range cats {\n            d.DB.Model(cat).Related(&amp;cat.Post)\n            //get relete POST\n            for x, p := range cat.Post {\n                d.DB.Model(&amp;p).Related(&amp;p.Comment)\n                d.DB.Model(&amp;p).Related(&amp;p.PostSeo)\n                cat.Post[x] = p\n            }\n        }\n        answer.AnswerJSON.Result = cats\n        answer.AnswerJSON.ErrorAnswer = nil\n        answer.AnswerJSON.Status = true\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) CategoryUpdate(catid int64, name string) *Answer {\n    answer := d.initCall(\"CategoryUpdate\")\n    cat := new(Category)\n\n    if catExists := d.DB.Find(cat, \"ID = ?\", catid).Error; catExists != nil {\n        answer.AnswerJSON.ErrorAnswer.Message = catExists.Error()\n        answer.AnswerJSON.Status = false\n    } else {\n        //get relevating struct info\n        d.DB.Model(cat).Related(&amp;cat.Post)\n\n        //update columns\n        if name != \"\" {\n            cat.Name = name\n        }\n        //update\n        if errUpdate := d.DB.Save(cat).Error; errUpdate != nil {\n            answer.AnswerJSON.ErrorAnswer.Message = errUpdate.Error()\n            answer.AnswerJSON.Status = false\n        } else {\n            answer.AnswerJSON.Result = cat\n            answer.AnswerJSON.ErrorAnswer = nil\n            answer.AnswerJSON.Status = true\n        }\n    }\n    d.serilize(answer)\n    return answer\n}\nfunc (d *Database) CategoryPaginate(page, countPage int) *Answer {\n    answer := d.initCall(\"CategoryPaginate\")\n    result := []*Category{}\n    if errPag := d.DB.Limit(countPage).Offset((page * countPage) - countPage).Find(&amp;result).Error; errPag != nil {\n        answer.AnswerJSON.ErrorAnswer.Message = errPag.Error()\n        answer.AnswerJSON.Status = false\n    } else {\n        for _, cat := range result {\n            d.DB.Model(&amp;cat).Related(&amp;cat.Post)\n            //get relete POST\n            for x, p := range cat.Post {\n                d.DB.Model(&amp;p).Related(&amp;p.Comment)\n                d.DB.Model(&amp;p).Related(&amp;p.PostSeo)\n                cat.Post[x] = p\n            }\n        }\n        answer.AnswerJSON.Result = result\n        answer.AnswerJSON.ErrorAnswer = nil\n        answer.AnswerJSON.Status = true\n    }\n    d.serilize(answer)\n    return answer\n}\n</code></pre>\n"}, {"tags": ["arrays", "string", "go", "formatting", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1467140878, "last_edit_date": 1467140878, "creation_date": 1467109841, "answer_id": 38073732, "question_id": 38073672, "link": "https://stackoverflow.com/questions/38073672/where-do-the-square-brackets-come-from/38073732#38073732", "title": "Where do the square brackets come from?", "body": "<p>You are printing the value of a slice. It is formatted / printed in <a href=\"https://golang.org/src/fmt/print.go\" rel=\"nofollow\"><code>print.go</code></a>, unexported function <code>printReflectValue()</code>, currently line #980:</p>\n\n<pre><code>855 func (p *pp) printReflectValue(value reflect.Value, verb rune, depth int)\n                                           (wasString bool) {\n\n        // ...\n\n947     case reflect.Array, reflect.Slice:\n            // ...\n\n979         } else {\n980             p.buf.WriteByte('[')\n981         }\n</code></pre>\n\n<p>and line #995:</p>\n\n<pre><code>994         } else {\n995             p.buf.WriteByte(']')\n996         }\n</code></pre>\n\n<p>Note that this is for \"general\" slices (like your <code>[]string</code>), byte slices are handled differently:</p>\n\n<pre><code>948         // Byte slices are special:\n949         // - Handle []byte (== []uint8) with fmtBytes.\n950         // - Handle []T, where T is a named byte type, with fmtBytes only\n</code></pre>\n\n<p><code>[]byte</code> is printed in the unexported function <code>fmtBytes()</code>:</p>\n\n<pre><code>533 func (p *pp) fmtBytes(v []byte, verb rune, typ reflect.Type, depth int) {\n\n            // ...\n\n551         } else {\n552             p.buf.WriteByte('[')\n553         }\n\n            // ...\n\n566         } else {\n567             p.buf.WriteByte(']')\n568         }\n</code></pre>\n"}], "owner": {"reputation": 2063, "user_id": 1722027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5d955abbd8b865e3966027a6d0e9280e?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/1722027/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 800, "favorite_count": 0, "accepted_answer_id": 38073732, "answer_count": 1, "score": 5, "last_activity_date": 1467140878, "creation_date": 1467109687, "last_edit_date": 1467118191, "question_id": 38073672, "link": "https://stackoverflow.com/questions/38073672/where-do-the-square-brackets-come-from", "title": "Where do the square brackets come from?", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n    a := []string{\"abc\", \"edf\"}\n    log.Println(fmt.Sprint(a))\n}\n</code></pre>\n\n<p>The above Go program will print the following output, with slice value inside the square brackets <code>\"[]\"</code>.</p>\n\n<blockquote>\n  <p>2009/11/10 23:00:00 [abc edf]</p>\n</blockquote>\n\n<p>And I want to know where in the source code that <code>[]</code> is added into the formatted string. </p>\n\n<p>I checked the source code <code>src/fmt/print.go</code> file, but couldn't find the exact line of code that does this. </p>\n\n<p>Could anyone provide a hint?</p>\n"}, {"tags": ["reflection", "go", "interface", "null"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1467101323, "post_id": 38070015, "comment_id": 63578679, "body": "Related question, please read answers there: <a href=\"http://stackoverflow.com/questions/29138591/hiding-nil-values-understanding-why-golang-fails-here\">Hiding nil values, understanding why golang fails here</a>"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1467106939, "post_id": 38070015, "comment_id": 63582302, "body": "Normaly you should try to avoid to use the reflect package. Why do you want to check if the interface is nil? Maybe the usage of an interface is not optimal and you shuold use an implementation of your interface."}], "answers": [{"tags": [], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "is_accepted": false, "score": 7, "last_activity_date": 1467100934, "creation_date": 1467100934, "answer_id": 38070426, "question_id": 38070015, "link": "https://stackoverflow.com/questions/38070015/check-if-interface-value-is-nil-in-go-without-using-reflect/38070426#38070426", "title": "Check if interface value is nil in Go without using reflect", "body": "<p>There are two things:\nIf y is the nil interface itself (in which case y==nil will be true), or if y is a non-nil interface but underlying value is a nil value (in which case y==nil will be false).</p>\n\n<p><a href=\"https://play.golang.org/p/BjDd1ko94E\" rel=\"noreferrer\">Here's</a> an example.</p>\n"}, {"tags": [], "owner": {"reputation": 2850, "user_id": 2646539, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/O5bBC.jpg?s=128&g=1", "display_name": "thanhpk", "link": "https://stackoverflow.com/users/2646539/thanhpk"}, "is_accepted": false, "score": 16, "last_activity_date": 1505725400, "creation_date": 1505725400, "answer_id": 46275411, "question_id": 38070015, "link": "https://stackoverflow.com/questions/38070015/check-if-interface-value-is-nil-in-go-without-using-reflect/46275411#46275411", "title": "Check if interface value is nil in Go without using reflect", "body": "<p>Interface is a pair of <code>(type, value)</code>, when you compare a interface with nil, you are comparing the pair (type, value) with nil. To just compare interface value, you either have to convert it to a struct (through type assertion) or use reflection.</p>\n\n<p>do a type assertion when you know the type of the interface</p>\n\n<pre><code>if i.(bool) == nil {\n}\n</code></pre>\n\n<p>otherwise, if you don't know the underlying type of the interface, you may have to use reflection</p>\n\n<pre><code>if reflect.ValueOf(i).IsNil() {\n}\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 6112606, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H4qy-Wstmd0/AAAAAAAAAAI/AAAAAAAAAGY/ENhjaGdCqaQ/photo.jpg?sz=128", "display_name": "manikanta p.s", "link": "https://stackoverflow.com/users/6112606/manikanta-p-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14325, "favorite_count": 3, "answer_count": 2, "score": 11, "last_activity_date": 1505725400, "creation_date": 1467099679, "last_edit_date": 1467109636, "question_id": 38070015, "link": "https://stackoverflow.com/questions/38070015/check-if-interface-value-is-nil-in-go-without-using-reflect", "title": "Check if interface value is nil in Go without using reflect", "body": "<p>I need to check if an <strong>interface</strong> value is `nil.</p>\n\n<p>But by using <strong>reflection</strong> it is giving me an error:</p>\n\n<blockquote>\n  <p>reflect: call of reflect.Value.Bool on struct Value.</p>\n</blockquote>\n\n<p>Through <code>nil</code> it is not giving an <strong>error</strong> for <code>nil</code> value.</p>\n"}, {"tags": ["http", "go", "webserver", "html5-video", "mp4"], "comments": [{"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 1, "creation_date": 1467104881, "post_id": 38069584, "comment_id": 63580902, "body": "The code you have seems to work fine for me. You may have to elaborate on the specific issue you&#39;re seeing. (You say &quot;it can not be loaded and therefor not played,&quot; but I&#39;m not sure what you mean by that. Please be specific about the problem you&#39;re having.)"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1467106695, "post_id": 38069584, "comment_id": 63582170, "body": "You still haven&#39;t described the actual issue you&#39;re seeing. Is there an error? If so, where do you see that error, and what does the error say?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user970470"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1467106957, "post_id": 38069584, "comment_id": 63582315, "body": "Sorry. No I don&#39;t receive any errors, there is just no video. If I try to load it diectly like <a href=\"http://localhost:8080/public/video/marketing.mp4\" rel=\"nofollow noreferrer\">localhost:8080/public/video/marketing.mp4</a> it shows me empty video controls and the video is not loaded. I updated the Issue again with a screenshot of the result."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1467107311, "post_id": 38069584, "comment_id": 63582582, "body": "Is there any chance you can share the exact video that&#39;s problematic?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1467107412, "post_id": 38069584, "comment_id": 63582649, "body": "You should serve your files using <a href=\"https://golang.org/pkg/net/http/#ServeFile\" rel=\"nofollow noreferrer\"><code>http.ServeFile()</code></a> which supports serving Range requests (required for videos to be able to seek). See related question: <a href=\"http://stackoverflow.com/questions/36540610/how-to-serve-http-partial-content-with-go\">How to serve http partial content with Go?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user970470"}, "edited": false, "score": 0, "creation_date": 1467107844, "post_id": 38069584, "comment_id": 63582934, "body": "unfortunately I can&#39;t share it sorry, but thanks for offering me to investigate deeper. Regarding http.ServeFile: I don&#39;t wan&#39;t it to be searched it is a video running in a loop without the needs of any controls. It just makes me curious why one video with the same codec is working and the other one is not. The only thing i could think of is the size. Maybe there is a size limit?"}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467108225, "post_id": 38069584, "comment_id": 63583211, "body": "@icz - correct, I already tried to state that:) &quot;Another video&quot; in this case is no proof, improper range handling is more likely the case because the code pasted here obviously does not deal with that."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 1, "creation_date": 1467108341, "post_id": 38069584, "comment_id": 63583286, "body": "@MichaelB simply run wireshark to see what exaclty is going on;) If chrome decides to dispatch another request with a <code>Range</code> header other than <code>0-</code> then of course that is the issue."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "edited": false, "score": 1, "creation_date": 1467108386, "post_id": 38069584, "comment_id": 63583317, "body": "@MichaelB also open <code>chrome:&#47;&#47;media-internals&#47;</code> in a new tab - that shows the internal info for all the opened media sinks. You will most probably be able to see what exactly went wrong."}, {"owner": {"user_type": "does_not_exist", "display_name": "user970470"}, "edited": false, "score": 0, "creation_date": 1467108626, "post_id": 38069584, "comment_id": 63583457, "body": "Thank you guys! I will do so and update the Issue as soon as I have more information. You were very helpful thanks again."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467123996, "post_id": 38069584, "comment_id": 63594432, "body": "To your last update: <i>&quot;without using the http.FileServe method&quot;</i> you claim you don&#39;t use <code>FileServe()</code> yet in your code you call it. Another problem here is that you call <code>w.WriteHeader()</code> which commits the headers (so you can&#39;t change response headers after that) and you call <code>http.ServeFile()</code> after this - but it won&#39;t be able to change headers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user970470"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467124365, "post_id": 38069584, "comment_id": 63594682, "body": "@icza: sorry forget to remove the line... corrected it! thanks"}], "answers": [{"tags": [], "owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "is_accepted": false, "score": 0, "last_activity_date": 1467104140, "creation_date": 1467104140, "answer_id": 38071506, "question_id": 38069584, "link": "https://stackoverflow.com/questions/38069584/golang-http-webserver-provide-video-mp4/38071506#38071506", "title": "GoLang http webserver provide video (mp4)", "body": "<p>Well, since it's not a live stream (in terms that the size and duration are known since the source is an mp4 file) I think your server should honor the <code>Range</code> header in the request and respond with proper <code>Content-Length</code>, <code>Content-Range</code> and <code>Accept-Range</code> values (otherwise seeking would be impossible and I guess you don't want that). That should make Chrome happy. Take care when implementing the handling of the <code>Range</code> header value in the request - if it is not <code>0-</code> then you must actually seek to the requested point and return the data from there. Also I don't think videos should be transferred with <code>Transfer-Encoding</code> set to <code>chunked</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user970470"}, "edited": false, "score": 0, "creation_date": 1467106489, "post_id": 38072009, "comment_id": 63582021, "body": "You are absolutely right! I never tried another video, but it is indeed working. The strange thing is, that I have no clue why... I updated my post and added two new images. Thanks for your help"}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": false, "score": 3, "last_activity_date": 1467105400, "creation_date": 1467105400, "answer_id": 38072009, "question_id": 38069584, "link": "https://stackoverflow.com/questions/38069584/golang-http-webserver-provide-video-mp4/38072009#38072009", "title": "GoLang http webserver provide video (mp4)", "body": "<p>Your code seems to work fine for me. Here's the complete working example I tested, using Chrome on OS X.</p>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nimport \"io/ioutil\"\nimport \"log\"\nimport \"net/http\"\nimport \"strings\"\n\ntype viewHandler struct{}\n\nfunc (vh *viewHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    path := r.URL.Path[1:]\n\n    data, err := ioutil.ReadFile(string(path))\n\n    if err != nil {\n        log.Printf(\"Error with path %s: %v\", path, err)\n        w.WriteHeader(404)\n        w.Write([]byte(\"404\"))\n    }\n\n    if strings.HasSuffix(path, \".html\") {\n        w.Header().Add(\"Content-Type\", \"text/html\")\n    } else if strings.HasSuffix(path, \".mp4\") {\n        w.Header().Add(\"Content-Type\", \"video/mp4\")\n    }\n\n    w.Write(data)\n}\n\nfunc main() {\n    http.Handle(\"/\", new(viewHandler))\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>index.html:</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;body&gt;\n    &lt;video autoplay loop&gt;\n        &lt;source src=\"big_buck_bunny.mp4\" type=\"video/mp4\"&gt;\n    &lt;/video&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Video downloaded from <a href=\"http://www.quirksmode.org/html5/videos/big_buck_bunny.mp4\" rel=\"nofollow\">http://www.quirksmode.org/html5/videos/big_buck_bunny.mp4</a>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user970470"}, "edited": false, "score": 0, "creation_date": 1467124579, "post_id": 38075985, "comment_id": 63594876, "body": "thanks! that was very helpful. I marked your statement as the correct answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 14, "last_activity_date": 1467123758, "last_edit_date": 1495542398, "creation_date": 1467116087, "answer_id": 38075985, "question_id": 38069584, "link": "https://stackoverflow.com/questions/38069584/golang-http-webserver-provide-video-mp4/38075985#38075985", "title": "GoLang http webserver provide video (mp4)", "body": "<p>Your \"issue\" is related to the video length / size. I don't know the default buffer Chrome uses (it may depend on multiple things like free memory, free disk space etc.), but you shouldn't rely on it for your video to play!</p>\n\n<p>One of your video is a few seconds shorter and almost 3rd the size of the other. Chrome buffers completely the smaller video (likely in memory), while does not do the same with the other. And since it's bigger than the buffer, it needs the server to support Range requests (partial content serving). The way you serve the content of your video, you are not supporting partial content serving (which Chrome expects in case of \"large\" videos), so Chrome simply denies to handle / play the video.</p>\n\n<p>You should serve your files using <a href=\"https://golang.org/pkg/net/http/#ServeFile\" rel=\"noreferrer\"><code>http.ServeFile()</code></a> which supports serving Range requests (required for videos that are bigger than a certain size). See related question: <strong><a href=\"https://stackoverflow.com/questions/36540610/how-to-serve-http-partial-content-with-go\">How to serve http partial content with Go?</a></strong></p>\n\n<p>Once you do this, both your video files will play fine.</p>\n\n<p>Going forward, there is no practical reason not to use <code>http.ServeFile()</code>. It won't load the complete file into memory as you did which is a really bad idea in case of big (video) files. <code>http.ServeFile()</code> handles Range requests if asked so, and also properly sets response headers including the <code>Content-Type</code> (and knows that <code>.mp4</code> files require <code>video/mp4</code> MIME type).</p>\n\n<h2>Analyzing requests of a big video file</h2>\n\n<p>Testing this simple application:</p>\n\n<pre><code>func fileh(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"/path/to/a/big/video.mp4\")    \n}\n\nfunc main() {\n    http.HandleFunc(\"/\", fileh)\n    panic(http.ListenAndServe(\"localhost:8080\", nil))\n}\n</code></pre>\n\n<p>And opening <code>http://localhost:8080</code> from Chrome, the browser makes 2 requests (I intentionally filtered out unimportant / unrelated request-response headers):</p>\n\n<h3>Request #1</h3>\n\n<pre><code>GET / HTTP/1.1\n</code></pre>\n\n<p>To get the requested (root) path.</p>\n\n<h3>Response #1</h3>\n\n<pre><code>HTTP/1.1 200 OK\nAccept-Ranges: bytes\nContent-Length: 104715956\nContent-Type: video/mp4\n</code></pre>\n\n<p>As you can see, the Go app reports the video size is around 100 MB. <code>http.ServeFile()</code> also includes the response header <code>Accept-Ranges: bytes</code> which lets clients know prior that we support Range requests.</p>\n\n<p>How does Chrome respond to this? Closes the connection after receiving 32 KB (32.2 KB including headers; which is enough to look into the stream and tell what it can do with it), then fires another request (which also happens even if the <code>Accept-Ranges</code> response header is not sent - your example code does not send it):</p>\n\n<h3>Request #2</h3>\n\n<pre><code>GET / HTTP/1.1\nReferer: http://localhost:8080/\nRange: bytes=0-\n</code></pre>\n\n<p>Chrome fires a Range request (asking everything from the first byte), so if your Go app does not support this, you're in trouble. See response #2.</p>\n\n<h3>Response #2</h3>\n\n<pre><code>HTTP/1.1 206 Partial Content\nAccept-Ranges: bytes\nContent-Length: 104715956\nContent-Range: bytes 0-104715955/104715956\nContent-Type: video/mp4\n</code></pre>\n\n<p><code>http.ServeFile()</code> behaves well, and responds properly to the Range request (<code>HTTP 206 Partial Content</code> status code and <code>Content-Range</code> header), and sends the range that was requested (everything in this case).</p>\n\n<p>Your example code does not respond with an <code>HTTP 206 Partial Content</code> but with a simple <code>HTTP 200 OK</code>. When Chrome receives the unexpected <code>HTTP 200 OK</code>, that's the point when it gives up on playing your video. If the video file is small, Chrome will not make a big deal out of it as it will just accept the <code>HTTP 200 OK</code> response too (and likely just store the small video in memory or in a cache file).</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 4780955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-x6VZfsNx5bY/AAAAAAAAAAI/AAAAAAAAQ80/Upuy-T4hutg/photo.jpg?sz=128", "display_name": "Gentry Rolofson", "link": "https://stackoverflow.com/users/4780955/gentry-rolofson"}, "is_accepted": false, "score": 0, "last_activity_date": 1516935532, "creation_date": 1516935532, "answer_id": 48455194, "question_id": 38069584, "link": "https://stackoverflow.com/questions/38069584/golang-http-webserver-provide-video-mp4/48455194#48455194", "title": "GoLang http webserver provide video (mp4)", "body": "<p>This is an example that supports all file types.\ncontentType := http.DetectContentType(buffer)\n<a href=\"https://play.golang.org/p/XuVgmsCHUZB\" rel=\"nofollow noreferrer\">https://play.golang.org/p/XuVgmsCHUZB</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user970470"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8412, "favorite_count": 8, "accepted_answer_id": 38075985, "answer_count": 4, "score": 9, "last_activity_date": 1516935532, "creation_date": 1467098494, "last_edit_date": 1467124335, "question_id": 38069584, "link": "https://stackoverflow.com/questions/38069584/golang-http-webserver-provide-video-mp4", "title": "GoLang http webserver provide video (mp4)", "body": "<p>I developed a webserver using golang. Pretty plane stuff, it just provides html/js/css and images which works perfectly fine:</p>\n\n<pre><code>func main() {\n    http.Handle(\"/\", new(viewHandler))\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc (vh *viewHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    path := r.URL.Path[1:]\n    log.Println(path)\n    data, err := ioutil.ReadFile(string(path))\n\n    if err == nil {\n\n        var contentType string\n\n        if strings.HasSuffix(path, \".html\") {\n            contentType = \"text/html\"\n        } else if strings.HasSuffix(path, \".css\") {\n            contentType = \"text/css\"\n        } else if strings.HasSuffix(path, \".js\") {\n            contentType = \"application/javascript\"\n        } else if strings.HasSuffix(path, \".png\") {\n            contentType = \"image/png\"\n        } else if strings.HasSuffix(path, \".jpg\") {\n            contentType = \"image/jpeg\"\n        } \n\n        w.Header().Add(\"Content-Type\", contentType)\n        w.Write(data)\n    } else {\n        log.Println(\"ERROR!\")\n        w.WriteHeader(404)\n        w.Write([]byte(\"404 - \" + http.StatusText(404)))\n    }\n}\n</code></pre>\n\n<p>I tried to add a video in mp4 format to my website in the same way:</p>\n\n<pre><code>&lt;video width=\"685\" height=\"525\" autoplay loop style=\"margin-top: 20px\"&gt;\n   &lt;source src=\"../public/video/marketing.mp4\" type=\"video/mp4\"&gt;Your browser does not support the video tag.&lt;/video&gt;\n</code></pre>\n\n<p>and enhanced the content type part of my go application with:</p>\n\n<pre><code>else if strings.HasSuffix(path, \".mp4\") {\n            contentType = \"video/mp4\"\n        }\n</code></pre>\n\n<p>When I open the html file directly in Chrome the Video is playing correctly, but if I open the website by calling the Web Server at <a href=\"http://localhost\" rel=\"noreferrer\">http://localhost</a>... it can not be loaded and therefor not played.</p>\n\n<p>There is no video loaded, if I try to hit it directly the browser just shows some video contols without loading the file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sp2u1.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/sp2u1.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/H9am4.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/H9am4.png\" alt=\"media loaded twice\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/02qV8.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/02qV8.png\" alt=\"media details\"></a></p>\n\n<p>Any ideas on this? thanks in advance.</p>\n\n<p>UPDATE:</p>\n\n<p>As suggested I also tried another video which is working perfectly fine! but I have no clue why, I compared both videos:</p>\n\n<p><a href=\"https://i.stack.imgur.com/paD7N.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/paD7N.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/2eQJz.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/2eQJz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Could it be the size??</p>\n\n<p>Cheers and thanks!</p>\n\n<p>UPDATE2:</p>\n\n<p>icza is right and I marked his post as correct answer to my question. But let me explain what I finally did to get it working:</p>\n\n<p>I tried to solve my problem without using the http.FileServe method. Therefore I implemented like so:</p>\n\n<pre><code>} else if strings.HasSuffix(path, \".mp4\") {\n            contentType = \"video/mp4\"\n            size := binary.Size(data)\n            if size &gt; 0 {\n                requestedBytes := r.Header.Get(\"Range\")\n                w.Header().Add(\"Accept-Ranges\", \"bytes\")\n                w.Header().Add(\"Content-Length\", strconv.Itoa(size))\n                w.Header().Add(\"Content-Range\", \"bytes \"+requestedBytes[6:len(requestedBytes)]+strconv.Itoa(size-1)+\"/\"+strconv.Itoa(size))\n                w.WriteHeader(206)\n            }\n        }\n\n        w.Header().Add(\"Content-Type\", contentType)\n        w.Write(data)\n</code></pre>\n\n<p>That worked for the first time I played the video. But since I want it to loop it should directly start from the beginning but it stuck at the very last frame of the video.</p>\n\n<p>So I implemented the ServeFile() method like:</p>\n\n<pre><code>if contentType == \"video/mp4\" {\n            http.ServeFile(w, r, path)\n        } else {\n            w.Header().Add(\"Content-Type\", contentType)\n            w.Write(data)\n        }\n</code></pre>\n\n<p>The video is also playing in a loop correctly now. But I still have no idea why ServeFile() is working and the other method not though the response is exactly the same for both methods. Nevertheless the content is looking like that now:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y1ZhS.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Y1ZhS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Cheers and thanks to all of you who helped me.</p>\n"}, {"tags": ["intellij-idea", "go"], "comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1467109263, "post_id": 38068202, "comment_id": 63583850, "body": "This looks like the GOPATH is not configured in the plugin. Can you check that you&#39;ve added it in: File | Settings | Languages &amp; Frameworks | Go | Go Libraries and add the GOPATH (and only the GOPATH there). If you have any issues, please ping me on Gitter and I&#39;ll help you out."}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1467176826, "post_id": 38068202, "comment_id": 63617055, "body": "@dlsniper. hi! thanks for your input. I&#39;m on gitter now, and i don&#39;t know on what room to search for you (couldn&#39;t find a way to search for specific people). anyhow updated main post.  hope this helps."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1467325882, "post_id": 38068202, "comment_id": 63699615, "body": "Sorry, I&#39;ve totally missed this, please join us here: <a href=\"https://gitter.im/go-lang-plugin-org/go-lang-idea-plugin\" rel=\"nofollow noreferrer\">gitter.im/go-lang-plugin-org/go-lang-idea-plugin</a> Ping me with @dlsniper when you are around. Thanks!"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467176713, "creation_date": 1467093875, "last_edit_date": 1592644375, "question_id": 38068202, "link": "https://stackoverflow.com/questions/38068202/compiling-golang-using-intellij-is-looking-for-wrong-path-of-3rd-party-packages", "title": "compiling golang using intellij is looking for wrong path of 3rd party packages", "body": "<p>I'm using IntelliJ with the go plugin to write my application.</p>\n<p>version of Go: <code>go version go1.7beta2 darwin/amd64</code></p>\n<p>Operation system: <code>OSX El Capitan 10.11.5</code></p>\n<p>Intellij Version: <code>2016.1.3</code></p>\n<p>Go Installation Location: <code>/usr/local/go</code></p>\n<p>Go Pkg Location ($GOPATH): <code>/Users/ufk/projects/go</code></p>\n<p>when I open terminal, browse to my application's main source file, and type <code>go</code> it compiles it properly without any errors.</p>\n<p>but when I try to Run the program using Intellij, which also compiles it, i get the following error:</p>\n<pre><code>/usr/local/go/pkg/tool/darwin_amd64/link: cannot open file /usr/local/go/pkg/darwin_amd64/github.com/codegangsta/negroni.a: open /usr/local/go/pkg/darwin_amd64/github.com/codegangsta/negroni.a: no such file or directory\n</code></pre>\n<p>lookgs like it's looking for the negroni package in the location when I have go installed, and not where I the 3rd party packages are installed according to <code>$GOPATH</code>. My project is configured to use $GOPATH, and the real time error of the intellj editor doesn't complain about packages that are not installed which means that Intellij does check the $GOPATH variable.</p>\n<p>so what am i missing ?</p>\n<p>thanks</p>\n<h1>update</h1>\n<p>Hi :)</p>\n<p>I noticed something new... I have 2 go projects, one of them is the JSON Api Server, and the other is for the web server.\nThe project that is causing issues is the Api Server.\nnow, the web server also uses and imports negroni, but the problem occurs only on the Api Server Project.</p>\n<p>so I decided to go wild and delete the .idea and iml file from the Api Server, reopen it with intellij, and see what happens... welp, what happens is that now it complains about a different module.</p>\n<pre><code>/usr/local/go/pkg/tool/darwin_amd64/link: cannot open file /usr/local/go/pkg/darwin_amd64/github.com/jingweno/negroni-gorelic.a: open /usr/local/go/pkg/darwin_amd64/github.com/jingweno/negroni-gorelic.a: no such file or directory\n</code></pre>\n<p>the thing is.. that my web server project also uses negroni-gorelic and things are fine!</p>\n<p>I tried downgrading go from 1.7beta2 to 1.6.2, deleting the content of the modules ($GOPATH/pkg and in src directory github.com and golang.org)\nthen I got all the modules again.. tried to compile with intellij and the results are the same.</p>\n<p>so... hope this helps to further investigate the issue.</p>\n"}, {"tags": ["logging", "go", "influxdb"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1467091999, "post_id": 38067435, "comment_id": 63573750, "body": "What about just calling <code>client.Write(cmdBP)</code> every N lines of logs processed?"}, {"owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1467099928, "post_id": 38067435, "comment_id": 63577794, "body": "So I need to use a counter inside the range loop?"}], "answers": [{"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 2, "last_activity_date": 1467101524, "creation_date": 1467101524, "answer_id": 38070603, "question_id": 38067435, "link": "https://stackoverflow.com/questions/38067435/how-to-write-to-continuosly-write-to-influxdb-using-golang-client/38070603#38070603", "title": "How to write to continuosly write to influxdb using golang client", "body": "<p>Use a combination of batch points and time out (this runs as a goroutine):</p>\n\n<pre><code>func (h *InfluxDBHook) loop() {\n    var coll []*client.Point\n    tick := time.NewTicker(h._batchInterval)\n\n    for {\n        timeout := false\n\n        select {\n        case pt := &lt;-h._points:\n            coll = append(coll, pt)\n        case &lt;-tick.C:\n            timeout = true\n        }\n\n        if (timeout || len(coll) &gt;= h._batchSize) &amp;&amp; len(coll) &gt; 0 {\n            bp, err := client.NewBatchPoints(h._batchPointsConfig)\n            if err != nil {\n                //TODO:\n            }\n            bp.AddPoints(coll)\n            err = h._client.Write(bp)\n            if err != nil {\n                //TODO:\n            } else {\n                coll = nil\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>BTW you can use a hook with <strong>logrus</strong> logging package, to send logs into InfluxDB (sample code is from a <em>logrus</em> <a href=\"https://github.com/dc0d/influxdbhook/blob/master/hook.go\" rel=\"nofollow\">InfluxDB hook</a>).</p>\n"}], "owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3810, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467101524, "creation_date": 1467090311, "question_id": 38067435, "link": "https://stackoverflow.com/questions/38067435/how-to-write-to-continuosly-write-to-influxdb-using-golang-client", "title": "How to write to continuosly write to influxdb using golang client", "body": "<p>I'm using influxDB to store my time series data.</p>\n\n<p>I wrote a simple golang application to read lines from a file called <code>time.log</code>.</p>\n\n<p>The documentation at <a href=\"https://github.com/influxdata/influxdb/blob/master/client/README.md#inserting-data\" rel=\"nofollow\">https://github.com/influxdata/influxdb/blob/master/client/README.md#inserting-data</a> says:</p>\n\n<blockquote>\n  <p>Inserting Data</p>\n  \n  <p>Time series data aka points are written to the database using batch inserts. The mechanism is to create one or more points and then create a batch aka batch points and write these to a given database and series. A series is a combination of a measurement (time/values) and a set of tags.</p>\n  \n  <p>In this sample we will create a batch of a 1,000 points. Each point has a time and a single value as well as 2 tags indicating a shape and color. We write these points to a database called square_holes using a measurement named shapes.</p>\n  \n  <p>NOTE: You can specify a RetentionPolicy as part of the batch points. If not provided InfluxDB will use the database default retention policy.</p>\n\n<pre><code>func writePoints(clnt client.Client) {\n    sampleSize := 1000\n    rand.Seed(42)\n\n    bp, _ := client.NewBatchPoints(client.BatchPointsConfig{\n        Database:  \"systemstats\",\n        Precision: \"us\",\n    })\n\n    for i := 0; i &lt; sampleSize; i++ {\n        regions := []string{\"us-west1\", \"us-west2\", \"us-west3\", \"us-east1\"}\n        tags := map[string]string{\n            \"cpu\":    \"cpu-total\",\n            \"host\":   fmt.Sprintf(\"host%d\", rand.Intn(1000)),\n            \"region\": regions[rand.Intn(len(regions))],\n        }\n\n        idle := rand.Float64() * 100.0\n        fields := map[string]interface{}{\n            \"idle\": idle,\n            \"busy\": 100.0 - idle,\n        }\n\n        bp.AddPoint(client.NewPoint(\n            \"cpu_usage\",\n            tags,\n            fields,\n            time.Now(),\n        ))\n    }\n\n    err := clnt.Write(bp)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n</blockquote>\n\n<p>But because I'm continuously reading data from the log. I'm never done reading the log. So what is the best way for me to write the points to the influx server?</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>cmdBP := client.NewBatchPoints(...)\nfor line := range logFile.Lines {\n    pt := parseLine(line.Text)\n    cmdBP.AddPoint(pt)\n}\n\ninfluxClient.Write(cmdBP)\n</code></pre>\n\n<p>Basically range logFile.Lines never terminates because it is based on a channel. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1467088023, "post_id": 38066966, "comment_id": 63572421, "body": "Add a <code>&amp;</code> in line 31: Collection does not implement Collection Interface (only *Collection does). And: Take the Tour of Go once more."}, {"owner": {"reputation": 21, "user_id": 6521308, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZSTew7OIIj0/AAAAAAAAAAI/AAAAAAAAB1E/aqXBTE1n5ig/photo.jpg?sz=128", "display_name": "Lukas Kristian", "link": "https://stackoverflow.com/users/6521308/lukas-kristian"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1468208087, "post_id": 38066966, "comment_id": 64014221, "body": "I&#39;m actually getting the interface from reflection, I just found out that the way to get it&#39;s pointer is using Add().Interface() function. I hope it helps people who stuck to get pointer for reflection interface."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6521308, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZSTew7OIIj0/AAAAAAAAAAI/AAAAAAAAB1E/aqXBTE1n5ig/photo.jpg?sz=128", "display_name": "Lukas Kristian", "link": "https://stackoverflow.com/users/6521308/lukas-kristian"}, "edited": false, "score": 0, "creation_date": 1467089741, "post_id": 38067100, "comment_id": 63572950, "body": "The thing is, I&#39;m getting the interface{} from a reflection. Do you know how to get the pointer with reflection? (still trying to figuring out reflection)"}, {"owner": {"reputation": 21, "user_id": 6521308, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZSTew7OIIj0/AAAAAAAAAAI/AAAAAAAAB1E/aqXBTE1n5ig/photo.jpg?sz=128", "display_name": "Lukas Kristian", "link": "https://stackoverflow.com/users/6521308/lukas-kristian"}, "edited": false, "score": 1, "creation_date": 1467089852, "post_id": 38067100, "comment_id": 63572993, "body": "Ok, I managed to figured it out. Using Add().Interface() give me the pointer that&#39;s the same with &amp;variable... you are a legend, thank you very much.. been stuck in this issue for 3 days haha.."}, {"owner": {"reputation": 1914, "user_id": 433327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/018e3018fba33be8c1f8198065af6f14?s=128&d=identicon&r=PG", "display_name": "Dustin Graham", "link": "https://stackoverflow.com/users/433327/dustin-graham"}, "edited": false, "score": 0, "creation_date": 1545117758, "post_id": 38067100, "comment_id": 94504644, "body": "Bingo. Been looking for this for hours. Glad you commented what you found. For clarity, I think you meant <code>Addr()</code> so something like <code>reflect.New(reflect.TypeOf(someVar)).Elem().Addr().Interface&zwnj;&#8203;()</code>"}], "tags": [], "owner": {"reputation": 522, "user_id": 1391008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03f3a6314e7ed2bd34b7200d48742d2?s=128&d=identicon&r=PG", "display_name": "Moch Lutfi", "link": "https://stackoverflow.com/users/1391008/moch-lutfi"}, "is_accepted": false, "score": -1, "last_activity_date": 1467088293, "creation_date": 1467088293, "answer_id": 38067100, "question_id": 38066966, "link": "https://stackoverflow.com/questions/38066966/panic-interface-conversionobj-is-not-objinterface-missing-method-x/38067100#38067100", "title": "panic: interface conversion:Obj is not ObjInterface: missing method X", "body": "<p>You are doing it wrong. I make little modification to fix it. Let me know if you have question.</p>\n\n<p><a href=\"https://play.golang.org/p/SEesgVhXt8\" rel=\"nofollow\">https://play.golang.org/p/SEesgVhXt8</a></p>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1467126935, "post_id": 38070817, "comment_id": 63596673, "body": "This is accurate.  The rule of thumb with interfaces is that value methods can fulfill the required interface methods for either a value or a pointer passed into the interface, but pointer methods can only fulfill the interface if a pointer is passed into the interface.  This is mostly because, if you passed in a value, it got copied when stored in the interface, so pointer methods wouldn&#39;t affect the original version you passed in, and thus aren&#39;t defined."}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 2, "last_activity_date": 1467102118, "creation_date": 1467102118, "answer_id": 38070817, "question_id": 38066966, "link": "https://stackoverflow.com/questions/38066966/panic-interface-conversionobj-is-not-objinterface-missing-method-x/38070817#38070817", "title": "panic: interface conversion:Obj is not ObjInterface: missing method X", "body": "<p>Change this line <code>test := Collection{Id: \"ya\"}</code> to this <code>test := &amp;Collection{Id: \"ya\"}</code>. The interface is implemented for type <code>*Collection</code>; not <code>Collection</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6521308, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZSTew7OIIj0/AAAAAAAAAAI/AAAAAAAAB1E/aqXBTE1n5ig/photo.jpg?sz=128", "display_name": "Lukas Kristian", "link": "https://stackoverflow.com/users/6521308/lukas-kristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1467102118, "creation_date": 1467087403, "question_id": 38066966, "link": "https://stackoverflow.com/questions/38066966/panic-interface-conversionobj-is-not-objinterface-missing-method-x", "title": "panic: interface conversion:Obj is not ObjInterface: missing method X", "body": "<p>At the moment, I'm stuck in this code : <a href=\"https://play.golang.org/p/r_HEVmpOuD\" rel=\"nofollow\">https://play.golang.org/p/r_HEVmpOuD</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype (\n    Collection struct {\n        Id string\n    }\n    CollectionInterface interface {\n        Process(...string)\n    }\n)\n\nfunc (this *Collection) Process(params ...string) {\n    this.Id = \"ok\"\n\n}\n\nfunc testfunc(input interface{}) CollectionInterface {\n    inputCol := input.(CollectionInterface)\n    inputCol.Process()\n    return inputCol\n}\n\nfunc makeInterface(input interface{}) interface{} {\n    return input\n}\n\nfunc main() {\n    test := Collection{Id: \"ya\"}\n    test.Process()\n    testInt := makeInterface(test)\n\n    test0 := testInt.(CollectionInterface)\n    test1 := testfunc(test0)\n    fmt.Println(test1)\n}\n</code></pre>\n\n<p>I'm just wondering how can I convert the interface{} into CollectionInterface without changing the \"Process\" function into a static function?</p>\n"}, {"tags": ["go", "gomail"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6520964, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PgZuTUeqDGY/AAAAAAAAAAI/AAAAAAAAZvU/YqgN2Z30GuU/photo.jpg?sz=128", "display_name": "Khazs", "link": "https://stackoverflow.com/users/6520964/khazs"}, "edited": false, "score": 0, "creation_date": 1467119912, "post_id": 38069030, "comment_id": 63591277, "body": "What means the &quot;addresses...&quot; (the 3 dots?)"}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 1, "creation_date": 1467129290, "post_id": 38069030, "comment_id": 63598297, "body": "... is a Go language construction for slice expansion:   if addresses has 3 elements  <code>mail.SetHeader(&quot;To&quot;, addresses...) </code>  will be equal to   <code>mail.SetHeader(&quot;To&quot;, addresses[0], addresses[1], addresses[2]) </code>"}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 6, "last_activity_date": 1502931320, "last_edit_date": 1502931320, "creation_date": 1467096736, "answer_id": 38069030, "question_id": 38066003, "link": "https://stackoverflow.com/questions/38066003/golang-multiple-recipients-with-gomail-v2/38069030#38069030", "title": "Golang multiple recipients with gomail.v2", "body": "<p>Give this a try?</p>\n\n<pre><code>recipients := os.Args[3:]\naddresses := make([]string, len(recipients))\nfor i, recipient := range recipients {\n    addresses[i] = mail.FormatAddress(recipient, \"\")\n}\n\nmail.SetHeader(\"To\", addresses...)\n\nif err := dialer.DialAndSend(mail); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6520964, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PgZuTUeqDGY/AAAAAAAAAAI/AAAAAAAAZvU/YqgN2Z30GuU/photo.jpg?sz=128", "display_name": "Khazs", "link": "https://stackoverflow.com/users/6520964/khazs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2648, "favorite_count": 2, "accepted_answer_id": 38069030, "answer_count": 1, "score": 6, "last_activity_date": 1502931320, "creation_date": 1467079970, "question_id": 38066003, "link": "https://stackoverflow.com/questions/38066003/golang-multiple-recipients-with-gomail-v2", "title": "Golang multiple recipients with gomail.v2", "body": "<p>The only way that I've used to send emails via gomail.v2 is using the Send() function to each email in a for loop. But I need to show the other email addresses those the same email have been sent.</p>\n\n<pre><code>for _, recipient := range os.Args[3:] {\n    mail.SetAddressHeader(\"From\", \"my@mail.com\", \"My Name\")\n    mail.SetHeader(\"To\", recipient)\n    mail.SetHeader(\"Subject\", os.Args[2])\n    mail.SetBody(\"text/html\", os.Args[1])\n\n    if err := dialer.DialAndSend(mail); err != nil {\n        log.Printf(\"Could not send email to %q: %v\", recipient, err)\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>I've found something like:</p>\n\n<pre><code>var emails bytes.Buffer\n\nmail.SetAddressHeader(\"From\", \"my@mail.com.br\", \"My Name\")\nmail.SetHeader(\"Subject\", os.Args[2])\nmail.SetBody(\"text/html\", os.Args[1])\n\nfor _, recipient := range os.Args[3:] {\n    emails.WriteString(recipient + \",\")\n}\n\nmail.SetHeader(\"To\", emails.String())\n\nif err := dialer.DialAndSend(mail); err != nil {\n    log.Printf(\"Could not send email to %q: %v\", buffer, err)\n    panic(err)\n}\n</code></pre>\n\n<p>It works by sending the email only to the first recipient in the String.\nAnd in the email manager like Gmail, Outlook or any other the other recipients addresses are showed, but not sent.</p>\n\n<p>How should I do that properly?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 43798, "user_id": 759019, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/a6ba85d48d057584ef57f1a648bb4577?s=128&d=identicon&r=PG", "display_name": "Anirudh Ramanathan", "link": "https://stackoverflow.com/users/759019/anirudh-ramanathan"}, "edited": false, "score": 5, "creation_date": 1467078202, "post_id": 38065765, "comment_id": 63570149, "body": "Please explain what you did and what you&#39;re trying to achieve. The example is unclear."}], "answers": [{"comments": [{"owner": {"reputation": 548, "user_id": 14409978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Hq5C.jpg?s=128&g=1", "display_name": "Reality", "link": "https://stackoverflow.com/users/14409978/reality"}, "edited": false, "score": 0, "creation_date": 1618172137, "post_id": 38073523, "comment_id": 118515756, "body": "It&#39;s simply <code>import &quot;html&quot;</code> for those who need to know (although it should be somewhat obvious/easily discoverable)."}], "tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 18, "last_activity_date": 1467109276, "creation_date": 1467109276, "answer_id": 38073523, "question_id": 38065765, "link": "https://stackoverflow.com/questions/38065765/how-to-escape-the-html-using-golang/38073523#38073523", "title": "How to escape the html using golang?", "body": "<p>There's EscapeString function in html package</p>\n\n<pre><code>unescaped := `&lt;script&gt;alert(123);&lt;/script&gt;`\nescaped := html.EscapeString(unescaped)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 0, "creation_date": 1580463087, "post_id": 59999890, "comment_id": 106113345, "body": "It does work perfectly fine with escaping any character, including <code>&quot;</code> and <code>&#39;</code>:  <a href=\"https://goplay.space/#aW8SePpZHRS\" rel=\"nofollow noreferrer\">goplay.space/#aW8SePpZHRS</a>"}], "tags": [], "owner": {"reputation": 65, "user_id": 7538548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7a749f97079e9ff6aaf948737ddd2f9?s=128&d=identicon&r=PG&f=1", "display_name": "Manikandan", "link": "https://stackoverflow.com/users/7538548/manikandan"}, "is_accepted": false, "score": 0, "last_activity_date": 1580457120, "creation_date": 1580457120, "answer_id": 59999890, "question_id": 38065765, "link": "https://stackoverflow.com/questions/38065765/how-to-escape-the-html-using-golang/59999890#59999890", "title": "How to escape the html using golang?", "body": "<p>Say this is an group name column there could be ' or \" in the group name right how to we escape just html and not this valid characters, in this case say Fresher's is the group name it would be Fresher[something]s the html.EscapeString() will not work</p>\n"}], "owner": {"reputation": 534, "user_id": 6112213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N48wo.jpg?s=128&g=1", "display_name": "HeadwindFly", "link": "https://stackoverflow.com/users/6112213/headwindfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9894, "favorite_count": 0, "accepted_answer_id": 38073523, "answer_count": 2, "score": 8, "last_activity_date": 1580457120, "creation_date": 1467077958, "last_edit_date": 1467089207, "question_id": 38065765, "link": "https://stackoverflow.com/questions/38065765/how-to-escape-the-html-using-golang", "title": "How to escape the html using golang?", "body": "<p>The html text following:</p>\n\n<pre><code>&amp;lt;script type=&amp;#34;text/javascript&amp;#34;&amp;gt;alert(123);&amp;lt;/script&amp;gt;\n&lt;script&gt;alert(123);&lt;/script&gt;\n</code></pre>\n\n<p>As mentioned above, only part of html text was escaped.</p>\n\n<p>Now, I want to escape the text: <strong><code>&lt;script&gt;alert(123);&lt;/script&gt;</code></strong>.</p>\n\n<p>Expected result:</p>\n\n<pre><code>&amp;lt;script type=&amp;#34;text/javascript&amp;#34;&amp;gt;alert(123);&amp;lt;/script&amp;gt;\n&amp;lt;script&amp;gt;alert(123);&amp;lt;/script&amp;gt;\n</code></pre>\n\n<p>I need some help.</p>\n"}, {"tags": ["go", "query-string"], "comments": [{"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1467063292, "post_id": 38063561, "comment_id": 63566139, "body": "I don&#39;t think I&#39;ve ever seen a search API that accepts query strings like that. Out of curiosity, can you give an example?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467063655, "post_id": 38063561, "comment_id": 63566302, "body": "I&#39;ve also never seen this &quot;common&quot; case, and I wouldn&#39;t recommend it since you&#39;re limited by reserved characters and awkward escaping. (plus this is off topic since you&#39;re explicitly asking for an external package.)"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1467063913, "post_id": 38063561, "comment_id": 63566405, "body": "ditto this is not common, i think nearly any URL lib will choke on <code>&amp;val=true&amp;amount&gt;33</code>, I have only ever seen <code>?k=v&amp;k=v...</code>"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467068342, "post_id": 38063561, "comment_id": 63567839, "body": "@JimB it seems you are right.. I just assumed is it common. Any idea what&#39;s  the &quot;best practice&quot; to express operators  though query strings?I have arbitrary data that I need to filter (i.e. like on a SQL query WHERE x &gt; y &amp; z &lt; 29...)"}, {"owner": {"reputation": 1982, "user_id": 2872479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ez7og.jpg?s=128&g=1", "display_name": "metame", "link": "https://stackoverflow.com/users/2872479/metame"}, "edited": false, "score": 0, "creation_date": 1467076778, "post_id": 38063561, "comment_id": 63569860, "body": "You would need to parameterize operator logic like <code>&amp;val=true&amp;minAmount=33</code>"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 1982, "user_id": 2872479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ez7og.jpg?s=128&g=1", "display_name": "metame", "link": "https://stackoverflow.com/users/2872479/metame"}, "edited": false, "score": 0, "creation_date": 1467164594, "post_id": 38063561, "comment_id": 63613942, "body": "@metame I ended-up using the operator itself (&lt;&gt;=) with a patch on url.ParseQuery. Let me know if you see any harm in that."}], "answers": [{"tags": [], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "is_accepted": true, "score": 2, "last_activity_date": 1467164418, "last_edit_date": 1467164418, "creation_date": 1467076435, "answer_id": 38065565, "question_id": 38063561, "link": "https://stackoverflow.com/questions/38063561/query-string-operator/38065565#38065565", "title": "Query string operator", "body": "<p>It seems the use case is not as common as I thought. I implemented a custom \"parser\". Hopefully this doesn't violate any RFC. Any patch is welcome!</p>\n\n<pre><code>package query\n\nimport(\n    \"net/url\"\n    \"strings\"\n)\n\n\n//ParseQueryOp parses the URL-encoded query string and returns a map \n// listing the values specified for each key. ParseQueryOp always returns \n// a non-nil map containing all the valid query parameters found;\n// err describes the first decoding error encountered, if any.\n// If the query has operators (e.g. &amp;amount&gt;300) it is Add-ed in the map\n// with a prefixed key ( {{prefix}}key ).\n/*\n e.g. for a query &amp;Amount&gt;300 the operator(\"&gt;\") is returnd\n    s := \"query &amp;Amount&gt;300\"\n    q, _ := ParseQueryOp(s, \"_op_\")\n    print(q.Get(\"_op_Amount\")) // prints `&gt;`\n    print(q.Get(\"Amount\")) // prints 300\n*/\nfunc ParseQueryOp(query, prefix string) (m url.Values, err error){\n    m = make(url.Values)\n\n    for query != \"\" {\n        var opKey string\n        key := query\n        if i := strings.IndexAny(key, \"&amp;;\"); i &gt;= 0 {\n            key, query = key[:i], key[i+1:]\n        } else {\n            query = \"\"\n        }\n        if key == \"\" {\n            continue\n        }\n        value := \"\"\n        var err1 error\n        if i := strings.Index(key, \"&gt;=\"); i &gt;= 0{\n            key, value = key[:i], key[i+2:]\n            opKey = prefix + key \n            opKey, err1 = url.QueryUnescape(opKey)\n            if err1 != nil {\n                if err == nil {\n                    err = err1\n                }\n                continue\n            }\n            m[opKey] = append(m[opKey], \"&gt;=\")\n        }else if i = strings.Index(key, \"&lt;=\"); i &gt;= 0{\n            key, value = key[:i], key[i+2:]\n            opKey = prefix + key \n            opKey, err1 = url.QueryUnescape(opKey)\n            if err1 != nil {\n                if err == nil {\n                    err = err1\n                }\n                continue\n            }\n            m[opKey] = append(m[opKey], \"&lt;=\")\n        }else if i = strings.Index(key, \"=\");  i &gt;= 0{\n            key, value = key[:i], key[i+1:]\n        }else if i = strings.Index(key, \"&gt;\");  i &gt;= 0{\n            key, value = key[:i], key[i+1:]\n            opKey = prefix + key \n            opKey, err1 = url.QueryUnescape(opKey)\n            if err1 != nil {\n                if err == nil {\n                    err = err1\n                }\n                continue\n            }\n            m[opKey] = append(m[opKey], \"&gt;\")\n        }else if i = strings.Index(key, \"&lt;\"); i &gt;= 0{\n            key, value = key[:i], key[i+1:]\n            opKey = prefix + key \n            opKey, err1 = url.QueryUnescape(opKey)\n            if err1 != nil {\n                if err == nil {\n                    err = err1\n                }\n                continue\n            }\n            m[opKey] = append(m[opKey], \"&lt;\")\n        }\n\n        key, err1 = url.QueryUnescape(key)\n        if err1 != nil {\n            if err == nil {\n                err = err1\n            }\n            continue\n        }\n        value, err1 = url.QueryUnescape(value)\n        if err1 != nil {\n            if err == nil {\n                err = err1\n            }\n            continue\n        }\n        m[key] = append(m[key], value)\n    }\n    return m, err\n}\n</code></pre>\n\n<p>And some tests</p>\n\n<pre><code>package query\n\n\nimport(\n    \"testing\"\n    \"net/url\"\n)\n\n\ntype parseTest struct {\n    query string\n    out   url.Values\n}\n\n\nvar parseTests = []parseTest{\n    {\n        query: \"a=1&amp;b=2\",\n        out:   url.Values{\"a\": []string{\"1\"}, \"b\": []string{\"2\"}},\n    },\n    {\n        query: \"a=1&amp;a=2&amp;a=banana\",\n        out:   url.Values{\"a\": []string{\"1\", \"2\", \"banana\"}},\n    },\n    {\n        query: \"ascii=%3Ckey%3A+0x90%3E\",\n        out:   url.Values{\"ascii\": []string{\"&lt;key: 0x90&gt;\"}},\n    },\n    {\n        query: \"a=1;b=2\",\n        out:   url.Values{\"a\": []string{\"1\"}, \"b\": []string{\"2\"}},\n    },\n    {\n        query: \"a=1&amp;a=2;a=banana\",\n        out:   url.Values{\"a\": []string{\"1\", \"2\", \"banana\"}},\n    },\n    {\n        query: \"a=1&amp;b&gt;2\",\n        out:   url.Values{\"a\": []string{\"1\"}, \"_op_b\": []string{\"&gt;\"}, \"b\": []string{\"2\"}},\n    },\n    {\n        query: \"a=1&amp;b&lt;2\",\n        out:   url.Values{\"a\": []string{\"1\"}, \"_op_b\": []string{\"&lt;\"}, \"b\": []string{\"2\"}},\n    },\n    {\n        query: \"a=1&amp;b&gt;=2\",\n        out:   url.Values{\"a\": []string{\"1\"}, \"_op_b\": []string{\"&gt;=\"}, \"b\": []string{\"2\"}},\n    },\n    {\n        query: \"a=1&amp;b&lt;=2\",\n        out:   url.Values{\"a\": []string{\"1\"}, \"_op_b\": []string{\"&lt;=\"}, \"b\": []string{\"2\"}},\n    },\n}\n\nfunc TestParseQueryOut(t *testing.T) {\n    for i, test := range parseTests {\n        form, err := ParseQueryOp(test.query, \"_op_\")\n        if err != nil {\n            t.Errorf(\"test %d: Unexpected error: %v\", i, err)\n            continue\n        }\n        if len(form) != len(test.out) {\n            t.Errorf(\"test %d: len(form) = %d, want %d\", i, len(form), len(test.out))\n        }\n        for k, evs := range test.out {\n            vs, ok := form[k]\n            if !ok {\n                t.Errorf(\"test %d: Missing key %q\", i, k)\n                continue\n            }\n            if len(vs) != len(evs) {\n                t.Errorf(\"test %d: len(form[%q]) = %d, want %d\", i, k, len(vs), len(evs))\n                continue\n            }\n            for j, ev := range evs {\n                if v := vs[j]; v != ev {\n                    t.Errorf(\"test %d: form[%q][%d] = %q, want %q\", i, k, j, v, ev)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "accepted_answer_id": 38065565, "answer_count": 1, "score": 0, "last_activity_date": 1467164418, "creation_date": 1467062979, "question_id": 38063561, "link": "https://stackoverflow.com/questions/38063561/query-string-operator", "title": "Query string operator", "body": "<p>I'm developing an API which requires operators as filters on values. E.g. <code>&amp;val=true&amp;Amount&gt;33\"</code>. I think the internal representation would be map[string]struct{Operator string, Val []string} but it doesn't seem supported by the standard library.</p>\n\n<p>Is there any external package with support for such queries? It's a common use case(e.g. for a search API) so I'm surprised I couldn't find anything on godoc.</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1467062638, "post_id": 38063179, "comment_id": 63565852, "body": "I think you can implement your own Unmarshal method on MixedVars but i&#39;m not sure. Also check this out, from the soruce of encoding/xml: <i>If the struct has a field of type []byte or string with tag &quot;,innerxml&quot;, Unmarshal accumulates the raw XML nested inside the element in that field.</i> Might help"}, {"owner": {"reputation": 244, "user_id": 1575431, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f7058a49c1dc4696e4ec48fc5f8ce4f?s=128&d=identicon&r=PG", "display_name": "MattLock", "link": "https://stackoverflow.com/users/1575431/mattlock"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1467125862, "post_id": 38063179, "comment_id": 63595843, "body": "@plato I&#39;ve tried using innerxml but I&#39;m still running into a similar situation"}], "answers": [{"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 3, "last_activity_date": 1467155535, "creation_date": 1467155535, "answer_id": 38087733, "question_id": 38063179, "link": "https://stackoverflow.com/questions/38063179/xml-parsing-golang/38087733#38087733", "title": "XML Parsing Golang", "body": "<p>It's possible to unmarshal the source xml node into both the raw xml and a slice of variables at once, eg:</p>\n\n<pre><code>type TransUnit struct {\n    ID     string `xml:\"id,attr\"`\n    Source Source `xml:\"source\"`\n    Target string `xml:\"target\"`\n}\n\ntype Source struct {\n    Raw  string `xml:\",innerxml\"`\n    Text string `xml:\",chardata\"`\n    Vars []Var  `xml:\"ph\"`\n}\n\ntype Var struct {\n    ID    string `xml:\"id,attr\"`\n    Value string `xml:\",innerxml\"`\n}\n</code></pre>\n\n<p>See a <a href=\"https://play.golang.org/p/7I1bxgxCCO\" rel=\"nofollow\">running example</a>. You should be good to go from there.</p>\n"}], "owner": {"reputation": 244, "user_id": 1575431, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f7058a49c1dc4696e4ec48fc5f8ce4f?s=128&d=identicon&r=PG", "display_name": "MattLock", "link": "https://stackoverflow.com/users/1575431/mattlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1252, "favorite_count": 0, "accepted_answer_id": 38087733, "answer_count": 1, "score": 3, "last_activity_date": 1467155535, "creation_date": 1467061309, "last_edit_date": 1467125810, "question_id": 38063179, "link": "https://stackoverflow.com/questions/38063179/xml-parsing-golang", "title": "XML Parsing Golang", "body": "<p>Scenario:\nI have an XML structure I'm trying to parse, I don't know how to set up a struct where the value of an xml attribute contains text and more nested values. All other attributes have been set properly, I'm not sure if I'll need to get the value of the source and create a separate parser to retrieve the values of the  elements.</p>\n\n<pre><code>&lt;trans-unit id=\"some.message\"&gt;\n    &lt;source&gt;hello %&lt;ph id=\"first_name\"&gt;{0}&lt;/ph&gt; %&lt;ph id=\"last_name\"&gt;{1}&lt;/ph&gt;\n    &lt;/source&gt;\n    &lt;target/&gt;\n&lt;/trans-unit&gt;\n\ntype TransUnit struct {\n  Id string `xml:\"id,attr\"`\n  Source string `xml:\"source\"`\n  SourceVars MixedVars `xml:\"source&gt;ph\"`\n  Target string `xml:\"target\"`\n}\n\ntype MixedVars []MixedVar\n\ntype MixedVar struct {\n  VarName string `xml:\"id,attr\"`\n}\n</code></pre>\n\n<p><strong>EDIT:</strong> \nI'm trying to parse the source into a string that follows the form:\nhello %{first_name} %{last_name}</p>\n\n<p>Unmarshalling the xml string with the current structs returns a an empty struct</p>\n\n<p>@plato using innerxml sets the source to:</p>\n\n<pre><code>&lt;source&gt;Are you sure you want to reset the reservation for %&lt;ph id=\"first_name\"&gt;{0}&lt;/ph&gt; %&lt;ph id=\"last_name\"&gt;{1}&lt;/ph&gt;\n</code></pre>\n\n<h2>    </h2>\n\n<p>This puts me in a similar situation where I still have nested xml tags interpolated within the source value</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1467050052, "post_id": 38060207, "comment_id": 63559337, "body": "If you want to use the default go tools, don&#39;t try to work around GOPATH. Otherwise you might be interested in <a href=\"https://getgb.io/\" rel=\"nofollow noreferrer\">getgb.io</a>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 3, "creation_date": 1467050158, "post_id": 38060207, "comment_id": 63559393, "body": "Vendoring is not supported outside of the <code>$GOPATH</code>: <a href=\"https://github.com/golang/go/issues/12511\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/12511</a>"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1467052713, "post_id": 38060207, "comment_id": 63560811, "body": "put it in your gopath and symlink <code>ln -s $GOPATH&#47;src&#47;github.com&#47;lanti&#47;project ~&#47;dev&#47;project</code>"}, {"owner": {"reputation": 1951, "user_id": 1442219, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6398031dc321aa3c975436e11d752f6b?s=128&d=identicon&r=PG", "display_name": "Lanti", "link": "https://stackoverflow.com/users/1442219/lanti"}, "edited": false, "score": 0, "creation_date": 1467052787, "post_id": 38060207, "comment_id": 63560859, "body": "This is not work in Windows environments."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1467053019, "post_id": 38060207, "comment_id": 63560976, "body": "@lanti can you use git-bash or similar to make it work?"}, {"owner": {"reputation": 1951, "user_id": 1442219, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6398031dc321aa3c975436e11d752f6b?s=128&d=identicon&r=PG", "display_name": "Lanti", "link": "https://stackoverflow.com/users/1442219/lanti"}, "edited": false, "score": 0, "creation_date": 1467053159, "post_id": 38060207, "comment_id": 63561062, "body": "I try to work with <code>gb</code> package manager now. It&#39;s a little bit buggy in windows, but in theory this is the nearest thing what I want."}, {"owner": {"reputation": 1951, "user_id": 1442219, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6398031dc321aa3c975436e11d752f6b?s=128&d=identicon&r=PG", "display_name": "Lanti", "link": "https://stackoverflow.com/users/1442219/lanti"}, "edited": false, "score": 0, "creation_date": 1467066410, "post_id": 38060207, "comment_id": 63567264, "body": "This is probably more closest to <code>npm</code> than <code>gb</code>: <a href=\"https://github.com/skelterjohn/wgo\" rel=\"nofollow noreferrer\">github.com/skelterjohn/wgo</a>"}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 2174835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2d39933bc970e561398e43748e98921?s=128&d=identicon&r=PG", "display_name": "user2174835", "link": "https://stackoverflow.com/users/2174835/user2174835"}, "is_accepted": true, "score": 3, "last_activity_date": 1526314731, "creation_date": 1526314731, "answer_id": 50334861, "question_id": 38060207, "link": "https://stackoverflow.com/questions/38060207/go-vendoring-outside-gopath/50334861#50334861", "title": "Go vendoring outside $GOPATH", "body": "<p>Not possible with the current go tooling, but looks like we might get it in go 1.12 or bit later.</p>\n\n<p>Proposal accepted:</p>\n\n<p><a href=\"https://github.com/golang/go/issues/17271\" rel=\"nofollow noreferrer\">cmd/go: modify the Go toolchain to work without GOPATH</a></p>\n"}], "owner": {"reputation": 1951, "user_id": 1442219, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6398031dc321aa3c975436e11d752f6b?s=128&d=identicon&r=PG", "display_name": "Lanti", "link": "https://stackoverflow.com/users/1442219/lanti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2689, "favorite_count": 0, "accepted_answer_id": 50334861, "answer_count": 1, "score": 3, "last_activity_date": 1526314731, "creation_date": 1467049855, "last_edit_date": 1467050206, "question_id": 38060207, "link": "https://stackoverflow.com/questions/38060207/go-vendoring-outside-gopath", "title": "Go vendoring outside $GOPATH", "body": "<p>I have a project which is built in Node.js/Express.js. I want to start to rewrite this to go/iris framework. I don't want to re-factor everything into my $GOPATH and I want to keep it together my express / go / docker files for this project.</p>\n\n<p>I tried to clone iris framework's git repo into a <code>./vendor</code> subfolder, but using <code>import \"github.com/kataras/iris\"</code> importing nothing.</p>\n\n<p>Is there a package manager which is</p>\n\n<ul>\n<li><p>copying and installing packages and all of it's dependencies in <code>my-project/vendor</code> folder <strong>outside $GOPATH</strong></p></li>\n<li><p>it can update these import packages</p></li>\n<li><p><code>go run/build/install</code> outside $GOPATH</p></li>\n<li><p>there's now any new files in $GOPATH <code>src/pkg/bin</code> folder when I working on a project, except this package manager</p></li>\n<li><p>I can define dependency packages for a project like <code>package.json</code> file for <code>node.js</code></p></li>\n</ul>\n\n<p>Is there a go package manager like that?</p>\n\n<p>Edit:</p>\n\n<p>Running this with <code>go</code> command is not required.</p>\n"}, {"tags": ["file", "go", "directory"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467055743, "post_id": 38060049, "comment_id": 63562465, "body": "@JonnyReeves, you might also consult the <code>stat(2)</code> manual page of your system (if it&#39;s not WIndows) to see the <code>stat_t</code> structure filled by the corresponding system calls does indeed not contain the file&#39;s name."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1467059688, "last_edit_date": 1467059688, "creation_date": 1467049287, "answer_id": 38060049, "question_id": 38059627, "link": "https://stackoverflow.com/questions/38059627/case-sensitive-os-stat/38060049#38060049", "title": "Case Sensitive `os.Stat`", "body": "<p>When you stat a file, the name returned in the info is the one you provided, as neither the <code>stat_t</code> nor <code>Win32FileAttributeData</code> data structures contain a name (in POSIX a file itself doesn't really have a name, it's just an inode named via 1 or more hardlinks) The actual name of the file on disk is stored in the parent directory. You will need to iterate through the directory entries to find the name as it's stored on disk. </p>\n\n<p>You can either open the directory file directly and call <a href=\"https://golang.org/pkg/os/#File.Readdir\" rel=\"nofollow\"><code>File.ReadDir</code></a>, or use the <a href=\"https://golang.org/pkg/io/ioutil/#ReadDir\" rel=\"nofollow\"><code>ioutil.ReadDir</code></a> convenience function. </p>\n"}], "owner": {"reputation": 5909, "user_id": 227349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/654f2b65b6dacd6702aa8f839e25c955?s=128&d=identicon&r=PG", "display_name": "JonnyReeves", "link": "https://stackoverflow.com/users/227349/jonnyreeves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 38060049, "answer_count": 1, "score": 3, "last_activity_date": 1467059688, "creation_date": 1467047638, "last_edit_date": 1467053524, "question_id": 38059627, "link": "https://stackoverflow.com/questions/38059627/case-sensitive-os-stat", "title": "Case Sensitive `os.Stat`", "body": "<p>I am writing a linting tool; one of the rules enforces that all linked files have lowercase filenames <em>on disk</em>, ie:</p>\n\n<ul>\n<li><code>some/asset.png</code> == OK</li>\n<li><code>another/asset.PNG</code> == Fail</li>\n</ul>\n\n<p>I was hoping to validate this rule with the following code:</p>\n\n<pre><code>f, err := os.Stat(\"another/asset.png\")\nactualName := f.Name()\n</code></pre>\n\n<p>However the retun value of <code>f.Name()</code> always reflects the value passed to <code>os.Stat()</code>, eg: passing <code>os.Stat(\"foo.BAR\")</code> will yield <code>foo.BAR</code> even if the file is named <code>foo.BaR</code> on disk.</p>\n\n<p>Am I just approaching this problem wrong?  Is there another way to get the <em>actual</em>, case-sensitive filename on disk for a given filepath?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "synchronization"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467053305, "post_id": 38060090, "comment_id": 63561137, "body": "I would get rid of the fake race example, since it neither applies to the go implementation of maps nor strings, and is kind of confusing. You also have <code>o</code> and <code>m</code> mixed up in the first examples, along with referencing the Mutex methods as an embedded field, but defining it as <code>mutex</code>."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467058416, "post_id": 38060090, "comment_id": 63563938, "body": "Corrected per recommendation."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 9, "last_activity_date": 1467126532, "last_edit_date": 1467126532, "creation_date": 1467049472, "answer_id": 38060090, "question_id": 38059618, "link": "https://stackoverflow.com/questions/38059618/go-goroutine-lock-and-unlock/38060090#38060090", "title": "Go goroutine lock and unlock", "body": "<p>You're diving into the world of race conditions.  The basic rule of thumb is that if <em>ANY</em> routine writes to or changes a piece of data that can be or is read by (or also written to) by any number of other coroutines/threads, you need to have some sort of synchronization system in place.</p>\n\n<p>For example, lets say you have that map.  It has [\"Joe\"] = \"Smith\" and [\"Sean\"] = \"Howard\" in it.  One goroutine wants to read the value of [\"Joe\"].  Another routine is updating [\"Joe\"] to \"Cooper\".  Which value does the first goroutine read?  Depends on which goroutine gets to the data first.  That's the race condition, the behavior is undefined and unpredictable.</p>\n\n<p>The easiest method to control that access is with a <code>sync.Mutex</code>.  In your case, since some routines only need to read and not write, you can instead use a <code>sync.RWMutex</code> (main difference is that a <code>RWMutex</code> allows any number of threads to read, as long as none are trying to write).  You would bake this into the map using a structure like this:</p>\n\n<pre><code>type MutexMap struct {\n    m map[string]string\n    *sync.RWMutex\n}\n</code></pre>\n\n<p>Then, in routines that need to read from the map, you would do:</p>\n\n<pre><code>func ReadSomething(o MutexMap, key string) string {\n    o.RLock() // lock for reading, blocks until the Mutex is ready\n    defer o.RUnlock() // make SURE you do this, else it will be locked permanently\n    return o.m[key]\n}\n</code></pre>\n\n<p>And to write:</p>\n\n<pre><code>func WriteSomething(o MutexMap, key, value string) {\n    o.Lock() // lock for writing, blocks until the Mutex is ready\n    defer o.Unlock() // again, make SURE you do this, else it will be locked permanently\n    o.m[key] = value\n}\n</code></pre>\n\n<p>Note that both of these could be written as methods of the struct, rather than functions, if desired.</p>\n\n<hr>\n\n<p>You can also approach this using channels.  You make a controller structure that runs in a goroutine, and you make requests to it over channels.  Example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype MapCtrl struct {\n    m       map[string]string\n    ReadCh  chan chan map[string]string\n    WriteCh chan map[string]string\n    QuitCh  chan struct{}\n}\n\nfunc NewMapController() *MapCtrl {\n    return &amp;MapCtrl{\n        m:       make(map[string]string),\n        ReadCh:  make(chan chan map[string]string),\n        WriteCh: make(chan map[string]string),\n        QuitCh:  make(chan struct{}),\n    }\n}\n\nfunc (ctrl *MapCtrl) Control() {\n    for {\n        select {\n        case r := &lt;-ctrl.ReadCh:\n            fmt.Println(\"Read request received\")\n            retmap := make(map[string]string)\n            for k, v := range ctrl.m { // copy map, so it doesn't change in place after return\n                retmap[k] = v\n            }\n            r &lt;- retmap\n        case w := &lt;-ctrl.WriteCh:\n            fmt.Println(\"Write request received with\", w)\n            for k, v := range w {\n                ctrl.m[k] = v\n            }\n        case &lt;-ctrl.QuitCh:\n            fmt.Println(\"Quit request received\")\n            return\n        }\n    }\n}\n\nfunc main() {\n    ctrl := NewMapController()\n    defer close(ctrl.QuitCh)\n    go ctrl.Control()\n\n    m := make(map[string]string)\n    m[\"Joe\"] = \"Smith\"\n    m[\"Sean\"] = \"Howard\"\n    ctrl.WriteCh &lt;- m\n\n    r := make(chan map[string]string, 1)\n    ctrl.ReadCh &lt;- r\n    fmt.Println(&lt;-r)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Cpwfox8iZy\" rel=\"nofollow\">Runnable version</a></p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3117, "favorite_count": 2, "accepted_answer_id": 38060090, "answer_count": 1, "score": 1, "last_activity_date": 1467126532, "creation_date": 1467047595, "last_edit_date": 1467048049, "question_id": 38059618, "link": "https://stackoverflow.com/questions/38059618/go-goroutine-lock-and-unlock", "title": "Go goroutine lock and unlock", "body": "<p>I been reading about goroutines and the sync package and my question is... Do I always need to lock unlock when reading writting to data on different goroutines?</p>\n\n<p>For example I have a variable on my server</p>\n\n<pre><code>config := make(map[string]string)\n</code></pre>\n\n<p>Then on different goroutines I want to read from config. Is it safe to read without using sync or it is not?</p>\n\n<p>I guess writting needs to be done using the sync package. but I am not sure about reading</p>\n\n<p>For example I have a simple in-memory cache system</p>\n\n<pre><code>type Cache interface {\n    Get(key string) interface{}\n    Put(key string, expires int64, value interface{})\n}\n\n// MemoryCache represents a memory type of cache\ntype MemoryCache struct {\n    c map[string]*MemoryCacheValue\n    rw sync.RWMutex\n}\n\n// MemoryCacheValue represents a memory cache value\ntype MemoryCacheValue struct {\n    value interface{}\n    expires int64\n}\n\n// NewMemoryCache creates a new memory cache\nfunc NewMemoryCache() Cache {\n    return &amp;MemoryCache{\n        c: make(map[string]*MemoryCacheValue),\n    }\n}\n\n// Get stores something into the cache\nfunc (m *MemoryCache) Get(key string) interface{} {\n    if v, ok := m.c[key]; ok {\n        return v\n    }\n    return nil\n}\n\n// Put retrieves something from the cache\nfunc (m *MemoryCache) Put(key string, expires int64, value interface{}) {\n    m.rw.Lock()\n    m.c[key] = &amp;MemoryCacheValue{\n        value,\n        time.Now().Unix() + expires,\n    }\n    m.rw.Unlock()\n}\n</code></pre>\n\n<p>I am acting safe here or I still need to lock unlock when I want to only read?</p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1467043865, "post_id": 38058320, "comment_id": 63555934, "body": "You don&#39;t seem to have any synchronization here."}, {"owner": {"reputation": 2800, "user_id": 878244, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f31ec619b91d3fb589c67ef04e13beaa?s=128&d=identicon&r=PG", "display_name": "Yehonatan", "link": "https://stackoverflow.com/users/878244/yehonatan"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1467044187, "post_id": 38058320, "comment_id": 63556156, "body": "@user2357112 You mean that c.Block, c.Block, c.Decrease might happen?"}], "answers": [{"comments": [{"owner": {"reputation": 296, "user_id": 755976, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VrGFZDwASP4/AAAAAAAAAAI/AAAAAAAAAo4/AEy1OTlapvM/photo.jpg?sz=128", "display_name": "9nut", "link": "https://stackoverflow.com/users/755976/9nut"}, "edited": false, "score": 1, "creation_date": 1467094706, "post_id": 38058704, "comment_id": 63574844, "body": "There is also a race condition on access to c.active. The <code>sync</code> package provides a <code>Cond</code> type that can help here.  Here&#39;s <a href=\"https://play.golang.org/p/UcREvPkaff\" rel=\"nofollow noreferrer\">a version</a> of the above code modified to use <code>sync.Cond</code>."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 7, "last_activity_date": 1467058524, "last_edit_date": 1495535361, "creation_date": 1467044080, "answer_id": 38058704, "question_id": 38058320, "link": "https://stackoverflow.com/questions/38058320/goroutine-only-works-when-fmt-println-is-executed/38058704#38058704", "title": "Goroutine only works when fmt.Println is executed", "body": "<p>You're not giving <code>c.Decrease()</code> a chance to run.  <code>c.Block()</code> runs an infinite for loop, but it never blocks in that for loop, just calling <code>continue</code> over and over on every iteration.  The main thread spins at 100% usage endlessly.</p>\n\n<p>However, when you add an <code>fmt.Print()</code> call, that makes a syscall, which allows the other goroutine to run.</p>\n\n<p><a href=\"https://stackoverflow.com/a/10096686/4551301\">This post</a> has details on how exactly goroutines yield or are pre-empted.  Note, however, that it's slightly out of date, as entering a function now has a random chance to yield that thread to another goroutine, to prevent similar style flooding of threads.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 6141723, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207772970035894/picture?type=large", "display_name": "M F&#233;lix Hertz", "link": "https://stackoverflow.com/users/6141723/m-f%c3%a9lix-hertz"}, "is_accepted": false, "score": 1, "last_activity_date": 1467051056, "creation_date": 1467051056, "answer_id": 38060504, "question_id": 38058320, "link": "https://stackoverflow.com/questions/38058320/goroutine-only-works-when-fmt-println-is-executed/38060504#38060504", "title": "Goroutine only works when fmt.Println is executed", "body": "<p>As others have pointed out, Block() will never yield; a goroutine is not a thread. You could use Gosched() in the runtime package to force a yield -- but note that spinning this way in Block() is a pretty terrible idea.</p>\n\n<p>There are much better ways to do concurrency limiting. See <a href=\"http://jmoiron.net/blog/limiting-concurrency-in-go/\" rel=\"nofollow\">http://jmoiron.net/blog/limiting-concurrency-in-go/</a> for one example</p>\n"}, {"tags": [], "owner": {"reputation": 82600, "user_id": 496445, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/db00d7b4388686c6d280e8f0578c7e39?s=128&d=identicon&r=PG", "display_name": "jdi", "link": "https://stackoverflow.com/users/496445/jdi"}, "is_accepted": false, "score": 1, "last_activity_date": 1467057221, "creation_date": 1467057221, "answer_id": 38062184, "question_id": 38058320, "link": "https://stackoverflow.com/questions/38058320/goroutine-only-works-when-fmt-println-is-executed/38062184#38062184", "title": "Goroutine only works when fmt.Println is executed", "body": "<p>What you are looking for is called a semaphore. You can apply this pattern using channels</p>\n\n<p><a href=\"http://www.golangpatterns.info/concurrency/semaphores\" rel=\"nofollow\">http://www.golangpatterns.info/concurrency/semaphores</a></p>\n\n<p>The idea is that you create a buffered channel of a desired length. Then you make callers acquire the resource by putting a value into the channel and reading it back out when they want to free the resource. Doing so creates proper synchronization points in your program so that the Go scheduler runs correctly. </p>\n\n<p>What you are doing now is spinning the cpu and blocking the Go scheduler. It depends on how many cpus you have available, the version of Go, and the value of GOMAXPROCS. Given the right combination, there may not be another available thread to service other goroutines while you infinitely spin that particular thread. </p>\n"}, {"comments": [{"owner": {"reputation": 2800, "user_id": 878244, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f31ec619b91d3fb589c67ef04e13beaa?s=128&d=identicon&r=PG", "display_name": "Yehonatan", "link": "https://stackoverflow.com/users/878244/yehonatan"}, "edited": false, "score": 0, "creation_date": 1467199107, "post_id": 38071284, "comment_id": 63630250, "body": "Thank you. Could you please explain what you&#39;ve done here?"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 2800, "user_id": 878244, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f31ec619b91d3fb589c67ef04e13beaa?s=128&d=identicon&r=PG", "display_name": "Yehonatan", "link": "https://stackoverflow.com/users/878244/yehonatan"}, "edited": false, "score": 0, "creation_date": 1467201659, "post_id": 38071284, "comment_id": 63632109, "body": "@Yehonatan An explanation of <code>sync.Cond</code> and how it works, added. I hope you find it useful!"}, {"owner": {"reputation": 2800, "user_id": 878244, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f31ec619b91d3fb589c67ef04e13beaa?s=128&d=identicon&r=PG", "display_name": "Yehonatan", "link": "https://stackoverflow.com/users/878244/yehonatan"}, "edited": false, "score": 1, "creation_date": 1467307350, "post_id": 38071284, "comment_id": 63690390, "body": "Really appreciated!  Thanks a lot!"}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 1, "last_activity_date": 1467201488, "last_edit_date": 1467201488, "creation_date": 1467103533, "answer_id": 38071284, "question_id": 38058320, "link": "https://stackoverflow.com/questions/38058320/goroutine-only-works-when-fmt-println-is-executed/38071284#38071284", "title": "Goroutine only works when fmt.Println is executed", "body": "<p>While other answers pretty much covered the reason (not giving a chance for the goroutine to run) - and I'm not sure what you intend to achieve here - you are mutating a value concurrently without proper synchronization. A rewrite of above code with synchronization considered; would be:</p>\n\n<pre><code>type ConcurrencyLimit struct {\n    active int\n    Limit  int\n    cond   *sync.Cond\n}\n\nfunc (c *ConcurrencyLimit) Block() {\n    c.cond.L.Lock()\n    for c.active == c.Limit {\n        c.cond.Wait()\n    }\n    c.active++\n    c.cond.L.Unlock()\n\n    c.cond.Signal()\n}\n\nfunc (c *ConcurrencyLimit) Decrease() int {\n    defer c.cond.Signal()\n\n    c.cond.L.Lock()\n    defer c.cond.L.Unlock()\n\n    fmt.Println(\"decrease\")\n    if c.active &gt; 0 {\n        c.active--\n    }\n    return c.active\n}\n\nfunc main() {\n    c := ConcurrencyLimit{\n        Limit: 1,\n        cond:  &amp;sync.Cond{L: &amp;sync.Mutex{}},\n    }\n\n    c.Block()\n    go func() {\n        c.Decrease()\n    }()\n    c.Block()\n    fmt.Println(c.active, c.Limit)\n}\n</code></pre>\n\n<p><code>sync.Cond</code> is a synchronization utility designed for times that you want to check if a condition is met, concurrently; while other workers are mutating the data of the condition.</p>\n\n<p>The <code>Lock</code> and <code>Unlock</code> functions work as we expect from a lock. When we are done with checking or mutating, we can call <code>Signal</code> to awake one goroutine (or call <code>Broadcast</code> to awake more than one), so the goroutine knows that is free to act upon the data (or check a condition).</p>\n\n<p>The only part that may seem unusual is the <code>Wait</code> function. It is actually very simple. It is like calling <code>Unlock</code> and instantly call <code>Lock</code> again - with the exception that <code>Wait</code> would not try to lock again, unless triggered by <code>Signal</code> (or <code>Broadcast</code>) in other goroutines; like the workers that are mutating the data (of the condition).</p>\n"}], "owner": {"reputation": 2800, "user_id": 878244, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f31ec619b91d3fb589c67ef04e13beaa?s=128&d=identicon&r=PG", "display_name": "Yehonatan", "link": "https://stackoverflow.com/users/878244/yehonatan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 38058704, "answer_count": 4, "score": 1, "last_activity_date": 1467307597, "creation_date": 1467042794, "last_edit_date": 1495542400, "question_id": 38058320, "link": "https://stackoverflow.com/questions/38058320/goroutine-only-works-when-fmt-println-is-executed", "title": "Goroutine only works when fmt.Println is executed", "body": "<p>For some reason, when I remove the <code>fmt.Println</code>s then the code is blocking.\nI've got no idea why it happens. All I want to do is to implement a simple concurrency limiter...</p>\n\n<p>I've never experienced such a weird thing. It's like that <code>fmt</code> flushes the variables or something and makes it work.</p>\n\n<p>Also, when I use a regular function instead of a goroutine then it works too.</p>\n\n<p>Here's the following code - </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype ConcurrencyLimit struct {\n    active int\n    Limit  int\n}\n\nfunc (c *ConcurrencyLimit) Block() {\n    for {\n        fmt.Println(c.active, c.Limit)\n        // If should block\n        if c.active == c.Limit {\n            continue\n        }\n        c.active++\n        break\n    }\n}\n\nfunc (c *ConcurrencyLimit) Decrease() int {\n    fmt.Println(\"decrease\")\n    if c.active &gt; 0 {\n        c.active--\n    }\n    return c.active\n}\n\nfunc main() {\n    c := ConcurrencyLimit{Limit: 1}\n    c.Block()\n    go func() {\n        c.Decrease()\n    }()\n    c.Block()\n}\n</code></pre>\n\n<p>Clarification: Even though I've accepted @kaedys 's answer(<a href=\"https://stackoverflow.com/a/38058704/878244\">here</a>) a solution was answered by @Kaveh Shahbazian (<a href=\"https://stackoverflow.com/a/38071284/878244\">here</a>)</p>\n"}, {"tags": ["go", "build"], "answers": [{"tags": [], "owner": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "is_accepted": true, "score": 0, "last_activity_date": 1520947247, "creation_date": 1520947247, "answer_id": 49257292, "question_id": 38056712, "link": "https://stackoverflow.com/questions/38056712/is-it-possible-to-compile-test-binary-using-go-install-instead-of-go-test-c/49257292#49257292", "title": "Is it possible to compile test binary using `go install` instead of `go test -c`", "body": "<h2>Before go 1.10</h2>\n\n<p>For go &lt; 1.10, the <code>go build</code> doesn't store the package compiled object files. The <code>go install</code> does. One solution is to call <code>go install</code> in the right package. It will go through all package dependencies, compile them if the timestamp of the file in the dependency package changed, store the object file and then link them all. \nExample: </p>\n\n<pre><code>GOBIN=\"my project build directory\" go install ./cmd/mycmd\n</code></pre>\n\n<p>Another solution is to use <code>-i</code> flag, which is supported by <code>build</code> and <code>test</code> commands.</p>\n\n<h2>After go 1.10</h2>\n\n<p>go 1.10 adds new flag to <code>go build</code> which does the \"smart\" caching. </p>\n\n<blockquote>\n  <p>The go build command now detects out-of-date packages purely based on the content of source files, specified build flags, and metadata stored in the compiled packages. Modification times are no longer consulted or relevant. The old advice to add -a to force a rebuild in cases where the modification times were misleading for one reason or another (for example, changes in build flags) is no longer necessary: builds now always detect when packages must be rebuilt. (If you observe otherwise, please file a bug.) </p>\n</blockquote>\n\n<p>Read <a href=\"https://golang.org/doc/go1.10#build\" rel=\"nofollow noreferrer\">release notes</a> for more information.</p>\n"}], "owner": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3957, "favorite_count": 0, "accepted_answer_id": 49257292, "answer_count": 1, "score": 2, "last_activity_date": 1520947247, "creation_date": 1467038055, "question_id": 38056712, "link": "https://stackoverflow.com/questions/38056712/is-it-possible-to-compile-test-binary-using-go-install-instead-of-go-test-c", "title": "Is it possible to compile test binary using `go install` instead of `go test -c`", "body": "<p>I would like to build test binary whenever it is need (only if the package or it's dependencies changed) - something like <code>go install</code> vs <code>go build</code>.</p>\n\n<p>The only option option to speed up building test binaries is <code>-i</code> (<code>go test -c -i</code>).</p>\n\n<p>Any idea if this is supported by the <code>go</code> tool? Is there any other <code>go</code> like tool to do it (I would like to use a tool with native support on go packages instead of a file based system like <code>make</code>).</p>\n"}, {"tags": ["rest", "google-app-engine", "go", "blobstore"], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 489215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11591979f29ab9c2bb58868232d07b88?s=128&d=identicon&r=PG", "display_name": "Adam Tanner", "link": "https://stackoverflow.com/users/489215/adam-tanner"}, "is_accepted": false, "score": 0, "last_activity_date": 1467600593, "creation_date": 1467600593, "answer_id": 38176299, "question_id": 38055758, "link": "https://stackoverflow.com/questions/38055758/upload-file-on-blobstore-with-go-api/38176299#38176299", "title": "upload file on blobstore with go API", "body": "<p>My suggestion would be to provide a small JSON API that your React Native app can call that will give you back an upload URL generated by <code>blobstore.UploadURL</code>. You should then be able to POST to the URL as normal.</p>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467600593, "creation_date": 1467035507, "question_id": 38055758, "link": "https://stackoverflow.com/questions/38055758/upload-file-on-blobstore-with-go-api", "title": "upload file on blobstore with go API", "body": "<p>I try to add files on the blobstore, i have found some examples with go but these are examples with a html template and i now send images from my react-native app that calls my api in go to add file on blobstore.</p>\n\n<p>So how to add a file on blobstore with a file i get with <code>r.FormFile()</code> in go ?</p>\n\n<p>example i have found : </p>\n\n<pre><code>func sampleHandler(w http.ResponseWriter, r *http.Request) {\n    // [START uploading_a_blob_2]\n    var rootTemplate = template.Must(template.New(\"root\").Parse(rootTemplateHTML))\n\n    const rootTemplateHTML = `\n&lt;html&gt;&lt;body&gt;\n&lt;form action=\"{{.}}\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\nUpload File: &lt;input type=\"file\" name=\"file\"&gt;&lt;br&gt;\n&lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\n&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;\n`\n    // [END uploading_a_blob_2]\n\n    // [START uploading_a_blob_1]\n    ctx := appengine.NewContext(r)\n    uploadURL, err := blobstore.UploadURL(ctx, \"/upload\", nil)\n    if err != nil {\n        serveError(ctx, w, err)\n        return\n    }\n    w.Header().Set(\"Content-Type\", \"text/html\")\n    err = rootTemplate.Execute(w, uploadURL)\n    if err != nil {\n        log.Errorf(ctx, \"%v\", err)\n    }\n    // [END uploading_a_blob_1]\n}\n</code></pre>\n\n<p>Thank's :)</p>\n"}, {"tags": ["go", "webdav"], "comments": [{"owner": {"reputation": 5230, "user_id": 5070577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719712211549bdac23e2b1dcaaa6e01b?s=128&d=identicon&r=PG&f=1", "display_name": "Walfrat", "link": "https://stackoverflow.com/users/5070577/walfrat"}, "edited": false, "score": 0, "creation_date": 1467029762, "post_id": 38053699, "comment_id": 63545960, "body": "WebDAV is an extension of HTTP by Microsoft, it add new verbs like LOCK, UNLOCK, so you should start first by either find a HTTP web server that handle this for you and allow you to add new verbs or developer yourself an HTTP Server"}, {"owner": {"reputation": 74246, "user_id": 80911, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9e9b4f80c65dc6076d74cd421084e4fc?s=128&d=identicon&r=PG", "display_name": "Evert", "link": "https://stackoverflow.com/users/80911/evert"}, "edited": false, "score": 0, "creation_date": 1467035503, "post_id": 38053699, "comment_id": 63549999, "body": "WebDAV is not an extension by microsoft. It&#39;s a web standard supported by many different vendors."}], "answers": [{"tags": [], "owner": {"reputation": 74246, "user_id": 80911, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9e9b4f80c65dc6076d74cd421084e4fc?s=128&d=identicon&r=PG", "display_name": "Evert", "link": "https://stackoverflow.com/users/80911/evert"}, "is_accepted": false, "score": 0, "last_activity_date": 1467035623, "creation_date": 1467035623, "answer_id": 38055802, "question_id": 38053699, "link": "https://stackoverflow.com/questions/38053699/how-do-i-implement-basic-authentication-in-webdav-using-golang/38055802#38055802", "title": "How do I implement basic authentication in WebDAV using golang?", "body": "<p>The best pointer for anyone to get started is the specification:</p>\n\n<p><a href=\"http://tools.ietf.org/html/rfc4918\" rel=\"nofollow\">http://tools.ietf.org/html/rfc4918</a></p>\n\n<p>Basic authentication is defined in RFC7617</p>\n\n<p><a href=\"https://tools.ietf.org/html/rfc7617\" rel=\"nofollow\">https://tools.ietf.org/html/rfc7617</a></p>\n"}], "owner": {"reputation": 567, "user_id": 1309509, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d5fb0cbcd08f82f3d177405bb1ec9c5f?s=128&d=identicon&r=PG", "display_name": "Kaarthik", "link": "https://stackoverflow.com/users/1309509/kaarthik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467035623, "creation_date": 1467029602, "last_edit_date": 1467032367, "question_id": 38053699, "link": "https://stackoverflow.com/questions/38053699/how-do-i-implement-basic-authentication-in-webdav-using-golang", "title": "How do I implement basic authentication in WebDAV using golang?", "body": "<p>I want to implement a WebDAV server with basic authentication using golang.  Can some give me some pointers regarding this? TIA</p>\n"}, {"tags": ["go", "struct", "reference", "slice", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1467025907, "post_id": 38052161, "comment_id": 63543482, "body": "I don&#39;t understand. Doesn&#39;t the populate() goroutine run while the main goroutine does time.Sleep(1000ms)?"}, {"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1467027073, "post_id": 38052161, "comment_id": 63544202, "body": "After Petr&#39;s suggestion I updated my question. I think your explanation doesn&#39;t apply anymore, but the behavior is still the same."}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "reply_to_user": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1467027445, "post_id": 38052161, "comment_id": 63544434, "body": "Yes, it&#39;s running, but <code>driver.variables = make(map[string]string)</code> will get reinitialized if you call the <code>populate</code> function on another goroutine."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 0, "last_activity_date": 1467024975, "creation_date": 1467024975, "answer_id": 38052161, "question_id": 38051774, "link": "https://stackoverflow.com/questions/38051774/why-is-this-map-empty-when-i-populate-it-in-a-goroutine/38052161#38052161", "title": "Why is this map empty when I populate it in a Goroutine?", "body": "<p>The reason why using the goroutine version you are not getting an uninitialized map is that when the main function returns, the program exits: <strong>it does not wait for other (non-main) goroutines to complete</strong>. Please be aware the main function itself is a goroutine.</p>\n\n<p>So even if you initialize the map using: </p>\n\n<pre><code>driver.variables = make(map[string]string)\n</code></pre>\n\n<p>it does not mean that you actually populate with values, you are only initialize a hash map data structure and returns a map value that points to it.</p>\n\n<blockquote>\n  <p>Map types are reference types, like pointers or slices, and so the\n  value of m above is nil; it doesn't point to an initialized map. A nil\n  map behaves like an empty map when reading, but attempts to write to a\n  nil map will cause a runtime panic; don't do that. To initialize a\n  map, use the built in make function.</p>\n</blockquote>\n\n<p>In case you remove the <code>go</code> keyword first it will initialize the <code>driver.variables</code> map. But because it's running in the same thread (the main thread) and you put a time delay on the <code>populate</code> function first it will initialize the map, then populate it.</p>\n"}, {"comments": [{"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1467026974, "post_id": 38052362, "comment_id": 63544146, "body": "Excellent idea. Your version still shows the same problem and eliminates all doubt about race conditions. I updated my question."}, {"owner": {"reputation": 1266, "user_id": 3656424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c56441e0f23ba66563c2dfd0e361b28?s=128&d=identicon&r=PG", "display_name": "Petr Shevtsov", "link": "https://stackoverflow.com/users/3656424/petr-shevtsov"}, "reply_to_user": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1467028238, "post_id": 38052362, "comment_id": 63544938, "body": "@AndreKR yes, indeed, I&#39;ve just noticed that it&#39;s not related to goroutines. You use a slice of structs, not a slice of pointers. It works with slice of pointers: <a href=\"https://play.golang.org/p/R8Vkwh_J9H\" rel=\"nofollow noreferrer\">play.golang.org/p/R8Vkwh_J9H</a>"}], "tags": [], "owner": {"reputation": 1266, "user_id": 3656424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c56441e0f23ba66563c2dfd0e361b28?s=128&d=identicon&r=PG", "display_name": "Petr Shevtsov", "link": "https://stackoverflow.com/users/3656424/petr-shevtsov"}, "is_accepted": false, "score": 0, "last_activity_date": 1467025565, "creation_date": 1467025565, "answer_id": 38052362, "question_id": 38051774, "link": "https://stackoverflow.com/questions/38051774/why-is-this-map-empty-when-i-populate-it-in-a-goroutine/38052362#38052362", "title": "Why is this map empty when I populate it in a Goroutine?", "body": "<p>I'd better use channels instead of <code>sleep</code>s:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype driver struct {\n    variables map[string]string\n}\n\nvar Drivers []driver\n\nfunc main() {\n    driver := driver{\n        variables: make(map[string]string),\n    }\n    Drivers = append(Drivers, driver)\n\n    done := make(chan bool)\n    go driver.populate(done)\n    &lt;-done // wait for goroutine to complete\n\n    fmt.Print(Drivers[0].variables)\n}\n\nfunc (this *driver) populate(done chan bool) {\n    time.Sleep(500 * time.Millisecond)\n    this.variables[\"a\"] = \"b\"\n    done &lt;- true\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/VsOzzh0MxP\" rel=\"nofollow\">Playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 7543, "user_id": 1794051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc6d765eadabca02bdd7b44d6504720?s=128&d=identicon&r=PG", "display_name": "val", "link": "https://stackoverflow.com/users/1794051/val"}, "edited": false, "score": 4, "creation_date": 1467028018, "post_id": 38052983, "comment_id": 63544785, "body": "This is the correct answer: goroutines in this case are irrelevant: <a href=\"https://play.golang.org/p/Eh3gPbFWPL\" rel=\"nofollow noreferrer\">play.golang.org/p/Eh3gPbFWPL</a> shows the problem with only the main goroutine; understanding that struct are <i>copied</i>, but pointers (and reference types, like map) are shared is what is causing the problem here."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1528882667, "last_edit_date": 1528882667, "creation_date": 1467027478, "answer_id": 38052983, "question_id": 38051774, "link": "https://stackoverflow.com/questions/38051774/why-is-this-map-empty-when-i-populate-it-in-a-goroutine/38052983#38052983", "title": "Why is this map empty when I populate it in a Goroutine?", "body": "<p>The problem is simple: you have a slice of <code>driver</code>s:</p>\n\n<pre><code>var Drivers []driver\n</code></pre>\n\n<p>Note that <code>Drivers</code> is a slice of some struct type, not a slice of pointers!</p>\n\n<p>When you append something (or you assign a value to one of its elements):</p>\n\n<pre><code>Drivers = append(Drivers, driver)\n</code></pre>\n\n<p>That makes a copy of the value appended (or assigned)! So when you do this later:</p>\n\n<pre><code>driver.variables = make(map[string]string)\n</code></pre>\n\n<p>It will set a new map value to <code>driver.variables</code>, but that is distinct from the value stored in <code>Drivers</code> (more precisely at <code>Drivers[0]</code>).</p>\n\n<p><strong>Later you populate <code>driver.variables</code>, but you print <code>Drivers[0].variables</code>. They are 2 different struct values, with 2 different map values.</strong> Goroutines do not play a role here (they are properly synchronized so they shouldn't anyway).</p>\n\n<p>Would you print <code>driver.variables</code>:</p>\n\n<pre><code>fmt.Print(driver.variables)\n</code></pre>\n\n<p>You would see (try it on the <a href=\"https://play.golang.org/p/UHMGFy17Lu\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[a:b]\n</code></pre>\n\n<p>If you comment out this line:</p>\n\n<pre><code>driver.variables = make(map[string]string) // Commenting this line makes it work, too\n</code></pre>\n\n<p>It would work, <strong>but only because even though you have 2 struct values, they have the same map value (same map header pointing to the same map data structure).</strong></p>\n\n<p>You can also make it work if you call <code>driver.populate()</code> on the struct value <code>Drivers[0]</code> (and sticking to printing <code>Drivers[0].variables</code>):</p>\n\n<pre><code>go Drivers[0].populate(done)\n\n// ...\n\nfmt.Print(Drivers[0].variables)\n</code></pre>\n\n<p>Try this one on the <a href=\"https://play.golang.org/p/M68uheK69Z\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>And you can also make it work if <code>Drivers</code> is a slice of pointers:</p>\n\n<pre><code>var Drivers []*driver\n\n// ...\n\ndriver := &amp;driver{\n    variables: make(map[string]string),\n}\n</code></pre>\n\n<p>Because <code>driver</code> and <code>Driver[0]</code> will be the same pointer (you will have only one struct value and one map value as the initial map is not accessible anymore). Try this on the <a href=\"https://play.golang.org/p/Ge-PxwecnK\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 1, "accepted_answer_id": 38052983, "answer_count": 3, "score": 4, "last_activity_date": 1528882667, "creation_date": 1467023816, "last_edit_date": 1467029390, "question_id": 38051774, "link": "https://stackoverflow.com/questions/38051774/why-is-this-map-empty-when-i-populate-it-in-a-goroutine", "title": "Why is this map empty when I populate it in a Goroutine?", "body": "<pre><code>type driver struct {\n    variables map[string]string\n}\n\nvar Drivers []driver\n\nfunc main() {\n\n    driver := driver{\n        variables: make(map[string]string),\n    }\n    Drivers = append(Drivers, driver)\n\n    driver.variables = make(map[string]string) // Commenting this line makes it work, too\n\n    done := make(chan bool) \n    go driver.populate(done)\n\n    &lt;-done\n\n    fmt.Print(Drivers[0].variables)\n}\n\nfunc (this *driver) populate(done chan bool) {\n    time.Sleep(500 * time.Millisecond)\n    this.variables[\"a\"] = \"b\"\n    done &lt;- true\n}\n</code></pre>\n\n<p>I expected:</p>\n\n<pre><code>map[a:b]\n</code></pre>\n\n<p>Actual result:</p>\n\n<pre><code>map[]\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/TNt4uwHGAw\" rel=\"nofollow\">Playground</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "edited": false, "score": 0, "creation_date": 1467013057, "post_id": 38047862, "comment_id": 63535809, "body": "Does &quot;/Users/tmp/Documents/workspace/app/go/src&quot; exist? EDIT: Nevermind, see @Mark &#39;s comment down below."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1467013136, "post_id": 38047862, "comment_id": 63535852, "body": "<a href=\"https://github.com/gogo/protobuf/proto\" rel=\"nofollow noreferrer\">github.com/gogo/protobuf/proto</a> doesn&#39;t exist, check the correct package name"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467020356, "post_id": 38047862, "comment_id": 63540110, "body": "My mistake: <a href=\"https://github.com/gogo/protobuf\" rel=\"nofollow noreferrer\">gogo/protobuf</a> does exist, and github.com/gogo/protobuf/proto is go gettable"}], "answers": [{"comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467020276, "post_id": 38048674, "comment_id": 63540051, "body": "Glad it&#39;s working. I thought the package name in your question was a typo, and didn&#39;t realise <a href=\"https://github.com/gogo/protobuf\" rel=\"nofollow noreferrer\">gogo/protobuf</a> was a port of the official <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">golang/protobuf</a>"}, {"owner": {"reputation": 504, "user_id": 1941745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9fbfbcd311fc349cfe27c231fa3654?s=128&d=identicon&r=PG", "display_name": "Kerby Shedden", "link": "https://stackoverflow.com/users/1941745/kerby-shedden"}, "edited": false, "score": 0, "creation_date": 1489442384, "post_id": 38048674, "comment_id": 72663770, "body": "Maybe not the case here, but this can also happen if a package owner renames part of the import path.  If &quot;go get&quot; worked before but not now, that is a possible reason."}, {"owner": {"reputation": 470, "user_id": 108913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc0921c3db61156f8bcedad636f9e8a7?s=128&d=identicon&r=PG", "display_name": "Dave Scotese", "link": "https://stackoverflow.com/users/108913/dave-scotese"}, "edited": false, "score": 0, "creation_date": 1569544243, "post_id": 38048674, "comment_id": 102640480, "body": "It appears to me that go get will only download a package if it is missing.  I had an earlier version of go installed when I attempted to <code>go get</code> something and it failed.  After upgrading to go 12.10, I tried the <code>go get</code> again and it got further, but produced the package error in this question.  Deleting the folder worked.  -d -u -a did NOT work."}], "tags": [], "owner": {"reputation": 991, "user_id": 2155614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-yPPj1XVo0uI/AAAAAAAAAAI/AAAAAAAAACQ/NW3rM807aQs/photo.jpg?sz=128", "display_name": "andor kesselman", "link": "https://stackoverflow.com/users/2155614/andor-kesselman"}, "is_accepted": false, "score": 3, "last_activity_date": 1467014448, "creation_date": 1467014448, "answer_id": 38048674, "question_id": 38047862, "link": "https://stackoverflow.com/questions/38047862/go-get-package-cannot-find-package/38048674#38048674", "title": "&quot;go get &lt;package&gt;&quot; cannot find package", "body": "<p>After some fiddling, I found out that somehow source files within the src directory got deleted. I removed the <strong>entire</strong> folder and its contents, which caused the entire package to be reinstalled. This seems to have cleared the issue and resolved it. </p>\n\n<p>I should note I ran into another error along the way of debugging: </p>\n\n<blockquote>\n  <p>no buildable Go source files in /Users/tmp/Documents/workspace/app/go/src/github.com/golang/protobuf/proto</p>\n</blockquote>\n\n<p>Again, this was all resolved after deleting the entire package in the source folder. </p>\n\n<p>@Mark: One thing to note is that I was referencing the correct package name according to <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow\">https://github.com/golang/protobuf</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 991, "user_id": 2155614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-yPPj1XVo0uI/AAAAAAAAAAI/AAAAAAAAACQ/NW3rM807aQs/photo.jpg?sz=128", "display_name": "andor kesselman", "link": "https://stackoverflow.com/users/2155614/andor-kesselman"}, "edited": false, "score": 1, "creation_date": 1467021496, "post_id": 38049422, "comment_id": 63540849, "body": "I tried the &quot;-u&quot; flag as well as the &quot;-d&quot; flag suggested by <a href=\"http://stackoverflow.com/questions/24095004/cant-load-package-package-no-buildable-go-source-files\" title=\"cant load package package no buildable go source files\">stackoverflow.com/questions/24095004/&hellip;</a>. Neither worked. This is useful information, but did not solve the original problem. I did not try the &quot;-a&quot; command, and would need to replicate the error to see if it would work."}], "tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": false, "score": 4, "last_activity_date": 1467017041, "creation_date": 1467017041, "answer_id": 38049422, "question_id": 38047862, "link": "https://stackoverflow.com/questions/38047862/go-get-package-cannot-find-package/38049422#38049422", "title": "&quot;go get &lt;package&gt;&quot; cannot find package", "body": "<p>I don't know if it is neccesery to delete the entire folder. </p>\n\n<p>First you could try to use the <code>-u</code> flag (<a href=\"https://golang.org/cmd/go/\" rel=\"nofollow\">go cmd doc</a>) to reinstall all the other dependencies.</p>\n\n<blockquote>\n  <p>The -u flag instructs get to use the network to update the named packages and their dependencies. By default, get uses the network to check out missing packages but does not use it to look for updates to existing packages. </p>\n</blockquote>\n\n<p>go get supports also build flags to rebuild the package you could try <code>-a</code>:</p>\n\n<blockquote>\n  <p>-a\n      force rebuilding of packages that are already up-to-date.</p>\n</blockquote>\n"}], "owner": {"reputation": 991, "user_id": 2155614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-yPPj1XVo0uI/AAAAAAAAAAI/AAAAAAAAACQ/NW3rM807aQs/photo.jpg?sz=128", "display_name": "andor kesselman", "link": "https://stackoverflow.com/users/2155614/andor-kesselman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8743, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1617792024, "creation_date": 1467011449, "last_edit_date": 1484435409, "question_id": 38047862, "link": "https://stackoverflow.com/questions/38047862/go-get-package-cannot-find-package", "title": "&quot;go get &lt;package&gt;&quot; cannot find package", "body": "<p>The command <code>go get github.com/gogo/protobuf/proto</code> doesn't seem to be working despite <code>GOPATH</code> set.</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>GOPATH=\"/Users/tmp/Documents/workspace/app/go\"\n</code></pre>\n\n<p>I see a similar problem with other packages. </p>\n\n<p>Error being read:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>package github.com/gogo/protobuf/proto: cannot find package \"github.com/gogo/protobuf/proto\" in any of:\n    /usr/local/go/src/github.com/gogo/protobuf/proto (from $GOROOT)\n    /Users/tmp/Documents/workspace/app/go/src/github.com/gogo/protobuf/proto (from $GOPATH)\n</code></pre>\n\n<p>Running <code>go env</code> shows:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>GOARCH=\"amd64\"\nGOBIN=\"\" GOEXE=\"\" GOHOSTARCH=\"amd64\" GOHOSTOS=\"darwin\" GOOS=\"darwin\"\nGOPATH=\"/Users/tmp/Documents/workspace/app/go\" GORACE=\"\"\nGOROOT=\"/usr/local/go\" GOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>What is the problem and how do I fix this? I haven't found anything on this online but this was working prior.</p>\n"}, {"tags": ["go", "winpcap", "cgo", "gopacket"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467025578, "post_id": 38047858, "comment_id": 63543290, "body": "I don&#39;t quite parse the question: the only case when you need to specify <code>GOARCH</code> is when you&#39;re cross-compiling; otherwise <code>GOARCH</code> is set by the <code>go</code> tools all by themselves (you can verify it by running <code>go env</code>). So, do I understand correctly that you 1) have 64-bit Windows; 2) have two Go packages -- i386 and x64 -- installed on it side-by-side; 3) you also have two TDM-GCC packages compiled for different architectures installed side-by-side?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467025860, "post_id": 38047858, "comment_id": 63543449, "body": "If yes, try then mere running of <code>go build</code> / <code>go install</code> from a shell should invoke the x64 build of Go. Try running those commands with the <code>-x</code> command-line option to see what they invoke."}, {"owner": {"reputation": 351, "user_id": 6517127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd638ade469ecd0b71dafe6d58807814?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6517127/j-dow"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467029673, "post_id": 38047858, "comment_id": 63545895, "body": "@kostix Ok to simpilfy: 1. I have a 64bit windows. 2. I installed 32bit GO 3. I compiled and run my program (needless to say it used cgo to build the gopacket module). 4. I uninstalled the 32bit GO. 5. I installed 64bit GO. 6. I tried to compile my program and failed with the given error."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467030295, "post_id": 38047858, "comment_id": 63546309, "body": "So, is your TDD-GCC install x64 as well?"}, {"owner": {"reputation": 351, "user_id": 6517127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd638ade469ecd0b71dafe6d58807814?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6517127/j-dow"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467032622, "post_id": 38047858, "comment_id": 63547922, "body": "@kostix Yes. I have both TDM-GCC x64 and x86. When trying to compile x64 I changed the PATH env variable to the x64 TDM-GCC folder.."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467035952, "post_id": 38047858, "comment_id": 63550339, "body": "Try using the <code>CC_FOR_TARGET</code> env variable to specify the correct compiler for the target arch."}, {"owner": {"reputation": 351, "user_id": 6517127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd638ade469ecd0b71dafe6d58807814?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6517127/j-dow"}, "edited": false, "score": 0, "creation_date": 1467036803, "post_id": 38047858, "comment_id": 63551001, "body": "I am trying to compile winpcap example code with TDM-GCC. of course, 32bit compiles easily. 64bit generates the same error. I&#39;m quite sure the problem is the static libraries missing from the /lib/x64 folder. you can try to compile one of the example in the winpcap developers packet <a href=\"https://www.winpcap.org/devel.htm\" rel=\"nofollow noreferrer\">here</a> compile commands for the &quot;basic dump&quot; example: <code>gcc -g -O -I ..&#47;..&#47;include -c -o basic_dump.o basic_dump.c</code> <code>gcc -g -O -I ..&#47;..&#47;include -o basic_dump.exe basic_dump.o -L ..&#47;..&#47;lib&#47;x64 -lwpcap</code>"}, {"owner": {"reputation": 351, "user_id": 6517127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd638ade469ecd0b71dafe6d58807814?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6517127/j-dow"}, "edited": false, "score": 0, "creation_date": 1467036863, "post_id": 38047858, "comment_id": 63551045, "body": "The guy <a href=\"http://stackoverflow.com/questions/24703765/winpcap-developer-usage-with-cygwin-c-netbeans-ide\">here</a> mentioned the missing .a files. maybe I can generate the .a files like <a href=\"https://sourceforge.net/p/mingw-w64/discussion/723797/thread/530727b3/\" rel=\"nofollow noreferrer\">this</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 6517127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd638ade469ecd0b71dafe6d58807814?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6517127/j-dow"}, "is_accepted": false, "score": 28, "last_activity_date": 1503388761, "last_edit_date": 1503388761, "creation_date": 1467097850, "answer_id": 38069376, "question_id": 38047858, "link": "https://stackoverflow.com/questions/38047858/compile-gopacket-on-windows-64bit/38069376#38069376", "title": "compile gopacket on windows 64bit", "body": "<p>OK so I have figured it out.<br>\nIn order to compile gopacket 64bit on windows you need to do the following:  </p>\n\n<ol>\n<li>Install go_amd64 (add go binaries to your PATH)</li>\n<li>Install TDM GCC x64 (add TDM-GCC binaries to your PATH)  </li>\n<li>Also add TDM-GCC\\x86_64-w64-mingw32\\bin to your PATH</li>\n<li>Install <a href=\"https://www.winpcap.org/install/default.htm\" rel=\"noreferrer\">Winpcap</a></li>\n<li><a href=\"https://www.winpcap.org/devel.htm\" rel=\"noreferrer\">Download Winpcap developer's pack</a> and extract it to C:\\</li>\n</ol>\n\n<p>Now the point is that there are missing linux static libraries files<br>\n(libwpcap.a and libpacket.a) from lib/x64 folder. I don't know why they weren't<br>\nincluded in the developers pack but anyway that's how we can generate them:  </p>\n\n<ol start=\"6\">\n<li>find wpcap.dll and packet.dll in your PC (typically in c:\\windows\\system32  </li>\n<li>copy them to some other temp folder or else you'll have to supply Admin privs to the following commands  </li>\n<li>run gendef on those files <code>gendef wpcap.dll</code> and <code>gendef packet.dll</code> (obtainable with MinGW Installation Manager, package mingw32-gendef)</li>\n<li>this will generate .def files  </li>\n<li>Now we'll generate the static libraries files:  </li>\n<li>run <code>dlltool --as-flags=--64 -m i386:x86-64 -k --output-lib libwpcap.a --input-def wpcap.def</code>  </li>\n<li>and <code>dlltool --as-flags=--64 -m i386:x86-64 -k --output-lib libpacket.a --input-def packet.def</code>  </li>\n<li>Now just copy both libwpcap.a and libpacket.a to c:\\WpdPack\\Lib\\x64  </li>\n</ol>\n\n<p>That's it.<br>\nNow gopacket should compile with no problems.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 5826368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7mlpK.jpg?s=128&g=1", "display_name": "CapitanShinChan", "link": "https://stackoverflow.com/users/5826368/capitanshinchan"}, "is_accepted": false, "score": 0, "last_activity_date": 1542845120, "creation_date": 1542845120, "answer_id": 53422149, "question_id": 38047858, "link": "https://stackoverflow.com/questions/38047858/compile-gopacket-on-windows-64bit/53422149#53422149", "title": "compile gopacket on windows 64bit", "body": "<p>Thank you so much for the solution, it saved me a lot of time!</p>\n\n<p>Just wanted to add that you can do the same with Npcap, modify the gopacket source code to point to Npcap and it will work too.</p>\n\n<p>In case you don't know Npcap:</p>\n\n<ul>\n<li><a href=\"https://nmap.org/npcap/vs-winpcap.html\" rel=\"nofollow noreferrer\">https://nmap.org/npcap/vs-winpcap.html</a></li>\n<li><a href=\"https://nmap.org/npcap/\" rel=\"nofollow noreferrer\">https://nmap.org/npcap/</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1574137416, "creation_date": 1574137416, "answer_id": 58926623, "question_id": 38047858, "link": "https://stackoverflow.com/questions/38047858/compile-gopacket-on-windows-64bit/58926623#58926623", "title": "compile gopacket on windows 64bit", "body": "<p>I installed <a href=\"https://nmap.org/npcap/\" rel=\"nofollow noreferrer\">Npcap</a> on Windows in \"Wpcap API Compatibility Mode\" and <code>gopacket</code> now works fine.</p>\n"}], "owner": {"reputation": 351, "user_id": 6517127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd638ade469ecd0b71dafe6d58807814?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6517127/j-dow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6219, "favorite_count": 4, "answer_count": 3, "score": 7, "last_activity_date": 1574137416, "creation_date": 1467011434, "last_edit_date": 1499695006, "question_id": 38047858, "link": "https://stackoverflow.com/questions/38047858/compile-gopacket-on-windows-64bit", "title": "compile gopacket on windows 64bit", "body": "<p>I am trying to use <a href=\"https://github.com/google/gopacket\" rel=\"noreferrer\">gopacket</a> on my windows 10.<br>\nI'm using it to sniff and inject packets directly to/from the NIC.<br>\nI can easily compile and run my code with GOARCH=386 but can't in GOARCH=amd64.  </p>\n\n<p>Worth noticing: I am NOT trying to cross-compile.<br>\nI'm using go1.6.windows-386 to compile the 32bit version and when I try to compile with GOARCH=amd64 I use go1.6.windows-amd64.  </p>\n\n<p>I used TDM-GCC as linux like compile tools.<br>\nThe error isn't indicative. it just says  </p>\n\n<p><code>c:/WpdPack/Lib/x64/wpcap.lib: error adding symbols: File in wrong format\ncollect2.exe: error ld returned 1 exit status</code></p>\n\n<p>Did anyone manage to build this, if it's even possible?</p>\n"}, {"tags": ["go", "fluent"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1467006529, "post_id": 38046591, "comment_id": 63532870, "body": "1. &quot;Fluent&quot; APIs are not really idiomatic in Go (and not that useful as e.g. in Java) and 2. No you cannot do this."}, {"owner": {"reputation": 542, "user_id": 1000900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/662b51594788f3aacbb1b1ad3ccc8a4b?s=128&d=identicon&r=PG", "display_name": "Guy Cook", "link": "https://stackoverflow.com/users/1000900/guy-cook"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1467022959, "post_id": 38046591, "comment_id": 63541750, "body": "@Volker 1. I&#39;m just working with what I&#39;ve got, 2. if it&#39;s provably impossible, can you make that an answer"}], "answers": [{"tags": [], "owner": {"reputation": 310, "user_id": 2178075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QBKQ.jpg?s=128&g=1", "display_name": "peiiion", "link": "https://stackoverflow.com/users/2178075/peiiion"}, "is_accepted": false, "score": 0, "last_activity_date": 1467060732, "creation_date": 1467060732, "answer_id": 38063031, "question_id": 38046591, "link": "https://stackoverflow.com/questions/38046591/extend-a-fluent-api-from-external-package-in-go/38063031#38063031", "title": "Extend a fluent API from external package in go", "body": "<p>No, you can't because you \"cannot define new methods on a non-local type\", as the compiler will tell you if you try. </p>\n\n<p>Let's say you want to do something silly like: </p>\n\n<pre><code>import \"net/http\"\n\nfunc (c *http.Client) SayHi() {\n    println(\"Hi!\")\n}\n</code></pre>\n\n<p>This won't compile and you'll get the error message mentioned above as you can check here: <a href=\"https://play.golang.org/p/FxBMAfR_aN\" rel=\"nofollow\">https://play.golang.org/p/FxBMAfR_aN</a></p>\n"}], "owner": {"reputation": 542, "user_id": 1000900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/662b51594788f3aacbb1b1ad3ccc8a4b?s=128&d=identicon&r=PG", "display_name": "Guy Cook", "link": "https://stackoverflow.com/users/1000900/guy-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467060732, "creation_date": 1467006049, "question_id": 38046591, "link": "https://stackoverflow.com/questions/38046591/extend-a-fluent-api-from-external-package-in-go", "title": "Extend a fluent API from external package in go", "body": "<p>I've currently got an object from an external package that provides a fluent API, like:</p>\n\n<pre><code>thing := ext.GetThing()\nthing.do().stuff()\n</code></pre>\n\n<p>I'd like to extend this to provide a new function <code>cool</code> so I can use it like</p>\n\n<pre><code>thing.do().cool().stuff()\n</code></pre>\n\n<p>Unfortunately, since I can't have an external type as a receiver for <code>cool</code>, then best I've got so far seems to be</p>\n\n<pre><code>cool(thing.do()).stuff()\n</code></pre>\n\n<p>which becomes very difficult to read as I combine my custom stuff with the built-in fluent.</p>\n\n<p>Is there some way in Go to achieve the extended fluent style that I'm missing?</p>\n"}, {"tags": ["linux", "go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3273409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da53n.jpg?s=128&g=1", "display_name": "A river and drowned fish", "link": "https://stackoverflow.com/users/3273409/a-river-and-drowned-fish"}, "edited": false, "score": 0, "creation_date": 1467197966, "post_id": 38048643, "comment_id": 63629532, "body": "I noticed that nginx also has this problem.  I guess it should be the Linux system file cache problem."}], "tags": [], "owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "is_accepted": false, "score": 0, "last_activity_date": 1467014364, "creation_date": 1467014364, "answer_id": 38048643, "question_id": 38045375, "link": "https://stackoverflow.com/questions/38045375/go1-6-file-method-writestringfrequent-calls-led-to-a-large-system-cache/38048643#38048643", "title": "go1.6 File method WriteStringfrequent calls led to a large system cache", "body": "<p>There's a bunch of things going on, I can't spot the bug right away but these things will help:</p>\n\n<ol>\n<li><p>Try to use <a href=\"https://golang.org/pkg/bufio/#example_Writer\" rel=\"nofollow\">bufio.Writer</a> as much as possible if you are calling <code>file.WriteString</code>, otherwise every single write will be a syscall, hurting performance.</p></li>\n<li><p>You don't need to use <code>select</code> in you <code>startAccessLog</code> function:</p>\n\n<p><code>func startAcessLog() {\n  for ctx := &lt;-logCtxCh {\n      handleAccessLog(ctx)\n  }\n}\n</code></p></li>\n<li><p>Change your error checks from:</p>\n\n<p><code>if err != nil {\n  fmt.Errorf(err.Error())\n}\n</code></p>\n\n<p>to:</p>\n\n<p><code>if err != nil {\n  fmt.Println(err)\n}\n</code></p>\n\n<p>otherwise you are not printing errors. <a href=\"https://golang.org/pkg/fmt/#Errorf\" rel=\"nofollow\">fmt.Errorf</a> formats a string, like <code>fmt.Sprintf</code> does and returns it as an error. It doesn't print anything at all.</p></li>\n<li><p>You should guard <code>accessLog</code> with a <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"nofollow\">sync.Mutex</a> or write to it via a channel. Why? Because there's more than one goroutine trying to work with <code>accessLog</code> and you don't want data races to happen.<br>\nDoing it via a channel would simplify your <code>writeLog</code> function a log. Currently it's hard to follow the logic. I initially thought you weren't properly closing the file.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 3273409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da53n.jpg?s=128&g=1", "display_name": "A river and drowned fish", "link": "https://stackoverflow.com/users/3273409/a-river-and-drowned-fish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467198078, "creation_date": 1466997266, "last_edit_date": 1467198078, "question_id": 38045375, "link": "https://stackoverflow.com/questions/38045375/go1-6-file-method-writestringfrequent-calls-led-to-a-large-system-cache", "title": "go1.6 File method WriteStringfrequent calls led to a large system cache", "body": "<p>go1.6 File method WriteStringfrequent calls led to a large system cache.  </p>\n\n<p>How to solve this problem.</p>\n\n<p>go env: linux  amd64.</p>\n\n<p>Is this a problem of Linux system?</p>\n\n<p>code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nvar logCtxCh chan *http.Request\nvar accessLogFile *os.File\n\ntype HandlerHttp struct{}\n\nfunc (this *HandlerHttp) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    sendAccessLog(req) \n    w.Write([]byte(\"Hello Word\"))\n}\n\nfunc main() {\n    s := &amp;http.Server{\n        Addr:    \":8012\",\n        Handler: &amp;HandlerHttp{},\n    }\n    logCtxCh = make(chan *http.Request, 500)\n    go startAcessLog()\n\n   err:= s.ListenAndServe()\n   fmt.Println(err.Error())\n}\n\nfunc startAcessLog() {\n    for {\n        select {\n        case ctx := &lt;-logCtxCh:\n            handleAccessLog(ctx)\n        }\n    }\n}\n\nfunc sendAccessLog(req *http.Request) {\n    logCtxCh &lt;- req\n}\n\nfunc handleAccessLog(req *http.Request) {\n    uri := req.RequestURI\n    ip := req.RemoteAddr\n    agent := req.UserAgent()\n    refer := req.Referer()\n    method := req.Method\n    now := time.Now().Format(\"2006-01-02 15:04:05\")\n\n    logText := fmt.Sprintf(\"%s %s %s %s %s %s\\n\",\n        now,\n        ip,\n        method,\n        uri,\n        agent,\n        refer,\n    )\n\n    fileName := fmt.Sprintf(\"/data/logs/zyapi/access_zyapi%s.log\",\n        time.Now().Format(\"2006010215\"),\n    )\n    writeLog(fileName, logText)\n}\n\nfunc writeLog(fileName, logText string) {\n    var err error\n    var exist = true\n\n    if _, err = os.Stat(fileName); os.IsNotExist(err) {\n        exist = false\n    }\n\n    if exist == false {\n        if accessLogFile != nil {\n            accessLogFile.Sync()\n            accessLogFile.Close()\n        }\n\n        accessLogFile, err = os.OpenFile(fileName, os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0644)\n        if err == nil {\n            _, err = accessLogFile.WriteString(logText)\n        }\n        if err != nil {\n            fmt.Errorf(err.Error())\n        }\n    } else {\n        if accessLogFile == nil {\n            accessLogFile, err = os.OpenFile(fileName, os.O_WRONLY|os.O_APPEND, 0666)\n            if err != nil {\n                fmt.Errorf(err.Error())\n                return\n            }\n        }\n        _, err = accessLogFile.WriteString(logText)\n        if err != nil {\n            fmt.Errorf(err.Error())\n        }\n    }\n}\n</code></pre>\n\n<p>test:</p>\n\n<pre><code>ab -n100000 -c10 -k \"http://127.0.0.1:8012/\"\nab -n100000 -c10 -k \"http://127.0.0.1:8012/\"\nab -n100000 -c10 -k \"http://127.0.0.1:8012/\"\nab -n100000 -c10 -k \"http://127.0.0.1:8012/\"\nab -n100000 -c10 -k \"http://127.0.0.1:8012/\"\n</code></pre>\n\n<p>After running several times the system file cache becomes very large</p>\n\n<pre><code>CONTAINER    CPU %   MEM USAGE/LIMIT   MEM %     NET I/O   BLOCK I/O\n\napi_8011  38.47%    6.442GB/6.442GB   100.00%    0B/0B     0B/115.4MB \n\napi_8012  36.90%    6.442GB/6.442GB   99.99%     0B/0B     0B/115.6 MB\n</code></pre>\n"}, {"tags": ["email", "go"], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 1287021, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c3115ed6a49b29883d2de57540d893d2?s=128&d=identicon&r=PG", "display_name": "steviesama", "link": "https://stackoverflow.com/users/1287021/steviesama"}, "is_accepted": false, "score": 0, "last_activity_date": 1492270961, "creation_date": 1492270961, "answer_id": 43428009, "question_id": 38045168, "link": "https://stackoverflow.com/questions/38045168/go-smtp-send-email/43428009#43428009", "title": "Go smtp send email", "body": "<p>You appear to be using gomail correctly, but you should make sure the email account on gmail you are trying to send from has less secure apps turned on, otherwise this will never actually send.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7224129, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U-8fSY_3Eio/AAAAAAAAAAI/AAAAAAAAG3Y/5rStEHd8Vj8/photo.jpg?sz=128", "display_name": "Md Al-amin Tusar Tk-shadow", "link": "https://stackoverflow.com/users/7224129/md-al-amin-tusar-tk-shadow"}, "is_accepted": false, "score": 0, "last_activity_date": 1593679405, "creation_date": 1593679405, "answer_id": 62692407, "question_id": 38045168, "link": "https://stackoverflow.com/questions/38045168/go-smtp-send-email/62692407#62692407", "title": "Go smtp send email", "body": "<p>firstly less secure apps must be turned on for your gmail account.</p>\n<p>After that go to <em>security section</em> of your gmail account and in <em>signing in google</em> part, add a new app (create).\nThen google will give a new app pass for that account.\nUse that app password as your password</p>\n<p>it will work</p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1614739349, "creation_date": 1466995299, "last_edit_date": 1614739349, "question_id": 38045168, "link": "https://stackoverflow.com/questions/38045168/go-smtp-send-email", "title": "Go smtp send email", "body": "<p>I am trying to send an email using Go. However I try to use my host custom mail servers which are the followings</p>\n<p><a href=\"https://i.stack.imgur.com/2uj1c.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2uj1c.jpg\" alt=\"enter image description here\" /></a></p>\n<p>So I am not quite sure what should I use over here. I am doing the following</p>\n<pre><code>auth := smtp.PlainAuth(&quot;&quot;, &quot;noreply@icon-universe.com&quot;, &quot;password&quot;, &quot;mail.icon-universe.com&quot;)\nlog.Println(smtp.SendMail(&quot;mail.icon-universe.com:25&quot;, auth, &quot;noreply@icon-universe.com&quot;, []string{&quot;to@gmail.com&quot;}, []byte(&quot;This is a simple test&quot;)))\n</code></pre>\n<p>However this would give me the following error</p>\n<blockquote>\n<p>x509: certificate is valid for server.premierehost.net,\n<a href=\"http://www.server.premierehost.net\" rel=\"nofollow noreferrer\">www.server.premierehost.net</a>, not mail.icon-universe.com</p>\n</blockquote>\n<p>So then I tried the following</p>\n<pre><code>auth := smtp.PlainAuth(&quot;&quot;, &quot;noreply@icon-universe.com&quot;, &quot;password&quot;, &quot;server.premierehost.net&quot;)\nlog.Println(smtp.SendMail(&quot;server.premierehost.net:465&quot;, auth, &quot;noreply@icon-universe.com&quot;, []string{&quot;nakotoffana@gmail.com&quot;}, []byte(&quot;thanks for loggin in&quot;)))\n</code></pre>\n<p>However this would just make my app go on an infinite loop...</p>\n<p>Which connection details should I use?</p>\n<hr />\n<p>Update</p>\n<p>I decided to try go-mail and seems to work but not for @gmail</p>\n<pre><code>d := gomail.NewDialer(&quot;server.premierehost.net&quot;, 465, &quot;noreply@icon-universe.com&quot;, &quot;password&quot;)\nm := gomail.NewMessage()\nm.SetHeader(&quot;From&quot;, &quot;noreply@icon-universe.com&quot;)\nm.SetHeader(&quot;To&quot;, &quot;carvajal@karmagameworks.com&quot;)\nm.SetHeader(&quot;Subject&quot;, &quot;Hello!&quot;)\nm.SetBody(&quot;text/html&quot;, &quot;Hello &lt;b&gt;Bob&lt;/b&gt; and &lt;i&gt;Cora&lt;/i&gt;!&quot;)\nlog.Println(d.DialAndSend(m))\n</code></pre>\n<p>This will work and the email will appear but sending to @gmail.com won't (the email will never arrive)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 21104, "user_id": 191450, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24a895bcec11df8f488a259f518063fc?s=128&d=identicon&r=PG", "display_name": "koblas", "link": "https://stackoverflow.com/users/191450/koblas"}, "edited": false, "score": 0, "creation_date": 1467033875, "post_id": 38046308, "comment_id": 63548756, "body": "The actual code never has an IGet (just being lazy for example purposes). The second version you posted puts the Init on the final structure, which of course gives it access to the interfaces. If my goal is to have effectivly and abstract base class where I don&#39;t have to have to have concrete implementation on every Controller is that not possible.  It might not be go, but it would be very useful.  FYI - Much of this is me trying to understand the possibilities, of what&#39;s can be done with interfaces."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 21104, "user_id": 191450, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24a895bcec11df8f488a259f518063fc?s=128&d=identicon&r=PG", "display_name": "koblas", "link": "https://stackoverflow.com/users/191450/koblas"}, "edited": false, "score": 0, "creation_date": 1467047717, "post_id": 38046308, "comment_id": 63558145, "body": "@koblas Totally possible, you&#39;re just doing it backwards.  Instead of embedding the interfaces that the base class <i>can</i> but <i>doesn&#39;t have to</i> implement (because embedding them by definition makes it implement them), embed the base class in the additional structures that also implement <code>IGet</code> or <code>IList</code>, and have an interface with the required methods to pass around.  Example: <a href=\"https://play.golang.org/p/SXuGc8fAMY\" rel=\"nofollow noreferrer\">play.golang.org/p/SXuGc8fAMY</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1469594998, "last_edit_date": 1469594998, "creation_date": 1467004305, "answer_id": 38046308, "question_id": 38043678, "link": "https://stackoverflow.com/questions/38043678/golang-embedded-interface-on-parent-struct/38046308#38046308", "title": "Golang embedded interface on parent struct", "body": "<p>name it with er: <code>Getter</code> instead of <code>IGet</code><br>\nyou do not need to embed interface method in struct, it is enough that your struct has Get receiver method.  </p>\n\n<p><strong>Calling any method of a nil interface value causes a panic</strong>:<br>\nyou defined <code>ctrl.IGet</code> but not initialized it,<br>\nadd this line inside your first if inside Init():  </p>\n\n<pre><code>fmt.Printf(\"f=%T IGet:T=%T V=%[2]v\\n\", f, ctrl.IGet)\n</code></pre>\n\n<p>output is:  </p>\n\n<pre><code>f=*main.BaseAppController IGet:T=&lt;nil&gt; V=&lt;nil&gt;\n</code></pre>\n\n<p>Variables are always initialized to a well-defined value, and interfaces are no exception. The zero value for an interface has both its type and value components set to nil.<br>\nyour <code>BaseAppController</code> lacks Get interface method.   </p>\n\n<p>and edit last method in your sample code to this:  </p>\n\n<pre><code>func (ctrl *BaseAppController) Get(v int) {\n    fmt.Printf(\"Hi name=%s v=%d\\n\", ctrl.name, v)\n}\n</code></pre>\n\n<p>and your code runs for now.  </p>\n\n<p>if you want to fix your current code with minimum change, just replace your main function with this (note that ctrl is pointer here):  </p>\n\n<pre><code>func main() {\n    app := Application{\"hithere\"}\n    ctrl := &amp;TestController{&amp;BaseAppController{Application: &amp;app}}\n    ctrl.IGet = interface{}(ctrl).(IGet)\n    ctrl.Init()\n    ctrl.Call()\n}\n</code></pre>\n\n<p>working sample code (with minimum change):  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype IGet interface {\n    Get(int)\n}\n\ntype IList interface {\n    List(int)\n}\n\ntype Application struct {\n    name string\n}\n\ntype BaseAppController struct {\n    *Application\n\n    IGet\n    IList\n}\n\ntype TestController struct {\n    *BaseAppController\n}\n\nfunc (ctrl *BaseAppController) Init() {\n    fmt.Println(\"In Init\")\n\n    if f, ok := interface{}(ctrl).(IGet); ok {\n        fmt.Println(\"Controller Found GET\", f)\n    } else {\n        fmt.Println(\"Controller NOT Found GET\", f)\n    }\n\n    if f, ok := interface{}(ctrl).(IList); ok {\n        fmt.Println(\"Controller Found LIST\", f)\n    } else {\n        fmt.Println(\"Controller NOT Found LIST\", f)\n    }\n}\n\nfunc (ctrl *BaseAppController) Call() {\n    fmt.Println(\"In Call\")\n\n    if f, ok := interface{}(ctrl).(IGet); ok {\n        fmt.Println(\"Controller Found GET - going to call\", f)\n\n        f.Get(7)\n    } else {\n        fmt.Println(\"Controller NOT Found GET - can't call\", f)\n    }\n}\n\n// Test controller implements the Get Method\nfunc (ctrl *TestController) Get(v int) {\n    fmt.Printf(\"Hi name=%s v=%d\\n\", ctrl.name, v)\n}\n\nfunc main() {\n    app := Application{\"hithere\"}\n    ctrl := &amp;TestController{&amp;BaseAppController{Application: &amp;app}}\n    ctrl.IGet = interface{}(ctrl).(IGet)\n    ctrl.Init()\n    ctrl.Call()\n}\n</code></pre>\n\n<p>also this works (embedded interface removed):  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype IGet interface {\n    Get(int)\n}\n\ntype IList interface {\n    List(int)\n}\n\ntype Application struct {\n    name string\n}\n\ntype BaseAppController struct {\n    *Application\n}\n\ntype TestController struct {\n    *BaseAppController\n}\n\nfunc (ctrl *TestController) Init() {\n    fmt.Println(\"In Init\")\n\n    if f, ok := interface{}(ctrl).(IGet); ok {\n        fmt.Println(\"Controller Found GET\", f)\n    } else {\n        fmt.Println(\"Controller NOT Found GET\", f)\n    }\n\n    if f, ok := interface{}(ctrl).(IList); ok {\n        fmt.Println(\"Controller Found LIST\", f)\n    } else {\n        fmt.Println(\"Controller NOT Found LIST\", f)\n    }\n}\n\nfunc (ctrl *TestController) Call() {\n    fmt.Println(\"In Call\")\n\n    if f, ok := interface{}(ctrl).(IGet); ok {\n        fmt.Println(\"Controller Found GET - going to call\", f)\n\n        f.Get(7)\n    } else {\n        fmt.Println(\"Controller NOT Found GET - can't call\", f)\n    }\n}\n\n// Test controller implements the Get Method\nfunc (ctrl *TestController) Get(v int) {\n    fmt.Printf(\"Hi name=%s v=%d\\n\", ctrl.name, v)\n}\n\nfunc main() {\n    app := Application{\"hithere\"}\n    ctrl := TestController{&amp;BaseAppController{Application: &amp;app}}\n\n    ctrl.Init()\n\n    ctrl.Call()\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>In Init\nController Found GET &amp;{0xc082026028}\nController NOT Found LIST &lt;nil&gt;\nIn Call\nController Found GET - going to call &amp;{0xc082026028}\nHi name=hithere v=7\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21104, "user_id": 191450, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24a895bcec11df8f488a259f518063fc?s=128&d=identicon&r=PG", "display_name": "koblas", "link": "https://stackoverflow.com/users/191450/koblas"}, "edited": false, "score": 1, "creation_date": 1467034059, "post_id": 38049036, "comment_id": 63548873, "body": "This is more Python style code (duck typing) if you&#39;re an &quot;X&quot; and implement &quot;Y&quot; then add the following behavior. Though I&#39;m realizing that&#39;s not really possible."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 1, "creation_date": 1467753631, "post_id": 38049036, "comment_id": 63849864, "body": "It doesn&#39;t matter whether it&#39;s a struct or an interface. In both cases you add another field to your struct which will have the same name as the embedded type. And it panics because in Go interface internally is just two pointers - pointer to type information and pointer to the data. If interface typed field is nil then both pointers nil and you will get panic when trying to do something with it. Same thing if you embed a pointer to a struct - the backing field will default to nil and you&#39;ll get a panic when trying to access it."}], "tags": [], "owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "is_accepted": false, "score": 4, "last_activity_date": 1467015726, "creation_date": 1467015726, "answer_id": 38049036, "question_id": 38043678, "link": "https://stackoverflow.com/questions/38043678/golang-embedded-interface-on-parent-struct/38049036#38049036", "title": "Golang embedded interface on parent struct", "body": "<p>Do not mix <strong>interface embedding</strong> with <strong>struct embedding</strong>.</p>\n\n<p>If you embed interfaces on a struct, you are actually adding new fields to the struct with the name of the interface so if you don't init those, you will get panics because they are nil.</p>\n\n<p>Your <code>BaseAppController</code> expects someone to fill in <code>IGet</code> and <code>IList</code> fields with something that satifies <code>IGet</code> and <code>IList</code> interfaces respectively.</p>\n\n<p>This is what your <code>BaseAppController</code> struct really looks like:</p>\n\n<pre><code>type BaseAppController struct {\n    Application *Application\n    IGet        IGet\n    IList       IList\n}\n</code></pre>\n\n<p>It seems you are trying to do Java-style programming in Go and that doesn't end well.</p>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 19, "last_activity_date": 1467753069, "last_edit_date": 1467753069, "creation_date": 1467043228, "answer_id": 38058463, "question_id": 38043678, "link": "https://stackoverflow.com/questions/38043678/golang-embedded-interface-on-parent-struct/38058463#38058463", "title": "Golang embedded interface on parent struct", "body": "<p>One thing you seem to be missing is how embedding interfaces affects a structure in Go.  See, embedding promotes all of the methods of the embedded type (struct or interface, doesn't matter) to be methods of the parent type, but called using the embedded object as the receiver.</p>\n\n<p>The practical side effect of this is that embedding an interface into a structure guarantees that that structure fulfills the interface it is embedding, because it by definition has all of the methods of that interface.  Trying to <em>call</em> any of those methods without defining something to fill that interface field in the struct, however, will panic, as that interface field defaults to <code>nil</code>.</p>\n\n<p>As a result, your type assertions will <em>always</em> be true.  <code>BaseAppController</code> embeds both the <code>IGet</code> and <code>IList</code> interfaces, and therefore always fulfills both.</p>\n\n<p>If you want duck-typing, where behavior is selectively enabled based on the presence or absence of methods on a type, you need to use something similar to how the standard library <a href=\"https://golang.org/src/io/io.go?s=10995:11049#L366\" rel=\"noreferrer\"><code>io.WriterTo</code> interface</a> works.  This interface, and <code>io.ReaderFrom</code>, are optional interfaces that <code>io.Writer</code> and <code>io.Reader</code> objects can implement to directly write to or read from another source, instead of the <code>io</code> package needing to buffer the read data or data to be written itself.</p>\n\n<p>The basic gist is that you define an underlying interface with the <em>required</em> methods on it, and that's what you pass around.  You then have one or more optional interfaces, which you can check the passed type to see if they fulfill, and if so, use that optional interface's methods (and if not, revert to default behavior).  Embedding isn't needed in this case.</p>\n\n<p>Embedding of interfaces, rather than being for duck-typing, is more about polymorphism.  As an example, if you wanted to access a SQL database, but wanted to be able to handle both standard database calls and calls within a transaction, you could make a structure that holds the joint methods of the two types (<code>sql.DB</code> and <code>sql.Tx</code>) like this:</p>\n\n<pre><code>type dber interface {\n    Query(query string, args ...interface{}) (*sql.Rows, error)\n    QueryRow(query string, args ...interface{}) *sql.Row\n    Exec(query string, args ...interface{}) (sql.Result, error)\n}\n</code></pre>\n\n<p>Then you make a structure like this:</p>\n\n<pre><code>type DBHandle struct {\n    dber\n}\n</code></pre>\n\n<p>Now you can store either a <code>sql.DB</code> or a <code>sql.Tx</code> in that <code>dber</code> slot of the structure, and anything using <code>DBHandle</code> (as well as all methods of <code>DBHandle</code> itself) can call <code>Query()</code>, <code>QueryRow()</code>, and <code>Exec()</code> on the <code>DBHandle</code> without having to know whether they are being called within the scope of a transaction or not (remember, though, that interface field must be initialized first!)</p>\n\n<p>This type of functionality is where embedding really starts to shine, as it allows functionality and flexibility close to a fully polymorphic inheritance system without the need of explicit \"implements\" or \"extends\" statements.  It's just not really useful for the type of dynamic duck-typing behavior you're going for.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5786451, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YeDbCImDDn8/AAAAAAAAAAI/AAAAAAAAEOk/tJBY8jPFey8/photo.jpg?sz=128", "display_name": "Roman Tsovanyan", "link": "https://stackoverflow.com/users/5786451/roman-tsovanyan"}, "is_accepted": false, "score": 1, "last_activity_date": 1505537584, "last_edit_date": 1505537584, "creation_date": 1505534245, "answer_id": 46249879, "question_id": 38043678, "link": "https://stackoverflow.com/questions/38043678/golang-embedded-interface-on-parent-struct/46249879#46249879", "title": "Golang embedded interface on parent struct", "body": "<p>If you want inherit any struct with base struct, you can write this (ugly) code, that works like a reflect package:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"unsafe\"\n)\n\ntype i interface{\n  i() interface{}\n  ct(i)\n}\n\ntype t1 struct{\n  rptr unsafe.Pointer\n}\n\nfunc(x *t1) i() interface{} {\n  // parent struct can view child changed value, stored in rptr, as original value type with changes after store, instead of i interface\n  rv:= *(*i)(x.rptr)\n  fmt.Printf(\"%#v %d\\n\", rv, rv.(*t2).a)\n  return rv\n}\n\nfunc(x *t1) ct(vv i){\n  // store pointer to child value of i interface type\n  // we can store any of types, i is for the sample\n  x.rptr = unsafe.Pointer(&amp;vv)\n}\n\ntype t2 struct{\n  t1\n  a int\n}\n\n\nfunc main() {\n  t:=&amp;t2{}\n  t.ct(t) // store original\n  t.a = 123 // change original\n  ti:=(t.i()).(*t2) // t.i() is a method of parent (embedded) struct, that return stored value as original with changes in interface{}\n  fmt.Printf(\"%#v %d\\n\",ti, ti.a)\n}\n</code></pre>\n\n<p>This sample is not good.\nBest sample can include interface field:</p>\n\n<pre><code>type t1 struct{\n  original i\n}\n</code></pre>\n"}], "owner": {"reputation": 21104, "user_id": 191450, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24a895bcec11df8f488a259f518063fc?s=128&d=identicon&r=PG", "display_name": "koblas", "link": "https://stackoverflow.com/users/191450/koblas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10280, "favorite_count": 6, "accepted_answer_id": 38058463, "answer_count": 4, "score": 7, "last_activity_date": 1505537584, "creation_date": 1466979093, "question_id": 38043678, "link": "https://stackoverflow.com/questions/38043678/golang-embedded-interface-on-parent-struct", "title": "Golang embedded interface on parent struct", "body": "<p>I've got a program that is trying to implement functions on \"subclasses\", where the parent can check to see if the interface is implemented. For perspective, it's really dealing with REST URL generation based on if methods exist.</p>\n\n<p>What I'm running into is that based on the following pattern, both the IList and IGet interfaces are found on the TestController object, when only 1 is implemented. When the IGet interface is called I get a panic.</p>\n\n<p>I would rather not make concrete definitions of the Get/List on the base struct and then have to override them, would much rather do the test for existence then go from there.</p>\n\n<p>Here's a go playground link as well <a href=\"https://play.golang.org/p/5j58fejeJ3\" rel=\"noreferrer\">https://play.golang.org/p/5j58fejeJ3</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype IGet interface {\n    Get(int)\n}\n\ntype IList interface {\n    List(int)\n}\n\ntype Application struct {\n    name    string\n}\n\ntype BaseAppController struct {\n    *Application\n\n    IGet\n    IList\n}\n\ntype TestController struct {\n    *BaseAppController\n}\n\nfunc (ctrl *BaseAppController) Init() {\n    fmt.Println(\"In Init\")\n\n    if f, ok := interface{}(ctrl).(IGet); ok {\n        fmt.Println(\"Controller Found GET\", f)\n    } else {\n        fmt.Println(\"Controller NOT Found GET\", f)\n    }\n\n    if f, ok := interface{}(ctrl).(IList); ok {\n        fmt.Println(\"Controller Found LIST\", f)\n    } else {\n        fmt.Println(\"Controller NOT Found LIST\", f)\n    }\n}\n\nfunc (ctrl *BaseAppController) Call() {\n    fmt.Println(\"In Call\")\n\n    if f, ok := interface{}(ctrl).(IGet); ok {\n        fmt.Println(\"Controller Found GET - going to call\", f)\n\n        f.Get(7)\n    } else {\n        fmt.Println(\"Controller NOT Found GET - can't call\", f)\n    }\n}\n\n// Test controller implements the Get Method\nfunc (ctrl *TestController) Get(v int) {\n    fmt.Printf(\"Hi name=%s v=%d\\n\", ctrl.name, v)\n}\n\nfunc main() {\n    app := Application{\"hithere\"}\n    ctrl := TestController{&amp;BaseAppController{Application: &amp;app}}\n\n    ctrl.Init()\n\n    ctrl.Call()\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 339, "user_id": 6512964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Kve6f8BM-o/AAAAAAAAAAI/AAAAAAAAB08/DZEVoRhF9Fw/photo.jpg?sz=128", "display_name": "Tom Cleveland", "link": "https://stackoverflow.com/users/6512964/tom-cleveland"}, "is_accepted": true, "score": 7, "last_activity_date": 1466976466, "last_edit_date": 1466976466, "creation_date": 1466969979, "answer_id": 38042460, "question_id": 38042181, "link": "https://stackoverflow.com/questions/38042181/how-to-make-templates-work-with-gin-framework/38042460#38042460", "title": "How to make templates work with gin framework?", "body": "<p>I'm guessing the issue is that you're using a relative filepath to access your templates.</p>\n\n<p>If I compile and run your code <em>from the <code>gospike</code> directory</em>, it works fine. But if I run <code>gospike</code> from any other directory, I get the same error you were seeing.</p>\n\n<p>So either you need to always run <code>gospike</code> in the parent directory of <code>templates</code>, or you need to use the absolute path. You could either hard code it:</p>\n\n<pre><code>router.LoadHTMLGlob(\"/go/src/github.com/ameykpatil/gospike/templates/*\")\n</code></pre>\n\n<p>or you could do something like</p>\n\n<pre><code>router.LoadHTMLGlob(filepath.Join(os.Getenv(\"GOPATH\"),\n    \"src/github.com/ameykpatil/gospike/templates/*\"))\n</code></pre>\n\n<p>but that will fail if you have multiple paths set in your <code>GOPATH</code>. A better long-term solution might be setting a special environment variable like <code>TMPL_DIR</code>, and then just using that:</p>\n\n<pre><code>router.LoadHTMLGlob(filepath.Join(os.Getenv(\"TMPL_DIR\"), \"*\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 14862579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qK4fl.png?s=128&g=1", "display_name": "yAnGwAwA", "link": "https://stackoverflow.com/users/14862579/yangwawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1609640963, "creation_date": 1609640963, "answer_id": 65546122, "question_id": 38042181, "link": "https://stackoverflow.com/questions/38042181/how-to-make-templates-work-with-gin-framework/65546122#65546122", "title": "How to make templates work with gin framework?", "body": "<p>use relative path glob will working, you can try to code</p>\n<pre class=\"lang-golang prettyprint-override\"><code>router.LoadHTMLGlob(&quot;./templates/*&quot;)\n</code></pre>\n<p>notice the <code>.</code> dot sign which meaning current directory, gin.Engine will load template\nbase on <code>templates</code> subdirectory of current directory .</p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 10950622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ffae8edc4edb5a2eaa3262d3924b543?s=128&d=identicon&r=PG&f=1", "display_name": "Cengleby", "link": "https://stackoverflow.com/users/10950622/cengleby"}, "is_accepted": false, "score": 1, "last_activity_date": 1610311142, "creation_date": 1610311142, "answer_id": 65658280, "question_id": 38042181, "link": "https://stackoverflow.com/questions/38042181/how-to-make-templates-work-with-gin-framework/65658280#65658280", "title": "How to make templates work with gin framework?", "body": "<p>Here is how I do it.  This walks through the directory and collects the files marked with my template suffix which is .html &amp; then I just include all of those.  I haven't seen this answer anywhere so I thought Id post it.</p>\n<pre><code>// START UP THE ROUTER\nrouter := gin.Default()\n\nvar files []string\nfilepath.Walk(&quot;./views&quot;, func(path string, info os.FileInfo, err error) error {\n    if strings.HasSuffix(path, &quot;.html&quot;) {\n        files = append(files, path)\n    }\n    return nil\n})\n\nrouter.LoadHTMLFiles(files...)\n\n// SERVE STATICS\nrouter.Use(static.Serve(&quot;/css&quot;, static.LocalFile(&quot;./css&quot;, true)))\nrouter.Use(static.Serve(&quot;/js&quot;, static.LocalFile(&quot;./js&quot;, true)))\nrouter.Use(static.Serve(&quot;/images&quot;, static.LocalFile(&quot;./images&quot;, true)))\n\nrouters.LoadBaseRoutes(router)\nrouters.LoadBlog(router)\n\nrouter.Run(&quot;:8080&quot;)\n</code></pre>\n"}], "owner": {"reputation": 571, "user_id": 1049413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9dd09ead92e1b1d21895b9318f316595?s=128&d=identicon&r=PG", "display_name": "ameykpatil", "link": "https://stackoverflow.com/users/1049413/ameykpatil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4038, "favorite_count": 2, "accepted_answer_id": 38042460, "answer_count": 3, "score": 3, "last_activity_date": 1610311142, "creation_date": 1466967988, "last_edit_date": 1466975491, "question_id": 38042181, "link": "https://stackoverflow.com/questions/38042181/how-to-make-templates-work-with-gin-framework", "title": "How to make templates work with gin framework?", "body": "<p>I am newbie to golang.\nTo learn it I have started with a simple web app using <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">gin</a> framework.\nI have followed the gin doc &amp; configured template file but not able to make it work. I am getting an error -</p>\n\n<blockquote>\n<pre><code>panic: html/template: pattern matches no files: `templates/*`\n\ngoroutine 1 [running]:\nhtml/template.Must\n  /usr/local/Cellar/go/1.5.2/libexec/src/html/template/template.go:330\ngithub.com/gin-gonic/gin.(*Engine).LoadHTMLGlob\n  /Users/ameypatil/deployment/go/src/github.com/gin-gonic/gin/gin.go:126\nmain.main()\n  /Users/ameypatil/deployment/go/src/github.com/ameykpatil/gospike/main.go:17\n</code></pre>\n</blockquote>\n\n<p>Below is my code - </p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    //os.Setenv(\"GIN_MODE\", \"release\")\n    //gin.SetMode(gin.ReleaseMode)\n\n    // Creates a gin router with default middleware:\n    // logger and recovery (crash-free) middleware\n    router := gin.Default()\n\n    router.LoadHTMLGlob(\"templates/*\")\n    //router.LoadHTMLFiles(\"templates/index.tmpl\")\n\n    router.GET(\"/\", func(c *gin.Context) {\n        c.HTML(http.StatusOK, \"index.tmpl\", gin.H{\n            \"title\": \"GoSpike\",\n        })\n    })\n\n    // By default it serves on :8080 unless a\n    // PORT environment variable was defined.\n    router.Run(\":4848\")\n}\n</code></pre>\n\n<p>My directory structure is</p>\n\n<pre><code>- gospike\n--- templates\n------index.tmpl\n--- main.go\n</code></pre>\n\n<p><code>go install</code> command does not give any error</p>\n\n<p>but on actually running, it gives the above error. I searched &amp; there were similar issues logged on gin's github repo but they are closed now.\nI have tried various things but I guess I am missing something obvious. What am I missing?  </p>\n"}, {"tags": ["go", "oauth"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5800226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a483dc8d5e2c2e9e0afe2006085bb6?s=128&d=identicon&r=PG&f=1", "display_name": "user5800226", "link": "https://stackoverflow.com/users/5800226/user5800226"}, "edited": false, "score": 0, "creation_date": 1466967952, "post_id": 38041905, "comment_id": 63524199, "body": "Interesting, so no database. Shouldn&#39;t the token be encrypted and verified before making API calls with it?"}, {"owner": {"reputation": 339, "user_id": 6512964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Kve6f8BM-o/AAAAAAAAAAI/AAAAAAAAB08/DZEVoRhF9Fw/photo.jpg?sz=128", "display_name": "Tom Cleveland", "link": "https://stackoverflow.com/users/6512964/tom-cleveland"}, "reply_to_user": {"reputation": 107, "user_id": 5800226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a483dc8d5e2c2e9e0afe2006085bb6?s=128&d=identicon&r=PG&f=1", "display_name": "user5800226", "link": "https://stackoverflow.com/users/5800226/user5800226"}, "edited": false, "score": 1, "creation_date": 1466968935, "post_id": 38041905, "comment_id": 63524524, "body": "@user5800226 I&#39;m assuming that the token granted by Instagram will only be valid when used in conjunction with the OP&#39;s <code>CLIENT_SECRET</code>, which makes encrypting the token less important. And I&#39;m also assuming that the request made in the <code>redirect()</code> function serves to verify the token. Finally, I&#39;m assuming that this is a simpler project without a database."}, {"owner": {"reputation": 107, "user_id": 5800226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a483dc8d5e2c2e9e0afe2006085bb6?s=128&d=identicon&r=PG&f=1", "display_name": "user5800226", "link": "https://stackoverflow.com/users/5800226/user5800226"}, "edited": false, "score": 0, "creation_date": 1466969584, "post_id": 38041905, "comment_id": 63524725, "body": "Okay just found out Instagram allows an option &quot;Enforce signed requests&quot; thanks!"}], "tags": [], "owner": {"reputation": 339, "user_id": 6512964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Kve6f8BM-o/AAAAAAAAAAI/AAAAAAAAB08/DZEVoRhF9Fw/photo.jpg?sz=128", "display_name": "Tom Cleveland", "link": "https://stackoverflow.com/users/6512964/tom-cleveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1466966519, "creation_date": 1466966519, "answer_id": 38041905, "question_id": 38040382, "link": "https://stackoverflow.com/questions/38040382/how-do-i-store-the-access-token-for-reuse/38041905#38041905", "title": "How do I store the access token for reuse?", "body": "<p>You could store the access token in a cookie, by inserting the following code immediately before the <code>res.Write(body)</code> line in the <code>redirect()</code> function:</p>\n\n<pre><code>res.SetCookie(&amp;Cookie{\n   Name: \"access_token\",\n   Value: tok.AccessToken,\n   Expires: time.Now().Add(time.Hour * 24), // expires in 24 hours\n}\n</code></pre>\n\n<p>In some other handler, you would read this token back again like this:</p>\n\n<pre><code>accessCookie, err := req.Cookie(\"access_token\")\nif err != nil {\n   res.WriteHeader(http.StatusUnauthorized)\n   fmt.Fprintln(res, \"no access token provided\")\n   return\n}\naccessToken := accessCookie.Value\n// make your requests to Instagram here\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9067, "user_id": 88122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/U0pg3.png?s=128&g=1", "display_name": "jwilleke", "link": "https://stackoverflow.com/users/88122/jwilleke"}, "is_accepted": false, "score": 0, "last_activity_date": 1466977927, "creation_date": 1466977927, "answer_id": 38043538, "question_id": 38040382, "link": "https://stackoverflow.com/questions/38040382/how-do-i-store-the-access-token-for-reuse/38043538#38043538", "title": "How do I store the access token for reuse?", "body": "<p>Why would you store an Access Token?</p>\n\n<p>Both Access and Refresh tokens are Bearer tokens and should be handled as defined in <a href=\"https://tools.ietf.org/html/rfc6750\" rel=\"nofollow\">RFC 6750</a>.</p>\n\n<p>You are often better off simply re-doing the authorization flow when they come back and click the login button again.</p>\n\n<p>If you store the token you need to worry about securing data in the token and these tokens give access to some fairly privileged information about your users. </p>\n\n<p>I would suggest, where you can, move to OpenID Connect and where you are using JWT which are encrypted and signed.</p>\n\n<p>-jim</p>\n"}, {"tags": [], "owner": {"reputation": 343, "user_id": 8411263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLuEd7kVkpA/AAAAAAAAAAI/AAAAAAAAACI/XGfe0AyH8n8/photo.jpg?sz=128", "display_name": "Manouchehr Rasouli", "link": "https://stackoverflow.com/users/8411263/manouchehr-rasouli"}, "is_accepted": false, "score": 0, "last_activity_date": 1565018747, "creation_date": 1565018747, "answer_id": 57361657, "question_id": 38040382, "link": "https://stackoverflow.com/questions/38040382/how-do-i-store-the-access-token-for-reuse/57361657#57361657", "title": "How do I store the access token for reuse?", "body": "<p>hi i wrote a module to token storage and management with time delay for expiration time take a look to this module i think it can help you,\ni call this storage from my middleware to manage the tokens</p>\n\n<pre><code> # storage.go\n package token_store\n\n import (\n     \"sync\"\n     \"time\"\n )\n\n type item struct {\n    token      string\n    lastAccess int64\n }\n\n // storage structure to managing the store tokens\n type Storage struct {\n     storeMap map[string]*item\n     lock     sync.Mutex\n }\n\n func NewStore(len, expireTime int64) (s *Storage) {\n     // initial the storage\n     s = &amp;Store{storeMap: make(map[string]*item, len)}\n     go func() {\n         // each minute check that token has expired or not\n         for now := range time.Tick(time.Minute) {\n             // lock the cache for updating the values\n             s.lock.Lock()\n             for key, value := range s.storeMap {\n                 /*\n                     if expiration time exceeded then start to removing\n                     the token from cache\n                 */\n                 if now.Unix()-value.lastAccess &gt; expireTime {\n                    delete(s.storeMap, key)\n                 }\n             }\n             s.lock.Unlock()\n         }\n     }()\n     return\n }\n\n func (s *Storage) Len() int {\n    // return the len of storage map\n    return len(s.storeMap)\n }\n\nfunc (s *Storage) Put(key, value string) {\n    /*\n        value will be the authentication token\n        key can be user-name or anay things that you\n        want to access token within it\n    */\n    s.lock.Lock()\n    if it, ok := s.storeMap[key]; !ok { // if token is not exist\n        it = &amp;item{value, time.Now().Unix()}\n        s.storeMap[key] = it\n    } else { // if token exist then update the last access time\n        it.lastAccess = time.Now().Unix()\n    }\n    s.lock.Unlock()\n\n }\n\n func (s *Storage) Get(key string) (value string) {\n     /*\n         check out hte item\n     */\n     s.lock.Lock()\n     if item, ok := s.storeMap[key]; ok { // check if item exist then pass the value\n          value = item.token\n          item.lastAccess = time.Now().Unix()\n     }\n     s.lock.Unlock()\n     return\n }\n</code></pre>\n\n<p>i hope this post be helpfull for you.</p>\n"}], "owner": {"reputation": 107, "user_id": 5800226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a483dc8d5e2c2e9e0afe2006085bb6?s=128&d=identicon&r=PG&f=1", "display_name": "user5800226", "link": "https://stackoverflow.com/users/5800226/user5800226"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1565018747, "creation_date": 1466956896, "question_id": 38040382, "link": "https://stackoverflow.com/questions/38040382/how-do-i-store-the-access-token-for-reuse", "title": "How do I store the access token for reuse?", "body": "<p>I'm using go's oauth2 package to make requests to Instagram on behalf of a user. The only part I have left to figure out is how to store the access/refresh token and then how do I use it again with oauth2? Here's the code I have so far, all it does is grab the access token and make one request to the API. After that I don't know what to do.</p>\n\n<pre><code>package main\n\nimport \"net/http\"\nimport \"io/ioutil\"\nimport \"fmt\"\nimport \"html/template\"\nimport \"golang.org/x/oauth2\"\n\nvar ClientID = YOUR_CLIENT_ID\n\nvar ClientSecret = YOUR_CLIENT_SECRET\nvar RedirectURI = \"http://localhost:8080/redirect\"\n\nvar authURL = \"https://api.instagram.com/oauth/authorize\"\n\nvar tokenURL = \"https://api.instagram.com/oauth/access_token\"\n\nvar templ = template.Must(template.New(\"index.html\").ParseFiles(\"index.html\"))\n\nvar igConf *oauth2.Config\n\nfunc redirect(res http.ResponseWriter, req *http.Request) {\n\n    code := req.FormValue(\"code\")\n\n    if len(code) != 0 {\n        tok, err := igConf.Exchange(oauth2.NoContext, code)\n        if err != nil {\n            fmt.Println(err)\n            http.NotFound(res, req)\n            return\n        }\n\n        if tok.Valid() {\n            client := igConf.Client(oauth2.NoContext, tok)\n\n            request, err := http.NewRequest(\"GET\", \"https://api.instagram.com/v1/users/self/?access_token=\"+tok.AccessToken, nil)\n            if err != nil {\n                fmt.Println(err)\n                http.NotFound(res, req)\n                return\n            }\n\n            resp, err := client.Do(request)\n            if err != nil {\n                fmt.Println(err)\n                http.NotFound(res, req)\n                return\n            }\n            defer resp.Body.Close()\n\n            body, err := ioutil.ReadAll(resp.Body)\n            if err != nil {\n                fmt.Println(err)\n                http.NotFound(res, req)\n                return\n            }\n\n            res.Write(body)\n        }\n\n        http.NotFound(res, req)\n    }\n\n}\n\nfunc homePage(res http.ResponseWriter, req *http.Request) {\n    url := igConf.AuthCodeURL(\"\", oauth2.AccessTypeOffline)\n    fmt.Println(url)\n    err := templ.Execute(res, url)\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n\nfunc main() {\n    igConf = &amp;oauth2.Config{\n        ClientID:     ClientID,\n        ClientSecret: ClientSecret,\n        Endpoint: oauth2.Endpoint{\n            AuthURL:  authURL,\n            TokenURL: tokenURL,\n        },\n        RedirectURL: RedirectURI,\n        Scopes:      []string{\"public_content\", \"comments\"},\n    }\n\n    http.HandleFunc(\"/redirect\", redirect)\n    http.HandleFunc(\"/\", homePage)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}, {"tags": ["go", "benchmarking"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1466952762, "post_id": 38038717, "comment_id": 63519206, "body": "No, stdandard Benchmark cannot do this simply because it is not generally useful. ns/op/S might be interesting for algorithms which are O(1) only."}], "answers": [{"comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1466951212, "post_id": 38039478, "comment_id": 63518695, "body": "I haven&#39;t done this before and couldn&#39;t find much supporting documents. To me this seems to be the way to do it."}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 9, "last_activity_date": 1466960027, "last_edit_date": 1466960027, "creation_date": 1466951187, "answer_id": 38039478, "question_id": 38038717, "link": "https://stackoverflow.com/questions/38038717/can-golang-benchmark-give-a-custom-output/38039478#38039478", "title": "Can golang benchmark give a custom output?", "body": "<p>You can write a custom benchmark using <a href=\"https://golang.org/pkg/testing/#Benchmark\" rel=\"noreferrer\">Benchmark</a> function from package <code>testing</code>. And get a <code>BenchmarkResult</code> instance you mention.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"testing\"\n)\n\nfunc benchmarkMy(i int) {\n    fn := func(b *testing.B) {\n         // Code you want benchmarked\n    }\n    r := testing.Benchmark(fn)\n\n    fmt.Printf(\"%d ns/op\\n\", int(r.T)/r.N)\n    fmt.Printf(\"%d ns/op/i\\n\", int(r.T)/r.N/i)\n}\n\nfunc main() {\n    benchmarkMy(10)\n}\n</code></pre>\n\n<p>You'll have to put this in a different package and run with <code>go run</code> instead of <code>go test</code>.</p>\n\n<p>Check an example in the <a href=\"https://play.golang.org/p/hWk6QnicEP\" rel=\"noreferrer\">playground</a>.</p>\n"}], "owner": {"reputation": 3468, "user_id": 71978, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ex4dt.jpg?s=128&g=1", "display_name": "TomOnTime", "link": "https://stackoverflow.com/users/71978/tomontime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 2, "accepted_answer_id": 38039478, "answer_count": 1, "score": 4, "last_activity_date": 1466960027, "creation_date": 1466945882, "last_edit_date": 1466952130, "question_id": 38038717, "link": "https://stackoverflow.com/questions/38038717/can-golang-benchmark-give-a-custom-output", "title": "Can golang benchmark give a custom output?", "body": "<p>I'm benchmarking code with different list sizes (lists of size S)  Go benchmark shows ns/op but what I want is (ns/op)/S.</p>\n\n<p>In other words, the output of <code>go test -bench=.</code> is:</p>\n\n<pre><code>BenchmarkMy10-4         100000000           15.7 ns/op\nBenchmarkMy20-4         50000000            33.8 ns/op\nBenchmarkMy30-4         30000000            43.8 ns/op\nBenchmarkMy40-4         30000000            49.3 ns/op\nBenchmarkMy50-4         30000000            56.6 ns/op\nBenchmarkMy1000-4        2000000           686 ns/op\nBenchmarkMy10000-4        200000          6685 ns/op\nBenchmarkMy100000-4        20000         65425 ns/op\n</code></pre>\n\n<p>The \"10\" in \"My10\" represents a list of 10 items (S=10).</p>\n\n<p>While it is useful to know the ns/op for different list sizes, I would also like to know the ns/op/S (time per item in the list).</p>\n\n<p>Right now I'm pasting the results into a spreadsheet and doing the math there. However I'd like to have \"go test\" output this information for me.</p>\n\n<p>My main_test.go file looks like:</p>\n\n<pre><code>import \"testing\"\n\nvar result int\n\nfunc benchmarkMy(i int, b *testing.B) {\n  var r int\n  mylist := MakeList(i)\n  b.ResetTimer()\n  for n := 0; n &lt; b.N; n++ {\n    r = My(mylist)\n  }\n  result = r\n}\n\nfunc BenchmarkMy10(b *testing.B)         { benchmarkMy(10, b) }\nfunc BenchmarkMy20(b *testing.B)         { benchmarkMy(20, b) }\nfunc BenchmarkMy30(b *testing.B)         { benchmarkMy(30, b) }\nfunc BenchmarkMy40(b *testing.B)         { benchmarkMy(40, b) }\nfunc BenchmarkMy50(b *testing.B)         { benchmarkMy(50, b) }\nfunc BenchmarkMy1000(b *testing.B)       { benchmarkMy(1000, b) }\nfunc BenchmarkMy10000(b *testing.B)      { benchmarkMy(10000, b) }\nfunc BenchmarkMy100000(b *testing.B)     { benchmarkMy(100000, b) }\n</code></pre>\n\n<p>It seems like the test.BenchmarkResult structure has the information I need, but I don't see how to use this structure.</p>\n"}, {"tags": ["templates", "go", "go-templates"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1466939686, "post_id": 38037615, "comment_id": 63515569, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/36980049/avoid-auto-escape-in-html-template\">avoid auto escape in html template</a>"}, {"owner": {"reputation": 57, "user_id": 2059095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791897db71b78ee3043a615f663f28b1?s=128&d=identicon&r=PG&f=1", "display_name": "basica", "link": "https://stackoverflow.com/users/2059095/basica"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1466940857, "post_id": 38037615, "comment_id": 63515904, "body": "@icza, thanks for referring me to that link but I can&#39;t see how I can implement that solution here. I&#39;m admittedly still a noob so perhaps that&#39;s why. I did end up finding another question whose solution ended up helping me so I&#39;ve posted that here."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1466941709, "post_id": 38037615, "comment_id": 63516146, "body": "See my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 2059095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791897db71b78ee3043a615f663f28b1?s=128&d=identicon&r=PG&f=1", "display_name": "basica", "link": "https://stackoverflow.com/users/2059095/basica"}, "is_accepted": false, "score": 0, "last_activity_date": 1466940550, "last_edit_date": 1495542770, "creation_date": 1466940550, "answer_id": 38038059, "question_id": 38037615, "link": "https://stackoverflow.com/questions/38037615/prevent-escaping-forward-slashes-in-templates/38038059#38038059", "title": "Prevent escaping forward slashes in templates", "body": "<p>OK, So the solution I've found (and please post if there's a better one) is based on an answer <a href=\"https://stackoverflow.com/questions/14765395/why-am-i-seeing-zgotmplz-in-my-go-html-template-output\">here</a>.</p>\n\n<p>I changed the struct I was using from:</p>\n\n<pre><code>type File struct {\n    FullFilePath string\n    FileName     string\n}\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>type File struct {\n    FullFilePath template.HTML\n    FileName     string\n}\n</code></pre>\n\n<p>And moved the html into the FullFilePath name, and then placed that in template.HTML so each FullFilePath name I was generating was done like so:</p>\n\n<pre><code>file := File{template.HTML(\"&lt;a href=\\\"/file?file=\" + path + \"\\\"&lt;/a&gt;\"), f.Name()}\n</code></pre>\n\n<p>And my template file line was changed to this:</p>\n\n<pre><code>&lt;tr&gt;&lt;td&gt;{{.FullFilePath}}{{.FileName}}&lt;/td&gt;&lt;/tr&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 2059095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791897db71b78ee3043a615f663f28b1?s=128&d=identicon&r=PG&f=1", "display_name": "basica", "link": "https://stackoverflow.com/users/2059095/basica"}, "edited": false, "score": 0, "creation_date": 1466942938, "post_id": 38038198, "comment_id": 63516439, "body": "Thanks, this is much appreciated. Thanks for explaining the security risks involved, in my case it&#39;s not applicable (this is just something I use at home, not public facing) but it&#39;s useful for others to know."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 57, "user_id": 2059095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791897db71b78ee3043a615f663f28b1?s=128&d=identicon&r=PG&f=1", "display_name": "basica", "link": "https://stackoverflow.com/users/2059095/basica"}, "edited": false, "score": 1, "creation_date": 1466942985, "post_id": 38038198, "comment_id": 63516450, "body": "@basica Also see the note added to the end: never parse templates in the handler functions (it&#39;s slow, and should be done prior to calling handlers)."}, {"owner": {"reputation": 1934, "user_id": 342359, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40d592cd1b79374d5fef85b427c7c5f7?s=128&d=identicon&r=PG", "display_name": "zengabor", "link": "https://stackoverflow.com/users/342359/zengabor"}, "edited": false, "score": 0, "creation_date": 1571935218, "post_id": 38038198, "comment_id": 103412516, "body": "Unfortunately this technique doesn&#39;t seem to work in JavaScript on* handlers, like onclick: <a href=\"https://play.golang.org/p/E_TU3xPAq6s\" rel=\"nofollow noreferrer\">play.golang.org/p/E_TU3xPAq6s</a>"}, {"owner": {"reputation": 1934, "user_id": 342359, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40d592cd1b79374d5fef85b427c7c5f7?s=128&d=identicon&r=PG", "display_name": "zengabor", "link": "https://stackoverflow.com/users/342359/zengabor"}, "edited": false, "score": 0, "creation_date": 1571935899, "post_id": 38038198, "comment_id": 103412848, "body": "Looks like there is an easy workaround lol: <a href=\"https://play.golang.org/p/d0l9Pb26oqT\" rel=\"nofollow noreferrer\">play.golang.org/p/d0l9Pb26oqT</a>"}, {"owner": {"reputation": 1934, "user_id": 342359, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40d592cd1b79374d5fef85b427c7c5f7?s=128&d=identicon&r=PG", "display_name": "zengabor", "link": "https://stackoverflow.com/users/342359/zengabor"}, "edited": false, "score": 0, "creation_date": 1572515266, "post_id": 38038198, "comment_id": 103586733, "body": "FYI: the above workaround which works on play.golang.org doesn&#39;t work on my server: a space is inserted between &quot;o&quot; and &quot;nclick&quot;. Sill looking for a fix."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1472730249, "last_edit_date": 1495540849, "creation_date": 1466941521, "answer_id": 38038198, "question_id": 38037615, "link": "https://stackoverflow.com/questions/38037615/prevent-escaping-forward-slashes-in-templates/38038198#38038198", "title": "Prevent escaping forward slashes in templates", "body": "<p>As the value of <code>.FullFilePath</code>, pass a value of type <a href=\"https://golang.org/pkg/html/template/#URL\" rel=\"nofollow noreferrer\"><code>template.URL</code></a> instead of <code>string</code>, which will tell the <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\"><code>html/template</code></a> package not to escape it.</p>\n\n<p>For example:</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Parse(templ))\n\n    m := map[string]interface{}{\n        \"FileName\":     \"something.txt\",\n        \"FileFullPath\": template.URL(\"/location/to/something\"),\n    }\n\n    if err := t.Execute(os.Stdout, m); err != nil {\n        panic(err)\n    }\n}\n\nconst templ = `&lt;tr&gt;&lt;td&gt;&lt;a href=\"/file?file={{.FileFullPath}}\"&gt;{{.FileName}}&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/om2dyE-Z-W\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&lt;tr&gt;&lt;td&gt;&lt;a href=\"/file?file=/location/to/something\"&gt;something.txt&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n</code></pre>\n\n<p>Note that even though forward slashes <code>/</code> are allowed in URLs, the reason why the <code>template</code> package still encodes them is because it analyses the URL and sees that the value you want to include is the value of a URL parameter (<code>file=XXX</code>), and so it also encodes the slashes (so that everything you pass in will be part of the value of the <code>file</code> URL parameter).</p>\n\n<p>If you plan to acquire this file path at the server side from URL parameters, then what the <code>template</code> package does is the correct and proper way.</p>\n\n<p>But know that by doing this, you'll lose the safety that prevents code injection into URLs. If you're the one providing the values and you know they are safe, there is no problem. But if the data comes from a user input for example, never do this.</p>\n\n<p>Also note that if you pass the whole URL (and not just a part of it), it will work without using <code>template.URL</code> (try this variant on the <a href=\"https://play.golang.org/p/sKji20On0_\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Parse(templ))\n\n    m := map[string]interface{}{\n        \"FileName\": \"something.txt\",\n        \"FileURL\":  \"/file?file=/location/to/something\",\n    }\n\n    if err := t.Execute(os.Stdout, m); err != nil {\n        panic(err)\n    }\n}\n\nconst templ = `&lt;tr&gt;&lt;td&gt;&lt;a href=\"{{.FileURL}}\"&gt;{{.FileName}}&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;`\n</code></pre>\n\n<p>Also note that the recommended way in my opinion would be to include the file path as part of the URL path and not as the value of a parameter, so instead you should create urls like this:</p>\n\n<pre><code>/file/location/to/something\n</code></pre>\n\n<p>Map your handler (which serves the file content, see <a href=\"https://stackoverflow.com/a/28899786/1705598\">this answer</a> as an example) to the <code>/file/</code> pattern, and when it is matched and your handler is called, cut off the <code>/file/</code> prefix from the path <code>r.URL.Path</code>, and the rest will be the full file path. If you choose this, you also won't need the <code>template.URL</code> conversion (because the value you include is not a value of a URL parameter anymore):</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Parse(templ))\n\n    m := map[string]interface{}{\n        \"FileName\":     \"something.txt\",\n        \"FileFullPath\": \"/location/to/something\",\n    }\n\n    if err := t.Execute(os.Stdout, m); err != nil {\n        panic(err)\n    }\n}\n\nconst templ = `&lt;tr&gt;&lt;td&gt;&lt;a href=\"/file{{.FileFullPath}}\"&gt;{{.FileName}}&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;`\n</code></pre>\n\n<p>Try this on the <a href=\"https://play.golang.org/p/VTxDasztY7\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Also very important: never parse templates in your handler functions! For details see:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28451675/it-takes-too-much-time-when-using-template-package-to-generate-a-dynamic-web-p\">It takes too much time when using &quot;template&quot; package to generate a dynamic web page to client in golang</a></p>\n"}], "owner": {"reputation": 57, "user_id": 2059095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791897db71b78ee3043a615f663f28b1?s=128&d=identicon&r=PG&f=1", "display_name": "basica", "link": "https://stackoverflow.com/users/2059095/basica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2962, "favorite_count": 0, "accepted_answer_id": 38038198, "answer_count": 2, "score": 1, "last_activity_date": 1472730249, "creation_date": 1466937385, "question_id": 38037615, "link": "https://stackoverflow.com/questions/38037615/prevent-escaping-forward-slashes-in-templates", "title": "Prevent escaping forward slashes in templates", "body": "<p>I'm working on converting a pet project of mine from Python to Go just to help me get a bit familiar with the language. An issue I am currently facing is that it's escaping my forward slashes. So it will receive a string like:</p>\n\n<pre><code>/location/to/something\n</code></pre>\n\n<p>and it then becomes</p>\n\n<pre><code>%2flocation%2fto%2fsomething\n</code></pre>\n\n<p>Now, it's only doing this when it's in a link (from what I've been reading this escaping is contextual) so this is what the line in the HTML template looks like:</p>\n\n<pre><code>&lt;tr&gt;&lt;td&gt;&lt;a href=\"/file?file={{.FullFilePath}}\"&gt;{{.FileName}}&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n</code></pre>\n\n<p>If possible, how can I prevent this in either the template or the code itself?</p>\n\n<p>This is what my templating function looks like (yes, I know it's hackish)</p>\n\n<pre><code>func renderTemplate(w http.ResponseWriter, tmpl string) {\n    t, err := template.ParseFiles(templates_dir+\"base.html\", templates_dir+tmpl)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    if tmpl == \"view.html\" {\n        err = t.Execute(w, FileList)\n    } else {\n        err = t.Execute(w, nil)\n    }\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1466934162, "post_id": 38036752, "comment_id": 63514032, "body": "Possible duplicate of this <a href=\"http://stackoverflow.com/questions/20271123/how-to-execute-an-in-lookup-in-sql-using-golang\">How to execute an IN lookup in SQL using Golang?</a>."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1466934426, "post_id": 38036752, "comment_id": 63514110, "body": "Thank you @MarioAlexandroSantini. Will take a looks. It is disappointing that I have not found it (I actually looked)"}, {"owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "edited": false, "score": 0, "creation_date": 1466943335, "post_id": 38036752, "comment_id": 63516553, "body": "I suggest you to use some library that handles this cases for you, without reinventing the wheel. <a href=\"https://github.com/galeone/igor#where-1\" rel=\"nofollow noreferrer\">igor</a> handles this (and other) case for you."}], "answers": [{"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1466933612, "post_id": 38037023, "comment_id": 63513899, "body": "and this is exactly what I am asking about. How to do this. The problem is that your answer does not explain how to achieve it."}, {"owner": {"reputation": 3709, "user_id": 3902367, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7cf72dbd2609b3e002de28cb65046679?s=128&d=identicon&r=PG&f=1", "display_name": "arunjos007", "link": "https://stackoverflow.com/users/3902367/arunjos007"}, "edited": false, "score": 0, "creation_date": 1606814693, "post_id": 38037023, "comment_id": 115069091, "body": "I think this will not work now it is expecting interface{} and it will give the error &quot;Cannot use xxx (type []int) as type []interface {} in argument to DB.QueryContext&quot;"}], "tags": [], "owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "is_accepted": false, "score": 6, "last_activity_date": 1560502348, "last_edit_date": 1560502348, "creation_date": 1466933182, "answer_id": 38037023, "question_id": 38036752, "link": "https://stackoverflow.com/questions/38036752/go-and-in-clause-in-postgres/38037023#38037023", "title": "Go and IN clause in Postgres", "body": "<p>This is not really a Golang issue, you are using a string to compare to integer (id) in your SQL request. That means, SQL receive:</p>\n\n<pre><code>SELECT COUNT(id)\nFROM tags\nWHERE id IN (\"1, 2, 3\")\n</code></pre>\n\n<p>instead of what you want to give it. You just need to convert your tags into integer and passe it to the query.</p>\n\n<p>EDIT:\nSince you are trying to pass multiple value to the query, then you should tell it:</p>\n\n<pre><code>params := make([]string, 0, len(tags))\nfor i := range tags {\n    params = append(params, fmt.Sprintf(\"$%d\", i+1))\n}\nquery := fmt.Sprintf(\"SELECT COUNT(id) FROM tags WHERE id IN (%s)\", strings.Join(params, \", \"))\n</code></pre>\n\n<p>This will end the query with a \"($1, $2, $3...\", then convert your tags as int:</p>\n\n<pre><code>values := make([]int, 0, len(tags))\nfor _, s := range tags {\n    val, err := strconv.Atoi(s)\n    if err != nil {\n        // Do whatever is required with the error\n        fmt.Println(\"Err : \", err)\n    } else {\n        values = append(values, val)\n    }\n}\n</code></pre>\n\n<p>And finally, you can use it in the query:</p>\n\n<pre><code>Db.QueryRow(query, values...)\n</code></pre>\n\n<p>This should do it.</p>\n"}, {"comments": [{"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 1, "creation_date": 1469333144, "post_id": 38037586, "comment_id": 64488706, "body": "I&#39;d like to add that these days there are quite a few libraries trying to simplify database use in go. Particularly for MySQL and PostgreSQL. And many simplify passing IN parameters as well. For example, gocraft/dbr and jmoiron/sqlx come to mind."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1520015740, "post_id": 38037586, "comment_id": 85156521, "body": "I find that the array constructor syntax (<code>array[1,2,3]</code>) is easier to use than than braces (<code>&#39;{1,2,3}&#39;::int[]</code>) for PostgreSQL arrays, fewer quoting problems. Of course that means that you&#39;d have to produce a list of placeholders (<code>array[$1,$2,$3]</code>) but that&#39;s easy enough."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 18, "last_activity_date": 1466972584, "last_edit_date": 1466972584, "creation_date": 1466937181, "answer_id": 38037586, "question_id": 38036752, "link": "https://stackoverflow.com/questions/38036752/go-and-in-clause-in-postgres/38037586#38037586", "title": "Go and IN clause in Postgres", "body": "<h3>Pre-building the SQL query (preventing SQL injection)</h3>\n\n<p>If you're generating an SQL string with a param placeholder for each of the values, it's easier to just generate the final SQL right away.</p>\n\n<p>Note that since values are <code>string</code>s, there's place for SQL injection attack, so we first test if all the <code>string</code> values are indeed numbers, and we only proceed if so:</p>\n\n<pre><code>tags := []string{\"1\", \"2\", \"3\"}\nbuf := bytes.NewBufferString(\"SELECT COUNT(id) FROM tags WHERE id IN(\")\nfor i, v := range tags {\n    if i &gt; 0 {\n        buf.WriteString(\",\")\n    }\n    if _, err := strconv.Atoi(v); err != nil {\n        panic(\"Not number!\")\n    }\n    buf.WriteString(v)\n}\nbuf.WriteString(\")\")\n</code></pre>\n\n<p>Executing it:</p>\n\n<pre><code>num := 0\nif err := Db.QueryRow(buf.String()).Scan(&amp;num); err != nil {\n    log.Println(err)\n}\n</code></pre>\n\n<h3>Using <code>ANY</code></h3>\n\n<p>You can also use <a href=\"https://www.postgresql.org/docs/9.5/static/functions-comparisons.html\" rel=\"noreferrer\">Postgresql's <code>ANY</code></a>, whose syntax is as follows:</p>\n\n<pre><code>expression operator ANY (array expression)\n</code></pre>\n\n<p>Using that, our query may look like this:</p>\n\n<pre><code>SELECT COUNT(id) FROM tags WHERE id = ANY('{1,2,3}'::int[])\n</code></pre>\n\n<p>In this case you can declare the text form of the array as a parameter:</p>\n\n<pre><code>SELECT COUNT(id) FROM tags WHERE id = ANY($1::int[])\n</code></pre>\n\n<p>Which can simply be built like this:</p>\n\n<pre><code>tags := []string{\"1\", \"2\", \"3\"}\nparam := \"{\" + strings.Join(tags, \",\") + \"}\"\n</code></pre>\n\n<p>Note that no check is required in this case as the array expression will not allow SQL injection (but rather will result in a query execution error).</p>\n\n<p>So the full code:</p>\n\n<pre><code>tags := []string{\"1\", \"2\", \"3\"}\n\nq := \"SELECT COUNT(id) FROM tags WHERE id = ANY($1::int[])\"\nparam := \"{\" + strings.Join(tags, \",\") + \"}\"\n\nnum := 0\nif err := Db.QueryRow(q, param).Scan(&amp;num); err != nil {\n    log.Println(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7099, "favorite_count": 4, "accepted_answer_id": 38037586, "answer_count": 2, "score": 14, "last_activity_date": 1560502348, "creation_date": 1466930754, "last_edit_date": 1469176125, "question_id": 38036752, "link": "https://stackoverflow.com/questions/38036752/go-and-in-clause-in-postgres", "title": "Go and IN clause in Postgres", "body": "<p>I am trying to execute the following query against the PostgreSQL database in Go using <a href=\"https://github.com/lib/pq\" rel=\"noreferrer\">pq driver</a>:</p>\n\n<pre><code>SELECT COUNT(id)\nFROM tags\nWHERE id IN (1, 2, 3)\n</code></pre>\n\n<p>where <code>1, 2, 3</code> is passed at a slice <code>tags := []string{\"1\", \"2\", \"3\"}</code>.</p>\n\n<p>I have tried many different things like:</p>\n\n<pre><code>s := \"(\" + strings.Join(tags, \",\") + \")\"\nif err := Db.QueryRow(`\n    SELECT COUNT(id)\n    FROM tags\n    WHERE id IN $1`, s,\n).Scan(&amp;num); err != nil {\n    log.Println(err)\n}\n</code></pre>\n\n<p>which results in <code>pq: syntax error at or near \"$1\"</code>. I also tried </p>\n\n<pre><code>if err := Db.QueryRow(`\n    SELECT COUNT(id)\n    FROM tags\n    WHERE id IN ($1)`, strings.Join(stringTagIds, \",\"),\n).Scan(&amp;num); err != nil {\n    log.Println(err)\n}\n</code></pre>\n\n<p>which also fails with <code>pq: invalid input syntax for integer: \"1,2,3\"</code></p>\n\n<p>I also tried passing a slice of integers/strings directly and got <code>sql: converting Exec argument #0's type: unsupported type []string, a slice</code>.</p>\n\n<p>So how can I execute this query in Go?</p>\n"}, {"tags": ["javascript", "templates", "canvas", "go"], "answers": [{"tags": [], "owner": {"reputation": 991, "user_id": 2155614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-yPPj1XVo0uI/AAAAAAAAAAI/AAAAAAAAACQ/NW3rM807aQs/photo.jpg?sz=128", "display_name": "andor kesselman", "link": "https://stackoverflow.com/users/2155614/andor-kesselman"}, "is_accepted": true, "score": 1, "last_activity_date": 1466920170, "creation_date": 1466920170, "answer_id": 38035609, "question_id": 38035176, "link": "https://stackoverflow.com/questions/38035176/insert-javascript-snippet-inside-template-with-beego-golang/38035609#38035609", "title": "Insert JavaScript Snippet Inside Template with Beego/GoLang", "body": "<p>The answer was </p>\n\n<pre><code> import \"html/template\"\n\n //within function\n c.Data[\"Javascript\"] = template.JS(JavasciptStringObject)\n</code></pre>\n\n<p>Note: template.JSEscape did not work. </p>\n"}], "owner": {"reputation": 991, "user_id": 2155614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-yPPj1XVo0uI/AAAAAAAAAAI/AAAAAAAAACQ/NW3rM807aQs/photo.jpg?sz=128", "display_name": "andor kesselman", "link": "https://stackoverflow.com/users/2155614/andor-kesselman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 38035609, "answer_count": 1, "score": 0, "last_activity_date": 1481677287, "creation_date": 1466914934, "last_edit_date": 1495540424, "question_id": 38035176, "link": "https://stackoverflow.com/questions/38035176/insert-javascript-snippet-inside-template-with-beego-golang", "title": "Insert JavaScript Snippet Inside Template with Beego/GoLang", "body": "<p>What is the best method to insert a javascript snippet into a template for Golang using the Beego framework?</p>\n\n<p>Currently, I am just adding data to a template:</p>\n\n<pre><code>c.Data[\"Javascript\"] = JavasciptStringObject\n</code></pre>\n\n<p>And in a script.tpl file adding insertion points:</p>\n\n<pre><code> var canvas = new fabric.Canvas('c');\n canvas.setHeight(571); //todo: Set to height of image\n canvas.setWidth(991);\n {{.JavaScript}}\n</code></pre>\n\n<p>The problem is that it escapes the quotation marks from the string, rather than injecting directly in: </p>\n\n<pre><code>var canvas = new fabric.Canvas('c');\ncanvas.setHeight(571); \ncanvas.setWidth(991);\n\"var path = new fabric.Path('M 617 141 L 606 126M 606 126 L 604 127 z', { stroke: 'red', strokeWidth: 2, fill: false, originX: 'left', originY: 'top',});canvas.add(path); \"\n</code></pre>\n\n<p>Some useful resources include Golang HTML Templating Doc, which apparently Beego models: <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/html/template/</a></p>\n\n<p>And this stack overflow seems to be getting closer, I don't think this will work with Beego: <a href=\"https://stackoverflow.com/questions/14226416/go-lang-templates-always-quotes-a-string-and-removes-comments\">Go lang templates: always quotes a string and removes comments</a></p>\n"}, {"tags": ["mongodb", "rest", "go", "mgo"], "comments": [{"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 0, "creation_date": 1519201530, "post_id": 38033834, "comment_id": 84807575, "body": "mongodb <code>FindAll</code> --&gt; query Returns Array of Objects not An Object  instead of    <code>result := models.User{}</code>   u can use  <code>result := []models.User{} </code> --&gt; will solve your Issue"}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 2507262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e60b9190b4c90084a737a7b3c4b4a4?s=128&d=identicon&r=PG", "display_name": "ozfive", "link": "https://stackoverflow.com/users/2507262/ozfive"}, "edited": false, "score": 0, "creation_date": 1466906452, "post_id": 38034323, "comment_id": 63509202, "body": "I did all the changes you suggested and now I am receiving this error on build: models.User literal is not a type  my User struct is located in an anonymous type"}, {"owner": {"reputation": 318, "user_id": 2507262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e60b9190b4c90084a737a7b3c4b4a4?s=128&d=identicon&r=PG", "display_name": "ozfive", "link": "https://stackoverflow.com/users/2507262/ozfive"}, "edited": false, "score": 0, "creation_date": 1466909451, "post_id": 38034323, "comment_id": 63509614, "body": "Thank you for the edit! It didn&#39;t solve the issue though. This is how my User definition is. It should be right.  type (                  User struct {                 Id          bson.ObjectId <code>json:&quot;id&quot; bson:&quot;_id&quot;</code>                 FirstName   string        <code>json:&quot;firstname&quot; bson:&quot;firstname&quot;</code>                 LastName    string        <code>json:&quot;lastname&quot; bson:&quot;lastname&quot;</code>                 UserName    string        <code>json:&quot;username&quot; bson:&quot;username&quot;</code>                 Password    string        <code>json:&quot;password&quot; bson:&quot;password&quot;</code>         } )"}], "tags": [], "owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "is_accepted": true, "score": 7, "last_activity_date": 1466909902, "last_edit_date": 1466909902, "creation_date": 1466902739, "answer_id": 38034323, "question_id": 38033834, "link": "https://stackoverflow.com/questions/38033834/golang-mongodb-error-result-argument-must-be-a-slice-address/38034323#38034323", "title": "Golang MongoDB Error: result argument must be a slice address", "body": "<p>In your code you have:</p>\n\n<pre><code>// Stub user\nresult := models.User{}\n</code></pre>\n\n<p>So result represents a single user, but you want all the users from the database, so the following should do the job:</p>\n\n<pre><code>// Stub user\nresult := make([]models.User, 0, 10) // Here you can specify a len and a cap.\n</code></pre>\n\n<p>This way, result is a slice of models.User.</p>\n\n<p>Also, in Golang, you should never ignore an error:</p>\n\n<pre><code>// Marshal provided interface into JSON structure\nmResult, _ := json.Marshal(result)\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>// Marshal provided interface into JSON structure\nmResult, err := json.Marshal(result)\nif err != nil {\n    // do something with the error (log it or write it in the response)\n}\n</code></pre>\n\n<p>EDIT: I updated the code, sorry for that.</p>\n"}], "owner": {"reputation": 318, "user_id": 2507262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e60b9190b4c90084a737a7b3c4b4a4?s=128&d=identicon&r=PG", "display_name": "ozfive", "link": "https://stackoverflow.com/users/2507262/ozfive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4916, "favorite_count": 0, "accepted_answer_id": 38034323, "answer_count": 1, "score": 4, "last_activity_date": 1466909902, "creation_date": 1466897283, "question_id": 38033834, "link": "https://stackoverflow.com/questions/38033834/golang-mongodb-error-result-argument-must-be-a-slice-address", "title": "Golang MongoDB Error: result argument must be a slice address", "body": "<p>I have a function that needs to retrieve all users from a mongoDB collection which is throwing an error when I try to call it through a REST endpoint. The function is:</p>\n\n<pre><code>func (usercontroller UserController) GetAllUsers(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n        session := usercontroller.session.Copy()\n        defer session.Close()\n\n        // Stub user\n        result := models.User{}\n\n        // get all users\n        if err := session.DB(\"Auth\").C(\"users\").Find(nil).All(&amp;result); err != nil {\n                w.WriteHeader(404)\n                return\n        }\n\n        // Marshal provided interface into JSON structure\n        mResult, _ := json.Marshal(result)\n\n        // Write content-type, statuscode, and the data package\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.WriteHeader(200)\n        fmt.Fprintf(w, \"%s\", mResult)\n}\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>2016/06/25 16:00:21 http: panic serving 127.0.0.1:49898: result argument must be a slice address\ngoroutine 13 [running]:\nnet/http.(*conn).serve.func1(0xc82005e380)\n    /usr/lib/go-1.6/src/net/http/server.go:1389 +0xc1\npanic(0x729b60, 0xc82000ba50)\n    /usr/lib/go-1.6/src/runtime/panic.go:443 +0x4e9\ngopkg.in/mgo%2ev2.(*Iter).All(0xc8201280f0, 0x704600, 0xc82007e360, 0x0, 0x0)\n    /root/work/src/gopkg.in/mgo.v2/session.go:3696 +0x742\ngopkg.in/mgo%2ev2.(*Query).All(0xc8200bc600, 0x704600, 0xc82007e360, 0x0, 0x0)\n    /root/work/src/gopkg.in/mgo.v2/session.go:3723 +0x4f\nAuth-REST-Server/controllers.UserController.GetAllUsers(0xc82000d040, 0x7f3c1b9bf950, 0xc820061c70, 0xc8200c6380, 0x0, 0x0, 0x0)\n    /root/work/src/Auth-REST-Server/controllers/user.go:34 +0x251\nAuth-REST-Server/controllers.(UserController).GetAllUsers-fm(0x7f3c1b9bf950, 0xc820061c70, 0xc8200c6380, 0x0, 0x0, 0x0)\n    /root/work/src/Auth-REST-Server/server.go:21 +0x5f\ngithub.com/julienschmidt/httprouter.(*Router).ServeHTTP(0xc820016380, 0x7f3c1b9bf950, 0xc820061c70, 0xc8200c6380)\n    /root/work/src/github.com/julienschmidt/httprouter/router.go:344 +0x195\nnet/http.serverHandler.ServeHTTP(0xc820122000, 0x7f3c1b9bf950, 0xc820061c70, 0xc8200c6380)\n    /usr/lib/go-1.6/src/net/http/server.go:2081 +0x19e\nnet/http.(*conn).serve(0xc82005e380)\n    /usr/lib/go-1.6/src/net/http/server.go:1472 +0xf2e\ncreated by net/http.(*Server).Serve\n    /usr/lib/go-1.6/src/net/http/server.go:2137 +0x44e\n</code></pre>\n\n<p>What am I doing wrong here. I thought I could just call Find(nil).All(&amp;result) and retrieve all of the records accordingly. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5109610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd3dd2c66e312365cb6cfd710df7fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Mat&#250;\u0161 Ka\u010dm&#225;r", "link": "https://stackoverflow.com/users/5109610/mat%c3%ba%c5%a1-ka%c4%8dm%c3%a1r"}, "edited": false, "score": 0, "creation_date": 1466895974, "post_id": 38033707, "comment_id": 63507607, "body": "the file path is logFile.txt"}, {"owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "reply_to_user": {"reputation": 91, "user_id": 5109610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd3dd2c66e312365cb6cfd710df7fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Mat&#250;\u0161 Ka\u010dm&#225;r", "link": "https://stackoverflow.com/users/5109610/mat%c3%ba%c5%a1-ka%c4%8dm%c3%a1r"}, "edited": false, "score": 2, "creation_date": 1466896634, "post_id": 38033707, "comment_id": 63507712, "body": "I ran your code. the issue I can see is that your config struct only has non-exported field (starting with lower-case letters) therefore the json package can&#39;t see them."}, {"owner": {"reputation": 91, "user_id": 5109610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd3dd2c66e312365cb6cfd710df7fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Mat&#250;\u0161 Ka\u010dm&#225;r", "link": "https://stackoverflow.com/users/5109610/mat%c3%ba%c5%a1-ka%c4%8dm%c3%a1r"}, "edited": false, "score": 0, "creation_date": 1466896689, "post_id": 38033707, "comment_id": 63507715, "body": "Yeah figured that out already repaired that its working now. Thanks for the help anyway."}], "tags": [], "owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "is_accepted": true, "score": 3, "last_activity_date": 1466895915, "creation_date": 1466895915, "answer_id": 38033707, "question_id": 38033557, "link": "https://stackoverflow.com/questions/38033557/os-openfile-with-o-create-flag-throws-no-such-file-or-directory/38033707#38033707", "title": "os.OpenFile with O_CREATE flag throws no such file or directory", "body": "<p>The error is most likely that the path you want to create your file in doesn't exist. it will create the logfile, but not the parent directories if they don't exist.\nTo create the necessary directory structure, you could use <a href=\"https://golang.org/pkg/os/#MkdirAll\" rel=\"nofollow\"><code>os.MkdirAll</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 5109610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd3dd2c66e312365cb6cfd710df7fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Mat&#250;\u0161 Ka\u010dm&#225;r", "link": "https://stackoverflow.com/users/5109610/mat%c3%ba%c5%a1-ka%c4%8dm%c3%a1r"}, "is_accepted": false, "score": 1, "last_activity_date": 1466896777, "creation_date": 1466896777, "answer_id": 38033784, "question_id": 38033557, "link": "https://stackoverflow.com/questions/38033557/os-openfile-with-o-create-flag-throws-no-such-file-or-directory/38033784#38033784", "title": "os.OpenFile with O_CREATE flag throws no such file or directory", "body": "<p>The problem was that json serverConfiguration had no values because it was not exported it needs to be like this:</p>\n\n<pre><code>// ServerConfiguration structs holds server configuration data from config json.\ntype ServerConfiguration struct {\n    Port                    string `json:\"port\"`\n    LogFileName             string `json:\"logFileName\"`\n    SessionStorePhrase      string `json:\"sessionStorePhrase\"`\n    ResourceFilesPath       string `json:\"resourceFilesPath\"`\n    ResourceFilesPathPrefix string `json:\"resourceFilesPathPrefix\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5109610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd3dd2c66e312365cb6cfd710df7fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Mat&#250;\u0161 Ka\u010dm&#225;r", "link": "https://stackoverflow.com/users/5109610/mat%c3%ba%c5%a1-ka%c4%8dm%c3%a1r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3291, "favorite_count": 0, "accepted_answer_id": 38033707, "answer_count": 2, "score": 4, "last_activity_date": 1466896777, "creation_date": 1466894393, "question_id": 38033557, "link": "https://stackoverflow.com/questions/38033557/os-openfile-with-o-create-flag-throws-no-such-file-or-directory", "title": "os.OpenFile with O_CREATE flag throws no such file or directory", "body": "<p>I'm trying to open a log file with os package using os.OpenFile function, which should with proper flag create file if such file does not exists. But it returns non nil error: No such file or directory. BTW I'm using linux and go 1.6. Log file opening happens in init function. Heres my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/gorilla/mux\"\n    \"github.com/gorilla/sessions\"\n)\n\n// Structs holds server configuration data from config json.\ntype serverConfiguration struct {\n    port                    string\n    logFileName             string\n    sessionStorePhrase      string\n    resourceFilesPath       string\n    resourceFilesPathPrefix string\n}\n\n// Server global variables.\nvar (\n    serverConfig serverConfiguration\n    logFile      *os.File\n    router       *mux.Router\n    sessionStore *sessions.CookieStore\n)\n\nfunc init() {\n    // temporary variables.\n    var (\n        configFile                                   *os.File\n        serverConfErr, configDecodingErr, logFileErr error\n    )\n\n    // Loads json config file.\n    configFile, serverConfErr = os.Open(\"server-conf.json\")\n    defer configFile.Close()\n\n    if serverConfErr != nil {\n        log.Fatal(\"SERVER-CONFIG-ERROR: \", serverConfErr)\n    }\n\n    // Decodes json to serverConfig struct.\n    decoder := json.NewDecoder(configFile)\n    serverConfig = serverConfiguration{}\n    configDecodingErr = decoder.Decode(&amp;serverConfig)\n\n    if configDecodingErr != nil {\n        log.Fatal(\"CONFIGURATION-DECODING-ERROR: \", configDecodingErr)\n    }\n\n    // Opens log file in app root directory.\n    logFile, logFileErr = os.OpenFile(serverConfig.logFileName, os.O_WRONLY|os.O_CREATE|os.O_APPEND, 0666)\n\n    if logFileErr != nil {\n        log.Fatal(\"LOG-FILE-ERROR: \", logFileErr)\n    }\n\n    // Creates session store.\n    sessionStore = sessions.NewCookieStore([]byte(serverConfig.sessionStorePhrase))\n}\n\n// Home page handler.\nfunc homePageHandler(writer http.ResponseWriter, request *http.Request) {\n    fmt.Fprint(writer, \"asdasdasdasd\")\n}\n\nfunc main() {\n    defer logFile.Close()\n    router = mux.NewRouter().StrictSlash(false)\n    resourceFileServer := http.FileServer(http.Dir(serverConfig.resourceFilesPath))\n    router.PathPrefix(serverConfig.resourceFilesPathPrefix).Handler(http.StripPrefix(serverConfig.resourceFilesPathPrefix, resourceFileServer))\n\n    router.HandleFunc(\"/\", homePageHandler)\n\n    server := &amp;http.Server{\n        Addr:    serverConfig.port,\n        Handler: router,\n    }\n\n    log.Println(\"Server listening on port \", serverConfig.port)\n    server.ListenAndServe()\n}\n</code></pre>\n"}, {"tags": ["ssl", "go", "tls1.2", "starttls"], "comments": [{"owner": {"reputation": 2611, "user_id": 872918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b89d3f5413870b28a39767f0289c32b?s=128&d=identicon&r=PG", "display_name": "snap", "link": "https://stackoverflow.com/users/872918/snap"}, "edited": false, "score": 0, "creation_date": 1467065118, "post_id": 38033511, "comment_id": 63566866, "body": "Could you check with tcpdump or similar tool if the client sends the TLS Client Hello packet or not? That would narrow the problem down to either client or server side."}], "answers": [{"tags": [], "owner": {"reputation": 2611, "user_id": 872918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b89d3f5413870b28a39767f0289c32b?s=128&d=identicon&r=PG", "display_name": "snap", "link": "https://stackoverflow.com/users/872918/snap"}, "is_accepted": false, "score": 0, "last_activity_date": 1467065588, "creation_date": 1467065588, "answer_id": 38064026, "question_id": 38033511, "link": "https://stackoverflow.com/questions/38033511/golang-tls-handshake-hangs-after-connection-upgrade/38064026#38064026", "title": "Golang: tls.Handshake hangs after connection upgrade", "body": "<p>Do you call c.conn.Handshake() or do something else to initiate the TLS handshake on the client side?</p>\n\n<p>If the client does not initiate the handshake by sending TLS Client Hello, the server will sit forever waiting for it.</p>\n\n<p>This is my best guess as you did not provide much of the client side code. Also checking with tcpdump would help to narrow the problem down (to server or client side).</p>\n"}], "owner": {"reputation": 83, "user_id": 3577085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7d3161e0f0dfac82773645a9a6690e?s=128&d=identicon&r=PG&f=1", "display_name": "acisola", "link": "https://stackoverflow.com/users/3577085/acisola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 783, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467065588, "creation_date": 1466893765, "last_edit_date": 1495540905, "question_id": 38033511, "link": "https://stackoverflow.com/questions/38033511/golang-tls-handshake-hangs-after-connection-upgrade", "title": "Golang: tls.Handshake hangs after connection upgrade", "body": "<p>I am writing a TCP text protocol for a project that I am working on. One of the commands in the protocol is <code>STARTTLS</code> which should upgrade the connection to TLS and continue on. My code to upgrade the connection is similar to the answer in <a href=\"https://stackoverflow.com/questions/13110713/upgrade-a-connection-to-tls-in-go\">this question</a>. The problem I am having is when I am upgrading the TLS connection, the <code>tlsConn.Handshake</code> will hang and never let go. There are some code samples below. Any help is greatly appreciated.</p>\n\n<p>After the <code>STARTTLS</code> command is received...</p>\n\n<pre><code>// Init a new TLS connection. I need a *tls.Conn type                                                                \n// so that I can do the Handshake()                                                                                  \ns.Logf(\"++&gt; Upgrading connection to TLS\")\ntlsConn := tls.Server(s.Conn, s.Server.TLSConfig)\ns.Logf(\"++&gt; Attempting TLS Handshake\")\n\ntlsConn.Handshake()\ns.Logf(\"++&gt; TLS Handshake Successful\")\n\n// Here is the trick. Since I do not need to access                                                                  \n// any of the TLS functions anymore,                                                                                 \n// I can convert tlsConn back in to a net.Conn type                                                                  \ns.Conn = net.Conn(tlsConn)\n\ns.Logf(\"++&gt; Updating read/write buffers\")\ns.reader = textproto.NewReader(bufio.NewReader(s.Conn))\ns.writer = textproto.NewWriter(bufio.NewWriter(s.Conn))\n\ns.Printf(\"100 SUCCESS\")\n</code></pre>\n\n<p>The client is currently upgrading the connection right after it sends the <code>STARTTLS</code> command like this...</p>\n\n<pre><code>c.conn = tls.Client(c.conn, clientTLSConfig)\n</code></pre>\n\n<p>The server <code>*tls.Config</code> looks like this...</p>\n\n<pre><code>// Load the key and certificate - paths are provided in flags.                                                                                           \ncert, err := tls.LoadX509KeyPair(flagTLSCert, flagTLSKey)                                                                    \nif err != nil {                                                                                                              \n    log.Fatal(err)                                                                                                       \n}\n\n// Create the TLS config                                                                                                     \ntlsConfig := &amp;tls.Config{\n    Certificates: []tls.Certificate{cert},\n    ClientAuth: tls.VerifyClientCertIfGiven,\n    ServerName: fqdn(),\n}\n</code></pre>\n\n<p>The client <code>*tls.Config</code> looks like this...</p>\n\n<pre><code>clientTLSConfig := &amp;tls.Config{\n    InsecureSkipVerify: true,\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mlab", "mgo"], "comments": [{"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1466891392, "post_id": 38032995, "comment_id": 63506703, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/35635293/golang-and-mongodb-remote-access-fail-server-returned-error-on-sasl-authenticat\">Golang and MongoDb remote access fail (server returned error on SASL authentication step: Authentication failed.)</a>"}, {"owner": {"reputation": 427, "user_id": 712533, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/5MzJx.jpg?s=128&g=1", "display_name": "codiaf", "link": "https://stackoverflow.com/users/712533/codiaf"}, "reply_to_user": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1466893396, "post_id": 38032995, "comment_id": 63507137, "body": "In that question, the answers turned out to be the user didn&#39;t created a mLab database user, but I do have one, which is the one I put in my connection string"}], "answers": [{"tags": [], "owner": {"reputation": 427, "user_id": 712533, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/5MzJx.jpg?s=128&g=1", "display_name": "codiaf", "link": "https://stackoverflow.com/users/712533/codiaf"}, "is_accepted": true, "score": 5, "last_activity_date": 1466897316, "creation_date": 1466897316, "answer_id": 38033840, "question_id": 38032995, "link": "https://stackoverflow.com/questions/38032995/cant-connect-with-mlab-database-but-i-can-to-my-local-mongo-with-mgo-golang/38033840#38033840", "title": "Can&#39;t connect with Mlab database but I can to my local mongo with mgo golang", "body": "<p>Found the problem</p>\n\n<p>I was importing the wrong go module.</p>\n\n<p>I had:</p>\n\n<pre><code>labix.org/v2/mgo\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>gopkg.in/mgo.v2\n</code></pre>\n\n<p>After importing <strong>gopkg.in/mgo.v2</strong> it made the connection</p>\n"}], "owner": {"reputation": 427, "user_id": 712533, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/5MzJx.jpg?s=128&g=1", "display_name": "codiaf", "link": "https://stackoverflow.com/users/712533/codiaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1409, "favorite_count": 0, "accepted_answer_id": 38033840, "answer_count": 1, "score": 3, "last_activity_date": 1511216270, "creation_date": 1466888954, "last_edit_date": 1466893704, "question_id": 38032995, "link": "https://stackoverflow.com/questions/38032995/cant-connect-with-mlab-database-but-i-can-to-my-local-mongo-with-mgo-golang", "title": "Can&#39;t connect with Mlab database but I can to my local mongo with mgo golang", "body": "<p>I am trying to connect to a mlab mongo database in my Golang application but I always get 'auth failed'.</p>\n\n<p>If I use my local mongo, I have no problems (my local doesn't have authentication)</p>\n\n<p><strong>EDIT:</strong> I do have created a database user in mLab and I can log in with that user in RoboMongo</p>\n\n<p>My database package looks like this:</p>\n\n<pre><code>package database\n\nimport (\n    \"os\"\n    \"fmt\"\n    \"sync\"\n    \"labix.org/v2/mgo\"\n    \"time\"\n)\n\ntype DB struct {\n    Database    *mgo.Database\n}\n\n\nconst (\n  MongoDBHosts = \"mlabHost:mlabPort\"\n  AuthDatabase = \"mydatabase\"\n  AuthUserName = \"mlabUser\"\n  AuthPassword = \"mlabPassword\"\n)\n\nvar _init_ctx sync.Once\nvar _instance *DB\n\nfunc New() *mgo.Database {\n    _init_ctx.Do(func() {\n        _instance = new(DB)\n\n        mongoDBDialInfo := &amp;mgo.DialInfo{\n            Addrs:    []string{MongoDBHosts},\n            Timeout:  600 * time.Second,\n            Database: AuthDatabase,\n            Username: AuthUserName,\n            Password: AuthPassword,\n        }\n\n        // Create a session which maintains a pool of socket connections\n        // to our MongoDB.\n        session, err := mgo.DialWithInfo(mongoDBDialInfo)\n\n        if err != nil {\n            fmt.Printf(\"Error en mongo: %+v\\n\", err)\n            os.Exit(1)\n        }\n        _instance.Database = session.DB(AuthDatabase)\n    })\n    return _instance.Database\n}\n</code></pre>\n\n<p>With that code, I always get 'auth failed', but if I change the const values to connect to my local like this:</p>\n\n<pre><code>const (\n    MongoDBHosts = \"localhost:27017\"\n    AuthDatabase = \"mydatabase\"\n    AuthUserName = \"\"\n    AuthPassword = \"\"\n)\n</code></pre>\n\n<p>Everything is good.</p>\n\n<p>I can even connect to my mLab database through RoboMongo, but one thing I noticed was that trying to connect from the command line like this:</p>\n\n<pre><code>mongo mLabHost:mLabPort/mydatabase -u mLabUser -p mLabPassword\n</code></pre>\n\n<p>The prompt asks again for the password and then I get (mypassword = mLabPassword I enter):</p>\n\n<pre><code>2016-06-25T16:07:10.822-0500 E -        [main] file [mypassword] doesn't exist\nfailed to load: mypassword\n</code></pre>\n\n<p>I tried connecting to mLab in several different ways, but I can't find what is my problem.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 1394764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579963d48c56fe440067b98a1a4b303?s=128&d=identicon&r=PG", "display_name": "Richard Wilkes", "link": "https://stackoverflow.com/users/1394764/richard-wilkes"}, "edited": false, "score": 1, "creation_date": 1466896859, "post_id": 38031808, "comment_id": 63507749, "body": "Thanks. That&#39;s what I ended up with... I was just hoping for something a bit less verbose."}], "tags": [], "owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "is_accepted": true, "score": 4, "last_activity_date": 1466880872, "last_edit_date": 1466880872, "creation_date": 1466880219, "answer_id": 38031808, "question_id": 38031401, "link": "https://stackoverflow.com/questions/38031401/how-can-i-fill-out-void-c-pointer-in-go/38031808#38031808", "title": "How can I fill out void* C pointer in Go?", "body": "<p>See <a href=\"https://golang.org/cmd/cgo/#hdr-Passing_pointers\" rel=\"nofollow\">\"Passing pointers\"</a> section in <code>cgo</code> docs:</p>\n\n<blockquote>\n  <p>Go code may pass a Go pointer to C provided the Go memory to which it points does not contain any Go pointers.</p>\n</blockquote>\n\n<p>And also:</p>\n\n<blockquote>\n  <p>These rules are checked dynamically at runtime. The checking is controlled by the cgocheck setting of the GODEBUG environment variable. The default setting is GODEBUG=cgocheck=1, which implements reasonably cheap dynamic checks. These checks may be disabled entirely using GODEBUG=cgocheck=0. Complete checking of pointer handling, at some cost in run time, is available via GODEBUG=cgocheck=2.</p>\n</blockquote>\n\n<p>If you run the snippet you've provided with:</p>\n\n<pre><code>GODEBUG=cgocheck=0 go run snippet.go\n</code></pre>\n\n<p>Then there is no panic. However, the correct way to go is to use <code>C.malloc</code> (or obtain a \"C pointer\" from somewhere else):</p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\n// typedef struct {\n//     int   size;\n//     void *data;\n// } info;\n//\n// void test(info *infoPtr) {\n//     // Do something here...\n// }\nimport \"C\"\n\nimport \"unsafe\"\n\nfunc main() {\n    var data uint8 = 5\n\n    cdata := C.malloc(C.size_t(unsafe.Sizeof(data)))\n    *(*C.char)(cdata) = C.char(data)\n    defer C.free(cdata)\n\n    info := &amp;C.info{size: C.int(unsafe.Sizeof(data)), data: cdata}\n    C.test(info)\n}\n</code></pre>\n\n<p>It works because while regular Go pointers are not allowed, <code>C.malloc</code> returns a \"C pointer\":</p>\n\n<blockquote>\n  <p>Go pointer means a pointer to memory allocated by Go (such as by using the &amp; operator or calling the predefined new function) and the term C pointer means a pointer to memory allocated by C (such as by a call to C.malloc). Whether a pointer is a Go pointer or a C pointer is a dynamic property determined by how the memory was allocated.</p>\n</blockquote>\n\n<p>Note that you need to include <code>stdlib.h</code> to use <code>C.free</code>.</p>\n"}], "owner": {"reputation": 310, "user_id": 1394764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579963d48c56fe440067b98a1a4b303?s=128&d=identicon&r=PG", "display_name": "Richard Wilkes", "link": "https://stackoverflow.com/users/1394764/richard-wilkes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3176, "favorite_count": 0, "accepted_answer_id": 38031808, "answer_count": 1, "score": 5, "last_activity_date": 1466892169, "creation_date": 1466877620, "last_edit_date": 1466892169, "question_id": 38031401, "link": "https://stackoverflow.com/questions/38031401/how-can-i-fill-out-void-c-pointer-in-go", "title": "How can I fill out void* C pointer in Go?", "body": "<p>I am trying to interface with some C code from Go. Using cgo, this has been relatively straight-forward until I hit this (fairly common) case: needing to pass a pointer to a structure that itself contains a pointer to some data. I cannot seem to figure out how to do this from Go without resorting to putting the creation of the structure into the C code itself, which I'd prefer not to do. Here is a snippet that illustrates the problem:</p>\n\n<pre><code>package main\n\n// typedef struct {\n//     int   size;\n//     void *data;\n// } info;\n//\n// void test(info *infoPtr) {\n//     // Do something here...\n// }\nimport \"C\"\n\nimport \"unsafe\"\n\nfunc main() {\n    var data uint8 = 5\n    info := &amp;C.info{size: C.int(unsafe.Sizeof(data)), data: unsafe.Pointer(&amp;data)}\n    C.test(info)\n}\n</code></pre>\n\n<p>While this compiles fine, trying to run it results in:</p>\n\n<pre><code>panic: runtime error: cgo argument has Go pointer to Go pointer\n</code></pre>\n\n<p>In my case, the data being passed to the C call doesn't persist past the call (i.e. the C code in question digs into the structure, copies what it needs, then returns).</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1466886607, "post_id": 38027738, "comment_id": 63505594, "body": "The 300s duplicate."}], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 3, "last_activity_date": 1466855173, "creation_date": 1466855173, "answer_id": 38028150, "question_id": 38027738, "link": "https://stackoverflow.com/questions/38027738/how-to-serialize-to-json-embed-structure-in-golang/38028150#38028150", "title": "How to serialize to json embed structure in golang", "body": "<p>You need to export your fields (make the names capitalized):</p>\n\n<pre><code>type Metadata struct {\n    Model string\n}\n\ntype Texture struct {\n    Url      string\n    Hash     string\n    Metadata *Metadata\n}\n</code></pre>\n\n<p>Updated playground example:</p>\n\n<p><a href=\"https://play.golang.org/p/d-d4SJbCpH\" rel=\"nofollow\">https://play.golang.org/p/d-d4SJbCpH</a></p>\n"}], "owner": {"reputation": 83, "user_id": 5184751, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-OtuNUCVn1Ao/AAAAAAAAAAI/AAAAAAAAAG0/rWVK3wQJf3I/photo.jpg?sz=128", "display_name": "ErickSkrauch", "link": "https://stackoverflow.com/users/5184751/erickskrauch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 38028150, "answer_count": 1, "score": 1, "last_activity_date": 1466855173, "creation_date": 1466852382, "question_id": 38027738, "link": "https://stackoverflow.com/questions/38027738/how-to-serialize-to-json-embed-structure-in-golang", "title": "How to serialize to json embed structure in golang", "body": "<p>I'm just starting to learn Go, but I can not make out current task. I need to serialize the structure consisting of nested structures.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Metadata struct {\n    model string\n}\n\ntype Texture struct {\n    url      string\n    hash     string\n    metadata *Metadata\n}\n\ntype Response struct {\n    SKIN *Texture\n}\n\nfunc main() {\n    response := Response{}\n    textures := &amp;Texture{\n        url: \"http://ely.by\",\n        hash: \"123123123123123123\",\n    }\n    metadata := &amp;Metadata{\n        model: \"slim\",\n    }\n\n    textures.metadata = metadata\n    response.SKIN = textures\n\n    result, _ := json.Marshal(response)\n    fmt.Println(string(result))\n}\n</code></pre>\n\n<p>Always output only {\"SKIN\":{}}. Expected value is:</p>\n\n<pre><code>{\n    \"SKIN\": {\n        \"url\": \"http://ely.by\",\n        \"hash\": \"123123123123123123\",\n        \"metadata\": {\n            \"model\": \"slim\"\n        }\n    }\n}\n</code></pre>\n\n<p>I created this example in a sandbox <a href=\"https://play.golang.org/p/IHktK6E33N\" rel=\"nofollow\">https://play.golang.org/p/IHktK6E33N</a>.</p>\n"}, {"tags": ["go", "tokenize"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1466855892, "post_id": 38026530, "comment_id": 63496650, "body": "I wouldn&#39;t split on ScanWords.  seems it would be more idiomatic to split on newlines as that ensures 1 grouping per iteration. Then within the iteration, using <code>strings.Split()</code>.  idiomatic as in easier to read by others and understand what the logic is doing."}], "answers": [{"comments": [{"owner": {"reputation": 1090, "user_id": 4674479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56af09c0905f13125aefb9c10c5af2f8?s=128&d=identicon&r=PG&f=1", "display_name": "adapt-dev", "link": "https://stackoverflow.com/users/4674479/adapt-dev"}, "edited": false, "score": 0, "creation_date": 1467062409, "post_id": 38026661, "comment_id": 63565760, "body": "Thanks.  Interestingly, Scanner is about 5x-10x faster than Fscan on my system, repeatedly doing 100k line files."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 1090, "user_id": 4674479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56af09c0905f13125aefb9c10c5af2f8?s=128&d=identicon&r=PG&f=1", "display_name": "adapt-dev", "link": "https://stackoverflow.com/users/4674479/adapt-dev"}, "edited": false, "score": 0, "creation_date": 1467092851, "post_id": 38026661, "comment_id": 63574083, "body": "@adapt-dev: if you are looking for faster input scanning see this: <a href=\"http://stackoverflow.com/questions/31333353/faster-input-scanning\" title=\"faster input scanning\">stackoverflow.com/questions/31333353/faster-input-scanning</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 3, "last_activity_date": 1466846328, "last_edit_date": 1466846328, "creation_date": 1466844418, "answer_id": 38026661, "question_id": 38026530, "link": "https://stackoverflow.com/questions/38026530/a-better-way-to-use-scanner-for-multiple-tokens-per-line/38026661#38026661", "title": "a better way to use Scanner for multiple tokens per line?", "body": "<p>you should not use <code>\\n</code> in <code>input</code>, and always check for errors.<br>\nworking sample code: </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    const input = `key1 62128128\nkey2 8337182720\nkey3 7834959872\nkey4 18001920\nkey5 593104896`\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    scanner.Split(bufio.ScanWords)\n    for scanner.Scan() {\n        key := scanner.Text()\n        if !scanner.Scan() {\n            break\n        }\n        value := scanner.Text()\n        fmt.Printf(\"k: %v, v: %v\\n\", key, value)\n    }\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>k: key1, v: 62128128\nk: key2, v: 8337182720\nk: key3, v: 7834959872\nk: key4, v: 18001920\nk: key5, v: 593104896  \n</code></pre>\n\n<p>Also you may use <code>Fscan</code> which scans to desired type, like this:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    const input = `key1 62128128\nkey2 8337182720\nkey3 7834959872\nkey4 18001920\nkey5 593104896`\n    rdr := strings.NewReader(input)\n    for {\n        k, v := \"\", 0\n        n, _ := fmt.Fscan(rdr, &amp;k, &amp;v)\n        if n != 2 {\n            //fmt.Println(err)\n            break\n        }\n        fmt.Printf(\"%T: %[1]v, %T: %[2]v\\n\", k, v)\n    }\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>string: key1, int: 62128128\nstring: key2, int: 8337182720\nstring: key3, int: 7834959872\nstring: key4, int: 18001920\nstring: key5, int: 593104896\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "is_accepted": false, "score": 1, "last_activity_date": 1466845994, "creation_date": 1466845994, "answer_id": 38026840, "question_id": 38026530, "link": "https://stackoverflow.com/questions/38026530/a-better-way-to-use-scanner-for-multiple-tokens-per-line/38026840#38026840", "title": "a better way to use Scanner for multiple tokens per line?", "body": "<p>Actually it's perfectly safe to do that, as Scan() validate input and set an error that you could get with Err(). </p>\n\n<p>So if you want to check if Scan() fail, you have to do it at the end of the loop as shown in many <a href=\"https://golang.org/pkg/bufio/#example_Scanner_custom\" rel=\"nofollow\">examples</a>.</p>\n\n<p>Your code shoud be:</p>\n\n<pre><code>func TestScanner(t *testing.T) {\n    const input = `key1 62128128\nkey2 8337182720\nkey3 7834959872\nkey4 18001920\nkey5 593104896`\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    scanner.Split(bufio.ScanWords)\n    for scanner.Scan() {\n        key := scanner.Text()\n        scanner.Scan()\n        value := scanner.Text();\n        fmt.Printf(\"k: %v, v: %v\\n\", key, value)\n    }\n\n    if err := scanner.Err(); err != nil {\n        fmt.Printf(\"Invalid input: %s\", err)\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1090, "user_id": 4674479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56af09c0905f13125aefb9c10c5af2f8?s=128&d=identicon&r=PG&f=1", "display_name": "adapt-dev", "link": "https://stackoverflow.com/users/4674479/adapt-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 38026661, "answer_count": 2, "score": 0, "last_activity_date": 1466846328, "creation_date": 1466843325, "question_id": 38026530, "link": "https://stackoverflow.com/questions/38026530/a-better-way-to-use-scanner-for-multiple-tokens-per-line", "title": "a better way to use Scanner for multiple tokens per line?", "body": "<p>I'm trying to parse a file with lines that consist of a key, a space, a number and then a newline.</p>\n\n<p>My code works, but it doesn't smell right to me.   Is there a better way to use Scanner?   Particularly, I don't like having the Scan() inside the for-loop without any protection on it.</p>\n\n<pre><code>func TestScanner(t *testing.T) {\n    const input = `key1 62128128\\n\nkey2 8337182720\\n\nkey3 7834959872\\n\nkey4 18001920\\n\nkey5 593104896\\n`\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    scanner.Split(bufio.ScanWords)\n    for scanner.Scan() {\n        key := scanner.Text()\n        scanner.Scan()\n        value := scanner.Text();\n        fmt.Printf(\"k: %v, v: %v\\n\", key, value)\n    }\n}\n</code></pre>\n"}, {"tags": ["reflection", "go", "visual-studio-code"], "comments": [{"owner": {"reputation": 138, "user_id": 5151619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LPuj6.jpg?s=128&g=1", "display_name": "sauroter", "link": "https://stackoverflow.com/users/5151619/sauroter"}, "edited": false, "score": 0, "creation_date": 1466837045, "post_id": 38025743, "comment_id": 63492099, "body": "Hi this question was answered: <a href=\"http://programmers.stackexchange.com/questions/286406/use-of-this-in-golang\" title=\"use of this in golang\">programmers.stackexchange.com/questions/286406/&hellip;</a> <a href=\"http://stackoverflow.com/questions/29028512/go-this-keywordh\">stackoverflow.com/questions/29028512/go-this-keywordh</a>"}, {"owner": {"reputation": 7891, "user_id": 1737201, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9d553e4eece2656148b5d0e2a613e53e?s=128&d=identicon&r=PG", "display_name": "mezoni", "link": "https://stackoverflow.com/users/1737201/mezoni"}, "edited": false, "score": 0, "creation_date": 1466843649, "post_id": 38025743, "comment_id": 63493644, "body": "In short words: The <code>this</code> means <code>inheritance</code>. <code>Inheritance</code> means <code>abstract</code> and <code>virtual</code> methods. That is, with the <code>Inheritance</code> you can write <code>this.callAbstractMethod()</code>. Go language does not support <code>inheritance</code>. This means that <code>receiver</code> is not a <code>this</code> because <code>this</code> always means something that maybe not a <code>this</code> but an <code>other</code> (eg. <code>super</code>). In Go language there are no <code>super</code> instances under the <code>this</code> instance since in Go language not exists inheritance as such."}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1466837012, "post_id": 38025765, "comment_id": 63492092, "body": "See also <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#receiver-names\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/CodeReviewComments#receiver-names</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 10, "last_activity_date": 1466837181, "last_edit_date": 1491982285, "creation_date": 1466836658, "answer_id": 38025765, "question_id": 38025743, "link": "https://stackoverflow.com/questions/38025743/go-why-shouldnt-use-this-for-method-receiver-name/38025765#38025765", "title": "Go, Why shouldn&#39;t use &quot;this&quot; for method receiver name", "body": "<p>As <a href=\"https://www.reddit.com/r/golang/comments/3qoo36/question_why_is_self_or_this_not_considered_a/\" rel=\"noreferrer\">mentioned here</a></p>\n\n<blockquote>\n  <p><code>v.Method()</code> is actually syntactic sugar and Go also understands the de-sugared version of it: <code>(T).Method(v)</code>. <a href=\"http://play.golang.org/p/YKI1HGqeM7\" rel=\"noreferrer\">You can see an example here</a>. </p>\n</blockquote>\n\n<pre><code>package main\n\ntype T struct{}\n\nfunc (t T) Method() {}\n\nfunc main() {\n    t := T{}\n    t.Method()    // this is valid\n    (T).Method(t) // this too\n}\n</code></pre>\n\n<blockquote>\n  <p><strong>Naming the receiver like any other parameter reflects that it is, in fact, just another parameter quite well</strong>.</p>\n</blockquote>\n\n<p>As <a href=\"https://softwareengineering.stackexchange.com/users/161917/ixrec\">Ixrec</a> puts it in <a href=\"https://softwareengineering.stackexchange.com/a/286409/3915\">this answer</a>:</p>\n\n<blockquote>\n  <p>In other languages the <code>this</code>/<code>self</code>/<code>whatever</code> variable typically has some special properties such as being magically provided by the language, or having special access to private methods (remember Go doesn't have private fields/methods).<br>\n  Though the \"receiver\" is still being \"magically provided\" to some extent, it's so similar to a regular function argument it arguably doesn't count.</p>\n</blockquote>\n"}], "owner": {"reputation": 1010, "user_id": 3187183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CxbLu.jpg?s=128&g=1", "display_name": "b.ben", "link": "https://stackoverflow.com/users/3187183/b-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4198, "favorite_count": 3, "closed_date": 1466837714, "accepted_answer_id": 38025765, "answer_count": 1, "score": 4, "last_activity_date": 1466843255, "creation_date": 1466836531, "last_edit_date": 1592644375, "question_id": 38025743, "link": "https://stackoverflow.com/questions/38025743/go-why-shouldnt-use-this-for-method-receiver-name", "closed_reason": "Duplicate", "title": "Go, Why shouldn&#39;t use &quot;this&quot; for method receiver name", "body": "<p>I use VS Code Go extension.</p>\n<p>Here's my code</p>\n<pre><code>func (this *MyClass) Xxx() error {}\n</code></pre>\n<p>And It's mention me this</p>\n<blockquote>\n<p>exported method <code>MyClass.Xxx</code> should have comment or be unexported</p>\n<p>receiver name should be a reflection of its identity; don't use generic names such as &quot;<code>me</code>&quot;, &quot;<code>this</code>&quot;, or &quot;<code>self</code>&quot;;</p>\n</blockquote>\n"}, {"tags": ["http", "go"], "answers": [{"tags": [], "owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "is_accepted": false, "score": 0, "last_activity_date": 1466835875, "creation_date": 1466835875, "answer_id": 38025654, "question_id": 38025626, "link": "https://stackoverflow.com/questions/38025626/how-does-the-function-passed-to-http-handlefunc-get-access-to-http-responsewrite/38025654#38025654", "title": "How does the function passed to http.HandleFunc get access to http.ResponseWriter and http.Request?", "body": "<p>It's the magic of golang and the http package. No just kiding.</p>\n\n<p>In fact http.HandleFunc will do this for you, so when a request will reach your webservice with a matching url, then golang http package will call your handler with w and r ready to be used.</p>\n"}, {"tags": [], "owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "is_accepted": true, "score": 2, "last_activity_date": 1466879555, "creation_date": 1466879555, "answer_id": 38031709, "question_id": 38025626, "link": "https://stackoverflow.com/questions/38025626/how-does-the-function-passed-to-http-handlefunc-get-access-to-http-responsewrite/38031709#38031709", "title": "How does the function passed to http.HandleFunc get access to http.ResponseWriter and http.Request?", "body": "<p>http.HandleFunc  knows its given input parms and that 2nd parm will have its own input parms (w http.ResponseWriter, r http.Request) ... so w and r are setup by http.HandleFunc  which after it registers func handler as a callback it then invokes passing in w and r ... so responsibility is given to calling context not inside the callback definition itself</p>\n\n<p>Its a worth while exercise to write your own such pair of functions where one is a callback passed into and invoked by other function ... this pattern is orthogonal to golang and is a pervasive tool across languages</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 38031709, "answer_count": 2, "score": 2, "last_activity_date": 1466879555, "creation_date": 1466835601, "last_edit_date": 1466843440, "question_id": 38025626, "link": "https://stackoverflow.com/questions/38025626/how-does-the-function-passed-to-http-handlefunc-get-access-to-http-responsewrite", "title": "How does the function passed to http.HandleFunc get access to http.ResponseWriter and http.Request?", "body": "<pre><code>func main() {\n    http.HandleFunc(\"/\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r http.Request) {\n    // I never declared, initialized or passed w and r. How does this function get access to them?\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "is_accepted": false, "score": 2, "last_activity_date": 1466831467, "creation_date": 1466831467, "answer_id": 38025202, "question_id": 38025054, "link": "https://stackoverflow.com/questions/38025054/accept-vs-accepttcp/38025202#38025202", "title": "Accept vs AcceptTCP", "body": "<p>The answer is easy, the type net.Conn is an interface and the type net.TCPListener is a struct that implements the net.Conn interface, means that it can be used as a net.Conn type, <a href=\"https://golang.org/doc/effective_go.html#interfaces_and_types\" rel=\"nofollow\">see go documentation on interface</a>.</p>\n\n<p>And net.<strong>c</strong>onn != net.<strong>C</strong>onn.</p>\n"}], "owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466831467, "creation_date": 1466829910, "question_id": 38025054, "link": "https://stackoverflow.com/questions/38025054/accept-vs-accepttcp", "title": "Accept vs AcceptTCP", "body": "<p>Could someone explain why Go's net package has func (l *TCPListener) Accept() (Conn, error) and func (l *TCPListener) AcceptTCP() (*TCPConn, error) when TCPConn is?</p>\n\n<pre><code>type TCPConn struct {\n        conn\n}\n</code></pre>\n\n<p>Above from tcpsock_posix.go.</p>\n\n<p>What's advantage of having a function which returns *TCPConn over Conn? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 3, "creation_date": 1466819914, "post_id": 38024149, "comment_id": 63489548, "body": "It is going to be hard to test something that has no observable behaviour."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466822754, "post_id": 38024149, "comment_id": 63489946, "body": "Move whatever you want to unit test outside main."}, {"owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 1, "creation_date": 1466826768, "post_id": 38024149, "comment_id": 63490474, "body": "Test an initialization? Why would you do that?"}], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "is_accepted": false, "score": -1, "last_activity_date": 1466885433, "creation_date": 1466885433, "answer_id": 38032531, "question_id": 38024149, "link": "https://stackoverflow.com/questions/38024149/how-do-you-test-code-inside-the-main-function/38032531#38032531", "title": "How do you test code inside the main function", "body": "<p>Why not try our most basic debug tool: printf.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype myStruct struct {\n   songs []string\n}\n\nfunc main() {\n  s1 := myStruct{songs:[]string{\"Master of Puppets\", \"Battery\"}}\n  foo(s1)\n}\n\nfunc foo(s myStruct) {\n  // Does something with s\n  for i:=0;i&lt;len(s.songs);i++ {\n    fmt.Printf(\"s.songs[%d]=\\\"%s\\\"\\n\",i, s.songs[i])\n  }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>s.songs[0]=\"Master of Puppets\"\ns.songs[1]=\"Battery\"\n</code></pre>\n\n<p>In case you really want to test if your structure was properly initialized inside your main function:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype myStruct struct {\n   songs []string\n}\n\nfunc main() {\n  s1 := myStruct{songs:[]string{\"Master of Puppets\", \"Battery\"}}\n  foo(s1)\n  for i:=0;i&lt;len(s1.songs);i++ {\n    fmt.Printf(\"s1.songs[%d]=\\\"%s\\\"\\n\",i, s1.songs[i])\n  }\n}\n\nfunc foo(s myStruct) {\n  // Does something with s\n  fmt.Printf(\"foo has finished its work!\\n\")\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>foo has finished its work!\ns1.songs[0]=\"Master of Puppets\"\ns1.songs[1]=\"Battery\"\n</code></pre>\n\n<p>If you want to make sure both main() and foo() are working with the same object, try this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype myStruct struct {\n   songs []string\n}\n\nfunc main() {\n  s1 := myStruct{songs:[]string{\"Master of Puppets\", \"Battery\"}}\n  foo(&amp;s1)\n  fmt.Printf(\"main() says: s1 lives in the address:%p\\n\",&amp;s1)\n}\n\nfunc foo(s *myStruct) {\n  // Does something with s\n  fmt.Printf(\"foo() says: s lives in the address:%p\\n\",s)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>foo() says: s lives in the address:0x10434120\nmain() says: s1 lives in the address:0x10434120\n</code></pre>\n\n<p>Next time, try being more specific on your questions.</p>\n\n<p>Cheers.</p>\n"}], "owner": {"reputation": 28653, "user_id": 527288, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9e175031c4adde62f40456f86a5e91b0?s=128&d=identicon&r=PG", "display_name": "Kurtis Nusbaum", "link": "https://stackoverflow.com/users/527288/kurtis-nusbaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466885433, "creation_date": 1466818588, "question_id": 38024149, "link": "https://stackoverflow.com/questions/38024149/how-do-you-test-code-inside-the-main-function", "title": "How do you test code inside the main function", "body": "<p>Consider the following trivial <code>main.go</code> file:</p>\n\n<pre><code>package main\n\ntype myStruct struct {\n   songs []string\n}\n\nfunc main() {\n  s1 := myStruct{\n    songs:[]string{\"Master of Puppets\", \"Battery\"}\n  }\n  foo(s1)\n}\n\nfunc foo(s myStruct) {\n  // Does something with s\n}\n</code></pre>\n\n<p>I get how I could test the <code>foo</code> function. But how could I test that the main function properly intializes the <code>s1</code> struct and assert that the <code>foo</code> function get's called with <code>s1</code> as an argument?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466809984, "post_id": 38022991, "comment_id": 63488091, "body": "2: you don&#39;t need to busy wait or ignore EOF to read from stdin. If you really want to use select, it&#39;s a syscall you can use directly without cgo, but you probably don&#39;t need it."}, {"owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466826655, "post_id": 38022991, "comment_id": 63490453, "body": "Well I&#39;m not sure how in either case, so I&#39;d love an example. As I said, I tried the syscall but without FD_SET I&#39;m not sure how to use it."}, {"owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466830262, "post_id": 38022991, "comment_id": 63490958, "body": "I though I got select working, but now it&#39;s returning immediately whether there&#39;s input or not."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1466836175, "post_id": 38022991, "comment_id": 63491929, "body": "I see that I might not have understood your question. Clients cannot &quot;come and go&quot; and close stdin. Once a file handle is closed, it is GONE."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1466836202, "post_id": 38022991, "comment_id": 63491935, "body": "So once you get EOF, that is all there ever will be on that."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1466836301, "post_id": 38022991, "comment_id": 63491953, "body": "So I suppose the goroutine that you have reading from os.Stdin will have to detect EOF and after that simply exit. Then you&#39;ll never see another channel message from that goroutine in the future."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466858312, "post_id": 38022991, "comment_id": 63497323, "body": "if you&#39;re having a problem reading from stdin normally, please show an example. None of this is necessary for normal Go programs"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466867433, "post_id": 38025619, "comment_id": 63499876, "body": "You have to check bytes read before an error. You can get EOF on a successful read."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 1, "last_activity_date": 1468366166, "last_edit_date": 1468366166, "creation_date": 1466835532, "answer_id": 38025619, "question_id": 38022991, "link": "https://stackoverflow.com/questions/38022991/error-compiling-with-cgo/38025619#38025619", "title": "error compiling with cgo", "body": "<p>In Go you do blocking operations. Everywhere.</p>\n\n<p>You put those blocking operations inside goroutines which are like green threads / fibers, whatever. They are scheduled by the Go runtime and might be on real threads or they might be sharing threads.</p>\n\n<p>Then you use channels to talk to the other parts of your Go program.</p>\n\n<p>For your problem with stdin always being readable after an EOF just stop reading it. I have my reader goroutine below just exit.</p>\n\n<p>Here, have a sample I just wrote:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    var err error\n    ch1 := make(chan []byte)\n    ch2 := make(chan int)\n    var buf []byte\n    var i int\n    var ok bool\n\n    go reader(ch1)\n    go counter(ch2)\n\n    for {\n        select {\n        case buf, ok = &lt;-ch1:\n            if ok {\n                _, err = os.Stdout.Write([]byte(\"input: \"))\n                _, err = os.Stdout.Write(buf)\n            }\n\n        case i, ok = &lt;-ch2:\n            if ok {\n                _, err = fmt.Println(\"count\", i)\n            }\n        }\n        if err != nil {\n            fmt.Println(\"error\", err)\n        }\n        if !ok {\n            break\n        }\n    }\n}\n\nfunc counter(ch chan&lt;- int) {\n    i := 0\n    for i &lt; 5 {\n        i++\n        ch &lt;- i\n        time.Sleep(time.Second)\n    }\n    close(ch)\n}\n\nfunc reader(ch chan&lt;- []byte) {\n    var r int\n    var err error\n    for {\n        buf := make([]byte, 4000)\n        r, err = os.Stdin.Read(buf)\n        if r &gt; 0 {\n            ch &lt;- buf[:r]\n        }\n        if err != nil {\n            fmt.Println(\"read error\", err)\n            if err == io.EOF {\n                break\n            }\n            // Or really just about any error on read is fatal\n            break\n        }\n    }\n    close(ch)\n}\n</code></pre>\n"}], "owner": {"reputation": 615, "user_id": 1263968, "user_type": "registered", "accept_rate": 13, "profile_image": "https://www.gravatar.com/avatar/9df72d3e2f53016dea6bb563359483ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Soulier", "link": "https://stackoverflow.com/users/1263968/michael-soulier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468366166, "creation_date": 1466807458, "last_edit_date": 1466830353, "question_id": 38022991, "link": "https://stackoverflow.com/questions/38022991/error-compiling-with-cgo", "title": "error compiling with cgo", "body": "<p>So, I'm trying to read from stdin without busy waiting, ignoring EOF as clients in my case will come and go. In C I'd use a simple select() or poll() but I'm trying to learn Go, and I'm quite frustrated by the lack of select() or poll(). I can't find a good way using select and channels in Go because a Read() will return immediately on an EOF and I'm back to busy waiting. syscall.Select() seems the best way, but Go has not bothered to implement FD_SET! <em>sigh</em></p>\n\n<p>So, I'm trying with cgo.</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdlib.h&gt;\n#include &lt;sys/select.h&gt;\nvoid _FD_SET(int sysfd, void *set) {\n    FD_SET(sysfd, (fd_set*)set);\n}\n*/\nimport \"C\"\n\nimport (\n    \"unsafe\"\n</code></pre>\n\n<p>But when I try to build this on my Mac I get this.</p>\n\n<pre><code># github.com/msoulier/mlogd\ncould not determine kind of name for C._FD_SET\n\nclang errors for preamble:\nsrc/github.com/msoulier/mlogd/mlogd.go:6:14: error: expected identifier or '('\nvoid _FD_SET(int sysfd, void *set) {\n             ^\nsrc/github.com/msoulier/mlogd/mlogd.go:6:14: error: expected ')'\nsrc/github.com/msoulier/mlogd/mlogd.go:6:13: note: to match this '('\nvoid _FD_SET(int sysfd, void *set) {\n            ^\n2 errors generated.\n</code></pre>\n\n<p>If I merge the imports together then most of the errors go away.</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdlib.h&gt;\n#include &lt;sys/select.h&gt;\nvoid _FD_SET(int sysfd, void *set) {\n    FD_SET(sysfd, (fd_set*)set);\n}\n*/\nimport (\n    \"C\"\n    \"unsafe\"\n    \"syscall\"\n</code></pre>\n\n<p>But there's still one.</p>\n\n<pre><code># github.com/msoulier/mlogd\ncould not determine kind of name for C._FD_SET\n</code></pre>\n\n<p>So, I'm looking for two things here. </p>\n\n<ol>\n<li>Why am I doing wrong with cgo here? From what I've read this should \"just work\".</li>\n<li>Is there a better way to read indefinitely from stdin, without busy waiting, and ignoring EOF?</li>\n</ol>\n\n<p>My environment.</p>\n\n<pre><code>msoulier@merlin:~/work/go$ go version\ngo version go1.6.2 darwin/amd64\nmsoulier@merlin:~/work/go$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/msoulier/work/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/Cellar/go/1.6.2/libexec\"\nGOTOOLDIR=\"/usr/local/Cellar/go/1.6.2/libexec/pkg/tool/darwin_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Thanks in advance. Must be simpler than this.</p>\n\n<p>I got this far with select.</p>\n\n<pre><code>// loop forever - we expect to be killed with a SIGTERM or SIGINT\nfor {\n    logger.Debug(\"going into select on stdin\")\n    var r_fdset syscall.FdSet\n    for i := 0; i &lt; 16; i++ {\n        r_fdset.Bits[i] = 0\n    }\n    r_fdset.Bits[0] = 1\n    selerr := syscall.Select(1, &amp;r_fdset, nil, nil, nil)\n    if selerr != nil {\n        logger.Warning(selerr)\n    }\n</code></pre>\n\n<p>But it's returning immediately even when the input runs out.</p>\n\n<p>Mike</p>\n"}, {"tags": ["go", "godeps"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1466798389, "post_id": 38020943, "comment_id": 63484198, "body": "Have you tried <code>godep save .&#47;...</code>?"}, {"owner": {"reputation": 3465, "user_id": 1342445, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7ZNEn.jpg?s=128&g=1", "display_name": "pnovotnak", "link": "https://stackoverflow.com/users/1342445/pnovotnak"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1466802920, "post_id": 38020943, "comment_id": 63486121, "body": "Sorry, my question was pretty bad :\\ I added some git context and output from the program."}, {"owner": {"reputation": 126, "user_id": 1246431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4254d4b6c9eebe54fecd792d2a0314f6?s=128&d=identicon&r=PG", "display_name": "bgeyts668", "link": "https://stackoverflow.com/users/1246431/bgeyts668"}, "edited": false, "score": 0, "creation_date": 1466885371, "post_id": 38020943, "comment_id": 63505227, "body": "It seems that godep does not complain about you repo, but about packages which you vendor. It might happen that they are also subrepositories of your project. Could you run <code>git status</code> in some package which is said to have dirty working tree? In their vendored path and their original import path both."}, {"owner": {"reputation": 501, "user_id": 1902767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88fd79f1a5443d8e4ce5c026cbe808c3?s=128&d=identicon&r=PG", "display_name": "dlorenc", "link": "https://stackoverflow.com/users/1902767/dlorenc"}, "edited": false, "score": 0, "creation_date": 1467045580, "post_id": 38020943, "comment_id": 63556955, "body": "Hey, godep can be a little clunky here :( This is basically the process I use for adding things to minikube.  * Create a clean gopath. You can make a new directory somewhere, just for the update (mkdir ~/fakegopath; export GOPATH=$HOME/fakegopath;)  * Copy your minikube directory into there (fakegopath/src/k8s.io/minikube)  * From the minikube repo, run &quot;godep restore ./...&quot;  * &quot;go get&quot; the new dependency  * edit your code to use it, build and test, etc.  * Run godep save ./..."}], "owner": {"reputation": 3465, "user_id": 1342445, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7ZNEn.jpg?s=128&g=1", "display_name": "pnovotnak", "link": "https://stackoverflow.com/users/1342445/pnovotnak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 880, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466808370, "creation_date": 1466797154, "last_edit_date": 1466808370, "question_id": 38020943, "link": "https://stackoverflow.com/questions/38020943/godep-save-not-adding-new-packages", "title": "&quot;godep save&quot; Not Adding New Packages", "body": "<p>I'm trying to submit a pull request to a golang project. I've never used <code>godep</code> before and it's giving me some grief.</p>\n\n<p>In <a href=\"https://github.com/pnovotnak/minikube/commit/b3455c17f58b58d73a90fdc730846d96d67ea39a\" rel=\"nofollow\">this commit</a> I added an import--github.com/Parallels/docker-machine-parallels but <code>godep save</code> is not adding it to Godeps/Godeps.json</p>\n\n<pre><code>~/.../github.com/pnovotnak/minikube (feat/parallels) $ git status\nOn branch feat/parallels\nnothing to commit, working directory clean\n</code></pre>\n\n<p>So, working directory seems to be clean, however;</p>\n\n<pre><code>~/.../github.com/pnovotnak/minikube (feat/parallels) $ godep save ./...\ngodep: no buildable Go source files in /Users/pnovotnak/go/src/github.com/pnovotnak/minikube/vendor/github.com/vishvananda/netlink/nl\ngodep: no buildable Go source files in /Users/pnovotnak/go/src/github.com/pnovotnak/minikube/vendor/golang.org/x/exp/inotify\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/cmd/localkube/cmd\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/cmd/minikube/cmd\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/localkube\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/minikube/cluster\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/minikube/config\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/minikube/constants\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/minikube/kubeconfig\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/minikube/machine\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/minikube/notify\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/minikube/sshutil\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/minikube/tests\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/util\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/pkg/version\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/bitbucket.org/ww/goautoneg\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/BurntSushi/toml\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/ClusterHQ/flocker-go\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/Sirupsen/logrus\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/appc/cni/libcni\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/appc/cni/pkg/invoke\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/appc/cni/pkg/types\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/appc/spec/schema\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/armon/go-metrics\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/aws/aws-sdk-go/aws\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/aws/aws-sdk-go/service/elb\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/beorn7/perks/quantile\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/blang/semver\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/boltdb/bolt\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/etcd/alarm\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/etcd/wal\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/go-etcd/etcd\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/go-oidc/oidc\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/go-semver/semver\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/go-systemd/activation\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/go-systemd/unit\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/pkg/capnslog\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/pkg/health\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/pkg/httputil\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/pkg/timeutil\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/coreos/rkt/api/v1alpha\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/davecgh/go-spew/spew\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/dgrijalva/jwt-go\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/distribution/digest\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/distribution/reference\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/docker/pkg/jsonmessage\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/docker/pkg/units\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/engine-api/client\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/engine-api/types\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/go-connections/nat\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/go-connections/sockets\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/go-connections/tlsconfig\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/go-units\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/machine/commands/mcndirs\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/machine/drivers/errdriver\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/machine/drivers/none\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/machine/drivers/virtualbox\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/machine/drivers/vmwarefusion\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/machine/libmachine\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/machine/version\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/docker/spdystream\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/elazarl/go-bindata-assetfs\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/emicklei/go-restful\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/evanphx/json-patch\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/fsnotify/fsnotify\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/ghodss/yaml\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/go-ini/ini\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/godbus/dbus\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/gogo/protobuf/proto\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/golang/glog\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/golang/groupcache/lru\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/golang/protobuf/proto\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/google/btree\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/google/cadvisor/events\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/google/cadvisor/utils\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/google/gofuzz\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/hashicorp/go-msgpack/codec\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/hashicorp/golang-lru\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/hashicorp/hcl\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/hashicorp/raft\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/hashicorp/raft-boltdb\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/hawkular/hawkular-client-go/metrics\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/imdario/mergo\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/influxdb/influxdb/client\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/influxdb/influxdb/influxql\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/influxdb/influxdb/meta\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/influxdb/influxdb/snapshot\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/influxdb/influxdb/toml\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/influxdb/influxdb/tsdb\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/jmespath/go-jmespath\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/jonboulle/clockwork\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/juju/ratelimit\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/magiconair/properties\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/matttproud/golang_protobuf_extensions/pbutil\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/mesos/mesos-go/detector\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/mesos/mesos-go/upid\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/miekg/dns\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/mitchellh/mapstructure\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/mxk/go-flowrate/flowrate\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/pborman/uuid\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/pkg/browser\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/prometheus/client_golang/prometheus\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/prometheus/client_model/go\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/prometheus/common/expfmt\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/prometheus/common/internal/bitbucket.org/ww/goautoneg\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/prometheus/common/model\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/prometheus/procfs\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/rackspace/gophercloud\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/robfig/cron\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/samalba/dockerclient\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/samuel/go-zookeeper/zk\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/skynetservices/skydns/backends/etcd\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/skynetservices/skydns/singleflight\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/spf13/cast\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/spf13/cobra\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/spf13/jwalterweatherman\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/spf13/pflag\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/spf13/viper\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/ugorji/go/codec\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/vmware/govmomi\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/github.com/xiang90/probing\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/go4.org/errorutil\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/golang.org/x/crypto/bcrypt\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/golang.org/x/sys/unix\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/google.golang.org/api/cloudmonitoring/v2beta2\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/google.golang.org/api/compute/v1\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/google.golang.org/api/container/v1\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/google.golang.org/api/gensupport\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/google.golang.org/api/googleapi\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/google.golang.org/cloud/compute/metadata\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/google.golang.org/cloud/internal\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/google.golang.org/grpc\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/gopkg.in/gcfg.v1\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/gopkg.in/inf.v0\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/gopkg.in/yaml.v2\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/heapster/metrics/api/v1/types\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/heapster/metrics/apis/metrics/v1alpha1\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/cmd/kube-apiserver/app\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/cmd/kube-controller-manager/app\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/cmd/kube-proxy/app\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/cmd/kubelet/app\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/admission\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/api\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/apimachinery\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/apis/abac\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/apis/rbac\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/apiserver\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/auth/authenticator\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/auth/authorizer\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/auth/handlers\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/auth/user\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/capabilities\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/client/cache\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/client/unversioned\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/cloudprovider\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/controller\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/conversion\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/credentialprovider\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/fieldpath\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/fields\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/genericapiserver\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/healthz\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/httplog\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/kubelet\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/labels\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/master\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/probe\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/proxy\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/quota\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/registry/cachesize\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/registry/thirdpartyresourcedata\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/runtime\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/security/podsecuritypolicy\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/securitycontext\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/serviceaccount\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/ssh\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/storage\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/types\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/ui\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/util\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/version\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/volume\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/pkg/watch\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/cmd/kube-scheduler/app\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/pkg/admission/admit\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/pkg/admission/serviceaccount\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/pkg/auth/authenticator/password/keystone\n...\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/pkg/auth/authorizer/rbac\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/pkg/auth/authorizer/webhook\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/pkg/client/auth\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/pkg/scheduler\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/plugin/pkg/webhook\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/third_party/forked/json\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/third_party/forked/reflect\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/third_party/golang/expansion\ngodep: dirty working tree (please commit changes): /Users/pnovotnak/go/src/k8s.io/minikube/vendor/k8s.io/kubernetes/third_party/golang/netutil\ngodep: error loading dependencies\n</code></pre>\n\n<p>Before I start tearing my hair out with dtruss / attaching a go debugger to godep source code I figured I'd ask the community... WTH am I doing wrong?</p>\n"}, {"tags": ["macos", "go", "symlink", "project-organization"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466793850, "post_id": 38019786, "comment_id": 63482039, "body": "You can use symlinks <i>to</i> directories in your GOPATH, just make sure you don&#39;t have symlinks inside your GOPATH. Other than that, fighting against the Go tools is only going to cause more trouble than its worth."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1466793977, "post_id": 38019786, "comment_id": 63482110, "body": "yeah, put everything in your gopath, then <code>ln -s $GOPATH&#47;src&#47;github.com&#47;foots&#47;project ~&#47;Work&#47;project</code>"}, {"owner": {"reputation": 320, "user_id": 3529271, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/NmPnP.jpg?s=128&g=1", "display_name": "Mr. Foots", "link": "https://stackoverflow.com/users/3529271/mr-foots"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466795450, "post_id": 38019786, "comment_id": 63482880, "body": "@JimB Okay, so let me see if I understand this properly, I am slightly new to Unix. Instead of actually putting my code in <code>~&#47;Code&#47;Work&#47;MyProject</code> I would put my code in <code>~&#47;gocode&#47;src&#47;MyProject</code>? Then if I symlink the code to my custom workspace, when I <code>cd</code> into my custom workspace, it would automatically redirect the terminal to the GOPATH?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466799106, "post_id": 38019786, "comment_id": 63484503, "body": "@Mr.Foots: yes (sort of). I would highly recommend learning a bit about *nix environments while you&#39;re at it. Note that there are a few things that could trip you up being in a symlinked path, but in those rare cases you can switch directories into the real path in GOPATH."}, {"owner": {"reputation": 320, "user_id": 3529271, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/NmPnP.jpg?s=128&g=1", "display_name": "Mr. Foots", "link": "https://stackoverflow.com/users/3529271/mr-foots"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466803225, "post_id": 38019786, "comment_id": 63486234, "body": "Alright so I did some experimentation and it seems like the symlink (created with Plato&#39;s command with the target dir lacking the <code>&#47;project</code> as Mac os x apparently creates its own folder named after the folder used in the symlink) works perfectly. So thank you @JimB and @Plato."}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1466796092, "creation_date": 1466796092, "answer_id": 38020685, "question_id": 38019786, "link": "https://stackoverflow.com/questions/38019786/how-to-fragment-the-go-workspace/38020685#38020685", "title": "How to fragment the Go workspace", "body": "<p><a href=\"https://dmitri.shuralyov.com/blog/18\" rel=\"nofollow\">https://dmitri.shuralyov.com/blog/18</a></p>\n\n<p>That blog lists how you can set up multiple paths into your <code>$GOPATH</code> variable to let you do what you want.  The idea is that you have some default workspace (which is where all your <code>go get</code> packages will be put), and then any additional workspaces you have can follow that default workspace in the environment variable (colon-separated on unix-based).  The Go tool is specifically designed to handle this use case, and will check each path in your <code>$GOPATH</code>, in order, for dependencies, using the first version of that dependency that it finds.</p>\n\n<p>The only major thing you'll have to be aware of if you do this is that you can't use <code>$GOPATH</code> as an actual path string anymore (you have to split it up first).  Some Go packages may not be able to handle this setup.  However, if you ever need to find a file in any of the paths in your <code>$GOPATH</code> yourself, this function will do so:</p>\n\n<pre><code>func FindInGoPath(filePath string) (string, error) {\n    pathList := strings.Split(os.ExpandEnv(\"${GOPATH}\"), string(os.PathListSeparator))\n\n    if strings.TrimSpace(pathList) == \"\" {\n        return \"\", errors.New(\"$GOPATH environment variable is empty/not set\")\n    }\n\n    for _, path := range pathList {\n        if !strings.HasSuffix(path, string(os.PathSeparator)) {\n            path += string(os.PathSeparator)\n        }\n        if _, err := os.Stat(path + filePath); err == nil {\n            return path + filePath, nil\n        }\n    }\n    return \"\", errors.New(\"file not found\")\n}\n</code></pre>\n"}], "owner": {"reputation": 320, "user_id": 3529271, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/NmPnP.jpg?s=128&g=1", "display_name": "Mr. Foots", "link": "https://stackoverflow.com/users/3529271/mr-foots"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466796092, "creation_date": 1466792339, "question_id": 38019786, "link": "https://stackoverflow.com/questions/38019786/how-to-fragment-the-go-workspace", "title": "How to fragment the Go workspace", "body": "<p>So I've run into an issue with the whole Go workspace and my own personal code organization. So I understand how the workspace is supposed to be set up as, with src, pkg, and bin, under one overarching gocode folder. </p>\n\n<p>However, this doesn't really integrate well with my workflow. In my code folder, I have two other folders: Work and Personal. Work of course is the folder that contains all of the projects that I am working on for my job, and personal is for personal side projects or fun testing. In both folders I have Go projects, along with JavaScript, python, and HTML projects. I do not really want to cross Work and Personal together in the same Go folder because I would like to cd into Work and see all of my projects (either for reference or ease of access) and same with Personal. I do not want to switch between one folder filled with a clash of Work and Personal Go code, and then another Work folder with loads of Javascript.</p>\n\n<p>But when I organize my projects as I explained, I essentially break the whole GOPATH functionality which in turns messes with import statements, etc. So is there anyway that I can continue organizing my projects as they are and trick Go into thinking that they are all in a central Go/src folder? I believe I could do something with symlinks as I am on Mac o x but I do not know if that works or not. Any developer solve this problem in their own company? Thanks!</p>\n"}, {"tags": ["pointers", "go", "initialization"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1466835423, "post_id": 38019680, "comment_id": 63491793, "body": "This video explains C pointers, but the lesson applies well to go too. <a href=\"https://www.youtube.com/watch?v=mnXkiAKbUPg\" rel=\"nofollow noreferrer\">youtube.com/watch?v=mnXkiAKbUPg</a>"}, {"owner": {"reputation": 138, "user_id": 5151619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LPuj6.jpg?s=128&g=1", "display_name": "sauroter", "link": "https://stackoverflow.com/users/5151619/sauroter"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1466836616, "post_id": 38019680, "comment_id": 63492016, "body": "Thank you for the video. I knew how it was working in C, I just never realized that it would be the same in go. Stupid me. But pointee for the referenced object was new. Actually very fitting."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1466800294, "last_edit_date": 1466800294, "creation_date": 1466793242, "answer_id": 38019987, "question_id": 38019680, "link": "https://stackoverflow.com/questions/38019680/go-pointer-first-assignment/38019987#38019987", "title": "Go pointer first assignment", "body": "<p>Each variable is initialized to the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow\">zero value</a> of its type if you don't explicitly specify an initial value. Zero value for all pointer types is <code>nil</code> which means it does not point to anything (yet).</p>\n\n<p>You may assign an address (pointer value) at any time to a variable of pointer type. But until you initialize your pointer variable (to anything other than <code>nil</code>), it points to nothing and thus you can't assign anything to where it points to (because that is \"nothing\").</p>\n\n<p>In order to set the pointed value, initialize it first so it will actually point to somewhere which you can set/change. This initialization may be the address of some other variable (of the same type as the pointed type - called the <em>element</em> type), or the address of some newly allocated zero value of the pointed type returned by the builtin <a href=\"https://golang.org/pkg/builtin/#new\" rel=\"nofollow\"><code>new()</code></a> function.</p>\n\n<p>This line</p>\n\n<pre><code>var b *string\n</code></pre>\n\n<p>just creates a new variable <code>b</code> of type <code>*string</code>, but it doesn't specify any initial value, so <code>b</code> will be initialized to <code>nil</code>. It does not point to anything (or to anywhere). If you attempt to set the <em>pointed</em> value:</p>\n\n<pre><code>var b *string\n*b = \"bar\"\n</code></pre>\n\n<p>You get a runtime panic:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>For you to be able to set the <em>pointed</em> value, you need to initialize it with a non-<code>nil</code> pointer value, e.g.:</p>\n\n<pre><code>b = new(string)\n</code></pre>\n\n<p>After this you can now set the pointed value:</p>\n\n<pre><code>*b = \"world\"\n</code></pre>\n\n<p>Note that when you do:</p>\n\n<pre><code>var b *string\nvar c string = \"bar\"\nb = &amp;c\n</code></pre>\n\n<p>This creates a variable <code>b</code> of type <code>*string</code> which will get the zero value <code>nil</code>. And creates a variable <code>c</code> of type <code>string</code>, and initializes it with the value <code>\"bar\"</code>. And after that takes the address of <code>c</code> and stores it in the pointer variable <code>b</code>. Now after this if you modify the value pointed by <code>b</code>, that will \"also\" modify the value of the variable <code>c</code> because <code>b</code> points to <code>c</code> (or more precisely <code>b</code> stores the memory address where <code>c</code> is). So if after this you do:</p>\n\n<pre><code>*b = \"world\"\n</code></pre>\n\n<p>And you print the value of both <code>c</code> and <code>*b</code>, both will be <code>\"world\"</code>:</p>\n\n<pre><code>fmt.Println(c, *b) // Prints \"world world\" \n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 5151619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LPuj6.jpg?s=128&g=1", "display_name": "sauroter", "link": "https://stackoverflow.com/users/5151619/sauroter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 38019987, "answer_count": 1, "score": 3, "last_activity_date": 1466834087, "creation_date": 1466791915, "last_edit_date": 1466834087, "question_id": 38019680, "link": "https://stackoverflow.com/questions/38019680/go-pointer-first-assignment", "title": "Go pointer first assignment", "body": "<p>While I was fooling around with closures, I stumbled upon this behavior. I can't wrap my head around it.</p>\n\n<p>This code snippet works:</p>\n\n<pre><code>func main(){\n    var a string = \"foo\"\n    var b *string\n    var c string = \"bar\"\n    b = &amp;c\n\n    fmt.Printf(\"%s %s\\n\", a, *b)\n\n    a = \"hello\"\n    *b = \"world\"\n\n    fmt.Printf(\"%s %s\\n\", a, *b)\n}\n</code></pre>\n\n<p>Whereas this does not:</p>\n\n<pre><code>func main(){\n    var a string = \"foo\"\n    var b *string\n    *b = \"bar\"\n\n    fmt.Printf(\"%s %s\\n\", a, *b)\n\n    a = \"hello\"\n    *b = \"world\"\n\n    fmt.Printf(\"%s %s\\n\", a, *b)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/NHw3X__Wtd\" rel=\"nofollow\">https://play.golang.org/p/NHw3X__Wtd</a></p>\n\n<p>Could someone much cleverer than me please explain.</p>\n"}, {"tags": ["go", "trace", "zipkin", "opentracing"], "comments": [{"owner": {"reputation": 471, "user_id": 2673284, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/40d04b9be7a037d05840c44dcec029ff?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Shkuro", "link": "https://stackoverflow.com/users/2673284/yuri-shkuro"}, "edited": false, "score": 0, "creation_date": 1489172066, "post_id": 38019422, "comment_id": 72571103, "body": "See <a href=\"http://stackoverflow.com/questions/42699603/how-can-i-get-a-trace-id-from-opentracing-api\" title=\"how can i get a trace id from opentracing api\">stackoverflow.com/questions/42699603/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1250, "user_id": 1357017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39aec5c6a5d39eb781d36fc55106404?s=128&d=identicon&r=PG", "display_name": "Ali Moghadam", "link": "https://stackoverflow.com/users/1357017/ali-moghadam"}, "edited": false, "score": 0, "creation_date": 1482398079, "post_id": 38021120, "comment_id": 69760573, "body": "I tried doing this but I got TraceID not defined error. It&#39;s picking up the Context from opentracing"}], "tags": [], "owner": {"reputation": 31, "user_id": 6509824, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DhAkcTUziRI/AAAAAAAAAAI/AAAAAAAAAAs/tfAgeapGHJs/photo.jpg?sz=128", "display_name": "Chris Kiick", "link": "https://stackoverflow.com/users/6509824/chris-kiick"}, "is_accepted": false, "score": 0, "last_activity_date": 1466797956, "creation_date": 1466797956, "answer_id": 38021120, "question_id": 38019422, "link": "https://stackoverflow.com/questions/38019422/get-traceid-from-zipkintracer/38021120#38021120", "title": "get traceId from zipkintracer", "body": "<pre><code>import (\n    \"github.com/opentracing/opentracing-go\"\n    \"github.com/openzipkin/zipkin-go-opentracing\"\n)\nfunc IdFromSpan(aspan interface{}) uint64 {\n    zspan := aspan.(zipkintracer.Span)\n    return zspan.Context().TraceID\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 916394, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57aaead30bfa2f76108d42070a3d76ba?s=128&d=identicon&r=PG", "display_name": "nboukeffa", "link": "https://stackoverflow.com/users/916394/nboukeffa"}, "is_accepted": false, "score": 0, "last_activity_date": 1503133172, "creation_date": 1503133172, "answer_id": 45769658, "question_id": 38019422, "link": "https://stackoverflow.com/questions/38019422/get-traceid-from-zipkintracer/45769658#45769658", "title": "get traceId from zipkintracer", "body": "<p>I'm not sure this is the right way to do it but this should normally works</p>\n\n<pre><code>stdopentracing \"github.com/opentracing/opentracing-go\"\nzipkin \"github.com/openzipkin/zipkin-go-opentracing\"\n\n[...]\n\nvar traceID string\n\nsp := stdopentracing.SpanFromContext(ctx)\n\nif sp != nil {\n    traceID = sp.Context().(zipkin.SpanContext).TraceID.ToHex()\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6509824, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DhAkcTUziRI/AAAAAAAAAAI/AAAAAAAAAAs/tfAgeapGHJs/photo.jpg?sz=128", "display_name": "Chris Kiick", "link": "https://stackoverflow.com/users/6509824/chris-kiick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 888, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1503133172, "creation_date": 1466790891, "last_edit_date": 1489259699, "question_id": 38019422, "link": "https://stackoverflow.com/questions/38019422/get-traceid-from-zipkintracer", "title": "get traceId from zipkintracer", "body": "<p>I am using <a href=\"https://github.com/openzipkin/zipkin-go-opentracing\" rel=\"nofollow\">zipkin-go-opentracing</a>, which is an implementation of the <a href=\"http://opentracing.io/\" rel=\"nofollow\">opentracing</a> API for zipkin in go.</p>\n\n<p>For (reasons) I need to get the traceId from a span. So the question:\ngiven a opentracing.Span, how do I get the TraceId?\nEverything I've tried has given me some kind of type assertion error.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "edited": false, "score": 0, "creation_date": 1466865822, "post_id": 38019616, "comment_id": 63499384, "body": "Thanks but, sadly, even after updating the code as suggested, I still get a failure message: <code>error: json: cannot unmarshal object into Go value of type []struct { Hash string &quot;json:\\&quot;hash\\&quot;</code> }&quot;"}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1466795266, "last_edit_date": 1466795266, "creation_date": 1466791659, "answer_id": 38019616, "question_id": 38019367, "link": "https://stackoverflow.com/questions/38019367/using-json-to-decode-a-small-amount-of-data-from-a-huge-string/38019616#38019616", "title": "Using JSON to decode a small amount of data from a huge string", "body": "<p>Your JSON isn't a list, which is what it would have to be to marshal to a slice.  </p>\n\n<p>However, if your input data is actually a list, you're probably running into problems with the destination structure (and more specifically, the <code>hash</code> field) not being exported.  It also may be easier to use an anonymous struct (which is by nature exported) rather than a type definition.  Instead of:</p>\n\n<pre><code>type Tx struct {\n    hash string\n}\nvar txs []Tx\nerr := json.Unmarshal(my_data, &amp;txs)\n</code></pre>\n\n<p>use:</p>\n\n<pre><code>var txs []struct {\n    Hash string `json:\"hash\"` // tag not strictly necessary, but useful for clarity\n}\nerr := json.Unmarshal(my_data, &amp;txs)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5203, "user_id": 3995261, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54754c59e35649b7d22d70b72ce2989a?s=128&d=identicon&r=PG&f=1", "display_name": "YakovL", "link": "https://stackoverflow.com/users/3995261/yakovl"}, "edited": false, "score": 0, "creation_date": 1466875081, "post_id": 38030952, "comment_id": 63502240, "body": "It is considered as best practice to provide the code in your post along with links to third party site (although it may be more illustrative with thier interactive engines). Partially because the link may get broken."}], "tags": [], "owner": {"reputation": 339, "user_id": 6512964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Kve6f8BM-o/AAAAAAAAAAI/AAAAAAAAB08/DZEVoRhF9Fw/photo.jpg?sz=128", "display_name": "Tom Cleveland", "link": "https://stackoverflow.com/users/6512964/tom-cleveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1466874809, "last_edit_date": 1495541769, "creation_date": 1466874809, "answer_id": 38030952, "question_id": 38019367, "link": "https://stackoverflow.com/questions/38019367/using-json-to-decode-a-small-amount-of-data-from-a-huge-string/38030952#38030952", "title": "Using JSON to decode a small amount of data from a huge string", "body": "<p><a href=\"https://stackoverflow.com/users/4551301/kaedys\">Kaedys</a> is right on both counts. </p>\n\n<ol>\n<li><p>Your JSON is an object, not an array.</p></li>\n<li><p>You aren't exporting the \"hash\" field in your struct, which the <code>encoding/json</code> library requires.</p></li>\n</ol>\n\n<p>If you put square brackets around the input JSON (to make it an array) and capitalize the \"hash\" field name, the <a href=\"https://play.golang.org/p/EiT6itJ5gQ\" rel=\"nofollow noreferrer\">code will work</a>. </p>\n"}], "owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 38030952, "answer_count": 2, "score": 0, "last_activity_date": 1466874809, "creation_date": 1466790650, "last_edit_date": 1466866226, "question_id": 38019367, "link": "https://stackoverflow.com/questions/38019367/using-json-to-decode-a-small-amount-of-data-from-a-huge-string", "title": "Using JSON to decode a small amount of data from a huge string", "body": "<p>I have a string representing a transaction data from the bitcoin network. I wish I could decode the string (named my_data) in such a way that I can retrieve only the value of the \"hash\" field. I have tried a small example (in the real situation I would have an array which each position contain a transfer data like the one you may see in the code):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    var my_data = []byte(`{\n   \"ver\":1,\n   \"inputs\":[\n      {\n         \"sequence\":4294967295,\n         \"prev_out\":{\n            \"spent\":true,\n            \"tx_index\":156978299,\n            \"type\":0,\n            \"addr\":\"34cXotJvHAz1RVFtmK2vU29E9d5hF2manG\",\n            \"value\":848231245,\n            \"n\":1,\n            \"script\":\"a914200f3e946fcf58d3f0787034a610860f0b96332d87\"\n         },\n             \"script\":\"004730440220149e4cd90c7b2648e89d357162f383098504eea21d390f02e5a289e114ed36520220556da97f0e6789d34f4fb1faf7a1c1055368c01ede85b8101be5007f7b9f3c190147304402200d72e1b91684cdb0e63ea2a24d6ae0b9e38dacdf068e2e08e46ce7f951cdc9dd0220242be0131722287bc15e3d802ba3dea9df0c18f3ec0ac6913b4146f7deb717c90147522102dfd3c8864cddd4d88a8f602d016a656132f89f66450966f9a4a45dea11ec6eb92102c5f064226fcd75fdcae289118b0c4d20e1bafbf4068e7102baec66fade94e3b952ae\"\n      }\n   ],\n   \"block_height\":417695,\n   \"relayed_by\":\"138.201.2.34\",\n   \"out\":[\n      {\n         \"spent\":false,\n         \"tx_index\":156978302,\n         \"type\":0,\n         \"addr\":\"1PWDLsx73qfyCUga29ffAjc2UVdWEeeHDL\",\n         \"value\":3123438,\n         \"n\":0,\n         \"script\":\"76a914f6d92221d499bf8c01a0dc6f0c04b82d6b62301f88ac\"\n      },\n      {\n         \"spent\":true,\n         \"tx_index\":156978302,\n         \"type\":0,\n         \"addr\":\"34cXotJvHAz1RVFtmK2vU29E9d5hF2manG\",\n         \"value\":845057807,\n         \"n\":1,\n         \"script\":\"a914200f3e946fcf58d3f0787034a610860f0b96332d87\"\n      }\n   ],\n   \"lock_time\":0,\n   \"size\":334,\n   \"double_spend\":false,\n   \"time\":1466725723,\n   \"tx_index\":156978302,\n   \"vin_sz\":1,\n   \"hash\":\"fae2577ff2a1cfa977c7a883ea4e594c91bd67c767ef1b7870475022c08a453b\",\n   \"vout_sz\":2\n}`)\n    type Tx struct {\n        hash string\n    }\n    var txs []Tx\n    err := json.Unmarshal(my_data, &amp;txs)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    for i:=0; i&lt;len(txs); i++{\n        fmt.Printf(\"%s\\n\\n\", txs[i].hash)\n    }\n}\n</code></pre>\n\n<p>but i keep getting the following error:</p>\n\n<pre><code>error: json: cannot unmarshal object into Go value of type []main.Tx\n</code></pre>\n\n<p>is there an easier way I could try that doesn't need the \"encoding/json\" library ?</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:</p>\n\n<p>The code I have was adapted from an example I extracted from <a href=\"https://golang.org/pkg/encoding/json/#example_Unmarshal\" rel=\"nofollow\">here</a>.</p>\n\n<p>I believe the issue lies within the string I'm trying to decode, since the pattern it's built on allows nested lists and field values with or without quotes. Though I'm not sure.</p>\n"}, {"tags": ["go", "blockchain", "grpc", "hyperledger"], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "edited": false, "score": 0, "creation_date": 1466957050, "post_id": 38023883, "comment_id": 63520633, "body": "hey, thanks for the detailed explanation. My Validation peer is starte din a docker ocntainer and I was missing the fact that we have to give the ip addres explicitly when using <code>peer node status</code>"}], "tags": [], "owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "is_accepted": true, "score": 3, "last_activity_date": 1466933547, "last_edit_date": 1466933547, "creation_date": 1466815280, "answer_id": 38023883, "question_id": 38017236, "link": "https://stackoverflow.com/questions/38017236/getting-grpc-timeout-while-setting-up-hyperledger-development-environment-and-ne/38023883#38023883", "title": "Getting grpc timeout while setting up Hyperledger development environment and network", "body": "<p>The \u201cError: Error trying to connect to local peer: grpc: timed out trying to connect\u201d usually means that Validation Peer is not started. In default configuration peer process should listen port 30303 and you can easily check that using <code>netstat -a | grep 30303</code></p>\n\n<p>If Validation Peer is started locally, the output should be similar to:</p>\n\n<pre><code>tcp6       0      0 [::]:30303              [::]:*                  LISTEN\n</code></pre>\n\n<p>In case if Validation Peer is started in Docker container or on remote VM the IP address should be provided:</p>\n\n<pre><code>CORE_PEER_ADDRESS=172.17.0.2:30303 ./peer node status\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 0, "accepted_answer_id": 38023883, "answer_count": 1, "score": 0, "last_activity_date": 1466933547, "creation_date": 1466782958, "question_id": 38017236, "link": "https://stackoverflow.com/questions/38017236/getting-grpc-timeout-while-setting-up-hyperledger-development-environment-and-ne", "title": "Getting grpc timeout while setting up Hyperledger development environment and network", "body": "<p>I followed the docs provided by the hyperledger/fabric documentation. I have setup a network with two validating peers and not CA. I try to run the \"peer node status\" and \"peer network list\" command and keep getting the following error:\n\"Error: Error trying to connect to local peer: grpc: timed out trying to connect\"</p>\n\n<p>I also tried changing the \"maxprocs\" to 2 in the core.yaml file, but it still didn't fix the issue. Any help is appreciated.</p>\n"}, {"tags": ["json", "serialization", "go"], "answers": [{"comments": [{"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1466888143, "post_id": 38022817, "comment_id": 63505945, "body": "Thanks, @icza. Custom marshaling seems very close to what I want, with one exception.The object that is an argument to FinctionX1 might not be an item but another FunctionX1 or FunctionX2 in which case the sub-item should not be called item. I tried to apply the same custom marshaler to item too, but I am getting one extra level there: <a href=\"https://play.golang.org/p/Op2tg1LOtZ\" rel=\"nofollow noreferrer\">play.golang.org/p/Op2tg1LOtZ</a>. Ideas how I can get rid of it?"}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1466888679, "post_id": 38022817, "comment_id": 63506065, "body": "Actually, I think I figured it out <a href=\"https://play.golang.org/p/6lVxnjnyit\" rel=\"nofollow noreferrer\">play.golang.org/p/6lVxnjnyit</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1509550165, "last_edit_date": 1509550165, "creation_date": 1466806233, "answer_id": 38022817, "question_id": 38017212, "link": "https://stackoverflow.com/questions/38017212/golang-json-serialization-deserialization-of-recursive-data-model/38022817#38022817", "title": "golang json serialization/deserialization of recursive data model", "body": "<h2>With Wrappers (struct or map)</h2>\n\n<p>You may use <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">struct tags</a> to map fields of structs to different names in/from JSON. So with this you can change <code>\"Object\"</code> to <code>\"item\"</code>:</p>\n\n<pre><code>type FunctionX1 struct {\n    Object IInclusionObject `json:\"item\"`\n}\n</code></pre>\n\n<p>But you still need a wrapper struct or map if you want <code>\"FunctionX1\"</code> to appear in the JSON text. For example:</p>\n\n<pre><code>f := FunctionX1{Item{\"foo\", []byte(\"bar\")}}\n\nif data, err := json.Marshal(map[string]interface{}{\"FunctionX1\": f}); err != nil {\n    panic(err)\n} else {\n    fmt.Println(string(data))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"FunctionX1\":{\"item\":{\"Description\":\"foo\",\"Data\":\"YmFy\"}}}\n</code></pre>\n\n<p>Or with a wrapper struct:</p>\n\n<pre><code>type Wrapper struct {\n    FunctionX1 FunctionX1\n}\n\nf := FunctionX1{Item{\"foo\", []byte(\"bar\")}}\n\nif data, err := json.Marshal(Wrapper{f}); err != nil {\n    panic(err)\n} else {\n    fmt.Println(string(data))\n}\n</code></pre>\n\n<p>Output is the same:</p>\n\n<pre><code>{\"FunctionX1\":{\"item\":{\"Description\":\"foo\",\"Data\":\"YmFy\"}}}\n</code></pre>\n\n<p>If you want pretty formatted JSON, you may use <a href=\"https://golang.org/pkg/encoding/json/#MarshalIndent\" rel=\"nofollow noreferrer\"><code>json.MarshalIndent()</code></a> to do the marshaling:</p>\n\n<pre><code>if data, err := json.MarshalIndent(Wrapper{f}, \"\", \"  \"); err != nil {\n    panic(err)\n} else {\n    fmt.Println(string(data))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\n  \"FunctionX1\": {\n    \"item\": {\n      \"Description\": \"foo\",\n      \"Data\": \"YmFy\"\n    }\n  }\n}\n</code></pre>\n\n<p>Try all the examples on the <a href=\"https://play.golang.org/p/Q_RPFI82IT\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<h2>With Custom Marshaling</h2>\n\n<p>If you don't want to utilize a wrapper struct or map, you need to use custom marshalling, but it's quite simple:</p>\n\n<pre><code>type FunctionX1 struct {\n    Object IInclusionObject `json:\"item\"`\n}\n\nfunc (f FunctionX1) MarshalJSON() ([]byte, error) {\n    type FunctionX1_ FunctionX1\n    return json.Marshal(map[string]interface{}{\"FunctionX1\": FunctionX1_(f)})\n}\n</code></pre>\n\n<p>Effectively we moved the wrapping into the <code>MarshalJSON()</code> method, so others marshaling values of <code>FunctionX1</code> don't have to.</p>\n\n<p>Testing it:</p>\n\n<pre><code>f := FunctionX1{Item{\"foo\", []byte(\"bar\")}}\n\nif data, err := json.Marshal(f); err != nil {\n    panic(err)\n} else {\n    fmt.Println(string(data))\n}\n\nif data, err := json.MarshalIndent(f, \"\", \"  \"); err != nil {\n    panic(err)\n} else {\n    fmt.Println(string(data))\n}\n</code></pre>\n\n<p>Note that the new <code>FunctionX1_</code> type inside <code>MarshalJSON()</code> is to avoid infinite \"recursion\".</p>\n\n<p>Output:</p>\n\n<pre><code>{\"FunctionX1\":{\"item\":{\"Description\":\"foo\",\"Data\":\"YmFy\"}}}\n{\n  \"FunctionX1\": {\n    \"item\": {\n      \"Description\": \"foo\",\n      \"Data\": \"YmFy\"\n    }\n  }\n}\n</code></pre>\n\n<p>Try this one on the <a href=\"https://play.golang.org/p/wZNAp8dcb5\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3039, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1509550165, "creation_date": 1466782890, "question_id": 38017212, "link": "https://stackoverflow.com/questions/38017212/golang-json-serialization-deserialization-of-recursive-data-model", "title": "golang json serialization/deserialization of recursive data model", "body": "<p>Lets say I have: </p>\n\n<pre><code>type IObject interface {\n}\n\ntype Item struct {\n    Description string\n    Data        []byte\n}\n\ntype FunctionX1 struct {\n    Object IInclusionObject\n}\n\ntype FunctionX2 struct {\n    Object1 IInclusionObject\n    Object2 IInclusionObject\n}\n</code></pre>\n\n<p>I would like to be able to serialization/deserialization a model, where <code>Item</code>, <code>FunctionX1</code> <code>FunctionX2</code> they all implement <code>IObject</code> and they could be pointing to each other arbitrarily deep.</p>\n\n<p>Note that I do not want: <code>FunctionX1{Item{\"foo\", []byte(\"bar\")}}</code> to be serialized as:</p>\n\n<pre><code>\"object\": {\n    \"Description\": \"foo\"\n    \"Data\": ...\n}\n</code></pre>\n\n<p>but rather:</p>\n\n<pre><code>\"FunctionX1\": {\n    \"item\": { \n        \"Description\": \"foo\"\n        \"Data\": ...\n    }\n}\n</code></pre>\n\n<p>Do I need to do my own JSON marshaller - it does not seem that I can use the existing one.</p>\n\n<p>Related questions in case I need my own. Is there JSON prettifier where I can stream valid but randomly formatted JSON and it to output pretty version (note the JSON could be significantly large - I do not want to generate, parse generate formatted).</p>\n"}, {"tags": ["go", "reverse-proxy"], "answers": [{"comments": [{"owner": {"reputation": 1071, "user_id": 241993, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zfpeC.jpg?s=128&g=1", "display_name": "Mohamed Bana", "link": "https://stackoverflow.com/users/241993/mohamed-bana"}, "edited": false, "score": 0, "creation_date": 1540385443, "post_id": 38017619, "comment_id": 92845136, "body": "Thanks for that answer. It really helped.  Do you know how to debug a failed request; in this case, how would I debug a version that does <i>not</i> have this <code>r.Host = r.URL.Host</code>."}], "tags": [], "owner": {"reputation": 1894, "user_id": 2269979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22a1e835980e29baccf08a62e7ff71?s=128&d=identicon&r=PG", "display_name": "molivier", "link": "https://stackoverflow.com/users/2269979/molivier"}, "is_accepted": false, "score": 3, "last_activity_date": 1466784188, "creation_date": 1466784188, "answer_id": 38017619, "question_id": 38016477, "link": "https://stackoverflow.com/questions/38016477/reverse-proxy-does-not-work/38017619#38017619", "title": "reverse proxy does not work", "body": "<p>From this article <a href=\"http://blog.semanticart.com/blog/2013/11/11/a-proper-api-proxy-written-in-go/\" rel=\"nofollow\">A Proper API Proxy Written in Go</a>:</p>\n\n<blockquote>\n  <p>httputil.NewSingleHostReverseProxy does not set the host of the request to the host of the destination server. If you\u2019re proxying from foo.com to bar.com, requests will arrive at bar.com with the host of foo.com. Many webservers are configured to not serve pages if a request doesn\u2019t appear from the same host.</p>\n</blockquote>\n\n<p>You need to define a custom middleware to set the required host parameter:</p>\n\n<pre><code>package main\n\nimport (\n        \"net/http\"\n        \"net/http/httputil\"\n        \"net/url\"\n)\n\nfunc sameHost(handler http.Handler) http.Handler {\n        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n                r.Host = r.URL.Host\n                handler.ServeHTTP(w, r)\n        })\n}\n\nfunc main()  {\n        // initialize our reverse proxy\n        u, _ := url.Parse(\"http://www.darul.io\")\n        reverseProxy := httputil.NewSingleHostReverseProxy(u)\n        // wrap that proxy with our sameHost function\n        singleHosted := sameHost(reverseProxy)\n        http.ListenAndServe(\":5000\", singleHosted)\n}\n</code></pre>\n"}], "owner": {"reputation": 4746, "user_id": 394572, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/1572070193/picture?type=large", "display_name": "alioygur", "link": "https://stackoverflow.com/users/394572/alioygur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1466784188, "creation_date": 1466780571, "question_id": 38016477, "link": "https://stackoverflow.com/questions/38016477/reverse-proxy-does-not-work", "title": "reverse proxy does not work", "body": "<p>I am using GO's reverse proxy like this, but this does not work well</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"net/http\"\n    \"net/http/httputil\"\n    \"net/url\"\n)\n\nfunc main() {\n    u, _ := url.Parse(\"http://www.darul.io\")\n\n    http.ListenAndServe(\":9000\", httputil.NewSingleHostReverseProxy(u))\n}\n</code></pre>\n\n<p>when I visit the <a href=\"http://localhost:9000\" rel=\"nofollow noreferrer\">http://localhost:9000</a>, I am seeing not expected page</p>\n\n<p><a href=\"https://i.stack.imgur.com/cPtEO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cPtEO.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["http", "go", "svgz"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466778735, "post_id": 38015870, "comment_id": 63473771, "body": "What content type does each server return?"}, {"owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466778749, "post_id": 38015870, "comment_id": 63473780, "body": "I also tried with beego , same results"}, {"owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466779492, "post_id": 38015870, "comment_id": 63474302, "body": "you can try it: <a href=\"http://97.107.133.88/test.svgz\" rel=\"nofollow noreferrer\">97.107.133.88/test.svgz</a>  and <a href=\"http://97.107.133.88:9090/test.svgz\" rel=\"nofollow noreferrer\">97.107.133.88:9090/test.svgz</a>"}, {"owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466779631, "post_id": 38015870, "comment_id": 63474379, "body": "also <a href=\"http://97.107.133.88/test.svg\" rel=\"nofollow noreferrer\">97.107.133.88/test.svg</a> and <a href=\"http://97.107.133.88:9090/test.svg\" rel=\"nofollow noreferrer\">97.107.133.88:9090/test.svg</a> both are working"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466780685, "post_id": 38015870, "comment_id": 63475055, "body": "What do you mean both are working? They both display correctly in your browser?"}, {"owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466780775, "post_id": 38015870, "comment_id": 63475110, "body": "svg is displaying correctly through dolang server and apache, while svgz gives error through golang server and display correctly through apache"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "edited": false, "score": 0, "creation_date": 1466782377, "post_id": 38016649, "comment_id": 63476094, "body": "thanks for the answer, any idea how this can be done using beego FW, svgz files are under static folder\\"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1466781115, "creation_date": 1466781115, "answer_id": 38016649, "question_id": 38015870, "link": "https://stackoverflow.com/questions/38015870/golang-static-files-svgz/38016649#38016649", "title": "Golang Static files (SVGZ)", "body": "<p>The Go <code>http.FileServer</code> doesn't automatically add <code>Content-Encoding</code> for sniffed files. If the file is pre-compressed you will need to add the appropriate value.</p>\n\n<p>You can add <code>Content-Encoding: gzip</code> to the headers and, and use <a href=\"https://golang.org/pkg/net/http/#ServeFile\" rel=\"nofollow\"><code>http.ServeFile</code></a> in your handler. </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5327266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h6lFJzJ1j_E/AAAAAAAAAAI/AAAAAAAAAJQ/YBpEiLSzNTo/photo.jpg?sz=128", "display_name": "dmknob", "link": "https://stackoverflow.com/users/5327266/dmknob"}, "reply_to_user": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "edited": false, "score": 0, "creation_date": 1466899585, "post_id": 38017232, "comment_id": 63508186, "body": "I&#39;m try in nginx, work with Chrome(51.0.2704.106) and fail on Firefox(45.0.2). And can&#39;t make work again with Go. No clue for now.."}], "tags": [], "owner": {"reputation": 1, "user_id": 5327266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h6lFJzJ1j_E/AAAAAAAAAAI/AAAAAAAAAJQ/YBpEiLSzNTo/photo.jpg?sz=128", "display_name": "dmknob", "link": "https://stackoverflow.com/users/5327266/dmknob"}, "is_accepted": false, "score": 0, "last_activity_date": 1466782950, "creation_date": 1466782950, "answer_id": 38017232, "question_id": 38015870, "link": "https://stackoverflow.com/questions/38015870/golang-static-files-svgz/38017232#38017232", "title": "Golang Static files (SVGZ)", "body": "<p>Apache Header (tested in Chrome):</p>\n\n<pre><code>HTTP/1.1 200 OK\nDate: Fri, 24 Jun 2016 14:56:03 GMT\nServer: Apache\nLast-Modified: Fri, 24 Jun 2016 14:43:34 GMT\nETag: \"443-5360731fd11b2\"\nAccept-Ranges: bytes\nContent-Length: 1091\nKeep-Alive: timeout=15, max=98\nConnection: Keep-Alive\nContent-Type: image/svg+xml\nContent-Encoding: gzip\n</code></pre>\n\n<p>Go Header (tested in Chrome):</p>\n\n<pre><code>HTTP/1.1 200 OK\nAccept-Ranges: bytes\nContent-Length: 1091\nContent-Type: image/svg+xml\nLast-Modified: Fri, 24 Jun 2016 14:43:34 GMT\nDate: Fri, 24 Jun 2016 14:54:56 GMT\n</code></pre>\n\n<p>Apache send \"Content-Encoding: gzip\" in header.</p>\n\n<p>Working code (heavy inspired by <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/Upzqsbu2zbo\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/golang-nuts/Upzqsbu2zbo</a> )</p>\n\n<p><a href=\"https://play.golang.org/p/eWxqHt9QbM\" rel=\"nofollow\">https://play.golang.org/p/eWxqHt9QbM</a></p>\n"}], "owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1466782950, "creation_date": 1466778672, "question_id": 38015870, "link": "https://stackoverflow.com/questions/38015870/golang-static-files-svgz", "title": "Golang Static files (SVGZ)", "body": "<p>Im trying to serve static .svgz files (compressed SVG) with the below script:</p>\n\n<pre><code>http.ListenAndServe(\":9090\", http.FileServer(http.Dir(\"/srv/www/htdocs/\")))\n</code></pre>\n\n<p>im getting the below error:</p>\n\n<pre><code>This page contains the following errors:\n\nerror on line 1 at column 1: Encoding error\nBelow is a rendering of the page up to the first error.\n</code></pre>\n\n<p>if i try to fetch the same file through apache, the file is displaying properly.</p>\n\n<p>is there a way to fix that?</p>\n"}, {"tags": ["javascript", "html", "go", "ssl-certificate"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466778052, "post_id": 38015512, "comment_id": 63473323, "body": "The only way to use https without warnings in a browser, is to use a certificate trusted by the browser."}, {"owner": {"reputation": 71, "user_id": 4555948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/daFTg.png?s=128&g=1", "display_name": "Tomi", "link": "https://stackoverflow.com/users/4555948/tomi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466779072, "post_id": 38015512, "comment_id": 63474016, "body": "Yes of course! I want to use letsencrypt.org, but the point is, that every client needs to download an application for their specific OS, before they are able to use all features of the website. But making this as a download, I need supply the certificate with the corresponding valid key.. as files."}], "owner": {"reputation": 71, "user_id": 4555948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/daFTg.png?s=128&g=1", "display_name": "Tomi", "link": "https://stackoverflow.com/users/4555948/tomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500219375, "creation_date": 1466777553, "last_edit_date": 1500219375, "question_id": 38015512, "link": "https://stackoverflow.com/questions/38015512/communicating-between-browser-and-local-application-secure-connection", "title": "Communicating between browser and local application - Secure connection?", "body": "<p>Currently creating an application launcher and updater based on a web page. Knowing the limitations of browsers (security reasons), for my project I needed to have a local application to control the update and the creation of the OS process. </p>\n\n<p>While testing and researching for a good amount of time; Now I have a working local-app, <em>written in Go</em>, that can create a process and kill it from an <code>ajax</code> <strong><code>POST</code></strong> request. I prepared some code to show, how my current attempt looks like (nothing fancy) :</p>\n\n<h3>index.html</h3>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta charset=\"utf-8\" /&gt;\n\n  &lt;title&gt;api_test&lt;/title&gt;\n  &lt;script src=\"js/jquery-3.0.0.min.js\"&gt;&lt;/script&gt;\n  &lt;script src=\"js/script.js\"&gt;&lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;h2 id=\"statusText\"&gt;&lt;/h2&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<h3>js/script.js</h3>\n\n<pre><code>$(document).ready(function(){\n  console.log(\"Hey! ;)\");\n  tryConnection();\n});\n\nfunction tryConnection() {\n  var statusReq = $.ajax({\n    method: \"GET\",\n    url: \"http://127.0.0.1:9091/api/test\",\n    dataType: \"json\"\n  });\n\n  statusReq.fail(function(){\n    $('#statusText').text(\"Fail\");\n    setTimeout(tryConnection, 5000);\n  });\n\n  statusReq.done(function(json){\n    $('#statusText').text(json.status);\n    console.log(\"Integer result: \" + json.result);\n    setTimeout(tryConnection, 10000);\n  });\n}\n</code></pre>\n\n<h3>Local application, app.go</h3>\n\n<pre><code>package main\n\nimport (\n  \"log\"\n  \"net/http\"\n  \"encoding/json\"\n)\n\ntype APITest struct {\n  Status string `json:\"status\"`\n  Result int `json:\"result,omitempty\"`\n};\n\nfunc testHandler(w http.ResponseWriter, r *http.Request) {\n  w.Header().Set(\"Access-Control-Allow-Origin\", \"*\");\n\n  TestValue := APITest{Status: \"Works!\", Result: 123};\n  json.NewEncoder(w).Encode(&amp;TestValue);\n}\n\nfunc main() {\n  log.Println(\"Started!\");\n  http.HandleFunc(\"/api/test\", testHandler);\n\n  err := http.ListenAndServe(\"127.0.0.1:9091\", nil);\n  if err != nil {\n    log.Fatal(\"Error occured:\", err);\n  }\n}\n</code></pre>\n\n<p>Everything seems to be fine! <em>But..</em></p>\n\n<p>The only problem I currently can't figure out is, How can I actually add support for <code>https://</code> connections without the need to carry the compiled binary with a cert and key file? Because I want to implement this feature into a <code>https://</code> only website and mixing together <code>https</code> and <code>http</code> connections, results in a <code>blocked mixed content</code> error from browser security restrictions, which is understandable.</p>\n\n<p>Maybe there are some other ways to implement this kind of communication? (to be clear, for <code>WebSockets</code> a secure connection is needed too).</p>\n"}, {"tags": ["go", "interface", "dry"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466775615, "post_id": 38014647, "comment_id": 63471788, "body": "You can delegate common fields/methods using struct embedding, but in reality you&#39;re not going to find anything this contrived."}], "answers": [{"comments": [{"owner": {"reputation": 779, "user_id": 2395058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a34b4ba13c28e2809235d2b36872ad43?s=128&d=identicon&r=PG", "display_name": "ridthyself", "link": "https://stackoverflow.com/users/2395058/ridthyself"}, "edited": false, "score": 0, "creation_date": 1466775863, "post_id": 38014789, "comment_id": 63471967, "body": "Is there a way to combine the Cat and Dog speak() methods, seeing as how they are identical? And: +1 for recognizing the Java accent."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1466781561, "post_id": 38014789, "comment_id": 63475611, "body": "Yes, there is, actually, but it requires embedding, so they <i>must</i> be <i>completely</i> identical.  Here&#39;s how: <a href=\"https://play.golang.org/p/M78lvvQvl_\" rel=\"nofollow noreferrer\">play.golang.org/p/M78lvvQvl_</a>"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 6, "last_activity_date": 1466775442, "creation_date": 1466775442, "answer_id": 38014789, "question_id": 38014647, "link": "https://stackoverflow.com/questions/38014647/coding-to-an-interface-in-go-without-repeating-yourself/38014789#38014789", "title": "Coding to an interface in Go without repeating yourself", "body": "<p>First: I cannot see any repetition in your code: You have cats and dogs and each cat may say something and each dog may something. If this is not the case and your assumption is true</p>\n\n<p>If all all Dogs woof and all cat meow how about:</p>\n\n<pre><code>const dogTalk = \"woof\"\nfunc (d Dog) speak() string { return dogTalk; }\n// or even\nfunc (d Cat) speak() string { return \"meow\"; }\n</code></pre>\n\n<p>(And: Don't code Java in Go)</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1466777851, "creation_date": 1466777851, "answer_id": 38015602, "question_id": 38014647, "link": "https://stackoverflow.com/questions/38014647/coding-to-an-interface-in-go-without-repeating-yourself/38015602#38015602", "title": "Coding to an interface in Go without repeating yourself", "body": "<p>You can embed a base type in some cases to delegate common fields and methods. This is not inheritance, it is only a form of automatic delegation via composition. Don't try to use this to create type hierarchies like you would in a java-style OOP language. </p>\n\n<p>Here you can delegate the <code>speak</code>  method to the <code>Speaker</code> type. In practice this is less useful because the <code>Speaker</code> and its methods have no relationship to the struct where they are embedded, i.e. a Speaker doesn't know which type it's speaking for, nor which individual instance. </p>\n\n<p><a href=\"https://play.golang.org/p/Bof92jZsNh\" rel=\"noreferrer\">https://play.golang.org/p/Bof92jZsNh</a></p>\n\n<pre><code>type Speaker struct {\n    Saying string\n}\n\nfunc (s Speaker) speak() string {\n    return s.Saying\n}\n\ntype Pet interface {\n    speak() string\n}\n\ntype Dog struct {\n    Speaker\n}\n\ntype Cat struct {\n    Speaker\n}\n\nfunc getSpeech(p Pet) string {\n    return p.speak()\n}\n\nfunc main() {\n    Fido := Dog{Speaker{Saying: \"woof\"}}\n    Lucy := Cat{Speaker{Saying: \"meow\"}}\n\n    fmt.Println(\"Fido says:\", getSpeech(Fido)) // Fido says: woof\n    fmt.Println(\"Lucy says:\", getSpeech(Lucy)) // Lucy says: meow\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1597566572, "creation_date": 1597566572, "answer_id": 63434758, "question_id": 38014647, "link": "https://stackoverflow.com/questions/38014647/coding-to-an-interface-in-go-without-repeating-yourself/63434758#63434758", "title": "Coding to an interface in Go without repeating yourself", "body": "<p>You could just do this.</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\ntype Pet interface{ speak() string }\ntype Speaker struct{ Saying string }\n\nfunc (s Speaker) speak() string { return s.Saying }\nfunc getSpeech(p Pet) string    { return p.speak() }\n\nfunc main() {\n    Fido := Speaker{Saying: &quot;woof&quot;}\n    Lucy := Speaker{Saying: &quot;meow&quot;}\n    fmt.Println(&quot;Fido says:&quot;, getSpeech(Fido)) // Fido says: woof\n    fmt.Println(&quot;Lucy says:&quot;, getSpeech(Lucy)) // Lucy says: meow\n}\n</code></pre>\n<p>I try not to make code too DRY that it\u00a0chafes. I'm okay with code that duplicates twice and only factor if it's repeated a third time.</p>\n"}], "owner": {"reputation": 779, "user_id": 2395058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a34b4ba13c28e2809235d2b36872ad43?s=128&d=identicon&r=PG", "display_name": "ridthyself", "link": "https://stackoverflow.com/users/2395058/ridthyself"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 38015602, "answer_count": 3, "score": 2, "last_activity_date": 1597566572, "creation_date": 1466774993, "question_id": 38014647, "link": "https://stackoverflow.com/questions/38014647/coding-to-an-interface-in-go-without-repeating-yourself", "title": "Coding to an interface in Go without repeating yourself", "body": "<p>Suppose I have two pets, a cat named Lucy and a dog named Fido. I have taught them both the same trick, \"speak\".</p>\n\n<p>In the future I would like to obtain more pets, and teach them different tricks, so in anticipation, I've coded to an interface:</p>\n\n<pre><code>package main                                                                 \n\nimport \"fmt\"                                                                 \n\ntype Pet interface {                                                         \n        speak() string                                                       \n}                                                                            \n\ntype Dog struct {                                                            \n        speech string                                                        \n}                                                                            \n\ntype Cat struct {                                                            \n        speech string                                                        \n}                                                                            \n\nfunc (c Cat) speak() string {                                                \n        return c.speech                                                      \n}                                                                            \n\nfunc (d Dog) speak() string {                                                \n        return d.speech                                                      \n}                                                                            \n\nfunc getSpeech(p Pet) string {                                               \n        return p.speak()                                                     \n}                                                                            \n\nfunc main() {                                                                \n        Fido := Dog{\"woof\"}                                                  \n        Lucy := Cat{\"meow\"}                                                  \n\n        fmt.Println(\"Fido says:\", getSpeech(Fido)) // Fido says: woof\n        fmt.Println(\"Lucy says:\", getSpeech(Lucy)) // Lucy says: meow\n} \n</code></pre>\n\n<p>Now, although this works well, it seems unnecessarily verbose. I'm clearly repeating myself.  Also, assuming all Dogs say \"woof\" and all Cats say \"meow\", is it idiomatic to initialize the string inside the struct?</p>\n\n<p>How would you re-factor this code to be more DRY without losing the benefit of an interface?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 7975, "user_id": 3836111, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8e3526756540925b0536455b280205?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Proske", "link": "https://stackoverflow.com/users/3836111/sebastian-proske"}, "edited": false, "score": 1, "creation_date": 1466774722, "post_id": 38014387, "comment_id": 63471265, "body": "If I read your question corrcectly, you are searching for a lookahead alternative. You might give <code>(?:^|[^n]|[^e]n|[^c]en)(ten)</code> a try."}, {"owner": {"reputation": 1997, "user_id": 140477, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/IjFb7.png?s=128&g=1", "display_name": "Kennedy", "link": "https://stackoverflow.com/users/140477/kennedy"}, "reply_to_user": {"reputation": 21876, "user_id": 1678362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba023d18099cde022b9e4394d5714c0?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1678362/aaron"}, "edited": false, "score": 0, "creation_date": 1466774923, "post_id": 38014387, "comment_id": 63471379, "body": "@Aaron Yes, I want to match &quot;ten&quot; when not preceded by &quot;cen&quot;. I have edited the question."}, {"owner": {"reputation": 1997, "user_id": 140477, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/IjFb7.png?s=128&g=1", "display_name": "Kennedy", "link": "https://stackoverflow.com/users/140477/kennedy"}, "reply_to_user": {"reputation": 7975, "user_id": 3836111, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8e3526756540925b0536455b280205?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Proske", "link": "https://stackoverflow.com/users/3836111/sebastian-proske"}, "edited": false, "score": 0, "creation_date": 1466775087, "post_id": 38014387, "comment_id": 63471470, "body": "@SebastianProske That works as expected! Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 7975, "user_id": 3836111, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8e3526756540925b0536455b280205?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Proske", "link": "https://stackoverflow.com/users/3836111/sebastian-proske"}, "is_accepted": true, "score": 9, "last_activity_date": 1466775999, "last_edit_date": 1466775999, "creation_date": 1466775672, "answer_id": 38014871, "question_id": 38014387, "link": "https://stackoverflow.com/questions/38014387/negative-lookbehind-alternative/38014871#38014871", "title": "Negative lookbehind alternative", "body": "<p>Due to the missing support for either lookahead or lookbehind, we need to stick to negated character classes - but <code>[^c][^e][^n]</code> doesn't fully cover it, as it would not allow cxxten and also not cover strings where there aren't 3 characters before <code>ten</code>.</p>\n\n<p>I came up with <code>(?:^|[^n]|(?:[^e]|^)n|(?:[^c]|^)en)ten</code>, that stores <code>ten</code> into the first captured group. It's creating alternatives for each possible way to not exactly match <code>cen</code>.</p>\n\n<p>An alternative might be matching <code>(.{0,3})(ten)</code> and discard the match programatically if the first group stores <code>cen</code>.</p>\n"}], "owner": {"reputation": 1997, "user_id": 140477, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/IjFb7.png?s=128&g=1", "display_name": "Kennedy", "link": "https://stackoverflow.com/users/140477/kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2751, "favorite_count": 0, "accepted_answer_id": 38014871, "answer_count": 1, "score": 6, "last_activity_date": 1466775999, "creation_date": 1466774146, "last_edit_date": 1466774847, "question_id": 38014387, "link": "https://stackoverflow.com/questions/38014387/negative-lookbehind-alternative", "title": "Negative lookbehind alternative", "body": "<p>I have a string</p>\n\n<p><code>centenary</code></p>\n\n<p>I'd like to match <code>ten</code> only when it is not preceded by <code>cen</code>.</p>\n\n<p>So far I have this regex:</p>\n\n<p><code>(([^c][^e][^n])|^)ten</code></p>\n\n<p>That returns <code>true</code> in the following cases <code>tenary</code>, <code>blahtenary</code> and false for <code>ctenary</code>, <code>cetenary</code>, <code>centanary</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    txt := \"ctenary\"\n    rx := `(([^c][^e][^n])|^)ten`\n    re := regexp.MustCompile(rx)\n    m := re.MatchString(txt)\n    fmt.Println(m)\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 23, "last_activity_date": 1475314202, "last_edit_date": 1475314202, "creation_date": 1466773298, "answer_id": 38014097, "question_id": 38013922, "link": "https://stackoverflow.com/questions/38013922/slicing-a-slice-pointer-passed-as-argument/38014097#38014097", "title": "Slicing a slice pointer passed as argument", "body": "<p>The error <code>cannot use type []byte as type *[]byte in argument to sliceArr()</code> comes from a typo which you haven't posted (you tried to pass a slice and not a pointer to a slice to <code>sliceArr()</code>).</p>\n\n<p>As to the other error (<code>cannot slice type *[]byte</code>), you just need to use parenthesis to group the pointer dereferencing:</p>\n\n<pre><code>*buf = (*buf)[i:]\n</code></pre>\n\n<p>And you accidentally left out a <code>=</code> sign from the variable declaration. Other than that, everything works as you wrote it:</p>\n\n<pre><code>func main() {\n    var buf = []byte{1, 2, 3, 4, 5}\n    sliceArr(&amp;buf, 2)\n    fmt.Println(buf)\n}\n\nfunc sliceArr(buf *[]byte, i int) {\n    *buf = (*buf)[i:]\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/jYncdyrbR9\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[3 4 5]\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Note that the <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"noreferrer\">specification states</a> that if <code>p</code> is a pointer to an <em>array</em>, <code>p[low:high]</code> is shorthand for <code>(*p)[low:high]</code>, that is, the pointer is dereferenced automatically for you. This does not happen automatically if <code>p</code> is a pointer to a <em>slice</em>, <code>p[low:high]</code> is invalid as you cannot slice a pointer. So you have to dereference the pointer manually in case of pointers to slices.</p>\n\n<p>Reason for this deviation is that a pointer to a slice is very rare as slices are already \"just\" descriptors (to a contiguous part of an underlying array), and slices are passed without a pointer most of the time, so if in the rare case (like this one) you do need to pass a pointer, you need to be explicit about handling it. Arrays on the other hand represent all the elements; assigning or passing arrays copies all the values, so it is much more common to use pointers to arrays (than pointers to slices) - hence it is justified to have more language support for working with array pointers.</p>\n\n<p>Also note that your task could be achieved by requiring only a (non pointer) slice as the parameter type and returning the new slice value - which of course must be assigned at the caller (a good example for this is the builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"noreferrer\"><code>append()</code></a> function).</p>\n\n<p><strong>Note #2:</strong></p>\n\n<p>If the parameter type is a slice (and not a pointer to a slice), and you pass a slice, the underlying array is not copied, only the slice header. But in this case if you slice the argument (which is a copy of the slice header), and you assign back the new slice (slice header) to the argument, you are just changing the value of the parameter (a local variable) and not the original value (variable) that was passed, this is why it won't work.</p>\n\n<p>Read the following blog posts for more details on slices:</p>\n\n<p><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">Go Slices: usage and internals</a></p>\n\n<p><a href=\"https://blog.golang.org/slices\" rel=\"noreferrer\">Arrays, slices (and strings): The mechanics of 'append'</a></p>\n"}], "owner": {"reputation": 1784, "user_id": 5479258, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9013d6bb5ccbdd8ef0cac115267fa2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user99999", "link": "https://stackoverflow.com/users/5479258/user99999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8223, "favorite_count": 3, "accepted_answer_id": 38014097, "answer_count": 1, "score": 6, "last_activity_date": 1475314202, "creation_date": 1466772762, "last_edit_date": 1466774927, "question_id": 38013922, "link": "https://stackoverflow.com/questions/38013922/slicing-a-slice-pointer-passed-as-argument", "title": "Slicing a slice pointer passed as argument", "body": "<p>I have the following code:</p>\n\n<pre><code>func main() {\n    var buf []byte{1, 2, 3, 4, 5}\n    buf = buf[2:]\n    fmt.Println(buf)\n    panic(1)\n}\n</code></pre>\n\n<p>However I want to pass a pointer to <code>buf</code> byte slice to another function, and slice it there, so something like:</p>\n\n<pre><code>func main() {\n    var buf []byte{1, 2, 3, 4, 5}\n    sliceArr(&amp;buf, 2)\n    fmt.Println(buf)\n    panic(1)\n}\n\nfunc sliceArr(buf *[]byte, i int) {\n    *buf = *buf[i:]\n}\n</code></pre>\n\n<p>It gives me an error that I cannot use type <code>[]byte</code> as type <code>*[]byte</code> in argument to <code>sliceArr()</code> function, and that I cannot slice type <code>*[]byte</code>. What's wrong? Aren't slices passed by reference by default? I tried to do this without a pointer but it doesn't work - the array is being copied. How can I do this?</p>\n"}, {"tags": ["go", "domain-driven-design"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 2, "creation_date": 1466773262, "post_id": 38013800, "comment_id": 63470356, "body": "i guess you could create an api boundary between the domain objects and the persistence layer, so your unmarshalling code would use the tagged struct then invoke <code>NewDomainObject(unmarshalled.X...)</code> BTW, why do you care? the tagged struct still represents the model, and can be used outside of a persistence layer. You may be trying to optimize something that&#39;s not broken simply to obey a pattern"}, {"owner": {"reputation": 83, "user_id": 4698496, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IzYUV99eY-A/AAAAAAAAAAI/AAAAAAAAABg/uKz4IpYSkyA/photo.jpg?sz=128", "display_name": "yakutori", "link": "https://stackoverflow.com/users/4698496/yakutori"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 2, "creation_date": 1466776879, "post_id": 38013800, "comment_id": 63472609, "body": "@Plato good point.  it&#39;s a silly question really since the mapping has to happen somewhere and the domain model is a good place.  i started this whole train of thought by not being happy with having an id of type bson.MongoID in my domain models and then went too far with it, not thinking too clearly.  cheers for helping me clarify."}], "owner": {"reputation": 83, "user_id": 4698496, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IzYUV99eY-A/AAAAAAAAAAI/AAAAAAAAABg/uKz4IpYSkyA/photo.jpg?sz=128", "display_name": "yakutori", "link": "https://stackoverflow.com/users/4698496/yakutori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 557, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1466772372, "creation_date": 1466772372, "question_id": 38013800, "link": "https://stackoverflow.com/questions/38013800/how-not-to-pollute-domain-model-with-persistence-layer-artifacts-when-practicing", "title": "How not to pollute domain model with persistence layer artifacts when practicing DDD in Golang?", "body": "<p>I'm practicing DDD using Golang and do not want to pollute my model with persistence artifacts like bson tags, neither with json tags that has to do with encoding/decoding data coming from endpoints.  </p>\n\n<p>What is an elegant way of achieving that without having to define structs in three places?</p>\n\n<p>I have gotten as far as to embed my model in a persistence layer version of my model, which wraps the model and adds a mongo-specific ID field, but the embedding means that i have to put my mongo tags in my model definitions and I'm faced with the same problem for my structs for enc/dec of my endpoints.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466774257, "post_id": 38013740, "comment_id": 63470981, "body": "I&#39;m not sure what you&#39;re referring to, but you don&#39;t need to &quot;shutdown a channel&quot;, nor can you signal to the goroutine to exit, a goroutines exits when it returns. Closing a channel means there will be no more values sent, and can used to unblock receivers or break range loops."}], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "is_accepted": true, "score": 1, "last_activity_date": 1466970743, "last_edit_date": 1466970743, "creation_date": 1466887520, "answer_id": 38032819, "question_id": 38013740, "link": "https://stackoverflow.com/questions/38013740/goroutines-behavior/38032819#38032819", "title": "Goroutines behavior", "body": "<p>It's not enough to add a \"return\" statement after \"\u0441 &lt;- chnum\". That's because the channel will block until the information can be inserted in the channel. Also, you need to consider that you might need a buffered channel so multiple entries can be inserted and retrieved from your threads. Consider the code below, which uses buffered channels:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    numGoRountines :=  10\n    c := make(chan int, numGoRountines)\n\n    for i := 0; i &lt; numGoRountines; i++ {\n        go myRoutine(i, c)\n    }\n\n    for i := 0; i &lt; numGoRountines; i++ {\n        fmt.Println(\"Returned routine:\", &lt;-c)\n    }\n}\n\nfunc myRoutine(chnum int, c chan int) {\n    //doing some stuff here\n    c &lt;- chnum\n    //and doing some stuff here\n}\n</code></pre>\n\n<p>Possible output:</p>\n\n<pre><code>Returned routine: 9\nReturned routine: 0\nReturned routine: 1\nReturned routine: 2\nReturned routine: 3\nReturned routine: 4\nReturned routine: 5\nReturned routine: 6\nReturned routine: 7\nReturned routine: 8\n</code></pre>\n\n<p>Regarding your second question, go will clean those extra goroutines for you. But be aware that if the parent dies, the child threads dies as well. You can see an example below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n\n    var waitGroupOnlyForParents sync.WaitGroup\n\n    numGoRountines :=  4\n\n    for i := 0; i &lt; numGoRountines; i++ {\n        waitGroupOnlyForParents.Add(1)\n        go myRoutine(&amp;waitGroupOnlyForParents, i)\n    }\n\n    // makes main function waits for every one who calls the method Done() in our wait group\n    waitGroupOnlyForParents.Wait()\n}\n\nfunc myRoutine(wg *sync.WaitGroup, myId int) {\n    defer wg.Done()\n\n    numGoRountines := 2\n    for i := 0; i &lt; numGoRountines; i++ {\n        go anotherRoutine(myId, i)\n    }\n}\nfunc anotherRoutine( parentId, childId int){\n    fmt.Printf(\"Created by %d, my name is %d\\n\", parentId, childId)\n}\n</code></pre>\n\n<p>possible output:</p>\n\n<pre><code>Created by 3, my name is 1\nCreated by 0, my name is 1\nCreated by 1, my name is 1\n</code></pre>\n\n<p>Now suppose we wish to sync all threads, to make sure each of them does everything they need we change the code slightly to this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n\n    var waitGroupForAllThreads sync.WaitGroup\n\n    numGoRountines :=  4\n\n    for i := 0; i &lt; numGoRountines; i++ {\n        waitGroupForAllThreads.Add(1)\n        go myRoutine(&amp;waitGroupForAllThreads, i)\n    }\n\n    // makes main function waits for every one who calls the method Done() in our wait group\n    waitGroupForAllThreads.Wait()\n}\n\nfunc myRoutine(wg *sync.WaitGroup, myId int) {\n    defer wg.Done()\n\n    numGoRountines := 2\n    for i := 0; i &lt; numGoRountines; i++ {\n        wg.Add(1)\n        go anotherRoutine(wg, myId, i)\n    }\n}\nfunc anotherRoutine(wg *sync.WaitGroup, parentId, childId int){\n    defer wg.Done()\n    fmt.Printf(\"Created by %d, my name is %d\\n\", parentId, childId)\n}\n</code></pre>\n\n<p>possible output (in this case all prints will for sure be displayed, the order may change):</p>\n\n<pre><code>Created by 3, my name is 1\nCreated by 0, my name is 1\nCreated by 1, my name is 1\nCreated by 2, my name is 1\nCreated by 3, my name is 0\nCreated by 0, my name is 0\nCreated by 1, my name is 0\nCreated by 2, my name is 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "is_accepted": false, "score": 1, "last_activity_date": 1467015457, "creation_date": 1467015457, "answer_id": 38048941, "question_id": 38013740, "link": "https://stackoverflow.com/questions/38013740/goroutines-behavior/38048941#38048941", "title": "Goroutines behavior", "body": "<blockquote>\n  <p>I wanted to know isn't it enough just add return after \u0441 &lt;- chnum?</p>\n</blockquote>\n\n<p>It is indeed, enough. Calling <code>return</code> inside a goroutine will termine it.<br>\nJust don't forget <code>close</code> your channel.</p>\n\n<blockquote>\n  <p>And second question about goroutines: When i start my app it creates 4 processes (one per cpu core) and my routines add two more. Should i do something to kill this two processes after finishing goroutines or Go does it by himself?</p>\n</blockquote>\n\n<p>Goroutines do not spawn additional processes, they are something internal to Go's runtime. When a Go app finishes it's work, your OS should properly clean everything.</p>\n"}], "owner": {"reputation": 233, "user_id": 978119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/63065694841cb294dda437d16669d36e?s=128&d=identicon&r=PG", "display_name": "aloneibreak", "link": "https://stackoverflow.com/users/978119/aloneibreak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 38032819, "answer_count": 2, "score": 3, "last_activity_date": 1467015457, "creation_date": 1466772128, "question_id": 38013740, "link": "https://stackoverflow.com/questions/38013740/goroutines-behavior", "title": "Goroutines behavior", "body": "<p>For example i have this code:</p>\n\n<pre><code>func main() {\n    go myRoutine(1, channel)\n    go myRoutine(2, channel)\n    go myRoutine(3, channel)\n    go myRoutine(4, channel)\n\n    for i := 0; i &lt; 4; i++ {\n        fmt.Println(\"Returned routine:\", &lt;-channel)\n    }\n}\n\nfunc myRoutine(chnum int, c chan int) {\n    //doing some stuff here\n    c &lt;- chnum\n    //and doing some stuff here\n}\n</code></pre>\n\n<p>I want myRoutine to exit just after writing to channel.\nGoogle tells that i should have shutdown channel and signal here if i want exit my goroutine.\nI wanted to know isn't it enough just add return after \u0441 &lt;- chnum?</p>\n\n<p>And second question about goroutines:\nWhen i start my app it creates 4 processes (one per cpu core) and my routines add two more. Should i do something to kill this two processes after finishing goroutines or Go does it by himself?                                                  </p>\n"}, {"tags": ["go", "atom-editor"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1466767933, "post_id": 38012317, "comment_id": 63467161, "body": "this belongs on go-plus&#39; issue tracker."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466769140, "post_id": 38012317, "comment_id": 63467868, "body": "have you tried <code>go get github.com&#47;algo&#47;package</code>? <i>edit</i> if your packages are already in your gopath this won&#39;t help"}, {"owner": {"reputation": 750, "user_id": 2839539, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sEZYB.jpg?s=128&g=1", "display_name": "Algo", "link": "https://stackoverflow.com/users/2839539/algo"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466769734, "post_id": 38012317, "comment_id": 63468218, "body": "@Plato Yup, already in gopath."}, {"owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 1, "creation_date": 1466779724, "post_id": 38012317, "comment_id": 63474441, "body": "I&#39;m using go-plus in atom too and it works just fine. In order to make import works, the tools used by go-plus need to find all your package inside the $GOPATH directory. So, if $GOPATH is correctly set, it should work. Don&#39;t forget that any imported package that is not used in your code, will be automatically removed from the import clause (if you configured go-plus do to that on save)."}], "answers": [{"tags": [], "owner": {"reputation": 750, "user_id": 2839539, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sEZYB.jpg?s=128&g=1", "display_name": "Algo", "link": "https://stackoverflow.com/users/2839539/algo"}, "is_accepted": true, "score": 3, "last_activity_date": 1466809082, "creation_date": 1466809082, "answer_id": 38023214, "question_id": 38012317, "link": "https://stackoverflow.com/questions/38012317/why-isnt-autocomplete-of-local-packages-working-in-atom-editor/38023214#38023214", "title": "Why isn&#39;t autocomplete of local packages working in Atom editor?", "body": "<p>The issue is addressed in the README.md of the go-plus package:</p>\n\n<blockquote>\n  <p>First of all, make sure\n  <a href=\"https://atom.io/packages/autocomplete-plus\" rel=\"nofollow\">autocomplete-plus</a> is\n  present on your setup. Go-plus provides autocompletion through\n  <a href=\"https://github.com/nsf/gocode\" rel=\"nofollow\">gocode</a> tool, so you should ensure\n  it's in PATH and available.</p>\n  \n  <p>If you can't get autocompletion for the user-defined packages working,\n  while it's there for packages from standard library, it's likely a\n  trivial gocode-related issue. Try running <code>gocode set</code>. Some expected\n  output'd be: <code>propose-builtins false lib-path \"\" autobuild false\n  force-debug-output \"\" package-lookup-mode \"go\"</code></p>\n  \n  <p><em>What you gotta do is switching autobuild to true, by running <code>gocode\n  set autobuild true</code>. Check autocompletion now, it must be working\n  right.</em></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 874316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a253166893968e9ea8f0a661fa7f782e?s=128&d=identicon&r=PG", "display_name": "Alex Ho", "link": "https://stackoverflow.com/users/874316/alex-ho"}, "is_accepted": false, "score": 0, "last_activity_date": 1485015234, "creation_date": 1485015234, "answer_id": 41781548, "question_id": 38012317, "link": "https://stackoverflow.com/questions/38012317/why-isnt-autocomplete-of-local-packages-working-in-atom-editor/41781548#41781548", "title": "Why isn&#39;t autocomplete of local packages working in Atom editor?", "body": "<p>Another possible cause is the <code>gocode</code> daemon is not working properly (either it is due to an update of Go or multiple <code>gocode</code> daemons). Closing the daemon may help.\n<code>gocode close</code></p>\n"}], "owner": {"reputation": 750, "user_id": 2839539, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sEZYB.jpg?s=128&g=1", "display_name": "Algo", "link": "https://stackoverflow.com/users/2839539/algo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2090, "favorite_count": 0, "accepted_answer_id": 38023214, "answer_count": 2, "score": 1, "last_activity_date": 1485015234, "creation_date": 1466767621, "last_edit_date": 1466794928, "question_id": 38012317, "link": "https://stackoverflow.com/questions/38012317/why-isnt-autocomplete-of-local-packages-working-in-atom-editor", "title": "Why isn&#39;t autocomplete of local packages working in Atom editor?", "body": "<p>Autocomplete (go-plus) works fine in Atom for standard library imports, but whenever I try to import my own packages It simply doesn't work. </p>\n\n<p>My package structure goes like this:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 pkg\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 Test\n        \u251c\u2500\u2500 MyPackage\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 hello.go\n        \u2514\u2500\u2500 main.go\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"Test/MyPackage\"\n)\n\nfunc main() {\n    hello.SayHello(\"World\")\n}\n</code></pre>\n\n<p><strong>hello.go</strong></p>\n\n<pre><code>package hello\n\nimport \"fmt\"\n\nconst Msg = \"Hello \"\n\nfunc SayHello(name string) {\n    fmt.Printf(\"%v%v!\\n\", Msg, name)\n}\n</code></pre>\n\n<p>The file compiles fine, but in <code>main.go</code> the <code>hello</code> package does not invoke any autocompletion in Atom, so what could be the problem?</p>\n"}, {"tags": ["caching", "go"], "comments": [{"owner": {"reputation": 161, "user_id": 7111995, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/362b2d03c7413977184f18ff5bfd302a?s=128&d=identicon&r=PG&f=1", "display_name": "K. Rhoda", "link": "https://stackoverflow.com/users/7111995/k-rhoda"}, "edited": false, "score": 0, "creation_date": 1537392529, "post_id": 38011288, "comment_id": 91772601, "body": "If this program has a clearly defined (and synchronous) end state, i.e. that it knows request 1 &amp; 2 succeeded and request 3 failed, is a local .json file out of the question (perhaps noting that request 3 failed in the instance given above)? Then it could feasibly read the .json file back into memory on a different run and understand the state from the prior execution. This also allows your deployment to match what you stated, be a single go binary that can be be distributed stand alone. It will produce it&#39;s own local data-store, and be somewhat dependent on it, but it isn&#39;t a second program."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "edited": false, "score": 0, "creation_date": 1466771028, "post_id": 38011665, "comment_id": 63469018, "body": "How can we save cache in file using go-cache , there is no example for saving results and fetching cache from file"}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "reply_to_user": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "edited": false, "score": 0, "creation_date": 1466771328, "post_id": 38011665, "comment_id": 63469198, "body": "@rohan using go-cache you can only store in memory your value. If you want store in a file the best choice is using Redis"}, {"owner": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "edited": false, "score": 0, "creation_date": 1466878324, "post_id": 38011665, "comment_id": 63503228, "body": "Redis will require its own server or installation in Go also , correct ? As it is required in other languages , Sorry I am new to Golang. As the tool will be command line and it will be distributed to users as single go file which they can build on their systems.  I am trying to avoid any extra installation required for tool, How good it will be to store Map objects in files locally and read and write in file only. Thanks in Advance"}], "tags": [], "owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "is_accepted": false, "score": 0, "last_activity_date": 1466765552, "creation_date": 1466765552, "answer_id": 38011665, "question_id": 38011288, "link": "https://stackoverflow.com/questions/38011288/how-to-do-persistent-caching-in-golang/38011665#38011665", "title": "How to do persistent caching in golang?", "body": "<p>You can store the data inside a <code>Map</code> and get it via <code>Key</code>, you can implement it or use plugin such as <a href=\"https://github.com/patrickmn/go-cache\" rel=\"nofollow\">go-cache</a>.<br>\nAs alternative you can use Redis for storing the data, <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow\">here</a> you can find the driver for Go</p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "edited": false, "score": 0, "creation_date": 1466770952, "post_id": 38011697, "comment_id": 63468967, "body": "Is it possible to store the results in key value pair in file and fetch it and parse it when required."}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "reply_to_user": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "edited": false, "score": 0, "creation_date": 1467012739, "post_id": 38011697, "comment_id": 63535647, "body": "Yes, it&#39;s possible. Example: <a href=\"https://github.com/gregjones/httpcache\" rel=\"nofollow noreferrer\">github.com/gregjones/httpcache</a> provides multiple backends right out of the box, there&#39;s diskcache and memcache for example that provide just that."}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "reply_to_user": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "edited": false, "score": 0, "creation_date": 1467012782, "post_id": 38011697, "comment_id": 63535676, "body": "But this goes a step forward and does caching automatically for you. You just tell it where to save things and then perform regular http calls."}], "tags": [], "owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "is_accepted": false, "score": 1, "last_activity_date": 1466765630, "last_edit_date": 1495535413, "creation_date": 1466765630, "answer_id": 38011697, "question_id": 38011288, "link": "https://stackoverflow.com/questions/38011288/how-to-do-persistent-caching-in-golang/38011697#38011697", "title": "How to do persistent caching in golang?", "body": "<p>There's a bunch of Go libraries to do HTTP caching transparently.</p>\n\n<ul>\n<li><a href=\"https://github.com/lox/httpcache\" rel=\"nofollow noreferrer\">https://github.com/lox/httpcache</a></li>\n<li><a href=\"https://github.com/gregjones/httpcache\" rel=\"nofollow noreferrer\">https://github.com/gregjones/httpcache</a></li>\n</ul>\n\n<p>Choose the one you like most and satisfies your needs better, both have examples in their README to get you started real fast.</p>\n\n<p>If for some reason you can't or don't wanna use third-party libraries check out this answer <a href=\"https://stackoverflow.com/a/32885209/322221\">https://stackoverflow.com/a/32885209/322221</a> which uses <a href=\"https://golang.org/pkg/net/http/httputil/#DumpRequest\" rel=\"nofollow noreferrer\">httputil.DumpResponse</a> and <a href=\"https://golang.org/pkg/net/http/#ReadResponse\" rel=\"nofollow noreferrer\">http.ReadResponse</a>, both on Go's standard library and also the answerer provides an example implementation you can base your work on.</p>\n"}], "owner": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8551, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1466775944, "creation_date": 1466764380, "last_edit_date": 1466775944, "question_id": 38011288, "link": "https://stackoverflow.com/questions/38011288/how-to-do-persistent-caching-in-golang", "title": "How to do persistent caching in golang?", "body": "<p>I am creating a command line utility using go , which will request particular server for data and will get the data from server in JSON response. Utility can do multiple requests for multiple products .\nI am able to do multiple requests and get the response for each product properly in JSON format.\nNow , I want to save the result locally in caching or local files. By which on every request I will check the local cache before sending request to server . If data is available for that product then no request will be send .</p>\n\n<p>I want to save the whole json response in cache or local file and keep that data every time before doing any request to server for data.</p>\n\n<p>Use Case :\nProducts {\"A\",\"B\",\"C\",\"D\",\"E\"} It could be any number of products\nTest 1 : Get data for A,B,C\nCheck local storage whether data is available or do request.\nSave json request in storage for each product.</p>\n\n<p>So for test 1 ,It will have entry like:\n[{test 1 : [{product a : json response} , {product b : json response} ,{product c : json response}]}]</p>\n\n<p>And in case if test fails in between and it get results for two products it should save response for 2 products and if we reran the test it will get result for 3rd product only.</p>\n"}, {"tags": ["vim", "go", "gofmt"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1466766432, "post_id": 38010819, "comment_id": 63466294, "body": "No you do not want to disable gofmt."}, {"owner": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 1, "creation_date": 1466778044, "post_id": 38010819, "comment_id": 63473320, "body": "So <code>vim-plug</code> guys told you the issue is with <code>vim-go</code>, and you&#39;re asking here hoping to get a different answer?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5929380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a534ce139032c35ba461572f4950da?s=128&d=identicon&r=PG&f=1", "display_name": "sameer oak", "link": "https://stackoverflow.com/users/5929380/sameer-oak"}, "edited": false, "score": 0, "creation_date": 1466831626, "post_id": 38011867, "comment_id": 63491191, "body": "thank you very much for the solution. i configured shiftwidth=4 and it solved my problem."}], "tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1466766131, "last_edit_date": 1495535645, "creation_date": 1466766131, "answer_id": 38011867, "question_id": 38010819, "link": "https://stackoverflow.com/questions/38010819/disable-gofmt-in-vim-plug-in-vim-ide/38011867#38011867", "title": "disable gofmt in vim-plug in vim ide", "body": "<p>Instead of disabling gofmt, you could make it work how you expect. <a href=\"https://stackoverflow.com/a/1878983/151825\">This answer about tabs/spaces</a> will be useful.</p>\n\n<p>You need to set <code>shiftwidth=4</code> so that tab indents appear to be the same size as tabs.  There are no 8 space tabs vs 4 space tabs (tabs don't have a width, vim uses these setting to display the tab as 4 characters.</p>\n\n<p>You really should reconsider fighting against gofmt, It will make reading the code much easier for anyone with Go experience. </p>\n"}], "owner": {"reputation": 13, "user_id": 5929380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a534ce139032c35ba461572f4950da?s=128&d=identicon&r=PG&f=1", "display_name": "sameer oak", "link": "https://stackoverflow.com/users/5929380/sameer-oak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "accepted_answer_id": 38011867, "answer_count": 1, "score": -1, "last_activity_date": 1466766131, "creation_date": 1466762862, "last_edit_date": 1466765499, "question_id": 38010819, "link": "https://stackoverflow.com/questions/38010819/disable-gofmt-in-vim-plug-in-vim-ide", "title": "disable gofmt in vim-plug in vim ide", "body": "<p>How can i disable gofmt in vim-plug ide for vim?</p>\n\n<p>Hello,\nI'm using vim-plug as my vim based IDE for golang.\nI've a very specific query. I don't want gofmt to do any unnecessary formatting for my code. I raised an issue with vim-plug on github but I was suggested that the issue is with vim-go.</p>\n\n<p>I've my own <code>set tabstop=4</code> in my <code>.vimrc</code>.\nI add header section to <code>.go</code> sources to help the reader understand what exactly the source file is all about. At many places in the code, additionally, I add more than 1 line in the code for cleaner segregation. Earlier, gofmt was modifying everything while saving a file.</p>\n\n<p>By including following 2 lines in my <code>.vimrc</code></p>\n\n<pre><code>let g:go_fmt_fail_silently = 1\nlet g:go_fmt_autosave = 0\nI've gotten rid of unnecessary errors and formatting by gofmt to my .go \n</code></pre>\n\n<p>source files, respectively.</p>\n\n<p>However, I'm not being able to disable gofmt from adding 8-space tab. Since I have my own 4-space tab, I don't want those 8-charater tabs added by <code>gofmt</code>.</p>\n\n<p>So, I want to disable <code>gofmt</code> at all. Can someone please help me to disable <code>gofmt</code>?</p>\n\n<p>Version information:\nI use vim-7.4 on CentOS 7.2</p>\n\n<p>Regards,\n- sameer oak.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13281, "user_id": 940834, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/03ef5a0987f8e09322461dc059972624?s=128&d=identicon&r=PG", "display_name": "IAmGroot", "link": "https://stackoverflow.com/users/940834/iamgroot"}, "edited": false, "score": 0, "creation_date": 1466762203, "post_id": 38010452, "comment_id": 63463878, "body": "dont know much about <code>go</code> but have you either accidently made a array of an array? Or try casting int8 to byte first."}, {"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1466762790, "post_id": 38010452, "comment_id": 63464278, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16888357/convert-an-integer-to-a-byte-array\">Convert an integer to a byte array</a>"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1466768749, "post_id": 38010611, "comment_id": 63467643, "body": "No need this &quot;tricky&quot; conversion, a simple <code>byte(value)</code> gives the same result."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1466788207, "post_id": 38010611, "comment_id": 63479267, "body": "It looks like you&#39;re right! I wonder if something changed here... I had found an older resource that expressed the need to convert to a positive number first."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1466790048, "post_id": 38010611, "comment_id": 63480162, "body": "There was no change. Either the old source was incorrect, or maybe it related to another language? Or maybe that included constant expressions..."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1466797599, "post_id": 38010611, "comment_id": 63483842, "body": "@icza Amazingly, I think my source was you! :-) <a href=\"http://stackoverflow.com/questions/28848187/golang-convert-int8-to-string/28848879#28848879\" title=\"golang convert int8 to string\">stackoverflow.com/questions/28848187/&hellip;</a>"}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": false, "score": 1, "last_activity_date": 1466788250, "last_edit_date": 1466788250, "creation_date": 1466762225, "answer_id": 38010611, "question_id": 38010452, "link": "https://stackoverflow.com/questions/38010452/putting-int8-into-byte-array/38010611#38010611", "title": "Putting int8 into byte array", "body": "<p>Try this:</p>\n\n<pre><code>buf := make([]byte, 1)\nvar value int8\nvalue = 45\nbuf[0] = byte(value)\n</code></pre>\n\n<p><strong>UPDATE</strong>: Took out the code converting negative numbers to positive ones. It appears that <code>byte(...)</code> already does this conversion in current versions of Go.</p>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1466781966, "post_id": 38011075, "comment_id": 63475874, "body": "Worth noting that <code>byte</code> is just an alias for <code>uint8</code> in Go.  That means the major difference is that you&#39;re trying to store a signed value into an unsigned slot.  Typecasting to <code>uint8</code>, or using a uint8 in the first place, works for this without needing a <code>byte</code> typecast.  Example: <a href=\"https://play.golang.org/p/XzQ7eWOS16\" rel=\"nofollow noreferrer\">play.golang.org/p/XzQ7eWOS16</a>"}], "tags": [], "owner": {"reputation": 3796, "user_id": 104749, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/E0lCr.png?s=128&g=1", "display_name": "Ross McFarlane", "link": "https://stackoverflow.com/users/104749/ross-mcfarlane"}, "is_accepted": false, "score": 2, "last_activity_date": 1466763661, "creation_date": 1466763661, "answer_id": 38011075, "question_id": 38010452, "link": "https://stackoverflow.com/questions/38010452/putting-int8-into-byte-array/38011075#38011075", "title": "Putting int8 into byte array", "body": "<p>The issue you're having their is that although <code>int8</code> and <code>byte</code> are roughly equivalent, they're not the same type. Go is a little stricter about this than, say, PHP (which isn't strict about much). You can get around this by explicitly casting the value to <code>byte</code>:</p>\n\n<pre><code>buf := make([]byte, 1)\nvar value int8\nvalue = 45\nbuf[0] = byte(value) // cast int8 to byte\n</code></pre>\n"}], "owner": {"reputation": 1784, "user_id": 5479258, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9013d6bb5ccbdd8ef0cac115267fa2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user99999", "link": "https://stackoverflow.com/users/5479258/user99999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4735, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1466788250, "creation_date": 1466761803, "question_id": 38010452, "link": "https://stackoverflow.com/questions/38010452/putting-int8-into-byte-array", "title": "Putting int8 into byte array", "body": "<p>I have the following byte array:</p>\n\n<pre><code>buf := make([]byte, 1)\nvar value int8\nvalue = 45\nbuf[0] = value // cannot use type int8 as type []byte in assignment\n</code></pre>\n\n<p>And when I want to put a char value into the byte array I get the error that I <code>cannot use type int8 as type []byte in assignment</code>. What's wrong? How do I do this?</p>\n"}, {"tags": ["string", "go", "c-strings"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1466751790, "post_id": 38007361, "comment_id": 63458181, "body": "If you need it, use <code>0</code> insted to get your work done."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1466754123, "post_id": 38007361, "comment_id": 63459408, "body": "See: <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">golang.org/ref/spec#String_literals</a> ."}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "edited": false, "score": 2, "creation_date": 1466755540, "post_id": 38007361, "comment_id": 63460241, "body": "NUL is escaped as <code>\\x00</code> in strings. Also, the language doesn&#39;t provide NUL-terminated strings so.. yes, you are forced to modify every string."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 39, "last_activity_date": 1471848986, "last_edit_date": 1471848986, "creation_date": 1466755619, "answer_id": 38008565, "question_id": 38007361, "link": "https://stackoverflow.com/questions/38007361/is-there-anyway-to-create-null-terminated-string-in-go/38008565#38008565", "title": "Is there anyway to create null terminated string in Go?", "body": "<p><a href=\"https://golang.org/ref/spec#String_literals\" rel=\"noreferrer\">Spec: String literals:</a></p>\n\n<blockquote>\n  <p>The text between the quotes forms the value of the literal, with backslash escapes interpreted as they are in <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"noreferrer\">rune literals</a> (except that <code>\\'</code> is illegal and <code>\\\"</code> is legal), with the same restrictions. The three-digit octal (<code>\\nnn</code>) and two-digit hexadecimal (<code>\\xnn</code>) escapes represent individual bytes of the resulting string; all other escapes represent the (possibly multi-byte) UTF-8 encoding of individual characters.</p>\n</blockquote>\n\n<p>So <code>\\0</code> is an illegal sequence, you have to use 3 octal digits:</p>\n\n<pre><code>s := \"golang\\000\"\n</code></pre>\n\n<p>Or use hex code (2 hex digits):</p>\n\n<pre><code>s := \"golang\\x00\"\n</code></pre>\n\n<p>Or a unicode sequence (4 hex digits):</p>\n\n<pre><code>s := \"golang\\u0000\"\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>s := \"golang\\000\"\nfmt.Println([]byte(s))\ns = \"golang\\x00\"\nfmt.Println([]byte(s))\ns = \"golang\\u0000\"\nfmt.Println([]byte(s))\n</code></pre>\n\n<p>Output: all end with a 0-code byte (try it on the <a href=\"https://play.golang.org/p/oKDlycXfsK\" rel=\"noreferrer\">Go Playground</a>).</p>\n\n<pre><code>[103 111 108 97 110 103 0]\n[103 111 108 97 110 103 0]\n[103 111 108 97 110 103 0]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1618286998, "creation_date": 1618286998, "answer_id": 67068622, "question_id": 38007361, "link": "https://stackoverflow.com/questions/38007361/is-there-anyway-to-create-null-terminated-string-in-go/67068622#67068622", "title": "Is there anyway to create null terminated string in Go?", "body": "<p>Another option is the <code>ByteSliceFromString</code> function:</p>\n<pre><code>package main\n\nimport (\n   &quot;fmt&quot;\n   &quot;golang.org/x/sys/windows&quot;\n)\n\nfunc main() {\n   b, e := windows.ByteSliceFromString(&quot;golang&quot;)\n   if e != nil {\n      panic(e)\n   }\n   fmt.Printf(&quot;%q\\n&quot;, string(b)) // &quot;golang\\x00&quot;\n}\n</code></pre>\n<ul>\n<li><a href=\"https://pkg.go.dev/golang.org/x/sys/unix#ByteSliceFromString\" rel=\"nofollow noreferrer\">https://pkg.go.dev/golang.org/x/sys/unix#ByteSliceFromString</a></li>\n<li><a href=\"https://pkg.go.dev/golang.org/x/sys/windows#ByteSliceFromString\" rel=\"nofollow noreferrer\">https://pkg.go.dev/golang.org/x/sys/windows#ByteSliceFromString</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1549, "user_id": 13631587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c4714de792628cb0aa0a4e39cf6eaa1?s=128&d=identicon&r=PG", "display_name": "Jon Nickles", "link": "https://stackoverflow.com/users/13631587/jon-nickles"}, "is_accepted": false, "score": 0, "last_activity_date": 1618978786, "creation_date": 1618978786, "answer_id": 67189232, "question_id": 38007361, "link": "https://stackoverflow.com/questions/38007361/is-there-anyway-to-create-null-terminated-string-in-go/67189232#67189232", "title": "Is there anyway to create null terminated string in Go?", "body": "<p>@icza describes how to write a string literal with a null terminator.  Use this code to add a null to the end of a string variable:</p>\n<pre><code> s += string(rune(0))\n</code></pre>\n<p>Example:</p>\n<pre><code>s := &quot;hello&quot;\ns += string(rune(0))\nfmt.Printf(&quot;%q\\n&quot;, s)  // prints &quot;hello\\x00&quot;\n</code></pre>\n"}], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13262, "favorite_count": 2, "accepted_answer_id": 38008565, "answer_count": 3, "score": 15, "last_activity_date": 1618978786, "creation_date": 1466751454, "last_edit_date": 1466756962, "question_id": 38007361, "link": "https://stackoverflow.com/questions/38007361/is-there-anyway-to-create-null-terminated-string-in-go", "title": "Is there anyway to create null terminated string in Go?", "body": "<p>Is there anyway to create null terminated <code>string</code> in Go?</p>\n\n<p>What I'm currently trying is <code>a:=\"golang\\0\"</code> but it is showing compilation error:</p>\n\n<pre><code>non-octal character in escape sequence: \"\n</code></pre>\n"}]