[{"tags": ["debugging", "go", "goclipse"], "comments": [{"owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "edited": false, "score": 0, "creation_date": 1432040525, "post_id": 30226605, "comment_id": 48747185, "body": "From: <a href=\"https://github.com/GoClipse/goclipse/blob/master/CONTRIBUTING.md#debugger-issues\" rel=\"nofollow noreferrer\">github.com/GoClipse/goclipse/blob/master/&hellip;</a>   &quot;Try to reproduce the problem outside of Eclipse, using just the command-line GDB interface. If the problem also occurs there, then it&#39;s an issue in either GDB or the Go compiler tools, not GoClipse. For more info on how to use command-line GDB, see <a href=\"http://golang.org/doc/gdb\" rel=\"nofollow noreferrer\">golang.org/doc/gdb</a>.&quot;  Unfortunately if the problem also occurs when running GDB directly, it&#39;s likely a bug or limitation with the Go toolchain&#39;s debugging support, so there is not much Goclipse can do."}, {"owner": {"reputation": 548, "user_id": 568390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/beae1d4e275fcb5135999224bbd4dcb0?s=128&d=identicon&r=PG", "display_name": "ledhed2222", "link": "https://stackoverflow.com/users/568390/ledhed2222"}, "reply_to_user": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "edited": false, "score": 0, "creation_date": 1432265494, "post_id": 30226605, "comment_id": 48864826, "body": "Thank you Bruno, it was definitely an issue with gdb.  I&#39;m not sure why, but gdb doesn&#39;t seem to respect my breakpoints at all. After poking around, I ultimately gave up on the possibility of a modern debugging experience with Go - I sank several hours into trying to correctly configure gdb for Go and got nowhere. I did find a useful debugger (written in Go!) called godebug, which offers the best experience I&#39;ve seen so far."}], "owner": {"reputation": 548, "user_id": 568390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/beae1d4e275fcb5135999224bbd4dcb0?s=128&d=identicon&r=PG", "display_name": "ledhed2222", "link": "https://stackoverflow.com/users/568390/ledhed2222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1431558157, "creation_date": 1431558157, "last_edit_date": 1495541658, "question_id": 30226605, "link": "https://stackoverflow.com/questions/30226605/cant-step-over-when-using-goclipse", "title": "Can&#39;t step over when using GoClipse", "body": "<p>This is a duplicate question from <a href=\"https://stackoverflow.com/questions/24561329/how-to-debug-go-programs-using-goclipse\">How to debug Go programs using GoClipse?</a>, however that thread only answered one of the two questions posed by the poster.</p>\n\n<p>When I debug my program with GoClipse, the \"step over\" command is functioning exactly the same as the \"step into\" command.</p>\n\n<p>Has anyone else seen this issue?</p>\n"}, {"tags": ["algorithm", "go"], "answers": [{"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": true, "score": 27, "last_activity_date": 1431557089, "creation_date": 1431557089, "answer_id": 30226442, "question_id": 30226438, "link": "https://stackoverflow.com/questions/30226438/generate-all-permutations-in-go/30226442#30226442", "title": "Generate all permutations in go", "body": "<p>There are a lot of the algorithms that generate <a href=\"http://en.wikipedia.org/wiki/Permutation#Algorithms_to_generate_permutations\" rel=\"noreferrer\">permutations</a>. One of the easiest I found is <a href=\"http://en.wikipedia.org/wiki/Heap%27s_algorithm\" rel=\"noreferrer\">Heap's algorithm</a>:</p>\n\n<blockquote>\n  <p>It generates each permutation from the previous one by choosing a pair\n  of elements to interchange.</p>\n</blockquote>\n\n<p>The idea and a pseudocode that prints the permutations one after another is outlined in the above link. Here is my implementation of the algorithm which returns all permutations</p>\n\n<pre><code>func permutations(arr []int)[][]int{\n    var helper func([]int, int)\n    res := [][]int{}\n\n    helper = func(arr []int, n int){\n        if n == 1{\n            tmp := make([]int, len(arr))\n            copy(tmp, arr)\n            res = append(res, tmp)\n        } else {\n            for i := 0; i &lt; n; i++{\n                helper(arr, n - 1)\n                if n % 2 == 1{\n                    tmp := arr[i]\n                    arr[i] = arr[n - 1]\n                    arr[n - 1] = tmp\n                } else {\n                    tmp := arr[0]\n                    arr[0] = arr[n - 1]\n                    arr[n - 1] = tmp\n                }\n            }\n        }\n    }\n    helper(arr, len(arr))\n    return res\n}\n</code></pre>\n\n<p>and here is an example of how to use it (<a href=\"https://play.golang.org/p/Ulyo1H2Bii\" rel=\"noreferrer\">Go playground</a>):</p>\n\n<pre><code>arr := []int{1, 2, 3}\nfmt.Println(permutations(arr))\n[[1 2 3] [2 1 3] [3 2 1] [2 3 1] [3 1 2] [1 3 2]]\n</code></pre>\n\n<p>One thing to notice that the permutations are not sorted lexicographically (as you have seen in <code>itertools.permutations</code>). If for some reason you need it to be sorted, one way I have found it is to generate them from a <a href=\"http://en.wikipedia.org/wiki/Factorial_number_system\" rel=\"noreferrer\">factorial number system</a> (it is described in <code>permutation section</code> and allows to quickly find n-th lexicographical permutation).</p>\n\n<p><strong>P.S.</strong> you can also take a look at others people code <a href=\"https://github.com/fighterlyt/permutation\" rel=\"noreferrer\">here</a> and <a href=\"http://rosettacode.org/wiki/Permutations#Go\" rel=\"noreferrer\">here</a> </p>\n"}, {"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 2, "creation_date": 1431584710, "post_id": 30230552, "comment_id": 48564361, "body": "Excellent implementation (+1 from me). Thank you for another algorithm. Just one minor bug: it panics on empty slice. You can also add that the permutations are in lexicographical order."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 2, "creation_date": 1495681584, "post_id": 30230552, "comment_id": 75358728, "body": "I&#39;ve turned this into a library for a personal project. I turned the functions into methods, fixed handling the empty slice, and added the option to read from a channel. <a href=\"https://gist.github.com/schwern/93f7d93c1c80f8720e6de85bdc92096f\" rel=\"nofollow noreferrer\">Have a look</a>. Would you mind if I published this open source?"}, {"owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 3, "creation_date": 1536486564, "post_id": 30230552, "comment_id": 91434844, "body": "+1 fastest algo for lexicographic ordered permutation afaik!  Could be sped up by additional ~10% if getPerm() line 1 is changed to result:=make([]int, len(orig)); copy(result, orig); (go1.10.3 darwin/amd64) The reason is that append is calling repeatedly for reallocation to allocate additional memory according to the exploitation of the append source (append is time critical)."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1592675426, "post_id": 30230552, "comment_id": 110512400, "body": "result variable of getPerm should be provided by the caller to prevent some more cpu usage."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 16, "last_activity_date": 1431584166, "creation_date": 1431584166, "answer_id": 30230552, "question_id": 30226438, "link": "https://stackoverflow.com/questions/30226438/generate-all-permutations-in-go/30230552#30230552", "title": "Generate all permutations in go", "body": "<p>Here's code that iterates over all permutations without generating them all first. The slice <code>p</code> keeps the intermediate state as offsets in a Fisher-Yates shuffle algorithm. This has the nice property that the zero value for <code>p</code> describes the identity permutation.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc nextPerm(p []int) {\n    for i := len(p) - 1; i &gt;= 0; i-- {\n        if i == 0 || p[i] &lt; len(p)-i-1 {\n            p[i]++\n            return\n        }\n        p[i] = 0\n    }\n}\n\nfunc getPerm(orig, p []int) []int {\n    result := append([]int{}, orig...)\n    for i, v := range p {\n        result[i], result[i+v] = result[i+v], result[i]\n    }\n    return result\n}\n\nfunc main() {\n    orig := []int{11, 22, 33}\n    for p := make([]int, len(orig)); p[0] &lt; len(p); nextPerm(p) {\n        fmt.Println(getPerm(orig, p))\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4667, "user_id": 268673, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/33abb5182937ebcc3765f224aa74c16d?s=128&d=identicon&r=PG", "display_name": "AndreDurao", "link": "https://stackoverflow.com/users/268673/andredurao"}, "reply_to_user": {"reputation": 5410, "user_id": 1390022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d29e994a1301613f40c4cc99909edb0?s=128&d=identicon&r=PG", "display_name": "derricw", "link": "https://stackoverflow.com/users/1390022/derricw"}, "edited": false, "score": 0, "creation_date": 1578001527, "post_id": 55885234, "comment_id": 105308460, "body": "Thanks @derricw, I forgot to insert that copy in the function. My original function used a slice of strings, so I didn&#39;t need to copy the array at that point. I will try to find a nicer way in the future."}], "tags": [], "owner": {"reputation": 4667, "user_id": 268673, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/33abb5182937ebcc3765f224aa74c16d?s=128&d=identicon&r=PG", "display_name": "AndreDurao", "link": "https://stackoverflow.com/users/268673/andredurao"}, "is_accepted": false, "score": 0, "last_activity_date": 1578001378, "last_edit_date": 1578001378, "creation_date": 1556402576, "answer_id": 55885234, "question_id": 30226438, "link": "https://stackoverflow.com/questions/30226438/generate-all-permutations-in-go/55885234#55885234", "title": "Generate all permutations in go", "body": "<p>In my case I had a reference to an array, then I've did a few changes in your example:</p>\n\n<pre><code>func generateIntPermutations(array []int, n int, result *[][]int) {\n    if n == 1 {\n        dst := make([]int, len(array))\n        copy(dst, array[:])\n        *result = append(*result, dst)\n    } else {\n        for i := 0; i &lt; n; i++ {\n            generateIntPermutations(array, n-1, result)\n            if n%2 == 0 {\n                // Golang allow us to do multiple assignments\n                array[0], array[n-1] = array[n-1], array[0]\n            } else {\n                array[i], array[n-1] = array[n-1], array[i]\n            }\n        }\n    }\n}\nnumbers := []int{0, 1, 2}\nvar result [][]int\ngenerateIntPermutations(numbers, len(numbers), &amp;result)\n\n// result -&gt; [[0 1 2] [1 0 2] [2 1 0] [1 2 0] [2 0 1] [0 2 1]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 8626433, "user_type": "registered", "profile_image": "https://graph.facebook.com/1276251982503903/picture?type=large", "display_name": "Damitha Dayananda", "link": "https://stackoverflow.com/users/8626433/damitha-dayananda"}, "is_accepted": false, "score": 0, "last_activity_date": 1605109321, "creation_date": 1605109321, "answer_id": 64789536, "question_id": 30226438, "link": "https://stackoverflow.com/questions/30226438/generate-all-permutations-in-go/64789536#64789536", "title": "Generate all permutations in go", "body": "<p>Another Working code</p>\n<pre><code>package permutations\n\nimport &quot;fmt&quot;\n\nfunc AllPermutation(a []int) {\n    var res [][]int\n    calPermutation(a, &amp;res, 0)\n    fmt.Println(res)\n}\nfunc calPermutation(arr []int, res *[][]int, k int) {\n    for i := k; i &lt; len(arr); i++ {\n        swap(arr, i, k)\n        calPermutation(arr, res, k+1)\n        swap(arr, k, i)\n    }\n    if k == len(arr)-1 {\n        r := make([]int, len(arr))\n        copy(r, arr)\n        *res = append(*res, r)\n        return\n    }\n}\nfunc swap(arr []int, i, k int) {\n    arr[i], arr[k] = arr[k], arr[i]\n}\n//result [[1 2 3] [1 3 2] [2 1 3] [2 3 1] [3 2 1] [3 1 2]]\n</code></pre>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11786, "favorite_count": 8, "accepted_answer_id": 30226442, "answer_count": 4, "score": 14, "last_activity_date": 1605109321, "creation_date": 1431557067, "question_id": 30226438, "link": "https://stackoverflow.com/questions/30226438/generate-all-permutations-in-go", "title": "Generate all permutations in go", "body": "<p>I am looking for a way to generate all possible permutations of a list of elements. Something similar to <a href=\"https://docs.python.org/2/library/itertools.html#itertools.permutations\" rel=\"noreferrer\">python's</a> <code>itertools.permutations(arr)</code></p>\n\n<pre><code>permutations ([])\n[]\n\npermutations ([1])\n[1]\n\npermutations ([1,2])\n[1, 2]\n[2, 1]\n\npermutations ([1,2,3])\n[1, 2, 3]\n[1, 3, 2]\n[2, 1, 3]\n[2, 3, 1]\n[3, 1, 2]\n[3, 2, 1]\n</code></pre>\n\n<p>With the difference that I do not care whether permutations would be generated on demand (like a generator in python) or all together. I also do not care whether they will be lexicographically sorted. All I need is to somehow get these <code>n!</code> permutations.</p>\n"}, {"tags": ["go", "split"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 8, "last_activity_date": 1431539399, "creation_date": 1431539399, "answer_id": 30221970, "question_id": 30221933, "link": "https://stackoverflow.com/questions/30221933/get-python-like-split-working-with-gos-strings-split/30221970#30221970", "title": "Get python-like split() working with go&#39;s strings.Split()", "body": "<p>You are looking for <a href=\"https://godoc.org/strings#Fields\" rel=\"noreferrer\"><code>strings.Fields</code></a>:</p>\n\n<blockquote>\n<pre><code>func Fields(s string) []string\n</code></pre>\n  \n  <p>Fields splits the string s around each instance of one or more consecutive white space characters, as defined by unicode.IsSpace, returning an array of substrings of s or an empty list if s contains only white space.</p>\n  \n  <p><strong>Example</strong></p>\n\n<pre><code>fmt.Printf(\"Fields are: %q\", strings.Fields(\"  foo bar  baz   \"))\n</code></pre>\n  \n  <p>Output:</p>\n\n<pre><code>Fields are: [\"foo\" \"bar\" \"baz\"]\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 1010, "user_id": 3326103, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06afeeee747f8c3245b1dc74f634db88?s=128&d=identicon&r=PG&f=1", "display_name": "linuxfan", "link": "https://stackoverflow.com/users/3326103/linuxfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1162, "favorite_count": 0, "closed_date": 1431553419, "answer_count": 1, "score": 4, "last_activity_date": 1431539399, "creation_date": 1431539276, "question_id": 30221933, "link": "https://stackoverflow.com/questions/30221933/get-python-like-split-working-with-gos-strings-split", "closed_reason": "Duplicate", "title": "Get python-like split() working with go&#39;s strings.Split()", "body": "<p>In python, the <code>split()</code> function with no separator splits the on whitespace/tab etc. and returns a list with <strong>all</strong> spaces removed</p>\n\n<pre><code>&gt;&gt;&gt; \"string    with multiple      spaces\".split()\n['string', 'with', 'multiple', 'spaces']\n</code></pre>\n\n<p>How can I achieve something similar in <code>go</code>? </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    s := \"string    with multiple      spaces\"\n    lst := strings.Split(s, \" \")\n    for k, v := range lst {\n        fmt.Println(k,v)\n    }\n}\n</code></pre>\n\n<p>The above gives </p>\n\n<pre><code>0 string\n1 \n2 \n3 \n4 with\n5 multiple\n6 \n7 \n8 \n9 \n10 \n11 spaces\n</code></pre>\n\n<p>I'd like to save each of the strings in <code>lst[0]</code>, <code>lst[1]</code>, <code>lst[2]</code> and <code>lst[3]</code>. Can this be done? Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1431536852, "post_id": 30220917, "comment_id": 48546210, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/30217922/network-file-share-possible-in-go-load-balanced-environment\">Network file share possible in Go load-balanced environment?</a>"}, {"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1431538244, "post_id": 30220917, "comment_id": 48546974, "body": "nope, this is the alternative approach im thinking might be a better alternative."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1431542209, "post_id": 30220917, "comment_id": 48549305, "body": "Even if it&#39;s not an exact duplicate, it still off topic, and not really programming related (unless you have a specific question about programming a file replication service, in which case, ask that question). Just like your other question, you should probably ask this on ServerFault or SuperUser."}, {"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1431543022, "post_id": 30220917, "comment_id": 48549755, "body": "Well it is a programming question since I need to implement this functionality in my application written in golang. What I&#39;m asking is how I&#39;d program such a thing in Go? But to make it clear i replaced the word &quot;setup&quot; with &quot;implement/code&quot;. So What I&#39;m asking is what libraries or perhaps a small code snippet to get me started or pointed in the right direction, if there should still be any doubt about the relevancy or what I&#39;m asking."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431550189, "post_id": 30220917, "comment_id": 48553660, "body": "See <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a>, specifically #4 and its link. As for an example of how to do it yourself, a &quot;file replication service&quot; isn&#39;t something you can demonstrate in a small code snippet."}, {"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431550578, "post_id": 30220917, "comment_id": 48553862, "body": "JimB, obviously you do not like or respect my question. If you do not have any constructive comments to lead me closer to an answer, can you at least stop commenting? This is a programming question, and one problem that I need to solve. I think it&#39;s a fair question, although certainly not easy. Asking for code snippets to point me in the right direction is certainly not forbidden by any law. There&#39;s not any info on how to achieve this in go, as far as I can tell by searching the web."}, {"owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "edited": false, "score": 1, "creation_date": 1431550581, "post_id": 30220917, "comment_id": 48553864, "body": "There already is a distributed replication program written in Go. It&#39;s called Syncthing."}, {"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 0, "creation_date": 1431550635, "post_id": 30220917, "comment_id": 48553889, "body": "Thanks andy. I&#39;ll check it out right now. See thats a comment I can use!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431551381, "post_id": 30220917, "comment_id": 48554288, "body": "It&#39;s a valid question, and I&#39;m just trying to get you to an answer. But being off topic here is just going to get closed or voted down. Setting up networked filesystems and file replication aren&#39;t uncommon tasks, but you&#39;re more likely to get an answer via ServerFault (or even SuperUser), since that is a common server administration task. As for your problem, it&#39;s even <i>more</i> common to share your assets outside of the filesystem, on a separate file server, or service like S3."}], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 0, "creation_date": 1431674179, "post_id": 30226210, "comment_id": 48607431, "body": "I was hoping to be able to do something similair to umbraco courier 2, but in the end I think perhaps I should start focussing on the application itself, without thinking too much about multi-site/load balancing networked setups. It looks like the external service, Syncthing would be able to keep files syncronized in a master/slave setup, and in PostgreSQL I guess master-slave database replication would be a viable solution. As the CMS progress however, I&#39;d really like to build this functionality into the application itself, but I guess for now I&#39;ll do it like this, to lower complexity a bit."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 3, "last_activity_date": 1431555831, "creation_date": 1431555831, "answer_id": 30226210, "question_id": 30220917, "link": "https://stackoverflow.com/questions/30220917/golang-file-and-folder-replication-mirroring-across-multiple-servers/30226210#30226210", "title": "Golang file and folder replication / mirroring across multiple servers", "body": "<p>You probably shouldn't do this. Use a distributed file system, object storage (ala S3 or GCS) or a syncing program like btsync or syncthing.</p>\n\n<p>If you still want to do this yourself, it will be challenging. You are basically building a distributed database and they are difficult to get right.</p>\n\n<p>At first blush you could checkout something like <a href=\"https://github.com/coreos/etcd\" rel=\"nofollow\">etcd</a> or <a href=\"https://github.com/hashicorp/raft\" rel=\"nofollow\">raft</a>, but unfortunately etcd doesn't work well with large files.</p>\n\n<p>You could, on upload, also copy the file to every other server using <a href=\"https://godoc.org/golang.org/x/crypto/ssh\" rel=\"nofollow\">ssh</a>. But then what happens when a server goes down? Or what happens when two people update the same file at the same time?</p>\n\n<p>Maybe you could design it such that every file gets a unique id (perhaps based on the hash of its contents so you can safely dedupe) and those files can never be updated or deleted, only added. That would solve the simultaneous update problem, but you'd still have the downtime problem.</p>\n\n<p>One approach would be for each server to maintain an append-only version log when a file is added:</p>\n\n<pre><code>VERSION | FILE HASH\n      1 |   abcd123\n      2 |   efgh456\n      3 |   ijkl789\n</code></pre>\n\n<p>With that you can pull every file from a server and a single number would be sufficient to know when a file is added. (For example if you think Server A is on version 5, and you get informed it is now on version 7, you know you need to sync 2 files)</p>\n\n<p>You could do this with a database table:</p>\n\n<pre><code>ID | LOCAL_SERVER_ID | REMOTE_SERVER_ID | VERSION | FILE HASH\n</code></pre>\n\n<p>Which you could periodically poll and do your syncing via ssh or http between machines. If a server was down you could just retry until it works.</p>\n\n<p>Or if you didn't want to have a centralized database for this you could use a library like <a href=\"https://godoc.org/github.com/hashicorp/memberlist\" rel=\"nofollow\">memberlist</a>. The local meta data for each node could be its version. </p>\n\n<p>Either way there will be some amount of delay between a file was uploaded to a single server, and when it's available on all of them. Handling that well is hard, which is why you probably shouldn't do this.</p>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 3, "accepted_answer_id": 30226210, "answer_count": 1, "score": 0, "last_activity_date": 1431555831, "creation_date": 1431535902, "last_edit_date": 1431547662, "question_id": 30220917, "link": "https://stackoverflow.com/questions/30220917/golang-file-and-folder-replication-mirroring-across-multiple-servers", "title": "Golang file and folder replication / mirroring across multiple servers", "body": "<p>Consider this scenario. In a load-balanced environment, I have 3 separate instances of a CMS running on 3 different physical servers. These 3 separate running instances of the application is sharing the same database.</p>\n\n<p>On each server, the CMS has a /media folder where all media subfolders and files reside. My question is how I'd implement/code a file replication service/functionality in Golang, so when a subfolder or file is added/changed/deleted on one of the servers, it'll get copied/replicated/deleted on all other servers?</p>\n\n<p>What packages would I need to look in to, or perhaps you have a small code snippet to help me get started? That would be awesome.</p>\n\n<p><em>Edit:\nThis question has been marked as \"duplicate\", but it is not. It is however an alternative to setting up a shared network file system. I'm thinking that keeping a copy of the same file on all servers, synchronizing and keeping them updated might be better than sharing them.</em></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1431534590, "post_id": 30220247, "comment_id": 48544865, "body": "Have a look at <a href=\"https://godoc.org/io#LimitedReader\" rel=\"nofollow noreferrer\"><code>io.LimitedReader</code></a>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431535783, "post_id": 30220247, "comment_id": 48545566, "body": "As Tim Cooper said, but I&#39;ll add that if you need the limit to be per message or somesuch you can just implement your own version of <code>io.LimitedReader</code> that lets you reset the count/limit between messages or some such. (Or directly change the <code>N</code> field as needed)."}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 4896540, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87995a686ab93aa90a57360c43ea00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4896540/alex"}, "edited": false, "score": 0, "creation_date": 1431583286, "post_id": 30226549, "comment_id": 48563733, "body": "Answer looking reasonable, I just switched from plain json.Decoder to use your code and received &quot;invalid character &#39;m&#39; after object key:value pair&quot; error from dec.Decode. Any idea how that happened? Message is guaranteed to be less then 5KB and I even increased limit to 100KB for testing."}, {"owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "reply_to_user": {"reputation": 502, "user_id": 4896540, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87995a686ab93aa90a57360c43ea00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4896540/alex"}, "edited": false, "score": 0, "creation_date": 1431607508, "post_id": 30226549, "comment_id": 48577028, "body": "Hard to know without seeing the code/data... When I use <code>conn := strings.NewReader(&quot;{\\&quot;a&quot;:&quot;b\\&quot;}{\\&quot;c\\&quot;:\\&quot;d\\&quot;}&quot;)</code> and change req to <code>var req map[string]interface{}</code> it correctly decodes both objects. Are you sure you&#39;re prepending the bytes from <code>dec.Buffered()</code> before reading the bytes from <code>conn</code>? Also, the decoder will ignore whitespace, but if you have anything else between your objects (<code>{&quot;a&quot;:&quot;b&quot;},{&quot;c&quot;:&quot;d&quot;}</code>) that won&#39;t work."}, {"owner": {"reputation": 502, "user_id": 4896540, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87995a686ab93aa90a57360c43ea00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4896540/alex"}, "edited": false, "score": 0, "creation_date": 1431614296, "post_id": 30226549, "comment_id": 48581680, "body": "Yes, sure. I am running it in a goroutine handleClient after AcceptTCP. dec.Buffered() prepended, code is identical. I am accepting this answer because for now I stick to ReadLine solution. Would be good to know what is wrong with 2nd solution. My data is JSON RPC followed by newline. Nothing special. Previous code worked with json.Decoder, but for some reason drop-in replacement does not work."}, {"owner": {"reputation": 502, "user_id": 4896540, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87995a686ab93aa90a57360c43ea00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4896540/alex"}, "edited": false, "score": 0, "creation_date": 1432286393, "post_id": 30226549, "comment_id": 48873678, "body": "Well, one of clients is broken and this is a reason of parsing problems. Excellent answer, thanks."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 3, "last_activity_date": 1431557696, "creation_date": 1431557696, "answer_id": 30226549, "question_id": 30220247, "link": "https://stackoverflow.com/questions/30220247/how-to-efficiently-implement-json-tcp-server-and-prevent-socket-flood/30226549#30226549", "title": "How to efficiently implement json tcp server and prevent socket flood?", "body": "<p>For the first example you can use <a href=\"http://golang.org/pkg/bufio/#Reader.ReadLine\" rel=\"nofollow\"><code>ReadLine</code></a>:</p>\n\n<pre><code>connbuff := bufio.NewReaderSize(conn, 5*1024)\nmsg, isPrefix, err := connbuff.ReadLine()\nif isPrefix {\n  // too long\n}\n...\n</code></pre>\n\n<p>If <code>isPrefix</code> is true then the line was too long. If you used a <code>bufio.Scanner</code> it actually already has a max token size of 64kb.</p>\n\n<p>As Tim Cooper &amp; Dave C said you can use <code>io.LimitedReader</code> for the second case, but there's one gotcha with the json decoder. It uses buffered IO, so it will read past the first request.</p>\n\n<p>To fix that use a combination of <code>io.MultiReader</code> and <code>io.LimitReader</code>:</p>\n\n<pre><code>// to start with we have nothing buffered (an empty byte slice)\nvar buffered io.Reader = bytes.NewReader([]byte{})\nfor {\n    // combine whatever was in buffered with conn, but only up to 5kb\n    dec := json.NewDecoder(io.LimitReader(io.MultiReader(buffered, conn), 5*1024))\n    var req string\n    err := dec.Decode(&amp;req)\n    if err == io.EOF {\n        break\n    } else if err != nil {\n        log.Fatalln(err)\n    }\n    // we probably read past the message, so save that to buffered\n    buffered = dec.Buffered()\n}\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 4896540, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87995a686ab93aa90a57360c43ea00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4896540/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 1, "accepted_answer_id": 30226549, "answer_count": 1, "score": 2, "last_activity_date": 1431557696, "creation_date": 1431533765, "question_id": 30220247, "link": "https://stackoverflow.com/questions/30220247/how-to-efficiently-implement-json-tcp-server-and-prevent-socket-flood", "title": "How to efficiently implement json tcp server and prevent socket flood?", "body": "<p>I am searching for most efficient solution, there are a lot of ways to read data from socket and decode json. I obviously should use json.Encoder and json.Decoder, because they are suitable for streaming nature of socket, but I have specific rule to prevent socket flooding, I must close connection if there is a single message > than 5 Kb. My message structure is JSON RPC.</p>\n\n<p>In the following example I can check length and apply policy:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>connbuf := bufio.NewReader(conn)\nmsg, err := connbuf.ReadBytes('\\n')\nif len(msg) &gt; 5 * 1024 {\n    conn.Close()\n}\n...\nvar req JSONRequest\nerr = json.Unmarshal(message, &amp;req)\n...\n</code></pre>\n\n<p>But if client pushes megabytes of data without delimiter, this data will be in application, in msg variable already before server will disconnect client. Pretty vulnerable.</p>\n\n<p>Second example uses Decoder, there is no chance to check size at all.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>dec = json.NewDecoder(conn)\nfor {\n    var req JSONRequest\n    if err := dec.Decode(&amp;req); err == io.EOF {\n        break\n    } else if err != nil {\n        log.Println(err.Error())\n        return err\n   }\n   ...\n}\n</code></pre>\n\n<p>What is the best approach you can suggest to me? Thanks.</p>\n"}, {"tags": ["go", "signals"], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 260971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/c2CKZ.png?s=128&g=1", "display_name": "Freaktor", "link": "https://stackoverflow.com/users/260971/freaktor"}, "edited": false, "score": 0, "creation_date": 1431566274, "post_id": 30226279, "comment_id": 48559188, "body": "how &quot;explosive&quot; this aproach is? I mean, i only need the pid to get captured by a goroutine so i can kill the sender child, nothing fancy."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 641, "user_id": 260971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/c2CKZ.png?s=128&g=1", "display_name": "Freaktor", "link": "https://stackoverflow.com/users/260971/freaktor"}, "edited": false, "score": 0, "creation_date": 1431567398, "post_id": 30226279, "comment_id": 48559486, "body": "@Freaktor: It locks you into requiring cgo and linux, it may break at some point, and it&#39;s likely for something where there&#39;s probably a better way. Maybe if you better describe what &quot;the alert&quot; signal is, and why the go program has to be the one to kill the child."}, {"owner": {"reputation": 641, "user_id": 260971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/c2CKZ.png?s=128&g=1", "display_name": "Freaktor", "link": "https://stackoverflow.com/users/260971/freaktor"}, "edited": false, "score": 0, "creation_date": 1431633026, "post_id": 30226279, "comment_id": 48593073, "body": "im calling some nagios plugins and im currently using a timeout over the execution, but the nagios standard says that the plugins will emit the alert signal if they got some problem so im trying to capture that event."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 641, "user_id": 260971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/c2CKZ.png?s=128&g=1", "display_name": "Freaktor", "link": "https://stackoverflow.com/users/260971/freaktor"}, "edited": false, "score": 0, "creation_date": 1431634612, "post_id": 30226279, "comment_id": 48594058, "body": "@Freaktor: I still don&#39;t understand what you mean. There&#39;s no such thing as &quot;the alert signal&quot; that you could catch, and from what I understand of nagios plugins, they communicate via stdout and their return code. Can you reference the documentation so we can see what you&#39;re trying to do?"}, {"owner": {"reputation": 641, "user_id": 260971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/c2CKZ.png?s=128&g=1", "display_name": "Freaktor", "link": "https://stackoverflow.com/users/260971/freaktor"}, "edited": false, "score": 0, "creation_date": 1431639338, "post_id": 30226279, "comment_id": 48596406, "body": "im sorry the signal that looking is called alarm but looks like the documentation says is a per script self anti hang mesure, and the caller do not need to capture any signal (the stdout,exit codes and stderr part are covered) so lets call this as solved. thanks"}, {"owner": {"reputation": 1245, "user_id": 986696, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7faEG.jpg?s=128&g=1", "display_name": "Alex Jansen", "link": "https://stackoverflow.com/users/986696/alex-jansen"}, "edited": false, "score": 0, "creation_date": 1581724775, "post_id": 30226279, "comment_id": 106544772, "body": "So if I receive the &quot;child exited&quot; signal, Go doesn&#39;t want me to know which child it was?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1470209536, "last_edit_date": 1470209536, "creation_date": 1431556189, "answer_id": 30226279, "question_id": 30219751, "link": "https://stackoverflow.com/questions/30219751/go-get-signal-origin/30226279#30226279", "title": "Go: Get signal origin", "body": "<p>No, you can't do this in an officially supported manner. The Go runtime needs to own the signal handlers, and that extra information isn't exposed in any way. </p>\n\n<p>You may still be able to do this from C by setting up a new signal handler, but I would be very cautious going about this (see issues like <a href=\"http://golang.org/issue/7227\" rel=\"nofollow\">issue/7227</a>). You're probably better off using another method for communication other than a signal.</p>\n\n<p>Here's a partial example based on Ian's code from issue 7227:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;string.h&gt;\n\nstruct sigaction old_action;\nvoid handler(int signum, siginfo_t *info, void *context) {\n    printf(\"Sent by %d\\n\", info-&gt;si_pid);\n}\n\nvoid test() {\n    struct sigaction action;\n    sigaction(SIGUSR1, NULL, &amp;action);\n    memset(&amp;action, 0, sizeof action);\n    sigfillset(&amp;action.sa_mask);\n    action.sa_sigaction = handler;\n    action.sa_flags = SA_NOCLDSTOP | SA_SIGINFO | SA_ONSTACK;\n    sigaction(SIGUSR1, &amp;action, &amp;old_action);\n}\n*/\nimport \"C\"\n\nimport (\n    \"os\"\n    \"syscall\"\n    \"time\"\n)\n\nfunc main() {\n    C.test()\n    pid := os.Getpid()\n    for {\n        syscall.Kill(pid, syscall.SIGUSR1)\n        time.Sleep(time.Second)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 260971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/c2CKZ.png?s=128&g=1", "display_name": "Freaktor", "link": "https://stackoverflow.com/users/260971/freaktor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 4, "accepted_answer_id": 30226279, "answer_count": 1, "score": 8, "last_activity_date": 1606410686, "creation_date": 1431532255, "last_edit_date": 1459896147, "question_id": 30219751, "link": "https://stackoverflow.com/questions/30219751/go-get-signal-origin", "title": "Go: Get signal origin", "body": "<p>I'm using Go to launch a couple of scripts and when they have some problems they use the \"alert\" signal, I know Go can capture those signals but I need to know the PID that originated the Signal. in C to the signal handler is passed a structure to know the pid who originated the signal but in Go looks like is not the case</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/signal\"\n)\n\nfunc main() {\n\n    c := make(chan os.Signal, 1)\n    signal.Notify(c, os.Interrupt, os.Kill)\n\n    s := &lt;-c\n    fmt.Println(\"Got signal:\", s)\n    fmt.Printf(\"%+v\\n\",s)\n}\n</code></pre>\n\n<p>the example below (extracted from the signal doc) send me the signal who originated the call but not any useful info (like the pid)</p>\n"}, {"tags": ["list", "go"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 1894236, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/49ff7a27d677c8fb27f0ab483cc13d03?s=128&d=identicon&r=PG", "display_name": "Illya Kovalevskyy", "link": "https://stackoverflow.com/users/1894236/illya-kovalevskyy"}, "edited": false, "score": 0, "creation_date": 1431527507, "post_id": 30217870, "comment_id": 48539610, "body": "It works! Pretty strange, cos I checked addresses of list and they were equal... Thanks, anyway!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1431527362, "creation_date": 1431527362, "answer_id": 30217870, "question_id": 30217782, "link": "https://stackoverflow.com/questions/30217782/failing-to-list-pushback/30217870#30217870", "title": "Failing to List.PushBack", "body": "<p>You're copying your Stream and List values in the Append method.</p>\n\n<p>Either make <code>Append</code> a pointer receiver</p>\n\n<pre><code>func (s *Stream) Append(value interface{}) {\n</code></pre>\n\n<p>or make <code>Stream.list</code> a <code>*list.List</code></p>\n\n<pre><code>type Stream struct {\n    list *list.List\n}\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 1894236, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/49ff7a27d677c8fb27f0ab483cc13d03?s=128&d=identicon&r=PG", "display_name": "Illya Kovalevskyy", "link": "https://stackoverflow.com/users/1894236/illya-kovalevskyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 30217870, "answer_count": 1, "score": 0, "last_activity_date": 1431527362, "creation_date": 1431527164, "question_id": 30217782, "link": "https://stackoverflow.com/questions/30217782/failing-to-list-pushback", "title": "Failing to List.PushBack", "body": "<p>Take a look at the following source code:</p>\n\n<pre><code>import \"container/list\"\n\ntype Stream struct {\n    list list.List\n}\n\nfunc (s Stream) Append(value interface{}) {\n    log.Println(s.list.Len())\n    s.list.PushBack(value)\n    log.Println(s.list.Len())\n}\n</code></pre>\n\n<p>This code will keep on printing <code>0</code> and <code>1</code> all the time. Am I doing it wrong?</p>\n"}, {"tags": ["json", "go", "geckoboard"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1431518430, "post_id": 30214094, "comment_id": 48532377, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/13364181/how-to-unmarshall-an-array-of-different-types-correctly\">How to unmarshall an array of different types correctly?</a>"}, {"owner": {"reputation": 1056, "user_id": 794897, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9edcb612b352826cd9ce45107a225932?s=128&d=identicon&r=PG", "display_name": "Elliot Lings", "link": "https://stackoverflow.com/users/794897/elliot-lings"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1431518648, "post_id": 30214094, "comment_id": 48532532, "body": "I need to do the opposite, marshall it (and how I would structure it), is the possible duplicate still relevant?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1431518893, "post_id": 30214094, "comment_id": 48532697, "body": "You probably mean the data-structure. I use it like this <code>map[string]interface{}</code> for each depth and <code>map[string]string</code> for each entry. Hope that helps you out. And please use <code>ffjson</code>. The native <code>json</code> is still very slow."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1431518963, "post_id": 30214094, "comment_id": 48532738, "body": "Yes, the basic principle is still the same. The simplest way you can represent your data in Go is <code>struct{ Item []interface{} }</code>. I may add an answer with an example, if you need it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1431519055, "post_id": 30214094, "comment_id": 48532797, "body": "Avoid structs if they&#39;re not necessary tho. When you really want performance and let the <code>reflect</code> of the marshaller kick in you will have extreme slowdowns. Just saying :)"}, {"owner": {"reputation": 1056, "user_id": 794897, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9edcb612b352826cd9ce45107a225932?s=128&d=identicon&r=PG", "display_name": "Elliot Lings", "link": "https://stackoverflow.com/users/794897/elliot-lings"}, "edited": false, "score": 0, "creation_date": 1431519249, "post_id": 30214094, "comment_id": 48532926, "body": "Thanks peeps, that&#39;s helpful and interesting. @Allendar are you saying structs are slow for JSON marshalling? I&#39;m trying to represent the graphs as Go types to make it easier to understand, I have something like this <a href=\"http://pastebin.com/Vxn0WAgU\" rel=\"nofollow noreferrer\">pastebin.com/Vxn0WAgU</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1431519442, "post_id": 30214094, "comment_id": 48533072, "body": "That&#39;s no problem tho. The slowdown is spoken in Go terms, so if your board-system is ok with tens of requests per second and not hundreds or thousands then you don&#39;t really need to worry."}, {"owner": {"reputation": 1056, "user_id": 794897, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9edcb612b352826cd9ce45107a225932?s=128&d=identicon&r=PG", "display_name": "Elliot Lings", "link": "https://stackoverflow.com/users/794897/elliot-lings"}, "edited": false, "score": 0, "creation_date": 1431519524, "post_id": 30214094, "comment_id": 48533134, "body": "Yeh that&#39;s cool. Performance isn&#39;t critical for this; never knew structs can slow down JSON marshalling though. Thanks for the insight"}], "answers": [{"comments": [{"owner": {"reputation": 1056, "user_id": 794897, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9edcb612b352826cd9ce45107a225932?s=128&d=identicon&r=PG", "display_name": "Elliot Lings", "link": "https://stackoverflow.com/users/794897/elliot-lings"}, "edited": false, "score": 0, "creation_date": 1431520029, "post_id": 30214612, "comment_id": 48533505, "body": "That&#39;s really helpful, thank you. I suppose a tradeoff to using maps is the code readability suffers a bit. Our application isn&#39;t performance critical so use of structs isn&#39;t too much of a problem. But thanks for the insight, I&#39;m sure this will come in handy in one day! :)"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431527727, "post_id": 30214612, "comment_id": 48539823, "body": "<code>string(i)</code> isn&#39;t doing what I think you intended."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1431533673, "post_id": 30214612, "comment_id": 48544242, "body": "Haha thanks, fixed it :) Those would&#39;ve been some evil bytes ^^"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "is_accepted": true, "score": 1, "last_activity_date": 1431557924, "last_edit_date": 1431557924, "creation_date": 1431519679, "answer_id": 30214612, "question_id": 30214094, "link": "https://stackoverflow.com/questions/30214094/best-way-to-represent-this-json-in-go/30214612#30214612", "title": "Best way to represent this JSON in Go?", "body": "<p>This stuff is easier than you might think. It's just not that well documented for the casual reader. I would recommend <code>ffjson</code> over normal <code>json</code> tho. It's made up in such a manner that you don't need to change your syntax other than the library name.</p>\n\n<p>It's easy as this:</p>\n\n<pre><code>type User struct {\n    Id      int    `json:'id'`\n    Name    string `json:name`\n    SomeId1 int    `json:some_id_1`\n    SomeId2 int    `json:some_id_2`\n    SomeId3 int    `json:some_id_3`\n    SomeId4 int    `json:some_id_4`\n}\n\nitem := map[string]User{}\nfor i := 0; i &lt; 10; i++ {\n    item[strconv.itoa(i)] = User{i, \"Username X\", 38393, 29384, 12393, 123981}\n}\nbuf, err := ffjson.Marshal(&amp;item)\n</code></pre>\n\n<p>The downside of structs (even in <code>ffjson</code> still) is that <code>reflection</code> will always be used, which, in times that you're in need of high performance, you will waste a lot of CPU cycles. <code>ffjson</code> is 2-3 times faster than normal <code>json</code> when you keep it to maps. This way the library can compile every data-structure you marshal and re-use it instead of constantly inspecting the data-integrity/structure with <code>reflect</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1471955123, "last_edit_date": 1471955123, "creation_date": 1431520707, "answer_id": 30215038, "question_id": 30214094, "link": "https://stackoverflow.com/questions/30214094/best-way-to-represent-this-json-in-go/30215038#30215038", "title": "Best way to represent this JSON in Go?", "body": "<p>There is an easy way to create a value of some data structure where you know the JSON output you want to generate/duplicate:</p>\n\n<p>Take the output you want to generate, and unmarshal it into a <code>map[string]interface{}</code>. You will get a map value which when you marshal will result in your desired output. When you unmarshal an expected output, you can inspect the result map value to know what you need to create in order for your expected output.</p>\n\n<p>This works in your case too. Here is the code:</p>\n\n<pre><code>var m map[string]interface{}\nerr := json.Unmarshal([]byte(input), &amp;m)\nif err != nil {\n    panic(err)\n}\nfmt.Printf(\"%+v\\n\", m)\n\nres, err := json.MarshalIndent(m, \"\", \"  \")\nif err != nil {\n    panic(err)\n}\nfmt.Println(string(res))\n</code></pre>\n\n<p>Where <code>input</code> is your JSON input:</p>\n\n<pre><code>const input = `{\n  \"item\": [\n    {\n      \"value\": \"274057\"\n    },\n    [\n      \"38594\",\n      \"39957\",\n      \"35316\",\n      \"35913\",\n      \"36668\",\n      \"45660\",\n      \"41949\"\n    ]\n  ]\n}`\n</code></pre>\n\n<p>This program generates the same output as your required output (or input):</p>\n\n<pre><code>map[item:[map[value:274057] [38594 39957 35316 35913 36668 45660 41949]]]\n{\n  \"item\": [\n    {\n      \"value\": \"274057\"\n    },\n    [\n      \"38594\",\n      \"39957\",\n      \"35316\",\n      \"35913\",\n      \"36668\",\n      \"45660\",\n      \"41949\"\n    ]\n  ]\n}\n</code></pre>\n\n<p>Try the complete application on the <a href=\"http://play.golang.org/p/nVVI3WLXqk\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<h3>Analyzing your unmarshaled map value:</h3>\n\n<p>Obviously it has a key <code>\"item\"</code>, its value's type:</p>\n\n<pre><code>fmt.Printf(\"%T\\n\", m[\"item\"]); // Prints []interface{}\n</code></pre>\n\n<p>So it's a slice. It has 2 values, their types:</p>\n\n<pre><code>fmt.Printf(\"%T\\n\", m[\"item\"].([]interface{})[0]); // map[string]interface{}\nfmt.Printf(\"%T\\n\", m[\"item\"].([]interface{})[1]); // []interface{}\n</code></pre>\n\n<p>So the slice contains 2 values:</p>\n\n<ul>\n<li>a map (the <code>\"value\" : \"274057\"</code> pair)</li>\n<li>and another slice (the list of ids or numbers)</li>\n</ul>\n\n<p>Here is the Go code to reproduce the same map value:</p>\n\n<pre><code>m := map[string]interface{}{\n    \"item\": []interface{}{\n        map[string]interface{}{\"value\": \"274057\"},\n        []interface{}{\"38594\", \"39957\", \"35316\", \"35913\", \"36668\", \"45660\", \"41949\"},\n    },\n}\n</code></pre>\n\n<p>Marshaling this produces the same JSON output.</p>\n"}], "owner": {"reputation": 1056, "user_id": 794897, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9edcb612b352826cd9ce45107a225932?s=128&d=identicon&r=PG", "display_name": "Elliot Lings", "link": "https://stackoverflow.com/users/794897/elliot-lings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 1, "accepted_answer_id": 30214612, "answer_count": 2, "score": 1, "last_activity_date": 1471955123, "creation_date": 1431518186, "last_edit_date": 1431522866, "question_id": 30214094, "link": "https://stackoverflow.com/questions/30214094/best-way-to-represent-this-json-in-go", "title": "Best way to represent this JSON in Go?", "body": "<p>I am writing an endpoint to return data for Geckoboard, it excepts a format like so:</p>\n\n<pre><code>{\n  \"item\": [\n    {\n      \"value\": \"274057\"\n    },\n    [\n      \"38594\",\n      \"39957\",\n      \"35316\",\n      \"35913\",\n      \"36668\",\n      \"45660\",\n      \"41949\"\n    ]\n  ]\n}\n</code></pre>\n\n<p><code>\"item\"</code> is an array of varying structures. How would I represent this data in Go?</p>\n\n<p>Note: this is not on how I would unmarshal this, I need to generate this format.</p>\n"}, {"tags": ["dictionary", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1431517523, "last_edit_date": 1592644375, "creation_date": 1431517523, "answer_id": 30213864, "question_id": 30213739, "link": "https://stackoverflow.com/questions/30213739/detecting-if-struct-exists-for-key-in-map/30213864#30213864", "title": "Detecting if struct exists for key in map", "body": "<p>Use the special &quot;comma, ok&quot; form which tells if the key was found in the map. Go <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">Spec: Index Expressions:</a></p>\n<blockquote>\n<p>An index expression on a map <code>a</code> of type <code>map[K]V</code> used in an assignment or initialization of the special form</p>\n<pre><code>v, ok = a[x]\nv, ok := a[x]\nvar v, ok = a[x]\n</code></pre>\n<p>yields an additional untyped boolean value. The value of <code>ok</code> is <code>true</code> if the key <code>x</code> is present in the map, and <code>false</code> otherwise.</p>\n</blockquote>\n<p>So in your code:</p>\n<pre><code>type Hello struct{}\nstructMap := map[string]Hello{}\nif j, ok := structMap[&quot;example&quot;]; !ok {\n    // &quot;example&quot; is not in the map\n}\n</code></pre>\n"}], "owner": {"reputation": 3291, "user_id": 462575, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/524849342/picture?type=large", "display_name": "Allen", "link": "https://stackoverflow.com/users/462575/allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5253, "favorite_count": 0, "accepted_answer_id": 30213864, "answer_count": 1, "score": 2, "last_activity_date": 1431517885, "creation_date": 1431517238, "last_edit_date": 1431517885, "question_id": 30213739, "link": "https://stackoverflow.com/questions/30213739/detecting-if-struct-exists-for-key-in-map", "title": "Detecting if struct exists for key in map", "body": "<p>According to the Golang documentation on maps,</p>\n\n<blockquote>\n  <p>If the requested key doesn't exist, we get the value type's zero value. In this case the value type is int, so the zero value is 0:</p>\n\n<pre><code>j := m[\"root\"] // j == 0\n</code></pre>\n</blockquote>\n\n<p>So I'm trying to determine if a struct exists with a given string, how would I determine this? Would I just check for an empty struct with zerod values? What would the comparison here look like?</p>\n\n<pre><code>type Hello struct{}\nstructMap := map[string]Hello{}\nj := structMap[\"example\"]\nif(j==?) {\n ...\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1431515011, "post_id": 30212742, "comment_id": 48529871, "body": "You want to start with <code>somebytes</code> and add (write) more bytes to it?"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1431515660, "post_id": 30212742, "comment_id": 48530296, "body": "In my code I actually have only &quot;buff&quot; ; somebytes being the result of buff itself ( buff.Bytes) thus the reason why I was wondering if I could use only one buffer or I need two."}], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1431515495, "post_id": 30213035, "comment_id": 48530198, "body": "The question is how to write &quot;def&quot; on top of &quot;abc&quot;."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1431515815, "post_id": 30213035, "comment_id": 48530406, "body": "My use case is that I write various data and also keep track of the &quot;dependencies&quot; after each write. After   I write all the &quot;body&quot; parts I need to write the header with all the dependencies on top of the body (buffer)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1431516028, "post_id": 30213035, "comment_id": 48530567, "body": "@Theuserwithnohat So you want to insert the header before the body? Or the space for the header is reserved and you want to fill it later (after body has been written)?"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1431517374, "post_id": 30213035, "comment_id": 48531558, "body": "The structure is &quot;[header][bodypart][bodypart]&quot;. However I know the header only after I&#39;ve written the body parts so it may also be said  that I need to basically to &quot;reserve&quot; space for header and then fill it later after the body is written. However as I said the header size is not known until the body is written."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 1, "creation_date": 1431517767, "post_id": 30213035, "comment_id": 48531850, "body": "@Theuserwithnohat In this case I would suggest to write the body to a <code>Buffer</code>, and once it&#39;s done, you can write the header to the output where everything should go, and after header is written, write the Body. I assume there is something missing that prevents this to be enough for you. Why isn&#39;t this working/good for you?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1431523409, "post_id": 30213035, "comment_id": 48536130, "body": "@Theuserwithnohat See the edit which addresses your body-first, header-second task."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1471955108, "last_edit_date": 1471955108, "creation_date": 1431515262, "answer_id": 30213035, "question_id": 30212742, "link": "https://stackoverflow.com/questions/30212742/is-it-possible-to-write-on-top-of-a-buffer/30213035#30213035", "title": "Is it possible to write on top of a buffer?", "body": "<p><a href=\"https://golang.org/pkg/bytes/#NewBuffer\" rel=\"nofollow\"><code>bytes.NewBuffer()</code></a> returns a <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow\"><code>*Buffer</code></a>. <code>*Buffer</code> implements <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow\"><code>io.Writer</code></a> (and <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow\"><code>io.Reader</code></a>) so you can simply write to it by calling its <a href=\"https://golang.org/pkg/bytes/#Buffer.Write\" rel=\"nofollow\"><code>Write()</code></a> or <a href=\"https://golang.org/pkg/bytes/#Buffer.WriteString\" rel=\"nofollow\"><code>WriteString()</code></a> methods.</p>\n\n<p>Example:</p>\n\n<pre><code>somebytes := []byte(\"abc\")\nbuff := bytes.NewBuffer(somebytes)\nbuff.Write([]byte(\"def\"))\nfmt.Println(buff)\n</code></pre>\n\n<p>Output as expected (try it on the <a href=\"http://play.golang.org/p/xOcspXoNel\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>abcdef\n</code></pre>\n\n<p>If you want to start with an empty buffer, you can simply create an empty <code>Buffer</code> struct (and take its address):</p>\n\n<pre><code>buff := &amp;bytes.Buffer{}\n</code></pre>\n\n<p>If you want to \"overwrite\" the current content of the buffer, you can use the <a href=\"https://golang.org/pkg/bytes/#Buffer.Reset\" rel=\"nofollow\"><code>Buffer.Reset()</code></a> method or the equivalent <a href=\"https://golang.org/pkg/bytes/#Buffer.Truncate\" rel=\"nofollow\"><code>Buffer.Truncate(0)</code></a> call.</p>\n\n<p>Note that resetting or truncating the buffer will throw away the content (or only a part of it in case of <code>Truncate()</code>. But the allocated buffer (byte slice) in the background is kept and reused.</p>\n\n<p><strong>Note:</strong></p>\n\n<p>What you really want to do is not possible directly: just imagine if you want to insert some data in front of an existing content, the existing content would have to be shifted every time you write / insert something in front of it. This is not really efficient.</p>\n\n<p>Instead create your body in a <code>Buffer</code>. Once it's done, you will know what your header will be. Create the header in another <code>Buffer</code>, and when it's done, copy (write) the body (from the first <code>Buffer</code>) into the second already containing the header.</p>\n\n<p>Or if you don't need to store the whole data, you don't need to create a 2nd <code>Buffer</code> for the header. Once the body is ready, write the header to your output, and then write the body from the <code>Buffer</code>.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 30213035, "answer_count": 1, "score": -1, "last_activity_date": 1471955108, "creation_date": 1431514438, "last_edit_date": 1431543103, "question_id": 30212742, "link": "https://stackoverflow.com/questions/30212742/is-it-possible-to-write-on-top-of-a-buffer", "title": "Is it possible to write on top of a buffer?", "body": "<pre><code>buff := bytes.NewBuffer(somebytes)\n</code></pre>\n\n<p>How to write on top of <code>buff</code>? Currently I'm creating a new buffer. Is this the right way?</p>\n\n<pre><code>newBuff := bytes.NewBuffer(otherbytes) \nnewBuff.ReadFrom(buff)\n</code></pre>\n"}, {"tags": ["go", "aerospike"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1431523269, "post_id": 30212334, "comment_id": 48536012, "body": "You&#39;re timeout is in <code>Benchmark1AerospikeCounter</code>, but you&#39;re showing us code for <code>Benchmark2AerospikeCounter</code>. The timeout occurred at <code>database_test.go:195</code>; what line is that?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1431523345, "post_id": 30212334, "comment_id": 48536077, "body": "You also have an error that says <code>dial tcp 127.0.0.1:3000: cannot assign requested address</code>. What resources are allotted to your test program? Are you exhausting open FDs or ports?"}, {"owner": {"reputation": 3449, "user_id": 412772, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/065e54c048ddfbfd67cc6fbd8421324a?s=128&d=identicon&r=PG", "display_name": "viblo", "link": "https://stackoverflow.com/users/412772/viblo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431570243, "post_id": 30212334, "comment_id": 48560131, "body": "@JimB Right, sorry about the error. My real code is more advanced and had to cut it down a bit to post here and pasted the wrong error. Ive updated my question."}, {"owner": {"reputation": 3449, "user_id": 412772, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/065e54c048ddfbfd67cc6fbd8421324a?s=128&d=identicon&r=PG", "display_name": "viblo", "link": "https://stackoverflow.com/users/412772/viblo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431572144, "post_id": 30212334, "comment_id": 48560549, "body": "@JimB I have not done any tweaking regarding resources. If I check the aerospike.log I cant find any CRITICAL errors like mentioned on the aerospike FAQ page as an indication of FD shortage."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431610016, "post_id": 30212334, "comment_id": 48578612, "body": "I&#39;m not saying you&#39;ve changed any resources, I&#39;m just saying you&#39;re exhausting some. The &quot;cannot assign requested address&quot; error means the OS won&#39;t or can&#39;t give you a socket for a new connection. Depending on how the aerospike client works, you may need to limit the number of connections it&#39;s allowed, or you need to increase the limits for your process."}, {"owner": {"reputation": 3449, "user_id": 412772, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/065e54c048ddfbfd67cc6fbd8421324a?s=128&d=identicon&r=PG", "display_name": "viblo", "link": "https://stackoverflow.com/users/412772/viblo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431666414, "post_id": 30212334, "comment_id": 48604167, "body": "I notice that I get a lot of tcp connections when it start to happen, so tried setting LimitConnectionsToQueueSize to true. That lowered the tcp connections from 10k+ to &gt;1k when the timeout happens, but I still get command execution timed out."}, {"owner": {"reputation": 3372, "user_id": 762649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21acc9d59af609a140703b8c2c2aca1?s=128&d=identicon&r=PG", "display_name": "sunil", "link": "https://stackoverflow.com/users/762649/sunil"}, "edited": false, "score": 0, "creation_date": 1431952794, "post_id": 30212334, "comment_id": 48702470, "body": "Alerted internally about the googleid not working on the forums"}, {"owner": {"reputation": 3372, "user_id": 762649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21acc9d59af609a140703b8c2c2aca1?s=128&d=identicon&r=PG", "display_name": "sunil", "link": "https://stackoverflow.com/users/762649/sunil"}, "edited": false, "score": 0, "creation_date": 1432013563, "post_id": 30212334, "comment_id": 48729944, "body": "The google id login is fixed now."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4960435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9960180ae6afa6f64e97d80183ea224?s=128&d=identicon&r=PG", "display_name": "KhAf", "link": "https://stackoverflow.com/users/4960435/khaf"}, "is_accepted": false, "score": 1, "last_activity_date": 1433144328, "creation_date": 1433144328, "answer_id": 30568067, "question_id": 30212334, "link": "https://stackoverflow.com/questions/30212334/benchmark-gives-command-execution-timed-out/30568067#30568067", "title": "Benchmark gives command execution timed out", "body": "<p>This has been a subtle bug on the Go client that would not let the connections go back to the connection pool on non-critical errors like KEY_NOT_FOUND_ERROR.</p>\n\n<p>Your code works now.</p>\n\n<p>ps. I'm not on stackoverflow, sorry for the late reply.</p>\n"}], "owner": {"reputation": 3449, "user_id": 412772, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/065e54c048ddfbfd67cc6fbd8421324a?s=128&d=identicon&r=PG", "display_name": "viblo", "link": "https://stackoverflow.com/users/412772/viblo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433144328, "creation_date": 1431513380, "last_edit_date": 1431572184, "question_id": 30212334, "link": "https://stackoverflow.com/questions/30212334/benchmark-gives-command-execution-timed-out", "title": "Benchmark gives command execution timed out", "body": "<p>Im trying to do a small performance/implementation comparison between redis and aerospike using go, but my aerospike code get a \"command execution timed out.\" error after a while. </p>\n\n<p>I installed aerospike server according to the site, and the supplied benchmark with the go client works without error so maybe Im doing something wrong in my code? </p>\n\n<p>I run the test with </p>\n\n<pre><code>-bench=\"1AerospikeCounter\" -benchtime 30s -cpu=1 -parallel=1\n</code></pre>\n\n<p>If I enable logging this is the output, the panic happens at the error check after PutObject.</p>\n\n<pre><code>2015/05/14 10:20:55 Connection to address `127.0.0.1:3000` failed to establish with error: dial tcp 127.0.0.1:3000: cannot assign requested address\n2015/05/14 10:20:55 Node BB9DC1A8E565000 127.0.0.1:3000: dial tcp 127.0.0.1:3000: cannot assign requested address\npanic: command execution timed out.\n\ngoroutine 20 [running]:\nbackend/gateway/core/database.UpdateWithDelta(0xc218aeea20, 0x60c7c, 0x3fde23dba43075e1, 0xc221f181d0, 0x0, 0x0)\n    /root/go/src/backend/gateway/core/database/database_test.go:247 +0x294\n</code></pre>\n\n<p>My code looks like</p>\n\n<pre><code>type Counter struct {\n    Id  int\n    Pop float64\n}\n\nfunc Benchmark2AerospikeCounter(b *testing.B) {\n    logger.Logger.SetLevel(logger.INFO)\n    clientPolicy := aerospike.NewClientPolicy()\n    asclient, err := aerospike.NewClientWithPolicy(clientPolicy, \"127.0.0.1\", 3000)\n    if err != nil {\n        b.Fatal(err)\n    }\n    b.ResetTimer()\n\n    b.RunParallel(func(pb *testing.PB) {\n        for pb.Next() {\n            x := rand.Intn(1000000)\n            y := rand.Float64()\n            delta := Counter{Id: x, Pop: y}\n            _, err := UpdateWithDelta(asclient, delta)\n            if err != nil {\n                b.Fatal(err)\n            }\n        }\n    })\n}\n\nfunc UpdateWithDelta(client *aerospike.Client, delta Counter) (*Counter, error) {\n    key, err := aerospike.NewKey(\"test\", \"counters\", delta.Id)\n    oldCounter := &amp;Counter{}\n    err = client.GetObject(client.DefaultPolicy, key, oldCounter)\n    if v, ok := err.(types.AerospikeError); ok {\n        if v.ResultCode() != types.KEY_NOT_FOUND_ERROR {\n            return nil, err\n        }\n    } else if err != nil {\n        return nil, err\n    }\n\n    newCounter := &amp;Counter{\n        Id:  delta.Id,\n        Pop: oldCounter.Pop + delta.Pop,\n    }\n\n    err = client.PutObject(client.DefaultWritePolicy, key, newCounter)\n    if err != nil {\n        panic(err)\n    }\n\n    return newCounter, err\n}\n</code></pre>\n\n<p>I run it on a virtualized CentOS box, I followed the basic aerospike installation instructions and then just started it. Note that I get the same error if I put the db on a separate machine.</p>\n\n<p>ps. If someone from aerospike is reading: It doesnt seems to be possible to signup with google on your forum.</p>\n"}, {"tags": ["java", "node.js", "multithreading", "go", "single-threaded"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 10, "last_activity_date": 1431512733, "last_edit_date": 1431512733, "creation_date": 1431512102, "answer_id": 30211851, "question_id": 30210935, "link": "https://stackoverflow.com/questions/30210935/how-are-single-thread-of-nodejs-and-go-lang-better-than-multi-thread-of-java/30211851#30211851", "title": "How are Single thread of NodeJS and Go lang better than multi thread of Java?", "body": "<p>NodeJS is single threaded. It has event concurrency model which bring sequence of callbacks in the code. Java has true multi-threaded model where each program thread mapped on OS thread. The cost of this model is stack switch. Go is multi-threaded also but it uses user-space or 'green threads' which are mapped to one or more OS threads by runtime sheduler. Such treads are light and switch cost is less, you can spawn hundreds of thousands of go routines without any problems. With Java model you have in hand more precise control around OS resource sharing.</p>\n"}], "owner": {"reputation": 11, "user_id": 4895039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05164f5a9260486d7c5ca9d2fc8c2350?s=128&d=identicon&r=PG&f=1", "display_name": "Tarkonak etak", "link": "https://stackoverflow.com/users/4895039/tarkonak-etak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2447, "favorite_count": 0, "closed_date": 1431512318, "answer_count": 1, "score": -3, "last_activity_date": 1431512733, "creation_date": 1431509762, "question_id": 30210935, "link": "https://stackoverflow.com/questions/30210935/how-are-single-thread-of-nodejs-and-go-lang-better-than-multi-thread-of-java", "closed_reason": "Opinion-based", "title": "How are Single thread of NodeJS and Go lang better than multi thread of Java?", "body": "<p>I wanna compare NodeJS, Go lang,and Java. I search about concurrency control. The result are the concurrency control of Java is multi thread, the concurrency control of NodeJS and Go lang are single thread. So, I wanna know how are Single thread of NodeJS and Go lang  better than multi thread of Java ?</p>\n\n<p>Can anyone help me ? \nTy for every comment.</p>\n"}, {"tags": ["linux", "go", "docker", "rhel", "rhel7"], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 0, "last_activity_date": 1436483558, "creation_date": 1436483558, "answer_id": 31329875, "question_id": 30209642, "link": "https://stackoverflow.com/questions/30209642/how-can-enable-udev-sync-successfully-in-docker/31329875#31329875", "title": "How can enable udev sync successfully in docker?", "body": "<p>I can't reproduce your issue; I get the following:</p>\n\n<pre><code>(gdb) disassemble dm_udev_set_sync_support\nDump of assembler code for function dm_udev_set_sync_support@plt:\n   0x0000000000403420 &lt;+0&gt;:     jmpq   *0xda8c92(%rip)        # 0x11ac0b8 &lt;dm_udev_set_sync_support@got.plt&gt;\n   0x0000000000403426 &lt;+6&gt;:     pushq  $0x14\n   0x000000000040342b &lt;+11&gt;:    jmpq   0x4032d0\n</code></pre>\n\n<p>Do yourself a favor: Ignore the builds that docker.io does, and get Docker directly from RHEL. It's available in the Extras channel. While it will usually be a few weeks behind upstream releases (e.g. 1.6 instead of 1.7) it is also well-tested and guaranteed to actually work.</p>\n"}, {"tags": [], "owner": {"reputation": 219, "user_id": 2565363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d7f1a60e472d881667ed605551e8f94?s=128&d=identicon&r=PG&f=1", "display_name": "Christy", "link": "https://stackoverflow.com/users/2565363/christy"}, "is_accepted": false, "score": 0, "last_activity_date": 1476812046, "last_edit_date": 1476812046, "creation_date": 1458312396, "answer_id": 36087349, "question_id": 30209642, "link": "https://stackoverflow.com/questions/30209642/how-can-enable-udev-sync-successfully-in-docker/36087349#36087349", "title": "How can enable udev sync successfully in docker?", "body": "<p>Revising my original answer after some useful feedback:</p>\n\n<p>You have to use a dynamic binary:\n\"The issue of course being that with a statically linked binary, udev sync is impossible, and as such can cause corruption issues.\nThis was difficult for RedHat (who maintains the devicemapper driver) to pinpoint because they use a dynamically linked binary (which they provide in their repos).</p>\n\n<p>Just after the 1.7.0 release docker started providing rpms and debs with dynamically linked binaries from the main install script @ get.docker.com (and apt repos to match).\nWith these binaries udev sync is supported and devicemapper should work fine.\"</p>\n\n<p>Docker has fortunately changed its repositories to provide dynamic binaries since the OP was created.</p>\n\n<p>reference: <a href=\"https://github.com/docker/docker/issues/13179\" rel=\"nofollow\">https://github.com/docker/docker/issues/13179</a></p>\n"}], "owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5451, "favorite_count": 1, "answer_count": 2, "score": 7, "last_activity_date": 1476812046, "creation_date": 1431505981, "last_edit_date": 1431574124, "question_id": 30209642, "link": "https://stackoverflow.com/questions/30209642/how-can-enable-udev-sync-successfully-in-docker", "title": "How can enable udev sync successfully in docker?", "body": "<p>I have downloaded and install the static-linked <code>docker 1.6.1</code> from this <a href=\"https://get.docker.com/builds/\" rel=\"noreferrer\">site</a>, and run it on <code>RHEL 7.1</code>:  </p>\n\n<pre><code>[root@localhost bin]# ./docker -d\nWARN[0000] Udev sync is not supported. This will lead to unexpected behavior, data loss and errors\nINFO[0000] +job init_networkdriver()\nINFO[0000] +job serveapi(unix:///var/run/docker.sock)\nINFO[0000] Listening for HTTP on unix (/var/run/docker.sock)\nINFO[0000] -job init_networkdriver() = OK (0)\nINFO[0000] Loading containers: start.\n\nINFO[0000] Loading containers: done.\nINFO[0000] docker daemon: 1.6.1 97cd073; execdriver: native-0.2; graphdriver: devicemapper\nINFO[0000] +job acceptconnections()\nINFO[0000] -job acceptconnections() = OK (0)\nINFO[0000] Daemon has completed initialization\n</code></pre>\n\n<p>I can see there is a warning: \"<code>Udev sync is not supported. This will lead to unexpected behavior, data loss and errors</code>\", and after checking the <code>docker</code> source code, I find the warning log is from <a href=\"https://github.com/docker/docker/blob/v1.6.1/daemon/graphdriver/devmapper/deviceset.go\" rel=\"noreferrer\">deviceset.go</a>:  </p>\n\n<pre><code>func (devices *DeviceSet) initDevmapper(doInit bool) error {\n    ......\n\n    // https://github.com/docker/docker/issues/4036\n    if supported := devicemapper.UdevSetSyncSupport(true); !supported {\n        log.Warnf(\"Udev sync is not supported. This will lead to unexpected behavior, data loss and errors\")\n    }\n    log.Debugf(\"devicemapper: udev sync support: %v\", devicemapper.UdevSyncSupported())\n\n    ......\n}\n</code></pre>\n\n<p>The <code>devicemapper.UdevSetSyncSupport</code> is like this:  </p>\n\n<pre><code>// UdevSyncSupported returns whether device-mapper is able to sync with udev\n//\n// This is essential otherwise race conditions can arise where both udev and\n// device-mapper attempt to create and destroy devices.\nfunc UdevSyncSupported() bool {\n    return DmUdevGetSyncSupport() != 0\n}\n\n// UdevSetSyncSupport allows setting whether the udev sync should be enabled.\n// The return bool indicates the state of whether the sync is enabled.\nfunc UdevSetSyncSupport(enable bool) bool {\n    if enable {\n        DmUdevSetSyncSupport(1)\n    } else {\n        DmUdevSetSyncSupport(0)\n    }\n    return UdevSyncSupported()\n}\n</code></pre>\n\n<p>I can see the reason is enabling <code>udev</code> sync failed. How can enable <code>udev</code> sync successfully?  </p>\n\n<p>Update:\nAfter checking the disassembly code of <code>dm_udev_set_sync_support</code>:  </p>\n\n<pre><code>(gdb) disassemble dm_udev_set_sync_support\nDump of assembler code for function dm_udev_set_sync_support:\n=&gt; 0x0000000000a3e4e0 &lt;+0&gt;:     repz retq\nEnd of assembler dump.\n</code></pre>\n\n<p>It is a empty function and does nothing, not mention set sync support. Does this mean this static-built docker binary is no-use?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 1821015, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4466adde9f6accac78dc37db5d776ca9?s=128&d=identicon&r=PG", "display_name": "nikolai-s", "link": "https://stackoverflow.com/users/1821015/nikolai-s"}, "edited": false, "score": 0, "creation_date": 1431955913, "post_id": 30209243, "comment_id": 48704606, "body": "Hey @smnpl, do you have example how to do it? (I mean common interface and map) I created interface but all values are pointers, gorm need instances. I can&#39;t assign instances as map values (type error)."}], "tags": [], "owner": {"reputation": 549, "user_id": 3040816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43fdb4f835d35ff0f78867a4d2007b4f?s=128&d=identicon&r=PG&f=1", "display_name": "smnpl", "link": "https://stackoverflow.com/users/3040816/smnpl"}, "is_accepted": false, "score": 0, "last_activity_date": 1431504819, "creation_date": 1431504819, "answer_id": 30209243, "question_id": 30208528, "link": "https://stackoverflow.com/questions/30208528/gorm-golang-how-to-optimize-this-code/30209243#30209243", "title": "GORM Golang how to optimize this code", "body": "<p>I'm not familiar with gorm, but:\nMaybe store \"department\" (as key) and a variable of the corresponding model type in a map, and then referencing via key to the model. If not already, the models then have to implement a common interface in order to be able to store them in one map.\nThough, if that would be a better solution I'm not sure. Maybe a bit easier to maintain, because new model types only have to be added to the map, and you don't have to adjust switches on multiple places in your code.</p>\n\n<p>Another obvious way would be, outsourcing the switch to a function, returning a variable of a common interface type and using that on different places in your code. That would definitely not be faster, but easier to maintain.</p>\n"}], "owner": {"reputation": 197, "user_id": 1821015, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4466adde9f6accac78dc37db5d776ca9?s=128&d=identicon&r=PG", "display_name": "nikolai-s", "link": "https://stackoverflow.com/users/1821015/nikolai-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 803, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431504819, "creation_date": 1431502706, "question_id": 30208528, "link": "https://stackoverflow.com/questions/30208528/gorm-golang-how-to-optimize-this-code", "title": "GORM Golang how to optimize this code", "body": "<p>I use GORM in my project and I want to create something like DB admin page.</p>\n\n<p>To load records I send GET with params:</p>\n\n<pre><code>category: \"name\", // database table name\n</code></pre>\n\n<p>On server I have the next code:</p>\n\n<pre><code>func LoadItems(db *gorm.DB, category string) interface{} {\n  var items interface{}\n\n  loadItems := func(i interface{}) {\n    err := db.Find(i).Error\n    if err != nil {\n      panic(err)\n    }\n    items = i\n  }\n\n  switch category {\n  case \"groups\":\n    var records []*models.Groups\n    loadItems(&amp;records)\n  case \"departments\":\n    var records []*models.Departments\n    loadItems(&amp;records)\n  case .....\n    ........\n  }\n\n  return items\n}\n</code></pre>\n\n<p>Is it possible to replace <code>switch</code> because I have 10 tables and after record editing I send new data to server, where I re forced to use <code>switch</code> in other function to save it.</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1431620598, "post_id": 30208182, "comment_id": 48585822, "body": "I should have been more clear on this. I understand that from the spec this behavior is expected. But from the programmer&#39;s perspective, it seems that low &lt; len(a) should be added to the constraints."}], "answers": [{"tags": [], "owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": true, "score": 3, "last_activity_date": 1431501998, "last_edit_date": 1431501998, "creation_date": 1431501650, "answer_id": 30208213, "question_id": 30208182, "link": "https://stackoverflow.com/questions/30208182/why-does-go-allow-slicing-from-lenslice/30208213#30208213", "title": "Why does go allow slicing from len(slice)?", "body": "<p><code>a[3:]</code> builds an empty slice which, just like an empty array, is a valid and useful object (in all languages, not just in Go).</p>\n\n<p>An empty slice also still points to an underlying array, a position and a capacity and can sometimes be extended:</p>\n\n<pre><code>a := []int{1, 2, 3}\nemptySlice := a[1:1]\nfmt.Println(emptySlice) // []\nnotEmpty := emptySlice[0:2]\nfmt.Println(notEmpty)   // [2 3]\n</code></pre>\n\n<p>On the other end, a slice with a negative length is inconsistent. It means nothing and thus is forbidden.</p>\n"}, {"tags": [], "owner": {"reputation": 86357, "user_id": 4856258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9ea19ceff450eb6e272da697ced62dc?s=128&d=identicon&r=PG&f=1", "display_name": "Tagir Valeev", "link": "https://stackoverflow.com/users/4856258/tagir-valeev"}, "is_accepted": false, "score": 2, "last_activity_date": 1431501720, "creation_date": 1431501720, "answer_id": 30208229, "question_id": 30208182, "link": "https://stackoverflow.com/questions/30208182/why-does-go-allow-slicing-from-lenslice/30208229#30208229", "title": "Why does go allow slicing from len(slice)?", "body": "<p>Because having <code>0</code> elements (<code>3-3</code>) in the slice is perfectly valid. However having <code>-1</code> element (<code>3-4</code>) is not.</p>\n\n<p>Such behavior is also consistent with other languages. For example, Java:</p>\n\n<pre><code>System.out.println(Arrays.asList(1, 2, 3).subList(0, 3));\nSystem.out.println(Arrays.asList(1, 2, 3).subList(1, 3));\nSystem.out.println(Arrays.asList(1, 2, 3).subList(2, 3));\nSystem.out.println(Arrays.asList(1, 2, 3).subList(3, 3));\nSystem.out.println(Arrays.asList(1, 2, 3).subList(4, 3));\n</code></pre>\n\n<p>Only the last statement fails.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1431504765, "last_edit_date": 1431504765, "creation_date": 1431501957, "answer_id": 30208304, "question_id": 30208182, "link": "https://stackoverflow.com/questions/30208182/why-does-go-allow-slicing-from-lenslice/30208304#30208304", "title": "Why does go allow slicing from len(slice)?", "body": "<p>Quoting from the <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow\">Spec: Slice Expressions</a>:</p>\n\n<blockquote>\n  <p>For arrays or strings, the indices are <em>in range</em> if <code>0 &lt;= low &lt;= high &lt;= len(a)</code>, otherwise they are out of range. For slices, the upper index bound is the slice capacity <code>cap(a)</code> rather than the length.</p>\n</blockquote>\n\n<p>So the specification allows to use indices up to <code>len(a)</code> of the underlying <em>array</em>, <code>len(a)</code> <strong>included</strong> (or <code>cap(a)</code> in case of a slice which in this case has the same value). That's why <code>a[3:]</code> in your case doesn't panic.</p>\n\n<p>But it will yield an empty slice of course, because:</p>\n\n<pre><code>a[low : high]\n</code></pre>\n\n<p>means the result has indices starting at <code>0</code> and length equal to <code>high - low</code> and since <code>high</code> is omitted, it defaults to <code>len(a)</code> therefore <code>len(a) - len(a) = 0</code>.</p>\n\n<p>And also (according to the spec) using an index <code>&gt; len(a)</code> <strong>will be out of range</strong> and therefore cause a runtime panic:</p>\n\n<blockquote>\n  <p>If the indices are out of range at run time, a <a href=\"https://golang.org/ref/spec#Run_time_panics\" rel=\"nofollow\">run-time panic</a> occurs.</p>\n</blockquote>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 30208213, "answer_count": 3, "score": 2, "last_activity_date": 1431617970, "creation_date": 1431501556, "last_edit_date": 1431617970, "question_id": 30208182, "link": "https://stackoverflow.com/questions/30208182/why-does-go-allow-slicing-from-lenslice", "title": "Why does go allow slicing from len(slice)?", "body": "<p>Why does the following behavior occur:</p>\n\n<pre><code>a := []int{1, 2, 3}\nfmt.Println(a[0:])\nfmt.Println(a[1:])\nfmt.Println(a[2:])\nfmt.Println(a[3:])// doesn't panic - why??\nfmt.Println(a[4:])// panics as expected\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/QWn86CrG43\" rel=\"nofollow\">Executable example</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1431499324, "post_id": 30207035, "comment_id": 48519538, "body": "When there is <code>gets</code> in Ruby, can you enter input from your console? Does Ruby wait for that? Do you hit Enter after entering your input?"}, {"owner": {"reputation": 8597, "user_id": 326543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f882e1ef33bcbefabf8c2f9463fb1f7f?s=128&d=identicon&r=PG", "display_name": "Srikanth Venugopalan", "link": "https://stackoverflow.com/users/326543/srikanth-venugopalan"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1431499687, "post_id": 30207035, "comment_id": 48519721, "body": "<code>gets</code> is in middle of a flow, and if I run the ruby script it waits for an input. Yes, I hit enter after the input. My real usecase is to invoke <code>pry</code> on the ruby side, and my expectation is <code>cmd.Run()</code> would wait for the <code>pry</code> REPL to complete."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1431499932, "post_id": 30207035, "comment_id": 48519879, "body": "If I run <a href=\"http://play.golang.org/p/0eWjtN2RWG\" rel=\"nofollow noreferrer\">this simple Go app</a> from your code, it works perfectly, waits for the input and properly prints the outpout. I&#39;d say it is something in your Ruby code."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1431524362, "post_id": 30207035, "comment_id": 48536985, "body": "BTW, not at all related to your question but, you almost never need or want to directly call an errors&#39; <code>Error</code> method. And if you&#39;re going to exit, you can send output to stderr and exit via the <code>log</code> packge. I.e. just <code>log.Fatal(&quot;Failed to start Ruby:&quot;, err)</code> will do."}, {"owner": {"reputation": 8597, "user_id": 326543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f882e1ef33bcbefabf8c2f9463fb1f7f?s=128&d=identicon&r=PG", "display_name": "Srikanth Venugopalan", "link": "https://stackoverflow.com/users/326543/srikanth-venugopalan"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1431610645, "post_id": 30207035, "comment_id": 48579037, "body": "Thanks for you comments everyone, I figured out that I was doing something stupid. @icza&#39;s point led me to troubleshoot it successfully. It turns out that my setup had multiple level of redirection and I missed redirecting <code>Stdin</code> at the first level."}, {"owner": {"reputation": 8597, "user_id": 326543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f882e1ef33bcbefabf8c2f9463fb1f7f?s=128&d=identicon&r=PG", "display_name": "Srikanth Venugopalan", "link": "https://stackoverflow.com/users/326543/srikanth-venugopalan"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431610972, "post_id": 30207035, "comment_id": 48579248, "body": "@DaveC - thanks for the tip, am going to refactor this bit."}], "answers": [{"comments": [{"owner": {"reputation": 8597, "user_id": 326543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f882e1ef33bcbefabf8c2f9463fb1f7f?s=128&d=identicon&r=PG", "display_name": "Srikanth Venugopalan", "link": "https://stackoverflow.com/users/326543/srikanth-venugopalan"}, "edited": false, "score": 1, "creation_date": 1431610875, "post_id": 30217532, "comment_id": 48579186, "body": "Did not know about this library, +1 for introducing me to a pseudoterminal in golang. The problem was elsewhere, as I mentioned in my comment above. Thanks."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 6, "last_activity_date": 1431526537, "creation_date": 1431526537, "answer_id": 30217532, "question_id": 30207035, "link": "https://stackoverflow.com/questions/30207035/golang-exec-command-read-std-input/30217532#30217532", "title": "golang exec.Command read std input", "body": "<p>You might need to use a <a href=\"http://en.wikipedia.org/wiki/Pseudoterminal\" rel=\"noreferrer\">pseudoterminal</a>. You can do this in go with this library: <a href=\"http://godoc.org/github.com/kr/pty\" rel=\"noreferrer\">github.com/kr/pty</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"io\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n\n    \"github.com/kr/pty\"\n)\n\nfunc runCommand(cmdName string, arg ...string) {\n    cmd := exec.Command(cmdName, arg...)\n    tty, err := pty.Start(cmd)\n    if err != nil {\n        log.Fatalln(err)\n    }\n    defer tty.Close()\n\n    go func() {\n        scanner := bufio.NewScanner(tty)\n        for scanner.Scan() {\n            log.Println(\"[\" + cmdName + \"] \" + scanner.Text())\n        }\n    }()\n    go func() {\n        io.Copy(tty, os.Stdin)\n    }()\n\n    err = cmd.Wait()\n    if err != nil {\n        log.Fatalln(err)\n    }\n}\n\nfunc main() {\n    log.SetFlags(0)\n    runCommand(\"ruby\", \"-e\", `\nputs \"Enter some text\"\ntext = gets\nputs text\n  `)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8597, "user_id": 326543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f882e1ef33bcbefabf8c2f9463fb1f7f?s=128&d=identicon&r=PG", "display_name": "Srikanth Venugopalan", "link": "https://stackoverflow.com/users/326543/srikanth-venugopalan"}, "edited": false, "score": 0, "creation_date": 1431610820, "post_id": 30238124, "comment_id": 48579159, "body": "Thanks - I finally figured out that this was valid code, and problem was elsewhere (I had multiple level of redirection, and I missed one of it)."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 7, "last_activity_date": 1431608584, "creation_date": 1431608584, "answer_id": 30238124, "question_id": 30207035, "link": "https://stackoverflow.com/questions/30207035/golang-exec-command-read-std-input/30238124#30238124", "title": "golang exec.Command read std input", "body": "<p>The following program seems do what you ask for (my <code>runCommand</code> is almost identical to yours. I just changed the <code>=</code> to <code>:=</code> for the <code>err</code> line.) Are you doing something differently?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    runCommand(\"ruby\", \"-e\", `puts \"Running\"; $in = gets; puts \"You said #{$in}\"`)\n}\n\nfunc runCommand(cmdName string, arg ...string) {\n    cmd := exec.Command(cmdName, arg...)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    cmd.Stdin = os.Stdin\n    err := cmd.Run()\n    if err != nil {\n        fmt.Printf(\"Failed to start Ruby. %s\\n\", err.Error())\n        os.Exit(1)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8597, "user_id": 326543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f882e1ef33bcbefabf8c2f9463fb1f7f?s=128&d=identicon&r=PG", "display_name": "Srikanth Venugopalan", "link": "https://stackoverflow.com/users/326543/srikanth-venugopalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4752, "favorite_count": 1, "accepted_answer_id": 30238124, "answer_count": 2, "score": 8, "last_activity_date": 1431608584, "creation_date": 1431497801, "last_edit_date": 1431497949, "question_id": 30207035, "link": "https://stackoverflow.com/questions/30207035/golang-exec-command-read-std-input", "title": "golang exec.Command read std input", "body": "<p>I have a go program that should invoke a ruby script.</p>\n\n<p>I have a <code>runCommand</code> function:</p>\n\n<pre><code>func runCommand(cmdName string, arg ...string) {\n    cmd := exec.Command(cmdName, arg...)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    cmd.Stdin = os.Stdin\n    err = cmd.Run()\n    if err != nil {\n        fmt.Printf(\"Failed to start Ruby. %s\\n\", err.Error())\n        os.Exit(1)\n    }\n}\n</code></pre>\n\n<p>I invoke it like this:</p>\n\n<pre><code>runCommand(\"ruby\", \"-e\", \"require 'foo'\")\n</code></pre>\n\n<p>It works for most cases, except if there is a <code>gets</code> or any similar operation in the child process that needs to pause for an input.</p>\n\n<p>I have tried setting <code>cmd.Stdin = os.Stdin</code>, but it does not wait for input.</p>\n\n<p>What am I doing wrong? </p>\n"}, {"tags": ["go", "initialization", "slice"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1431496759, "last_edit_date": 1431496759, "creation_date": 1431496269, "answer_id": 30206675, "question_id": 30206633, "link": "https://stackoverflow.com/questions/30206633/difference-between-slice-declaration-and-initialization/30206675#30206675", "title": "difference between slice declaration and initialization", "body": "<p>The <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow\">zero value</a> for <code>a</code> makes it nil.</p>\n\n<blockquote>\n  <p><strong><code>nil</code></strong> for pointers, functions, interfaces, <strong>slices</strong>, channels, and maps.</p>\n</blockquote>\n\n<p>As opposed to <code>b</code>, which is initialized as a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">short declaration</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1431496415, "post_id": 30206692, "comment_id": 48518182, "body": "Damn, forgot it&#39;s a slice. +1"}, {"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1431497453, "post_id": 30206692, "comment_id": 48518668, "body": "In terms of <a href=\"http://research.swtch.com/godata\" rel=\"nofollow noreferrer\">Go Data Structures</a>, it&#39;s clear that b&#39;s len/cap are zero but what does b&#39;s ptr point to? an underlying array of length zero?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1431497984, "post_id": 30206692, "comment_id": 48518888, "body": "@lf215 <a href=\"http://play.golang.org/p/HGnerzKXSX\" rel=\"nofollow noreferrer\">Unsafe trickery</a> shows that it points to some (apparently zero-sized) memory, but is overwritten as soon as you append anything to it."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1431496721, "last_edit_date": 1431496721, "creation_date": 1431496352, "answer_id": 30206692, "question_id": 30206633, "link": "https://stackoverflow.com/questions/30206633/difference-between-slice-declaration-and-initialization/30206692#30206692", "title": "difference between slice declaration and initialization", "body": "<pre><code>fmt.Println(a == nil, b == nil)\n</code></pre>\n\n<p>prints <code>true false</code> (Playground: <a href=\"http://play.golang.org/p/E0nQP8dVyE\" rel=\"nofollow\">http://play.golang.org/p/E0nQP8dVyE</a>). <code>a</code> is a nil slice, while b is just an empty slice. There isn't a lot of difference in practice, but usually, say in a function that queries a database, a nil slice means no result (due to error or something else), while an empty slice - that it could not find the information.</p>\n\n<p>For the difference on the lower level, see Russ Cox's <a href=\"http://research.swtch.com/godata\" rel=\"nofollow\">Go Data Structures</a> article.</p>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "accepted_answer_id": 30206692, "answer_count": 2, "score": 2, "last_activity_date": 1431496759, "creation_date": 1431496086, "question_id": 30206633, "link": "https://stackoverflow.com/questions/30206633/difference-between-slice-declaration-and-initialization", "title": "difference between slice declaration and initialization", "body": "<p>What is the difference between a and b? I know that reflect.DeepEqual considers them not equal and I know that a is nil. Are there built in functions that easily show the difference?</p>\n\n<pre><code>var a []foo\nb := []foo{}\n</code></pre>\n"}, {"tags": ["performance", "go", "benchmarking"], "answers": [{"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 7, "last_activity_date": 1431470950, "last_edit_date": 1431470950, "creation_date": 1431470586, "answer_id": 30202689, "question_id": 30202611, "link": "https://stackoverflow.com/questions/30202611/how-do-i-write-a-benchmark-script-in-go-to-measure-ops-sec/30202689#30202689", "title": "How do i write a benchmark script in Go to measure ops/sec", "body": "<p>This is best handled by the built-in <a href=\"http://golang.org/pkg/testing/\" rel=\"noreferrer\"><code>testing.Benchmark</code></a> system. For example, a test case like:</p>\n\n<pre><code>func BenchmarkHello(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        fmt.Sprintf(\"hello\")\n    }\n}\n</code></pre>\n\n<p>will automatically work out timing calculations for this function. See the package documentation for more details on setting it up, but it should be very familiar if you've written Go test cases before.</p>\n\n<p>To your question about concurrency benchmarking, see the <code>RunParallel</code> helper, which is specifically to assist in this.</p>\n"}], "owner": {"reputation": 183, "user_id": 3470707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d4d7e34655b755f8fc53978e56358e2?s=128&d=identicon&r=PG&f=1", "display_name": "user3470707", "link": "https://stackoverflow.com/users/3470707/user3470707"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 1, "accepted_answer_id": 30202689, "answer_count": 1, "score": 2, "last_activity_date": 1431470950, "creation_date": 1431470087, "question_id": 30202611, "link": "https://stackoverflow.com/questions/30202611/how-do-i-write-a-benchmark-script-in-go-to-measure-ops-sec", "title": "How do i write a benchmark script in Go to measure ops/sec", "body": "<p>I am practicing my Golang by writing a simple Redis clone.</p>\n\n<p>How do i write a benchmark script that would establish X connections per second at C concurrency level to deal with my server's protocol and measure how many ops/sec?</p>\n\n<p>I can simply write a script that would actually do this:</p>\n\n<pre><code>for i := range(1000) {\n    // Open connection\n    // Perform command\n    // Close connection\n}\n</code></pre>\n\n<p>But i want to know the concept behind distributing the number of connections per concurrency level per second. </p>\n"}, {"tags": ["go", "martini", "auth0"], "answers": [{"comments": [{"owner": {"reputation": 624, "user_id": 2402338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8ae4230594d72f338de30eee5d02f078?s=128&d=identicon&r=PG", "display_name": "Jon Carl", "link": "https://stackoverflow.com/users/2402338/jon-carl"}, "edited": false, "score": 0, "creation_date": 1431468129, "post_id": 30201940, "comment_id": 48509939, "body": "Works like a charm. Also, I did a double take there wondering if I had missed the martini example but then noticed you just added it. Thanks!!"}, {"owner": {"reputation": 6304, "user_id": 390722, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/64fc18734e843f8bb227765cb1b62137?s=128&d=identicon&r=PG&f=1", "display_name": "StartupGuy", "link": "https://stackoverflow.com/users/390722/startupguy"}, "edited": false, "score": 0, "creation_date": 1438189459, "post_id": 30201940, "comment_id": 51351917, "body": "This no longer seems to work as the call to &quot;SecuredPingHandler&quot; is never made. I even used <code>os.Exit</code> instead of <code>SecuredPingHandler</code> just to see if the code gets that far and it never does.. I just get <code>[martini] Completed 200 OK</code> and the app keeps running"}, {"owner": {"reputation": 6304, "user_id": 390722, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/64fc18734e843f8bb227765cb1b62137?s=128&d=identicon&r=PG&f=1", "display_name": "StartupGuy", "link": "https://stackoverflow.com/users/390722/startupguy"}, "edited": false, "score": 0, "creation_date": 1438189617, "post_id": 30201940, "comment_id": 51352009, "body": "Also, <code>return []byte(&quot;My Secret&quot;), nil</code> did not work, but <code>decode, err := base64.URLEncoding.DecodeString(secret)</code> does work for me"}], "tags": [], "owner": {"reputation": 6617, "user_id": 385982, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a59989272e656ad26300650b72e3fdd?s=128&d=identicon&r=PG", "display_name": "mgonto", "link": "https://stackoverflow.com/users/385982/mgonto"}, "is_accepted": true, "score": 2, "last_activity_date": 1431466958, "creation_date": 1431466958, "answer_id": 30201940, "question_id": 30201084, "link": "https://stackoverflow.com/questions/30201084/auth0-in-go-martini/30201940#30201940", "title": "Auth0 in Go Martini", "body": "<p>To use the jwt-middleware with Martini, you just have to use the <code>CheckJWT</code> method instead of the Handler method.</p>\n\n<p>Check this example: <a href=\"https://github.com/auth0/go-jwt-middleware/blob/master/examples/martini-example/main.go#L27\" rel=\"nofollow\">https://github.com/auth0/go-jwt-middleware/blob/master/examples/martini-example/main.go#L27</a></p>\n\n<p>Let me know if this helps.</p>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 624, "user_id": 2402338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8ae4230594d72f338de30eee5d02f078?s=128&d=identicon&r=PG", "display_name": "Jon Carl", "link": "https://stackoverflow.com/users/2402338/jon-carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 30201940, "answer_count": 1, "score": 0, "last_activity_date": 1431466958, "creation_date": 1431463532, "last_edit_date": 1431463731, "question_id": 30201084, "link": "https://stackoverflow.com/questions/30201084/auth0-in-go-martini", "title": "Auth0 in Go Martini", "body": "<p>I'm trying to use Auth0 with Martini in Go. I'm using their <a href=\"https://auth0.com/docs/server-apis/golang\" rel=\"nofollow\">examples</a> but I can't seem to get it working no matter what I try.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n  \"flag\"\n  \"github.com/go-martini/martini\"\n  \"github.com/martini-contrib/render\"\n  \"github.com/auth0/go-jwt-middleware\"\n  \"encoding/base64\"\n  \"github.com/dgrijalva/jwt-go\"\n  \"net/http\"\n)\n\nfunc main() {\n  m := martini.Classic()\n  port := flag.String(\"port\", \"8000\", \"HTTP Port\")\n  flag.Parse()\n\n  jwtMiddleware := jwtmiddleware.New(jwtmiddleware.Options{\n    ValidationKeyGetter: func(token *jwt.Token) (interface{}, error) {\n      decoded, err := base64.URLEncoding.DecodeString(\"&lt;token&gt;\")\n      if err != nil {\n        return nil, err\n      }\n      return decoded, nil\n    },\n  })\n\n  m.Use(render.Renderer(render.Options{\n    IndentJSON: true, // Output human readable JSON\n  }))\n\n  m.Get(\"/\", jwtMiddleware.Handler, func(res http.ResponseWriter, req *http.Request) { // res and req are injected by Martini\n    res.WriteHeader(200) // HTTP 200\n  })\n\n  // Get the PORT from the environment.\n  m.RunOnAddr(\":\" + *port)\n\n}\n</code></pre>\n\n<p>When I run that, I get a panic that says <code>Value not found for type http.Handler</code></p>\n\n<p>If I change the <code>jwtMiddleware.Handler</code> to <code>jwtMiddleware.HandlerWithNext</code>, I get a panic for <code>Value not found for type http.HandlerFunc</code>.</p>\n\n<p>Does anyone have any ideas what I'm doing wrong?</p>\n"}, {"tags": ["string", "go", "string-comparison", "equality", "case-insensitive"], "answers": [{"comments": [{"owner": {"reputation": 1450, "user_id": 602719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NeKpd.jpg?s=128&g=1", "display_name": "lunicon", "link": "https://stackoverflow.com/users/602719/lunicon"}, "edited": false, "score": 0, "creation_date": 1584021507, "post_id": 30196828, "comment_id": 107312965, "body": "EqualFold not compare :("}, {"owner": {"reputation": 1450, "user_id": 602719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NeKpd.jpg?s=128&g=1", "display_name": "lunicon", "link": "https://stackoverflow.com/users/602719/lunicon"}, "edited": false, "score": 4, "creation_date": 1584022112, "post_id": 30196828, "comment_id": 107313306, "body": "Sorting can use strings.ToLower(&quot;Go&quot;) &lt; strings.ToLower(&quot;go&quot;)"}, {"owner": {"reputation": 2836, "user_id": 1359163, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/063e1984ad8cb19353c311ba3a9290b9?s=128&d=identicon&r=PG", "display_name": "KBN", "link": "https://stackoverflow.com/users/1359163/kbn"}, "reply_to_user": {"reputation": 1450, "user_id": 602719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NeKpd.jpg?s=128&g=1", "display_name": "lunicon", "link": "https://stackoverflow.com/users/602719/lunicon"}, "edited": false, "score": 0, "creation_date": 1604475354, "post_id": 30196828, "comment_id": 114355485, "body": "&gt; EqualFold not compare   @lunicon what do you mean?"}, {"owner": {"reputation": 1450, "user_id": 602719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NeKpd.jpg?s=128&g=1", "display_name": "lunicon", "link": "https://stackoverflow.com/users/602719/lunicon"}, "reply_to_user": {"reputation": 2836, "user_id": 1359163, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/063e1984ad8cb19353c311ba3a9290b9?s=128&d=identicon&r=PG", "display_name": "KBN", "link": "https://stackoverflow.com/users/1359163/kbn"}, "edited": false, "score": 1, "creation_date": 1604640552, "post_id": 30196828, "comment_id": 114414385, "body": "@KBN, compare operation can say &quot;more, less or equals&quot;, EqualFold retrun boolean"}], "tags": [], "owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "is_accepted": true, "score": 80, "last_activity_date": 1431448895, "creation_date": 1431448895, "answer_id": 30196828, "question_id": 30196780, "link": "https://stackoverflow.com/questions/30196780/case-insensitive-string-comparison-in-go/30196828#30196828", "title": "Case insensitive string comparison in Go", "body": "<p><a href=\"https://golang.org/pkg/strings/#EqualFold\">https://golang.org/pkg/strings/#EqualFold</a> is the function you are looking for. It is used like this (example from the linked documentation):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    fmt.Println(strings.EqualFold(\"Go\", \"go\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26279, "favorite_count": 3, "accepted_answer_id": 30196828, "answer_count": 1, "score": 40, "last_activity_date": 1586768175, "creation_date": 1431448723, "last_edit_date": 1586768175, "question_id": 30196780, "link": "https://stackoverflow.com/questions/30196780/case-insensitive-string-comparison-in-go", "title": "Case insensitive string comparison in Go", "body": "<p>How do I compare strings in a case insensitive manner?</p>\n\n<p>For example, \"Go\" and \"go\" should be considered equal.</p>\n"}, {"tags": ["parsing", "go", "compare", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 0, "creation_date": 1431662743, "post_id": 30196236, "comment_id": 48603082, "body": "Do you want to compare arbitrary trees, or just go trees that you have parsed?"}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 0, "creation_date": 1431682856, "post_id": 30196236, "comment_id": 48612266, "body": "Just go source code/trees, thus the go tag"}, {"owner": {"reputation": 13491, "user_id": 3093731, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c7b0be040859579c70e028938f4be069?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3093731/andrew"}, "edited": false, "score": 0, "creation_date": 1432254092, "post_id": 30196236, "comment_id": 48862157, "body": "<a href=\"https://www.diffchecker.com/\" rel=\"nofollow noreferrer\">diffchecker.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1431614601, "post_id": 30197832, "comment_id": 48581902, "body": "The comparison function may not be trivial so I&#39;m trying to avoid that. printer seems to fail on more &quot;complex&quot; structures <a href=\"http://play.golang.org/p/I9cAVEYLAm\" rel=\"nofollow noreferrer\">play.golang.org/p/I9cAVEYLAm</a>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1431633727, "post_id": 30197832, "comment_id": 48593533, "body": "@mihai maybe traverse the tree and filter it, then use DeepEqual?"}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1431654325, "post_id": 30197832, "comment_id": 48600981, "body": "Any idea how exactly can I filter the irrelevant nodes? I&#39;ve tried to remove the nil nodes assuming they represent the new lines / spaces but it doesn&#39;t seem to be the case. play.golang.org/p/JVVpKIzela"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1431671813, "post_id": 30197832, "comment_id": 48606216, "body": "A nit: <code>bytes.Buffer</code> has a <code>String()</code> method, so you don&#39;t need all those conversions."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 8, "last_activity_date": 1431452145, "creation_date": 1431452145, "answer_id": 30197832, "question_id": 30196236, "link": "https://stackoverflow.com/questions/30196236/how-can-i-compare-two-source-code-files-ast-trees/30197832#30197832", "title": "How can I compare two source code files/ ast trees?", "body": "<p>Well, one simple way to achieve this is to use the <code>go/printer</code> library, that gives you better control of output formatting, and is basically like running <code>gofmt</code> on the source, normalizing both trees:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"go/parser\"\n    \"go/token\"\n    \"go/printer\"\n    //\"reflect\"\n    \"bytes\"\n)\n\nfunc main() {\n    stub1 := `package main\n     func myfunc(s string) error {\n        return nil  \n    }`\n    stub2 := `package main\n\n     func myfunc(s string) error {\n\n        return nil\n\n    }`\n\n    fset1 := token.NewFileSet()\n    r1, err := parser.ParseFile(fset1, \"\", stub1, parser.AllErrors)\n    if err != nil {\n        panic(err)\n    }\n    fset2 := token.NewFileSet()\n    r2, err := parser.ParseFile(fset1, \"\", stub2, parser.AllErrors)\n    if err != nil {\n        panic(err)\n    }\n\n    // we create two output buffers for each source tree\n    out1 := bytes.NewBuffer(nil)\n    out2 := bytes.NewBuffer(nil)\n\n    // we use the same printer config for both\n    conf := &amp;printer.Config{Mode: printer.TabIndent | printer.UseSpaces, Tabwidth: 8}\n\n    // print to both outputs\n    if err := conf.Fprint(out1, fset1, r1); err != nil {\n        panic(err)\n    }\n    if err := conf.Fprint(out2, fset2, r2); err != nil {\n        panic(err)\n    }\n\n\n    // they should be identical!\n    if string(out1.Bytes()) != string(out2.Bytes()) {\n        panic(string(out1.Bytes()) +\"\\n\" + string(out2.Bytes()))\n    } else {\n        fmt.Println(\"A-OKAY!\")\n    }\n}\n</code></pre>\n\n<p>Of course this code needs to be refactored to not look as stupid. Another approach is instead of using DeepEqual, create a tree comparison function yourself, that skips irrelevant nodes. </p>\n"}, {"tags": [], "owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "is_accepted": true, "score": 4, "last_activity_date": 1432291613, "last_edit_date": 1432291613, "creation_date": 1431696939, "answer_id": 30260897, "question_id": 30196236, "link": "https://stackoverflow.com/questions/30196236/how-can-i-compare-two-source-code-files-ast-trees/30260897#30260897", "title": "How can I compare two source code files/ ast trees?", "body": "<p>This was easier than I thought. All I had to do was to remove the empty new lines(after formatting). Below is the code.</p>\n\n<pre><code>    package main\n\n    import (\n        \"fmt\"\n        \"go/format\"\n        \"strings\"\n    )\n\n    func main() {\n        a, err := fmtSource(stub1)\n        if err != nil {\n            panic(err)\n        }\n        b, err := fmtSource(stub2)\n        if err != nil {\n            panic(err)\n        }\n        if a != b {\n            fmt.Printf(\"a %v, \\n b %v\", a, b)\n        }\n    }\n\nfunc fmtSource(source string) (string, error) {\n    if !strings.Contains(source, \"package\") {\n        source = \"package main\\n\" + source\n    }\n    b, err := format.Source([]byte(source))\n    if err != nil {\n        return \"\", err\n    }\n    // cleanLine replaces double space with one space\n    cleanLine := func(s string)string{\n        sa := strings.Fields(s)\n        return strings.Join(sa, \" \")\n    }\n    lines := strings.Split(string(b), \"\\n\")\n    n := 0\n    var startLn *int\n    for _, line := range lines {\n        if line != \"\" {\n            line = cleanLine(line)\n            lines[n] = line\n            if startLn == nil {\n                x := n\n                startLn = &amp;x\n            }\n            n++\n        }\n    }\n    lines = lines[*startLn:n]\n    // Add final \"\" entry to get trailing newline from Join.\n    if n &gt; 0 &amp;&amp; lines[n-1] != \"\" {\n        lines = append(lines, \"\")\n    }\n\n\n    // Make it pretty \n    b, err = format.Source([]byte(strings.Join(lines, \"\\n\")))\n    if err != nil {\n        return \"\", err\n    }\n    return string(b), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1467, "favorite_count": 2, "accepted_answer_id": 30260897, "answer_count": 2, "score": 21, "last_activity_date": 1432291613, "creation_date": 1431447037, "last_edit_date": 1431643088, "question_id": 30196236, "link": "https://stackoverflow.com/questions/30196236/how-can-i-compare-two-source-code-files-ast-trees", "title": "How can I compare two source code files/ ast trees?", "body": "<p>I'm generating some source code using the <a href=\"http://golang.org/pkg/text/template/\" rel=\"noreferrer\">templates</a> package( is there a better method? )and part of the testing I need to check if the output matches the expected source code.</p>\n\n<ul>\n<li>I tried a string comparison but it fails due the extra spaces / new lines generated by the templates package. I've also tried <a href=\"https://golang.org/pkg/go/format/\" rel=\"noreferrer\">format.Source</a> with not success. ( FAIL)</li>\n<li><p>I tried to parse the ast of the both sources (see bellow) but the ast doesn't match either even if the code is basically same except the new lines / spaces. (FAIL)</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"go/parser\"\n    \"go/token\"\n    \"reflect\"\n)\n\nfunc main() {\n    stub1 := `package main\n     func myfunc(s string) error {\n        return nil  \n    }`\n    stub2 := `package main\n\n     func myfunc(s string) error {\n\n        return nil\n\n    }`\n    fset := token.NewFileSet()\n    r1, err := parser.ParseFile(fset, \"\", stub1, parser.AllErrors)\n    if err != nil {\n        panic(err)\n    }\n    fset = token.NewFileSet()\n    r2, err := parser.ParseFile(fset, \"\", stub2, parser.AllErrors)\n    if err != nil {\n        panic(err)\n    }\n    if !reflect.DeepEqual(r1, r2) {\n        fmt.Printf(\"e %v, r %s, \", r1, r2)\n    }\n}\n</code></pre></li>\n</ul>\n\n<p><a href=\"http://play.golang.org/p/HABfWtsLuf\" rel=\"noreferrer\">Playground</a></p>\n"}, {"tags": ["c++", "go", "constants"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 12, "last_activity_date": 1431447997, "creation_date": 1431447997, "answer_id": 30196549, "question_id": 30196175, "link": "https://stackoverflow.com/questions/30196175/const-methods-in-golang/30196549#30196549", "title": "const methods in golang?", "body": "<p>No there is not.</p>\n\n<p>Additional your argument that \"because you don't want to copy a huge struct around\" is wrong very often. It is hard to come up with struct which are really that large, that copies during method invocation is the application bottleneck (remember that slices and maps are small).</p>\n\n<p>If you do not want to mutate your structure (a complicated notion when you think about e.g. maps or pointer fields): Just don't do it. Or make a copy. If you then worry about performance: Measure.</p>\n"}, {"tags": [], "owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "is_accepted": false, "score": 0, "last_activity_date": 1488606971, "creation_date": 1488606971, "answer_id": 42592684, "question_id": 30196175, "link": "https://stackoverflow.com/questions/30196175/const-methods-in-golang/42592684#42592684", "title": "const methods in golang?", "body": "<p>If you want to guarantee not to change the target of the method, you have to declare it not to be a pointer.</p>\n\n<pre><code>    package main\n\n    import (\n            \"fmt\"\n    )\n\n    type Walrus struct {\n            Kukukachoo int\n    }\n\n    func (w Walrus) foofookachu() {\n            w.Kukukachoo++\n    }\n\n    func main() {\n            w := Walrus { 3 }\n            fmt.Println(w)\n            w.foofookachu()\n            fmt.Println(w)\n    }\n\n    ===\n\n    {3}\n    {3}\n</code></pre>\n"}], "owner": {"reputation": 8455, "user_id": 850326, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cd6f8a1a0f5957695e1d9625868d2642?s=128&d=identicon&r=PG", "display_name": "djhaskin987", "link": "https://stackoverflow.com/users/850326/djhaskin987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3170, "favorite_count": 0, "accepted_answer_id": 30196549, "answer_count": 2, "score": 4, "last_activity_date": 1488606971, "creation_date": 1431446857, "question_id": 30196175, "link": "https://stackoverflow.com/questions/30196175/const-methods-in-golang", "title": "const methods in golang?", "body": "<p>In golang, often you want to declare a pointer-type associated method, because you don't want to copy a huge struct around:</p>\n\n<pre><code>func (a *HugeStructType) AMethod() {\n    ....\n}\n</code></pre>\n\n<p>In C++, when I wanted to make such a method, but guarantee that it didn't mutate the underlying struct, I declared it <code>const</code>:</p>\n\n<pre><code>class HugeStructType {\n    public:\n        void AMethod() const\n        ...\n}\n</code></pre>\n\n<p>Is there an equivalent in golang? If not, is there an idiomatic way to create a pointer-type-associated method which is known not to change the underlying structure?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 1833, "user_id": 1269987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/109257bc96f7c7102148e6e02a361405?s=128&d=identicon&r=PG", "display_name": "dylanjha", "link": "https://stackoverflow.com/users/1269987/dylanjha"}, "edited": false, "score": 0, "creation_date": 1431448691, "post_id": 30196718, "comment_id": 48498679, "body": "Thank you, this is exactly what I&#39;m looking for"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 1833, "user_id": 1269987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/109257bc96f7c7102148e6e02a361405?s=128&d=identicon&r=PG", "display_name": "dylanjha", "link": "https://stackoverflow.com/users/1269987/dylanjha"}, "edited": false, "score": 0, "creation_date": 1431448824, "post_id": 30196718, "comment_id": 48498759, "body": "BTW, one minor drawback of this approach is you may need to do things like <code>post.URL = urlstring(strVar)</code> (so you should probably export that type if the fields is exported) if you directly assign from a non-constant. If that bothers you, you could possibly move the <code>MarshalJSON</code> method up to the <code>Post</code> type but then you have to handle marshalling of the entire type yourself :(."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1431448922, "last_edit_date": 1431448922, "creation_date": 1431448526, "answer_id": 30196718, "question_id": 30196021, "link": "https://stackoverflow.com/questions/30196021/append-string-to-member-when-encoding-a-type-to-json/30196718#30196718", "title": "Append string to member when encoding a type to JSON", "body": "<p>If you want to change the (un)marshalling behaviour then use a custom type that implements <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow\"><code>json.Marshaler</code></a> (and possibly <code>json.Unmarshaler</code>).</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Post struct {\n    URL URLString `json:\"url\"`\n}\n\nconst (\n    Host = \"http://myhost.com\"\n)\n\ntype URLString string\n\nfunc (u URLString) MarshalJSON() ([]byte, error) {\n    return []byte(fmt.Sprintf(`\"%s%s\"`, Host, u)), nil\n}\n\nfunc main() {\n    post := Post{\"/thisurl\"}\n    marshaled, _ := json.Marshal(post)\n\n    fmt.Println(string(marshaled))\n    //{\"url\":\"http://myhost.com/thisurl\"}\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/e-a7LNABpI\" rel=\"nofollow\"><kbd>Playground</kbd></a></p>\n\n<p>(also note, using all caps for constants is <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#mixed-caps\" rel=\"nofollow\">not idiomatic</a>, and <code>golint</code> recommends <code>URL</code>, <code>MyURL</code>, <code>HTTP</code>, <code>ID</code> vs <code>Url</code>, <code>MyUrl</code>, or <code>Id</code>).</p>\n"}], "owner": {"reputation": 1833, "user_id": 1269987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/109257bc96f7c7102148e6e02a361405?s=128&d=identicon&r=PG", "display_name": "dylanjha", "link": "https://stackoverflow.com/users/1269987/dylanjha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 30196718, "answer_count": 1, "score": 0, "last_activity_date": 1431449411, "creation_date": 1431446435, "last_edit_date": 1431447767, "question_id": 30196021, "link": "https://stackoverflow.com/questions/30196021/append-string-to-member-when-encoding-a-type-to-json", "title": "Append string to member when encoding a type to JSON", "body": "<p>I have this type with a value member called \"Url\".  When encoding this type to json, I want to prepend the HOST value in front of the Url.  What is the best way to achieve that?</p>\n\n<p>In this example, the <code>Println</code> statement prints <code>{\"url\":\"/thisurl\"}</code>, I want it to print <code>{\"url\":\"http://myhost.com/thisurl\"}</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/json\"\n\ntype Post struct {\n  Url string `json:\"url\"`\n}\n\nconst (\n  HOST = \"http://myhost.com\"\n)\n\nfunc main() {\n  post := Post{\"/thisurl\"}\n  marshaled, _ := json.Marshal(post)\n\n  fmt.Println(string(marshaled))\n   //{\"url\":\"/thisurl\"}\n}\n</code></pre>\n\n<h1>Update</h1>\n\n<p>I could re-assign post.Url right before the <code>json.Marshal</code> line</p>\n\n<pre><code>post.Url = fmt.Sprintf(\"%s%s\", HOST, post.Url)\n</code></pre>\n\n<p>But that feels a little messy, if I have to remember to do a reassignment every time I want to encode to json.</p>\n\n<p>I don't want to change the value of <code>post.Url</code>, I simply want to change how it is represented as json.</p>\n"}, {"tags": ["go", "godoc"], "answers": [{"tags": [], "owner": {"reputation": 16171, "user_id": 1155984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22074349884978092d46beac83608767?s=128&d=identicon&r=PG", "display_name": "Umberto Raimondi", "link": "https://stackoverflow.com/users/1155984/umberto-raimondi"}, "is_accepted": true, "score": 3, "last_activity_date": 1431442932, "creation_date": 1431442932, "answer_id": 30194686, "question_id": 30194631, "link": "https://stackoverflow.com/questions/30194631/where-is-the-source-code-for-godoc-itself/30194686#30194686", "title": "Where is the source code for godoc itself?", "body": "<p>Golang and its tools are also available on github now, <a href=\"https://github.com/golang/tools/tree/master/godoc\" rel=\"nofollow\">https://github.com/golang/tools/tree/master/godoc</a></p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "closed_date": 1541098972, "accepted_answer_id": 30194686, "answer_count": 1, "score": -2, "last_activity_date": 1431442932, "creation_date": 1431442789, "question_id": 30194631, "link": "https://stackoverflow.com/questions/30194631/where-is-the-source-code-for-godoc-itself", "closed_reason": "Not suitable for this site", "title": "Where is the source code for godoc itself?", "body": "<p>I want to look at the source code for the <code>godoc</code> tool, but I cannot find it. Where can I find it?</p>\n"}, {"tags": ["oop", "go"], "answers": [{"tags": [], "owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "is_accepted": true, "score": 5, "last_activity_date": 1431440421, "creation_date": 1431440421, "answer_id": 30193677, "question_id": 30193562, "link": "https://stackoverflow.com/questions/30193562/in-golang-which-type-should-i-use-for-a-method-only-type/30193677#30193677", "title": "In Golang which type should I use for a method-only type?", "body": "<p>I believe that the main difference between <code>struct {}</code> and <code>int</code> is that <code>struct {}</code> takes up no memory whereas an unused <code>int</code> would waste 4 or 8 bytes.</p>\n"}], "owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 30193677, "answer_count": 1, "score": 1, "last_activity_date": 1431463862, "creation_date": 1431440190, "last_edit_date": 1431463862, "question_id": 30193562, "link": "https://stackoverflow.com/questions/30193562/in-golang-which-type-should-i-use-for-a-method-only-type", "title": "In Golang which type should I use for a method-only type?", "body": "<p>I mean a method-only type like this</p>\n\n<pre><code>var Util util\ntype util struct { }\nfunc (util)Help(v VM) {}\nfunc (util)HelpMe(v VM) {}\nfunc (util)HelpYou(v VM) {}\nfunc (util)HelpEveryOne(v VM) {}\n</code></pre>\n\n<p>I see this in <a href=\"http://golang.org/src/encoding/binary/binary.go\" rel=\"nofollow\">binary.BigEndian</a> </p>\n\n<pre><code>// LittleEndian is the little-endian implementation of ByteOrder.\nvar LittleEndian littleEndian\n\n// BigEndian is the big-endian implementation of ByteOrder.\nvar BigEndian bigEndian\n\ntype littleEndian struct{}\n</code></pre>\n\n<p>This is a very tricky way to group your method. So the question is: why <code>struct{}</code>?  Why not just a <code>int</code> alias, is there any reason to choose <code>struct{}</code> over other types?</p>\n"}, {"tags": ["go", "command-line-interface", "keyboard-events"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1431438885, "post_id": 30191171, "comment_id": 48490976, "body": "The <a href=\"https://github.com/nsf/termbox-go\" rel=\"nofollow noreferrer\">termbox-go</a> library is commonly used for this."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1431444952, "post_id": 30191171, "comment_id": 48495963, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/27198193/how-to-react-to-keypress-events-in-go\">How to react to keypress events in Go?</a> or <a href=\"http://stackoverflow.com/questions/14094190/golang-function-similar-to-getchar\">Golang function similar to getchar</a>"}], "owner": {"reputation": 761, "user_id": 2971507, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8e81245b6ef278ae2870b5acc08559a9?s=128&d=identicon&r=PG", "display_name": "ami_GS", "link": "https://stackoverflow.com/users/2971507/ami-gs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3172, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1482361914, "creation_date": 1431434375, "question_id": 30191171, "link": "https://stackoverflow.com/questions/30191171/keyboard-event-on-console-in-golang", "title": "Keyboard event on console in Golang", "body": "<p>I'm now creating CUI based mine sweeper in Golang.\nAnd I would like to deal with keyboard events to manipulate the game.</p>\n\n<p>Do you have any idea to achieve this?</p>\n"}, {"tags": ["json", "sockets", "tcp", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431434796, "post_id": 30190159, "comment_id": 48487573, "body": "You need to read the data from the connection obviously. What is the message framing that your client is going to use?"}, {"owner": {"reputation": 225, "user_id": 4386456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c6417ecf01fa926b90b8b7b77c54381?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Smitty", "link": "https://stackoverflow.com/users/4386456/joseph-smitty"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431435060, "post_id": 30190159, "comment_id": 48487799, "body": "Yeah, I am trying to read the data from the connection.  Here is the code I am sending from the client (written in Ruby).  pastebin.com/vkUy0hta  I have verified that the tcp socket is established and the golang server is receiving the packets.  I just can&#39;t figure out how to read the actual data being sent and decode the JSON."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431436042, "post_id": 30190159, "comment_id": 48488610, "body": "Why not just use http which sets up the framing for you, and allows you to any client library you wish? Closing the connection after each message is going to be very inefficient."}, {"owner": {"reputation": 225, "user_id": 4386456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c6417ecf01fa926b90b8b7b77c54381?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Smitty", "link": "https://stackoverflow.com/users/4386456/joseph-smitty"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431436327, "post_id": 30190159, "comment_id": 48488818, "body": "Woops, I didn&#39;t realize I was closing the connection after each message.  My goal is to create an MMORPG game where the client sends the server a constant stream of coordinate/rotation TCP data, so I think TCP would be the best protocol to use."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1431435901, "post_id": 30191504, "comment_id": 48488494, "body": "<code>Decoder</code> can read multiple messages, in the same way that <code>Encoder</code> writes multiple messages. They use a simple newline delimiter between objects."}, {"owner": {"reputation": 225, "user_id": 4386456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c6417ecf01fa926b90b8b7b77c54381?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Smitty", "link": "https://stackoverflow.com/users/4386456/joseph-smitty"}, "edited": false, "score": 0, "creation_date": 1431435913, "post_id": 30191504, "comment_id": 48488502, "body": "This code/explanation helps me a lot, thank you.  My goal is to create a client that sends coordinates in an online game to a Golang server, so I do need to send constant streams of data.  I&#39;ll look into the EOF some more, thanks."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431442704, "post_id": 30191504, "comment_id": 48494190, "body": "@jimb thanks, I wasn&#39;t aware of that. I&#39;ll change my answer when I&#39;m not on my phone :)"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 11, "last_activity_date": 1431445194, "last_edit_date": 1431445194, "creation_date": 1431435242, "answer_id": 30191504, "question_id": 30190159, "link": "https://stackoverflow.com/questions/30190159/golang-server-how-to-receive-tcp-json-packet/30191504#30191504", "title": "Golang server, how to receive TCP JSON packet?", "body": "<p>You can patch a <code>json.Decoder</code> directly to the connection:</p>\n\n<pre><code>func handleServerConnection(c net.Conn) {\n\n    // we create a decoder that reads directly from the socket\n    d := json.NewDecoder(c)\n\n    var msg coordinate\n\n    err := d.Decode(&amp;msg)\n    fmt.Println(msg, err)\n\n    c.Close()\n\n}\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 4386456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c6417ecf01fa926b90b8b7b77c54381?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Smitty", "link": "https://stackoverflow.com/users/4386456/joseph-smitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9080, "favorite_count": 3, "accepted_answer_id": 30191504, "answer_count": 1, "score": 6, "last_activity_date": 1431445194, "creation_date": 1431431772, "last_edit_date": 1431433653, "question_id": 30190159, "link": "https://stackoverflow.com/questions/30190159/golang-server-how-to-receive-tcp-json-packet", "title": "Golang server, how to receive TCP JSON packet?", "body": "<p>I'm new to Golang and am using the \"Server\" code here as a starting point:  <a href=\"http://www.golang-book.com/13/index.htm#section7\" rel=\"noreferrer\">http://www.golang-book.com/13/index.htm#section7</a></p>\n\n<p>I've attempted to use JSON instead of Gob decoding (since I am required to write the client in C#), and I'm sending the JSON TCP data client data in a separate script from the code below.</p>\n\n<p>I'm stuck on the part where I'm actually receiving the JSON TCP data and storing it in a variable for it to be decoded.  It looks like I can decode it with <code>json.Unmarshal</code>, but I can't find any examples where <code>json.Unmarshal</code> is being used to decode TCP data.  I can only find examples where <code>json.Unmarshal</code> is being used to decode JSON strings.</p>\n\n<p>My code is below:  </p>\n\n<pre><code>package main\n\nimport (\n  \"encoding/json\"\n  \"fmt\"\n  \"net\"\n)\n\ntype coordinate struct {\n  X float64 `json:\"x\"`\n  Y float64 `json:\"y\"`\n  Z float64 `json:\"z\"`\n}\n\nfunc server() {\n  // listen on a port\n  ln, err := net.Listen(\"tcp\", \":9999\")\n  if err != nil {\n    fmt.Println(err)\n    return\n  }\n  for {\n    // accept a connection\n    c, err := ln.Accept()\n    if err != nil {\n      fmt.Println(err)\n      continue\n    }\n    // handle the connection\n    go handleServerConnection(c)\n  }\n}\n\nfunc handleServerConnection(c net.Conn) {\n  // receive the message\n  var msg coordinate\n</code></pre>\n\n<p>Stuck on the line below.  What could I set the rawJSON variable equal to?</p>\n\n<pre><code>  err := json.Unmarshal([]byte(rawJSON), &amp;msg)\n  if err != nil {\n    fmt.Println(err)\n  } else {\n    fmt.Println(\"Received\", msg)\n  }\n\n  c.Close()\n}\n\nfunc main() {\n  go server()\n\n  //let the server goroutine run forever\n  var input string\n  fmt.Scanln(&amp;input)\n}\n</code></pre>\n"}, {"tags": ["git", "go", "github"], "comments": [{"owner": {"reputation": 1462, "user_id": 4185609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UVeDk.jpg?s=128&g=1", "display_name": "Ashok Londhe", "link": "https://stackoverflow.com/users/4185609/ashok-londhe"}, "edited": false, "score": 0, "creation_date": 1431427574, "post_id": 30188499, "comment_id": 48482225, "body": "Try this.. git tag -a v0.8.8 -&quot;Your comment&quot;"}, {"owner": {"reputation": 1922, "user_id": 660848, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SLqSN.jpg?s=128&g=1", "display_name": "wonderb0lt", "link": "https://stackoverflow.com/users/660848/wonderb0lt"}, "reply_to_user": {"reputation": 1462, "user_id": 4185609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UVeDk.jpg?s=128&g=1", "display_name": "Ashok Londhe", "link": "https://stackoverflow.com/users/4185609/ashok-londhe"}, "edited": false, "score": 2, "creation_date": 1431427646, "post_id": 30188499, "comment_id": 48482286, "body": "@AshokLondhe He&#39;s asking how to use a tag for <code>go get</code>, not how to create one."}, {"owner": {"reputation": 1462, "user_id": 4185609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UVeDk.jpg?s=128&g=1", "display_name": "Ashok Londhe", "link": "https://stackoverflow.com/users/4185609/ashok-londhe"}, "reply_to_user": {"reputation": 1922, "user_id": 660848, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SLqSN.jpg?s=128&g=1", "display_name": "wonderb0lt", "link": "https://stackoverflow.com/users/660848/wonderb0lt"}, "edited": false, "score": 0, "creation_date": 1431427692, "post_id": 30188499, "comment_id": 48482328, "body": "@wonderb0lt this is command to add tag."}, {"owner": {"reputation": 1922, "user_id": 660848, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SLqSN.jpg?s=128&g=1", "display_name": "wonderb0lt", "link": "https://stackoverflow.com/users/660848/wonderb0lt"}, "edited": false, "score": 0, "creation_date": 1431427776, "post_id": 30188499, "comment_id": 48482384, "body": "I think I tried finding out how to check out a specific tag as well, and last time I tried it wasn&#39;t possible..."}, {"owner": {"reputation": 1922, "user_id": 660848, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SLqSN.jpg?s=128&g=1", "display_name": "wonderb0lt", "link": "https://stackoverflow.com/users/660848/wonderb0lt"}, "edited": false, "score": 1, "creation_date": 1431427947, "post_id": 30188499, "comment_id": 48482517, "body": "Have a look at <a href=\"http://www.slideshare.net/poga/dependency-management-in-go\" rel=\"nofollow noreferrer\">this</a>. Near the end the slides offer some dependency management alternatives."}, {"owner": {"reputation": 3201, "user_id": 2616179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb90669caa64288bdb5767f736152bbe?s=128&d=identicon&r=PG", "display_name": "Makpoc", "link": "https://stackoverflow.com/users/2616179/makpoc"}, "edited": false, "score": 0, "creation_date": 1431436243, "post_id": 30188499, "comment_id": 48488764, "body": "I&#39;ve never used this tool, but according to the docs it supports tags and revisions as <code>&lt;import path&gt; &lt;tag&#47;revision&gt;</code> - <a href=\"https://github.com/pote/gpm\" rel=\"nofollow noreferrer\">gpm</a>. It is written in bash, so it might not work for you if you are using Windows."}, {"owner": {"reputation": 3571, "user_id": 2693875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b7853fb2bdc0b5958a28da6984178c82?s=128&d=identicon&r=PG", "display_name": "Greg Dubicki", "link": "https://stackoverflow.com/users/2693875/greg-dubicki"}, "reply_to_user": {"reputation": 1922, "user_id": 660848, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SLqSN.jpg?s=128&g=1", "display_name": "wonderb0lt", "link": "https://stackoverflow.com/users/660848/wonderb0lt"}, "edited": false, "score": 0, "creation_date": 1462794984, "post_id": 30188499, "comment_id": 61771399, "body": "Link to that presentation doesn&#39;t work anymore, @wonderb0lt : &quot;This uploaded file has been marked private by the author. Sorry!&quot;"}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "edited": false, "score": 0, "creation_date": 1570222962, "post_id": 30188499, "comment_id": 102858467, "body": "For Go 1.11 or higher, see Go Modules: <a href=\"https://stackoverflow.com/questions/53682247/how-to-point-go-module-dependency-in-go-mod-to-a-latest-commit-in-a-repo/\" title=\"how to point go module dependency in go mod to a latest commit in a repo\">stackoverflow.com/questions/53682247/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1431430996, "post_id": 30188904, "comment_id": 48484691, "body": "Can you elaborate a bit more about the google part? There&#39;s a big discussion of this on the go community&#39;s mailing list, is there any other direction that has not been discussed there?"}, {"owner": {"reputation": 4376, "user_id": 959140, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/66Jhu.png?s=128&g=1", "display_name": "Robin Andersson", "link": "https://stackoverflow.com/users/959140/robin-andersson"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1431433171, "post_id": 30188904, "comment_id": 48486337, "body": "@Not_a_Golfer It was a guy who wasn&#39;t part of the Go team, but talked about that they currently use vendoring internally and that it was quite bulky. So they had an interest in solving it better with the official tools. Think it was an unofficial statement though, will make that more clear."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1431454633, "post_id": 30188904, "comment_id": 48502530, "body": "AFAIK, the only proposal is for an official vendor/dependency file format. This is still great, in that projects wouldn&#39;t be tied to a dependency tool, and can interoperate with whatever solution they want (i.e. I prefer revision locking, while others prefer vendoring)."}, {"owner": {"reputation": 337, "user_id": 2099074, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1491488287/picture?type=large", "display_name": "Martin Kosicky", "link": "https://stackoverflow.com/users/2099074/martin-kosicky"}, "edited": false, "score": 0, "creation_date": 1565073332, "post_id": 30188904, "comment_id": 101225523, "body": "modules dont really deal with dependency on code compilers, which forces us to use go get protoc-gen-go somewhere else with fix version. Thus keeping us needing to keep track of the same versioning in 2 different places (because the libraries is tightly coupled with the generator)"}], "tags": [], "owner": {"reputation": 4376, "user_id": 959140, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/66Jhu.png?s=128&g=1", "display_name": "Robin Andersson", "link": "https://stackoverflow.com/users/959140/robin-andersson"}, "is_accepted": true, "score": 35, "last_activity_date": 1540359401, "last_edit_date": 1540359401, "creation_date": 1431428510, "answer_id": 30188904, "question_id": 30188499, "link": "https://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository/30188904#30188904", "title": "How to do &quot;go get&quot; on a specific tag of a github repository", "body": "<p>It is not possible using the <code>go get</code> tool. Instead you need to use a third party go package management tool or create your own forks for the packages that you wish to manage more fine grained.</p>\n\n<p>Spoke to a guy that works at Google and he acknowledged this problem/requirement, he said that vendoring which his team used was bulky and they will probably solve it with the official tools soon.</p>\n\n<p><strong>Read more:</strong></p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"noreferrer\">Reference of third party package management tools</a></li>\n<li><a href=\"https://groups.google.com/forum/#!topic/golang-dev/nMWoEAG55v8%5B1-25%5D\" rel=\"noreferrer\">Blog post by golang team discussing the approach for implementing vendoring</a></li>\n</ul>\n\n<p><strong>Vendoring in Go 1.6</strong></p>\n\n<p>Vendoring has been <a href=\"https://blog.golang.org/go1.6\" rel=\"noreferrer\">released from experimental in go 1.6</a> (after this post was initially written) that makes the process of using specific tags / versions of packages using third party tools easier. <code>go get</code> does still not have the functionality to fetch specific tags or versions.</p>\n\n<p>More about how vendoring works: <a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder/\" rel=\"noreferrer\">Understanding and using the vendor folder</a></p>\n\n<p><strong>Modules in Go 1.11</strong></p>\n\n<p>Go 1.11 has released an experimental features called modules to improve dependency management, they hope to release it as stable in Go 1.12: <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\">Information about modules in Go 1.11</a></p>\n"}, {"tags": [], "owner": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "is_accepted": false, "score": 1, "last_activity_date": 1478681988, "last_edit_date": 1478681988, "creation_date": 1431434751, "answer_id": 30191317, "question_id": 30188499, "link": "https://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository/30191317#30191317", "title": "How to do &quot;go get&quot; on a specific tag of a github repository", "body": "<p>I have a (somewhat hackish, but working) approach to address this problem, at least for git repositories: As go get'ed packages are normal source control repositories, one can check out tags using normal git tools (could use git from command line, I am using Atlassian SourceTree).</p>\n\n<p>To share my package configuration with my teammates, I have made a <strong>git repository out ouf my GOPATH</strong>. I then added all packages (at least the ones I wanted to manage this way) to this repo as git submodule. This requires you to move the exising repo folders out of the way and re-add them as git submodule, to not confuse git. This process is somewhat tedious, but proved to be worth the trouble:</p>\n\n<p>I can now commit and push to my GOPATH-repo every timy I use a new go package. When my teammates pull from this repo and issue a git submodule update (or simply update via SoureTree, which does this automatically), their version of the package gets checked out on the same tag as mine is.</p>\n\n<p>Of course this does only work for packages under git source control...</p>\n"}, {"comments": [{"owner": {"reputation": 4312, "user_id": 274811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94807cb89f41f2a6dcc48ba70b95f839?s=128&d=identicon&r=PG", "display_name": "webwurst", "link": "https://stackoverflow.com/users/274811/webwurst"}, "edited": false, "score": 4, "creation_date": 1489494459, "post_id": 42031814, "comment_id": 72686000, "body": "On the first run you could use <code>go get -d &lt;git-url&gt;</code> to just download the packages and skip the installation."}, {"owner": {"reputation": 196, "user_id": 512126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f231a026687d47a1aee39fc6ef60787?s=128&d=identicon&r=PG", "display_name": "Hrishikesh Kumar", "link": "https://stackoverflow.com/users/512126/hrishikesh-kumar"}, "edited": false, "score": 0, "creation_date": 1492498832, "post_id": 42031814, "comment_id": 73986454, "body": "This is what should be used when you need a specific tag, the gopkg.in is too restrictive."}], "tags": [], "owner": {"reputation": 151, "user_id": 4734393, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZGhLMEnsmiI/AAAAAAAAAAI/AAAAAAAAAAA/tnUfun1MdN8/photo.jpg?sz=128", "display_name": "Gregory Russell", "link": "https://stackoverflow.com/users/4734393/gregory-russell"}, "is_accepted": false, "score": 15, "last_activity_date": 1486150709, "creation_date": 1486150709, "answer_id": 42031814, "question_id": 30188499, "link": "https://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository/42031814#42031814", "title": "How to do &quot;go get&quot; on a specific tag of a github repository", "body": "<p>I've had success with this:</p>\n\n<ul>\n<li>Run the get command without the tag - it should clone the master branch.</li>\n<li>Move to the clone directory and checkout the tag or branch that you want.</li>\n<li>Run the go get command again, it should process the command on the checked out branch.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 693, "user_id": 1802697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eH3MJ.jpg?s=128&g=1", "display_name": "Igor Maznitsa", "link": "https://stackoverflow.com/users/1802697/igor-maznitsa"}, "is_accepted": false, "score": 0, "last_activity_date": 1499338329, "creation_date": 1499338329, "answer_id": 44946909, "question_id": 30188499, "link": "https://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository/44946909#44946909", "title": "How to do &quot;go get&quot; on a specific tag of a github repository", "body": "<p><a href=\"https://github.com/raydac/mvn-golang\" rel=\"nofollow noreferrer\">maven golang plugin</a> allows to play with branch, tag and revision during GET, you can take a look at <a href=\"https://github.com/raydac/mvn-golang/tree/master/mvn-golang-examples/test-git-cvs\" rel=\"nofollow noreferrer\">its test for such cases with GIT repository</a></p>\n"}, {"comments": [{"owner": {"reputation": 316, "user_id": 2526040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/245d8c99de20b10fd560be5384edf8c3?s=128&d=identicon&r=PG", "display_name": "archie", "link": "https://stackoverflow.com/users/2526040/archie"}, "edited": false, "score": 4, "creation_date": 1567993826, "post_id": 54275441, "comment_id": 102121202, "body": "In go 1.13, the <code>go mod init</code> needs a module id, e.g. <code>go mod init local&#47;build</code>"}], "tags": [], "owner": {"reputation": 677, "user_id": 4379906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8bfb9836f54ce1972b614cfdb13bbdde?s=128&d=identicon&r=PG&f=1", "display_name": "kbridge4096", "link": "https://stackoverflow.com/users/4379906/kbridge4096"}, "is_accepted": false, "score": 25, "last_activity_date": 1547979485, "creation_date": 1547979485, "answer_id": 54275441, "question_id": 30188499, "link": "https://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository/54275441#54275441", "title": "How to do &quot;go get&quot; on a specific tag of a github repository", "body": "<p><code>go mod</code> is available now.</p>\n\n<p>For those who need to <strong>build a binary of a specific tag</strong>, here is my way:</p>\n\n<pre><code>mkdir temp\ncd temp\ngo mod init .\ngo get -d -v github.com/nsqio/nsq@v1.1.0\nmkdir bin\ngo build -o bin/nsqd.exe github.com/nsqio/nsq/apps/nsqd\n</code></pre>\n\n<p>Explanation:</p>\n\n<ul>\n<li>The above code pulls NSQ v1.1.0 and build <code>nsqd</code>.</li>\n<li><code>go mod init .</code> creates a <code>go.mod</code> file in the current directory, which enables using <code>go get</code> with revision/tags. (see <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\">this link</a>)</li>\n<li><code>-d</code> means \"download only\", if you want a direct installation, omit this flag and the build commands below this line.</li>\n<li><code>-v</code> means \"be verbose\".</li>\n<li>The above code is for Windows. If you use Linux, replace <code>bin/nsqd.exe</code> with <code>bin/nsqd</code>.</li>\n</ul>\n\n<p>The module downloaded is stored in <code>%GOPATH%\\pkg\\mod</code>. If you don't want to pollute your <code>GOPATH</code> directory, make a new one and set your <code>GOPATH</code> to it.</p>\n"}, {"tags": [], "owner": {"reputation": 2103, "user_id": 1085938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3122451f536ef0f24247e15f1c35b2a?s=128&d=identicon&r=PG", "display_name": "emidander", "link": "https://stackoverflow.com/users/1085938/emidander"}, "is_accepted": false, "score": 5, "last_activity_date": 1617747646, "last_edit_date": 1617747646, "creation_date": 1573110869, "answer_id": 58743673, "question_id": 30188499, "link": "https://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository/58743673#58743673", "title": "How to do &quot;go get&quot; on a specific tag of a github repository", "body": "<p>This question predates <a href=\"https://golang.org/ref/mod\" rel=\"nofollow noreferrer\">Go Modules</a>, but for future reference the correct procedure in Go 1.11 for fetching a specific version is this:</p>\n<pre><code>go get github.com/influxdb@[version]\n</code></pre>\n<p>Or to get a specific git tag:</p>\n<pre><code>go get github.com/influxdb@[gitref]\n</code></pre>\n"}], "owner": {"reputation": 5903, "user_id": 2597143, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6c563c6b8247d907f6fad654da22218d?s=128&d=identicon&r=PG", "display_name": "ESala", "link": "https://stackoverflow.com/users/2597143/esala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77222, "favorite_count": 13, "accepted_answer_id": 30188904, "answer_count": 6, "score": 94, "last_activity_date": 1617747646, "creation_date": 1431427410, "last_edit_date": 1560504379, "question_id": 30188499, "link": "https://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository", "title": "How to do &quot;go get&quot; on a specific tag of a github repository", "body": "<p>I am trying to compile the InfluxDB database (version v0.8.8) using <code>go get github.com/influxdb/influxdb</code></p>\n\n<p>But this pulls the master branch, and I need the <code>v0.8.8</code> tag.</p>\n\n<p>I have tried to do:  <code>go get github.com/influxdb/influxdb/releases/tag/v0.8.8</code> but this fails saying unable to find.</p>\n\n<p>I also tried to do a regular <code>go get</code> of the master branch, and then manually checking out the tag using <code>git</code> in <code>GOPATH/src/github...</code> in order to set the corret version.</p>\n\n<p>The problem using the last approach is that when I try to pull the dependencies with <code>go get -u -f ./...</code> it tries to find them in the master branch, and some of them do not exist on the master branch...</p>\n\n<p><strong>TL;DR</strong>: perform <code>go get</code> on a specific github tag, and pull the correct dependencies.</p>\n"}, {"tags": ["go", "migration", "database-migration", "beego"], "answers": [{"comments": [{"owner": {"reputation": 40596, "user_id": 1677912, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/craWj.png?s=128&g=1", "display_name": "Mogsdad", "link": "https://stackoverflow.com/users/1677912/mogsdad"}, "edited": false, "score": 2, "creation_date": 1444333995, "post_id": 33011652, "comment_id": 53872050, "body": "Please <a href=\"https://stackoverflow.com/posts/33011652/edit\">edit</a> with more information. Code-only and &quot;try this&quot; answers are <a href=\"//meta.stackexchange.com/questions/196187\">discouraged</a>, because they contain no searchable content, and don&#39;t explain why someone should &quot;try this&quot;. We make an effort here to be a resource for knowledge."}, {"owner": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "edited": false, "score": 0, "creation_date": 1493729470, "post_id": 33011652, "comment_id": 74519582, "body": "Is it any way to apply migrations without entering db credentials every time?"}], "tags": [], "owner": {"reputation": 472, "user_id": 2064183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9d0065dda5ffd11d5c0f516fc2bce5?s=128&d=identicon&r=PG", "display_name": "Kyaw Myint Thein", "link": "https://stackoverflow.com/users/2064183/kyaw-myint-thein"}, "is_accepted": false, "score": 0, "last_activity_date": 1444408107, "last_edit_date": 1444408107, "creation_date": 1444296192, "answer_id": 33011652, "question_id": 30184456, "link": "https://stackoverflow.com/questions/30184456/how-to-do-database-migration-with-beego-framework/33011652#33011652", "title": "How to do database migration with Beego framework?", "body": "<p>I think you also need to add in migration file beego. Then,\nbee migrate -driver='mysql' -conn='root:@tcp(127.0.0.1:3306)/test'</p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 6538432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/703af6cc3cf9434336c6b8168d73d145?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Castillo", "link": "https://stackoverflow.com/users/6538432/eduardo-castillo"}, "edited": false, "score": 0, "creation_date": 1487023092, "post_id": 38036909, "comment_id": 71589943, "body": "I&#39;m having trouble with this, is there a way this migration script will work without having to actually type in any RAW SQL in the up and down functions? I didn&#39;t seem to have this issue when I was using gorm so I&#39;m asking."}, {"owner": {"reputation": 793, "user_id": 2733146, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f0a42576570e11deffb4a3e80dff6ab?s=128&d=identicon&r=PG", "display_name": "musafar006", "link": "https://stackoverflow.com/users/2733146/musafar006"}, "edited": false, "score": 0, "creation_date": 1560765780, "post_id": 38036909, "comment_id": 99829889, "body": "@Ritesh What if I want to run migrations in my prod server? mysql remote access is revoked. I&#39;ve ssh access, though. Is there any way other than allowing mysql remote access?"}], "tags": [], "owner": {"reputation": 2156, "user_id": 2076937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cced1ece0753c4e2028b34c04e074bfe?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2076937/ritesh"}, "is_accepted": false, "score": 5, "last_activity_date": 1466932152, "creation_date": 1466932152, "answer_id": 38036909, "question_id": 30184456, "link": "https://stackoverflow.com/questions/30184456/how-to-do-database-migration-with-beego-framework/38036909#38036909", "title": "How to do database migration with Beego framework?", "body": "<p>Came across the same issue, I'm using MySql. Here is how I've done it-</p>\n\n<p>Created a migration file using <code>bee generate</code>:</p>\n\n<pre><code>$ bee generate migration user\n2016/06/26 13:36:31 [INFO] Using 'user' as migration name\n2016/06/26 13:36:32 [INFO] Migration file generated: /path/to/project/database/migrations/20160626_140247_user.go\n2016/06/26 13:36:32 [SUCC] generate successfully created!\n</code></pre>\n\n<p>Now the file will be generated and below is the content of the file:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/astaxie/beego/migration\"\n)\n\n// DO NOT MODIFY\ntype User_20160626_140247 struct {\n    migration.Migration\n}\n\n// DO NOT MODIFY\nfunc init() {\n    m := &amp;User_20160626_140247{}\n    m.Created = \"20160626_140247\"\n    migration.Register(\"User_20160626_140247\", m)\n}\n\n// Run the migrations\nfunc (m *User_20160626_140247) Up() {\n    // use m.SQL(\"CREATE TABLE ...\") to make schema update\n\n}\n\n// Reverse the migrations\nfunc (m *User_20160626_140247) Down() {\n    // use m.SQL(\"DROP TABLE ...\") to reverse schema update\n\n}\n</code></pre>\n\n<p>Updated the <code>Up</code> and <code>Down</code> methods. In comment of these methods you can see <code>m.SQL</code> can be invoked to run raw SQL queries. Here you can use <code>alter</code> commands to update the structure.</p>\n\n<p>Once you are done with the changes, you can run <code>bee migrate</code> to apply these migration. Below is the example-</p>\n\n<pre><code>$bee migrate -conn=\"username:password@tcp(127.0.0.1:3306)/mydb\"\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 2043385, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fn3Um.jpg?s=128&g=1", "display_name": "vitams", "link": "https://stackoverflow.com/users/2043385/vitams"}, "is_accepted": false, "score": 0, "last_activity_date": 1538478857, "creation_date": 1538478857, "answer_id": 52607224, "question_id": 30184456, "link": "https://stackoverflow.com/questions/30184456/how-to-do-database-migration-with-beego-framework/52607224#52607224", "title": "How to do database migration with Beego framework?", "body": "<p>Example for postgres\n<code>bee migrate -driver=postgres -conn=\"postgres://my_user:my_pass@my_host:my_port/my_db?sslmode=disable\"</code></p>\n"}], "owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5202, "favorite_count": 2, "answer_count": 3, "score": 4, "last_activity_date": 1538478857, "creation_date": 1431415817, "question_id": 30184456, "link": "https://stackoverflow.com/questions/30184456/how-to-do-database-migration-with-beego-framework", "title": "How to do database migration with Beego framework?", "body": "<p>I need to add a new field to existing table, what is the correct process to do this with Beego?</p>\n\n<p>I am familiar with Django's south: first you generate the migration script with <code>manage.py schema_migration</code>, then execute the migration script <code>manage.py migrate</code>.</p>\n\n<p>Beego has a command <code>bee generate migration</code> to generate migration script in <code>database/migrations/xxx.go</code>. But I don't understand how to use this generated script, it doesn't seem to be connected with anything.</p>\n\n<p>And I don't see any documentation mentioning migration.</p>\n"}, {"tags": ["go", "closures"], "comments": [{"owner": {"reputation": 583, "user_id": 6003901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670460d23edc4b03e848c32cd07cdc38?s=128&d=identicon&r=PG&f=1", "display_name": "abby37", "link": "https://stackoverflow.com/users/6003901/abby37"}, "edited": false, "score": 1, "creation_date": 1589699488, "post_id": 30183669, "comment_id": 109392560, "body": "<a href=\"https://github.com/golang/go/wiki/CommonMistakes\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/CommonMistakes</a> - This will give clear picture for the doubt regarding closure in Go"}], "answers": [{"comments": [{"owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "edited": false, "score": 0, "creation_date": 1431430688, "post_id": 30183888, "comment_id": 48484465, "body": "Thanks for this. This and the other answer really helped me clear up my understanding. Good examples. In my case, using a channel, I think I&#39;ll just use the closure style."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1431416405, "last_edit_date": 1431416405, "creation_date": 1431413962, "answer_id": 30183888, "question_id": 30183669, "link": "https://stackoverflow.com/questions/30183669/passing-parameters-to-function-closure/30183888#30183888", "title": "Passing parameters to function closure", "body": "<h3>When to use parameters</h3>\n\n<p>Definitely the first form is preferred if you plan to change the value of the variable which you don't want to observe in the function.</p>\n\n<p>This is the typical case when the anonymous function is inside a <code>for</code> loop and you intend to use the loop's variables, for example:</p>\n\n<pre><code>for i := 0; i &lt; 10; i++ {\n    go func(i int) {\n        fmt.Println(i)\n    }(i)\n}\n</code></pre>\n\n<p>Without passing the variable <code>i</code> you might observe printing <code>10</code> ten times. With passing <code>i</code>, you will observe numbers printed from <code>0</code> to <code>9</code>.</p>\n\n<h3>When not to use parameters</h3>\n\n<p>If you don't want to change the value of the variable, it is cheaper not to pass it and thus not create another copy of it. This is especially true for large structs. Although if you later alter the code and modify the variable, you may easily forget to check its effect on the closure and get unexpected results.</p>\n\n<p>Also there might be cases when you <em>do</em> want to observe changes made to \"outer\" variables, such as:</p>\n\n<pre><code>func GetRes(name string) (Res, error) {\n    res, err := somepack.OpenRes(name)\n    if err != nil {\n        return nil, err\n    }\n\n    closeres := true\n    defer func() {\n        if closeres {\n            res.Close()\n        }\n    }()\n\n    // Do other stuff\n    if err = otherStuff(); err != nil {\n        return nil, err // res will be closed\n    }\n\n    // Everything went well, return res, but\n    // res must not be closed, it will be the responsibility of the caller\n    closeres = false\n\n    return res, nil // res will not be closed\n}\n</code></pre>\n\n<p>In this case the <code>GetRes()</code> is to open some resource. But before returning it other things have to be done which might also fail. If those fail, <code>res</code> must be closed and not returned. If everything goes well, <code>res</code> must not be closed and returned.</p>\n"}, {"comments": [{"owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "edited": false, "score": 1, "creation_date": 1431430484, "post_id": 30183893, "comment_id": 48484316, "body": "Thanks! That makes sense. A question then with regards to my original code; am I correct in saying that I should just use the channel as is without bothering with parameters? It seems like passing it through via parameter would just incur overhead."}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "edited": false, "score": 0, "creation_date": 1431432109, "post_id": 30183893, "comment_id": 48485510, "body": "Welcome :) Yes, in your case it wouldn&#39;t make any sense using parameters.  A channel is also &#39;goroutine&#39;-safe so to say."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 37, "last_activity_date": 1431416440, "last_edit_date": 1431416440, "creation_date": 1431413976, "answer_id": 30183893, "question_id": 30183669, "link": "https://stackoverflow.com/questions/30183669/passing-parameters-to-function-closure/30183893#30183893", "title": "Passing parameters to function closure", "body": "<p>The difference between using a closure vs using a function parameter has to do with sharing the same variable vs getting a copy of the value. Consider these two examples below.</p>\n\n<p>In the <em>Closure</em> all function calls will use the value stored in <code>i</code>. This value will most likely already reach 3 before any of the goroutines has had time to print it's value.</p>\n\n<p>In the <em>Parameter</em> example each function call will get passed a copy of the value of <code>i</code> when the call was made, thus giving us the result we more likely wanted:</p>\n\n<p><strong>Closure:</strong></p>\n\n<pre><code>for i := 0; i &lt; 3; i++ {\n    go func() {\n        fmt.Println(i)\n    }()\n}\n</code></pre>\n\n<p><em>Result:</em></p>\n\n<blockquote>\n  <p>3<br>\n  3<br>\n  3  </p>\n</blockquote>\n\n<p><strong>Parameter:</strong></p>\n\n<pre><code>for i := 0; i &lt; 3; i++ {\n    go func(v int) {\n        fmt.Println(v)\n    }(i)\n}\n</code></pre>\n\n<p><em>Result:</em></p>\n\n<blockquote>\n  <p>0<br>\n  1<br>\n  2 </p>\n</blockquote>\n\n<p><strong>Playground:</strong> <a href=\"http://play.golang.org/p/T5rHrIKrQv\" rel=\"noreferrer\">http://play.golang.org/p/T5rHrIKrQv</a></p>\n"}], "owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13230, "favorite_count": 8, "accepted_answer_id": 30183893, "answer_count": 2, "score": 28, "last_activity_date": 1431416440, "creation_date": 1431413174, "question_id": 30183669, "link": "https://stackoverflow.com/questions/30183669/passing-parameters-to-function-closure", "title": "Passing parameters to function closure", "body": "<p>I'm trying to understand the difference in Go between creating an anonymous function which takes a parameter, versus having that function act as a closure. Here is an example of the difference.</p>\n\n<p>With parameter:</p>\n\n<pre><code>func main() {\n  done := make(chan bool, 1)\n  go func(c chan bool) {\n    time.Sleep(50 * time.Millisecond)\n    c &lt;- true\n  }(done)\n  &lt;-done\n}\n</code></pre>\n\n<p>As closure:</p>\n\n<pre><code>func main() {\n  done := make(chan bool, 1)\n  go func() {\n    time.Sleep(50 * time.Millisecond)\n    done &lt;- true\n  }()\n  &lt;-done\n}\n</code></pre>\n\n<p>My question is, when is the first form better than the second? Would you ever use a parameter for this kind of thing? The only time I can see the first form being useful is when returning a <code>func(x, y)</code> from another function.</p>\n"}, {"tags": ["java", "c", "go", "byte", "endianness"], "comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 5, "creation_date": 1431409713, "post_id": 30182661, "comment_id": 48471064, "body": "what exactly do you want to do? And also it is time to actually decide what language do you need java, c or go? Or do you think people will write you in 3 languages?"}, {"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 1, "creation_date": 1431410446, "post_id": 30182661, "comment_id": 48471414, "body": "There only byte or byte-order is relate to this question, I hope more people can see this, so I tagged the language that I know."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 1, "creation_date": 1431410792, "post_id": 30182661, "comment_id": 48471565, "body": "I do not think that this is a correct way to draw attention (yes it worked right now), but tagging a question with <code>c</code>, <code>c++</code>, <code>python</code>, <code>php</code>, <code>javascript</code>, <code>haskel</code>, <code>ruby</code>, <code>java</code>, <code>objective-c</code> just to draw attention is not really nice."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1431411561, "post_id": 30182661, "comment_id": 48471966, "body": "The proper solution is to use a nibble-based lookup table. Anyway, not going to answer this since I don&#39;t know all 3 languages..."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431444323, "post_id": 30182661, "comment_id": 48495481, "body": "@wener, observing that rude behaviour &quot;work[ed] for [you]&quot; does not justify it! It just shows you don&#39;t care about other peoples time/effort."}], "answers": [{"comments": [{"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 0, "creation_date": 1431410271, "post_id": 30182860, "comment_id": 48471334, "body": "I code in this way, but is there any easy way to not split up and merge ?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1471955139, "last_edit_date": 1471955139, "creation_date": 1431410207, "answer_id": 30182860, "question_id": 30182661, "link": "https://stackoverflow.com/questions/30182661/fast-way-to-switch-bits-order/30182860#30182860", "title": "Fast way to switch bits order?", "body": "<p>You can do it using bitmasks and bitshift in one step without breaking it into 4 different variables:</p>\n\n<p><strong>Go solution</strong> (try it on the <a href=\"http://play.golang.org/p/C_BdleF8PJ\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>i := 0x9b // 10011011\nfmt.Printf(\"%b\\n\", i)\n\ni = (i&amp;0x03)&lt;&lt;6 | (i&amp;0x0c)&lt;&lt;2 | (i&amp;0x30)&gt;&gt;2 | (i&amp;0xc0)&gt;&gt;6\nfmt.Printf(\"%b\\n\", i)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>10011011\n11100110\n</code></pre>\n\n<p><strong>In Java:</strong></p>\n\n<pre><code>int i = 0x9b; // 10011011\nSystem.out.printf(\"%x\\n\", i);\n\ni = (i &amp; 0x03) &lt;&lt; 6 | (i &amp; 0x0c) &lt;&lt; 2 | (i &amp; 0x30) &gt;&gt; 2 | (i &amp; 0xc0) &gt;&gt; 6;\nSystem.out.printf(\"%x\\n\", i);\n</code></pre>\n\n<p>Output (it is hex, but represents the same numbers):</p>\n\n<pre><code>9b\ne6\n</code></pre>\n\n<p>Since each bit-group (group of 2 bits) has to be moved from its original place in the input, I don't think you can do it in fewer steps (steps as masking and shifting). If this is not fast enough for you, your only option to make it faster is to pre-compute the transformation and store the results in an array as detailed in @ruakh's answer. Of course this becomes unfeasible if we allow more than just 8 bits.</p>\n"}, {"comments": [{"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 0, "creation_date": 1431411565, "post_id": 30182964, "comment_id": 48471969, "body": "I mark you as answer, because this way is fast enough !"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1431411699, "post_id": 30182964, "comment_id": 48472057, "body": "Alternatively you&#39;d make the lookup-table nibble based, so it won&#39;t consume as much memory. It should be <code>const</code> and initialized, not set in run-time."}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1431465458, "post_id": 30182964, "comment_id": 48508718, "body": "@Lundin: Java doesn&#39;t have a <code>const</code> keyword; and my example didn&#39;t show it being set in run-time, specifically, but rather, simply showed the code to generate/populate the array. As for nibble-based lookups -- I&#39;m not sure. As I said in my answer, the OP should profile. It&#39;s possible that the bit-twiddling will actually be faster than the array lookup."}], "tags": [], "owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "is_accepted": true, "score": 2, "last_activity_date": 1431410579, "creation_date": 1431410579, "answer_id": 30182964, "question_id": 30182661, "link": "https://stackoverflow.com/questions/30182661/fast-way-to-switch-bits-order/30182964#30182964", "title": "Fast way to switch bits order?", "body": "<p>The fastest way <em>might</em> be to precompute a table of all the values:</p>\n\n<pre><code>final int[] values = new int[256];\nfor (int i = 0; i &lt; 256; ++i) {\n    values[i] = (i &amp; 0b1100_0000) &gt;&gt; 6\n                | (i &amp; 0b0011_0000) &gt;&gt; 2\n                | (i &amp; 0b0000_1100) &lt;&lt; 2\n                | (i &amp; 0b0000_0011) &lt;&lt; 6;\n}\n</code></pre>\n\n<p>and then use array lookups rather than bit manipulation.</p>\n\n<p>Naturally, you'll want to profile. </p>\n"}], "owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "closed_date": 1431413774, "accepted_answer_id": 30182964, "answer_count": 2, "score": 0, "last_activity_date": 1471955139, "creation_date": 1431409433, "question_id": 30182661, "link": "https://stackoverflow.com/questions/30182661/fast-way-to-switch-bits-order", "closed_reason": "Needs details or clarity", "title": "Fast way to switch bits order?", "body": "<p>I have a binary like this</p>\n\n<pre><code>10011011\n</code></pre>\n\n<p>My data store like this <code>10,01,10,11</code>, but I want to reorder like this</p>\n\n<pre><code>11100110\n</code></pre>\n\n<p>The data look like <code>11,10,01,10</code>.This operation same as ByteOrder convert but in bits level.</p>\n\n<p>Any fast bitop way to do this ?</p>\n\n<p>Currently, I have to decode this to four int then merge to one.</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 1, "creation_date": 1431409212, "post_id": 30182538, "comment_id": 48470869, "body": "thanks everyone, it is really sad that I have not noticed that slices should be the same length."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1431409790, "post_id": 30182538, "comment_id": 48471093, "body": "Not necessarily the same, but <code>dst</code> should be at least as big as many elements you want to copy (for a full copy of <code>src</code> it means <code>len(dst) &gt;= len(src)</code>)."}, {"owner": {"reputation": 3131, "user_id": 4318281, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/TFbTV.png?s=128&g=1", "display_name": "rocketspacer", "link": "https://stackoverflow.com/users/4318281/rocketspacer"}, "edited": false, "score": 2, "creation_date": 1497966055, "post_id": 30182538, "comment_id": 76294691, "body": "<code>b := append([]int{}, a...)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 12, "last_activity_date": 1431416838, "last_edit_date": 1431416838, "creation_date": 1431409047, "answer_id": 30182573, "question_id": 30182538, "link": "https://stackoverflow.com/questions/30182538/why-cant-i-duplicate-a-slice-with-copy/30182573#30182573", "title": "Why can&#39;t I duplicate a slice with `copy()`?", "body": "<p>If your slices were of the same size, <a href=\"https://play.golang.org/p/ulbeHwQlBx\">it would work</a>:</p>\n\n<pre><code>arr := []int{1, 2, 3}\ntmp := []int{0, 0, 0}\ni := copy(tmp, arr)\nfmt.Println(i)\nfmt.Println(tmp)\nfmt.Println(arr)\n</code></pre>\n\n<p>Would give:</p>\n\n<pre><code>3\n[1 2 3]\n[1 2 3]\n</code></pre>\n\n<p>From \"<a href=\"http://blog.golang.org/go-slices-usage-and-internals\">Go Slices: usage and internals</a>\":</p>\n\n<blockquote>\n  <p>The copy function supports copying between slices of different lengths (<strong>it will copy only up to the smaller number of elements</strong>)</p>\n</blockquote>\n\n<p>The usual example is:</p>\n\n<pre><code>t := make([]byte, len(s), (cap(s)+1)*2)\ncopy(t, s)\ns = t\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1431409073, "creation_date": 1431409073, "answer_id": 30182578, "question_id": 30182538, "link": "https://stackoverflow.com/questions/30182538/why-cant-i-duplicate-a-slice-with-copy/30182578#30182578", "title": "Why can&#39;t I duplicate a slice with `copy()`?", "body": "<blockquote>\n  <p><a href=\"http://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"http://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow\">Appending to and copying slices</a></p>\n  \n  <p>The function copy copies slice elements from a source src to a\n  destination dst and returns the number of elements copied. Both\n  arguments must have identical element type T and must be assignable to\n  a slice of type []T. The number of elements copied is the minimum of\n  len(src) and len(dst). As a special case, copy also accepts a\n  destination argument assignable to type []byte with a source argument\n  of a string type. This form copies the bytes from the string into the\n  byte slice.</p>\n\n<pre><code>copy(dst, src []T) int\ncopy(dst []byte, src string) int\n</code></pre>\n</blockquote>\n\n<p><code>tmp</code> needs enough room for <code>arr</code>. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    arr := []int{1, 2, 3}\n    tmp := make([]int, len(arr))\n    copy(tmp, arr)\n    fmt.Println(tmp)\n    fmt.Println(arr)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[1 2 3]\n[1 2 3]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 104432, "user_id": 53212, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0fbce15f81d6308656931250db267a1?s=128&d=identicon&r=PG", "display_name": "thomasrutter", "link": "https://stackoverflow.com/users/53212/thomasrutter"}, "edited": false, "score": 3, "creation_date": 1501652108, "post_id": 30182622, "comment_id": 77865379, "body": "To summarise, <code>copy</code> doesn&#39;t contain logic for growing the destination slice if the destination slice is too small, but there is another built-in function that does: <code>append</code>  While in this example it&#39;s better just to allocate the right sized slice in the first place, <code>append</code> can be used when you already have a slice and want to grow it by adding elements to the end."}, {"owner": {"reputation": 1012, "user_id": 6650014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10157116047225461/picture?type=large", "display_name": "Alex", "link": "https://stackoverflow.com/users/6650014/alex"}, "edited": false, "score": 2, "creation_date": 1519161282, "post_id": 30182622, "comment_id": 84794450, "body": "But <i>why</i> do I have to create a bounded size slice when copying an unbounded sized slice?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 247, "last_activity_date": 1471847304, "last_edit_date": 1471847304, "creation_date": 1431409241, "answer_id": 30182622, "question_id": 30182538, "link": "https://stackoverflow.com/questions/30182538/why-cant-i-duplicate-a-slice-with-copy/30182622#30182622", "title": "Why can&#39;t I duplicate a slice with `copy()`?", "body": "<p>The builtin <a href=\"http://golang.org/pkg/builtin/#copy\" rel=\"noreferrer\"><code>copy(dst, src)</code></a> copies <code>min(len(dst), len(src))</code> elements.</p>\n\n<p>So if your <code>dst</code> is empty (<code>len(dst) == 0</code>), nothing will be copied.</p>\n\n<p>Try <code>tmp := make([]int, len(arr))</code> (<a href=\"https://play.golang.org/p/xwISeGLzxb\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>arr := []int{1, 2, 3}\ntmp := make([]int, len(arr))\ncopy(tmp, arr)\nfmt.Println(tmp)\nfmt.Println(arr)\n</code></pre>\n\n<p>Output (as expected):</p>\n\n<pre><code>[1 2 3]\n[1 2 3]\n</code></pre>\n\n<p>Unfortunately this is not documented in the <a href=\"http://golang.org/pkg/builtin/\" rel=\"noreferrer\"><code>builtin</code></a> package, but it is documented in the <a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"noreferrer\"><strong>Go Language Specification: Appending to and copying slices</strong></a>:</p>\n\n<blockquote>\n  <p>The number of elements copied is the minimum of <code>len(src)</code> and <code>len(dst)</code>.</p>\n</blockquote>\n\n<p><strong>Edit:</strong></p>\n\n<p>Finally the documentation of <code>copy()</code> has been updated and it now contains the fact that the minimum length of source and destination will be copied:</p>\n\n<blockquote>\n  <p>Copy returns the number of elements copied, which will be the <strong>minimum</strong> of len(src) and len(dst).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 371, "user_id": 2366388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88627f54fc980376a5fa1aa71ec03f5?s=128&d=identicon&r=PG", "display_name": "j. andrew shusta", "link": "https://stackoverflow.com/users/2366388/j-andrew-shusta"}, "edited": false, "score": 13, "creation_date": 1512486122, "post_id": 35748636, "comment_id": 82271442, "body": "the catch here is that in real-world examples, which are much larger, append will allocate excess memory -- unless this array is later filled to capacity by some further processing -- because it is designed for efficient reallocation over repeated calls. <a href=\"https://play.golang.org/p/5_6618xnXn\" rel=\"nofollow noreferrer\">play.golang.org/p/5_6618xnXn</a> observe that cap(x) increases to 12, not 10. now look what happens when 1 value is added to 1048576 values <a href=\"https://play.golang.org/p/nz32JPehhl\" rel=\"nofollow noreferrer\">play.golang.org/p/nz32JPehhl</a> the capacity jumps by 2048 slots to 1050624, to accommodate only one additional value."}, {"owner": {"reputation": 157, "user_id": 1311538, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1dc49f99b84275d3364164127bf190d?s=128&d=identicon&r=PG", "display_name": "asgaines", "link": "https://stackoverflow.com/users/1311538/asgaines"}, "reply_to_user": {"reputation": 371, "user_id": 2366388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88627f54fc980376a5fa1aa71ec03f5?s=128&d=identicon&r=PG", "display_name": "j. andrew shusta", "link": "https://stackoverflow.com/users/2366388/j-andrew-shusta"}, "edited": false, "score": 2, "creation_date": 1610403106, "post_id": 35748636, "comment_id": 116117372, "body": "Another option that allows for an in-line solution which simultaneously addresses the issue brought forth by @j.andrewshusta is to initialize the capacity of the input slice like so: <code>tmp := append(make([]int, 0, len(arr)), arr...)</code>. Under the hood, the <code>append</code> function checks the capacity of the slice on each call, allocating a new slice if the capacity is about to be exceeded. This solution has the added benefit of circumventing the repeated re-allocations."}], "tags": [], "owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "is_accepted": false, "score": 28, "last_activity_date": 1616106204, "last_edit_date": 1616106204, "creation_date": 1456925467, "answer_id": 35748636, "question_id": 30182538, "link": "https://stackoverflow.com/questions/30182538/why-cant-i-duplicate-a-slice-with-copy/35748636#35748636", "title": "Why can&#39;t I duplicate a slice with `copy()`?", "body": "<p>Another simple way to do this is by using <code>append</code> which will allocate the slice in the process.</p>\n<pre><code>arr := []int{1, 2, 3}\ntmp := append([]int(nil), arr...)  // Notice the ... splat\nfmt.Println(tmp)\nfmt.Println(arr)\n</code></pre>\n<p>Output (as expected):</p>\n<pre><code>[1 2 3]\n[1 2 3]\n</code></pre>\n<p>As pointed out in the comments below, <code>append</code> may allocate excess memory if the slice isn't sized correctly to begin with. A nice solution to this is to preallocate a slice of the right capacity, like so:</p>\n<pre><code>tmp := append(make([]int, 0, len(arr)), arr...)\n</code></pre>\n<p>So a shorthand for copying array <code>arr</code> would be <code>append(make([]int, 0, len(arr)), arr...)</code></p>\n<p><a href=\"https://play.golang.org/p/xwevI1chGrd\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xwevI1chGrd</a></p>\n"}, {"comments": [{"owner": {"reputation": 371, "user_id": 2366388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88627f54fc980376a5fa1aa71ec03f5?s=128&d=identicon&r=PG", "display_name": "j. andrew shusta", "link": "https://stackoverflow.com/users/2366388/j-andrew-shusta"}, "edited": false, "score": 3, "creation_date": 1512487394, "post_id": 44337887, "comment_id": 82272417, "body": "append should be used in cases where the array will be increased by repeated calls, as it will optimistically allocate excess capacity in anticipation of this. copy should be used once per input array in cases where the result array should be created to exact size, and is not reallocated from again. <a href=\"https://play.golang.org/p/0kviwKmGzx\" rel=\"nofollow noreferrer\">play.golang.org/p/0kviwKmGzx</a> you didn&#39;t share the benchmark code that produced those results so i can&#39;t confirm or deny its validity, but it overlooks this more important aspect."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 2, "creation_date": 1526038234, "post_id": 44337887, "comment_id": 87598745, "body": "You mean <b>&#39;slice&#39;</b> not <i>array</i>. They&#39;re different things."}], "tags": [], "owner": {"reputation": 194, "user_id": 1801149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kpbu4.jpg?s=128&g=1", "display_name": "Esze", "link": "https://stackoverflow.com/users/1801149/esze"}, "is_accepted": false, "score": 11, "last_activity_date": 1496442572, "last_edit_date": 1496442572, "creation_date": 1496440123, "answer_id": 44337887, "question_id": 30182538, "link": "https://stackoverflow.com/questions/30182538/why-cant-i-duplicate-a-slice-with-copy/44337887#44337887", "title": "Why can&#39;t I duplicate a slice with `copy()`?", "body": "<p>The copy() runs for the least length of dst and src, so you must initialize the dst to the desired length.</p>\n\n<pre><code>A := []int{1, 2, 3}\nB := make([]int, 3)\ncopy(B, A)\nC := make([]int, 2)\ncopy(C, A)\nfmt.Println(A, B, C)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[1 2 3] [1 2 3] [1 2]\n</code></pre>\n\n<p>You can initialize and copy all elements in one line using append() to a nil slice.</p>\n\n<pre><code>x := append([]T{}, []...)\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>A := []int{1, 2, 3}\nB := append([]int{}, A...)\nC := append([]int{}, A[:2]...)\nfmt.Println(A, B, C)    \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[1 2 3] [1 2 3] [1 2]\n</code></pre>\n\n<p>Comparing with allocation+copy(), for greater than 1,000 elements, use append. Actually bellow 1,000 the difference may be neglected, make it a go for rule of thumb unless you have many slices.</p>\n\n<pre><code>BenchmarkCopy1-4                50000000            27.0 ns/op\nBenchmarkCopy10-4               30000000            53.3 ns/op\nBenchmarkCopy100-4              10000000           229 ns/op\nBenchmarkCopy1000-4              1000000          1942 ns/op\nBenchmarkCopy10000-4              100000         18009 ns/op\nBenchmarkCopy100000-4              10000        220113 ns/op\nBenchmarkCopy1000000-4              1000       2028157 ns/op\nBenchmarkCopy10000000-4              100      15323924 ns/op\nBenchmarkCopy100000000-4               1    1200488116 ns/op\nBenchmarkAppend1-4              50000000            34.2 ns/op\nBenchmarkAppend10-4             20000000            60.0 ns/op\nBenchmarkAppend100-4             5000000           240 ns/op\nBenchmarkAppend1000-4            1000000          1832 ns/op\nBenchmarkAppend10000-4            100000         13378 ns/op\nBenchmarkAppend100000-4            10000        142397 ns/op\nBenchmarkAppend1000000-4            2000       1053891 ns/op\nBenchmarkAppend10000000-4            200       9500541 ns/op\nBenchmarkAppend100000000-4            20     176361861 ns/op\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2572, "user_id": 40843, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a7119398715c21e61308a5c2b4f8659c?s=128&d=identicon&r=PG", "display_name": "ben lemasurier", "link": "https://stackoverflow.com/users/40843/ben-lemasurier"}, "edited": false, "score": 1, "creation_date": 1596755176, "post_id": 62746494, "comment_id": 111920780, "body": "This is incorrect, as show here: <a href=\"https://play.golang.org/p/q3CoEoaid6d\" rel=\"nofollow noreferrer\">play.golang.org/p/q3CoEoaid6d</a>. The expected output should reflect that of @Dave&#39;s answer: <a href=\"https://play.golang.org/p/mgdJ4voSlpd\" rel=\"nofollow noreferrer\">play.golang.org/p/mgdJ4voSlpd</a>"}, {"owner": {"reputation": 2697, "user_id": 11059315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68263eac6b6be448f38d829a0832e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "xilpex", "link": "https://stackoverflow.com/users/11059315/xilpex"}, "reply_to_user": {"reputation": 2572, "user_id": 40843, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a7119398715c21e61308a5c2b4f8659c?s=128&d=identicon&r=PG", "display_name": "ben lemasurier", "link": "https://stackoverflow.com/users/40843/ben-lemasurier"}, "edited": false, "score": 1, "creation_date": 1596755298, "post_id": 62746494, "comment_id": 111920810, "body": "@benlemasurier -- Huh... Seems you&#39;re right! Thanks for letting me know!"}], "tags": [], "owner": {"reputation": 2697, "user_id": 11059315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68263eac6b6be448f38d829a0832e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "xilpex", "link": "https://stackoverflow.com/users/11059315/xilpex"}, "is_accepted": false, "score": 0, "last_activity_date": 1596755509, "last_edit_date": 1596755509, "creation_date": 1593984296, "answer_id": 62746494, "question_id": 30182538, "link": "https://stackoverflow.com/questions/30182538/why-cant-i-duplicate-a-slice-with-copy/62746494#62746494", "title": "Why can&#39;t I duplicate a slice with `copy()`?", "body": "<blockquote>\n<p><strong>NOTE:</strong> This is an incorrect solution as @benlemasurier proved</p>\n</blockquote>\n<p>Here is a way to copy a slice. I'm a bit late, but there is a simpler, and faster answer than @Dave's. <a href=\"https://godbolt.org/z/h4Js3X\" rel=\"nofollow noreferrer\">This</a> are the instructions generated from a code like @Dave's. <a href=\"https://godbolt.org/z/kkcM4H\" rel=\"nofollow noreferrer\">These</a> is the instructions generated by mine. As you can see there are far fewer instructions. What is does is it just does <code>append(slice)</code>, which copies the slice. This code:</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc main() {\n    var foo = []int{1, 2, 3, 4, 5}\n    fmt.Println(&quot;foo:&quot;, foo)\n    var bar = append(foo)\n    fmt.Println(&quot;bar:&quot;, bar)\n    bar = append(bar, 6)\n    fmt.Println(&quot;foo after:&quot;, foo)\n    fmt.Println(&quot;bar after:&quot;, bar)\n}\n</code></pre>\n<p>Outputs this:</p>\n<pre><code>foo: [1 2 3 4 5]\nbar: [1 2 3 4 5]\nfoo after: [1 2 3 4 5]\nbar after: [1 2 3 4 5 6]\n</code></pre>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116365, "favorite_count": 27, "accepted_answer_id": 30182622, "answer_count": 6, "score": 139, "last_activity_date": 1616106204, "creation_date": 1431408806, "last_edit_date": 1567253190, "question_id": 30182538, "link": "https://stackoverflow.com/questions/30182538/why-cant-i-duplicate-a-slice-with-copy", "title": "Why can&#39;t I duplicate a slice with `copy()`?", "body": "<p>I need to make a copy of a slice in Go and reading the docs there is a <a href=\"http://golang.org/pkg/builtin/#copy\" rel=\"noreferrer\">copy</a> function at my disposal. </p>\n\n<blockquote>\n  <p>The copy built-in function copies elements from a source slice into a\n  destination slice. (As a special case, it also will copy bytes from a\n  string to a slice of bytes.) The source and destination may overlap.\n  Copy returns the number of elements copied, which will be the minimum\n  of len(src) and len(dst).</p>\n</blockquote>\n\n<p>But when I do:</p>\n\n<pre><code>arr := []int{1, 2, 3}\ntmp := []int{}\ncopy(tmp, arr)\nfmt.Println(tmp)\nfmt.Println(arr)\n</code></pre>\n\n<p>My <code>tmp</code> is empty as it was before (I even tried to use <code>arr, tmp</code>):</p>\n\n<pre><code>[]\n[1 2 3]\n</code></pre>\n\n<p>You can check it on go <a href=\"https://play.golang.org/p/iE6TarF8-S\" rel=\"noreferrer\">playground</a>. So why can not I copy a slice?</p>\n"}, {"tags": ["windows", "go"], "answers": [{"comments": [{"owner": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 1, "creation_date": 1524844688, "post_id": 30182618, "comment_id": 87148844, "body": "You can actually mark your own questions as the answer."}], "tags": [], "owner": {"reputation": 474, "user_id": 964178, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2e0e34f5b2657af5de49f3ffa2dd0eea?s=128&d=identicon&r=PG", "display_name": "Laszlo the Wiz", "link": "https://stackoverflow.com/users/964178/laszlo-the-wiz"}, "is_accepted": false, "score": 9, "last_activity_date": 1431409232, "creation_date": 1431409232, "answer_id": 30182618, "question_id": 30182508, "link": "https://stackoverflow.com/questions/30182508/launching-a-new-command-window-from-golang-in-windows/30182618#30182618", "title": "Launching a new command window from Golang in Windows", "body": "<p>I found it!</p>\n\n<p>The trick is to use the \"start\" as a command after <code>cmd /c</code></p>\n\n<p>Here's the code:</p>\n\n<p><code>cmd:= exec.Command(\"cmd\",\"/C\",\"start\",_path_to_executable_)\nerr=cmd.Start()</code></p>\n"}], "owner": {"reputation": 474, "user_id": 964178, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2e0e34f5b2657af5de49f3ffa2dd0eea?s=128&d=identicon&r=PG", "display_name": "Laszlo the Wiz", "link": "https://stackoverflow.com/users/964178/laszlo-the-wiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2996, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1431409232, "creation_date": 1431408689, "question_id": 30182508, "link": "https://stackoverflow.com/questions/30182508/launching-a-new-command-window-from-golang-in-windows", "title": "Launching a new command window from Golang in Windows", "body": "<p>I'm writing a go application that just uses the command window (CMD) for user input and output. I need to launch another instance of the application that is using its own window.</p>\n\n<p>I trying to use the \"os/exec\" package but that only creates a window for GUI apps. I tried executing the application with <code>cmd /c ___</code> but it still hasn't created a separate window.</p>\n\n<p>Is there a way to launch a non-GUI application with its own window, stdin and stdout?</p>\n"}, {"tags": ["go", "exponentiation"], "answers": [{"comments": [{"owner": {"reputation": 10443, "user_id": 2438460, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sUAeA.jpg?s=128&g=1", "display_name": "Ye Lin Aung", "link": "https://stackoverflow.com/users/2438460/ye-lin-aung"}, "edited": false, "score": 0, "creation_date": 1431407557, "post_id": 30182187, "comment_id": 48470207, "body": "Oops. That&#39;d be a mistake. I didn&#39;t mean to return immediately. I&#39;ll update the question."}], "tags": [], "owner": {"reputation": 1013, "user_id": 1858954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f399b9420bf9ec6ad27e823cfd2bf2?s=128&d=identicon&r=PG", "display_name": "spalac24", "link": "https://stackoverflow.com/users/1858954/spalac24"}, "is_accepted": false, "score": 2, "last_activity_date": 1431407079, "creation_date": 1431407079, "answer_id": 30182187, "question_id": 30182129, "link": "https://stackoverflow.com/questions/30182129/calculating-large-exponentiation-in-golang/30182187#30182187", "title": "Calculating large exponentiation in Golang", "body": "<p>You are returning immediately if <code>power % 2 == 0</code>. Instead, you just want to get the <code>result</code> of <code>base ** (power /2)</code>. Then multiply <code>result * result</code>, and if <code>power</code> is even then multiply <code>base</code> to that.</p>\n"}, {"comments": [{"owner": {"reputation": 10443, "user_id": 2438460, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sUAeA.jpg?s=128&g=1", "display_name": "Ye Lin Aung", "link": "https://stackoverflow.com/users/2438460/ye-lin-aung"}, "edited": false, "score": 0, "creation_date": 1431407746, "post_id": 30182302, "comment_id": 48470285, "body": "That&#39;s a good one. I didn&#39;t see that while looking through the <code>math&#47;big</code> package."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 13, "last_activity_date": 1431429962, "last_edit_date": 1431429962, "creation_date": 1431407649, "answer_id": 30182302, "question_id": 30182129, "link": "https://stackoverflow.com/questions/30182129/calculating-large-exponentiation-in-golang/30182302#30182302", "title": "Calculating large exponentiation in Golang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    z := new(big.Int).Exp(big.NewInt(2), big.NewInt(100), nil)\n    fmt.Println(z)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1267650600228229401496703205376\n</code></pre>\n\n<p>Since it's a power of two, you could also do a bit shift:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    z := new(big.Int).Lsh(big.NewInt(1), 100)\n    fmt.Println(z)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1267650600228229401496703205376\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10443, "user_id": 2438460, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sUAeA.jpg?s=128&g=1", "display_name": "Ye Lin Aung", "link": "https://stackoverflow.com/users/2438460/ye-lin-aung"}, "edited": false, "score": 0, "creation_date": 1431408142, "post_id": 30182338, "comment_id": 48470454, "body": "That&#39;s true. It doesn&#39;t make much sense to take two <code>*big.Int</code> as the arguments. I like your approach."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 10443, "user_id": 2438460, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sUAeA.jpg?s=128&g=1", "display_name": "Ye Lin Aung", "link": "https://stackoverflow.com/users/2438460/ye-lin-aung"}, "edited": false, "score": 0, "creation_date": 1431408380, "post_id": 30182338, "comment_id": 48470548, "body": "@YeLinAung actually if at some point of time you will need big integers, you can modify it easily to do this. I wrote this function just to as a toy example, to make sure I understand the algorithm, but if need to use it somewhere in your production code, rather use default Exp method."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431444789, "post_id": 30182338, "comment_id": 48495838, "body": "<code>new(big.Int).Exp(big.NewInt(int64(a)), big.NewInt(int64(n)), nil)</code> is faster (and could be improved to not realloc the result, like the rest of the <code>math&#47;big</code> routines do)."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431456899, "post_id": 30182338, "comment_id": 48503942, "body": "@DaveC if you would have read the whole answer, you would see that I wrote about it at the end. I included own implementation, because sometimes people learn how algorithms work and try to implement something by themself and in my opinion OP needed exactly this."}, {"owner": {"reputation": 10443, "user_id": 2438460, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sUAeA.jpg?s=128&g=1", "display_name": "Ye Lin Aung", "link": "https://stackoverflow.com/users/2438460/ye-lin-aung"}, "edited": false, "score": 0, "creation_date": 1431583150, "post_id": 30182338, "comment_id": 48563674, "body": "Yeah. I&#39;ve been trying to solve the ProjectEuler problems with different approaches and trying learn go in the same time. That&#39;s why I am trying to implement the different <code>exponentiation</code>. On the other hand, I didn&#39;t notice the built-in method too. Thanks both of you. I&#39;ve upvoted all the answers :)"}, {"owner": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "edited": false, "score": 0, "creation_date": 1500868985, "post_id": 30182338, "comment_id": 77507563, "body": "shouldn&#39;t some Pow() function(s) be added to the go package &quot;big&quot; ? They would be handy! Any particular reason why Go authors did not add any pow() functions to that package? It exists in the math package for small numbers"}], "tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": true, "score": 16, "last_activity_date": 1455533211, "last_edit_date": 1455533211, "creation_date": 1431407848, "answer_id": 30182338, "question_id": 30182129, "link": "https://stackoverflow.com/questions/30182129/calculating-large-exponentiation-in-golang/30182338#30182338", "title": "Calculating large exponentiation in Golang", "body": "<p>BigInt package allows you to <a href=\"https://golang.org/pkg/math/big/#Int.Exp\" rel=\"noreferrer\">calculate x^y in log time</a> (for some reason it is called exp). All you need is to pass <code>nil</code> as a last parameter.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    fmt.Println(new(big.Int).Exp(big.NewInt(5), big.NewInt(20), nil))\n}\n</code></pre>\n\n<p>If you are interested how to calculate it by yourself, take a look at my implementation:</p>\n\n<pre><code>func powBig(a, n int) *big.Int{\n    tmp := big.NewInt(int64(a))\n    res := big.NewInt(1)\n    for n &gt; 0 {\n        temp := new(big.Int)\n        if n % 2 == 1 {\n            temp.Mul(res, tmp)\n            res = temp\n        }\n        temp = new(big.Int)\n        temp.Mul(tmp, tmp)\n        tmp = temp\n        n /= 2\n    }\n    return res\n}\n</code></pre>\n\n<p>or play with it on <a href=\"https://play.golang.org/p/iPkJx35ysc\" rel=\"noreferrer\">go playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4890052, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f4d8bbc95adc94db6447f63db7f37227?s=128&d=identicon&r=PG", "display_name": "user4890052", "link": "https://stackoverflow.com/users/4890052/user4890052"}, "is_accepted": false, "score": 2, "last_activity_date": 1431410745, "creation_date": 1431410745, "answer_id": 30183008, "question_id": 30182129, "link": "https://stackoverflow.com/questions/30182129/calculating-large-exponentiation-in-golang/30183008#30183008", "title": "Calculating large exponentiation in Golang", "body": "<p>To compute 2^100</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    n := big.NewInt(0)\n    fmt.Println(n.SetBit(n, 100, 1))\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/zzkAep-ylc\" rel=\"nofollow\">Playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9538135, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Tp5MS8bPB4/AAAAAAAAAAI/AAAAAAAAAA8/1ecmkXStS2g/photo.jpg?sz=128", "display_name": "Digital MobileForce", "link": "https://stackoverflow.com/users/9538135/digital-mobileforce"}, "edited": false, "score": 0, "creation_date": 1521863322, "post_id": 49441759, "comment_id": 85924924, "body": "Nice job, Tom! Thanks for the help pout in formatting."}], "tags": [], "owner": {"reputation": 11, "user_id": 9538135, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Tp5MS8bPB4/AAAAAAAAAAI/AAAAAAAAAA8/1ecmkXStS2g/photo.jpg?sz=128", "display_name": "Digital MobileForce", "link": "https://stackoverflow.com/users/9538135/digital-mobileforce"}, "is_accepted": false, "score": 1, "last_activity_date": 1521774570, "last_edit_date": 1521774570, "creation_date": 1521774415, "answer_id": 49441759, "question_id": 30182129, "link": "https://stackoverflow.com/questions/30182129/calculating-large-exponentiation-in-golang/49441759#49441759", "title": "Calculating large exponentiation in Golang", "body": "<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n\n    bigx, power10 := new(big.Int), new(big.Int)\n    var x int64\n    bigx.SetInt64(x) //set x int64 to bigx\n    power10.Exp(big.NewInt(10), bigx, nil) //power10 *big.Int points to solution\n\n    str10 := power10.Text(10)\n    fmt.Printf(str10) // print out the number and check for your self\n\n}\n</code></pre>\n"}], "owner": {"reputation": 10443, "user_id": 2438460, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sUAeA.jpg?s=128&g=1", "display_name": "Ye Lin Aung", "link": "https://stackoverflow.com/users/2438460/ye-lin-aung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8023, "favorite_count": 6, "accepted_answer_id": 30182338, "answer_count": 5, "score": 9, "last_activity_date": 1521774570, "creation_date": 1431406812, "last_edit_date": 1431407676, "question_id": 30182129, "link": "https://stackoverflow.com/questions/30182129/calculating-large-exponentiation-in-golang", "title": "Calculating large exponentiation in Golang", "body": "<p>I've been trying to calculating <code>2^100</code> in Golang. I understand the <a href=\"http://golang.org/ref/spec#Numeric_types\" rel=\"noreferrer\">limit of numeric type</a> and tried using <code>math/big</code> package. Here's what I've tried but I can't figure out why it doesn't work. </p>\n\n<p>I've used <a href=\"http://en.wikipedia.org/wiki/Exponentiation_by_squaring#Computation_by_powers_of_2\" rel=\"noreferrer\">computation by powers of two</a> method to calculate the exponentiation. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    two := big.NewInt(2)\n    hundred := big.NewInt(50)\n    fmt.Printf(\"2 ** 100    is %d\\n\", ExpByPowOfTwo(two, hundred))\n}\n\nfunc ExpByPowOfTwo(base, power *big.Int) *big.Int {\n    result := big.NewInt(1)\n    zero := big.NewInt(0)\n    for power != zero {\n        if modBy2(power) != zero {\n            multiply(result, base)\n        }\n        power = divideBy2(power)\n        base = multiply(base, base)\n    }\n    return result\n}\n\nfunc modBy2(x *big.Int) *big.Int {\n    return big.NewInt(0).Mod(x, big.NewInt(2))\n}\n\nfunc divideBy2(x *big.Int) *big.Int {\n    return big.NewInt(0).Div(x, big.NewInt(2))\n}\n\nfunc multiply(x, y *big.Int) *big.Int {\n    return big.NewInt(0).Mul(x, y)\n}\n</code></pre>\n"}, {"tags": ["debugging", "go"], "answers": [{"tags": [], "owner": {"reputation": 497, "user_id": 1236394, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7c5989ad7dc8460f7bc53a002277ccc8?s=128&d=identicon&r=PG", "display_name": "Kirk", "link": "https://stackoverflow.com/users/1236394/kirk"}, "is_accepted": false, "score": 0, "last_activity_date": 1431452260, "creation_date": 1431452260, "answer_id": 30197857, "question_id": 30180101, "link": "https://stackoverflow.com/questions/30180101/how-to-remove-a-breakpoint-in-delve/30197857#30197857", "title": "How to remove a breakpoint in delve", "body": "<p>I found out how to remove a breakpoint in delve.</p>\n\n<p>You can use the clear NUMBER or clearall</p>\n\n<p>Examples:</p>\n\n<p>Clear the break point 2.</p>\n\n<pre><code>clear 2\n</code></pre>\n\n<p>Clear all the break point.</p>\n\n<pre><code>clearall\n</code></pre>\n\n<p>In addition, in delve you can actually enter help to get a list of commands.</p>\n"}, {"tags": [], "owner": {"reputation": 1572, "user_id": 1894908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/64b07bf8a52770c0c70a5313ea26188d?s=128&d=identicon&r=PG", "display_name": "Renato Prado", "link": "https://stackoverflow.com/users/1894908/renato-prado"}, "is_accepted": false, "score": 1, "last_activity_date": 1587504493, "creation_date": 1587504493, "answer_id": 61353569, "question_id": 30180101, "link": "https://stackoverflow.com/questions/30180101/how-to-remove-a-breakpoint-in-delve/61353569#61353569", "title": "How to remove a breakpoint in delve", "body": "<p>find existing endpoints:</p>\n\n<pre><code>breakpoints\n</code></pre>\n\n<p>It should output something like this:</p>\n\n<pre><code>Breakpoint 1 at 0x4ad817 for main.getChange() ./main.go:22 (1)\n</code></pre>\n\n<p>Now we can delete the <strong>breakpoint 1</strong></p>\n\n<pre><code>clear 1\n</code></pre>\n\n<p>If you are in the middle of a debugging process you may need to restart first with the r or restart command and then execute the clear command.</p>\n\n<p>You can also use <strong>clearall</strong> to delete multiple breakpoints.</p>\n"}], "owner": {"reputation": 497, "user_id": 1236394, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7c5989ad7dc8460f7bc53a002277ccc8?s=128&d=identicon&r=PG", "display_name": "Kirk", "link": "https://stackoverflow.com/users/1236394/kirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1587504493, "creation_date": 1431393003, "question_id": 30180101, "link": "https://stackoverflow.com/questions/30180101/how-to-remove-a-breakpoint-in-delve", "title": "How to remove a breakpoint in delve", "body": "<p>I've just installed <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow\">delve</a> to debug go code. I tried to add a few breakpoints but I couldn't find how to delete breakpoints. How do you remove a breakpoint you've set?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1431383020, "post_id": 30177953, "comment_id": 48463196, "body": "Usually, even when I&#39;m writing Python which has Java-like exception categories, my <i>intent</i> is to handle either a specific error I know I want a special path for (like a network error calling some outside API, say), or to catch anything at all (and, e.g., log and abort). So potentially-special-snowflake error values mostly work. The <code>os</code> package does provide functions that categorize its own errors (e.g., <code>os.IsPermission(err error) bool</code>), but that&#39;s sort of a different thing."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1431379733, "creation_date": 1431379733, "answer_id": 30177953, "question_id": 30177860, "link": "https://stackoverflow.com/questions/30177860/does-go-have-standard-err-variables/30177953#30177953", "title": "Does Go have standard Err variables?", "body": "<p>No, there aren't. Just provide intelligible errors instead of generic ones. What information does a IllegalArgument transport? Not much, not enough.</p>\n"}, {"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1431381614, "last_edit_date": 1431381614, "creation_date": 1431381207, "answer_id": 30178260, "question_id": 30177860, "link": "https://stackoverflow.com/questions/30177860/does-go-have-standard-err-variables/30178260#30178260", "title": "Does Go have standard Err variables?", "body": "<p>As you have seen, there are specific errors that specific packages use.  For example, in the <a href=\"https://golang.org/pkg/database/sql/\" rel=\"nofollow\">database/sql</a> package, they define:</p>\n\n<pre><code>var ErrNoRows = errors.New(\"sql: no rows in result set\")\n</code></pre>\n\n<p>So if you do <code>QueryRow</code> (which defers the error until <code>Scan</code>), and then <code>Scan</code>, you can do</p>\n\n<pre><code>if  err := row.Scan(&amp;data); err != nil &amp;&amp; err != sql.ErrNoRows {\n    //something actually went wrong\n} else if err != nil {\n    //no results\n} else {\n    //we found it\n}\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow\">os/exec</a> has <code>var ErrNotFound = errors.New(\"executable file not found in $PATH\")</code></p>\n\n<p><a href=\"http://golang.org/pkg/encoding/json/\" rel=\"nofollow\">encoding/json</a> has a <code>type UnmarshalTypeError</code> which is just a type that implements the <code>error</code> interface.</p>\n\n<p>So no, while there is no \"set of standard errors\", you can (and most likely should) have specific error variables that you reuse.</p>\n\n<p>You could have your own errorMsgs package that you use, where you can reuse common errors:</p>\n\n<pre><code>err := doSomething(); if err != nil {\n    switch err {\n        case errorMsgs.IllegalArgument:\n           //do something\n        case errorMsgs.CouldNotConnect:\n           //do something else\n     }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 24, "last_activity_date": 1568310187, "last_edit_date": 1568310187, "creation_date": 1431383826, "answer_id": 30178766, "question_id": 30177860, "link": "https://stackoverflow.com/questions/30177860/does-go-have-standard-err-variables/30178766#30178766", "title": "Does Go have standard Err variables?", "body": "<p>There are a few common idiomatic ways for a package author to make error returns.</p>\n\n<ol>\n<li><p>Fixed error variables, usually named <code>Err\u2026</code></p>\n\n<pre><code>var (\n        ErrSomethingBad = errors.New(\"some string\")\n        ErrKindFoo      = errors.New(\"foo happened\")\n)\n</code></pre></li>\n<li><p>Error types, usually named <code>\u2026Error</code></p>\n\n<pre><code>type SomeError struct {\n     // extra information, whatever might be useful to callers\n     // (or for making a nice message in `Error()`)\n     ExtraInfo int\n}\ntype OtherError string\n\nfunc (e SomeError) Error() string { /* \u2026 */ }\nfunc (e OtherError) Error() string {\n        return fmt.Sprintf(\"failure doing something with %q\", string(e))\n}\n</code></pre>\n\n<p>With Go\u00a01.13 and later you may also want to implement a <code>Unwrap() error</code> method for use with <a href=\"https://golang.org/pkg/errors#Unwrap\" rel=\"nofollow noreferrer\"><code>errors.Unwrap</code></a>.</p></li>\n<li><p>Ad hoc <code>errors.New</code> values as needed.</p>\n\n<pre><code>func SomepackageFunction() error {\n        return errors.New(\"not implemented\")\n}\n</code></pre></li>\n<li><p>Using errors defined in the standard packages. Usually limited to a small set such as <code>io.EOF</code>; in most cases it's better to create your own via method 1 above.</p>\n\n<pre><code>func SomeFunc() error {\n        return io.EOF\n}\n</code></pre>\n\n<p>Note that sometimes when implementing an interface (such as a <code>Read</code> method to become an <code>io.Reader</code>) it <em>is</em> best to use matching errors (or \"required\" by the specification of the interface).</p></li>\n<li><p>Making an interface such as <a href=\"https://golang.org/pkg/net/#Error\" rel=\"nofollow noreferrer\"><code>net.Error</code></a>:</p>\n\n<pre><code>type Error interface {\n    error\n    Timeout() bool   // Is the error a timeout?\n    Temporary() bool // Is the error temporary?\n}\n</code></pre></li>\n<li><p>With Go 1.13 or later, returning an existing error with simple context (for more complicated context, use a custom error type with an <code>Unwrap()</code> method):</p>\n\n<pre><code>func SomepackageFunction() error {\n    err := somethingThatCanFail()\n    if err != nil {\n            return fmt.Errorf(\"some context: %w\", err)\n    }\n}\n</code></pre>\n\n<p>Note the new (to Go\u00a01.13) formatting verb <code>%w</code>, it wraps the provided error so that callers can get at it with <code>errors.Unwrap</code> or <code>error.Is</code>.</p></li>\n</ol>\n\n<p>Often you'll use a mix of all these ways.</p>\n\n<p>The first, second, and fifth are preferred if you think <em>any</em> user of your package will <em>ever</em> want to test for specific errors.\nThey allow things like:</p>\n\n<pre><code>err := somepkg.Function()\nif err == somepkg.ErrSomethingBad {\n        // \u2026\n}\n// or for an error type, something like:\nif e, ok := err.(somepkg.SomeError); ok &amp;&amp; e.ExtraInfo &gt; 42 {\n        // use the fields/methods of `e` if needed\n}\n</code></pre>\n\n<p>For Go 1.13 or later, the above can instead be written as:</p>\n\n<pre><code>err := somepkg.Function()\nif errors.Is(err, somepkg.ErrSomethingBad) {\n        // \u2026\n}\n// or for an error type, something like:\nvar someErr somepkg.SomeError\nif errors.As(err, &amp;someErr) &amp;&amp; someErr.ExtraInfo &gt; 42 {\n        // use the fields/methods of `someErr` if needed\n}\n</code></pre>\n\n<p>the difference is that errors will be unwrapped as needed.</p>\n\n<p>The fifth way (which is just an extension of the second) allows checking the error for behaviour/type like so (or using Go\u00a01.13's <code>errors.As</code>):</p>\n\n<pre><code>if e, ok := err.(net.Error); ok &amp;&amp; e.Timeout() {\n        // it's a timeout, sleep and retry\n}\n</code></pre>\n\n<p>The problem with the third way is it leaves no sane way for a user of the package to test for it. (Testing the contents of the string returned by <code>err.Error()</code> isn't a great idea).\nHowever, it's fine for the errors that you don't ever expect anyone to want to test for.</p>\n\n<p>Further reading:</p>\n\n<ul>\n<li><a href=\"https://golang.org/doc/effective_go.html#errors\" rel=\"nofollow noreferrer\">Effective Go on errors</a></li>\n<li>The Go Blog <a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"nofollow noreferrer\">Error handling and Go</a></li>\n<li>Dave Cheney <a href=\"http://dave.cheney.net/2014/12/24/inspecting-errors\" rel=\"nofollow noreferrer\">Inspecting Errors</a></li>\n<li>Peter Bourgon <a href=\"https://peter.bourgon.org/blog/2019/09/11/programming-with-errors.html\" rel=\"nofollow noreferrer\">Programming with errors</a></li>\n</ul>\n"}], "owner": {"reputation": 8455, "user_id": 850326, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cd6f8a1a0f5957695e1d9625868d2642?s=128&d=identicon&r=PG", "display_name": "djhaskin987", "link": "https://stackoverflow.com/users/850326/djhaskin987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2087, "favorite_count": 2, "accepted_answer_id": 30177953, "answer_count": 3, "score": 7, "last_activity_date": 1568310187, "creation_date": 1431379272, "last_edit_date": 1554155345, "question_id": 30177860, "link": "https://stackoverflow.com/questions/30177860/does-go-have-standard-err-variables", "title": "Does Go have standard Err variables?", "body": "<p>Just started using Golang. I think that it is idiomatic to declare an error variable and use it in your error structure to determine what went wrong, as is done in <a href=\"https://golang.org/src/strconv/atoi.go\" rel=\"nofollow\">strconv.go</a>. There, <code>ErrRange</code> and <code>ErrSyntax</code> is declared, and when appropriate, references to those are stored in <code>NumError</code> structs when they return. I think that the reason is because then the address of the reference to the error stored in <code>NumError</code> can be compared with the <code>ErrRange</code> and <code>ErrSyntax</code> variables to determine which type of error was returned.</p>\n\n<p>Are there \"standard\" such declared error types? In Java, for example, you have things like <code>java.lang.IllegalArgumentException</code>. Is there, for instance, <code>ErrArgument</code> or <code>ErrUnsupportedOperation</code> that I can use in my own code instead of creating new error variables that mean the same thing every time?</p>\n"}, {"tags": ["go", "enums", "printf"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1431378373, "post_id": 30177344, "comment_id": 48461180, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/27187132/is-it-possible-to-get-enum-name-without-creating-string-in-golang\">Is it possible to get Enum name without creating String() in Golang</a>"}], "answers": [{"comments": [{"owner": {"reputation": 600, "user_id": 4368184, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4FXPxzXpS3Y/AAAAAAAAAAI/AAAAAAAAAAA/CiVcjz3yUQg/photo.jpg?sz=128", "display_name": "Zephaniah Grunschlag", "link": "https://stackoverflow.com/users/4368184/zephaniah-grunschlag"}, "edited": false, "score": 1, "creation_date": 1501512642, "post_id": 30177417, "comment_id": 77798950, "body": "This is very brittle code and doesn&#39;t solve the DRY problem. If you&#39;re going to go in that direction, might as well just have an explicit and simple <code>String()</code> method with a switch for each const."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 600, "user_id": 4368184, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4FXPxzXpS3Y/AAAAAAAAAAI/AAAAAAAAAAA/CiVcjz3yUQg/photo.jpg?sz=128", "display_name": "Zephaniah Grunschlag", "link": "https://stackoverflow.com/users/4368184/zephaniah-grunschlag"}, "edited": false, "score": 6, "creation_date": 1501513270, "post_id": 30177417, "comment_id": 77799404, "body": "@ZephaniahGrunschlag: that&#39;s what this example does; it generates a simple String method, except you don&#39;t have to maintain it yourself, or even look at the generated code. Using the <code>stringer</code> package is fairly common in go projects. It&#39;s not intended to create a true enum, the String() output isn&#39;t meant for any comparison or verification, it&#39;s just a convenient method of creating human readable output. You don&#39;t need to downvote an answer because you don&#39;t like the Go community&#39;s choice of solution."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 10, "last_activity_date": 1431377845, "last_edit_date": 1431377845, "creation_date": 1431377465, "answer_id": 30177417, "question_id": 30177344, "link": "https://stackoverflow.com/questions/30177344/how-to-print-the-string-representation-of-an-enum-in-go/30177417#30177417", "title": "How to print the string representation of an &quot;enum&quot; in Go?", "body": "<p>You can't directly within the language, but there's a tool for generating the supporting code: <a href=\"https://godoc.org/golang.org/x/tools/cmd/stringer\" rel=\"noreferrer\">golang.org/x/tools/cmd/stringer</a></p>\n\n<p>From the example in the <code>stringer</code> docs</p>\n\n<pre><code>type Pill int\n\nconst (\n    Placebo Pill = iota\n    Aspirin\n    Ibuprofen\n    Paracetamol\n    Acetaminophen = Paracetamol\n)\n</code></pre>\n\n<p>Would produce code like</p>\n\n<pre><code>const _Pill_name = \"PlaceboAspirinIbuprofenParacetamol\"\n\nvar _Pill_index = [...]uint8{0, 7, 14, 23, 34}\n\nfunc (i Pill) String() string {\n    if i &lt; 0 || i+1 &gt;= Pill(len(_Pill_index)) {\n        return fmt.Sprintf(\"Pill(%d)\", i)\n    }\n    return _Pill_name[_Pill_index[i]:_Pill_index[i+1]]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2477, "user_id": 231664, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/Ebn5i.jpg?s=128&g=1", "display_name": "David \u5929\u5b87 Wong", "link": "https://stackoverflow.com/users/231664/david-%e5%a4%a9%e5%ae%87-wong"}, "is_accepted": false, "score": -3, "last_activity_date": 1478550940, "creation_date": 1478550940, "answer_id": 40474117, "question_id": 30177344, "link": "https://stackoverflow.com/questions/30177344/how-to-print-the-string-representation-of-an-enum-in-go/40474117#40474117", "title": "How to print the string representation of an &quot;enum&quot; in Go?", "body": "<p>This works for me:</p>\n\n<p><code>\nlevel_str = fmt.SPrintf(\"%s\", level)\n</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10412, "favorite_count": 3, "accepted_answer_id": 30177417, "answer_count": 2, "score": 7, "last_activity_date": 1478550940, "creation_date": 1431377157, "question_id": 30177344, "link": "https://stackoverflow.com/questions/30177344/how-to-print-the-string-representation-of-an-enum-in-go", "title": "How to print the string representation of an &quot;enum&quot; in Go?", "body": "<p>I've looked at the various official sources for how to do this but I can't find it. Imagine you have the following enum (I know golang doesn't have enums in the classic sense):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype LogLevel int\n\nconst (\n    Off LogLevel = iota\n    Debug\n)\n\nvar level LogLevel = Debug\n\nfunc main() {\n    fmt.Printf(\"Log Level: %s\", level)\n}\n</code></pre>\n\n<p>The closest I can get with the above <code>%s</code>, which gives me:</p>\n\n<pre><code>Log Level: %!s(main.LogLevel=1)\n</code></pre>\n\n<p>I would like to have:</p>\n\n<pre><code>Log Level: Debug\n</code></pre>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["json", "dictionary", "interface", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1431367450, "post_id": 30174260, "comment_id": 48455188, "body": "The error I get when I try to unmarshal / decode the map value (aka the interface{}) is I need a type assertion, and I am not sure how to do it.  If I know the the value is really a homeType struct how do I get it out of being an interface so I can unmarshal it an object of homeType?"}, {"owner": {"reputation": 1822, "user_id": 1401580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fad5da1145825d03c88a47b02995e6?s=128&d=identicon&r=PG", "display_name": "Alfred Rossi", "link": "https://stackoverflow.com/users/1401580/alfred-rossi"}, "reply_to_user": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1431369032, "post_id": 30174260, "comment_id": 48456099, "body": "In that case I&#39;d do something like this <a href=\"http://play.golang.org/p/hHQlAdcE56\" rel=\"nofollow noreferrer\">play.golang.org/p/hHQlAdcE56</a>. Will update the answer"}, {"owner": {"reputation": 1822, "user_id": 1401580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fad5da1145825d03c88a47b02995e6?s=128&d=identicon&r=PG", "display_name": "Alfred Rossi", "link": "https://stackoverflow.com/users/1401580/alfred-rossi"}, "reply_to_user": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1431370854, "post_id": 30174260, "comment_id": 48457163, "body": "To address your comment directly, you won&#39;t be able to type assert cleanly to a struct, because the inner object was unmarshalled as map[string]interface{} -- so you have to pick that apart field by field. See <a href=\"http://play.golang.org/p/WrpLxZH0r-\" rel=\"nofollow noreferrer\">play.golang.org/p/WrpLxZH0r-</a> and <a href=\"http://stackoverflow.com/questions/26744873/converting-map-to-struct\" title=\"converting map to struct\">stackoverflow.com/questions/26744873/converting-map-to-struc&zwnj;&#8203;t</a>"}], "tags": [], "owner": {"reputation": 1822, "user_id": 1401580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fad5da1145825d03c88a47b02995e6?s=128&d=identicon&r=PG", "display_name": "Alfred Rossi", "link": "https://stackoverflow.com/users/1401580/alfred-rossi"}, "is_accepted": true, "score": 2, "last_activity_date": 1431369269, "last_edit_date": 1431369269, "creation_date": 1431366304, "answer_id": 30174260, "question_id": 30174220, "link": "https://stackoverflow.com/questions/30174220/decode-arbitrary-json-in-golang/30174260#30174260", "title": "Decode arbitrary JSON in Golang", "body": "<p>If you have something like a map[string]interface{} then you can access the values using type assertions, e.g.</p>\n\n<pre><code>home, valid := msg[\"home\"].(string)\nif !valid {\n    return\n}\n</code></pre>\n\n<p>This works nicely for simple values. For more complicated nested structures you might find it easier to do deferred decoding with <code>json.RawMessage</code> or implement a custom <code>json.Unmarshaler</code>. See <a href=\"http://attilaolah.eu/2013/11/29/json-decoding-in-go/\" rel=\"nofollow\">this</a> for a very detailed discussion.</p>\n\n<p>Another idea might be to define a custom <code>Message</code> type consisting of pointers to Home, Bike, and Soda structs. Such as</p>\n\n<pre><code>type Home struct {\n    HomeStuff     int\n    MoreHomeStuff string\n} \n\ntype Bike struct {\n    BikeStuff int\n}\n\ntype Message struct {\n    Bike *Bike `json:\"Bike,omitempty\"`\n    Home *Home `json:\"Home,omitempty\"`\n}\n</code></pre>\n\n<p>If you set these to omit if nil then unmarshalling should only populate the relevant one. You can play with it <a href=\"http://play.golang.org/p/hHQlAdcE56\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3653, "favorite_count": 0, "accepted_answer_id": 30174260, "answer_count": 1, "score": 3, "last_activity_date": 1431369269, "creation_date": 1431366196, "question_id": 30174220, "link": "https://stackoverflow.com/questions/30174220/decode-arbitrary-json-in-golang", "title": "Decode arbitrary JSON in Golang", "body": "<p>I have a question about decoding arbitrary JSON objects/messages in Go..  Lets say for example you have three wildly different JSON objects (aka messages) that you can receive on an http connection, lets call them for sake of illustration:</p>\n\n<pre><code>{ home : { some unique set of arrays, objects, fields, and arrays objects } }\n</code></pre>\n\n<p>and</p>\n\n<pre><code>{ bike : { some unique set of arrays, objects, fields, and arrays objects } }\n</code></pre>\n\n<p>and </p>\n\n<pre><code>{ soda : { some unique set of arrays, objects, fields, and arrays objects } }\n</code></pre>\n\n<p>What I am thinking is you could decode these, from an http connection in to a map of interfaces such as:</p>\n\n<pre><code>func httpServerHandler(w http.ResponseWriter, r *http.Request) {\n    message := make(map[string]interface{})\n    decoder := json.NewDecoder(r.Body)\n    _ = decoder.Decode(&amp;message)\n</code></pre>\n\n<p>Then do an if, else if block to look for valid JSON messages</p>\n\n<pre><code>if _, ok := message[\"home\"]; ok {\n    // Decode interface{} to appropriate struct\n} else if _, ok := message[\"bike\"]; ok {\n    // Decode interface{} to appropriate struct\n} else {\n    // Decode interface{} to appropriate struct\n}\n</code></pre>\n\n<p>Now in the if block I can make it work if I re-decode the entire package, but I was thinking that is kind of a waste since I have already partially decoded it and would only need to decode the value of the map which is an interface{}, but I can not seem to get that to work right.</p>\n\n<p>Redecoding the entire thing works though, if I do something like the following where the homeType for example is a struct:</p>\n\n<pre><code>var homeObject homeType\nvar bikeObject bikeType\nvar sodaObject sodaType\n</code></pre>\n\n<p>Then in the if block do:</p>\n\n<pre><code>if _, ok := message[\"home\"]; ok {\n    err = json.Unmarshal(r.Body, &amp;homeObject)\n    if err != nil {\n        fmt.Println(\"Bad Response, unable to decode JSON message contents\")\n        os.Exit(1)\n    }\n</code></pre>\n\n<p>So without re-decoding / unmarshal-ing the entire thing again, how do you work with the interface{} in a map?</p>\n"}, {"tags": ["xml", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 3, "creation_date": 1431362881, "post_id": 30173086, "comment_id": 48452527, "body": "Holy nested <code>struct</code>s"}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "reply_to_user": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1431426752, "post_id": 30173086, "comment_id": 48481644, "body": "yep,but  i&#39;m not the one who wrote it I just give the Xml forma to a go prog and he give me the struct ^^"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1431363814, "creation_date": 1431363814, "answer_id": 30173545, "question_id": 30173086, "link": "https://stackoverflow.com/questions/30173086/golang-xml-unmarshal-no-value/30173545#30173545", "title": "Golang Xml Unmarshal, No value", "body": "<p>You are trying to unmarshal an xml document with a root of <code>&lt;VAST&gt;</code> into a struct of type <code>VastHtml</code>, which contains <code>VAST</code> as its first field. </p>\n\n<p>Pass the <code>VAST</code> element directly to the <code>Unmarshal</code> function if that is what you want to decode into.</p>\n\n<pre><code>err = xml.Unmarshal(xmlDataFromHttp, &amp;xmlData.VAST)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1431426709, "post_id": 30173558, "comment_id": 48481612, "body": "Thank you, it works, and for the nested struct i&#39;m not the one who wrote it I just give the Xml forma to a go prog and he give me the struct ^^"}], "tags": [], "owner": {"reputation": 9694, "user_id": 797538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50394e88b7b1ff30dbca04c06560e5a?s=128&d=identicon&r=PG", "display_name": "lnmx", "link": "https://stackoverflow.com/users/797538/lnmx"}, "is_accepted": false, "score": 2, "last_activity_date": 1431363854, "creation_date": 1431363854, "answer_id": 30173558, "question_id": 30173086, "link": "https://stackoverflow.com/questions/30173086/golang-xml-unmarshal-no-value/30173558#30173558", "title": "Golang Xml Unmarshal, No value", "body": "<p>The XML input has a <code>&lt;VAST&gt;</code> element at the root -- this corresponds to the <code>VastHtml.VAST</code> field in your struct.  So, pass that to <code>xml.Unmarshal</code> as the target value:</p>\n\n<pre><code>err = xml.Unmarshal(xmlDataFromHttp, &amp;xmlData.VAST)\n</code></pre>\n\n<p>(I agree with Lander that the deeply-nested struct definition is going to be a problem going forward).</p>\n"}], "owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "accepted_answer_id": 30173545, "answer_count": 2, "score": 2, "last_activity_date": 1431363854, "creation_date": 1431362262, "question_id": 30173086, "link": "https://stackoverflow.com/questions/30173086/golang-xml-unmarshal-no-value", "title": "Golang Xml Unmarshal, No value", "body": "<pre><code>type VastHtml struct {\n     VAST struct {\n             Version string `xml:\"version,attr\"`\n             Ad      struct {\n                     Id     string `xml:\"id,attr\"`\n                     InLine struct {\n                             AdSystem    string   `xml:\"AdSystem\"`\n                             AdTitle     string   `xml:\"AdTitle\"`\n                             Description string   `xml:\"Description\"`\n                             Error       string   `xml:\"Error\"`\n                             Impression  []string `xml:\"Impression\"`\n                             Creatives   struct {\n                                     Creative []struct {\n                                             Sequence string `xml:\"sequence,attr\"`\n                                             Id       string `xml:\"id,attr\"`\n                                             Linear   struct {\n                                                     Duration       string `xml:\"Duration\"`\n                                                     TrackingEvents struct {\n                                                             Tracking []string `xml:\"Tracking\"`\n                                                     } `xml:\"TrackingEvents\"`\n                                                     VideoClicks struct {\n                                                             ClickThrough string   `xml:\"ClickThrough\"`\n                                                             CustomClick  []string `xml:\"CustomClick\"`\n                                                     } `xml:\"VideoClicks\"`\n                                                     MediaFiles struct {\n                                                             MediaFile []struct {\n                                                                     Delivery string `xml:\"delivery,attr\"`\n                                                                     Bitrate  string `xml:\"bitrate,attr\"`\n                                                                     Width    string `xml:\"width,attr\"`\n                                                                     Height   string `xml:\"height,attr\"`\n                                                                     Type     string `xml:\"type,attr\"`\n                                                             } `xml:\"MediaFile\"`\n                                                     } `xml:\"MediaFiles\"`\n                                             } `xml:\"Linear\"`\n                                             CompanionAds struct {\n                                                     Companion []struct {\n                                                             Width                 string `xml:\"width,attr\"`\n                                                             Height                string `xml:\"height,attr\"`\n                                                             StaticResource        string `xml:\"StaticResource\"`\n                                                             TrackingEvents        string `xml:\"TrackingEvents\"`\n                                                             CompanionClickThrough string `xml:\"CompanionClickThrough\"`\n                                                     } `xml:\"Companion\"`\n                                             } `xml:\"CompanionAds\"`\n                                     } `xml:\"Creative\"`\n                             } `xml:\"Creatives\"`\n                             Extensions string `xml:\"Extensions\"`\n                     } `xml:\"InLine\"`\n             } `xml:\"Ad\"`\n     } `xml:\"VAST\"`\n</code></pre>\n\n<p>}</p>\n\n<pre><code>   func main() \n{\n\n    resp, err := http.Get(\"http://ad3.liverail.com/?LR_PUBLISHER_ID=1331&amp;LR_CAMPAIGN_ID=229&amp;LR_SCHEMA=vast2\")\n\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    defer resp.Body.Close()\n\n   xmlDataFromHttp, err := ioutil.ReadAll(resp.Body) \n\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n   fmt.Println(os.Stdout, string(xmlDataFromHttp))\n\n// read xml http response\n\n   var xmlData VastHtml\n   err = xml.Unmarshal(xmlDataFromHttp, &amp;xmlData)\n     if err != nil {\n           panic(err)\n         }\n\nfmt.Printf(\"XML===&gt;: \", xmlData.VAST)\n\n }\n</code></pre>\n\n<p>Hello everone,\nafter Unmarshaling the XmlVast that I get from an URL that's give just the struct but without any value. even when i copy the content of the XmlVast in a file and I try to  Unmarshal it it give me the same responce the struct without any value.</p>\n\n<p>Thank you in advance.  </p>\n"}, {"tags": ["unit-testing", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 2030114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/56e62c4b0427c86a45ca8fd1300022c3?s=128&d=identicon&r=PG", "display_name": "Vikas Verma", "link": "https://stackoverflow.com/users/2030114/vikas-verma"}, "edited": false, "score": 0, "creation_date": 1431515914, "post_id": 30171872, "comment_id": 48530479, "body": "Thanks for the answer, can you also explain why keeping the state as external global variable is not recommended."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 183, "user_id": 2030114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/56e62c4b0427c86a45ca8fd1300022c3?s=128&d=identicon&r=PG", "display_name": "Vikas Verma", "link": "https://stackoverflow.com/users/2030114/vikas-verma"}, "edited": false, "score": 0, "creation_date": 1431517822, "post_id": 30171872, "comment_id": 48531892, "body": "@VikasVerma you can do it for sure, but from my experience, it&#39;s just asking for trouble. what if you run parallel tests, for example? It&#39;s better to pass the context between stateless functions."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 6, "last_activity_date": 1431358877, "last_edit_date": 1431358877, "creation_date": 1431358498, "answer_id": 30171872, "question_id": 30171693, "link": "https://stackoverflow.com/questions/30171693/execute-test-cases-in-a-pre-defined-order/30171872#30171872", "title": "Execute test cases in a pre-defined order", "body": "<p>The only way to do it is to encapsulate all your tests into one test function, that calls sub-functions in the right order and with the right context, and pass the <code>testing.T</code> pointer to each so they can fail. The down-side is that they will all appear as one test. But in fact that is the case - tests are stateless as far as the testing framework is concerned, and each function is a separate test case. </p>\n\n<p>Note that although the tests may run in the order they are written in, I found no documentation stating that this is actually a contract of some sort. So even though you can write them in order and keep the state as external global variables - that's not recommended.</p>\n\n<p>The only flexibility the framework gives you since go 1.4 is the TestMain method that lets you run before/after steps, or setup/teardown: </p>\n\n<pre><code>func TestMain(m *testing.M) {\n\n    if err := setUp(); err != nil {\n        panic(err)\n    }\n    rc := m.Run()\n    tearDown()\n    os.Exit(rc)\n}\n</code></pre>\n\n<p>But that won't give you what you want. The only way to do that safely is to do something like:</p>\n\n<pre><code>// this is the whole stateful sequence of tests - to the testing framework it's just one case\nfunc TestWrapper(t *testing.T) {\n\n   // let's say you pass context as some containing struct\n   ctx := new(context)\n   test1(t, ctx)\n   test2(t, ctx)\n   ...\n}\n\n// this holds context between methods\ntype context struct {   \n    eventId string\n}\n\nfunc test1(t *testing.T, c *context) {\n   // do your thing, and you can manipulate the context\n   c.eventId = \"something\"\n} \n\nfunc test2(t *testing.T, c *context) {\n   // do your thing, and you can manipulate the context\n   doSomethingWith(c.eventId)\n} \n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 2030114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/56e62c4b0427c86a45ca8fd1300022c3?s=128&d=identicon&r=PG", "display_name": "Vikas Verma", "link": "https://stackoverflow.com/users/2030114/vikas-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 30171872, "answer_count": 1, "score": 1, "last_activity_date": 1431358877, "creation_date": 1431358004, "question_id": 30171693, "link": "https://stackoverflow.com/questions/30171693/execute-test-cases-in-a-pre-defined-order", "title": "Execute test cases in a pre-defined order", "body": "<p>Is there a way to execute test cases in GoLang in a pre-defined order.  </p>\n\n<p>P.S: I am writing test cases for life cycle of a event. So I have different api's for all the CURD operations. I want to run these test cases in a particular order as only if an event is created it can be destroyed.</p>\n\n<p>Also can I get some value from one test case and pass it as input to another. (example:- To test the delete event api, I need a event_id which i get when I call create_event test case)</p>\n\n<p>I am new to GoLang, can someone please guide me through.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["arrays", "json", "go", "nested"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 2284019, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5da76f7ed150b38a3db00413d3976f67?s=128&d=identicon&r=PG", "display_name": "Dede", "link": "https://stackoverflow.com/users/2284019/dede"}, "edited": false, "score": 0, "creation_date": 1431367489, "post_id": 30172804, "comment_id": 48455213, "body": "Thanks for your answer Dave! Actually using the Whatever structure help me solving the issue. Regarding ioutil.ReadAll I tried using r.Body directly but that did not work. Do you suggest to use io.Reader on r.Body?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 127, "user_id": 2284019, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5da76f7ed150b38a3db00413d3976f67?s=128&d=identicon&r=PG", "display_name": "Dede", "link": "https://stackoverflow.com/users/2284019/dede"}, "edited": false, "score": 0, "creation_date": 1431370706, "post_id": 30172804, "comment_id": 48457079, "body": "@Dede the <code>Body</code> field of an http.Response <i>is</i> an <code>io.Reader</code>. Yes, use it via <code>json.Decoder</code> as I showed. Unless you need other fields/method of the request it&#39;d also be better to change the argument of your <code>getJsonContent</code> function to be an <code>io.Reader</code> (like I did for <code>fromJSON</code>; or perhaps an <code>io.ReadCloser</code>; in the former you&#39;d leave it to the caller to close the request body). That makes it more flexible (e.g. you could pass it an <code>*os.File</code> of stored JSON or a <code>strings.Reader</code> for testing)."}, {"owner": {"reputation": 127, "user_id": 2284019, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5da76f7ed150b38a3db00413d3976f67?s=128&d=identicon&r=PG", "display_name": "Dede", "link": "https://stackoverflow.com/users/2284019/dede"}, "edited": false, "score": 0, "creation_date": 1431415077, "post_id": 30172804, "comment_id": 48473879, "body": "Thanks, I actually managed to do exactly what you said with <code>x, err := fromJSON(r.Body)</code>. By the way, just for clarity, RT is <code>time.Duration</code> and gtAnswer (ground truth answer) is <code>string</code>. Thanks again"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1431361352, "creation_date": 1431361352, "answer_id": 30172804, "question_id": 30171134, "link": "https://stackoverflow.com/questions/30171134/decoding-nested-json-objects-in-go/30172804#30172804", "title": "decoding nested json objects in go", "body": "<p>You're doing it the hard way by using <code>interface{}</code> and not taking advantage of what <code>encoding/json</code> gives you.</p>\n\n<p>I'd do it something like this (note I assumed there was an error with the type of the \"gtAns\" field and I made it a boolean, you don't give enough information to know what to do with the \"RT\" field):</p>\n\n<pre><code>package main\n\nimport (\n        \"encoding/json\"\n        \"fmt\"\n        \"io\"\n        \"log\"\n        \"strconv\"\n        \"strings\"\n)\n\nconst input = `{\n\"user\":{\n    \"gender\":\"male\",\n    \"age\":\"21-30\",\n    \"id\":\"80b1ea88-19d7-24e8-52cc-65cf6fb9b380\"\n    },\n\"trials\":{\n    \"0\":{\"index\":0,\"word\":\"WORD 1\",\"Time\":3000,\"keyboard\":true,\"train\":true,\"type\":\"A\"},\n    \"1\":{\"index\":1,\"word\":\"WORD 2\",\"Time\":3000,\"keyboard\":true,\"train\":true,\"type\":\"A\"}\n    },\n\"answers\":{\n    \"training\":[\n        {\"ans\":0,\"RT\":null,\"gtAns\":true,\"correct\":0},\n        {\"ans\":0,\"RT\":null,\"gtAns\":true,\"correct\":0}\n        ],\n    \"test\":[\n        {\"ans\":0,\"RT\":null,\"gtAns\":true,\"correct\":0},\n        {\"ans\":0,\"RT\":null,\"gtAns\":true,\"correct\":0}\n        ]\n    }\n}`\n\ntype Whatever struct {\n        User struct {\n                Gender Gender   `json:\"gender\"`\n                Age    Range    `json:\"age\"`\n                ID     IDString `json:\"id\"`\n        } `json:\"user\"`\n        Trials map[string]struct {\n                Index int    `json:\"index\"`\n                Word  string `json:\"word\"`\n                Time  int    // should this be a time.Duration?\n                Train bool   `json:\"train\"`\n                Type  string `json:\"type\"`\n        } `json:\"trials\"`\n        Answers map[string][]struct {\n                Answer    int             `json:\"ans\"`\n                RT        json.RawMessage // ??? what type is this\n                GotAnswer bool            `json:\"gtAns\"`\n                Correct   int             `json:\"correct\"`\n        } `json:\"answers\"`\n}\n\n// Using some custom types to show custom marshalling:\n\ntype IDString string // TODO custom unmarshal and format/error checking\n\ntype Gender int\n\nconst (\n        Male Gender = iota\n        Female\n)\n\nfunc (g *Gender) UnmarshalJSON(b []byte) error {\n        var s string\n        err := json.Unmarshal(b, &amp;s)\n        if err != nil {\n                return err\n        }\n        switch strings.ToLower(s) {\n        case \"male\":\n                *g = Male\n        case \"female\":\n                *g = Female\n        default:\n                return fmt.Errorf(\"invalid gender %q\", s)\n        }\n        return nil\n}\nfunc (g Gender) MarshalJSON() ([]byte, error) {\n        switch g {\n        case Male:\n                return []byte(`\"male\"`), nil\n        case Female:\n                return []byte(`\"female\"`), nil\n        default:\n                return nil, fmt.Errorf(\"invalid gender %v\", g)\n        }\n}\n\ntype Range struct{ Min, Max int }\n\nfunc (r *Range) UnmarshalJSON(b []byte) error {\n        // XXX could be improved\n        _, err := fmt.Sscanf(string(b), `\"%d-%d\"`, &amp;r.Min, &amp;r.Max)\n        return err\n}\nfunc (r Range) MarshalJSON() ([]byte, error) {\n        return []byte(fmt.Sprintf(`\"%d-%d\"`, r.Min, r.Max)), nil\n        // Or:\n        b := make([]byte, 0, 8)\n        b = append(b, '\"')\n        b = strconv.AppendInt(b, int64(r.Min), 10)\n        b = append(b, '-')\n        b = strconv.AppendInt(b, int64(r.Max), 10)\n        b = append(b, '\"')\n        return b, nil\n}\n\nfunc fromJSON(r io.Reader) (Whatever, error) {\n        var x Whatever\n        dec := json.NewDecoder(r)\n        err := dec.Decode(&amp;x)\n        return x, err\n}\n\nfunc main() {\n        // Use http.Get or whatever to get an io.Reader,\n        // (e.g. response.Body).\n        // For playground, substitute a fixed string\n        r := strings.NewReader(input)\n\n        // If you actually had a string or []byte:\n        //     var x Whatever\n        //     err := json.Unmarshal([]byte(input), &amp;x)\n\n        x, err := fromJSON(r)\n        if err != nil {\n                log.Fatal(err)\n        }\n        fmt.Println(x)\n        fmt.Printf(\"%+v\\n\", x)\n\n        b, err := json.MarshalIndent(x, \"\", \"  \")\n        if err != nil {\n                log.Fatal(err)\n        }\n        fmt.Printf(\"Re-marshalled: %s\\n\", b)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/jmcLXHOBEr\" rel=\"nofollow\"><kbd>Playground</kbd></a></p>\n\n<p>Of course if you want to reuse those sub-types you could pull them out of the \"Whatever\" type into their own named types.</p>\n\n<p>Also, note the use of a <code>json.Decoder</code> rather than reading in all the data ahead of time. Usually try and avoid any use of <code>ioutil.ReadAll</code> unless you really need all the data at once.</p>\n"}], "owner": {"reputation": 127, "user_id": 2284019, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5da76f7ed150b38a3db00413d3976f67?s=128&d=identicon&r=PG", "display_name": "Dede", "link": "https://stackoverflow.com/users/2284019/dede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 30172804, "answer_count": 1, "score": 0, "last_activity_date": 1431361352, "creation_date": 1431356497, "question_id": 30171134, "link": "https://stackoverflow.com/questions/30171134/decoding-nested-json-objects-in-go", "title": "decoding nested json objects in go", "body": "<p>I found some posts on how to decoding json nested objects in go, I tried to apply the answers to my problem, but I only managed to find a partial solution.</p>\n\n<p>My json file look like this:</p>\n\n<pre><code>{\n\"user\":{\n    \"gender\":\"male\",\n    \"age\":\"21-30\",\n    \"id\":\"80b1ea88-19d7-24e8-52cc-65cf6fb9b380\"\n    },\n\"trials\":{\n    \"0\":{\"index\":0,\"word\":\"WORD 1\",\"Time\":3000,\"keyboard\":true,\"train\":true,\"type\":\"A\"},\n    \"1\":{\"index\":1,\"word\":\"WORD 2\",\"Time\":3000,\"keyboard\":true,\"train\":true,\"type\":\"A\"},\n    },\n\"answers\":{\n    \"training\":[\n        {\"ans\":0,\"RT\":null,\"gtAns\":\"WORD 1\",\"correct\":0},\n        {\"ans\":0,\"RT\":null,\"gtAns\":\"WORD 2\",\"correct\":0}\n        ],\n    \"test\":[\n        {\"ans\":0,\"RT\":null,\"gtAns\":true,\"correct\":0},\n        {\"ans\":0,\"RT\":null,\"gtAns\":true,\"correct\":0}\n        ]\n    }\n}\n</code></pre>\n\n<p>Basically I need to parse the information inside it and save them into go structure. With the code below I managed to extract the user information, but it looks too complicated to me and it won't be easy to apply the same thing to the \"answers\" fields which contains 2 arrays with more than 100 entries each. Here the code I'm using now:</p>\n\n<pre><code>type userDetails struct {\n    Id     string `json:\"id\"`\n    Age    string `json:\"age\"`\n    Gender string `json:\"gender\"`\n}\n\ntype jsonRawData map[string]interface {\n}\n\nfunc getJsonContent(r *http.Request) ( userDetails) {\n    defer r.Body.Close()\n    jsonBody, err := ioutil.ReadAll(r.Body)\n    var userDataCurr userDetails\n    if err != nil {\n        log.Printf(\"Couldn't read request body: %s\", err)\n    } else {\n        var f jsonRawData\n        err := json.Unmarshal(jsonBody, &amp;f)\n        if err != nil {\n            log.Printf(\"Error unmashalling: %s\", err)\n        } else {\n            user := f[\"user\"].(map[string]interface{})\n            userDataCurr.Id = user[\"id\"].(string)\n            userDataCurr.Gender = user[\"gender\"].(string)\n            userDataCurr.Age = user[\"age\"].(string)\n        }\n    }\n    return userDataCurr\n}\n</code></pre>\n\n<p>Any suggestions? Thanks a lot!</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1431354654, "post_id": 30169961, "comment_id": 48446764, "body": "now im getting this error datastore.NewQuery returned error:&amp;errors.errorString{s:&quot;datastore: bad query filter value type: unsupported datastore value type: datastore.ByteString&quot;}"}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1431354710, "post_id": 30169961, "comment_id": 48446799, "body": "this ByteString(subscriptionToken))  has to be  datastore.ByteString(subscriptionToken) in order to compile ??"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1431355185, "post_id": 30169961, "comment_id": 48447149, "body": "@MIkCode Ok, I tried the code, when filtering, you have to specify a value of type <code>[]byte</code>. The posted code now works."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1431423034, "post_id": 30169961, "comment_id": 48478961, "body": "im still getting the same error ,the bytestring is saved in the datastore as Blob , why ? It might be a version &quot;thing&quot; ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1431424415, "post_id": 30169961, "comment_id": 48480003, "body": "@MIkCode If you already have entities saved as <code>[]byte</code>, they will not miraculously change to <code>ByteString</code>. You have to load them and resave them as <code>ByteString</code>."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1431430506, "post_id": 30169961, "comment_id": 48484331, "body": "i drop the table completely re insert the data  as you can see in the update , but still datastore  set the type to BLOB  <a href=\"http://imgur.com/Lo87STS\" rel=\"nofollow noreferrer\">imgur.com/Lo87STS</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1431430999, "post_id": 30169961, "comment_id": 48484693, "body": "@MIkCode I suggest you to upgrade/use the latest AppEngine SDK. I also suggest to clear your whole local datastore upon start. You can do that with <code>goapp serve -clear_datastore</code>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1431361489, "last_edit_date": 1431361489, "creation_date": 1431353561, "answer_id": 30169961, "question_id": 30169476, "link": "https://stackoverflow.com/questions/30169476/datastore-blob-that-cannot-be-indexed/30169961#30169961", "title": "Datastore BLOB that cannot be indexed", "body": "<p>The error message indicates that the <code>User</code> entity that you have in your Datastore has a property <code>SubscriptionToken</code> which is not of type <code>ByteString</code> but rather <code>[]byte</code>.</p>\n\n<p>Properties of type <code>[]byte</code> are not indexed.</p>\n\n<p>If you want a property of type Byte slice to be indexed, when you save the entity, the property must have a value of type <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#ByteString\" rel=\"nofollow\"><code>datastore.ByteString</code></a>, for example:</p>\n\n<pre><code>type User struct {\n    SubscriptionToken datastore.ByteString\n}\n\nu := User{SubscriptionToken: datastore.ByteString(\"somevalue\")}\n// Save u\nkey, err := datastore.Put(c, datastore.NewIncompleteKey(c, \"User\", nil), &amp;u)\nif err != nil {\n    // Handle error\n}\n</code></pre>\n\n<p><code>datastore.ByteString</code> is basically just a byte slice (<code>[]byte</code>) and nothing more (at the moment): it signals that you want the the byte slice that is being saved to be indexed.</p>\n\n<p>And when you try to filter by this property, the property value to filter by has to be a value of type <code>[]byte</code>:</p>\n\n<pre><code>q := datastore.NewQuery(\"User\").Filter(\"SubscriptionToken=\", []byte(subscriptionToken))\n\n// If you want to count:\ncount, err := q.Count(c)\nif err != nil {\n    // Handle error\n}\n\n// Query/filter:\nvar users []*User\nkeys, err := q.GetAll(c, &amp;users)\nif err != nil {\n    // Handle error\n}\n</code></pre>\n\n<p>Btw to check the length of a <code>ByteString</code> value, you can simply use the builtin function <a href=\"http://golang.org/pkg/builtin/#len\" rel=\"nofollow\"><code>len()</code></a> since a <code>ByteString</code> is a byte slice (<code>[]byte</code>):</p>\n\n<pre><code>length := len(u.SubscriptionToken)\n</code></pre>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1471904272, "creation_date": 1431352273, "last_edit_date": 1471904272, "question_id": 30169476, "link": "https://stackoverflow.com/questions/30169476/datastore-blob-that-cannot-be-indexed", "title": "Datastore BLOB that cannot be indexed", "body": "<p>I have a string (~180 chars length) as <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#ByteString\" rel=\"nofollow\">datastore.ByteString</a> type, I want it to be indexed so that I will able to filter by the type.</p>\n\n<pre><code>keys, err := datastore.NewQuery(\"User\").\n    Filter(\"SubscriptionToken= \", []byte(subscriptionToken)).Count(c)\n</code></pre>\n\n<p>When I'm trying to filter I'm getting this error:</p>\n\n<pre><code>{Service:\"datastore_v3\", Detail:\"Property \\\"SubscriptionToken\\\" has a value meaning BLOB that cannot be indexed.\", Code:1}\n</code></pre>\n\n<p>The only reason that I think about is that the size of the bytestring is greater than 1500k and it can't be indexed? </p>\n\n<p>But I can't figure out how to check the bytestring size.</p>\n\n<p><strong>UPDATE:</strong>  this is how i insert the <strong>User</strong> entity </p>\n\n<pre><code>type User struct {\n    UserEmail         string\n    SubscriptionToken datastore.ByteString\n}\n//subscriptionToken has value\nu := User{\n            UserEmail:         userEmail,\n            SubscriptionToken: datastore.ByteString(subscriptionToken),\n        }\n\nk := datastore.NewKey(c, \"User\", userKey, 0, nil)\n        _, err = datastore.Put(c, k, &amp;u)\n        if err != nil {\n            log.Debugf(c, \"Write datastore.Put: %#v \", err)\n            return err\n        }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1431345394, "post_id": 30166986, "comment_id": 48440294, "body": "Shouldn&#39;t you add a type to the <code>testParameters, reqType</code> parameters? like <code>func ConstructRequest(testParameters, reqType string) *Request</code>"}, {"owner": {"reputation": 3291, "user_id": 462575, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/524849342/picture?type=large", "display_name": "Allen", "link": "https://stackoverflow.com/users/462575/allen"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1431345463, "post_id": 30166986, "comment_id": 48440339, "body": "sorry i just corrected it"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 3, "creation_date": 1431345569, "post_id": 30166986, "comment_id": 48440405, "body": "And should,&#39;t you add the package associated with Request in your function definition? Like http.Request?"}], "answers": [{"comments": [{"owner": {"reputation": 3291, "user_id": 462575, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/524849342/picture?type=large", "display_name": "Allen", "link": "https://stackoverflow.com/users/462575/allen"}, "edited": false, "score": 0, "creation_date": 1431345667, "post_id": 30167122, "comment_id": 48440471, "body": "calculation_test.go:18:64: expected &#39;;&#39;, found &#39;*&#39;"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1431345694, "last_edit_date": 1431345694, "creation_date": 1431345600, "answer_id": 30167122, "question_id": 30166986, "link": "https://stackoverflow.com/questions/30166986/golang-import-undefined-request/30167122#30167122", "title": "Golang Import (undefined: Request)", "body": "<p><code>undefined: Request</code> seems normal if you don't specify the package for the returned type:</p>\n\n<pre><code>func ConstructRequest(testParameters string, reqType string) http.Request\n                                                             ^^^^\n</code></pre>\n\n<p>Since <a href=\"http://golang.org/pkg/net/http/#NewRequest\" rel=\"noreferrer\"><code>http.NewRequest()</code></a> returns a pointer, this should be:</p>\n\n<pre><code>func ConstructRequest(testParameters string, reqType string) *http.Request\n</code></pre>\n"}], "owner": {"reputation": 3291, "user_id": 462575, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/524849342/picture?type=large", "display_name": "Allen", "link": "https://stackoverflow.com/users/462575/allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 2, "accepted_answer_id": 30167122, "answer_count": 1, "score": 2, "last_activity_date": 1431345694, "creation_date": 1431345160, "last_edit_date": 1431345477, "question_id": 30166986, "link": "https://stackoverflow.com/questions/30166986/golang-import-undefined-request", "title": "Golang Import (undefined: Request)", "body": "<p>I'm trying to create a custom function that passes the Request object back as a result:</p>\n\n<pre><code> func ConstructRequest(testParameters string, reqType string) Request {\n    req, err := http.NewRequest(reqType, testPath+testParameters, nil)\n\n    if err != nil {\n        log.Fatal(err)\n        return nil\n    } else {\n        return req\n    }\n}\n</code></pre>\n\n<p>but I'm getting a \"undefined: Request\" error</p>\n\n<p>I'm not sure what library I need to import to make it work?</p>\n"}, {"tags": ["pointers", "interface", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 41, "last_activity_date": 1489176527, "last_edit_date": 1489176527, "creation_date": 1431331359, "answer_id": 30162432, "question_id": 30162256, "link": "https://stackoverflow.com/questions/30162256/convert-nil-interface-to-pointer-of-something-in-golang/30162432#30162432", "title": "Convert nil interface to pointer of something in Golang?", "body": "<p>This is because a variable of <em>static</em> type <code>Nexter</code> (which is just an interface) may hold values of many different <em>dynamic</em> types.</p>\n\n<p>Yes, since <code>*Node</code> implements <code>Nexter</code>, your <code>p</code> variable <em>may</em> hold a value of type <code>*Node</code>, but it may hold <em>other types</em> as well which implement <code>Nexter</code>; or it may hold <em>nothing</em> at all (<code>nil</code> value). And <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">Type assertion</a> cannot be used here because quoting from the spec:</p>\n\n<blockquote>\n  <p><code>x.(T)</code> asserts that <code>x</code> is <strong>not <code>nil</code></strong> and that the value stored in <code>x</code> is of type <code>T</code>.</p>\n</blockquote>\n\n<p>But <code>x</code> in your case is <code>nil</code>. And if the type assertion is false, <strong>a run-time panic occurs</strong>.</p>\n\n<p>If you change your program to initialize your <code>p</code> variable with:</p>\n\n<pre><code>var p Nexter = (*Node)(nil)\n</code></pre>\n\n<p>Your program will run and type assertion succeeds. This is because an interface value actually holds a pair in the form of: <code>(value, dynamic type)</code>, and in this case your <code>p</code> will not be <code>nil</code>, but will hold a pair of <code>(nil, *Node)</code>; for details see <a href=\"http://blog.golang.org/laws-of-reflection#TOC_3.\" rel=\"noreferrer\">The Laws of Reflection #The representation of an interface</a>.</p>\n\n<p>If you also want to handle <code>nil</code> values of interface types, you may check it explicitly like this:</p>\n\n<pre><code>if p != nil {\n    n = p.(*Node) // will not fail IF p really contains a value of type *Node\n}\n</code></pre>\n\n<p>Or better: use the special \"comma-ok\" form:</p>\n\n<pre><code>// This will never fail:\nif n, ok := p.(*Node); ok {\n    fmt.Printf(\"n=%#v\\n\", n)\n}\n</code></pre>\n\n<p>Using the \"comma-ok\" form:</p>\n\n<blockquote>\n  <p>The value of <code>ok</code> is <code>true</code> if the assertion holds. Otherwise it is <code>false</code> and the value of <code>n</code> is the zero value for type <code>T</code>. <strong>No run-time panic occurs in this case.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 367, "user_id": 1489111, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68908e77fc0ee19a223530b75a32df75?s=128&d=identicon&r=PG", "display_name": "Mihnea Giurgea", "link": "https://stackoverflow.com/users/1489111/mihnea-giurgea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27348, "favorite_count": 8, "accepted_answer_id": 30162432, "answer_count": 1, "score": 19, "last_activity_date": 1489176527, "creation_date": 1431330696, "last_edit_date": 1470219673, "question_id": 30162256, "link": "https://stackoverflow.com/questions/30162256/convert-nil-interface-to-pointer-of-something-in-golang", "title": "Convert nil interface to pointer of something in Golang?", "body": "<p>In the following code piece, trying to convert a nil interface to a pointer of something fails with the following error: <code>interface conversion: interface is nil, not *main.Node</code></p>\n\n<pre><code>type Nexter interface {\n    Next() Nexter\n}\n\ntype Node struct {\n    next Nexter\n}\n\nfunc (n *Node) Next() Nexter {...}\n\nfunc main() {\n    var p Nexter\n\n    var n *Node\n    fmt.Println(n == nil) // will print true\n    n = p.(*Node) // will fail\n}\n</code></pre>\n\n<p>Play link here: <a href=\"https://play.golang.org/p/2cgyfUStCI\" rel=\"noreferrer\">https://play.golang.org/p/2cgyfUStCI</a></p>\n\n<p>Why does this fail exactly? It's entirely possible to do </p>\n\n<pre><code>n = (*Node)(nil)\n</code></pre>\n\n<p>, so I'm wondering how can you achieve a similar effect starting from a nil interface.</p>\n"}, {"tags": ["go", "box-api"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1431323994, "post_id": 30160508, "comment_id": 48427950, "body": "As trivial as your code seems to be, please apply some formatting on it..."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1431327949, "last_edit_date": 1431327949, "creation_date": 1431324474, "answer_id": 30160613, "question_id": 30160508, "link": "https://stackoverflow.com/questions/30160508/uploading-the-files-and-folders-using-go-to-the-box-account/30160613#30160613", "title": "Uploading the files and folders using Go to the box account", "body": "<p>The problem is that you try to do an <code>HTTP POST</code> request:</p>\n\n<pre><code>r, _ := http.NewRequest(\"POST\", urlStr, bytes.NewBuffer(f))\n</code></pre>\n\n<p>But the server does not allow/support this as stated in the response error (only <code>GET</code>, <code>OPTIONS</code> and <code>HEAD</code> methods are allowed):</p>\n\n<blockquote>\n  <p>Method Not Allowed 405 HTTP/1.1 1 1 map[Allow:[GET, OPTIONS, HEAD] </p>\n</blockquote>\n\n<p>According to the <a href=\"https://developers.box.com/get-started/\" rel=\"nofollow\">box.com API</a> to upload a file using <code>POST</code> you need to use a multi-part form upload request.</p>\n\n<p>You can use the <a href=\"http://golang.org/pkg/mime/multipart/\" rel=\"nofollow\"><code>multipart</code></a> package to create a multipart request with a file.</p>\n\n<p>Here is an example how to do it (incomplete/untested code):</p>\n\n<pre><code>buf := &amp;bytes.Buffer{}\nmw := multipart.NewWriter(buf)\ndefer mw.Close()\nf, err := os.Open(\"C:\\\\Users\\\\vembu\\\\Desktop\\\\hi.txt\")\nif err != nil {\n    // Handle error\n}\ndefer f.Close()\nff, err := mw.CreateFormFile(\"name\", \"hi.txt\")\nif err != nil {\n    // Handle error\n}\nif _, err = io.Copy(ff, f); err != nil {\n    // Handle error\n}\n\n// TODO: INCLUDE OTHER FIELDS/PARAMS IN URL\nr, err := http.NewRequest(\"POST\", \"https://upload.box.com/api/2.0/files/content\", buf)\nif err != nil {\n    // Handle error\n}\nr.Header.Set(\"Content-Type\", mw.FormDataContentType())\n// TODO: ADD YOUR OTHER HEADER FIELDS\n\n// Do the call: upload file\nclient := &amp;http.Client{}\nresp, err := client.Do(r)\nif err != nil {\n    // Handle error\n}\n\nif resp.StatusCode != http.StatusOK {\n    fmt.Printf(\"Error: %v\", resp.Status)\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4563410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3901385ef613380c66e439c020a1733b?s=128&d=identicon&r=PG&f=1", "display_name": "Kiruthika Hindraj", "link": "https://stackoverflow.com/users/4563410/kiruthika-hindraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431327949, "creation_date": 1431323888, "last_edit_date": 1431326230, "question_id": 30160508, "link": "https://stackoverflow.com/questions/30160508/uploading-the-files-and-folders-using-go-to-the-box-account", "title": "Uploading the files and folders using Go to the box account", "body": "<p>For the program below I get the below error. It will be helpful if anyone helps me to fix my errors. Thanks in advance.</p>\n\n<pre><code>func upload() {\n    fmt.Println(\"dfxfgcghvjbjhiiiiiiiiiiiiiiiiiii\")\n    apiUrl := \"https://upload.box.com/\"\n    resource := \"api/2.0/files/content\"\n    data := url.Values{}\n    data.Add(\"access_token\", accessobj.Access_token)\n    authbear := \"Bearer \"\n    authbear += accessobj.Access_token\n\n    u, _ := url.ParseRequestURI(apiUrl)\n    u.Path = resource\n    urlStr := fmt.Sprintf(\"%v\", u)\n    client := &amp;http.Client{}\n    fmt.Println(urlStr)\n\n    f, err := ioutil.ReadFile(\"C:\\\\Users\\\\vembu\\\\Desktop\\\\hi.txt\")\n    ioutil.WriteFile(\"hi.txt\", f, 0x777)\n    r, _ := http.NewRequest(\"POST\", urlStr, bytes.NewBuffer(f))\n    r.Header.Add(\"Authorization\", \"Bearer \"+accessobj.Access_token)\n    r.Header.Add(\"attributes\",\n        \"{\\\"name\\\":\\\"hi.txt\\\",\\\"parent\\\":{\\\"id\\\":\\\"3098791209\\\"}}\")\n    r.Header.Add(\"file\", \"hi.txt\")\n    fmt.Println(r)\n    if err != nil {\n        fmt.Println(\"error......:\", err)\n    }\n\n    resp, err1 := client.Do(r)\n    if err1 != nil {\n        fmt.Println(\"error:\", err1)\n    }\n    fmt.Println(\"uploading\")\n    fmt.Println(resp)\n\n    re, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Println(\"errorrrrr:\", err)\n    }\n    fmt.Println(string(re))\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>I face &amp;{405 Method Not Allowed 405 HTTP/1.1 1 1\nmap[Allow:[GET, OPTIONS, HEAD] Content-Type:[text/html;charset=UTF-8]\nContent-Length:[0] Date:[Thu, 12 Mar 2015 13:07:32 GMT] Age:[0]\nConnection:[keep-alive]\nServer:[ATS]] 0xc08200b8c0 0 [] false map[] 0xc08201f2b0 0xc082060980}\n</code></pre>\n"}, {"tags": ["string", "go"], "answers": [{"comments": [{"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 3, "creation_date": 1431321654, "post_id": 30160112, "comment_id": 48427200, "body": "Ninjas... ninjas everywhere!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1431321731, "last_edit_date": 1592644375, "creation_date": 1431321601, "answer_id": 30160112, "question_id": 30159980, "link": "https://stackoverflow.com/questions/30159980/why-does-error-have-priority-over-string/30160112#30160112", "title": "Why does Error() have priority over String()", "body": "<p>Simply because this is how it is implemented. An <code>error</code> is more important in practice, so if the <code>error</code> interface is implemented, that will be printed.</p>\n<p>This is documented, read the package doc of <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\"><code>fmt</code></a>:</p>\n<blockquote>\n<p>Except when printed using the verbs %T and %p, special formatting considerations apply for operands that implement certain interfaces. In order of application:</p>\n<ol>\n<li><p>If an operand implements the Formatter interface, it will be invoked. Formatter provides fine control of formatting.</p>\n</li>\n<li><p>If the %v verb is used with the # flag (%#v) and the operand implements the GoStringer interface, that will be invoked.</p>\n</li>\n</ol>\n<p>If the format (which is implicitly %v for Println etc.) is valid for a string (%s %q %v %x %X), the following two rules apply:</p>\n<ol start=\"3\">\n<li><p>If an operand implements the <strong>error</strong> interface, the Error method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</li>\n<li><p>If an operand implements method <strong>String() string</strong>, that method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</li>\n</ol>\n</blockquote>\n<p>So <code>error</code> is 3<sup>rd</sup> on the list while <code>String()</code> is only 4<sup>th</sup>.</p>\n"}, {"tags": [], "owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "is_accepted": false, "score": 1, "last_activity_date": 1431321619, "creation_date": 1431321619, "answer_id": 30160115, "question_id": 30159980, "link": "https://stackoverflow.com/questions/30159980/why-does-error-have-priority-over-string/30160115#30160115", "title": "Why does Error() have priority over String()", "body": "<p>The reason is simple: when <em>fmt</em> uses any of it's print functions, it does a type switch for each argument to determine how it should be printed, and in that type switch <code>case error</code> appears just before <code>case Stringer</code>. </p>\n"}], "owner": {"reputation": 15995, "user_id": 1509580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UW1HY.jpg?s=128&g=1", "display_name": "Arian Faurtosh", "link": "https://stackoverflow.com/users/1509580/arian-faurtosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 30160112, "answer_count": 2, "score": 2, "last_activity_date": 1431321731, "creation_date": 1431320705, "last_edit_date": 1431321350, "question_id": 30159980, "link": "https://stackoverflow.com/questions/30159980/why-does-error-have-priority-over-string", "title": "Why does Error() have priority over String()", "body": "<p>I've been looking through the tour for go, and I can't figure out why this happens.</p>\n\n<p>When you have a <code>Stringer</code> (<code>String() string</code>), <code>fmt</code> will use that method for printing to console. Like suggested in <a href=\"https://tour.golang.org/methods/6\" rel=\"nofollow\">https://tour.golang.org/methods/6</a></p>\n\n<p>However if you add <code>Error() string</code>, this method gets called instead of <code>String() string</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    Name string\n    Age  int\n}\n\nfunc (p *Person) String() string {\n    return fmt.Sprintf(\"%v (%v years)\", p.Name, p.Age)\n}\n\nfunc (p *Person) Error() string {\n    return fmt.Sprintf(\"Failed\")\n}\n\nfunc main() {\n    a := &amp;Person{\"Arthur Dent\", 42}\n    z := &amp;Person{\"Zaphod Beeblebrox\", 9001}\n    fmt.Println(a, z)\n}\n</code></pre>\n\n<p>Results:</p>\n\n<blockquote>\n  <p>Failed Failed</p>\n</blockquote>\n\n<p>I don't understand why <code>fmt.Println</code> uses <code>Error</code> instead of <code>String</code>.</p>\n"}, {"tags": ["mysql", "postgresql", "go", "embedded-database"], "answers": [{"tags": [], "owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "is_accepted": true, "score": 4, "last_activity_date": 1431322216, "last_edit_date": 1431322216, "creation_date": 1431307643, "answer_id": 30158451, "question_id": 30158146, "link": "https://stackoverflow.com/questions/30158146/how-to-detemine-if-database-server-or-embedded-database-is-appropriate/30158451#30158451", "title": "How to detemine if database server or embedded database is appropriate", "body": "<ol>\n<li><p>An <code>embedded database</code> resides within the application. It doesn't need to be relational.</p>\n\n<p>For instance, the media manager on your computer has a database embedded within it to store audio/video metadata and file location. This database could be relational, in which case, the database could be something like sqlite or mysql. (i don't think postgres can be deployed embedded in an application). Embedded databases are great if you want to cache local information, or you're sure that information within the application does not need to be communicated externally for the application's functionality. A core design goal for embedded databases is having a low footprint, so in many cases embedded databases omit features found in dedicated databases.</p></li>\n<li><p>A dedicated database server supports one or many clients' read and write operations, and usually provides more features than the embedded versions. Postgres and Mysql are both dedicated databases and are used widely in networked applications. They are also both relational databases, and not key-value stores, which Bolt seems to be. </p></li>\n<li><p>A key value store is a non-relational database. Think <code>redis</code> (or <code>dicts</code> in python), where  </p>\n\n<ul>\n<li>retrieval: the client gives the database the key, and the database responds with the value.  </li>\n<li>assigning: the client provides the database a key &amp; value, and the database assigns a new key with given value, or updates the existing key's value.</li>\n</ul>\n\n<p>Note: <code>postgres</code> has <code>hstore</code>, which is a key value store.</p></li>\n</ol>\n\n<p>Just like relational databases, key-value databases can be embedded within or reside separately on dedicated hardware. Here are some example questions one must ask while making these architecture decisions.</p>\n\n<ol>\n<li><p>Does my application depend on data that need to be communicated, and do I want to communicate the data by writing to a central database, or does each chat client connect to the other client on a peer to peer model and stores its own data?</p></li>\n<li><p>Do I need a relational model in my application, or a key-value store, or some other exotic data model?</p></li>\n</ol>\n\n<p><em>Just my personal opinion, the relational model has been successful at satisfying a wide variety of persistent requirements over the last 30 odd years. Has very mature solutions for both embedded or dedicated deployment. It is a good place to start.</em></p>\n"}], "owner": {"reputation": 677, "user_id": 764384, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7792c766c5034f2d1322b38d9ed1bad0?s=128&d=identicon&r=PG", "display_name": "slmyers", "link": "https://stackoverflow.com/users/764384/slmyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 30158451, "answer_count": 1, "score": 1, "last_activity_date": 1431322216, "creation_date": 1431304795, "last_edit_date": 1592644375, "question_id": 30158146, "link": "https://stackoverflow.com/questions/30158146/how-to-detemine-if-database-server-or-embedded-database-is-appropriate", "title": "How to detemine if database server or embedded database is appropriate", "body": "<blockquote>\n<p>Bolt is a pure Go key/value store inspired by Howard Chu's and the LMDB project. The goal of the project is to provide a simple, fast, and reliable database for projects that don't require a full database server such as Postgres or MySQL.</p>\n</blockquote>\n<p><a href=\"https://github.com/boltdb/bolt/blob/master/README.md\" rel=\"nofollow noreferrer\">Bolt readme</a></p>\n<p>How does one determine if an application requires a full database server? I assume it has to do with number of concurrent writers?</p>\n<p>I'm planning on writing a simple distributed social networking application as a fun project.</p>\n"}, {"tags": ["security", "email", "go", "smtp"], "answers": [{"comments": [{"owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1431378751, "post_id": 30158160, "comment_id": 48461362, "body": "How do I know if my server supports TLS? Do I need to install some other program? Do I need a TLS certificate on my end?"}, {"owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "reply_to_user": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1431380624, "post_id": 30158160, "comment_id": 48462284, "body": "are you running your own server or using someone elses?  if you own? did you configure TLS / SSL on your MTA?   You would need an SSL certificate  configured ( it can be self signed,but you might run into issue with certain programs -- not sure about go, but assuming it is linked against openssl, then you might have issues with self signed)"}, {"owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1431381349, "post_id": 30158160, "comment_id": 48462566, "body": "Most of the time, I&#39;m running my own server on DigitalOcean."}, {"owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "reply_to_user": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1431382275, "post_id": 30158160, "comment_id": 48462937, "body": "Then you would need to configure / enable tls as part of the server / droplet. If the code is running on the same server /droplet you probably won&#39;t need the auth / tls. As your attack surface in that case is minimal."}, {"owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1431382934, "post_id": 30158160, "comment_id": 48463164, "body": "Is configuring TLS &quot;as part of the server&quot; similar to setting up TLS certs for a web server? Or is it a different process entirely?"}, {"owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "reply_to_user": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1431387011, "post_id": 30158160, "comment_id": 48464417, "body": "Pretty much same thing and you can use the same cert / key. Just need to add the correct config."}], "tags": [], "owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "is_accepted": true, "score": 3, "last_activity_date": 1431323046, "last_edit_date": 1431323046, "creation_date": 1431304957, "answer_id": 30158160, "question_id": 30158027, "link": "https://stackoverflow.com/questions/30158027/does-net-smtp-send-credentials-in-plain-text/30158160#30158160", "title": "Does net/smtp send credentials in plain text?", "body": "<p>PlainAuth uses the Plain auth mech from RFC 4616, which is the username/password in plain cleartext.  Normally when you are using this, encryption will be handled at a lower level, for example you will create a TLS connection.   and then use PlainAuth over that.  If you are not talking over an encrypted connection, then use of PlainAuth can be risky as if the traffic is intercepted, the user/pass are easy to get.    </p>\n\n<p>but if you read, you will see the <code>SendMail</code> function says the following:</p>\n\n<blockquote>\n  <p>SendMail connects to the server at addr, switches to TLS if possible, authenticates with the optional mechanism a if possible, and then sends an email from address from, to addresses to, with message msg.</p>\n</blockquote>\n\n<p>So it will try to automatically upgrade to TLS where possible for you.  So as long as you are using servers that support TLS, you should be relatively safe.   The other Auth choice is CramMD5, but server support for this method is generally less common than PlainAuth which most everything supports.</p>\n"}], "owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 30158160, "answer_count": 1, "score": 1, "last_activity_date": 1431323046, "creation_date": 1431303721, "question_id": 30158027, "link": "https://stackoverflow.com/questions/30158027/does-net-smtp-send-credentials-in-plain-text", "title": "Does net/smtp send credentials in plain text?", "body": "<p>I'm looking at this example. <a href=\"http://golang.org/pkg/net/smtp/#example_PlainAuth\" rel=\"nofollow\">http://golang.org/pkg/net/smtp/#example_PlainAuth</a></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/smtp\"\n)\n\nfunc main() {\n    // Set up authentication information.\n    auth := smtp.PlainAuth(\"\", \"user@example.com\", \"password\", \"mail.example.com\")\n\n    to := []string{\"recipient@example.net\"}\n    mesg := []byte(\"This is the email body.\")\n\n    err := smtp.SendMail(\"mail.example.com:25\", auth, \"sender@example.org\", to, mesg)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Does <code>smtp.PlainAuth</code> send credentials to the mail server in plain text? Is it safe to use net/smtp in the wild?</p>\n"}, {"tags": ["oop", "interface", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431304114, "post_id": 30158023, "comment_id": 48423259, "body": "Like <a href=\"https://golang.org/pkg/io/#ReadWriteCloser\" rel=\"nofollow noreferrer\"><code>io.ReadWriteCloser</code></a>?"}], "answers": [{"tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": true, "score": 19, "last_activity_date": 1431313574, "last_edit_date": 1431313574, "creation_date": 1431310306, "answer_id": 30158714, "question_id": 30158023, "link": "https://stackoverflow.com/questions/30158023/composition-of-interfaces-golang/30158714#30158714", "title": "Composition of interfaces [Golang]", "body": "<p>This can be done the same way as when composing structs.</p>\n\n<pre><code>type BasicDatabase interface {\n    CreateTable(string) error\n    DeleteTable(string) error\n}\n\ntype SpecificDatabase interface {\n    BasicDatabase\n    CreateUserRecord(User) error\n}\n</code></pre>\n"}], "owner": {"reputation": 1535, "user_id": 1190009, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/7ErLF.jpg?s=128&g=1", "display_name": "Michael Robinson", "link": "https://stackoverflow.com/users/1190009/michael-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2827, "favorite_count": 3, "accepted_answer_id": 30158714, "answer_count": 1, "score": 9, "last_activity_date": 1431313574, "creation_date": 1431303677, "last_edit_date": 1431304896, "question_id": 30158023, "link": "https://stackoverflow.com/questions/30158023/composition-of-interfaces-golang", "title": "Composition of interfaces [Golang]", "body": "<p>Is there a way to make an interface also include the methods defined by another interface in Go?</p>\n\n<p>For example:</p>\n\n<pre><code>type BasicDatabase interface {\n    CreateTable(string) error\n    DeleteTable(string) error\n}\n\ntype SpecificDatabase interface {\n    CreateUserRecord(User) error\n}\n</code></pre>\n\n<p>I would like a way to specify that the <code>SpecificDatabase</code> interface contains the <code>BasicDatabase</code> interface. Similar to the way Go lets you do composition of structs.</p>\n\n<p>This way my methods can take a type that implements <code>SpecificDatabase</code> but still call <code>CreateTable()</code> on it.</p>\n"}, {"tags": ["google-chrome", "go", "windows-8.1"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user285594"}, "edited": false, "score": 0, "creation_date": 1431294759, "post_id": 30156926, "comment_id": 48421124, "body": "What if the Windows 8.1 PC does not have DNS (like in enterprise they do not allow to go internet but only stay in local area network, how do you verify in that case if Ethernet or WiFi is online and it has at-least an IP)"}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": 1, "last_activity_date": 1431293735, "creation_date": 1431293735, "answer_id": 30156926, "question_id": 30156703, "link": "https://stackoverflow.com/questions/30156703/how-to-make-sure-the-pc-is-having-internet-and-then-launch-exec/30156926#30156926", "title": "How to make sure the PC is having internet and then launch exec?", "body": "<p>you could do an <code>http.Get()</code></p>\n\n<pre><code>func hazInternet() bool {\n    res, err := http.Get(\"http://www.google.com/robots.txt\")\n    if err != nil {\n        log.Println(err)\n        return false\n    }\n    res.Body.Close()\n    return true\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/CEMvR_g-Wf\" rel=\"nofollow\">Go PlayGround</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user285594"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 30156926, "answer_count": 1, "score": 1, "last_activity_date": 1431293735, "creation_date": 1431292269, "last_edit_date": 1431292470, "question_id": 30156703, "link": "https://stackoverflow.com/questions/30156703/how-to-make-sure-the-pc-is-having-internet-and-then-launch-exec", "title": "How to make sure the PC is having internet and then launch exec?", "body": "<p>I  have this application running, when system boots Windows 8.1 then it launch. But often the PC get into the network later as a result Google Chrome shows a failed page.</p>\n\n<pre><code>package main\nimport \"os\"\nimport \"os/exec\"\nimport \"runtime\"\nimport \"encoding/json\"\n\ntype Configuration struct {\n  main []string\n  name []string\n  window []string\n}\n\nfunc main() {\n  myos := runtime.GOOS;\n  myarch := runtime.GOARCH;\n  var chrome = \"\";\n  var cmdopen *exec.Cmd;\n\n  if myos == \"windows\" {\n    if myarch == \"386\" {\n      chrome = \"C:/Program Files (x86)/Google/Chrome/Application/chrome.exe\";\n    } else {      \n      chrome = \"C:/Program Files (x86)/Google/Chrome/Application/chrome.exe\";\n    }          \n\n    // Read config\n    file, _ := os.Open(\"C:/Program Files (x86)/abc/package.json\");\n    decoder := json.NewDecoder(file);\n    configuration := Configuration{};\n    err := decoder.Decode(&amp;configuration);\n    if err != nil {\n      println(\"error: \", err);\n    }\n\n    println(configuration.main);\n\n    // BUG!!!!!!!!!!!!!!!!!!! But make sure local network or internet is available do not just execute the chrome like idiot, which is showing dead page\n    cmdopen = exec.Command(chrome, \"--app=http://icanhazip.com\");\n    err1 := cmdopen.Start();\n    if err1 != nil {\n      println(\"Failed: \", err1);\n    } \n\n  } else {\n    println(\"Incompatible\");\n  } \n}\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 115, "user_id": 3483106, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYgZl.png?s=128&g=1", "display_name": "Tudor", "link": "https://stackoverflow.com/users/3483106/tudor"}, "edited": false, "score": 0, "creation_date": 1431365511, "post_id": 30155409, "comment_id": 48454138, "body": "I changed two items: a. objectID := bson.ObjectIdHex(The_ID) plus err = c.FindId(objectID).One(&amp;result) and b. the object returned is of type Raw and not RawDocElem. It saved correctly the pdf after this."}], "answers": [{"tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": true, "score": 0, "last_activity_date": 1431345150, "creation_date": 1431345150, "answer_id": 30166981, "question_id": 30155409, "link": "https://stackoverflow.com/questions/30155409/golang-mongodb-mgo-retrieve-inserted-file-bson-not-gridfs/30166981#30166981", "title": "Golang - MongoDB (mgo) retrieve inserted file (BSON not GridFS)", "body": "<p>I think your way to build the object ID is wrong. Furthermore, you forgot to test the error following the FindId call.</p>\n\n<p>I would try to import the bson package, and build the object ID using something like:</p>\n\n<pre><code>hexString := \"554f98a400afc2dd3cbfb21b\" //24 digits hexadecimal string\nobjid := bson.ObjectIdHex(hexString)\n...\nerr = c.FindId(objid).One(&amp;result)\nif err == nil {\n   // Do something with result\n   ...\n} else {\n   // Error\n   ...\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 3483106, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYgZl.png?s=128&g=1", "display_name": "Tudor", "link": "https://stackoverflow.com/users/3483106/tudor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 0, "accepted_answer_id": 30166981, "answer_count": 1, "score": 0, "last_activity_date": 1431345150, "creation_date": 1431284106, "last_edit_date": 1431285179, "question_id": 30155409, "link": "https://stackoverflow.com/questions/30155409/golang-mongodb-mgo-retrieve-inserted-file-bson-not-gridfs", "title": "Golang - MongoDB (mgo) retrieve inserted file (BSON not GridFS)", "body": "<p>I am a newbie in Golang.\nI am trying to retrieve a PDF file object I have inserted. I am not using GridFS, as the files that I would be storing are under 16 MB.\nThe object has been inserted (using load_file function) and the object ID I am seeing with the MongoDB visual client is ObjectId(\"554f98a400afc2dd3cbfb21b\").</p>\n\n<p>Unfortunately the file created on disk is of 0 kb.\nPlease advise how to correctly retrieve the inserted PDF object.</p>\n\n<p>Thank you</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n\n    \"gopkg.in/mgo.v2\"\n)\n\ntype Raw struct {\n    Kind byte\n    Data []byte\n}\n\ntype RawDocElem struct {\n    Name  string\n    Value Raw\n}\n\nfunc check(err error) {\n    if err != nil {\n        panic(err.Error())\n    }\n}\n\nfunc read_file_content(AFileName string) []byte {\n\n    file_contents, err := ioutil.ReadFile(AFileName)\n    check(err)\n    return file_contents\n}\n\nfunc save_fetched_file(AFileName RawDocElem) {\n    ioutil.WriteFile(\"fisier.pdf\", AFileName.Value.Data, 0644)\n    fmt.Println(\"FileName:\", AFileName.Name)\n}\n\nfunc load_file(AFileName string, ADatabaseName string, ACollection string) {\n    session, err := mgo.Dial(\"127.0.0.1,127.0.0.1\")\n\n    if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n\n    session.SetMode(mgo.Monotonic, true)\n\n    c := session.DB(ADatabaseName).C(ACollection)\n\n    the_obj_to_insert := Raw{Kind: 0x00, Data: read_file_content(AFileName)}\n\n    err = c.Database.C(ACollection).Insert(&amp;the_obj_to_insert)\n    check(err)\n\n}\n\nfunc get_file(ADatabaseName string, ACollection string, The_ID string) RawDocElem {\n    session, err := mgo.Dial(\"127.0.0.1,127.0.0.1\")\n\n    if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n\n    session.SetMode(mgo.Monotonic, true)\n    c := session.DB(ADatabaseName).C(ACollection)\n\n    result := RawDocElem{}\n    err = c.FindId(The_ID).One(&amp;result)\n    return result\n}\n\nfunc main() {\n    //f_name := \"Shortcuts.pdf\"\n    db_name := \"teste\"\n    the_collection := \"ColectiaDeFisiere\"\n    //load_file(f_name, db_name, the_collection)\n    fmt.Sprintf(`ObjectIdHex(\"%x\")`, string(\"554f98a400afc2dd3cbfb21b\"))\n    save_fetched_file(get_file(db_name, the_collection, fmt.Sprintf(`ObjectIdHex(\"%x\")`, string(\"554f98a400afc2dd3cbfb21b\"))))\n}\n</code></pre>\n"}, {"tags": ["performance", "memory-management", "optimization", "multidimensional-array", "go"], "answers": [{"comments": [{"owner": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "edited": false, "score": 0, "creation_date": 1431328017, "post_id": 30154985, "comment_id": 48429803, "body": "Quick follow-up regarding your first point: the matrix is stored the same way in memory in both cases, i.e. as a 1D array. The only difference is in how I access it. In version 1 I use 2D slices and in version 2 I use a linear slice.I&#39;m also not experiencing such big performance differences in other languages, e.g. Java. Do you know why that might be?"}, {"owner": {"reputation": 5100, "user_id": 4109045, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gslz2.jpg?s=128&g=1", "display_name": "VAndrei", "link": "https://stackoverflow.com/users/4109045/vandrei"}, "reply_to_user": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "edited": false, "score": 0, "creation_date": 1431336535, "post_id": 30154985, "comment_id": 48434588, "body": "There&#39;s a difference between using [][]int and []int. The second case means that the array is stored contiguously (1D). The first I consider 2D and you have to pay all the mentioned penalties. There&#39;s a chance that Java might make just in time optimizations and change your code on the fly, so the performance differences won&#39;t be major."}, {"owner": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "edited": false, "score": 0, "creation_date": 1431341281, "post_id": 30154985, "comment_id": 48437714, "body": "If you look at the code of version 1 you see that I allocate one big n*n array, and then create slices for each row that point to this linear array."}, {"owner": {"reputation": 5100, "user_id": 4109045, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gslz2.jpg?s=128&g=1", "display_name": "VAndrei", "link": "https://stackoverflow.com/users/4109045/vandrei"}, "reply_to_user": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "edited": false, "score": 0, "creation_date": 1431349190, "post_id": 30154985, "comment_id": 48442791, "body": "Hmmm... That&#39;s a point. What do you include in timing? Do you also include the allocation? If not, that leaves only causes 2 and 3. Because of the indirection you add more cycles per transaction and make the hw prefetcher ineffective."}, {"owner": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "edited": false, "score": 0, "creation_date": 1431355391, "post_id": 30154985, "comment_id": 48447316, "body": "The measurements doesn&#39;t include any allocations. I&#39;m gonna do some more testing in Java before I&#39;ll accept this as answered."}, {"owner": {"reputation": 5100, "user_id": 4109045, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gslz2.jpg?s=128&g=1", "display_name": "VAndrei", "link": "https://stackoverflow.com/users/4109045/vandrei"}, "reply_to_user": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "edited": false, "score": 0, "creation_date": 1431434252, "post_id": 30154985, "comment_id": 48487156, "body": "The most straight forward solution would be to have the assembly code posted for mult1 and mult2 and look at the differences."}, {"owner": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "edited": false, "score": 0, "creation_date": 1431466016, "post_id": 30154985, "comment_id": 48509006, "body": "I implemented something similar to Go slices in C which made it clearer were the performance penalty came from. Thanks for your answer, although you should probably remove / edit your first bullet."}, {"owner": {"reputation": 5100, "user_id": 4109045, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gslz2.jpg?s=128&g=1", "display_name": "VAndrei", "link": "https://stackoverflow.com/users/4109045/vandrei"}, "reply_to_user": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "edited": false, "score": 0, "creation_date": 1431720953, "post_id": 30154985, "comment_id": 48635799, "body": "Please see my revised response. If you have a linux machine, you can run your program with &quot;perf stat ./binary&quot; and you will see a bunch of statistics that will give you the reasons for the performance difference."}], "tags": [], "owner": {"reputation": 5100, "user_id": 4109045, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gslz2.jpg?s=128&g=1", "display_name": "VAndrei", "link": "https://stackoverflow.com/users/4109045/vandrei"}, "is_accepted": true, "score": 6, "last_activity_date": 1431720823, "last_edit_date": 1431720823, "creation_date": 1431281904, "answer_id": 30154985, "question_id": 30154087, "link": "https://stackoverflow.com/questions/30154087/go-unexpected-performance-when-accessing-an-array-through-slice-of-slices-2d-s/30154985#30154985", "title": "Go: Unexpected performance when accessing an array through slice of slices (2D slice)", "body": "<p>The main problem in your version 1 code seems to be <em>indirect addressing</em>. Even though the layout in memory for the matrices in both versions is the same, using indirect addressing can lead to:</p>\n\n<ul>\n<li><em>More generated instructions for the same code.</em> The compiler could have trouble in determining when to use packed versions of SIMD instructions (e.g. SSE, AVX). You can verify this by dumping the assembly code, look for XMM or YMM registers and check if the instructions operating on the registers are packed.</li>\n<li><em>You make it difficult for the compiler to add software prefetches.</em> Because indirect addressing, it's difficult for the compiler to detect how to add software prefetches. You can look for vprefetch instructions in the assembly code.</li>\n<li><em>The hardware prefetcher will be less efficient</em> also due to indirect addressing. You first need to access the line start address and then access the line elements so it's hard to observe that the hardware prefetcher should just fetch consecutive addresses. That's only measurable through profiling like perf.</li>\n</ul>\n\n<p>So in case of version 1, <em>indirect addressing</em> is the main issue. I also recommend running the 2 codes in multiple iterations to r<em>emove the cache warming penalty</em> which might be higher for version 1 because of what I explained above.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1537273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d458e61767068d2b3e7d8cc99fac2d7c?s=128&d=identicon&r=PG", "display_name": "Zaript", "link": "https://stackoverflow.com/users/1537273/zaript"}, "is_accepted": false, "score": -1, "last_activity_date": 1431361056, "creation_date": 1431361056, "answer_id": 30172705, "question_id": 30154087, "link": "https://stackoverflow.com/questions/30154087/go-unexpected-performance-when-accessing-an-array-through-slice-of-slices-2d-s/30172705#30172705", "title": "Go: Unexpected performance when accessing an array through slice of slices (2D slice)", "body": "<p>Unfortunately, I do not have enough reputation to put this in as comment, but in addition to <em>VAndrei</em>'s points it is worth noting that two provided examples use for-loop differently. How does first example perform after <code>s/i := range m1/i := 0; i &lt; n; i++/</code> ?</p>\n\n<p>It could also be useful to check how \"list mult1\" and \"list mult2\" outputs looks like in pprof.\nThere is great tutorial to get started with Go's pprof very fast: <a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow\">Profiling Go Programs By Russ Cox</a></p>\n"}], "owner": {"reputation": 1159, "user_id": 1047423, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d1ef31e7a2cebcd486e9bfbe63c65a01?s=128&d=identicon&r=PG", "display_name": "Carlj901", "link": "https://stackoverflow.com/users/1047423/carlj901"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 30154985, "answer_count": 2, "score": 6, "last_activity_date": 1431720823, "creation_date": 1431277042, "last_edit_date": 1431377399, "question_id": 30154087, "link": "https://stackoverflow.com/questions/30154087/go-unexpected-performance-when-accessing-an-array-through-slice-of-slices-2d-s", "title": "Go: Unexpected performance when accessing an array through slice of slices (2D slice)", "body": "<p>I was doing some performance experimentation in Go with matrix multiplication and ran into some unexpected results.</p>\n\n<p>Version 1:</p>\n\n<pre><code>func newMatrix(n int) [][]int {\n    m := make([][]int, n)\n    buf := make([]int, n*n)\n\n    for i := range m {\n        m[i] = buf[i*n : (i+1)*n]\n    }\n\n    return m\n}\n\nfunc mult1(m1, m2, res [][]int) [][]int {\n    for i := range m1 {\n        for k := range m1[0] {\n            for j := range m2[0] {\n                res[i][j] += m1[i][k] * m2[k][j]\n            }\n        }\n    }\n\n    return res\n}\n</code></pre>\n\n<p>From the linear array i create multiple slices that represent the matrix rows.</p>\n\n<p>Version 2:</p>\n\n<pre><code>func mult2(m1, m2, res []int, n int) []int {\n    for i := 0; i &lt; n; i++ {\n        for k := 0; k &lt; n; k++ {\n            for j := 0; j &lt; n; j++ {\n                res[i*n+j] += m1[i*n+k] * m2[k*n+j]\n            }\n        }\n    }\n\n    return res\n}\n</code></pre>\n\n<p>In this version I simply use a linear array and index into it from the multiplication.</p>\n\n<p>Multiplying 2 2048x2048 matrices give the following execution time:</p>\n\n<pre><code> version 1: 35.550813801s\n version 2: 19.090223468s\n</code></pre>\n\n<p>Version 2 is almost twice as fast.</p>\n\n<p>I used the approach below to take the measurements:</p>\n\n<pre><code>start := time.Now()\nmult(m1, m2, m3)\nstop := time.Now()\n</code></pre>\n\n<p>I am aware using slices give another layer of indirection which could impact the cache performance, however I didn't expect it would be such a big difference. Unfortunately I haven't found any good tool, that works with Mac, that can analyse cache efficiency in Go, so I can't say for sure if this is what's causing the performance difference.</p>\n\n<p>So I guess I'm asking is this expected behavior or is there something I'm missing?</p>\n\n<p>Software and hardware:\nGo version 1.4.2 darwin/amd64; OS X 10.10.3; 2 GHz quad-core i7.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 2, "last_activity_date": 1431275770, "creation_date": 1431275770, "answer_id": 30153870, "question_id": 30153664, "link": "https://stackoverflow.com/questions/30153664/byteswap-ulong-in-golang/30153870#30153870", "title": "_byteswap_ulong in Golang", "body": "<p>The package encoding/binary has a ByteOrder type\n<a href=\"http://golang.org/pkg/encoding/binary/#ByteOrder\" rel=\"nofollow\">http://golang.org/pkg/encoding/binary/#ByteOrder</a></p>\n\n<pre><code>binary.LittleEndian\n</code></pre>\n\n<p>and</p>\n\n<pre><code>binary.BigEndian\n</code></pre>\n\n<p>Let you swap to different orders.</p>\n\n<p>It's not exactly the same as it doesn't just swap bytes.  But may get you what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "is_accepted": true, "score": 0, "last_activity_date": 1431277869, "creation_date": 1431277869, "answer_id": 30154248, "question_id": 30153664, "link": "https://stackoverflow.com/questions/30153664/byteswap-ulong-in-golang/30154248#30154248", "title": "_byteswap_ulong in Golang", "body": "<p>As @David said, use the <a href=\"http://golang.org/pkg/encoding/binary/#ByteOrder\" rel=\"nofollow\">binary.ByteOrder</a> type</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n)\n\nfunc main() {\n    value := make([]byte, 4)\n\n    // need to know the byte ordering ahead of time\n    binary.LittleEndian.PutUint32(value, 0x12345678)\n\n    fmt.Printf(\"%#v\\n\", value)\n\n    fmt.Printf(\"Big Endian Representation, 0x%X\\n\", binary.BigEndian.Uint32(value))\n    fmt.Printf(\"Little Endian Representation, 0x%X\\n\", binary.LittleEndian.Uint32(value))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Fb6kDPmc_9\" rel=\"nofollow\">Playground link</a></p>\n\n<p>This will output:</p>\n\n<pre><code>[]byte{0x78, 0x56, 0x34, 0x12}\nBig Endian Representation, 0x78563412\nLittle Endian Representation, 0x12345678\n</code></pre>\n\n<p>These are the big-endian and little-endian representations on a little-endian server.</p>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 1, "last_activity_date": 1569706916, "creation_date": 1569706916, "answer_id": 58150527, "question_id": 30153664, "link": "https://stackoverflow.com/questions/30153664/byteswap-ulong-in-golang/58150527#58150527", "title": "_byteswap_ulong in Golang", "body": "<p>Golang 1.9 added <code>ReverseBytes</code> function family in package <code>math/bits</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"math/bits\"\n)\n\nfunc main() {\n    fmt.Printf(\"%x\", bits.ReverseBytes32(2832779))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/VqFc4Zk3F3w\" rel=\"nofollow noreferrer\">Playground link</a></p>\n"}], "owner": {"reputation": 13, "user_id": 4884765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9ea4539ac717d8ab308ce52e41fae27?s=128&d=identicon&r=PG&f=1", "display_name": "rkon", "link": "https://stackoverflow.com/users/4884765/rkon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 30154248, "answer_count": 3, "score": 0, "last_activity_date": 1569706916, "creation_date": 1431274680, "last_edit_date": 1431282175, "question_id": 30153664, "link": "https://stackoverflow.com/questions/30153664/byteswap-ulong-in-golang", "title": "_byteswap_ulong in Golang", "body": "<p>What is the equivalent of _byteswap_ulong in Golang?\nDoes it exist as a package?</p>\n\n<p>I tried to use the binary package and play with the reader, but couldn't get it working. I need to swap bytes in a uint64 variable.</p>\n\n<p>Input is 2832779. Output should be 8b392b.</p>\n"}, {"tags": ["apache", "go", "mod-proxy", "mod-auth-kerb"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4491734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nRN3ussy9JI/AAAAAAAAAAI/AAAAAAAAEOg/umM-JRj26Hk/photo.jpg?sz=128", "display_name": "Ulrich Anhalt", "link": "https://stackoverflow.com/users/4491734/ulrich-anhalt"}, "edited": false, "score": 0, "creation_date": 1431338146, "post_id": 30152782, "comment_id": 48435620, "body": "Thank you for the response! Unfortunately the only header entries I can see in my Go application are the following:     Date value: [Mon, 11 May 2015 09:42:55 GMT]     Www-Authenticate value: [Negotiate]     Vary value: [Accept-Encoding]     Content-Type value: [text/html; charset=iso-8859-1]  Is the position of the SetEnvIf line in the &lt;VirtualHost&gt; section imortant? I tried different positions but without success."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 0, "last_activity_date": 1431269349, "creation_date": 1431269349, "answer_id": 30152782, "question_id": 30152416, "link": "https://stackoverflow.com/questions/30152416/apache-mod-auth-kerb-mod-proxy-get-authenticated-user-in-go-web-application/30152782#30152782", "title": "Apache, mod_auth_kerb, mod_proxy: Get authenticated user in Go Web Application", "body": "<p>You should be able to set a header via <code>SetEnvIf</code> - <a href=\"http://httpd.apache.org/docs/2.2/mod/mod_setenvif.html#setenvif\" rel=\"nofollow\">http://httpd.apache.org/docs/2.2/mod/mod_setenvif.html#setenvif</a> - as below:</p>\n\n<p><code>SetEnvIf Authorization \"(.*)\" HTTP_APP_USER=$1</code></p>\n\n<p>You can then access it in Go via <code>r.Header.Get(\"HTTP_APP_USER\")</code>.</p>\n\n<p>Beware that there's no guarantee the client hasn't <em>also</em> set a header with the same: <a href=\"http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#x-headers\" rel=\"nofollow\">http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#x-headers</a></p>\n\n<blockquote>\n  <p>Be careful when using these headers on the origin server, since they will contain more than one (comma-separated) value if the original request already contained one of these headers. For example, you can use %{X-Forwarded-For}i in the log format string of the origin server to log the original clients IP address, but you may get more than one address if the request passes through several proxies.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2404, "user_id": 2583229, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ExqLX.png?s=128&g=1", "display_name": "revau.lt", "link": "https://stackoverflow.com/users/2583229/revau-lt"}, "is_accepted": false, "score": 0, "last_activity_date": 1446146484, "creation_date": 1446146484, "answer_id": 33422880, "question_id": 30152416, "link": "https://stackoverflow.com/questions/30152416/apache-mod-auth-kerb-mod-proxy-get-authenticated-user-in-go-web-application/33422880#33422880", "title": "Apache, mod_auth_kerb, mod_proxy: Get authenticated user in Go Web Application", "body": "<p>Try the following config, you should then see your username in the header <code>X-Forwarded-User</code>. Make sure the headers module is loaded e.g. <code>a2enmod headers</code>:</p>\n\n<pre><code>&lt;VirtualHost host.domain.com:80&gt;\n\n  &lt;Location /&gt;\n    ## gzip\n    ##\n    AddOutputFilterByType DEFLATE text/html\n\n    AuthType                   Kerberos\n    AuthName                   \"User Admin\"\n    KrbAuthRealms              DOMAIN.COM\n    Krb5Keytab                 /etc/host.krb5keytab\n    KrbMethodNegotiate         on\n    KrbAuthoritative           on\n    KrbMethodK5Passwd          off\n    KrbLocalUserMapping        on\n    KrbSaveCredentials         on\n    require valid-user\n    RequestHeader              set X-Forwarded-User %{REMOTE_USER}s    \n  &lt;/Location&gt;\n\n  ProxyPreserveHost On\n  ProxyPass / http://127.0.0.1:9000/\n  ProxyPassReverse / http://127.0.0.1:9000/\n\n&lt;/VirtualHost&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4491734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nRN3ussy9JI/AAAAAAAAAAI/AAAAAAAAEOg/umM-JRj26Hk/photo.jpg?sz=128", "display_name": "Ulrich Anhalt", "link": "https://stackoverflow.com/users/4491734/ulrich-anhalt"}, "is_accepted": true, "score": 5, "last_activity_date": 1448548458, "last_edit_date": 1448548458, "creation_date": 1448547385, "answer_id": 33940890, "question_id": 30152416, "link": "https://stackoverflow.com/questions/30152416/apache-mod-auth-kerb-mod-proxy-get-authenticated-user-in-go-web-application/33940890#33940890", "title": "Apache, mod_auth_kerb, mod_proxy: Get authenticated user in Go Web Application", "body": "<p>Sorry for the delay - I was involved in other projects. Many thanks for the suggestions. The following solution now works for me after switching to the environment <strong>CentOS 7/httpd 2.4:</strong></p>\n\n<pre><code>&lt;VirtualHost host.domain.com:80&gt;\n\n  &lt;Location /&gt;\n    ## gzip                                                                                          \n    ##                                                                                               \n    AddOutputFilterByType DEFLATE text/html\n\n    AuthType                   Kerberos\n    AuthName                   \"Web Application\"\n    KrbAuthRealms              DOMAIN.COM\n    Krb5Keytab                 /etc/host.krb5keytab\n    KrbMethodNegotiate         on\n    KrbAuthoritative           on\n    KrbMethodK5Passwd          off\n    KrbLocalUserMapping        on\n    KrbSaveCredentials         on\n    require valid-user\n\n    RequestHeader unset X-Forwarded-User\n    RewriteEngine On\n    RewriteCond %{LA-U:REMOTE_USER} (.+)\n    RewriteRule .* - [E=RU:%1]\n    RequestHeader add X-Forwarded-User %{RU}e\n  &lt;/Location&gt;\n\n  ProxyPreserveHost On\n  ProxyPass / http://127.0.0.1:8000/\n  ProxyPassReverse / http://127.0.0.1:8000/\n\n  ServerName host.domain.com\n &lt;/VirtualHost&gt;\n</code></pre>\n\n<p>The user can be accessed in Go with:</p>\n\n<pre><code>user := req.Header.Get(\"X-Forwarded-User\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 2754655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fbb2333d25098dc3285fe662768d0bf?s=128&d=identicon&r=PG&f=1", "display_name": "Hans-Joachim Kliemeck", "link": "https://stackoverflow.com/users/2754655/hans-joachim-kliemeck"}, "is_accepted": false, "score": 1, "last_activity_date": 1469693330, "creation_date": 1469693330, "answer_id": 38630565, "question_id": 30152416, "link": "https://stackoverflow.com/questions/30152416/apache-mod-auth-kerb-mod-proxy-get-authenticated-user-in-go-web-application/38630565#38630565", "title": "Apache, mod_auth_kerb, mod_proxy: Get authenticated user in Go Web Application", "body": "<p>do NOT use the rewrite workaround, because you will get into trouble with execution phases if the REMOTE_USER is set with a module like mod_authn_ntlm (ntlm with local computer, see <a href=\"https://support.microsoft.com/en-us/kb/896861\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/896861</a>).</p>\n\n<pre><code>RewriteCond %{LA-U:REMOTE_USER} (.+)\nRewriteRule . - [E=RU:%1]\nRequestHeader set X-Remote-User %{RU}e\n</code></pre>\n\n<p><strong>instead use the following method:</strong></p>\n\n<pre><code>RequestHeader set X-Remote-User expr=%{REMOTE_USER}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4491734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nRN3ussy9JI/AAAAAAAAAAI/AAAAAAAAEOg/umM-JRj26Hk/photo.jpg?sz=128", "display_name": "Ulrich Anhalt", "link": "https://stackoverflow.com/users/4491734/ulrich-anhalt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7990, "favorite_count": 0, "accepted_answer_id": 33940890, "answer_count": 4, "score": 1, "last_activity_date": 1469693330, "creation_date": 1431267211, "question_id": 30152416, "link": "https://stackoverflow.com/questions/30152416/apache-mod-auth-kerb-mod-proxy-get-authenticated-user-in-go-web-application", "title": "Apache, mod_auth_kerb, mod_proxy: Get authenticated user in Go Web Application", "body": "<p>I'm using Apache as reverse proxy for things like authentication in front of the go http server.</p>\n\n<p>The following apache kerberos setup works with one problem. I don't know how to get the authenticated username in my go application.</p>\n\n<p>httpd.conf:</p>\n\n<pre><code>&lt;VirtualHost host.domain.com:80&gt;\n  ProxyPreserveHost On\n  ProxyPass / http://127.0.0.1:9000/\n  ProxyPassReverse / http://127.0.0.1:9000/\n\n  &lt;Location /&gt;\n    ## gzip\n    ##\n    AddOutputFilterByType DEFLATE text/html\n\n    Order                      deny,allow\n    Allow                      from all\n\n    AuthType                   Kerberos\n    AuthName                   \"User Admin\"\n    KrbAuthRealms              DOMAIN.COM\n    Krb5Keytab                 /etc/host.krb5keytab\n    KrbMethodNegotiate         on\n    KrbAuthoritative           on\n    KrbMethodK5Passwd          off\n    KrbLocalUserMapping on\n    KrbSaveCredentials         on\n    require valid-user\n  &lt;/Location&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>With</p>\n\n<pre><code> AuthType                    basic\n</code></pre>\n\n<p>I get the username from the request's Authorization header with the go function </p>\n\n<pre><code>func (*Request) BasicAuth\n</code></pre>\n\n<p>but with Authorization header negotiate this is not possible. Furthermore I'm not able to use the REMOTE_USER environment variable because there is no cgi environment. I also tried to set the RequestHeader but without any success.</p>\n\n<p>Is there any possibility to get the authorized username from the go application?</p>\n"}, {"tags": ["node.js", "go"], "comments": [{"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1431265906, "post_id": 30152150, "comment_id": 48411674, "body": "If you have a byte array it&#39;s simply <code>buffer[3]</code>."}, {"owner": {"reputation": 85, "user_id": 3125559, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9703d3d2eea00a8ee895679452feeead?s=128&d=identicon&r=PG&f=1", "display_name": "user3125559", "link": "https://stackoverflow.com/users/3125559/user3125559"}, "reply_to_user": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1431265991, "post_id": 30152150, "comment_id": 48411697, "body": "@inf can you please provide an example?"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 1, "creation_date": 1431266083, "post_id": 30152150, "comment_id": 48411736, "body": "buffer := []byte(&quot;asdf&quot;); log.Println(buffer[2]);"}, {"owner": {"reputation": 92373, "user_id": 2050455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b1255d2cb06adc4d0b48adf1d90e847?s=128&d=identicon&r=PG", "display_name": "mscdex", "link": "https://stackoverflow.com/users/2050455/mscdex"}, "edited": false, "score": 1, "creation_date": 1431269668, "post_id": 30152150, "comment_id": 48412896, "body": "<code>readUIntLE(position, 3)</code> doesn&#39;t &quot;read a byte&quot;, it reads <i>3</i> bytes at <code>position</code> in the buffer and converts those bytes to an unsigned 24-bit integer (little endian)."}, {"owner": {"reputation": 85, "user_id": 3125559, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9703d3d2eea00a8ee895679452feeead?s=128&d=identicon&r=PG&f=1", "display_name": "user3125559", "link": "https://stackoverflow.com/users/3125559/user3125559"}, "reply_to_user": {"reputation": 92373, "user_id": 2050455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b1255d2cb06adc4d0b48adf1d90e847?s=128&d=identicon&r=PG", "display_name": "mscdex", "link": "https://stackoverflow.com/users/2050455/mscdex"}, "edited": false, "score": 0, "creation_date": 1431271733, "post_id": 30152150, "comment_id": 48413608, "body": "@mscdex Thanks, I updated the question."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1431305761, "last_edit_date": 1431305761, "creation_date": 1431273298, "answer_id": 30153431, "question_id": 30152150, "link": "https://stackoverflow.com/questions/30152150/equivalent-of-readuintle-in-golang/30153431#30153431", "title": "Equivalent of readUIntLE in Golang?", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc readUIntLE(buf []byte, offset, byteLength int) uint64 {\n    var n uint64\n    buf = buf[offset : offset+byteLength]\n    if len(buf) &gt; 8 {\n        buf = buf[:8]\n    }\n    for i, b := range buf {\n        n += uint64(b) &lt;&lt; uint(8*i)\n    }\n    return n\n}\n\nfunc main() {\n    buf := []byte{2, 4, 8, 16, 32, 64, 128, 255}\n    fmt.Println(buf)\n    fmt.Println(readUIntLE(buf, 0, 4))\n    fmt.Println(readUIntLE(buf, 0, len(buf)))\n    fmt.Println(readUIntLE(buf, len(buf)-1, 1))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[2 4 8 16 32 64 128 255]\n268960770\n18410785783142679554\n255\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 3125559, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9703d3d2eea00a8ee895679452feeead?s=128&d=identicon&r=PG&f=1", "display_name": "user3125559", "link": "https://stackoverflow.com/users/3125559/user3125559"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 3, "accepted_answer_id": 30153431, "answer_count": 1, "score": 0, "last_activity_date": 1431305761, "creation_date": 1431265482, "last_edit_date": 1431271708, "question_id": 30152150, "link": "https://stackoverflow.com/questions/30152150/equivalent-of-readuintle-in-golang", "title": "Equivalent of readUIntLE in Golang?", "body": "<p>I need to read X (for example, 3) bytes at position Y in the buffer.</p>\n\n<p>In Node.js, I'm doing this by using the Buffer class and the readUIntLE function.</p>\n\n<p>For example: <code>readUIntLE(position, 3)</code>.</p>\n\n<p>What is the equivalent of that process in Golang?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["json", "encoding", "struct", "go", "go-gorm"], "comments": [{"owner": {"reputation": 1822, "user_id": 1401580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fad5da1145825d03c88a47b02995e6?s=128&d=identicon&r=PG", "display_name": "Alfred Rossi", "link": "https://stackoverflow.com/users/1401580/alfred-rossi"}, "edited": false, "score": 0, "creation_date": 1431536193, "post_id": 30151645, "comment_id": 48545823, "body": "Case matters. You need to set the DeletedAt bool to serialize as `json:&quot;DeletedAt,omitempty&quot;. Captial D to clobber &quot;DeletedAt&quot; in the result."}], "answers": [{"comments": [{"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1431535056, "post_id": 30151862, "comment_id": 48545146, "body": "Using the shadowing approach worked great if you have just one parent struct but in my case I have a grandparent-struct (gorm.Model) which can&#39;t be shadowed. <a href=\"https://play.golang.org/p/WQxbLSUX4R\" rel=\"nofollow noreferrer\">Look here</a>."}, {"owner": {"reputation": 1822, "user_id": 1401580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fad5da1145825d03c88a47b02995e6?s=128&d=identicon&r=PG", "display_name": "Alfred Rossi", "link": "https://stackoverflow.com/users/1401580/alfred-rossi"}, "reply_to_user": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1431535250, "post_id": 30151862, "comment_id": 48545262, "body": "Shadowing works fine, the problem is that the Json key is set to deletedAt and you are shadowing deleted_at"}, {"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1431536319, "post_id": 30151862, "comment_id": 48545897, "body": "My fault. Thanks again Mr. Rossi."}], "tags": [], "owner": {"reputation": 1822, "user_id": 1401580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fad5da1145825d03c88a47b02995e6?s=128&d=identicon&r=PG", "display_name": "Alfred Rossi", "link": "https://stackoverflow.com/users/1401580/alfred-rossi"}, "is_accepted": true, "score": 2, "last_activity_date": 1431542391, "last_edit_date": 1431542391, "creation_date": 1431263744, "answer_id": 30151862, "question_id": 30151645, "link": "https://stackoverflow.com/questions/30151645/set-tags-for-imported-struct-in-go/30151862#30151862", "title": "Set tags for imported struct in Go", "body": "<p>You can just shadow the field with a bool set to false and tag it with <code>omitempty</code></p>\n\n<p>For example</p>\n\n<pre><code>type User struct {\n    Username  string `json:\"username\"`\n    DeletedAt int    `json:\"deleted_at\"`\n}\n\ntype PublicUser struct {\n    *User\n    DeletedAt bool `json:\"deleted_at,omitempty\"`\n}\n</code></pre>\n\n<p>Feel free to play with it <a href=\"http://play.golang.org/p/vJoCAoMm4v\" rel=\"nofollow\">here</a>. Also see <a href=\"http://attilaolah.eu/2014/09/10/json-and-struct-composition-in-go/\" rel=\"nofollow\">this blog post</a> of Attila Ol\u00e1h.</p>\n"}], "owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1329, "favorite_count": 0, "accepted_answer_id": 30151862, "answer_count": 1, "score": 3, "last_activity_date": 1431542391, "creation_date": 1431262293, "last_edit_date": 1431534948, "question_id": 30151645, "link": "https://stackoverflow.com/questions/30151645/set-tags-for-imported-struct-in-go", "title": "Set tags for imported struct in Go", "body": "<p>I'm using <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow\">gorm</a> (<strong>g</strong>o <strong>orm</strong>) to retrieve data from my database that will be encoded in JSON. Gorm provides a default struct for primary keys and time tracking, whose DeletedAt attribute should not be encoded in JSON. </p>\n\n<p>I've written a small example, that <strong>doesn't</strong> output the password but the DeletedAt attribute is still visible.</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/lib/pq\"\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\n// Struct from the gorm package:\n//\n// type Model struct {\n//     ID        uint `gorm:\"primary_key\"`\n//     CreatedAt time.Time\n//     UpdatedAt time.Time\n//     DeletedAt *time.Time\n// }\n\n// Defines the database model for gorn\ntype User struct {\n    gorm.Model\n    Username string `json:\"username\" sql:\"size:32; not null; unique\"`\n    Password string `json:\"password\" sql:\"not null\"`\n    Locale   string `json:\"locale\"   sql:\"not null\"`\n}\n\n// Public JSON version of database model\ntype PublicUser struct {\n    *User\n    DeletedAt bool `json:\"deletedAt,omitempty\"`\n    Password  bool `json:\"password,omitempty\"`\n}\n\nfunc main() {\n    db, err := gorm.Open(\"sqlite3\", \"storage.db\")\n\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    u := &amp;User{}\n    db.Where(\"id = ?\", 3).Find(&amp;u)\n\n    json.NewEncoder(os.Stdout).Encode(PublicUser{\n        User: u,\n    })\n}\n</code></pre>\n\n<p>This is the ourput I get if I run my script:</p>\n\n<pre><code>{\n    \"ID\":3,\n    \"CreatedAt\":\"2015-05-13T14:54:23.5577227Z\",\n    \"UpdatedAt\":\"2015-05-13T14:54:23.5577227Z\",\n    \"DeletedAt\":null,\n    \"username\":\"dan\",\n    \"locale\":\"en_US\"\n}\n</code></pre>\n\n<p>I modified the <a href=\"https://play.golang.org/p/WQxbLSUX4R\" rel=\"nofollow\">example</a> of Alfred Rossi to imitate the behavior and I got the same result.</p>\n"}, {"tags": ["json", "go", "redis", "redigo"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "edited": false, "score": 0, "creation_date": 1431345890, "post_id": 30150479, "comment_id": 48440597, "body": "<code>json:&quot;a&quot;</code> etc tags were my cut&amp;paste bad, they are/were actually <code>redis:&quot;a&quot;</code> etc.   I&#39;m intrigued by your suggestion to &quot;wrap this whole model thing in a struct that does all that logic behind the scene while deserializing from redigo&quot; since that&#39;s excatly what I was trying to do, without success.   In other words, as you suggest I think, I wanted to go from      <code>{&quot;a&quot;:&quot;{&#39;x&#39;:&#39;t1&#39;, &#39;y&#39;:&#39;t2&#39;, &#39;z&#39;:&#39;t3&#39;}&quot;}</code>  being one big string to     a.x, a.y, a.z  as addressable parts through the struct in one go.   I just don&#39;t know how. Any tips would be appreciated. Thanks."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "edited": false, "score": 0, "creation_date": 1431346554, "post_id": 30150479, "comment_id": 48441036, "body": "@parens I made a pull request to redigo that enables what you want :) <a href=\"https://github.com/garyburd/redigo/issues/123\" rel=\"nofollow noreferrer\">github.com/garyburd/redigo/issues/123</a> you can use my fork if you want"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "edited": false, "score": 0, "creation_date": 1431415536, "post_id": 30150479, "comment_id": 48474143, "body": "@parens feel free to voice your opinion on the github issue ;)"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 2, "last_activity_date": 1431254829, "creation_date": 1431254829, "answer_id": 30150479, "question_id": 30150086, "link": "https://stackoverflow.com/questions/30150086/casting-json-parts-into-go-structs-from-redis-using-redigo/30150479#30150479", "title": "Casting json parts into Go structs from Redis using redigo", "body": "<p>First of all, you should tag your field names with <code>redis</code> and not <code>json</code> tags, that's what redigo uses for ScanStruct(). e.g</p>\n\n<pre><code>type Model struct {\n    A string `redis:\"a\"`\n    B string `redis:\"b\"`\n    C string `redis:\"c\"` // Unknown length of map at runtime\n}\n</code></pre>\n\n<p>Second, your members are strings, so you can't have individual member access to their content, and I don't think you can automate it with redigo.  </p>\n\n<p>You can, as workaround have some type that extends string, and has an access method that lazily parses the json into an underlying dict and then returns the value. Something like this (writing without testing, just the general idea, I'm not sure it will work but it's worth a try):</p>\n\n<pre><code>type MyString string\n\nfunc (s MyString)Get(key string) (interface{}, error) {\n   var m map[string]interface{}\n\n   if err := json.Unmarshal([]byte(s), &amp;m); err != nil {\n       return nil, err\n   } \n\n   return m[key], nil\n\n}\n</code></pre>\n\n<p>It's also not very efficient as it will parse the json again each time. \nPersonally I'd wrap this whole model thing in a struct that does all that logic behind the scene while deserializing from redigo. </p>\n"}, {"tags": [], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "is_accepted": false, "score": 0, "last_activity_date": 1488547248, "creation_date": 1488547248, "answer_id": 42580006, "question_id": 30150086, "link": "https://stackoverflow.com/questions/30150086/casting-json-parts-into-go-structs-from-redis-using-redigo/42580006#42580006", "title": "Casting json parts into Go structs from Redis using redigo", "body": "<pre><code>type Model struct {\n    A string `redis:\"a\" json:\"a\"`\n    B string `redis:\"b\" json:\"b\"`\n    C string `redis:\"c\" json:\"c\"`\n}\n</code></pre>\n\n<p>You can use <code>redis</code> tags with <code>json</code> tags at the  sametime.\n<br> ScanStruct should work fine, it uses <code>redis</code> tags.<br></p>\n\n<pre><code>m := Model\nv, err := redis.Values(c.Do(\"HGETALL\", key))\nerr = redis.ScanStruct(v, &amp;m)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "is_accepted": false, "score": 1, "last_activity_date": 1526649565, "creation_date": 1526649565, "answer_id": 50412260, "question_id": 30150086, "link": "https://stackoverflow.com/questions/30150086/casting-json-parts-into-go-structs-from-redis-using-redigo/50412260#50412260", "title": "Casting json parts into Go structs from Redis using redigo", "body": "<p>Check out the <a href=\"https://github.com/RedisLabsModules/rejson\" rel=\"nofollow noreferrer\">ReJSON</a> module from RedisLabs. </p>\n\n<p>I created a simple go-client for it <a href=\"https://github.com/nitishm/go-rejson\" rel=\"nofollow noreferrer\">here</a> that works with Redigo.</p>\n\n<pre><code>type Model struct {\n    A string `redis:\"a\" json:\"a\"`\n    B string `redis:\"b\" json:\"b\"`\n    C string `redis:\"c\" json:\"c\"`\n}\n</code></pre>\n\n<p>To read it back use the <code>JSON.GET</code> command, </p>\n\n<pre><code>v, err := redis.Bytes(rejson.JSONGet(conn, \"id:123\", \"\"))\nif err != nil {\n    return\n}\n\nm := new(Model)\nerr = json.Unmarshal(v, m)\nif err != nil {\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 3691075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c51d7ab1d6c5ab5ca3a6d1431b48a7b8?s=128&d=identicon&r=PG&f=1", "display_name": "parens", "link": "https://stackoverflow.com/users/3691075/parens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5138, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1526649565, "creation_date": 1431252322, "question_id": 30150086, "link": "https://stackoverflow.com/questions/30150086/casting-json-parts-into-go-structs-from-redis-using-redigo", "title": "Casting json parts into Go structs from Redis using redigo", "body": "<p>I have a json that is POSTed by a browser. It's a hash with </p>\n\n<pre><code>var id int64 = 123 \n</code></pre>\n\n<p>and, say, three fields like so:</p>\n\n<pre><code>myJson := `{ \n    \"a\":\"{'x1':'apple','x2':'orange'}\", \n    \"b\":\"{'y1':345678,'y2':32456}\", \n    \"c\":\"['alpha@example1.com', 'beta@example2.com']\"}`\n</code></pre>\n\n<p>It's then stored in Redis using <strong><a href=\"https://godoc.org/github.com/garyburd/redigo/redis\" rel=\"nofollow\">redigo</a></strong> with command: </p>\n\n<pre><code>HMSET id:123 a \"{'x1':'apple','x2':'orange'}\" b \"{'y1':345678,'y2':32456}\" c \"['alpha@example1.com', 'beta@example2.com']\"\n</code></pre>\n\n<p>Now, I'd like to use a model like this in Go</p>\n\n<pre><code>type Model struct {\n    A string `json:\"a\"`\n    B string `json:\"b\"`\n    C string `json:\"c\"` // Unknown length of map at runtime\n}\n</code></pre>\n\n<p><strong>1.</strong> I call Redis with</p>\n\n<pre><code>v, _ := redis.Values(c.Do(\"HGETALL\", \"id:123\"))\n</code></pre>\n\n<p>I see correctly stored values via redis-cli, but converting the <strong>v</strong> reply into the <strong>Model</strong> struct doesn't work:</p>\n\n<pre><code>var model Model\nif err := redis.ScanStruct(v, &amp;model); err != nil {\n    panic(err)\n}\nfmt.Printf(\"c %#v\\n\", model.C) =&gt; empty []\n</code></pre>\n\n<p>I'd like to access individual k:v pairs like: </p>\n\n<pre><code>B.y2 = 32456\nC[0] = \"alpha@example1.com\"\n</code></pre>\n\n<p><strong>2.</strong> I'd also like to json.Marshal <strong>myJson</strong> back to the browser as combinations of {a}, {a,b}, {a,c}, {a,b,c}, etc. I'm not sure how to combine various a,b,c field combos into one to be Marshalled. </p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["assembly", "go"], "answers": [{"comments": [{"owner": {"reputation": 18225, "user_id": 152580, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34b114b30616ba935061582133cceeb8?s=128&d=identicon&r=PG", "display_name": "Eloff", "link": "https://stackoverflow.com/users/152580/eloff"}, "edited": false, "score": 0, "creation_date": 1431271829, "post_id": 30146643, "comment_id": 48413640, "body": "The same suffixes are used, with the same meanings, for SETxx and CMOVxx as well."}], "tags": [], "owner": {"reputation": 18225, "user_id": 152580, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34b114b30616ba935061582133cceeb8?s=128&d=identicon&r=PG", "display_name": "Eloff", "link": "https://stackoverflow.com/users/152580/eloff"}, "is_accepted": true, "score": 9, "last_activity_date": 1431219960, "creation_date": 1431219960, "answer_id": 30146643, "question_id": 30146642, "link": "https://stackoverflow.com/questions/30146642/what-are-the-conditional-jump-instructions-for-gos-assembler/30146643#30146643", "title": "What are the conditional jump instructions for Go&#39;s assembler?", "body": "<p>I'm answering this so I don't lose the information, and so other people don't have to go through the same sleuthing game as me. Looking at <a href=\"https://code.google.com/p/go/source/browse/src/cmd/8l/optab.c?spec=svn40dd722155f6d0c83fa572c1a5abf7c6ff35049f&amp;r=0c67faa66be793b487192717a827c5412dd794bf\" rel=\"noreferrer\">optab.c</a> and the <a href=\"http://www.unixwiz.net/techtips/x86-jumps.html\" rel=\"noreferrer\">x86 jumps</a> we can match up the instruction encodings to solve the puzzle.</p>\n\n<pre><code>JCC     JAE\nJCS     JB\nJCXZL   JECXZ\nJEQ     JE,JZ\nJGE     JGE\nJGT     JG\nJHI     JA\nJLE     JLE\nJLS     JBE\nJLT     JL\nJMI     JS\nJNE     JNE, JNZ\nJOC     JNO\nJOS     JO\nJPC     JNP, JPO\nJPL     JNS\nJPS     JP, JPE\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5916563, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/cbe9a55ddbe1853d03c62b043186596c?s=128&d=identicon&r=PG", "display_name": "Nigel Tao", "link": "https://stackoverflow.com/users/5916563/nigel-tao"}, "is_accepted": false, "score": 1, "last_activity_date": 1455245651, "creation_date": 1455245651, "answer_id": 35354029, "question_id": 30146642, "link": "https://stackoverflow.com/questions/30146642/what-are-the-conditional-jump-instructions-for-gos-assembler/35354029#35354029", "title": "What are the conditional jump instructions for Go&#39;s assembler?", "body": "<p>The Go assembler's <a href=\"https://go.googlesource.com/go/+/master/src/cmd/asm/internal/arch/arch.go#115\" rel=\"nofollow\">arch.go</a> says:</p>\n\n<pre><code>instructions[\"JA\"]  = x86.AJHI\ninstructions[\"JAE\"] = x86.AJCC\ninstructions[\"JB\"]  = x86.AJCS\netc\n</code></pre>\n\n<p>which means that Go asm's JHI means Intel asm's JA, etc.</p>\n"}], "owner": {"reputation": 18225, "user_id": 152580, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34b114b30616ba935061582133cceeb8?s=128&d=identicon&r=PG", "display_name": "Eloff", "link": "https://stackoverflow.com/users/152580/eloff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1616, "favorite_count": 2, "accepted_answer_id": 30146643, "answer_count": 2, "score": 5, "last_activity_date": 1455245651, "creation_date": 1431219960, "last_edit_date": 1431368151, "question_id": 30146642, "link": "https://stackoverflow.com/questions/30146642/what-are-the-conditional-jump-instructions-for-gos-assembler", "title": "What are the conditional jump instructions for Go&#39;s assembler?", "body": "<p>Go's 6a assembler has conditional jump instructions:</p>\n\n<pre><code>JCC\nJCS\nJCXZL\nJEQ\nJGE\nJGT\nJHI\nJLE\nJLS\nJLT\nJMI\nJNE\nJOC\nJOS\nJPC\nJPL\nJPS\n</code></pre>\n\n<p>But how do they map to x86 conditional jumps?</p>\n"}, {"tags": ["winapi", "go"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 2, "last_activity_date": 1431203780, "last_edit_date": 1431203780, "creation_date": 1431203568, "answer_id": 30144726, "question_id": 30144654, "link": "https://stackoverflow.com/questions/30144654/winapi-getsystemtimes-function-does-not-fill-lpidletime-lpkerneltime-lpusertime/30144726#30144726", "title": "winapi GetSystemTimes function does not fill lpIdleTime/lpKernelTime/lpUserTime", "body": "<p>You're passing the address of nil fields to the function.</p>\n\n<p>Either make it point directly to the <code>Filetime</code> struct or initialize all 3 fields before passing them:</p>\n\n<pre><code>type SystemTimes struct {\n    IdleTime   syscall.Filetime\n    KernelTime syscall.Filetime\n    UserTime   syscall.Filetime\n}\n.....\nres, _, err1 := procGetSystemTimes.Call(uintptr(unsafe.Pointer(&amp;times.IdleTime)), uintptr(unsafe.Pointer(&amp;times.KernelTime)), uintptr(unsafe.Pointer(&amp;times.UserTime)))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u250c\u2500 oneofone@Oa [/tmp]                                                                                                             \n\u2514\u2500\u2500\u279c env CC=i686-w64-mingw32-gcc CGO_ENABLED=1 GOOS=windows GOARCH=386 go build -a /tmp/syscall.go; and wine syscall.exe\n2015/05/09 22:31:53 idle={1292275456 39}, kernel={1436840864 41}, user={3496565408 2}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/GdtWP_SgY2\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 25, "user_id": 807973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c05cd26b4d5d2de73bcbcd8e14096ccc?s=128&d=identicon&r=PG", "display_name": "DeusModus", "link": "https://stackoverflow.com/users/807973/deusmodus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 30144726, "answer_count": 1, "score": 1, "last_activity_date": 1431203780, "creation_date": 1431203121, "question_id": 30144654, "link": "https://stackoverflow.com/questions/30144654/winapi-getsystemtimes-function-does-not-fill-lpidletime-lpkerneltime-lpusertime", "title": "winapi GetSystemTimes function does not fill lpIdleTime/lpKernelTime/lpUserTime", "body": "<p>I`m stuck with <a href=\"https://msdn.microsoft.com/en-us/library/ms724400%28VS.85%29.aspx\" rel=\"nofollow\">GetSystemTimes</a> function. There is no any problem in c++ code, but with golang I'm getting three nils instead of expected values</p>\n\n<p>My code:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nvar (\n    modKernel32 = syscall.NewLazyDLL(\"kernel32.dll\")\n    procGetSystemTimes = modKernel32.NewProc(\"GetSystemTimes\")\n)\n\ntype SystemTimes struct {\n    IdleTime   *syscall.Filetime\n    KernelTime *syscall.Filetime\n    UserTime   *syscall.Filetime\n}\n\nfunc main() {\n    times, err := getSystemTimes()\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"idle=%v, kernel=%v, user=%v\", times.IdleTime, times.KernelTime, times.UserTime)\n}\n\nfunc getSystemTimes() (times SystemTimes, err error) {\n    res, _, err1 := procGetSystemTimes.Call(uintptr(unsafe.Pointer(times.IdleTime)), uintptr(unsafe.Pointer(times.KernelTime)), uintptr(unsafe.Pointer(times.UserTime)))\n    if res != 1 {\n        return times, err1\n    }\n    return\n}\n</code></pre>\n\n<p>It's super simple and very similar to syscall`s GetProcessTimes function from stdlib.\nAnd look, what my program prints:</p>\n\n<pre><code>idle=&lt;nil&gt;, kernel=&lt;nil&gt;, user=&lt;nil&gt;\n</code></pre>\n\n<p>Why? I expect error or result, why my fields are empty?</p>\n\n<p>Confguration: win8 x64, go1.4.2 windows/amd64</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 5361, "user_id": 2112028, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/6c9ad74e5d192e2207eb5008e6af8224?s=128&d=identicon&r=PG", "display_name": "Alec Teal", "link": "https://stackoverflow.com/users/2112028/alec-teal"}, "edited": false, "score": 2, "creation_date": 1431270834, "post_id": 30144524, "comment_id": 48413303, "body": "Whose upvoting this? Fess up! There is no behaviour I can think of that is sensible where this doesn&#39;t mean &quot;literal dash&quot; - Does the OP have any hypothesis at all?"}], "answers": [{"comments": [{"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 3, "creation_date": 1431234717, "post_id": 30144558, "comment_id": 48403800, "body": "In normal POSIX 1003.2 regular expressions a dash is included in a bracket expression by making it the first or last character, or the second endpoint of a range.  Also <b>most importantly</b> the &#39;\\&#39; character loses all special meaning in a bracket expression!"}, {"owner": {"reputation": 68253, "user_id": 20938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuXSm.jpg?s=128&g=1", "display_name": "Alan Moore", "link": "https://stackoverflow.com/users/20938/alan-moore"}, "reply_to_user": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 3, "creation_date": 1431260685, "post_id": 30144558, "comment_id": 48410026, "body": "@GregA.Woods: A quick look at the docs tells me Go uses Perl syntax, probably by way of the PCRE library.  If this regex is being used in Go as the tags imply, the backslash will <i>always</i> be treated as an escape character."}, {"owner": {"reputation": 52749, "user_id": 1400768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tM0N8.png?s=128&g=1", "display_name": "nhahtdh", "link": "https://stackoverflow.com/users/1400768/nhahtdh"}, "reply_to_user": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431266257, "post_id": 30144558, "comment_id": 48411791, "body": "@GregA.Woods: POSIX standard is irrelevant to the discussion here. Go implements its own syntax anyway."}, {"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 1, "creation_date": 1431270952, "post_id": 30144558, "comment_id": 48413344, "body": "Stupid question, but how can a dash be &quot;the last character in a range&quot; if you can&#39;t escape anything? I mean, AFAIK a sequence like <code>A-]</code> means &quot;A through ]&quot; rather than &quot;A, dash, end of range&quot;"}, {"owner": {"reputation": 52749, "user_id": 1400768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tM0N8.png?s=128&g=1", "display_name": "nhahtdh", "link": "https://stackoverflow.com/users/1400768/nhahtdh"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1431283487, "post_id": 30144558, "comment_id": 48417644, "body": "@MrLister: In POSIX regex, <code>]</code> always terminates the character class, unless it is the first in the character class (possibly after negation <code>^</code>). You can include <code>]</code> inside a collating element <code>[.].]</code> to make it a valid end point of a range. Anyway, it is POSIX regex and not related to the subject matter in this question/answer."}, {"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "reply_to_user": {"reputation": 52749, "user_id": 1400768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tM0N8.png?s=128&g=1", "display_name": "nhahtdh", "link": "https://stackoverflow.com/users/1400768/nhahtdh"}, "edited": false, "score": 1, "creation_date": 1431283899, "post_id": 30144558, "comment_id": 48417794, "body": "@nhahtdh I hate all these different regex syntaxes. I yearn for the simple days when there was only GREP. Oh, and EGREP."}, {"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 1, "creation_date": 1431283954, "post_id": 30144558, "comment_id": 48417818, "body": "Go&#39;s native <code>regexp</code> package actually uses Russ Cox&#39;s RE2 library (I.e. most definitely_not_ PCRE, though it implements a regular expression syntax with features that are <i>somewhat</i> compatible with PCRE).  RE2 also has a POSIX mode (accessable from Go) which is not quite POSIX-compliant.  So, @ireardon, what regular expression package is imported and what compile call is used in the code you&#39;re working with?"}, {"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431285095, "post_id": 30144558, "comment_id": 48418219, "body": "BTW, what I meant by referring to POSIX is that in this answer the appearance of the &#39;\\&#39; is entirely unnecessary and potentially confusing."}, {"owner": {"reputation": 52749, "user_id": 1400768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tM0N8.png?s=128&g=1", "display_name": "nhahtdh", "link": "https://stackoverflow.com/users/1400768/nhahtdh"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1431287194, "post_id": 30144558, "comment_id": 48418969, "body": "@MrLister: You are contradicting yourself, since grep and egrep uses POSIX regex."}], "tags": [], "owner": {"reputation": 44734, "user_id": 964243, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/fL1rH.png?s=128&g=1", "display_name": "Boann", "link": "https://stackoverflow.com/users/964243/boann"}, "is_accepted": true, "score": 52, "last_activity_date": 1431202555, "creation_date": 1431202555, "answer_id": 30144558, "question_id": 30144524, "link": "https://stackoverflow.com/questions/30144524/what-does-a-z-a-z-mean-in-a-regular-expression/30144558#30144558", "title": "What does a-z-A-Z mean in a regular expression?", "body": "<p>A dash in a character class in a place where it cannot be interpreted as a range is interpreted as a literal dash. So the expression excludes the characters <code>0</code> to <code>9</code>, <code>a</code> to <code>z</code>, <code>A</code> to <code>Z</code>, and <code>-</code>. That's why there's no syntax error.</p>\n\n<p>It's probably a typo though. If the dash is meant to be there, then to prevent confusion it should be escaped and/or moved out from between the ranges, such as <code>[^0-9a-zA-Z\\-]</code></p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 6, "creation_date": 1431209293, "post_id": 30144561, "comment_id": 48399449, "body": "From that page: &quot;RegExr uses your browser&#39;s RegExp engine for matching, and its syntax highlighting and documentation reflect the Javascript RegExp standard.&quot; So the syntax likely differs from that support by <a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow noreferrer\">Go&#39;s RE2</a>."}, {"owner": {"reputation": 6485, "user_id": 321301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FnFvK.jpg?s=128&g=1", "display_name": "Austin Adams", "link": "https://stackoverflow.com/users/321301/austin-adams"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1431225747, "post_id": 30144561, "comment_id": 48402511, "body": "@DaveC you&#39;re right, but not really in the context of this question IMO. In my experience, basic regex syntax (like OP&#39;s <code>[^0-9a-z-A-Z]</code>) don&#39;t differ much between different engines. For instance, I&#39;d bet that in most browsers, <a href=\"http://regexr.com/3avj4\" rel=\"nofollow noreferrer\">regexr.com/3avj4</a> will give the same result as <a href=\"http://play.golang.org/p/ozmtbUHH7C\" rel=\"nofollow noreferrer\">play.golang.org/p/ozmtbUHH7C</a>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431229518, "post_id": 30144561, "comment_id": 48403048, "body": "It doesn&#39;t relate to the syntax used in this question, but I just wanted to make it clear that that website (and many others like it) do not exactly match RE2&#39;s syntax and in general you cannot cut-n-paste between Go and such a site. I&#39;ve seen a number of regex questions where apparently the questioner was unaware of syntax differences."}], "tags": [], "owner": {"reputation": 501, "user_id": 2738148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22ee18a28885cf8d73eaef501e0a2e95?s=128&d=identicon&r=PG&f=1", "display_name": "Atuos", "link": "https://stackoverflow.com/users/2738148/atuos"}, "is_accepted": false, "score": 0, "last_activity_date": 1431202575, "creation_date": 1431202575, "answer_id": 30144561, "question_id": 30144524, "link": "https://stackoverflow.com/questions/30144524/what-does-a-z-a-z-mean-in-a-regular-expression/30144561#30144561", "title": "What does a-z-A-Z mean in a regular expression?", "body": "<p>It excludes the minus sign.</p>\n\n<p>You can test regex handily here: <a href=\"http://www.regexr.com/\" rel=\"nofollow\">http://www.regexr.com/</a></p>\n"}], "owner": {"reputation": 382, "user_id": 2038041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0itVU.jpg?s=128&g=1", "display_name": "ireardon", "link": "https://stackoverflow.com/users/2038041/ireardon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2261, "favorite_count": 2, "accepted_answer_id": 30144558, "answer_count": 2, "score": 31, "last_activity_date": 1431245035, "creation_date": 1431202331, "last_edit_date": 1431245035, "question_id": 30144524, "link": "https://stackoverflow.com/questions/30144524/what-does-a-z-a-z-mean-in-a-regular-expression", "title": "What does a-z-A-Z mean in a regular expression?", "body": "<p>I've been working with someone else's code and I ran across the regular expression <code>[^0-9a-z-A-Z]</code>. This bears close resemblance to the common <code>[^0-9a-zA-Z]</code> which is meant to exclude non-alphanumeric characters, but note the extra dash in the middle, between the lowercase <code>z</code> and uppercase <code>A</code>.</p>\n\n<p>I'm not very familiar with regular expressions, but I've read several pages on them now, and none of the rules I've seen seem to cover what this syntax would mean. Perhaps it's not even valid syntax, but the Golang regex interpreter doesn't seem to mind. I'd appreciate any clarification. Thanks.</p>\n"}, {"tags": ["file", "sorting", "for-loop", "go"], "answers": [{"comments": [{"owner": {"reputation": 3225, "user_id": 1015599, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/aec35bc008f9400081836d873bcac22f?s=128&d=identicon&r=PG", "display_name": "q3d", "link": "https://stackoverflow.com/users/1015599/q3d"}, "edited": false, "score": 1, "creation_date": 1431189218, "post_id": 30142239, "comment_id": 48393347, "body": "I had this idea not long after I posted my question; I ended up writing it differently - but thanks very much for helping. I&#39;ve accepted your answer because it would have given me what I wanted if I had used it."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1431191017, "post_id": 30142239, "comment_id": 48393965, "body": "@BenCampbell, You&#39;ve added a syntax error with your last edit."}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431207337, "post_id": 30142239, "comment_id": 48398919, "body": "@DaveC Thanks! It&#39;s always risky writing code live."}], "tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": true, "score": 9, "last_activity_date": 1431207237, "last_edit_date": 1431207237, "creation_date": 1431187975, "answer_id": 30142239, "question_id": 30141956, "link": "https://stackoverflow.com/questions/30141956/sorting-files-in-numerical-order-in-go/30142239#30142239", "title": "Sorting files in numerical order in Go", "body": "<p>Could you implement the <a href=\"http://golang.org/pkg/sort/\" rel=\"noreferrer\">sort</a> interface and order based on your requirements? Given the slice of returned os.FileInfo elements you can arrange them using an numerical order instead of lexicographical order.</p>\n\n<pre><code>type ByNumericalFilename []os.FileInfo\n\nfunc (nf ByNumericalFilename) Len() int      { return len(nf) }\nfunc (nf ByNumericalFilename) Swap(i, j int) { nf[i], nf[j] = nf[j], nf[i] }\nfunc (nf ByNumericalFilename) Less(i, j int) bool {\n\n    // Use path names\n    pathA := nf[i].Name()\n    pathB := nf[j].Name()\n\n    // Grab integer value of each filename by parsing the string and slicing off\n    // the extension\n    a, err1 := strconv.ParseInt(pathA[0:strings.LastIndex(pathA, \".\")], 10, 64)\n    b, err2 := strconv.ParseInt(pathB[0:strings.LastIndex(pathB, \".\")], 10, 64)\n\n    // If any were not numbers sort lexographically\n    if err1 != nil || err2 != nil {\n        return pathA &lt; pathB\n    }\n\n    // Which integer is smaller?\n    return a &lt; b\n}\n\nfiles, _ := ioutil.ReadDir(\".\")\n\nsort.Sort(ByNumericalFilename(files))\n\nfor _, f := range files {\n    fmt.Println(f.Name())\n}\n</code></pre>\n\n<p>I know its not very concise but is a valid answer.</p>\n"}], "owner": {"reputation": 3225, "user_id": 1015599, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/aec35bc008f9400081836d873bcac22f?s=128&d=identicon&r=PG", "display_name": "q3d", "link": "https://stackoverflow.com/users/1015599/q3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2136, "favorite_count": 0, "accepted_answer_id": 30142239, "answer_count": 1, "score": 2, "last_activity_date": 1431207237, "creation_date": 1431186375, "question_id": 30141956, "link": "https://stackoverflow.com/questions/30141956/sorting-files-in-numerical-order-in-go", "title": "Sorting files in numerical order in Go", "body": "<p>I am reading a directory, and with this I've noticed that if I have files which are ordered by number (1, 2, 3, 4...) then it seems to use some alphabetic ordering.</p>\n\n<p>Say that I have 13 files (named 1.md, 2.md, 3.md...), the ordering would look like: 1, 10, 11, 12, 13, 2, 3, 4...; The current code I am using to produce this order is:</p>\n\n<pre><code>files, _ := ioutil.ReadDir(my_dir)\n    for _, f := range files {\n        fmt.Println(f.Name())\n    }\n</code></pre>\n\n<p>The ordering I am looking for is 1, 2, 3, ... 9, 10, 11, 12, 13.</p>\n\n<p>How can I get a strict numerical sorting on these files? Bear in mind that each file is named N.md where N is guaranteed to be an integer greater than or equal to 0.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1431183897, "post_id": 30141392, "comment_id": 48391610, "body": "<a href=\"https://golang.org/pkg/net/http/#Serve\" rel=\"nofollow noreferrer\"><code>net&#47;http.Serve</code></a>: &quot;\u2026 creating a new service goroutine for each.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": true, "score": 3, "last_activity_date": 1431185519, "creation_date": 1431185519, "answer_id": 30141798, "question_id": 30141392, "link": "https://stackoverflow.com/questions/30141392/is-the-http-server-in-the-go-libraries-nonblocking/30141798#30141798", "title": "Is the http server in the go libraries nonblocking?", "body": "<p>The Go http package is concurrent, rather than nonblocking in the node.js sense. This means that the request handlers will not delay the processing of other requests even if they perform blocking operations. As Dave C said, it creates a new goroutine for each request. In practice, this means that you get the benefits of a nonblocking server without needing to worry about whether the code you write is blocking.</p>\n"}], "owner": {"reputation": 8438, "user_id": 675066, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/46d4ff5b7ae7894733f30d34e865de4e?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/675066/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 0, "accepted_answer_id": 30141798, "answer_count": 1, "score": -1, "last_activity_date": 1431185519, "creation_date": 1431183287, "question_id": 30141392, "link": "https://stackoverflow.com/questions/30141392/is-the-http-server-in-the-go-libraries-nonblocking", "title": "Is the http server in the go libraries nonblocking?", "body": "<p>I want a nonblocking http server for restful endpoints for my go project.  Will the server included in the go libs do the trick?</p>\n"}, {"tags": ["sqlite", "go"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4882008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b9ba61c411abf2494d567768a8afbd?s=128&d=identicon&r=PG&f=1", "display_name": "Markh", "link": "https://stackoverflow.com/users/4882008/markh"}, "edited": false, "score": 0, "creation_date": 1431178556, "post_id": 30140347, "comment_id": 48389793, "body": "I updated my question to reflect your answer - it did not resolve the problem for me."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 11, "user_id": 4882008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b9ba61c411abf2494d567768a8afbd?s=128&d=identicon&r=PG&f=1", "display_name": "Markh", "link": "https://stackoverflow.com/users/4882008/markh"}, "edited": false, "score": 0, "creation_date": 1431178849, "post_id": 30140347, "comment_id": 48389892, "body": "when you run this it is printing the WTF line then?"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 2, "last_activity_date": 1431177078, "creation_date": 1431177078, "answer_id": 30140347, "question_id": 30140078, "link": "https://stackoverflow.com/questions/30140078/go-golang-sqlite-query-not-returning-any-rows/30140347#30140347", "title": "Go/golang sqlite query not returning any rows", "body": "<p>when you do:</p>\n\n<pre><code>if rows.Next() == false\n</code></pre>\n\n<p>you are scrolling to the first row</p>\n\n<p>and</p>\n\n<pre><code>for rows.Next()\n</code></pre>\n\n<p>moves to the next row</p>\n\n<p>basically, you are skipping the first row in your result set in the example code you provided.</p>\n\n<p>also, you are ignoring the error in Scan.  </p>\n\n<p>This looks like it would print something if the query returns at least 2 rows (since first row is being skipped)</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4882008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b9ba61c411abf2494d567768a8afbd?s=128&d=identicon&r=PG&f=1", "display_name": "Markh", "link": "https://stackoverflow.com/users/4882008/markh"}, "is_accepted": false, "score": 0, "last_activity_date": 1431253989, "creation_date": 1431253989, "answer_id": 30150349, "question_id": 30140078, "link": "https://stackoverflow.com/questions/30140078/go-golang-sqlite-query-not-returning-any-rows/30150349#30150349", "title": "Go/golang sqlite query not returning any rows", "body": "<p>Ok I figured out what the problem was:</p>\n\n<p>In my query I used: %d as a placeholder for my variable when I should have used $1,$2 etc. Using this the query returns results as expected. </p>\n\n<p>It seems strange to me that this behaviour is allowed returns no error from go or sqlite and even works when you just printout the query and use it with sqlite3 manually. Coming from C and just starting out with go this can obviously be the cause for some headaches.</p>\n"}], "owner": {"reputation": 11, "user_id": 4882008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b9ba61c411abf2494d567768a8afbd?s=128&d=identicon&r=PG&f=1", "display_name": "Markh", "link": "https://stackoverflow.com/users/4882008/markh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2350, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1431253989, "creation_date": 1431175424, "last_edit_date": 1431221940, "question_id": 30140078, "link": "https://stackoverflow.com/questions/30140078/go-golang-sqlite-query-not-returning-any-rows", "title": "Go/golang sqlite query not returning any rows", "body": "<p>I am new to go and trying to retrieve data from a sqlite database. \nIm using github.com/mattn/go-sqlite3 as sqlite driver.</p>\n\n<p>The query I m sending does not return any results even though it should. I tried the query my programme is generating manually and it returns data as it should when I use the query manually as well as when I send it via my programme.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>for index := range Array {\n\nid, _ := strconv.Atoi(Array[index])\n\n\nrand.Seed(time.Now().UnixNano())\nRandomNr := rand.Intn(100)\nfmt.Printf(\"index: %d - randomnr: %d  \\n\", id, RandomNr)\n\n\n\n\n\nrows, errROW := db.Query(\"SELECT user.id,user.name,stage.link,player.url,player.characterchance,player.chance FROM user,stage,player WHERE user.id = '%d' AND '%d' &lt;= user.chance AND stage.user = user.id AND stage.domain = player.id AND player.chance &gt; 0 ORDER BY player.id ASC \\n\",id, RandomNr)//.Scan(&amp;idr, &amp;name, &amp;link, &amp;url, &amp;characterchance, &amp;chance)\n\n\n\n//this is what the finished query looks like and it returns the rows as its supposed to \n//rows, errROW := db.Query(\"SELECT user.id,user.name,stage.link,player.url,player.characterchance,player.chance FROM user,stage,player WHERE user.id = '203' AND '33' &lt;= user.chance AND stage.user = user.id AND stage.domain = player.id AND player.chance &gt; 0 ORDER BY player.id ASC\")\n\nif errROW != nil {\n    fmt.Println(\"errROW\")\n    log.Println(errROW)\n\n}\ndefer rows.Close()\nif rows.Next() == false {\n\n    fmt.Println(\"no rows \")\n\n}\nfor rows.Next() {\n    fmt.Println(\"where are the rows\")\n    var id int\n    var name string\n    var link string\n    var url string\n    var characterchance int\n    var chance int\n\n    rows.Scan(&amp;id, &amp;name, &amp;link, &amp;url, &amp;characterchance, &amp;chance)\n    fmt.Println(id,name,link,url,characterchance,chance)\n\n\n}\nrows.Close()\n\n}\n\n}\n</code></pre>\n\n<p>This query can return multiple and single rows. I also tried retrieving the data via QueryRow as a single row which also did not return any result.</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p>UPDATE:\nI added\n    if rows.Next() == false </p>\n\n<p>as an attempt to find the problem. Removing it yields the same result. Furthermore I do not get an error message from scan. The for rows.next() loop does not even get executed.</p>\n"}, {"tags": ["concurrency", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 7, "creation_date": 1431170924, "post_id": 30139279, "comment_id": 48387574, "body": "You&#39;re making a copy of your <code>WaitGroup</code>; you should be passing <code>download_file</code> a pointer to it."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1431173527, "post_id": 30139279, "comment_id": 48388262, "body": "Go has some syntactic sugar to call methods with pointer receivers on non-pointer values but you should really think about what you are passing around and a method call always makes a copy."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 6, "creation_date": 1431174841, "post_id": 30139279, "comment_id": 48388687, "body": "Also, you are ignoring errors. Don&#39;t do that."}], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 951018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rnFgc.jpg?s=128&g=1", "display_name": "grotos", "link": "https://stackoverflow.com/users/951018/grotos"}, "edited": false, "score": 0, "creation_date": 1431233546, "post_id": 30141186, "comment_id": 48403627, "body": "Is there a convention to use camelCase?"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 1, "last_activity_date": 1431182204, "creation_date": 1431182204, "answer_id": 30141186, "question_id": 30139279, "link": "https://stackoverflow.com/questions/30139279/golang-concurrent-download-deadlock/30141186#30141186", "title": "Golang concurrent download deadlock", "body": "<p>As Tim Cooper said you need to pass the <code>WaitGroup</code> as a pointer. If you run the <code>go vet</code> tool on your code it will give you this warning:</p>\n\n<pre><code>$ go vet ex.go\nex.go:12: download_file passes Lock by value: sync.WaitGroup contains sync.Mutex\nexit status 1\n</code></pre>\n\n<p>I recommend using an editor that can do this for you when you save a file. For example <a href=\"https://github.com/joefitzgerald/go-plus\" rel=\"nofollow\">go-plus</a> for Atom.</p>\n\n<p>As for the code I think you should restructure it like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"net/http\"\n    \"os\"\n    \"path/filepath\"\n    \"sync\"\n)\n\nfunc downloadFile(filePath string) error {\n    resp, err := http.Get(filePath)\n    if err != nil {\n        return err\n    }\n    defer resp.Body.Close()\n\n    name := filepath.Base(filePath)\n\n    file, err := os.Create(name)\n    if err != nil {\n        return err\n    }\n    defer file.Close()\n\n    size, err := io.Copy(file, resp.Body)\n    if err != nil {\n        return err\n    }\n    fmt.Println(name, size, resp.Status)\n    return nil\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n\n    fileList := []string{\n        \"http://i.imgur.com/dxGb2uZ.jpg\",\n        \"http://i.imgur.com/RSU6NxX.jpg\",\n        \"http://i.imgur.com/hUWgS2S.jpg\",\n        \"http://i.imgur.com/U8kaix0.jpg\",\n        \"http://i.imgur.com/w3cEYpY.jpg\",\n        \"http://i.imgur.com/ooSCD9T.jpg\"}\n    fmt.Println(\"downloading\", len(fileList), \"files\")\n    for _, url := range fileList {\n        wg.Add(1)\n        go func(url string) {\n            err := downloadFile(url)\n            if err != nil {\n                fmt.Println(\"[error]\", url, err)\n            }\n            wg.Done()\n        }(url)\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>I don't like passing <code>WaitGroup</code>s around and prefer to keep functions simple, blocking and sequential and then stitch together the concurrency at a higher level. This gives you the option of doing it all sequentially without having to change <code>downloadFile</code>.</p>\n\n<p>I also added error handling and fixed names so they are camelCase.</p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1431190113, "creation_date": 1431190113, "answer_id": 30142584, "question_id": 30139279, "link": "https://stackoverflow.com/questions/30139279/golang-concurrent-download-deadlock/30142584#30142584", "title": "Golang concurrent download deadlock", "body": "<p>Adding to Calab's response, there's absolutely nothing wrong with your approach, all you had to do is to pass a pointer to the <code>sync.WaitGroup</code>.</p>\n\n<pre><code>func download_file(file_path string, wg *sync.WaitGroup) {\n    defer wg.Done()\n    ......\n}\n.....\n        go download_file(url, &amp;wg)\n.....\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/4MukvuHm5k\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 393, "user_id": 951018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rnFgc.jpg?s=128&g=1", "display_name": "grotos", "link": "https://stackoverflow.com/users/951018/grotos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 30141186, "answer_count": 2, "score": -1, "last_activity_date": 1431190113, "creation_date": 1431170464, "last_edit_date": 1495542772, "question_id": 30139279, "link": "https://stackoverflow.com/questions/30139279/golang-concurrent-download-deadlock", "title": "Golang concurrent download deadlock", "body": "<p>I want to download files in parallel in go, but my code never exits:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"net/http\"\n    \"os\"\n    \"path/filepath\"\n    \"sync\"\n)\n\nfunc download_file(file_path string, wg sync.WaitGroup) {\n    defer wg.Done()\n    resp, _ := http.Get(file_path)\n    defer resp.Body.Close()\n    filename := filepath.Base(file_path)\n    file, _ := os.Create(filename)\n    defer file.Close()\n\n    size, _ := io.Copy(file, resp.Body)\n    fmt.Println(filename, size, resp.Status)\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n\n    file_list := []string{\n        \"http://i.imgur.com/dxGb2uZ.jpg\",\n        \"http://i.imgur.com/RSU6NxX.jpg\",\n        \"http://i.imgur.com/hUWgS2S.jpg\",\n        \"http://i.imgur.com/U8kaix0.jpg\",\n        \"http://i.imgur.com/w3cEYpY.jpg\",\n        \"http://i.imgur.com/ooSCD9T.jpg\"}\n    fmt.Println(len(file_list))\n    for _, url := range file_list {\n        wg.Add(1)\n        fmt.Println(wg)\n        go download_file(url, wg)\n\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>What's the reason? I've looked here: <a href=\"https://stackoverflow.com/questions/23635070/golang-download-multiple-files-in-parallel-using-goroutines\">Golang download multiple files in parallel using goroutines</a> but I found no solution.\nWhat is the best way to debug such code?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4881800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad032b18cadaca60762f3de4cea1f2ef?s=128&d=identicon&r=PG&f=1", "display_name": "mmburr", "link": "https://stackoverflow.com/users/4881800/mmburr"}, "edited": false, "score": 1, "creation_date": 1431171633, "post_id": 30139371, "comment_id": 48387754, "body": "Nope. After changing it to <code>func (p P) PrintName()</code> rest stays the same."}], "tags": [], "owner": {"reputation": 6258, "user_id": 1527018, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62e4e73fe7386a5e9401f90dc98c7584?s=128&d=identicon&r=PG", "display_name": "mic4ael", "link": "https://stackoverflow.com/users/1527018/mic4ael"}, "is_accepted": false, "score": 0, "last_activity_date": 1431170988, "creation_date": 1431170988, "answer_id": 30139371, "question_id": 30139200, "link": "https://stackoverflow.com/questions/30139200/types-interfaces-and-pointers/30139371#30139371", "title": "Types, interfaces and pointers", "body": "<p>I suppose - bear in mind I am not really proficient in GO - that the main reason for all of your questions is related to the fact that you implemented <code>PrintName</code> in a way that the receiver (implementer) object is a pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1431174408, "creation_date": 1431174408, "answer_id": 30139894, "question_id": 30139200, "link": "https://stackoverflow.com/questions/30139200/types-interfaces-and-pointers/30139894#30139894", "title": "Types, interfaces and pointers", "body": "<p>Assert that <code>*on</code> is of type <code>*P</code>. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Namer interface {\n    PrintName()\n}\n\ntype P struct {\n    Name string\n}\n\nfunc (p *P) PrintName() {\n    fmt.Printf(\"%s\\n\", p.Name)\n}\n\nfunc main() {\n    p := P{Name: \"Name\"}\n\n    var namers []Namer\n    namers = append(namers, &amp;p)\n    fmt.Println(reflect.TypeOf(namers[0]))\n\n    on := &amp;namers[0]\n    fmt.Println(reflect.TypeOf(on))\n    (*on).PrintName()\n    (*on).(*P).Name = \"EEEE\"\n    (*on).PrintName()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre>\n*main.P\n*main.Namer\nName\nEEEE\n</pre>\n"}, {"tags": [], "owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "is_accepted": true, "score": 0, "last_activity_date": 1431174609, "creation_date": 1431174609, "answer_id": 30139934, "question_id": 30139200, "link": "https://stackoverflow.com/questions/30139200/types-interfaces-and-pointers/30139934#30139934", "title": "Types, interfaces and pointers", "body": "<ol>\n<li><p>P doesn't implement interface Namer, only *P does, as PrintName() is defined on *P.</p></li>\n<li><p>As I understand it, TypeOf(namers[0]) is *P because you're inspecting the actual slice element itself, and TypeOf can see inside the interface. With TypeOf(&amp;namers[0]) you're merely taking the address of the first element and inspecting <em>its</em> type (which is, of course, *Namer, as namers is a slice of Namer interface elements), without actually looking \"inside\" the element itself.</p></li>\n<li><p>The last line doesn't print anything, because (**on).Name is not allowed. Change it to (*on).(*P).Name = \"EEEE\" and it works as intended.</p></li>\n</ol>\n"}], "owner": {"reputation": 7, "user_id": 4881800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad032b18cadaca60762f3de4cea1f2ef?s=128&d=identicon&r=PG&f=1", "display_name": "mmburr", "link": "https://stackoverflow.com/users/4881800/mmburr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 30139934, "answer_count": 3, "score": -1, "last_activity_date": 1431174609, "creation_date": 1431169837, "question_id": 30139200, "link": "https://stackoverflow.com/questions/30139200/types-interfaces-and-pointers", "title": "Types, interfaces and pointers", "body": "<p>I have a simple code:</p>\n\n<pre><code>type Namer interface {\n    PrintName()\n}\n\ntype P struct {\n    Name string\n}\n\nfunc (p *P) PrintName() {\n    fmt.Printf(\"%s\\n\", p.Name)\n}\n\nfunc main() {\n    p := P{Name: \"Name\"}\n\n    var namers []Namer\n    namers = append(namers, &amp;p)\n    fmt.Println(reflect.TypeOf(namers[0]))\n\n    on := &amp;namers[0]\n    fmt.Println(reflect.TypeOf(on))\n    (*on).PrintName()\n    (**on).Name = \"EEEE\"\n    (*on).PrintName()\n}\n</code></pre>\n\n<p>and bunch of questions :)</p>\n\n<ol>\n<li>Why I cannot write: append(namers, p)? &amp;p is a pointer to P, array namers is not a array of pointers</li>\n<li>Why TypeOf(namers[0]) is *P and TypeOf(on) is *Namer? It does not make sense, TypeOf(&amp;(*P)) should be **P</li>\n<li>Why the last line print: \"Name\" instead of \"EEE\"?</li>\n</ol>\n\n<p>Thanks for help!</p>\n"}, {"tags": ["encryption", "go", "aes", "encryption-symmetric"], "comments": [{"owner": {"reputation": 14257, "user_id": 820127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f8fffeec4f2ba3e75aebe941e4e5dd?s=128&d=identicon&r=PG", "display_name": "rossum", "link": "https://stackoverflow.com/users/820127/rossum"}, "edited": false, "score": 2, "creation_date": 1431166430, "post_id": 30138477, "comment_id": 48386254, "body": "For authentication try having a look at <a href=\"http://en.wikipedia.org/wiki/Hash-based_message_authentication_code\" rel=\"nofollow noreferrer\">HMAC</a> first,  If that does not suit then possibly an in-line authentication like <a href=\"http://en.wikipedia.org/wiki/Galois/Counter_Mode\" rel=\"nofollow noreferrer\">GCM mode</a> might be better for you."}, {"owner": {"reputation": 63, "user_id": 4881679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de76d8b98989078e6ffed88aaec174fb?s=128&d=identicon&r=PG", "display_name": "M4ng0Squ4sh", "link": "https://stackoverflow.com/users/4881679/m4ng0squ4sh"}, "reply_to_user": {"reputation": 14257, "user_id": 820127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f8fffeec4f2ba3e75aebe941e4e5dd?s=128&d=identicon&r=PG", "display_name": "rossum", "link": "https://stackoverflow.com/users/820127/rossum"}, "edited": false, "score": 0, "creation_date": 1431257394, "post_id": 30138477, "comment_id": 48409097, "body": "Great! That helped me figuring it out. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4881679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de76d8b98989078e6ffed88aaec174fb?s=128&d=identicon&r=PG", "display_name": "M4ng0Squ4sh", "link": "https://stackoverflow.com/users/4881679/m4ng0squ4sh"}, "edited": false, "score": 0, "creation_date": 1431257918, "post_id": 30147087, "comment_id": 48409233, "body": "Great understood it now! Managed to get this working in a small test environment. However Go&#39;s implementation of GCM or CCM are not streamable. If I&#39;ll encrypt a huge file, I would have to load everything into RAM at once... The NaCL port also implements the go crypt AEAD interface. So it&#39;s also not streamable. Any suggestions? ;)"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1431273429, "post_id": 30147087, "comment_id": 48414150, "body": "Take the code and make it streamable. Note that using the plaintext before authentication is dangerous (which is possibly why it isn&#39;t streamable in the first place). Otherwise you can use e.g. CTR and perform a HMAC or CMAC encryption over it <i>and</i> the IV - basically creating your own two pass (two key!) AEAD cipher. Don&#39;t forget to accept good answers."}, {"owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "reply_to_user": {"reputation": 63, "user_id": 4881679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de76d8b98989078e6ffed88aaec174fb?s=128&d=identicon&r=PG", "display_name": "M4ng0Squ4sh", "link": "https://stackoverflow.com/users/4881679/m4ng0squ4sh"}, "edited": false, "score": 0, "creation_date": 1431293674, "post_id": 30147087, "comment_id": 48420841, "body": "@M4ng0Squ4sh break the file up into chunks and encrypt each one. With <code>secretbox</code> there&#39;s an <code>Overhead</code> constant which will tell you how much bigger the encrypted chunk will be than the decrypted chunk. You will have to define a format (like the memberlist example) and don&#39;t reuse nonces. <code>io.Reader</code> should be fairly straightforward... <code>io.Seeker</code> would be harder."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 3, "last_activity_date": 1431224890, "last_edit_date": 1489747555, "creation_date": 1431224890, "answer_id": 30147087, "question_id": 30138477, "link": "https://stackoverflow.com/questions/30138477/golang-aes-streamreader-encryption-example-omits-any-authentication-of-the-enc/30147087#30147087", "title": "Golang AES StreamReader encryption - Example omits any authentication of the encrypted data", "body": "<p>From wikipedia:</p>\n\n<blockquote>\n  <p>The block cipher modes ECB, CBC, OFB, CFB, CTR, and XTS provide confidentiality, but they do not protect against accidental modification or malicious tampering. </p>\n</blockquote>\n\n<p>A good explanation can be found here: <a href=\"https://security.stackexchange.com/a/33576\">https://security.stackexchange.com/a/33576</a>.</p>\n\n<p>Go has support for other modes which do support integrity and authentication checks. As rossum said you can use <a href=\"http://golang.org/pkg/crypto/cipher/#NewGCM\" rel=\"nofollow noreferrer\">GCM</a> or <a href=\"https://godoc.org/bitbucket.org/dchapes/ripple/crypto/ccm\" rel=\"nofollow noreferrer\">CCM</a>. You can find lots of examples on <a href=\"http://godoc.org/crypto/cipher?importers\" rel=\"nofollow noreferrer\">godoc.org</a>. For example HashiCorp's <a href=\"https://github.com/hashicorp/memberlist/blob/master/security.go#L88\" rel=\"nofollow noreferrer\">memberlist library</a>.</p>\n\n<p>Another library worth checking out is the NaCL port in <a href=\"https://godoc.org/golang.org/x/crypto/nacl/secretbox\" rel=\"nofollow noreferrer\">golang.org/x/crypto/nacl</a>:</p>\n\n<pre><code>func Open(out []byte, box []byte, nonce *[24]byte, key *[32]byte) ([]byte, bool)\nfunc Seal(out, message []byte, nonce *[24]byte, key *[32]byte) []byte\n</code></pre>\n\n<p>If you're working with small messages this API will probably be a lot easier to use.</p>\n"}], "owner": {"reputation": 63, "user_id": 4881679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de76d8b98989078e6ffed88aaec174fb?s=128&d=identicon&r=PG", "display_name": "M4ng0Squ4sh", "link": "https://stackoverflow.com/users/4881679/m4ng0squ4sh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3329, "favorite_count": 0, "accepted_answer_id": 30147087, "answer_count": 1, "score": 6, "last_activity_date": 1431224890, "creation_date": 1431165151, "question_id": 30138477, "link": "https://stackoverflow.com/questions/30138477/golang-aes-streamreader-encryption-example-omits-any-authentication-of-the-enc", "title": "Golang AES StreamReader encryption - Example omits any authentication of the encrypted data", "body": "<p>Finally I am posting my first question on StackOverflow. I'm using this site for years now and I always found great answers to all my questions :)</p>\n\n<p>I am implementing a file encryption background daemon which is based on the <a href=\"https://golang.org/src/crypto/cipher/example_test.go\" rel=\"noreferrer\">official Golang cipher example</a>:</p>\n\n<pre><code>func ExampleStreamReader() {\n    key := []byte(\"example key 1234\")\n\n    inFile, err := os.Open(\"encrypted-file\")\n    if err != nil {\n        panic(err)\n    }\n    defer inFile.Close()\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    // If the key is unique for each ciphertext, then it's ok to use a zero\n    // IV.\n    var iv [aes.BlockSize]byte\n    stream := cipher.NewOFB(block, iv[:])\n\n    outFile, err := os.OpenFile(\"decrypted-file\", os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0600)\n    if err != nil {\n        panic(err)\n    }\n    defer outFile.Close()\n\n    reader := &amp;cipher.StreamReader{S: stream, R: inFile}\n    // Copy the input file to the output file, decrypting as we go.\n    if _, err := io.Copy(outFile, reader); err != nil {\n        panic(err)\n    }\n\n    // Note that this example is simplistic in that it omits any\n    // authentication of the encrypted data. If you were actually to use\n    // StreamReader in this manner, an attacker could flip arbitrary bits in\n    // the output.\n}\n\nfunc ExampleStreamWriter() {\n    key := []byte(\"example key 1234\")\n\n    inFile, err := os.Open(\"plaintext-file\")\n    if err != nil {\n        panic(err)\n    }\n    defer inFile.Close()\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    // If the key is unique for each ciphertext, then it's ok to use a zero\n    // IV.\n    var iv [aes.BlockSize]byte\n    stream := cipher.NewOFB(block, iv[:])\n\n    outFile, err := os.OpenFile(\"encrypted-file\", os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0600)\n    if err != nil {\n        panic(err)\n    }\n    defer outFile.Close()\n\n    writer := &amp;cipher.StreamWriter{S: stream, W: outFile}\n    // Copy the input file to the output file, encrypting as we go.\n    if _, err := io.Copy(writer, inFile); err != nil {\n        panic(err)\n    }\n\n    // Note that this example is simplistic in that it omits any\n    // authentication of the encrypted data. If you were actually to use\n    // StreamReader in this manner, an attacker could flip arbitrary bits in\n    // the decrypted result.\n}\n</code></pre>\n\n<p>What is meant with the following quote. About what should I take care to provide a secure encryption and decryption?</p>\n\n<blockquote>\n  <p>Note that this example is simplistic in that it\n  omits any   authentication of the encrypted data. If you were actually\n  to use  StreamReader in this manner, an attacker could flip arbitrary\n  bits in the output.</p>\n</blockquote>\n\n<p>Thanks!</p>\n"}, {"tags": ["concurrency", "go", "race-condition", "goroutine"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1431154291, "post_id": 30136884, "comment_id": 48383287, "body": "Why do you think this code doesn&#39;t have a race condition? The goroutine runs concurrently with the for loop and there&#39;s no synchronization performed."}], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 4068848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FD7nX.png?s=128&g=1", "display_name": "huron", "link": "https://stackoverflow.com/users/4068848/huron"}, "edited": false, "score": 1, "creation_date": 1431155700, "post_id": 30137103, "comment_id": 48383618, "body": "Thank you! But my race detector really can&#39;t catch the problem, I don&#39;t know why. My go version is 1.4.2."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 632, "user_id": 4068848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FD7nX.png?s=128&g=1", "display_name": "huron", "link": "https://stackoverflow.com/users/4068848/huron"}, "edited": false, "score": 0, "creation_date": 1431156660, "post_id": 30137103, "comment_id": 48383846, "body": "The system I tested this on had Go 1.3.3 installed (Ubuntu 15.04 on amd64).  I haven&#39;t tested it on 1.4.2 myself."}, {"owner": {"reputation": 632, "user_id": 4068848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FD7nX.png?s=128&g=1", "display_name": "huron", "link": "https://stackoverflow.com/users/4068848/huron"}, "edited": false, "score": 0, "creation_date": 1431157024, "post_id": 30137103, "comment_id": 48383933, "body": "It seems that when a deadlock occurs the race detector can&#39;t catch the problem. I manage to prevent deadlock and the race detector catch the problem successfully."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 632, "user_id": 4068848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FD7nX.png?s=128&g=1", "display_name": "huron", "link": "https://stackoverflow.com/users/4068848/huron"}, "edited": false, "score": 0, "creation_date": 1431160706, "post_id": 30137103, "comment_id": 48384772, "body": "You&#39;ve definitely got a deadlock, with your <code>main</code> gouroutine filling up a channel that isn&#39;t being drained.  I elided that from the output in my answer because that isn&#39;t from the race detector, and I assumed you&#39;d already seen that bit."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1431181862, "post_id": 30137103, "comment_id": 48390924, "body": "The <a href=\"https://blog.golang.org/race-detector#TOC_5.\" rel=\"nofollow noreferrer\">race detector</a> does not issue false positives, but it can have false negatives (i.e. a run without any <code>-race</code> reports does not mean there are no races)."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 2, "last_activity_date": 1431155304, "creation_date": 1431155304, "answer_id": 30137103, "question_id": 30136884, "link": "https://stackoverflow.com/questions/30136884/golang-why-does-this-race-condition-occur/30137103#30137103", "title": "Golang - Why does this race condition occur\uff1f", "body": "<p>As there is no synchronisation between the <code>main</code> and <code>test</code> goroutines, you don't know at what point the <code>fmt.Println</code> call in <code>test</code> will happen.</p>\n\n<p>When running with <code>GOMAXPROCS = 1</code>, the answer will essentially depend on when the scheduler decides to stop executing <code>main</code> and switch to <code>test</code>.  The send operation within the loop is one point where the scheduler can switch over to another goroutine, so with enough iterations of the loop you'd expect <code>test</code> to get a chance to execute at some point.  It isn't necessarily going to switch at the same iteration every run leading to the variation in results.</p>\n\n<p>As for catching this with the race detector, it successfully catches the problem for me:</p>\n\n<pre><code>$ go run -race test.go\n==================\nWARNING: DATA RACE\nRead by goroutine 5:\n  main.test()\n      /../test.go:8 +0x6e\n\nPrevious write by main goroutine:\n  main.main()\n      /.../test.go:18 +0xfe\n\nGoroutine 5 (running) created at:\n  main.main()\n      /.../test.go:15 +0x8f\n==================\n...\n</code></pre>\n"}], "owner": {"reputation": 632, "user_id": 4068848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FD7nX.png?s=128&g=1", "display_name": "huron", "link": "https://stackoverflow.com/users/4068848/huron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1466, "favorite_count": 0, "accepted_answer_id": 30137103, "answer_count": 1, "score": 1, "last_activity_date": 1542550225, "creation_date": 1431153579, "last_edit_date": 1542550225, "question_id": 30136884, "link": "https://stackoverflow.com/questions/30136884/golang-why-does-this-race-condition-occur", "title": "Golang - Why does this race condition occur\uff1f", "body": "<pre><code>package main\nimport \"fmt\"\n\nvar quit chan int\nvar glo int\n\nfunc test() {\n    fmt.Println(glo)\n}\n\nfunc main() {\n    glo = 0\n    n := 10000\n    quit = make(chan int, n)\n    go test()\n    for {\n        quit &lt;- 1\n        glo++\n    }\n}\n</code></pre>\n\n<p><strong>Situation:</strong></p>\n\n<p>The above program outputs 10000. But when I assign a bigger number to <em>n</em> (e.g. <code>n := 1000000</code>), the output will be a random number <em>less than n</em>.</p>\n\n<p>I haven't called <code>runtime.GOMAXPROCS()</code>, so these two goroutines can't run in parallel. Executing <code>go run -race</code> to detect race conditions, ends up <em>without</em> any warnings.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Why does this race condition occur?</p>\n"}, {"tags": ["angularjs", "http", "go", "gorilla"], "comments": [{"owner": {"reputation": 2995, "user_id": 152984, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SRMEV.jpg?s=128&g=1", "display_name": "CuriousMind", "link": "https://stackoverflow.com/users/152984/curiousmind"}, "edited": false, "score": 1, "creation_date": 1431153762, "post_id": 30136801, "comment_id": 48383161, "body": "Did you check that whether the session cookie is sent back when the page is getting reloaded?"}, {"owner": {"reputation": 1688, "user_id": 4477334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/634320017/picture?type=large", "display_name": "Steve Drake", "link": "https://stackoverflow.com/users/4477334/steve-drake"}, "edited": false, "score": 0, "creation_date": 1431153884, "post_id": 30136801, "comment_id": 48383183, "body": "Have you had a look to see what&#39;s going on with fiddler?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2684680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6934ec5bf1927a276457e07d549f96e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ayush Agrawal", "link": "https://stackoverflow.com/users/2684680/ayush-agrawal"}, "is_accepted": true, "score": 1, "last_activity_date": 1431174248, "creation_date": 1431174248, "answer_id": 30139866, "question_id": 30136801, "link": "https://stackoverflow.com/questions/30136801/angularjs-page-does-not-refresh-from-server/30139866#30139866", "title": "AngularJS page does not refresh from server", "body": "<p>It started behaving properly after I added the \"Cache-Control\": \"no-store\" header in my IndexHandler.</p>\n\n<pre><code>w.Header().Set(\"Cache-Control\", \"no-store\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2684680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6934ec5bf1927a276457e07d549f96e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ayush Agrawal", "link": "https://stackoverflow.com/users/2684680/ayush-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 30139866, "answer_count": 1, "score": 0, "last_activity_date": 1431220804, "creation_date": 1431152943, "last_edit_date": 1431220804, "question_id": 30136801, "link": "https://stackoverflow.com/questions/30136801/angularjs-page-does-not-refresh-from-server", "title": "AngularJS page does not refresh from server", "body": "<p>I have an AngularJS app. The server side is Go and uses Gorilla Web Toolkit mux and sessions packages. The Angular app has two forms on the main page, Sign In and Sign Up. The data is posted to Go using AngularJS <code>$http.post</code> as JSON and appropriate responses are sent back from the server as JSON. What I want to achieve is that two different pages should be served on the main page of the website depending on if the user is logged in or not. Currently, when I submit the details of the Sign In form and the server responds with an appropriate response, I reload the page, but AngularJS keeps showing the page with the forms and not the new page.</p>\n\n<p>AngularJS Code</p>\n\n<pre><code>angular.module('app', [])\n\nangular.module('app').controller('SignInController', ['$scope', '$http', function($scope, $http) {\n    $scope.formData = {}\n\n    $scope.signIn = function() {\n        $http.post('/signIn', {\n            email: $scope.formData.email,\n            password: $scope.formData.password\n        }).success(function(data) {\n            console.log(data)\n            if(data.ok == true) {\n                window.location.reload(true)\n            }\n        })\n    }\n}])\n</code></pre>\n\n<p>Relevant Go Code\nBelow, the SignInHandler gets called on a POST to \"/signIn\" and the IndexHandler gets called on a Get to \"/\".</p>\n\n<pre><code>type JsonResponse map[string]interface{}\n\nfunc (jr JsonResponse) String() (output string) {\n    b, err := json.Marshal(jr)\n    if err != nil {\n        output = \"\"\n        return\n    }\n    output = string(b)\n    return\n}\n\nfunc SignInHandler(w http.ResponseWriter, r *http.Request) {\n    session, _ := sessionStore.Get(r, \"user-session\")\n\n    decoder := json.NewDecoder(r.Body)\n    var user User\n    err := decoder.Decode(&amp;user)\n    if err != nil {\n        fmt.Fprint(w, JsonResponse{\"ok\": false, \"message\": \"Bad request\"})\n        return\n    }\n\n    if user.Email == \"\" || user.Password == \"\" {\n        fmt.Fprint(w, JsonResponse{\"ok\": false, \"message\": \"All fields are required\"})\n        return\n    }\n\n    userExists, u := user.Exists()\n    if userExists == false {\n        fmt.Fprint(w, JsonResponse{\"ok\": false, \"message\": \"Email and/or password in invalid\"})\n        return\n    }\n\n    err = bcrypt.CompareHashAndPassword([]byte(u.Password), []byte(user.Password))\n    if err != nil {\n        fmt.Fprint(w, JsonResponse{\"ok\": false, \"message\": \"Email and/or password in invalid\"})\n        return\n    }\n\n    session.Values[\"userId\"] = u.Id.Hex()\n\n    session.Save(r, w)\n\n    fmt.Fprint(w, JsonResponse{\"ok\": true, \"message\": \"Authentication Successful\"})\n}\n\nfunc IndexHandler(w http.ResponseWriter, r *http.Request) {\n    session, _ := sessionStore.Get(r, \"promandi-user-session\")\n\n    if _, ok := session.Values[\"userId\"]; ok {\n        http.ServeFile(w, r, \"./views/home.html\")\n    } else {\n        http.ServeFile(w, r, \"./views/index.html\")\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 2, "last_activity_date": 1431133272, "creation_date": 1431133272, "answer_id": 30134883, "question_id": 30134828, "link": "https://stackoverflow.com/questions/30134828/json-marshal-map-to-json-array/30134883#30134883", "title": "json.Marshal map to JSON array", "body": "<p>You can define a custom <a href=\"http://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow\"><code>json.Marshaler</code></a> interface to do that, for example:</p>\n\n<pre><code>type mapInfo struct {\n    Name string `json:\"name\"`\n    Date string `json:\"date\"`\n}\n\ntype CustomMap map[string]string\n\nfunc (cm CustomMap) MarshalJSON() ([]byte, error) {\n    // if you want to optimize you can use a bytes.Buffer and write the strings out yourself.\n    var out struct {\n        Map []mapInfo `json:\"map\"`\n    }\n    for k, v := range cm {\n        out.Map = append(out.Map, mapInfo{k, v})\n    }\n    return json.Marshal(out)\n}\n\nfunc (cm CustomMap) UnmarshalJSON(b []byte) (err error) {\n    var out struct {\n        Map []mapInfo `json:\"map\"`\n    }\n    if err = json.Unmarshal(b, &amp;out); err != nil {\n        return\n    }\n    for _, v := range out.Map {\n        cm[v.Name] = v.Date\n    }\n    return\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/7AHbAhJo-o\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 153, "user_id": 4489257, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/755572e35afde5bf222b3096a3b9d36b?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Lis", "link": "https://stackoverflow.com/users/4489257/maxim-lis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 931, "favorite_count": 0, "accepted_answer_id": 30134883, "answer_count": 1, "score": 2, "last_activity_date": 1431133272, "creation_date": 1431132639, "question_id": 30134828, "link": "https://stackoverflow.com/questions/30134828/json-marshal-map-to-json-array", "title": "json.Marshal map to JSON array", "body": "<p>When i try Marshal a map, json.Marshal return:</p>\n\n<pre><code>{\"Map Key\":\"Map Value\"}...\n</code></pre>\n\n<p>This is normal behavior. But i can marshal this to:</p>\n\n<pre><code>{\"Map\":[{\"Name\":\"Map Key\",\"Date\":\"Map Value\"},{\"Name\":\"Map Key2\",\"Date\":\"Map Value2\"}]}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1431132271, "post_id": 30134667, "comment_id": 48379449, "body": "That&#39;s not JSON, you&#39;d need to parse each line and convert it to whatever format."}, {"owner": {"reputation": 49, "user_id": 4638860, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768212f16481aed42b312f00cbc281e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4638860/ganesh"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1431493463, "post_id": 30134667, "comment_id": 48517046, "body": "Yeah. That&#39;s why I posted it saying input is a text and wanted to convert the input text to JSON."}], "answers": [{"tags": [], "owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "is_accepted": true, "score": 0, "last_activity_date": 1431133270, "creation_date": 1431133270, "answer_id": 30134882, "question_id": 30134667, "link": "https://stackoverflow.com/questions/30134667/golang-parse-a-complex-string-to-json/30134882#30134882", "title": "golang parse a complex string to json", "body": "<p>You are going to have to write a custom parser that will cut that input up into a way you can retrieve your keys and values. The <a href=\"https://golang.org/pkg/strings/\" rel=\"nofollow\"><code>strings</code></a> package should be very helpful, specifically <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\"><code>strings.Split</code></a>.</p>\n\n<p>I wrote a basic example that works on at least one section of your input. You are going to want to tweak it to work for your entire input. As it stands, mine will overwrite keys when continuing to read. You will want to add some sort of array structure to handle using the same keys. Also, mine uses all values as <code>string</code>s. I'm not sure if that is useful to you.</p>\n\n<p><a href=\"http://play.golang.org/p/FZ_cQ-b-bx\" rel=\"nofollow\">http://play.golang.org/p/FZ_cQ-b-bx</a></p>\n\n<p>However, if you control the server and application that you are getting this output from, the preferred solution would be to have that application convert it to JSON.</p>\n\n<p><strong>NOTE:</strong> The code above is very brittle.</p>\n"}], "owner": {"reputation": 49, "user_id": 4638860, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768212f16481aed42b312f00cbc281e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4638860/ganesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 30134882, "answer_count": 1, "score": -1, "last_activity_date": 1431133270, "creation_date": 1431131030, "question_id": 30134667, "link": "https://stackoverflow.com/questions/30134667/golang-parse-a-complex-string-to-json", "title": "golang parse a complex string to json", "body": "<p>I am trying to parse a string response from a server to JSON format. I am new to golang and need some help in understanding the right way to achieve a solution. Here is the response I am getting from the server -</p>\n\n<pre><code>Test 1: local 1.1.1.1  remote 2.2.2.2  state GOOD\nTest ID: 2.2.2.2\nTest Type: ABD\nAdmin State: START\nDFD: Disabled\nAddress family: ipv4-unicast  \nOptions: &lt; Refresh &gt;  \nUpdates Received: 0,  Updates Sent: 7\nData Received: 853,  Data Sent: 860\nTime since last received update: n/a\nNumber of transitions to GOOD: 1\nTime since last entering GOOD state: 22384 seconds\nRetry Interval: 120 seconds\nHold Time: 90 seconds,  Keep Test Time: 30 seconds\n\nTest 2: local 1.1.1.1  remote 2.2.2.2  state GOOD\nTest ID: 2.2.2.2\nTest Type: ABD\nAdmin State: START\nDFD: Disabled\nAddress family: ipv4-unicast  \nOptions: &lt; Refresh &gt;  \nUpdates Received: 0,  Updates Sent: 7\nData Received: 853,  Data Sent: 860\nTime since last received update: n/a\nNumber of transitions to GOOD: 1\nTime since last entering GOOD state: 22384 seconds\nRetry Interval: 120 seconds\nHold Time: 90 seconds,  Keep Test Time: 30 seconds\n\nTest 3: local 1.1.1.1  remote 2.2.2.2  state GOOD\nTest ID: 2.2.2.2\nTest Type: ABD\nAdmin State: START\nDFD: Disabled\nAddress family: ipv4-unicast  \nOptions: &lt; Refresh &gt;  \nUpdates Received: 0,  Updates Sent: 7\nData Received: 853,  Data Sent: 860\nTime since last received update: n/a\nNumber of transitions to GOOD: 1\nTime since last entering GOOD state: 22384 seconds\nRetry Interval: 120 seconds\nHold Time: 90 seconds,  Keep Test Time: 30 seconds\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["syntax", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431181136, "post_id": 30133844, "comment_id": 48390692, "body": "Normally in Go you just use a <code>[]MyType</code> as a &quot;stack&quot;. The builtin <code>append</code> is &quot;push&quot; and you either grab the last element or the first for LIFO or FIFO semantics (e.g. <code>x, s = s[len(s)-1], s[:len(s)-1]</code> or <code>x, s = s[0], s[1:]</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 248, "user_id": 4326150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-O8n8uGqx1_A/AAAAAAAAAAI/AAAAAAAAADw/LnfOJeMwnds/photo.jpg?sz=128", "display_name": "angubenko", "link": "https://stackoverflow.com/users/4326150/angubenko"}, "edited": false, "score": 0, "creation_date": 1431125348, "post_id": 30133858, "comment_id": 48377925, "body": "Field_2 is not an array. I need to create Field_2 as a stack of a specific type, because later I need to Pop() element from stack and access &quot;start_row &quot;, &quot;start_column &quot;."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 248, "user_id": 4326150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-O8n8uGqx1_A/AAAAAAAAAAI/AAAAAAAAADw/LnfOJeMwnds/photo.jpg?sz=128", "display_name": "angubenko", "link": "https://stackoverflow.com/users/4326150/angubenko"}, "edited": false, "score": 1, "creation_date": 1431129019, "post_id": 30133858, "comment_id": 48378856, "body": "You need to be more specific then, where&#39;s that stack package defined?"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 0, "last_activity_date": 1431124706, "creation_date": 1431124706, "answer_id": 30133858, "question_id": 30133844, "link": "https://stackoverflow.com/questions/30133844/how-to-put-custom-structure-to-stack-and-then-be-able-to-access-all-fields/30133858#30133858", "title": "How to put custom structure to stack and then be able to access all fields?", "body": "<p>Few points:</p>\n\n<ol>\n<li><p>all fields in <code>Custom</code> are not exported, you can't modify them directly from a different package.</p></li>\n<li><p>You can't create <code>Foo</code> that way, however since it's an array you can simply just use <code>new_element := &amp;foo.Foo{Field_2: Stack{}}</code>.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 2616277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf262b64d42c2bd0103eafe5940eee4?s=128&d=identicon&r=PG", "display_name": "Manan", "link": "https://stackoverflow.com/users/2616277/manan"}, "reply_to_user": {"reputation": 248, "user_id": 4326150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-O8n8uGqx1_A/AAAAAAAAAAI/AAAAAAAAADw/LnfOJeMwnds/photo.jpg?sz=128", "display_name": "angubenko", "link": "https://stackoverflow.com/users/4326150/angubenko"}, "edited": false, "score": 0, "creation_date": 1431131426, "post_id": 30134584, "comment_id": 48379315, "body": "Maybe something like this - <a href=\"https://play.golang.org/p/Ftrm8V3-9a\" rel=\"nofollow noreferrer\">play.golang.org/p/Ftrm8V3-9a</a>  You can separate those out into different packages"}], "tags": [], "owner": {"reputation": 91, "user_id": 2616277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf262b64d42c2bd0103eafe5940eee4?s=128&d=identicon&r=PG", "display_name": "Manan", "link": "https://stackoverflow.com/users/2616277/manan"}, "is_accepted": false, "score": 0, "last_activity_date": 1431130144, "creation_date": 1431130144, "answer_id": 30134584, "question_id": 30133844, "link": "https://stackoverflow.com/questions/30133844/how-to-put-custom-structure-to-stack-and-then-be-able-to-access-all-fields/30134584#30134584", "title": "How to put custom structure to stack and then be able to access all fields?", "body": "<p>With the current implementation of package stack, there is no way to enforce the type of <code>value</code> that gets stored inside struct <code>Element</code>.</p>\n"}], "owner": {"reputation": 248, "user_id": 4326150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-O8n8uGqx1_A/AAAAAAAAAAI/AAAAAAAAADw/LnfOJeMwnds/photo.jpg?sz=128", "display_name": "angubenko", "link": "https://stackoverflow.com/users/4326150/angubenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 30133858, "answer_count": 2, "score": -1, "last_activity_date": 1431130144, "creation_date": 1431124598, "last_edit_date": 1431130098, "question_id": 30133844, "link": "https://stackoverflow.com/questions/30133844/how-to-put-custom-structure-to-stack-and-then-be-able-to-access-all-fields", "title": "How to put custom structure to stack and then be able to access all fields?", "body": "<p>I have struct Foo with fields Field_1 and Field_2.</p>\n\n<pre><code>  package foo  \n  type Custom struct {\n      start_row int\n      start_column int\n      move_row int\n      move_column int\n    }\n\n    type Foo struct{\n      Field_1 [100]Custom\n      Field_2 stack.Stack\n    }\n</code></pre>\n\n<p>How can I initialize Foo? Something like this,</p>\n\n<pre><code>new_element := &amp;foo.Foo { [100]foo.Custom{}, stack.Stack {} }\n</code></pre>\n\n<p>But I need specify stack as container for foo.Custom struct, because I need to access later start_row, start_column like this</p>\n\n<pre><code>Element: = Field_2.Pop()\nfmt.Printf(\"%d \\n\", Element.start_row)\n</code></pre>\n\n<p>Here is stack implementation</p>\n\n<pre><code>package stack\n\ntype Stack struct {\n  top *Element\n  size int\n}\n\ntype Element struct {\n  value interface{}\n  next *Element\n}\n\n// Get length of the stack\nfunc (s *Stack) Length() int {\n  return s.size\n}\n\n// Push a new element into the stack\nfunc (s *Stack) Push(value interface{}) {\n  s.top = &amp;Element{value, s.top}\n  s.size += 1\n}\n\n// Remove the top element from the stack and return value\n// If stack is empty return nil\nfunc (s *Stack) Pop() (value interface{}) {\n  if s.size &gt; 0 {\n    value, s.top = s.top.value, s.top.next\n    s.size -= 1\n    return\n  }\n  return nil\n}\n</code></pre>\n"}, {"tags": ["go", "newrelic"], "comments": [{"owner": {"reputation": 357, "user_id": 2301947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c743804b16ae320fbf01ccb1b88cf7?s=128&d=identicon&r=PG", "display_name": "Song Keang", "link": "https://stackoverflow.com/users/2301947/song-keang"}, "edited": false, "score": 0, "creation_date": 1442481791, "post_id": 30132131, "comment_id": 53103281, "body": "Hi Tuk, I just started using gorelic, and tracing code blocks, but I cound&#39;t find the metrics trace anywhere in the newrelic plugin dashboard? How did you get to that chart? Thank you"}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 357, "user_id": 2301947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c743804b16ae320fbf01ccb1b88cf7?s=128&d=identicon&r=PG", "display_name": "Song Keang", "link": "https://stackoverflow.com/users/2301947/song-keang"}, "edited": false, "score": 0, "creation_date": 1442549017, "post_id": 30132131, "comment_id": 53135306, "body": "Hi Song, After logging in on top right corner where user name is showing, click on &quot;Account Settings&quot; then from the left Select &quot;Connected Agents&quot;, then on the &quot;Connected Agents&quot; page you can find the various applications using GoRelic plugin all will have the perfix &quot;GoRelic&quot;. Click on any of them and you will land up on the metrics page. After that you can click on any of the metrics to get the graphs I have mentioned in my question"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1431115976, "creation_date": 1431115976, "question_id": 30132131, "link": "https://stackoverflow.com/questions/30132131/gorelic-trace-metric-explanation", "title": "GoRelic - Trace Metric Explanation", "body": "<p>I have added a trace in a Go function using the GoRelic as mentioned <a href=\"https://github.com/yvasiyarov/gorelic#tracing-metrics\" rel=\"nofollow\">here</a>. The numbers reported in GoRelic Dashboard for this trace are as follows:- (Please check the screen shot of the trace in NewRelic dashboard <a href=\"https://drive.google.com/file/d/0BwE7aDgG6P0DZm9mQTZucUFRZ3M/view?usp=sharing\" rel=\"nofollow\">here</a>)</p>\n\n<p>Trace/ Prudsys Select/ max Average ms</p>\n\n<pre><code>Avg - 9.38k ms\nTotal - 37.5k ms\nMax - 13.9k ms\nMin - 5.48k ms\nStdDev - 3.93k\nRate - 20.8 ms/sec\nCount - 4 Samples\n</code></pre>\n\n<p>Can some one explain me:-</p>\n\n<ol>\n<li><p>What does k ms mean in 9.38k ms? Does it mean 9 sec 38ms? </p></li>\n<li><p>What does Rate - 20.8 ms/sec mean? </p></li>\n<li><p>What does max Average ms mean in \"Trace/Prudsys Select/ max Average\nms\"? </p></li>\n<li><p>What does count - 4 Samples mean?</p></li>\n</ol>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1431111849, "post_id": 30131052, "comment_id": 48372170, "body": "A struct value can&#39;t be nil. I think you really need to start off with the <a href=\"http://golang.org/doc/\" rel=\"nofollow noreferrer\">docs</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 9, "creation_date": 1431112447, "post_id": 30131052, "comment_id": 48372453, "body": "I think you&#39;re confusing a pointer to a stuct with the value itself. <code>nil</code> is not an allowed value for a struct. It is however, a common value for a pointer. If <code>NewVar</code> were declared as <code>var NewVar *Ptr</code> it could be set to <code>nil</code>. It could also be set to something like <code>&amp;Ptr{}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2138, "user_id": 2116520, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/84a8dc0af169f1b2b000e914ab6b9f96?s=128&d=identicon&r=PG", "display_name": "wwjdm", "link": "https://stackoverflow.com/users/2116520/wwjdm"}, "edited": false, "score": 0, "creation_date": 1431119504, "post_id": 30131146, "comment_id": 48375785, "body": "@EliMiller ID is declared as a <i>pointer</i> to big.Int, which means its zero value will be <code>nil</code>."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 19, "last_activity_date": 1431112077, "creation_date": 1431112077, "answer_id": 30131146, "question_id": 30131052, "link": "https://stackoverflow.com/questions/30131052/golang-set-type-struct-to-nil/30131146#30131146", "title": "golang: Set type struct to nil", "body": "<p>The <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">zero value</a> of a struct value is not nil</p>\n\n<blockquote>\n  <p>Each element of such a <a href=\"https://golang.org/ref/spec#Variables\" rel=\"noreferrer\">variable</a> or value is set to the zero value for its type: <code>false</code> for booleans, <code>0</code> for integers, <code>0.0</code> for floats, <code>\"\"</code> for strings, and <strong><code>nil</code> for pointers, functions, interfaces, slices, channels, and maps</strong>. </p>\n</blockquote>\n\n<p>In your case, this <a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"noreferrer\">variable declaration</a> <code>var NewVar Ptr</code> creates the  variable, binds corresponding identifier <code>Ptr</code> to it, and gives it a type and an initial value. </p>\n"}], "owner": {"reputation": 2138, "user_id": 2116520, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/84a8dc0af169f1b2b000e914ab6b9f96?s=128&d=identicon&r=PG", "display_name": "wwjdm", "link": "https://stackoverflow.com/users/2116520/wwjdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26775, "favorite_count": 2, "closed_date": 1431150989, "accepted_answer_id": 30131146, "answer_count": 1, "score": 12, "last_activity_date": 1431112077, "creation_date": 1431111733, "question_id": 30131052, "link": "https://stackoverflow.com/questions/30131052/golang-set-type-struct-to-nil", "closed_reason": "Needs details or clarity", "title": "golang: Set type struct to nil", "body": "<pre><code>type Ptr struct {\n    ID   *big.Int\n    IpAddress string\n    Port      string\n}\nvar NewVar Ptr\n</code></pre>\n\n<p>After initializing the NewVar with values I then want to set NewVar to nil. How can I do this?</p>\n"}, {"tags": ["function", "go"], "comments": [{"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 2, "creation_date": 1431105835, "post_id": 30129206, "comment_id": 48368941, "body": "I&#39;m no expert in how Go works in the backend, but the &quot;comma ok&quot; pattern is applied to builtin operations (not &quot;real&quot; functions). Since it&#39;s optional it would seem that the compiler checks for a multi-value <i>assignment</i>. Maybe someone <a href=\"https://github.com/golang/go/blob/254964074f34dc1cb39693f3e23a95938092044f/src/go/types/call.go#L118-L134\" rel=\"nofollow noreferrer\">more familiar with the compiler</a> can elaborate"}, {"owner": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "reply_to_user": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1431119402, "post_id": 30129206, "comment_id": 48375723, "body": "would you mind elaborating on the &quot;comma ok&quot; pattern? an answer would be appreciated (and upvoted) since I&#39;m not only trying to save keystrokes but understanding <b>why</b> this happens."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1431127239, "post_id": 30129206, "comment_id": 48378435, "body": "I have a strong suspicion of why this isn&#39;t allowed but I&#39;ll need to reference the spec. I think there is a sound logical reason for it. Pretty sure if you allowed it I could come up with some edge cases that will break the compiler or have undefined/inconsistent behavior."}, {"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1431139029, "post_id": 30129206, "comment_id": 48380621, "body": "@PabloFernandez I hope my response is able to answer your why!"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 14, "last_activity_date": 1431105213, "creation_date": 1431105213, "answer_id": 30129325, "question_id": 30129206, "link": "https://stackoverflow.com/questions/30129206/golang-return-multiple-values-issue/30129325#30129325", "title": "golang return multiple values issue", "body": "<p>You may save a couple of key strokes by using named returns:</p>\n\n<pre><code>func FindUserInfo(id string) (i Info, ok bool) {\n    i, ok = all[id]\n    return\n}\n</code></pre>\n\n<p>But apart from that, I don't think what you want is possible.</p>\n"}, {"comments": [{"owner": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "edited": false, "score": 0, "creation_date": 1431119287, "post_id": 30130594, "comment_id": 48375670, "body": "<code>return all[id]</code> is not returning an array but an element in the <b>map</b>. if the return type is just an element that&#39;s ok but actually it returns 2 values, that&#39;s why you can do <code>a,b := foo[id]</code>"}], "tags": [], "owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "is_accepted": false, "score": 2, "last_activity_date": 1431111263, "last_edit_date": 1431111263, "creation_date": 1431109856, "answer_id": 30130594, "question_id": 30129206, "link": "https://stackoverflow.com/questions/30129206/golang-return-multiple-values-issue/30130594#30130594", "title": "golang return multiple values issue", "body": "<p>I'm no Go expert but I believe you are getting compile time error when you are trying to return the array i.e. <code>return all[id]</code>. The reason could be because the functions return type is specially mentioned as <code>(Info, bool)</code> and when you are doing <code>return all[id]</code> it can't map the return type of <code>all[id]</code> to <code>(Info, bool)</code>.</p>\n\n<p>However the solution mentioned above, the variables being returned <code>i</code> and <code>ok</code> are the same that are mentioned in the return type of the function <code>(i Info, ok bool)</code> and hence the compiler knows what it's returning as opposed to just doing <code>(i Info, ok bool)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 2616277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf262b64d42c2bd0103eafe5940eee4?s=128&d=identicon&r=PG", "display_name": "Manan", "link": "https://stackoverflow.com/users/2616277/manan"}, "is_accepted": false, "score": 1, "last_activity_date": 1431129392, "creation_date": 1431129392, "answer_id": 30134516, "question_id": 30129206, "link": "https://stackoverflow.com/questions/30129206/golang-return-multiple-values-issue/30134516#30134516", "title": "golang return multiple values issue", "body": "<p>By default, maps in golang return a single value when accessing a key</p>\n\n<p><a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow\">https://blog.golang.org/go-maps-in-action</a></p>\n\n<p>Hence, <code>return all[id]</code> won't compile for a function that expects 2 return values.</p>\n"}, {"tags": [], "owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "is_accepted": false, "score": 19, "last_activity_date": 1431138875, "last_edit_date": 1495540908, "creation_date": 1431138875, "answer_id": 30135334, "question_id": 30129206, "link": "https://stackoverflow.com/questions/30129206/golang-return-multiple-values-issue/30135334#30135334", "title": "golang return multiple values issue", "body": "<p>To elaborate on my <a href=\"https://stackoverflow.com/questions/30129206/golang-return-multiple-values-issue?noredirect=1#comment48368941_30129206\">comment</a>, the <a href=\"https://golang.org/doc/effective_go.html#maps\" rel=\"noreferrer\">Effective Go</a> mentions that the multi-value assignment from accessing a map key is called the \"comma ok\" pattern.</p>\n\n<blockquote>\n  <p>Sometimes you need to distinguish a missing entry from a zero value. Is there an entry for \"UTC\" or is that the empty string because it's not in the map at all? You can discriminate with a form of multiple assignment.</p>\n</blockquote>\n\n<pre><code>var seconds int\nvar ok bool\nseconds, ok = timeZone[tz]\n</code></pre>\n\n<blockquote>\n  <p>For obvious reasons this is called the \u201ccomma ok\u201d idiom. In this example, if tz is present, seconds will be set appropriately and ok will be true; if not, seconds will be set to zero and ok will be false.</p>\n</blockquote>\n\n<p><a href=\"http://play.golang.org/p/cgtysKkLEp\" rel=\"noreferrer\">Playground demonstrating this</a></p>\n\n<p>We can see that this differs from calling a regular function where the compiler would tell you that something is wrong:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc multiValueReturn() (int, int) {\n    return 0, 0\n}\n\nfunc main() {\n    fmt.Println(multiValueReturn)\n\n    asgn1, _ := multiValueReturn()\n\n    asgn2 := multiValueReturn()\n}\n</code></pre>\n\n<p>On the <a href=\"http://play.golang.org/p/fe29S1706D\" rel=\"noreferrer\">playground</a> this will output</p>\n\n<pre><code># command-line-arguments\n/tmp/sandbox592492597/main.go:14: multiple-value multiValueReturn() in single-value context\n</code></pre>\n\n<p>This gives us a hint that it may be something the compiler is doing. <a href=\"https://github.com/golang/go/search?utf8=%E2%9C%93&amp;q=commaOk\" rel=\"noreferrer\">Searching the source code</a> for \"commaOk\" gives us a few places to look, including <a href=\"https://github.com/golang/go/blob/254964074f34dc1cb39693f3e23a95938092044f/src/go/types/call.go#L118-L134\" rel=\"noreferrer\"><code>types.unpack</code></a></p>\n\n<p>At the time of writing this it this the method's godoc reads:</p>\n\n<pre><code>// unpack takes a getter get and a number of operands n. If n == 1, unpack\n// calls the incoming getter for the first operand. If that operand is\n// invalid, unpack returns (nil, 0, false). Otherwise, if that operand is a\n// function call, or a comma-ok expression and allowCommaOk is set, the result\n// is a new getter and operand count providing access to the function results,\n// or comma-ok values, respectively. The third result value reports if it\n// is indeed the comma-ok case. In all other cases, the incoming getter and\n// operand count are returned unchanged, and the third result value is false.\n//\n// In other words, if there's exactly one operand that - after type-checking\n// by calling get - stands for multiple operands, the resulting getter provides\n// access to those operands instead.\n//\n// If the returned getter is called at most once for a given operand index i\n// (including i == 0), that operand is guaranteed to cause only one call of\n// the incoming getter with that i.\n//\n</code></pre>\n\n<p>The key bits of this being that this method appears to determine whether or not something is <em>actually</em> a \"comma ok\" case.</p>\n\n<p>Digging into that method tells us that it will check to see if the mode of the operands is <strong>indexing a map</strong> or if the mode is set to <code>commaok</code> (where this <a href=\"https://github.com/golang/go/blob/677839353e013b13e0fb3d28e01a01a5ccf0c7a1/src/go/types/operand.go#L28\" rel=\"noreferrer\">is defined</a> does give us many hints on when it's used, but searching the source for assignments to <code>commaok</code> we can see it's used when <a href=\"https://github.com/golang/go/blob/677839353e013b13e0fb3d28e01a01a5ccf0c7a1/src/go/types/expr.go#L107\" rel=\"noreferrer\">getting a value from a channel</a> and <a href=\"https://github.com/golang/go/blob/677839353e013b13e0fb3d28e01a01a5ccf0c7a1/src/go/types/expr.go#L1343\" rel=\"noreferrer\">type assertions</a>). Remember the bolded bit for later!</p>\n\n<pre><code>if x0.mode == mapindex || x0.mode == commaok {\n    // comma-ok value\n    if allowCommaOk {\n        a := [2]Type{x0.typ, Typ[UntypedBool]}\n        return func(x *operand, i int) {\n            x.mode = value\n            x.expr = x0.expr\n            x.typ = a[i]\n        }, 2, true\n    }\n    x0.mode = value\n}\n</code></pre>\n\n<p><code>allowCommaOk</code> is a parameter to the function. Checking out where <code>unpack</code> is called in that file we can see that all callers pass <code>false</code> as an argument. Searching the rest of the repository leads us to <code>assignments.go</code> in the <a href=\"https://github.com/golang/go/blob/254964074f34dc1cb39693f3e23a95938092044f/src/go/types/assignments.go#L207-L208\" rel=\"noreferrer\"><code>Checker.initVars()</code> method</a>.</p>\n\n<pre><code>l := len(lhs)\nget, r, commaOk := unpack(func(x *operand, i int) { check.expr(x, rhs[i]) }, len(rhs), l == 2 &amp;&amp; !returnPos.IsValid())\n</code></pre>\n\n<p>Since it seems that we can only use the \"comma ok\" pattern to get two return values when doing a multi-value assignment this seems like the right place to look! In the above code the length of the left hand side is checked, and when <code>unpack</code> is called the <code>allowCommaOk</code> parameter is the result of <code>l == 2 &amp;&amp; !returnPos.IsValid()</code>. The <code>!returnPos.IsValid()</code> is somewhat confusing here as that would mean that the position <a href=\"https://github.com/golang/go/blob/6ffed3020c0fb749868b71d5b13fef65ff248902/src/go/token/position.go#L80-L83\" rel=\"noreferrer\">has no file or line information associated</a> with it, but we'll just ignore that.</p>\n\n<p>Further down in that method we've got:</p>\n\n<pre><code>var x operand\nif commaOk {\n    var a [2]Type\n    for i := range a {\n        get(&amp;x, i)\n        a[i] = check.initVar(lhs[i], &amp;x, returnPos.IsValid())\n    }\n    check.recordCommaOkTypes(rhs[0], a)\n    return\n}\n</code></pre>\n\n<p><strong>So what does all of this tell us?</strong></p>\n\n<ul>\n<li>Since the <code>unpack</code> method takes an <code>allowCommaOk</code> parameter that's hardcoded to false everywhere <em>except</em> in <code>assignment.go</code>'s <code>Checker.initVars()</code> method, we can probably assume that you will only ever get two values when doing an assignment and have two variables on the left-hand side.</li>\n<li>The <code>unpack</code> method will determine whether or not you actually <em>do</em> get an <code>ok</code> value in return by checking if you are indexing a slice, grabbing a value from a channel, or doing a type assertion</li>\n<li>Since you can only get the <code>ok</code> value when doing an assignment it looks like in your specific case you will always need to use variables </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "is_accepted": false, "score": 8, "last_activity_date": 1431161568, "last_edit_date": 1592644375, "creation_date": 1431161568, "answer_id": 30137980, "question_id": 30129206, "link": "https://stackoverflow.com/questions/30129206/golang-return-multiple-values-issue/30137980#30137980", "title": "golang return multiple values issue", "body": "<p>Simply put: the reason why your second example isn't valid Go code is because the language specification says so. ;)</p>\n<p><a href=\"http://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">Indexing a map</a> only yields a secondary value in an assignment to two variables. Return statement is not an assignment.</p>\n<blockquote>\n<p>An index expression on a map a of type map[K]V used in an assignment or initialization of the special form</p>\n<p>v, ok = a[x]<br />\nv, ok := a[x]<br />\nvar v, ok = a[x]</p>\n<p>yields an additional untyped boolean value. The value of ok is true if the key x is present in the map, and false otherwise.</p>\n</blockquote>\n<p>Furthermore, indexing a map is not a &quot;<a href=\"http://golang.org/ref/spec#Return_statements\" rel=\"noreferrer\">single call to a multi-valued function</a>&quot;, which is one of the three ways to return values from a function (the second one, the other two not being relevant here):</p>\n<blockquote>\n<p>There are three ways to return values from a function with a result type:</p>\n<ol>\n<li><p>The return value or values may be explicitly listed in the &quot;return&quot; statement. Each expression must be single-valued and assignable to the corresponding element of the function's result type.</p>\n</li>\n<li><p>The expression list in the &quot;return&quot; statement may be a single call to a multi-valued function. The effect is as if each value returned from that function were assigned to a temporary variable with the type of the respective value, followed by a &quot;return&quot; statement listing these variables, at which point the rules of the previous case apply.</p>\n</li>\n<li><p>The expression list may be empty if the function's result type specifies names for its result parameters. The result parameters act as ordinary local variables and the function may assign values to them as necessary. The &quot;return&quot; statement returns the values of these variables.</p>\n</li>\n</ol>\n</blockquote>\n<p>As for your actual question: the only way to avoid temporary variables would be using non-temporary variables, but usually that would be quite unwise - and probably not much of an optimization even when safe.</p>\n<p>So, why doesn't the language specification allow this kind of special use of map indexing (or type assertion or channel receive, both of which can also utilize the &quot;comma ok&quot; idiom) in return statements? That's a good question. My guess: to keep the language specification simple.</p>\n"}], "owner": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12209, "favorite_count": 5, "answer_count": 5, "score": 19, "last_activity_date": 1431161568, "creation_date": 1431104677, "question_id": 30129206, "link": "https://stackoverflow.com/questions/30129206/golang-return-multiple-values-issue", "title": "golang return multiple values issue", "body": "<p>I was wondering why this is valid go code:</p>\n\n<pre><code>func FindUserInfo(id string) (Info, bool) {\n    it, present := all[id]\n    return it, present\n}\n</code></pre>\n\n<p>but this isn't</p>\n\n<pre><code>func FindUserInfo(id string) (Info, bool) {\n    return all[id]\n}\n</code></pre>\n\n<p>is there a way to avoid the temporary variables?</p>\n"}, {"tags": ["data-structures", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431102808, "post_id": 30128531, "comment_id": 48367268, "body": "You said it yourself, you&#39;re making <code>first</code> point to the same structure as <code>last</code>. Therefore anytime you change <code>last</code>, it changes <code>first</code>. Don&#39;t do that."}, {"owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431103500, "post_id": 30128531, "comment_id": 48367719, "body": "Correct, but if I declare <code>first</code> as <code>Link</code> instead of currently declared as <code>*Link</code>. And later when I assign <code>first</code> = <code>last</code> this would mean that it&#39;s a copy and not reference. But doing this leads to the issue I have mentioned i.e. - <code>first.next</code> doesn&#39;t point to 20 when 20 is added, it points to {0,&lt;nil&gt;}."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1431104308, "post_id": 30128531, "comment_id": 48368156, "body": "Yes, don&#39;t mutate <code>last</code> and you won&#39;t have that problem.  I&#39;ll put it in an answer"}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "edited": false, "score": 0, "creation_date": 1431105697, "post_id": 30129157, "comment_id": 48368867, "body": "Thank you @JimB. So basically when you do <code>last = next&#39; you are pointing </code>last` to the address of <code>next</code>. Is that correct? I think using Java has made my pointers more rusty :). Thanks again for your help. It&#39;s really nice to see people like you helping out golang community in SO!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "edited": false, "score": 0, "creation_date": 1431106664, "post_id": 30129157, "comment_id": 48369408, "body": "@srock: correct. <code>last</code> and <code>next</code> are pointers, so <code>last = next</code> assigns the address of <code>next</code> to <code>last</code>."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1431107952, "last_edit_date": 1431107952, "creation_date": 1431104498, "answer_id": 30129157, "question_id": 30128531, "link": "https://stackoverflow.com/questions/30128531/pointer-trouble-with-linkedlist-implementation/30129157#30129157", "title": "Pointer trouble with linkedlist implementation", "body": "<p>Don't mutate the element value in <code>last</code>, since that element is already created. Make a new <code>last</code>, and set the previous <code>next</code> pointer to point to it. Here is a modified version: <a href=\"http://play.golang.org/p/-X5RayC0gU\" rel=\"nofollow\">http://play.golang.org/p/-X5RayC0gU</a></p>\n\n<pre><code>var first *Link\nvar last *Link\n\nfunc AddToLast(d int) {\n    next := &amp;Link{d, nil}\n    if first == nil {\n        first = next\n    } else {\n        last.next = next\n    }\n    last = next\n}\n\ntype Link struct {\n    data int\n    next *Link\n}\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 30129157, "answer_count": 1, "score": 0, "last_activity_date": 1431107952, "creation_date": 1431102176, "last_edit_date": 1431105978, "question_id": 30128531, "link": "https://stackoverflow.com/questions/30128531/pointer-trouble-with-linkedlist-implementation", "title": "Pointer trouble with linkedlist implementation", "body": "<p>Trying to implement LinkedList with simple addToLast function (which adds the new node to the end of the linkedlist) instead of using the inbuilt list)\nBelow is the code (removed print statements which I used for debugging):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar first *Link\nvar last Link\n\nfunc main() {\n    AddToLast(10)\n    AddToLast(20)\n}\n\nfunc AddToLast(d int) {\n    if first == nil {\n        last = Link{d, new(Link)}\n        first = &amp;last\n    } else {\n        last.next = &amp;Link{d, new(Link)}\n        last = *last.next\n    }\n}\n\ntype Link struct {\n    data int\n    next *Link\n}\n</code></pre>\n\n<p>My understanding of the above code:</p>\n\n<p>Inside AddToLast functions -\nAfter checking if 'first' is nil i.e. it doesn't have any element, 'last' is created \nwith 10 as the data and new empty Link as the next. Now 'first' is assigned the same value\nas 'last' but using memory address(as reference - I'm not sure if my understanding is incorrect here)</p>\n\n<p>Now when we try to insert 20 (the next new element) the else part in the 'AddToLast' is executed.\n'last.next' is assigned a link with value as 20 and it's next as nil. Now 'last' is moved to 'last.next',\nto make sure 'last' always points to the last node.</p>\n\n<p>However since I moved 'last' to 'last.next', 'last'('s) memory address changes which is obvious and this also\ncauses first to point to the new last i.e. with value as 20. </p>\n\n<p>In order to avoid this, I tried declaring 'first' as Link instead of *Link.\nHowever, doing this doesn't make first.next point to new node i.e. 20. I'm confused as to where I'm not thinking correct.</p>\n"}, {"tags": ["mongodb", "curl", "go", "mlab"], "answers": [{"tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": true, "score": 0, "last_activity_date": 1431126552, "creation_date": 1431126552, "answer_id": 30134129, "question_id": 30125018, "link": "https://stackoverflow.com/questions/30125018/mongolab-delete-multiple-collections-using-http-put-via-curl-golang-http-not-wor/30134129#30134129", "title": "MongoLab Delete Multiple collections using HTTP PUT via CURL/Golang-http not working", "body": "<p>I suppose you need to pass an empty json array as the payload of the PUT message. With curl, it would be something like:</p>\n\n<pre><code>curl -H \"Content-Type: application/json\" -X PUT -d '[]' \"https://api.mongolab.com/api/1/databases/mydb/collections/mycoll?q={\\\"person\\\":\\\"554b3d1ae4b0e2832aeeb6af\\\"}&amp;apiKey=xxxxxxxxxxxxxxxxx\"\n</code></pre>\n\n<p>In the Go code, you need to write something like this:</p>\n\n<pre><code>client := &amp;http.Client{}\nreq, err := http.NewRequest(\n    \"PUT\",\n    \"https://api.mongolab.com/api/1/databases/mydb/collections/mycoll?q={\\\"person\\\":\\\"554b3d1ae4b0e2832aeeb6af\\\"}&amp;apiKey=xxxxxxxxxxxxxxxxx\",\n     bytes.NewBuffer(\"[]\")\n)\nreq.Header.Set(\"Content-Type\", \"application/json\")\nreply, err := client.Do(req)\n</code></pre>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 30134129, "answer_count": 1, "score": 1, "last_activity_date": 1431126552, "creation_date": 1431091558, "question_id": 30125018, "link": "https://stackoverflow.com/questions/30125018/mongolab-delete-multiple-collections-using-http-put-via-curl-golang-http-not-wor", "title": "MongoLab Delete Multiple collections using HTTP PUT via CURL/Golang-http not working", "body": "<p>Im trying to delete multiple Documents in a collection in my MongoDb database hosted in MongoLab Services via their HTTP interface . Here is the CURL request i'm using in trying to achieve it </p>\n\n<pre><code> curl -H \"Content-Type: application/json\" -X PUT  \"https://api.mongolab.com/api/1/databases/mydb/collections/mycoll?q={\\\"person\\\":\\\"554b3d1ae4b0e2832aeeb6af\\\"}&amp;apiKey=xxxxxxxxxxxxxxxxx\"\n</code></pre>\n\n<p>I essentially  want all the documents with the matching query to deleted from the collection . \nThe Mongolab doc at <a href=\"http://docs.mongolab.com/restapi/#view-edit-delete-document\" rel=\"nofollow\">http://docs.mongolab.com/restapi/#view-edit-delete-document</a> suggests <code>\"Specifying an empty list in the body is equivalent to deleting the documents matching the query.\"</code> . But how do i send empty list in PUT request body ?</p>\n\n<p>Here is the Golang code im using to achieve the above PUT request </p>\n\n<pre><code>client := &amp;http.Client{}\npostRequestToBeSentToMongoLab, err := http.NewRequest(\"PUT\",\"https://api.mongolab.com/api/1/databases/mydb/collections/mycoll?q={\\\"person\\\":\\\"554b3d1ae4b0e2832aeeb6af\\\"}&amp;apiKey=xxxxxxxxxxxxxxxxx\",nil )\npostRequestToBeSentToMongoLab.Header.Set(\"Content-Type\", \"application/json\") //http://stackoverflow.com/questions/24455147/go-lang-how-send-json-string-in-post-request\nresponseFromMongoLab, err := client.Do(postRequestToBeSentToMongoLab)\n</code></pre>\n\n<p>It returns <code>null</code> is in both the cases (case of PUT request by Golang and CURL ) . How to get this working so that it deletes all documents matching the query ?</p>\n"}, {"tags": ["javascript", "json", "google-app-engine", "go", "google-cloud-storage"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 2284019, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5da76f7ed150b38a3db00413d3976f67?s=128&d=identicon&r=PG", "display_name": "Dede", "link": "https://stackoverflow.com/users/2284019/dede"}, "edited": false, "score": 0, "creation_date": 1431170380, "post_id": 30136311, "comment_id": 48387431, "body": "Hi Caleb, your code is working nicely, thanks! You are right, the code is not well written, I&#39;m still prototyping and even more, I&#39;m still learning go. Anyway, I&#39;ll try to post a clearer code next time. Thanks a lot and sorry for the confusion."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 0, "last_activity_date": 1431148615, "creation_date": 1431148615, "answer_id": 30136311, "question_id": 30124515, "link": "https://stackoverflow.com/questions/30124515/upload-json-array-from-gae-to-cloud-storage-in-go/30136311#30136311", "title": "Upload Json Array from GAE to Cloud Storage in GO", "body": "<p>This code is very confusing but from what I can tell are you trying to do this:</p>\n\n<pre><code>func (d *saveData) createFile(fileName string, content userData) {\n    wc := storage.NewWriter(d.ctx, bucket, fileName)\n    wc.ContentType = \"text/plain\"\n    d.cleanUp = append(d.cleanUp, fileName)\n\n    //*** new code *******\n    io.Copy(wc, content)\n    //********************\n\n    if err := wc.Close(); err != nil {\n        d.errorf(\"createFile: unable to close bucket %q, file %q: %v\", bucket, fileName, err)\n        return\n    }\n}\n</code></pre>\n\n<p>You can't write an object directly to a file, it needs to be encoded first. I'm assuming you want json. You could do it this way:</p>\n\n<pre><code>bs, err := json.Marshal(content)\nif err != nil {\n  return err\n}\nio.Copy(wc, bytes.NewReader(bs))\n</code></pre>\n\n<p>But it would be better to use <code>json.NewEncoder</code>:</p>\n\n<pre><code>json.NewEncoder(wc).Encode(content)\n</code></pre>\n\n<p>Your <code>createUserFolder</code> can also be simplified (you don't need a buffer to concatenate strings):</p>\n\n<pre><code>func (d *saveData) createUserFolder() {\n    content := testA(d.r)\n    d.createFile(content.id + \"/\")\n}\n</code></pre>\n\n<p>I don't know what <code>testA</code> is supposed to mean, but it too can be simplified:</p>\n\n<pre><code>type UserData {\n  ID     string `json:\"id\"`\n  Age    string `json:\"age\"`\n  Gender string `json:\"gender\"`\n}\n\nfunc testA(r *http.Request) UserData {\n  defer r.Body.Close()\n  var obj struct {\n    User UserData `json:\"user\"`\n  }\n  err := json.NewDecoder(r.Body).Decode(&amp;obj)\n  if err != nil {\n      log.Println(\"Error: %s\", err)\n  }\n  return obj.User\n}\n</code></pre>\n\n<p>Use uppercase field names so that json can handle the conversion for you.</p>\n\n<p>There's probably a lot more refactoring to be done, but maybe that's enough to get started.</p>\n"}], "owner": {"reputation": 127, "user_id": 2284019, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5da76f7ed150b38a3db00413d3976f67?s=128&d=identicon&r=PG", "display_name": "Dede", "link": "https://stackoverflow.com/users/2284019/dede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 30136311, "answer_count": 1, "score": 0, "last_activity_date": 1431148615, "creation_date": 1431089917, "question_id": 30124515, "link": "https://stackoverflow.com/questions/30124515/upload-json-array-from-gae-to-cloud-storage-in-go", "title": "Upload Json Array from GAE to Cloud Storage in GO", "body": "<p>I trying to upload to google cloud storage a json array which is posted by an app engine application using the following code: </p>\n\n<pre><code>saveData : function saveData() {\n  var _this = this,\n      save = this.shadowRoot.querySelector('#save-data'),\n      subData = JSON.stringify(_this.app.userSession);\n\n  save.url=\"url\";\n  save.body = subData;\n  save.go();\n}\n</code></pre>\n\n<p>The posted message is handled in go with the code posted below. With this code I'm able to create a folder on the cloud storage bucket which is named with the user ID. What I would love to do is to copy into the folder the entire json array -i.e. the variable f in the code below. I tried with io.Copy(wc, f) but it gives me the following error: </p>\n\n<blockquote>\n  <p>cannot use content (type userData) as type io.Reader in argument to\n  io.Copy:\n          userData does not implement io.Reader (missing Read method)</p>\n</blockquote>\n\n<p>Obviously I'm doing something wrong, but I'm quite new to go and I'm totally stuck. Can someone help me?</p>\n\n<pre><code>package expt\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"golang.org/x/net/context\"\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/google\"\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/file\"\n    \"google.golang.org/appengine/urlfetch\"\n    \"google.golang.org/cloud\"\n    \"google.golang.org/cloud/storage\"\n)\n\nvar bucket = \"expt\"\n\nfunc init() {\n    http.HandleFunc(\"/\", handleStatic)\n    http.HandleFunc(\"/save\", saveJson)\n}\n\nfunc handleStatic(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Cache-Control\", \"no-cache\")\n    http.ServeFile(w, r, \"static/\"+r.URL.Path)\n}\n\ntype Result map[string]interface {\n}\n\ntype userData struct {\n    id     string\n    age    string\n    gender string\n}\n\nfunc testA(r *http.Request) userData {\n    defer r.Body.Close()\n    body, err := ioutil.ReadAll(r.Body)\n    var userDataCurr userData\n    if err != nil {\n        log.Printf(\"Couldn't read request body: %s\", err)\n    } else {\n        var f Result\n        err := json.Unmarshal(body, &amp;f)\n        if err != nil {\n            log.Println(\"Error: %s\", err)\n        } else {\n            user := f[\"user\"].(map[string]interface{})\n            userDataCurr.id = user[\"id\"].(string)\n        }\n    }\n    return userDataCurr\n}\n\n// saveData struct holds information needed to run the various saving functions.\ntype saveData struct {\n    c   context.Context\n    r   *http.Request\n    w   http.ResponseWriter\n    ctx context.Context\n    // cleanUp is a list of filenames that need cleaning up at the end of the saving.\n    cleanUp []string\n    // failed indicates that one or more of the saving steps failed.\n    failed bool\n}\n\nfunc (d *saveData) errorf(format string, args ...interface{}) {\n    d.failed = true\n    // log.Errorf(d.c, format, args...)\n}\n\n// testSave is the main saving entry point that calls the GCS operations.\nfunc saveJson(w http.ResponseWriter, r *http.Request) {\n\n    c := appengine.NewContext(r)\n    if bucket == \"\" {\n        var err error\n        if bucket, err = file.DefaultBucketName(c); err != nil {\n            // log.Errorf(c, \"failed to get default GCS bucket name: %v\", err)\n            return\n        }\n    }\n    hc := &amp;http.Client{\n        Transport: &amp;oauth2.Transport{\n            Source: google.AppEngineTokenSource(c, storage.ScopeFullControl),\n            Base:   &amp;urlfetch.Transport{Context: c},\n        },\n    }\n    ctx := cloud.NewContext(appengine.AppID(c), hc)\n\n    d := &amp;saveData{\n        c:   c,\n        r:   r,\n        w:   w,\n        ctx: ctx,\n    }\n\n    d.createUserFolder()\n\n}\n\n// createFile creates a file in Google Cloud Storage.\nfunc (d *saveData) createFile(fileName string) {\n\n    wc := storage.NewWriter(d.ctx, bucket, fileName)\n    wc.ContentType = \"text/plain\"\n    d.cleanUp = append(d.cleanUp, fileName)\n\n    if err := wc.Close(); err != nil {\n        d.errorf(\"createFile: unable to close bucket %q, file %q: %v\", bucket, fileName, err)\n        return\n    }\n}\n\n//create files that will be used by listBucket.\nfunc (d *saveData) createUserFolder() {\n    var (\n        content = testA(d.r)\n        buffer  bytes.Buffer\n    )\n\n    buffer.WriteString(content.id)\n    buffer.WriteString(\"/\")\n    d.createFile(buffer.String())\n}\n</code></pre>\n"}, {"tags": ["php", "sockets", "go"], "comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 1, "creation_date": 1431076579, "post_id": 30119881, "comment_id": 48350211, "body": "you go  code is full of build error   no new variables on left side of :=,  undefined: msg, readlen declared and not used FIX THE BUILD ERROR"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1431078729, "post_id": 30119881, "comment_id": 48351475, "body": "PHP is probably closing the socket after exiting. What happens if you add <code>socket_set_block($socket);</code> before the write and <code>sleep(60);</code> at the end of your PHP script?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1431091056, "post_id": 30119881, "comment_id": 48359253, "body": "What&#39;s the output of <code>go env</code> and <code>go version</code>?"}], "owner": {"reputation": 195, "user_id": 3713080, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/db1744b22f6bc4ca7bed18b81dd555a9?s=128&d=identicon&r=PG&f=1", "display_name": "user3713080", "link": "https://stackoverflow.com/users/3713080/user3713080"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "closed_date": 1431115151, "answer_count": 0, "score": 0, "last_activity_date": 1431076899, "creation_date": 1431075765, "last_edit_date": 1431076899, "question_id": 30119881, "link": "https://stackoverflow.com/questions/30119881/go-php-socket-communication", "closed_reason": "Duplicate", "title": "Go &amp; PHP socket communication", "body": "<p>I have created a connection between a PHP script and Go with the following code:</p>\n\n<blockquote>\n  <p>Go (server):</p>\n</blockquote>\n\n<pre><code>ln, err1 := net.Listen(\"tcp\", \":5432\")\nif err1 != nil{\n    fmt.Println(err1.Error())\n    return\n}\nconn, err2 := ln.Accept()\nif err2 != nil{\n    fmt.Println(err2.Error())\n    return\n}\n\nbuf := make([]byte, 11)\n_, err3:= conn.Read(buf)\nif err3 != nil{\n    fmt.Println(err3.Error())\n    return\n}\nfmt.Println(string(buf))\n\n_, err := conn.Write([]byte(\"HELLO WORLD\"))\nif err != nil {\n    fmt.Println(err.Error())\n    return\n}\n</code></pre>\n\n<blockquote>\n  <p>PHP (Client):</p>\n</blockquote>\n\n<pre><code>$address = gethostbyaddr(\"localhost\"); \n$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\n\nif($socket === false){\n    echo \"socket_create() failed: reason: \" . socket_strerror(socket_last_error());\n}\n\n$result = socket_connect($socket, $address, 5432); \nif ($result === false) {\n    echo \"socket_connect() failed.\\nReason: ($result) \" . socket_strerror(socket_last_error($socket));\n} \n\nif($socket!==false &amp;&amp; $result!==false)\n    echo \"ok\";\n\nsocket_write($socket, \"hello world\", 11); \nfflush($socket);\nif($out = socket_read($socket, 4)){ \n    echo $out;\n}\n</code></pre>\n\n<p>I can connect and receive \"hello world\" on the Go server. <br> \n<strong>Problem:</strong> When I try to send something back to PHP. All I get is \"<em>invalid argument</em>\" at <code>_, err := conn.Write([]byte(msg + \"\\n\"))</code>.</p>\n"}, {"tags": ["go", "liteide"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1431066903, "post_id": 30117155, "comment_id": 48344857, "body": "Slashes on the end of both paths revert to the first quoted error."}], "answers": [{"comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1431070769, "post_id": 30117889, "comment_id": 48346900, "body": "Ah, yeah, that was the problem.   It switched in the middle of the session because I must have stray clicked and switched my target from linux64 to linux32 - the linux32.env had the buggy GOROOT entry (GOROOT=$HOME/go).  Ugh, that should not override environment.  TYVM"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1431070944, "post_id": 30117889, "comment_id": 48346992, "body": "@BadZen Great! I have included your comment in the answer for more visibility."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1431070927, "last_edit_date": 1495540262, "creation_date": 1431069065, "answer_id": 30117889, "question_id": 30117155, "link": "https://stackoverflow.com/questions/30117155/liteide-setting-goroot-to-gopath-when-run/30117889#30117889", "title": "liteide setting GOROOT to GOPATH when run", "body": "<p>You can check if GOROOT is set at all in <code>/usr/share/liteide/liteenv/linux*.env</code> (which can be an <a href=\"https://github.com/visualfc/liteide/issues/201\" rel=\"nofollow noreferrer\">issue as reported in here</a>)<br>\nYou can also check if <a href=\"https://stackoverflow.com/a/18166659/6309\">GOROOT is set in other place as well</a>.</p>\n\n<p>Finally check if the issue persists with the <a href=\"https://github.com/visualfc/liteide/releases\" rel=\"nofollow noreferrer\">latest liteide (x27.2.1)</a>.</p>\n\n<hr>\n\n<p>The <a href=\"https://stackoverflow.com/users/675723/badzen\">OP BadZen</a> confirms <a href=\"https://stackoverflow.com/questions/30117155/liteide-setting-goroot-to-gopath-when-run/30117889#comment48346900_30117889\">in the comments</a>:</p>\n\n<blockquote>\n  <p>It switched in the middle of the session because I must have stray clicked and switched my target from <code>linux64</code> to <code>linux32</code> - the <code>linux32.env</code> had the buggy <code>GOROOT</code> entry (<code>GOROOT=$HOME/go</code>).</p>\n</blockquote>\n"}], "owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2063, "favorite_count": 1, "accepted_answer_id": 30117889, "answer_count": 1, "score": 3, "last_activity_date": 1431070927, "creation_date": 1431066524, "last_edit_date": 1431066853, "question_id": 30117155, "link": "https://stackoverflow.com/questions/30117155/liteide-setting-goroot-to-gopath-when-run", "title": "liteide setting GOROOT to GOPATH when run", "body": "<p>In the middle of a development session, this stupid behavior started and now it looks permanent.  I have no idea what happened:</p>\n\n<pre><code>[dtrombley@sleet bin]$ echo $GOROOT\n/usr/lib/golang\n[dtrombley@sleet bin]$ echo $GOPATH\n/home/dtrombley/go/\n[dtrombley@sleet bin]$ ./liteide\n</code></pre>\n\n<p>liteide build error:</p>\n\n<pre><code> ../../github.com/Sirupsen/logrus/writer.go:4:2: cannot find package \"bufio\" in any of:\n/home/dtrombley/go/src/bufio (from $GOROOT)\n/home/dtrombley/go/src/bufio (from $GOPATH)\n</code></pre>\n\n<p>What?   Why is it using GOPATH in place of GOROOT?  This used to work, and mysteriously switched to broken <em>while liteide was running</em>, from one build to the next, literally a few seconds later...  </p>\n\n<p>Has anyone seen this?  Is there some way I can inspect/set the GOROOT within liteide?</p>\n\n<p>[Edit]   Further weirdness:  I thought the / at the end of GOPATH might be confusing it, so I removed that.  Now:</p>\n\n<pre><code> [dtrombley@sleet bin]$ echo $GOROOT\n /usr/lib/golang\n [dtrombley@sleet bin]$ echo $GOPATH\n /home/dtrombley/go\n [dtrombley@sleet bin]$ ./liteide\n</code></pre>\n\n<p>...</p>\n\n<pre><code>warning: GOPATH set to GOROOT (/home/dtrombley/go) has no effect\n../../github.com/Sirupsen/logrus/writer.go:4:2: cannot find package \"bufio\" in any of:\n/home/dtrombley/go/src/bufio (from $GOROOT)\n($GOPATH not set)\n</code></pre>\n\n<p>Misery.</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 1175, "user_id": 407866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7be01021f310d85a540778fcc24b1c6?s=128&d=identicon&r=PG", "display_name": "Christian Siegert", "link": "https://stackoverflow.com/users/407866/christian-siegert"}, "edited": false, "score": 0, "creation_date": 1431178787, "post_id": 30117264, "comment_id": 48389867, "body": "Thank you for this very detailed answer."}, {"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1440055470, "post_id": 30117264, "comment_id": 52117202, "body": "Cursors and offset seem to now be implemented in the source code on Github...any idea when this might be available on GAE?"}, {"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 0, "creation_date": 1448582167, "post_id": 30117264, "comment_id": 55656023, "body": "Since this was written it has become available on GAE (in both the classic &quot;appengine&quot; packages and the ones at google.golang.org)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1448607226, "last_edit_date": 1448607226, "creation_date": 1431066909, "answer_id": 30117264, "question_id": 30113476, "link": "https://stackoverflow.com/questions/30113476/google-app-engine-search-for-go-how-to-paginate/30117264#30117264", "title": "Google App Engine Search for Go: How to paginate?", "body": "<p><strong>EDIT: Good News!</strong> Since writing this answer, Cursors for the Search API has been completed and published, and so it's generally available.</p>\n\n<p>Check out the <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#Cursor\" rel=\"nofollow\"><code>Cursor</code></a> type. A <code>Cursor</code> value may be specified in the <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#Cursor\" rel=\"nofollow\"><code>SearchOptions</code></a>. So when you call <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#Index.Search\" rel=\"nofollow\"><code>Index.Search()</code></a>, you may pass a <code>SearchOptions</code> with a <code>Cursor</code> you obtained previously from <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#Iterator.Cursor\" rel=\"nofollow\"><code>Iterator.Cursor()</code></a>.</p>\n\n<p>Original answer follows below.</p>\n\n<hr>\n\n<p>You are out of luck.</p>\n\n<p>In general Cursors are supported for the Search API (for example see <a href=\"https://cloud.google.com/appengine/docs/java/search/results#Java_Using_cursors\" rel=\"nofollow\">Java Using cursors</a>) and it is also implemented in Go, but the cursor API for searches is incomplete and not exported.</p>\n\n<p>For evidence see the source of <a href=\"https://github.com/golang/appengine/blob/master/search/search.go\" rel=\"nofollow\">search/search.go</a>: the <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#Iterator\" rel=\"nofollow\"><code>Iterator</code></a> type (returned by both <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#Index.List\" rel=\"nofollow\"><code>Index.List()</code></a> and <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#Index.Search\" rel=\"nofollow\"><code>Index.Search()</code></a> methods) has an unexported <code>searchCursor</code> field (currently line #602) which is exactly what we think it is, and it is used internally, it is just not exported.</p>\n\n<p>If you check the source of the <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#SearchOptions\" rel=\"nofollow\"><code>SearchOptions</code></a> struct in the same source file (search/search.go) (this is what you can pass to the <a href=\"https://cloud.google.com/appengine/docs/go/search/reference#Index.Search\" rel=\"nofollow\"><code>Index.Search()</code></a> method when initiating/performing searches):</p>\n\n<pre><code>// Currently starts at line #464:\ntype SearchOptions struct {\n    ...\n    // TODO: cursor, offset, maybe others.\n}\n</code></pre>\n\n<p>So there is plan to add support for Search cursors, offsets and others, it is just not yet implemented and exported. Hopefully will get added in a future release.</p>\n"}], "owner": {"reputation": 1175, "user_id": 407866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7be01021f310d85a540778fcc24b1c6?s=128&d=identicon&r=PG", "display_name": "Christian Siegert", "link": "https://stackoverflow.com/users/407866/christian-siegert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 30117264, "answer_count": 1, "score": 4, "last_activity_date": 1448607226, "creation_date": 1431042208, "question_id": 30113476, "link": "https://stackoverflow.com/questions/30113476/google-app-engine-search-for-go-how-to-paginate", "title": "Google App Engine Search for Go: How to paginate?", "body": "<p>If I query Google App Engine Search for Go, e.g. for the first 10 results, how do I do a follow-up query that fetches the next 10 results? There are no cursors I\u2019m aware of.</p>\n"}, {"tags": ["go", "private", "godoc"], "answers": [{"comments": [{"owner": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "edited": false, "score": 0, "creation_date": 1431027456, "post_id": 30110028, "comment_id": 48331145, "body": "Sorry for leaving this important part out: My private struct has an intricate construction process, so I did not want any consumer of the package to be able to circumvent the factory method. Your proposed solution would allow for that. If going that way would be feasible, I could have made privatestruct public in the first place. Or am I missing out on a cool trick here?"}, {"owner": {"reputation": 15285, "user_id": 113158, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48b539a26d13f6c9e40081805d8f47ac?s=128&d=identicon&r=PG", "display_name": "Jean Hominal", "link": "https://stackoverflow.com/users/113158/jean-hominal"}, "reply_to_user": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "edited": false, "score": 1, "creation_date": 1431028093, "post_id": 30110028, "comment_id": 48331550, "body": "@PeterHommel: The fields are private, so API clients cannot set them. That means, the only thing that API clients can do if they try and work around your constructor is get a zero value. Who cares? But if you do not like it, then just define a public interface with all of the struct&#39;s public methods, and return that instead."}, {"owner": {"reputation": 15285, "user_id": 113158, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48b539a26d13f6c9e40081805d8f47ac?s=128&d=identicon&r=PG", "display_name": "Jean Hominal", "link": "https://stackoverflow.com/users/113158/jean-hominal"}, "edited": false, "score": 1, "creation_date": 1431028227, "post_id": 30110028, "comment_id": 48331645, "body": "However, I would seriously go with simply making a public, all-fields private struct - that seems the most go-like, and is a pattern that appears in the standard library."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "edited": false, "score": 0, "creation_date": 1431028369, "post_id": 30110028, "comment_id": 48331722, "body": "@PeterHommel: See my revised answer."}, {"owner": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "edited": false, "score": 0, "creation_date": 1431028766, "post_id": 30110028, "comment_id": 48331945, "body": "@peterSO: Although I am beginning to think that I may be over-encapsulating a bit, your latter solution is really inventive!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1431029008, "last_edit_date": 1431029008, "creation_date": 1431026953, "answer_id": 30110028, "question_id": 30109674, "link": "https://stackoverflow.com/questions/30109674/documenting-public-methods-on-private-structs-via-godoc-in-go/30110028#30110028", "title": "Documenting public methods on private structs via Godoc in Go", "body": "<p><code>PublicFunction</code> uses <code>PublicStruct</code> whose private fields will be private with private documentation. For example,</p>\n\n<pre><code>package godocprivate\n\ntype PublicInterface interface {\n    PublicFunction()\n}\n\ntype privatestruct struct {\n}\n\n// PublicStruct is something to be documented except for private fields\ntype PublicStruct struct {\n    privatestruct\n}\n\nfunc NewPublic() *PublicStruct {\n    ps := &amp;PublicStruct{}\n    return ps\n}\n\n// PublicFunction does something to be documented\nfunc (p *PublicStruct) PublicFunction() {\n}\n</code></pre>\n\n<p>When <code>PublicStruct</code> is created it initially has zero values for each field. If that's not enough, introduce a factory boolean. For example,</p>\n\n<pre><code>package godocprivate\n\ntype PublicInterface interface {\n    PublicFunction()\n}\n\ntype privatestruct struct {\n}\n\n// PublicStruct is something to be documented except for private fields\ntype PublicStruct struct {\n    factory bool\n    privatestruct\n}\n\nfunc NewPublic() *PublicStruct {\n    ps := &amp;PublicStruct{factory: true}\n    return ps\n}\n\n// PublicFunction does something to be documented\nfunc (p *PublicStruct) PublicFunction() {\n    if !p.factory {\n        panic(\"Use NewPublic\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1421, "favorite_count": 1, "accepted_answer_id": 30110028, "answer_count": 1, "score": 2, "last_activity_date": 1431029008, "creation_date": 1431025690, "question_id": 30109674, "link": "https://stackoverflow.com/questions/30109674/documenting-public-methods-on-private-structs-via-godoc-in-go", "title": "Documenting public methods on private structs via Godoc in Go", "body": "<p>I have a private struct (actually more than one, I simplified a bit for this example) which I have a public function on, that satisfies a public interface.\nThis struct is created via a factory method (NewX-style):</p>\n\n<pre><code>package godocprivate\n\ntype PublicInterface interface {\n    PublicFunction()\n}\n\ntype privatestruct struct {\n}\n\nfunc NewPublic() *privatestruct {\n    ps := &amp;privatestruct{}\n    return ps\n}\n\n// PublicFunction does something to be documented\nfunc (self *privatestruct) PublicFunction() {\n}\n</code></pre>\n\n<p>I <strong>cannot</strong> make the factory method <strong>return the public interface</strong>, because there are other interfaces to be satisfied by the returned value, in my project.</p>\n\n<p>I do want to document PublicFunction() via godoc, but because it is on a private struct, it does not show up:</p>\n\n<p><img src=\"https://i.stack.imgur.com/NhxHD.png\" alt=\"This is how Godoc of the above looks like\"></p>\n\n<p>Is there any way, trick, workaround, etc. to make privatestruct.PublicFunction() visible in Godoc?</p>\n\n<p>My actual use case is even more severe: I do have more than one private struct. All of them satisfy PublicInterface, but the inner workings of their respective PublicFunction-implementations differ, hence could their documentations need to be different, too...</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 3, "creation_date": 1431024612, "post_id": 30109061, "comment_id": 48329586, "body": "I&#39;m pretty sure the standard xml package can do that. and if not, try goquery <a href=\"https://github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">github.com/PuerkitoBio/goquery</a>"}, {"owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1431026361, "post_id": 30109061, "comment_id": 48330539, "body": "@Not_a_Golfer I attempted to used the standard XML package, however I have not been able to get it to read child/nested tags within the body as a string. For example: &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Title of the document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;body content &lt;p&gt;more content&lt;/p&gt;&lt;/body&gt;&lt;/html&gt; will return body content, ignoring the subsequent &lt;p&gt; tags and the text they wrap."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431028684, "post_id": 30109061, "comment_id": 48331894, "body": "You could try the <a href=\"https://godoc.org/golang.org/x/net/html/\" rel=\"nofollow noreferrer\"><code>golang.org&#47;x&#47;net&#47;html</code></a> package."}, {"owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1431029028, "post_id": 30109061, "comment_id": 48332079, "body": "@DaveC I have been trying this as well. For the life of me I cannot get it to return nested tags the way in which I&#39;m expecting. Its the same issue in my reply to Not_a_Golfer"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431029279, "post_id": 30109061, "comment_id": 48332223, "body": "@user2737876 You should probably <a href=\"https://stackoverflow.com/posts/30109061/edit\">edit</a> the question to include the information in your first comment."}, {"owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431029435, "post_id": 30109061, "comment_id": 48332323, "body": "@DaveC I had not tried these before posting my original issue. I had tried been trying the package as you left your comment. Will edit the question accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 12822, "user_id": 87750, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9eb0c80f3b41463ed45f45584b065a9?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/87750/fredrik"}, "is_accepted": false, "score": 10, "last_activity_date": 1431038776, "last_edit_date": 1431038776, "creation_date": 1431036718, "answer_id": 30112550, "question_id": 30109061, "link": "https://stackoverflow.com/questions/30109061/golang-parse-html-extract-all-content-with-body-body-tags/30112550#30112550", "title": "Golang parse HTML, extract all content with &lt;body&gt; &lt;/body&gt; tags", "body": "<p>It can be done using the standard <code>encoding/xml</code> package. But it's a bit cumbersome. And one caveat in this example is that it will not include the enclosing body tag, but it will contain all of it's children.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/xml\"\n    \"fmt\"\n)\n\ntype html struct {\n    Body body `xml:\"body\"`\n}\ntype body struct {\n    Content string `xml:\",innerxml\"`\n}\n\nfunc main() {\n    b := []byte(`&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;\n            Title of the document\n        &lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        body content \n        &lt;p&gt;more content&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;`)\n\n    h := html{}\n    err := xml.NewDecoder(bytes.NewBuffer(b)).Decode(&amp;h)\n    if err != nil {\n        fmt.Println(\"error\", err)\n        return\n    }\n\n    fmt.Println(h.Body.Content)\n}\n</code></pre>\n\n<p>Runnable example:<br>\n<a href=\"http://play.golang.org/p/ZH5iKyjRQp\" rel=\"noreferrer\">http://play.golang.org/p/ZH5iKyjRQp</a></p>\n"}, {"comments": [{"owner": {"reputation": 501, "user_id": 3134155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxJSZ.jpg?s=128&g=1", "display_name": "18augst", "link": "https://stackoverflow.com/users/3134155/18augst"}, "edited": false, "score": 0, "creation_date": 1576884248, "post_id": 30112639, "comment_id": 105050368, "body": "That&#39;s very interesting solution, except that under the hood it uses <code>bufio</code>. This is not entirely good at causing additional memory allocation. Do you know any similar solution, but without the flaw above?"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 2, "last_activity_date": 1431037141, "creation_date": 1431037141, "answer_id": 30112639, "question_id": 30109061, "link": "https://stackoverflow.com/questions/30109061/golang-parse-html-extract-all-content-with-body-body-tags/30112639#30112639", "title": "Golang parse HTML, extract all content with &lt;body&gt; &lt;/body&gt; tags", "body": "<p>You could also do this purely with strings:</p>\n\n<pre><code>func main() {\n    r := strings.NewReader(`\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;\n            Title of the document\n        &lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        body content\n        &lt;p&gt;more content&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n`)\n    str := NewSkipTillReader(r, []byte(\"&lt;body&gt;\"))\n    rtr := NewReadTillReader(str, []byte(\"&lt;/body&gt;\"))\n    bs, err := ioutil.ReadAll(rtr)\n    fmt.Println(string(bs), err)\n}\n</code></pre>\n\n<p>The definitions for <code>SkipTillReader</code> and <code>ReadTillReader</code> are here: <a href=\"https://play.golang.org/p/6THLhRgLOa\" rel=\"nofollow\">https://play.golang.org/p/6THLhRgLOa</a>. (But basically skip until you see the delimiter and then read until you see the delimiter)</p>\n\n<p>This won't work for case insensitivity (though that wouldn't be hard to change). </p>\n"}, {"tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": false, "score": 6, "last_activity_date": 1431038136, "creation_date": 1431038136, "answer_id": 30112811, "question_id": 30109061, "link": "https://stackoverflow.com/questions/30109061/golang-parse-html-extract-all-content-with-body-body-tags/30112811#30112811", "title": "Golang parse HTML, extract all content with &lt;body&gt; &lt;/body&gt; tags", "body": "<p>Since you didn't show the source code of your attempt with the html package, I'll have to guess what you were doing, but I suspect you were using the tokenizer rather than the parser. Here is a program that uses the parser and does what you were looking for:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"strings\"\n\n    \"github.com/andybalholm/cascadia\"\n    \"golang.org/x/net/html\"\n)\n\nfunc main() {\n    r := strings.NewReader(`&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;\n            Title of the document\n        &lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        body content \n        &lt;p&gt;more content&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;`)\n    doc, err := html.Parse(r)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    body := cascadia.MustCompile(\"body\").MatchFirst(doc)\n    html.Render(os.Stdout, body)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 409, "user_id": 3088592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be12b560b191bd1f592932ca24d613a?s=128&d=identicon&r=PG&f=1", "display_name": "dhoelle", "link": "https://stackoverflow.com/users/3088592/dhoelle"}, "edited": false, "score": 10, "creation_date": 1495507543, "post_id": 38855264, "comment_id": 75268831, "body": "IMO this should be the accepted answer. HTML is not a subset of XML, and <code>encoding&#47;xml</code>-based approaches will fail if the source HTML includes non-XML such as <code>&lt;meta charset=&quot;UTF-8&quot;&gt;</code>."}, {"owner": {"reputation": 325, "user_id": 8618438, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TfmU3we5fjg/AAAAAAAAAAI/AAAAAAAAAEc/h_kTa9TmWIY/photo.jpg?sz=128", "display_name": "stand alone", "link": "https://stackoverflow.com/users/8618438/stand-alone"}, "edited": false, "score": 3, "creation_date": 1542976600, "post_id": 38855264, "comment_id": 93766476, "body": "I think we can add <code>return</code> after <code>b = n</code> in closure body to prevent unnecessary work"}, {"owner": {"reputation": 10223, "user_id": 7032856, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh6.googleusercontent.com/-v2P-pqI1pww/AAAAAAAAAAI/AAAAAAAAABg/BHOFSOpQ0BM/photo.jpg?sz=128", "display_name": "Nae", "link": "https://stackoverflow.com/users/7032856/nae"}, "edited": false, "score": 1, "creation_date": 1603887471, "post_id": 38855264, "comment_id": 114177074, "body": "You may need to <code>go get golang.org&#47;x&#47;net&#47;html</code> beforehand."}], "tags": [], "owner": {"reputation": 531, "user_id": 1002564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ULP7X.png?s=128&g=1", "display_name": "Joachim Birche", "link": "https://stackoverflow.com/users/1002564/joachim-birche"}, "is_accepted": false, "score": 47, "last_activity_date": 1571357027, "last_edit_date": 1571357027, "creation_date": 1470757732, "answer_id": 38855264, "question_id": 30109061, "link": "https://stackoverflow.com/questions/30109061/golang-parse-html-extract-all-content-with-body-body-tags/38855264#38855264", "title": "Golang parse HTML, extract all content with &lt;body&gt; &lt;/body&gt; tags", "body": "<p>This can be solved by recursively finding the body node, using the html package, and subsequently render the html, starting from that node.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"errors\"\n    \"fmt\"\n    \"golang.org/x/net/html\"\n    \"io\"\n    \"strings\"\n)\n\nfunc Body(doc *html.Node) (*html.Node, error) {\n    var body *html.Node\n    var crawler func(*html.Node)\n    crawler = func(node *html.Node) {\n        if node.Type == html.ElementNode &amp;&amp; node.Data == \"body\" {\n            body = node\n            return\n        }\n        for child := node.FirstChild; child != nil; child = child.NextSibling {\n            crawler(child)\n        }\n    }\n    crawler(doc)\n    if body != nil {\n        return body, nil\n    }\n    return nil, errors.New(\"Missing &lt;body&gt; in the node tree\")\n}\n\nfunc renderNode(n *html.Node) string {\n    var buf bytes.Buffer\n    w := io.Writer(&amp;buf)\n    html.Render(w, n)\n    return buf.String()\n}\n\nfunc main() {\n    doc, _ := html.Parse(strings.NewReader(htm))\n    bn, err := Body(doc)\n    if err != nil {\n        return\n    }\n    body := renderNode(bn)\n    fmt.Println(body)\n}\n\nconst htm = `&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    body content\n    &lt;p&gt;more content&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;`\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54931, "favorite_count": 8, "answer_count": 4, "score": 28, "last_activity_date": 1571357027, "creation_date": 1431023644, "last_edit_date": 1451877847, "question_id": 30109061, "link": "https://stackoverflow.com/questions/30109061/golang-parse-html-extract-all-content-with-body-body-tags", "title": "Golang parse HTML, extract all content with &lt;body&gt; &lt;/body&gt; tags", "body": "<p>As stated in the title. I am needing to return all of the content within the body tags of an html document, including any subsequent html tags, etc. Im curious to know what the best way to go about this is. I had a working solution with the Gokogiri package, however I am trying to stay away from any packages that depend on C libraries. Is there a way to accomplish this with the go standard library? or with a package that is 100% go? </p>\n\n<p>Since posting my original question I have attempted to use the following packages that have yielded no resolution. (Neither of which seem to return subsequent children or nested tags from inside the body.  For example: </p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;\n            Title of the document\n        &lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        body content \n        &lt;p&gt;more content&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt; \n</code></pre>\n\n<p>will return body content, ignoring the subsequent <code>&lt;p&gt;</code> tags and the text they wrap):</p>\n\n<ul>\n<li>pkg/encoding/xml/ (standard library xml package)</li>\n<li>golang.org/x/net/html</li>\n</ul>\n\n<p>The over all goal would be to obtain a string or content that would look like:</p>\n\n<pre><code>&lt;body&gt;\n    body content \n    &lt;p&gt;more content&lt;/p&gt;\n&lt;/body&gt;\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1431028531, "post_id": 30108562, "comment_id": 48331807, "body": "On the sending side, if it&#39;s a buffered channel with room then the data gets buffered. Otherwise it depends on if the writer blocks or not, and if it doesn&#39;t block if it retries or continues on and drops the data. The other way to drop/ignore data is for a reader to exit without ever reading buffered items."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431028112, "post_id": 30108758, "comment_id": 48331565, "body": "Minor correction, <code>time.NewTimer</code> uses a buffered channel so that it cannot block. It will write the time into the buffer and either later someone reads it or, if the timer&amp;channel are no longer referenced, they&#39;ll get garbage collected eventually."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431028190, "post_id": 30108758, "comment_id": 48331618, "body": "Related, <code>time.NewTicker</code> also uses a channel with a buffer size of one and does non-blocking sends. It is documented as dropping ticks if the reader gets behind (if the buffer is already full the next tick gets dropped)."}, {"owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431028208, "post_id": 30108758, "comment_id": 48331626, "body": "Thanks for the clarification. I didn&#39;t bother to look at the source to see whether the channel is buffered."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431028272, "post_id": 30108758, "comment_id": 48331670, "body": "it&#39;s a minor implementation detail, your answer is still correct."}], "tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": true, "score": 3, "last_activity_date": 1431022599, "creation_date": 1431022599, "answer_id": 30108758, "question_id": 30108562, "link": "https://stackoverflow.com/questions/30108562/can-data-coming-from-different-channels-into-select-statement-get-ignored/30108758#30108758", "title": "Can data coming from different channels into select statement get ignored?", "body": "<p>When the timer expires, it will send the current time on C. If no one is reading from C at the time, the send will block, so it will wait until the value is received. In this case, it will wait till the next iteration of the loop.</p>\n\n<p>Channels are designed to be  a synchronization mechanism, so they don't require readers and writers to be already synchronized.</p>\n"}], "owner": {"reputation": 8717, "user_id": 73249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa58ce9763beb48289b05c19f716bcd8?s=128&d=identicon&r=PG", "display_name": "Sahas", "link": "https://stackoverflow.com/users/73249/sahas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 30108758, "answer_count": 1, "score": 2, "last_activity_date": 1431022599, "creation_date": 1431021866, "question_id": 30108562, "link": "https://stackoverflow.com/questions/30108562/can-data-coming-from-different-channels-into-select-statement-get-ignored", "title": "Can data coming from different channels into select statement get ignored?", "body": "<p>Is it possible for data coming in through a channel in golang to get ignored if it is not caught at the right moment inside a select statement?</p>\n\n<p>For example,  lets say there is this select statement:</p>\n\n<pre><code>for {\n    select {\n    case &lt;-timer.C:\n        //block A\n    default:\n        // block B takes 2 seconds.\n    }\n}\n</code></pre>\n\n<p>If timer ends while block B is running,  does block A still run in the next iteration of the loop or does the channel's incoming data get lost?</p>\n"}, {"tags": ["error-handling", "go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 4846435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AQQye2-d0e4/AAAAAAAAAAI/AAAAAAAABig/uprMuwHLDjA/photo.jpg?sz=128", "display_name": "Alan Conway", "link": "https://stackoverflow.com/users/4846435/alan-conway"}, "edited": false, "score": 0, "creation_date": 1431369761, "post_id": 30108307, "comment_id": 48456531, "body": "That&#39;s really helpful. I like the abort channel being created by the caller. I did that already for message acknowledgements but somehow I didn&#39;t consider it for errors."}, {"owner": {"reputation": 186, "user_id": 4846435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AQQye2-d0e4/AAAAAAAAAAI/AAAAAAAABig/uprMuwHLDjA/photo.jpg?sz=128", "display_name": "Alan Conway", "link": "https://stackoverflow.com/users/4846435/alan-conway"}, "edited": false, "score": 0, "creation_date": 1431369983, "post_id": 30108307, "comment_id": 48456663, "body": "I don&#39;t follow this: &quot;I would never have the worker close the channel it writes on&quot; I thought it was only safe to close from the write end. Who should close the channel?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 186, "user_id": 4846435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AQQye2-d0e4/AAAAAAAAAAI/AAAAAAAABig/uprMuwHLDjA/photo.jpg?sz=128", "display_name": "Alan Conway", "link": "https://stackoverflow.com/users/4846435/alan-conway"}, "edited": false, "score": 0, "creation_date": 1431371646, "post_id": 30108307, "comment_id": 48457632, "body": "@AlanConway yeah, that doesn&#39;t make sense... I will edit it. The writer should close it&#39;s channel and return from the abort case."}, {"owner": {"reputation": 18949, "user_id": 427457, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Iwfoc.jpg?s=128&g=1", "display_name": "Roman Podlinov", "link": "https://stackoverflow.com/users/427457/roman-podlinov"}, "edited": false, "score": 0, "creation_date": 1521477060, "post_id": 30108307, "comment_id": 85736619, "body": "it would be very useful to have some simple code example as addition for the answer."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 5, "last_activity_date": 1431371597, "last_edit_date": 1431371597, "creation_date": 1431020975, "answer_id": 30108307, "question_id": 30108058, "link": "https://stackoverflow.com/questions/30108058/how-to-handle-asynchronous-errors-in-go/30108307#30108307", "title": "How to handle asynchronous errors in Go?", "body": "<p>Your question is a bit on the broad side but I'll try to give some guidance based on my experience writing highly concurrent code...</p>\n\n<p>Personally I think making the channel a property of the object that gets initialized in a nice helpful <code>NewMyObject() *MyObject</code> method is good design pattern. It makes it so code using the object doesn't have to do boiler plate set up every time it wants to call some asynchronous method the type offers.</p>\n\n<p><code>For readers: I can close the channel, but no error info. I could pass a struct { data, error } or use a second channel. Pros &amp; cons? Other ideas?</code></p>\n\n<p>Let the reader signal to return by closing the abort channel. The reader should simply use the <code>temp, err := &lt;-FromChannel</code> paradigm and move on with execution if the data or error channel has closed. This should prevent the 'send on closed channel' panics error from the workers since they will close their channel and return. When <code>err != nil</code> the reader will know to move on.</p>\n\n<p><code>For writers: I can't close without a panic so I guess I need a second channel. Is this idiomatic?</code></p>\n\n<p>Yes. Sadly I was quite pissed of with the uni-directional behavior of channels and though it should be abstracted. Regardless, it's not. In my code I <strong><em>would not</em></strong> define this on the object that does work asynchronously. The paradigm I prefer is to use the closing signal (since sending a on a channel is not one-to-many, only one goroutine will read that). Instead, I allocate the abort channel in the calling code and if things need to shut down you close the <code>abort</code> channel and all the goroutines doing asynchronous work who are listening on that channel do their clean up and return. You should also use a WaitGroup so you can wait for the goroutines to return before moving on.</p>\n\n<p>So my basic summary;</p>\n\n<p>1) let the caller of asynchronous methods signal it's time to stop, not the other way around. A waitgroup is better used to coordinate their returns</p>\n\n<p>2) use a <code>sync.WaitGroup</code> in the calling code to know when your goroutines are finished so you can move on</p>\n\n<p>3) allocate your error channel in the calling code and take advantage of the one-to-many signal produced by closing the channel; if you send on a channel you allocate in the caller, only a single instance will read from it. If you put one on each instance you have to iterate a collection of instances to send the on each.</p>\n\n<p>4) if you have a type that provide async methods that do work in the background, set up the channels to read off of in it's initializer, document the async methods saying where to listen for data, provide an example of a non-blocking select that passes an abort channel into the async method and listens on the methods data and error channels. If you need to kill a single routine you could accomplish this by closing one of the channels it owns rather than killing them all by closing the callers <code>abort</code> channel.</p>\n\n<p>Hopefully that all makes sense.</p>\n"}], "owner": {"reputation": 186, "user_id": 4846435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AQQye2-d0e4/AAAAAAAAAAI/AAAAAAAABig/uprMuwHLDjA/photo.jpg?sz=128", "display_name": "Alan Conway", "link": "https://stackoverflow.com/users/4846435/alan-conway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1767, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521477477, "creation_date": 1431020100, "last_edit_date": 1521477477, "question_id": 30108058, "link": "https://stackoverflow.com/questions/30108058/how-to-handle-asynchronous-errors-in-go", "title": "How to handle asynchronous errors in Go?", "body": "<p>I am working on my first real Go project, a messaging API. I use channels to pass messages and other data between user goroutines and library goroutines that use a thread-unsafe, event-based C protocol library. For details <a href=\"https://github.com/apache/qpid-proton/blob/master/proton-c/bindings/go/README.md\" rel=\"nofollow noreferrer\">https://github.com/apache/qpid-proton/blob/master/proton-c/bindings/go/README.md</a></p>\n\n<p>My question is in 2 related parts:</p>\n\n<p><strong>1. What are common idioms for handling errors across channels?</strong> </p>\n\n<p>The goroutine at one end blows up, how do I ensure the other end unblocks, gets an <code>error</code> value and doesn't get blocked again later?</p>\n\n<p><em>For readers:</em> </p>\n\n<ul>\n<li>I can close the channel, but no error info. </li>\n<li>I could pass a <code>struct { data, error }</code> </li>\n<li>or use a second channel. </li>\n</ul>\n\n<p>Pros &amp; cons? Other ideas?</p>\n\n<p><em>For writers:</em> I can't close without a panic so I guess I need a second channel.  Is this idiomatic?</p>\n\n<pre><code>select {\n    case sendChan &lt;- data: sentOk()\n    case err := &lt;- errChan: oops(err)\n}\n</code></pre>\n\n<p>I also can't write after close so I need to store the error somewhere and check before trying to write. Any other approaches?</p>\n\n<p><strong>2. Exposing channels in APIs.</strong></p>\n\n<p>I need channels to pass error info: should I make those channels public fields or hide them in methods?</p>\n\n<p>There is a tradeoff, and I don't have the experience to evaluate it:</p>\n\n<ul>\n<li><p>Exposing channels lets users select directly, but it requires them to correctly impement the error handling patterns (check for errors before write, select for error as well as write). This seems complex and error-prone but maybe that because I'm not seasoned in go.</p></li>\n<li><p>Hiding channels in a method simplifies and enforces correct use of the library. But now an async user must create their own goroutine and channel(s). They may just duplicate what the library does already, which is silly. Also there is an extra goroutine and channel on the path. Maybe that's not a big deal, but the data channel is <em>the</em> critical path for my library and I think it has to be hidden along with the error channel.</p></li>\n</ul>\n\n<p>I could do both: expose the channels for power users <em>and</em> provide a simple method wrapper for people with simple needs. That's more to support but worth it if neither alone can fit all cases.</p>\n\n<p>The standard net.Conn uses blocking methods, not channels, and I wrote goroutines to pump data to my C event-loop channel so I know it can be done, but I did not find it trivial. net.Conn is wrapping sytem calls not channels underneath so \"exposing the channels\" is not an option. Do any of the standard libraries export channels with error handling? (time.After doesn't count, there are no errors)</p>\n\n<p>Thanks a lot!\nAlan</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": false, "score": 9, "last_activity_date": 1431015461, "creation_date": 1431015461, "answer_id": 30106572, "question_id": 30106518, "link": "https://stackoverflow.com/questions/30106518/golang-convert-date-with-time-to-seconds/30106572#30106572", "title": "golang: Convert date with time to seconds", "body": "<p>You can use <code>time.Parse</code> and then call <code>Unix</code> on the result:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/time/#Parse\">https://golang.org/pkg/time/#Parse</a></li>\n<li><a href=\"https://golang.org/pkg/time/#Time.Unix\">https://golang.org/pkg/time/#Time.Unix</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1431015764, "creation_date": 1431015764, "answer_id": 30106663, "question_id": 30106518, "link": "https://stackoverflow.com/questions/30106518/golang-convert-date-with-time-to-seconds/30106663#30106663", "title": "golang: Convert date with time to seconds", "body": "<p>There's a nice little package on GitHub to abstract the format matching part of <code>Parse</code> (it requires you provide a string to explain the format of your date); <a href=\"https://github.com/araddon/dateparse\" rel=\"nofollow\">https://github.com/araddon/dateparse</a></p>\n\n<p>You can just use <code>ParseAny</code> to get a <code>time.Time{}</code> call it <code>ts</code> then <code>ts.Unix</code> to get seconds. I would recommend it since <code>Parse</code> itself is extremely sensitive to it's input.</p>\n"}], "owner": {"reputation": 2138, "user_id": 2116520, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/84a8dc0af169f1b2b000e914ab6b9f96?s=128&d=identicon&r=PG", "display_name": "wwjdm", "link": "https://stackoverflow.com/users/2116520/wwjdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10017, "favorite_count": 0, "accepted_answer_id": 30106663, "answer_count": 2, "score": 1, "last_activity_date": 1612844075, "creation_date": 1431015301, "last_edit_date": 1431059630, "question_id": 30106518, "link": "https://stackoverflow.com/questions/30106518/golang-convert-date-with-time-to-seconds", "title": "golang: Convert date with time to seconds", "body": "<p>If I have date format: \"1/_2/2006, 15:04:05\"</p>\n\n<p>How to I convert the entire date to seconds. Is there a golang time method?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1431019087, "creation_date": 1431019087, "answer_id": 30107768, "question_id": 30106494, "link": "https://stackoverflow.com/questions/30106494/unmarshal-datastore-bytestring-go/30107768#30107768", "title": "Unmarshal datastore.ByteString go", "body": "<p>You need to use some intermediate type here. The json simply has a string, you can't directly unmarshal it into a <code>ByteString</code> without doing some custom unmarshaling implementation. Personally I would just use something like;</p>\n\n<pre><code>type jsonUser struct {\n    SubscriptionToken string\n}\n\ntype User struct {\n    SubscriptionToken datastore.ByteString\n}\n</code></pre>\n\n<p>Then provide a conversion method;</p>\n\n<pre><code>func NewUser(u jsonUser) *User {\n     return &amp;User{SubscriptionToken: StringToByteString(u.SubscriptionToken)}\n}\n</code></pre>\n\n<p>So, unmarshal into the <code>jsonUser</code> type then convert it to a <code>User</code></p>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 30107768, "answer_count": 1, "score": 0, "last_activity_date": 1471904300, "creation_date": 1431015226, "last_edit_date": 1471904300, "question_id": 30106494, "link": "https://stackoverflow.com/questions/30106494/unmarshal-datastore-bytestring-go", "title": "Unmarshal datastore.ByteString go", "body": "<p>Hi im trying to unmarshal  datastore entity that contain  <strong>ByteString</strong> field.</p>\n\n<p>But i'm getting  unmarshal error, i can't figure out a way to unmarshal it \nShould i create my own <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#hdr-The_PropertyLoadSaver_Interface\" rel=\"nofollow\">PropertyLoadSaver</a>  ??</p>\n\n<pre><code>json: cannot unmarshal string into Go value of type \n\n\n\ndatastore.ByteString\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"google.golang.org/appengine/datastore\"\n)\n\ntype User struct {\n    SubscriptionToken datastore.ByteString\n}\n\nfunc main() {\n    u := new(User)\n    str := \"{\\\"SubscriptionToken\\\":\\\"YWR66969hjgkgkgo\\\"}\"\n    err := json.Unmarshal([]byte(str), &amp;u)\n    if err != nil {\n        fmt.Println(err)\n\n    }\n    fmt.Println(u)\n}\n</code></pre>\n"}, {"tags": ["python", "json", "go", "syntactic-sugar"], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 18, "last_activity_date": 1431014048, "creation_date": 1431014048, "answer_id": 30106057, "question_id": 30105798, "link": "https://stackoverflow.com/questions/30105798/go-constructing-struct-json-on-the-fly/30106057#30106057", "title": "Go - constructing struct/json on the fly", "body": "<p>You can use a map:</p>\n\n<pre><code>example := map[string]interface{}{ \"Key1\": 123, \"Key2\": \"value2\" }\njs, _ := json.Marshal(example)\n</code></pre>\n\n<p>You can also create types inside of a function:</p>\n\n<pre><code>func f() {\n    type Example struct { }\n}\n</code></pre>\n\n<p>Or create unnamed types:</p>\n\n<pre><code>func f() {\n    json.Marshal(struct { Key1 int; Key2 string }{123, \"value2\"})\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 14, "last_activity_date": 1431014134, "creation_date": 1431014134, "answer_id": 30106093, "question_id": 30105798, "link": "https://stackoverflow.com/questions/30105798/go-constructing-struct-json-on-the-fly/30106093#30106093", "title": "Go - constructing struct/json on the fly", "body": "<p>You could use an anonymous struct type.</p>\n\n<pre><code>example := struct {\n    Key1 int\n    Key2 string\n}{\n    Key1: 123,\n    Key2: \"value2\",\n}\njs, err := json.Marshal(&amp;example)\n</code></pre>\n\n<p>Or, if you are ready to lose some type safety, <code>map[string]interface{}</code>:</p>\n\n<pre><code>example := map[string]interface{}{\n    \"Key1\": 123,\n    \"Key2\": \"value2\",\n}\njs, err := json.Marshal(example)\n</code></pre>\n"}], "owner": {"reputation": 21358, "user_id": 1977620, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/lvWfj.jpg?s=128&g=1", "display_name": "Max Malysh", "link": "https://stackoverflow.com/users/1977620/max-malysh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5363, "favorite_count": 1, "accepted_answer_id": 30106057, "answer_count": 2, "score": 9, "last_activity_date": 1431014134, "creation_date": 1431013291, "question_id": 30105798, "link": "https://stackoverflow.com/questions/30105798/go-constructing-struct-json-on-the-fly", "title": "Go - constructing struct/json on the fly", "body": "<p>In Python it is possible to create a dictionary and serialize it as a JSON object like this:</p>\n\n<pre><code>example = { \"key1\" : 123, \"key2\" : \"value2\" }\njs = json.dumps(example)\n</code></pre>\n\n<p>Go is statically typed, so we have to declare the object schema first:</p>\n\n<pre><code>type Example struct {\n    Key1 int\n    Key2 string\n}\n\nexample := &amp;Example { Key1 : 123, Key2 : \"value2\" }\njs, _ := json.Marshal(example)\n</code></pre>\n\n<p>Sometimes object (struct) with a specific schema (type declaration) is needed just in one place and nowhere else. I don't want to spawn numerous useless types, and I don't want to use reflection for this. </p>\n\n<p>Is there any syntactic sugar in Go that provides a more elegant way to do this? </p>\n"}, {"tags": ["json", "reflection", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1431016706, "post_id": 30105688, "comment_id": 48325041, "body": "If you have a specific structure to your JSON then you&#39;d normally use a type (a <code>struct</code> likely) that encapsulates that structure instead of using <code>interface{}</code>."}], "answers": [{"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 6, "last_activity_date": 1541067054, "last_edit_date": 1541067054, "creation_date": 1431013174, "answer_id": 30105762, "question_id": 30105688, "link": "https://stackoverflow.com/questions/30105688/golang-json-array-of-different-types-reflection-float64-vs-int64/30105762#30105762", "title": "Golang JSON array of different types reflection: float64 vs int64", "body": "<p>This is documented behavior of <code>Unmarshal</code>. All numbers are unmarshaled into float64.</p>\n\n<blockquote>\n  <p>To unmarshal JSON into an interface value, Unmarshal stores one of these in the interface value:  </p>\n  \n  <ul>\n  <li>bool, for JSON booleans</li>\n  <li>float64, for JSON numbers </li>\n  <li>string, for JSON strings  </li>\n  <li>[]interface{}, for JSON arrays  </li>\n  <li>map[string]interface{}, for JSON objects</li>\n  <li>nil for JSON null </li>\n  </ul>\n</blockquote>\n\n<p>This is because JSON does not have integers, every number in JSON is defined to be a 64 bit floating point.</p>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1431013560, "creation_date": 1431013560, "answer_id": 30105908, "question_id": 30105688, "link": "https://stackoverflow.com/questions/30105688/golang-json-array-of-different-types-reflection-float64-vs-int64/30105908#30105908", "title": "Golang JSON array of different types reflection: float64 vs int64", "body": "<p>This is the default behaviour of the JSON decoder. You can change it to output <a href=\"http://golang.org/pkg/encoding/json/#Number\" rel=\"nofollow\"><code>json.Number</code></a> instead by using the <a href=\"http://golang.org/pkg/encoding/json/#Decoder.UseNumber\" rel=\"nofollow\"><code>UseNumber</code></a> method.</p>\n"}], "owner": {"reputation": 72977, "user_id": 95944, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/SprKq.jpg?s=128&g=1", "display_name": "Richard Knop", "link": "https://stackoverflow.com/users/95944/richard-knop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2240, "favorite_count": 1, "accepted_answer_id": 30105762, "answer_count": 2, "score": 2, "last_activity_date": 1541067054, "creation_date": 1431012948, "question_id": 30105688, "link": "https://stackoverflow.com/questions/30105688/golang-json-array-of-different-types-reflection-float64-vs-int64", "title": "Golang JSON array of different types reflection: float64 vs int64", "body": "<p>Consider this simple example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"reflect\"\n)\n\nvar args = `[1, 2.5, \"aaa\", true, false]`\n\nfunc main() {\n    var x []interface{}\n    err := json.Unmarshal([]byte(args), &amp;x)\n\n    if err != nil {\n        log.Fatalf(\"%s\", err.Error())\n        panic(fmt.Sprintf(\"%s\", err.Error()))\n    }\n\n    for _, arg := range x {\n        t := reflect.TypeOf(arg).Kind().String()\n        v := reflect.ValueOf(arg)\n\n        if t == \"int64\" {\n            fmt.Printf(\"int64 %v\\n\", v.Int())\n        }\n\n        if t == \"float64\" {\n            fmt.Printf(\"float64 %v\\n\", v.Float())\n        }\n\n        if t == \"string\" {\n            fmt.Printf(\"string %v\\n\", v.String())\n        }\n\n        if t == \"bool\" {\n            fmt.Printf(\"bool %v\\n\", v.Bool())\n        }\n    }\n}\n</code></pre>\n\n<p>The program outputs:</p>\n\n<pre><code>float64 1\nfloat64 2.5\nstring aaa\nbool true\nbool false\n</code></pre>\n\n<p>As you can see, my input is a valid JSON which represents an array with five items:</p>\n\n<pre><code>- integer\n- floating point number\n- string\n- boolean\n- boolean\n</code></pre>\n\n<p>When I unmarshal the valid JSON string into []interface{} and try to check the types with reflection, the integer value from JSON has a type of float64. Any idea why? Is this expected behaviour?</p>\n"}, {"tags": ["struct", "go", "nested"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1431008130, "post_id": 30102932, "comment_id": 48318645, "body": "If you are &quot;very new to Go&quot; you might want to keep away from <code>interface{}</code> for some days or even weeks."}], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 2709885, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/5bd44cee4ff1ca1e2521c5cf65a1a683?s=128&d=identicon&r=PG&f=1", "display_name": "user2709885", "link": "https://stackoverflow.com/users/2709885/user2709885"}, "edited": false, "score": 0, "creation_date": 1431010230, "post_id": 30103467, "comment_id": 48320273, "body": "Thank you for your answer. Can you please explain me how to initialise nested anonymous struct if I need to. Thanks"}, {"owner": {"reputation": 393, "user_id": 2709885, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/5bd44cee4ff1ca1e2521c5cf65a1a683?s=128&d=identicon&r=PG&f=1", "display_name": "user2709885", "link": "https://stackoverflow.com/users/2709885/user2709885"}, "edited": false, "score": 0, "creation_date": 1431011813, "post_id": 30103467, "comment_id": 48321535, "body": "thank you. This is great"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 0, "last_activity_date": 1431011609, "last_edit_date": 1431011609, "creation_date": 1431007461, "answer_id": 30103467, "question_id": 30102932, "link": "https://stackoverflow.com/questions/30102932/how-to-initialise-nested-structs-in-go/30103467#30103467", "title": "How to initialise nested structs in go?", "body": "<p>The type of <code>M[\"Filter\"]</code> to the compiler is <code>interface{}</code>. The type to the runtime is <code>map[string]interface{}</code>. Neither of those is convertable to your anonymous struct type for the <code>Filter</code> field.</p>\n\n<p>You should define a type for filter, or just not have it at all. Why not</p>\n\n<pre><code>type DetailsFilter struct {\n   Name    string        \n   ID      int                           \n} \n\nM := make(map[string]*DetailsFilter)\nM[\"Filter\"] = &amp;DetailsFilter{\"Name\": \"XYZ\", \"ID\": 5}\nvar detailsFilter = M[\"Filter\"]\n</code></pre>\n\n<p>I am not sure why you need the nested anonymous struct at all. In general it is not needed to use <code>interface{}</code> unless you really need to. It is usually a sign you are fighting the type system instead of embracing it.</p>\n\n<p>The reason You should not use an anonymous struct like that is that there is no clean way to intialize it. You have two options:</p>\n\n<p>1- Repeat the type definition in the struct literal:</p>\n\n<pre><code>x := DetailsFilter{Filter: struct {\n    Name string\n    ID   int\n}{Name: \"Foo\", ID: 5}}\n</code></pre>\n\n<p>2- Set individual fields:</p>\n\n<pre><code>x := DetailsFilter{}\nx.Filter.Name = \"Foo\"\nx.Filter.ID = 5\n</code></pre>\n\n<p>It seems easier to create a real type for the nested field if you want to create them with struct literals.</p>\n"}, {"comments": [{"owner": {"reputation": 393, "user_id": 2709885, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/5bd44cee4ff1ca1e2521c5cf65a1a683?s=128&d=identicon&r=PG&f=1", "display_name": "user2709885", "link": "https://stackoverflow.com/users/2709885/user2709885"}, "edited": false, "score": 0, "creation_date": 1431011822, "post_id": 30104985, "comment_id": 48321544, "body": "Thank you. this works :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1471955170, "last_edit_date": 1471955170, "creation_date": 1431011181, "answer_id": 30104985, "question_id": 30102932, "link": "https://stackoverflow.com/questions/30102932/how-to-initialise-nested-structs-in-go/30104985#30104985", "title": "How to initialise nested structs in go?", "body": "<p>Unfortunately if the type of a struct field is an anonymous struct, <em>at construction time</em> you can only initialize it by \"duplicating\" the anonymous struct type (specifying it again):</p>\n\n<pre><code>type DetailsFilter struct {\n    Filter struct {\n        Name string\n        ID   int\n    }\n}\n\ndf := DetailsFilter{Filter: struct {\n    Name string\n    ID   int\n}{Name: \"myname\", ID: 123}}\nfmt.Println(df)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{Filter:{Name:myname ID:123}}\n</code></pre>\n\n<h3>Shorter Alternative</h3>\n\n<p>So instead I recommend not to initialize it at construction, but rather after the zero-valued struct has been created, like this:</p>\n\n<pre><code>df = DetailsFilter{}\ndf.Filter.Name = \"myname2\"\ndf.Filter.ID = 321\nfmt.Printf(\"%+v\\n\", df)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{Filter:{Name:myname2 ID:321}}\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/DHshsUmLOu\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<h3>Naming the anonymous struct type</h3>\n\n<p>Or don't use anonymous struct as field type at all, name the type like this:</p>\n\n<pre><code>type Filter struct {\n    Name string\n    ID   int\n}\n\ntype DetailsFilter struct {\n    Filter Filter\n}\n</code></pre>\n\n<p>And then you can simply initialize it like this:</p>\n\n<pre><code>df := DetailsFilter{Filter: Filter{Name: \"myname\", ID: 123}}\nfmt.Printf(\"%+v\\n\", df)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/0EhQBpeSD0\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>{Filter:{Name:myname ID:123}}\n</code></pre>\n"}], "owner": {"reputation": 393, "user_id": 2709885, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/5bd44cee4ff1ca1e2521c5cf65a1a683?s=128&d=identicon&r=PG&f=1", "display_name": "user2709885", "link": "https://stackoverflow.com/users/2709885/user2709885"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2317, "favorite_count": 1, "closed_date": 1431053338, "accepted_answer_id": 30104985, "answer_count": 2, "score": 0, "last_activity_date": 1471955170, "creation_date": 1431006209, "last_edit_date": 1495535630, "question_id": 30102932, "link": "https://stackoverflow.com/questions/30102932/how-to-initialise-nested-structs-in-go", "closed_reason": "Duplicate", "title": "How to initialise nested structs in go?", "body": "<p>Hi I am very new to Golang, please help me. I have defined a struct inside a struct. But I get an error when I try to initialise the main struct. </p>\n\n<pre><code>type DetailsFilter struct {\n  Filter struct {\n    Name    string        \n    ID      int                           \n  } \n}\n\nvar M map[string]interface{}\nM = make(map[string]interface{})\nM[\"Filter\"] = map[string]interface{}{\"Name\": \"XYZ\", \"ID\": 5}\nvar detailsFilter = DetailsFilter{Filter: M[\"Filter\"]}}\n</code></pre>\n\n<p>The error I get is : can not use (type interface {}) as type struct in field value : need type assertion. </p>\n\n<p>Please suggest a way to initialise DetailsFilter. \nI tried doing the method described in <a href=\"https://stackoverflow.com/questions/24809235/initialize-a-nested-struct-in-golang\">Initialize a nested struct in Golang</a>, but even this is not working. </p>\n"}, {"tags": ["go", "command-line-arguments"], "comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1431008201, "post_id": 30102822, "comment_id": 48318705, "body": "The fix to <code>go&#47;cmd&#47;run.go</code> would be very small; I recommend discussing it on the go-nuts list and submitting a CL. I don&#39;t see any way to really work around this.\\"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1431008311, "post_id": 30102822, "comment_id": 48318797, "body": "Given the minimal overhead of <code>go build prog.go &amp;&amp; .&#47;prog foo.go</code> compared to <code>go run prog.go foo.go</code> (which also compiles and links your program) I&#39;d just stick to the &quot;build&quot; version."}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1431043897, "post_id": 30102822, "comment_id": 48338236, "body": "Yeah; I use <code>go build</code> too most of the time because of all the problems with <code>go run</code>, but the really annoying thing IMO is that it writes an untracked file into your source directory. A good version of <code>go run</code> would definitely be worthwhile."}, {"owner": {"reputation": 76487, "user_id": 34218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f657c6adf1e623cd6f8818408ecd8f75?s=128&d=identicon&r=PG", "display_name": "Jason Coco", "link": "https://stackoverflow.com/users/34218/jason-coco"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 2, "creation_date": 1431068278, "post_id": 30102822, "comment_id": 48345533, "body": "@RobNapier I just write it out somewhere else, like <code>go build -o &#47;tmp&#47;prog &amp;&amp; &#47;tmp&#47;prog foo.go</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 5, "last_activity_date": 1431009219, "creation_date": 1431009219, "answer_id": 30104126, "question_id": 30102822, "link": "https://stackoverflow.com/questions/30102822/passing-a-go-file-as-additional-argument-to-go-run/30104126#30104126", "title": "Passing a .go-file as additional argument to `go run`", "body": "<p>It's not possible. Here's the <a href=\"https://golang.org/src/cmd/go/run.go#L71\" rel=\"noreferrer\">source</a> for the command:</p>\n\n<pre><code>for i &lt; len(args) &amp;&amp; strings.HasSuffix(args[i], \".go\") {\n    i++\n}\nfiles, cmdArgs := args[:i], args[i:]\n</code></pre>\n\n<p>You can use <code>go install</code> instead of <code>go build</code>. That will put your executable in your <code>$GOPATH/bin</code> folder (I don't like having the binary in the same folder because sometimes I accidentally add it to git). But it's really not much different.</p>\n\n<p>Another option you might want to consider is <a href=\"https://github.com/skelterjohn/rerun\" rel=\"noreferrer\"><code>rerun</code></a>. It will automatically recompile and run your code whenever you change a file:</p>\n\n<pre><code>rerun path/to/your/project foo.go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6904, "user_id": 60462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/64fd87fd2c140ee93f638a624bcc97c9?s=128&d=identicon&r=PG", "display_name": "Volker Stolz", "link": "https://stackoverflow.com/users/60462/volker-stolz"}, "is_accepted": false, "score": 0, "last_activity_date": 1431070803, "creation_date": 1431070803, "answer_id": 30118421, "question_id": 30102822, "link": "https://stackoverflow.com/questions/30102822/passing-a-go-file-as-additional-argument-to-go-run/30118421#30118421", "title": "Passing a .go-file as additional argument to `go run`", "body": "<p>Looking at my problem again, I have to find out if I'm ever going to need several input files. If not, I might get away with just reading from <code>Stdin</code> instead of opening a file.</p>\n"}], "owner": {"reputation": 6904, "user_id": 60462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/64fd87fd2c140ee93f638a624bcc97c9?s=128&d=identicon&r=PG", "display_name": "Volker Stolz", "link": "https://stackoverflow.com/users/60462/volker-stolz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1409, "favorite_count": 0, "accepted_answer_id": 30104126, "answer_count": 2, "score": 5, "last_activity_date": 1431519201, "creation_date": 1431005993, "last_edit_date": 1431519201, "question_id": 30102822, "link": "https://stackoverflow.com/questions/30102822/passing-a-go-file-as-additional-argument-to-go-run", "title": "Passing a .go-file as additional argument to `go run`", "body": "<p>For quick hacking, I prefer to use <code>go run prog.go ...</code> instead of building the executable first. However, the program I am working on should take another go-file as an argument. As a consequence, <code>go run</code> and the compiled binary behave differently:</p>\n\n<pre><code>go run prog.go foo.go\n</code></pre>\n\n<p>will try to execute both go-files, whereas</p>\n\n<pre><code>go build prog.go &amp;&amp; ./prog foo.go\n</code></pre>\n\n<p>will correctly take my file as input (the intended behaviour). Now I can pass additional args like this <code>go run ... -- foo.go</code>, but then because of the <code>--</code> the position of the file differs in <code>os.Args</code> between the <code>go run prog.go -- foo.go</code> and the <code>./prog foo.go</code>. Any easy solution? I'd like to avoid having full flag-processing. Should I just give up and stick to the compiled version?</p>\n"}, {"tags": ["javascript", "groovy", "go", "base64", "gnu"], "comments": [{"owner": {"reputation": 12604, "user_id": 4028085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adaca62313b171fa49a9210bb6f838e8?s=128&d=identicon&r=PG&f=1", "display_name": "brso05", "link": "https://stackoverflow.com/users/4028085/brso05"}, "edited": false, "score": 0, "creation_date": 1431005223, "post_id": 30102466, "comment_id": 48316190, "body": "Are they using the same encoding?"}, {"owner": {"reputation": 357, "user_id": 4623820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oWXXGmfgMGY/AAAAAAAAAAI/AAAAAAAAAII/grWWB4H6rQU/photo.jpg?sz=128", "display_name": "Daniel Tung", "link": "https://stackoverflow.com/users/4623820/daniel-tung"}, "edited": false, "score": 3, "creation_date": 1431005522, "post_id": 30102466, "comment_id": 48316463, "body": "If you decode the results you&#39;ll see that the GNU base64 has a new line character at the end. (You get &#39;Laurence Tureaud is Mr. T\\n&#39; where \\n is a new line."}, {"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 4, "creation_date": 1431005700, "post_id": 30102466, "comment_id": 48316603, "body": "try <code>echo -n &#39;Laurence Tureaud is Mr. T&#39; | base64</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3420, "user_id": 605331, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fe7ceba53392c390435f1ecbabb688db?s=128&d=identicon&r=PG", "display_name": "user605331", "link": "https://stackoverflow.com/users/605331/user605331"}, "edited": false, "score": 1, "creation_date": 1431005836, "post_id": 30102607, "comment_id": 48316702, "body": "Ah, yes, that was it indeed.  The following matches: printf &#39;Laurence Tureaud is Mr. T&#39; | base64"}, {"owner": {"reputation": 357, "user_id": 4623820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oWXXGmfgMGY/AAAAAAAAAAI/AAAAAAAAAII/grWWB4H6rQU/photo.jpg?sz=128", "display_name": "Daniel Tung", "link": "https://stackoverflow.com/users/4623820/daniel-tung"}, "reply_to_user": {"reputation": 3420, "user_id": 605331, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fe7ceba53392c390435f1ecbabb688db?s=128&d=identicon&r=PG", "display_name": "user605331", "link": "https://stackoverflow.com/users/605331/user605331"}, "edited": false, "score": 0, "creation_date": 1431005978, "post_id": 30102607, "comment_id": 48316826, "body": "@user605331 If this worked for you, please mark this as the correct solution. Thanks! :)"}, {"owner": {"reputation": 3420, "user_id": 605331, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fe7ceba53392c390435f1ecbabb688db?s=128&d=identicon&r=PG", "display_name": "user605331", "link": "https://stackoverflow.com/users/605331/user605331"}, "edited": false, "score": 1, "creation_date": 1431006013, "post_id": 30102607, "comment_id": 48316857, "body": "SO won&#39;t allow until 5 minutes has passed.  I tried."}, {"owner": {"reputation": 357, "user_id": 4623820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oWXXGmfgMGY/AAAAAAAAAAI/AAAAAAAAAII/grWWB4H6rQU/photo.jpg?sz=128", "display_name": "Daniel Tung", "link": "https://stackoverflow.com/users/4623820/daniel-tung"}, "reply_to_user": {"reputation": 3420, "user_id": 605331, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fe7ceba53392c390435f1ecbabb688db?s=128&d=identicon&r=PG", "display_name": "user605331", "link": "https://stackoverflow.com/users/605331/user605331"}, "edited": false, "score": 0, "creation_date": 1431006107, "post_id": 30102607, "comment_id": 48316933, "body": "@user605331 Sorry, didn&#39;t mean to rush you. Just wanted to put a little reminder. I added a little more to this answer for future reference!"}], "tags": [], "owner": {"reputation": 1629, "user_id": 1616627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZjH8g.jpg?s=128&g=1", "display_name": "Roger Gustavsson", "link": "https://stackoverflow.com/users/1616627/roger-gustavsson"}, "is_accepted": true, "score": 7, "last_activity_date": 1431006025, "last_edit_date": 1431006025, "creation_date": 1431005495, "answer_id": 30102607, "question_id": 30102466, "link": "https://stackoverflow.com/questions/30102466/why-do-these-base64-encoding-outputs-differ-given-the-same-input-string/30102607#30102607", "title": "Why do these base64 encoding outputs differ, given the same input string?", "body": "<blockquote>\n  <p><code>echo 'Laurence Tureaud is Mr. T'</code></p>\n</blockquote>\n\n<p>Echo adds a newline after the string.</p>\n\n<p>Try the following to remove the newline:</p>\n\n<p><code>echo -n 'Laurence Tureaud is Mr. T' | base64</code></p>\n\n<p>And you get <code>TGF1cmVuY2UgVHVyZWF1ZCBpcyBNci4gVA==</code></p>\n"}, {"tags": [], "owner": {"reputation": 9185, "user_id": 1813616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48c7ae0b99bfe154c31f51f68fa2eb4e?s=128&d=identicon&r=PG", "display_name": "Uwe Plonus", "link": "https://stackoverflow.com/users/1813616/uwe-plonus"}, "is_accepted": false, "score": 4, "last_activity_date": 1431005553, "creation_date": 1431005553, "answer_id": 30102637, "question_id": 30102466, "link": "https://stackoverflow.com/questions/30102466/why-do-these-base64-encoding-outputs-differ-given-the-same-input-string/30102637#30102637", "title": "Why do these base64 encoding outputs differ, given the same input string?", "body": "<p>All output is the same.</p>\n\n<p>The only difference is that bash appends a newline (<code>\\n</code>) to the end when using <code>echo</code>. Therefore the is an additional character appended to the output (the character <code>=</code> is only a padding in base64).</p>\n"}], "owner": {"reputation": 3420, "user_id": 605331, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fe7ceba53392c390435f1ecbabb688db?s=128&d=identicon&r=PG", "display_name": "user605331", "link": "https://stackoverflow.com/users/605331/user605331"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 30102607, "answer_count": 2, "score": -1, "last_activity_date": 1431006025, "creation_date": 1431005178, "last_edit_date": 1431005699, "question_id": 30102466, "link": "https://stackoverflow.com/questions/30102466/why-do-these-base64-encoding-outputs-differ-given-the-same-input-string", "title": "Why do these base64 encoding outputs differ, given the same input string?", "body": "<p>When getting a bas64 encoded string from the same input string I find that JavaScript, Groovy, and Go have the same result, but GNU base64 is slightly different.  Why is that?</p>\n\n<p><strong>JavaScript (nodejs v0.10.33):</strong></p>\n\n<pre><code>new Buffer('Laurence Tureaud is Mr. T').toString('base64');\nTGF1cmVuY2UgVHVyZWF1ZCBpcyBNci4gVA==\n</code></pre>\n\n<p><strong>Groovy (2.3.7 on Java 8):</strong></p>\n\n<pre><code>'Laurence Tureaud is Mr. T'.bytes.encodeBase64().toString()\nTGF1cmVuY2UgVHVyZWF1ZCBpcyBNci4gVA==\n</code></pre>\n\n<p><strong>Go (1.4):</strong></p>\n\n<pre><code>b64.StdEncoding.EncodeToString([]byte(\"Laurence Tureaud is Mr. T\"))\nTGF1cmVuY2UgVHVyZWF1ZCBpcyBNci4gVA==\n</code></pre>\n\n<p><strong>GNU base64 (GNU coreutils 8.12.197-032bb with UTF-8 term charset):</strong></p>\n\n<pre><code>echo 'Laurence Tureaud is Mr. T' | base64\nTGF1cmVuY2UgVHVyZWF1ZCBpcyBNci4gVAo=\n</code></pre>\n"}, {"tags": ["jquery", "go"], "comments": [{"owner": {"reputation": 3396, "user_id": 1510754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6aaf2c6b55d5479a738266d96f8a5c5?s=128&d=identicon&r=PG", "display_name": "conceptdeluxe", "link": "https://stackoverflow.com/users/1510754/conceptdeluxe"}, "edited": false, "score": 1, "creation_date": 1431004295, "post_id": 30102045, "comment_id": 48315449, "body": "Maybe check: <a href=\"http://stackoverflow.com/questions/9754767/cannot-set-content-type-to-application-json-in-jquery-ajax\" title=\"cannot set content type to application json in jquery ajax\">stackoverflow.com/questions/9754767/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11687, "user_id": 1680836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bb9af77981f04237f59efd6826d949?s=128&d=identicon&r=PG", "display_name": "War10ck", "link": "https://stackoverflow.com/users/1680836/war10ck"}, "is_accepted": false, "score": 1, "last_activity_date": 1431004341, "creation_date": 1431004341, "answer_id": 30102112, "question_id": 30102045, "link": "https://stackoverflow.com/questions/30102045/jquery-go-how-do-you-set-a-json-header/30102112#30102112", "title": "jquery &amp; go : how do you set a json header", "body": "<p>I believe it's a simple as adding:</p>\n\n<pre><code>contentType: \"application/json\"\n</code></pre>\n\n<p>as an object property. See the <code>contentType</code> property in the <a href=\"http://api.jquery.com/jquery.ajax/\" rel=\"nofollow\">docs</a>.</p>\n\n<p><strong>Full Example:</strong></p>\n\n<pre><code>...\n$.ajax({\n    url: '',\n    contentType: 'application/json',\n    headers: {\n      \"listkey\":{\"key1\":\"val1\", \"key2\": \"val2\", \"key3\":\"val3\"}\n    },\n    dataType: 'json',\n    cache: false,\n    success: function(data) {\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 878, "user_id": 2575916, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45aefa22254e6f552440cdf57293cbe1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/2575916/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1431004350, "creation_date": 1431004350, "answer_id": 30102118, "question_id": 30102045, "link": "https://stackoverflow.com/questions/30102045/jquery-go-how-do-you-set-a-json-header/30102118#30102118", "title": "jquery &amp; go : how do you set a json header", "body": "<p>you can use the <code>contentType</code> property to set the <code>content-type</code> header, i.e. what you are sending to the server.</p>\n\n<p>And you can use the <code>accept</code> property to tell the server what you would like back.</p>\n\n<pre><code>$.ajax({\n  contentType: 'application/json',\n  accept: 'application/json',\n  url: '',\n  headers: {\n    \"listkey\":{\"key1\":\"val1\", \"key2\": \"val2\", \"key3\":\"val3\"}\n  },\n  dataType: 'json',\n  cache: false,\n  success: function(data) {\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1431076265, "creation_date": 1431076265, "answer_id": 30120019, "question_id": 30102045, "link": "https://stackoverflow.com/questions/30102045/jquery-go-how-do-you-set-a-json-header/30120019#30120019", "title": "jquery &amp; go : how do you set a json header", "body": "<p>This worked:</p>\n\n<pre><code>$.ajax({\n  contentType: 'application/json',\n  accept: 'application/json',\n  url: '',\n  headers: {\n    \"listkey\": '{\"key1\":\"val1\", \"key2\": \"val2\", \"key3\":\"val3\"}'\n  },\n  dataType: 'json',\n  cache: false,\n  success: function(data) {\n...\n</code></pre>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1431076317, "creation_date": 1431004149, "last_edit_date": 1431076317, "question_id": 30102045, "link": "https://stackoverflow.com/questions/30102045/jquery-go-how-do-you-set-a-json-header", "title": "jquery &amp; go : how do you set a json header", "body": "<p>How do you set a json header in query. I need it to be a string on the server?:\n<br></p>\n\n<pre><code>...\n$.ajax({\n  url: '',\n  headers: {\n    \"listkey\":{\"key1\":\"val1\", \"key2\": \"val2\", \"key3\":\"val3\"}\n  },\n  dataType: 'json',\n  cache: false,\n  success: function(data) {\n...\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-storage"], "answers": [{"tags": [], "owner": {"reputation": 32859, "user_id": 81491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa2d855b58c41269f0876b99eac9607d?s=128&d=identicon&r=PG", "display_name": "Brandon Yarbrough", "link": "https://stackoverflow.com/users/81491/brandon-yarbrough"}, "is_accepted": false, "score": 0, "last_activity_date": 1431018833, "creation_date": 1431018833, "answer_id": 30107679, "question_id": 30101669, "link": "https://stackoverflow.com/questions/30101669/multi-object-deleteion-google-cloud-storage-go/30107679#30107679", "title": "Multi object Deleteion google cloud storage go", "body": "<p>Each object that is deleted requires one call to GCS. Iterating over each object and calling delete is the easiest and likely best solution. If you need faster performance, you may want to send multiple delete requests to GCS at a time using multiple threads.</p>\n\n<p>If this is a significant performance issue for your app, there is, however, another way, which I hesitate to mention because it adds significant complexity and doesn't buy much extra performance. GCS supports batching calls together into a single connection. It likely won't be much faster than sending delete requests over several threads, but it does behave more like a DeleteMulti call.</p>\n\n<p>Effectively, batch calls work by sending a multipart HTTP request to the /batch path, each part of which representing an HTTP call. A request to delete several objects would look like this:</p>\n\n<pre><code>POST /batch HTTP/1.1\nHost: www.googleapis.com\nContent-Length: content_length\nContent-Type: multipart/mixed; boundary=\"===============7330845974216740156==\"\nAuthorization: Bearer oauth2_token\n\n\n--===============7330845974216740156==\nContent-Type: application/http\nContent-Transfer-Encoding: binary\nContent-ID: &lt;b29c5de2-0db4-490b-b421-6a51b598bd22+1&gt;\n\nDELETE /storage/v1/b/example-bucket/o/obj1 HTTP/1.1\naccept: application/json\n\n\n--===============7330845974216740156==\nContent-Type: application/http\nContent-Transfer-Encoding: binary\nContent-ID: &lt;b29c5de2-0db4-490b-b421-6a51b598bd22+2&gt;\n\nDELETE /storage/v1/b/example-bucket/o/obj2 HTTP/1.1\naccept: application/json\n\n\n--===============7330845974216740156==--\n</code></pre>\n\n<p>There's more documentation on it here: <a href=\"https://cloud.google.com/storage/docs/json_api/v1/how-tos/batch\" rel=\"nofollow\">https://cloud.google.com/storage/docs/json_api/v1/how-tos/batch</a></p>\n\n<p>But, again, I recommend just sending individual delete requests. Batch calls are not atomic, which means some deletes might succeed while others fail. In the event one of the batch delete operations fails, you'll need to parse the batch response message to figure out which call failed so that you can retry it, which is very likely not worth the effort for the gain you'll get back.</p>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431018833, "creation_date": 1431003227, "question_id": 30101669, "link": "https://stackoverflow.com/questions/30101669/multi-object-deleteion-google-cloud-storage-go", "title": "Multi object Deleteion google cloud storage go", "body": "<p>I'm using go in order to interact with cloud storage .</p>\n\n<p>I can't use gsutil from the app engine and delete with  the <strong>rm command</strong> ?</p>\n\n<p>I can delete one object  with <a href=\"http://godoc.org/google.golang.org/cloud/storage#DeleteObject\" rel=\"nofollow\">DeleteObject</a>  or iterate over a range of objects and delete each one , but i`m looking for another solution something like   <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#DeleteMulti\" rel=\"nofollow\">DeleteMulti</a> in Datastor.</p>\n\n<p>Do you have a better solution for  multi deletion  ?</p>\n"}, {"tags": ["pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 3649, "user_id": 1656568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sY2E9.jpg?s=128&g=1", "display_name": "achedeuzot", "link": "https://stackoverflow.com/users/1656568/achedeuzot"}, "edited": false, "score": 0, "creation_date": 1431001267, "post_id": 30100646, "comment_id": 48313143, "body": "Thanks for the information but I still don&#39;t understand why they changed the function prototypes in the middle of the sample code. I added an example at the bottom of my question to illustrate this."}, {"owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "reply_to_user": {"reputation": 3649, "user_id": 1656568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sY2E9.jpg?s=128&g=1", "display_name": "achedeuzot", "link": "https://stackoverflow.com/users/1656568/achedeuzot"}, "edited": false, "score": 0, "creation_date": 1431001626, "post_id": 30100646, "comment_id": 48313405, "body": "Swap and Push do different things. Swap only changes the content of the slice. Push adds to the slice and thus changes the length of the slice, i.e. the slice header. Because of that you need a pointer (or return the modified copy). Your second example will not work because append will modify a copy of the slice header."}, {"owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "reply_to_user": {"reputation": 3649, "user_id": 1656568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sY2E9.jpg?s=128&g=1", "display_name": "achedeuzot", "link": "https://stackoverflow.com/users/1656568/achedeuzot"}, "edited": false, "score": 0, "creation_date": 1431001699, "post_id": 30100646, "comment_id": 48313450, "body": "If you look at the heap example it says right in the comments: <code>&#47;&#47; Push and Pop use pointer receivers because they modify the slice&#39;s length, not just its contents.</code>"}, {"owner": {"reputation": 3649, "user_id": 1656568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sY2E9.jpg?s=128&g=1", "display_name": "achedeuzot", "link": "https://stackoverflow.com/users/1656568/achedeuzot"}, "edited": false, "score": 0, "creation_date": 1431002228, "post_id": 30100646, "comment_id": 48313827, "body": "Oh right, I didn&#39;t expand the <code>IntHeap</code> example ! Also I found <a href=\"http://stackoverflow.com/questions/22543025/priority-queue-and-heap\">this useful SO post about a strange <code>Pop method has no pointer receiver</code> error</a>."}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 5, "last_activity_date": 1431000510, "creation_date": 1431000510, "answer_id": 30100646, "question_id": 30100461, "link": "https://stackoverflow.com/questions/30100461/why-is-the-slice-sometimes-passed-by-reference-sometimes-by-pointer/30100646#30100646", "title": "Why is the slice sometimes passed by reference, sometimes by pointer?", "body": "<p><a href=\"http://blog.golang.org/slices\">This article</a> on the Go blog explains why. </p>\n\n<p>From the section <strong>Passing slices to functions</strong>:</p>\n\n<blockquote>\n  <p>It's important to understand that even though a slice contains a\n  pointer, it is itself a value. Under the covers, it is a struct value\n  holding a pointer and a length. It is not a pointer to a struct.</p>\n</blockquote>\n\n<p>As a result you either need to pass a pointer or you need to return the slice as a value if you want to modify it with append.</p>\n\n<p>If you just want to modify the contents of a slice you can simply pass the slice by value:</p>\n\n<blockquote>\n  <p>Even though the slice header is passed by value, the header includes a\n  pointer to elements of an array, so both the original slice header and\n  the copy of the header passed to the function describe the same array.\n  Therefore, when the function returns, the modified elements can be\n  seen through the original slice variable.</p>\n</blockquote>\n\n<p>With append you are modifying the slice header. And</p>\n\n<blockquote>\n  <p>Thus if we want to write a function that modifies the header, we must\n  return it as a result parameter</p>\n</blockquote>\n\n<p>Or:</p>\n\n<blockquote>\n  <p>Another way to have a function modify the slice header is to pass a\n  pointer to it.</p>\n</blockquote>\n"}], "owner": {"reputation": 3649, "user_id": 1656568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sY2E9.jpg?s=128&g=1", "display_name": "achedeuzot", "link": "https://stackoverflow.com/users/1656568/achedeuzot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 2, "accepted_answer_id": 30100646, "answer_count": 1, "score": 1, "last_activity_date": 1431001208, "creation_date": 1431000027, "last_edit_date": 1495541297, "question_id": 30100461, "link": "https://stackoverflow.com/questions/30100461/why-is-the-slice-sometimes-passed-by-reference-sometimes-by-pointer", "title": "Why is the slice sometimes passed by reference, sometimes by pointer?", "body": "<p>In the default <code>container/heap</code> package in go, there's an example for implementing a priority queue.</p>\n\n<p>While looking at <a href=\"http://golang.org/pkg/container/heap/\" rel=\"nofollow noreferrer\">the sample code</a>, it uses a slice <code>[]*Item</code>, and implements the <code>heap.Interface</code>.</p>\n\n<p>My trouble is with the following bit. Why are some functions declared with the priority queue as a slice and sometimes as a pointer to slice ?:</p>\n\n<pre><code>func (pq PriorityQueue) Swap(i, j int) {...}\n// vs\nfunc (pq *PriorityQueue) Push(x interface{}) {...}\n</code></pre>\n\n<p>Why isn't it always <code>(pq PriorityQueue)</code> ? On this other <a href=\"https://stackoverflow.com/questions/2439453/go-using-a-pointer-to-array\">StackOverflow thread about pointer to slices</a>, the docs say that slices are refence types, so why use pointers on them ? I'm having trouble with the fact that the official doc says something then mixes both without explaining the point of adding a pointer.</p>\n\n<p>Thanks for your insights !</p>\n\n<p><strong>EDIT</strong>:\nHere's an example:</p>\n\n<pre><code>// original sample code from the docs:\nfunc (pq *PriorityQueue) Push(x interface{}) {\n    n := len(*pq)\n    item := x.(*Item)\n    item.index = n\n    *pq = append(*pq, item)\n}\n\n// is this the same (removed pointers to slice) ?\nfunc (pq PriorityQueue) Push(x interface{}) {\n    n := len(pq)\n    item := x.(*Item)\n    item.index = n\n    pq = append(pq, item)\n}\n</code></pre>\n\n<p>If both functions <strong>are the same</strong>, why use a pointer now ?</p>\n"}, {"tags": ["json", "selenium", "go", "proxy"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1431014220, "post_id": 30099970, "comment_id": 48323467, "body": "Have you tried <code>selenium.Capabilities{&quot;proxy&quot;: map[string]interface{}{&quot;httpProxy&quot;: &quot;http:&#47;&#47;1.2.3.4:999&quot;}}</code>?"}, {"owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1431059358, "post_id": 30099970, "comment_id": 48342213, "body": "Yes, that worked, how did you know? :-) Thanks a lot! Working line line this:  <code>caps := selenium.Capabilities{&quot;browserName&quot;: &quot;firefox&quot;, &quot;proxy&quot;: map[string]interface{}{&quot;proxyType&quot;: &quot;manual&quot;, &quot;httpProxy&quot;: &quot;218.97.194.214:80&quot;}}</code>  Ah its, seems written in there <a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">json and go</a>."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1431065847, "creation_date": 1431065847, "answer_id": 30116975, "question_id": 30099970, "link": "https://stackoverflow.com/questions/30099970/golang-pass-json-object-to-a-function/30116975#30116975", "title": "Golang pass JSON object to a function", "body": "<p>As I've said in the comment, you can use the form</p>\n\n<pre><code>selenium.Capabilities{\n    \"proxy\": map[string]interface{}{\n        \"httpProxy\": \"http://1.2.3.4:999\",\n        // etc.\n    }\n}\n</code></pre>\n\n<p>Unstructured JSON is usually (un)marshalled through <code>map[string]interface{}</code>, and the type <a href=\"https://godoc.org/bitbucket.org/tebeka/selenium#Capabilities\" rel=\"nofollow\"><code>selenium.Capabilities</code></a> is in fact just a <code>map[string]interface{}</code>.</p>\n\n<p>See also: <a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow\">JSON and Go</a>.</p>\n"}], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "accepted_answer_id": 30116975, "answer_count": 1, "score": 2, "last_activity_date": 1431065847, "creation_date": 1430998702, "question_id": 30099970, "link": "https://stackoverflow.com/questions/30099970/golang-pass-json-object-to-a-function", "title": "Golang pass JSON object to a function", "body": "<p>This is regarded the <a href=\"https://godoc.org/bitbucket.org/tebeka/selenium\" rel=\"nofollow\">Selenium Web driver</a> but I think it is not quite important. </p>\n\n<p>I can set the browser name     </p>\n\n<pre><code>caps := selenium.Capabilities{\"browserName\": \"firefox\"}\nwd, _ := selenium.NewRemote(caps, \"\")\n</code></pre>\n\n<p>But for \"proxy\" ie:</p>\n\n<pre><code>caps := selenium.Capabilities{\"proxy\": \"http://1.2.3.4:999\"}\nwd, _ := selenium.NewRemote(caps, \"\")\n</code></pre>\n\n<p>I have to pass a <a href=\"https://code.google.com/p/selenium/wiki/JsonWireProtocol#Proxy_JSON_Object\" rel=\"nofollow\">JSON Proxy Object</a> which I absolutely have no idea how to create... I searched there and there, but still could not figure... Is it kind of struct? Or map.. or what... :-(</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3466, "user_id": 1010243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcd7086205172a7ba43cee2c62466c6e?s=128&d=identicon&r=PG", "display_name": "Ali-Akber Saifee", "link": "https://stackoverflow.com/users/1010243/ali-akber-saifee"}, "edited": false, "score": 0, "creation_date": 1430996588, "post_id": 30099039, "comment_id": 48309846, "body": "Thanks @VonC. Looks like theres a minor additional overhead of registering the type using an instance but I guess that instance will be garbage collected reasonably quickly?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3466, "user_id": 1010243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcd7086205172a7ba43cee2c62466c6e?s=128&d=identicon&r=PG", "display_name": "Ali-Akber Saifee", "link": "https://stackoverflow.com/users/1010243/ali-akber-saifee"}, "edited": false, "score": 0, "creation_date": 1430996662, "post_id": 30099039, "comment_id": 48309901, "body": "@Ali-AkberSaifee yes, it will. But in general reflection is slower so if you intend to call your factory hundreds of time per second, a map is quicker."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3466, "user_id": 1010243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcd7086205172a7ba43cee2c62466c6e?s=128&d=identicon&r=PG", "display_name": "Ali-Akber Saifee", "link": "https://stackoverflow.com/users/1010243/ali-akber-saifee"}, "edited": false, "score": 0, "creation_date": 1430996982, "post_id": 30099039, "comment_id": 48310135, "body": "@Ali-AkberSaifee do you want your factory to return a <i>new</i> instance of A or B? If yes, I have edited the answer."}, {"owner": {"reputation": 3466, "user_id": 1010243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcd7086205172a7ba43cee2c62466c6e?s=128&d=identicon&r=PG", "display_name": "Ali-Akber Saifee", "link": "https://stackoverflow.com/users/1010243/ali-akber-saifee"}, "edited": false, "score": 0, "creation_date": 1430998623, "post_id": 30099039, "comment_id": 48311277, "body": "for my current usecase I&#39;m ok with just getting a new instance - but in terms of trying to understand the language I&#39;m curious if I can return just the type"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1430996937, "last_edit_date": 1495542112, "creation_date": 1430996067, "answer_id": 30099039, "question_id": 30098611, "link": "https://stackoverflow.com/questions/30098611/how-can-i-store-types-in-go-maps-for-initialisation-at-a-later-stage/30099039#30099039", "title": "How can I store types in go maps for initialisation at a later stage", "body": "<p>You can use <code>map[string]X</code>, with X the interface (which can reference a value or a pointer of any object respecting X contract)</p>\n\n<blockquote>\n  <p>or if there is a different go idiom to solve this kind of requirement that I'm missing?</p>\n</blockquote>\n\n<p>You can also use reflection (as in \"<a href=\"https://stackoverflow.com/a/10211940/6309\">Instance new Type</a>\") to implement your factory.</p>\n\n<pre><code>reflect.New(yourtype).Elem().Interface()\n</code></pre>\n\n<p>You can see a factory example in \"<a href=\"https://stackoverflow.com/a/23031445/6309\">is there a way to create an instance of a struct from a string?</a>\".</p>\n\n<hr>\n\n<p>The quicker approach for a factory method (returning a new instance each time) is using a switch (like <a href=\"https://github.com/go-goodies/go_oops/blob/0e93be7326745a30de943fb72211495227934525/factory_method_with_reuse/widget.go#L63-L72\" rel=\"nofollow noreferrer\">in this example</a>):</p>\n\n<pre><code>// Create a new Widget interface based on WidgetType and set WidgetInfo\nfunc New(wt WidgetType, wi WidgetInfo) Widget_iface {\n    switch wt {\n    case Widget_A:\n        return newWidgetA(wi)\n    case Widget_B:\n        return newWidgetB(wi)\n    }\n    return nil\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1431019729, "post_id": 30106497, "comment_id": 48326788, "body": "A map of functions is more efficient than my answer. +1"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1431015234, "creation_date": 1431015234, "answer_id": 30106497, "question_id": 30098611, "link": "https://stackoverflow.com/questions/30098611/how-can-i-store-types-in-go-maps-for-initialisation-at-a-later-stage/30106497#30106497", "title": "How can I store types in go maps for initialisation at a later stage", "body": "<p>If you have a simple value type then as @VonC said, you can just use <code>map[string]X</code> and return a copy of the exemplar value.</p>\n\n<p>For anything else, instead of using reflection, I'd just use a map of creation functions. Like what the <code>image</code> package does with\n<a href=\"https://golang.org/pkg/image/#RegisterFormat\" rel=\"nofollow\"><code>image.RegisterFormat</code></a>.</p>\n\n<p>E.g. (<a href=\"https://play.golang.org/p/SJyNCNDQ5t\" rel=\"nofollow\">playground</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype X interface {\n        y()\n}\n\ntype newXFunc func() X\n\n// Here just a map variable and two functions, but\n// this could be a type with two methods instead.\n\nvar m = map[string]newXFunc{}\n\nfunc register(name string, fn newXFunc) {\n        m[name] = fn\n}\n\nfunc factory(name string) X {\n        return m[name]()\n}\n\nfunc init() {\n        // If register is exported than these\n        // calls can be in other packages that\n        // implement A and B.\n        register(\"a\", NewA)\n        // For simple things that don't have/need\n        // their own stand-alone \"new\" function.\n        register(\"b\", func() X { return B{} })\n}\n\ntype A struct{}\n\nfunc (a *A) y() {}\nfunc NewA() X   { return &amp;A{} }\n\ntype B struct{}\n\nfunc (b B) y() {}\n\nfunc main() {\n        a1 := factory(\"a\")\n        b1 := factory(\"b\")\n        fmt.Printf(\"%T\\n\", a1)\n        fmt.Printf(\"%T\\n\", b1)\n}\n</code></pre>\n"}], "owner": {"reputation": 3466, "user_id": 1010243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcd7086205172a7ba43cee2c62466c6e?s=128&d=identicon&r=PG", "display_name": "Ali-Akber Saifee", "link": "https://stackoverflow.com/users/1010243/ali-akber-saifee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 30099039, "answer_count": 2, "score": 1, "last_activity_date": 1431015234, "creation_date": 1430995016, "question_id": 30098611, "link": "https://stackoverflow.com/questions/30098611/how-can-i-store-types-in-go-maps-for-initialisation-at-a-later-stage", "title": "How can I store types in go maps for initialisation at a later stage", "body": "<p>I'm trying to implement a factory function that will return an instance of one of many structs that fulfil the contract of an interface <code>X</code>.</p>\n\n<pre><code>m := make(map[string] ?)\nfunc init () {\n    m[\"a\"] = ?\n    m[\"b\"] = ?\n}\n\ntype X interface { \n    y()\n}\n\ntype A struct {}\nfunc (a * A) y () {}\n\ntype B struct {}\nfunc (b * B) y () {}\n\n\nfunction factory(name string) X {\n    return &amp;m[name]{}\n}\n</code></pre>\n\n<p>The code above is just a simplified demonstration of what I'm trying to achieve - looking for pointers for whether this is possible, or if there is a different go idiom to solve this kind of requirement that I'm missing.</p>\n"}, {"tags": ["mysql", "amazon-web-services", "go", "amazon-rds"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1430995028, "post_id": 30098335, "comment_id": 48308786, "body": "I&#39;m giving away the answer here,  but Amazon is limiting your bandwidth after you run a certain number of queries.  Whether they are actually running each one of your queries more slowly, or only running them at certain intervals, is anyone&#39;s guess."}, {"owner": {"reputation": 735, "user_id": 190833, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c214bae9cd1b284a7006c2d725392747?s=128&d=identicon&r=PG", "display_name": "FrontierPsycho", "link": "https://stackoverflow.com/users/190833/frontierpsycho"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1431006650, "post_id": 30098335, "comment_id": 48317430, "body": "I can actually answer that, I ran SHOW FULL PROCESSLIST on the DB while the job was running, and  the queries were actually taking longer, they weren&#39;t being run at intervals. But how can they make the queries run longer? Also, where can I see that? Is there documentation on the limits and so on?"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1431010444, "post_id": 30098335, "comment_id": 48320469, "body": "Well if the queries are being run in parallel with other tasks then they would appear to take longer."}, {"owner": {"reputation": 735, "user_id": 190833, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c214bae9cd1b284a7006c2d725392747?s=128&d=identicon&r=PG", "display_name": "FrontierPsycho", "link": "https://stackoverflow.com/users/190833/frontierpsycho"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1431020105, "post_id": 30098335, "comment_id": 48327027, "body": "I even ran this on a replica that I commissioned precisely for this purpose, it was running no other queries. :-|"}, {"owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "edited": false, "score": 0, "creation_date": 1431226118, "post_id": 30098335, "comment_id": 48402573, "body": "Just a shot in the dark here... Try setting <code>http:&#47;&#47;godoc.org&#47;database&#47;sql#DB.SetMaxIdleConns</code> to <code>0</code>. It sounds like perhaps your connections are stalling out. Eventually they get cleaned up, but in the interim everything is waiting. (<a href=\"https://github.com/go-sql-driver/mysql/issues/257\" rel=\"nofollow noreferrer\">github.com/go-sql-driver/mysql/issues/257</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 190833, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c214bae9cd1b284a7006c2d725392747?s=128&d=identicon&r=PG", "display_name": "FrontierPsycho", "link": "https://stackoverflow.com/users/190833/frontierpsycho"}, "is_accepted": true, "score": 0, "last_activity_date": 1431516420, "creation_date": 1431516420, "answer_id": 30213452, "question_id": 30098335, "link": "https://stackoverflow.com/questions/30098335/consecutive-mysql-queries-from-go-become-much-slower-after-some-point/30213452#30213452", "title": "Consecutive MySQL queries from Go become MUCH slower after some point", "body": "<p>So, after lots and lots of experimentation, I found the solution.</p>\n\n<p>I am using Magnetic Storage on the RDS instances involved, which guarantees approximately 100 IOPS. This limited the speed with which we could query the data.</p>\n\n<p>I tested using 2000 <a href=\"http://aws.amazon.com/ebs/details/\" rel=\"nofollow\" title=\"Amazon EBS product page\">Provisioned IOPS</a>, and the job ran quickly all the way. </p>\n"}], "owner": {"reputation": 735, "user_id": 190833, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c214bae9cd1b284a7006c2d725392747?s=128&d=identicon&r=PG", "display_name": "FrontierPsycho", "link": "https://stackoverflow.com/users/190833/frontierpsycho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 30213452, "answer_count": 1, "score": 1, "last_activity_date": 1431516420, "creation_date": 1430994323, "last_edit_date": 1431074976, "question_id": 30098335, "link": "https://stackoverflow.com/questions/30098335/consecutive-mysql-queries-from-go-become-much-slower-after-some-point", "title": "Consecutive MySQL queries from Go become MUCH slower after some point", "body": "<p>I'm writing a job in go that goes through some MySQL tables, selects some of the rows based on some critera, extracts email addresses from them and sends an email to each. </p>\n\n<p>The filtering process looks at a table (let's call it <code>storage</code>) which is pretty big (~6gb dumped) and looks like this:</p>\n\n<pre><code>Columns:\nid      varchar(64) PK\npath    varchar(64) PK\ngame    varchar(64)\nguid    varchar(64)\nvalue   varchar(512)\ntimestamp   timestamp\n</code></pre>\n\n<p>There are two indices: <code>(id, path)</code> (the PK as seen above) and <code>guid</code>. </p>\n\n<p>The job first retrieves a long list of guids from one table, then batches them and performs consecutive queries like this on the <code>storage</code> table:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT guid, timestamp FROM storage \nWHERE game = 'somegame' \nAND path = 'path' AND value = 'value' AND timestamp &gt;= '2015-04-22 00:00:00.0' AND timestamp &lt;= '2015-04-29T14:53:07+02:00' \nAND guid IN ( ... )\n</code></pre>\n\n<p>Where the <code>IN</code> clause contains a list of guids. </p>\n\n<p>I need to retrieve timestamps to be able to filter further.</p>\n\n<p><strong>When running against my local MySQL</strong>, everything works as expected, the query takes about 180ms with batches of 1000 guids.</p>\n\n<p><strong>When running against the same DB on Amazon RDS</strong>, the queries begin quick, but after some point, they suddenly start taking around 30 seconds, and continue to do so until the job ends. </p>\n\n<p>I have tried many many things to fix this, but can't figure out the reason. Some notes:</p>\n\n<ul>\n<li>The job uses only one <code>sql.DB</code> object. Also, I prepare the above statement once and reuse it quite heavily. </li>\n<li>At first, I thought it was because the RDS DB was running MySQL 5.5, and I was running 5.6. I made a replica of the RDS DB, upgraded to 5.6, ran the job again. The problem happened again.</li>\n<li>The volume of data in the two databases is the same: I dumped the production database and imported it into my local database and ran the job. Same behaviour (it still ran quickly locally).</li>\n<li>The AWS monitoring of the RDS nodes doesn't show any significant spikes. The CPU usage jumps from 1% to up to 10%, and the job seems to open just a few connections (~4).</li>\n<li>I had a colleague run the job on their PC, pointing to <em>my</em> MySQL DB, just to make sure the great performance didn't stem from the fact that the connection was local. It ran just as quickly as on my PC (admittedly, over LAN).</li>\n<li>I ran the job against RDS <em>both from my local PC</em> and from <em>an Amazon EC2 node</em>, which is considerably closer to RDS. From EC2, it performed better, but the problem still appeared. </li>\n<li>The job is very concurrent, each step has input and output channels (with buffer sizes of 1000), and the work is performed by goroutines. Between the steps, I have other goroutines that batch the output of the previous goroutine. </li>\n<li>The slowdown is sudden, one query takes milliseconds, and the next one takes tens of seconds. </li>\n</ul>\n\n<p>I haven't the faintest idea why this happens. Any suggestions would be appreciated. </p>\n"}, {"tags": ["windows", "go"], "answers": [{"tags": [], "owner": {"reputation": 57221, "user_id": 3032289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c171ec0f2c8040d24436a40a3bf075b?s=128&d=identicon&r=PG", "display_name": "Luaan", "link": "https://stackoverflow.com/users/3032289/luaan"}, "is_accepted": true, "score": 2, "last_activity_date": 1430996079, "creation_date": 1430996079, "answer_id": 30099043, "question_id": 30098205, "link": "https://stackoverflow.com/questions/30098205/how-set-process-to-a-cpu-using-go-in-windows/30099043#30099043", "title": "How set process to a CPU using Go in windows?", "body": "<p>You'll have to invoke the WinAPI <code>SetProcessAffinityMask</code>.</p>\n\n<p>Something like this should work:</p>\n\n<pre><code>func setProcessAffinityMask(h syscall.Handle, mask uintptr) (err error) {\n    r1, _, e1 := syscall.Syscall(syscall.NewLazyDLL(\"kernel32.dll\").NewProc(\"SetProcessAffinityMask\").Addr(), 2, uintptr(h), mask, 0)\n    if r1 == 0 {\n        if e1 != 0 {\n            err = error(e1)\n        } else {\n            err = syscall.EINVAL\n        }\n    }\n    return\n}\n</code></pre>\n\n<p><code>h</code> being the process handle, and <code>mask</code> being the desired affinity mask, of course.</p>\n\n<p>This is taken from Go <a href=\"https://github.com/golang/benchmarks/blob/master/driver/driver_windows.go\" rel=\"nofollow\">benchmarks</a>, under the BSD license.</p>\n"}], "owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 1, "accepted_answer_id": 30099043, "answer_count": 1, "score": 0, "last_activity_date": 1430996079, "creation_date": 1430993915, "question_id": 30098205, "link": "https://stackoverflow.com/questions/30098205/how-set-process-to-a-cpu-using-go-in-windows", "title": "How set process to a CPU using Go in windows?", "body": "<p>I want set a process to a CPU using Go in win7, the below code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"runtime\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nfunc SetAffinity(pid int, mask *int64) {\n    syscall.Syscall(syscall.SYS_SCHED_SETAFFINITY,\n        uintptr(pid), 8, uintptr(unsafe.Pointer(mask)))\n}\n\nfunc GetAffinity(pid int, mask *int64) {\n    syscall.Syscall(syscall.SYS_SCHED_GETAFFINITY,\n        uintptr(pid), 8, uintptr(unsafe.Pointer(mask)))\n}\n\nvar cpuNum = float64(runtime.NumCPU())\n\nvar setx = []struct {\n    args     int\n    expected int64\n}{\n    {0, int64(math.Pow(2, cpuNum)) - 2},\n}\n\nfunc main() {\n    for _, ca := range setx {\n        var cpuSet int64\n        GetAffinity(ca.args, &amp;cpuSet)\n        cpuSet = cpuSet &amp; 0XFFFFFFE\n        SetAffinity(ca.args, &amp;cpuSet)\n        fmt.Println(cpuSet)\n        GetAffinity(ca.args, &amp;cpuSet)\n        fmt.Println(cpuSet)\n    }\n}\n</code></pre>\n\n<p>When I use <code>go run affinity.go</code>, get the follow info:</p>\n\n<pre><code># command-line-arguments\n.\\affinity.go:12: undefined: syscall.SYS_SCHED_SETAFFINITY\n.\\affinity.go:13: not enough arguments in call to syscall.Syscall\n.\\affinity.go:17: undefined: syscall.SYS_SCHED_GETAFFINITY\n.\\affinity.go:18: not enough arguments in call to syscall.Syscall\n</code></pre>\n\n<p>I find <code>SYS_SCHED_SETAFFINITY</code> that it only used in linux.\nSo, I want to set a process to a cpu using Go in Windows(Win7), what can I do?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1430997180, "last_edit_date": 1430997180, "creation_date": 1430995466, "answer_id": 30098794, "question_id": 30098196, "link": "https://stackoverflow.com/questions/30098196/golang-get-process-time-to-an-action/30098794#30098794", "title": "Golang get process time to an action", "body": "<p>Use the <a href=\"http://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow\">built-in Benchmarks</a>.</p>\n\n<blockquote>\n  <p>A sample benchmark function looks like this:</p>\n\n<pre><code>func BenchmarkHello(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        fmt.Sprintf(\"hello\")\n    }\n}\n</code></pre>\n  \n  <p>The benchmark function must run the target code b.N times. During benchark execution, b.N is adjusted until the benchmark function lasts long enough to be timed reliably. The output</p>\n\n<pre><code>BenchmarkHello    10000000    282 ns/op\n</code></pre>\n  \n  <p>means that the loop ran 10000000 times at a speed of 282 ns per loop. </p>\n</blockquote>\n\n<p><strong>EDIT:</strong> If you want to measure time of doing something at runtime, and not in your tests, your way looks fine to me.</p>\n"}], "owner": {"reputation": 2472, "user_id": 1746258, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c80e6ebd8ed195a574b7654a2aeb89b1?s=128&d=identicon&r=PG&f=1", "display_name": "Ulug&#39;bek Ro&#39;zimboyev", "link": "https://stackoverflow.com/users/1746258/ulugbek-rozimboyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 30098794, "answer_count": 1, "score": 2, "last_activity_date": 1525915188, "creation_date": 1430993891, "last_edit_date": 1525915188, "question_id": 30098196, "link": "https://stackoverflow.com/questions/30098196/golang-get-process-time-to-an-action", "title": "Golang get process time to an action", "body": "<p>I really interested in how much time is spending time to do this action. Does anybody have any best idea? or any library. I did with simple way, but it seems as wrong way. Because I did have more experience with workin on <code>go</code></p>\n\n<p>My have that code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    var d int = 0\n    var beginTime = time.Now()\n    for i := 0; i &lt; 100000; i++ {\n\n        for c := 0; c &lt; 100; c++ {\n            d = 1\n        }\n    }\n    var endTime = time.Now()\n    fmt.Println(beginTime, endTime)\n    fmt.Println(time.Since(beginTime))\n    fmt.Println(d)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1430994418, "post_id": 30097775, "comment_id": 48308323, "body": "Oh wow - Ignore my comment that was meant for a completely different question :/"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1430996859, "post_id": 30097775, "comment_id": 48310038, "body": "Do you want to refactor methods that consist of <i>a single simple for loop?</i> If that&#39;s the only thing that&#39;s bothering you in the code, that must be a damn good code."}, {"owner": {"reputation": 15767, "user_id": 2457, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1cbf5f896e05660e2b78b1b89e9befd?s=128&d=identicon&r=PG", "display_name": "Adam Lindberg", "link": "https://stackoverflow.com/users/2457/adam-lindberg"}, "edited": false, "score": 0, "creation_date": 1430999483, "post_id": 30097775, "comment_id": 48311846, "body": "I&#39;m pretty sure the loop will appear in more places as I add the functionality I&#39;ve planned. And if not, this would still be a valuable experience for me as I&#39;m learning Go."}, {"owner": {"reputation": 44321, "user_id": 318174, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/916b39039a8269e3c45b5ce2b98675a9?s=128&d=identicon&r=PG", "display_name": "Adam Gent", "link": "https://stackoverflow.com/users/318174/adam-gent"}, "edited": false, "score": 0, "creation_date": 1431000177, "post_id": 30097775, "comment_id": 48312348, "body": "What you want for this sort of small reuse is functional programming. I will put a code example later but I would not be surprised if go has some FP like libs to help."}, {"owner": {"reputation": 15767, "user_id": 2457, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1cbf5f896e05660e2b78b1b89e9befd?s=128&d=identicon&r=PG", "display_name": "Adam Lindberg", "link": "https://stackoverflow.com/users/2457/adam-lindberg"}, "reply_to_user": {"reputation": 44321, "user_id": 318174, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/916b39039a8269e3c45b5ce2b98675a9?s=128&d=identicon&r=PG", "display_name": "Adam Gent", "link": "https://stackoverflow.com/users/318174/adam-gent"}, "edited": false, "score": 0, "creation_date": 1431000701, "post_id": 30097775, "comment_id": 48312722, "body": "@Adam Gent: The problem, as I understood it, is that Go doesn&#39;t have generics, so anything that deals with different types isn&#39;t really possible (if it isn&#39;t reflected = slow)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1431035791, "post_id": 30097775, "comment_id": 48335623, "body": "Both those loops could be done with a <code>func ForComponents(loopBody func(*Component), comps ...Component) (result, finished bool)</code>. (I recall jQuery&#39;s <code>.each()</code> might work something like that, with a return value used to cut off the iteration early.) Minor challenge is that your wrapper function&#39;s type depends on what information each run of the loop returns, so you need different functions for different return values. Larger challenge is that <code>ForComponents(func(c *Component) (result, finished bool) { ... }, components...)</code> is longer than <code>for _, c := range components { ... }</code>."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1431035955, "post_id": 30097775, "comment_id": 48335702, "body": "...so I think writing the loop out each time is just the best way to do it. I do agree with Michael Laszlo that a <code>map[foo]bool</code> might be handy to have here, since you&#39;re doing what look like membership tests, but I don&#39;t know the larger picture of your app."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1431040560, "post_id": 30097775, "comment_id": 48337292, "body": "A corrected and maybe slightly better <code>ForComponents</code> is at <a href=\"http://play.golang.org/p/4W99c_sVm8\" rel=\"nofollow noreferrer\">play.golang.org/p/4W99c_sVm8</a> -- but I still think just writing out loops (and maybe using a <code>map</code> if membership checks are core to what you&#39;re doing) is the way to go."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1431061710, "post_id": 30097775, "comment_id": 48342892, "body": "This code is already easy to understand and simple. Sure you can abstract it to avoid writing a for-loop twice, but it&#39;s going to make your code worse."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1431067219, "post_id": 30097775, "comment_id": 48345002, "body": "As @twotwotwo suggested, you could refactor it to have a function/method containing the <code>for</code> loop and call the jobs to be done specified in different functions, but that will not make your code more compact, nor make it more efficient, nor make it easier to understand and maintain. You do not need to optimize out simple <code>for</code> loops."}], "answers": [{"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 2, "creation_date": 1431061857, "post_id": 30111950, "comment_id": 48342937, "body": "You&#39;ve unified the if statement and for loop, but this is now more code than before and is harder to understand. Duplication is best avoided, but so too are complexity and abstraction."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1431067469, "post_id": 30111950, "comment_id": 48345144, "body": "Agree that abstraction you don&#39;t need has a cost. I think it&#39;s useful to have all the options out there, but app authors should think hard about what they need to get the task done."}], "tags": [], "owner": {"reputation": 11133, "user_id": 4275347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdbsN.jpg?s=128&g=1", "display_name": "Michael Laszlo", "link": "https://stackoverflow.com/users/4275347/michael-laszlo"}, "is_accepted": false, "score": 0, "last_activity_date": 1431034326, "last_edit_date": 1431034326, "creation_date": 1431033968, "answer_id": 30111950, "question_id": 30097775, "link": "https://stackoverflow.com/questions/30097775/how-do-i-abstract-out-loop-details-for-identical-types-in-go/30111950#30111950", "title": "How do I abstract out loop details for identical types in Go?", "body": "<p>Yes, I think you should refactor this code, not merely to make it more compact, but to better express the set-theoretical nature of the operations you're performing. Both functions are asking a question about the intersection of <code>e.components</code> and <code>components</code>.</p>\n\n<p>What you're essentially saying with <code>HasComponent</code>&mdash;which should probably be called <code>HasAllComponents</code>&mdash;is that the intersection of <code>e.components</code> and <code>components</code> is equal to <code>components</code>. In other words, the size of the intersection is the same as the size of <code>components</code>.</p>\n\n<p>As for <code>HasAnyComponent</code>, what you're saying is that the size of the intersection is at least one.</p>\n\n<p>Both functions can be expressed succinctly by testing the size of the intersection, which you can obtain with, say, a function that has this signature:</p>\n\n<pre><code>func (e *entity) CountComponents(components ...Component) int\n</code></pre>\n\n<p>However, your original code has short-circuit logic that stops looking at further components once it knows the answer. You can incorporate such a short-circuited loop into a function with this signature:</p>\n\n<pre><code>func (e *entity) HasMinimumComponents(minimum int, components ...Component) bool\n</code></pre>\n\n<p>In the loop, increment a <code>count</code> variable whenever <code>e.components[c.Type()] != nil</code>. Return <code>true</code> as soon as <code>count &gt;= minimum</code>.</p>\n\n<p>Now you can efficiently implement <code>HasAllComponents</code> with a one-line body:</p>\n\n<pre><code>return entity.HasMinimumComponents(len(components), components...)\n</code></pre>\n\n<p>And the body of <code>HasAnyComponent</code> becomes:</p>\n\n<pre><code>return entity.HasMinimumComponents(1, components...)\n</code></pre>\n\n<p>Below is a program that implements this idea with slightly different data types. I defined a more abstract kind of <code>Entity</code> that contains a <code>map[int]bool</code>. You should have no trouble adapting the idea to your own program.</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n        \"fmt\"\n)\n\ntype Entity struct {\n        ValueMap map[int]bool\n}\n\nfunc MakeEntity(values ...int) *Entity {\n        entity := Entity{map[int]bool{}}\n        for _, value := range values {\n                entity.ValueMap[value] = true\n        }\n        return &amp;entity\n}\n\nfunc (entity *Entity) HasMinimumValues(minimum int, values ...int) bool {\n        count := 0\n        if minimum == 0 {\n                return true\n        }\n        for _, value := range values {\n                if entity.ValueMap[value] {\n                        count++\n                        if count &gt;= minimum {\n                                return true\n                        }\n                }\n        }\n        return false\n}\n\nfunc (entity *Entity) HasAllValues(values ...int) bool {\n        return entity.HasMinimumValues(len(values), values...)\n}\n\nfunc (entity *Entity) HasAnyValue(values ...int) bool {\n        return entity.HasMinimumValues(1, values...)\n}\n\nfunc main() {\n        entity := MakeEntity(1, 3, 5, 7, 9)\n        fmt.Printf(\"%t\\n\", entity.HasAllValues(3, 9))\n        fmt.Printf(\"%t\\n\", entity.HasAllValues(3, 9, 12))\n        fmt.Printf(\"%t\\n\", entity.HasAnyValue(9, 12, 15))\n        fmt.Printf(\"%t\\n\", entity.HasAnyValue(12, 15))\n}\n</code></pre>\n"}], "owner": {"reputation": 15767, "user_id": 2457, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1cbf5f896e05660e2b78b1b89e9befd?s=128&d=identicon&r=PG", "display_name": "Adam Lindberg", "link": "https://stackoverflow.com/users/2457/adam-lindberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1431037180, "creation_date": 1430992904, "last_edit_date": 1431037180, "question_id": 30097775, "link": "https://stackoverflow.com/questions/30097775/how-do-i-abstract-out-loop-details-for-identical-types-in-go", "title": "How do I abstract out loop details for identical types in Go?", "body": "<p>I have the following type:</p>\n\n<pre><code>type entity struct {\n    components []Component\n}\n\nfunc NewEntity(componentsLength ComponentType) Entity {\n    return &amp;entity{\n        components: make([]Component, componentsLength),\n    }\n}\n</code></pre>\n\n<p>When coding, I noticed the following repeated pattern:</p>\n\n<pre><code>func (e *entity) HasComponent(components ...Component) bool {\n    for _, c := range components {\n        if e.components[c.Type()] == nil {\n            return false\n        }\n    }\n    return true\n}\n\nfunc (e *entity) HasAnyComponent(components ...Component) bool {\n    for _, c := range components {\n        if e.components[c.Type()] != nil {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>Go seems okay with a lot of duplicated code when you're writing similar functions for different types. However, in this case the types are the same. I'm still having trouble refactoring the code to generalize the use of the <code>for</code> loop and <code>if</code> statement.</p>\n\n<p>How can I refactor these functions so that the list handling is common, but the boolean operators and values are abstracted out? And should I?</p>\n"}]