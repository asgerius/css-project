[{"tags": ["go", "go-reflect"], "comments": [{"owner": {"reputation": 5450, "user_id": 942317, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/SY5ID.jpg?s=128&g=1", "display_name": "STEEL", "link": "https://stackoverflow.com/users/942317/steel"}, "edited": false, "score": 0, "creation_date": 1577727749, "post_id": 38885169, "comment_id": 105239150, "body": "you can just specify the return type as an <code>Interface</code>. As correctly answered below"}], "answers": [{"tags": [], "owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "is_accepted": false, "score": 0, "last_activity_date": 1470873784, "creation_date": 1470873784, "answer_id": 38885363, "question_id": 38885169, "link": "https://stackoverflow.com/questions/38885169/function-that-takes-different-type-of-struct/38885363#38885363", "title": "Function that takes different type of struct", "body": "<p>This code wouldn't actually compile since <code>len(aa)</code> would be passing a struct to <code>len</code> which would fail. But I think I get what you're trying to do, and the best way to do it is with the nearest thing Go has to inheritance, which is really just struct embedding.</p>\n\n<p>By making an embeddable struct, and having each of your structs that have that similar feature embed it, you can reduce the line count of the code, though \"simplifying\" may be a bit of a stretch.</p>\n\n<pre><code>type HasIDs struct {\n   Ids []string\n}\n\ntype AA struct {   \n   HasIDs\n   OtherValues []int\n}\n\ntype BB struct {\n   HasIDs\n   OtherValues []byte\n}\n</code></pre>\n\n<p>At this point both structs <code>AA</code> and <code>BB</code> have the value <code>Ids []string</code>. Now you can give the <code>HasIDs</code> struct a method that both structs should be able to call.</p>\n\n<pre><code>func (hasIds HasIDs) length() {\n    return len(hasIds.Ids)\n}\n</code></pre>\n\n<p>And call the method on either struct that embeds the struct with the method.</p>\n\n<pre><code>a1 := AA{}\naLength := a1.length()\n</code></pre>\n\n<p>Here is a working code sample: <a href=\"https://play.golang.org/p/ys_CN_L_cr\" rel=\"nofollow\">https://play.golang.org/p/ys_CN_L_cr</a></p>\n"}, {"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 5, "last_activity_date": 1470873812, "creation_date": 1470873812, "answer_id": 38885366, "question_id": 38885169, "link": "https://stackoverflow.com/questions/38885169/function-that-takes-different-type-of-struct/38885366#38885366", "title": "Function that takes different type of struct", "body": "<p>The Go way of doing this would be for both <code>AA</code> and <code>BB</code> to implement a common method. <code>length</code> would then accept an interface that contains the same function signature. Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Lengther interface {\n    Length() int\n}\n\ntype A struct {\n    id string\n}\n\ntype AA struct {\n    ids []A\n}\n\nfunc (a *AA) Length() int {\n    return len(a.ids)\n}\n\ntype B struct {\n    id    string\n    value bool\n}\n\ntype BB struct {\n    ids []B\n}\n\nfunc (b *BB) Length() int {\n    return len(b.ids)\n}\n\nfunc length(l Lengther) int {\n    return l.Length()\n}\n\nfunc main() {\n    aa := &amp;AA{\n        ids: make([]A, 10),\n    }\n    bb := &amp;BB{\n        ids: make([]B, 34),\n    }\n    fmt.Println(length(aa))\n    fmt.Println(length(bb))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/DdxP5lFcZi\" rel=\"noreferrer\">https://play.golang.org/p/DdxP5lFcZi</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1471111206, "last_edit_date": 1471111206, "creation_date": 1470901704, "answer_id": 38890350, "question_id": 38885169, "link": "https://stackoverflow.com/questions/38885169/function-that-takes-different-type-of-struct/38890350#38890350", "title": "Function that takes different type of struct", "body": "<p>1- Using two separate receiver methods <code>length()</code> like this working sample code (This is idiomatic Go):  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc (v *AA) length() int {\n    return len(v.ids)\n}\nfunc (v *BB) length() int {\n    return len(v.ids)\n}\n\nfunc main() {\n    aa := AA{[]A{A{\"id\"}, A{\"id2\"}}}\n    fmt.Println(aa.length()) // 2\n    bb := BB{[]B{B{\"id\", true}, B{\"id2\", true}}}\n    fmt.Println(bb.length()) // 2\n}\n\ntype A struct {\n    id string\n}\n\ntype AA struct {\n    ids []A\n}\n\ntype B struct {\n    id    string\n    value bool\n}\n\ntype BB struct {\n    ids []B\n}\n</code></pre>\n\n<hr>\n\n<p>2- Using one <code>length(aa interface{})</code> function, like this working sample code (in some use cases this is useful):  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc length(aa interface{}) int {\n    switch v := aa.(type) {\n    case AA:\n        return len(v.ids)\n    case BB:\n        return len(v.ids)\n    }\n    return -1\n}\n\nfunc main() {\n    aa := AA{[]A{A{\"id\"}, A{\"id2\"}}}\n    fmt.Println(length(aa)) // 2\n    bb := BB{[]B{B{\"id\", true}, B{\"id2\", true}}}\n    fmt.Println(length(bb)) // 2\n}\n\ntype A struct {\n    id string\n}\n\ntype AA struct {\n    ids []A\n}\n\ntype B struct {\n    id    string\n    value bool\n}\n\ntype BB struct {\n    ids []B\n}\n</code></pre>\n\n<hr>\n\n<p>3- Using <code>reflect</code> and one <code>length(v interface{})</code> function, like this working sample code (in some use cases this is useful):  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\nfunc length(v interface{}) int {\n    return reflect.ValueOf(v).FieldByName(\"ids\").Len()\n}\n\nfunc main() {\n    aa := AA{[]A{A{\"id\"}, A{\"id2\"}}}\n    fmt.Println(length(aa)) // 2\n    bb := BB{[]B{B{\"id\", true}, B{\"id2\", true}}}\n    fmt.Println(length(bb)) // 2\n}\n\ntype A struct {\n    id string\n}\n\ntype AA struct {\n    ids []A\n}\n\ntype B struct {\n    id    string\n    value bool\n}\n\ntype BB struct {\n    ids []B\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>2\n2\n</code></pre>\n"}], "owner": {"reputation": 894, "user_id": 6078917, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/HRZj4.jpg?s=128&g=1", "display_name": "ryan", "link": "https://stackoverflow.com/users/6078917/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1615, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1471842672, "creation_date": 1470872142, "last_edit_date": 1471842672, "question_id": 38885169, "link": "https://stackoverflow.com/questions/38885169/function-that-takes-different-type-of-struct", "title": "Function that takes different type of struct", "body": "<p>I wonder how the following functions <code>lengthAA</code> and <code>lengthBB</code> can be simplified to just one function.  Note in those two functions it just compute the length of the array, it is just an example and can be more complicated than that.   Ideally, I want only one function that serve the same purpose (in this case, <code>len</code>) but can take different <code>struct</code> as variable.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type A struct {\n   id string\n}\n\ntype AA struct {\n   ids []A\n}\n\ntype B struct {\n   id string\n   value bool\n}\n\ntype BB struct {\n   ids []B\n}\n\nfunc lengthAA(aa AA) int {\n   return len(aa)\n}\n\nfunc lengthBB(bb BB) int {\n   return len(bb)\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "go", "time"], "answers": [{"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470872479, "post_id": 38885097, "comment_id": 65131014, "body": "Ah thanks! I was also wondering - what if I want to get <code>2014-11-17 23:02:03 +0000 UTC</code> in Go, how would I do that?"}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470872680, "post_id": 38885097, "comment_id": 65131050, "body": "Use <code>time.Format</code> to lay out your times as strings in the format you want, again using the sentinel value <code>Mon Jan 2 15:04:05 -0700 MST 2006</code> (mnemonic: 1/2 3:04:05 pm &#39;06, -0700).  So for this case: <code>time.Format(&quot;2006-01-02 15:04:05 -0700 MST&quot;)</code>"}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470872799, "post_id": 38885097, "comment_id": 65131085, "body": "(I kind of wish they&#39;d gone with <code>2001-02-03 4:05:06 pm, -0700 MST</code> as their mnemonic sentinel value, but whatever.)"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470873147, "post_id": 38885097, "comment_id": 65131161, "body": "wait..so how do I get a time like <code>2014-11-17 23:02:03 +0000</code>?"}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470873584, "post_id": 38885097, "comment_id": 65131269, "body": "If you want a <code>time.Time</code> variable with a value representing <code>2014-11-16 23:02:03 +0000</code>, then call <code>time.Parse(&quot;2006-01-02 15:04:05 -0700&quot;, &quot;2014-11-16 23:02:03 +0000&quot;)</code>.  If you already have that in some <code>var t time.Time</code>, and you want to print it as a string in that format, then call <code>t.Format(&quot;2006-01-02 15:04:05 -0700&quot;)</code>."}], "tags": [], "owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "is_accepted": true, "score": 2, "last_activity_date": 1470871615, "creation_date": 1470871615, "answer_id": 38885097, "question_id": 38884784, "link": "https://stackoverflow.com/questions/38884784/ruby-and-golang-time-parsing/38885097#38885097", "title": "Ruby and Golang time parsing", "body": "<p>The format string provided in <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow\">the docs</a> contains some redundant information (MST and -0700 in particular convey the same information\u2014a UTC offset in hours*100+minutes).</p>\n\n<p>So, just leave \"MST\" out of your format string.</p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 38885097, "answer_count": 1, "score": 0, "last_activity_date": 1470871615, "creation_date": 1470869339, "question_id": 38884784, "link": "https://stackoverflow.com/questions/38884784/ruby-and-golang-time-parsing", "title": "Ruby and Golang time parsing", "body": "<p>I understand how to parse times from strings using Golang. </p>\n\n<p>Currently, I make a request in rails/ruby that is handled by Go, in which I pass in a time parameter. </p>\n\n<p>This is what I'm doing in rails</p>\n\n<pre><code>  resp = connection.get \"url\", {\n    updated_at: updated_at\n  }.compact\n</code></pre>\n\n<p>and <code>updated_at</code> is <code>Time.now - 1.day</code>.</p>\n\n<p>In Go, this is how I'm parsing the time, after getting it out.</p>\n\n<pre><code>updatedAt, err := time.Parse(\"2006-01-02 15:04:05 -0700 MST\", updatedAtVar)\n</code></pre>\n\n<p>The above works if time looks like </p>\n\n<pre><code>2014-11-17 23:02:03 +0000 UTC\n</code></pre>\n\n<p>but Ruby spits out a time that looks like</p>\n\n<pre><code>2016-08-10 22:29:51 +0000\n</code></pre>\n\n<p>which, when parsing results in </p>\n\n<pre><code>0001-01-01 00:00:00 +0000 UTC\n</code></pre>\n\n<p>What can I pass into my param such that go will parse the time correctly? </p>\n"}, {"tags": ["date", "go", "time"], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 230392, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uwtL7.jpg?s=128&g=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/230392/jeff"}, "reply_to_user": {"reputation": 295, "user_id": 1176154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bGOB6.jpg?s=128&g=1", "display_name": "RAFJR", "link": "https://stackoverflow.com/users/1176154/rafjr"}, "edited": false, "score": 0, "creation_date": 1470927866, "post_id": 38884959, "comment_id": 65158858, "body": "@RAFJR look at Verrans answer above. That&#39;s the correct way."}], "tags": [], "owner": {"reputation": 5954, "user_id": 230392, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uwtL7.jpg?s=128&g=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/230392/jeff"}, "is_accepted": false, "score": 1, "last_activity_date": 1470871046, "last_edit_date": 1470871046, "creation_date": 1470870617, "answer_id": 38884959, "question_id": 38884776, "link": "https://stackoverflow.com/questions/38884776/go-compare-two-time-structs-considering-only-the-dates/38884959#38884959", "title": "Go: compare two time structs considering only the dates", "body": "<p>Could call <code>timeA.Date()</code> format that to a string and compare them like in the following example.  Don't know if there's a better way.</p>\n\n<pre><code>func isSameDate() bool {\n    timeA, _ := t.Parse(\"01022006 15:04\", \"08152016 09:00\")\n    timeB, _ := t.Parse(\"01022006 15:04\", \"08152016 07:30\")\n\n    ay, am, ad := timeA.Date()\n    a := fmt.Sprintf(\"%d%d%d\", ay, am, ad)\n\n    by, bm, bd := timeB.Date()\n    b := fmt.Sprintf(\"%d%d%d\", by, bm, bd)\n    return a == b\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "is_accepted": true, "score": 2, "last_activity_date": 1470871144, "creation_date": 1470871144, "answer_id": 38885036, "question_id": 38884776, "link": "https://stackoverflow.com/questions/38884776/go-compare-two-time-structs-considering-only-the-dates/38885036#38885036", "title": "Go: compare two time structs considering only the dates", "body": "<p>If you use the <a href=\"https://golang.org/pkg/time/#Time.Truncate\" rel=\"nofollow\"><code>Truncate</code> function</a> from the time package you can cut it down to the date.</p>\n\n<p>So truncate both times with the parameter <code>24 * time.Hour</code> to get the date of each and compare with the <a href=\"https://golang.org/pkg/time/#Time.Equal\" rel=\"nofollow\"><code>Equal</code> function</a>.</p>\n\n<pre><code>timeA, _ := t.Parse(\"01022006 15:04\", \"08152016 09:00\")\ntimeB, _ := t.Parse(\"01022006 15:04\", \"08152016 07:30\")\nreturn timeA.Truncate(24 * time.Hour).Equal(timeB.Truncate(24*time.Hour))\n</code></pre>\n\n<p>Here's the sample: <a href=\"https://play.golang.org/p/39ws4DL2pB\" rel=\"nofollow\">https://play.golang.org/p/39ws4DL2pB</a></p>\n"}], "owner": {"reputation": 295, "user_id": 1176154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bGOB6.jpg?s=128&g=1", "display_name": "RAFJR", "link": "https://stackoverflow.com/users/1176154/rafjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "accepted_answer_id": 38885036, "answer_count": 2, "score": 0, "last_activity_date": 1470871144, "creation_date": 1470869289, "last_edit_date": 1470870729, "question_id": 38884776, "link": "https://stackoverflow.com/questions/38884776/go-compare-two-time-structs-considering-only-the-dates", "title": "Go: compare two time structs considering only the dates", "body": "<p>I'm looking for a clean way to do this in go:</p>\n\n<pre><code>package main \n\nimport(\n    \"fmt\"\n    t \"time\"\n)\n\nfunc isSameDate() bool {\n    timeA, err := t.Parse(\"01022006 15:04\", \"08152016 09:00\")\n    timeB, err := t.Parse(\"01022006 15:04\", \"08152016 07:30\")\n\n    return timeA.Date == timeB.Date // This is C# code but I'm looking for something similar in GO\n}\n</code></pre>\n\n<p>Should return true</p>\n"}, {"tags": ["go", "time"], "answers": [{"comments": [{"owner": {"reputation": 295, "user_id": 1176154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bGOB6.jpg?s=128&g=1", "display_name": "RAFJR", "link": "https://stackoverflow.com/users/1176154/rafjr"}, "edited": false, "score": 0, "creation_date": 1470864013, "post_id": 38883749, "comment_id": 65128342, "body": "Perfect. That&#39;s a clean way to do it. Give me a few minutes to accept your answer."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1470874874, "last_edit_date": 1470874874, "creation_date": 1470863898, "answer_id": 38883749, "question_id": 38883711, "link": "https://stackoverflow.com/questions/38883711/go-finding-the-lower-time-value/38883749#38883749", "title": "Go: Finding the lower time value", "body": "<p>You can use the <a href=\"https://godoc.org/time#Time.Before\" rel=\"nofollow\"><code>Time.Before</code></a> method to test if a time is before another:</p>\n\n<pre><code>timeA, err := time.Parse(\"01022006\", \"08112016\")\ntimeB, err := time.Parse(\"01022006\", \"08152016\")\n\nvar min time.Time\nif timeA.Before(timeB) {\n    min = timeA\n} else {\n    min = timeB\n}\n</code></pre>\n"}], "owner": {"reputation": 295, "user_id": 1176154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bGOB6.jpg?s=128&g=1", "display_name": "RAFJR", "link": "https://stackoverflow.com/users/1176154/rafjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 38883749, "answer_count": 1, "score": 0, "last_activity_date": 1470874874, "creation_date": 1470863782, "last_edit_date": 1470864113, "question_id": 38883711, "link": "https://stackoverflow.com/questions/38883711/go-finding-the-lower-time-value", "title": "Go: Finding the lower time value", "body": "<p>I'm using C# my entire life and now trying out GO. How do I find the lower time value between two time structs?</p>\n\n<pre><code>import (\n        t \"time\"\n        \"fmt\"\n)\n\nfunc findTime() {\n    timeA, err := t.Parse(\"01022006\", \"08112016\")\n    timeB, err := t.Parse(\"01022006\", \"08152016\")\n    Math.Min(timeA.Ticks, timeB.Ticks) // This is C# code but I'm looking for something similar in GO\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 3, "creation_date": 1470853176, "post_id": 38879356, "comment_id": 65122688, "body": "You create a session in <code>ReceiveData</code> but never close it."}, {"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "reply_to_user": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1470917309, "post_id": 38879356, "comment_id": 65150802, "body": "@AlexBlex thanks man ... if you want write an answer so that I can accept it"}], "answers": [{"tags": [], "owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "is_accepted": false, "score": 0, "last_activity_date": 1470918321, "creation_date": 1470918321, "answer_id": 38896352, "question_id": 38879356, "link": "https://stackoverflow.com/questions/38879356/a-program-written-in-go-opens-many-connections-to-mongodb/38896352#38896352", "title": "A program written in Go opens many connections to mongoDB", "body": "<p>Missed <code>defer closeSession(session)</code> in <code>ReceiveData</code></p>\n"}], "owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470918321, "creation_date": 1470848037, "last_edit_date": 1470853793, "question_id": 38879356, "link": "https://stackoverflow.com/questions/38879356/a-program-written-in-go-opens-many-connections-to-mongodb", "title": "A program written in Go opens many connections to mongoDB", "body": "<p>I have a very simple HTP server written in Go which serves my AngularJS front end data from a mongodb instance through an API. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>// ReceiveData - used to handle incoming data\nfunc ReceiveData(w http.ResponseWriter, r *http.Request) {\n    if r.Method != \"POST\" {\n        http.NotFound(w, r)\n        return\n    }\n\n    body, err := ioutil.ReadAll(r.Body)\n    if err != nil {\n        panic(err)\n    }\n\n    // database\n    session, err := mgo.Dial(\"localhost\")\n    if err != nil {\n        panic(err)\n    } else {\n        fmt.Println(\"session created\")\n        database := session.DB(\"schedule_calculator\")\n        collection := database.C(\"schedule_save\")\n        num, err := collection.Count()\n        if err == nil {\n            fmt.Println(\"schedule_save collection count = \", num)\n            mongodbData := SavedData{ID: bson.NewObjectId(), Data: string(body), Date: time.Now()}\n            collection.Insert(mongodbData)\n            num, _ := collection.Count()\n            fmt.Println(\"new count: \", num)\n        } else {\n            fmt.Println(\"schedule_save error - \", err)\n        }\n    }\n\n    if err := json.NewEncoder(w).Encode(\"todos\"); err != nil {\n        panic(err)\n    }\n}\n\ntype SavedData struct {\n    ID   bson.ObjectId `bson:\"_id\"`\n    Data string\n    Date time.Time\n}\n\n// SendData - Called by UI to get saved data\nfunc SendData(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"SendData function\")\n    session, err := mgo.Dial(\"localhost\")\n    defer closeSession(session)\n    if err != nil {\n        panic(err)\n    } else {\n        fmt.Println(\"session created\")\n        database := session.DB(\"schedule_calculator\")\n        collection := database.C(\"schedule_save\")\n        num, err := collection.Count()\n        if err == nil {\n            fmt.Println(\"schedule_save collection count = \", num)\n\n            var myData SavedData\n            dbSize, err2 := collection.Count()\n            if err2 != nil {\n                panic(err2)\n            }\n\n            if dbSize &gt; 0 {\n                // db not empty\n                err2 = collection.Find(nil).Skip(dbSize - 1).One(&amp;myData)\n                if err2 != nil {\n          // TODO: handle error\n                    panic(err2)\n                }\n\n                // fmt.Println(myData.Data)\n\n                w.Header().Set(\"Content-Type\", \"application/json; charset=UTF-8\")\n                w.WriteHeader(http.StatusOK)\n\n                if err := json.NewEncoder(w).Encode(myData.Data); err != nil {\n          // TODO: handle error\n                    panic(err)\n                }\n            } else {\n                // db empty\n        fmt.Println(\"DB is empty\")\n            }\n\n        } else {\n            fmt.Println(\"schedule_save error - \", err)\n        }\n    }\n}\n\n// closes the mongodb session\n// TODO: make it use only 1 session\nfunc closeSession(session *mgo.Session) {\n    session.Close()\n    fmt.Println(\"session closed\")\n}\n</code></pre>\n\n<p>and this is what I get in the console after some short interaction with the API:</p>\n\n<pre><code>2016-08-10T19:22:59.734+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55401 #60 (6 connections now open)\n2016-08-10T19:22:59.740+0300 I NETWORK  [conn60] end connection 127.0.0.1:55401 (5 connections now open)\n2016-08-10T19:23:58.794+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55405 #61 (6 connections now open)\n2016-08-10T19:23:58.800+0300 I NETWORK  [conn61] end connection 127.0.0.1:55405 (5 connections now open)\n2016-08-10T19:24:24.219+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55411 #62 (6 connections now open)\n2016-08-10T19:24:24.225+0300 I NETWORK  [conn62] end connection 127.0.0.1:55411 (5 connections now open)\n2016-08-10T19:25:56.149+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55434 #63 (6 connections now open)\n2016-08-10T19:25:56.155+0300 I NETWORK  [conn63] end connection 127.0.0.1:55434 (5 connections now open)\n2016-08-10T19:33:54.127+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55460 #64 (6 connections now open)\n2016-08-10T19:33:54.133+0300 I NETWORK  [conn64] end connection 127.0.0.1:55460 (5 connections now open)\n2016-08-10T19:35:12.060+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55476 #65 (6 connections now open)\n2016-08-10T19:35:12.066+0300 I NETWORK  [conn65] end connection 127.0.0.1:55476 (5 connections now open)\n2016-08-10T19:35:22.827+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55477 #66 (6 connections now open)\n2016-08-10T19:35:22.833+0300 I NETWORK  [conn66] end connection 127.0.0.1:55477 (5 connections now open)\n2016-08-10T19:35:37.720+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55478 #67 (6 connections now open)\n2016-08-10T19:35:52.725+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55487 #68 (7 connections now open)\n2016-08-10T19:36:20.498+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55488 #69 (8 connections now open)\n2016-08-10T19:36:20.508+0300 I NETWORK  [conn69] end connection 127.0.0.1:55488 (7 connections now open)\n2016-08-10T19:36:33.100+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55490 #70 (8 connections now open)\n2016-08-10T19:36:37.155+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55492 #71 (9 connections now open)\n2016-08-10T19:36:48.105+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55493 #72 (10 connections now open)\n2016-08-10T19:36:50.284+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55494 #73 (11 connections now open)\n2016-08-10T19:36:52.157+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55495 #74 (12 connections now open)\n2016-08-10T19:36:53.328+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55496 #75 (13 connections now open)\n2016-08-10T19:37:01.375+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55497 #76 (14 connections now open)\n2016-08-10T19:37:05.287+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55498 #77 (15 connections now open)\n2016-08-10T19:37:05.827+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55499 #78 (16 connections now open)\n2016-08-10T19:37:05.836+0300 I NETWORK  [conn78] end connection 127.0.0.1:55499 (15 connections now open)\n2016-08-10T19:37:08.333+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55500 #79 (16 connections now open)\n2016-08-10T19:37:16.376+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55521 #80 (17 connections now open)\n2016-08-10T19:37:23.323+0300 W NETWORK  [HostnameCanonicalizationWorker] Failed to obtain name info for: [ (192.168.0.102, \"nodename nor servname provided, or not known\"), (192.168.0.102, \"nodename nor servname provided, or not known\") ]\n2016-08-10T19:40:41.079+0300 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:55546 #81 (18 connections now open)\n2016-08-10T19:40:41.087+0300 I NETWORK  [conn81] end connection 127.0.0.1:55546 (17 connections now open)\n</code></pre>\n\n<p>I am very new to Go, so this was the simplest way I managed to make it work however I would really like to know how to limit the opened connections to 1.</p>\n"}, {"tags": ["go", "rethinkdb"], "comments": [{"owner": {"reputation": 2867, "user_id": 1076057, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/h2k2g.jpg?s=128&g=1", "display_name": "dalanmiller", "link": "https://stackoverflow.com/users/1076057/dalanmiller"}, "edited": false, "score": 0, "creation_date": 1470938944, "post_id": 38876471, "comment_id": 65165237, "body": "Hey Peter Hon, this looks correct having the sort <i>after</i> the <code>.Ungroup()</code>. Can you edit your question to include some more example data so I can give this a try?"}], "owner": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1470839841, "creation_date": 1470839841, "question_id": 38876471, "link": "https://stackoverflow.com/questions/38876471/rethinkdb-sort-of-group-data-according-to-reduction-data", "title": "Rethinkdb sort of group data according to reduction data", "body": "<p>I have a json file like this: which I used to group data and sort after group, and I am using golang driver but it seems not work.\nCan I sort the grouped data with the \"created_at\" inside the reduction? Tried this one in golang but no work.     </p>\n\n<pre><code>r.DB(database).Table(table).Group(\"from_user_id\").Max(\"created_at\").\nUngroup().OrderBy(r.Desc(\"created_at\")).Run(session)\n\n{\n\"body\":  \"Hi\" ,\n\"created_at\": Wed Aug 10 2016 05:39:57 GMT+00:00 ,\n\"from_user_id\":  \"user11\" ,    \n\"send_direction\":  \"client\" ,\n\"to_user_id\":  \"user10\",\n}\n</code></pre>\n\n<p>I group with r.db(\"chaatz\").table(\"message\").group(\"from_user_id\").max(\"created_at\"), and here is the result, can I sort according the created_at in reduciton?</p>\n\n<pre><code>[\n{\n\"group\": \"0fa92543-59c9-4896-97a2-c703da32c77c\" ,\n\"reduction\": {\n\"avatar\": \n\"body\": \"Hi\" ,\n\"created_at\": Wed Aug 10 2016 11:22:50 GMT+00:00 ,\n\"from_user_id\": \"0fa92543-59c9-4896-97a2-c703da32c77c\" ,\n\"id\": \"c4b20a64-c665-447c-a17b-67c0adfb7176\" ,\n\"msg_id\": \"09058ed8-853b-4057-8e09-a7c6ee4be1f7\" ,\n\"send_direction\": \"client\" ,\n\"to_user_id\": \"01c171cd-1be6-4b2b-8448-79a87c8f06b6\" ,\n\"updated_at\": Wed Aug 10 2016 11:22:50 GMT+00:00\n}\n} ,\n{\n\"group\": \"user123\" ,\n\"reduction\": {\n\"avatar\": \n\"body\": \"Hi\" ,\n\"created_at\": Wed Aug 10 2016 13:23:21 GMT+00:00 ,\n\"from_user_id\": \"user123\" ,\n\"id\": \"954ac289-7490-4c08-8859-e222148f86b2\" ,\n\"msg_id\": \"c5138387-cba4-42b7-b0ba-1f479433ce88\" ,\n\"send_direction\": \"client\" ,\n\"to_user_id\": \"01c171cd-1be6-4b2b-8448-79a87c8f06b6\" ,\n\"updated_at\": Wed Aug 10 2016 13:23:21 GMT+00:00\n}\n}\n]\n</code></pre>\n"}, {"tags": ["go", "scheduling", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470837413, "post_id": 38875325, "comment_id": 65112296, "body": "Goroutines don&#39;t map directly to threads, meaning you can run as many as you want on a a single thread. They wouldn&#39;t be much use for concurrency if they couldn&#39;t run concurrently."}, {"owner": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470837939, "post_id": 38875325, "comment_id": 65112705, "body": "@JimB As I know, all G(goroutine) will added to P(context)&#39;s local queue, P will attach M(os thread), then if G has IO blocking, then P will detech from current M and produce a new M to attach with current P, the following G will run in P with new M. Here we just have 1 M, as goroutine in fact still a coroutine, next go routine could seize the chance to run unless the before goroutine give up the cpu with PARK or GoSched, here, the goroutine did not do that, why the second goroutine has the chance to seize the CPU?"}, {"owner": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470838330, "post_id": 38875325, "comment_id": 65113026, "body": "@JimB I know a lot of goroutine could run on one thread, but they should cooperate to seize the cpu, if one did not give up CPU, all goroutine on this thread should block? Is my unstanding wrong. If correct, why above code, the second goroutine get the CPU? Did some opeation in my goroutine indeed give up CPU and make go scheduler reschedule? Please suggest, thanks."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1470838633, "post_id": 38875325, "comment_id": 65113302, "body": "Like you said, they don&#39;t yield the CPU during the busy loop, the first loop yields at the entry to the <code>fmt.Println</code> call, which is why the second <code>1 2</code> is printed in quick succession."}, {"owner": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470838869, "post_id": 38875325, "comment_id": 65113533, "body": "@JimB Yes, I have once heard about that fmt.Println will give up CPU, it seems it is the root cause as you are the second guy point this. I am a newbie to golang. If Println give up CPU, how can I prove if my understanding is correct or not as Println will change the logic, any good method for me to use rather than Print? I want to know if my understanding to golang schduelr logic is true or not, I need experiment."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1470839178, "post_id": 38875325, "comment_id": 65113791, "body": "it&#39;s not specifically <code>fmt.Println</code>, it&#39;s that function calls, IO, and channel operations are all scheduling points. You can prove that a busy loop blocks the entire thread by making it an infinite loop and seeing that no progress is made. Other than the fact that a busy loop is a programming error, I&#39;m not sure what you&#39;re trying to prove."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1470840959, "creation_date": 1470840959, "answer_id": 38876938, "question_id": 38875325, "link": "https://stackoverflow.com/questions/38875325/how-does-the-golang-scheduler-sched-goroutine-in-following-code/38876938#38876938", "title": "How does the golang scheduler sched goroutine in following code?", "body": "<p>Here's the order of the relevant operations in your program. </p>\n\n<ol>\n<li><code>go loop(1)</code> dispatches goroutine loop1</li>\n<li><code>time.Sleep(time.Second)</code> starts in the <code>main</code> goroutine</li>\n<li><code>fmt.Println(a)</code> called from loop1, <strong>prints <code>1</code></strong></li>\n<li>loop1 enters busy loop and holds the CPU</li>\n<li>entry to <code>fmt.Println(a)</code> from loop1 yields to the scheduler</li>\n<li><code>main</code> goroutine wakes up, finishes the <code>time.Sleep</code> call</li>\n<li><code>go loop(2)</code> dispatches goroutine loop2</li>\n<li><code>fmt.Println(a)</code> called from loop2, <strong>prints <code>2</code></strong></li>\n<li>loop2 enters busy loop and holds the CPU</li>\n<li>entry to <code>fmt.Println(a)</code> from loop2 yields to the scheduler</li>\n<li>loop1 one wakes up and finishes <code>fmt.Println(a)</code>, <strong>prints <code>1</code></strong></li>\n<li>loop1 sends <code>0</code> over the quit channel</li>\n<li>loop2 finishes <code>fmt.Println(a)</code>, <strong>prints <code>2</code></strong></li>\n<li>loop2 sends <code>0</code> over the quit channel</li>\n</ol>\n"}], "owner": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 38876938, "answer_count": 1, "score": 1, "last_activity_date": 1542530441, "creation_date": 1470836941, "last_edit_date": 1542530441, "question_id": 38875325, "link": "https://stackoverflow.com/questions/38875325/how-does-the-golang-scheduler-sched-goroutine-in-following-code", "title": "How does the golang scheduler sched goroutine in following code?", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"runtime\"\n)\n\nvar quit chan int = make(chan int)\n\nfunc loop(a int) {\n    fmt.Println(a)\n    for i := 0; i &lt; 30000000000; i++ {\n    }\n    fmt.Println(a)\n    quit &lt;- 0\n}\n\nfunc main() {\n    runtime.GOMAXPROCS(1)\n\n    go loop(1)\n    time.Sleep(time.Second)\n    go loop(2)\n\n    for i := 0; i &lt; 2; i++ {\n        &lt;-quit\n    }\n}\n</code></pre>\n\n<p>For the scheduler model (M+P+G), I suppose we just have 1 cpu context because we set <code>GOMAXPROCS</code> as 1, and there is just 1 thread(M) here.</p>\n\n<p>In the goroutine, the for loop do not has any IO blocking, so no new thread will be generated, all goroutine should still work in current thread, so I think the 2 goroutine must go one by one, thus, the result should be <code>1 1 2 2</code>. But in fact, the result is <code>1 2 1 2</code>. Why?</p>\n"}, {"tags": ["go", "server", "client"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1533209760, "last_edit_date": 1533209760, "creation_date": 1470838446, "answer_id": 38875901, "question_id": 38875016, "link": "https://stackoverflow.com/questions/38875016/splitting-client-server-code/38875901#38875901", "title": "Splitting client/server code", "body": "<p>This \"dead code elimination\" is already done\u2013partly\u2013by the go tool. The go tool does not include everything from imported packages, only what is needed (or more precisely: it excludes things that it can prove unreachable).</p>\n\n<p>For example this application </p>\n\n<pre><code>package main; import _ \"fmt\"; func main() {}\n</code></pre>\n\n<p>results in almost 300KB smaller executable binary (on windows amd64) compared to the following:</p>\n\n<pre><code>package main; import \"fmt\"; func main() {fmt.Println()}\n</code></pre>\n\n<p>Excludable things include functions, types and even unexported and exported variables. This is possible because even with reflection you can't call a function or \"instantiate\" types or refer to package variables just by having their names as a <code>string</code> value. So maybe you shouldn't worry about it that much.</p>\n\n<p><strong>Edit:</strong> With Go 1.7 released, it is even better: read blog post: <a href=\"https://blog.golang.org/go1.7-binary-size\" rel=\"nofollow noreferrer\"><strong>Smaller Go 1.7 binaries</strong></a></p>\n\n<p>So if you design your types and functions well, and you don't create \"giant\" registries where you enumerate functions and types (which explicitly generates references to them and thus renders them unexcludable), compiled binaries will only contain what is actually used from imported packages.</p>\n\n<p>I would not suggest to use build tags for this kind of problem. By using them, you'll have an extra responsibility to maintain package / file dependencies yourself which otherwise is done by the go tool.</p>\n\n<p>You should not design and separate code into packages to make your output executables smaller. You should design and separate code into packages based on logic.</p>\n\n<p>I would go with separating stuffs into packages when it is really needed, and import appropriately. Because this is really what you want: some code intended only for the client, some only for the server. You may have to think a little more during your design and coding phase, but at least you will see the result (what actually belongs / gets compiled into the client and into the server).</p>\n"}], "owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533209760, "creation_date": 1470836161, "last_edit_date": 1470837554, "question_id": 38875016, "link": "https://stackoverflow.com/questions/38875016/splitting-client-server-code", "title": "Splitting client/server code", "body": "<p>I'm developing a client/server application in golang, and there are certain logical entities that exist both on client and server(the list is limited)</p>\n\n<p>I would like to ensure certain code for this entities is included ONLY in the server part but NOT in the client(wise versa is nice, but not so important). </p>\n\n<p>The naive thought would be to rely on dead code elimination, but from my brief research it's not a reliable way to handle the task... <code>go build</code> simply won't eliminate dead code from the fact that it may have been used via reflection(nobody cares that it wasn't and there is no option to tune this)</p>\n\n<p>More solid approach seems to be splitting code in different packages and import appropriately, this seems reliable but over-complicates the code forcing you to physically split certain entities between different packages and constantly keep this in mind...</p>\n\n<p>And finally there are build tags allowing to have multiple files under the same package built conditionally for client and server</p>\n\n<p>The motivation with using build tags is that I want to keep code as clean as possible without introducing any synthetic entities</p>\n\n<p>Use case:\nthere are certain cryptography routines, client works with public key, server operates with private... Code logically belongs to the same entity</p>\n\n<p>What option would you choose and why?</p>\n"}, {"tags": ["go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1470846649, "post_id": 38875513, "comment_id": 65119043, "body": "OMG! Total brainfart! Of course... I feel so stupid now. Thanks."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1470837406, "creation_date": 1470837406, "answer_id": 38875513, "question_id": 38874816, "link": "https://stackoverflow.com/questions/38874816/unexpected-response-code-200-when-attempting-a-websocket-connection/38875513#38875513", "title": "Unexpected response code 200 when attempting a websocket connection", "body": "<p>The problem is that the room handler is not registered with the mux.  All requests are served by the handler for / in main.go.</p>\n\n<p>To fix this issue, add code to intialize the <code>room</code> value and register it with the mox:</p>\n\n<pre><code>func main() {\n  http.Handler(\"/room\", &amp;room{\n     forward: make(chan []byte),\n     join: make(chan *client),\n     leave: make(chan *client),\n     clients: make(map[*client]bool),\n  })\n  http.Handle(\"/\", &amp;templateHandler{filename: \"chat.html\"})\n  if err := http.ListenAndServe(\":5000\", nil); err != nil {\n    log.Fatal(\"ListenAndServe\", err)\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1870, "favorite_count": 0, "accepted_answer_id": 38875513, "answer_count": 1, "score": 0, "last_activity_date": 1470854178, "creation_date": 1470835662, "last_edit_date": 1470854178, "question_id": 38874816, "link": "https://stackoverflow.com/questions/38874816/unexpected-response-code-200-when-attempting-a-websocket-connection", "title": "Unexpected response code 200 when attempting a websocket connection", "body": "<p>Fairly new gopher here. Limited experience.</p>\n\n<p>I am going through a book that explores websockets and I hit a dead end. I have assembled a simple chat app with the examples from the book and when I run it I hit the following error:</p>\n\n<blockquote>\n  <p>WebSocket connection to 'ws://localhost:5000/room' failed: Error\n  during WebSocket handshake: Unexpected response code: 200</p>\n</blockquote>\n\n<p>Does anybody know what causes this?</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n    \"path/filepath\"\n    \"sync\"\n)\n\ntype templateHandler struct {\n    //once is an object that will perform exactly one action\n    once     sync.Once\n    filename string\n    templ    *template.Template\n}\n\nfunc (t *templateHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    //this function call will be executed only once\n    t.once.Do(func() {\n        t.templ = template.Must(template.ParseFiles(filepath.Join(\"templates\", t.filename)))\n        log.Println(\"one time\")\n    })\n    t.templ.Execute(w, nil)\n}\n\nfunc main() {\n    http.Handle(\"/\", &amp;templateHandler{filename: \"chat.html\"})\n    if err := http.ListenAndServe(\":5000\", nil); err != nil {\n        log.Fatal(\"ListenAndServe\", err)\n    }\n}\n</code></pre>\n\n<p>client.go</p>\n\n<pre><code>package main\n\n//Notes on channels\n//read from channel x to a\n//a := &lt;- x\n//write 5 to channel x\n//x &lt;- 5\n\nimport (\n    \"github.com/gorilla/websocket\"\n)\n\n//client represents a single chatting user.\n\ntype client struct {\n    //client represents a single chatting user\n    socket *websocket.Conn\n    //sent is a channel on which messages are sent\n    send chan []byte\n    //room is the room this client is chatting in\n    room *room\n}\n\nfunc (c *client) read() {\n    for {\n        //if err is nil after the execution of ReadMessage()\n        //execute the line between the braces\n        if _, msg, err := c.socket.ReadMessage(); err == nil {\n            c.room.forward &lt;- msg\n        } else {\n            break\n        }\n    }\n    c.socket.Close()\n}\n\nfunc (c *client) write() {\n    for msg := range c.send {\n        if err := c.socket.WriteMessage(websocket.TextMessage, msg); err != nil {\n            break\n        }\n    }\n    c.socket.Close()\n}\n</code></pre>\n\n<p>room.go</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/websocket\"\n)\n\ntype room struct {\n    //forward is a channel that holds incoming messages\n    //that should be forwarded to other clients\n    forward chan []byte\n    //join is a channel for clients wishing to join the room\n    join chan *client\n    //leave is a channel for clients wishing to leave the room.\n    leave chan *client\n    //clients holds al the current clients in this room.\n    clients map[*client]bool\n}\n\nfunc (r *room) run() {\n    for {\n        select {\n        case client := &lt;-r.join:\n            //joining\n            r.clients[client] = true\n        case client := &lt;-r.leave:\n            //leaving\n            delete(r.clients, client)\n            close(client.send)\n        case msg := &lt;-r.forward:\n            //forward message to all clients\n            for client := range r.clients {\n                select {\n                case client.send &lt;- msg:\n                default:\n                    //failed to send\n                    delete(r.clients, client)\n                    close(client.send)\n                }\n            }\n        }\n    }\n}\n\nconst (\n    socketBufferSize  = 1024\n    messageBufferSize = 256\n)\n\n//in order for the browser to switch to the websocket\n//protocol a header with an upgrade request from http\n//to websocket must be sent\nvar upgrader = &amp;websocket.Upgrader{\n    ReadBufferSize:  socketBufferSize,\n    WriteBufferSize: socketBufferSize,\n}\n\nfunc (r *room) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    socket, err := upgrader.Upgrade(w, req, nil)\n    if err != nil {\n        log.Fatal(\"ServeHTTP:\", err)\n        return\n    }\n    client := &amp;client{\n        socket: socket,\n        send:   make(chan []byte, messageBufferSize),\n        room:   r,\n    }\n\n    r.join &lt;- client\n    defer func() { r.leave &lt;- client }()\n    go client.write()\n    client.read()\n}\n</code></pre>\n\n<p>chat.html</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;Chat&lt;/title&gt;\n&lt;style&gt;\ninput {display:block;}\nul{list-style:none;}\n&lt;/style&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;ul id=\"messages\"&gt;&lt;/ul&gt;\n    &lt;form id=\"chatbox\"&gt;\n        &lt;textarea&gt;&lt;/textarea&gt;\n        &lt;input type=\"submit\" value=\"Send\" /&gt;\n    &lt;/form&gt;\n    &lt;script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"&gt;\n    &lt;/script&gt;\n\n    &lt;script&gt;\n$(function(){\n    var socket = null;\n    var msgBox = $(\"#chatbox textarea\");\n    var messages = $(\"#messages\");\n    $(\"#chatbox\").submit(function(){\n        if (!msgBox.val()) return false;\n        if (!socket) {\n            alert(\"Error: There is no socket connection.\");\n            return false;\n        }\n        socket.send(msgBox.val());\n        msgBox.val(\"\");\n        return false;\n    });\n    if (!window[\"WebSocket\"]) {\n        alert(\"Error: Your browser does not support web sockets.\")\n    }else {\n        socket = new WebSocket(\"ws://localhost:5000/room\");\n        socket.onclose = function() {\n            alert(\"Connection has been closed.\");\n        }\n        socket.onmessage = function(e) {\n            messages.append($(\"&lt;li&gt;\").text(e.data));\n        }\n    }\n});\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470839139, "post_id": 38874664, "comment_id": 65113757, "body": "Not an answer to your question, but related: if you want to limit the incoming request size (instead of the response of an outgoing request): <a href=\"http://stackoverflow.com/questions/28073395/limiting-file-size-in-formfile\">Limiting file size in FormFile</a>"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 6, "creation_date": 1470838821, "post_id": 38874756, "comment_id": 65113493, "body": "Or just simply call <a href=\"https://golang.org/pkg/io/#LimitReader\" rel=\"nofollow noreferrer\"><code>io.LimitReader()</code></a> (so you don&#39;t need to know the internals of <code>io.LimitedReader</code>): <code>io.LimitReader(response.Body, limit)</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470838911, "post_id": 38874756, "comment_id": 65113573, "body": "@icza: thanks ;) I always forget that one, I think because it&#39;s not a <code>New*</code> function."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1470839484, "post_id": 38874756, "comment_id": 65114043, "body": "@JimB ...and maybe because it is not grouped under the <code>LimitedReader</code> type in the doc (because it returns <code>io.Reader</code> and not <code>io.LimitedReader</code>)."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 21, "last_activity_date": 1470838942, "last_edit_date": 1470838942, "creation_date": 1470835477, "answer_id": 38874756, "question_id": 38874664, "link": "https://stackoverflow.com/questions/38874664/limiting-amount-of-data-read-in-the-response-to-a-http-get-request/38874756#38874756", "title": "Limiting amount of data read in the response to a HTTP GET request", "body": "<p>Use an <a href=\"https://golang.org/pkg/io/#LimitedReader\" rel=\"noreferrer\"><code>io.LimitedReader</code></a></p>\n\n<blockquote>\n  <p>A LimitedReader reads from R but limits the amount of data returned to just N bytes.</p>\n</blockquote>\n\n<pre><code>limitedReader := &amp;io.LimitedReader{R: response.Body, N: limit}\nbody, err := ioutil.ReadAll(limitedReader)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>body, err := ioutil.ReadAll(io.LimitReader(response.Body, limit))    \n</code></pre>\n"}], "owner": {"reputation": 1912, "user_id": 1345266, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/kZ0QR.jpg?s=128&g=1", "display_name": "KiwiJuicer", "link": "https://stackoverflow.com/users/1345266/kiwijuicer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4572, "favorite_count": 5, "accepted_answer_id": 38874756, "answer_count": 1, "score": 7, "last_activity_date": 1470853964, "creation_date": 1470835226, "last_edit_date": 1470853964, "question_id": 38874664, "link": "https://stackoverflow.com/questions/38874664/limiting-amount-of-data-read-in-the-response-to-a-http-get-request", "title": "Limiting amount of data read in the response to a HTTP GET request", "body": "<p>I'm scraping HTML pages and have set up a HTTP client like so:</p>\n\n<pre><code>client := *http.Client{\n        Transport: &amp;http.Transport{\n            Dial: (&amp;net.Dialer{\n                Timeout:   30 * time.Second,\n                KeepAlive: 30 * time.Second,\n            }).Dial,\n            TLSHandshakeTimeout:   10 * time.Second,\n            ResponseHeaderTimeout: 10 * time.Second,\n        },\n    }\n</code></pre>\n\n<p>Now when I make GET requests of multiple URLs I don't want to get stuck with URLs that deliver massive amount of data.</p>\n\n<pre><code>response, err := client.Get(page.Url)\ncheckErr(err)\nbody, err := ioutil.ReadAll(response.Body)\ncheckErr(err)\npage.Body = string(body)\n</code></pre>\n\n<p>Is there a way to limit the amount of data (bytes) the GET request accepts from a resource and stops?</p>\n"}, {"tags": ["regex", "go"], "answers": [{"tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": false, "score": 4, "last_activity_date": 1470829657, "creation_date": 1470829657, "answer_id": 38872591, "question_id": 38872450, "link": "https://stackoverflow.com/questions/38872450/explain-this-regex-interpretation-by-go/38872591#38872591", "title": "Explain this regex interpretation by go", "body": "<p>The <code>*</code> in your regexp matches <em>zero</em> or more occurances of capital letters, of which there are two after the initial run of two (AB).\nChange it to a <code>+</code> for <em>one</em> or more occurances.</p>\n"}, {"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 5, "last_activity_date": 1470830103, "creation_date": 1470830103, "answer_id": 38872749, "question_id": 38872450, "link": "https://stackoverflow.com/questions/38872450/explain-this-regex-interpretation-by-go/38872749#38872749", "title": "Explain this regex interpretation by go", "body": "<p>The <code>ABcd</code> string is seen by a regex engine as </p>\n\n<pre><code>EMPTY_STRING A EMPTY_STRING B EMPTY_STRING c EMPTY_STRING d EMPTY_STRING\n</code></pre>\n\n<p>The <code>[A-Z]*</code> matches <em>zero or more</em> ASCII uppercase letters. That is, it may match <code>EMTPY_STRING</code>. It works like this:</p>\n\n<pre><code>EMPTY_STRING A EMPTY_STRING B EMPTY_STRING c EMPTY_STRING d EMPTY_STRING\n| ------------- First match ------------ |   |-2nd one-|    |-3rd one-|\n</code></pre>\n\n<p>Resulting in <code>.c.d.</code>.</p>\n\n<p>Thus, you should consider using <code>+</code> or <code>{1,}</code> quantifier instead of <code>*</code> (= <code>{0,}</code>).</p>\n"}], "owner": {"reputation": 15751, "user_id": 1345655, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2f01aca0b4d2d9347a6fd0f16f24d084?s=128&d=identicon&r=PG", "display_name": "Kshitiz Sharma", "link": "https://stackoverflow.com/users/1345655/kshitiz-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 38872749, "answer_count": 2, "score": 3, "last_activity_date": 1470830103, "creation_date": 1470829261, "question_id": 38872450, "link": "https://stackoverflow.com/questions/38872450/explain-this-regex-interpretation-by-go", "title": "Explain this regex interpretation by go", "body": "<p>package main</p>\n\n<p>Consider the following code:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    re := regexp.MustCompile(\"[A-Z]*\")\n    fmt.Println(re.ReplaceAllString(\"ABcd\", \".\"))\n}\n</code></pre>\n\n<p>It outputs:</p>\n\n<blockquote>\n  <p>.c.d.</p>\n</blockquote>\n\n<p>I've tested my regex and string on <a href=\"http://www.regexpal.com/\" rel=\"nofollow\">regexpal</a>. It should only match <code>AB</code>. What does it match between <code>c</code> and <code>d</code> that go inserts a <code>.</code> there?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb", "aws-sdk", "aws-sdk-go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "edited": false, "score": 0, "creation_date": 1470976549, "post_id": 38877331, "comment_id": 65177766, "body": "Thanks Bro. Can you please tell me how to access data from the QueryOutput? Suppose if I want to access last entry in the queryoutput how can I do that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "edited": false, "score": 0, "creation_date": 1470984302, "post_id": 38877331, "comment_id": 65180574, "body": "Is this the only way to do it? <code>*resp.Items[*resp.Count - int64(1)][&quot;attribute&quot;].S</code>"}, {"owner": {"reputation": 7988, "user_id": 584947, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5c0e998a5b4fdce4f95cbec31e6dab22?s=128&d=identicon&r=PG", "display_name": "anon58192932", "link": "https://stackoverflow.com/users/584947/anon58192932"}, "edited": false, "score": 1, "creation_date": 1512771558, "post_id": 38877331, "comment_id": 82406597, "body": "This looks perfect Alessio except it should be <code>S: aws.String(&quot;aDeviceId&quot;),</code>"}, {"owner": {"reputation": 7988, "user_id": 584947, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5c0e998a5b4fdce4f95cbec31e6dab22?s=128&d=identicon&r=PG", "display_name": "anon58192932", "link": "https://stackoverflow.com/users/584947/anon58192932"}, "edited": false, "score": 0, "creation_date": 1512771706, "post_id": 38877331, "comment_id": 82406658, "body": "@user6681013 if we look in <code>api.go</code> we can see that the <code>QueryOutput</code> struct has the definition <code>Items []map[string]*AttributeValue</code> so the results are returned as an array of maps. each map represents one row of values and each key in the map represents one column name in the table."}], "tags": [], "owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "is_accepted": true, "score": 20, "last_activity_date": 1512923721, "last_edit_date": 1512923721, "creation_date": 1470841957, "answer_id": 38877331, "question_id": 38870638, "link": "https://stackoverflow.com/questions/38870638/how-to-get-data-from-aws-dynamodb-with-using-partition-key-only/38877331#38877331", "title": "How to get data from aws Dynamodb with using partition key only?", "body": "<p>You have to use Query or Scan operation, this is a simple example but you can read more on Amazon documentation <a href=\"http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/QueryAndScan.html\" rel=\"noreferrer\">here</a> </p>\n\n<p>In particular, Query operation</p>\n\n<blockquote>\n  <blockquote>\n    <p>A Query operation finds items in a table or a secondary index using only primary key attribute values</p>\n  </blockquote>\n</blockquote>\n\n<pre><code>var queryInput = &amp;dynamodb.QueryInput{\n    TableName: aws.String(dynamoRestDataTableName),\n    KeyConditions: map[string]*dynamodb.Condition{\n        \"DeviceId\": {\n            ComparisonOperator: aws.String(\"EQ\"),\n            AttributeValueList: []*dynamodb.AttributeValue{\n                {\n                    S: aws.String(\"aDeviceId\"),\n                },\n            },\n        },\n    },\n}\n\nvar resp, err = dynamoSvc.Query(queryInput)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 776, "user_id": 10187244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VklC4.jpg?s=128&g=1", "display_name": "Deep Nirmal", "link": "https://stackoverflow.com/users/10187244/deep-nirmal"}, "is_accepted": false, "score": 0, "last_activity_date": 1617782808, "creation_date": 1617782808, "answer_id": 66981945, "question_id": 38870638, "link": "https://stackoverflow.com/questions/38870638/how-to-get-data-from-aws-dynamodb-with-using-partition-key-only/66981945#66981945", "title": "How to get data from aws Dynamodb with using partition key only?", "body": "<p>Query operation can be used in that case<br />\nFollowing is one generic example for the same</p>\n<pre><code>compositeKey := entity.GetPrimaryKey(inputVar)\nexpressionAttributeValues := map[string]*dynamodb.AttributeValue{\n    &quot;:v1&quot;: {\n        S: aws.String(compositeKey.PartitionKey.Data.(string)),\n    },\n}\nqueryInput := dynamodb.QueryInput{\n    TableName:                 &amp;d.TableName,\n    KeyConditionExpression:    aws.String(&quot;id = :v1&quot;),\n    ExpressionAttributeValues: expressionAttributeValues,\n}\nqueryOutput, err := d.DdbSession.Query(&amp;queryInput)\nif err != nil {\n    log.Error(&quot;error in fetching records &quot;, err)\n    return nil, err\n}\n\n// unmarshal the query output - items to interface\n\nerr = dynamodbattribute.UnmarshalListOfMaps(queryOutput.Items, &amp;yourInterface)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17570, "favorite_count": 4, "accepted_answer_id": 38877331, "answer_count": 2, "score": 15, "last_activity_date": 1617782808, "creation_date": 1470824481, "last_edit_date": 1489178970, "question_id": 38870638, "link": "https://stackoverflow.com/questions/38870638/how-to-get-data-from-aws-dynamodb-with-using-partition-key-only", "title": "How to get data from aws Dynamodb with using partition key only?", "body": "<p>I am using aws-sdk-go library for DynamoDb connectivity in Golang.  </p>\n\n<p>My DynamoDb table have a Partition key DeviceId (String) and a Sort Key Time (Number). How can I write GetItemInput to get all data with a specific DeviceId?</p>\n\n<pre><code>params := &amp;dynamodb.GetItemInput{\n\n    Key:    map[string]*dynamodb.AttributeValue {\n        \"DeviceId\": {\n            S: aws.String(\"item_1\"),\n        },\n    },\n    ExpressionAttributeNames: map[string]*string{\n        \"DeviceId\": \"DeviceId\",\n    },\n    TableName:  aws.String(\"DbName\"), \n}\n\nlist, err := svc.GetItem(params)\n</code></pre>\n"}, {"tags": ["templates", "go", "beego", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1470845228, "creation_date": 1470845228, "answer_id": 38878516, "question_id": 38869860, "link": "https://stackoverflow.com/questions/38869860/how-can-pass-variable-to-a-template-and-receive-variable-in-beego/38878516#38878516", "title": "How can pass variable to a template and receive variable in beego", "body": "<p>When you use the <code>{{template}}</code> action and you pass something, that becomes the dot <code>.</code> in the called template. Quoting from the package doc of <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow\"><code>text/template</code></a>:</p>\n\n<pre><code>{{template \"name\" pipeline}}\n    The template with the specified name is executed with dot set\n    to the value of the pipeline.\n</code></pre>\n\n<p>So inside <code>alternative_src.html</code> refer to the option only as a dot <code>.</code> (the dot <code>.</code> will mean the value of the pipeline you passed to the template, which is <code>$option</code> in the caller template):</p>\n\n<pre><code>{{if compare . \"\"}}\n  &lt;option value=\"\" selected=\"selected\"&gt;\n  &lt;/option&gt;\n{{else}}\n  &lt;option value=\"\"&gt;&lt;/option&gt;\n{{end}}\n{{if compare . \"xxx\"}}\n  &lt;option value=\"xxx\" selected=\"selected\"&gt;xxx&lt;/option&gt;\n{{else}}\n  &lt;option value=\"xxx\"&gt;xxx&lt;/option&gt;\n{{end}}\n</code></pre>\n"}], "owner": {"reputation": 556, "user_id": 2645856, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/s3W1B.gif?s=128&g=1", "display_name": "wawa", "link": "https://stackoverflow.com/users/2645856/wawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470845332, "creation_date": 1470822525, "last_edit_date": 1470845332, "question_id": 38869860, "link": "https://stackoverflow.com/questions/38869860/how-can-pass-variable-to-a-template-and-receive-variable-in-beego", "title": "How can pass variable to a template and receive variable in beego", "body": "<p>My template file:</p>\n\n<pre><code>{{range $index, $option := .alternatives}}\n&lt;div id=\"splashAlternative{{$index}}\" class=\"col-sm-2\"&gt;\n    &lt;select id=\"flashSrc_{{$index}}\"&gt;\n    {{template \"alternative_src.html\" $option}}\n    &lt;/select&gt;\n&lt;/div&gt;\n{{end}}\n</code></pre>\n\n<p>I want pass <code>$option</code> to template, and <code>alternative_src.html</code> code :</p>\n\n<pre><code>{{if compare .option \"\"}}\n  &lt;option value=\"\" selected=\"selected\"&gt;\n  &lt;/option&gt;\n{{else}}\n  &lt;option value=\"\"&gt;&lt;/option&gt;\n{{end}}\n{{if compare .option \"xxx\"}}\n  &lt;option value=\"xxx\" selected=\"selected\"&gt;xxx&lt;/option&gt;\n{{else}}\n  &lt;option value=\"xxx\"&gt;xxx&lt;/option&gt;\n{{end}}\n</code></pre>\n\n<p>but I get problem below:</p>\n\n<pre><code>executing \"alternative_src.html\" at &lt;.option&gt;: can't evaluate field option in type string\n</code></pre>\n"}, {"tags": ["go", "rethinkdb"], "answers": [{"tags": [], "owner": {"reputation": 2867, "user_id": 1076057, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/h2k2g.jpg?s=128&g=1", "display_name": "dalanmiller", "link": "https://stackoverflow.com/users/1076057/dalanmiller"}, "is_accepted": false, "score": 0, "last_activity_date": 1470939087, "creation_date": 1470939087, "answer_id": 38903393, "question_id": 38869505, "link": "https://stackoverflow.com/questions/38869505/rethinkdb-how-to-select-with-unique-key/38903393#38903393", "title": "Rethinkdb how to select with unique key", "body": "<p>I think you already solved this, but this would be the group query to achieve what you want. </p>\n\n<pre><code>r.DB(\"example\").Table(\"messages\").Group(\"from_user_id\").Max(\"created_at\").Ungroup()\n</code></pre>\n"}], "owner": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470939087, "creation_date": 1470821642, "question_id": 38869505, "link": "https://stackoverflow.com/questions/38869505/rethinkdb-how-to-select-with-unique-key", "title": "Rethinkdb how to select with unique key", "body": "<p>I am trying use rethinkdb to store chat message, here is the json stored:</p>\n\n<pre><code>{\n\"body\":  \"Hi\" ,\n\"created_at\": Wed Aug 10 2016 05:39:57 GMT+00:00 ,\n\"from_user_id\":  \"user11\" ,    \n\"send_direction\":  \"client\" ,\n\"to_user_id\":  \"user10\",\n}\n</code></pre>\n\n<p>each user may send many message, now I want to select one message for each unique from_user_id with the latest created_at. How can I write the rethink query? I am using golang rethinkdb driver. Thanks</p>\n"}, {"tags": ["heroku", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470835365, "post_id": 38868689, "comment_id": 65110760, "body": "The description of H13 is <code>Connection closed without response</code> which mean the <i>server</i> didn&#39;t write a response. You would need to instrument your code to figure out why."}], "answers": [{"tags": [], "owner": {"reputation": 923, "user_id": 711024, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/595b03bef5e51ded53769ba91df29955?s=128&d=identicon&r=PG", "display_name": "Azr", "link": "https://stackoverflow.com/users/711024/azr"}, "is_accepted": false, "score": 0, "last_activity_date": 1470930485, "creation_date": 1470930485, "answer_id": 38900947, "question_id": 38868689, "link": "https://stackoverflow.com/questions/38868689/heroku-golang-mobiles-h13-errors/38900947#38900947", "title": "Heroku + golang + mobiles =&gt; H13 errors?", "body": "<p>H13 means the APP code is having a problem.\nTaking too long or bloating up memory.</p>\n\n<p>( asked a Heroku guy :) )</p>\n"}], "owner": {"reputation": 923, "user_id": 711024, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/595b03bef5e51ded53769ba91df29955?s=128&d=identicon&r=PG", "display_name": "Azr", "link": "https://stackoverflow.com/users/711024/azr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470930485, "creation_date": 1470819630, "question_id": 38868689, "link": "https://stackoverflow.com/questions/38868689/heroku-golang-mobiles-h13-errors", "title": "Heroku + golang + mobiles =&gt; H13 errors?", "body": "<p>On a golang service, I get some H13 (Heroku13 ?) errors these days ( max ~1% of requests ), but 100% of users calling the service are mobile apps.</p>\n\n<p>Is it possible that if they lose connection it triggers an H13 error ?</p>\n\n<p>Or is it only due to some of my code ?</p>\n\n<p>Thx !</p>\n"}, {"tags": ["arrays", "json", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "edited": false, "score": 1, "creation_date": 1470817513, "post_id": 38867782, "comment_id": 65098507, "body": "I forgot that I pass the address, and thought it returned the parsed array, so that why the result was &lt;nil&gt; because it was the value of the error, shame on me."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "edited": false, "score": 0, "creation_date": 1470817614, "post_id": 38867782, "comment_id": 65098566, "body": "@kingSlayer You have to pass the address of the variable so the <code>json</code> package can unmarshal right into your variable. The result doesn&#39;t need to be returned, but the optional error have to be."}, {"owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "edited": false, "score": 0, "creation_date": 1470817835, "post_id": 38867782, "comment_id": 65098685, "body": "So my problem was that I printed out the value of error and not the pointed value of the arr.Array, that was the confusion for me, Thanks."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "edited": false, "score": 1, "creation_date": 1470817948, "post_id": 38867782, "comment_id": 65098744, "body": "@kingSlayer Yeah, you edited your question, but in your <a href=\"http://stackoverflow.com/revisions/38867692/1\">original question</a>  you passed <code>arr</code> which results in an error."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 10, "last_activity_date": 1475315421, "last_edit_date": 1495540099, "creation_date": 1470817018, "answer_id": 38867782, "question_id": 38867692, "link": "https://stackoverflow.com/questions/38867692/how-to-parse-json-array-in-go/38867782#38867782", "title": "How to parse JSON array in Go", "body": "<p><strong>Note:</strong> This answer was written before the question was edited. In the <a href=\"https://stackoverflow.com/revisions/38867692/1\">original question</a> <code>&amp;arr</code> was passed to <code>json.Unmarshal()</code>:</p>\n\n<pre><code>unmarshaled := json.Unmarshal([]byte(dataJson), &amp;arr)\n</code></pre>\n\n<hr>\n\n<p>You pass the address of <code>arr</code> to <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"noreferrer\"><code>json.Unmarshal()</code></a> to unmarshal a JSON array, but <code>arr</code> is not an array (or slice), it is a struct value.</p>\n\n<p>Arrays can be unmarshaled into Go arrays or slices. So pass <code>arr.Array</code>:</p>\n\n<pre><code>dataJson := `[\"1\",\"2\",\"3\"]`\narr := JsonType{}\nerr := json.Unmarshal([]byte(dataJson), &amp;arr.Array)\nlog.Printf(\"Unmarshaled: %v, error: %v\", arr.Array, err)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/0cG8ZIyK-0\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:00 Unmarshaled: [1 2 3], error: &lt;nil&gt;\n</code></pre>\n\n<p>Of course you don't even need the <code>JsonType</code> wrapper, just use a simple <code>[]string</code> slice:</p>\n\n<pre><code>dataJson := `[\"1\",\"2\",\"3\"]`\nvar s []string\nerr := json.Unmarshal([]byte(dataJson), &amp;s)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 160456, "user_id": 89391, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bb5230985aa2c9ea7d022d1a16890f16?s=128&d=identicon&r=PG", "display_name": "miku", "link": "https://stackoverflow.com/users/89391/miku"}, "is_accepted": true, "score": 52, "last_activity_date": 1617818903, "last_edit_date": 1617818903, "creation_date": 1470817121, "answer_id": 38867827, "question_id": 38867692, "link": "https://stackoverflow.com/questions/38867692/how-to-parse-json-array-in-go/38867827#38867827", "title": "How to parse JSON array in Go", "body": "<p>The <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">return value</a> of <code>Unmarshal</code> is an <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"nofollow noreferrer\">error</a>, and this is what you are printing out:</p>\n<pre><code>// Return value type of Unmarshal is error.\nerr := json.Unmarshal([]byte(dataJson), &amp;arr)\n</code></pre>\n<p>You can get rid of the <code>JsonType</code> as well and just use a slice:</p>\n\n<pre><code>package main\n\nimport (\n    &quot;encoding/json&quot;\n    &quot;log&quot;\n)\n\nfunc main() {\n    dataJson := `[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]`\n    var arr []string\n    _ = json.Unmarshal([]byte(dataJson), &amp;arr)\n    log.Printf(&quot;Unmarshaled: %v&quot;, arr)\n}\n\n// prints out:\n// 2009/11/10 23:00:00 Unmarshaled: [1 2 3]\n</code></pre>\n<p>Code on play: <a href=\"https://play.golang.org/p/GNWlylavam\" rel=\"nofollow noreferrer\">https://play.golang.org/p/GNWlylavam</a></p>\n<p>Background: Passing in a pointer allows <code>Unmarshal</code> to reduce (or get entirely rid of) memory allocations. Also, in a processing context, the caller may reuse the same value to repeatedly - saving allocations as well.</p>\n"}], "owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62947, "favorite_count": 17, "accepted_answer_id": 38867827, "answer_count": 2, "score": 38, "last_activity_date": 1617818903, "creation_date": 1470816714, "last_edit_date": 1611907267, "question_id": 38867692, "link": "https://stackoverflow.com/questions/38867692/how-to-parse-json-array-in-go", "title": "How to parse JSON array in Go", "body": "<p>How to parse a string (which is an array) in Go using json package?</p>\n<pre class=\"lang-golang prettyprint-override\"><code>type JsonType struct{\n    Array []string\n}\n\nfunc main(){\n    dataJson = `[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]`\n    arr := JsonType{}\n    unmarshaled := json.Unmarshal([]byte(dataJson), &amp;arr.Array)\n    log.Printf(&quot;Unmarshaled: %v&quot;, unmarshaled)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 7, "creation_date": 1470816380, "post_id": 38867498, "comment_id": 65097868, "body": "This is working as intended. Since the values are identical, newID will be true. The problem is with your semantics for that variable; you should reverse the result, i.e. <code>newID = ba.RateID != rr.RateID</code>."}, {"owner": {"reputation": 457, "user_id": 609295, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/lPOCA.png?s=128&g=1", "display_name": "Dave Appleton", "link": "https://stackoverflow.com/users/609295/dave-appleton"}, "reply_to_user": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1470816471, "post_id": 38867498, "comment_id": 65097918, "body": "Damn - thank you.  Stupid me."}], "owner": {"reputation": 457, "user_id": 609295, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/lPOCA.png?s=128&g=1", "display_name": "Dave Appleton", "link": "https://stackoverflow.com/users/609295/dave-appleton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470816140, "creation_date": 1470816140, "question_id": 38867498, "link": "https://stackoverflow.com/questions/38867498/strange-behaviour-of-booleans", "title": "Strange behaviour of booleans", "body": "<p>I have a function</p>\n\n<pre><code>func (ba * xxAPI) GetID() (newID boolean, err error) {\n    ...\n    newID = (ba.RateID == rr.RateID)\n    fmt.Printf(\"old id : %d, new ID %d, update flag %v\\n\", ba.RateID, rr.RateID, newID)\n    ...\n</code></pre>\n\n<p>Which results in the following message :</p>\n\n<p>old id : 325041, new ID 325041, update flag true</p>\n\n<p>I wondered if it was the assignment and tried the evil version:</p>\n\n<pre><code>if ba.RateID == rr.RateID {\n    newID = true\n} else {\n    newID = false\n}\n</code></pre>\n\n<p>but (thankfully) the result was the same.</p>\n\n<p>I am obviously overlooking something. </p>\n\n<p>Any idea what?</p>\n"}, {"tags": ["go", "execution"], "answers": [{"comments": [{"owner": {"reputation": 899, "user_id": 2914587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8264caf9ad892f1a8a3128aeebbdb0ac?s=128&d=identicon&r=PG&f=1", "display_name": "supercalifragilistichespirali", "link": "https://stackoverflow.com/users/2914587/supercalifragilistichespirali"}, "edited": false, "score": 0, "creation_date": 1471242741, "post_id": 38870609, "comment_id": 65255188, "body": "Thanks, 1) works fine. If I want to process Stdout and Stderr at the same time, I guess I can just use 2 channels and 2 go routines (one per pipe type)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 5, "last_activity_date": 1470830063, "last_edit_date": 1470830063, "creation_date": 1470824409, "answer_id": 38870609, "question_id": 38866952, "link": "https://stackoverflow.com/questions/38866952/streaming-commands-output-progress-from-goroutine/38870609#38870609", "title": "Streaming commands output progress from Goroutine", "body": "<h3>There are some problems:</h3>\n\n<ul>\n<li>The pipe is being closed before reading all data.  </li>\n<li>Always check for errors</li>\n<li>Start <code>cmd.Start()</code> after <code>c &lt;- struct{}{}</code> and use unbuffered channel <code>c := make(chan struct{})</code></li>\n</ul>\n\n<hr>\n\n<h3>Two working sample codes:</h3>\n\n<p>1: Wait using channel then close the pipe after <code>EOF</code> using <code>defer func() { c &lt;- struct{}{} }()</code>, like this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"Streamer\")\n    c := make(chan struct{})\n\n    go run(cmd, c)\n\n    c &lt;- struct{}{}\n    cmd.Start()\n\n    &lt;-c\n    if err := cmd.Wait(); err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(\"done.\")\n}\n\nfunc run(cmd *exec.Cmd, c chan struct{}) {\n    defer func() { c &lt;- struct{}{} }()\n    stdout, err := cmd.StdoutPipe()\n    if err != nil {\n        panic(err)\n    }\n    &lt;-c\n    scanner := bufio.NewScanner(stdout)\n    for scanner.Scan() {\n        m := scanner.Text()\n        fmt.Println(m)\n    }\n    fmt.Println(\"EOF\")\n}\n</code></pre>\n\n<hr>\n\n<p>2: Also you may Wait using <code>sync.WaitGroup</code>, like this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os/exec\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    cmd := exec.Command(\"Streamer\")\n    c := make(chan struct{})\n    wg.Add(1)\n    go func(cmd *exec.Cmd, c chan struct{}) {\n        defer wg.Done()\n        stdout, err := cmd.StdoutPipe()\n        if err != nil {\n            panic(err)\n        }\n        &lt;-c\n        scanner := bufio.NewScanner(stdout)\n        for scanner.Scan() {\n            m := scanner.Text()\n            fmt.Println(m)\n        }\n    }(cmd, c)\n\n    c &lt;- struct{}{}\n    cmd.Start()\n\n    wg.Wait()\n    fmt.Println(\"done.\")\n}\n</code></pre>\n\n<hr>\n\n<p>And Streamer sample code (just for testing):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    for i := 0; i &lt; 10; i++ {\n        time.Sleep(1 * time.Second)\n        fmt.Println(i, \":\", time.Now().UTC())\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>And see <code>func (c *Cmd) StdoutPipe() (io.ReadCloser, error)</code>  Docs:  </p>\n\n<blockquote>\n  <p>StdoutPipe returns a pipe that will be connected to the command's\n  standard output when the command starts.</p>\n  \n  <p>Wait will close the pipe after seeing the command exit, so most\n  callers need not close the pipe themselves; however, an implication is\n  that it is incorrect to call Wait before all reads from the pipe have\n  completed. For the same reason, it is incorrect to call Run when using\n  StdoutPipe. See the example for idiomatic usage.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": false, "score": 1, "last_activity_date": 1470826244, "last_edit_date": 1470826244, "creation_date": 1470825495, "answer_id": 38871065, "question_id": 38866952, "link": "https://stackoverflow.com/questions/38866952/streaming-commands-output-progress-from-goroutine/38871065#38871065", "title": "Streaming commands output progress from Goroutine", "body": "<p>From godocs:</p>\n\n<blockquote>\n  <p>StdoutPipe returns a pipe that will be connected to the command's\n  standard output when the command starts.</p>\n  \n  <p>Wait will close the pipe after seeing the command exit, so most\n  callers need not close the pipe themselves; however, an implication is\n  that it is incorrect to call Wait before all reads from the pipe have\n  completed.</p>\n</blockquote>\n\n<p>You are calling <code>Wait()</code> immediately after starting the command. So the pipe gets closed as soon as the command completes, before making sure you have read all the data from the pipe. Try moving <code>Wait()</code> to your go routine after the scan loop.</p>\n\n<pre><code>go func(cmd *exec.Cmd, c chan int) {\n    stdout, _ := cmd.StdoutPipe()\n\n    &lt;-c\n\n    scanner := bufio.NewScanner(stdout)\n    for scanner.Scan() {\n        m := scanner.Text()\n        fmt.Println(m)\n    }\n\n    cmd.Wait()\n    c &lt;- 1\n}(cmd, c)\n\ncmd.Start()\nc &lt;- 1\n\n// This is here so we don't exit the program early,\n&lt;-c\n</code></pre>\n\n<p>There's also a simpler way to do things, which is to just assign os.stdout as the cmd's stdout, causing the command to directly write to the os.stdout:</p>\n\n<pre><code>cmd := exec.Command(\"some\", \"command\")\ncmd.Stdout = os.Stdout\ncmd.Run()\n</code></pre>\n"}], "owner": {"reputation": 899, "user_id": 2914587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8264caf9ad892f1a8a3128aeebbdb0ac?s=128&d=identicon&r=PG&f=1", "display_name": "supercalifragilistichespirali", "link": "https://stackoverflow.com/users/2914587/supercalifragilistichespirali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2990, "favorite_count": 2, "accepted_answer_id": 38870609, "answer_count": 2, "score": 2, "last_activity_date": 1470830063, "creation_date": 1470814405, "last_edit_date": 1495541342, "question_id": 38866952, "link": "https://stackoverflow.com/questions/38866952/streaming-commands-output-progress-from-goroutine", "title": "Streaming commands output progress from Goroutine", "body": "<p><a href=\"https://stackoverflow.com/questions/30725751/streaming-commands-output-progress\">Streaming commands output progress</a> question addresses the problem of printing progress of a long running command.</p>\n\n<p>I tried to put the printing code within a goroutine but the scanner claims  to have already hit the <code>EOF</code> immediately and the for block is never executed.</p>\n\n<p>The <code>bufio.scan</code> code that gets executed on the first execution of the <code>Scan()</code> method is:</p>\n\n<pre><code>    // We cannot generate a token with what we are holding.\n    // If we've already hit EOF or an I/O error, we are done.\n    if s.err != nil {\n        // Shut it down.\n        s.start = 0\n        s.end = 0\n        return false\n    }\n</code></pre>\n\n<p>And if I print <code>s.err</code> the output is <code>EOF</code>.</p>\n\n<p>The code I'm trying to run is:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>cmd := exec.Command(\"some\", \"command\")\nc := make(chan int, 1)\n\ngo func(cmd *exec.Cmd, c chan int) {\n    stdout, _ := cmd.StdoutPipe()\n\n    &lt;-c\n\n    scanner := bufio.NewScanner(stdout)\n    for scanner.Scan() {\n        m := scanner.Text()\n        fmt.Println(m)\n    }\n}(cmd, c)\n\ncmd.Start()\n\nc &lt;- 1\n\ncmd.Wait()\n</code></pre>\n\n<p>The idea is to start the Goroutine, get a hold of the <code>cmd.stdout</code>, wait that the <code>cmd</code> is started, and start processing its output.</p>\n\n<p>The result is that the long command gets executed and the program waits for its completion, but nothing is printed to terminal.</p>\n\n<p>Any idea why by the time <code>scanner.Scan()</code> is invoked for the first time the <code>stdout</code> has already reached <code>EOF</code>?</p>\n"}, {"tags": ["arrays", "string", "go", "int", "maping"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1470803172, "post_id": 38864187, "comment_id": 65091544, "body": "What kind of mapping are you looking for exactly? Do you mean conversion to a single dimensional array?"}, {"owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1470803615, "post_id": 38864187, "comment_id": 65091679, "body": "I want to map A1 to 1, A2 to 2,...B1 to 9,.....H8 to 64 @abhink"}], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1470804530, "creation_date": 1470804530, "answer_id": 38864475, "question_id": 38864187, "link": "https://stackoverflow.com/questions/38864187/how-to-map-values-of-string-type-array-with-int-type-array-in-golang/38864475#38864475", "title": "How to map values of string type array with int type array in Golang?", "body": "<p>You could use a map instead of a slice for <code>change</code>:</p>\n\n<pre><code>change := make(map[int]string)\n\nfor i = 0; i &lt; 8; i++ {  \n    for j = 0; j &lt; 8; j++ {  \n        board[i][j] = string(i+65) + string(j+49)\n        // map 1-&gt;A1, 2-&gt;A2...64-&gt;H8\n        change[i*8 + j+1] = board[i][j]\n        fmt.Print(board[i][j] ,\" \")  \n    }    \n}    \n</code></pre>\n\n<p>There shouldn't be any need for the second loop.</p>\n\n<p>Example: <a href=\"https://play.golang.org/p/VOGhNpiG3g\" rel=\"nofollow\">https://play.golang.org/p/VOGhNpiG3g</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1470804981, "creation_date": 1470804981, "answer_id": 38864544, "question_id": 38864187, "link": "https://stackoverflow.com/questions/38864187/how-to-map-values-of-string-type-array-with-int-type-array-in-golang/38864544#38864544", "title": "How to map values of string type array with int type array in Golang?", "body": "<p>Use <code>int(s[0]-'A')*8 + int(s[1]-'0')</code> like this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(toNumber(\"A1\")) // 1\n    fmt.Println(toNumber(\"A2\")) // 2\n    fmt.Println(toNumber(\"B1\")) // 9\n    fmt.Println(toNumber(\"H8\")) // 64\n    convert()\n}\nfunc toNumber(s string) int {\n    if len(s) != 2 {\n        panic(\"len(string) != 2\")\n    }\n    return int(s[0]-'A')*8 + int(s[1]-'0')\n}\nfunc convert() {\n    change := [64]int{}\n    board := [8][8]string{}\n    k := 0\n    for i := 0; i &lt; 8; i++ {\n        for j := 0; j &lt; 8; j++ {\n            board[i][j] = string(i+65) + string(j+49)\n            fmt.Print(board[i][j], \" \")\n            change[k] = toNumber(board[i][j])\n            k++\n        }\n        fmt.Println()\n    }\n    fmt.Println()\n\n    for i := 0; i &lt; 64; i++ {\n        fmt.Print(change[i], \" \")\n    }\n    fmt.Println()\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>1\n2\n9\n64\nA1 A2 A3 A4 A5 A6 A7 A8 \nB1 B2 B3 B4 B5 B6 B7 B8 \nC1 C2 C3 C4 C5 C6 C7 C8 \nD1 D2 D3 D4 D5 D6 D7 D8 \nE1 E2 E3 E4 E5 E6 E7 E8 \nF1 F2 F3 F4 F5 F6 F7 F8 \nG1 G2 G3 G4 G5 G6 G7 G8 \nH1 H2 H3 H4 H5 H6 H7 H8 \n\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 \n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "accepted_answer_id": 38864544, "answer_count": 2, "score": 0, "last_activity_date": 1470867528, "creation_date": 1470802958, "last_edit_date": 1470867528, "question_id": 38864187, "link": "https://stackoverflow.com/questions/38864187/how-to-map-values-of-string-type-array-with-int-type-array-in-golang", "title": "How to map values of string type array with int type array in Golang?", "body": "<p>I want to know how to map each element of board with respective element of change.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func convert () {  \n        var i,j,k int   \n        k = 1  \n        change := [64]int {}  \n        board := [8][8]string{}  \n\n       for i = 0; i &lt; 8; i++ {  \n            for j = 0; j &lt; 8; j++ {  \n                board[i][j] = string(i+65) + string(j+49)  \n                fmt.Print(board[i][j] ,\" \")  \n            }  \n            fmt.Println()  \n        }    \n        fmt.Println()  \n\n        for i = 0 ; i &lt; 64 ; i++ {\n                change[i] = k\n                k++\n              fmt.Print(change[i] ,\" \")\n            }\n        fmt.Println()\n      }\n    }\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1470790693, "creation_date": 1470790693, "answer_id": 38862645, "question_id": 38862606, "link": "https://stackoverflow.com/questions/38862606/go-expression-seems-to-not-follow-order-of-operations/38862645#38862645", "title": "go expression seems to not follow order of operations", "body": "<p>The expression <code>a / b * c</code> is grouped as <code>(a / b) * c</code>.  The expression <code>a / (b * c)</code> is grouped as shown. The first multiplies by <code>c</code>. The second divides by <code>c</code>.</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 38862645, "answer_count": 1, "score": -1, "last_activity_date": 1470790693, "creation_date": 1470790306, "question_id": 38862606, "link": "https://stackoverflow.com/questions/38862606/go-expression-seems-to-not-follow-order-of-operations", "title": "go expression seems to not follow order of operations", "body": "<p>In <code>go</code> I am getting two different answers to equations that should be evaluating the same as far as I can see... I am doing the <code>go</code> tour and I am on this page ( <a href=\"https://tour.golang.org/flowcontrol/8\" rel=\"nofollow\">https://tour.golang.org/flowcontrol/8</a> ) </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc Sqrt(x float64) float64 {\n    z := 1.0\n    for i := 0; i &lt; int(x); i++ {\n        z = z - ((z * z - x) / 2 * z)\n        fmt.Println(z)\n    }\n    return z\n}\n\nfunc main() {\n    fmt.Println(Sqrt(9))\n}\n</code></pre>\n\n<p>Here is the code that I initially wrote that was not working, It seems that I \"NEED\" parentheses like this...</p>\n\n<pre><code>z = z - ((z * z - x) / (2 * z))\n</code></pre>\n\n<p>But I cannot see any reason why I would need to specify the order of operations like that since it seems like it shouldn't matter</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1470781701, "post_id": 38861295, "comment_id": 65086766, "body": "I would recommend against unmarshalling into an interface, there are simpler solutions to the same problem. Here&#39;s a couple suggestions that might get you moving towards an appropriate solution. So one option is to provide custom implementation of <code>UnmarshalJSON</code> (<a href=\"https://gist.github.com/mdwhatcott/8dd2eef0042f7f1c0cd8\" rel=\"nofollow noreferrer\">gist.github.com/mdwhatcott/8dd2eef0042f7f1c0cd8</a>) where you would provide custom logic to convert the strings to doubles. The other would be to keep everything the same but define just those inner arrays as an <code>[]interface{}</code>. You could also convert after this, just I would recommend being as specific as possible there."}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1470802668, "post_id": 38861295, "comment_id": 65091414, "body": "For me, better for you to make standard JSON instead. Is the one who generate JSON is external program or your program?"}, {"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1470804042, "post_id": 38861295, "comment_id": 65091825, "body": "I agree, if you have control over the structure of the json, that would be better still. But, as is usually the case you don&#39;t, and so you can use my answer."}, {"owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "reply_to_user": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1470812928, "post_id": 38861295, "comment_id": 65095808, "body": "@Apin Unfortunately these are external services generating the JSON."}], "answers": [{"tags": [], "owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "is_accepted": true, "score": 4, "last_activity_date": 1470804198, "last_edit_date": 1470804198, "creation_date": 1470803841, "answer_id": 38864359, "question_id": 38861295, "link": "https://stackoverflow.com/questions/38861295/how-to-parse-json-arrays-with-two-different-data-types-into-a-struct-in-golang/38864359#38864359", "title": "How to parse JSON arrays with two different data types into a struct in Golang", "body": "<p>Why not just leave out declaring the types of the A and B slices like so?</p>\n\n<pre><code>data := []byte(`{\"a\": [[\"12.58861425\",10.52046452],[\"12.58861426\",4.1073]],\"b\": [[\"12.58861425\",10.52046452],[\"12.58861426\",4.1073]],\"c\": \"true\",\"d\": 1234}`)\n\ntype OrderBook struct {\n    A [][2]interface{} `json:\"a\"`\n    B [][2]interface{} `json:\"b\"`\n    C string           `json:\"c\"`\n    D uint32           `json:\"d\"`\n}\norders := new(OrderBook)\nerr := json.Unmarshal(data, &amp;orders)\nif err != nil {\n    fmt.Printf(err.Error())\n} else {\n    fmt.Printf(\"%s\\n\", orders.A[0][0].(string))     \n    fmt.Printf(\"%f\\n\", orders.A[0][1].(float64))\n}\n</code></pre>\n\n<p>There's an example in the playground: <a href=\"https://play.golang.org/p/0MUY-yOYII\" rel=\"nofollow\">https://play.golang.org/p/0MUY-yOYII</a></p>\n\n<p>I must disagree with evanmcdonnal, there are certainly use cases where where rolling your own Unmarshaller makes sense, this I do not believe is one of them.  It doesn't get much simpler than what is shown here.</p>\n"}], "owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3241, "favorite_count": 0, "accepted_answer_id": 38864359, "answer_count": 1, "score": 2, "last_activity_date": 1470804198, "creation_date": 1470780959, "question_id": 38861295, "link": "https://stackoverflow.com/questions/38861295/how-to-parse-json-arrays-with-two-different-data-types-into-a-struct-in-golang", "title": "How to parse JSON arrays with two different data types into a struct in Golang", "body": "<p>I have JSON that looks like this:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>{\r\n    \"a\": [\r\n          [\r\n              \"12.58861425\",\r\n              10.52046452\r\n          ],\r\n          [\r\n              \"12.58861426\",\r\n              4.1073\r\n          ]\r\n        ]\r\n    \"b\": [\r\n          [\r\n              \"12.58861425\",\r\n              10.52046452\r\n          ],\r\n          [\r\n              \"12.58861426\",\r\n              4.1073\r\n          ]\r\n        ]\r\n    \"c\": \"true\"\r\n    \"d\": 1234\r\n}\r\n        </code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I want to unmarshall this into a struct I created:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>type OrderBook struct {\r\n\tA [][2]float32 `json:\"a\"`\r\n\tB [][2]float32 `json:\"b\"`\r\n        C string `json:\"c\"`\r\n\tD uint32 `json:\"d\"`\r\n}\r\n\r\n//Note this won't work because the JSON array contains a string and a float value pair rather than only floats.</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Normally I would then convert this JSON into a struct in Golang as so:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>orders := new(OrderBook)\r\nerr = json.Unmarshal(JSON, &amp;orders)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Since I can't define the type struct to match the JSON this won't work. Doing a bit of reading, I think Unmarshal-ing into an interface, and then using the interface data through type checking may be a solution. </p>\n\n<p>Am I going in the right direction with this?<br>\nA template showing how I might go about using the data once it's in the interface would really help.</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1470769541, "post_id": 38858500, "comment_id": 65081194, "body": "<code>foo</code> the <code>interface{}</code> is addressable, but the value within the interface is not. I don&#39;t think the first example does what you think it does."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1470779146, "post_id": 38858500, "comment_id": 65085832, "body": "The value of the argument <code>foo</code> is passed to <code>reflect.Value</code>. It&#39;s impossible for reflect to discover the address of the argument from the value stored in the argument."}], "owner": {"reputation": 879, "user_id": 73309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3580fe1b74d0daebd7c5508263d5008?s=128&d=identicon&r=PG", "display_name": "Will Charczuk", "link": "https://stackoverflow.com/users/73309/will-charczuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470769252, "creation_date": 1470769252, "question_id": 38858500, "link": "https://stackoverflow.com/questions/38858500/how-to-take-address-of-argument-with-reflection", "title": "How to take address of argument with reflection", "body": "<p>Basic situation:</p>\n\n<p>you can do this in golang:</p>\n\n<pre><code>func addrOf(foo interface{}) interface{} {\n    return &amp;foo\n}\n</code></pre>\n\n<p>but you cannot do this:</p>\n\n<pre><code>func addrOf(foo interface{}) interface{} {\n    fooValue := reflect.ValueOf(foo)\n    return fooValue.Addr().Interface()\n}\n</code></pre>\n\n<p>Am I doing something wrong? why is <code>foo</code> addressable to the language but not to reflect?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 7, "creation_date": 1470763542, "post_id": 38856959, "comment_id": 65078131, "body": "Go docs are extremely easy to read.  Many questions like this can be answered by clicking on the function definition within the docs site. <a href=\"https://golang.org/pkg/time/#NewTicker\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#NewTicker</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 11, "last_activity_date": 1470763447, "creation_date": 1470763447, "answer_id": 38856982, "question_id": 38856959, "link": "https://stackoverflow.com/questions/38856959/go-time-tick-vs-time-newticker/38856982#38856982", "title": "Go time.Tick vs time.NewTicker", "body": "<p>From the <a href=\"https://godoc.org/time#Tick\" rel=\"noreferrer\">time.Tick documentation</a>:</p>\n\n<blockquote>\n  <p>Tick is a convenience wrapper for NewTicker providing access to the ticking channel only. While Tick is useful for clients that have no need to shut down the Ticker, be aware that without a way to shut it down the underlying Ticker cannot be recovered by the garbage collector; it \"leaks\".</p>\n</blockquote>\n"}], "owner": {"reputation": 4909, "user_id": 1177295, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jHPUu.jpg?s=128&g=1", "display_name": "Raghavendra", "link": "https://stackoverflow.com/users/1177295/raghavendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4255, "favorite_count": 2, "accepted_answer_id": 38856982, "answer_count": 1, "score": 0, "last_activity_date": 1470763447, "creation_date": 1470763367, "question_id": 38856959, "link": "https://stackoverflow.com/questions/38856959/go-time-tick-vs-time-newticker", "title": "Go time.Tick vs time.NewTicker", "body": "<p>I am new to Go and started learning recently. I have come across tickers and timers. In the tickers, we can create a ticker in two ways</p>\n\n<pre><code>throttler := time.Tick(time.Millisecond * 50)\n&lt;- throttler\n\nthrottler := time.NewTicker(time.Millisecond * 500)\n&lt;- throttler.C\n</code></pre>\n\n<p>What is the difference between them other than syntax?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1470760795, "post_id": 38855836, "comment_id": 65076727, "body": "There was a relevant gophercon talk this year. I can&#39;t find the slides, but here&#39;s the author&#39;s blog post covering the same material: <a href=\"http://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully\" rel=\"nofollow noreferrer\">dave.cheney.net/2016/04/27/&hellip;</a> <i>edit</i> heh I independently linked the same reference as the dupe :)"}, {"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1470814525, "post_id": 38855836, "comment_id": 65096741, "body": "I generally only use panics for unrecoverable errors.  Otherwise, the &quot;go way&quot; is to check if err != nil {return err} or whatever the return signature dictates."}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "closed_date": 1470761188, "answer_count": 0, "score": 1, "last_activity_date": 1470759448, "creation_date": 1470759448, "question_id": 38855836, "link": "https://stackoverflow.com/questions/38855836/what-is-good-practice-for-nested-functions-return-error", "closed_reason": "Duplicate", "title": "What is good practice for nested function&#39;s return error?", "body": "<p>In Go, assume that I write a function which calls several functions which return the <code>error</code> type.</p>\n\n<ol>\n<li><p>Which one is a better practice</p>\n\n<ul>\n<li>inside my function, check the return error of each called function, immediately after it returns, and panic if the return\nerror is not nil</li>\n<li>make my function return the <code>error</code> type, depending on whether there is an called function inside returning non-nil error, and when\nmy function is called and finishes running, check its return error\nand panic if the return error is not nil.</li>\n<li>both</li>\n</ul>\n\n<p>In my current implementation of my function, I actually do both. But\nI think it might be redundant to do so, since if a panic happens\nright after a called function returns a non-nil error, the panic\nwill be handled immediately, and my function will never reach the\nstep to return error.</p>\n\n<p>If I am correct that doing both is redundant, is it correct that it\nis better to check the error earlier than later, i.e. is it better\nto check the return error of each called function immediately after\nit returns, than to check the return error of my function which is\nthe caller?</p></li>\n<li><p>Which one is a better practice</p>\n\n<ul>\n<li>use the same object of <code>error</code> to store the returns of the called functions, </li>\n<li>create a different object of <code>error</code> to store the return of different called function?</li>\n</ul></li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["windows", "bash", "google-app-engine", "go", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470753973, "post_id": 38853624, "comment_id": 65071911, "body": "Do you have the correct version of Python? <code>2.x</code> is required, <code>3.x</code> is not good for GAE SDK. Run <code>python -V</code> to find out."}, {"owner": {"reputation": 333, "user_id": 6314007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b627e22e41844aade50e6e6584a420?s=128&d=identicon&r=PG", "display_name": "Takumi Sato", "link": "https://stackoverflow.com/users/6314007/takumi-sato"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470754413, "post_id": 38853624, "comment_id": 65072249, "body": "Sorry, I forgot that informations.  <code>Python 2.7.6</code>   Go version :  <code>go version go1.6.3 linux&#47;amd64</code>  AppEngine : <code>go version go1.6.2 (appengine-1.9.40) linux&#47;amd64</code>"}], "answers": [{"tags": [], "owner": {"reputation": 333, "user_id": 6314007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b627e22e41844aade50e6e6584a420?s=128&d=identicon&r=PG", "display_name": "Takumi Sato", "link": "https://stackoverflow.com/users/6314007/takumi-sato"}, "is_accepted": true, "score": 5, "last_activity_date": 1470800749, "creation_date": 1470800749, "answer_id": 38863870, "question_id": 38853624, "link": "https://stackoverflow.com/questions/38853624/appengine-sdk-for-go-with-bash-on-ubuntu-on-windows/38863870#38863870", "title": "AppEngine SDK for Go with Bash on Ubuntu on Windows", "body": "<p>I got answer by myself.</p>\n\n<p>This problem was happening in Bash on Ubuntu on Windows.</p>\n\n<p>It does not support File Watcher. ( Already somebody made a issue <a href=\"https://github.com/Microsoft/BashOnWindows/issues/216\" rel=\"noreferrer\">https://github.com/Microsoft/BashOnWindows/issues/216</a>)</p>\n\n<p>Therefore, I use <code>dev_appserver.py</code> and <code>--use_mtime_file_watcher=true</code> option.</p>\n\n<p>Here is my full command that works perfectly.</p>\n\n<p><code>$ dev_appserver.py --use_mtime_file_watcher=true /home/surface/projects/</code></p>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 333, "user_id": 6314007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b627e22e41844aade50e6e6584a420?s=128&d=identicon&r=PG", "display_name": "Takumi Sato", "link": "https://stackoverflow.com/users/6314007/takumi-sato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 1, "accepted_answer_id": 38863870, "answer_count": 1, "score": 4, "last_activity_date": 1472103830, "creation_date": 1470753084, "last_edit_date": 1472103830, "question_id": 38853624, "link": "https://stackoverflow.com/questions/38853624/appengine-sdk-for-go-with-bash-on-ubuntu-on-windows", "title": "AppEngine SDK for Go with Bash on Ubuntu on Windows", "body": "<p>I am trying to use AppEngine SDK for Go in Bash on Ubuntu on Windows, but I have an error. Here is my code.</p>\n\n<p>app.yaml</p>\n\n<pre><code>runtime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"github.com/labstack/echo\"\n    \"github.com/labstack/echo/engine/standard\"\n)\n\nfunc init() {\n    e := echo.New()\n    e.GET(\"/\", func(c echo.Context) error {\n        return c.String(http.StatusOK, \"Hello, World!\")\n    })\n    s := standard.New(\"\")\n    s.SetHandler(e)\n    http.Handle(\"/\", s)\n}\n</code></pre>\n\n<p>and here is error and command.</p>\n\n<pre><code>surface@DESKTOP-U7N4QNQ:~/projects$ goapp serve\nINFO     2016-08-09 14:24:35,574 devappserver2.py:769] Skipping SDK update check.\nINFO     2016-08-09 14:24:35,665 api_server.py:205] Starting API server at: http://localhost:38070\nINFO     2016-08-09 14:24:35,670 api_server.py:648] Applying all pending transactions and saving the datastore\nINFO     2016-08-09 14:24:35,671 api_server.py:651] Saving search indexes\nTraceback (most recent call last):\n  File \"/home/surface/dev/go_appengine/dev_appserver.py\", line 89, in &lt;module&gt;\n    _run_file(__file__, globals())\n  File \"/home/surface/dev/go_appengine/dev_appserver.py\", line 85, in _run_file\n    execfile(_PATHS.script_file(script_name), globals_)\n  File \"/home/surface/dev/go_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 1040, in &lt;module&gt;\n    main()\n  File \"/home/surface/dev/go_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 1033, in main\n    dev_server.start(options)\n  File \"/home/surface/dev/go_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 824, in start\n    self._dispatcher.start(options.api_host, apis.port, request_data)\n  File \"/home/surface/dev/go_appengine/google/appengine/tools/devappserver2/dispatcher.py\", line 194, in start\n    _module.start()\n  File \"/home/surface/dev/go_appengine/google/appengine/tools/devappserver2/module.py\", line 1180, in start\n    self._watcher.start()\n  File \"/home/surface/dev/go_appengine/google/appengine/tools/devappserver2/inotify_file_watcher.py\", line 220, in start\n    self._add_watch_for_path(directory)\n  File \"/home/surface/dev/go_appengine/google/appengine/tools/devappserver2/inotify_file_watcher.py\", line 205, in _add_watch_for_path\n    raise error\nOSError: [Errno 22] EINVAL: '/home/surface/projects'\nerror while running dev_appserver.py: exit status 1\nsurface@DESKTOP-U7N4QNQ:~/projects$\n</code></pre>\n\n<p>I do not have any idea to resolve this problem.\nI think this is a SDK's problem. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1470755486, "post_id": 38853564, "comment_id": 65073097, "body": "Time zone info database is provided by the operating system. Are you asking where that database comes from?"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1470830584, "post_id": 38853564, "comment_id": 65107245, "body": "Please give more information about that issue you ran into. Your question is not really clear, without that information."}], "answers": [{"tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": true, "score": 1, "last_activity_date": 1470831509, "last_edit_date": 1470831509, "creation_date": 1470830151, "answer_id": 38872765, "question_id": 38853564, "link": "https://stackoverflow.com/questions/38853564/where-does-go-get-time-zone-information-from/38872765#38872765", "title": "Where does Go get time zone information from?", "body": "<p>Actually it depends.</p>\n\n<p>Check time.LoadLocation() source and the comment above it. Particularly, it says this:</p>\n\n<pre><code>// LoadLocation looks in the directory or uncompressed zip file\n// named by the ZONEINFO environment variable, if any, then looks in\n// known installation locations on Unix systems,\n// and finally looks in $GOROOT/lib/time/zoneinfo.zip.\n</code></pre>\n\n<p>And you should keep in mind that on a Unix/Posix systems (e.g. Linux), proper time zone data files are always available in \"known installation locations\". But on other systems there no such locations. As a result, on Windows, LoadLocation zone won't find any time zones (unless either ZONEINFO or GOROOT were configured properly) and will just use default instead (which is UTC, if my memory is correct).</p>\n\n<p>However, the LMT issue you described above is a bit different beast. You see, LMT is not exactly a proper time zone. E.g. see <a href=\"http://www.timeanddate.com/time/local-mean-time.html\" rel=\"nofollow\">here</a>. And I didn't dig out where exactly it comes from, but I suspect it is related to the fact that the time zone was not established yet at the time that you're converting. So, go seems to be calculating LMT of the place instead. </p>\n\n<p>For example, if you just change year from 1900 to 2000 (or even 1905) in your playground example, it will come out with correct time zone (CET).</p>\n\n<p>As to the difference between machines, I'd say it's pretty arguable what is the most natural way of defining time zone rules before they were actually introduced. As a result, I would imagine that in some time zone databases, start time of the first rule in a time zone will be either omitted or adjusted to extend it further to the past. While others will put an LMT offset there instead. (Even though most if not all of them are derived from the same IANA database in one way or another.)</p>\n\n<p>If you want to ensure exact same behavior on different machines, I'd say building your own zoneinfo.zip and setting ZONEINFO variable should help.</p>\n"}], "owner": {"reputation": 2548, "user_id": 493886, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/609445395685769579dc8fb2dbb83f49?s=128&d=identicon&r=PG", "display_name": "rausch", "link": "https://stackoverflow.com/users/493886/rausch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1459, "favorite_count": 0, "accepted_answer_id": 38872765, "answer_count": 1, "score": 1, "last_activity_date": 1470831509, "creation_date": 1470752940, "question_id": 38853564, "link": "https://stackoverflow.com/questions/38853564/where-does-go-get-time-zone-information-from", "title": "Where does Go get time zone information from?", "body": "<p>I ran into an issue with Go code, related to time zones, that would return either <code>1900-01-01 01:00:00 +0100 CET</code> or <code>1900-01-01 00:53:28 +0053 LMT</code>, depending on which machine it is being run:</p>\n\n<p><a href=\"https://play.golang.org/p/K3ceq1n1KI\" rel=\"nofollow\">https://play.golang.org/p/K3ceq1n1KI</a></p>\n\n<p>I was able to rule out the Go version as source of the difference. Where does Go get its time zone information from?</p>\n"}, {"tags": ["sockets", "go", "network-programming", "packet-sniffers", "sniffer"], "comments": [{"owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "edited": false, "score": 0, "creation_date": 1470755429, "post_id": 38853365, "comment_id": 65073057, "body": "You may like to check <a href=\"https://github.com/buger/gor\" rel=\"nofollow noreferrer\">github.com/buger/gor</a> for reference, and <a href=\"https://github.com/buger/gor/blob/master/raw_socket_listener/listener.go#L595\" rel=\"nofollow noreferrer\">github.com/buger/gor/blob/master/raw_socket_listener/&hellip;</a> in particular."}, {"owner": {"reputation": 29, "user_id": 6226193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c9d3d3d8bfcf3a0499e2d55e1536c2?s=128&d=identicon&r=PG&f=1", "display_name": "query_port", "link": "https://stackoverflow.com/users/6226193/query-port"}, "reply_to_user": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "edited": false, "score": 0, "creation_date": 1470759031, "post_id": 38853365, "comment_id": 65075603, "body": "Slawosz, those are both great examples. Thanks. However, I&#39;m looking for something that will allow to parse the packet use dns queries identified in the packet. We have a tap from a remote interface that is pushing packets to my interface, and I&#39;m attempting to accept them and pull them apart. I&#39;ve used Python Scapy and the amount of packets we have coming in are too many for Scapy to handle."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1470762235, "post_id": 38853365, "comment_id": 65077494, "body": "Go can do raw sockets just fine. <a href=\"https://www.google.com/search?q=raw+socket+golang\" rel=\"nofollow noreferrer\">This search</a> should get you up to speed with examples. Oh, and you could find <a href=\"https://github.com/miekg/dns\" rel=\"nofollow noreferrer\">this library</a> useful if you want to parse DNS stuff from its wire format -- it provides for advanced processing of in plain Go."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1470762538, "post_id": 38853365, "comment_id": 65077640, "body": "You might also be tempted to use something like <code>gopacket</code> which wraps dissecting libraries provided by <code>tcpdump</code> and Wireshark but you must keep in mind that calling C from Go is <i>slow</i> -- possibly slower than performing a syscall, so if performance is of paramount importance steer clear from wrapped C libraries and make sure you&#39;re using pure Go."}, {"owner": {"reputation": 29, "user_id": 6226193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c9d3d3d8bfcf3a0499e2d55e1536c2?s=128&d=identicon&r=PG&f=1", "display_name": "query_port", "link": "https://stackoverflow.com/users/6226193/query-port"}, "edited": false, "score": 0, "creation_date": 1470919160, "post_id": 38853365, "comment_id": 65152186, "body": "Roger. Thanks for the feedback and help."}], "owner": {"reputation": 29, "user_id": 6226193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c9d3d3d8bfcf3a0499e2d55e1536c2?s=128&d=identicon&r=PG&f=1", "display_name": "query_port", "link": "https://stackoverflow.com/users/6226193/query-port"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1111, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1470762129, "creation_date": 1470752426, "last_edit_date": 1470762129, "question_id": 38853365, "link": "https://stackoverflow.com/questions/38853365/implementing-tcp-packet-sniffer-using-raw-sockets-in-go", "title": "Implementing TCP packet sniffer using raw sockets in Go", "body": "<p>I am looking for a way to listen on an interface for all incoming traffic using the Go programming language.</p>\n\n<p>I would want it to be something similar to this python:</p>\n\n<pre><code>import socket, sys\nfrom struct import *\ns = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_TCP)\n\nwhile True:\n    packet = s.recvfrom(65565)\n</code></pre>\n\n<p>Any suggestions would be great. Thanks.</p>\n"}, {"tags": ["json", "go", "memory-leaks", "heap", "profiler"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470750004, "post_id": 38852189, "comment_id": 65068845, "body": "Unmarshaling json uses a lot of reflection and makes a lot of allocations. What exactly is the problem here?"}, {"owner": {"reputation": 21, "user_id": 3151279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ws7LQ.jpg?s=128&g=1", "display_name": "CreditSuisse", "link": "https://stackoverflow.com/users/3151279/creditsuisse"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470750944, "post_id": 38852189, "comment_id": 65069578, "body": "The number of &quot;heap&quot; in profiler is always increasing, so memory usage is increasing"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1470751498, "post_id": 38852189, "comment_id": 65070013, "body": "I highly doubt your memory usage is increasing when running this program. Run this with <code>gctrace=1</code> and watch heap size after each GC."}], "owner": {"reputation": 21, "user_id": 3151279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ws7LQ.jpg?s=128&g=1", "display_name": "CreditSuisse", "link": "https://stackoverflow.com/users/3151279/creditsuisse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1176, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1470749703, "creation_date": 1470749352, "last_edit_date": 1470749703, "question_id": 38852189, "link": "https://stackoverflow.com/questions/38852189/golang-a-lot-of-heap-items-in-profiler-after-json-decode-unmarshal", "title": "Golang: a lot of heap items in profiler after json.Decode/Unmarshal", "body": "<p>I've got a sample golang script: it gets page response and unmarshalles its body in infinitive loop as a goroutine.</p>\n\n<pre><code>package main\n\n\nimport (\n    \"time\"\n    \"net/http\"\n    \"encoding/json\"\n    \"fmt\"\n    _ \"net/http/pprof\"\n)\n\nfunc init() {\n    go http.ListenAndServe(\":8087\", http.DefaultServeMux)\n}\n\n\nfunc DoTask()  {\n    resp, _ := http.Get(\"https://www.citibikenyc.com/stations/json\")\n    defer resp.Body.Close()\n    var answerInterface map[string]interface{}\n    json.NewDecoder(resp.Body).Decode(&amp;answerInterface)\n}\n\n\n\nfunc main() {\n    for {\n        go func() {\n            time.Sleep(1*time.Second)\n            DoTask()\n            fmt.Println(\"goroutine finished\")\n        }()\n        time.Sleep(1*time.Second)\n    }\n}\n</code></pre>\n\n<p>But when I open profiler the number of heap items is increasing all the \ntime. \nExample of heap item:</p>\n\n<pre><code>#   0x6b7699    compress/flate.NewReader+0x49           /usr/local/go/src/compress/flate/inflate.go:828\n#   0x5f339d    compress/gzip.(*Reader).readHeader+0x7ad    /usr/local/go/src/compress/gzip/gunzip.go:254\n#   0x5f1da7    compress/gzip.NewReader+0x207           /usr/local/go/src/compress/gzip/gunzip.go:95\n#   0x4d5117    net/http.(*gzipReader).Read+0x97        /usr/local/go/src/net/http/transport.go:1658\n#   0x4d4c6a    net/http.(*bodyEOFSignal).Read+0x26a        /usr/local/go/src/net/http/transport.go:1613\n#   0x502617    encoding/json.(*Decoder).refill+0x287       /usr/local/go/src/encoding/json/stream.go:152\n#   0x5022a3    encoding/json.(*Decoder).readValue+0x413    /usr/local/go/src/encoding/json/stream.go:128\n#   0x501ba9    encoding/json.(*Decoder).Decode+0x159               /usr/local/go/src/encoding/json/stream.go:57\n#   0x401219    main.DoTask+0x169               /root/test.go:21\n#   0x4012f9    main.main.func1+0x29                /root/test.go:30\n</code></pre>\n\n<p>Couldn't you explain, what is the problem? Thank you anyway</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470749690, "post_id": 38851835, "comment_id": 65068599, "body": "Are you certain <code>Wait</code> is blocking? Have you confirmed the call to <code>stdin.Close()</code> completed? Why are you writing a single byte at a time, and why are you using a buffered writer if you Flush after every byte?"}, {"owner": {"reputation": 39, "user_id": 1725853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d081ab202f2b0d5e6856261b57d281ff?s=128&d=identicon&r=PG", "display_name": "user1725853", "link": "https://stackoverflow.com/users/1725853/user1725853"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470752352, "post_id": 38851835, "comment_id": 65070699, "body": "Hi Jim. At your suggestion, I did put in some more error checks, and things do seem to be OK. The data is not going byte at a time, the chunk_begin array is typically spaced so that data goes in units of around 50k bytes."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470753002, "post_id": 38851835, "comment_id": 65071199, "body": "Ah yes, I missed <code>chunk_begin</code> was being indexed, not the bytes themselves. If all your data is sent, and the stdin pipe is getting closed, then the command being executed by bash simply isn&#39;t exiting and you need to debug that. Does <code>cmd</code> <i>require</i> being run in a shell? Can you provide input as a single <code>io.Reader</code> to the process&#39;s stdin and see if that changes anything without the pipe?"}, {"owner": {"reputation": 39, "user_id": 1725853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d081ab202f2b0d5e6856261b57d281ff?s=128&d=identicon&r=PG", "display_name": "user1725853", "link": "https://stackoverflow.com/users/1725853/user1725853"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470753216, "post_id": 38851835, "comment_id": 65071360, "body": "Hi Jim I did look closer and the problem is that I was being impatient! Usually Go is fast, but my 28 MB file was taking too long. I just needed to wait a little and not be so impatient. Hopefully others will find this post helpful. Thank you JimB, your comments helped a lot. Ian"}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473800781, "post_id": 38851835, "comment_id": 66277126, "body": "Mark this as answered, @JimB"}], "answers": [{"tags": [], "owner": {"reputation": 5849, "user_id": 657703, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/208ba006821bf4ab078692204d23ceee?s=128&d=identicon&r=PG", "display_name": "\u042f\u0440\u043e\u0441\u043b\u0430\u0432 \u0420\u0430\u0445\u043c\u0430\u0442\u0443\u043b\u043b\u0438\u043d", "link": "https://stackoverflow.com/users/657703/%d0%af%d1%80%d0%be%d1%81%d0%bb%d0%b0%d0%b2-%d0%a0%d0%b0%d1%85%d0%bc%d0%b0%d1%82%d1%83%d0%bb%d0%bb%d0%b8%d0%bd"}, "is_accepted": false, "score": 0, "last_activity_date": 1592596581, "last_edit_date": 1592596581, "creation_date": 1592596127, "answer_id": 62477606, "question_id": 38851835, "link": "https://stackoverflow.com/questions/38851835/go-language-wait-does-not-return-when-sending-data-to-spawned-process/62477606#62477606", "title": "Go language: Wait() does not return when sending data to spawned process", "body": "<p>The issue is with the input program.</p>\n\n<p>cmd.Wait waits for the writer to finish.\nThe call <code>doit.StdinPipe().Close()</code>, does not affect the writer, although, I have to admit I find this surprising.</p>\n\n\n\n<p>I concocted an example to demonstrate this;</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n  \"bufio\"\n  \"io/ioutil\"\n  \"math\"\n  \"os/exec\"\n)\n\nfunc main() {\n  doit := exec.Command(\"/bin/bash\", \"-c\", \"md5sum\")\n  doitStdin,_  := doit.StdinPipe()\n  doitStdout,_ := doit.StdoutPipe()\n  doit.Start()\n  inputData := generateCrapForever()\n  k32 := 33\n  nchunks := len(inputData) / k32\n  chunkBegin := make([]int, nchunks)\n  var i = 0\n  for i&lt;nchunks {\n    chunkBegin[i] = i*k32\n    i++\n  }\n\n  go func() {\n    w := bufio.NewWriter(doitStdin)\n    for i := 0; i &lt; nchunks-1; i++ {\n      last := int(math.Max(float64(chunkBegin[i+1]), float64(len(inputData))))\n      w.Write(inputData[chunkBegin[i]:last])\n      w.Flush()\n    }\n    doitStdin.Close()\n  }()\n\n  rc,_ := ioutil.ReadAll(doitStdout)\n  doit.Wait()\n  println(string(rc))\n}\n\nfunc generateCrapForever() []byte {\n  out, _ := exec.Command(\"dd\", \"if=/dev/urandom\", \"bs=10\" ).Output()\n  return out\n}\n</code></pre>\n\n<p>If you substitute generateCrapForever() with generateCrap(), then the code works. But if the input pipe never exits, and keeps writing, then cmd.Wait will never stop, because it is waiting for the input-pipe to finish.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>  func generateCrap() []byte {\n    out, _ := exec.Command(\"dd\", \"if=/dev/urandom\", \"bs=10\", \"count=33\").Output()\n    return out\n  }\n</code></pre>\n\n<p>Actually, in this example, the blocking code is <code>generateCrapforever()</code> and not <code>cmd.Wait</code>. Perhaps something similar is happening in your code? </p>\n"}], "owner": {"reputation": 39, "user_id": 1725853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d081ab202f2b0d5e6856261b57d281ff?s=128&d=identicon&r=PG", "display_name": "user1725853", "link": "https://stackoverflow.com/users/1725853/user1725853"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1592596581, "creation_date": 1470748481, "last_edit_date": 1512553796, "question_id": 38851835, "link": "https://stackoverflow.com/questions/38851835/go-language-wait-does-not-return-when-sending-data-to-spawned-process", "title": "Go language: Wait() does not return when sending data to spawned process", "body": "<p>I need to send several MB to a spawned Go process. I followed the directions at <a href=\"https://gobyexample.com/spawning-processes\" rel=\"nofollow noreferrer\">https://gobyexample.com/spawning-processes</a>, but my data is too large to send that way. I thought I could chunk the data. Here is the code I ended up with:</p>\n\n<pre><code>doit := exec.Command(\"/bin/bash\", \"-c\", cmd)    // cmd reads stdin\ndoit_stdin,_  := doit.StdinPipe()\ndoit_stdout,_ := doit.StdoutPipe()\n\ndoit.Start()\n\ngo func() {\n  w := bufio.NewWriter(doit_stdin)\n  for i := 0; i &lt; nchunks; i++ {\n    w.Write(input_data[chunk_begin[i]:chunk_begin[i+1]]) \n    w.Flush()\n  }\n  doit_stdin.Close()\n}()\n\nrc,_ := ioutil.ReadAll(doit_stdout)\ndoit.Wait()\n</code></pre>\n\n<p>Where <code>input_data</code> is <code>[]byte</code> and <code>chunk_begin</code> is an array of break points computed elsewhere. Everything works just fine. <code>cmd</code> gets all the data sent to it, detects EOF, sends results back and exits. <code>ReadAll</code> gets all the info sent back from cmd. But <code>do it.Wait()</code> blocks. I cannot understand why <code>doit.Wait</code> is blocking.</p>\n\n<p>Or if there is some other standard way of transferring larger amounts of data, that would be fine too. I do need to control the break points because the data has internal structure.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470772532, "post_id": 38851740, "comment_id": 65082846, "body": "Thanks. It actually looks like the only thing that writes to that is Ancestor() for the purpose of an outgoing query rather than a query result: <a href=\"https://github.com/golang/appengine/blob/master/datastore/query.go#L118\" rel=\"nofollow noreferrer\">github.com/golang/appengine/blob/master/datastore/query.go#L&zwnj;&#8203;118</a> . So, it isn&#39;t actually populated with anything that you don&#39;t already know."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1470748247, "creation_date": 1470748247, "answer_id": 38851740, "question_id": 38851549, "link": "https://stackoverflow.com/questions/38851549/appengine-datastore-golang-get-ancestor-for-a-query-result/38851740#38851740", "title": "AppEngine Datastore Golang: Get ancestor for a query result", "body": "<p>If your query returns results, the ancestor is contained in the entity <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Key\" rel=\"nofollow\"><code>Key</code></a>.</p>\n\n<p>The entity key is returned by <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Iterator.Next\" rel=\"nofollow\"><code>Iterator.Next()</code></a> for example:</p>\n\n<pre><code>func (t *Iterator) Next(dst interface{}) (*Key, error)\n</code></pre>\n\n<p>From the key, use the <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Key.Parent\" rel=\"nofollow\"><code>Key.Parent()</code></a> method to get the ancestor.</p>\n\n<p>See this example:</p>\n\n<pre><code>query := datastore.NewQuery(\"MyEntity\")\n\ne := MyEntity{}\nfor i := query.Run(ctx); ; {\n    if k, err = t.Next(&amp;te); err == nil {\n        log.Infof(\"Ancestor / parent key: %v\", k.Parent())\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Note that the ancestor is stored in the <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Query\" rel=\"nofollow\"><code>datastore.Query</code></a>, but it is not exported:</p>\n\n<pre><code>type Query struct {\n    ancestor *Key\n    // ...\n}\n</code></pre>\n\n<p>And the <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Iterator\" rel=\"nofollow\"><code>datastore.Iterator</code></a> returned by <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Query.Run\" rel=\"nofollow\"><code>Query.Run()</code></a> contains the <code>Query</code>, but it is also unexported:</p>\n\n<pre><code>type Iterator struct {\n    // q is the original query which yielded this iterator.\n    q *Query\n    //...\n}\n</code></pre>\n\n<p>So you can't access these struct fields, your best bet is an actual entity in the result (or rather its key).</p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 1, "accepted_answer_id": 38851740, "answer_count": 1, "score": 1, "last_activity_date": 1471237313, "creation_date": 1470747753, "last_edit_date": 1471237313, "question_id": 38851549, "link": "https://stackoverflow.com/questions/38851549/appengine-datastore-golang-get-ancestor-for-a-query-result", "title": "AppEngine Datastore Golang: Get ancestor for a query result", "body": "<p>Is it possible to get the ancestor key for a query result? Based on the <em>datastore</em> documentation (<a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Query.Run\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/datastore/reference#Query.Run</a>) the query.Run() result only has a Cursor() and a Next() function and neither will lead you to an ancestor. It seems like this should be information that's in scope, unless the mechanics of Datastore prevent it. Is it up to the developer to write the ancestor into a property (with a matching kind) on the child (if we're willing to incur the cost) for it?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6624148, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BzhagXYGPW8/AAAAAAAAAAI/AAAAAAAAAIc/uULBPCL7V58/photo.jpg?sz=128", "display_name": "Stephen Le", "link": "https://stackoverflow.com/users/6624148/stephen-le"}, "edited": false, "score": 0, "creation_date": 1470741427, "post_id": 38849125, "comment_id": 65062800, "body": "Thank u very much! It&#39;s work."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 2, "last_activity_date": 1470740999, "creation_date": 1470740999, "answer_id": 38849125, "question_id": 38848985, "link": "https://stackoverflow.com/questions/38848985/golang-how-to-let-the-template-execute-write-as-html-page/38849125#38849125", "title": "golang how to let the template.Execute write as HTML page", "body": "<p>The browser is rendering the page as it was a text. This is because it received no content type from the server. You need to set it in the header.</p>\n\n<pre><code>w.Header().Set(\"Content-Type\", \"text/html\")\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6624148, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BzhagXYGPW8/AAAAAAAAAAI/AAAAAAAAAIc/uULBPCL7V58/photo.jpg?sz=128", "display_name": "Stephen Le", "link": "https://stackoverflow.com/users/6624148/stephen-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1659, "favorite_count": 0, "closed_date": 1470743338, "answer_count": 1, "score": 0, "last_activity_date": 1470741152, "creation_date": 1470740575, "last_edit_date": 1470741152, "question_id": 38848985, "link": "https://stackoverflow.com/questions/38848985/golang-how-to-let-the-template-execute-write-as-html-page", "closed_reason": "Duplicate", "title": "golang how to let the template.Execute write as HTML page", "body": "<p>I need represent a struct array(load from Mysql) within a template HTML. but the template.Execute() method write response as a string, not represent as a HTML page. \ncan someone help me ? </p>\n\n<pre><code>import (\n    \"fmt\"\n    \"log\"\n    \"time\"\n    \"net/http\"\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n    s \"strings\"\n    \"html/template\"\n    \"io/ioutil\"\n)\nvar p = fmt.Println\n\ntype ListData struct{\n    Id int\n    Os sql.NullString\n    Title string\n} \n\nfunc searchHandler(w http.ResponseWriter, r *http.Request) {\n    db,er := sql.Open(\"mysql\",\"root:11b@tcp(localhost:3306)/collection\")\n    cursor := []ListData{}\n    for rows.Next() {\n        //load data here....\n    }\n    t, pErr := template.ParseFiles(\"./admin/list.html\")\n    if pErr != nil {\n        panic(pErr)\n    }\n    pErr = t.Execute(w, cursor)\n    if pErr != nil {\n        http.Error(w, pErr.Error(), http.StatusInternalServerError)\n        return\n    }\n}//end of searchHandler\n\nfunc main(){\n    p(\"start servlet.\")\n    //other handlers\n    http.HandleFunc(\"/search\", searchHandler)\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>I embed few go code into this HTML files:</p>\n\n<pre><code>........\n&lt;thead&gt;\n   &lt;tr&gt;\n       &lt;th&gt;id&lt;/th&gt;\n       &lt;th&gt;os&lt;/th&gt;\n       &lt;th&gt;title&lt;/th&gt;\n   &lt;/tr&gt;\n&lt;/thead&gt;\n       &lt;tbody&gt;\n             {{range .}}\n               &lt;tr class=\"success\"&gt;\n                &lt;td&gt;{{.Id}}&lt;/td&gt;\n                &lt;td&gt;{{.Os}}&lt;/td&gt;\n                &lt;td&gt;{{.Title}}&lt;/td&gt;\n               &lt;/tr&gt;\n             {{end}}\n       &lt;/tbody&gt;\n      .....\n</code></pre>\n\n<p>Can not load as a HTML page after template.Execute done</p>\n\n<p><a href=\"https://i.stack.imgur.com/ebPrg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ebPrg.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 2, "last_activity_date": 1470744930, "creation_date": 1470744930, "answer_id": 38850448, "question_id": 38847489, "link": "https://stackoverflow.com/questions/38847489/how-to-generate-a-pkcss12-file-given-private-key-and-certificate-in-golang/38850448#38850448", "title": "How to generate a PKCSs#12 file given private key and certificate in Golang?", "body": "<p>The package <a href=\"https://godoc.org/golang.org/x/crypto/pkcs12\" rel=\"nofollow\"><code>crypto/pkcs12</code></a> provides some basic functions for reading PKCS#12 files (it was imported from <a href=\"https://github.com/Azure/go-pkcs12\" rel=\"nofollow\"><code>Azure/go-pkcs12</code></a>, but there is currently no way to write them.</p>\n\n<p>The <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/oni2Fce6ELY\" rel=\"nofollow\">recommended solution</a>, for now, is use OpenSSL.</p>\n\n<pre><code>$ openssl pkcs12 -export -inkey private.key -in certificate.pem -certfile intermediates.crt -out certificate.pfx\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 1959016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4587465b2b1b94834e5e625b80a29dd?s=128&d=identicon&r=PG", "display_name": "Marcos Dione", "link": "https://stackoverflow.com/users/1959016/marcos-dione"}, "is_accepted": false, "score": 0, "last_activity_date": 1617271270, "creation_date": 1617271270, "answer_id": 66902451, "question_id": 38847489, "link": "https://stackoverflow.com/questions/38847489/how-to-generate-a-pkcss12-file-given-private-key-and-certificate-in-golang/66902451#66902451", "title": "How to generate a PKCSs#12 file given private key and certificate in Golang?", "body": "<p>There's also <a href=\"https://software.sslmate.com/src/go-pkcs12\" rel=\"nofollow noreferrer\">go-pkcs12</a> but it's not clear what should you do with the resulting <code>[]byte</code> (write them, I guess?), specially since you can't provide the alias. So I guess that as Simone says, we should stick to <code>openssl pkcs12</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6694938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/627edd1ef67300f4a4d4c899ae46a3c2?s=128&d=identicon&r=PG&f=1", "display_name": "shobana bhaskar", "link": "https://stackoverflow.com/users/6694938/shobana-bhaskar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1617271270, "creation_date": 1470736336, "last_edit_date": 1475653652, "question_id": 38847489, "link": "https://stackoverflow.com/questions/38847489/how-to-generate-a-pkcss12-file-given-private-key-and-certificate-in-golang", "title": "How to generate a PKCSs#12 file given private key and certificate in Golang?", "body": "<p>I have a base64 encoded private key and public certificate. My requirement is to create a keystore from it. From my analysis, there is no such API in Golang to create it. The other way is to generate a PKCSs#12 format file which is a keystore.</p>\n\n<p>Please let me know the solution if any.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1470744475, "post_id": 38846890, "comment_id": 65064866, "body": "This would be a <code>pre_put</code>, not a <code>post_put</code>."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1470745276, "post_id": 38846890, "comment_id": 65065444, "body": "In your <code>Save</code> interface method for your entity, you&#39;ll be calling <code>datastore.SaveStruct</code> function at some point. Whatever post put operation you need, it can go after this call, depending on it success status."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 1, "creation_date": 1470752543, "post_id": 38846890, "comment_id": 65070855, "body": "No, you don&#39;t necessary call the SaveStruct - see example at docs - <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#hdr-The_PropertyLoadSaver_Interface\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/datastore/&hellip;</a>.  And even if you do call it does not save to DB - just serialize to slice of properties.<a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#SaveStruct\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/datastore/&hellip;</a> So in no way it&#39;s an analogue of _post_put. To have a _post_put I guess you  you would need a wrapper over API and use it everywhere."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 1, "creation_date": 1470761820, "post_id": 38846890, "comment_id": 65077306, "body": "oh i see.. my bad. I didn&#39;t realize that&#39;s simply for custom serialization."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1470734805, "creation_date": 1470734805, "answer_id": 38846890, "question_id": 38845620, "link": "https://stackoverflow.com/questions/38845620/post-put-hook-in-go/38846890#38846890", "title": "_post_put_hook in Go", "body": "<p>App engine datastore operations take <code>PropertyLoadSaver</code> interface as an input. For example, <code>datastore.Put</code> has the following signature:</p>\n\n<pre><code>func Put(c context.Context, key *Key, src interface{}) (*Key, error)\n</code></pre>\n\n<p>With the following documentation about <code>src</code>:</p>\n\n<blockquote>\n  <p>Put saves the entity src into the datastore with key k. src must be a\n  struct pointer or implement PropertyLoadSaver</p>\n</blockquote>\n\n<p>This means that you can implement your own custom behavior around various datastore operations. An example can be found <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#hdr-The_PropertyLoadSaver_Interface\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 6586, "user_id": 256405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/420ecb69f4d50ee66160e01e4071be6e?s=128&d=identicon&r=PG", "display_name": "Morrowless", "link": "https://stackoverflow.com/users/256405/morrowless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470778117, "creation_date": 1470731216, "last_edit_date": 1470778117, "question_id": 38845620, "link": "https://stackoverflow.com/questions/38845620/post-put-hook-in-go", "title": "_post_put_hook in Go", "body": "<p>Python <code>ndb.Model</code> has a convenient <code>_post_put_hook</code> where you can perform some work after the entity is saved to the datastore.\nSince models in Go are just structs, how is this feature supported?</p>\n"}, {"tags": ["go", "interface", "naming-conventions", "naming"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1470723712, "post_id": 38842457, "comment_id": 65051881, "body": "I would just call it <code>RoleSupport</code> but reaching for English.SE would be an interesting endeavor indeed. Please consider not using <code>this</code> to name method receivers: this is frowned upon as being unidiomatic Go. <a href=\"http://stackoverflow.com/q/23482068/720999\">One example</a> of discussing these matters."}, {"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1470724063, "post_id": 38842457, "comment_id": 65052057, "body": "Yeah, I&#39;ve been struggling with receiver names.  I know the go idiom is to use single letter variables....I&#39;m sorry, I can&#39;t do that.  &quot;this&quot; or &quot;self&quot; are so prevalent in any other language it disambiguates meaning.  &quot;RoleSupport&quot; is ok, but doesn&#39;t really fit a neat pattern."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1470730180, "post_id": 38842457, "comment_id": 65055450, "body": "Not single letters but rather meaningful abbreviations -- with single letters being OK for short functions (yours included). &quot;Any other language&quot; is a gross exaggregation for sure. Well, for some reason this is not a problem for me: different languages just <i>feel</i> differently. Novice programmers indeed try hard to be one-trick dogs trying to carry their set of learned skills into any new language they face (been there myself for sure) but it&#39;s always better to understand the philosophy behind the language and stick to it."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1470730195, "post_id": 38842457, "comment_id": 65055455, "body": "At least this lowers the WTF factor for the next programmer dealing with your code. ;-)"}, {"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1470732832, "post_id": 38842457, "comment_id": 65057028, "body": "WTF factor, &quot;this&quot; or &quot;self&quot; is &quot;idiomatic&quot; in at least half a dozen languages I &quot;know&quot;"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1470733224, "post_id": 38842457, "comment_id": 65057282, "body": "@Dale It&#39;s not in Go, see: <a href=\"http://stackoverflow.com/questions/23482068/in-go-is-naming-the-receiver-variable-self-misleading-or-good-practise\">In Go is naming the receiver variable &#39;self&#39; misleading or good practise?</a>"}, {"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1470892296, "post_id": 38842457, "comment_id": 65135871, "body": "I&#39;ve refactored this project to not include this or self.  <a href=\"https://play.golang.org/p/hGDELp3OBA\" rel=\"nofollow noreferrer\">play.golang.org/p/hGDELp3OBA</a> is pretty cool.  IIRC the first thing pushed onto a stack in a function call in C++ is a reference to &quot;this&quot; followed by the function parameters.  &quot;this&quot; can be thought of as an implicit first parameter, I&#39;m glad to see this happening here.  This is not unlike python where they just removed the implicit part.  I&#39;m still not entirely convinced given what I know so far, but I&#39;m ignorant, so I&#39;ll go along."}], "answers": [{"comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1470722474, "post_id": 38843060, "comment_id": 65051320, "body": "IsRoler and AssumeRoler -&gt; IsserAssumer?  lol, this might be better in the english stack exchange...."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1485486091, "post_id": 38843060, "comment_id": 70955145, "body": "@Dale <a href=\"https://talks.golang.org/2014/names.slide#14\" rel=\"nofollow noreferrer\">talks.golang.org/2014/names.slide#14</a>  =&gt; Sometimes the result isn&#39;t correct English, but we do it anyway:"}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1532471256, "post_id": 38843060, "comment_id": 89985758, "body": "@SarathSadasivanPillai.. let me try to understand... if i bring into this context an struct (That is the data structure that is associated with a method), i would rather say  &quot;any struct implementing the method &#39;Read&#39; becomes a Reader&quot;, that has sense?; an let me add another quick question here: what would be the name for a struct that is used as source of read? &quot;Sourcer&quot;??, (I know that it would be &quot;Readable&quot; in Java!)"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1532565870, "post_id": 38843060, "comment_id": 90027195, "body": "@Victor interface name depends on the functions it implements"}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1532699186, "post_id": 38843060, "comment_id": 90085471, "body": "@SarathSadasivanPillai, i thing i get it. The think is that for some reason my OO based mind (after years in JAVA) still keep me saying that interfaces describes objects (of a same kind) behaviour, and interfaces in go describies object behaviour too. Both ways are for describing a methods (1 or many) with an object, we agree on that?. Guess in JAVA you are looking for a <i>word</i> describing what a client can DO with the object (things that the object can be &quot;tell&quot; to do), and in GOLANG the word is solely related to what the object can DO. That strive me to the question of Sourcer/Readable."}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 2, "last_activity_date": 1485485899, "last_edit_date": 1485485899, "creation_date": 1470722177, "answer_id": 38843060, "question_id": 38842457, "link": "https://stackoverflow.com/questions/38842457/interface-naming-convention-golang/38843060#38843060", "title": "Interface naming convention Golang", "body": "<p>In golang By convention, one-method interface names are\nnouns denoting the doer of an action. For example,</p>\n\n<pre><code>the `Read` method implements the `Reader` interface, and\nthe `Generate` method implements the `Generator` interface.\n</code></pre>\n\n<p>It would be best to make the specifics  of the convention clear,regardless of what they are.This goes good when there is only one function or a very specific set of functions are required by the interface</p>\n\n<p>There is a practise of using <code>I</code>  prefix to Lowest Common Denominator of the functions ,in this case <code>IRole</code> would be a better interface name as the interface defines two functions that has to be satiisfied by all the types representing <code>Role</code> </p>\n"}, {"tags": [], "owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "is_accepted": true, "score": 4, "last_activity_date": 1470723285, "creation_date": 1470723285, "answer_id": 38843355, "question_id": 38842457, "link": "https://stackoverflow.com/questions/38842457/interface-naming-convention-golang/38843355#38843355", "title": "Interface naming convention Golang", "body": "<p>I got it, turns out I can use the \"er\" convention.</p>\n\n<pre><code>/*\n*  Role will ALWAYS reserve the session key \"role\".\n */\npackage goserver\n\nconst (\n    ROLE_KEY string = \"role\"\n)\n\ntype Role string\n\n//if index is higher or equal than role, will pass\ntype RolesHierarchy []Role\n\ntype RoleChecker interface {\n    IsRole(Role, RolesHierarchy) bool\n}\n\ntype RoleAssumer interface {\n    AssumeRole(ServerSession, Role)\n}\n\ntype RoleCheckerAssumer interface {\n    RoleChecker\n    RoleAssumer\n}\n\nfunc (r Role) String() string {\n    return string(r)\n}\n\nfunc NewRole(session ServerSession) Role {\n    return session.GetValue(ROLE_KEY).(Role)\n}\n\nfunc (this Role) IsRole(role Role, hierarchy RolesHierarchy) bool {\n    if role == this {\n        return true\n    }\n    if len(hierarchy) == 0 {\n        return false\n    }\n    var thisI int = 0\n    var roleI int = 0\n    //Duped roles in hierarchy are verified in verifyConfig during parse\n    for i, r := range hierarchy {\n        if this == r {\n            thisI = i\n        }\n        if role == r {\n            roleI = i\n        }\n    }\n    //TODO I can probably condense what follows into one if\n    if thisI == 0 &amp;&amp; roleI == 0 {\n        return false\n    }\n    return thisI &gt;= roleI\n}\n\nfunc (this *Role) AssumeRole(session ServerSession, role Role) {\n   session.SetValue(ROLE_KEY, role)\n   *this = role\n}\n</code></pre>\n\n<p>Thank you Sarathsp for getting me thinking about this properly.</p>\n"}, {"comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 1, "creation_date": 1470732763, "post_id": 38845301, "comment_id": 65056982, "body": "Single method interfaces are &quot;easier&quot;.  The &quot;Is&lt;something&gt;()&quot; was throwing me off.  I ended up just using &quot;checker()&quot;.  Yeah, sorry, not going to use single or two letter identifiers.  I don&#39;t care what is idiomatic here.  I know half a dozen languages that use this or self, why would I break convention here simply because some doc in a language spec says I should?  This or self is exactly what I mean and what I want.  At the end of the day, I need to read my code, and if I&#39;m rummaging through my speghetti for some single letter identifier, what is the point?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 4, "creation_date": 1470733142, "post_id": 38845301, "comment_id": 65057221, "body": "@Dale You do whatever you want. No one will force you to do anything. And as long as you code &quot;alone&quot; it won&#39;t bother anyone else. But if you want to work with others, or others have to work with your code, you need to speak a &quot;common&quot; language. Regarding <code>this</code> and <code>self</code> as the method receiver: <a href=\"http://stackoverflow.com/questions/23482068/in-go-is-naming-the-receiver-variable-self-misleading-or-good-practise\">In Go is naming the receiver variable &#39;self&#39; misleading or good practise?</a>"}, {"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1470733485, "post_id": 38845301, "comment_id": 65057470, "body": "Thank you.  I don&#39;t want to be argumentative.  I do plan on open sourcing this heap. Perhaps feedback will force me to rethink my decision.  I&#39;m still not convinced of the designers&#39; decisions here.  That being said, just about everything else I&#39;ve seen in Go has been very impressive."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 40, "last_activity_date": 1470747151, "last_edit_date": 1470747151, "creation_date": 1470730000, "answer_id": 38845301, "question_id": 38842457, "link": "https://stackoverflow.com/questions/38842457/interface-naming-convention-golang/38845301#38845301", "title": "Interface naming convention Golang", "body": "<p>In your case I would just name them <code>RoleChecker</code> and <code>RoleAssumer</code>, the \"merged\" one <code>RoleCheckerAssumer</code>. Or if you'd go with a single interface, that could be <code>RoleHelper</code> or <code>RoleChecker</code>.</p>\n\n<p><code>ServerSession</code> is also fine, or even just <code>Session</code> (especially if there is no \"client\" session). <code>ServerSessioner</code> on the other hand is bad, <code>Session</code> is not a verb and not a method of the interface.</p>\n\n<hr>\n\n<p>There has been many posts about the conventions.</p>\n\n<p><a href=\"https://golang.org/doc/effective_go.html#interface-names\" rel=\"noreferrer\">Effective Go: Interface names:</a></p>\n\n<blockquote>\n  <p>By convention, one-method interfaces are named by the method name plus an -er suffix or similar modification to construct an agent noun: <code>Reader</code>, <code>Writer</code>, <code>Formatter</code>, <code>CloseNotifier</code> etc.</p>\n  \n  <p>There are a number of such names and it's productive to honor them and the function names they capture. <code>Read</code>, <code>Write</code>, <code>Close</code>, <code>Flush</code>, <code>String</code> and so on have canonical signatures and meanings. To avoid confusion, don't give your method one of those names unless it has the same signature and meaning. Conversely, if your type implements a method with the same meaning as a method on a well-known type, give it the same name and signature; call your string-converter method <code>String</code> not <code>ToString</code>.</p>\n</blockquote>\n\n<p><a href=\"https://talks.golang.org/2014/names.slide#14\" rel=\"noreferrer\">Interface Types @ What's in a name? - Talks at golang.org</a></p>\n\n<blockquote>\n  <p>Interfaces that specify just one method are usually just that function name with 'er' appended to it.</p>\n\n<pre><code>type Reader interface {\n    Read(p []byte) (n int, err error)\n}\n</code></pre>\n  \n  <p>Sometimes the result isn't correct English, but we do it anyway:</p>\n\n<pre><code>type Execer interface {\n    Exec(query string, args []Value) (Result, error)\n}\n</code></pre>\n  \n  <p>Sometimes we use English to make it nicer:</p>\n\n<pre><code>type ByteReader interface {\n    ReadByte() (c byte, err error)\n}\n</code></pre>\n  \n  <p>When an interface includes multiple methods, choose a name that accurately describes its purpose (examples: net.Conn, http.ResponseWriter, io.ReadWriter).</p>\n</blockquote>\n\n<p>For receiver names, don't use <code>this</code> or <code>self</code> or similar ones. Instead:</p>\n\n<p><a href=\"https://talks.golang.org/2014/names.slide#12\" rel=\"noreferrer\">Receivers @ What's in a name? - Talks at golang.org</a></p>\n\n<blockquote>\n  <p>Receivers are a special kind of argument.</p>\n  \n  <p>By convention, they are one or two characters that reflect the receiver type, \n  because they typically appear on almost every line:</p>\n\n<pre><code>func (b *Buffer) Read(p []byte) (n int, err error)\n\nfunc (sh serverHandler) ServeHTTP(rw ResponseWriter, req *Request)\n\nfunc (r Rectangle) Size() Point\n</code></pre>\n  \n  <p>Receiver names should be consistent across a type's methods. \n  (Don't use r in one method and rdr in another.)</p>\n</blockquote>\n\n<p><a href=\"https://github.com/golang/go/wiki/CodeReviewComments#receiver-names\" rel=\"noreferrer\">Go Code Review Comments: Receiver Names:</a></p>\n\n<blockquote>\n  <p>The name of a method's receiver should be a reflection of its identity; often a one or two letter abbreviation of its type suffices (such as \"c\" or \"cl\" for \"Client\"). Don't use generic names such as \"me\", \"this\" or \"self\", identifiers typical of object-oriented languages that place more emphasis on methods as opposed to functions. The name need not be as descriptive as that of a method argument, as its role is obvious and serves no documentary purpose. It can be very short as it will appear on almost every line of every method of the type; familiarity admits brevity. Be consistent, too: if you call the receiver \"c\" in one method, don't call it \"cl\" in another.</p>\n</blockquote>\n"}], "owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29865, "favorite_count": 5, "accepted_answer_id": 38843355, "answer_count": 3, "score": 25, "last_activity_date": 1527071625, "creation_date": 1470719115, "last_edit_date": 1527071625, "question_id": 38842457, "link": "https://stackoverflow.com/questions/38842457/interface-naming-convention-golang", "title": "Interface naming convention Golang", "body": "<p>I'll just post my code:</p>\n\n<pre><code>/*\n*  Role will ALWAYS reserve the session key \"role\".\n */\npackage goserver\n\nconst (\n    ROLE_KEY string = \"role\"\n)\n\ntype Role string\n\n//if index is higher or equal than role, will pass\ntype RolesHierarchy []Role\n\nfunc (r Role) String() string {\n    return string(r)\n}\n\nfunc NewRole(session ServerSession) Role {\n    return session.GetValue(ROLE_KEY).(Role)\n}\n\nfunc (this Role) IsRole(role Role, hierarchy RolesHierarchy) bool {\n    if role == this {\n        return true\n    }\n    if len(hierarchy) == 0 {\n        return false\n    }\n    var thisI int = 0\n    var roleI int = 0\n    //Duped roles in hierarchy are verified in verifyConfig during parse\n    for i, r := range hierarchy {\n        if this == r {\n            thisI = i\n        }\n        if role == r {\n            roleI = i\n        }\n    }\n    //TODO I can probably condense what follows into one if\n    if thisI == 0 &amp;&amp; roleI == 0 {\n        return false\n    }\n    return thisI &gt;= roleI\n}\n\nfunc (this *Role) AssumeRole(session ServerSession, role Role) {\n    session.SetValue(ROLE_KEY, role)\n    *this = role\n}\n</code></pre>\n\n<p>It should be noted that ServerSession is also an interface, calling \"ServerSessioner\" just feels wonky to me.</p>\n\n<p>I'm toying with the idea of creating an interface with IsRole() and AssumeRole(), however \"Roler\" seems very wonky.  It's dawning on me that I don't really know or have ever come across naming conventions for interfaces, other than the standard \"er\" suffix.  I do seem to recall the VS C++ convention is to just throw an \"I\" in front of everything.  Is this \"idiomatic\"?</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["windows", "file", "go", "operating-system"], "comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1470725978, "post_id": 38840415, "comment_id": 65053047, "body": "What does it return?  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa446629%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>  I suspect your answer lurks in there.  It&#39;s probably a DWORD, which is a &quot;double word&quot; or a byte or a uint in go."}, {"owner": {"reputation": 11, "user_id": 6606332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3f7f6d7006721a6a1c1f768b166948e?s=128&d=identicon&r=PG&f=1", "display_name": "askretov", "link": "https://stackoverflow.com/users/6606332/askretov"}, "reply_to_user": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1470817192, "post_id": 38840415, "comment_id": 65098318, "body": "But how it could help me in Go ?"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1470760433, "creation_date": 1470760433, "answer_id": 38856143, "question_id": 38840415, "link": "https://stackoverflow.com/questions/38840415/go-golang-file-uid-on-windows/38856143#38856143", "title": "Go (golang), file uid on windows", "body": "<p>The first problem is that file systems native to Windows which supports file/directory ownership do not have the concept of \"owner UID\" simply because Windows users have no UIDs either.</p>\n\n<p>The security of the Windows NT line or kernels is implemented using the so-called \"access control lists\" (ACLs), and security principals (such as users) are identified using the so-called \"security identifiers\" (SIDs).  A <a href=\"https://msdn.microsoft.com/en-us/library/cc230371.aspx\" rel=\"nofollow\">SID is a variable-length multi-field data structure</a> usually passed around as a byte array.</p>\n\n<p>Another complication is that a file on an ACL-enabled Windows file system might have no owner at all (and no ACL attached to it as well); this is rare but possible.</p>\n\n<p>So... If the part of explanation stating \"there's no such thing as the entry owner's UID on Windows filesystem\" is OK for you, this is all there is to it.</p>\n\n<p>If not, and you actually wanted to ask \"how do I get security information for an entry on a Windows filesystem?\", the question gets more complicated.\nAFAIK the stock standard library shipped with Go does not have the necessary wrappers around the relevant bits of the Win32 API.  So to implement this, you'll need to either wrap them yourself (it's not that hard, after all) or try to find a helper package.</p>\n"}], "owner": {"reputation": 11, "user_id": 6606332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3f7f6d7006721a6a1c1f768b166948e?s=128&d=identicon&r=PG&f=1", "display_name": "askretov", "link": "https://stackoverflow.com/users/6606332/askretov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470760433, "creation_date": 1470703384, "last_edit_date": 1470707988, "question_id": 38840415, "link": "https://stackoverflow.com/questions/38840415/go-golang-file-uid-on-windows", "title": "Go (golang), file uid on windows", "body": "<p>Is it possible to get a file's UID (owner) on Windows? I tried to use <code>FileInfo.Sys()</code>, but it only works on Linux. I'm really stumped on this one and can't figure out how to get the UID.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1470693512, "post_id": 38839094, "comment_id": 65043923, "body": "Of course you can do this in Go, because Go is a general-purpose programming language.  The real question is whether it is possible to do so in the HTTP library you have chosen to use.  So what HTTP library are you using?  Can you provide a link to its documentation?  Have you tried looking at the <code>Host</code> HTTP header in the request?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470693604, "post_id": 38839094, "comment_id": 65043969, "body": "The <code>www</code> subdomain isn&#39;t part of the path, it will be part of the host field. Please show an example of what you&#39;re seeing, since it should be present in the <code>Request.Host</code> or <code>Request.URL</code>."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1470694036, "creation_date": 1470694036, "answer_id": 38839236, "question_id": 38839094, "link": "https://stackoverflow.com/questions/38839094/is-there-no-way-to-redirect-from-https-www-to-https-in-go/38839236#38839236", "title": "Is there no way to redirect from https://www.. to https://.. in Go?", "body": "<p>Wrap your handlers with a redirector:</p>\n\n<pre><code>func wwwRedirect(h http.Handler) http.Handler {\n  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    if host := strings.TrimPrefix(r.Host, \"www.\"); host != r.Host {\n        // Request host has www. prefix. Redirect to host with www. trimmed.\n        u := *r.URL\n        u.Host = host\n        u.Scheme = \"https\"\n        http.Redirect(w, r, u.String(), http.StatusFound)\n        return\n    }\n    h.ServeHTTP(w, r)\n  })\n}\n</code></pre>\n\n<p>Use the redirector like this:</p>\n\n<pre><code>log.Fatal(http.ListenAndServeTLS(addr, certFile, keyFile, wwwRedirect(handler))\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 1, "accepted_answer_id": 38839236, "answer_count": 1, "score": 1, "last_activity_date": 1470694036, "creation_date": 1470693255, "last_edit_date": 1495542786, "question_id": 38839094, "link": "https://stackoverflow.com/questions/38839094/is-there-no-way-to-redirect-from-https-www-to-https-in-go", "title": "Is there no way to redirect from https://www.. to https://.. in Go?", "body": "<p>I saw this post by someone here but there are no answers: <a href=\"https://stackoverflow.com/questions/38700883/redirecting-https-www-domain-com-to-https-domain-com-in-go\">Redirecting https://www.domain.com to https://domain.com in Go</a></p>\n\n<p>I tried to see if I could find a way to check if the request was made with a www url by checking the variables in <code>*http.Request</code> variable but all I got was relative paths and empty strings <code>\"\"</code>.</p>\n\n<p>I tried to <code>fmt.Println()</code> these variables:</p>\n\n<pre><code>func handleFunc(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(r.URL.string())\n    fmt.Println(r.Host)\n    fmt.Println(r.RequestURI)\n}\n</code></pre>\n\n<p>But none of these variables contained the absolute path with the www part. How can I check if a request was made from a www url? I want to figure this out so that I can redirect from www to non-www.</p>\n\n<p>Is this really not even possible in Go? Some people suggested putting nginx in front of Go, but there has to be a way without nginx right? Do I really need to install and use nginx in front of Go just to do a simple redirect from www to non-www? This does not seem like a good solution to a seemingly small problem.</p>\n\n<p>Is there no way to achieve this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "edited": false, "score": 0, "creation_date": 1470760689, "post_id": 38840317, "comment_id": 65076652, "body": "that makes sense. But how do I access the Verbose or Terse flags in the ListCommand?  ListCommand&#39;s Execute function gets run <code>func (c *ListCommand) Execute(args []string) error</code> and the ListCommand does not have access to Verbose or Terse right?"}, {"owner": {"reputation": 174, "user_id": 2510038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ae9975ea868e41ea6aea30e5d85dad?s=128&d=identicon&r=PG", "display_name": "Kel Cecil", "link": "https://stackoverflow.com/users/2510038/kel-cecil"}, "reply_to_user": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "edited": false, "score": 0, "creation_date": 1470761746, "post_id": 38840317, "comment_id": 65077266, "body": "That&#39;s correct. Verbose and terse in my example would be accessible through <code>defaultOptions</code> in my example above. You can make that global to be able to access those options across your program."}, {"owner": {"reputation": 174, "user_id": 2510038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ae9975ea868e41ea6aea30e5d85dad?s=128&d=identicon&r=PG", "display_name": "Kel Cecil", "link": "https://stackoverflow.com/users/2510038/kel-cecil"}, "reply_to_user": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "edited": false, "score": 0, "creation_date": 1470761882, "post_id": 38840317, "comment_id": 65077328, "body": "I&#39;m going to edit my answer with another possibility that achieves what you&#39;re trying to achieve. One moment please."}], "tags": [], "owner": {"reputation": 174, "user_id": 2510038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ae9975ea868e41ea6aea30e5d85dad?s=128&d=identicon&r=PG", "display_name": "Kel Cecil", "link": "https://stackoverflow.com/users/2510038/kel-cecil"}, "is_accepted": true, "score": 4, "last_activity_date": 1470762231, "last_edit_date": 1470762231, "creation_date": 1470702284, "answer_id": 38840317, "question_id": 38833711, "link": "https://stackoverflow.com/questions/38833711/global-parameters-to-commands-using-go-flags/38840317#38840317", "title": "Global parameters to commands using go-flags", "body": "<p>You can use <a href=\"https://godoc.org/github.com/jessevdk/go-flags#NewParser\" rel=\"nofollow\">NewParser</a> to create a new parser. You'll notice from the documentation that the first argument is a pointer to a struct that will be \"Application Options.\" I'll start with an explanation and follow with a working example. Pretend you have the following struct that contains your application wide options:</p>\n\n<pre><code>type Defaults struct {\n    Verbose []bool `short:\"v\" long:\"verbose\" description:\"Show verbose debug information\"`\n    Terse   bool   `short:\"t\" long:\"terse\" description:\"Shows terse output\"`\n}\n</code></pre>\n\n<p>You can pass this into the NewParser function as mentioned before like so:</p>\n\n<pre><code>defaultOptions = Defaults{}\nparser = flags.NewParser(&amp;defaultOptions, flags.Default)\n</code></pre>\n\n<p>Your additional commands can be added with the parser.AddCommand function. For example:</p>\n\n<pre><code>list := ListCommand{}\nparser.AddCommand(\"list\", \"lists something\", \"\", &amp;list)\n</code></pre>\n\n<p>Finish up by calling parser. Parse and enjoy!</p>\n\n<pre><code>parser.Parse()\nfmt.Printf(\"Verbose: %v\\n\", defaultOptions.Verbose)\nfmt.Printf(\"Terse: %v\\n\", defaultOptions.Terse)\n</code></pre>\n\n<p>Here's a small fully-working example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    flags \"github.com/jessevdk/go-flags\"\n)\n\ntype Defaults struct {\n    Verbose []bool `short:\"v\" long:\"verbose\" description:\"Show verbose    debug information\"`\n    Terse   bool   `short:\"t\" long:\"terse\" description:\"Shows terse output\"`\n}\n\ntype ListCommand struct {\n    Config string `short:\"c\" long:\"config\" description:\"config file\" optional:\"yes\"`\n}\n\nfunc main() {\n    defaultOptions := Defaults{}\n    listCmd := ListCommand{}\n\n    parser := flags.NewParser(&amp;defaultOptions, flags.Default)\n    parser.AddCommand(\"list\", \"lists something\", \"\", &amp;listCmd)\n\n    parser.Parse()\n}\n</code></pre>\n\n<p>You can also achieve exactly what you're asking for by including the Defaults struct as an anonymous struct in your Command structs. Notice how I am referencing the Defaults type in my ListCommand struct but am not providing a name for the field. This allows me to access the fields of Defaults as if they were part of the ListCommand struct. The following example code allows me to provide the Verbose and Terse flags when using <code>&lt;prog&gt; list -h</code>:</p>\n\n<pre><code>package main\n\nimport flags \"github.com/jessevdk/go-flags\"\n\ntype Defaults struct {\n    Verbose []bool `short:\"v\" long:\"verbose\" description:\"Show verbose    debug information\"`\n    Terse   bool   `short:\"t\" long:\"terse\" description:\"Shows terse output\"`\n}\n\ntype ListCommand struct {\n    Config string `short:\"c\" long:\"config\" description:\"config file\" optional:\"yes\"`\n    Defaults\n}\n\nfunc main() {\n    listCmd := ListCommand{}\n\n    parser := flags.NewParser(nil, flags.Default)\n    parser.AddCommand(\"list\", \"lists something\", \"\", &amp;listCmd)\n\n    parser.Parse()\n}\n</code></pre>\n"}], "owner": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "accepted_answer_id": 38840317, "answer_count": 1, "score": 2, "last_activity_date": 1602924010, "creation_date": 1470671877, "last_edit_date": 1602924010, "question_id": 38833711, "link": "https://stackoverflow.com/questions/38833711/global-parameters-to-commands-using-go-flags", "title": "Global parameters to commands using go-flags", "body": "<p>I'm using this library <a href=\"https://github.com/jessevdk/go-flags\" rel=\"nofollow noreferrer\">https://github.com/jessevdk/go-flags</a></p>\n<p>A command for my app might be like:</p>\n<p><code>ex list events</code></p>\n<p>So I have my wrapper command</p>\n<pre><code>type ExCommand struct {\n    List list.ListCommand `command:&quot;list&quot; description:&quot;list events&quot; subcommands-optional:&quot;true&quot;`\n}\n</code></pre>\n<p>List command</p>\n<pre><code>type ListCommand struct {\n    ExCommand ExCommand `command:&quot;events&quot; description:&quot;list events&quot;`\n\n    Config string `short:&quot;c&quot; long:&quot;config&quot; description:&quot;config file&quot; optional:&quot;yes&quot;`\n}\n</code></pre>\n<p>Ex command</p>\n<pre><code>type EventsCommand struct {\n}\n\n\nfunc (c *ListCommand) Execute(args []string) error {\n    fmt.Println(&quot;execute list&quot;)\n    for _, val := range args {\n        fmt.Println(val)\n    }\n    fmt.Printf(&quot;c: %s\\n&quot;, c.Config)\n\n    return nil\n}\n\nfunc (c *ExCommand) Execute(args []string) error {\n    fmt.Println(&quot;list events&quot;)\n    for _, val := range args {\n        fmt.Println(val)\n    }\n\n    return nil\n}\n</code></pre>\n<p>So what I'd like to do, is to have a few options like</p>\n<pre><code>verbose\nconfig\nterse\n</code></pre>\n<p>that are global options that can be run on any commands.  I can't seem to figure out if there's a way to do this though with this library.  Does anyone have experience with that?  I can add <code>Config</code> to each individual low level command, list in this case the EventsCommand, but it seems like I'm repeating myself by adding at each low level command instead of the higher up ListCommand or ExCommand.</p>\n"}, {"tags": ["arrays", "go", "parallel-processing", "channel"], "comments": [{"owner": {"reputation": 22367, "user_id": 1057909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a3df0a806e7301ce9b92d0705646ac?s=128&d=identicon&r=PG", "display_name": "ams", "link": "https://stackoverflow.com/users/1057909/ams"}, "edited": false, "score": 0, "creation_date": 1470669025, "post_id": 38832493, "comment_id": 65030856, "body": "You put 10 things into a channel in an undefined order, so I&#39;m not sure what you expected to happen here?"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1470680392, "last_edit_date": 1470680392, "creation_date": 1470669097, "answer_id": 38832791, "question_id": 38832493, "link": "https://stackoverflow.com/questions/38832493/goroutines-sharing-an-array-channel-trying-to-solve-data-race/38832791#38832791", "title": "Goroutines sharing an array channel : trying to solve data race", "body": "<p>There's two pieces to this fix, don't share the slices between goroutines, and then range over <code>queue</code> synchronously in <code>main</code>.</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"strconv\"\n    \"sync\"\n)\n\nfunc cat_strings(a int, b string) []string {\n    var y []string\n\n    j := strconv.Itoa(a)\n    y = append(y, j)\n    y = append(y, b)\n    return y\n}\n\nfunc main() {\n    var slice []string\n    var wg sync.WaitGroup\n\n    queue := make(chan []string, 10)\n\n    wg.Add(10)\n    for i := 0; i &lt; 10; i++ {\n        go func(i int) {\n            defer wg.Done()\n            queue &lt;- cat_strings(i, \"var\")\n        }(i)\n\n    }\n\n    go func() {\n        wg.Wait()\n        close(queue)\n    }()\n\n    for t := range queue {\n        slice = append(slice, t...)\n    }\n\n    fmt.Println(slice)\n}\n</code></pre>\n\n<p>There's no reason for the extra <code>x</code> slice you're sharing between goroutines. If each goroutine needs another slice, define a new one for each. Sharing a single slice is always going to require extra synchronization.</p>\n\n<p>The other race is between the goruoutine appending from <code>queue</code> to the <code>slice</code> slice, and the final <code>fmt.Println</code>. There's no reason for those be concurrent since you don't want to print until all values have been read, so finish the for-range loop entirely before printing the final value.</p>\n"}], "owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 1, "accepted_answer_id": 38832791, "answer_count": 1, "score": 0, "last_activity_date": 1470750749, "creation_date": 1470668303, "question_id": 38832493, "link": "https://stackoverflow.com/questions/38832493/goroutines-sharing-an-array-channel-trying-to-solve-data-race", "title": "Goroutines sharing an array channel : trying to solve data race", "body": "<p>I try to write a complex program with parallel goroutines. It is my first program with channels ;)  Each goroutine returns an array and, unfortunately, the result is \"random\". If I run 10 times the program, I have 10 different results :(</p>\n\n<p>This is an over simplification of my program, the results is good (maybe because it is too simple) but when I run it with -race argument, there is 4 data races.</p>\n\n<p>I tried to had a close() function but it did not worked.</p>\n\n<p>May you help me to find the mistake ? Thank you very much in advance !</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"sync\"\nimport \"strconv\"\n\n\nfunc cat_strings(a int, b string) []string{\n    var y []string\n\n    j := strconv.Itoa(a)\n    y = append(y, j)\n    y = append(y, b)\n    return y\n}\n\nfunc main() {\n    var slice []string\n    var wg sync.WaitGroup\n    var x []string\n\n    queue := make(chan []string, 10)\n\n    wg.Add(10)\n    for i := 0; i &lt; 10; i++ {\n        go func(i int) {\n            defer wg.Done()\n            x = cat_strings(i, \"var\")\n            queue &lt;- x\n        }(i)\n\n    }\n    //close(queue)\n\n    go func() {\n        defer wg.Done()\n        for t := range queue {\n            slice = append(slice, t...)\n        }\n    }()\n\n    wg.Wait()\n    fmt.Println(slice)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1470667189, "creation_date": 1470667189, "answer_id": 38832115, "question_id": 38831816, "link": "https://stackoverflow.com/questions/38831816/disable-logging-for-3rd-party-library/38832115#38832115", "title": "Disable logging for 3rd party library", "body": "<p>That package defines it's own logger, doesn't export it, and provides no hooks to modify the output. You won't be able to change the log destination without modifying the package code. </p>\n\n<p>Another option in this case is that since the logger writes to <code>os.Stderr</code>, you could redefine <code>os.Stderr</code> as your own <code>io.Writer</code> to intercept and filter the log output there. That may be as simple as buffering up all stderr output, and only printing it out in the case of an error. </p>\n"}], "owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 38832115, "answer_count": 1, "score": 0, "last_activity_date": 1470667189, "creation_date": 1470666363, "last_edit_date": 1495541686, "question_id": 38831816, "link": "https://stackoverflow.com/questions/38831816/disable-logging-for-3rd-party-library", "title": "Disable logging for 3rd party library", "body": "<p>I am using a third party library in one of my tools that uses the standard logging from golang. The library is <a href=\"https://github.com/jason0x43/go-toggl\" rel=\"nofollow noreferrer\">https://github.com/jason0x43/go-toggl</a></p>\n\n<p>Now I wrote a command line utility that instruments toggl and I do not want to have the logging written there. I found <a href=\"https://stackoverflow.com/questions/10571182/go-disable-a-log-logger\">Go: Disable a log.Logger?</a> but this deals with disabling within the own code. How can I disable logging in a library?</p>\n"}, {"tags": ["json", "pointers", "go", "interface", "unmarshalling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1470663772, "post_id": 38829941, "comment_id": 65026989, "body": "A good rule of thumb is to never use a pointer to an interface. There&#39;s almost never a need for one."}], "answers": [{"comments": [{"owner": {"reputation": 6754, "user_id": 1353139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5G7DC.png?s=128&g=1", "display_name": "vitaminwater", "link": "https://stackoverflow.com/users/1353139/vitaminwater"}, "edited": false, "score": 0, "creation_date": 1470726414, "post_id": 38830638, "comment_id": 65053288, "body": "Thanks @icza for the good read, this will surely be useful to a bunch of us."}, {"owner": {"reputation": 6754, "user_id": 1353139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5G7DC.png?s=128&g=1", "display_name": "vitaminwater", "link": "https://stackoverflow.com/users/1353139/vitaminwater"}, "edited": false, "score": 1, "creation_date": 1470727962, "post_id": 38830638, "comment_id": 65054239, "body": "Just went through the docs you pointed to, and especially the passage aboute settability, I guess that&#39;s what prevents Unmarshal to use the value in the interface{} when given a non-pointer."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6754, "user_id": 1353139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5G7DC.png?s=128&g=1", "display_name": "vitaminwater", "link": "https://stackoverflow.com/users/1353139/vitaminwater"}, "edited": false, "score": 1, "creation_date": 1470728146, "post_id": 38830638, "comment_id": 65054348, "body": "@vitaminwater Yes. The value in the interface is a copy. If you want the <code>json</code> package to unmarshal into a variable you pass, you have to pass its address - a pointer (which will also be passed as a value), but the <code>json</code> package will not modify the pointer but the <i>pointed</i> value - which is your variable."}, {"owner": {"reputation": 6754, "user_id": 1353139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5G7DC.png?s=128&g=1", "display_name": "vitaminwater", "link": "https://stackoverflow.com/users/1353139/vitaminwater"}, "edited": false, "score": 0, "creation_date": 1470728400, "post_id": 38830638, "comment_id": 65054471, "body": "For anyone seeking full explanations: <a href=\"https://blog.golang.org/laws-of-reflection#TOC_9\" rel=\"nofollow noreferrer\">blog.golang.org/laws-of-reflection#TOC_9</a>. thanks @icza"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1470667661, "last_edit_date": 1470667661, "creation_date": 1470663270, "answer_id": 38830638, "question_id": 38829941, "link": "https://stackoverflow.com/questions/38829941/golang-interface-type-misunderstanding/38830638#38830638", "title": "Golang interface{} type misunderstanding", "body": "<h3>The right scenario</h3>\n\n<p><code>interface{}</code> is a wrapper for any value and of any type. An interface schematically wraps a <code>(value; type)</code> pair, a concrete value and its type. More details on this: <a href=\"http://blog.golang.org/laws-of-reflection#TOC_3.\" rel=\"nofollow\">The Laws of Reflection #The representation of an interface</a>.</p>\n\n<p><a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\"><code>json.Unmarshal()</code></a> already takes the value of type <code>interface{}</code>:</p>\n\n<pre><code>func Unmarshal(data []byte, v interface{}) error\n</code></pre>\n\n<p>So if you already have an <code>interface{}</code> value (the <code>i interface{}</code> parameter of the <code>test()</code> function), don't try to take its address, just pass it along as-is.</p>\n\n<p>Also note that for any package to modify a value stored in an <code>interface{}</code>, you need to pass a pointer to it. So what should be in <code>i</code> is a pointer. So the right scenario is to pass <code>*Test</code> to <code>test()</code>, and inside <code>test()</code> pass <code>i</code> to <code>json.Unmarshal()</code> (without taking its address).</p>\n\n<h3>Explanation of other scenarios</h3>\n\n<p>When <code>i</code> contains <code>*Test</code> and you pass <code>&amp;i</code>, it will work because the <code>json</code> package will simply dereference the <code>*interface{}</code> pointer, and finds an <code>interface{}</code> value, which wraps a <code>*Test</code> value. It's a pointer, so it's all good: unmarshals the JSON object into the pointed <code>Test</code> value.</p>\n\n<p>When <code>i</code> contains <code>Test</code> and you pass <code>&amp;i</code>, same thing goes as above: <code>*interface{}</code> is dereferenced, so it finds an <code>interface{}</code> which contains a non-pointer: <code>Test</code>. Since the <code>json</code> package can't unmarshal into a non-pointer value, it has to create a new value. And since the passed value to the <code>json.Unmarshal()</code> function is of type <code>*interface{}</code>, it tells the <code>json</code> package to unmarshal the data into a value of type <code>interface{}</code>. This means the <code>json</code> package is free to choose which type to use. And by default the <code>json</code> package unmarshals JSON objects into <code>map[string]interface{}</code> values, so that is what's created and used (and eventually put into the value pointed by the pointer you passed: <code>&amp;i</code>).</p>\n\n<h3>All in all</h3>\n\n<p>All in all, avoid using pointers to interfaces. Instead \"put\" pointers into the interfaces (the interface value should wrap the pointer). When you already have an <code>interface{}</code> holding a pointer, just pass it along.</p>\n"}], "owner": {"reputation": 6754, "user_id": 1353139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5G7DC.png?s=128&g=1", "display_name": "vitaminwater", "link": "https://stackoverflow.com/users/1353139/vitaminwater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 1, "accepted_answer_id": 38830638, "answer_count": 1, "score": 4, "last_activity_date": 1470672587, "creation_date": 1470661346, "last_edit_date": 1470672587, "question_id": 38829941, "link": "https://stackoverflow.com/questions/38829941/golang-interface-type-misunderstanding", "title": "Golang interface{} type misunderstanding", "body": "<p>I got a bug in Go when using an <code>interface{}</code> as function parameter type, when given a non-pointer type, and using <code>json.Unmarshal</code> with it.</p>\n\n<p>Because a piece of code is worth a thousand words, here is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc test(i interface{}) {\n    j := []byte(`{ \"foo\": \"bar\" }`)\n    fmt.Printf(\"%T\\n\", i)\n    fmt.Printf(\"%T\\n\", &amp;i)\n    json.Unmarshal(j, &amp;i)\n    fmt.Printf(\"%T\\n\", i)\n}\n\ntype Test struct {\n    Foo string\n}\n\nfunc main() {\n    test(Test{})\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>main.Test\n*interface {}\nmap[string]interface {}\n</code></pre>\n\n<p><code>json.Unmarshal</code> turns my struct to a <code>map[string]interface{}</code> oO...</p>\n\n<p>Little readings later explains some of it, <code>interface{}</code> is a type in itself, not some sort of typeless container, which explains the <code>*interface{}</code>, and the fact that <code>json.Unmarshal</code> could not get the initial type, and returned a <code>map[string]interface{}</code>..</p>\n\n<p>From <code>Unmarshal</code> docs:</p>\n\n<blockquote>\n  <p>To unmarshal JSON into an interface value, Unmarshal stores one of\n  these in the interface value:\n  [...]</p>\n</blockquote>\n\n<p>And if I pass a pointer to the test function like so, it works:</p>\n\n<pre><code>func test(i interface{}) {\n    j := []byte(`{ \"foo\": \"bar\" }`)\n    fmt.Printf(\"%T\\n\", i)\n    fmt.Printf(\"%T\\n\", &amp;i)\n    json.Unmarshal(j, i)\n    fmt.Printf(\"%T\\n\", i)\n    fmt.Println(i)\n}\n\nfunc main() {\n    test(&amp;Test{})\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>*main.Test\n*interface {}\n*main.Test\n&amp;{bar}\n</code></pre>\n\n<p>Cool, the data is unmarshalled and all, now in this second snippet I removed the <code>&amp;</code> when calling <code>Unmarshal</code>. Because I have a <code>*Test</code> in <code>i</code>, no use for it.</p>\n\n<p>So in all logic, if I put back the <code>&amp;</code> to <code>i</code> when calling <code>Unmarshal</code> it should mess up with <code>i</code>'s type again. But no.</p>\n\n<p>If I run:</p>\n\n<pre><code>func test(i interface{}) {\n    j := []byte(`{ \"foo\": \"bar\" }`)\n    fmt.Printf(\"%T\\n\", i)\n    fmt.Printf(\"%T\\n\", &amp;i)\n    json.Unmarshal(j, &amp;i)\n    fmt.Printf(\"%T\\n\", i)\n    fmt.Println(i)\n}\n\nfunc main() {\n    test(&amp;Test{})\n}\n</code></pre>\n\n<p>Well it still works:</p>\n\n<pre><code>*main.Test\n*interface {}\n*main.Test\n&amp;{bar}\n</code></pre>\n\n<p>And now I'm out of google search queries.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470660352, "post_id": 38829469, "comment_id": 65024650, "body": "It is because of <b>eventual consistency</b>. See possible duplicates: 1. <a href=\"http://stackoverflow.com/questions/29228712/how-to-filter-a-gae-query\">How to filter a GAE query?</a>; 2. <a href=\"http://stackoverflow.com/questions/28590519/google-app-engine-datastore-testing-queries-fails\">Google App Engine Datastore - Testing Queries fails</a>; 3. <a href=\"http://stackoverflow.com/questions/29529296/why-the-query-doesnt-return-results-when-the-ancestor-is-not-provided\">Why the query doesn&#39;t return results when the ancestor is not provided?</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470661458, "post_id": 38829469, "comment_id": 65025367, "body": "Please confirm if this solves your issue."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470661553, "post_id": 38829469, "comment_id": 65025419, "body": "@icza It doesn&#39;t. The record previously existed (read: prior to the current development-server being started). It was not just created."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470700146, "post_id": 38829469, "comment_id": 65045825, "body": "Are you sure you have an exact <code>UserAccount</code> entity with <code>&quot;email&quot;</code> property having <code>&quot;test@example.com&quot;</code>? Please check my answer at this possible duplicate, and confirm if all tests pass: <a href=\"http://stackoverflow.com/questions/29133079/how-do-i-query-an-appengine-datastore-with-an-email-address\">How do I query an appengine datastore with an email address</a>"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470701660, "post_id": 38829469, "comment_id": 65046126, "body": "@icza Several good points, but none apply. I verified with a different record having a different value. This is ridiculous."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470701831, "post_id": 38829469, "comment_id": 65046157, "body": "Please insert a <code>UserAccount</code> with <code>email=&quot;anothertest@a.b&quot;</code>. Then insert a 1 second sleep, then please query by this email. Can you get the entity this way?"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470702590, "post_id": 38829469, "comment_id": 65046312, "body": "@icza Same as before. NewQuery-&gt;GetAll() returns it but a NewQuery-&gt;Filter-&gt;Run won&#39;t."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470702727, "post_id": 38829469, "comment_id": 65046336, "body": "Please post your <code>UserAccount</code> type definition. Also please try the same with another type, e.g. <code>type Temp struct { Email string }</code>. Is your <code>UserAccount.email</code> unexported?"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470708967, "post_id": 38829469, "comment_id": 65047672, "body": "@icza It&#39;s exported. I could write it after all (it shows up in the Viewer). I created a new model and added that along with the code to the original post above."}], "answers": [{"comments": [{"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470662228, "post_id": 38830027, "comment_id": 65025904, "body": "It&#39;s not clear how to tag properties for indexing or if it&#39;s even supported. The documentation only mentions tagging in the context of <i>preventing</i> an index: (<a href=\"https://cloud.google.com/appengine/docs/go/datastore/indexes\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/datastore/indexes</a>) &quot;Age  int <code>datastore:&quot;,noindex&quot;</code>&quot;"}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470664219, "post_id": 38830027, "comment_id": 65027329, "body": "Indeed, go seems different than python in this regard. The answer still applies - you could have had indexing disabled when the entity was created :)"}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470671714, "post_id": 38830027, "comment_id": 65032578, "body": "@DustinOprea: You can see if a property is indexed in your Cloud Console Datastore viewer. Find an entity and click on the edit icon - it will show all properties."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470672148, "post_id": 38830027, "comment_id": 65032846, "body": "@AndreiVolgin I&#39;ve never done a search on that column, but my understanding is that simple indices are implicitly created. However, that doesn&#39;t appear to be the case. I tried creating an <i>index.yaml</i> with some syntax errors to test whether or not it&#39;d be loaded (if there were errors on startup then obviously there was an <i>attempt</i> to load it) and I could effectively add an explicit one there. However, the development environment seemed to completely ignore it on startup. Any ideas?"}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470672731, "post_id": 38830027, "comment_id": 65033192, "body": "@DustinOprea I suspect the devserver only reads the <code>index.yaml</code> file when it encounters a query which needs a composite index - to check if an index needs to be added to the file. Try addind a composite query in your code just to test this theory - the devserver <i>should</i> either barf because of the incorrect existing <code>index.yaml</code> file or happily re-generate it from scratch if the theory is correct."}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470673807, "post_id": 38830027, "comment_id": 65033787, "body": "You don&#39;t need to specify an index for single properties. I have not used Go, but the convention in other runtimes is the same: property is indexed unless you request not to index it when an entity is created."}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470673889, "post_id": 38830027, "comment_id": 65033824, "body": "Note that you have to re-save the entity to make the property indexed - uploading index definitions will not affect any of the existing entities. You can, however, change a property to &quot;indexed&quot; in the Cloud Console manually (it does re-save it)."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470701348, "post_id": 38830027, "comment_id": 65046069, "body": "@AndreiVolgin There is no such option in the Dev Server Admin. The &quot;Indexes&quot; screen is empty of items and buttons and there is no ability to configure the entities/indexes in the query screen. You&#39;re saying this exists in production?"}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470704536, "post_id": 38830027, "comment_id": 65046688, "body": "Yes, in production But the Dev Server should also show which properties are indexed (under the value - at least, in Java)."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470711071, "post_id": 38830027, "comment_id": 65048155, "body": "@AndreiVolgin I&#39;m guessing that the Dev server is always Python, so I don&#39;t believe it&#39;ll make a difference. I added a screenshot of the Viewer. Is it in this screen that it should be indicated which properties are indexed? Note that since my indices appear to be troubled it may usually be shown but not at this moment."}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470712034, "post_id": 38830027, "comment_id": 65048355, "body": "My view looks different, but it may be because of the SDK version. I will try the latest."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470713911, "post_id": 38830027, "comment_id": 65048730, "body": "@AndreiVolgin Go, PHP, Python, and Java are currently essentially at the same version (1.9.40, my version) with the exception that Java is at 1.9.42 . The packaging may be language specific but I think they share the same Dev server (why rewrite it?)."}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1470717506, "post_id": 38830027, "comment_id": 65049566, "body": "Just tried 1.9.42. It looks different. There is no &quot;Create entity&quot; button. I feel cheated :)   I also see <code>(unindexed)</code> after values that are not indexed. Dan, you are a Python guy among us - what do you see?"}], "tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": false, "score": 0, "last_activity_date": 1470661609, "last_edit_date": 1495541354, "creation_date": 1470661609, "answer_id": 38830027, "question_id": 38829469, "link": "https://stackoverflow.com/questions/38829469/appengine-datastore-query-with-filter-never-returns-results-go/38830027#38830027", "title": "AppEngine Datastore query with filter never returns results (Go)", "body": "<p>To be able to find an entity in the result of a query/filter by a property that property <strong>must</strong> have had indexing enabled (in the model definition) at the time when the entity was created and the datastore's background indexing task(s) must be completed for it.</p>\n\n<p>If you enable indexing for that property <strong>after</strong> the entity was created you need to re-write the property so that the indexing tasks are triggered for it, see: <a href=\"https://stackoverflow.com/a/34583510/4495081\">https://stackoverflow.com/a/34583510/4495081</a>.</p>\n\n<p>The \"Saving search indexes\" message is a generic one printed before the operation takes place, it doesn't mean the result of the operation will be non-empty.</p>\n\n<p>You don't need to worry that your <code>index.yaml</code> file is empty. Not all indexes need to be present in the <code>index.yaml</code> file, only the more complex/composite ones need to. Your filter can be matched using the built-in indexes (after the above-mentioned indexing requirements are met). From <a href=\"https://cloud.google.com/datastore/docs/concepts/indexes\" rel=\"nofollow noreferrer\">Indexes</a>:</p>\n\n<blockquote>\n  <p>There are two types of indexes:</p>\n  \n  <ul>\n  <li><p><em>Built-in indexes</em></p>\n  \n  <p>By default, Cloud Datastore automatically predefines an index for each property of each entity kind. These single property indexes are\n  suitable for simple types of queries.</p></li>\n  <li><p><em>Composite indexes</em></p>\n  \n  <p>Composite indexes index multiple property values per indexed entity. Composite indexes support complex queries and are defined in\n  an index configuration file (index.yaml).</p></li>\n  </ul>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470746478, "post_id": 38842871, "comment_id": 65066303, "body": "Thanks for noticing something that I was too dumb to notice myself. That was a fun thirty messages. At least we established the possibility of seeing the &quot;unindexed&quot; thing. Also, I got results but I still don&#39;t see any indices in the admin or an &quot;index.yaml&quot; file. As previously mentioned by DanCornilescu simple indices must never be represented (which seems like it&#39;d make it harder to calculate cost estimates for writes). Lastly, I noticed when I run my AppEngine version under Go (&quot;goapp serve&quot;), I get a footnote that says it wraps the Python Dev server."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470746726, "post_id": 38842871, "comment_id": 65066468, "body": "@DustinOprea Only composite indices needs to be added to <code>index.yaml</code>. Single property indices do not. Single property indices exist on a <i>per entity</i> basis: one entity may have an indexed <code>Email</code> property, another one may have an unindexed <code>Email</code> property, a 3rd may not even have such property. And even a 4th may have one, but having different type... Datastore is not a relational database, it&#39;s schemaless."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470746787, "post_id": 38842871, "comment_id": 65066516, "body": "@DustinOprea And yes, the Go SDK uses the python dev server, it&#39;s no secret."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470747208, "post_id": 38842871, "comment_id": 65066773, "body": "I expected to not see an index.yaml file (it&#39;s already been mentioned by the user that I said mentioned it) but was stating it for posterity. I did, however, expect to see the simple index populate into the &quot;Datastore Indexes&quot; panel. I also meant to imply that, should you invoke the command-line help for the Java flavor, you might get the same indication (that it uses the Python server)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470747364, "post_id": 38842871, "comment_id": 65066899, "body": "@DustinOprea Single property indices need not be defined explicitly, and they don&#39;t appear on the indices page. Only composite indices. There&#39;s no deviation here on the Go part. Property indices &quot;just&quot; exists and they just &quot;vanish&quot; if there is no entry for them."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1470724057, "last_edit_date": 1495540435, "creation_date": 1470721269, "answer_id": 38842871, "question_id": 38829469, "link": "https://stackoverflow.com/questions/38829469/appengine-datastore-query-with-filter-never-returns-results-go/38842871#38842871", "title": "AppEngine Datastore query with filter never returns results (Go)", "body": "<p>The property name in the datastore is <code>\"Email\"</code> with capital E, not <code>\"email\"</code>.</p>\n\n<p>It's case-sensitive, must be queried with capital E:</p>\n\n<pre><code>query = datastore.NewQuery(\"UserAccount\").Filter(\"Email =\", \"test@example.com\")\n</code></pre>\n\n<p>If you would want it to be saved / retrieved with small <code>e</code>, you could use <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">tags</a> to do the mapping, e.g.:</p>\n\n<pre><code>type UserAccount struct {\n    Email string `datastore:\"email\"`\n    // other fields...\n}\n</code></pre>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 38842871, "answer_count": 2, "score": 1, "last_activity_date": 1471237332, "creation_date": 1470659938, "last_edit_date": 1471237332, "question_id": 38829469, "link": "https://stackoverflow.com/questions/38829469/appengine-datastore-query-with-filter-never-returns-results-go", "title": "AppEngine Datastore query with filter never returns results (Go)", "body": "<p>If I don't use a filter, I get results. If I use a filter (this record definitely exists), I don't get any results. It might be the lack of an index defined for that property, but, as I understand it, simple indices should automatically be created in the development server (and an index.yaml file created and populated with it). This is not happening.</p>\n\n<pre><code>query = datastore.NewQuery(\"UserAccount\").Filter(\"email =\", \"test@example.com\")\n\nua := UserAccount{}\nt := query.Run(ctx)\nfor ; ; {\n    if _, err = t.Next(&amp;ua); err == nil {\n        log.Debugf(ctx, \"Current: %s\", ua)\n    } else if err == datastore.Done {\n        break\n    } else {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>When the development server terminates, it states that it's \"saving search indexes\":</p>\n\n<pre><code>INFO     2016-08-08 05:09:52,894 api_server.py:651] Saving search indexes\n</code></pre>\n\n<p>However, since an \"index.yaml\" file doesn't appear, I'm assuming that no indices needed to be created, which means that my query must not've had the desired effect?</p>\n\n<p>What am I missing?</p>\n\n<p>Edit:</p>\n\n<p>Note that the record was previously created and the application stopped and started many times since. I sincerely doubt this is a eventual-consistency thing.</p>\n\n<p>Edit 2:</p>\n\n<p>For the purpose of testing, I've created the following model with the following code. They both exhibit the same behavior as my original model and code.</p>\n\n<p>Definition:</p>\n\n<pre><code>type TestEntity struct {\n    Email string\n}\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>log.Debugf(ctx, \"Putting.\")\n\nemail := \"anothertest@a.b\"\n\nte := &amp;TestEntity{\n        Email: email,\n}\n\nk := datastore.NewKey(ctx, \"TestEntity\", \"123\", 0, nil)\n_, err = datastore.Put(ctx, k, te)\nif err != nil {\n    panic(err)\n}\n\nlog.Debugf(ctx, \"Waiting.\")\ntime.Sleep(1 * time.Second)\n\nquery := datastore.NewQuery(\"TestEntity\")\n\nvar results []TestEntity\n_, err = query.GetAll(ctx, &amp;results)\nlog.Debugf(ctx, \"GetAll: %s\", results)\n\nlog.Debugf(ctx, \"Running query.\")\n\nquery = datastore.NewQuery(\"TestEntity\").Filter(\"email =\", email)\n\nte = &amp;TestEntity{}\nt := query.Run(ctx)\nfor ; ; {\n    if _, err = t.Next(te); err == nil {\n        log.Debugf(ctx, \"Found: [%s]\", te.Email)\n    } else if err == datastore.Done {\n        log.Debugf(ctx, \"Done.\")\n        break\n    } else {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>2016/08/09 02:11:36 DEBUG: Putting.\n2016/08/09 02:11:36 DEBUG: Waiting.\n2016/08/09 02:11:37 DEBUG: GetAll: [{anothertest@a.b}]\n2016/08/09 02:11:37 DEBUG: Running query.\n2016/08/09 02:11:37 DEBUG: Done.\n</code></pre>\n\n<p>Screenshot of Viewer:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SvE3Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SvE3Y.png\" alt=\"Screenshot of Viewer\"></a></p>\n"}, {"tags": ["go", "sha"], "answers": [{"comments": [{"owner": {"reputation": 589, "user_id": 4520017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-w04YXUYu3J8/AAAAAAAAAAI/AAAAAAAAOJU/_2vsGU9vq4Q/photo.jpg?sz=128", "display_name": "snapo", "link": "https://stackoverflow.com/users/4520017/snapo"}, "edited": false, "score": 0, "creation_date": 1471550269, "post_id": 38829516, "comment_id": 65403921, "body": "thank you very much for the one-liner, thats very helpfull and i changed everything now in my script. seems to work the same way."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1470660644, "last_edit_date": 1470660644, "creation_date": 1470660058, "answer_id": 38829516, "question_id": 38829420, "link": "https://stackoverflow.com/questions/38829420/getsha224-in-crypto-sha256-undeclared-name/38829516#38829516", "title": "GetSha224 in crypto/sha256 undeclared name", "body": "<p>There is no <code>sha224</code> package, the SHA224 algorithm is implemented in the <a href=\"https://golang.org/pkg/crypto/sha256/\" rel=\"nofollow\"><code>crypto/sha256</code></a> package (along with SHA256 of course). This is because SHA224 is simply a truncated version of SHA256.</p>\n\n<p>You properly imported that, use the <a href=\"https://golang.org/pkg/crypto/sha256/#New224\" rel=\"nofollow\"><code>sha256.New224()</code></a> function to acquire a new SHA224 \"hasher\" (<a href=\"https://golang.org/pkg/hash/#Hash\" rel=\"nofollow\"><code>hash.Hash</code></a>):</p>\n\n<pre><code>func GetSha224Hash(text string) string {\n    hasher := sha256.New224()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n</code></pre>\n\n<p>Note: if you just want to hash some data, you don't need to create a hasher. Most packages provide a shortcut to do that, e.g. <a href=\"https://golang.org/pkg/crypto/sha256/#Sum224\" rel=\"nofollow\"><code>sha256.Sum224()</code></a>:</p>\n\n<pre><code>func GetSha224Hash(text string) string {\n    s := sha256.Sum224([]byte(text))\n    return hex.EncodeToString(s[:])\n}\n</code></pre>\n\n<p>Or here's a one-liner:</p>\n\n<pre><code>func GetSha224Hash(text string) string {\n    return fmt.Sprintf(\"%x\", sha256.Sum224([]byte(text)))\n}\n</code></pre>\n"}], "owner": {"reputation": 589, "user_id": 4520017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-w04YXUYu3J8/AAAAAAAAAAI/AAAAAAAAOJU/_2vsGU9vq4Q/photo.jpg?sz=128", "display_name": "snapo", "link": "https://stackoverflow.com/users/4520017/snapo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "accepted_answer_id": 38829516, "answer_count": 1, "score": 1, "last_activity_date": 1470660644, "creation_date": 1470659796, "question_id": 38829420, "link": "https://stackoverflow.com/questions/38829420/getsha224-in-crypto-sha256-undeclared-name", "title": "GetSha224 in crypto/sha256 undeclared name", "body": "<p>I just startet with golang and write a very small script, everything works except for sha224. Can someone explain me please why i get the error (in regards to my script)? i dont need this error fixed, i wanna understand it to prevent future errors from my side.</p>\n\n<p>The error <strong>49:12: undeclared name: sha224</strong> indicates that i didnt declare something, but i cant find it because i did the same for all hashing algorythms.</p>\n\n<p>Im not a programmer, nor a specialist in golang. Its about my first go program.</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"crypto/sha1\"\n    \"crypto/sha256\"\n    \"crypto/sha512\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    url := \"http://45.32.153.207/index2.php\"\n    fmt.Printf(\"HTML code of %s ...\\n\", url)\n    resp, err := http.Get(url)\n    if err != nil {\n        panic(err)\n    }\n    defer resp.Body.Close()\n    html, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%s\\n\", html)\n    toHash := CToGoString(html[:])\n\n    fmt.Printf(\"%s\\n\", GetMD5Hash(toHash))\n    fmt.Printf(\"%s\\n\", GetSha1Hash(toHash))\n    fmt.Printf(\"%s\\n\", GetSha224Hash(toHash))\n    fmt.Printf(\"%s\\n\", GetSha256Hash(toHash))\n    fmt.Printf(\"%s\\n\", GetSha512Hash(toHash))\n}\n\nfunc GetMD5Hash(text string) string {\n    hasher := md5.New()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n\nfunc GetSha1Hash(text string) string {\n    hasher := sha1.New()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n\nfunc GetSha224Hash(text string) string {\n    hasher := sha224.New()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n\nfunc GetSha256Hash(text string) string {\n    hasher := sha256.New()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n\nfunc GetSha512Hash(text string) string {\n    hasher := sha512.New()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n\nfunc CToGoString(c []byte) string {\n    n := -1\n    for i, b := range c {\n        if b == 0 {\n            break\n        }\n        n = i\n    }\n    return string(c[:n+1])\n}\n</code></pre>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 1, "creation_date": 1470654152, "post_id": 38827407, "comment_id": 65020679, "body": "see this: <a href=\"http://stackoverflow.com/questions/38536734/golang-find-filenames-and-line-numbers-that-prints-output-to-stdout\" title=\"golang find filenames and line numbers that prints output to stdout\">stackoverflow.com/questions/38536734/&hellip;</a>"}, {"owner": {"reputation": 2432, "user_id": 1089226, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/06a2bf4d1a7d9eed5a2ed61c7440c2bf?s=128&d=identicon&r=PG", "display_name": "Poppy", "link": "https://stackoverflow.com/users/1089226/poppy"}, "edited": false, "score": 0, "creation_date": 1470662656, "post_id": 38827407, "comment_id": 65026197, "body": "@Amd This applies for default logging. But for logging using juju/logger, i dont see any method that could provide this by default. So is there a way i could do?"}], "owner": {"reputation": 2432, "user_id": 1089226, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/06a2bf4d1a7d9eed5a2ed61c7440c2bf?s=128&d=identicon&r=PG", "display_name": "Poppy", "link": "https://stackoverflow.com/users/1089226/poppy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470654200, "creation_date": 1470653808, "last_edit_date": 1470654200, "question_id": 38827407, "link": "https://stackoverflow.com/questions/38827407/golang-juju-logger-does-not-log-the-actual-line-in-the-log-file", "title": "Golang juju/logger does not log the actual line in the log file", "body": "<p>I'm using juju/logger in my Golang application for logging. I have configured the logger to log error,info and trace\nexample: </p>\n\n<pre><code>filelog.go\n-----------\nfunc (obj fileLog) Infof(format string, args ...interface{}) {\n    log.logger.Infof(format, args)\n}\n</code></pre>\n\n<p>and when called, the logger file actually shows the line number of <code>filelog.go</code> where the logger is defined and not the actual location where the logger is called. I'm calling <code>filelog</code> as </p>\n\n<pre><code>log.Logger().Infof(\"Invalid data passed\" + err.Error())\n</code></pre>\n\n<p>Is there any param to be configured to log the line number of the actual caller function? Please help.</p>\n"}, {"tags": ["go", "intellij-idea", "interface", "keyboard-shortcuts", "goland"], "comments": [{"owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "edited": false, "score": 0, "creation_date": 1470655495, "post_id": 38826591, "comment_id": 65021500, "body": "Never used IntelliJ, though for Go I would recommend <a href=\"https://github.com/Microsoft/vscode\" rel=\"nofollow noreferrer\">vscode</a>, it has an awesome Go plugin, plus the 100% open source."}], "answers": [{"tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 1, "last_activity_date": 1470661538, "creation_date": 1470661538, "answer_id": 38830007, "question_id": 38826591, "link": "https://stackoverflow.com/questions/38826591/intellij-idea-jump-from-interface-to-implementing-method-in-go/38830007#38830007", "title": "IntelliJ IDEA: Jump from interface to implementing method in Go", "body": "<p>No, such shortcut doesn't exist.</p>\n\n<p>You can use \"Find Usage\" to determine where the specific interface method is used, but if you want to see all the concrete implementations the current way is to search the entire project for the method name.</p>\n"}, {"tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 11, "last_activity_date": 1573200556, "last_edit_date": 1573200556, "creation_date": 1527269885, "answer_id": 50534369, "question_id": 38826591, "link": "https://stackoverflow.com/questions/38826591/intellij-idea-jump-from-interface-to-implementing-method-in-go/50534369#50534369", "title": "IntelliJ IDEA: Jump from interface to implementing method in Go", "body": "<p>This support has been added in Goland (or with go plugin in IntelliJ ultimate) now. Shortcut for the same is <code>Alt+Cmd+B</code> (<code>Option+Cmd+B</code> for Mac).</p>\n\n<p><a href=\"https://i.stack.imgur.com/AFxt7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AFxt7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 397, "user_id": 8595519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Hwjq.png?s=128&g=1", "display_name": "Lifei Chen", "link": "https://stackoverflow.com/users/8595519/lifei-chen"}, "is_accepted": false, "score": 1, "last_activity_date": 1573107198, "creation_date": 1573107198, "answer_id": 58742921, "question_id": 38826591, "link": "https://stackoverflow.com/questions/38826591/intellij-idea-jump-from-interface-to-implementing-method-in-go/58742921#58742921", "title": "IntelliJ IDEA: Jump from interface to implementing method in Go", "body": "<p>For goland</p>\n\n<p>Windows: <code>Alt+Cmd+B</code>\nMac os: <code>Option+Cmd+B</code></p>\n"}], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2526, "favorite_count": 2, "accepted_answer_id": 50534369, "answer_count": 3, "score": 7, "last_activity_date": 1573200556, "creation_date": 1470651311, "last_edit_date": 1561046612, "question_id": 38826591, "link": "https://stackoverflow.com/questions/38826591/intellij-idea-jump-from-interface-to-implementing-method-in-go", "title": "IntelliJ IDEA: Jump from interface to implementing method in Go", "body": "<p>Is there some shortcut that would allow me after creating method in an interface, select and jump to implementation of that method or give me list of implementations.</p>\n\n<p>I am looking for something like what I get when <kbd>Cmd</kbd>+Click and get usage of the interface method.</p>\n\n<p><a href=\"https://i.stack.imgur.com/txnhF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/txnhF.png\" alt=\"View After Cmd+Click\"></a></p>\n\n<p>But instead of usage of method I need short cut for implementation. Currently I have to copy the method name and search in the project, which does not feels like most efficient way.</p>\n\n<p>I am using intelliJ Idea (Community Edition) 2016.2.2 EAP with <a href=\"https://github.com/go-lang-plugin-org\" rel=\"nofollow noreferrer\">Go plugin</a> Version: 0.12.1724. </p>\n\n<p>I have tried <kbd>Cmd</kbd>+<kbd>Alt</kbd>+<kbd>b</kbd> but always getting <code>No implementation found</code></p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 8, "creation_date": 1470647103, "post_id": 38824899, "comment_id": 65016217, "body": "the answer is not go related, but read the man page for <code>ulimit</code>. However - a. you code has two disastrous bugs, see if you can spot them.  And b. on top of that, you are trying to open 1M files at once, unless you have a massive RAID array this is not practical."}, {"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 0, "creation_date": 1470647386, "post_id": 38824899, "comment_id": 65016377, "body": "What is your OS, is it Unix/Linux?"}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1470647653, "post_id": 38824899, "comment_id": 65016536, "body": "ulimit is not the best solution. I would prefer to have only limited number of goroutines, that open files and process it (maybe 500 parallel opened files). And each goroutine should select inputs from same channel, opens the file, read and close it, and sent result back to other channel. This second channel should be a part of request. And everybody who needs to use such goroutine should create this channel, sent request and wait for result. Do you understand, or you need an example?"}], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1470660091, "post_id": 38825523, "comment_id": 65024460, "body": "This still has the two bugs of the original question: 1. the goroutine function refers to <code>i</code> and not to <code>index</code>which is passed to it, and will result in opening the wrong files (besides the fact that you can&#39;t open integers as files). 2. still adding 1024*1024 to the waitGroup while doing <code>Done()</code> just once :)"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1470661603, "post_id": 38825523, "comment_id": 65025451, "body": "Updated the <code>index</code> bug. Thanks. About the <code>wg.Done</code>, what do you mean it&#39;s being done only once? Each goroutine only needs to do it once and that&#39;s what&#39;s happening. Can you please explain a bit more."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1470665044, "post_id": 38825523, "comment_id": 65027876, "body": "no it&#39;s ok, you fixed it.the code in the question itself has this bug."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 10, "last_activity_date": 1470661457, "last_edit_date": 1495542864, "creation_date": 1470648278, "answer_id": 38825523, "question_id": 38824899, "link": "https://stackoverflow.com/questions/38824899/golang-too-many-open-files-in-go-function-goroutine/38825523#38825523", "title": "golang too many open files in go function, goroutine", "body": "<p>You are running out of system resources because you are using up too many file descriptors without releasing enough of them. You need to limit concurrency in your program.</p>\n\n<p>For this, you can have a buffered channel that acts as a counting semaphore.</p>\n\n<pre><code>sem := make(chan struct{}, 12) // 12 is the maximum number of \n                                // concurrent processes that may run at any time\n</code></pre>\n\n<p>Now you can modify your method as:</p>\n\n<pre><code>func main() {\n    var wg sync.WaitGroup\n    wg.Add(1024 * 1024)\n\n    for i := 0; i &lt; (1024 * 1024); i++ {\n        go func(index int) {\n\n            // if there are already 12 goroutines running, below send will block\n            // and a new file wont be open\n            sem &lt;- struct{}{}\n\n            // once this goroutine finishes, empty the buffer by one\n            // so the next process may start (another goroutine blocked on\n            // above send will now be able to execute the statement and continue)\n            defer func() { &lt;-sem }()\n\n            // wg.Done must be deferred after a read from sem so that\n            // it executes before the above read\n            defer wg.Done()\n\n            if f, e := os.Open(strconv.Itoa(index)); e != nil {\n                // handle file open failure\n                return\n            }\n            defer f.Close()\n            // handle open file\n        }(i)\n    }\n\n    wg.Wait()\n    close(sem)\n}\n</code></pre>\n\n<p>Your use of <code>wg.Done</code> is also incorrect. Read about it <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\">here</a></p>\n\n<p>(Note that this code is to give a basic idea about this kind of problem. You can also refer to this question for a working example: <a href=\"https://stackoverflow.com/questions/38817122/go-worker-pool-with-repetitive-queue-structure\">Go worker pool with repetitive queue structure</a></p>\n"}], "owner": {"reputation": 57, "user_id": 6690204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c19908de18904c50f4490795e1481f?s=128&d=identicon&r=PG&f=1", "display_name": "kmdigit", "link": "https://stackoverflow.com/users/6690204/kmdigit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4331, "favorite_count": 3, "closed_date": 1470668892, "answer_count": 1, "score": 3, "last_activity_date": 1470661457, "creation_date": 1470646347, "question_id": 38824899, "link": "https://stackoverflow.com/questions/38824899/golang-too-many-open-files-in-go-function-goroutine", "closed_reason": "Needs more focus", "title": "golang too many open files in go function, goroutine", "body": "<pre><code>package main\n\nimport (\n    \"os\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(1024 * 1024)\n    for i := 0; i &lt; (1024 * 1024); i++ {\n        go func(index int) {\n            if f, e := os.Open(i); e == nil {\n                //blah blah\n                f.Close()\n            }\n        }(i)\n    }\n    wg.Done()\n}\n</code></pre>\n\n<p>If you run the program brings up the following error.\n\"open $ too many open files\"\nPlease tell us how to eliminate the error.</p>\n"}, {"tags": ["bash", "go", "mingw", "git-bash"], "comments": [{"owner": {"reputation": 6992, "user_id": 495157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UFMPn.png?s=128&g=1", "display_name": "JGFMK", "link": "https://stackoverflow.com/users/495157/jgfmk"}, "edited": false, "score": 1, "creation_date": 1499800841, "post_id": 38824561, "comment_id": 77060107, "body": "There seems to be someone with similar setup here <a href=\"https://sourceforge.net/p/mingw-w64/bugs/561/\" rel=\"nofollow noreferrer\">sourceforge.net/p/mingw-w64/bugs/561</a> May be worth following up with Keynan Pratt. There was a mention it may be a GO bug. But from what you&#39;ve said maybe it is in MINGW64. You should add pointer back to your post here perhaps."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 1, "creation_date": 1505517777, "post_id": 38824561, "comment_id": 79461458, "body": "Not a Go bug, actually, also happens if you try the very same in C."}], "answers": [{"comments": [{"owner": {"reputation": 972, "user_id": 410496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2860f84bcf050b1010a72cbda366ed32?s=128&d=identicon&r=PG", "display_name": "John Jeffery", "link": "https://stackoverflow.com/users/410496/john-jeffery"}, "edited": false, "score": 0, "creation_date": 1529200152, "post_id": 48323689, "comment_id": 88786531, "body": "Thanks for this answer, Phil. It works well for me. One thing I have found is that once I use <code>winpty</code> at least once, then subsequent invocations of the program will catch signals without me having to explicitly call <code>winpty</code>. This is just what I want to happen."}, {"owner": {"reputation": 191, "user_id": 1491662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e617d6ce2013d21e2a22290b59b0556?s=128&d=identicon&r=PG", "display_name": "uudaddy", "link": "https://stackoverflow.com/users/1491662/uudaddy"}, "edited": false, "score": 0, "creation_date": 1553892263, "post_id": 48323689, "comment_id": 97569574, "body": "So I did &quot;winpty mintty&quot; (mintty is the program that runs git bash window on Windows). It prompts me for which mintty version. It seems still now working for me..."}], "tags": [], "owner": {"reputation": 3685, "user_id": 1847261, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/87730852cde40d956d3854bea0cd2d01?s=128&d=identicon&r=PG", "display_name": "Phil K", "link": "https://stackoverflow.com/users/1847261/phil-k"}, "is_accepted": false, "score": 7, "last_activity_date": 1516286051, "creation_date": 1516286051, "answer_id": 48323689, "question_id": 38824561, "link": "https://stackoverflow.com/questions/38824561/catch-ctrl-c-on-windows-using-git-bash-mingw64-with-go/48323689#48323689", "title": "Catch CTRL-C on Windows using Git Bash / MINGW64 with Go", "body": "<p>Use <code>winpty</code> to catch signals correctly in Git Bash for Windows. It comes bundled with the installation, so all you need to do is:</p>\n\n<pre><code>$ winpty ./my-program.exe\n</code></pre>\n"}], "owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3643, "favorite_count": 1, "answer_count": 1, "score": 12, "last_activity_date": 1516286051, "creation_date": 1470645208, "last_edit_date": 1495542313, "question_id": 38824561, "link": "https://stackoverflow.com/questions/38824561/catch-ctrl-c-on-windows-using-git-bash-mingw64-with-go", "title": "Catch CTRL-C on Windows using Git Bash / MINGW64 with Go", "body": "<p>I want to run specific code before quitting when the user hits CTRL-C. The code is in Go and I want to run it on Windows using Git Bash / MINGW64. Using Go, I do</p>\n\n<pre><code>interrupt := make(chan os.Signal, 1)\nsignal.Notify(interrupt, os.Interrupt, syscall.SIGTERM, syscall.SIGINT)\n// some goroutines get started here\n// ...\nfor {\n  select {\n  case &lt;-interrupt:\n    // code which shall be run on CTRL-C\n  }\n}\n</code></pre>\n\n<p>On Windows, this works when I use a Windows command line, but I want it to work on MINGW64/Git Bash as well.</p>\n\n<p>I found on <a href=\"https://stackoverflow.com/a/31974985/1370397\">https://stackoverflow.com/a/31974985/1370397</a> that adding</p>\n\n<pre><code>trap '' SIGINT\n</code></pre>\n\n<p>to ~/.bashrc traps the SIGINT signal and prevents bash from terminating my program.</p>\n\n<p>This works for me on MINGW32 with bash version</p>\n\n<pre><code>$ bash --version\nGNU bash, version 3.1.20(4)-release (i686-pc-msys)\nCopyright (C) 2005 Free Software Foundation, Inc.\n</code></pre>\n\n<p>but it fails to work on MINGW64, bash version</p>\n\n<pre><code>$ bash --version\nGNU bash, version 4.3.42(5)-release (x86_64-pc-msys)\nCopyright (C) 2013 Free Software Foundation, Inc.\n[...]\n</code></pre>\n\n<p>What's different on MINGW64 or on that new (git) bash version?</p>\n\n<p>For easier testing, here is a minimal example to see the behaviour differences:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/signal\"\n    \"syscall\"\n    \"time\"\n)\n\nfunc cleanup(){\n    for i:=0; i&lt;3; i++ {\n        fmt.Println(\"Cleaning up...\")\n        time.Sleep(500*time.Millisecond)\n    }\n}\n\nfunc work() {\n    for {\n        fmt.Println(\"Working...\")\n        time.Sleep(300*time.Millisecond)\n    }\n}\n\nfunc main() {\n    interrupt := make(chan os.Signal, 1)\n    signal.Notify(interrupt, os.Interrupt, syscall.SIGTERM, syscall.SIGINT)\n\n    go work()\n\n    for {\n        select {\n        case &lt;-interrupt:\n            fmt.Println(\"Interrupt received - calling cleanup()...\")\n            cleanup()\n            fmt.Println(\"Quitting...\")\n            return\n        }\n        fmt.Println(\"Waiting...\")\n    }\n}\n</code></pre>\n\n<p>Output from MINGW32 (with trap '' SIGINT in ~/.bashrc):</p>\n\n<pre><code>$ ./sigint.exe\nWorking...\nWorking...\nWorking...\nInterrupt received - calling cleanup()...\nCleaning up...\nWorking...\nWorking...\nCleaning up...\nWorking...\nCleaning up...\nWorking...\nWorking...\nQuitting...\n</code></pre>\n\n<p>The cleanup() code gets executed.</p>\n\n<p>Output from MINGW64 (also with trap '' SIGINT in ~/.bashrc):</p>\n\n<pre><code>$ ./sigint.exe\nWorking...\nWorking...\nWorking...\nWorking...\n</code></pre>\n\n<p>cleanup() does not get executed. :-(</p>\n"}, {"tags": ["rest", "ssl", "go"], "answers": [{"comments": [{"owner": {"reputation": 3312, "user_id": 4175960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QbvYc.png?s=128&g=1", "display_name": "Eddy Hernandez", "link": "https://stackoverflow.com/users/4175960/eddy-hernandez"}, "edited": false, "score": 0, "creation_date": 1512137325, "post_id": 38825553, "comment_id": 82147661, "body": "I think <code>ServerName</code> is required in <code>&amp;tls.Config{}</code>"}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1532479892, "post_id": 38825553, "comment_id": 89987820, "body": "this code runs fine so when hitting a domain using letsencrypt just give it your public key cert.pem file"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 1, "creation_date": 1566504971, "post_id": 38825553, "comment_id": 101687928, "body": "Use <code>SystemCertPool</code> instead of <code>NewCertPool</code> to keep existing certs."}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 36, "last_activity_date": 1470648374, "creation_date": 1470648374, "answer_id": 38825553, "question_id": 38822764, "link": "https://stackoverflow.com/questions/38822764/how-to-send-a-https-request-with-a-certificate-golang/38825553#38825553", "title": "How to send a https request with a certificate golang", "body": "<p>You need to add CA of your certificate to your transport like:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"crypto/x509\"\n)\n\nfunc main() {\n    caCert, err := ioutil.ReadFile(\"rootCA.crt\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    caCertPool := x509.NewCertPool()\n    caCertPool.AppendCertsFromPEM(caCert)\n\n    client := &amp;http.Client{\n        Transport: &amp;http.Transport{\n            TLSClientConfig: &amp;tls.Config{\n                RootCAs:      caCertPool,\n            },\n        },\n    }\n\n    _, err := client.Get(\"https://secure.domain.com\")\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>But I guess you just haven't created CA to make your certificates. Here is the list of commands without explanation which can help you to make certificates signed with your own CA. For more information, you can Google it.</p>\n\n<ol>\n<li><p>Generating CA</p>\n\n<pre><code>openssl genrsa -out rootCA.key 4096\nopenssl req -x509 -new -key rootCA.key -days 3650 -out rootCA.crt\n</code></pre></li>\n<li><p>Generate certificate for <code>secure.domain.com</code> signed with created CA</p>\n\n<pre><code>openssl genrsa -out secure.domain.com.key 2048\nopenssl req -new -key secure.domain.com.key -out secure.domain.com.csr\n#In answer to question `Common Name (e.g. server FQDN or YOUR name) []:` you should set `secure.domain.com` (your real domain name)\nopenssl x509 -req -in secure.domain.com.csr -CA rootCA.crt -CAkey rootCA.key -CAcreateserial -days 365 -out secure.domain.com.crt\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 3312, "user_id": 4175960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QbvYc.png?s=128&g=1", "display_name": "Eddy Hernandez", "link": "https://stackoverflow.com/users/4175960/eddy-hernandez"}, "edited": false, "score": 1, "creation_date": 1512137210, "post_id": 44954368, "comment_id": 82147595, "body": "If I understand correctly if you add <code>InsecureSkipVerify</code> you allow the client to verify the server&#39;s certificate instead of yours, and your caCertPool is ignored. Please correct me if I&#39;m wrong."}], "tags": [], "owner": {"reputation": 41, "user_id": 5092826, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f-kAuBBCicA/AAAAAAAAAAI/AAAAAAAAD1E/Pb75_CWY6rc/photo.jpg?sz=128", "display_name": "J&#233;r&#244;me CARRE", "link": "https://stackoverflow.com/users/5092826/j%c3%a9r%c3%b4me-carre"}, "is_accepted": false, "score": 0, "last_activity_date": 1499365030, "last_edit_date": 1499365030, "creation_date": 1499358388, "answer_id": 44954368, "question_id": 38822764, "link": "https://stackoverflow.com/questions/38822764/how-to-send-a-https-request-with-a-certificate-golang/44954368#44954368", "title": "How to send a https request with a certificate golang", "body": "<p>If the certificate is self-signed, you must add this option :</p>\n\n<pre><code>TLSClientConfig: &amp;tls.Config{\n   RootCAs:      caCertPool,\n   InsecureSkipVerify: true,\n},\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 452, "user_id": 5834438, "user_type": "registered", "profile_image": "https://graph.facebook.com/515216871971511/picture?type=large", "display_name": "Mohamed Elbahja", "link": "https://stackoverflow.com/users/5834438/mohamed-elbahja"}, "edited": false, "score": 0, "creation_date": 1595200946, "post_id": 59112507, "comment_id": 111384211, "body": "How you can verify that your response actually from &quot;example.com&quot; and not hijacked?"}], "tags": [], "owner": {"reputation": 15417, "user_id": 805284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9799d7defe74d115e49df39f61388b2?s=128&d=identicon&r=PG", "display_name": "sjas", "link": "https://stackoverflow.com/users/805284/sjas"}, "is_accepted": false, "score": -2, "last_activity_date": 1575078042, "creation_date": 1575078042, "answer_id": 59112507, "question_id": 38822764, "link": "https://stackoverflow.com/questions/38822764/how-to-send-a-https-request-with-a-certificate-golang/59112507#59112507", "title": "How to send a https request with a certificate golang", "body": "<pre><code>package main\n\nimport \"crypto/tls\"\nimport . \"fmt\"\nimport \"io/ioutil\"\nimport \"net/http\"\nimport \"log\"\n\nfunc main(){\n    // InsecureSkipVerify: true  ## thats what you need\n    c:=&amp;http.Client{\n        Transport: &amp;http.Transport{\n            TLSClientConfig: &amp;tls.Config{\n                InsecureSkipVerify: true,\n            },\n        },\n    }\n    html,err:=c.Get(\"http://google.com\");if err!=nil{log.Fatal(err)}\n    website,err:=ioutil.ReadAll(html.Body);if err!=nil{log.Fatal(err)}\n    html.Body.Close()\n    Print(string(website))\n}\n</code></pre>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25505, "favorite_count": 15, "accepted_answer_id": 38825553, "answer_count": 3, "score": 26, "last_activity_date": 1575078042, "creation_date": 1470638706, "last_edit_date": 1470639703, "question_id": 38822764, "link": "https://stackoverflow.com/questions/38822764/how-to-send-a-https-request-with-a-certificate-golang", "title": "How to send a https request with a certificate golang", "body": "<p>I have a server which has a rest API running over https. I want to make a call to this rest api in my application which is running in different port but since this is over https I am getting </p>\n\n<pre><code>Post https://localhost:8080/api/v1/myapi: x509: certificate signed by unknown authority\n</code></pre>\n\n<p>I have 2 files pulic_key.pem and private_key which can used to verify the certificate. How can verify certificate while sending rest request using golang? I am using <code>&amp;http.Client{}</code> to send a rest request. Here is what I am doing to ignore the certificate right now.</p>\n\n<pre><code>tr := &amp;http.Transport{\nTLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n}\n\nclient := &amp;http.Client{Transport: tr}\n</code></pre>\n"}, {"tags": ["go", "switch-statement", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": false, "score": 27, "last_activity_date": 1470990153, "last_edit_date": 1470990153, "creation_date": 1470634063, "answer_id": 38821848, "question_id": 38821491, "link": "https://stackoverflow.com/questions/38821491/what-is-the-difference-between-switch-and-select-in-go/38821848#38821848", "title": "What is the difference between switch and select in Go?", "body": "<p><strong>switch</strong> is used to make a decision based on a variable value of any type. Read <a href=\"https://golang.org/doc/effective_go.html#switch\" rel=\"noreferrer\">this</a> for more details:</p>\n\n<blockquote>\n  <p>Go's switch is more general than C's. The expressions need not be constants or even integers, the cases are evaluated top to bottom until a match is found, and if the switch has no expression it switches on true. It's therefore possible\u2014and idiomatic\u2014to write an if-else-if-else chain as a switch. </p>\n</blockquote>\n\n<p>Sample Use: (<a href=\"https://play.golang.org/p/g7F7d7OG43\" rel=\"noreferrer\">Go Playground</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc main() {\n    fmt.Print(\"Go runs on \")\n    switch os := runtime.GOOS; os {\n    case \"darwin\":\n        fmt.Println(\"OS X.\")\n    case \"linux\":\n        fmt.Println(\"Linux.\")\n    default:\n        // freebsd, openbsd,\n        // plan9, windows...\n        fmt.Printf(\"%s.\", os)\n    }\n}\n</code></pre>\n\n<p>The <strong>select</strong> statement lets a goroutine wait on multiple communication operations.</p>\n\n<p>A select blocks until one of its cases can run, then it executes that case. It chooses one at random if multiple are ready. Here is one example: (<a href=\"https://play.golang.org/p/ipOXPcmWcL\" rel=\"noreferrer\">Go Playground</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    tick := time.Tick(100 * time.Millisecond)\n    boom := time.After(500 * time.Millisecond)\n    for {\n        select {\n        case &lt;-tick:\n            fmt.Println(\"tick.\")\n        case &lt;-boom:\n            fmt.Println(\"BOOM!\")\n            return\n        default:\n            fmt.Println(\"    .\")\n            time.Sleep(50 * time.Millisecond)\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19167, "user_id": 432193, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/87f2efac0ff72169aa6e92fc3c613189?s=128&d=identicon&r=PG", "display_name": "Endophage", "link": "https://stackoverflow.com/users/432193/endophage"}, "edited": false, "score": 8, "creation_date": 1470702791, "post_id": 38821921, "comment_id": 65046350, "body": "Would be good if you expanded on the <code>switch</code> explanation. It&#39;s not simply restricted to concrete types. By default, it does an equality check, and with no argument, each case statement must be a boolean expression, with the first <code>true</code> case being chosen."}], "tags": [], "owner": {"reputation": 6856, "user_id": 25411, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/23654c71d18aab6eb0da8ca1d27377d0?s=128&d=identicon&r=PG", "display_name": "null", "link": "https://stackoverflow.com/users/25411/null"}, "is_accepted": true, "score": 51, "last_activity_date": 1470743101, "last_edit_date": 1470743101, "creation_date": 1470634565, "answer_id": 38821921, "question_id": 38821491, "link": "https://stackoverflow.com/questions/38821491/what-is-the-difference-between-switch-and-select-in-go/38821921#38821921", "title": "What is the difference between switch and select in Go?", "body": "<p>A <code>select</code> is only used with channels. <a href=\"https://gobyexample.com/select\" rel=\"noreferrer\">Example</a></p>\n\n<p>A <code>switch</code> is used with concrete types. <a href=\"https://gobyexample.com/switch\" rel=\"noreferrer\">Example</a></p>\n\n<p>A <code>select</code> will choose multiple valid options at random, while a<code>switch</code> will go in sequence (and would require a fallthrough to match multiple.)  </p>\n\n<p>Note that a switch can also go over types for interfaces when used with the keyword <code>.(type)</code> </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var a interface{}\na = 5\nswitch a.(type) {\ncase int:\n     fmt.Println(\"an int.\")\ncase int32:\n     fmt.Println(\"an int32.\")\n}\n// in this case it will print \"an int.\"\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 7, "last_activity_date": 1470743043, "last_edit_date": 1470743043, "creation_date": 1470635489, "answer_id": 38822059, "question_id": 38821491, "link": "https://stackoverflow.com/questions/38821491/what-is-the-difference-between-switch-and-select-in-go/38822059#38822059", "title": "What is the difference between switch and select in Go?", "body": "<p><a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"noreferrer\">Select statements</a></p>\n\n<blockquote>\n  <p>A \"select\" statement chooses which of a set of possible send or\n  receive operations will proceed. It looks similar to a \"switch\"\n  statement but with the cases all referring to communication\n  operations.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"noreferrer\">Switch statements</a></p>\n\n<blockquote>\n  <p>\"Switch\" statements provide multi-way execution. An expression or type\n  specifier is compared to the \"cases\" inside the \"switch\" to determine\n  which branch to execute. There are two forms: expression switches and\n  type switches. In an expression switch, the cases contain expressions\n  that are compared against the value of the switch expression. In a\n  type switch, the cases contain types that are compared against the\n  type of a specially annotated switch expression. The switch expression\n  is evaluated exactly once in a switch statement.</p>\n</blockquote>\n\n<p>Yes, there are many differences:  </p>\n\n<ul>\n<li><code>select</code> works just on channel events (receive, close or wait), but you can use <code>switch</code> just for comparing channel data like <code>case &lt;-ch == 1:</code></li>\n<li><code>switch</code> works in deterministic way like multiple <code>if</code> or <code>if else</code> statement, but <code>select</code> chooses the <code>case</code> in non-deterministic way: you can't say which case runs first in <code>select</code></li>\n<li>you can't use <code>fallthrough</code> in <code>select</code></li>\n<li>in <code>switch</code> An expression or type specifier is compared to the <code>cases</code> inside the <code>switch</code> to determine which branch to execute.</li>\n<li><code>switch</code> is not blocking itself, but <code>select</code> is blocking underlying goroutine unless you use <code>default</code></li>\n<li><code>switch</code> has two forms: expression switches and type switches</li>\n<li>in blocking <code>select</code> (without <code>default</code>) there is no CPU usage (goroutine sleep)</li>\n<li>Unlike <code>select</code> you can't use <code>case &lt;-ch:</code> inside <code>switch</code>.</li>\n</ul>\n\n<p>Working sample Code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    ch := make(chan int, 4)\n    ch &lt;- 1\n    ch &lt;- 2\n    ch &lt;- 3\n    ch &lt;- 4\n    close(ch)\n    switch {\n    //case &lt;-ch: //  invalid case &lt;-ch in switch (mismatched types int and bool)\n    case &lt;-ch == 1:\n        fmt.Println(\"switch1\")\n        fallthrough\n    case &lt;-ch == 2:\n        fmt.Println(\"switch2\")\n    }\n    select {\n    case d := &lt;-ch:\n        fmt.Println(\"select1 d=\", d)\n    case d := &lt;-ch:\n        fmt.Println(\"select2 d=\", d)\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>switch1\nswitch2\nselect2 d= 2\n</code></pre>\n\n<p>output of another run:</p>\n\n<pre><code>switch1\nswitch2\nselect1 d= 2\n</code></pre>\n"}], "owner": {"reputation": 6600, "user_id": 2210667, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/65e361318ee533712efd7929d6e9977c?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2210667/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18934, "favorite_count": 8, "protected_date": 1492842696, "accepted_answer_id": 38821921, "answer_count": 3, "score": 41, "last_activity_date": 1565353175, "creation_date": 1470631841, "last_edit_date": 1470969070, "question_id": 38821491, "link": "https://stackoverflow.com/questions/38821491/what-is-the-difference-between-switch-and-select-in-go", "title": "What is the difference between switch and select in Go?", "body": "<p>Is there any difference between <code>switch</code> and <code>select</code> in Go,<br>\napart from the fact that one takes an argument and the other not?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1470628710, "post_id": 38820997, "comment_id": 65008788, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/25919213/why-does-golang-handle-closures-differently-in-goroutines\">Why does Golang handle closures differently in goroutines?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "edited": false, "score": 0, "creation_date": 1470628983, "post_id": 38821032, "comment_id": 65008842, "body": "I tried adding the parameter, but I am experiencing <a href=\"https://play.golang.org/p/SxcnORT6Ru\" rel=\"nofollow noreferrer\">dead lock</a>."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "edited": false, "score": 0, "creation_date": 1470673533, "post_id": 38821032, "comment_id": 65033615, "body": "@user3591466: Well, there&#39;s another problem. You send to the channels twice but your goroutines exit after receiving one value."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 1, "last_activity_date": 1470630186, "last_edit_date": 1470630186, "creation_date": 1470628186, "answer_id": 38821032, "question_id": 38820997, "link": "https://stackoverflow.com/questions/38820997/deadlock-when-spawning-goroutine-in-a-for-loop/38821032#38821032", "title": "Deadlock when spawning goroutine in a for loop", "body": "<p>By the time the goroutines are running the variable <code>i</code> has already incremented. Pass it as a function parameter instead.</p>\n\n<p>In fact, never rely on variables from a function closure in goroutines. It's too unreliable.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 4, "last_activity_date": 1470629400, "last_edit_date": 1470629400, "creation_date": 1470629096, "answer_id": 38821129, "question_id": 38820997, "link": "https://stackoverflow.com/questions/38820997/deadlock-when-spawning-goroutine-in-a-for-loop/38821129#38821129", "title": "Deadlock when spawning goroutine in a for loop", "body": "<p>There are some problems:<br>\n<strong>What is the value of <code>i</code> when <code>chan_array[i-1]</code> runs</strong>:</p>\n\n<pre><code>for i := 0; i &lt; 2; i++ {\n    go func() {\n        select {\n        case x := &lt;- chan_array[i-1]:\n            if x == 0 {\n                return\n            }\n            fmt.Println(x)\n        }\n    }()\n}\n</code></pre>\n\n<p>try this:  </p>\n\n<pre><code>for i := 0; i &lt; 2; i++ {\n    go func(i int) { \n        select {\n        case x := &lt;-chan_array[i]:\n            if x == 0 {\n                return\n            }\n            fmt.Println(x)\n        }\n    }(i)\n}\n</code></pre>\n\n<p>Let's simplify your code (with some corrections):  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    chan1 := make(chan int)\n    chan2 := make(chan int)\n\n    go routine(chan1)\n    go routine(chan2)\n\n    chan1 &lt;- 1\n    chan2 &lt;- 2\n    chan1 &lt;- 0\n    chan2 &lt;- 0\n}\n\nfunc routine(ch chan int) {\n    select {\n    case x := &lt;-ch:\n        if x == 0 {\n            return\n        }\n        fmt.Println(x)\n    }\n}\n</code></pre>\n\n<p>With these:</p>\n\n<pre><code>chan1 &lt;- 1\nchan2 &lt;- 2\n</code></pre>\n\n<p>fatal error: </p>\n\n<pre><code>all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>your goroutines finished and <strong>no goroutines listening</strong> to <code>chan1</code> and <code>chan1</code> here:</p>\n\n<pre><code>chan1 &lt;- 0\nchan2 &lt;- 0\n</code></pre>\n\n<p>Your corrected working sample code is:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    chan1 := make(chan int)\n    chan2 := make(chan int)\n\n    go routine(chan1)\n    go routine(chan2)\n\n    chan1 &lt;- 1\n    chan2 &lt;- 2\n    chan1 &lt;- 0\n    chan2 &lt;- 0\n}\n\nfunc routine(ch chan int) {\n    for {\n        select {\n        case x := &lt;-ch:\n            if x == 0 {\n                return\n            }\n            fmt.Println(x)\n        }\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>1\n2\n</code></pre>\n"}], "owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 38821129, "answer_count": 2, "score": 2, "last_activity_date": 1470630186, "creation_date": 1470627888, "last_edit_date": 1470629509, "question_id": 38820997, "link": "https://stackoverflow.com/questions/38820997/deadlock-when-spawning-goroutine-in-a-for-loop", "title": "Deadlock when spawning goroutine in a for loop", "body": "<p>Consider the following <a href=\"https://play.golang.org/p/PNSd2h0XPK\" rel=\"nofollow\">go playground</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    var chan_array [2]chan int\n\n    chan1 := make(chan int)\n    chan2 := make(chan int)\n\n    chan_array[0] = chan1\n    chan_array[1] = chan2\n\n\n    for i := 0; i &lt; 2; i++ {\n        go func() {\n\n            select {\n                case x := &lt;- chan_array[i]:\n                    if (x == 0) {\n                        return\n                    }       \n                    fmt.Println(x)\n            }\n        }()\n    }\n\n    chan1&lt;- 1\n    chan2&lt;- 2\n    chan1&lt;- 0\n    chan2&lt;- 0\n}\n</code></pre>\n\n<p>The code above is trying to create 2 running goroutines with that listens to the channel to signal print or close.</p>\n\n<p>But the above code run into dead lock.</p>\n\n<p>I am not exactly sure why</p>\n\n<p>Can someone point out my mistake?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "bit", "bit-shift"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1470620264, "post_id": 38820150, "comment_id": 65007175, "body": "<code>1 &lt;&lt; 64 = 10000000000000000</code> (hex) <code>1 &lt;&lt; 64 - 1 = FFFFFFFFFFFFFFFF</code> (hex) which is the largest <i>unsigned</i> 64 bit integer that can be stored in a <i>twos-compliment</i> numbering system. (if you are still stuck <code>1 &lt;&lt; 64</code> is a <code>65</code> bit number, not <code>64</code>)"}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1470620839, "post_id": 38820150, "comment_id": 65007289, "body": "ahh ok so by subtracting 1 you make the 65th bit disappear leaving <code>111111.....</code>?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1470621001, "post_id": 38820150, "comment_id": 65007332, "body": "Yes, you got it! (but leaving <code>FFFF... (16 hex digits)</code>, or <code>1111.... (64 binary 1s</code>)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470663860, "post_id": 38820150, "comment_id": 65027068, "body": "subtraction works the same in any base, just like in base 10 <code>1000 - 1 = 999</code>, one digit less."}, {"owner": {"reputation": 19167, "user_id": 432193, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/87f2efac0ff72169aa6e92fc3c613189?s=128&d=identicon&r=PG", "display_name": "Endophage", "link": "https://stackoverflow.com/users/432193/endophage"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1470703306, "post_id": 38820150, "comment_id": 65046427, "body": "@DavidC.Rankin isn&#39;t two&#39;s complement used to represent signed integers specifically? i.e. there&#39;s no such thing as an unsigned two&#39;s complement numbering system (at least not in the context of binary numbers in programming)? c.f. <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Two%27s_complement</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1470725458, "post_id": 38820150, "comment_id": 65052762, "body": "<i>&quot;GCC supports only two&#39;s complement integer types, and all bit patterns are ordinary values.&quot;</i> <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html\" rel=\"nofollow noreferrer\"><b>See: 4.5 Integers</b></a>  It applies to <i>both</i>."}], "answers": [{"tags": [], "owner": {"reputation": 38400, "user_id": 12166, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ae44dc366eacfc7e7eede0ae0ac065c?s=128&d=identicon&r=PG", "display_name": "Rafa\u0142 Dowgird", "link": "https://stackoverflow.com/users/12166/rafa%c5%82-dowgird"}, "is_accepted": true, "score": 1, "last_activity_date": 1470746244, "creation_date": 1470746244, "answer_id": 38850972, "question_id": 38820150, "link": "https://stackoverflow.com/questions/38820150/how-is-this-bitshifting-working-in-this-example/38850972#38850972", "title": "How is this bitshifting working in this example?", "body": "<p>What happens here, step by step:</p>\n\n<ol>\n<li><p>Take 1.</p></li>\n<li><p>Shift it to the left 64 bits. This is tricky. The result actually needs 65 bits for representation - namely 1 followed by 64 zeroes. Since we are calculating a 64 bit value here why does this even compile instead of overflowing to 0 or 1 or producing a compile error? </p></li>\n<li><p>It works because the arithmetic used to calculate constants in Go is a bit magic (<a href=\"https://blog.golang.org/constants\" rel=\"nofollow\">https://blog.golang.org/constants</a>) in that it has nothing to do whatsoever with the type of the named constant being calculated. You can say <code>foo uint8 = 1&lt;&lt;415 / 1&lt;&lt;414</code> and <code>foo</code> is now <code>2</code>.</p></li>\n<li><p>Subtract 1. This brings us back into 64 bits numbers, as it's actually 11....1 (64 times), which is indeed the maximum value of <code>uint64</code>. Without this step, the compiler would complain about us trying to cram 65 bit value into <code>uint64</code>.</p></li>\n<li><p>Name the constant <code>MaxInt</code> and give it type <code>uint64</code>. Success!</p></li>\n</ol>\n\n<p>The magic arithmetic used to calculate constants still has limitations (obviously). Shifts greater than 500 or so produce funny named <code>stupid shift</code> errors.</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 38850972, "answer_count": 1, "score": 2, "last_activity_date": 1470746244, "creation_date": 1470619980, "question_id": 38820150, "link": "https://stackoverflow.com/questions/38820150/how-is-this-bitshifting-working-in-this-example", "title": "How is this bitshifting working in this example?", "body": "<p>I was going through the <code>go</code> tutorial on golang.org and I came across an example that i partially understand...</p>\n\n<pre><code>MaxInt uint64     = 1&lt;&lt;64 - 1\n</code></pre>\n\n<p>Now I understand this to be shifting the bit 64 places to the left which would make it a 1 followed by 64 0's.</p>\n\n<p>My question is why is this the max integer that can be achieved in a 64 bit number. Wouldn't the max integer be <code>111111111....(until the 64th 1)</code> instead of <code>100000...(until the 64th one)</code>?</p>\n"}, {"tags": ["c", "go"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1470618948, "post_id": 38820047, "comment_id": 65006891, "body": "I thought it was <code>interface{}</code>, but I don&#39;t even know Go."}, {"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1470618964, "post_id": 38820047, "comment_id": 65006894, "body": "<a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/1</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": true, "score": 0, "last_activity_date": 1470619277, "last_edit_date": 1495540098, "creation_date": 1470619277, "answer_id": 38820084, "question_id": 38820047, "link": "https://stackoverflow.com/questions/38820047/what-is-the-golang-equivalent-of-a-void-pointer/38820084#38820084", "title": "What is the Golang equivalent of a void pointer", "body": "<p>You have to use an empty interface, (<code>interface {}</code>), and modify it to what you want. (<a href=\"https://stackoverflow.com/a/8996797/6525260\">Source</a>). This is known as an empty interface, and it can embody <em>any</em> type.</p>\n"}], "owner": {"reputation": 453, "user_id": 4868267, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d390efb3fd7d28967f9bf357d2d9f48e?s=128&d=identicon&r=PG&f=1", "display_name": "bmacrevolution", "link": "https://stackoverflow.com/users/4868267/bmacrevolution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1840, "favorite_count": 0, "closed_date": 1470619541, "accepted_answer_id": 38820084, "answer_count": 1, "score": 1, "last_activity_date": 1470627939, "creation_date": 1470618751, "last_edit_date": 1470627939, "question_id": 38820047, "link": "https://stackoverflow.com/questions/38820047/what-is-the-golang-equivalent-of-a-void-pointer", "closed_reason": "Duplicate", "title": "What is the Golang equivalent of a void pointer", "body": "<p>I am already familiar with C and I've been working on improving my Golang skills. Anyone know how to create something reminiscent of a void * in Golang?</p>\n\n<p>For example:</p>\n\n<pre><code>struct Node {\n    void *data;\n    struct Node *next;\n    struct Node *prev;\n}\n</code></pre>\n"}, {"tags": ["go", "reflection", "struct", "slice", "go-reflect"], "comments": [{"owner": {"reputation": 4071, "user_id": 1190419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3379111576f67a2d7c53bca4a25113aa?s=128&d=identicon&r=PG", "display_name": "moesef", "link": "https://stackoverflow.com/users/1190419/moesef"}, "edited": false, "score": 0, "creation_date": 1470611574, "post_id": 38818915, "comment_id": 65005528, "body": "This is acutally more along the lines of what I was looking for. <a href=\"http://stackoverflow.com/questions/25384640/why-golang-reflect-makeslice-returns-un-addressable-value\" title=\"why golang reflect makeslice returns un addressable value\">stackoverflow.com/questions/25384640/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 659, "user_id": 5032930, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/852933064761674/picture?type=large", "display_name": "Kartavya", "link": "https://stackoverflow.com/users/5032930/kartavya"}, "edited": false, "score": 0, "creation_date": 1581285730, "post_id": 38819105, "comment_id": 106370579, "body": "However, elemSlice is still of the type reflect.Value   How to get this to the actual slice type it is ?"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 12, "last_activity_date": 1537217978, "last_edit_date": 1537217978, "creation_date": 1470608631, "answer_id": 38819105, "question_id": 38818915, "link": "https://stackoverflow.com/questions/38818915/creating-slice-from-reflected-type/38819105#38819105", "title": "Creating Slice from Reflected Type", "body": "<p>No, what you describe is not possible. Not type asserting the result of <code>.Interface()</code> limits what you can do. Your best chance is to continue to work with the <code>reflect.Value</code> value:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype TestStruct struct {\n    TestStr string\n}\n\nfunc main() {\n    elemType := reflect.TypeOf(TestStruct{})\n\n    elemSlice := reflect.MakeSlice(reflect.SliceOf(elemType), 0, 10)\n\n    elemSlice = reflect.Append(elemSlice, reflect.ValueOf(TestStruct{\"Testing\"}))\n\n    fmt.Printf(\"%+v\\n\", elemSlice)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/WkGPjv0m_P\" rel=\"noreferrer\">https://play.golang.org/p/WkGPjv0m_P</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 4, "last_activity_date": 1470969762, "last_edit_date": 1470969762, "creation_date": 1470608658, "answer_id": 38819109, "question_id": 38818915, "link": "https://stackoverflow.com/questions/38818915/creating-slice-from-reflected-type/38819109#38819109", "title": "Creating Slice from Reflected Type", "body": "<p>1- Using <code>reflect.MakeSlice(reflect.SliceOf(elemType), 0, 10)</code> and<br>\n<code>reflect.Append(elemSlice, reflect.ValueOf(TestStruct{\"Testing\"}))</code>,<br>\nLike this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\nfunc main() {\n    elemType := reflect.TypeOf(TestStruct{})\n    elemSlice := reflect.MakeSlice(reflect.SliceOf(elemType), 0, 10)\n    elemSlice = reflect.Append(elemSlice, reflect.ValueOf(TestStruct{\"Testing\"}))\n    fmt.Println(elemSlice) // [{Testing}]\n\n}\n\ntype TestStruct struct {\n    TestStr string\n}\n</code></pre>\n\n<hr>\n\n<p>2- Using <code>reflect.New(reflect.SliceOf(elemType)).Elem()</code> and<br>\n<code>elemSlice = reflect.Append(elemSlice, reflect.ValueOf(TestStruct{\"Testing\"}))</code><br>\nLike this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype TestStruct struct {\n    TestStr string\n}\n\nfunc main() {\n    elemType := reflect.TypeOf(TestStruct{})\n    elemSlice := reflect.New(reflect.SliceOf(elemType)).Elem()\n    elemSlice = reflect.Append(elemSlice, reflect.ValueOf(TestStruct{\"Testing\"}))\n\n    fmt.Printf(\"%+v\\n\", elemSlice) // [{TestStr:Testing}]\n    fmt.Println(elemSlice)         // [{Testing}]\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[{TestStr:Testing}]\n[{Testing}]\n</code></pre>\n\n<hr>\n\n<p>3- If you need <code>append</code>, the only way is using <code>s := elemSlice.([]TestStruct)</code>, like this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype TestStruct struct {\n    TestStr string\n}\n\nfunc main() {\n    elemType := reflect.TypeOf(TestStruct{})\n    elemSlice := reflect.New(reflect.SliceOf(elemType)).Elem().Interface()\n\n    s := elemSlice.([]TestStruct)\n    s = append(s, TestStruct{\"Testing\"})\n\n    fmt.Printf(\"%+v\\n\", elemSlice) // []\n    fmt.Println(s)                 // [{Testing}]\n}\n</code></pre>\n"}], "owner": {"reputation": 4071, "user_id": 1190419, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3379111576f67a2d7c53bca4a25113aa?s=128&d=identicon&r=PG", "display_name": "moesef", "link": "https://stackoverflow.com/users/1190419/moesef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5211, "favorite_count": 3, "accepted_answer_id": 38819105, "answer_count": 2, "score": 5, "last_activity_date": 1537217978, "creation_date": 1470606856, "last_edit_date": 1471842574, "question_id": 38818915, "link": "https://stackoverflow.com/questions/38818915/creating-slice-from-reflected-type", "title": "Creating Slice from Reflected Type", "body": "<p>I am trying to create a slice from a <code>reflect.Type</code>. This is what I have so far.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype TestStruct struct {\n    TestStr string\n}\n\nfunc main() {\n    elemType := reflect.TypeOf(TestStruct{})\n\n    elemSlice := reflect.New(reflect.SliceOf(elemType)).Interface()\n\n    elemSlice = append(elemSlice, TestStruct{\"Testing\"})\n\n    fmt.Printf(\"%+v\\n\", elemSlice)\n\n}\n</code></pre>\n\n<p>However I get the following error and I'm not sure how to get around it without hardcoding a conversion to <code>[]TestStruct</code>.</p>\n\n<pre><code>prog.go:17: first argument to append must be slice; have interface {}\n</code></pre>\n\n<p>Is there anyway to treat the returned interface as a slice without having to hardcode the conversion from <code>interface{}</code> to <code>[]TestStruct</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1470600159, "post_id": 38818005, "comment_id": 65003000, "body": "Indicate the line of code where you get the error. Show the type definition for CustomHandler."}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470600300, "post_id": 38818005, "comment_id": 65003032, "body": "Have you mis-spelt <code>Handler</code>?"}, {"owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1470600941, "post_id": 38818005, "comment_id": 65003208, "body": "The error points to &#39;})&#39; and no I haven&#39;t mis-spelt Handler this time"}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470609752, "post_id": 38818005, "comment_id": 65005182, "body": "You still mis-spelt it in the question title..."}], "answers": [{"tags": [], "owner": {"reputation": 1121, "user_id": 4381158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABb2u.jpg?s=128&g=1", "display_name": "Maxim Samburskiy", "link": "https://stackoverflow.com/users/4381158/maxim-samburskiy"}, "is_accepted": false, "score": 0, "last_activity_date": 1470601131, "creation_date": 1470601131, "answer_id": 38818156, "question_id": 38818005, "link": "https://stackoverflow.com/questions/38818005/how-to-wrap-a-custom-handlerfunc/38818156#38818156", "title": "How to wrap a custom HandlerFunc", "body": "<p>You can simply do that:</p>\n\n<pre><code>type handler func(w http.ResponseWriter, r *http.Request) error\n\nfunc (h handler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    if err := h(w, r); err != nil {\n        ...\n    }\n}\n</code></pre>\n\n<p>And use it like:</p>\n\n<pre><code>func home(w http.ResponseWriter, r *http.Request) error {\n    ...\n}\n\nfunc main() {\n    http.Handle(\"/\", handler(home))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1470743157, "last_edit_date": 1470743157, "creation_date": 1470605314, "answer_id": 38818744, "question_id": 38818005, "link": "https://stackoverflow.com/questions/38818005/how-to-wrap-a-custom-handlerfunc/38818744#38818744", "title": "How to wrap a custom HandlerFunc", "body": "<p>First define <code>CustomHandler</code> like this: </p>\n\n<pre><code>type CustomHandler struct{}\n</code></pre>\n\n<p>then <code>ServeHTTP</code> like this:</p>\n\n<pre><code>func (c CustomHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"%s\", msg1)\n}\n</code></pre>\n\n<p>See this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"net/http\"\n\nfunc main() {\n    http.Handle(\"/\", CustomHandler{})\n    http.ListenAndServe(\":80\", nil)\n}\n\ntype CustomHandler struct{}\n\nfunc (c CustomHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"%s\", msg1)\n}\n\nvar msg1 string = `\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt; \n&lt;title&gt;Welcome Home&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\nWelcome Home\n&lt;/body&gt;\n&lt;/html&gt;\n`\n</code></pre>\n\n<p>Then run the above code then open <code>http://127.0.0.1/</code><br>\noutput:</p>\n\n<pre><code>Welcome Home\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": false, "score": 0, "last_activity_date": 1470605724, "creation_date": 1470605724, "answer_id": 38818797, "question_id": 38818005, "link": "https://stackoverflow.com/questions/38818005/how-to-wrap-a-custom-handlerfunc/38818797#38818797", "title": "How to wrap a custom HandlerFunc", "body": "<p>Don't make so many spelling mistakes in your code.</p>\n\n<ul>\n<li><code>ServerHTTP</code> should be <code>ServeHTTP</code></li>\n<li><code>Handeler</code> should be <code>Handler</code></li>\n<li><code>ServerHttp</code> should be <code>ServeHTTP</code></li>\n<li><code>CusomHandlerFunc</code> should be <code>CustomHandlerFunc</code></li>\n</ul>\n\n<p>When you have fixed these misspellings, you have a better chance that your code works.</p>\n"}], "owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1471945125, "creation_date": 1470599997, "last_edit_date": 1471945125, "question_id": 38818005, "link": "https://stackoverflow.com/questions/38818005/how-to-wrap-a-custom-handlerfunc", "title": "How to wrap a custom HandlerFunc", "body": "<p>I have defined a <code>CustomHandler</code> (struct which implements <code>ServerHTTP</code>, and has a <code>HandlerFunc</code> that returns an error)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type CustomHandler struct{\n  HandlerFunc func(w http.ResponseWriter, r *http.Request) error\n}\n\ntype (c CustomHandler) ServerHTTP(w http.ResponseWriter, r *http.Request) {\n  err := c.Handeler.ServerHttp(w, r)\n  // Handler error\n}\n</code></pre>\n\n<p>How can I wrap my <code>CustomHandler</code>?</p>\n\n<p>I have tried this, but I keep getting not enough arguments.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func myMiddle(h CustomHandler) CustomHandler {\n  return h.CusomHandlerFunc(func(w http.ResponseWriter, r *http.Request) error {\n    h.ServerHTTP(w, r)\n    return nil\n  })\n}\n</code></pre>\n"}, {"tags": ["go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 4669076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42db31c862a8974778f6a2d3dcfe5e97?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel D&#39;Souza", "link": "https://stackoverflow.com/users/4669076/daniel-dsouza"}, "edited": false, "score": 0, "creation_date": 1470690423, "post_id": 38817630, "comment_id": 65042625, "body": "Is &quot;golang.org/x/net/websocket&quot; still inferior to gorilla?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 67, "user_id": 4669076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42db31c862a8974778f6a2d3dcfe5e97?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel D&#39;Souza", "link": "https://stackoverflow.com/users/4669076/daniel-dsouza"}, "edited": false, "score": 0, "creation_date": 1470690502, "post_id": 38817630, "comment_id": 65042660, "body": "The x/net package does not implement the complete protocol including commonly used features like message fragmentation. Use the Gorilla package."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1470597327, "creation_date": 1470597327, "answer_id": 38817630, "question_id": 38817478, "link": "https://stackoverflow.com/questions/38817478/writing-a-client-over-websocket-in-golang/38817630#38817630", "title": "writing a client over websocket in golang", "body": "<p>Use a for loop to read a websocket using the Gorilla package:</p>\n\n<pre><code>for {\n    _, message, err := c.ReadMessage()\n    if err != nil {\n        log.Println(\"read:\", err)\n        c.Close()\n        break\n    }\n    handleMessage(message)\n}\n</code></pre>\n\n<p>Run the loop in a goroutine to make it asynchronous:</p>\n\n<pre><code>go func() {\n    for {\n        _, message, err := c.ReadMessage()\n        if err != nil {\n            log.Println(\"read:\", err)\n            c.Close()\n            break\n        }\n        handleMessage(message)\n    }\n}()\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4669076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42db31c862a8974778f6a2d3dcfe5e97?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel D&#39;Souza", "link": "https://stackoverflow.com/users/4669076/daniel-dsouza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 38817630, "answer_count": 1, "score": 1, "last_activity_date": 1561822317, "creation_date": 1470596216, "last_edit_date": 1561822317, "question_id": 38817478, "link": "https://stackoverflow.com/questions/38817478/writing-a-client-over-websocket-in-golang", "title": "writing a client over websocket in golang", "body": "<p>I'm writing an client that dials a websocket, and waits to receive information. I can successfully dial the websocket, but I cannot figure out how to implement some kind of asynchronous callback using the \"golang.org/x/net/websocket\" package. Is this even possible, or should I use the Gorilla package?</p>\n"}, {"tags": ["multithreading", "go", "concurrency", "queue", "worker"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1470594448, "post_id": 38817122, "comment_id": 65001439, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go\">Is this an idiomatic worker thread pool in Go?</a>"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1470596626, "post_id": 38817122, "comment_id": 65002057, "body": "Can you provide the code that shows the possible concurrent access to the same <code>Item</code>? It sounds like you&#39;d probably need to protect it with a mutex, but it&#39;s hard to say without seeing the code. You may also need to protect against concurrent access to <code>Items</code>, depending on how that happens in your code. Concurrent reads are OK, but if a write may happen while another goroutine is accessing the map, you need to protect it with a mutex."}, {"owner": {"reputation": 1121, "user_id": 4381158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABb2u.jpg?s=128&g=1", "display_name": "Maxim Samburskiy", "link": "https://stackoverflow.com/users/4381158/maxim-samburskiy"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470598689, "post_id": 38817122, "comment_id": 65002620, "body": "@icza my version is more complex"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1470601359, "post_id": 38817122, "comment_id": 65003316, "body": "How is <code>Count</code> being accessed in the worker goroutines? That may or may not need to be protected, depending on what you&#39;re doing. If the code in <code>main</code> is adding entries to <code>items</code>, you definitely need to protect that. <code>RWMutex</code> is probably what you want there."}, {"owner": {"reputation": 1121, "user_id": 4381158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABb2u.jpg?s=128&g=1", "display_name": "Maxim Samburskiy", "link": "https://stackoverflow.com/users/4381158/maxim-samburskiy"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1470601604, "post_id": 38817122, "comment_id": 65003386, "body": "@AndySchweig workers compare <code>Count</code> with number from http request. <code>main</code> don&#39;t add any new items, but changes <code>Count</code> for some existing items"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1470602397, "post_id": 38817122, "comment_id": 65003591, "body": "It sounds like you don&#39;t need any mutexes. The read and write of <code>Count</code> will be atomic since it&#39;s a single byte. As long as you&#39;ll never be creating an entry in the map while another goroutine is trying to look up something in the map, you don&#39;t need to protect that either."}, {"owner": {"reputation": 1121, "user_id": 4381158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABb2u.jpg?s=128&g=1", "display_name": "Maxim Samburskiy", "link": "https://stackoverflow.com/users/4381158/maxim-samburskiy"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1470602612, "post_id": 38817122, "comment_id": 65003643, "body": "@AndySchweig so modifying <code>Count</code> in main thread and reading it in another is safe? And what if I will use <code>uint16</code>, <code>uint32</code> or <code>uint64</code> which contains more bytes?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1470604688, "post_id": 38817122, "comment_id": 65004178, "body": "There are functions in the <code>atomic</code> package that will do atomic access for 32- and 64-bit integers. For a single byte, you should be OK, but you may still want to use a mutex instead of relying on atomic operations just in case your access to the item becomes more complex. Some might also say that this is a cleaner way to go. If you do use a mutex, I would put it in the <code>Item</code> struct. I&#39;m afraid I haven&#39;t actually answered your question about the idiomatic way to do this, since I&#39;m not completely sure what it is. Doing it with a mutex protecting the item will definitely work, though."}], "owner": {"reputation": 1121, "user_id": 4381158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABb2u.jpg?s=128&g=1", "display_name": "Maxim Samburskiy", "link": "https://stackoverflow.com/users/4381158/maxim-samburskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476707322, "creation_date": 1470593720, "last_edit_date": 1470601841, "question_id": 38817122, "link": "https://stackoverflow.com/questions/38817122/go-worker-pool-with-repetitive-queue-structure", "title": "Go worker pool with repetitive queue structure", "body": "<p>I'm trying make worker pool with looped queue. Is my code idiomatic for Go? And how can I solve concurrent access to <code>*Item</code>? Pool processing 1 item at time and <code>*Item</code> don't shared between workers, but sometimes I need change <code>*Item</code> from main thread. Should I place mutex at every <code>*Item</code> and when I should lock/unlock it? Or maybe some other structure is possible?</p>\n\n<pre><code>var items = make(map[uint8]*Item)\n\nfunc worker(queue, done chan uint8) {\n    for id := range queue {\n        item := items[id]\n\n        // get from http request\n        n := ...\n\n        if item.Count &gt; n {\n            ... // perform some actions with id\n        }\n\n        done&lt;- id\n    }\n}\n\nfunc dispatcher() {\n    queue := make(chan uint8, 100)\n    done := make(chan uint8, 100)\n\n    for i := 0; i &lt; 4; i++ {\n        go worker(queue, done)\n    }\n\n    for id := range jobs {\n        queue&lt;- id\n    }\n\n    for {\n        select {\n            case id := &lt;-done:\n                queue&lt;- id\n            ...\n        }\n    }\n}\n</code></pre>\n\n<p>And main:</p>\n\n<pre><code>func main() {\n    go dispatcher()\n\n    for {\n        var id, count uint8\n        fmt.Scan(&amp;id, &amp;count)\n        // modifying\n        items[id].Count = count\n    }\n}\n</code></pre>\n\n<p>P.S. Sorry for my bad English.</p>\n"}, {"tags": ["testing", "logging", "go", "printing"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1470594121, "post_id": 38817090, "comment_id": 65001336, "body": "Did you try the option <i>-cover</i> ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470594625, "post_id": 38817090, "comment_id": 65001481, "body": "Related: <a href=\"http://stackoverflow.com/questions/38463609/why-does-go-test-run-notexist-pass\">Why does <code>go test -run NotExist</code> pass?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 4265763, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_XuweyYACIs/AAAAAAAAAAI/AAAAAAAAAEI/OvebLDs1Rlo/photo.jpg?sz=128", "display_name": "Sirui Zhuang", "link": "https://stackoverflow.com/users/4265763/sirui-zhuang"}, "is_accepted": false, "score": 0, "last_activity_date": 1470733209, "creation_date": 1470733209, "answer_id": 38846316, "question_id": 38817090, "link": "https://stackoverflow.com/questions/38817090/go-test-specific-file-ouput/38846316#38846316", "title": "Go test specific file ouput", "body": "<p>Just <code>go test ./handlers -v</code>. The <strong>handlers</strong> is the package path.</p>\n"}], "owner": {"reputation": 2007, "user_id": 2209904, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/oMlqY.jpg?s=128&g=1", "display_name": "JudyJiang", "link": "https://stackoverflow.com/users/2209904/judyjiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470733209, "creation_date": 1470593483, "question_id": 38817090, "link": "https://stackoverflow.com/questions/38817090/go-test-specific-file-ouput", "title": "Go test specific file ouput", "body": "<p>I'm new in Go and trying to work on a project.\nThe structure of the code is like</p>\n\n<pre><code>handlers/\n  -time.go\n  -time_test.go\n</code></pre>\n\n<p>I've already tried go build, make (project) name</p>\n\n<p>The thing is, I want to add some console output inside the code so that I know if a branch is covered or not (or for debugging). Right now, it doesn't work for me.</p>\n\n<p>If I use: </p>\n\n<pre><code>go test -run test_file_path\n</code></pre>\n\n<p>If will just output</p>\n\n<pre><code>Pass        0.009s\n</code></pre>\n\n<p>Even I put<code>t.Log(\"print log\")</code> or even <code>fmt.Print(\"Say Hello\")</code> inside the test function.</p>\n\n<p>If I just use <code>go test -v test_file_path</code> I would have undefined variables. The build &amp; test would fail.</p>\n\n<p>Any suggestions? Thanks!g</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "is_accepted": false, "score": 1, "last_activity_date": 1470592992, "creation_date": 1470592992, "answer_id": 38817020, "question_id": 38816843, "link": "https://stackoverflow.com/questions/38816843/explain-type-assertions-in-go/38817020#38817020", "title": "Explain Type Assertions in Go", "body": "<p>Common usecase: check if returned error is of a type T.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">https://golang.org/ref/spec#Type_assertions</a></p>\n\n<p>For a single return value assertion: when it fails the program panics.</p>\n\n<p>For a two return values assertion: when it fails second argument is set to false and the program doesn't panic.</p>\n"}, {"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 3, "creation_date": 1470638626, "post_id": 38818437, "comment_id": 65011735, "body": "Great explanation! I understand it much better now. Just one more thing, if I may ask you to complement: what does the assertion return when T is an interface and not a concrete type?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 2, "creation_date": 1470643189, "post_id": 38818437, "comment_id": 65014074, "body": "@user1283776 : <code>var _ = i.(interface{})</code> if <code>i</code> is nil it panics.  but in <code>b, ok := i.(interface{})</code> if <code>i</code> is nil then <code>ok</code> is false, otherwise <code>ok</code> is true and <code>b</code> is of type <code>interface{}</code>, and see end of this post for sample codes."}, {"owner": {"reputation": 126, "user_id": 1478871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b386beddeea598aa6cfe6108d3acfd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Tandon", "link": "https://stackoverflow.com/users/1478871/sahil-tandon"}, "edited": false, "score": 2, "creation_date": 1589918980, "post_id": 38818437, "comment_id": 109483184, "body": "Fantastic answer that really demystifies the concept. Thank you."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 86, "last_activity_date": 1560379775, "last_edit_date": 1560379775, "creation_date": 1470603072, "answer_id": 38818437, "question_id": 38816843, "link": "https://stackoverflow.com/questions/38816843/explain-type-assertions-in-go/38818437#38818437", "title": "Explain Type Assertions in Go", "body": "<h1>Short answer</h1>\n\n<p>In one line: </p>\n\n<blockquote>\n  <p><code>x.(T)</code> asserts that <code>x</code> is not nil and that the value stored in <code>x</code> is of type <code>T</code>.</p>\n</blockquote>\n\n<h3>Why would I use them:</h3>\n\n<ul>\n<li>to check <code>x</code> is nil</li>\n<li>to check if it's convertible (assert) to another type</li>\n<li>convert (assert) to another type</li>\n</ul>\n\n<h3>What exactly they return:</h3>\n\n<ul>\n<li><p><code>t := x.(T)</code> => t is of type <code>T</code>; if <code>x</code> is nil, it panics.</p></li>\n<li><p><code>t,ok := x.(T)</code> => if <code>x</code> is nil or not of type <code>T</code> => <code>ok</code> is <code>false</code> otherwise <code>ok</code> is <code>true</code> and <code>t</code> is of type <code>T</code>.</p></li>\n</ul>\n\n<hr>\n\n<h1>Detailed explanation</h1>\n\n<p>Imagine you need to calculate area of 4 different shapes: Circle, Square, Rectangle and Triangle. You may define new types with a new method called <code>Area()</code>, like this:  </p>\n\n\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Circle struct {\n    Radius float64\n}\nfunc (t Circle) Area() float64 {\n    return math.Pi * t.Radius * t.Radius\n}\n</code></pre>\n\n<p>And for <code>Triangle</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Triangle struct {\n    A, B, C float64 // lengths of the sides of a triangle.\n}\nfunc (t Triangle) Area() float64 {\n    p := (t.A + t.B + t.C) / 2.0 // perimeter half\n    return math.Sqrt(p * (p - t.A) * (p - t.B) * (p - t.C))\n}\n</code></pre>\n\n<p>And for <code>Rectangle</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Rectangle struct {\n    A, B float64\n}\n\nfunc (t Rectangle) Area() float64 {\n    return t.A * t.B\n}\n</code></pre>\n\n<p>And for <code>Square</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Square struct {\n    A float64\n}\nfunc (t Square) Area() float64 {\n    return t.A * t.A\n}\n</code></pre>\n\n<p>Here you have <code>Circle</code>, with radius of 1.0, and other shapes with their sides:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>shapes := []Shape{\n    Circle{1.0},\n    Square{1.772453},\n    Rectangle{5, 10},\n    Triangle{10, 4, 7},\n}\n</code></pre>\n\n<p>Interesting! How can we collect them all in one place?<br>\nFirst you need <code>Shape interface</code> to collect them all in one slice of shape <code>[]Shape</code> :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Shape interface {\n    Area() float64\n}\n</code></pre>\n\n<p>Now you can collect them like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>shapes := []Shape{\n    Circle{1.0},\n    Square{1.772453},\n    Rectangle{5, 10},\n    Triangle{10, 4, 7},\n}\n</code></pre>\n\n<p>After all, <code>Circle</code> is a <code>Shape</code> and <code>Triangle</code> is a <code>Shape</code> too.<br>\nNow you can print the area of each shape using the single statement <code>v.Area()</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>for _, v := range shapes {\n    fmt.Println(v, \"\\tArea:\", v.Area())\n}\n</code></pre>\n\n<p>So <code>Area()</code> is a common interface between all shapes.\nNow, how can we calculate and call uncommon method like angles of triangle using above <code>shapes</code>?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (t Triangle) Angles() []float64 {\n    return []float64{angle(t.B, t.C, t.A), angle(t.A, t.C, t.B), angle(t.A, t.B, t.C)}\n}\nfunc angle(a, b, c float64) float64 {\n    return math.Acos((a*a+b*b-c*c)/(2*a*b)) * 180.0 / math.Pi\n}\n</code></pre>\n\n<p>Now it's time to extract <code>Triangle</code> from above <code>shapes</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>for _, v := range shapes {\n    fmt.Println(v, \"\\tArea:\", v.Area())\n    if t, ok := v.(Triangle); ok {\n        fmt.Println(\"Angles:\", t.Angles())\n    }\n}\n</code></pre>\n\n<p>Using <code>t, ok := v.(Triangle)</code> we requested type assertions, meaning we asked the compiler to try to convert <code>v</code> of type <code>Shape</code> to type <code>Triangle</code>, so that if it's successful, the <code>ok</code> will be <code>true</code> otherwise <code>false</code>, and then if it is successful call <code>t.Angles()</code> to calculate the triangle's three angles.</p>\n\n<p>This is the output:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>Circle (Radius: 1)  Area: 3.141592653589793\nSquare (Sides: 1.772453)    Area: 3.1415896372090004\nRectangle (Sides: 5, 10)    Area: 50\nTriangle (Sides: 10, 4, 7)  Area: 10.928746497197197\nAngles: [128.68218745348943 18.194872338766785 33.12294020774379]\n</code></pre>\n\n<p>And the whole working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n    shapes := []Shape{\n        Circle{1.0},\n        Square{1.772453},\n        Rectangle{5, 10},\n        Triangle{10, 4, 7},\n    }\n    for _, v := range shapes {\n        fmt.Println(v, \"\\tArea:\", v.Area())\n        if t, ok := v.(Triangle); ok {\n            fmt.Println(\"Angles:\", t.Angles())\n        }\n    }\n}\n\ntype Shape interface {\n    Area() float64\n}\ntype Circle struct {\n    Radius float64\n}\ntype Triangle struct {\n    A, B, C float64 // lengths of the sides of a triangle.\n}\ntype Rectangle struct {\n    A, B float64\n}\ntype Square struct {\n    A float64\n}\n\nfunc (t Circle) Area() float64 {\n    return math.Pi * t.Radius * t.Radius\n}\n\n// Heron's Formula for the area of a triangle\nfunc (t Triangle) Area() float64 {\n    p := (t.A + t.B + t.C) / 2.0 // perimeter half\n    return math.Sqrt(p * (p - t.A) * (p - t.B) * (p - t.C))\n}\nfunc (t Rectangle) Area() float64 {\n    return t.A * t.B\n}\n\nfunc (t Square) Area() float64 {\n    return t.A * t.A\n}\n\nfunc (t Circle) String() string {\n    return fmt.Sprint(\"Circle (Radius: \", t.Radius, \")\")\n}\nfunc (t Triangle) String() string {\n    return fmt.Sprint(\"Triangle (Sides: \", t.A, \", \", t.B, \", \", t.C, \")\")\n}\nfunc (t Rectangle) String() string {\n    return fmt.Sprint(\"Rectangle (Sides: \", t.A, \", \", t.B, \")\")\n}\nfunc (t Square) String() string {\n    return fmt.Sprint(\"Square (Sides: \", t.A, \")\")\n}\n\nfunc (t Triangle) Angles() []float64 {\n    return []float64{angle(t.B, t.C, t.A), angle(t.A, t.C, t.B), angle(t.A, t.B, t.C)}\n}\nfunc angle(a, b, c float64) float64 {\n    return math.Acos((a*a+b*b-c*c)/(2*a*b)) * 180.0 / math.Pi\n}\n</code></pre>\n\n<p>Also see:  </p>\n\n<p><a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">Type assertions</a></p>\n\n<blockquote>\n  <p>For an expression x of interface type and a type T, the primary\n  expression</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>x.(T)  \n</code></pre>\n  \n  <p><strong>asserts that x is not nil and that the value stored in x is of type T. The notation x.(T) is called a type assertion.</strong></p>\n  \n  <p>More precisely, if T is not an interface type, x.(T) asserts that the\n  dynamic type of x is identical to the type T. In this case, T must\n  implement the (interface) type of x; otherwise the type assertion is\n  invalid since it is not possible for x to store a value of type T. If\n  T is an interface type, x.(T) asserts that the dynamic type of x\n  implements the interface T.</p>\n  \n  <p>If the type assertion holds, the value of the expression is the value\n  stored in x and its type is T. <strong>If the type assertion is false, a\n  run-time panic occurs.</strong> In other words, even though the dynamic type of\n  x is known only at run time, the type of x.(T) is known to be T in a\n  correct program.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var x interface{} = 7  // x has dynamic type int and value 7\ni := x.(int)           // i has type int and value 7\n\ntype I interface { m() }\nvar y I\ns := y.(string)        // illegal: string does not implement I (missing method m)\nr := y.(io.Reader)     // r has type io.Reader and y must implement both I and io.Reader\n</code></pre>\n  \n  <p>A type assertion used in an assignment or initialization of the\n  special form</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>v, ok = x.(T)\nv, ok := x.(T)\nvar v, ok = x.(T)\n</code></pre>\n  \n  <p>yields an additional untyped boolean value. The value of ok is true if\n  the assertion holds. Otherwise it is false and the value of v is the\n  zero value for type T. <strong>No run-time panic occurs in this case</strong>.</p>\n</blockquote>\n\n<hr>\n\n<h1>EDIT</h1>\n\n<p><em>Question</em>: What does the assertion <code>x.(T)</code> return when T is an <code>interface{}</code> and not a concrete type?<br>\n<em>Answer</em>:  </p>\n\n<blockquote>\n  <p>It asserts that x is not nil and that the value stored in x is of type T.  </p>\n</blockquote>\n\n<p>E.g. this panics (compile: Success, Run: <code>panic: interface conversion: interface is nil, not interface {}</code>):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nfunc main() {\n    var i interface{} // nil\n    var _ = i.(interface{})\n}\n</code></pre>\n\n<p>And this works (Run: OK):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var i interface{} // nil\n    b, ok := i.(interface{})\n    fmt.Println(b, ok) // &lt;nil&gt; false\n\n    i = 2\n    c, ok := i.(interface{})\n    fmt.Println(c, ok) // 2 true\n\n    //var j int = c // cannot use c (type interface {}) as type int in assignment: need type assertion\n    //fmt.Println(j)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>&lt;nil&gt; false\n2 true\n</code></pre>\n\n<p><strong>NOTE:</strong> here <code>c</code> is of type <code>interface {}</code> and not <code>int</code>.</p>\n\n<p><br>\nSee this working sample code with commented outputs:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    const fm = \"'%T'\\t'%#[1]v'\\t'%[1]v'\\t%v\\n\"\n    var i interface{}\n    b, ok := i.(interface{})\n    fmt.Printf(fm, b, ok) // '&lt;nil&gt;'    '&lt;nil&gt;' '&lt;nil&gt;' false\n\n    i = 2\n    b, ok = i.(interface{})\n    fmt.Printf(fm, b, ok) // 'int'  '2' '2' true\n\n    i = \"Hi\"\n    b, ok = i.(interface{})\n    fmt.Printf(fm, b, ok) // 'string'   '\"Hi\"'  'Hi'    true\n\n    i = new(interface{})\n    b, ok = i.(interface{})\n    fmt.Printf(fm, b, ok) // '*interface {}'    '(*interface {})(0xc042004330)' '0xc042004330'  true\n\n    i = struct{}{}\n    b, ok = i.(interface{})\n    fmt.Printf(fm, b, ok) // 'struct {}'    'struct {}{}'   '{}'    true\n\n    i = fmt.Println\n    b, ok = i.(interface{})\n    fmt.Printf(fm, b, ok) // 'func(...interface {}) (int, error)'   '(func(...interface {}) (int, error))(0x456740)'    '0x456740'  true\n\n    i = Shape.Area\n    b, ok = i.(interface{})\n    fmt.Printf(fm, b, ok) // 'func(main.Shape) float64' '(func(main.Shape) float64)(0x401910)'  '0x401910'  true\n}\n\ntype Shape interface {\n    Area() float64\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3405, "user_id": 7034183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcIEw.jpg?s=128&g=1", "display_name": "Remario", "link": "https://stackoverflow.com/users/7034183/remario"}, "is_accepted": false, "score": 0, "last_activity_date": 1536027315, "creation_date": 1536027315, "answer_id": 52157938, "question_id": 38816843, "link": "https://stackoverflow.com/questions/38816843/explain-type-assertions-in-go/52157938#52157938", "title": "Explain Type Assertions in Go", "body": "<p>A type assertion is the x.(T) notation where x is of interface type and T is a type. Additionally, the actual value stored in x is of type T, and T must satisfy the interface type of x.</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15941, "favorite_count": 29, "accepted_answer_id": 38818437, "answer_count": 3, "score": 39, "last_activity_date": 1560379775, "creation_date": 1470591687, "last_edit_date": 1470605648, "question_id": 38816843, "link": "https://stackoverflow.com/questions/38816843/explain-type-assertions-in-go", "title": "Explain Type Assertions in Go", "body": "<p>I'm reading about type assertions <code>x.(T)</code> in <a href=\"https://rads.stackoverflow.com/amzn/click/com/0134190440\" rel=\"noreferrer\" rel=\"nofollow noreferrer\" title=\"The Go Programming Language\">The Go Programming Language</a> and don't understand them.</p>\n\n<p>I understand that there are different scenarios:</p>\n\n<ul>\n<li>T is a concrete type or an interface</li>\n<li>One (asserted value?) or two (ok) values can be returned</li>\n</ul>\n\n<p>This is what I don't understand:</p>\n\n<ul>\n<li>Why would I use them?</li>\n<li>What exactly do they return?</li>\n</ul>\n\n<p>I have also googled on the topic and still don't understand. </p>\n"}, {"tags": ["go", "travis-ci", "ginkgo"], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 1951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/404a9144a9a673dc754bdacd56d25f6f?s=128&d=identicon&r=PG", "display_name": "morras", "link": "https://stackoverflow.com/users/1951414/morras"}, "is_accepted": true, "score": 0, "last_activity_date": 1470938805, "creation_date": 1470938805, "answer_id": 38903305, "question_id": 38816090, "link": "https://stackoverflow.com/questions/38816090/ginkgo-does-not-provide-coverage-in-travis-ci/38903305#38903305", "title": "Ginkgo does not provide coverage in Travis CI", "body": "<p>I finally got it to work after I ran the travis build locally through their docker image. For some reason I need to specify which package to cover, so the ginkgo command has been changed into </p>\n\n<pre><code>ginkgo -r --randomizeAllSpecs --randomizeSuites --failOnPending --coverpkg gitserver --trace --race --compilers=2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1348, "user_id": 1363520, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dd01041b737eca45a9c5d01d234d3b9c?s=128&d=identicon&r=PG", "display_name": "Som Poddar", "link": "https://stackoverflow.com/users/1363520/som-poddar"}, "is_accepted": false, "score": 0, "last_activity_date": 1541181982, "creation_date": 1541181982, "answer_id": 53123759, "question_id": 38816090, "link": "https://stackoverflow.com/questions/38816090/ginkgo-does-not-provide-coverage-in-travis-ci/53123759#53123759", "title": "Ginkgo does not provide coverage in Travis CI", "body": "<p>The following command seems to work for me.</p>\n\n<pre><code>ginkgo  -r --randomizeAllSpecs --randomizeSuites --cover --race --trace\n</code></pre>\n\n<p>If you like to know more, look at <a href=\"http://onsi.github.io/ginkgo/#ginkgo-and-continuous-integration\" rel=\"nofollow noreferrer\">the documentation here</a>. </p>\n"}], "owner": {"reputation": 781, "user_id": 1951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/404a9144a9a673dc754bdacd56d25f6f?s=128&d=identicon&r=PG", "display_name": "morras", "link": "https://stackoverflow.com/users/1951414/morras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 38903305, "answer_count": 2, "score": 1, "last_activity_date": 1541181982, "creation_date": 1470586562, "last_edit_date": 1470680327, "question_id": 38816090, "link": "https://stackoverflow.com/questions/38816090/ginkgo-does-not-provide-coverage-in-travis-ci", "title": "Ginkgo does not provide coverage in Travis CI", "body": "<p>I have a GO project which I build in Travis CI.\nI have implemented a few tests with Ginkgo, and I am getting code coverage when I run it locally, however I get no coverage when I run it on Travis.</p>\n\n<p>My .travis.yml</p>\n\n<pre><code>language: go\n\n# safelist\nbranches:\n  only:\n  - master\n  - travis\n\nbefore_install:\n  - go get github.com/onsi/gomega\n  - go get github.com/onsi/ginkgo/ginkgo\n  - go get github.com/modocache/gover\n\nscript:\n  - ginkgo -r --randomizeAllSpecs --randomizeSuites --failOnPending --cover --trace --race --compilers=2\n\nafter_success:\n  - gover . coverage.txt\n  - ls -al\n  - cat coverage.txt\n  - bash &lt;(curl -s https://codecov.io/bash)\n</code></pre>\n\n<p>When I run the script command on my own machine I get the following result </p>\n\n<pre><code>$ ginkgo -r --randomizeAllSpecs --randomizeSuites --failOnPending --cover --trace --race --compilers=2\nRunning Suite: Gitserver Suite\n==============================\nRandom Seed: 1470431018 - Will randomize all specs\nWill run 4 of 4 specs\n\n++++\nRan 4 of 4 Specs in 0.000 seconds\nSUCCESS! -- 4 Passed | 0 Failed | 0 Pending | 0 Skipped PASS\ncoverage: 25.9% of statements\n\nGinkgo ran 1 suite in 4.411023s\nTest Suite Passed\n</code></pre>\n\n<p>But on travis CI the coverage says \"0.0% of statement\"</p>\n\n<p>I have tried to setup a new GOPATH on my local machine to get a clean setup and only run the commands that occurs in the Travis log, and I still get a reported 25% coverage. My machine is running windows where as Travis is linux, that is the only difference I can think of right now.</p>\n\n<p>I have just tried GoCover.io on my package, and that also gives me the 25% coverage that I get locally.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 2, "creation_date": 1470579845, "post_id": 38815005, "comment_id": 64997374, "body": "Do you mean &quot;test functions by reflection&quot; as I did 3 years ago? (<a href=\"http://stackoverflow.com/q/20823836/6309\">stackoverflow.com/q/20823836/6309</a>)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1470580877, "post_id": 38815005, "comment_id": 64997725, "body": "Related / possible duplicates: 1. <a href=\"http://stackoverflow.com/questions/37384473/call-all-functions-with-special-prefix-or-suffix-in-golang\">Call all functions with special prefix or suffix in Golang</a>; 2. <a href=\"http://stackoverflow.com/questions/18017979/golang-pointer-to-function-from-string-functions-name\">Golang: pointer to function from string (function&#39;s name)</a>"}, {"owner": {"reputation": 97669, "user_id": 707381, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/439db9ac83f4ea14a904390900ec6634?s=128&d=identicon&r=PG", "display_name": "Randomblue", "link": "https://stackoverflow.com/users/707381/randomblue"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1470581216, "post_id": 38815005, "comment_id": 64997828, "body": "@VonC: I want to avoid manually listing the functions <code>var funcNames = []string{&quot;Func1&quot;, &quot;Func2&quot;, &quot;Func3&quot;}</code>"}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470585497, "post_id": 38815005, "comment_id": 64999043, "body": "This says &quot;no&quot;: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/9Di5eHK2eQ0\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/9Di5eHK2eQ0</a>"}], "owner": {"reputation": 97669, "user_id": 707381, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/439db9ac83f4ea14a904390900ec6634?s=128&d=identicon&r=PG", "display_name": "Randomblue", "link": "https://stackoverflow.com/users/707381/randomblue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1470579311, "creation_date": 1470579311, "question_id": 38815005, "link": "https://stackoverflow.com/questions/38815005/iterate-over-imported-package-functions", "title": "Iterate over imported package functions", "body": "<p>I have a package with many functions. I want to test all those functions simultaneously for error handling, because the error handling is common to those functions.</p>\n\n<p>Is there a way to iterate over the imported functions within my test file?</p>\n"}, {"tags": ["go", "struct", "embedding"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1470569038, "post_id": 38811253, "comment_id": 64994513, "body": "You can use User as that type.  <code>if user &gt; 0 ...</code> as an example.  If the primitive had methods, those would be promoted as well."}, {"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1470571289, "post_id": 38811253, "comment_id": 64995059, "body": "@eduncan911 can you paste a sample code? I was not able to do this on the Go Playground."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 2, "creation_date": 1470573079, "post_id": 38811253, "comment_id": 64995534, "body": "@eduncan911 No, you can&#39;t do that: <code>u &gt; int32(0)</code> results in <code>invalid operation: u &gt; int32(0) (mismatched types User and int32)</code>"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1470600432, "post_id": 38811253, "comment_id": 65003068, "body": "Ah, that&#39;s right. U still need to access the property by name: <a href=\"https://play.golang.org/p/mIk_7ewRkN\" rel=\"nofollow noreferrer\">play.golang.org/p/mIk_7ewRkN</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21589, "user_id": 4875631, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Goodbye StackExchange", "link": "https://stackoverflow.com/users/4875631/goodbye-stackexchange"}, "edited": false, "score": 1, "creation_date": 1470549333, "post_id": 38811323, "comment_id": 64990464, "body": "Interesting use of the &#39;&lt;kbd&gt;&#39; tags"}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470654365, "post_id": 38811323, "comment_id": 65020798, "body": "Interestingly, primitive types that contains spaces or symbols (arrays / slices, maps, channels) cannot be embedded in this way, a &quot;typedef&quot; (type declaration) is needed, like <code>type MapStringInt map[string]int</code> or <code>type RecvChanInt &lt;-chan int</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470654931, "post_id": 38811323, "comment_id": 65021156, "body": "@SiuChingPong-AsukaKenji- That&#39;s actually the consequence of that the unqualified type name &quot;becomes&quot; the field name, and characters such as <code>[ ] &lt; -</code> are not allowed in <a href=\"https://golang.org/ref/spec#Identifiers\" rel=\"nofollow noreferrer\">identifiers</a>."}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470655135, "post_id": 38811323, "comment_id": 65021279, "body": "Yup, I noticed that. But sadly, only the &quot;methods&quot; of the anonymous fields are promoted, not the &quot;operators&quot;. So, even if an anonymous <code>RecvChanInt</code> (a.k.a. <code>&lt;-chan int</code>) is embedded in <code>User</code> above, one still cannot do <code>&lt;- u</code>, but only <code>&lt;- u.RecvChanInt</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470655273, "post_id": 38811323, "comment_id": 65021364, "body": "@SiuChingPong-AsukaKenji- And that is because it would be <i>ambiguous</i>. Imagine you embed 2 channels (2 different types with channels as underlying types), and you write <code>&lt;- u</code>. Which channel would that mean?"}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470655619, "post_id": 38811323, "comment_id": 65021578, "body": "The same problem (ambiguity) also exists in the current embedding, so allowing that does NOT make it worse: <a href=\"https://play.golang.org/p/tBaNUbCXbF\" rel=\"nofollow noreferrer\">play.golang.org/p/tBaNUbCXbF</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470656086, "post_id": 38811323, "comment_id": 65021885, "body": "@SiuChingPong-AsukaKenji- True. I revise my comment: it&#39;s not allowed because the operand of the receive operator must be of channel type, and a struct is clearly not one of those."}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470657465, "post_id": 38811323, "comment_id": 65022765, "body": "Yes, of course, in the current Go language. As I said, [[But sadly, only the &quot;methods&quot; of the anonymous fields are promoted, not the &quot;operators&quot;.]]. It would be nice if this is allowed, since one of the most wanted features is doing a <code>range</code> on a custom type."}, {"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "reply_to_user": {"reputation": 21589, "user_id": 4875631, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Goodbye StackExchange", "link": "https://stackoverflow.com/users/4875631/goodbye-stackexchange"}, "edited": false, "score": 0, "creation_date": 1471593374, "post_id": 38811323, "comment_id": 65417512, "body": "@FrankerZ This use has been long ago declared to be very incorrect: <a href=\"http://meta.stackexchange.com/questions/181774/stricter-kbd-usage-rules\" title=\"stricter kbd usage rules\">meta.stackexchange.com/questions/181774/&hellip;</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1471595107, "post_id": 38811323, "comment_id": 65418489, "body": "@DenysS&#233;guret I didn&#39;t know about that. Thanks for letting me know."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1471593396, "last_edit_date": 1471593396, "creation_date": 1470549118, "answer_id": 38811323, "question_id": 38811253, "link": "https://stackoverflow.com/questions/38811253/go-embedding-a-primitive-type/38811323#38811323", "title": "Go: Embedding a primitive type?", "body": "<p>The type <code>int32</code> is a <a href=\"https://golang.org/ref/spec#Predeclared_identifiers\" rel=\"nofollow\">predeclared type</a>, it has no methods. To verify:</p>\n\n<pre><code>fmt.Println(reflect.TypeOf(int32(0)).NumMethod()) // Prints 0\n</code></pre>\n\n<p>You can refer to all embedded fields by using the unqualified type name as the field name (<a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">Spec: Struct types</a>), predeclared types are no exception. See this example:</p>\n\n<pre><code>u := User{3, \"Bob\"}\nfmt.Printf(\"%#v\\n\", u)\nu.int32 = 4\nfmt.Println(u.int32)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/SVNgV3FE81\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>main.User{int32:3, Name:\"Bob\"}\n4\n</code></pre>\n\n<p>Primary gain of using embedding is:</p>\n\n<ul>\n<li><p>methods of the embedded type get promoted, so it's easier to implement interfaces (you don't need to provide methods that get promoted)</p></li>\n<li><p>you can \"override\" methods of the embedded type (on the embedder type): provide your own implementation which will be called when a value of your embedder type is used</p></li>\n<li><p>and fields of the embedded type get promoted, so code is shorter to refer to promoted fields (field name is left out).</p></li>\n</ul>\n\n<p>By embedding predeclared types such as <code>int32</code>, you don't get any advantage over using just a regular field (<em>named</em>, not embedded field), as the <code>int32</code> type doesn't have any methods or fields.</p>\n\n<p>Going forward, besides not having any advantage, you even have a disadvantage. Since predeclared type names start with lowercased letters, embedding them implicitly makes them <em>unexported</em>, so you can only refer to them in the declaring package of the embedder type. If you make them regular, <em>named</em> fields, you may choose to use an uppercased name to make it exported, or a lowercased name to make it unexported.</p>\n"}], "owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1062, "favorite_count": 1, "accepted_answer_id": 38811323, "answer_count": 1, "score": 3, "last_activity_date": 1471593396, "creation_date": 1470548443, "last_edit_date": 1470550477, "question_id": 38811253, "link": "https://stackoverflow.com/questions/38811253/go-embedding-a-primitive-type", "title": "Go: Embedding a primitive type?", "body": "<p>Suppose we have this piece of code:</p>\n\n<pre><code>type User struct {\n    int32\n    Name string\n}\n</code></pre>\n\n<p>Can this type of embedding be useful?<br>\nDoes <code>int32</code> have any methods which other can call on instances of <code>User</code>?<br>\nHow can I access the value of the <code>int32</code> that <code>User</code> is embedding?</p>\n"}, {"tags": ["sql", "database", "go"], "answers": [{"tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": false, "score": 3, "last_activity_date": 1470562487, "last_edit_date": 1470562487, "creation_date": 1470562034, "answer_id": 38812731, "question_id": 38811056, "link": "https://stackoverflow.com/questions/38811056/how-to-determine-name-of-database-driver-im-using/38812731#38812731", "title": "How to determine name of database driver I&#39;m using?", "body": "<p>Give your database string in url format like <code>postgres://postgres@localhost:5432/db_name?sslmode=disable</code>.</p>\n\n<p>And then find the database type you are using Parse function of url package. Based on the database type, run db specific queries.</p>\n\n<pre><code>func New(url string) (Driver, error) {\n    u, err := neturl.Parse(url)\n    if err != nil {\n        return nil, err\n    }\n\n    switch u.Scheme {\n    case \"postgres\":\n        d := &amp;postgres.Driver{}\n        if err := d.Initialize(url); err != nil {\n            return nil, err\n        }\n        return d, nil\n\n    case \"mysql\":\n        d := &amp;mysql.Driver{}\n        if err := d.Initialize(url); err != nil {\n            return nil, err\n        }\n        return d, nil\n\n    case \"bash\":\n        d := &amp;bash.Driver{}\n        if err := d.Initialize(url); err != nil {\n            return nil, err\n        }\n        return d, nil\n\n    case \"cassandra\":\n        d := &amp;cassandra.Driver{}\n        if err := d.Initialize(url); err != nil {\n            return nil, err\n        }\n        return d, nil\n    case \"sqlite3\":\n        d := &amp;sqlite3.Driver{}\n        if err := d.Initialize(url); err != nil {\n            return nil, err\n        }\n        return d, nil\n    default:\n        return nil, errors.New(fmt.Sprintf(\"Driver '%s' not found.\", u.Scheme))\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 1, "last_activity_date": 1470562196, "creation_date": 1470562196, "answer_id": 38812753, "question_id": 38811056, "link": "https://stackoverflow.com/questions/38811056/how-to-determine-name-of-database-driver-im-using/38812753#38812753", "title": "How to determine name of database driver I&#39;m using?", "body": "<p>You should already know the name of the database driver because its represented by the parameter you identified with the <code>dbstr</code> variable.</p>\n\n<pre><code>db, err := sql.Open(\"postgres\", \"user= ... \")\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p><code>db.Driver()</code> correctly returns the underlying driver in use, but you are formatting it as <code>string</code> (because of <code>%s</code>). If you change <code>%s</code> with <code>%T</code> you will see that it correctly prints out the type:</p>\n\n<pre><code>log.Printf(\"%T\\n\", db.Driver())\n</code></pre>\n\n<p>For example, if you use <code>github.com/lib/pq</code>, the output is <code>*pq.drv</code>. This is the same of using the <code>reflect</code> package:</p>\n\n<pre><code>log.Printf(\"%s\\n\", reflect.TypeOf(db.Driver()))\n</code></pre>\n\n<p>It may be impractical to use that value for performing conditional executions. Moreover, the <code>Driver</code> interface doesn't specify any way to get the specific driver information, except the <code>Open()</code> function.</p>\n\n<p>If you have specific needs, you may want to either use the driver name passed when you open the connection, or create specific drivers that delegate to the original ones and handle your custom logic.</p>\n"}], "owner": {"reputation": 21, "user_id": 6687213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78059aa7ec73472b61c95d8cd070fe6f?s=128&d=identicon&r=PG&f=1", "display_name": "user6687213", "link": "https://stackoverflow.com/users/6687213/user6687213"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1470562487, "creation_date": 1470546315, "question_id": 38811056, "link": "https://stackoverflow.com/questions/38811056/how-to-determine-name-of-database-driver-im-using", "title": "How to determine name of database driver I&#39;m using?", "body": "<p>In code which tries to be database agnostic, I would like to perform some database specific queries, so I need to know name of Database Driver in Go language:</p>\n\n<pre><code>   db,err := sql.Open(dbstr, dbconnstr)\n    if err != nil {\n            log.Fatal(err)\n    }\n    errp := db.Ping()\n    if errp != nil {\n            log.Fatal(errp)\n    }\n    log.Printf(\"%s\\n\", db.Driver())\n</code></pre>\n\n<p>How I can determine name of database driver I'm using?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1470539997, "post_id": 38810507, "comment_id": 64989120, "body": "Please edit the question to include the exact command that you are running."}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1470541274, "post_id": 38810507, "comment_id": 64989260, "body": "I have added the commands"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 2, "creation_date": 1470543387, "post_id": 38810507, "comment_id": 64989580, "body": "@deltaskelta: Also useful: <a href=\"http://stackoverflow.com/questions/30612611/what-does-go-build-build\" title=\"what does go build build\">stackoverflow.com/questions/30612611/what-does-go-build-buil&zwnj;&#8203;d</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1470542200, "post_id": 38810688, "comment_id": 64989372, "body": "I see. I totally misread the helloworld program install instructions. Thanks"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1470541673, "creation_date": 1470541673, "answer_id": 38810688, "question_id": 38810507, "link": "https://stackoverflow.com/questions/38810507/go-install-fails-if-i-am-outside-of-the-go-file-directory/38810688#38810688", "title": "go install fails if I am outside of the .go file directory", "body": "<p>The arguments to the <code>go install</code> command are packages, not .go files. Use these commands to specify the package by relative path.  </p>\n\n<p>For the package containing the file ./src/tutorial/helloworld/hello.go:</p>\n\n<pre><code>go install ./src/tutorial/helloworld\n</code></pre>\n\n<p>For the package containing the file ./path/to/.go/file/hello.go:</p>\n\n<pre><code>go install ./path/to/.go/file\n</code></pre>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1458, "favorite_count": 0, "accepted_answer_id": 38810688, "answer_count": 1, "score": 0, "last_activity_date": 1470543280, "creation_date": 1470539082, "last_edit_date": 1470543280, "question_id": 38810507, "link": "https://stackoverflow.com/questions/38810507/go-install-fails-if-i-am-outside-of-the-go-file-directory", "title": "go install fails if I am outside of the .go file directory", "body": "<p>I installed Golang via the suggestion <a href=\"https://golang.org/doc/install\" rel=\"nofollow\">https://golang.org/doc/install</a> and it seems I cannot run the <code>go install</code> command like they do on the website</p>\n\n<p>If I run the command from any directory besides the directory that is home to the <code>.go</code> file, then it gives me this error. for example:</p>\n\n<pre><code>go install ./src/tutorial/helloworld/hello.go\n</code></pre>\n\n<p>or </p>\n\n<pre><code>go install ./path/to/.go/file/hello.go\n\ngo install: no install location for .go files listed on command line (GOBIN not set)\n</code></pre>\n\n<p>but if I run the install from inside the directory that has the <code>.go</code> file everything goes well and it places the final executable in the <code>GOPATH</code> <code>bin</code> folder. </p>\n\n<pre><code>//In the folder that contains my .go file\ngo install\n</code></pre>\n\n<p>I have set <code>GOPATH</code> in my <code>.bash_profile</code> and the go installation added the go root directory in <code>/usr/local/go/bin</code> to my <code>PATH</code></p>\n\n<p>Any ideas why I cannot run install from outside the directory like the instructions on the golang.org website says?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1470542042, "post_id": 38809664, "comment_id": 64989351, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3387273/how-to-implement-resizable-arrays-in-go\">How to implement resizable arrays in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "edited": false, "score": 0, "creation_date": 1470750575, "post_id": 38809715, "comment_id": 65069300, "body": "Thanks. Works perfect."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 2, "last_activity_date": 1470528137, "creation_date": 1470528137, "answer_id": 38809715, "question_id": 38809664, "link": "https://stackoverflow.com/questions/38809664/how-to-adjust-the-size-of-two-dimensional-array-in-go/38809715#38809715", "title": "How to adjust the size of two-dimensional array in Go?", "body": "<p>Try <a href=\"https://play.golang.org/p/3c8IJ5SDwy\" rel=\"nofollow\">this variation</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    const input = \"#FooBar1\\nFooBar1\\n#Foobar2\\nFooBar2\\n#FooBar3\\nFooBar3\"\n\n    var multiDimArr [][2]string\n\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    for scanner.Scan() {\n        if strings.HasPrefix(scanner.Text(), \"#\") {\n            firstLine := scanner.Text()\n            scanner.Scan()\n            secondLine := scanner.Text()\n            multiDimArr = append(multiDimArr, [2]string{firstLine, secondLine})\n        }\n    }\n    for i, row := range multiDimArr {\n        for j, line := range row {\n            fmt.Printf(\"multiDimArr[%d][%d] = %s\\n\", i, j, line)\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "edited": false, "score": 0, "creation_date": 1470750488, "post_id": 38810692, "comment_id": 65069233, "body": "Thanks. I don&#39;t have much experience with Go yet. Are these two examples more or less effective and idiomatic compared to that posted by Amit Kumar Gupta?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "edited": false, "score": 0, "creation_date": 1470752452, "post_id": 38810692, "comment_id": 65070784, "body": "@JohnSmith: Yes, the first sample code is similar to that post, except I checked the <code>r.Scan()</code> returns true or not, but he needs to check it ( in second <code>scanner.Scan()</code> he didn&#39;t (but should)), so if  the  second <code>scanner.Scan()</code>  returns false that code fails."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1470743934, "last_edit_date": 1470743934, "creation_date": 1470541723, "answer_id": 38810692, "question_id": 38809664, "link": "https://stackoverflow.com/questions/38809664/how-to-adjust-the-size-of-two-dimensional-array-in-go/38810692#38810692", "title": "How to adjust the size of two-dimensional array in Go?", "body": "<p>Use this Slice: <code>[][2]string{}</code> , so you don't need to count the number of lines of input:  </p>\n\n<p>Try this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"bufio\"\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    const input = \"#FooBar1\\nFooBar1\\n#Foobar2\\nFooBar2\\n#FooBar3\\nFooBar3\"\n    multiDimArr := [][2]string{}\n    for i, r := 0, bufio.NewScanner(strings.NewReader(input)); r.Scan(); i++ {\n        line1 := r.Text()\n        if !strings.HasPrefix(line1, \"#\") || !r.Scan() {\n            break\n        }\n        multiDimArr = append(multiDimArr, [2]string{line1, r.Text()})\n    }\n    fmt.Println(multiDimArr)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[[#FooBar1 FooBar1] [#Foobar2 FooBar2] [#FooBar3 FooBar3]]\n</code></pre>\n\n<hr>\n\n<p>Also you may use this working sample code if you need to pre scan input to count the number of lines, using <code>multiDimArr := make([][2]string, n)</code> makes this slice  <code>[][2]string</code> with <code>length = capacity = n</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"bufio\"\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    const input = \"#FooBar1\\nFooBar1\\n#Foobar2\\nFooBar2\\n#FooBar3\\nFooBar3\"\n    n := 0\n    for r := bufio.NewScanner(strings.NewReader(input)); r.Scan() &amp;&amp; strings.HasPrefix(r.Text(), \"#\") &amp;&amp; r.Scan(); n++ {\n    }\n    multiDimArr := make([][2]string, n)\n    for i, r := 0, bufio.NewScanner(strings.NewReader(input)); r.Scan(); i++ {\n        line1 := r.Text()\n        if !strings.HasPrefix(line1, \"#\") || !r.Scan() {\n            break\n        }\n        multiDimArr[i] = [2]string{line1, r.Text()}\n    }\n    fmt.Println(multiDimArr)\n}\n</code></pre>\n\n<p>Output:  </p>\n\n<pre><code>[[#FooBar1 FooBar1] [#Foobar2 FooBar2] [#FooBar3 FooBar3]]\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow\">Array types</a>:</p>\n\n<blockquote>\n  <p>The length is part of the array's type; it must evaluate to a\n  non-negative <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow\">constant</a> representable by a value of type int.</p>\n</blockquote>\n\n<p>So you can't use array because its length is constant, using <code>multiDimArr := [n][2]string{}</code> makes compile time error: <code>non-constant array bound n</code>:  </p>\n\n<pre><code>n := preScan(input) \n//multiDimArr := [n][2]string{} // error: non-constant array bound n\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470744323, "creation_date": 1470527241, "last_edit_date": 1470744323, "question_id": 38809664, "link": "https://stackoverflow.com/questions/38809664/how-to-adjust-the-size-of-two-dimensional-array-in-go", "title": "How to adjust the size of two-dimensional array in Go?", "body": "<p>I have written a program that reads input lines and checks if a line begins with <code>#</code>.<br>\nIf so, the current line and the next one will be saved in two columns in the same row in a two-dimensional array:</p>\n\n<p><a href=\"https://play.golang.org/p/vZ2kNrni9i\" rel=\"nofollow\">Go Playground</a></p>\n\n<pre><code>package main\n\nimport (\n        \"bufio\"\n        \"fmt\"\n        \"strings\"\n)\n\nfunc main() {\n        const input = \"#FooBar1\\nFooBar1\\n#Foobar2\\nFooBar2\\n#FooBar3\\nFooBar3\"\n\n        var multiDimArr [3][2]string\n        var lineCount int\n\n        scanner := bufio.NewScanner(strings.NewReader(input))\n        for line := 0; scanner.Scan(); line++ {\n                if strings.HasPrefix(scanner.Text(), \"#\") {\n                        multiDimArr[line][0] = scanner.Text()\n                        scanner.Scan()\n                        multiDimArr[line][1] = scanner.Text()\n                        lineCount++\n                }\n        }\n        for i := 0; i &lt; lineCount; i++ {\n                for j := 0; j &lt; 2; j++ {\n                        fmt.Printf(\"multiDimArr[%d][%d] = %s\\n\", i, j, multiDimArr[i][j])\n                }\n        }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>multiDimArr[0][0] = #FooBar1\nmultiDimArr[0][1] = FooBar1\nmultiDimArr[1][0] = #Foobar2\nmultiDimArr[1][1] = FooBar2\nmultiDimArr[2][0] = #FooBar3\nmultiDimArr[2][1] = FooBar3\n</code></pre>\n\n<p>My problem is that I need to know the number of lines in the input when building the program, so I can adjust the size of <code>multiDimArr</code>.</p>\n\n<p>Can I do anything to make it take any number of lines?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 4840, "user_id": 622440, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf638dd0a3f0786c42d681689ffc35e?s=128&d=identicon&r=PG", "display_name": "Domenic D.", "link": "https://stackoverflow.com/users/622440/domenic-d"}, "edited": false, "score": 0, "creation_date": 1472731380, "post_id": 38809347, "comment_id": 65876356, "body": "This ended up being a defect in the Amazon code which has since been corrected and released."}], "answers": [{"comments": [{"owner": {"reputation": 4840, "user_id": 622440, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf638dd0a3f0786c42d681689ffc35e?s=128&d=identicon&r=PG", "display_name": "Domenic D.", "link": "https://stackoverflow.com/users/622440/domenic-d"}, "edited": false, "score": 0, "creation_date": 1470844736, "post_id": 38877591, "comment_id": 65117847, "body": "I tried that modification, but still seeing: <code>If-Modified-Since: Mon, 1 Jan 0001 00:00:00 GMT</code>"}, {"owner": {"reputation": 4840, "user_id": 622440, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf638dd0a3f0786c42d681689ffc35e?s=128&d=identicon&r=PG", "display_name": "Domenic D.", "link": "https://stackoverflow.com/users/622440/domenic-d"}, "edited": false, "score": 0, "creation_date": 1470844841, "post_id": 38877591, "comment_id": 65117908, "body": "FWIW, their tests don&#39;t address the IfModifiedSince header. I do have an open ticket with AWS."}, {"owner": {"reputation": 103, "user_id": 5235763, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MT8m38bvWls/AAAAAAAAAAI/AAAAAAAAAWc/sIY7wBDDXYk/photo.jpg?sz=128", "display_name": "Nathaniel Dean", "link": "https://stackoverflow.com/users/5235763/nathaniel-dean"}, "reply_to_user": {"reputation": 4840, "user_id": 622440, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf638dd0a3f0786c42d681689ffc35e?s=128&d=identicon&r=PG", "display_name": "Domenic D.", "link": "https://stackoverflow.com/users/622440/domenic-d"}, "edited": false, "score": 0, "creation_date": 1470844987, "post_id": 38877591, "comment_id": 65118007, "body": "Sorry... tried my best. Good luck with that ticket! Let me know how it goes."}], "tags": [], "owner": {"reputation": 103, "user_id": 5235763, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MT8m38bvWls/AAAAAAAAAAI/AAAAAAAAAWc/sIY7wBDDXYk/photo.jpg?sz=128", "display_name": "Nathaniel Dean", "link": "https://stackoverflow.com/users/5235763/nathaniel-dean"}, "is_accepted": false, "score": 0, "last_activity_date": 1470842585, "creation_date": 1470842585, "answer_id": 38877591, "question_id": 38809347, "link": "https://stackoverflow.com/questions/38809347/how-to-set-if-modified-since-header-in-aws-s3-using-go/38877591#38877591", "title": "How to set If-Modified-Since header in AWS S3 using Go", "body": "<p>Try this simplification:</p>\n\n<pre><code>var t time.Time\nif fi, err2 := os.Stat(finalFilePath); err2 == nil {\n    t := fi.ModTime()\n}\n</code></pre>\n\n<p>and later:</p>\n\n<pre><code>params := &amp;s3.GetObjectInput{Bucket: aws.String(bucket),\n    Key:    aws.String(filename),\n    IfModifiedSince: aws.Time(t)}\n</code></pre>\n\n<p>...as suggested in the example code here: <a href=\"https://github.com/aws/aws-sdk-go/blob/f1e26250235022af782521266389e4b2ae2945e4/service/s3/examples_test.go#L975\" rel=\"nofollow\">https://github.com/aws/aws-sdk-go/blob/f1e26250235022af782521266389e4b2ae2945e4/service/s3/examples_test.go#L975</a></p>\n\n<p>At first I thought it was an erasure issue, but after testing, I find that the <code>time.Time</code> value that <code>t</code> was pointing to escapes the block (which honestly surprised me). Maybe there's some other bug happening in between the two, but I would assume that since their tests are passing, this should work.</p>\n"}], "owner": {"reputation": 4840, "user_id": 622440, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf638dd0a3f0786c42d681689ffc35e?s=128&d=identicon&r=PG", "display_name": "Domenic D.", "link": "https://stackoverflow.com/users/622440/domenic-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 857, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470842585, "creation_date": 1470522949, "question_id": 38809347, "link": "https://stackoverflow.com/questions/38809347/how-to-set-if-modified-since-header-in-aws-s3-using-go", "title": "How to set If-Modified-Since header in AWS S3 using Go", "body": "<p>I have a function to download a file from S3. It works but does not recognize the IfModifiedSince option. The below function looks for the same named file locally, and if present sets a time.Time object to the Modification date and time. That is then used in the request to S3 to only download the file if it has been modified since then.</p>\n\n<pre><code>func DownloadS3Media(filename string, mediaDirectory string, bucket string, c *configuration.Configuration) (dest string, bytes int64, err error) {\n    os.Setenv(\"AWS_ACCESS_KEY_ID\", c.AWS_ACCESS_KEY_ID)\n    os.Setenv(\"AWS_SECRET_ACCESS_KEY\", c.AWS_SECRET_ACCESS_KEY)\n\n    // Create the directories in the path\n    finalFilePath := filepath.Join(mediaDirectory, filename)\n    if err1 := os.MkdirAll(filepath.Dir(finalFilePath), 0775); err1 != nil {\n        return \"\", 0, err1\n    }\n\n    //Create the blank file to push the data into\n    var t *time.Time\n    if fi, err2 := os.Stat(finalFilePath); err2 == nil {\n        t1 := fi.ModTime()\n        t = &amp;t1\n    }\n    tempFilePath := filepath.Join(mediaDirectory, filename + \".tmp\")\n    tempFile, err3 := os.Create(tempFilePath)\n    if err3 != nil {\n        log.Println(\"Failed to create file\", err3)\n        return finalFilePath, 0, err3\n    }\n    defer tempFile.Close()\n\n    logLevel := aws.LogDebug\n    downloader := s3manager.NewDownloader(session.New(&amp;aws.Config{Region: aws.String(\"us-east-1\"), LogLevel:&amp;logLevel}))\n    params := &amp;s3.GetObjectInput{Bucket: aws.String(bucket),\n        Key:    aws.String(filename),\n        IfModifiedSince: t}\n    numBytes, err4 := downloader.Download(tempFile, params)\n    if err4 != nil {\n        log.Println(\"Failed to download file\", err4)\n        return finalFilePath, 0, err4\n    }\n\n    //if downloader pulled down the file, rename the tmp file to original.\n    if _, err5 := os.Stat(tempFilePath); err5 == nil {\n        os.Rename(tempFilePath, finalFilePath)\n        log.Println(\"Renamed \", tempFilePath, \"to\", finalFilePath)\n    }\n\n    log.Println(\"Downloaded file\", filename, \"to\", finalFilePath, numBytes, \"bytes\")\n    return finalFilePath, numBytes, nil\n}\n</code></pre>\n\n<p>When debugging, I see the proper value for &amp;t which is \ufeffsomething like <code>sec: 63606119179</code>. By the time AWS sends the request, the header is present but is set to 1/1/0001.</p>\n\n<pre><code>---[ REQUEST POST-SIGN ]-----------------------------\nGET http://*****.s3.amazonaws.com/domenic-test.png HTTP/1.1\nHost: *****.s3.amazonaws.com\nUser-Agent: aws-sdk-go/1.3.1 (go1.6.3; darwin; amd64) S3Manager\nAuthorization: AWS4-HMAC-SHA256 Credential= *****/20160806/us-east-1/s3/aws4_request, SignedHeaders=host;if-modified-since;range;x-amz-content-sha256;x-amz-date, Signature= *****\nIf-Modified-Since: Mon, 1 Jan 0001 00:00:00 GMT\nRange: bytes=0-5242879\nX-Amz-Content-Sha256: *****\nX-Amz-Date: 20160806T223302Z\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "geospatial", "geo"], "answers": [{"tags": [], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "is_accepted": true, "score": 1, "last_activity_date": 1471545735, "creation_date": 1471545735, "answer_id": 39025396, "question_id": 38809218, "link": "https://stackoverflow.com/questions/38809218/appengine-geospatial-queries-under-go/39025396#39025396", "title": "AppEngine: Geospatial queries under Go", "body": "<p>It's, officially, completely unsupported in Datastore at this time. Use geohashes: <a href=\"https://github.com/gansidui/geohash/blob/master/geohash.go\" rel=\"nofollow\">https://github.com/gansidui/geohash/blob/master/geohash.go</a> . It reduces this fro ma geospatial-storage/RTREE support problem to a string prefix-search.</p>\n\n<p>It allows you derive a hash that describes a particular location, and then you can take this string and successively remove characters from the right side (and do string prefix-searches against your list of places and <em>their</em> geohashes with what remains) to find places near your principal location and expanding outward. </p>\n\n<p>There is a predictable amount of geographic precision between each adjacent character of a geohash string, so you can either use this or the common prefix bytes between the principal point and the corner latitude/longitude of the map window to identify all places that should appear within it.</p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 39025396, "answer_count": 1, "score": 0, "last_activity_date": 1472922393, "creation_date": 1470521866, "last_edit_date": 1472922393, "question_id": 38809218, "link": "https://stackoverflow.com/questions/38809218/appengine-geospatial-queries-under-go", "title": "AppEngine: Geospatial queries under Go", "body": "<p>There appears to be geospatial-query support under Java (<a href=\"https://cloud.google.com/appengine/docs/java/datastore/geosearch\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/java/datastore/geosearch</a>) but there appears to be absolutely no documentation for doing the same under Go. Grepping google.golang.org/appengine for \"geo\" renders nothing but construction and validation of <em>GeoPoint</em> values.</p>\n\n<p>Since Java supports this the API support must obviously be there. Does anyone have any experience with this or advice? Thanks.</p>\n\n<p>Edit:</p>\n\n<p>It looks like what limited support there is is only offered for Java:</p>\n\n<p><a href=\"http://startup-with-gae.blogspot.com/2016/01/geospatial-queries-with-google-cloud.html\" rel=\"nofollow\">http://startup-with-gae.blogspot.com/2016/01/geospatial-queries-with-google-cloud.html</a></p>\n"}, {"tags": ["json", "go", "struct", "tags"], "comments": [{"owner": {"reputation": 4457, "user_id": 141023, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/18431ffe70f2e333b8d29d7664171ac4?s=128&d=identicon&r=PG", "display_name": "cheshirekow", "link": "https://stackoverflow.com/users/141023/cheshirekow"}, "edited": false, "score": 1, "creation_date": 1576040922, "post_id": 38809137, "comment_id": 104765012, "body": "Voting to re-open. The question linked as duplicate with answer is for assigning multiple <i>different</i> name tags in a struct. The OP is asking for how to assign multiple <code>json</code> tags... which is a different question."}, {"owner": {"reputation": 311, "user_id": 4957046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6e531ff15d53c5177d2ca8d9206b99?s=128&d=identicon&r=PG", "display_name": "exyzzy", "link": "https://stackoverflow.com/users/4957046/exyzzy"}, "edited": false, "score": 0, "creation_date": 1588826860, "post_id": 38809137, "comment_id": 109050722, "body": "Dup, see good answers here: <a href=\"https://stackoverflow.com/questions/37118263/is-it-possible-to-have-a-struct-with-multiple-json-tags\" title=\"is it possible to have a struct with multiple json tags\">stackoverflow.com/questions/37118263/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 1, "creation_date": 1470522712, "post_id": 38809263, "comment_id": 64986784, "body": "Thanks. I needed something like this for retro compatibility. This is good."}, {"owner": {"reputation": 4457, "user_id": 141023, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/18431ffe70f2e333b8d29d7664171ac4?s=128&d=identicon&r=PG", "display_name": "cheshirekow", "link": "https://stackoverflow.com/users/141023/cheshirekow"}, "edited": false, "score": 3, "creation_date": 1576041465, "post_id": 38809263, "comment_id": 104765163, "body": "I think this is a good answer, but IIUC you <i>cannot</i> use multiple json name tags to any useful effect. For example <code>json:&quot;pattern&quot; json:&quot;frames&quot;</code> will <b>not</b> tell <code>Unmarshal</code> to unmarshal either <code>pattern</code> or <code>frames</code>. So maybe it&#39;s worth noting after the link &quot;but this doesn&#39;t work the way you want&quot;"}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 13, "last_activity_date": 1554374128, "last_edit_date": 1554374128, "creation_date": 1470522250, "answer_id": 38809263, "question_id": 38809137, "link": "https://stackoverflow.com/questions/38809137/golang-multiple-json-tag-names-for-one-field/38809263#38809263", "title": "Golang multiple json tag names for one field", "body": "<p>See <a href=\"https://stackoverflow.com/questions/18635671/how-to-define-multiple-name-tags-in-a-struct/18635910\">How to define multiple name tags in a struct</a> on how you can define multiple tags on one struct field.</p>\n\n<p>You can also use a <code>type Info map[string]interface{}</code> instead of your struct.</p>\n\n<p>Or you can use both types in your structure, and make method <code>Details()</code> which will return right pattern.</p>\n\n<pre><code>type Animation struct {\n    Name    string  `json:\"name\"`\n    Repeat  int     `json:\"repeat\"`\n    Speed   uint    `json:\"speed\"`\n    Pattern Pattern `json:\"pattern\"`\n    Frame   Pattern `json:\"frames\"`\n}\n\nfunc (a Animation) Details() Pattern {\n    if a.Pattern == nil {\n        return a.Frame\n    }\n    return a.Pattern\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1684, "user_id": 4669135, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d9d4ff76c8827f4adfc6218ba952aefc?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Devillers", "link": "https://stackoverflow.com/users/4669135/gabriel-devillers"}, "edited": false, "score": 3, "creation_date": 1529578643, "post_id": 50966527, "comment_id": 88929890, "body": "Welcome to stackoverflow ! You can improve your answer by editing to explain what your code does and tell which part is key to answering the user question."}, {"owner": {"reputation": 636, "user_id": 5563092, "user_type": "registered", "accept_rate": 31, "profile_image": "https://lh6.googleusercontent.com/-57aSH6n3Au8/AAAAAAAAAAI/AAAAAAAAMdE/dWgTfQjG4bg/photo.jpg?sz=128", "display_name": "The 0bserver", "link": "https://stackoverflow.com/users/5563092/the-0bserver"}, "edited": false, "score": 0, "creation_date": 1580814046, "post_id": 50966527, "comment_id": 106213304, "body": "Your solution answers for when somebody wants to add multiple different tags to different packages. ie in your case json and newtag. OP asked for a usecase when he/she wants to target the same package. ie. In json if you have to specify 2 different properties. Usecases for example in  json formatting options, ORMs etc. Your solution is pretty much just working around that problem. no?"}], "tags": [], "owner": {"reputation": 129, "user_id": 9972491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/423ee7e4aa2550d2a3faeaaef949322a?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/9972491/zhang"}, "is_accepted": false, "score": 12, "last_activity_date": 1531133990, "last_edit_date": 1531133990, "creation_date": 1529577735, "answer_id": 50966527, "question_id": 38809137, "link": "https://stackoverflow.com/questions/38809137/golang-multiple-json-tag-names-for-one-field/50966527#50966527", "title": "Golang multiple json tag names for one field", "body": "<p>you can use multiple json tag with third part json lib like <code>github.com/json-iterator/go</code>\ncoding like below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/json-iterator/go\"\n)\n\ntype TestJson struct {\n    Name string `json:\"name\" newtag:\"newname\"`\n    Age  int    `json:\"age\" newtag:\"newage\"`\n}\n\nfunc main() {\n\n    var json = jsoniter.ConfigCompatibleWithStandardLibrary\n    data := TestJson{}\n    data.Name = \"zhangsan\"\n    data.Age = 22\n    byt, _ := json.Marshal(&amp;data)\n    fmt.Println(string(byt))\n\n    var NewJson = jsoniter.Config{\n        EscapeHTML:             true,\n        SortMapKeys:            true,\n        ValidateJsonRawMessage: true,\n        TagKey:                 \"newtag\",\n    }.Froze()\n\n    byt, _ = NewJson.Marshal(&amp;data)\n    fmt.Println(string(byt))\n}\n\noutput:\n\n    {\"name\":\"zhangsan\",\"age\":22}\n    {\"newname\":\"zhangsan\",\"newage\":22}\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15732, "favorite_count": 2, "accepted_answer_id": 38809263, "answer_count": 2, "score": 13, "last_activity_date": 1576065178, "creation_date": 1470521251, "question_id": 38809137, "link": "https://stackoverflow.com/questions/38809137/golang-multiple-json-tag-names-for-one-field", "title": "Golang multiple json tag names for one field", "body": "<p>It it possible in Golang to use more than one name for a JSON struct tag ?</p>\n\n<pre><code>type Animation struct {\n    Name    string  `json:\"name\"`\n    Repeat  int     `json:\"repeat\"`\n    Speed   uint    `json:\"speed\"`\n    Pattern Pattern `json:\"pattern\",json:\"frames\"`\n}\n</code></pre>\n"}, {"tags": ["rest", "http", "go"], "answers": [{"comments": [{"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "edited": false, "score": 3, "creation_date": 1470516339, "post_id": 38807963, "comment_id": 64985325, "body": "If you get a web page with (for e.g) spanish/italian/etc. characters, you won&#39;t get a good result in conversion of <code>[]byte</code> to <code>string</code>. Exactly, characters such as <code>&#233;</code>, <code>&#225;</code>, etc. you will get \ufffd character. You need iterate the <code>responseData</code> and to concat every character. An optimized way would be <a href=\"https://play.golang.org/p/IPKmytFOEd\" rel=\"nofollow noreferrer\">this</a> ;-)"}, {"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "edited": false, "score": 0, "creation_date": 1470813675, "post_id": 38807963, "comment_id": 65096208, "body": "@Amd &#39;s answer resolves the problem of Unicode text with same way my previous comment, however, I think better ;-)"}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 61, "last_activity_date": 1506288650, "last_edit_date": 1506288650, "creation_date": 1470511387, "answer_id": 38807963, "question_id": 38807903, "link": "https://stackoverflow.com/questions/38807903/how-do-i-handle-plain-text-http-get-response-in-golang/38807963#38807963", "title": "How do I handle plain text HTTP Get response in Golang?", "body": "<p>Response of the body can be read using any method that could read data from incoming byte stream. Simplest of them is ReadAll function provided in ioutil package.</p>\n\n<pre><code>responseData,err := ioutil.ReadAll(response.Body)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>It will give you API response in []byte. If response is plain text you can easily convert it into string using type conversion:</p>\n\n<pre><code>responseString := string(responseData)\n</code></pre>\n\n<p>And Check the result </p>\n\n<pre><code>fmt.Println(responseString)\n</code></pre>\n\n<p><strong>Sample Program:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    url := \"http://country.io/capital.json\"\n    response, err := http.Get(url)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer response.Body.Close()\n\n    responseData, err := ioutil.ReadAll(response.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    responseString := string(responseData)\n\n    fmt.Println(responseString)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "edited": false, "score": 0, "creation_date": 1470813376, "post_id": 38808838, "comment_id": 65096041, "body": "Thanks @Amd for you answer! , I didn&#39;t know that way of to decode an bytes array of Unicode text to string, and for me was an headache... :-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "edited": false, "score": 0, "creation_date": 1470825026, "post_id": 38808838, "comment_id": 65103563, "body": "@ToniVillena  Thanks for encouraging"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 5, "last_activity_date": 1470744399, "last_edit_date": 1470744399, "creation_date": 1470518609, "answer_id": 38808838, "question_id": 38807903, "link": "https://stackoverflow.com/questions/38807903/how-do-i-handle-plain-text-http-get-response-in-golang/38808838#38808838", "title": "How do I handle plain text HTTP Get response in Golang?", "body": "<p>Use <code>ioutil.ReadAll(response.Body)</code>.</p>\n\n<p>Also you may handle Unicode text using <code>bufio.NewScanner(response.Body)</code><br>\nlike this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    response, err := http.Get(\"http://127.0.0.1\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer response.Body.Close()\n\n    scanner := bufio.NewScanner(response.Body)\n    scanner.Split(bufio.ScanRunes)\n    var buf bytes.Buffer\n    for scanner.Scan() {\n        buf.WriteString(scanner.Text())\n    }\n    fmt.Println(buf.String())\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>*Hello World* B=\u00b5H *\n</code></pre>\n\n<p>Using this sample web server code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    body := \"*Hello World* B=\u00b5H *\"\n    fmt.Fprint(w, body)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", ServeHTTP)\n    if err := http.ListenAndServe(\":80\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "is_accepted": false, "score": 1, "last_activity_date": 1498669665, "creation_date": 1498669665, "answer_id": 44808730, "question_id": 38807903, "link": "https://stackoverflow.com/questions/38807903/how-do-i-handle-plain-text-http-get-response-in-golang/44808730#44808730", "title": "How do I handle plain text HTTP Get response in Golang?", "body": "<p>With <code>io.Copy</code> you read all bytes from an io.Reader, and write it to an io.Writer</p>\n\n<pre><code>resp, err := http.Get(server.URL + \"/v1/ping\")\nif err != nil {\n    t.Errorf(\"failed to execute GET request: %s\", err)\n}\ndefer resp.Body.Close()\n\nvar b bytes.Buffer\nif _, err := io.Copy(&amp;b, resp.Body); err != nil {\n    t.Errorf(\"failed to copy response body: %s\", err)\n}\n\nfmt.Println(b.String())\n</code></pre>\n"}], "owner": {"reputation": 7606, "user_id": 180253, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df46030788b7cc95cadb9778a2b9e7dd?s=128&d=identicon&r=PG", "display_name": "TheJediCowboy", "link": "https://stackoverflow.com/users/180253/thejedicowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30540, "favorite_count": 9, "accepted_answer_id": 38807963, "answer_count": 3, "score": 35, "last_activity_date": 1599328827, "creation_date": 1470511011, "last_edit_date": 1599328827, "question_id": 38807903, "link": "https://stackoverflow.com/questions/38807903/how-do-i-handle-plain-text-http-get-response-in-golang", "title": "How do I handle plain text HTTP Get response in Golang?", "body": "<p>I am making an HTTP GET request to an endpoint that returns a plain text response.</p>\n<p>How do I grab the string of the plain text response?</p>\n<p>My code looks like the following:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>url := &quot;http://someurl.com&quot;\n\nresponse, err := http.Get(url)\nif err != nil {\n    log.Fatal(err)\n}\ndefer response.Body.Close()\nresponseString := //NOT SURE HOW TO GRAB THE PLAIN TEXT STRING\n</code></pre>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 2, "creation_date": 1470511882, "post_id": 38807862, "comment_id": 64984260, "body": "You can take a look at bufio package. <a href=\"https://golang.org/pkg/bufio/#example_Scanner_lines\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#example_Scanner_lines</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1470899870, "last_edit_date": 1470899870, "creation_date": 1470515348, "answer_id": 38808439, "question_id": 38807862, "link": "https://stackoverflow.com/questions/38807862/truncate-every-member-of-a-slice-using-go/38808439#38808439", "title": "Truncate every member of a slice using Go", "body": "<p>Using <code>bufio.NewScanner</code> then <code>word := strings.Fields(scanner.Text())</code> and <code>slice = append(slice, word[0])</code> like this working sample code:   </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    s := ` wanted1 not wanted \n    wanted2 not wanted \n\n    wanted3 not wanted \n\n    `\n    slice := []string{}\n    // scanner := bufio.NewScanner(os.Stdin)\n    scanner := bufio.NewScanner(strings.NewReader(s))\n    for scanner.Scan() {\n        word := strings.Fields(scanner.Text())\n        if len(word) &gt; 0 {\n            slice = append(slice, word[0])\n        }\n    }\n    fmt.Println(slice)\n}\n</code></pre>\n\n<p>Using <code>strings.Fields(line)</code> like this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    s := `\n    wanted1 not wanted \n    wanted2 not wanted \n\n    wanted3 not wanted \n\n    `\n\n    lines := strings.Split(s, \"\\n\")\n    slice := make([]string, 0, len(lines))\n    for _, line := range lines {\n        words := strings.Fields(line)\n        if len(words) &gt; 0 {\n            slice = append(slice, words[0])\n        }\n    }\n\n    fmt.Println(slice)\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>[wanted1 wanted2 wanted3]\n</code></pre>\n"}], "owner": {"reputation": 944, "user_id": 1499575, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/82374abfce29c20a6f214de4fa2226f5?s=128&d=identicon&r=PG", "display_name": "mreff555", "link": "https://stackoverflow.com/users/1499575/mreff555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470899870, "creation_date": 1470510720, "last_edit_date": 1470515551, "question_id": 38807862, "link": "https://stackoverflow.com/questions/38807862/truncate-every-member-of-a-slice-using-go", "title": "Truncate every member of a slice using Go", "body": "<p>I just started with Go, and I'm having a little trouble accomplishing what I want to do. After loading a large text file in which each line begins with a word I want in my array, followed by single and multi-space delimited text I do not care about.</p>\n\n<p>My first line of code creates an array of lines</p>\n\n<pre><code>lines := strings.Split( string( file ), \"\\n\" )\n</code></pre>\n\n<p>The next step would be to truncate each line  which I can do with a split statement.  I'm sure I could do this with a for loop but I'm trying to learn some of the more efficient operations in Go (compared to c/c++)</p>\n\n<p>I was hoping I could do something like this</p>\n\n<pre><code>lines := strings.Split( (lines...), \"  \" )\n</code></pre>\n\n<p>Is there a better way to do this or should I just use some type of for loop?</p>\n"}, {"tags": ["go", "scanning"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 1, "creation_date": 1470511433, "post_id": 38807855, "comment_id": 64984141, "body": "Are you trying to read from <code>stdin</code> when you get the error? Or is it also occurring upon supplying an input file to main?"}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 1, "creation_date": 1470511668, "post_id": 38807855, "comment_id": 64984204, "body": "Please provide whole output of panic."}], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 2, "last_activity_date": 1470512143, "creation_date": 1470512143, "answer_id": 38808063, "question_id": 38807855, "link": "https://stackoverflow.com/questions/38807855/golang-panic-runtime-error-invalid-memory-address-or-nil-pointer-dereference/38808063#38808063", "title": "Golang: panic: runtime error: invalid memory address or nil pointer dereference using bufio.Scanner", "body": "<p>One reason why <code>command.Scanner</code> is not initialized could be that you are not passing a <code>filename</code> argument to your main script. In this case, <code>source.Input(*sourceFlag)</code> is never called, as per the if condition (<code>if *sourceFlag != \"\"</code> is false in case of a missing <code>filename</code> option). </p>\n\n<p>Also, since you are checking for an empty file name later in <code>source</code>, this condition in <code>main</code>'s <code>init</code> is redundant. Try:</p>\n\n<pre><code>func init() {\n    sourceFlag := flag.String(\"filename\", \"\", \"if input is through source file\")\n    flag.Parse()\n    source.Input(*sourceFlag)\n}\n</code></pre>\n"}], "owner": {"reputation": 1217, "user_id": 5066719, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/902c0e0e880e8e5d5395c6872f05fb05?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Soni", "link": "https://stackoverflow.com/users/5066719/abhishek-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2174, "favorite_count": 0, "accepted_answer_id": 38808063, "answer_count": 1, "score": 1, "last_activity_date": 1470512143, "creation_date": 1470510651, "question_id": 38807855, "link": "https://stackoverflow.com/questions/38807855/golang-panic-runtime-error-invalid-memory-address-or-nil-pointer-dereference", "title": "Golang: panic: runtime error: invalid memory address or nil pointer dereference using bufio.Scanner", "body": "<p>I am implementing a go program which uses bufio.Scanner and bufio.Writer i have packaged my code as follows </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"player/command\"\n    \"strings\"\n)\n\nfunc main() {\n    //Enter your code here. Read input from STDIN. Print output to STDOUT\n\n\n\n    for commands.Scanner.Scan() {\n\n        //scan a new line and send it to comand variable to check command exist or not\n        input := strings.Split(strings.Trim(commands.Scanner.Text(), \" \"), \" \")\n        command := input[0]\n\n        if command == \"\" {\n            fmt.Printf(\"$ %s:\", commands.Pwd)\n            continue\n        }\n\n        if !commands.Commands[command] {\n            commands.ThrowError(\"CANNOT RECOGNIZE INPUT.\")\n\n        } else {\n\n            commands.Execute(command, input[1:], nil)\n\n        }\n        fmt.Printf(\"$ %s:\", commands.Pwd)\n    }\n}\n</code></pre>\n\n<p>I am also using init.go file in main package as follows</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"player/source\"\n)\n\nfunc init() {\n    sourceFlag := flag.String(\"filename\", \"\", \"if input is through source file\")\n    flag.Parse()\n    if *sourceFlag != \"\" {\n        source.Input(*sourceFlag)\n    }\n}\n</code></pre>\n\n<p>and my final package player/source is as follows :-</p>\n\n<pre><code>package source\n\n    import (\n        \"bufio\"\n        \"log\"\n        \"os\"\n        \"player/command\"\n    )\n\n    func Input(source string) {\n        if source != \"\" {\n            readFile, err := os.OpenFile(source, os.O_RDONLY, os.ModeExclusive)\n            if err != nil {\n                log.Fatal(err)\n            }\n            commands.Scanner = bufio.NewScanner(readFile)\n            writeFile, err := os.Create(source + \"_output.txt\")\n            if err != nil {\n                log.Fatal(err)\n            }\n            commands.Writer = bufio.NewWriter(writeFile)\n        } else {\n            commands.Scanner = bufio.NewScanner(os.Stdin)\n            commands.Writer = bufio.NewWriter(os.Stdout)\n            // fmt.Println(commands.Scanner)\n        }\n    }\n</code></pre>\n\n<p>Execution of this code results in </p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x58 pc=0x4a253a]\n\ngoroutine 1 [running]:\nbufio.(*Scanner).Scan(0x0, 0x5)\n    /usr/local/go/src/bufio/scan.go:120 +0x2a\nmain.main()\n    /home/xyz/dev/go/src/players/main.go:13 +0x124\n</code></pre>\n\n<p>I dont know the reason even after initializing my scanner why i am not been able to read from it</p>\n"}, {"tags": ["go", "bit-manipulation", "bitwise-operators"], "answers": [{"comments": [{"owner": {"reputation": 1639, "user_id": 647449, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/537208670/picture?type=large", "display_name": "stantonk", "link": "https://stackoverflow.com/users/647449/stantonk"}, "edited": false, "score": 1, "creation_date": 1470583766, "post_id": 38806550, "comment_id": 64998566, "body": "ah interesting, so in <code>MaxInt uint64     = 1&lt;&lt;64 - 1</code> the <code>1&lt;&lt;64</code> is evaluated at compile time to 18446744073709551616 in an untyped manner and then when the <code>- 1</code> is accounted for it ends up fitting inside an uint64."}, {"owner": {"reputation": 1639, "user_id": 647449, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/537208670/picture?type=large", "display_name": "stantonk", "link": "https://stackoverflow.com/users/647449/stantonk"}, "edited": false, "score": 0, "creation_date": 1470583788, "post_id": 38806550, "comment_id": 64998574, "body": "so why doesn&#39;t this overflow in the loop when i = 65? <code>var j uint64 = 1 &lt;&lt; uint64(i) - 1</code>"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 1639, "user_id": 647449, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/537208670/picture?type=large", "display_name": "stantonk", "link": "https://stackoverflow.com/users/647449/stantonk"}, "edited": false, "score": 0, "creation_date": 1470586497, "post_id": 38806550, "comment_id": 64999287, "body": "Added explanation."}, {"owner": {"reputation": 1639, "user_id": 647449, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/537208670/picture?type=large", "display_name": "stantonk", "link": "https://stackoverflow.com/users/647449/stantonk"}, "edited": false, "score": 1, "creation_date": 1470626293, "post_id": 38806550, "comment_id": 65008301, "body": "interesting; thanks for that! It&#39;s been a long time since I&#39;ve had to do bitwise operations, and back then it was in FPGAs and ASICs. This makes sense from an implementation standpoint to me now, it&#39;s a nice little feature to allow arbitrary precision for constant literals at compile time, so you know exactly what you&#39;re getting for your constant."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 11, "last_activity_date": 1470586483, "last_edit_date": 1470586483, "creation_date": 1470501881, "answer_id": 38806550, "question_id": 38806491, "link": "https://stackoverflow.com/questions/38806491/why-doesnt-left-bit-shifting-by-64-overflow-in-golang/38806550#38806550", "title": "Why doesn&#39;t left bit shifting by 64 overflow in golang?", "body": "<p>When you write</p>\n\n<pre><code>1&lt;&lt;64\n</code></pre>\n\n<p>The <code>1</code> above is not an <code>int64</code>. It is a <em>constant literal</em>. From the language specs:</p>\n\n<blockquote>\n  <p>Constant expressions are always evaluated exactly; intermediate values\n  and the constants themselves may require precision significantly\n  larger than supported by any predeclared type in the language.</p>\n</blockquote>\n\n<p>Thus, a constant literal is evaluated at compile time and can be very large because it is not a specific type of the language implementation.</p>\n\n<p>Below will in fact give an overflow error:</p>\n\n<pre><code>var i int64\ni = 1&lt;&lt;65 - 1\n</code></pre>\n\n<p>Because now the constant literal expression evaluates to a value greater than that an <code>int64</code> can contain.</p>\n\n<p>Read more about this <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"noreferrer\">here</a>.</p>\n\n<p>To know why your example code works for <code>i = 65</code>, refer to the below specification from the Golang <a href=\"https://golang.org/ref/spec#Operators\" rel=\"noreferrer\">specs</a>:</p>\n\n<blockquote>\n  <p>The right operand in a shift expression must have unsigned integer\n  type or be an untyped constant that can be converted to unsigned\n  integer type. If the <strong>left operand of a non-constant shift expression\n  is an untyped constant, it is first converted to the type it would\n  assume if the shift expression were replaced by its left operand\n  alone</strong>.</p>\n</blockquote>\n\n<p>The blod part above concerns your code. Consider the code below:</p>\n\n<pre><code>a := 66\nvar j uint64 = 1&lt;&lt;uint64(a) - 1\n</code></pre>\n\n<p>Here in the shift operator, the right operand is <em>a non-constant exrpession</em>. So the whole shift operation becomes <em>non-constant shift expression</em>. Thus, as described above, the left operand, <code>1</code> is converted to a <code>uint64</code>.</p>\n\n<p>Now, the shift is being done on <code>uint64(1)</code>, which can be shifted using <code>&lt;&lt;</code> to as many places as you want. You can shift it beyond 64 bits, and the implementation will easily allow it. But in this case the memory that's holding the <code>uint64(1)</code> above will contain all zeros.</p>\n\n<p>Note that this behavior is not the same thing as an overflow as per the language specifications. Again, the language implemntation allows for as many shifts as long as the right operator is not a constant expression. So for example, this will work:</p>\n\n<pre><code>a := 6666\nvar j uint64 = 1&lt;&lt;uint64(a) - 1 // non-constant shift expression\n</code></pre>\n\n<p>Think about it this way. Earlier, the <code>1</code> was untyped. It had an arbitrary precision (implementation dependent) and the whole number was being returned (all the bits). Now, since it is a <code>uint64</code>, only the first 64 bits are being taken into consideration.</p>\n\n<p>This still causes an overflow because the left operand <code>1</code> is untypes and can contain a large number of bits, returning a value too large for a <code>uint64</code>:</p>\n\n<pre><code>var j uint64 = 1&lt;&lt;uint64(66) - 1 // overflow. Note that uint64(64)\nfmt.Println(j)                   // is typed, but it's still a constant\n</code></pre>\n"}], "owner": {"reputation": 1639, "user_id": 647449, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/537208670/picture?type=large", "display_name": "stantonk", "link": "https://stackoverflow.com/users/647449/stantonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 1, "accepted_answer_id": 38806550, "answer_count": 1, "score": 7, "last_activity_date": 1470586483, "creation_date": 1470501570, "question_id": 38806491, "link": "https://stackoverflow.com/questions/38806491/why-doesnt-left-bit-shifting-by-64-overflow-in-golang", "title": "Why doesn&#39;t left bit shifting by 64 overflow in golang?", "body": "<p>I was taking a look at <a href=\"https://tour.golang.org/basics/11\" rel=\"noreferrer\">A Tour of Go</a> and I was confused by something in their basic-types.go example:</p>\n\n<pre><code>MaxInt uint64     = 1&lt;&lt;64 - 1\n</code></pre>\n\n<p>Shouldn't shifting a 1 64 positions to the left in an unsigned 64 bit integer cause overflow (a.k.a. shifting a bit past the MSB)?</p>\n\n<p>However, the compiler doesn't complain until the line is changed to:</p>\n\n<pre><code>MaxInt uint64     = 1&lt;&lt;65 - 1\n\n./basic-types.go:5: constant 36893488147419103231 overflows uint64\n</code></pre>\n\n<p>If I write some code to iterate over left shifts of varying lengths, including shifting by 65 as in the above example that causes the compiler to barf, I see two things:</p>\n\n<ol>\n<li><p>It behaves as I expected, in that <code>1&lt;&lt;63</code> places the 1 in the MSB possible for an uint64</p></li>\n<li><p>It doesn't overflow anymore (huh?!?!)</p></li>\n</ol>\n\n<p>code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    for i := 60; i &lt; 66; i++ {\n        var j uint64 = 1 &lt;&lt; uint64(i) - 1\n        fmt.Printf(\"%2d | %64b | %#18x\\n\", i, j, j)\n\n    }\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>60 |     111111111111111111111111111111111111111111111111111111111111 |  0xfffffffffffffff\n61 |    1111111111111111111111111111111111111111111111111111111111111 | 0x1fffffffffffffff\n62 |   11111111111111111111111111111111111111111111111111111111111111 | 0x3fffffffffffffff\n63 |  111111111111111111111111111111111111111111111111111111111111111 | 0x7fffffffffffffff\n64 | 1111111111111111111111111111111111111111111111111111111111111111 | 0xffffffffffffffff\n65 | 1111111111111111111111111111111111111111111111111111111111111111 | 0xffffffffffffffff\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1470553476, "post_id": 38805381, "comment_id": 64991183, "body": "And discussed here too <a href=\"http://stackoverflow.com/questions/37404025/should-i-rlock-map-before-range/37410279#37410279\" title=\"should i rlock map before range\">stackoverflow.com/questions/37404025/&hellip;</a>"}], "owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1470494509, "answer_count": 0, "score": 1, "last_activity_date": 1470494087, "creation_date": 1470494087, "question_id": 38805381, "link": "https://stackoverflow.com/questions/38805381/when-to-protect-a-map-during-reads", "closed_reason": "Duplicate", "title": "When to protect a map during reads", "body": "<p>In my main function, I'm creating a map that is passed to a struct, the map will be used just for reads in multiple handlers and helper functions.</p>\n\n<p>Do I need to protect a <code>map[string]interface{}</code> with a mutex?</p>\n\n<pre><code>type SomeStruct struct {\n    content map[string]interface{}\n}\n\nvar ss *SomeStruct\n\nfunc main() {\n    m := map[string]interface{}{\"s1\": \"string\", \"s2\": 1}\n    ss = &amp;SomeStruct{m}\n    http.HandleFunc(\"/s1\", Handler1)\n    http.HandleFunc(\"/s2\", Handler2)\n    http.ListenAndServe(\":8081\", nil)\n}\n\nfunc Handler1(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(ss.content[\"s1\"].(string))\n}\n\nfunc Handler2(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(ss.content[\"s2\"].(int))\n}\n</code></pre>\n\n<p>I have tried adding the <code>-race</code> flag when building and running the above code, but nothing was detected.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "edited": false, "score": 0, "creation_date": 1470640267, "post_id": 38805459, "comment_id": 65012534, "body": "I wasn&#39;t able to follow your instructions based on what you said. Another solution based on maps worked though."}], "tags": [], "owner": {"reputation": 1698, "user_id": 3778742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad62c6ebfd4440c951edde151cb76714?s=128&d=identicon&r=PG&f=1", "display_name": "alexsmn", "link": "https://stackoverflow.com/users/3778742/alexsmn"}, "is_accepted": false, "score": 2, "last_activity_date": 1470494528, "creation_date": 1470494528, "answer_id": 38805459, "question_id": 38805269, "link": "https://stackoverflow.com/questions/38805269/way-to-check-for-duplicates-before-writing-into-a-file/38805459#38805459", "title": "Way to check for duplicates before writing into a file?", "body": "<p>Create a type that implements <code>writer</code> then create a custom <code>WriteString</code></p>\n\n<p>Inside <code>WriteString</code> open the file where you store your emails, iterate over each email and save the new emails.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "edited": false, "score": 1, "creation_date": 1470640230, "post_id": 38816139, "comment_id": 65012517, "body": "That&#39;s perfect. I&#39;ve edited my code to incorporate your solution and it&#39;s both elegant and teaching. Thanks!"}], "tags": [], "owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "is_accepted": true, "score": 1, "last_activity_date": 1470636384, "last_edit_date": 1470636384, "creation_date": 1470586852, "answer_id": 38816139, "question_id": 38805269, "link": "https://stackoverflow.com/questions/38805269/way-to-check-for-duplicates-before-writing-into-a-file/38816139#38816139", "title": "Way to check for duplicates before writing into a file?", "body": "<p>You may use a Go built-in map as a set like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar emailSet map[string]bool = make(map[string]bool)\n\nfunc emailExists(email string) bool {\n    _, ok := emailSet[email]\n    return ok\n}\n\nfunc addEmail(email string) {\n    emailSet[email] = true\n}\n\nfunc main() {\n    emails := []string{\n        \"duplicated@golang.org\",\n        \"abc@golang.org\",\n        \"stackoverflow@golang.org\",\n        \"duplicated@golang.org\", // &lt;- Duplicated!\n    }\n    for _, email := range emails {\n        if !emailExists(email) {\n            fmt.Println(email)\n            addEmail(email)\n        }\n    }\n}\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>duplicated@golang.org\nabc@golang.org\nstackoverflow@golang.org\n</code></pre>\n\n<p>You may try the same code at <kbd><a href=\"https://play.golang.org/p/yRbU8_TzlF\" rel=\"nofollow\">The Go Playground</a></kbd>.</p>\n"}], "owner": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 38816139, "answer_count": 2, "score": 0, "last_activity_date": 1470640335, "creation_date": 1470493280, "last_edit_date": 1470640335, "question_id": 38805269, "link": "https://stackoverflow.com/questions/38805269/way-to-check-for-duplicates-before-writing-into-a-file", "title": "Way to check for duplicates before writing into a file?", "body": "<p>So I wrote a small script that takes text files as an input, reads every line and tries to validate it as an email. If it passes, it writes the line into a new ('clean') file, if it doesn't pass, it strips it of spaces and tries to validate it again. Now, if it passes this time, it writes the line into a new file and if it fails, it ignores the line.</p>\n\n<p>Thing is, such as it is, my script may write duplicate emails into the output files. How should I go around that and check for duplicates present in the output file before writing?</p>\n\n<p>Here's the relevant code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// create reading and writing buffers\n    scanner := bufio.NewScanner(r)\n    writer := bufio.NewWriter(w)\n\n    for scanner.Scan() {\n        email := scanner.Text()\n\n        // validate each email\n        if !correctEmail.MatchString(email) {\n            // if validation didn't pass, strip and lowercase the email and store it\n            email = strings.Replace(email, \" \", \"\", -1)\n            // validate the email again after cleaning\n            if !correctEmail.MatchString(email) {\n                // if validation didn't pass, ignore this email\n                continue\n            } else {\n                // if validation passed, write clean email into file\n                _, err = writer.WriteString(email + \"\\r\\n\")\n                if err != nil {\n                    return err\n                }\n            }\n\n        } else {\n            // if validation passed, write the email into file\n            _, err = writer.WriteString(email + \"\\r\\n\")\n            if err != nil {\n                return err\n            }\n        }\n\n    }\n\n    err = writer.Flush()\n    if err != nil {\n        return err\n    }\n</code></pre>\n"}, {"tags": ["go", "docker", "dockerfile", "docker-api"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 4194833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-hfIUlzOxai0/AAAAAAAAAAI/AAAAAAAABd4/nqpFrsKIiKw/photo.jpg?sz=128", "display_name": "Mangirdas", "link": "https://stackoverflow.com/users/4194833/mangirdas"}, "edited": false, "score": 0, "creation_date": 1473971414, "post_id": 39229066, "comment_id": 66355360, "body": "I ended doing this :/ So looks like kinda way to do this now."}, {"owner": {"reputation": 11396, "user_id": 2768067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hSTUv.png?s=128&g=1", "display_name": "Komu", "link": "https://stackoverflow.com/users/2768067/komu"}, "edited": false, "score": 0, "creation_date": 1506906964, "post_id": 39229066, "comment_id": 79990912, "body": "You do not have to call close on the dockerBuildContext; <code>defer dockerBuildContext.Close()</code>                                    This is because, cli.ImageBuild calls go&#39;s net/http client; <a href=\"https://github.com/moby/moby/blob/master/client/image_build.go#L34\" rel=\"nofollow noreferrer\">github.com/moby/moby/blob/master/client/image_build.go#L34</a>    And the go client always closes the request body by default; <a href=\"https://github.com/golang/go/blob/c8aec4095e089ff6ac50d18e97c3f46561f14f48/src/net/http/client.go#L472\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 116, "user_id": 5975852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a231e93f312cd6eff139701a31f4a5bd?s=128&d=identicon&r=PG", "display_name": "Marcus Havranek", "link": "https://stackoverflow.com/users/5975852/marcus-havranek"}, "is_accepted": false, "score": 10, "last_activity_date": 1472564208, "creation_date": 1472564208, "answer_id": 39229066, "question_id": 38804313, "link": "https://stackoverflow.com/questions/38804313/build-docker-image-from-go-code/39229066#39229066", "title": "Build Docker Image From Go Code", "body": "<p>@Mangirdas: staring at a screen long enough DOES help - at least in my case. I have been stuck with the same issue for some time now. \nYou were right to use the tar file (your second example). If you look at the API doc here <a href=\"https://docs.docker.com/engine/reference/api/docker_remote_api_v1.24/#/build-image-from-a-dockerfile\" rel=\"noreferrer\">https://docs.docker.com/engine/reference/api/docker_remote_api_v1.24/#/build-image-from-a-dockerfile</a> you can see that it expects a tar.\nWhat really helped me was looking at other implementations of the client, perl and ruby in my case. Both create a tar on the fly when being asked to build an image from a directory.\nAnyway, you only need to put your dockerBuildContext somewhere else (see the cli.ImageBuild())</p>\n\n<pre><code>dockerBuildContext, err := os.Open(\"/Path/to/your/docker/tarfile.tar\")\ndefer dockerBuildContext.Close()\n\nbuildOptions := types.ImageBuildOptions{\n    Dockerfile:   \"Dockerfile\", // optional, is the default\n}\n\nbuildResponse, err := cli.ImageBuild(context.Background(), dockerBuildContext, buildOptions)\nif err != nil {\n    log.Fatal(err)\n}\ndefer buildResponse.Body.Close()\n</code></pre>\n\n<p>I am not there with naming the images properly yet, but at least I can create them...\nHope this helps.\nCheers</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 7287171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4016b6b10294ce9a446d7d74e0c77991?s=128&d=identicon&r=PG&f=1", "display_name": "Liz Furlan", "link": "https://stackoverflow.com/users/7287171/liz-furlan"}, "is_accepted": false, "score": 4, "last_activity_date": 1488843284, "creation_date": 1488843284, "answer_id": 42637584, "question_id": 38804313, "link": "https://stackoverflow.com/questions/38804313/build-docker-image-from-go-code/42637584#42637584", "title": "Build Docker Image From Go Code", "body": "<p>I agree with Marcus Havranek's answer, that method has worked for me. Just want to add how to add a name to an image, since that seemed like an open question:</p>\n\n<pre><code>buildOptions := types.ImageBuildOptions{\n    Tags:   []string{\"imagename\"},\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 2996, "user_id": 2733115, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/asgs0.jpg?s=128&g=1", "display_name": "Daniel Andrei Minc\u0103", "link": "https://stackoverflow.com/users/2733115/daniel-andrei-minc%c4%83"}, "edited": false, "score": 2, "creation_date": 1612724660, "post_id": 46518557, "comment_id": 116850368, "body": "loved that you used the native &quot;archive/tar&quot; library to generate the tar, this code is maintainable even more years from now on."}], "tags": [], "owner": {"reputation": 11396, "user_id": 2768067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hSTUv.png?s=128&g=1", "display_name": "Komu", "link": "https://stackoverflow.com/users/2768067/komu"}, "is_accepted": false, "score": 10, "last_activity_date": 1506909000, "creation_date": 1506909000, "answer_id": 46518557, "question_id": 38804313, "link": "https://stackoverflow.com/questions/38804313/build-docker-image-from-go-code/46518557#46518557", "title": "Build Docker Image From Go Code", "body": "<p>The following works for me;</p>\n\n<pre><code>package main\n\nimport (\n    \"archive/tar\"\n    \"bytes\"\n    \"context\"\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n\n    \"github.com/docker/docker/api/types\"\n    \"github.com/docker/docker/client\"\n)\n\nfunc main() {\n    ctx := context.Background()\n    cli, err := client.NewEnvClient()\n    if err != nil {\n        log.Fatal(err, \" :unable to init client\")\n    }\n\n    buf := new(bytes.Buffer)\n    tw := tar.NewWriter(buf)\n    defer tw.Close()\n\n    dockerFile := \"myDockerfile\"\n    dockerFileReader, err := os.Open(\"/path/to/dockerfile\")\n    if err != nil {\n        log.Fatal(err, \" :unable to open Dockerfile\")\n    }\n    readDockerFile, err := ioutil.ReadAll(dockerFileReader)\n    if err != nil {\n        log.Fatal(err, \" :unable to read dockerfile\")\n    }\n\n    tarHeader := &amp;tar.Header{\n        Name: dockerFile,\n        Size: int64(len(readDockerFile)),\n    }\n    err = tw.WriteHeader(tarHeader)\n    if err != nil {\n        log.Fatal(err, \" :unable to write tar header\")\n    }\n    _, err = tw.Write(readDockerFile)\n    if err != nil {\n        log.Fatal(err, \" :unable to write tar body\")\n    }\n    dockerFileTarReader := bytes.NewReader(buf.Bytes())\n\n    imageBuildResponse, err := cli.ImageBuild(\n        ctx,\n        dockerFileTarReader,\n        types.ImageBuildOptions{\n            Context:    dockerFileTarReader,\n            Dockerfile: dockerFile,\n            Remove:     true})\n    if err != nil {\n        log.Fatal(err, \" :unable to build docker image\")\n    }\n    defer imageBuildResponse.Body.Close()\n    _, err = io.Copy(os.Stdout, imageBuildResponse.Body)\n    if err != nil {\n        log.Fatal(err, \" :unable to read image build response\")\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1609320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda1d31b7484a9224f59ad84c66e76f0?s=128&d=identicon&r=PG", "display_name": "Elsvent", "link": "https://stackoverflow.com/users/1609320/elsvent"}, "is_accepted": false, "score": 3, "last_activity_date": 1530758526, "creation_date": 1530758526, "answer_id": 51182726, "question_id": 38804313, "link": "https://stackoverflow.com/questions/38804313/build-docker-image-from-go-code/51182726#51182726", "title": "Build Docker Image From Go Code", "body": "<p>I encounter same problem. Finally find out the tar file should be docker build context even with Dockerfile.</p>\n\n<p>Here is my code,</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n\n    \"github.com/docker/docker/api/types\"\n    \"github.com/docker/docker/client\"\n    \"golang.org/x/net/context\"\n)\n\nfunc main() {\n    dockerBuildContext, err := os.Open(\"/Users/elsvent/workspace/Go/src/test/test.tar\")\n    defer dockerBuildContext.Close()\n\n    buildOptions := types.ImageBuildOptions{\n        SuppressOutput: true,\n        PullParent:     true,\n        Tags:           []string{\"xxx\"},\n        Dockerfile:     \"test/Dockerfile\",\n    }\n    defaultHeaders := map[string]string{\"Content-Type\": \"application/tar\"}\n    cli, _ := client.NewClient(\"unix:///var/run/docker.sock\", \"v1.24\", nil, defaultHeaders)\n    buildResp, err := cli.ImageBuild(context.Background(), dockerBuildContext, buildOptions)\n    if err != nil {\n    log.Fatal(err)\n    }\n    defer buildResp.Body.Close()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9243, "user_id": 1318181, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1ZfAE.png?s=128&g=1", "display_name": "kylieCatt", "link": "https://stackoverflow.com/users/1318181/kyliecatt"}, "is_accepted": false, "score": 6, "last_activity_date": 1538523839, "creation_date": 1538523839, "answer_id": 52617853, "question_id": 38804313, "link": "https://stackoverflow.com/questions/38804313/build-docker-image-from-go-code/52617853#52617853", "title": "Build Docker Image From Go Code", "body": "<p>The Docker package has a function for creating a TAR from a file path. It's whats used by the CLI. It's not in the client package so it need to be installed separately:</p>\n\n<pre><code>import (\n    \"github.com/mitchellh/go-homedir\"\n    \"github.com/docker/docker/pkg/archive\"\n)\n\nfunc GetContext(filePath string) io.Reader {\n    // Use homedir.Expand to resolve paths like '~/repos/myrepo'\n    filePath, _ := homedir.Expand(filePath)\n    ctx, _ := archive.TarWithOptions(filePath, &amp;archive.TarOptions{})\n    return ctx\n}\n\ncli.ImageBuild(context.Background(), GetContext(\"~/repos/myrepo\"), types.ImageBuildOptions{...})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 5503782, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba37ef3defd576719e0a8ec3350db07a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5503782/steve"}, "edited": false, "score": 0, "creation_date": 1598063125, "post_id": 58742917, "comment_id": 112344006, "body": "Thanks for this.  I&#39;m wondering why you chose to write to Stderr though? Why not Stdout?"}], "tags": [], "owner": {"reputation": 296, "user_id": 963438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7ON36.jpg?s=128&g=1", "display_name": "Steve Gore", "link": "https://stackoverflow.com/users/963438/steve-gore"}, "is_accepted": false, "score": 4, "last_activity_date": 1573107182, "creation_date": 1573107182, "answer_id": 58742917, "question_id": 38804313, "link": "https://stackoverflow.com/questions/38804313/build-docker-image-from-go-code/58742917#58742917", "title": "Build Docker Image From Go Code", "body": "<p>Combining a few of the answers, and adding how to correctly parse the returned JSON using <a href=\"https://godoc.org/github.com/docker/docker/pkg/jsonmessage#DisplayJSONMessagesStream\" rel=\"nofollow noreferrer\">DisplayJSONMessagesToStream</a>. </p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"log\"\n\n    \"github.com/docker/docker/api/types\"\n    \"github.com/docker/docker/pkg/archive\"\n    \"github.com/docker/docker/pkg/jsonmessage\"\n    \"github.com/docker/docker/pkg/term\"\n    \"golang.org/x/net/context\"\n)\n\n// Build a dockerfile if it exists\nfunc Build(dockerFilePath, buildContextPath string, tags []string) {\n\n    ctx := context.Background()\n    cli := getCLI()\n\n    buildOpts := types.ImageBuildOptions{\n        Dockerfile: dockerFilePath,\n        Tags:       tags,\n    }\n\n    buildCtx, _ := archive.TarWithOptions(buildContextPath, &amp;archive.TarOptions{})\n\n    resp, err := cli.ImageBuild(ctx, buildCtx, buildOpts)\n    if err != nil {\n        log.Fatalf(\"build error - %s\", err)\n    }\n    defer resp.Body.Close()\n\n    termFd, isTerm := term.GetFdInfo(os.Stderr)\n    jsonmessage.DisplayJSONMessagesStream(resp.Body, os.Stderr, termFd, isTerm, nil)\n}\n</code></pre>\n\n<p>I've left our a few convenience functions like <code>getCLI</code> but I'm sure you have your own equivalents.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 15491526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92c5e021e3f6cb0151b731bdc2a46eca?s=128&d=identicon&r=PG&f=1", "display_name": "user15491526", "link": "https://stackoverflow.com/users/15491526/user15491526"}, "edited": false, "score": 1, "creation_date": 1616809800, "post_id": 66827282, "comment_id": 118128299, "body": "go get github.com/mitchellh/go-homedir"}], "tags": [], "owner": {"reputation": 1, "user_id": 15491526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92c5e021e3f6cb0151b731bdc2a46eca?s=128&d=identicon&r=PG&f=1", "display_name": "user15491526", "link": "https://stackoverflow.com/users/15491526/user15491526"}, "is_accepted": false, "score": 0, "last_activity_date": 1616809568, "creation_date": 1616809568, "answer_id": 66827282, "question_id": 38804313, "link": "https://stackoverflow.com/questions/38804313/build-docker-image-from-go-code/66827282#66827282", "title": "Build Docker Image From Go Code", "body": "<pre><code>opt := types.ImageBuildOptions{\n    Dockerfile: &quot;Dockerfile&quot;,\n}\n\nfilePath, _ = homedir.Expand(&quot;.&quot;)\nbuildCtx, _ := archive.TarWithOptions(filePath, &amp;archive.TarOptions{})\n\nx, err := cli.ImageBuild(context.Background(), buildCtx, opt)\nio.Copy(os.Stdout, x.Body)\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 4194833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-hfIUlzOxai0/AAAAAAAAAAI/AAAAAAAABd4/nqpFrsKIiKw/photo.jpg?sz=128", "display_name": "Mangirdas", "link": "https://stackoverflow.com/users/4194833/mangirdas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6732, "favorite_count": 3, "answer_count": 7, "score": 11, "last_activity_date": 1616809568, "creation_date": 1470486549, "last_edit_date": 1524260149, "question_id": 38804313, "link": "https://stackoverflow.com/questions/38804313/build-docker-image-from-go-code", "title": "Build Docker Image From Go Code", "body": "<p>I'm trying to build a Docker image using the Docker API and Docker Go libraries (<a href=\"https://github.com/docker/engine-api/\" rel=\"noreferrer\">https://github.com/docker/engine-api/</a>). Code example:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"github.com/docker/engine-api/client\"\n    \"github.com/docker/engine-api/types\"\n    \"golang.org/x/net/context\"\n)\nfunc main() {\n    defaultHeaders := map[string]string{\"User-Agent\": \"engine-api-cli-1.0\"}\n    cli, err := client.NewClient(\"unix:///var/run/docker.sock\", \"v1.22\", nil, defaultHeaders)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Print(cli.ClientVersion())\n    opt := types.ImageBuildOptions{\n        CPUSetCPUs:   \"2\",\n        CPUSetMems:   \"12\",\n        CPUShares:    20,\n        CPUQuota:     10,\n        CPUPeriod:    30,\n        Memory:       256,\n        MemorySwap:   512,\n        ShmSize:      10,\n        CgroupParent: \"cgroup_parent\",\n        Dockerfile:   \"dockerSrc/docker-debug-container/Dockerfile\",\n    }\n    _, err = cli.ImageBuild(context.Background(), nil, opt)\n    if err == nil || err.Error() != \"Error response from daemon: Server error\" {\n        fmt.Printf(\"expected a Server Error, got %v\", err)\n    }\n}\n</code></pre>\n\n<p>The error is always same:</p>\n\n<blockquote>\n  <p>Error response from daemon: Cannot locate specified Dockerfile: dockerSrc/docker-debug-container/Dockerfile </p>\n</blockquote>\n\n<p>or </p>\n\n<blockquote>\n  <p>Error response from daemon: Cannot locate specified Dockerfile: Dockerfile</p>\n</blockquote>\n\n<p><strong>Things I've checked:</strong></p>\n\n<ol>\n<li>The folder exists in build path</li>\n<li>I tried both relative and absolute path</li>\n<li>There are no softlinks in the path </li>\n<li>I tried the same folder for binary and <code>Dockerfile</code></li>\n<li><code>docker build &lt;path&gt;</code> works</li>\n<li>and bunch of other stuff</li>\n</ol>\n\n<p>My other option was to use <code>RemoteContext</code> which looks like it works, but only for fully self contained dockerfiles, and not the ones with \"local file presence\".</p>\n\n<hr>\n\n<p><strong>Update:</strong>\nTried passing <code>tar</code> as buffer, but got the same result with the following:</p>\n\n<pre><code>  dockerBuildContext, err := os.Open(\"&lt;path to&gt;/docker-debug-    container/docker-debug-container.tar\")\n  defer dockerBuildContext.Close()\n\n    opt := types.ImageBuildOptions{\n        Context:      dockerBuildContext,\n        CPUSetCPUs:   \"2\",\n        CPUSetMems:   \"12\",\n        CPUShares:    20,\n        CPUQuota:     10,\n        CPUPeriod:    30,\n        Memory:       256,\n        MemorySwap:   512,\n        ShmSize:      10,\n        CgroupParent: \"cgroup_parent\",\n        //  Dockerfile:   \"Dockerfile\",\n    }\n\n    _, err = cli.ImageBuild(context.Background(), nil, opt)\n</code></pre>\n"}, {"tags": ["html", "mysql", "go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "edited": false, "score": 0, "creation_date": 1470488949, "post_id": 38804603, "comment_id": 64978066, "body": "Thanks Simo, but i want to print this in browser. Is there any template helpers already available in go?"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 3, "last_activity_date": 1470488828, "creation_date": 1470488828, "answer_id": 38804603, "question_id": 38804290, "link": "https://stackoverflow.com/questions/38804290/how-to-print-new-lines-in-golang-template/38804603#38804603", "title": "How to print new lines in Golang template?", "body": "<p>Here you can use the <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\">Split</a> function to parse the string and split the substring into slices using the <code>sep</code> as separator.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    txt := \"Hi!\\nHow are you?\\nHere is the link you wanted:\\nhttp://www.google.com\"\n    res := strings.Split(txt, \"\\n\")\n    for _, val := range res {\n        fmt.Println(val)\n    }\n}\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>Hi!\nHow are you?\nHere is the link you wanted:\nhttp://www.google.com\n</code></pre>\n\n<p>Example on <a href=\"https://play.golang.org/p/vREkix07ZF\" rel=\"nofollow\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1470494642, "last_edit_date": 1495539952, "creation_date": 1470491343, "answer_id": 38804964, "question_id": 38804290, "link": "https://stackoverflow.com/questions/38804290/how-to-print-new-lines-in-golang-template/38804964#38804964", "title": "How to print new lines in Golang template?", "body": "<p>To print this in browser, replace <code>\\n</code> with e.g. <code>&lt;br&gt;</code><br>\nlike <code>body = strings.Replace(body, \"\\n\", \"&lt;br&gt;\", -1)</code><br>\nSee this working sample code:  </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", ServeHTTP)\n    if err := http.ListenAndServe(\":80\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    html := `\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;  \n&lt;table style=\"width:100%\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Data&lt;/th&gt;\n    &lt;th&gt;Content&lt;/th&gt; \n  &lt;/tr&gt; \n  &lt;tr&gt;\n    &lt;td&gt;{{.Data}}&lt;/td&gt;\n    &lt;td&gt;{{.Content}}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt; \n&lt;/body&gt;\n&lt;/html&gt;\n`\n    st := \"Hi!\\nHow are you?\\nHere is the link you wanted:\\nhttp://www.google.com\"\n    data := DataContent{\"data\", st}\n\n    buf := &amp;bytes.Buffer{}\n    t := template.Must(template.New(\"template1\").Parse(html))\n    if err := t.Execute(buf, data); err != nil {\n        panic(err)\n    }\n    body := buf.String()\n    body = strings.Replace(body, \"\\n\", \"&lt;br&gt;\", -1)\n    fmt.Fprint(w, body)\n}\n\ntype DataContent struct {\n    Data, Content string\n}\n</code></pre>\n\n<p>To see the output, run this code and open your browser at <code>http://127.0.0.1/</code>  </p>\n\n<p>Also see:  <a href=\"https://stackoverflow.com/questions/13779027/html-templates-replacing-newlines-with-br\">html/templates - Replacing newlines with &lt;br&gt;</a>  </p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10599, "favorite_count": 0, "closed_date": 1470495484, "accepted_answer_id": 38804964, "answer_count": 2, "score": 3, "last_activity_date": 1475418205, "creation_date": 1470486390, "last_edit_date": 1475418205, "question_id": 38804290, "link": "https://stackoverflow.com/questions/38804290/how-to-print-new-lines-in-golang-template", "closed_reason": "Duplicate", "title": "How to print new lines in Golang template?", "body": "<p>I have stored some content in MySQL that looks like this. </p>\n\n<pre><code>\"Hi!\\nHow are you?\\nHere is the link you wanted:\\nhttp://www.google.com\"\n</code></pre>\n\n<p>When I print it in Golang template, its not parsing correctly. I mean everything displayed in one line. </p>\n\n<p>Its supposed to print like this</p>\n\n<pre><code>Hi!\nHow are you?\nHere is the link you wanted:\nhttp://www.google.com\n</code></pre>\n\n<p>Here is my template code.</p>\n\n<pre><code>&lt;tr&gt;\n    &lt;td&gt;TextBody&lt;/td&gt;\n    &lt;td&gt;{{.Data.Content}}&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Am I missing something? </p>\n"}, {"tags": ["unix", "go", "fifo", "mkfifo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1470489253, "post_id": 38804279, "comment_id": 64978150, "body": "You&#39;re not checking the errors from writing to the pipe"}, {"owner": {"reputation": 2005, "user_id": 910553, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/9101644/picture?type=large", "display_name": "Scott Frazer", "link": "https://stackoverflow.com/users/910553/scott-frazer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470502461, "post_id": 38804279, "comment_id": 64981611, "body": "When I check for errors, it appears that it does show an error when there&#39;s no receiver but it doesn&#39;t block, that&#39;s nice to know."}], "answers": [{"tags": [], "owner": {"reputation": 6241, "user_id": 3672465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PAHIc.gif?s=128&g=1", "display_name": "Beejor", "link": "https://stackoverflow.com/users/3672465/beejor"}, "is_accepted": false, "score": 0, "last_activity_date": 1555280900, "creation_date": 1555280900, "answer_id": 55680585, "question_id": 38804279, "link": "https://stackoverflow.com/questions/38804279/where-does-named-pipe-fifo-data-go-when-reader-disconnects/55680585#55680585", "title": "Where does named pipe (FIFO) data go when reader disconnects?", "body": "<p>A FIFO requires at least one source and one destination for data to get transferred anywhere. A reader alone waits to pull from someone, and a writer alone waits to send to someone. In this way, there are no gaps in a one-to-one pipe.</p>\n\n<p>So if you're still trying to read or write from one end of a disconnected or nonexistent pipe, the answer is that <strong>the data is going nowhere</strong>; the pipe is \"blocked\" and can hold no data of its own. So it depends on how your code handles this situation.</p>\n\n<p>In <code>producer.go</code>, the loop continues to run even when there's no longer a connection. Because <code>Fprintf</code> or <code>MultiWriter</code> don't raise a code-stopping error for whatever reason. In this case you could either add a check in the loop or an event handler for the <code>fifo</code> object's disconnection.</p>\n\n<p>The reason it seems that there's a gap of disappearing data, is because the loop continues to iterate for <code>i</code> and generate strings it can't send.</p>\n"}], "owner": {"reputation": 2005, "user_id": 910553, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/9101644/picture?type=large", "display_name": "Scott Frazer", "link": "https://stackoverflow.com/users/910553/scott-frazer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1555280900, "creation_date": 1470486287, "question_id": 38804279, "link": "https://stackoverflow.com/questions/38804279/where-does-named-pipe-fifo-data-go-when-reader-disconnects", "title": "Where does named pipe (FIFO) data go when reader disconnects?", "body": "<p>Let's say I have a <code>producer.go</code> and <code>consumer.go</code>.  The <code>consumer.go</code> reads from a UNIX named pipe, and the producer writes to the named pipe.</p>\n\n<p>As expected, If you start up <strong>just one</strong> of the producer or consumer programs, it hangs because there's no reader or writer on the other side of the pipe.</p>\n\n<p>Now, If I start both programs, then immediately CTRL-C from the consumer, the producer continues sending data to the pipe and as far as I can tell there's no limit to the size of that data (I've sent 80MB)</p>\n\n<p>If I start the consumer program again (while the producer is still running), it starts pulling data off of the named pipe, but not the data that I \"missed\" while the consumer program was not running.</p>\n\n<p>My question is: <strong>When a reader of a named pipe disconnects, what happens to the data that's sent to the named pipe?</strong></p>\n\n<p>Here are my <code>consumer.go</code> and <code>producer.go</code> programs:</p>\n\n<p>consumer.go</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"syscall\"\n)\n\nfunc main() {\n    syscall.Mkfifo(\"fifo0\", 0777)\n    fp, err := os.OpenFile(\"fifo0\", os.O_RDONLY, 0777)\n    if err != nil {\n        log.Fatalf(\"Could not open fifo0: %s\", err)\n    }\n    tee := io.TeeReader(fp, os.Stdout)\n    ioutil.ReadAll(tee)\n}\n</code></pre>\n\n<p>producer.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n    \"strings\"\n    \"time\"\n)\n\nfunc main() {\n    dots := strings.Repeat(\".\", 990)\n    fifo, err := os.OpenFile(\"fifo0\", os.O_WRONLY, 0777)\n    if err != nil {\n        log.Fatalf(\"Could not open fifo0: %s\", err)\n    }\n    defer fifo.Close()\n    w := io.MultiWriter(os.Stdout, fifo)\n    for i := 0; i &lt; 8000; i++ {\n        fmt.Fprintf(w, \"%010d%s\\n\", i, dots)\n        time.Sleep(time.Millisecond * 10)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "types"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1470467736, "post_id": 38801540, "comment_id": 64972651, "body": "The reason of the error, is because your function is accepting just string, so why you&#39;re converting the id? You could just pass it to your function as it is."}, {"owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1470469576, "post_id": 38801540, "comment_id": 64973023, "body": "I need to pass that as int for mysql where clause. Thats why i&#39;m converting the id"}], "answers": [{"comments": [{"owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "edited": false, "score": 0, "creation_date": 1470469458, "post_id": 38801638, "comment_id": 64972994, "body": "Thanks so much. That helps a lot"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 4, "last_activity_date": 1473768583, "last_edit_date": 1473768583, "creation_date": 1470468004, "answer_id": 38801638, "question_id": 38801540, "link": "https://stackoverflow.com/questions/38801540/how-do-i-write-a-function-that-accepts-both-string-and-int64-types-in-go/38801638#38801638", "title": "How do I write a function that accepts both string and int64 types in Go?", "body": "<p>Use <code>interface{}</code> like this working sample:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"errors\"\n\nfunc GetMessage(id interface{}) error {\n    //fmt.Printf(\"v:%v\\tT: %[1]T \\n\", id)\n    switch v := id.(type) {\n    case string:\n        fmt.Println(\"Hello \" + v)\n    case int64:\n        fmt.Println(v + 101)\n    default:\n        //panic(\"Unknown type: id.\")\n        return errors.New(\"Unknown type: id.\")\n    }\n    return nil\n}\n\nfunc main() {\n    message_id := \"World\"\n    id := int64(101)\n    GetMessage(message_id)\n    GetMessage(id)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Hello World\n202\n</code></pre>\n"}], "owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 38801638, "answer_count": 1, "score": 1, "last_activity_date": 1473768583, "creation_date": 1470467183, "last_edit_date": 1470468349, "question_id": 38801540, "link": "https://stackoverflow.com/questions/38801540/how-do-i-write-a-function-that-accepts-both-string-and-int64-types-in-go", "title": "How do I write a function that accepts both string and int64 types in Go?", "body": "<p>I have function that looks like this</p>\n\n<pre><code>func GetMessage(id string, by string) error {\n    // mysql query goes here\n}\n</code></pre>\n\n<p>I have <code>message_id</code> which is string and <code>id</code> which is primary key.</p>\n\n<p>I would like to accept both types for id parameter.</p>\n\n<p>I have tried like this</p>\n\n<pre><code>if (by == \"id\") {\n        int_id, err := strconv.ParseInt(id, 10, 64)\n        if err != nil {\n            panic(err)\n        }\n        id = int_id\n    }\n</code></pre>\n\n<p>But I'm getting error like </p>\n\n<pre><code>cannot use int_id (type int64) as type string in assignment\n</code></pre>\n\n<p>can someone help me?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["loops", "go", "channel", "pause"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1470450454, "post_id": 38798863, "comment_id": 64969983, "body": "Instead of having an infinite loop, couldn&#39;t you just block waiting to receive something on the resume channel?"}], "answers": [{"comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 2, "creation_date": 1470460686, "post_id": 38800758, "comment_id": 64971371, "body": "nice touch, handling quit in the paused state :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 8, "last_activity_date": 1470638564, "last_edit_date": 1470638564, "creation_date": 1470460096, "answer_id": 38800758, "question_id": 38798863, "link": "https://stackoverflow.com/questions/38798863/golang-pause-a-loop-in-a-goroutine-with-channels/38800758#38800758", "title": "Golang pause a loop in a goroutine with channels", "body": "<p>Pause a loop in a goroutine with channels, use <code>play</code>, <code>pause</code> and <code>quit</code> channels like this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport \"sync\"\n\nfunc routine() {\n    for {\n        select {\n        case &lt;-pause:\n            fmt.Println(\"pause\")\n            select {\n            case &lt;-play:\n                fmt.Println(\"play\")\n            case &lt;-quit:\n                wg.Done()\n                return\n            }\n        case &lt;-quit:\n            wg.Done()\n            return\n        default:\n            work()\n        }\n    }\n}\n\nfunc main() {\n    wg.Add(1)\n    go routine()\n\n    time.Sleep(1 * time.Second)\n    pause &lt;- struct{}{}\n\n    time.Sleep(1 * time.Second)\n    play &lt;- struct{}{}\n\n    time.Sleep(1 * time.Second)\n    pause &lt;- struct{}{}\n\n    time.Sleep(1 * time.Second)\n    play &lt;- struct{}{}\n\n    time.Sleep(1 * time.Second)\n    close(quit)\n\n    wg.Wait()\n    fmt.Println(\"done\")\n}\n\nfunc work() {\n    time.Sleep(250 * time.Millisecond)\n    i++\n    fmt.Println(i)\n}\n\nvar play = make(chan struct{})\nvar pause = make(chan struct{})\nvar quit = make(chan struct{})\nvar wg sync.WaitGroup\nvar i = 0\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>1\n2\n3\n4\npause\nplay\n5\n6\n7\n8\npause\nplay\n9\n10\n11\n12\ndone\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 1, "creation_date": 1470653814, "post_id": 38817711, "comment_id": 65020465, "body": "you made it so complex and complicated."}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470654254, "post_id": 38817711, "comment_id": 65020732, "body": "You may want to create a type (say, <code>type Player</code>) to encapsulate the variables (as private fields) and closures (as public methods, like <code>Start()</code>, <code>Pause()</code>, <code>Play()</code>, etc.). The OP showed me his original problem, and there are more states in it. Therefore, the <code>select</code>-<code>case</code> must be &quot;flattened&quot; in order to make it scalable."}], "tags": [], "owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "is_accepted": true, "score": 5, "last_activity_date": 1470653850, "last_edit_date": 1495542810, "creation_date": 1470597888, "answer_id": 38817711, "question_id": 38798863, "link": "https://stackoverflow.com/questions/38798863/golang-pause-a-loop-in-a-goroutine-with-channels/38817711#38817711", "title": "Golang pause a loop in a goroutine with channels", "body": "<h3>The problem:</h3>\n\n<p><a href=\"https://stackoverflow.com/a/38800758/142239\">Amd's answer</a> is essentially a state machine built with Go's <code>select</code> statement. One problem I noticed is that when you add more functionalities (like \"fast forward\", \"slow motion\", etc.), more <code>case</code>s have to be added to the <code>select</code> in the \"pause\" <code>case</code>.</p>\n\n<h3>Receiving from <code>nil</code> channels:</h3>\n\n<p>In Go, receiving from (or sending to) a <code>nil</code> channel results in \"blocking forever\". This in fact is a very important feature to implement the following trick: In a <code>for</code>-<code>select</code> pattern, if you set a <code>case</code> <code>channel</code> to <code>nil</code>, the corresponding <code>case</code> will not be matched in the next iteration. In other words, the <code>case</code> is \"disabled\".</p>\n\n<h3>Receiving from closed channels:</h3>\n\n<p>In Go, receiving from a closed channel always returns immediately. Therefore, you may replace your <code>default</code> <code>case</code> by a variable holding a closed channel. When the variable holds the closed channel, it behaves like the <code>default</code> <code>case</code>; However, when the variable holds <code>nil</code>, the <code>case</code> is never matched, having the \"pause\" behavior.</p>\n\n<h3>My ideas:</h3>\n\n<ul>\n<li>Modify your <code>default</code> case: read from a closed channel instead. (explained above);</li>\n<li>Make a backup of the closed channel. When <code>pause</code> is needed, set the \"default case channel\" to <code>nil</code>; when <code>play</code> is needed, set it to the backup;</li>\n<li>Make a \"continue\" channel to ask the <code>select</code> statement to re-read the variables after assignment;</li>\n<li>In fact, the \"quit\" channel can be reused as the \"continue\" channel: send <code>struct{}{}</code> when \"continue\" is needed; <code>close()</code> when \"quit\" is needed;</li>\n<li>Encapsulate the resources in closures, and ensure that cleanup is done;</li>\n<li>Ensure that when <code>start()</code> is not yet called, no channels or go routines are created, in order to prevent leaks.</li>\n</ul>\n\n<h3>My implementation (also available at <kbd><a href=\"https://play.golang.org/p/dui8rqMFbJ\" rel=\"nofollow noreferrer\">The Go Playground</a></kbd>):</h3>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport \"sync\"\n\nfunc prepare() (start, pause, play, quit, wait func()) {\n    var (\n        chWork       &lt;-chan struct{}\n        chWorkBackup &lt;-chan struct{}\n        chControl    chan struct{}\n        wg           sync.WaitGroup\n    )\n\n    routine := func() {\n        defer wg.Done()\n\n        i := 0\n        for {\n            select {\n            case &lt;-chWork:\n                fmt.Println(i)\n                i++\n                time.Sleep(250 * time.Millisecond)\n            case _, ok := &lt;-chControl:\n                if ok {\n                    continue\n                }\n                return\n            }\n        }\n    }\n\n    start = func() {\n        // chWork, chWorkBackup\n        ch := make(chan struct{})\n        close(ch)\n        chWork = ch\n        chWorkBackup = ch\n\n        // chControl\n        chControl = make(chan struct{})\n\n        // wg\n        wg = sync.WaitGroup{}\n        wg.Add(1)\n\n        go routine()\n    }\n\n    pause = func() {\n        chWork = nil\n        chControl &lt;- struct{}{}\n        fmt.Println(\"pause\")\n    }\n\n    play = func() {\n        fmt.Println(\"play\")\n        chWork = chWorkBackup\n        chControl &lt;- struct{}{}\n    }\n\n    quit = func() {\n        chWork = nil\n        close(chControl)\n        fmt.Println(\"quit\")\n    }\n\n    wait = func() {\n        wg.Wait()\n    }\n\n    return\n}\n\nfunc sleep() {\n    time.Sleep(1 * time.Second)\n}\n\nfunc main() {\n    start, pause, play, quit, wait := prepare()\n\n    sleep()\n    start()\n    fmt.Println(\"start() called\")\n\n    sleep()\n    pause()\n\n    sleep()\n    play()\n\n    sleep()\n    pause()\n\n    sleep()\n    play()\n\n    sleep()\n    quit()\n\n    wait()\n    fmt.Println(\"done\")\n}\n</code></pre>\n\n<h3>Extras:</h3>\n\n<p>If you really want to implement \"fast forward\" and \"slow motion\", simply:</p>\n\n<ul>\n<li>Refactor the magic <code>250</code> to a variable;</li>\n<li>Return one more closure from <code>prepare()</code> used to set the variable and send <code>struct{}{}</code> to <code>chControl</code>.</li>\n</ul>\n\n<p>Please be reminded that \"race conditions\" are ignored for this simple case.</p>\n\n<h3>References:</h3>\n\n<p><a href=\"https://golang.org/ref/spec#Send_statements\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Send_statements</a></p>\n\n<blockquote>\n  <p>A send on a closed channel proceeds by causing a run-time panic. A send on a nil channel blocks forever.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Receive_operator</a></p>\n\n<blockquote>\n  <p>Receiving from a nil channel blocks forever. A receive operation on a closed channel can always proceed immediately, yielding the element type's zero value after any previously sent values have been received.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/ref/spec#Close\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Close</a></p>\n\n<blockquote>\n  <p>Sending to or closing a closed channel causes a run-time panic. Closing the nil channel also causes a run-time panic. After calling close, and after any previously sent values have been received, receive operations will return the zero value for the channel's type without blocking. The multi-valued receive operation returns a received value along with an indication of whether the channel is closed.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2437, "user_id": 1914002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ae822f979980ea450842c7cc36baeb94?s=128&d=identicon&r=PG", "display_name": "dapangmao", "link": "https://stackoverflow.com/users/1914002/dapangmao"}, "is_accepted": false, "score": 0, "last_activity_date": 1520362237, "creation_date": 1520362237, "answer_id": 49137996, "question_id": 38798863, "link": "https://stackoverflow.com/questions/38798863/golang-pause-a-loop-in-a-goroutine-with-channels/49137996#49137996", "title": "Golang pause a loop in a goroutine with channels", "body": "<p>Modified according to @user6169399 above that uses a channel </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"sync\"\n)\n\nvar i int\n\nfunc work() {\n    time.Sleep(250 * time.Millisecond)\n    i++\n    fmt.Println(i)\n}\n\nfunc routine(command &lt;- chan string, wg *sync.WaitGroup) {\n    defer wg.Done()\n    var status = \"play\"\n    for {\n        select {\n        case cmd := &lt;- command:\n            fmt.Println(cmd)\n            switch cmd {\n            case \"stop\":\n                return\n            case \"pause\":\n                status = \"pause\"\n            default:\n                status = \"play\"\n            }\n        default:\n            if status == \"play\" {\n                work()\n            }\n        }\n    }\n}\n\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(1)\n    command := make(chan string)\n    go routine(command, &amp;wg)\n    time.Sleep(1 * time.Second)\n    command &lt;- \"pause\"\n    time.Sleep(1 * time.Second)\n    command &lt;- \"play\"\n    time.Sleep(1 * time.Second)\n    command &lt;- \"stop\"\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8244, "favorite_count": 5, "accepted_answer_id": 38817711, "answer_count": 3, "score": 3, "last_activity_date": 1613186563, "creation_date": 1470438265, "last_edit_date": 1470639636, "question_id": 38798863, "link": "https://stackoverflow.com/questions/38798863/golang-pause-a-loop-in-a-goroutine-with-channels", "title": "Golang pause a loop in a goroutine with channels", "body": "<p>I have a function that is launched as a goroutine:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (bt *BlinkyTape) finiteLoop(frames []Frame, repeat int, delay time.Duration) {\n    bt.isPlaying = true\nL:\n    for i := 0; i &lt; repeat; i++ {\n        select {\n        case &lt;-bt.stop:\n            break L\n        default:\n            bt.playFrames(frames, delay)\n        }\n    }\n    bt.isPlaying = false\n}\n</code></pre>\n\n<p>This function uses channels so it is possible to break the loop (loop can be finite or infinite)</p>\n\n<p>What I would like to implement is a way to pause the execution of the loop and of course being able to resume it.</p>\n\n<p>I was thinking to add another case to the select condition where I listen on another channel <code>pause</code>. If the case is executed, it enter in a new infinite loop that does nothing. Then it will need the same system as previously with a <code>resume</code> channel to break this loop.</p>\n\n<p>What do you think ? Is there a better way to achieve what I need ?</p>\n\n<p>Regards</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1470603984, "post_id": 38798594, "comment_id": 65003984, "body": "Question was, how print methods. Therefore the simples solution is: <b>godoc . Searcher</b> (replace . with name of package, if you want to ask to not current package)"}], "answers": [{"tags": [], "owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "is_accepted": true, "score": 0, "last_activity_date": 1470436436, "creation_date": 1470436436, "answer_id": 38798595, "question_id": 38798594, "link": "https://stackoverflow.com/questions/38798594/how-to-determine-the-method-set-of-an-interface-in-golang/38798595#38798595", "title": "How to determine the method set of an interface in Golang?", "body": "<p>Using reflection:</p>\n\n<pre><code>t := reflect.TypeOf(new(Searcher)).Elem()\nfmt.Println(t)\n\nfor i := 0; i &lt; t.NumMethod(); i++ {\n    fmt.Println(t.Method(i).Name)\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>main.Searcher\nClearSearches\nListSearches\nSearch\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 2, "last_activity_date": 1470591974, "creation_date": 1470591974, "answer_id": 38816886, "question_id": 38798594, "link": "https://stackoverflow.com/questions/38798594/how-to-determine-the-method-set-of-an-interface-in-golang/38816886#38816886", "title": "How to determine the method set of an interface in Golang?", "body": "<p><code>reflect</code> package is the right tool for this.Using reflection one can get the type information of a variable without knowing the type before hand . Here is a code snippet showing how to get the function names of functions defined as needed by an interface</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Searcher interface {\n    Search(query string) (found bool, err error)\n    ListSearches() []string\n    ClearSearches() (err error)\n}\n\nfunc main() {\n    t := reflect.TypeOf(struct{ Searcher }{})\n    for i := 0; i &lt; t.NumMethod(); i++ {\n        fmt.Println(t.Method(i).Name)\n    }\n}\n</code></pre>\n\n<p>Check the <a href=\"https://play.golang.org/p/vzPXxMgOql\" rel=\"nofollow\" title=\"golang playground\">golangplayground</a></p>\n"}], "owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 38798595, "answer_count": 2, "score": 0, "last_activity_date": 1470591974, "creation_date": 1470436436, "question_id": 38798594, "link": "https://stackoverflow.com/questions/38798594/how-to-determine-the-method-set-of-an-interface-in-golang", "title": "How to determine the method set of an interface in Golang?", "body": "<p>How would one print the method set of the following interface?</p>\n\n<pre><code>type Searcher interface {\n    Search(query string) (found bool, err error)\n    ListSearches() []string\n    ClearSearches() (err error)\n}\n</code></pre>\n\n<p>Such that </p>\n\n<pre><code>Search\nListSearches\nClearSearches\n</code></pre>\n\n<p>is printed out? (Without knowledge of a concrete type which implements it).</p>\n"}, {"tags": ["datetime", "go"], "comments": [{"owner": {"reputation": 18935, "user_id": 19405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b55a41a43ea0493fc64641a1ed295?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/19405/nobody"}, "edited": false, "score": 0, "creation_date": 1470435573, "post_id": 38798349, "comment_id": 64967288, "body": "+ is a special character in URLs."}], "answers": [{"tags": [], "owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "is_accepted": true, "score": 1, "last_activity_date": 1470436199, "last_edit_date": 1470436199, "creation_date": 1470435589, "answer_id": 38798486, "question_id": 38798349, "link": "https://stackoverflow.com/questions/38798349/why-does-go-modify-utc-time-when-passing-as-a-url-param/38798486#38798486", "title": "Why does Go modify UTC time when passing as a URL param?", "body": "<p>Maybe the question should be: Why does the (not shown) query string evaluate the value \"2014-11-17 23:02:03 0000 UTC\" when accessed?</p>\n\n<p>Since \"+\" in a <a href=\"https://en.wikipedia.org/wiki/Query_string\" rel=\"nofollow\">query string</a> will be treated as a space when parsed (this is a historic rule) ..</p>\n\n<blockquote>\n  <p>HTML 5 specifies the following transformation for submitting HTML forms with the \"get\" method to a web server .. <strong>SPACE is encoded as '+'</strong> or '%20'</p>\n</blockquote>\n\n<p>.. my hypothesis is the result of accessing the value in URL is really the following:</p>\n\n<pre><code>2014-11-17 23:02:03  0000 UTC\n                   ^^-- space space\n</code></pre>\n\n<p>A 'correct' URL would be <code>foo?time=2014-11-17+23:02:03+%2B0000+UTC</code>, encoding <code>+</code> as <code>%2B</code> so it is not parsed as a space. An equivalent URL would be generated if using programmatic methods to generate URLs instead of building one by hand / string concatenation.</p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 38798486, "answer_count": 1, "score": 0, "last_activity_date": 1470436199, "creation_date": 1470434647, "question_id": 38798349, "link": "https://stackoverflow.com/questions/38798349/why-does-go-modify-utc-time-when-passing-as-a-url-param", "title": "Why does Go modify UTC time when passing as a URL param?", "body": "<p>So I'm doing this code.</p>\n\n<p>I create a time, and pass it as an URL parameter. In my handler, I do this.</p>\n\n<pre><code>path := //some url + time.Now().String()\n\n// put into url and execute a request. \n\nupdatedAtVar := r.URL.Query()[\"updated_at\"][0]\nfmt.Println(updatedAtVar)\n</code></pre>\n\n<p>What is coming out of <code>time.Now().String()</code> is something like </p>\n\n<p><code>2014-11-17 23:02:03 +0000 UTC</code>.</p>\n\n<p>What is coming out of <code>r.URL.Query()[\"updated_at\"][0]</code> is</p>\n\n<p><code>2014-11-17 23:02:03 0000 UTC</code>.</p>\n\n<p>Why does this happen?</p>\n"}, {"tags": ["go", "stack-overflow"], "answers": [{"comments": [{"owner": {"reputation": 1037, "user_id": 1070486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a5ce3caa2e39211059ca4ee29ca1fdfe?s=128&d=identicon&r=PG", "display_name": "zgcharley", "link": "https://stackoverflow.com/users/1070486/zgcharley"}, "edited": false, "score": 0, "creation_date": 1470435597, "post_id": 38798460, "comment_id": 64967294, "body": "Then how can handle this fatal error? It will cause program crash."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1037, "user_id": 1070486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a5ce3caa2e39211059ca4ee29ca1fdfe?s=128&d=identicon&r=PG", "display_name": "zgcharley", "link": "https://stackoverflow.com/users/1070486/zgcharley"}, "edited": false, "score": 1, "creation_date": 1470435763, "post_id": 38798460, "comment_id": 64967340, "body": "You can&#39;t handle it, it&#39;s supposed to crash your program. There&#39;s a problem with your program if you&#39;re hitting this error."}, {"owner": {"reputation": 1037, "user_id": 1070486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a5ce3caa2e39211059ca4ee29ca1fdfe?s=128&d=identicon&r=PG", "display_name": "zgcharley", "link": "https://stackoverflow.com/users/1070486/zgcharley"}, "edited": false, "score": 2, "creation_date": 1470436123, "post_id": 38798460, "comment_id": 64967435, "body": "Unfortunately it is in a library i&#39;m using, I want to handle it in my level. Looks like no way to do it..."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 10, "last_activity_date": 1470609565, "last_edit_date": 1470609565, "creation_date": 1470435401, "answer_id": 38798460, "question_id": 38798311, "link": "https://stackoverflow.com/questions/38798311/how-to-catch-stack-overflow-error-in-golang/38798460#38798460", "title": "how to catch stack overflow error in golang", "body": "<p>What you see in the output is a \"fatal error\", not a panic. </p>\n\n<pre><code>fatal error: stack overflow\n</code></pre>\n\n<p>You can only use <code>recover()</code> to recover from panics. A stack overflow is a fatal error thrown by the runtime which causes the process to print a stack trace and exit.</p>\n"}, {"comments": [{"owner": {"reputation": 1037, "user_id": 1070486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a5ce3caa2e39211059ca4ee29ca1fdfe?s=128&d=identicon&r=PG", "display_name": "zgcharley", "link": "https://stackoverflow.com/users/1070486/zgcharley"}, "edited": false, "score": 0, "creation_date": 1470679374, "post_id": 38817051, "comment_id": 65036865, "body": "thanks for your details explanation, it&#39;s helpful to understand the error handing in go. But specific to the question, I have to choose JimB&#39;s answer as resolution."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 1037, "user_id": 1070486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a5ce3caa2e39211059ca4ee29ca1fdfe?s=128&d=identicon&r=PG", "display_name": "zgcharley", "link": "https://stackoverflow.com/users/1070486/zgcharley"}, "edited": false, "score": 0, "creation_date": 1470721353, "post_id": 38817051, "comment_id": 65050801, "body": "@zgcharley You may use the function defined above as RecoverPanic and use as mentioned as a generic solution for the same . The function specifies ignore panic is the panic is of a specific type which in your case could be &quot;stack overflow&quot;"}, {"owner": {"reputation": 1138, "user_id": 296066, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/940b69b965704253eca438cdfaf72b15?s=128&d=identicon&r=PG", "display_name": "metalim", "link": "https://stackoverflow.com/users/296066/metalim"}, "edited": false, "score": 2, "creation_date": 1542789011, "post_id": 38817051, "comment_id": 93690622, "body": "@SarathSadasivanPillai Just to clarify: as it was stated in the other answer, stack overflow is not a <code>panic</code>, but <code>fatal error</code>, and cannot be recovered with <code>recover()</code>. So, there are not 2, but at least 3 ways to report errors in Go: return error code, panic, and fatal error."}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 0, "last_activity_date": 1470721442, "last_edit_date": 1470721442, "creation_date": 1470593230, "answer_id": 38817051, "question_id": 38798311, "link": "https://stackoverflow.com/questions/38798311/how-to-catch-stack-overflow-error-in-golang/38817051#38817051", "title": "how to catch stack overflow error in golang", "body": "<p>In Golang there are two ways of error propagation one is to return error which is mostly function dependent non fatal errors. Other one is to <strong>panic</strong> which is propagated through function call stack till end of the process or till it reached <strong>recover</strong></p>\n\n<p><strong>Panic</strong> is a built-in function that stops the ordinary flow of control and begins panicking. When the function F calls panic, execution of F stops, any deferred functions in F are executed normally, and then F returns to its caller. To the caller, F then behaves like a call to panic. The process continues up the stack until all functions in the current goroutine have returned, at which point the program crashes. Panics can be initiated by invoking panic directly. They can also be caused by runtime errors, such as out-of-bounds array accesses.</p>\n\n<p><strong>Recover</strong> is a built-in function that regains control of a panicking goroutine. Recover is only useful inside deferred functions. During normal execution, a call to recover will return nil and have no other effect. If the current goroutine is panicking, a call to recover will capture the value given to panic and resume normal execution.</p>\n\n<p>If you want to ignore a <strong>panic</strong> you may call recover and inspect the panic message to see if the panic message is of an expected type which is <em>ok</em> to ignore </p>\n\n<p>Here is how you may do it</p>\n\n<pre><code>//RecoverPanic recovers from panic given the message String\n//if no message string is given it recovers from all panics\n//Example:\n//  defer RecoverPanic(\"stack overflow\")\n//The above satatement recovers any function from panic that happen\n//due to stackoverflow\nfunc RecoverPanic(msg string) {\n        if r := recover(); r != nil {\n                if msg != \"\" {\n                        if r != msg {\n                                panic(r)\n                        }\n                }\n        }\n}\n</code></pre>\n\n<p>After this you may call,at the beginning of function call</p>\n\n<pre><code>funtion foo(){\n    defer RecoverPanic(\"stack overflow\")\n    ......\n}\n</code></pre>\n\n<p>There are sometimes <strong>panic</strong> could not be hadled,for example panic on trying to allocate memory due to insufficient memory that should not be tried to handle as the function to handle itself may panic as there is no memory to hold its data</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10176213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I9gF2fRxN20/AAAAAAAAAAI/AAAAAAAAABs/ez_A987I5Hs/photo.jpg?sz=128", "display_name": "Bhanu Teja", "link": "https://stackoverflow.com/users/10176213/bhanu-teja"}, "is_accepted": false, "score": -1, "last_activity_date": 1578563367, "creation_date": 1578563367, "answer_id": 59661229, "question_id": 38798311, "link": "https://stackoverflow.com/questions/38798311/how-to-catch-stack-overflow-error-in-golang/59661229#59661229", "title": "how to catch stack overflow error in golang", "body": "<p>by using panic &amp; recover, you ca achieve to catch an error in golang</p>\n"}], "owner": {"reputation": 1037, "user_id": 1070486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a5ce3caa2e39211059ca4ee29ca1fdfe?s=128&d=identicon&r=PG", "display_name": "zgcharley", "link": "https://stackoverflow.com/users/1070486/zgcharley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5414, "favorite_count": 2, "accepted_answer_id": 38798460, "answer_count": 3, "score": 5, "last_activity_date": 1578563367, "creation_date": 1470434409, "question_id": 38798311, "link": "https://stackoverflow.com/questions/38798311/how-to-catch-stack-overflow-error-in-golang", "title": "how to catch stack overflow error in golang", "body": "<p>Is there any way to catch stack overflow error in golang? Currently I'm using go recover() do this job(below code snippet), looks like stack overflow error can't be caught.</p>\n\n<pre><code>defer func() {\n            if x := recover(); x != nil {\n                log.Error(\"In recover, cought error====================\", x)\n            }\n        }()\n\nfn(xxx)\n</code></pre>\n"}, {"tags": ["datetime", "go", "time"], "answers": [{"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470433213, "post_id": 38798084, "comment_id": 64966604, "body": "lol..yes. I used the wrong layout. I have no idea what layout to use. I just tried <code>&quot;2006-01-02 15:04:05 -0700 MST&quot;</code> and it didn&#39;t work either.  Was wondering if someone knew what layout to use because this is a common format.  I&#39;m literally going <code>time.Now()</code>, converting it to String, and passing it in to unpack (writing an integration test)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470433278, "post_id": 38798084, "comment_id": 64966622, "body": "@praks5432 What do you mean? It&#39;s not working for you? Click on the Playground link in my answer and try it yourself."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470433393, "post_id": 38798084, "comment_id": 64966658, "body": "I pasted in <code>2014-11-17 23:02:03 0000 UTC</code> which is the output of <code>time.Now().String()</code> (I froze time - for a test)  I get this error in your playground <code>0001-01-01 00:00:00 +0000 UTC parsing time &quot;2014-11-17 23:02:03  0000 UTC&quot; as &quot;2006-01-02 15:04:05 -0700 MST&quot;: cannot parse &quot;UTC&quot; as &quot;-0700&quot;</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470433443, "post_id": 38798084, "comment_id": 64966671, "body": "@praks5432 You have a missing <code>+</code> sign in your input, as part of the zone offset."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470433527, "post_id": 38798084, "comment_id": 64966700, "body": "Yes. I know. I don&#39;t control that. I&#39;m passing in <code>time.Now().String()</code>. That&#39;s from Go. How can we have a function in one package that won&#39;t take the output of another function in the same package that seem to be designed to work together?"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470433580, "post_id": 38798084, "comment_id": 64966716, "body": "I&#39;d rather not take the time from my url, break it apart, add the plus and then convert to time. There <i>should</i> be an easy way to do this."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470434107, "post_id": 38798084, "comment_id": 64966876, "body": "So I pass this time in as an URL parameter. When I unpack that using <code>r.URL.Query()[&quot;updated_at&quot;]</code>, I get that output. I&#39;m creating the time like this - <code>time.Now().String()</code>, and <code>2014-11-17 23:02:03 0000 UTC</code> is what is coming back to me as a URL param."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470435248, "post_id": 38798084, "comment_id": 64967210, "body": "@praks5432 You didn&#39;t say anything about including times in URLs unencoded. <code>+</code> is a special symbol which means a space. See edit."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1470435438, "post_id": 38798084, "comment_id": 64967253, "body": "ohhhhhhhh is that just using <code>url.Encode</code> on my path?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1475846635, "last_edit_date": 1475846635, "creation_date": 1470433070, "answer_id": 38798084, "question_id": 38798043, "link": "https://stackoverflow.com/questions/38798043/convert-utc-string-to-time-object/38798084#38798084", "title": "Convert UTC string to time object", "body": "<p>Most likely you used a wrong layout, and you didn't check the returned error.</p>\n\n<p>The layout must be this date/time, in the format your input time is:</p>\n\n<pre><code>Mon Jan 2 15:04:05 -0700 MST 2006\n</code></pre>\n\n<p>See this working code:</p>\n\n<pre><code>layout := \"2006-01-02 15:04:05 -0700 MST\"\nt, err := time.Parse(layout, \"2014-11-17 23:02:03 +0000 UTC\")\nfmt.Println(t, err)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/hW-XeuJpXn\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2014-11-17 23:02:03 +0000 UTC &lt;nil&gt;\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>In your question you included a <code>+</code> sign in your input time (as part of the zone offset), but you have error with times of other formats.</p>\n\n<p><a href=\"https://golang.org/pkg/time/#Time.String\" rel=\"noreferrer\"><code>Time.String()</code></a> uses the following format string:</p>\n\n<pre><code>\"2006-01-02 15:04:05.999999999 -0700 MST\"\n</code></pre>\n\n<p>So either use this to parse the times, or use <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"noreferrer\"><code>Time.Format()</code></a> to produce your string representations where you can specify the layout, so you can use the same layout to parse the time strings.</p>\n\n<p><strong>2nd round:</strong></p>\n\n<p>You're including your time strings in URLs. The <code>+</code> sign is a special character in URL encoding: it denotes the space. So the <code>+</code> gets converted to space (and so it vanishes from your time string). Use proper URL encoding! Check out the <a href=\"https://golang.org/pkg/net/url/\" rel=\"noreferrer\"><code>net/url</code></a> package, and <a href=\"https://golang.org/pkg/net/url/#example_Values\" rel=\"noreferrer\">this example</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 1, "creation_date": 1470433699, "post_id": 38798159, "comment_id": 64966759, "body": "Yes, I understand. But what I&#39;m doing is using <code>time.Now().String</code> as an url parameter. I&#39;m then unpacking that parameter and trying to convert back to a time (this is a test that I&#39;m writing).   The output I get from <code>time.Now().String</code> once it is unpacked is <code>2014-11-17 23:02:03  0000 UTC</code>, which is not being parsed.   I know I have the wrong layout. I&#39;m trying to find which layout."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 0, "last_activity_date": 1470433467, "creation_date": 1470433467, "answer_id": 38798159, "question_id": 38798043, "link": "https://stackoverflow.com/questions/38798043/convert-utc-string-to-time-object/38798159#38798159", "title": "Convert UTC string to time object", "body": "<p>You are likely using the wrong layout. As explained in <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow\"><code>time.Parse</code></a>, you need to specify a layout that helps Go to understand how the date passed as input is formatted.</p>\n\n<p>There are predefined layouts (like the ones you were using), but none matches your input. Hence you need to define a custom layout.</p>\n\n<p>A layout uses the following date as reference:</p>\n\n<pre><code>Mon Jan 2 15:04:05 MST 2006\n</code></pre>\n\n<p>The layout is nothing else that a representation of that date, that matches the representation of your input:</p>\n\n<pre><code>t, err := time.Parse(\"2006-01-02 15:04:05 -0700 MST\", \"2014-11-17 23:02:03 +0000 UTC\")\n</code></pre>\n\n<p>Also remember to check <code>err</code> for errors. It's likely your attempts returned an error, but you didn't check it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    t, err := time.Parse(\"2006-01-02 15:04:05 -0700 UTC\", \"2014-11-17 23:02:03 +0000 UTC\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n    fmt.Println(t)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 7988409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c641096840249c7ee9afece9fa3592?s=128&d=identicon&r=PG&f=1", "display_name": "derekjones562", "link": "https://stackoverflow.com/users/7988409/derekjones562"}, "is_accepted": false, "score": 4, "last_activity_date": 1570668418, "creation_date": 1570668418, "answer_id": 58313983, "question_id": 38798043, "link": "https://stackoverflow.com/questions/38798043/convert-utc-string-to-time-object/58313983#58313983", "title": "Convert UTC string to time object", "body": "<p>Didn't see this yet but for those that don't know the formats, time has the formats builtin as constants. so you can reference them when parsing or formating. </p>\n\n<pre><code>time.Parse(time.RFC3339, &lt;your time.Time object here&gt;)\n&lt;time.Time object&gt;.Format(time.RFC3339) //or other type of formats\n</code></pre>\n\n<p>Here they are for reference</p>\n\n<pre><code>ANSIC       = \"Mon Jan _2 15:04:05 2006\"\nUnixDate    = \"Mon Jan _2 15:04:05 MST 2006\"\nRubyDate    = \"Mon Jan 02 15:04:05 -0700 2006\"\nRFC822      = \"02 Jan 06 15:04 MST\"\nRFC822Z     = \"02 Jan 06 15:04 -0700\" // RFC822 with numeric zone\nRFC850      = \"Monday, 02-Jan-06 15:04:05 MST\"\nRFC1123     = \"Mon, 02 Jan 2006 15:04:05 MST\"\nRFC1123Z    = \"Mon, 02 Jan 2006 15:04:05 -0700\" // RFC1123 with numeric zone\nRFC3339     = \"2006-01-02T15:04:05Z07:00\"\nRFC3339Nano = \"2006-01-02T15:04:05.999999999Z07:00\"\nKitchen     = \"3:04PM\"\n</code></pre>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15258, "favorite_count": 1, "accepted_answer_id": 38798084, "answer_count": 3, "score": 6, "last_activity_date": 1570668418, "creation_date": 1470432792, "last_edit_date": 1566400346, "question_id": 38798043, "link": "https://stackoverflow.com/questions/38798043/convert-utc-string-to-time-object", "title": "Convert UTC string to time object", "body": "<p>I have this datetime, or something that looks like it.</p>\n\n<pre><code>2014-11-17 23:02:03 +0000 UTC\n</code></pre>\n\n<p>I want to convert this to a time object and I've been unable to produce any output from <code>time.Parse</code> apart from:</p>\n\n<pre><code>0001-01-01 00:00:00 +0000 UTC\n</code></pre>\n\n<p>I've tried these layouts:</p>\n\n<pre><code>time.RFC3339\n0001-01-01 00:00:00 0000 UTC\n2016-10-10\ntime.UnixDate\n</code></pre>\n\n<p>And a few more - none have worked.</p>\n\n<p>This is how I'm calling <code>parse</code> :</p>\n\n<pre><code>updatedAt, err := time.Parse(time.UnixDate, updatedAtVar)\n</code></pre>\n\n<p>How do I create a time object from a string?</p>\n"}, {"tags": ["linux", "go", "cgo"], "comments": [{"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470600015, "post_id": 38797098, "comment_id": 65002962, "body": "Have you tried replacing <code>$CC</code> to <code>$CC_FOR_TARGET</code>? See <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "reply_to_user": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "edited": false, "score": 0, "creation_date": 1470659519, "post_id": 38797098, "comment_id": 65024073, "body": "@SiuChingPong-AsukaKenji- $CC_FOR_TARGET is to be used when building the toolchain using make.bash. $CC is used for cross-compiling a program. I tried rebuilding the toolchain with CC_FOR_TARGET set, but I get the same error when running the go tool."}, {"owner": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "edited": false, "score": 0, "creation_date": 1470671573, "post_id": 38797098, "comment_id": 65032504, "body": "Maybe something like <code>--sysroot &#47;am335x_toolchain&#47;</code> both in <code>CGO_CFLAGS</code> and <code>CGO_LDFLAGS</code> would help?"}, {"owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "reply_to_user": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "edited": false, "score": 0, "creation_date": 1470679673, "post_id": 38797098, "comment_id": 65037027, "body": "@RomanKhimov I added <code>--sysroot &#47;am335x_toolchain&#47;</code> to both <code>CGO_CFLAGS</code> and <code>CGO_LDFLAGS</code> and it worked. Thank you for your help. If you writeup an answer I&#39;ll mark it as correct."}], "answers": [{"tags": [], "owner": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "is_accepted": true, "score": 6, "last_activity_date": 1470680253, "creation_date": 1470680253, "answer_id": 38835938, "question_id": 38797098, "link": "https://stackoverflow.com/questions/38797098/cgo-cross-compile-failing-to-find-libraries/38835938#38835938", "title": "cgo cross-compile failing to find libraries", "body": "<p>So the problem is that for the cross-compiler to properly find its headers and libraries it needs a <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Directory-Options.html\" rel=\"noreferrer\"><code>--sysroot</code> option</a>, in your case <code>--sysroot /am335x_toolchain/</code> added both to CGO_CFLAGS and CGO_LDFLAGS.</p>\n"}], "owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2409, "favorite_count": 2, "accepted_answer_id": 38835938, "answer_count": 1, "score": 2, "last_activity_date": 1470680253, "creation_date": 1470427748, "last_edit_date": 1470659756, "question_id": 38797098, "link": "https://stackoverflow.com/questions/38797098/cgo-cross-compile-failing-to-find-libraries", "title": "cgo cross-compile failing to find libraries", "body": "<p>I've written a wrapper around the semaphore functions in linux. This worked for me in the past on Go 1.3 and Go 1.4, but I needed to rebuild my application using this wrapper and it no longer builds with Go 1.6.2 or Go 1.7rc5.</p>\n\n<p>I wrote a simple test application that produces the same errors:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"linux/semaphore\"\n)\n\nfunc main() {\n    var sema semaphore.Semaphore\n    if err := sema.Open(\"/test\", 0644, 1); err != nil {\n        fmt.Printf(\"%v\\n\", err)\n        os.Exit(1)\n    }\n    if err := sema.TryWait(); err != nil {\n        fmt.Printf(\"%v\\n\", err)\n        os.Exit(1)\n    }\n    if err := sema.Post(); err != nil {\n        fmt.Printf(\"%v\\n\", err)\n        os.Exit(1)\n    }\n}\n</code></pre>\n\n<p>Now the program does compile natively (linux/amd64), my issue is when I try to cross-compile for linux/arm (Ti am3352).</p>\n\n<p>Previously all I had to do was:</p>\n\n<pre><code>GOOS=linux GOARCH=arm GOARM=7 CGO_ENABLED=1 CC=/am335x_toolchain/bin/armv7l-timesys-linux-gnueabi-gcc go build\n</code></pre>\n\n<p>Which now gives the following error:</p>\n\n<pre><code># runtime/cgo\n/tmp/go-build820923984/runtime/cgo/_obj/_cgo_export.c:2:20: fatal error: stdlib.h: No such file or directory\n #include &lt;stdlib.h&gt;\n                    ^\ncompilation terminated.\n</code></pre>\n\n<p>So I specified the include path:</p>\n\n<pre><code>GOOS=linux GOARCH=arm GOARM=7 CGO_ENABLED=1 CC=/am335x_toolchain/bin/armv7l-timesys-linux-gnueabi-gcc CGO_CFLAGS=\"-I/am335x_toolchain/include\" go build\n# runtime/cgo\n/am335x_toolchain/bin/../lib/gcc/armv7l-timesys-linux-gnueabi/4.8.3/../../../../armv7l-timesys-linux-gnueabi/bin/ld: cannot find Scrt1.o: No such file or directory\n/am335x_toolchain/bin/../lib/gcc/armv7l-timesys-linux-gnueabi/4.8.3/../../../../armv7l-timesys-linux-gnueabi/bin/ld: cannot find crti.o: No such file or directory\n/am335x_toolchain/bin/../lib/gcc/armv7l-timesys-linux-gnueabi/4.8.3/../../../../armv7l-timesys-linux-gnueabi/bin/ld: cannot find -lpthread\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Eventually I got to this, which still doesn't work:</p>\n\n<pre><code>GOOS=linux GOARCH=arm GOARM=7 CGO_ENABLED=1 CC=/am335x_toolchain/bin/armv7l-timesys-linux-gnueabi-gcc CGO_LDFLAGS=\"-L/am335x_toolchain/lib -pthread\" CGO_CFLAGS=\"-I/am335x_toolchain/include\" go build\n# runtime/cgo\n/am335x_toolchain/bin/../lib/gcc/armv7l-timesys-linux-gnueabi/4.8.3/../../../../armv7l-timesys-linux-gnueabi/bin/ld: cannot find Scrt1.o: No such file or directory\n/am335x_toolchain/bin/../lib/gcc/armv7l-timesys-linux-gnueabi/4.8.3/../../../../armv7l-timesys-linux-gnueabi/bin/ld: cannot find crti.o: No such file or directory\n/am335x_toolchain/bin/../lib/gcc/armv7l-timesys-linux-gnueabi/4.8.3/../../../../armv7l-timesys-linux-gnueabi/bin/ld: cannot find /lib/libpthread.so.0\n/am335x_toolchain/bin/../lib/gcc/armv7l-timesys-linux-gnueabi/4.8.3/../../../../armv7l-timesys-linux-gnueabi/bin/ld: cannot find /usr/lib/libpthread_nonshared.a\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>The pthread library does exist:</p>\n\n<pre><code>$ ls /am335x_toolchain/lib | grep \"libpthread*\"\nlibpthread-2.18.so\nlibpthread.a\nlibpthread_nonshared.a\nlibpthread.so\nlibpthread.so.0\n</code></pre>\n\n<p>Any pointers on what I need to do to cross-compile with CGO? Seems like with each release I've had more trouble cross-compiling with CGO.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I've discovered this is an issue with the host architecture. I get the above issues when running on an x86_64 machine (linux). When I compile with Go 1.6 on a 32bit x86 machine (linux), it builds without errors. Still haven't found a solution of compiling on the 64bit machine.</p>\n"}, {"tags": ["json", "go", "struct", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 569, "user_id": 1286132, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8aD2x.jpg?s=128&g=1", "display_name": "Joseph Roberts", "link": "https://stackoverflow.com/users/1286132/joseph-roberts"}, "edited": false, "score": 0, "creation_date": 1470467700, "post_id": 38794442, "comment_id": 64972645, "body": "Thank you. I knew there must of been an easier way."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1470416602, "creation_date": 1470416602, "answer_id": 38794442, "question_id": 38794336, "link": "https://stackoverflow.com/questions/38794336/golang-unmarshall-json-with-changing-key-value/38794442#38794442", "title": "Golang - Unmarshall JSON with changing key value", "body": "<p>You have a series of JSON objects, <em>mapping</em> a unique id to each <code>Device</code>. Unmarshal that into a <code>map</code></p>\n\n<pre><code>type Device struct {\n    LocalUUID       string  `json:\"localUUID\"`\n    ApplicationUUID string  `json:\"applicationUUID\"`\n    ExternalUUID    string  `json:\"externalUUID\"`\n    Commit          string  `json:\"commit\"`\n    LastSeen        string  `json:\"lastSeen\"`\n    State           string  `json:\"state\"`\n    Progress        float32 `json:\"progress,string\"`\n}\n\nfunc main() {\n    devices := make(map[string]*Device)\n\n    err := json.Unmarshal(b, &amp;devices)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, device := range devices {\n        fmt.Printf(\"%#v\\n\", device)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/JDZzG64jJR\" rel=\"noreferrer\">https://play.golang.org/p/JDZzG64jJR</a></p>\n"}], "owner": {"reputation": 569, "user_id": 1286132, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8aD2x.jpg?s=128&g=1", "display_name": "Joseph Roberts", "link": "https://stackoverflow.com/users/1286132/joseph-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2512, "favorite_count": 2, "accepted_answer_id": 38794442, "answer_count": 1, "score": 1, "last_activity_date": 1470416602, "creation_date": 1470416225, "question_id": 38794336, "link": "https://stackoverflow.com/questions/38794336/golang-unmarshall-json-with-changing-key-value", "title": "Golang - Unmarshall JSON with changing key value", "body": "<p>I'm trying to unmarshall JSON into a struct, but it's proving difficult because the outer JSON key changes and I only started go a week ago. This is my manual attempt:</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n    \"strconv\"\n)\n\ntype Device struct {\n    localUUID       string\n    applicationUUID string\n    externalUUID    string\n    commit          string\n    lastSeen        string\n    state           string\n    progress        float32\n}\n\nfunc main() {\n    devices := make([]*Device, 0, 10)\n\n    b := []byte(`{\n        \"5417871461137421886\": {\n            \"applicationUUID\": \"test_applicationUUID\",\n            \"commit\": \"test_commit\",\n            \"lastSeen\": \"test_lastSeen\",\n            \"localUUID\": \"E4:F5:13:8E:F5:43\",\n            \"progress\": \"3.5\",\n            \"externalUUID\": \"test_externalUUID\",\n            \"state\": \"test_state\"\n        },\n        \"5632882567440442530\": {\n            \"applicationUUID\": \"test_applicationUUID\",\n            \"commit\": \"test_commit\",\n            \"lastSeen\": \"test_lastSeen\",\n            \"localUUID\": \"E4:F5:13:8E:F5:42\",\n            \"progress\": \"3.5\",\n            \"externalUUID\": \"test_externalUUID\",\n            \"state\": \"test_state\"\n        },\n        \"8912255216147730520\": {\n            \"applicationUUID\": \"test_applicationUUID\",\n            \"commit\": \"test_commit\",\n            \"lastSeen\": \"test_lastSeen\",\n            \"localUUID\": \"E4:F5:13:8E:F5:41\",\n            \"progress\": \"3.5\",\n            \"externalUUID\": \"test_externalUUID\",\n            \"state\": \"test_state\"\n        }\n    }`)\n\n    var f interface{}\n    json.Unmarshal(b, &amp;f)\n    outer := f.(map[string]interface{})\n    for _, value := range outer {\n        inner := value.(map[string]interface{})\n        device := &amp;Device{}\n        device.localUUID = inner[\"localUUID\"].(string)\n        device.applicationUUID = inner[\"applicationUUID\"].(string)\n        device.externalUUID = inner[\"externalUUID\"].(string)\n        device.commit = inner[\"commit\"].(string)\n        device.lastSeen = inner[\"lastSeen\"].(string)\n        device.state = inner[\"state\"].(string)\n        f, _ := strconv.ParseFloat(inner[\"progress\"].(string), 32)\n        device.progress = float32(f)\n\n        devices = append(devices, device)\n    }\n\n    for _, device := range devices {\n        fmt.Println(device)\n    }\n}\n</code></pre>\n\n<p>Is there a way to ignore the keys and iterate over the values instead, allowing me to use json.Unmarshal(b, &amp;Device)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1470413543, "post_id": 38793573, "comment_id": 64957567, "body": "Maybe you should use a <a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow noreferrer\">select</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1470414198, "post_id": 38793573, "comment_id": 64957914, "body": "This sounds like an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a> -- you generally don&#39;t wait for a channel to be full, since you can&#39;t then concurrently consume values from it. You want to wait for the goroutines to complete, which is what you use a sync.WaitGroup for."}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 5, "last_activity_date": 1470414174, "creation_date": 1470414174, "answer_id": 38793817, "question_id": 38793573, "link": "https://stackoverflow.com/questions/38793573/wait-for-a-buffered-channel-to-be-full/38793817#38793817", "title": "Wait for a buffered channel to be full", "body": "<p>The function <code>len()</code> supports channels, returning the number of unread queued elements within the channel.  However, you'll have to run a loop to periodically check it.</p>\n\n<p>The traditional method of handling this is using a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a>, as so:</p>\n\n<pre><code>func main() {\n    // Initialization of the slice a and 0 &lt; n &lt; len(a) - 1.\n    var wg sync.WaitGroup\n    wg.Add(3)\n    difs := make(chan int, 3)\n    go routine(a[:n], difs, &amp;wg)\n    go routine(a[n + 1:], difs, &amp;wg)\n    go routine(n - 1:n + 1], difs, &amp;wg)\n\n    wg.Wait() // blocks until wg.Done() is called 3 times\n    fmt.Println(&lt;-difs) // Display the first result returned by one of the routine.\n}\n\n// NOTE: This MUST accept a POINTER to the waitgroup.  They are not copy-safe.\nfunc routine(a []int, out chan&lt;- int, wg *sync.WaitGroup) {\n    defer wg.Done()\n    // Long computation.\n    out &lt;- result\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2648, "user_id": 1673772, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pyqck.jpg?s=128&g=1", "display_name": "Armand Grillet", "link": "https://stackoverflow.com/users/1673772/armand-grillet"}, "edited": false, "score": 0, "creation_date": 1470414526, "post_id": 38793839, "comment_id": 64958073, "body": "Simple yet effective, thank you! I upvote the other answer as it uses <code>sync.WaitGroup</code>, a solution that seems the standard one for this kind of problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 2648, "user_id": 1673772, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pyqck.jpg?s=128&g=1", "display_name": "Armand Grillet", "link": "https://stackoverflow.com/users/1673772/armand-grillet"}, "edited": false, "score": 0, "creation_date": 1470414781, "post_id": 38793839, "comment_id": 64958187, "body": "@armand-grillet no need for sync.WaitGroup here for just 3 channels, you may use channel itself to sync."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470415088, "post_id": 38793839, "comment_id": 64958325, "body": "Waitgroups are particularly ideal when you have a variable number of messages being written, because they can be added to and subtracted from as you fire up new goroutines and as they complete."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1470415218, "post_id": 38793839, "comment_id": 64958379, "body": "Also you may use: \t<code>result := make([]int, 3) \tfor i := 0; i &lt; 3; i++ { \t\tresult[i] = &lt;-difs \t}</code> for more channels."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470415393, "post_id": 38793839, "comment_id": 64958448, "body": "Downside is that the receive routine will block indefinitely if one of the sender routines returns before sending.  With the waitgroup version using a deferred <code>wg.Done()</code>, this can&#39;t happen."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1470415574, "post_id": 38793839, "comment_id": 64958543, "body": "also you may use <code>defer</code> with channels too, like this: ` \tdefer func() { out &lt;- result }()`"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470420863, "post_id": 38793839, "comment_id": 64961211, "body": "You can, but that still requires you to send as many values over the routine as you have routines, even if some of those sends are basically just sentinel values that indicate something went wrong.  Waitgroups allow routines to indicate that they have completed without actually having to sent junk data over the output channel."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 5, "last_activity_date": 1470414268, "creation_date": 1470414268, "answer_id": 38793839, "question_id": 38793573, "link": "https://stackoverflow.com/questions/38793573/wait-for-a-buffered-channel-to-be-full/38793839#38793839", "title": "Wait for a buffered channel to be full", "body": "<p>Wait using channel itself, like this working sample code:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12} // Initialization of the slice a and 0 &lt; n &lt; len(a) - 1.\n    difs := make(chan int, 3)\n\n    go routine(a[0:4], difs)\n    go routine(a[4:8], difs)\n    go routine(a[8:12], difs)\n\n    result := []int{&lt;-difs, &lt;-difs, &lt;-difs}\n\n    fmt.Println(result) // Display the first result returned by one of the routine.\n}\n\nfunc routine(a []int, out chan&lt;- int) {\n    result := 0 // Long computation.\n    for _, v := range a {\n        result += v\n    }\n    out &lt;- result\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[10 42 26]\n</code></pre>\n"}], "owner": {"reputation": 2648, "user_id": 1673772, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pyqck.jpg?s=128&g=1", "display_name": "Armand Grillet", "link": "https://stackoverflow.com/users/1673772/armand-grillet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3055, "favorite_count": 0, "accepted_answer_id": 38793839, "answer_count": 2, "score": 6, "last_activity_date": 1470414614, "creation_date": 1470413238, "last_edit_date": 1470414614, "question_id": 38793573, "link": "https://stackoverflow.com/questions/38793573/wait-for-a-buffered-channel-to-be-full", "title": "Wait for a buffered channel to be full", "body": "<p>I must have missed something because I haven't found the answer online for this pretty basic problem. I am using a buffered channel capable of holding three <code>int</code> values. </p>\n\n<p>I am then using three goroutines to fill it up and I want to do an operation once the buffered channel is full.</p>\n\n<p>Here is a snippet explaining the problem:</p>\n\n<pre><code>func main() {\n    // Initialization of the slice a and 0 &lt; n &lt; len(a) - 1.\n    difs := make(chan int, 3)\n    go routine(a[:n], difs)\n    go routine(a[n + 1:], difs)\n    go routine(a[n - 1:n + 1], difs)\n\n    fmt.Println(&lt;-difs) // Display the first result returned by one of the routine.\n}\n\nfunc routine(a []int, out chan&lt;- int) {\n    // Long computation.\n    out &lt;- result\n}\n</code></pre>\n\n<p>I would like to update my code so that <code>fmt.Println(&lt;-difs)</code> displays an array of <code>int</code> when all the values have been computed. I could use three times <code>&lt;-difs</code> but I wonder if Go offers something cleaner to do that.</p>\n"}, {"tags": ["go", "orm", "model", "beego"], "answers": [{"comments": [{"owner": {"reputation": 1467, "user_id": 2665155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d53b5ebb899ec7100f5cc9946e20e55?s=128&d=identicon&r=PG", "display_name": "Hobbestigrou", "link": "https://stackoverflow.com/users/2665155/hobbestigrou"}, "edited": false, "score": 0, "creation_date": 1470500791, "post_id": 38796077, "comment_id": 64981179, "body": "It&#39;s not necesary to call the Using function, because it&#39;s already call by the NewOrm function see <a href=\"https://github.com/astaxie/beego/tree/master/orm/orm.go\" rel=\"nofollow noreferrer\">github.com/astaxie/beego/tree/master/orm/orm.go</a> so it&#39;s not the reason of the error."}], "tags": [], "owner": {"reputation": 26, "user_id": 4830638, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-apztjpp44PA/AAAAAAAAAAI/AAAAAAAAALA/3eK8Lrmn2a4/photo.jpg?sz=128", "display_name": "kwtucker", "link": "https://stackoverflow.com/users/4830638/kwtucker"}, "is_accepted": false, "score": 0, "last_activity_date": 1470424975, "last_edit_date": 1470424975, "creation_date": 1470423362, "answer_id": 38796077, "question_id": 38793557, "link": "https://stackoverflow.com/questions/38793557/model-error-with-beego/38796077#38796077", "title": "Model error with beego", "body": "<p>I think you are missing this in your controller. Telling which database to use. I went to this link: <a href=\"http://beego.me/docs/mvc/model/orm.md#driver\" rel=\"nofollow\">Beego ORM</a></p>\n\n<pre><code>o := orm.NewOrm()\no.Using(\"default\")\ndr = o.Driver()\nfmt.Println(dr.Name() == \"default\") // true\nfmt.Println(dr.Type() == orm.DRSqlite) // true\n</code></pre>\n\n<p><strong>Update Try</strong></p>\n\n<p>Tell the syncdb which db to use in the command:</p>\n\n<pre><code>./mahewinsexyurl orm syncdb -db=\"default\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1467, "user_id": 2665155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d53b5ebb899ec7100f5cc9946e20e55?s=128&d=identicon&r=PG", "display_name": "Hobbestigrou", "link": "https://stackoverflow.com/users/2665155/hobbestigrou"}, "is_accepted": true, "score": 3, "last_activity_date": 1470503784, "creation_date": 1470503784, "answer_id": 38806849, "question_id": 38793557, "link": "https://stackoverflow.com/questions/38793557/model-error-with-beego/38806849#38806849", "title": "Model error with beego", "body": "<p>I found my error it was a careless mistake in the controllers:</p>\n\n<pre><code>ur := &amp;models.ShortUrl{\n    Domain: domain,\n    Short:  short,\n}\n\nif created, _, err := o.ReadOrCreate(&amp;ur, \"Domain\"); err == nil {\n}\n</code></pre>\n\n<p>Thew new version is:</p>\n\n<pre><code>ur := models.ShortUrl{\n    Domain: domain,\n    Short:  short,\n}\n\nif created, _, err := o.ReadOrCreate(&amp;ur, \"Domain\"); err == nil {\n}\n</code></pre>\n\n<p>The error is the double usage of &amp; to work and create pointer to a ShortUrl struct.</p>\n"}], "owner": {"reputation": 1467, "user_id": 2665155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d53b5ebb899ec7100f5cc9946e20e55?s=128&d=identicon&r=PG", "display_name": "Hobbestigrou", "link": "https://stackoverflow.com/users/2665155/hobbestigrou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2030, "favorite_count": 0, "accepted_answer_id": 38806849, "answer_count": 2, "score": 1, "last_activity_date": 1470503784, "creation_date": 1470413210, "question_id": 38793557, "link": "https://stackoverflow.com/questions/38793557/model-error-with-beego", "title": "Model error with beego", "body": "<p>I'm quite new on beego. I start a little project to discover and start to learn\nthe framework. I used the bee command to create the project:</p>\n\n<pre><code>bee new my_project\n</code></pre>\n\n<p>The version of beego is:</p>\n\n<pre><code>bee   :1.4.1\nbeego :1.6.1\nGo    :go version go1.6.3 linux/amd64\n</code></pre>\n\n<p>I have a little model, the content of my model file is:</p>\n\n<pre><code>package models\n\nimport \"github.com/astaxie/beego/orm\"\n\ntype ShortUrl struct {\n    Id     int `orm:\"auto\"`\n    Domain string\n    Short  string\n}\n\nfunc init() {\n    orm.RegisterModel(new(ShortUrl))\n}\n</code></pre>\n\n<p>In the main file:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/astaxie/beego\"\n    \"github.com/astaxie/beego/orm\"\n    _ \"github.com/hobbestigrou/mahewinsexyurl/routers\"\n)\n\nfunc init() {\n    orm.RegisterDriver(\"sqlite3\", orm.DRSqlite)\n    orm.RegisterDataBase(\"default\", \"sqlite3\", \"data.db\")\n    orm.RunCommand()\n}\n\nfunc main() {\n    beego.Run()\n}\n</code></pre>\n\n<p>In the controller file:</p>\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/astaxie/beego\"\n    \"github.com/astaxie/beego/orm\"\n    \"github.com/hobbestigrou/mahewinsexyurl/models\"\n    _ \"github.com/mattn/go-sqlite3\"\n    \"github.com/ventu-io/go-shortid\"\n    \"net/url\"\n)\n\ntype MainController struct {\n    beego.Controller\n}\n\ntype Domain struct {\n    Id  int    `form:\"-\"`\n    Url string `form:\"url\"`\n}\n\nfunc (c *MainController) Get() {\n    _ = beego.ReadFromRequest(&amp;c.Controller)\n\n    c.Data[\"Form\"] = &amp;Domain{}\n    c.TplName = \"index.tpl\"\n}\n\nfunc (c *MainController) Post() {\n    o := orm.NewOrm()\n\n    flash := beego.NewFlash()\n    domain := c.Input().Get(\"url\")\n\n    if _, err := url.ParseRequestURI(domain); err != nil {\n        flash.Error(\"Please put a valid url\")\n        flash.Store(&amp;c.Controller)\n        c.Redirect(\"/\", 302)\n    }\n\n    short, _ := shortid.Generate()\n    ur := &amp;models.ShortUrl{\n        Domain: domain,\n        Short:  short,\n    }\n\n    if created, _, err := o.ReadOrCreate(&amp;ur, \"Domain\"); err != nil {\n        if created {\n            flash.Notice(\"The url was added: \", short)\n            flash.Store(&amp;c.Controller)\n            c.Redirect(\"/\", 302)\n            } else {\n                flash.Notice(\"The url already exists\", short)\n                flash.Store(&amp;c.Controller)\n                c.Redirect(\"/\", 302)\n            }\n        }\n\n        c.TplName = \"index.tpl\"\n}\n</code></pre>\n\n<p>I know I can refactor the flash part but it's a detail at the moment.</p>\n\n<p>The router:</p>\n\n<pre><code>package routers\n\nimport (\n    \"github.com/hobbestigrou/mahewinsexyurl/controllers\"\n    \"github.com/astaxie/beego\"\n)\n\nfunc init() {\n    beego.Router(\"/\", &amp;controllers.MainController{})\n}\n</code></pre>\n\n<p>I used the syncdb to create the table:</p>\n\n<pre><code>./mahewinsexyurl orm syncdb\n</code></pre>\n\n<p>The table was successfully created. But when I try to post data, I got an\nerror:</p>\n\n<pre><code>2016/08/05 17:16:24 [router.go:854][C] the request url is  /\n2016/08/05 17:16:24 [router.go:855][C] Handler crashed with error &lt;Ormer&gt; table: `.` not found, maybe not RegisterModel\n2016/08/05 17:16:24 [router.go:861][C] /usr/lib/go-1.6/src/runtime/asm_amd64.s:472\n2016/08/05 17:16:24 [router.go:861][C] /usr/lib/go-1.6/src/runtime/panic.go:443\n2016/08/05 17:16:24 [router.go:861][C] /home/hobbestigrou/go/src/github.com/astaxie/beego/orm/orm.go:110\n2016/08/05 17:16:24 [router.go:861][C] /home/hobbestigrou/go/src/github.com/astaxie/beego/orm/orm.go:135\n2016/08/05 17:16:24 [router.go:861][C] /home/hobbestigrou/go/src/github.com/hobbestigrou/mahewinsexyurl/controllers/default.go:47\n2016/08/05 17:16:24 [router.go:861][C] /home/hobbestigrou/go/src/github.com/astaxie/beego/router.go:763\n2016/08/05 17:16:24 [router.go:861][C] /usr/lib/go-1.6/src/net/http/server.go:2081\n2016/08/05 17:16:24 [router.go:861][C] /usr/lib/go-1.6/src/net/http/server.go:1472\n2016/08/05 17:16:24 [router.go:861][C] /usr/lib/go-1.6/src/runtime/asm_amd64.s:1998\n</code></pre>\n\n<p>What is my mistake ?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 2, "last_activity_date": 1470411349, "creation_date": 1470411349, "answer_id": 38793002, "question_id": 38792864, "link": "https://stackoverflow.com/questions/38792864/what-are-the-phantom-processes-resulting-from-killing-a-go-run-process/38793002#38793002", "title": "What are the phantom processes resulting from killing a `go run` process?", "body": "<p>The one you're calling the \"phantom process\" is your server, which is why killing it kills your server. The other is the \"go run\" utility itself, which is compiling your code and then running the resulting executable.</p>\n"}], "owner": {"reputation": 12273, "user_id": 1048539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b2bfeca28ec73556f395bed4668f9e16?s=128&d=identicon&r=PG", "display_name": "enderland", "link": "https://stackoverflow.com/users/1048539/enderland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 38793002, "answer_count": 1, "score": 0, "last_activity_date": 1470411349, "creation_date": 1470410927, "last_edit_date": 1470411264, "question_id": 38792864, "link": "https://stackoverflow.com/questions/38792864/what-are-the-phantom-processes-resulting-from-killing-a-go-run-process", "title": "What are the phantom processes resulting from killing a `go run` process?", "body": "<p>I have been running a server with:</p>\n\n<pre><code>go run server.go &amp;\n</code></pre>\n\n<p>When I am done with the process, this requires me to kill the process. The way I have been doing this is with <code>kill PID</code> of the <code>go run</code> process.</p>\n\n<p>However, I've noticed my server appears connected still. Investigating further it seems that there are other processes go is starting which appear to \"keep alive\" my server:</p>\n\n<pre><code>$ps aux | grep go\nusername   70481   0.0  0.0 573416816   5228   ??  S     3:15PM   0:00.63 /var/folders/wf/89r2567s5hv48lj1g9l65mbw0000gp/T/go-build062422854/command-line-arguments/_obj/exe/server\nusername   70472   0.0  0.0 573407408   7720   ??  S     3:15PM   0:00.80 go run server.go\n</code></pre>\n\n<p>When I kill this associated process, too, I see that my connection is released as expected.</p>\n\n<p>Is there a better way to \"really\" kill a golang process than <code>kill PID</code>?  Or is there a reason why there are these phantom processes?</p>\n\n<p>I have resorted to killing <em>both</em> but this seems... strange.</p>\n\n<pre><code>$ go version\ngo version go1.5.4 darwin/amd64\n</code></pre>\n"}, {"tags": ["python", "go", "sublimetext3"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1470409254, "post_id": 38791826, "comment_id": 64954921, "body": "Why aren&#39;t you using language-specific plugins that will handle that for you? GoSublime for example."}, {"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1470410293, "post_id": 38791826, "comment_id": 64955579, "body": "That works but not according to my requirement. In that case I need to define a shortcut for every language&#39;s goto definition function."}], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1470663129, "post_id": 38796045, "comment_id": 65026531, "body": "And, what if we want to do the same for Ctrl+click shortcuts?"}, {"owner": {"reputation": 16941, "user_id": 814803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUo4b.png?s=128&g=1", "display_name": "OdatNurd", "link": "https://stackoverflow.com/users/814803/odatnurd"}, "reply_to_user": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1470679070, "post_id": 38796045, "comment_id": 65036714, "body": "I don&#39;t think there is an analog for setting such a context in a <code>sublime-mousemap</code> file, although I could be wrong. Documentation on it seems sparse and I wasn&#39;t able to find any examples that do it. It might be possible via a custom plugin command that would examine the filename/syntax of the clicked in view and then run the appropriate command, though."}], "tags": [], "owner": {"reputation": 16941, "user_id": 814803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUo4b.png?s=128&g=1", "display_name": "OdatNurd", "link": "https://stackoverflow.com/users/814803/odatnurd"}, "is_accepted": true, "score": 3, "last_activity_date": 1470423213, "creation_date": 1470423213, "answer_id": 38796045, "question_id": 38791826, "link": "https://stackoverflow.com/questions/38791826/sublime-text-3-language-specific-goto-definition-keyboard-shortcut/38796045#38796045", "title": "Sublime Text 3 - Language specific Goto definition Keyboard Shortcut", "body": "<p>The context that you want is for <code>selector</code>:</p>\n\n<pre><code>{\n    \"keys\": [\"ctrl+d\"],\n    \"command\": \"python_goto_definition\",\n    \"context\": [\n        { \"key\": \"selector\", \"operator\": \"equal\", \"operand\": \"source.python\" }\n    ]\n},\n</code></pre>\n\n<p>You can add more or less specificity as needed. Use <kbd>Ctrl+Shift+Alt+P</kbd> or <kbd>Shift+Ctrl+P</kbd> (MacOS) to view the scope selector for the current position.</p>\n"}], "owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 0, "accepted_answer_id": 38796045, "answer_count": 1, "score": 3, "last_activity_date": 1470423213, "creation_date": 1470407722, "last_edit_date": 1470410123, "question_id": 38791826, "link": "https://stackoverflow.com/questions/38791826/sublime-text-3-language-specific-goto-definition-keyboard-shortcut", "title": "Sublime Text 3 - Language specific Goto definition Keyboard Shortcut", "body": "<p>How can I set \"Goto Definition\" work according to the language I'm working on.</p>\n\n<p>For example:</p>\n\n<p>In Python I want to use PythonIDE's go to definition:</p>\n\n<pre><code>{\n        \"keys\": [\"ctrl+d\"],\n        \"command\": \"python_goto_definition\"\n    },\n</code></pre>\n\n<p>And, for any other language, for instance Go, I want to use GoSublime's go to definition:</p>\n\n<pre><code>{\n        \"keys\": [\"ctrl+d\"],\n        \"command\": \"go_sublime_goto_definition\"\n    },\n</code></pre>\n\n<p>I'm wondering how can I set the context?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1470409725, "last_edit_date": 1470409725, "creation_date": 1470409100, "answer_id": 38792294, "question_id": 38791598, "link": "https://stackoverflow.com/questions/38791598/unmarshalling-xml-using-go-how-to-find-attributes-with-the-same-value/38792294#38792294", "title": "Unmarshalling XML using Go: How to find attributes with the same value?", "body": "<p>Since <code>&lt;manga&gt;</code> contains a list of <code>&lt;info&gt;</code> elements, it makes more sense to have a list of <code>Info</code> structs rather than trying to translate the <code>&lt;info&gt;</code> elements into various types. I would define the data structures like:</p>\n\n<pre><code>type Manga struct {\n    WorkID    int    `xml:\"id,attr\"`\n    Name      string `xml:\"name,attr\"`\n    Precision string `xml:\"precision,attr\"`\n    Info      []Info `xml:\"info\"`\n}\n\ntype Info struct {\n    Type  string `xml:\"type,attr\"`\n    Value string `xml:\",chardata\"`\n}\n</code></pre>\n\n<p>The output (json encoded for convenience) looks like:</p>\n\n<pre><code>{\n  \"WorkID\": 4199,\n  \"Name\": \"Jinki: Extend\",\n  \"Precision\": \"manga\",\n  \"Info\": [\n    {\n      \"Type\": \"Main title\",\n      \"Value\": \"Jinki: Extend\"\n    },\n    {\n      \"Type\": \"Genres\",\n      \"Value\": \"action\"\n    },\n    {\n      \"Type\": \"Genres\",\n      \"Value\": \"science fiction\"\n    },\n    {\n      \"Type\": \"Themes\",\n      \"Value\": \"mecha\"\n    },\n    {\n      \"Type\": \"Number of tankoubon\",\n      \"Value\": \"9\"\n    },\n    {\n      \"Type\": \"Number of pages\",\n      \"Value\": \"186\"\n    }\n  ]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": false, "score": 0, "last_activity_date": 1470412680, "creation_date": 1470412680, "answer_id": 38793401, "question_id": 38791598, "link": "https://stackoverflow.com/questions/38791598/unmarshalling-xml-using-go-how-to-find-attributes-with-the-same-value/38793401#38793401", "title": "Unmarshalling XML using Go: How to find attributes with the same value?", "body": "<p>In case the XML won't not very large, I would just write an utility function  like:</p>\n\n<pre><code>type Manga struct {\n    WorkID    int    `xml:\"id,attr\"`\n    Name      string `xml:\"name,attr\"`\n    Precision string `xml:\"precision,attr\"`\n    Info      []Info `xml:\"info\"`\n}\n\ntype Info struct {\n    Type string `xml:\"type,attr\"`\n    Data string `xml:\",chardata\"`\n}\n\nfunc (m *Manga) Genres() []Info {\n    var g []Info\n\n    for _, v := range m.Info {\n        if v.Type == \"Genres\" {\n            g = append(g, v)\n        }\n    }\n    return g\n\n}\n</code></pre>\n\n<p>See it in action: <a href=\"https://play.golang.org/p/bebUwwbSwG\" rel=\"nofollow\">https://play.golang.org/p/bebUwwbSwG</a></p>\n"}], "owner": {"reputation": 25, "user_id": 4046789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f9f10f12e3e5f8e75e1b5f517b9815?s=128&d=identicon&r=PG", "display_name": "JCRamires", "link": "https://stackoverflow.com/users/4046789/jcramires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 38792294, "answer_count": 2, "score": 2, "last_activity_date": 1470412680, "creation_date": 1470407042, "question_id": 38791598, "link": "https://stackoverflow.com/questions/38791598/unmarshalling-xml-using-go-how-to-find-attributes-with-the-same-value", "title": "Unmarshalling XML using Go: How to find attributes with the same value?", "body": "<p>I'm having trouble unmarshalling the XML below, how do I find all <code>&lt;info&gt;</code> nodes with <code>type=\"Genres\"</code> and store their values inside a <code>[]Genre</code>?</p>\n\n<pre><code>&lt;manga id=\"4199\" type=\"manga\" name=\"Jinki: Extend\" precision=\"manga\"&gt;\n    &lt;info type=\"Main title\" lang=\"EN\"&gt;Jinki: Extend&lt;/info&gt;\n    &lt;info type=\"Genres\"&gt;action&lt;/info&gt;\n    &lt;info type=\"Genres\"&gt;science fiction&lt;/info&gt;\n    &lt;info type=\"Themes\"&gt;mecha&lt;/info&gt;\n    &lt;info type=\"Number of tankoubon\"&gt;9&lt;/info&gt;\n    &lt;info type=\"Number of pages\"&gt;186&lt;/info&gt;\n&lt;/manga&gt;\n</code></pre>\n\n<p>I'm looking to store the values in structs similar to these:</p>\n\n<pre><code>// Manga struct\ntype Manga struct {\n    WorkID    int     `xml:\"id,attr\"`\n    Name      string  `xml:\"name,attr\"`\n    Precision string  `xml:\"precision,attr\"`\n    Genres    []Genre `[this is the part I need help on]`\n}\n\n// Genre struct\ntype Genre struct {\n    Value string\n}\n</code></pre>\n\n<p>I know the XML is not ideal, but it is what I have to work with, I hope you guys can help me with this.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["logging", "go", "glog"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1470404727, "post_id": 38790378, "comment_id": 64951790, "body": "what the heck are you asking?"}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 6253101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ygYWm.png?s=128&g=1", "display_name": "vogtb", "link": "https://stackoverflow.com/users/6253101/vogtb"}, "is_accepted": false, "score": 2, "last_activity_date": 1470866068, "creation_date": 1470866068, "answer_id": 38884188, "question_id": 38790378, "link": "https://stackoverflow.com/questions/38790378/golang-logging-strategy/38884188#38884188", "title": "Golang logging strategy", "body": "<p>So, I think you're asking, what if a package I'm using uses plain old <a href=\"https://golang.org/pkg/log/\" rel=\"nofollow\">https://golang.org/pkg/log/</a> and my main package uses something special, like <code>log.Info</code>, <code>log.Warn</code>, <code>log.Error</code>, and <code>log.Debug</code>?</p>\n\n<p>If the package exposes the <code>log.Logger</code> object to you, you can use <code>SetFlags</code>, <code>SetOutput</code>, <code>SetPrefix</code> to alter what those log messages look like, or silence them altogether, but you can't make them play nice with your special third-party logging package.</p>\n\n<p>For example if a third part package looks like this:</p>\n\n<pre><code>package sayhello\n\nimport (\n      \"log\"\n      \"os\"\n)\n\ntype SayHello {\n      Logger *log.Logger\n}\n\nfunc NewSayHello() (SayHello) {\n      logger, _ := os.OpenFile(\"/tmp/tmp.log\",  os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n      var sh SayHello\n      sh.Logger = log.New(logger, \"SAY HELLO LOGGER: \", log.Ldate|log.Ltime|log.Lshortfile)\n      return sh\n}\n\nfunc (sh SayHello) Run() {\n      sh.Logger.Println(\"Hello. I ran!\")\n}\n</code></pre>\n\n<p>Then I can silence it like this:</p>\n\n<pre><code>package main\n\nimport (\n      \"sayhello\"\n      \"io/ioutil\"\n)\n\nfunc main() {\n      sh := sayhello.NewSayHello()\n      sh.Run()\n      // output is: 2016/08/10 16:47:46 SAY HELLO LOGGER: Hello. I ran!\n      sh.Logger.SetOutput(ioutil.Discard)\n      sh.Run()\n      // output is nothing\n}\n</code></pre>\n\n<p>But there's really no way you can translate log statements in another package like <code>log.Println</code> in a into something like <code>log.Info</code>, or <code>log.Debug</code>, which is what you're looking for.</p>\n"}], "owner": {"reputation": 927, "user_id": 1174972, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21f35146c9eedc7b990c367ec86dcdc?s=128&d=identicon&r=PG", "display_name": "shicky", "link": "https://stackoverflow.com/users/1174972/shicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1747, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1470866068, "creation_date": 1470403310, "last_edit_date": 1470536195, "question_id": 38790378, "link": "https://stackoverflow.com/questions/38790378/golang-logging-strategy", "title": "Golang logging strategy", "body": "<p>Standard <code>log</code> package in Go does not support levels unlike <code>logging</code> standard library in Python.</p>\n\n<p>Many packages resort to third-party log packages such as <code>glog</code> or <code>logrus</code>.</p>\n\n<p>What is best logging strategy for Go when importing third-party packages that may or may not use third-party logging package.</p>\n"}, {"tags": ["c", "go", "debian", "shadow"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470403198, "post_id": 38790092, "comment_id": 64950724, "body": "Why do you have <code>-D_POSIX_SOURCE=1</code>? The <code>getspnam_r</code> function isn&#39;t POSIX, so I think that macro is what&#39;s interfering."}, {"owner": {"reputation": 1467, "user_id": 2665155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d53b5ebb899ec7100f5cc9946e20e55?s=128&d=identicon&r=PG", "display_name": "Hobbestigrou", "link": "https://stackoverflow.com/users/2665155/hobbestigrou"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470403585, "post_id": 38790092, "comment_id": 64951005, "body": "Because without this flag I got another error see <a href=\"https://friendpaste.com/2EFrPk78Ghx96kE4CW0V2Z\" rel=\"nofollow noreferrer\">friendpaste.com/2EFrPk78Ghx96kE4CW0V2Z</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470404347, "post_id": 38790092, "comment_id": 64951535, "body": "Use  <code>C.struct_spwd</code> instead of <code>C.struct_passwd</code>. The compiler should be able to point out the rest of the issues from there. You should also defer your calls to <code>free</code>, because you&#39;re not freeing the memory when you return early."}, {"owner": {"reputation": 1467, "user_id": 2665155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d53b5ebb899ec7100f5cc9946e20e55?s=128&d=identicon&r=PG", "display_name": "Hobbestigrou", "link": "https://stackoverflow.com/users/2665155/hobbestigrou"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470407413, "post_id": 38790092, "comment_id": 64953593, "body": "Awesome it works now."}], "answers": [{"tags": [], "owner": {"reputation": 1467, "user_id": 2665155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d53b5ebb899ec7100f5cc9946e20e55?s=128&d=identicon&r=PG", "display_name": "Hobbestigrou", "link": "https://stackoverflow.com/users/2665155/hobbestigrou"}, "is_accepted": true, "score": 0, "last_activity_date": 1470408088, "creation_date": 1470408088, "answer_id": 38791956, "question_id": 38790092, "link": "https://stackoverflow.com/questions/38790092/call-a-c-function-from-go/38791956#38791956", "title": "Call a C function from go", "body": "<p>I fixed my mistake. The error was the used of the flag some was unnecessary and the typo on the name of the struct:</p>\n\n<pre><code>// #include &lt;stdlib.h&gt;\n// #include &lt;shadow.h&gt;\n// size_t size_of_shadow() { return sizeof(struct spwd); }\nimport \"C\"\n\nimport \"C\"\nimport \"unsafe\"\nimport \"fmt\"\n\ntype Shadow struct {\n    Name   string\n    Passwd string\n}\n\nfunc Getspnam(name string) (*Shadow, error) {\n    cname := C.CString(name)\n    defer C.free(unsafe.Pointer(cname))\n\n    cspwd := (*C.struct_spwd)(C.malloc(C.size_of_shadow()))\n    defer C.free(unsafe.Pointer(cspwd))\n\n    buf := (*C.char)(C.malloc(1024))\n    defer C.free(unsafe.Pointer(buf))\n\n    _, err := C.getspnam_r(cname, cspwd, buf, 1024, &amp;cspwd)\n\n    if unsafe.Pointer(cspwd) == unsafe.Pointer(uintptr(0)) {\n        if err == nil {\n            err = fmt.Errorf(\"User %s not found\", name)\n        }\n\n        return nil, err\n    }\n\n    s := Shadow{\n        Name:   C.GoString(cspwd.sp_namp),\n        Passwd: C.GoString(cspwd.sp_pwdp),\n    }\n\n    return &amp;s, nil\n}\n</code></pre>\n\n<p>The new version of the code.</p>\n"}], "owner": {"reputation": 1467, "user_id": 2665155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d53b5ebb899ec7100f5cc9946e20e55?s=128&d=identicon&r=PG", "display_name": "Hobbestigrou", "link": "https://stackoverflow.com/users/2665155/hobbestigrou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 38791956, "answer_count": 1, "score": 2, "last_activity_date": 1470408088, "creation_date": 1470402521, "question_id": 38790092, "link": "https://stackoverflow.com/questions/38790092/call-a-c-function-from-go", "title": "Call a C function from go", "body": "<p>I'm quite new on learning go language, and I start to be a great lover of this\nlanguage.\nI hope, I will be a good gopher soon. Currently I try to call a C function\nto read the shadow file, my code is:</p>\n\n<pre><code>// #cgo CFLAGS: -D_POSIX_SOURCE=1\n// #include &lt;stdlib.h&gt;\n// #include &lt;shadow.h&gt;\n// size_t size_of_shadow() { return sizeof(struct spwd); }\nimport \"C\"\nimport \"unsafe\"\nimport \"fmt\"\n\ntype Shadow struct {\n    Name   string\n    Passwd string\n}\n\nfunc Getspnam(name string) (*Shadow, error) {\n    cname := C.CString(name)\n    cspwd := (*C.struct_passwd)(C.malloc(C.size_of_shadow()))\n    buf := (*C.char)(C.malloc(1024))\n    _, err := C.getspnam_r(cname, cspwd, 1024, &amp;cpwd)\n\n    if unsafe.Pointer(cspwd) == unsafe.Pointer(uintptr(0)) {\n        C.free(unsafe.Pointer(cname))\n\n        if err == nil {\n            err = fmt.Errorf(\"User %s not found\", name)\n        }\n\n        return nil, err\n    }\n\n    s := Shadow{\n        Name: C.GoString(cspwd.sp_namp),\n        Passwd: C.GoString(cspwd.sp_pwdp),\n    }\n\n    C.free(unsafe.Pointer(cname))\n    C.free(unsafe.Pointer(cspwd))\n    C.free(unsafe.Pointer(buf))\n\n    return &amp;s, nil\n}\n</code></pre>\n\n<p>Inspired by this little project and the documentation of the function of\ncourse:</p>\n\n<p><a href=\"https://github.com/LTD-Beget/passwd\" rel=\"nofollow\">https://github.com/LTD-Beget/passwd</a>\n<a href=\"http://linux.die.net/man/3/getspnam\" rel=\"nofollow\">http://linux.die.net/man/3/getspnam</a></p>\n\n<p>I'm on debian stretch and go 1.6 version, installed with the package manager.\nI got an error when I try to compile my file:</p>\n\n<pre><code>could not determine kind of name for C.getspnam_r\n</code></pre>\n\n<p>But when I open the header file shadow.h, the function is however present on\nthe file.</p>\n"}, {"tags": ["bash", "go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1470401448, "post_id": 38787443, "comment_id": 64949489, "body": "its not clear to me what problem you&#39;re trying to solve. if you just dont want to type it, <code>alias flagcv=&quot;.&#47;flags.test -test.coverprofile=&#47;tmp&#47;out.out&quot;</code>"}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1470403017, "post_id": 38787443, "comment_id": 64950601, "body": "the problem is I need to change the code in 500 places (already written bash tests which call my binary without <code>-coverprofile</code> flag) and paste <code>flagcv</code> instead of <code>.&#47;flags.test</code>. I would like to keep that tests without changes just replace <code>flags.test</code> binary and it should have flag <code>coverprofile</code> on board. Maybe <code>flags.test</code> name is misleading. In fact, I rename <code>flags.test</code> to <code>flags</code> and run as vanilla binary then check cover profiles."}], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 787553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4be2932e858c8fc42b83a705031b73?s=128&d=identicon&r=PG", "display_name": "dmitris", "link": "https://stackoverflow.com/users/787553/dmitris"}, "edited": false, "score": 0, "creation_date": 1470407685, "post_id": 38791765, "comment_id": 64953769, "body": "another really hacky way would be to modify the testing package in the stdlib - change this line <a href=\"https://github.com/golang/go/blob/master/src/testing/testing.go#L234\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/testing/testing.go#L234</a> to put the filepath of where you want the coverprofile to go instead of the default empty string.  You should have this file locally in /usr/local/go/src/testing/testing.go; to rebuild go, run <code>.&#47;make.bash</code> in /usr/local/go/src.  As I said, it&#39;s a hack - but should work if needed :)"}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1470630515, "post_id": 38791765, "comment_id": 65009169, "body": "thanks, not clear from where to import <code>Asset</code> function, please see my update above"}], "tags": [], "owner": {"reputation": 1281, "user_id": 787553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4be2932e858c8fc42b83a705031b73?s=128&d=identicon&r=PG", "display_name": "dmitris", "link": "https://stackoverflow.com/users/787553/dmitris"}, "is_accepted": false, "score": 0, "last_activity_date": 1470412488, "last_edit_date": 1470412488, "creation_date": 1470407538, "answer_id": 38791765, "question_id": 38787443, "link": "https://stackoverflow.com/questions/38787443/predefine-test-coverprofile-flag/38791765#38791765", "title": "predefine test.coverprofile flag", "body": "<p>If you have to do it, you can do the following - the idea is to pack the \"original\" test binary into the one that you will distribute and which will unpack the \"original\" and call it with the required arguments:</p>\n\n<ul>\n<li>install <code>go-bindata</code>: <code>go get -u github.com/jteeuwen/go-bindata/...</code></li>\n<li>create a test executable <code>flags.test</code>: <code>go test -c -cover</code></li>\n<li>create a wrapper .go file (for example, wrapper.go): <code>go-bindata -o wrapper.go flags.test</code></li>\n<li>edit the wrapper.go file to add a <code>main</code> function to extract the binary and call it with the desired arguments:</li>\n</ul>\n\n<p>wrapper.go</p>\n\n<pre><code>func main() {\n    prog, err := Asset(\"flags.test\")\n    if err != nil {\n        panic(err)\n    }\n    dest := \"/tmp/flags.test\" // could also use https://golang.org/pkg/io/ioutil/#TempFile\n    coverProfile := \"/tmp/flagstest.out\"\n    err = ioutil.WriteFile(dest, prog, 0755)\n    if err != nil {\n        panic(err)\n    }\n    cmd := exec.Command(dest, \"-test.coverprofile\", coverProfile)\n    output, err := cmd.CombinedOutput()\n    if err != nil {\n        log.Fatalf(\"Output: %s, Error: %s\", string(output), err)\n    }\n    fmt.Println(string(output))\n    fmt.Println(\"Coverprofile saved to \", coverProfile)\n}\n</code></pre>\n\n<ul>\n<li>compile the wrapper program for distribution: <code>go build -o wrapper wrapper.go</code></li>\n</ul>\n\n<p>Output:</p>\n\n<pre><code>$ go run wrapper.go\nPASS\ncoverage: 100.0% of statements\n\nCoverprofile saved to  /tmp/flagstest.out\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470630453, "creation_date": 1470394260, "last_edit_date": 1470630453, "question_id": 38787443, "link": "https://stackoverflow.com/questions/38787443/predefine-test-coverprofile-flag", "title": "predefine test.coverprofile flag", "body": "<p>I am analyzing code coverage using go tooling. \nFirst I create test binary </p>\n\n<pre><code>go test -coverpkg=\"github.com/ypapax/flags\" -c\n</code></pre>\n\n<p>Then I run it </p>\n\n<pre><code>./flags.test -test.coverprofile=/tmp/out.out\ncat /tmp/out.out\n</code></pre>\n\n<p>And see profile content</p>\n\n<pre><code>PASS\ncoverage: 100.0% of statements in github.com/ypapax/flags\nmode: set\ngithub.com/ypapax/flags/main.go:5.12,7.2 1 1\n</code></pre>\n\n<p>The question is:\nIs it possible to predefine flag <code>-test.coverprofile=/tmp/out.out</code> so I could run without <code>test.coverprofile</code> flag\n<code>\n./flags.test\ncat /tmp/out.out\n</code>\nand still see <code>/tmp/out.out</code> content.\nMy test code:</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc TestRunMain(t *testing.T) {\n    main()\n}\n</code></pre>\n\n<p>My main code:</p>\n\n<pre><code>package main\n\nimport \"time\"\n\nfunc main(){\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p>The full code is here:</p>\n\n<pre><code>go get github.com/ypapax/flags &amp;&amp; cd $GOPATH/src/github.com/ypapax/flags\n</code></pre>\n\n<p>My question may seem weird but it may be helpful if a lot of functional tests already written which call <code>flags.test</code> binary and it would be nice to avoid adding <code>-test.coverprofile</code> to each <code>flags.test</code> binary call.</p>\n\n<p>I see 2 possible solutions:</p>\n\n<ol>\n<li>Set <code>-test.coverprofile</code> inside go code. How to do it?</li>\n<li>Use bash to wrap up binary with a predefined flag. But in this case, there should not be extra files. It must be the only one <code>flags.test</code> with predefined <code>-test.coverprofile</code> flag. How to do it?</li>\n</ol>\n\n<p>I appreciate any advice. Thanks</p>\n\n<h1>Update</h1>\n\n<p>I am trying to run @dmitris answer </p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"os/exec\"\n    \"log\"\n    \"fmt\"\n\n    . \"github.com/jteeuwen/go-bindata\"\n)\n\nfunc main() {\n    prog, err := Asset(\"flags.test\")\n    if err != nil {\n        panic(err)\n    }\n    dest := \"/tmp/flags.test\" // could also use https://golang.org/pkg/io/ioutil/#TempFile\n    coverProfile := \"/tmp/flagstest.out\"\n    err = ioutil.WriteFile(dest, prog, 0755)\n    if err != nil {\n        panic(err)\n    }\n    cmd := exec.Command(dest, \"-test.coverprofile\", coverProfile)\n    output, err := cmd.CombinedOutput()\n    if err != nil {\n        log.Fatalf(\"Output: %s, Error: %s\", string(output), err)\n    }\n    fmt.Println(string(output))\n    fmt.Println(\"Coverprofile saved to \", coverProfile)\n}\n</code></pre>\n\n<p>Not clear from where to import <code>Asset</code> func on line <code>prog, err := Asset(\"flags.test\")</code>. \nRunning <code>go build -o wrapper wrapper.go</code> gives me</p>\n\n<pre><code>./wrapper.go:13: cannot convert \"flags.test\" (type string) to type bindata.Asset\n./wrapper.go:13: assignment count mismatch: 2 = 1\n</code></pre>\n"}, {"tags": ["oracle", "go", "static-linking", "cgo", "oci8"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470394298, "post_id": 38785691, "comment_id": 64944868, "body": "You haven&#39;t shown if <code>&#47;usr&#47;lib&#47;oracle&#47;12.1&#47;client64&#47;lib&#47;</code> contains static libs for everything you need (or if the system has static versions of its dependencies, but that&#39;s more likely)"}, {"owner": {"reputation": 123, "user_id": 6262157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uG6Hz.jpg?s=128&g=1", "display_name": "hanneslehmann", "link": "https://stackoverflow.com/users/6262157/hanneslehmann"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470642692, "post_id": 38785691, "comment_id": 65013807, "body": "Hi, I have to admit that I have not to much knowledge when it comes to compiling static programs. So, here is my directory:  <code>ls &#47;usr&#47;lib&#47;oracle&#47;12.1&#47;client64&#47;lib&#47; glogin.sql              libclntsh.so            libclntsh.so.12.1   libclntshcore.so        libclntshcore.so.12.1   libipc1.so          libmql1.so          libnnz12.so         libocci.so        libocci.so.12.1   libociei.so      libocijdbc12.so   libons.so          liboramysql12.so   libsqlplus.so      libsqlplusic.so    ojdbc6.jar ojdbc7.jar ottclasses.zip xstreams.jar </code>"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 6262157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uG6Hz.jpg?s=128&g=1", "display_name": "hanneslehmann", "link": "https://stackoverflow.com/users/6262157/hanneslehmann"}, "edited": false, "score": 0, "creation_date": 1470471592, "post_id": 38787452, "comment_id": 64973462, "body": "Hi, thanks for your quick answer. I don&#39;t have the relink tool in my installation (I don&#39;t have the oracle full install), I downloaded some of the instant client packages and installed them on ubuntu via alien (followed instructions from here: [<a href=\"https://help.ubuntu.com/community/Oracle%20Instant%20Client]\" rel=\"nofollow noreferrer\">help.ubuntu.com/community/Oracle%20Instant%20Client]</a>) . Will check later if relink is inside some other package I didn&#39;t unzip/install yet."}, {"owner": {"reputation": 123, "user_id": 6262157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uG6Hz.jpg?s=128&g=1", "display_name": "hanneslehmann", "link": "https://stackoverflow.com/users/6262157/hanneslehmann"}, "edited": false, "score": 0, "creation_date": 1470733316, "post_id": 38787452, "comment_id": 65057340, "body": "Hi, so I found out that (see above comment) I am missing the &quot;.a&quot; static libraries. My folder contains only the shared files. Now I am chasing the $ORACLE_HOME/bin/relink as it is not available via the installation procedure I followed from the Ubuntu community. I hope the tool will then generate the &quot;.a&quot; files"}, {"owner": {"reputation": 123, "user_id": 6262157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uG6Hz.jpg?s=128&g=1", "display_name": "hanneslehmann", "link": "https://stackoverflow.com/users/6262157/hanneslehmann"}, "edited": false, "score": 0, "creation_date": 1475593313, "post_id": 38787452, "comment_id": 66999190, "body": "Hi, meanwhile I have installed the oracle installation and found the relink tool. In the logs of the tool I find some error messages regarding the linker (again), so I have to go through them to fix them until I get the static library....I guess..."}, {"owner": {"reputation": 123, "user_id": 6262157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uG6Hz.jpg?s=128&g=1", "display_name": "hanneslehmann", "link": "https://stackoverflow.com/users/6262157/hanneslehmann"}, "edited": false, "score": 0, "creation_date": 1475756342, "post_id": 38787452, "comment_id": 67077130, "body": "Hi, I made it to run the relink tool after fixing some issues (mainly with the help of (<a href=\"https://gemsofprogramming.wordpress.com/2013/09/19/installing-oracle-12c-on-ubuntu-12-04-64-bit-a-hard-journey-but-its-worth-it/\" rel=\"nofollow noreferrer\">gemsofprogramming.wordpress.com/2013/09/19/&hellip;</a>). You are right, now I have tons of symbols missing and need to resolve them."}], "tags": [], "owner": {"reputation": 4133, "user_id": 836215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96343cdb1ae4d50aa89067f4427dccca?s=128&d=identicon&r=PG", "display_name": "ibre5041", "link": "https://stackoverflow.com/users/836215/ibre5041"}, "is_accepted": true, "score": 1, "last_activity_date": 1470402084, "last_edit_date": 1470402084, "creation_date": 1470394306, "answer_id": 38787452, "question_id": 38785691, "link": "https://stackoverflow.com/questions/38785691/trying-to-build-static-cgo-executable-with-oracle-libraries-on-linux-ubuntu/38787452#38787452", "title": "Trying to build static CGO executable with oracle libraries on Linux/Ubuntu", "body": "<ul>\n<li>Use $ORACLE_HOME/bin/relink tool to generate the library named <code>libclntst.a</code>\nThe <code>st</code> stands for static library. Oracle client is not usually shipped with this file. The </li>\n<li>Try to link your app with this library. You will most probably find many symbols missing. </li>\n<li>Use nm tool to find the source of those missing symbols.</li>\n<li><p>In case of 11gR2 this command worked for me:</p>\n\n<pre><code>/usr/bin/c++ -Wall -ggdb3 -fPIC \\\n CMakeFiles/opassgen.dir/opassgen.cpp.o \\\n CMakeFiles/opassgen.dir/dbutils.cpp.o \\\n CMakeFiles/opassgen.dir/common.cpp.o  \\\n CMakeFiles/opassgen.dir/crypto.cpp.o  \\\n n.o  -o opassgen                      \\\n -rdynamic -static-libgcc -L. -Wl,-Bstatic -lstdc++ -Wl,-Bdynamic \\\n /home/oracle/ivan/openssl-1.0.1t/libcrypto.a  \\\n /oracle/u01/db/11.2.0.4/lib/libclntst11.a     \\\n /oracle/u01/db/11.2.0.4/lib/libippdcmerged.a  \\\n /oracle/u01/db/11.2.0.4/lib/libippsmerged.a   \\\n -Wl,--whole-archive libtrotl.a -Wl,--no-whole-archive \\\n -lpthread -ldl\n</code></pre></li>\n</ul>\n\n<p>Static linking requires, that you resolve all the dependencies manually.\nIn this example libclntst11.a depends on symbols from libippdcmerged.a and libippsmerged.a.</p>\n\n<p>On older Oracle version the whole database was build and linked using Intel's ICC compiler. So when linking Oracle's client lib statically you also had to add some static libs from ICC's runtime.</p>\n"}], "owner": {"reputation": 123, "user_id": 6262157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uG6Hz.jpg?s=128&g=1", "display_name": "hanneslehmann", "link": "https://stackoverflow.com/users/6262157/hanneslehmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1718, "favorite_count": 3, "accepted_answer_id": 38787452, "answer_count": 1, "score": 4, "last_activity_date": 1470748913, "creation_date": 1470388812, "last_edit_date": 1470748913, "question_id": 38785691, "link": "https://stackoverflow.com/questions/38785691/trying-to-build-static-cgo-executable-with-oracle-libraries-on-linux-ubuntu", "title": "Trying to build static CGO executable with oracle libraries on Linux/Ubuntu", "body": "<p>I have already searched for some days, tried several suggestions but none helped. At the moment I just want to create a small Go snippet which connects to an Oracle Database. While everything works by using normal <code>go build</code> and invoking the resulting dynamic linked application, I am stuck when I try to run the static compiler. I already have build other projects statically (even with CGO) without problems, but here gcc is not finding the oracle library. Maybe someone has a hint?</p>\n\n<p>Error during build:</p>\n\n<pre><code>host link: \"gcc\" \"-m64\" \"-gdwarf-2\" \"-o\" \"/tmp/go-build319417544/command-line-arguments/_obj/exe/a.out\" \"-static\" \"/tmp/go-link-116023228/000000.o\" \"/tmp/go-link-116023228/000001.o\" \"/tmp/go-link-116023228/000002.o\" \"/tmp/go-link-116023228/go.o\" \"-g\" \"-O2\" \"-g\" \"-O2\" \"-lpthread\" \"-g\" \"-O2\" \"-L/usr/lib/oracle/12.1/client64/lib\" \"-lclntsh\" \"-static\"\n/home/hannes/.gvm/gos/go1.5/pkg/tool/linux_amd64/link: running gcc failed: exit status 1\n/usr/bin/ld: cannot find -lclntsh\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Build command</p>\n\n<pre><code> CGO_ENABLED=1  go build -work -x -ldflags  \" -v -linkmode external -extldflags -static\"  ${MAIN_SRC}\n</code></pre>\n\n<p>Application code:</p>\n\n<pre><code>package main\n/*\n// #cgo CFLAGS: -I/usr/lib/oracle/12.1/client64/include\n// #cgo LDFLAGS: -L/usr/lib/oracle/12.1/client64/lib -lclntsh\n*/\nimport \"C\"\nimport (\n    \"fmt\"\n    \"database/sql\"\n    _ \"github.com/mattn/go-oci8\"\n    \"time\"\n)\n\nfunc main(){\n\n\n    db, err := sql.Open(\"oci8\", \"...\")\n    ...\n}\n</code></pre>\n\n<p>I have checked with </p>\n\n<pre><code>dconfig -p | grep cln\nlibkadm5clnt_mit.so.9 (libc6,x86-64) =&gt; /usr/lib/x86_64-linux-gnu/libkadm5clnt_mit.so.9\nlibclntshcore.so.12.1 (libc6,x86-64) =&gt; /usr/lib/oracle/12.1/client64/lib/libclntshcore.so.12.1\nlibclntshcore.so (libc6,x86-64) =&gt; /usr/lib/oracle/12.1/client64/lib/libclntshcore.so\nlibclntsh.so.12.1 (libc6,x86-64) =&gt; /usr/lib/oracle/12.1/client64/lib/libclntsh.so.12.1\nlibclntsh.so (libc6,x86-64) =&gt; /usr/lib/oracle/12.1/client64/lib/libclntsh.so\n</code></pre>\n\n<p>The dynamic build executable (just \"go build oracle_test.go) has everything it needs:</p>\n\n<pre><code>ldd oracle_test \nlinux-vdso.so.1 =&gt;  (0x00007ffeac867000)\nlibpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f083ef82000)\nlibclntsh.so.12.1 =&gt; /usr/lib/oracle/12.1/client64/lib/libclntsh.so.12.1 (0x00007f083bfc5000)\nlibc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f083bbfa000)\n/lib64/ld-linux-x86-64.so.2 (0x00005615b32e8000)\nlibmql1.so =&gt; /usr/lib/oracle/12.1/client64/lib/libmql1.so (0x00007f083b984000)\nlibipc1.so =&gt; /usr/lib/oracle/12.1/client64/lib/libipc1.so (0x00007f083b606000)\nlibnnz12.so =&gt; /usr/lib/oracle/12.1/client64/lib/libnnz12.so (0x00007f083aefb000)\nlibons.so =&gt; /usr/lib/oracle/12.1/client64/lib/libons.so (0x00007f083acb6000)\nlibdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f083aab2000)\nlibm.so.6 =&gt; /lib/x86_64-linux-gnu/libm.so.6 (0x00007f083a7a9000)\nlibnsl.so.1 =&gt; /lib/x86_64-linux-gnu/libnsl.so.1 (0x00007f083a58f000)\nlibrt.so.1 =&gt; /lib/x86_64-linux-gnu/librt.so.1 (0x00007f083a387000)\nlibaio.so.1 =&gt; /lib/x86_64-linux-gnu/libaio.so.1 (0x00007f083a184000)\nlibclntshcore.so.12.1 =&gt; /usr/lib/oracle/12.1/client64/lib/libclntshcore.so.12.1 (0x00007f0839c12000)\n</code></pre>\n\n<p>I also tried to put/export CGO_LDFLAGS and/ord LD_LIBRARY_PATH environment variable, which didn't help.</p>\n\n<p>Pkg-config shows as well the library</p>\n\n<pre><code>pkg-config --libs oci8\n-L/usr/lib/oracle/12.1/client64/lib -lclntsh\n</code></pre>\n\n<p>After looking for the static libraries, I have installed the complete oracle database package and now I have some more files in lib folder: \n<code>ls  /usr/lib/oracle/12.1/client64/lib/lib*.a<br>\n-rw-r--r--  1   1424782 /usr/lib/oracle/12.1/client64/lib/libagent12.a\n-rw-r--r--  1   1962088 /usr/lib/oracle/12.1/client64/lib/libasmclnt12.a\n-rw-r--r--  1   2187864 /usr/lib/oracle/12.1/client64/lib/libasmclntsh12.a\n-rw-r--r--  1   11386   /usr/lib/oracle/12.1/client64/lib/libasmperl12.a\n-rw-r--r--  1   28454   /usr/lib/oracle/12.1/client64/lib/libavstub12.a\n-rw-r--r--  1   7408322 /usr/lib/oracle/12.1/client64/lib/libcell12.a\n-rw-r--r--  1   11246008    /usr/lib/oracle/12.1/client64/lib/libclient12.a\n-rw-r--r--  1   0   /usr/lib/oracle/12.1/client64/lib/libclntst12.a\n-rw-r--r--  1   1749282 /usr/lib/oracle/12.1/client64/lib/libclsr12.a\n-rw-r--r--  1   10087032    /usr/lib/oracle/12.1/client64/lib/libcommon12.a\n-rw-r--r--  1   5803698 /usr/lib/oracle/12.1/client64/lib/libcore12.a\n-rw-r--r--  1   6051402 /usr/lib/oracle/12.1/client64/lib/libctx12.a\n-rw-r--r--  1   1201840 /usr/lib/oracle/12.1/client64/lib/libctxc12.a\n-rw-r--r--  1   56964   /usr/lib/oracle/12.1/client64/lib/libctxs12.a\n...snipped...\n</code></p>\n\n<p>As seen the one file has zero size, so I had to run $ORACLE_HOME/bin/genclntst to generate libclntst12.a.</p>\n"}, {"tags": ["go", "struct", "anonymous-types"], "comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 1, "creation_date": 1470387285, "post_id": 38784963, "comment_id": 64940638, "body": "What happens if you upper case the properties of the struct? struct {I int S string}"}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "reply_to_user": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1470387400, "post_id": 38784963, "comment_id": 64940715, "body": "@Dale : Yes! I just noticed this too! Thanks! How silly I am!"}], "answers": [{"tags": [], "owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "is_accepted": false, "score": 6, "last_activity_date": 1470800467, "last_edit_date": 1470800467, "creation_date": 1470387351, "answer_id": 38785185, "question_id": 38784963, "link": "https://stackoverflow.com/questions/38784963/exporting-functions-with-anonymous-struct-as-a-parameter-cannot-use-value-type/38785185#38785185", "title": "Exporting functions with anonymous struct as a parameter [cannot use value (type struct {...}) as type struct {...} in argument to package.Func]", "body": "<p>Oh! I just realized that the field names are in lowercase, and thus not public! Changing the first letter of the field names to uppercase solves the problem:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"temp\"\n)\n\nfunc main() {\n    value := struct {\n        I int\n        S string\n    }{\n        0, \"Hello, world!\",\n    }\n    temp.PrintAnonymous(value)\n    temp.PrintAnonymous2(struct{}{})\n}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package temp\n\nimport (\n    \"fmt\"\n)\n\nfunc PrintAnonymous(v struct{I int; S string}) {\n    fmt.Printf(\"%d: %s\\n\", v.I, v.S)\n}\n\nfunc PrintAnonymous2(v struct{}) {\n    fmt.Println(\"Whatever\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1470900906, "last_edit_date": 1495542767, "creation_date": 1470389594, "answer_id": 38785966, "question_id": 38784963, "link": "https://stackoverflow.com/questions/38784963/exporting-functions-with-anonymous-struct-as-a-parameter-cannot-use-value-type/38785966#38785966", "title": "Exporting functions with anonymous struct as a parameter [cannot use value (type struct {...}) as type struct {...} in argument to package.Func]", "body": "<p>The fields of your anonymous struct type are unexported. This means you cannot create values of this struct and specify values for the fields from another package. <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">Spec: Composite literals:</a></p>\n\n<blockquote>\n  <p>It is an error to specify an element for a non-exported field of a struct belonging to a different package.</p>\n</blockquote>\n\n<p>If you change the struct definition to export the fields, then it will work because all fields can be assigned to by other packages (see Siu Ching Pong -Asuka Kenji-'s answer).</p>\n\n<p>This is the case with the empty struct (with no fields) too: the empty struct has no fields, thus it has no unexported fields, so you're allowed to pass a value of that.</p>\n\n<p>You can call the function with unmodified struct (with unexported fields) via <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflection</a> though. You can obtain the <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>reflect.Type</code></a> of the <code>PrintAnonymous()</code> function, and you can use <code>Type.In()</code> to get the <code>reflect.Type</code> of its first parameter. That is the anonymous struct we want to pass a value for. And you can construct a value of that type using <a href=\"https://golang.org/pkg/reflect/#New\" rel=\"nofollow noreferrer\"><code>reflect.New()</code></a>. This will be a <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>reflect.Value</code></a>, wrapping a pointer to the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">zero value</a> of the anonymous struct. Sorry, you can't have a struct value with fields having non-zero values (for reason mentioned above).</p>\n\n<p>This is how it could look like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>v := reflect.ValueOf(somepackage.PrintAnonymous)\nparamt := v.Type().In(0)\nv.Call([]reflect.Value{reflect.New(paramt).Elem()})\n</code></pre>\n\n<p>This will print:</p>\n\n<pre><code>0: \n</code></pre>\n\n<p><code>0</code> is zero value for <code>int</code>, and <code>\"\"</code> empty string for <code>string</code>.</p>\n\n<p>For deeper inside into the type system and structs with unexported fields, see related questions:</p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/36310538/identify-non-builtin-types-using-reflect\">Identify non builtin-types using reflect</a></strong><br>\n<strong><a href=\"https://stackoverflow.com/questions/38369350/how-to-clone-a-structure-with-unexported-field\">How to clone a structure with unexported field?</a></strong></p>\n\n<hr>\n\n<p>Interestingly (<em>this is a bug</em>, see linked issue below), using reflection, you can use a value of your own anonymous struct type (with matching, unexported fields), and in this case we can use values other than the zero value of the struct fields:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>value := struct {\n    i int\n    s string\n}{\n    1, \"Hello, world!\",\n}\n\nv.Call([]reflect.Value{reflect.ValueOf(value)})\n</code></pre>\n\n<p>Above runs (without panic):</p>\n\n<pre><code>1: Hello, world!\n</code></pre>\n\n<p>The reason why this is allowed is due to a bug in the compiler. See the example code below:</p>\n\n<pre><code>s := struct{ i int }{2}\n\nt := reflect.TypeOf(s)\nfmt.Printf(\"Name: %q, PkgPath: %q\\n\", t.Name(), t.PkgPath())\nfmt.Printf(\"Name: %q, PkgPath: %q\\n\", t.Field(0).Name, t.Field(0).PkgPath)\n\nt2 := reflect.TypeOf(subplay.PrintAnonymous).In(0)\nfmt.Printf(\"Name: %q, PkgPath: %q\\n\", t2.Name(), t2.PkgPath())\nfmt.Printf(\"Name: %q, PkgPath: %q\\n\", t2.Field(0).Name, t2.Field(0).PkgPath)\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>Name: \"\", PkgPath: \"\"\nName: \"i\", PkgPath: \"main\"\nName: \"\", PkgPath: \"\"\nName: \"i\", PkgPath: \"main\"\n</code></pre>\n\n<p>As you can see the unexported field <code>i</code> in both anonymous struct types (in <code>main</code> package and in <code>somepackage</code> as parameter to <code>PrintAnonymous()</code> function) \u2013falsely\u2013 report the same package, and thus their type will be equal:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>fmt.Println(t == t2) // Prints true\n</code></pre>\n\n<p>Note: I consider this a <em>flaw</em>: if this is allowed using reflection, then this should be possible without using reflection too. If without reflection the compile-time error is justified, then using reflection should result in runtime panic. I opened an issue for this, you can follow it here: <a href=\"https://github.com/golang/go/issues/16616\" rel=\"nofollow noreferrer\">issue #16616</a>. Fix currently aims Go 1.8.</p>\n"}], "owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5359, "favorite_count": 2, "accepted_answer_id": 38785966, "answer_count": 2, "score": 16, "last_activity_date": 1519498412, "creation_date": 1470386660, "last_edit_date": 1519498412, "question_id": 38784963, "link": "https://stackoverflow.com/questions/38784963/exporting-functions-with-anonymous-struct-as-a-parameter-cannot-use-value-type", "title": "Exporting functions with anonymous struct as a parameter [cannot use value (type struct {...}) as type struct {...} in argument to package.Func]", "body": "<p>Here is a piece of code <kbd><a href=\"https://play.golang.org/p/nk9HBJAMO3\" rel=\"nofollow noreferrer\">play.google.org</a></kbd> that runs without any problem:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc PrintAnonymous(v struct {\n    i int\n    s string\n}) {\n    fmt.Printf(\"%d: %s\\n\", v.i, v.s)\n}\n\nfunc PrintAnonymous2(v struct{}) {\n    fmt.Println(\"Whatever\")\n}\n\nfunc main() {\n    value := struct {\n        i int\n        s string\n    }{\n        0, \"Hello, world!\",\n    }\n    PrintAnonymous(value)\n    PrintAnonymous2(struct{}{})\n}\n</code></pre>\n\n<p>However, if the <code>PrintAnonymous()</code> function exists in another package (let's say, <code>temp</code>), the code will not work:</p>\n\n<pre><code>cannot use value (type struct { i int; s string })\nas type struct { i int; s string } in argument to temp.PrintAnonymous\n</code></pre>\n\n<p>My question are:</p>\n\n<ul>\n<li>Is there a way to call a (public) function with anonymous struct as a parameter (a.k.a. <code>PrintAnonymous()</code> above)?</li>\n<li>A function with empty struct as a parameter (a.k.a. <code>PrintAnonymous2()</code> above) can be called even if it exists in another package. Is this a special case?</li>\n</ul>\n\n<p>Well, I know that I can always name the <code>struct</code> to solve the problem, I'm just curious about this, and wonder why it seems that this is not allowed.</p>\n"}, {"tags": ["arrays", "go", "initialization", "variable-assignment", "declaration"], "answers": [{"comments": [{"owner": {"reputation": 11270, "user_id": 590088, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ed3c16678b7536774b5eef75cee2e764?s=128&d=identicon&r=PG", "display_name": "eran otzap", "link": "https://stackoverflow.com/users/590088/eran-otzap"}, "edited": false, "score": 0, "creation_date": 1569593622, "post_id": 38783337, "comment_id": 102659150, "body": "what if i wanted to init an array of int with -1 ?  with out knowing the arrays size.  something like \t_indexes := [numStacks]int{-1}"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11270, "user_id": 590088, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ed3c16678b7536774b5eef75cee2e764?s=128&d=identicon&r=PG", "display_name": "eran otzap", "link": "https://stackoverflow.com/users/590088/eran-otzap"}, "edited": false, "score": 0, "creation_date": 1569594090, "post_id": 38783337, "comment_id": 102659400, "body": "@eranotzap What about that? If <code>numStacks</code> is a constant greater than <code>0</code>, that will work. If you want all elements initialized to <code>-1</code>, see <a href=\"https://stackoverflow.com/questions/30614165/is-there-analog-of-memset-in-go/30614594#30614594\">Is there analog of memset in go?</a>"}, {"owner": {"reputation": 11270, "user_id": 590088, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ed3c16678b7536774b5eef75cee2e764?s=128&d=identicon&r=PG", "display_name": "eran otzap", "link": "https://stackoverflow.com/users/590088/eran-otzap"}, "edited": false, "score": 0, "creation_date": 1569594392, "post_id": 38783337, "comment_id": 102659554, "body": "well before even tackling the init issue.  _indexes := [numStacks]int\t gives me this error.  non-constant array bound numStacks go"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11270, "user_id": 590088, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ed3c16678b7536774b5eef75cee2e764?s=128&d=identicon&r=PG", "display_name": "eran otzap", "link": "https://stackoverflow.com/users/590088/eran-otzap"}, "edited": false, "score": 1, "creation_date": 1569594472, "post_id": 38783337, "comment_id": 102659596, "body": "@eranotzap Please read my previous comment: <i>if <code>numstacks</code> is a <b>constant</b>...</i> Array size must be constant. If you don&#39;t know it at compile time, use slices instead of arrays."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1471849062, "last_edit_date": 1592644375, "creation_date": 1470381322, "answer_id": 38783337, "question_id": 38783260, "link": "https://stackoverflow.com/questions/38783260/go-explicit-array-initialization/38783337#38783337", "title": "GO explicit array initialization", "body": "<p>They are equivalent. In general: <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">Spec: Short variable declaration:</a></p>\n<blockquote>\n<p>A <em>short variable declaration</em> uses the syntax:</p>\n<pre><code>ShortVarDecl = IdentifierList &quot;:=&quot; ExpressionList .\n</code></pre>\n<p>It is shorthand for a regular <a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">variable declaration</a> with initializer expressions but no types:</p>\n<pre><code>&quot;var&quot; IdentifierList = ExpressionList .\n</code></pre>\n</blockquote>\n<p>So this line:</p>\n<pre><code>a := [3]int{369, 0, 963}\n</code></pre>\n<p>Is equivalent to this:</p>\n<pre><code>var a = [3]int{369, 0, 963}\n</code></pre>\n<p>But since the expression list is a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a> of type <code>[3]int</code>, the following is the same:</p>\n<pre><code>var a [3]int = [3]int{369, 0, 963}\n</code></pre>\n<p><a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">Spec: Variable declaration:</a></p>\n<blockquote>\n<p>If a type is present, each variable is given that type. Otherwise, each variable is given the type of the corresponding initialization value in the assignment.</p>\n</blockquote>\n<p>So you may use any of the following, all declare and initialize a variable of type <code>[3]int</code>:</p>\n<pre><code>a := [3]int{369, 0, 963}\nb := [...]int{369, 0, 963}\nvar c = [3]int{369, 0, 963}\nvar d [3]int = [3]int{369, 0, 963}\nvar e [3]int = [...]int{369, 0, 963}\nvar f = [...]int{369, 0, 963}\n</code></pre>\n<p><strong>Notes:</strong></p>\n<p>Note that in composite literals, it is valid to not list all values. Elements whose value is not explicitly specified will be the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">zero value</a> of the element type. You may include an optional index before a value in the enumeration to specify the element whose value it will be.</p>\n<p><a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">Spec: Composite literals:</a></p>\n<blockquote>\n<p>For array and slice literals the following rules apply:</p>\n<ul>\n<li>Each element has an associated integer index marking its position in the array.</li>\n<li>An element with a key uses the key as its index; the key must be a constant integer expression.</li>\n<li>An element without a key uses the previous element's index plus one. If the first element has no key, its index is zero.</li>\n</ul>\n</blockquote>\n<p>Since your initial array contains a <code>0</code> which is the zero value for the element type <code>int</code>, you may exclude it from the literal. To create and initialize a variable to the value <code>[3]int{369, 0, 963}</code>, you may also do it like this:</p>\n<pre><code>// Value at index 1 implicitly gets 0:\ng := [3]int{369, 2: 963} \nh := [...]int{369, 2: 963} \n</code></pre>\n<p>Try all the examples on the <a href=\"https://play.golang.org/p/KgumxQDosZ\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n<p>See this question for more details + practical examples: <strong><a href=\"https://stackoverflow.com/questions/36302441/keyed-items-in-golang-array-initialization\">Keyed items in golang array initialization</a></strong></p>\n"}], "owner": {"reputation": 215, "user_id": 6245040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff049024bed71295b8446acb6eb1a042?s=128&d=identicon&r=PG&f=1", "display_name": "User0123456789", "link": "https://stackoverflow.com/users/6245040/user0123456789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2960, "favorite_count": 1, "accepted_answer_id": 38783337, "answer_count": 1, "score": 5, "last_activity_date": 1498825991, "creation_date": 1470381030, "question_id": 38783260, "link": "https://stackoverflow.com/questions/38783260/go-explicit-array-initialization", "title": "GO explicit array initialization", "body": "<p>Is there explicit array initialization (declaration and assignment) in GO or the only way is using the shorthand operator?\nHere is a practical example - is this two equal:</p>\n\n<pre><code>a := [3]int{1, 0, 1}\n\nvar a [3]int = [3]int{1, 0, 1}\n</code></pre>\n"}, {"tags": ["vim", "go", "macvim"], "comments": [{"owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "edited": false, "score": 0, "creation_date": 1470380877, "post_id": 38782986, "comment_id": 64936930, "body": "Yes, but Im looking to have GoBuild run automatically upon the saving of a go file. - Will edit question to better reflect this."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 2, "last_activity_date": 1470383877, "last_edit_date": 1470383877, "creation_date": 1470381172, "answer_id": 38783299, "question_id": 38782986, "link": "https://stackoverflow.com/questions/38782986/golang-running-go-build-on-save-using-vim-macvim-and-vim-go/38783299#38783299", "title": "Golang: running `go build` on save using vim (macvim) and vim-go", "body": "<p>yes, use vim <code>autocommand</code> to run <code>:GoBuild</code>:  </p>\n\n<blockquote>\n  <p>You can specify commands to be executed automatically when reading or\n  writing a file, when entering or leaving a buffer or window, and when\n  exiting Vim.  The usual place to put autocommands is in your .vimrc or\n  .exrc file.</p>\n</blockquote>\n\n<p>Run the following command:</p>\n\n<p><code>:autocmd BufWritePre *.go :GoBuild</code></p>\n\n<p>Now each time you save your Go file with <code>:w</code> it will run <code>:GoBuild</code> too.<br>\nThe event type is <code>BufWritePre</code>, which means the event will be checked just before you write <code>*.go</code> file.</p>\n\n<blockquote>\n  <p><code>BufWritePre</code> starting to write the whole buffer to a file<br>\n  <code>BufWritePost</code> after writing the whole buffer to a file</p>\n</blockquote>\n\n<p>and:</p>\n\n<blockquote>\n  <p>When your .vimrc file is sourced twice, the autocommands will appear\n  twice. To avoid this, put this command in your .vimrc file, before\n  defining autocommands:</p>\n\n<pre><code>:autocmd! \" Remove ALL autocommands for the current group.\n</code></pre>\n  \n  <p>If you don't want to remove all autocommands, you can instead use a\n  variable to ensure that Vim includes the autocommands only once:</p>\n\n<pre><code>:if !exists(\"autocommands_loaded\")    \n:  let autocommands_loaded = 1    \n: au ...  \n:endif\n</code></pre>\n</blockquote>\n\n<p>like this (put this at the end of your vim startup file):  </p>\n\n<pre><code>:if !exists(\"autocommands_loaded\")\n:  let autocommands_loaded = 1\n:  autocmd BufWritePost *.go :GoBuild\n:endif\n</code></pre>\n\n<p>ref:<br>\n<a href=\"http://vimdoc.sourceforge.net/htmldoc/autocmd.html\" rel=\"nofollow\">http://vimdoc.sourceforge.net/htmldoc/autocmd.html</a><br>\n<a href=\"http://learnvimscriptthehardway.stevelosh.com/chapters/12.html\" rel=\"nofollow\">http://learnvimscriptthehardway.stevelosh.com/chapters/12.html</a>  </p>\n"}, {"tags": [], "owner": {"reputation": 9197, "user_id": 1338062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1326e2782566f50c3340b9951819f0?s=128&d=identicon&r=PG", "display_name": "user1338062", "link": "https://stackoverflow.com/users/1338062/user1338062"}, "is_accepted": false, "score": 0, "last_activity_date": 1521107220, "creation_date": 1521107220, "answer_id": 49296080, "question_id": 38782986, "link": "https://stackoverflow.com/questions/38782986/golang-running-go-build-on-save-using-vim-macvim-and-vim-go/49296080#49296080", "title": "Golang: running `go build` on save using vim (macvim) and vim-go", "body": "<p>Create <code>~/.vim/after/ftplugin/go.vim</code> with:</p>\n\n<pre><code>autocmd BufWritePre *.go :GoBuild\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1293, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1521107220, "creation_date": 1470380068, "last_edit_date": 1470381578, "question_id": 38782986, "link": "https://stackoverflow.com/questions/38782986/golang-running-go-build-on-save-using-vim-macvim-and-vim-go", "title": "Golang: running `go build` on save using vim (macvim) and vim-go", "body": "<p>I am recently moving from sublime 3 go to mvim (vim on the mac os) and am trying to get my Golang development environment to be as similar on vim to my sublime implementation as possible. </p>\n\n<p>Within my sublime setup, it runs <code>go build</code> anytime I save the a Go file. This provides me instant feedback on if I have unused vars or other info <code>go build</code> provides. </p>\n\n<p>I'm attempting to move to vim, and am wondering if I can have this functionality implemented there as well. I am using vim-go but have not found a setting to implement this. </p>\n\n<p>In short I want to run <code>:GoBuild</code> upon the saving of a Go file while using vim / vim-go. Is this Possible and how do I do so?</p>\n"}, {"tags": ["windows", "go", "build", "antivirus"], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 4034917, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bZwdXgIm38k/AAAAAAAAAAI/AAAAAAAABAk/lVdH3NHbDFE/photo.jpg?sz=128", "display_name": "Dmitry Kapsamun", "link": "https://stackoverflow.com/users/4034917/dmitry-kapsamun"}, "edited": false, "score": 2, "creation_date": 1470640983, "post_id": 38782892, "comment_id": 65012925, "body": "It&#39;s not a solution because in Windows Go compiles in temp folder - <i>C:\\Users\\D24F7~1.KAP\\AppData\\Local\\Temp_ - and only then copies it into _/your/custom/path</i>. So it&#39;s sill <b>Access denied</b> error."}], "tags": [], "owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "is_accepted": false, "score": 0, "last_activity_date": 1470380148, "last_edit_date": 1470380148, "creation_date": 1470379775, "answer_id": 38782892, "question_id": 38782750, "link": "https://stackoverflow.com/questions/38782750/golang-change-build-working-path-on-windows/38782892#38782892", "title": "Golang - change build working path on Windows", "body": "<p>You can build a binary directly using <code>go build</code> (out binary is at current dir) or <code>go build -o /your/custom/path</code>. Then just run the output binary.</p>\n"}, {"tags": [], "owner": {"reputation": 267, "user_id": 6029196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9163d11bdfcfa225915266be86e084dd?s=128&d=identicon&r=PG&f=1", "display_name": "Vetos", "link": "https://stackoverflow.com/users/6029196/vetos"}, "is_accepted": false, "score": 1, "last_activity_date": 1514705728, "creation_date": 1514705728, "answer_id": 48040811, "question_id": 38782750, "link": "https://stackoverflow.com/questions/38782750/golang-change-build-working-path-on-windows/48040811#48040811", "title": "Golang - change build working path on Windows", "body": "<p>I change ouput directoty </p>\n\n<pre><code>go build -i -o D:\\Users\\MyProj\\out\\\n</code></pre>\n\n<p>-o  flag</p>\n\n<p>and put to antivirus ignoring D:\\Users\\MyProj\\out\\ directory</p>\n"}, {"tags": [], "owner": {"reputation": 385, "user_id": 4085283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TqUPC.jpg?s=128&g=1", "display_name": "Andrey Kaipov", "link": "https://stackoverflow.com/users/4085283/andrey-kaipov"}, "is_accepted": false, "score": 2, "last_activity_date": 1597114859, "creation_date": 1597114859, "answer_id": 63350873, "question_id": 38782750, "link": "https://stackoverflow.com/questions/38782750/golang-change-build-working-path-on-windows/63350873#63350873", "title": "Golang - change build working path on Windows", "body": "<p>The <code>WORK</code> directory (seen if building or running with the <code>-x</code> flag) is taken from the <code>TMP</code> environment variable. Updating that variable through the system properties will change the working directory.</p>\n"}], "owner": {"reputation": 399, "user_id": 4034917, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bZwdXgIm38k/AAAAAAAAAAI/AAAAAAAABAk/lVdH3NHbDFE/photo.jpg?sz=128", "display_name": "Dmitry Kapsamun", "link": "https://stackoverflow.com/users/4034917/dmitry-kapsamun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2795, "favorite_count": 0, "answer_count": 3, "score": 10, "last_activity_date": 1597114859, "creation_date": 1470379297, "question_id": 38782750, "link": "https://stackoverflow.com/questions/38782750/golang-change-build-working-path-on-windows", "title": "Golang - change build working path on Windows", "body": "<p>I'm testing simple Go program on Windows 8 with SublimeText3 (GoSublime plugin)</p>\n\n<pre><code>go run -v example.go\n</code></pre>\n\n<p>and before run it's being compiled inside <em>..AppData\\Local\\Temp..</em> directory. My antivirus program thinks that it's a virus and blocks it:</p>\n\n<pre><code>fork/exec C:\\Users\\D24F7~1.KAP\\AppData\\Local\\Temp\\go-build333212398\\command-line-arguments_obj\\exe\\example.exe: Access is denied.\n</code></pre>\n\n<p>I can't disable it and my solution is to change the folder where it's being compiled.\nHow can I do that?</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda"], "comments": [{"owner": {"reputation": 1526, "user_id": 2025312, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f94f57dc8f67eb8c5230da16feb3b5a1?s=128&d=identicon&r=PG", "display_name": "stevepkr84", "link": "https://stackoverflow.com/users/2025312/stevepkr84"}, "edited": false, "score": 1, "creation_date": 1470389302, "post_id": 38782417, "comment_id": 64941901, "body": "To be clear, you are posting at an API Gateway endpoint which is backed by a lambda function? The issue is with the api configuration. I&#39;m guessing the X-Custom-Header there is part of your API authorization? I&#39;d look to double check that side of things."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "reply_to_user": {"reputation": 1526, "user_id": 2025312, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f94f57dc8f67eb8c5230da16feb3b5a1?s=128&d=identicon&r=PG", "display_name": "stevepkr84", "link": "https://stackoverflow.com/users/2025312/stevepkr84"}, "edited": false, "score": 0, "creation_date": 1470638696, "post_id": 38782417, "comment_id": 65011768, "body": "@stevepkr84 can you please explain how to send the params?"}], "answers": [{"tags": [], "owner": {"reputation": 391, "user_id": 4375384, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_RqBl08cXag/AAAAAAAAAAI/AAAAAAAAAH4/YeJ8_X9cdiw/photo.jpg?sz=128", "display_name": "Noah Zoschke", "link": "https://stackoverflow.com/users/4375384/noah-zoschke"}, "is_accepted": false, "score": 1, "last_activity_date": 1522422213, "creation_date": 1522422213, "answer_id": 49576742, "question_id": 38782417, "link": "https://stackoverflow.com/questions/38782417/error-posting-to-aws-lambda-function/49576742#49576742", "title": "Error - Posting to aws lambda function", "body": "<p>How you invoke a Lambda function over HTTP via API Gateway very much depends on how the API Gateway is configured.</p>\n\n<p>By default there is no authentication, so plain POST might work:</p>\n\n<pre><code>$ curl -X POST https://x19vpdk568.execute-api.us-east-1.amazonaws.com/Prod/users -d '{\"username\":\"noah\"}'\n{\n  \"id\": \"4c47648f-e419-456b-97b8-22f82a9df6cb\",\n  \"username\": \"noah\"\n}\n</code></pre>\n\n<p>Check out my <a href=\"https://github.com/nzoschke/gofaas/blob/master/docs/http-functions.md\" rel=\"nofollow noreferrer\">HTTP Functions with API Gateway and Lambda</a> guide for tips on setting this simple configuration up.</p>\n\n<p>You can <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/permissions.html\" rel=\"nofollow noreferrer\">configure API Gateway to use IAM for authentication</a>, which requires the AWS access key and secret. In this case, you have follow the <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/RESTAuthentication.html\" rel=\"nofollow noreferrer\">AWS Signature V4 authentication scheme</a>. There is a <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/aws/signer/v4/\" rel=\"nofollow noreferrer\">v4 signer package</a> in the aws-sdk-go which can help. </p>\n\n<p>Finally, you can also configure <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/use-custom-authorizer.html\" rel=\"nofollow noreferrer\">API Gateway custom authorizers</a> to require a custom header, etc. These schemes don't need AWS access keys.</p>\n\n<p>All said, take a close look at your API Gateway configuration to get your POST working.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1522422213, "creation_date": 1470378014, "last_edit_date": 1470378334, "question_id": 38782417, "link": "https://stackoverflow.com/questions/38782417/error-posting-to-aws-lambda-function", "title": "Error - Posting to aws lambda function", "body": "<p>I am new on AWS. I was trying to do an http post to an aws lambda function and received an error 403(Forbidden). I understood I had to pass AWS_SECRET and AWS_Key with post. How do I do it? My coding language for post is golang. </p>\n\n<p><strong>Code in Context</strong></p>\n\n<pre><code>url := \"https://xxxxx.xxxxx-api.us-west-x.amazonaws.com/prod/xxxxxx\"\nvar jsonStr = []byte(`{\"title\":\"Some data\"}`)\n\nreq, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(jsonStr))\n\nreq.Header.Set(\"X-Custom-Header\", \"myvalue\")\nreq.Header.Set(\"Content-Type\", \"application/json\")\n\nclient := &amp;http.Client{}\nresp, err := client.Do(req)\nif err != nil {\n    panic(err)\n}\ndefer resp.Body.Close()\nfmt.Println(\"response Status:\", resp.Status) // response message\n</code></pre>\n\n<p><strong>Respose Message</strong></p>\n\n<blockquote>\n  <p>response Status: 403 Forbidden</p>\n</blockquote>\n\n<p>How should I pass the authentication parameters? Is it to be passed along with the url?</p>\n"}, {"tags": ["google-app-engine", "go", "memory-leaks"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1470371649, "post_id": 38781096, "comment_id": 64933372, "body": "A <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">heap profile</a> (described at that link along with allocation and CPU profiles) can tell you what&#39;s using most of the RAM. <a href=\"https://golang.org/pkg/runtime/pprof/\" rel=\"nofollow noreferrer\"><code>runtime&#47;pprof</code></a> can send a heap prof. to any <code>Writer</code> including an <code>http.ResponseWriter</code>; you could run that behind some auth in production."}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1470372597, "post_id": 38781096, "comment_id": 64933634, "body": "You could look at this in a different way: upgrade temporarily to the next (1 or 2) instance class(es)  and check the memory usage trend. If it stabilizes after a while the instance class was indeed too small - done :) If it keeps growing (eventually causing an instance restart) then indeed some memory leakage occurs and the investigation <i>might</i> be necessary (the instance restart rate <i>might</i> be tolerable with the higher instance class). One could look at such restarts as a periodic instance refresh/self-cleaning &quot;feature&quot; allowing, for example, focusing on other, more pressing matters ;)"}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1470392415, "post_id": 38781096, "comment_id": 64943793, "body": "@twotwotwo I have that logging now, thanks for the idea."}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "reply_to_user": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1470392458, "post_id": 38781096, "comment_id": 64943820, "body": "@DanCornilescu I might try that, thanks for the recommendation. I actually think I might have found the leak while working with twotwotwo&#39;s idea above, but I&#39;ll see if it sticks around."}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "edited": false, "score": 0, "creation_date": 1470392482, "post_id": 38781096, "comment_id": 64943833, "body": "If you guys want to submit these as answers below I&#39;ll vote for both of them. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": false, "score": 1, "last_activity_date": 1470407395, "creation_date": 1470407395, "answer_id": 38791720, "question_id": 38781096, "link": "https://stackoverflow.com/questions/38781096/tracking-down-memory-leak-in-google-app-engine-golang-application/38791720#38791720", "title": "Tracking down memory leak in Google App Engine Golang application?", "body": "<p>A possible approach to check if your app has indeed a memory leak is to upgrade temporarily the instance class and check the memory usage pattern (in the developer console on the <code>Instances</code> page select the <code>Memory Usage</code> view for the respective module version).</p>\n\n<p>If the pattern eventually levels out and the instance no longer restarts then indeed your instance class was too low. Done :)</p>\n\n<p>If the usage pattern keeps growing (with a rate proportional with the app's activity) then indeed you have a memory leak. During this exercise you <em>might</em> be able to also narrow the search area - if you manage to correlate the graph growth areas with certain activities of the app.</p>\n\n<p>Even if there is a leak, using a higher instance class should increase the time between the instance restarts, maybe even making them <em>tolerable</em> (comparable with the automatic shutdown of dynamically managed instances, for example). Which would allow putting the memory leak investigation on the back burner and focusing on more pressing matters, if that's of interest to you. One could look at such restarts as an instance refresh/self-cleaning \"feature\" :)</p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 1, "last_activity_date": 1470431692, "last_edit_date": 1470431692, "creation_date": 1470426595, "answer_id": 38796825, "question_id": 38781096, "link": "https://stackoverflow.com/questions/38781096/tracking-down-memory-leak-in-google-app-engine-golang-application/38796825#38796825", "title": "Tracking down memory leak in Google App Engine Golang application?", "body": "<p>For a starting point, you might be able to try <a href=\"https://golang.org/pkg/runtime/pprof/#WriteHeapProfile\" rel=\"nofollow\"><code>pprof.WriteHeapProfile</code></a>. It'll write to any <code>Writer</code>, including an <code>http.ResponseWriter</code>, so you can write a view that checks for some auth and gives you a heap profile. An annoying thing about that is that it's really tracking <em>allocations</em>, not what <em>remains</em> allocated after GC. So in a sense it's telling you what's RAM-hungry, but doesn't target leaks specifically.</p>\n\n<p>The standard <code>expvar</code> package can expose some JSON including memstats, which tells you about GCs and the number allocs <em>and frees</em> of particular sizes of allocation (<a href=\"https://tip.golang.org/debug/vars\" rel=\"nofollow\">example</a>). If there's a leak you could use <code>allocs</code>-<code>frees</code> to get a sense of whether it's large allocs or small that are growing over time, but that's not very fine-grained. </p>\n\n<p>Finally, there's <a href=\"https://golang.org/pkg/runtime/\" rel=\"nofollow\">a function to dump the current state of the heap</a>, but I'm not sure it works in GAE and it seems to be kind of rarely used. </p>\n\n<p>Note that, to keep GC work down, Go processes grow to be about twice as large as their actual live data <em>as part of normal steady-state operation</em>. (The exact % it grows before GC depends on <code>runtime.GOGC</code>, which people sometimes increase to save collector work in exchange for using more memory.) A (very old) thread suggests <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/nKy7F-73HFQ\" rel=\"nofollow\">App Engine processes regulate GC like any other</a>, though they could have tweaked it since 2011. Anyhow, if you're allocating slowly (good for you!) you should <em>expect</em> slow process growth; it's just that usage should drop back down again after each collection cycle. </p>\n"}], "owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 987, "favorite_count": 0, "accepted_answer_id": 38796825, "answer_count": 2, "score": 0, "last_activity_date": 1470431692, "creation_date": 1470371110, "question_id": 38781096, "link": "https://stackoverflow.com/questions/38781096/tracking-down-memory-leak-in-google-app-engine-golang-application", "title": "Tracking down memory leak in Google App Engine Golang application?", "body": "<p>I saw this Python question: <a href=\"https://stackoverflow.com/questions/35189446/app-engine-deferred-tracking-down-memory-leaks\">App Engine Deferred: Tracking Down Memory Leaks</a></p>\n\n<p>... Similarly, I've run into this dreaded error:</p>\n\n<blockquote>\n  <p>Exceeded soft private memory limit of 128 MB with 128 MB after servicing 384 requests total</p>\n</blockquote>\n\n<p>...</p>\n\n<blockquote>\n  <p>After handling this request, the process that handled this request was found to be using too much memory and was terminated. This is likely to cause a new process to be used for the next request to your application. If you see this message frequently, you may have a memory leak in your application.</p>\n</blockquote>\n\n<p>According to that other question, it could be that the \"instance class\" is too small to run this application, but before increasing it I want to be sure.</p>\n\n<p>After checking through the application I can't see anything obvious as to where a leak might be (for example, unclosed buffers, etc.) ... and so whatever it is it's got to be a very small but perhaps common mistake.</p>\n\n<p>Because this is running on GAE, I can't really profile it locally very easily as far as I know as that's the runtime environment. <strong>Might anyone have a suggestion as to how to proceed and ensure that memory is being recycled properly?</strong> \u2014 I'm sort of new to Go but I've enjoyed working with it so far.</p>\n"}, {"tags": ["string", "go", "trim"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1470366630, "post_id": 38780352, "comment_id": 64932174, "body": "What is your expected output, for example: &quot;Kolaka Utara&quot; ?"}, {"owner": {"reputation": 49, "user_id": 5663115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4964fd2f2974991223cce37b8d2b143?s=128&d=identicon&r=PG&f=1", "display_name": "gchristi001", "link": "https://stackoverflow.com/users/5663115/gchristi001"}, "edited": false, "score": 0, "creation_date": 1470367922, "post_id": 38780352, "comment_id": 64932444, "body": "@Amd Yes, I expected Kolaka Utara"}], "answers": [{"tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 6, "last_activity_date": 1470366384, "creation_date": 1470366384, "answer_id": 38780457, "question_id": 38780352, "link": "https://stackoverflow.com/questions/38780352/golang-strings-trim-function/38780457#38780457", "title": "Golang: Strings Trim Function", "body": "<p>Trim returns a slice of the string s with all leading and trailing Unicode code points contained in cutset removed.</p>\n\n<p>sentence[:4] is \"Kab.\" Trim will remove all leading and trailing \"k\",\"a\", \"b\", \".\" </p>\n\n<p><a href=\"https://golang.org/pkg/strings/#Trim\">https://golang.org/pkg/strings/#Trim</a></p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 5663115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4964fd2f2974991223cce37b8d2b143?s=128&d=identicon&r=PG&f=1", "display_name": "gchristi001", "link": "https://stackoverflow.com/users/5663115/gchristi001"}, "edited": false, "score": 0, "creation_date": 1470367998, "post_id": 38780556, "comment_id": 64932460, "body": "Okay. Thank you :)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 4, "last_activity_date": 1470367228, "creation_date": 1470367228, "answer_id": 38780556, "question_id": 38780352, "link": "https://stackoverflow.com/questions/38780352/golang-strings-trim-function/38780556#38780556", "title": "Golang: Strings Trim Function", "body": "<p>If you want to trim the first 5 bytes, then use:</p>\n\n<pre><code>result := sentence[5:]\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/mWjAQ3kgLY\" rel=\"nofollow\">playground example</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 2, "last_activity_date": 1506535607, "last_edit_date": 1506535607, "creation_date": 1470368442, "answer_id": 38780712, "question_id": 38780352, "link": "https://stackoverflow.com/questions/38780352/golang-strings-trim-function/38780712#38780712", "title": "Golang: Strings Trim Function", "body": "<p>Since strings are UTF-8 encoded in Golang for <strong>single byte Unicode code points</strong>  you may use <code>result := sentence[5:]</code><br>\nlike this working sample code:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    sentence := \"Kab. Kolaka Utara\"\n    result := sentence[5:]\n    fmt.Println(result)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Kolaka Utara\n</code></pre>\n\n<p>and for multibyte Unicode code points like <code>\"\u00b5\u00b5\u00b5\u00b5 Kolaka Utara\"</code> you may use <code>string([]rune(sentence)[5:])</code>, like this working sample code:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    sentence := \"\u00b5\u00b5\u00b5\u00b5 Kolaka Utara\"\n    result := string([]rune(sentence)[5:])\n    fmt.Println(result)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Kolaka Utara\n</code></pre>\n\n<p>and see Docs:  </p>\n\n<p><code>func Trim(s string, cutset string) string</code>:  </p>\n\n<blockquote>\n  <p>Trim returns a slice of the string s with all leading and trailing\n  Unicode code points contained in cutset removed.</p>\n</blockquote>\n\n<p>and see: <a href=\"https://stackoverflow.com/questions/12311033/extracting-substrings-in-go\">Extracting substrings in Go</a>  </p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 4431860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QEHOW.jpg?s=128&g=1", "display_name": "Tony Zhang", "link": "https://stackoverflow.com/users/4431860/tony-zhang"}, "is_accepted": false, "score": 1, "last_activity_date": 1473402773, "last_edit_date": 1473402773, "creation_date": 1473399877, "answer_id": 39404596, "question_id": 38780352, "link": "https://stackoverflow.com/questions/38780352/golang-strings-trim-function/39404596#39404596", "title": "Golang: Strings Trim Function", "body": "<p>You should know the precise meaning of \"trim\" in programming: removing some characters both from the beginning and the end.</p>\n\n<p>And in Golang's strings.Trim, The second argument is a set of characters.</p>\n\n<p>Trim will remove all leading and trailing characters contained in the set.</p>\n\n<p>In your example:</p>\n\n<p>The set is </p>\n\n<pre><code>{\"K\", \"a\", \".\", \"b\"};\n</code></pre>\n\n<p>For \"Kab. Kolaka Utara\", Trim will remove \"Kab.\" from the beginning and \"a\" from the end.</p>\n\n<p>So, the actual string you get is \" Kolaka Utar\" instead of \"Kolaka Utar\" which has no leading space.</p>\n\n<p>If you just want to \"trim\" the first five characters, you should use this statement: </p>\n\n<pre><code>sentence = sentence[5:].\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 5856523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63de4ccd018dba6a0ff19ef87674ebc?s=128&d=identicon&r=PG&f=1", "display_name": "pschilakanti", "link": "https://stackoverflow.com/users/5856523/pschilakanti"}, "is_accepted": false, "score": 0, "last_activity_date": 1492515979, "creation_date": 1492515979, "answer_id": 43471251, "question_id": 38780352, "link": "https://stackoverflow.com/questions/38780352/golang-strings-trim-function/43471251#43471251", "title": "Golang: Strings Trim Function", "body": "<p>If you are sure about how many characters to be trimmed. Use this method.</p>\n\n<pre><code>func main() {\n    sentence := \"Kab. Kolaka Utara\"\n    fmt.Println(sentence)\n    fmt.Println(sentence[5:len(sentence)])\n\n}\n</code></pre>\n\n<p>Output :</p>\n\n<pre><code> Value :  Kab. Kolaka Utara\n Trimed : Kolaka Utara\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5663115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4964fd2f2974991223cce37b8d2b143?s=128&d=identicon&r=PG&f=1", "display_name": "gchristi001", "link": "https://stackoverflow.com/users/5663115/gchristi001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5514, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1506535607, "creation_date": 1470365487, "last_edit_date": 1470970284, "question_id": 38780352, "link": "https://stackoverflow.com/questions/38780352/golang-strings-trim-function", "title": "Golang: Strings Trim Function", "body": "<p>I used <code>strings.Trim()</code> in Golang to trim the first five characters.<br>\nHowever, the last \"a\" is always gone.<br>\nWhy is that so? </p>\n\n<p>Example: </p>\n\n<pre><code>sentence := \"Kab. Kolaka Utara\"\nresult := strings.Trim(sentence,sentence[:4])\nfmt.Println(result)\n</code></pre>\n\n<p>Result: <code>Kolaka Utar</code><br>\nI expected: <code>Kolaka Utara</code></p>\n\n<p><a href=\"https://play.golang.org/p/R6UoKWNaVv\" rel=\"nofollow\">https://play.golang.org/p/R6UoKWNaVv</a></p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1470361094, "last_edit_date": 1470361094, "creation_date": 1470359108, "answer_id": 38779631, "question_id": 38779469, "link": "https://stackoverflow.com/questions/38779469/new-object-each-time-mutation-happens-in-go/38779631#38779631", "title": "new object each time mutation happens in go?", "body": "<p>The methods are printing the address of the receiver argument <code>u</code>, a <code>**User</code>. </p>\n\n<p>Print <code>u</code> instead of <code>&amp;u</code> and you will observe that the address remains the same. A new <code>User</code> value is not created on every mutation.</p>\n\n<pre><code>func Modify(u *User) {\n  u.Name = \"Paul11\"\n  fmt.Printf(\"Modify() address: %p %p\\n\", u, &amp;u.Name)\n}\n\nfunc Modify2(u *User) {\n   u.Name = \"Leto\"\n   fmt.Printf(\"Modify() address: %p %p\\n\", u, &amp;u.Name)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/7ywy2jVKHk\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 9619, "user_id": 534617, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7cd10a43f8fab06f82c32ace961f9fa0?s=128&d=identicon&r=PG", "display_name": "Qiang Li", "link": "https://stackoverflow.com/users/534617/qiang-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 38779631, "answer_count": 1, "score": -1, "last_activity_date": 1470361094, "creation_date": 1470357513, "question_id": 38779469, "link": "https://stackoverflow.com/questions/38779469/new-object-each-time-mutation-happens-in-go", "title": "new object each time mutation happens in go?", "body": "<p>I have this go code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype User struct {\n    Name string\n    Sex string\n}\n\nfunc main() {\n    u := &amp;User{Name: \"Leto\", Sex: \"Male\"}\n    fmt.Printf(\"main() address: %p %p\\n\", &amp;u, &amp;u.Name)\n    Modify(u)\n    Modify(u)\n    Modify2(u)\n    Modify2(u)\n}\n\nfunc Modify(u *User) {\n    u.Name = \"Paul11\"\n    fmt.Printf(\"Modify() address: %p %p\\n\", &amp;u, &amp;u.Name)\n}\n\nfunc Modify2(u *User) {\n    u.Name = \"Leto\"\n    fmt.Printf(\"Modify() address: %p %p\\n\", &amp;u, &amp;u.Name)\n}\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>main() address: 0x1040a120 0x10434120\nModify() address: 0x1040a130 0x10434120\nModify() address: 0x1040a138 0x10434120\nModify() address: 0x1040a140 0x10434120\nModify() address: 0x1040a148 0x10434120\n</code></pre>\n\n<p>I wonder \n1. why the address of the object after mutation is different. \n2. why the first takes 16 bytes, and afterwards it is only 8 bytes. \n3. why the mutated field is still using the same memory address.</p>\n\n<p>Thanks!</p>\n"}]