[{"tags": ["go", "filesystems", "nfs", "nfsclient"], "comments": [{"owner": {"reputation": 479, "user_id": 2911436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7440d55bf27c1d2b26fae3af24ca2fff?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/2911436/john"}, "edited": false, "score": 0, "creation_date": 1573072996, "post_id": 58737597, "comment_id": 103766399, "body": "What is the output of <code>sudo mount -t nfs IP:&#47;vol&#47;share &#47;mnt&#47;export1</code>?"}, {"owner": {"reputation": 155, "user_id": 8287030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d60020766c26e9acb8c0f898921333f9?s=128&d=identicon&r=PG&f=1", "display_name": "cpuNram", "link": "https://stackoverflow.com/users/8287030/cpunram"}, "reply_to_user": {"reputation": 479, "user_id": 2911436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7440d55bf27c1d2b26fae3af24ca2fff?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/2911436/john"}, "edited": false, "score": 1, "creation_date": 1573077848, "post_id": 58737597, "comment_id": 103768175, "body": "@JohnOss. I added some additional details."}], "owner": {"reputation": 155, "user_id": 8287030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d60020766c26e9acb8c0f898921333f9?s=128&d=identicon&r=PG&f=1", "display_name": "cpuNram", "link": "https://stackoverflow.com/users/8287030/cpunram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573079513, "creation_date": 1573070144, "last_edit_date": 1573079513, "question_id": 58737597, "link": "https://stackoverflow.com/questions/58737597/syscall-mount-returns-invalid-argument", "title": "syscall.Mount returns invalid argument", "body": "<p>I have the below simple code, but it fails with invalid argument. I am running this program\nas root. And the mount point does exist. In \":/vol/share\", IP is IP address of NFS server\nand it is reachable.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n)   \n\nfunc nfsMount() {\n    // err := syscall.Mount(\"&lt;IP&gt;:/vol/share\", \"/mnt/export1\", \"nfs\", 0x0, \"\")\n    err := err := syscall.Mount(\"IP:/vol/share\", \"/mnt/export1\", \"nfs\", 0, \"\")\n    if err != nil {\n        fmt.Printf(\"error : %v\\n\", err.Error())\n    }   \n}   \n\nfunc main() {\n    nfsMount()\n}   \n\nroot@~# \nroot@~# nfsmount \nerror : invalid argument\nroot@~# \n\nI have tried the similar program in C.\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/mount.h&gt;\n#include &lt;errno.h&gt;\n\nvoid\nnfsmount(void)\n{\n    const char *src = \"IP:/vol/share\";\n    const char *target = \"/mnt/export1\";\n    const char *fsType = \"nfs\";\n    unsigned long mountFlags = 0;\n    const void *data = NULL;\n    int rc;\n\n\n    rc = mount(src, target, fsType, mountFlags, \"\");\n    if (rc != 0) {\n        printf(\"mount failed, rc = %d, errno=%d\\n\", rc, errno);\n    }\n}\n\nint\nmain(void)\n{\n    nfsmount();\n}\n\nroot@~# cc nfsmount.c -o nfsmountc\nroot@~#./nfsmountc\nmount failed, rc = -1, errno=22\nroot@~#\n\n</code></pre>\n\n<p>It seems to me, this error is some thing to do with <code>data</code> (const void *data)`, the last arg to mount.</p>\n\n<p>When I do the mount through shell, it works.</p>\n\n<pre><code>root@~#  mount -t nfs IP:/vol/share /mnt/export1\nroot@~# echo $?\n0\nroot@~#  cat /proc/mounts | grep export1\nIP:/vol/share /mnt/export1 nfs rw,relatime,vers=3,rsize=65536,wsize=65536,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,mountaddr=IP,mountvers=3,mountport=4046,mountproto=udp,local_lock=none,addr=172.22.14.107 0 0\nroot@~#  \n</code></pre>\n\n<p>After some further read, <a href=\"https://stackoverflow.com/questions/28350912/nfs-mount-system-call-in-linux\">NFS mount System Call in linux</a> helped me. The fix seems:\n<code>err := syscall.Mount(\":/vol/share\", \"/mnt/export1\", \"nfs\", 0, \"nolock,addr=NFSServer&gt;\")</code></p>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "edited": false, "score": 1, "creation_date": 1573068543, "post_id": 58737197, "comment_id": 103764542, "body": "Is your GOPATH&#39;s bin directory in your $PATH?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1573069236, "post_id": 58737197, "comment_id": 103764815, "body": "<code>go get</code> should install the binary. What output are you getting from the command? Are you suing the current version of Go?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1573071247, "post_id": 58737197, "comment_id": 103765636, "body": "I think you&#39;re missing some errors in the output there. There&#39;s nothing to add here, <code>go get</code> should work unless they document some other method for building the project. When in doubt however, figure out how the developers must be building it. go to the <code>$HOME&#47;go&#47;src&#47;k8s.io&#47;test-infra&#47;kubetest</code> directory and use <code>go get</code> or <code>go install</code> from there. Some part of the module structure isn&#39;t working correctly."}, {"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 0, "creation_date": 1573072055, "post_id": 58737197, "comment_id": 103766009, "body": "I could not find any errors in the output. I pasted the full output on paste bin: <a href=\"https://pastebin.com/WkNwuBc6\" rel=\"nofollow noreferrer\">pastebin.com/WkNwuBc6</a> if you want to have a look"}, {"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 0, "creation_date": 1573072326, "post_id": 58737197, "comment_id": 103766120, "body": "However, your suggestion to perform an install from <code>test-infra&#47;kubetest</code> seemed to have done the trick. there is not a <code>bin</code> directory in <code>$HOME&#47;go</code> and it contains <code>kubetest</code> as an executable. So thank you for the help!"}, {"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 0, "creation_date": 1573072382, "post_id": 58737197, "comment_id": 103766140, "body": "I do wonder if I should open that as an issue on the github project, as the documented method of installation did not work, and I might not be the only one..."}, {"owner": {"reputation": 274, "user_id": 1208381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9306a4cbc8abcfff562ca93c244a0e68?s=128&d=identicon&r=PG", "display_name": "DevOpsGeek", "link": "https://stackoverflow.com/users/1208381/devopsgeek"}, "edited": false, "score": 0, "creation_date": 1582791114, "post_id": 58737197, "comment_id": 106900586, "body": "Can Anyone let me know whether you found solution for this? am facing the same issue here"}], "answers": [{"comments": [{"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 1, "creation_date": 1573068689, "post_id": 58737264, "comment_id": 103764609, "body": "the GOPATH environment variable is not defined on my system. and the /home/go dir only contains <code>pkg</code> and <code>src</code> directories. no <code>bin</code> directory"}, {"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 1, "creation_date": 1573068916, "post_id": 58737264, "comment_id": 103764688, "body": "I have found this variable to point to /home/tomk/go. which, as I mentioned, does not contain a <code>bin</code> directory"}], "tags": [], "owner": {"reputation": 3237, "user_id": 9741769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b0913fe3d348f510777caaf5540169?s=128&d=identicon&r=PG&f=1", "display_name": "Blokje5", "link": "https://stackoverflow.com/users/9741769/blokje5"}, "is_accepted": false, "score": 1, "last_activity_date": 1573068519, "creation_date": 1573068519, "answer_id": 58737264, "question_id": 58737197, "link": "https://stackoverflow.com/questions/58737197/why-kubetest-does-not-install-according-to-instructions/58737264#58737264", "title": "why kubetest does not install according to instructions?", "body": "<p><code>go get</code> by default places projects in the directory defined as your <code>$GOPATH</code>, which by default is <code>$HOME/go</code>. Binaries are by default placed in <code>$GOPATH/bin</code>. Ensure that <code>GOPATH/bin</code> is added to your <code>$PATH</code> variable, otherwise you are unable to use binaries fetched using <code>go get</code>.</p>\n"}], "owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1590054764, "creation_date": 1573068192, "last_edit_date": 1590054764, "question_id": 58737197, "link": "https://stackoverflow.com/questions/58737197/why-kubetest-does-not-install-according-to-instructions", "title": "why kubetest does not install according to instructions?", "body": "<p>According to the page <a href=\"https://github.com/kubernetes/community/blob/master/contributors/devel/sig-testing/e2e-tests.md\" rel=\"nofollow noreferrer\">here</a>, kubetest should be installed with the following go command:</p>\n\n<pre><code>go get -u k8s.io/test-infra/kubetest\n</code></pre>\n\n<p>I've done that and tried running <code>kubetest</code> but it appears that it was not installed.</p>\n\n<pre><code>$ kubetest\nkubetest: command not found\n</code></pre>\n\n<p>Is this not the correct way of installing it? Or is there anything extra that needs to be done? If so, why is it not mentioned in the readme?</p>\n\n<hr>\n\n<p>edit:</p>\n\n<p>here is my go version:</p>\n\n<pre><code>$ go version\ngo version go1.13.4 linux/amd64\n</code></pre>\n\n<hr>\n\n<p>edit:</p>\n\n<p>Here is a partial output from my install command:</p>\n\n<pre><code>$ go get -v -u k8s.io/test-infra/kubetest\nget \"k8s.io/test-infra/kubetest\": found meta tag get.metaImport{Prefix:\"k8s.io/test-infra\", VCS:\"git\", RepoRoot:\"https://github.com/kubernetes/test-infra\"} at //k8s.io/test-infra/kubetest?go-get=1\nget \"k8s.io/test-infra/kubetest\": verifying non-authoritative meta tag\nk8s.io/test-infra (download)\ngithub.com/Azure/azure-sdk-for-go (download)\ngithub.com/Azure/go-autorest (download)\ngithub.com/dgrijalva/jwt-go (download)\n...\nk8s.io/api/settings/v1alpha1\nk8s.io/api/storage/v1\nk8s.io/api/storage/v1alpha1\nk8s.io/api/storage/v1beta1\nk8s.io/client-go/tools/reference\nk8s.io/client-go/kubernetes/scheme\n</code></pre>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1573066410, "post_id": 58736651, "comment_id": 103763654, "body": "I believe it&#39;s because it&#39;s declared on a pointer, the <code>Parse</code> method that is, but you are passing in a <i>value</i> to your function. That is, to fix this, declare <code>Parse</code> on a non-pointer. Or pass in the pointer, i.e. <code>setPropertiesFromFlags(reflect.ValueOf(c), viper)</code> (without <code>.Elem()</code>) and then when you need to manipulate the struct inside <code>setPropertiesFromFlags</code> call <code>Elem</code> there."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573066773, "post_id": 58736651, "comment_id": 103763821, "body": "... alternatively keep doing what you&#39;re doing but retrieve the method from v&#39;s &quot;address&quot;, i.e. <code>v.Addr().MethodByName(&quot;Parse&quot;)</code>."}, {"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573067033, "post_id": 58736651, "comment_id": 103763920, "body": "@mkopriva you beat me to the answer in these comments and your last comment is perhaps the best answer.  Should you write an actual answer instead of a comment?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1573067212, "post_id": 58736651, "comment_id": 103764007, "body": "@iLoveReflection i&#39;m too lazy, your answer is good enough."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573067473, "post_id": 58736651, "comment_id": 103764106, "body": "@ddibiase couple demonstrations of what you can and cannot do depending on whether you have a pointer or a value. <a href=\"https://play.golang.com/p/vxyIIvrsBZt\" rel=\"nofollow noreferrer\">play.golang.com/p/vxyIIvrsBZt</a> (updated)"}], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1573070657, "post_id": 58736878, "comment_id": 103765369, "body": "I see now. I wasn&#39;t passing in .Addr() THAT was the major issue. Thanks gents."}], "tags": [], "owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "is_accepted": true, "score": 2, "last_activity_date": 1573066801, "creation_date": 1573066801, "answer_id": 58736878, "question_id": 58736651, "link": "https://stackoverflow.com/questions/58736651/calling-struct-method-with-reflection/58736878#58736878", "title": "Calling struct method with reflection", "body": "<p>The problem is that the method is on the pointer receiver, but the function is working with a valuer receiver. \nRewrite the function to work with a pointer to a struct:</p>\n\n<pre><code>func setPropertiesFromFlags(vp reflect.Value, viper *viper.Viper) {\n    method := vp.MethodByName(\"Parse\")\n    fmt.Println(method)\n\n    v := vp.Elem()\n    t := v.Type()\n    for i := 0; i &lt; t.NumField(); i++ {\n        field := t.Field(i)\n        switch field.Type.Kind() {\n        case reflect.Struct:\n            setPropertiesFromFlags(v.Field(i).Addr(), viper) // &lt;-- take address of field here\n        case reflect.String:\n            v.Field(i).SetString(viper.GetString(field.Tag.Get(\"name\")))\n        }\n    }\n}\n</code></pre>\n\n<p>Call like this:</p>\n\n<pre><code>   setPropertiesFromFlags(reflect.ValueOf(c), viper) // &lt;-- do not call Elem()\n</code></pre>\n"}], "owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58736878, "answer_count": 1, "score": 0, "last_activity_date": 1573066801, "creation_date": 1573065824, "question_id": 58736651, "link": "https://stackoverflow.com/questions/58736651/calling-struct-method-with-reflection", "title": "Calling struct method with reflection", "body": "<p>I'm having trouble calling a method in my recursive reflection function. Here it is:</p>\n\n<pre><code>func setPropertiesFromFlags(v reflect.Value, viper *viper.Viper) {\n    t := v.Type()\n    method := v.MethodByName(\"Parse\")\n    fmt.Println(method)\n    for i := 0; i &lt; t.NumField(); i++ {\n        field := t.Field(i)\n        switch field.Type.Kind() {\n        case reflect.Struct:\n            setPropertiesFromFlags(v.Field(i), viper)\n        case reflect.String:\n            v.Field(i).SetString(viper.GetString(field.Tag.Get(\"name\")))\n    }\n}\n</code></pre>\n\n<p>I'm calling the function with:</p>\n\n<pre><code>// Config struct passed to all services\ntype Config struct {\n    common.Config\n    common.ServerConfig\n    common.AuthConfig\n}\n// Parse the thing already!\nfunc (c *Config) Parse() {\n    fmt.Println(\"RUN THIS THING\")\n}\nint main() {\n   setPropertiesFromFlags(reflect.ValueOf(c).Elem(), viper)\n}\n</code></pre>\n\n<p>What I'm hoping for is to get my parse method in the place where I'm printing method and run .Call() against it. Instead it's printing out: <code>&lt;invalid reflect.Value&gt;</code> which I cannot call against.</p>\n\n<p>I suppose I'm having trouble wrapping my head around the return values of each method. I know I have to use ValueOf to pull the value but it seems any permutation I try I'm getting the methods from the reflection class itself :-p <em>sigh</em></p>\n"}, {"tags": ["debugging", "go", "module"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1573065796, "post_id": 58736604, "comment_id": 103763379, "body": "Use a <code>replace</code> directive in <code>go.mod</code> to point a module reference at a local path as outlined here: <a href=\"https://github.com/golang/go/wiki/Modules#can-i-work-entirely-outside-of-vcs-on-my-local-filesystem\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8647, "user_id": 112755, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/653e9876709910096ccdde524a306bf8?s=128&d=identicon&r=PG", "display_name": "Mordachai", "link": "https://stackoverflow.com/users/112755/mordachai"}, "edited": false, "score": 0, "creation_date": 1598357915, "post_id": 60660789, "comment_id": 112427242, "body": "Adrian really answered me above - but for visibility for others coming to find the answer - I appreciate you spelling it out.  Thanks."}], "tags": [], "owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "is_accepted": true, "score": 1, "last_activity_date": 1584041588, "creation_date": 1584041588, "answer_id": 60660789, "question_id": 58736604, "link": "https://stackoverflow.com/questions/58736604/how-to-debug-my-own-go-module-from-another-project/60660789#60660789", "title": "how to debug my own go module from another project", "body": "<p>Suppose that your copy of <code>my-mod</code> is in <code>/home/foo/my-mod</code>, and your copy of <code>MyApp.go</code> is in a module rooted at <code>/home/foo/some-app</code>, then if you want to work on <code>MyApp.go</code>, you should update <code>/home/foo/some-app/go.mod</code> to include the line:</p>\n\n<pre><code>replace github.com/my-co/my-mod =&gt; /some/filesystem/path/my-mod\n</code></pre>\n\n<p>If you instead want to work in the directory containing <code>a-package</code>, you can set up a similar <code>replace</code> directive in <code>/home/foo/my-mod/go.mod</code> .</p>\n"}], "owner": {"reputation": 8647, "user_id": 112755, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/653e9876709910096ccdde524a306bf8?s=128&d=identicon&r=PG", "display_name": "Mordachai", "link": "https://stackoverflow.com/users/112755/mordachai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 1, "accepted_answer_id": 60660789, "answer_count": 1, "score": 0, "last_activity_date": 1584041588, "creation_date": 1573065613, "question_id": 58736604, "link": "https://stackoverflow.com/questions/58736604/how-to-debug-my-own-go-module-from-another-project", "title": "how to debug my own go module from another project", "body": "<p>Curious as to how to run &amp; debug changes to a private module I have authorship over from a dependent project?</p>\n\n<p>If I have MyApp.go in its own project which <code>import \"github.com/my-co/my-mod/a-package\"</code> and I want to make changes to a-package in my-mod and run MyApp.go in order to exercise the changes I'm making to a-package - how can I set things up so that Go uses the live version I am editing locally?</p>\n\n<p>Ideally, I'd be able to step through calling side functions into the source already on my system for that module &amp; package - where I can then edit the source directly.</p>\n\n<p>I can definitely push changes to my-mod, and then version them at github, and then force my local project to use the latest version of my-mod.  But that's a huge round-trip that makes minor edits and fixes cumbersome - and requires a new minor version for every single one.  </p>\n\n<p>That sounds very inefficient - surely there's a better way?</p>\n"}, {"tags": ["http", "go", "server", "timeout"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573065701, "post_id": 58736588, "comment_id": 103763340, "body": "&quot;after a timeout&quot; where? What are you expecting would cause the handler to &quot;end imediately&quot;? Nothing in Go has the power to force a running goroutine to stop from outside the goroutine."}, {"owner": {"reputation": 547, "user_id": 4293902, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/275f62145e5393776735a6a58fe4f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4293902/mark"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573068296, "post_id": 58736588, "comment_id": 103764429, "body": "I guess the WriteTimeout is the one being trigger, since without the sleep it works. You are right, is not what I am expecting but what I would like to achieve."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1573069240, "post_id": 58736588, "comment_id": 103764817, "body": "Nothing is going to stop the handler from outside. It&#39;s just a function, it stops when it returns."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1573069482, "post_id": 58736588, "comment_id": 103764908, "body": "If you would reach the write timeout Execute would return an error. There&#39;s no guesswork here. It is highly unlikely that you will ever get this timeout with a normal browser on localhost. time.Sleep is uninterruptible and not a good stand-in for real code, so we can&#39;t really make relevant suggestions here."}, {"owner": {"reputation": 547, "user_id": 4293902, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/275f62145e5393776735a6a58fe4f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4293902/mark"}, "edited": false, "score": 0, "creation_date": 1573069853, "post_id": 58736588, "comment_id": 103765053, "body": "But why when running the server and visiting with a browser, I get ten println(&#39;responding&#39;) on the console and and then the browser shows a connection reset error?"}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 6259146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/383c6972dd341887eccab08506f064da?s=128&d=identicon&r=PG&f=1", "display_name": "schain", "link": "https://stackoverflow.com/users/6259146/schain"}, "is_accepted": true, "score": 0, "last_activity_date": 1573098709, "creation_date": 1573098709, "answer_id": 58741753, "question_id": 58736588, "link": "https://stackoverflow.com/questions/58736588/http-server-handlefunc-loop-on-timeout/58741753#58741753", "title": "HTTP server HandleFunc loop on timeout?", "body": "<p>immediately response use goroutines and context timeout</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"html/template\"\n    \"net/http\"\n    \"time\"\n)\n\nvar layout *template.Template\nvar WriteTimeout = 1 * time.Second\n\nfunc main() {\n    router := http.NewServeMux()\n    server := &amp;http.Server{\n        Addr:         \":8889\",\n        Handler:      router,\n        ReadTimeout:  5 * time.Second,\n        WriteTimeout: WriteTimeout + 10*time.Millisecond, //10ms Redundant time\n        IdleTimeout:  15 * time.Second,\n    }\n    router.HandleFunc(\"/\", home)\n    server.ListenAndServe()\n}\n\nfunc home(w http.ResponseWriter, r *http.Request) {\n    fmt.Printf(\"responding\\n\")\n    ctx, _ := context.WithTimeout(context.Background(), WriteTimeout)\n    worker, cancel := context.WithCancel(context.Background())\n    var buffer string\n    go func() {\n        // do something\n        time.Sleep(2 * time.Second)\n        buffer = \"ready all response\\n\"\n        //do another\n        time.Sleep(2 * time.Second)\n        cancel()\n        fmt.Printf(\"worker finish\\n\")\n    }()\n    select {\n    case &lt;-ctx.Done():\n        //add more friendly tips\n        w.WriteHeader(http.StatusInternalServerError)\n        return\n    case &lt;-worker.Done():\n        w.Write([]byte(buffer))\n        fmt.Printf(\"writed\\n\")\n        return\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 547, "user_id": 4293902, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/275f62145e5393776735a6a58fe4f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4293902/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 58741753, "answer_count": 1, "score": 0, "last_activity_date": 1573098709, "creation_date": 1573065540, "last_edit_date": 1573074283, "question_id": 58736588, "link": "https://stackoverflow.com/questions/58736588/http-server-handlefunc-loop-on-timeout", "title": "HTTP server HandleFunc loop on timeout?", "body": "<p>I am working on a Go app that has a web server. I was trying to add timeouts and encountered an issue. Here's a sample code I made to reproduce it because posting the actual code would be impossible:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n    \"net/http\"\n    \"time\"\n)\n\nvar layout *template.Template\n\nfunc main() {\n    router := http.NewServeMux()\n    server := &amp;http.Server{\n        Addr:         \":8888\",\n        Handler:      router,\n        ReadTimeout:  5 * time.Second,\n        WriteTimeout: 1 * time.Second,\n        IdleTimeout:  15 * time.Second,\n    }\n\n    router.HandleFunc(\"/\", home)\n\n    var err error\n    layout, err = template.ParseFiles(\"./layout.html\")\n    if err != nil {\n        fmt.Printf(\"Error1: %+v\\n\", err)\n    }\n\n    server.ListenAndServe()\n}\n\nfunc home(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"responding\")\n    err := layout.Execute(w, template.HTML(`World`))\n    if err != nil {\n        fmt.Printf(\"Error2: %+v\\n\", err)\n    }\n    time.Sleep(5 * time.Second)\n}\n</code></pre>\n\n<p><strong>layout.html:</strong> <code>Hello {{.}}!</code></p>\n\n<p>When I run it and visit 127.0.0.1:8888, the browser stays loading, and the <code>home()</code> which is triggering the timeout, starts over again and it does it 10 times before it stops and the browser shows a connection reset error.</p>\n\n<p>I was expecting that after a timeout, the func would end immediately, the connection be closed and the browser stop loading and show an error.</p>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["go", "dependencies", "vgo"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1573065970, "post_id": 58736125, "comment_id": 103763459, "body": "No. Just use <code>replace</code> and don&#39;t commit the temporary change to repo."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1573069831, "post_id": 58736125, "comment_id": 103765038, "body": "<a href=\"https://git-scm.com/docs/git-add#Documentation/git-add.txt--p\" rel=\"nofollow noreferrer\"><code>git add -p</code></a>. I never use add without -p."}], "owner": {"reputation": 392, "user_id": 5767484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063da3e00ffcf4d3a001a1329c4e51b8?s=128&d=identicon&r=PG&f=1", "display_name": "NotX", "link": "https://stackoverflow.com/users/5767484/notx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1573074609, "creation_date": 1573063623, "last_edit_date": 1573074609, "question_id": 58736125, "link": "https://stackoverflow.com/questions/58736125/most-convenient-way-to-work-with-local-go-dependencies", "title": "Most convenient way to work with local go dependencies?", "body": "<p>I'm wondering how to work with local libraries. Let's say I want to develop two vgo projects in parallel, a <code>my-project</code> and a <code>my-util</code> project which is used by <code>my-project</code>. Of course <code>my-util</code> is available at a remote repository, but since it's not feasible to commit all my changes in here into the master branch just to make them available (and testable) in <code>my-project</code>, I want to use the local version of <code>my-util</code> instead. Similar to the good old <code>mvn clean install</code> in Java.</p>\n\n<p>I figure this must be realized with the <code>replace</code> directive. But this means that I need to manipulate my <code>go.mod</code> in <code>my-project</code> in a way I don't want to commit later. Is there any way around this problem except removing all my <code>replace</code> directives before the commit and just to re-add them afterwards?</p>\n\n<p>Is there something like a <code>go_local.mod</code> which contains the <code>replace</code> directives and could be put on <code>.gitignore</code>? Or some kind of environment variable where I can define replacements? Or at least an IDE which allows to ignore <code>replace</code> directives in the <code>go.mod</code> on commit?</p>\n\n<p>Or am I taking the wrong approach and is there a more convenient alternative for the <code>replace</code> approach in my case?</p>\n"}, {"tags": ["go", "imagemagick", "color-palette"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573062252, "post_id": 58735783, "comment_id": 103761769, "body": "That depends on what you mean by &quot;dominant colors&quot;. Most-frequently used? How fuzzy do you want to match colors? Are you just looking for hues? How many &quot;dominant colors&quot; are you looking for? What threshold makes a color &quot;dominant&quot; in your use case?"}, {"owner": {"reputation": 1034, "user_id": 3176972, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mlKGV.png?s=128&g=1", "display_name": "SaroVin", "link": "https://stackoverflow.com/users/3176972/sarovin"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573064577, "post_id": 58735783, "comment_id": 103762831, "body": "I want create a palette of 5 colors that represent the image."}], "answers": [{"comments": [{"owner": {"reputation": 1034, "user_id": 3176972, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mlKGV.png?s=128&g=1", "display_name": "SaroVin", "link": "https://stackoverflow.com/users/3176972/sarovin"}, "edited": false, "score": 0, "creation_date": 1573064630, "post_id": 58736134, "comment_id": 103762851, "body": "I sort the array with this code ``` sort.SliceStable(allColors, func(i, j int) bool { \t\treturn allColors[i].GetColorCount() &gt; allColors[j].GetColorCount() \t}) ```"}], "tags": [], "owner": {"reputation": 20869, "user_id": 438117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec2e8d45b1a0210065d1a4e3800f151?s=128&d=identicon&r=PG", "display_name": "emcconville", "link": "https://stackoverflow.com/users/438117/emcconville"}, "is_accepted": false, "score": 1, "last_activity_date": 1573063672, "creation_date": 1573063672, "answer_id": 58736134, "question_id": 58735783, "link": "https://stackoverflow.com/questions/58735783/how-to-get-the-dominant-color-in-an-image-with-go-and-imagemagick/58736134#58736134", "title": "How to get the dominant color in an image with go and imagemagick", "body": "<p>You want to iterate over all color items &amp; call <code>(*PixelWand)GetColorCount</code> to determine the frequency.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>mw.QuantizeImage(5, mw.GetImageColorspace(), 0, imagick.DITHER_METHOD_NO, false)\n_, allColors := mw.GetImageHistogram()\nvar (\n    mostUsedColor *PixelWand\n    mostUsedCount uint\n)\nfor _, c := range allColors {\n    count := c.GetColorCount()\n    if count &gt; mostUsedCount {\n        mostUsedColor = c\n        mostUsedCount = count\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1034, "user_id": 3176972, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mlKGV.png?s=128&g=1", "display_name": "SaroVin", "link": "https://stackoverflow.com/users/3176972/sarovin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1613062466, "creation_date": 1573062133, "last_edit_date": 1613062466, "question_id": 58735783, "link": "https://stackoverflow.com/questions/58735783/how-to-get-the-dominant-color-in-an-image-with-go-and-imagemagick", "title": "How to get the dominant color in an image with go and imagemagick", "body": "<p>I want extract dominant colors from png, jpeg, svg and etc.\nI haved try this code but sometimes the generated palette is not correct.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>// GET image colors\n    mw.QuantizeImage(5, mw.GetImageColorspace(), 0, imagick.DITHER_METHOD_NO, false)\n    _, allColors := mw.GetImageHistogram()\n\n    for i, c := range allColors {\n        if i &gt; 4 {\n            break\n        }\n        h, s, l := c.GetHSL()\n\n        // &quot;github.com/lucasb-eyer/go-colorful&quot;\n        cf := colorful.Hsl(h*360, s, l)\n\n        result = append(result, cf.Hex())\n    }\n</code></pre>\n<p>What is the best method to extract the dominant colors?</p>\n"}, {"tags": ["macos", "go", "raspberry-pi", "barcode-scanner", "multiple-input"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 1, "creation_date": 1573060766, "post_id": 58735349, "comment_id": 103761030, "body": "@xarantolus: The answer to your question appears to be in the title: They emulate a keyboard."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573060811, "post_id": 58735349, "comment_id": 103761053, "body": "I&#39;m pretty sure the only way to get that granular data is to read <code>&#47;dev&#47;inputX</code> (assuming Linux). See <a href=\"https://stackoverflow.com/questions/2775461/linux-keyboard-event-capturing-dev-inputx\" title=\"linux keyboard event capturing dev inputx\">stackoverflow.com/questions/2775461/&hellip;</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1573060851, "post_id": 58735349, "comment_id": 103761071, "body": "Yep, if you&#39;re receiving this as plain keyboard input, you don&#39;t know, same as you don&#39;t know which of multiple normal keyboards are typing - you just receive characters. To get more info you&#39;d need to connect to the device directly."}, {"owner": {"reputation": 51, "user_id": 5679990, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cc76d84c937e02240b3db6ba42e21bfe?s=128&d=identicon&r=PG", "display_name": "Brad Turner", "link": "https://stackoverflow.com/users/5679990/brad-turner"}, "reply_to_user": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1573060920, "post_id": 58735349, "comment_id": 103761111, "body": "@xarantolus There is no library as they simply emulate a USB keyboard input. I&#39;ve wrote a very basic Go program that waits for user input using <code>fmt.Scanln</code>. After the reader scans the barcode, it also &#39;clicks&#39; return"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1573061130, "post_id": 58735349, "comment_id": 103761225, "body": "You may need different solutions for macos vs Raspberry Pi. Although they&#39;re probably similar (i.e. they may just require reading from different device names)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1573061254, "post_id": 58735349, "comment_id": 103761295, "body": "This should help: <a href=\"https://stackoverflow.com/q/37134686/13860\">stackoverflow.com/q/37134686/13860</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2943, "user_id": 9014308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6e0464313ca63c239f5d973213daf9?s=128&d=identicon&r=PG&f=1", "display_name": "kunif", "link": "https://stackoverflow.com/users/9014308/kunif"}, "is_accepted": false, "score": 0, "last_activity_date": 1573081410, "creation_date": 1573081410, "answer_id": 58739691, "question_id": 58735349, "link": "https://stackoverflow.com/questions/58735349/how-to-detect-what-barcode-scanner-emulated-as-usb-keyboard-input-data-came-fr/58739691#58739691", "title": "How to detect what barcode scanner (emulated as USB keyboard input) data came from", "body": "<p>Many keyboard input barcode scanners have the ability to customize prefix/suffix codes that are appended to the front and back to identify barcode data input.</p>\n\n<p>They can be customized by reading the settings barcode.</p>\n\n<p>Set a different prefix/suffix code for each barcode scanner, check the key code notified by the application program one by one, and if such special data comes, either of which depends on the prefix/suffix code judges whether it is barcode data from the scanner.</p>\n"}], "owner": {"reputation": 51, "user_id": 5679990, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cc76d84c937e02240b3db6ba42e21bfe?s=128&d=identicon&r=PG", "display_name": "Brad Turner", "link": "https://stackoverflow.com/users/5679990/brad-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573081410, "creation_date": 1573060407, "last_edit_date": 1573061494, "question_id": 58735349, "link": "https://stackoverflow.com/questions/58735349/how-to-detect-what-barcode-scanner-emulated-as-usb-keyboard-input-data-came-fr", "title": "How to detect what barcode scanner (emulated as USB keyboard input) data came from", "body": "<p>I'm building a Go application that runs in the terminal to gather input from two USB barcode scanners. How do I detect what barcode scanner the text (that's emulated as USB keyboard input) came from?</p>\n\n<p>E.g. <code>Barcode: 4009900522250 from Scanner 1</code> or <code>Barcode: 4009900522399 from Scanner 2</code></p>\n\n<p>I'm developing this on Mac OS, but the code will run on Raspbian for Raspberry Pi.</p>\n"}, {"tags": ["go", "grpc", "voltdb"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573060842, "post_id": 58735171, "comment_id": 103761067, "body": "Okay, that error is completely unrelated to a deadlock."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573060974, "post_id": 58735171, "comment_id": 103761135, "body": "You should be closing your <code>rows</code>, in case an error occurs: <code>defer rows.Close()</code> right after your error check."}, {"owner": {"reputation": 37, "user_id": 6070607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dff3264d07313e10e251e5abed2af?s=128&d=identicon&r=PG&f=1", "display_name": "Vuong", "link": "https://stackoverflow.com/users/6070607/vuong"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573061403, "post_id": 58735171, "comment_id": 103761361, "body": "It works. But I don&#39;t know why it still works well when run without grpc."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573061439, "post_id": 58735171, "comment_id": 103761375, "body": "GRPC is probably completely unrelated to the issue you&#39;re facing."}, {"owner": {"reputation": 37, "user_id": 6070607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dff3264d07313e10e251e5abed2af?s=128&d=identicon&r=PG&f=1", "display_name": "Vuong", "link": "https://stackoverflow.com/users/6070607/vuong"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573061780, "post_id": 58735171, "comment_id": 103761557, "body": "I will check on this and get back with you soon. By the way please add an answer. I will mark it as correct"}], "owner": {"reputation": 37, "user_id": 6070607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dff3264d07313e10e251e5abed2af?s=128&d=identicon&r=PG&f=1", "display_name": "Vuong", "link": "https://stackoverflow.com/users/6070607/vuong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573060881, "creation_date": 1573059756, "last_edit_date": 1573060881, "question_id": 58735171, "link": "https://stackoverflow.com/questions/58735171/grpc-server-does-not-release-db-connection", "title": "GRPC server does not release DB connection", "body": "<p>I am working on a Go project which use gRPC as server and Voltdb as DB. I have an issue when sending many DB read/write requests to gRPC server. Request has been handled but it does not release DB connection after finishing operator. So when connection in pool run out I get this error:</p>\n\n<blockquote>\n  <p>Rejected connection from /127.0.0.1:63015 because the connection limit of 9940 has been reached</p>\n</blockquote>\n\n<p>proto file</p>\n\n<pre><code>syntax = \"proto3\";\npackage grpc;\n\nimport \"google/protobuf/struct.proto\";\n\noption java_multiple_files = true;\noption java_package = \"com.io.test\";\n\nservice TestService {\n    rpc updateUser (UserRequest) returns (Status) {};\n}\nmessage UserRequest {\n    string userId = 1;\n    string name = 2;\n}\nmessage Status {\n    string code = 1;\n}\n</code></pre>\n\n<p>Grpc implement in Go</p>\n\n<pre><code>package service\n\nimport (\n    \"context\"\n    \"log\"\n    api \"testgrpc/pkg/api/grpc\"\n    \"testgrpc/pkg/db\"\n    \"testgrpc/pkg/model\"\n)\n\nvar voltDbClient *db.VoltDBClient\n\nfunc init() {\n    voltDbClient = db.NewVoltDBClient()\n}\n\ntype GrpcService struct {\n}\n\nfunc NewGrpcService() *GrpcService {\n    return &amp;GrpcService{}\n}\nfunc (sv *GrpcService) UpdateUser(ctx context.Context, req *api.UserRequest) (*api.Status, error) {\n    user, err := voltDbClient.FindByID(req.GetUserId())\n    if user == nil || err != nil {\n        log.Print(\"error while reading\")\n    } else {\n        log.Println(user.(*model.User).UserId)\n        log.Println(user.(*model.User).Name)\n    }\n    err = voltDbClient.Put(req.GetUserId(), req.GetName())\n    if err != nil {\n        log.Print(\"error while writing\")\n    }\n    return &amp;api.Status{Code: \"0\"}, nil\n}\n</code></pre>\n\n<p>DB client</p>\n\n<pre><code>package db\n\nimport (\n    \"database/sql\"\n    \"log\"\n\n    \"testgrpc/pkg/model\"\n\n    _ \"github.com/VoltDB/voltdb-client-go/voltdbclient\"\n)\n\nvar Db *sql.DB\n\nfunc init() {\n    if Db == nil {\n        var err error\n        Db, err = sql.Open(\"voltdb\", \"localhost:21212\")\n        if err != nil {\n            log.Fatal(err)\n        }\n        //limit max connection to reproduce issue\n        Db.SetMaxOpenConns(20)\n    }\n}\n\ntype VoltDBClient struct {\n}\n\nfunc NewVoltDBClient() *VoltDBClient {\n    return &amp;VoltDBClient{}\n}\n\n//Put add or update record\nfunc (dbClient *VoltDBClient) Put(key interface{}, value interface{}) error {\n    res, err := Db.Exec(\"GROUPINFO.upsert\", key, value)\n    if err != nil {\n        log.Println(err)\n        return err\n    }\n    rowCnt, err := res.RowsAffected()\n    if err != nil {\n        log.Println(err)\n        return err\n    }\n    log.Printf(\"affected = %d\\n\", rowCnt)\n    return nil\n}\n\n//FindByID find a record by ID\nfunc (dbClient *VoltDBClient) FindByID(key interface{}) (interface{}, error) {\n    rows, err := Db.Query(\"GROUPSELECT\", key)\n    if err != nil {\n        log.Println(err)\n        return nil, err\n    }\n    for rows.Next() {\n        user := model.User{UserId: \"\", Name: \"\"}\n        err := rows.Scan(&amp;user.UserId, &amp;user.Name)\n        if err != nil {\n            log.Println(err)\n            return nil, err\n        }\n        return &amp;user, nil\n    }\n    return nil, nil\n}\n</code></pre>\n\n<p>Note: I have tried run project without grpc, read/write operators work well.</p>\n"}, {"tags": ["json", "rest", "go", "decode"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 4, "last_activity_date": 1573058358, "creation_date": 1573058358, "answer_id": 58734801, "question_id": 58734686, "link": "https://stackoverflow.com/questions/58734686/how-to-parse-a-json-whose-field-name-is-a-value-in-go/58734801#58734801", "title": "How to parse a JSON whose field name is a value in Go?", "body": "<p>You cannot do this with plain encoding/json. Marstall into a map[string]Measure</p>\n"}, {"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1573060369, "post_id": 58734833, "comment_id": 103760813, "body": "@Adrian: Oh, right. :/"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1573060381, "post_id": 58734833, "comment_id": 103760817, "body": "There is a typo in the first code block though, <code>Decode(&amp;measures)</code> should be <code>Decode(&amp;d)</code> to suit the example."}], "tags": [], "owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "is_accepted": true, "score": 4, "last_activity_date": 1573060947, "last_edit_date": 1573060947, "creation_date": 1573058476, "answer_id": 58734833, "question_id": 58734686, "link": "https://stackoverflow.com/questions/58734686/how-to-parse-a-json-whose-field-name-is-a-value-in-go/58734833#58734833", "title": "How to parse a JSON whose field name is a value in Go?", "body": "<p>Decode to a type that matches the structure of the data:</p>\n\n<pre><code>var d struct{ Result map[string][]Measure }\nerr = json.NewDecoder(resp.Body).Decode(&amp;d)\n</code></pre>\n\n<p>Convert that data to the desired result:</p>\n\n<pre><code>var measures []Measure\nfor k, vs := range d.Result {\n    for _, v := range vs {\n        v.Guid = k\n        measures = append(measures, v)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/zqY66iKEWrp\" rel=\"nofollow noreferrer\">Run it on the playground</a></p>\n"}], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1573062449, "accepted_answer_id": 58734833, "answer_count": 2, "score": -1, "last_activity_date": 1573060947, "creation_date": 1573057940, "last_edit_date": 1573059852, "question_id": 58734686, "link": "https://stackoverflow.com/questions/58734686/how-to-parse-a-json-whose-field-name-is-a-value-in-go", "closed_reason": "Duplicate", "title": "How to parse a JSON whose field name is a value in Go?", "body": "<p>I receive from a service a JSON that has this format.</p>\n\n<pre><code>{\n    \"result\": {\n        \"bn05deh7jsm86gtlg2l0C\": [\n            {\n                \"index_name\": \"BASE\",\n                \"index_value\": 4081512,\n                \"timestamp\": \"2019-11-05T13:20:00Z\",\n                \"op_id\": \"A0000000001\"\n            },\n            ...\n        ],\n        \"bn05deh7jsm86gtlg2lgC\": [\n            {\n                \"index_name\": \"BASE\",\n                \"index_value\": 4728633,\n                \"timestamp\": \"2019-11-05T13:20:00Z\",\n                \"op_id\": \"A0000000001\"\n            },\n            ...\n        ],\n        ...\n    }\n}\n</code></pre>\n\n<p>What I need is to transform it to an array of object like []Measure:</p>\n\n<pre><code>type Measure struct {\n    IndexName    string    `json:\"index_name\"`\n    IndexValue   uint32    `json:\"index_value\"`\n    Timestamp    time.Time `json:\"timestamp\"`\n    OperationID  string    `json:\"op_id\"`\n    Guid         string    `json:\"guid\"`\n}\n</code></pre>\n\n<p>Where <code>Guid</code> should have value <code>bn05deh7jsm86gtlg2l0C</code>, <code>bn05deh7jsm86gtlg2lgC</code>, etc.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>url := \"https://myurl.com\"\nreq, err := http.NewRequest(\"GET\", url, nil)\nif req != nil {\n    req.Header.Set(\"Content-Type\", \"application/json\")\n}\nresp, err := client.Do(req)\nif err != nil {\n    log.Println(err)\n    return nil\n}\nvar measures []Measure\nerr = json.NewDecoder(resp.Body).Decode(&amp;measures)\nif err != nil {\n    log.Println(err)\n}\n</code></pre>\n\n<p>How can I do this?</p>\n"}, {"tags": ["go", "google-bigquery"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4797351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc5dd1ea3826f4cbb468cf4225af2af?s=128&d=identicon&r=PG&f=1", "display_name": "walshbm15", "link": "https://stackoverflow.com/users/4797351/walshbm15"}, "edited": false, "score": 0, "creation_date": 1573586760, "post_id": 58769856, "comment_id": 103927427, "body": "Thanks, I see the MaxBytesBilled flag in the docs. Is it also possible to set the other options, like the output format to CSV? I don&#39;t see that in the docs."}, {"owner": {"reputation": 68, "user_id": 12232504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c258405ba40449af6733dd84a082b350?s=128&d=identicon&r=PG&f=1", "display_name": "quimiluzon", "link": "https://stackoverflow.com/users/12232504/quimiluzon"}, "reply_to_user": {"reputation": 51, "user_id": 4797351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc5dd1ea3826f4cbb468cf4225af2af?s=128&d=identicon&r=PG&f=1", "display_name": "walshbm15", "link": "https://stackoverflow.com/users/4797351/walshbm15"}, "edited": false, "score": 0, "creation_date": 1573634146, "post_id": 58769856, "comment_id": 103941400, "body": "I have replied about this by editing the answer above, please check."}], "tags": [], "owner": {"reputation": 68, "user_id": 12232504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c258405ba40449af6733dd84a082b350?s=128&d=identicon&r=PG&f=1", "display_name": "quimiluzon", "link": "https://stackoverflow.com/users/12232504/quimiluzon"}, "is_accepted": false, "score": 0, "last_activity_date": 1573634126, "last_edit_date": 1573634126, "creation_date": 1573228348, "answer_id": 58769856, "question_id": 58734536, "link": "https://stackoverflow.com/questions/58734536/how-to-run-a-query-and-return-the-results-in-csv-format/58769856#58769856", "title": "How to run a query and return the results in csv format", "body": "<p>You can use QueryConfig from the package <code>bigquery</code> [1] [2], which holds the configuration for a query job. There, for example, you will find <code>MaxBytesBilled</code> which is an analogy of the <code>--maximum_bytes_billed</code> flag. </p>\n\n<p>Saving the output result is not a specific feature of the BigQuery package. You can use the <code>encoding/csv</code> package [3] for this purpose.</p>\n\n<p>[1] - <a href=\"https://godoc.org/cloud.google.com/go/bigquery\" rel=\"nofollow noreferrer\">https://godoc.org/cloud.google.com/go/bigquery</a></p>\n\n<p>[2] - <a href=\"https://github.com/googleapis/google-cloud-go/blob/master/bigquery/query.go#L26\" rel=\"nofollow noreferrer\">https://github.com/googleapis/google-cloud-go/blob/master/bigquery/query.go#L26</a></p>\n\n<p>[3] - <a href=\"https://golang.org/pkg/encoding/csv/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/csv/</a></p>\n"}], "owner": {"reputation": 51, "user_id": 4797351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc5dd1ea3826f4cbb468cf4225af2af?s=128&d=identicon&r=PG&f=1", "display_name": "walshbm15", "link": "https://stackoverflow.com/users/4797351/walshbm15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573634126, "creation_date": 1573057384, "last_edit_date": 1573059830, "question_id": 58734536, "link": "https://stackoverflow.com/questions/58734536/how-to-run-a-query-and-return-the-results-in-csv-format", "title": "How to run a query and return the results in csv format", "body": "<p>I am trying to convert a query using the BigQuery command-line tool, to instead be done using Go but I am not finding how I should configure the query correctly. The command I have sets the format to CSV, the maximum number of rows to output, maximum bytes billed, and the project id; then runs a standard SQL query and writes the output to a CSV file while removing the headers and blank lines at the top. </p>\n\n<p>Below is the command I have working correctly using the command-line tool:</p>\n\n<pre><code>bq query --format csv \\\n  --max_rows &lt;max_row_int&gt; --maximum_bytes_billed &lt;max_bytes_billed_int&gt; \\\n  --project_id &lt;project_id&gt; \"#standardSQL\n    &lt;standard_sql_statment&gt;\n  \" \\\n  | tail -n +3 &gt;results.csv\n</code></pre>\n\n<p>I can see from the docs to run a query in Go I need to create the client/connection and then I should be able to run the query as below:</p>\n\n<pre><code>ctx := context.Background()\n\nclient, error := bigquery.NewClient(ctx, \"&lt;project_id_string&gt;\")\nif err != nil {\n    return nil, err\n}\n\nq := client.Query(&lt;standard_sql_query&gt;)\n</code></pre>\n\n<p>How can I set the configuration flags I have above in my command-line tool code in my Go code?</p>\n"}, {"tags": ["go", "gmail-api"], "comments": [{"owner": {"reputation": 479, "user_id": 2911436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7440d55bf27c1d2b26fae3af24ca2fff?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/2911436/john"}, "edited": false, "score": 0, "creation_date": 1573073897, "post_id": 58734439, "comment_id": 103766759, "body": "The <code>SendAs</code> type may be helpful. <a href=\"https://godoc.org/google.golang.org/api/gmail/v1#SendAs\" rel=\"nofollow noreferrer\">godoc.org/google.golang.org/api/gmail/v1#SendAs</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2044, "user_id": 11058516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCOCc.png?s=128&g=1", "display_name": "alberto vielma", "link": "https://stackoverflow.com/users/11058516/alberto-vielma"}, "is_accepted": true, "score": 1, "last_activity_date": 1573140073, "last_edit_date": 1573140073, "creation_date": 1573139246, "answer_id": 58751625, "question_id": 58734439, "link": "https://stackoverflow.com/questions/58734439/sender-email-is-strange-in-gmail-interface-while-using-gmail-api/58751625#58751625", "title": "Sender email is strange in gmail interface while using Gmail API", "body": "<p>Build your message in this way to achieve what you desire:</p>\n\n<pre><code>    user := \"me\"\n    full_name := \"John Doe\"\n    email := \"myexample@gmail.com\"\n\n    // New message for our gmail service to send\n    var message gmail.Message\n\n    // Compose the message\n    messageStr := []byte(\n        \"From: \" + full_name + \"&lt;\" + email + \"&gt;\" + \"\\r\\n\" +\n            \"To: sendto@gmail.com\\r\\n\" +\n            \"Subject: My first Gmail API message\\r\\n\\r\\n\" +\n            \"Message body goes here!\")\n\n    // Place messageStr into message.Raw in base64 encoded format\n    message.Raw = base64.URLEncoding.EncodeToString(messageStr)\n\n    // Send the message\n    _, err = service.Users.Messages.Send(user, &amp;message).Do()\n    if err != nil {\n        log.Printf(\"Error: %v\", err)\n    } else {\n        fmt.Println(\"Message sent!\")\n    }\n</code></pre>\n\n<p>This is due to the API must check the headers from the email and if it doesn't recognize the headers in the right way it will use the default one like for example <strong><em>from: myexample</em></strong>.</p>\n\n<p><a href=\"https://godoc.org/google.golang.org/api/gmail/v1\" rel=\"nofollow noreferrer\">HERE</a> you can check more about the Go's Gmail package. </p>\n"}], "owner": {"reputation": 75, "user_id": 5508661, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UvdFUY3OXBM/AAAAAAAAAAI/AAAAAAAAAEE/n_bblEvYUgg/photo.jpg?sz=128", "display_name": "creaturek", "link": "https://stackoverflow.com/users/5508661/creaturek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58751625, "answer_count": 1, "score": -1, "last_activity_date": 1573140073, "creation_date": 1573057037, "question_id": 58734439, "link": "https://stackoverflow.com/questions/58734439/sender-email-is-strange-in-gmail-interface-while-using-gmail-api", "title": "Sender email is strange in gmail interface while using Gmail API", "body": "<p>I use method of <code>google.golang.org/api/gmail/v1</code> for sending messages with \"me\" <code>userId</code>:</p>\n\n<pre><code>gm, err := gmail.NewUsersMessagesService(service).Send(\"me\", gm).Do()\n    if err != nil {\n        return\n    }\n</code></pre>\n\n<p>Let's say, my email address is <code>myemail@gmail.com</code>. I expect that recipient will get my message with my email (or Name + Surname) in <code>From</code> field. However, in gmail interface it's showed as <code>myemail</code>. \nThe same situation when I set email manually. </p>\n\n<p>Could you please help me to figure out a proper signature for this API method to make sender name previewed as Name + Surname or as a full email?</p>\n"}, {"tags": ["docker", "go", "sdk", "terraform", "stdin"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1573054241, "post_id": 58732588, "comment_id": 103757302, "body": "For highly interactive programs like Terraform, both running them in Docker and driving them from other programs add significant complexity.  You\u2019ll also have trouble accessing things like AWS credentials that live only on the host.  Since Terraform is distributed as a single binary it\u2019s not like installing it is complicated; I would just run <code>terraform apply</code> directly without trying to wrap it in anything."}, {"owner": {"reputation": 173, "user_id": 12332609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d500467f5015deddf88133b9a0083c75?s=128&d=identicon&r=PG&f=1", "display_name": "David Walton", "link": "https://stackoverflow.com/users/12332609/david-walton"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1573055192, "post_id": 58732588, "comment_id": 103757888, "body": "I have this working well using docker except what I&#39;m doing is running bash/shell commands in golang. and this works fine, I have it all working nicely with aws mfa.   I&#39;m just trying to replace the docker shell commands with the programatic way to run an interactive docker image"}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 0, "creation_date": 1577680267, "post_id": 58732588, "comment_id": 105222196, "body": "Instead of those <code>Scanner</code> and <code>waiter.Conn</code> goroutines, why not just: <code>go io.Copy(waiter.Conn, os.Stdin)</code>"}, {"owner": {"reputation": 2993, "user_id": 825114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7056c25a9ab81c4c963d63a148edc901?s=128&d=identicon&r=PG", "display_name": "Rolice", "link": "https://stackoverflow.com/users/825114/rolice"}, "edited": false, "score": 0, "creation_date": 1596794344, "post_id": 58732588, "comment_id": 111931634, "body": "Apart from copying stdin and stdout, the setting <code>StdinOnce:   true</code> allowed me to hold running container in interactive mode. This is however not necessary if you have an execute session."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 13763837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LKs6fEkbekQ/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucny80QbT9JojcCQrbr-49_JIHhG6Q/photo.jpg?sz=128", "display_name": "Elizabeth Nguyen", "link": "https://stackoverflow.com/users/13763837/elizabeth-nguyen"}, "is_accepted": false, "score": 2, "last_activity_date": 1595444795, "creation_date": 1595444795, "answer_id": 63041485, "question_id": 58732588, "link": "https://stackoverflow.com/questions/58732588/accept-user-input-os-stdin-to-container-using-golang-docker-sdk-interactive-co/63041485#63041485", "title": "Accept user Input os.stdin to container using Golang docker SDK - Interactive Container", "body": "<p>The edit to your question was super helpful so I just wanted to update with what had worked for me.</p>\n<p>I had problems using your solution for Stdin (pertaining to Scanner and waiter.Conn) and took nicerobot's advice to use io.Copy which is used in Docker's cli source code.</p>\n<p>To get the terminal feel (removing the echo from stdin, autocomplete, etc), I referenced this thread: <a href=\"https://github.com/fsouza/go-dockerclient/issues/707\" rel=\"nofollow noreferrer\">https://github.com/fsouza/go-dockerclient/issues/707</a> which basically said you have to treat stdin as a raw terminal (later realized this is also done in Docker's cli source code). It's also important to note that you have to restore the terminal state as soon as possible, otherwise your other print statements may be wonky.</p>\n<p>In the end, my final code looks something like this...</p>\n<pre><code>// ContainerCreate\n    \n// ContainerAttach\n\ngo io.Copy(os.Stdout, waiter.Reader)\ngo io.Copy(os.Stderr, waiter.Reader)\ngo io.Copy(waiter.Conn, os.Stdin)\n\n// ContainerStart\n\n// import(&quot;golang.org/x/net/context&quot;)\nfd := int(os.Stdin.Fd())\nvar oldState *terminal.State\nif terminal.IsTerminal(fd) {\n  oldState, err = terminal.MakeRaw(fd)\n  if err != nil {\n    // print error\n  }\n  defer terminal.Restore(fd, oldState)\n}\n\n// ContainerWait for exit\n\nterminal.Restore(fd, oldState)\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 12332609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d500467f5015deddf88133b9a0083c75?s=128&d=identicon&r=PG&f=1", "display_name": "David Walton", "link": "https://stackoverflow.com/users/12332609/david-walton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 2, "answer_count": 1, "score": 8, "last_activity_date": 1595444795, "creation_date": 1573051237, "last_edit_date": 1573131632, "question_id": 58732588, "link": "https://stackoverflow.com/questions/58732588/accept-user-input-os-stdin-to-container-using-golang-docker-sdk-interactive-co", "title": "Accept user Input os.stdin to container using Golang docker SDK - Interactive Container", "body": "<p>My last resort is asking here. I'm new to Golang and I've made simple programs. </p>\n\n<p>I'm trying to do the following: \nUsing golang: \n1 - run a container \n2 - accept input stdin to the container </p>\n\n<p>The example I want to use is the hashicorp/terraform docker image, I want to do a simple <code>terraform apply</code>  but I need to wait for user input </p>\n\n<p>below is the code I have working so far...anyone trying the exact code below needs to update the AWS environment variables or change the terraform test file to another provider...or just use a different docker image ;-) </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/docker/docker/api/types\"\n    \"github.com/docker/docker/api/types/container\"\n    \"github.com/docker/docker/api/types/mount\"\n    \"github.com/docker/docker/client\"\n    \"github.com/docker/docker/pkg/stdcopy\"\n    \"golang.org/x/net/context\"\n    \"io\"\n    \"os\"\n)\n\nconst workingDir = \"/home\"\n\n\nfunc main() {\n    ctx := context.Background()\n    cli, err := client.NewClientWithOpts(client.FromEnv, client.WithAPIVersionNegotiation())\n    if err != nil {\n        panic(err)\n    }\n\n    reader, err := cli.ImagePull(ctx, \"hashicorp/terraform\", types.ImagePullOptions{})\n    if err != nil {\n        panic(err)\n    }\n    io.Copy(os.Stdout, reader)\n\n    fmt.Println(os.Args)\n    cwd, _ := os.Getwd()\n\n    resp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n        AttachStdin: true,\n        Tty:         false,\n        StdinOnce:   true,\n        AttachStdout:true,\n        Cmd:         os.Args[1:],\n        Image:       \"hashicorp/terraform\",\n        WorkingDir:   workingDir,\n        Env:         []string{\"AWS_ACCESS_KEY_ID=XXX\", \"AWS_SECRET_ACCESS_KEY=XXX\", \"AWS_SESSION_TOKEN=XXX\"},\n        },\n    &amp;container.HostConfig{\n\n            Mounts: []mount.Mount{\n                mount.Mount{\n                    Type: mount.TypeBind,\n                    Source: cwd,\n                    Target: workingDir,\n                },\n            },\n        },nil, \"\")\n    if err != nil {\n        panic(err)\n    }\n\n    if err := cli.ContainerStart(ctx, resp.ID, types.ContainerStartOptions{}); err != nil {\n        panic(err)\n    }\n\n    statusCh, errCh := cli.ContainerWait(ctx, resp.ID, container.WaitConditionNotRunning)\n    select {\n    case err := &lt;-errCh:\n        if err != nil {\n            panic(err)\n        }\n    case &lt;-statusCh:\n    }\n\n\n\n\n    out, err := cli.ContainerLogs(ctx, resp.ID, types.ContainerLogsOptions{ShowStdout: true})\n    if err != nil {\n        panic(err)\n    }\n\n    stdcopy.StdCopy(os.Stdout, os.Stderr, out)\n\n\n}\n</code></pre>\n\n<p>My example terraform file test.tf </p>\n\n<pre><code>provider \"aws\" {\n  region                  = \"eu-west-1\"\n}\n\n\nresource \"aws_vpc\" \"main\" {\n  cidr_block       = \"10.0.0.0/16\"\n  instance_tenancy = \"dedicated\"\n\n  tags = {\n    Name = \"test-main-vpc\"\n  }\n}\n\n</code></pre>\n\n<p>so if I build that go file and run something like </p>\n\n<p><code>./build apply</code> with the test.tf in the same directory</p>\n\n<p>I get the below output: </p>\n\n<pre><code>\nAn execution plan has been generated and is shown below.\nResource actions are indicated with the following symbols:\n  + create\n\nTerraform will perform the following actions:\n\n  # aws_vpc.main will be created\n  + resource \"aws_vpc\" \"main\" {\n      + arn                              = (known after apply)\n      + assign_generated_ipv6_cidr_block = false\n      + cidr_block                       = \"10.0.0.0/16\"\n      + default_network_acl_id           = (known after apply)\n      + default_route_table_id           = (known after apply)\n      + default_security_group_id        = (known after apply)\n      + dhcp_options_id                  = (known after apply)\n      + enable_classiclink               = (known after apply)\n      + enable_classiclink_dns_support   = (known after apply)\n      + enable_dns_hostnames             = (known after apply)\n      + enable_dns_support               = true\n      + id                               = (known after apply)\n      + instance_tenancy                 = \"dedicated\"\n      + ipv6_association_id              = (known after apply)\n      + ipv6_cidr_block                  = (known after apply)\n      + main_route_table_id              = (known after apply)\n      + owner_id                         = (known after apply)\n      + tags                             = {\n          + \"Name\" = \"test-main-vpc\"\n        }\n    }\n\nPlan: 1 to add, 0 to change, 0 to destroy.\n\nDo you want to perform these actions?\n  Terraform will perform the actions described above.\n  Only 'yes' will be accepted to approve.\n\n  Enter a value: \nApply cancelled.\n\nProcess finished with exit code 0\n\n</code></pre>\n\n<p>What I've been trying to figure out is how to wait for user input.</p>\n\n<p>The logs are printing after the container is run and exits I think.. so I believe I need to use a mixture of these: </p>\n\n<p><a href=\"https://godoc.org/github.com/docker/docker/container/stream\" rel=\"noreferrer\">https://godoc.org/github.com/docker/docker/container/stream</a></p>\n\n<p><a href=\"https://godoc.org/github.com/docker/docker/client#Client.ContainerAttach\" rel=\"noreferrer\">https://godoc.org/github.com/docker/docker/client#Client.ContainerAttach</a></p>\n\n<p>I just dont know how to implement these and there are no examples. </p>\n\n<p>Any ideas would be helpful. I dont want the full answer I just want the general direction on how to use the container/stream  and/or Client.ContainerAttach to wait for user input </p>\n\n<h2>Thanks so much!</h2>\n\n<p>EDIT: </p>\n\n<p>I've managed to get it working. Below is the working code</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"github.com/docker/docker/api/types\"\n    \"github.com/docker/docker/api/types/container\"\n    \"github.com/docker/docker/api/types/mount\"\n    \"github.com/docker/docker/client\"\n    \"golang.org/x/net/context\"\n    \"io\"\n    \"os\"\n)\n\nconst workingDir = \"/home\"\nvar inout chan []byte\n\nfunc main() {\n    inout = make(chan []byte)\n\n    ctx := context.Background()\n    cli, err := client.NewClientWithOpts(client.FromEnv, client.WithAPIVersionNegotiation())\n    if err != nil {\n        panic(err)\n    }\n\n    reader, err := cli.ImagePull(ctx, \"hashicorp/terraform\", types.ImagePullOptions{})\n    if err != nil {\n        panic(err)\n    }\n    go io.Copy(os.Stdout, reader)\n\n\n    //fmt.Println(os.Args)\n    cwd, _ := os.Getwd()\n\n    resp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n        AttachStderr:true,\n        AttachStdin: true,\n        Tty:         true,\n        AttachStdout:true,\n        OpenStdin:   true,\n        Cmd:         os.Args[1:],\n        Image:       \"hashicorp/terraform\",\n        WorkingDir:   workingDir,\n        Env:         []string{\"AWS_ACCESS_KEY_ID=\",\n            \"AWS_SECRET_ACCESS_KEY=\",\n            \"AWS_SESSION_TOKEN=\",\n\n        },\n    },\n        &amp;container.HostConfig{\n\n            Mounts: []mount.Mount{\n                mount.Mount{\n                    Type: mount.TypeBind,\n                    Source: cwd,\n                    Target: workingDir,\n                },\n            },\n        },nil, \"\")\n    if err != nil {\n        panic(err)\n    }\n\n\n    if err := cli.ContainerStart(ctx, resp.ID, types.ContainerStartOptions{}); err != nil {\n        panic(err)\n    }\n\n\n\n    waiter, err := cli.ContainerAttach(ctx, resp.ID, types.ContainerAttachOptions{\n        Stderr:       true,\n        Stdout:       true,\n        Stdin:        true,\n        Stream:       true,\n    })\n\n    go  io.Copy(os.Stdout, waiter.Reader)\n    go  io.Copy(os.Stderr, waiter.Reader)\n\n    if err != nil {\n        panic(err)\n    }\n\n    go func() {\n        scanner := bufio.NewScanner(os.Stdin)\n        for scanner.Scan() {\n            inout &lt;- []byte(scanner.Text())\n        }\n    }()\n\n    // Write to docker container\n    go func(w io.WriteCloser) {\n        for {\n            data, ok := &lt;-inout\n            //log.Println(\"Received to send to docker\", string(data))\n            if !ok {\n                fmt.Println(\"!ok\")\n                w.Close()\n                return\n            }\n\n            w.Write(append(data, '\\n'))\n        }\n    }(waiter.Conn)\n\n\n    statusCh, errCh := cli.ContainerWait(ctx, resp.ID, container.WaitConditionNotRunning)\n    select {\n    case err := &lt;-errCh:\n        if err != nil {\n            panic(err)\n        }\n    case &lt;-statusCh:\n    }\n\n\n}\n</code></pre>\n"}, {"tags": ["selenium", "go", "selenium-chromedriver", "agouti"], "comments": [{"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 1, "creation_date": 1573073937, "post_id": 58731630, "comment_id": 103766780, "body": "See this: <a href=\"https://stackoverflow.com/questions/14480717/load-chrome-profile-using-selenium-webdriver-using-java\" title=\"load chrome profile using selenium webdriver using java\">stackoverflow.com/questions/14480717/&hellip;</a>  Making a copy of the directory is best..."}, {"owner": {"reputation": 1623, "user_id": 1611395, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8aT4z.jpg?s=128&g=1", "display_name": "zored", "link": "https://stackoverflow.com/users/1611395/zored"}, "reply_to_user": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1573202426, "post_id": 58731630, "comment_id": 103812394, "body": "Thanks! Does that preserve cookies? Maybe my Golang implementation causes this behaviour..."}, {"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 1, "creation_date": 1573238132, "post_id": 58731630, "comment_id": 103830089, "body": "the behavior of starting with a fresh profile each time is the default for the webdriver.   This is a clean state and is the most important test case."}, {"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1573250679, "post_id": 58731630, "comment_id": 103834646, "body": "and yes, the cookies are stored in the profile folder.  (and also in app data per machine user...)"}], "owner": {"reputation": 1623, "user_id": 1611395, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8aT4z.jpg?s=128&g=1", "display_name": "zored", "link": "https://stackoverflow.com/users/1611395/zored"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573065835, "creation_date": 1573048010, "last_edit_date": 1573065835, "question_id": 58731630, "link": "https://stackoverflow.com/questions/58731630/clean-cookies-in-default-chrome-using-chromedriver", "title": "Clean cookies in default Chrome using chromedriver", "body": "<p>I have my Chrome browser and I want to automate some actions using <code>chromedriver</code>. But when I use my default profile (default user or new <a href=\"https://stackoverflow.com/questions/49270109/how-to-open-a-chrome-profile-through-python/49280195#49280195\">\"bot\" profile</a>) I <strong>always start with cleared cookies</strong> for that profile.</p>\n\n<p>Can I automate existing Chrome user activity with <code>chromedriver</code>?</p>\n\n<p>Here is code example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package chrome\n\nimport (\n    \"fmt\"\n    \"github.com/sclevine/agouti\"\n    \"time\"\n)\n\nfunc getDriver() (driver *agouti.WebDriver, stop func(), err error) {\n    chromeOptions := []string{\n        \"--user-data-dir=/Users/robbo/Library/Application Support/Google/Chrome\",\n        \"--profile-directory=Profile 1\",\n    }\n\n    driver = agouti.ChromeDriver(agouti.ChromeOptions(\"args\", chromeOptions))\n    if err = driver.Start(); err != nil {\n        return\n    }\n\n    stop = func() {\n        _ = driver.Stop()\n    }\n    return\n}\n\nfunc NavigateToPageWithSession(project string) (err error) {\n    driver, stop, err := getDriver()\n    if err != nil {\n        return\n    }\n    defer stop()\n\n    page, err := driver.NewPage()\n    if err != nil {\n        return\n    }\n\n    url := fmt.Sprintf(\"https://stackoverflow.com/\")\n    err = page.Navigate(url)\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1573046703, "post_id": 58731147, "comment_id": 103752848, "body": "If there&#39;s an error, don&#39;t use <code>lResp</code>. Simple as that. Only assume <code>lResp</code> to be valid / usable if <code>err</code> is <code>nil</code>."}, {"owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1573046758, "post_id": 58731147, "comment_id": 103752889, "body": "@icza Agreed but I&#39;d like to act upon timeouts (do a manual retry of some sort) hence my question."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1573046971, "post_id": 58731147, "comment_id": 103753030, "body": "Have you tried checking the error type? If you have a <code>net.Error</code> then you have a <code>Timeout()</code> method"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1573047054, "post_id": 58731147, "comment_id": 103753088, "body": "<a href=\"https://golang.org/pkg/os/#IsTimeout\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#IsTimeout</a>"}, {"owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1573047101, "post_id": 58731147, "comment_id": 103753120, "body": "@JimB Just as I mentioned: <code>err</code> returned from <code>Decode()</code> is of type <code>*errors.errorString</code>"}, {"owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1573047206, "post_id": 58731147, "comment_id": 103753185, "body": "@Peter <code>os.IsTimeout()</code> doesn&#39;t work in this case"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1573047240, "post_id": 58731147, "comment_id": 103753202, "body": "@Patryk: yup, missed that.  Just read the full response and unmarshal it in 2 separate steps. That way the read error isn&#39;t wrapped in the json package."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1573051232, "post_id": 58731147, "comment_id": 103755433, "body": "Maybe you&#39;re missing the fact that <code>*http.httpError</code> is a <code>net.Error</code>?"}, {"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1573057897, "post_id": 58731147, "comment_id": 103759388, "body": "The decoder returns the io.Reader error as is.  Just check for net.Error timeout as suggested by JimB in his first comment here."}], "answers": [{"comments": [{"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1573061351, "post_id": 58734265, "comment_id": 103761332, "body": "What is the reason for ignoring all but net errors when slurping up the response body?"}, {"owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "reply_to_user": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1573061670, "post_id": 58734265, "comment_id": 103761499, "body": "@iLoveReflection Just wanted to do a manual retry of some sorts (and some accounting for that) and I wanted to figure out a way to do that (manual error inspection as depicted)."}, {"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1573094429, "post_id": 58734265, "comment_id": 103772138, "body": "I get that you want to retry, but that does not explain the reason for ignoring errors.  Also, it seems odd to treat net.Error differently from other errors when reading the response body.  Why not <code>bb, err := ioutil.ReadAll(resp.Body); if err != nil { return err }</code>."}, {"owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "reply_to_user": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1573114396, "post_id": 58734265, "comment_id": 103777861, "body": "@iLoveReflection I might have oversimplified this. I do take care of other errors as well. Le me edit the answer"}], "tags": [], "owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "is_accepted": true, "score": 0, "last_activity_date": 1573114466, "last_edit_date": 1573114466, "creation_date": 1573056447, "answer_id": 58734265, "question_id": 58731147, "link": "https://stackoverflow.com/questions/58731147/how-to-get-the-error-cause-of-json-newdecoderbody-decode-when-a-http-timeout/58734265#58734265", "title": "How to get the error cause of json.NewDecoder(body).Decode() when a http timeout occurs?", "body": "<p>Ok, so I ended up reading the response body into into a <code>[]byte</code> and then unmarshalling it with <code>json.Unmarshal()</code></p>\n\n<pre><code>bb, err := ioutil.ReadAll(resp.Body)\nif err != nil {\n    var netError net.Error\n    if errors.As(err, &amp;netError) {\n        log.Printf(\"netError %v\", netError)\n        // handle net.Error...\n        return nil, netError\n    }\n    // handle general errors...\n    return nil, netError\n}\n\nvar lResp LResponse\nif err := json.Unmarshal(bb, &amp;lResp); err != nil {\n    return nil, errors.Wrap(err, \"failed to unmarshal LResponse\")\n}\n</code></pre>\n\n<p>I'm still looking for a solution to use <code>json.NewDecoder(resp.Body).Decode(&amp;str)</code> to avoid copying whole body into memory.</p>\n\n<p>If anyone knows the way to do it, please add your answer.</p>\n"}], "owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 58734265, "answer_count": 1, "score": 0, "last_activity_date": 1573114466, "creation_date": 1573046400, "last_edit_date": 1573046536, "question_id": 58731147, "link": "https://stackoverflow.com/questions/58731147/how-to-get-the-error-cause-of-json-newdecoderbody-decode-when-a-http-timeout", "title": "How to get the error cause of json.NewDecoder(body).Decode() when a http timeout occurs?", "body": "<p>I'm trying to figure out a way to get the error cause while JSON decoding <code>http.Response.Body</code></p>\n\n<pre><code>if err := json.NewDecoder(resp.Body).Decode(&amp;lResp); err != nil {\n    // Get the cause of err\n}\n</code></pre>\n\n<p>The type of <code>err</code> (and <code>errors.Cause(err)</code> using either <code>github.com/pkg/errors</code> or <code>github.com/friendsofgo/errors</code>) is <code>*errors.errorString</code>.</p>\n\n<p>So what I'm able to do right now is the exact opposite of checking for the error type, namely:</p>\n\n<pre><code>if strings.HasSuffix(cause.Error(), \"(Client.Timeout exceeded while reading body)\") {\n    //...\n}\n</code></pre>\n\n<p>I can try to use <a href=\"https://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"nofollow noreferrer\"><code>ioutil.ReadAll()</code></a> and then I'll get <code>*http.httpError</code> as an error when the timeout occurs.</p>\n\n<p>The primary reason is that I don't want to get the partially read JSON structure in the error - only the cause of the error and with current way, it's being done (the error returned) I get:</p>\n\n<pre><code>main.ListingResponse.DataSources: struct CustomType{ /* partially read JSON struct ... */ }.net/http: request canceled (Client.Timeout exceeded while reading body)\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mongodb-query", "bson"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1573045934, "post_id": 58730911, "comment_id": 103752375, "body": "And why are you trying to unmarshal it? Use <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo#Collection.Aggregate\" rel=\"nofollow noreferrer\"><code>Colleciton.Aggregate()</code></a> to execute it. You may pass <code>bsonobj</code> to it."}, {"owner": {"reputation": 390, "user_id": 2481981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6b557fbb677f7cc2fd8647f723195ffb?s=128&d=identicon&r=PG", "display_name": "Sreenath", "link": "https://stackoverflow.com/users/2481981/sreenath"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1573049912, "post_id": 58730911, "comment_id": 103754653, "body": "I&#39;m not able to pass string to aggregate"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 7652938, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OqpxxW-rcDc/AAAAAAAAAAI/AAAAAAAAAA0/pdkJ3iBkL2A/photo.jpg?sz=128", "display_name": "Jay Jayswal", "link": "https://stackoverflow.com/users/7652938/jay-jayswal"}, "is_accepted": false, "score": 0, "last_activity_date": 1573046949, "creation_date": 1573046949, "answer_id": 58731299, "question_id": 58730911, "link": "https://stackoverflow.com/questions/58730911/how-to-convert-string-to-bson/58731299#58731299", "title": "How to convert string to BSON", "body": "<p>try this:</p>\n\n<pre><code>    var str = `[{\"$match\":{\"tenantId\":\"TenantOne\"}},{\"$group\":{\"_id\":{\"referralType\":\"$referralType\"},\"value\":{\"$sum\":1}}}]`\nfmt.Println(str)\nvar bdoc interface{}\nerr := bson.UnmarshalExtJSON([]byte(str),true,&amp;bdoc)\nfmt.Println(bdoc)\nfmt.Println(err)\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 2481981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6b557fbb677f7cc2fd8647f723195ffb?s=128&d=identicon&r=PG", "display_name": "Sreenath", "link": "https://stackoverflow.com/users/2481981/sreenath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1573054146, "creation_date": 1573045657, "last_edit_date": 1573054146, "question_id": 58730911, "link": "https://stackoverflow.com/questions/58730911/how-to-convert-string-to-bson", "title": "How to convert string to BSON", "body": "<p>I want to convert a string to BSON Obj to perform mongodb aggregate operation. All the queries will be stored in somewhere and now we have to convert string to BSON operation and show the result.</p>\n\n<p>Lets say</p>\n\n<pre><code>var str = `[{\"$match\":{\"tenantId\":\"TenantOne\"}},{\"$group\":{\"_id\":{\"referralType\":\"$referralType\"},\"value\":{\"$sum\":1}}}]`\n</code></pre>\n\n<p>I've to convert to </p>\n\n<pre><code>var bsonobj = bson.A{\n  bson.D{{\n    Key: \"$match\", Value : bson.D{{\n      Key : \"tenantId\" : Value: \"TenantOne\"\n    }}\n  }},\n  bson.D{{\n    Key: \"$group\", Value : bson.D{{\n      Key : \"_id\" : Value: bson.D{{\n        Key : \"referralType\" : Value: \"$referralType\"\n      }},\n      Key : \"value\" : Value: bson.D{{\n        Key : \"$sum\" : Value: 1\n      }}\n\n    }}\n  }}\n}\n</code></pre>\n\n<p>I've tried <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/bson#Unmarshal\" rel=\"nofollow noreferrer\">Golang MongoDB-Driver - Bson Unmarshal</a>! I'm not able to use it properly.</p>\n"}, {"tags": ["git", "go", "github", "registry", "go-modules"], "comments": [{"owner": {"reputation": 4059, "user_id": 8763847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k2myi.png?s=128&g=1", "display_name": "sayboras", "link": "https://stackoverflow.com/users/8763847/sayboras"}, "edited": false, "score": 2, "creation_date": 1573044046, "post_id": 58730071, "comment_id": 103751344, "body": "You can try with GOPRIVATE=github.ny.nts.com, and re-run go mod tidy"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573050235, "post_id": 58730071, "comment_id": 103754854, "body": "There is no package registry/repository in Go."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573053077, "post_id": 58730071, "comment_id": 103756531, "body": "@Adrian, yes, we kinda do now: the sum database and module proxy."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573054406, "post_id": 58730071, "comment_id": 103757418, "body": "Kind of but not really, because they&#39;re still simple proxies over arbitrary source repositories."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 3262529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HEc3o.jpg?s=128&g=1", "display_name": "PeterFraedrich", "link": "https://stackoverflow.com/users/3262529/peterfraedrich"}, "is_accepted": false, "score": 0, "last_activity_date": 1573497114, "creation_date": 1573497114, "answer_id": 58806820, "question_id": 58730071, "link": "https://stackoverflow.com/questions/58730071/how-to-use-private-go-package-with-modules/58806820#58806820", "title": "How to use private go package with modules", "body": "<p>You can implicitly install the dependency by running <code>go get</code> in your project root like</p>\n\n<p><code>$&gt; go get github.ny.nts.com/fds/client</code></p>\n\n<p>If the repository is private you'll need to implement a workaround, as <code>go get</code> defaults to <code>https</code> for cloning git repos. Running the following from your project folder will tell git to use SSH (and therefore your stored credentials) when pulling packages from your repo for this project:</p>\n\n<p><code>$&gt; git config insteadOf.\"https://github.ny.nts.com/\".use \"git@github.ny.nts.com:\"</code></p>\n\n<p>Once that's done, you should be able to run <code>go get ...</code> and pull your package</p>\n"}], "owner": {"reputation": 99, "user_id": 12218656, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UvVqOhSgbqk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSPbDrm1uzqACG3jr2DFqyYlLOPA/photo.jpg?sz=128", "display_name": "Jon lib", "link": "https://stackoverflow.com/users/12218656/jon-lib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573497114, "creation_date": 1573042848, "last_edit_date": 1573044479, "question_id": 58730071, "link": "https://stackoverflow.com/questions/58730071/how-to-use-private-go-package-with-modules", "title": "How to use private go package with modules", "body": "<p>I have a project which is providing an API but not under github.com, it\u2019s under <code>github.ny.nts.com</code>\nHow can I use it on my code?</p>\n\n<p>I\u2019ve added to a new program and in the import I put:</p>\n\n<pre><code>import \u201cgithub.ny.nts.com/fds/client\u201d\n</code></pre>\n\n<p>Now when I run go mod init it didn't add anything (which is related to this project) to the go.mod file</p>\n\n<p>How can I define the \u201cregistry\u201d (similar to nodejs/npm when you can tell from where to download the packages) on go and tell gomod to take it my company git?</p>\n\n<p>I'm able to clone the project without any problem so I don't have any access problem to the project git.</p>\n"}, {"tags": ["go", "build", "operating-system", "cross-compiling", "cpu-architecture"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 5, "creation_date": 1573042571, "post_id": 58729932, "comment_id": 103750550, "body": "Only you can answer &quot;what is worth it&quot; for you."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1573050158, "post_id": 58729932, "comment_id": 103754806, "body": "Whichever ones <i>you</i> need to compile for. The community cannot answer this for you."}, {"owner": {"reputation": 1314, "user_id": 10588376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2jgpj.png?s=128&g=1", "display_name": "MarvinJWendt", "link": "https://stackoverflow.com/users/10588376/marvinjwendt"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573089757, "post_id": 58729932, "comment_id": 103771144, "body": "@Adrian: Well that&#39;s the thing. I could build it for every platform, but I was asking what the community is actually using? Are there any people who host a server on Plan9? Do I have to include that? What is the majority of linux distros that I sould support? But I get what you mean, there might not be &quot;the answer&quot; for this question."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1573132207, "post_id": 58729932, "comment_id": 103787313, "body": "&quot;The community&quot; does not have homogenous needs. Build for the platforms that your target user base demands, not what StackOverflow happens to be building arbitrary projects for. There is no reasonable community answer to this question."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573133140, "post_id": 58729932, "comment_id": 103787785, "body": "&quot;Are there any people who host a server on Plan9?&quot; -- Obvoiusly there are people who use Plan 9, otherwise nobody would have ported Go to it. &quot;Do I have to include that?&quot; -- You don&#39;t have to do anything. &quot;What is the majority of linux distros that I sould support?&quot; -- Linux distros don&#39;t really fit into this question at all. Compile for one distro, and it&#39;ll work for all others."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1573044535, "last_edit_date": 1573044535, "creation_date": 1573042951, "answer_id": 58730106, "question_id": 58729932, "link": "https://stackoverflow.com/questions/58729932/which-platforms-should-i-compile-to-via-go-build/58730106#58730106", "title": "Which platforms should I compile to via &#39;go build&#39;?", "body": "<p>To list all supported platforms (<code>GOOS/GOARCH</code> combinations), use the following command:</p>\n\n<pre><code>go tool dist list\n</code></pre>\n\n<p>Take this list as a superset of platforms you want to / have to build to, and filter out those you don't need (e.g. android). Don't try to build to platforms not included in this list, it will fail.</p>\n\n<p>For me (Go 1.13.3 linux/amd64) it outputs:</p>\n\n<pre><code>aix/ppc64\nandroid/386\nandroid/amd64\nandroid/arm\nandroid/arm64\ndarwin/386\ndarwin/amd64\ndarwin/arm\ndarwin/arm64\ndragonfly/amd64\nfreebsd/386\nfreebsd/amd64\nfreebsd/arm\nillumos/amd64\njs/wasm\nlinux/386\nlinux/amd64\nlinux/arm\nlinux/arm64\nlinux/mips\nlinux/mips64\nlinux/mips64le\nlinux/mipsle\nlinux/ppc64\nlinux/ppc64le\nlinux/s390x\nnacl/386\nnacl/amd64p32\nnacl/arm\nnetbsd/386\nnetbsd/amd64\nnetbsd/arm\nnetbsd/arm64\nopenbsd/386\nopenbsd/amd64\nopenbsd/arm\nopenbsd/arm64\nplan9/386\nplan9/amd64\nplan9/arm\nsolaris/amd64\nwindows/386\nwindows/amd64\nwindows/arm\n</code></pre>\n"}], "owner": {"reputation": 1314, "user_id": 10588376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2jgpj.png?s=128&g=1", "display_name": "MarvinJWendt", "link": "https://stackoverflow.com/users/10588376/marvinjwendt"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1573050167, "answer_count": 1, "score": -4, "last_activity_date": 1573044535, "creation_date": 1573042462, "last_edit_date": 1573042560, "question_id": 58729932, "link": "https://stackoverflow.com/questions/58729932/which-platforms-should-i-compile-to-via-go-build", "closed_reason": "Opinion-based", "title": "Which platforms should I compile to via &#39;go build&#39;?", "body": "<p>I have this list of supported platforms by the go builder:</p>\n\n<pre><code>    \"darwin/386\",\n    \"darwin/amd64\",\n    \"dragonfly/amd64\",\n    \"freebsd/386\",\n    \"freebsd/amd64\",\n    \"freebsd/arm\",\n    \"linux/386\",\n    \"linux/amd64\",\n    \"linux/arm\",\n    \"linux/arm64\",\n    \"linux/ppc64\",\n    \"linux/ppc64le\",\n    \"linux/mips\",\n    \"linux/mipsle\",\n    \"linux/mips64\",\n    \"linux/mips64le\",\n    \"linux/s390x\",\n    \"nacl/386\",\n    \"nacl/amd64p32\",\n    \"nacl/arm\",\n    \"netbsd/386\",\n    \"netbsd/amd64\",\n    \"netbsd/arm\",\n    \"openbsd/386\",\n    \"openbsd/amd64\",\n    \"openbsd/arm\",\n    \"plan9/386\",\n    \"plan9/amd64\",\n    \"plan9/arm\",\n    \"solaris/amd64\",\n    \"windows/386\",\n    \"windows/amd64\",\n</code></pre>\n\n<p>I am working on a script to cross-compile my project. I started by including them all, but now I added some more code to my project and I couldn't compile it for Plan9. I looked Plan9 up and saw that it's really old and not used anymore. So my question is, which platforms are actually used and worth compiling to?</p>\n"}, {"tags": ["typescript", "go", "encryption", "aes"], "comments": [{"owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "edited": false, "score": 0, "creation_date": 1573044247, "post_id": 58729774, "comment_id": 103751442, "body": "Which pkcs7 you wereusing? I am reproducing it."}, {"owner": {"reputation": 15, "user_id": 4394183, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001289082499/picture?type=large", "display_name": "Alaa Radwan", "link": "https://stackoverflow.com/users/4394183/alaa-radwan"}, "reply_to_user": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "edited": false, "score": 0, "creation_date": 1573045113, "post_id": 58729774, "comment_id": 103751929, "body": "im using this &quot;github.com/mergermarket/go-pkcs7&quot;"}, {"owner": {"reputation": 15, "user_id": 4394183, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001289082499/picture?type=large", "display_name": "Alaa Radwan", "link": "https://stackoverflow.com/users/4394183/alaa-radwan"}, "reply_to_user": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "edited": false, "score": 0, "creation_date": 1573045806, "post_id": 58729774, "comment_id": 103752304, "body": "and I don&#39;t know the type in ts , but when I search in google I found that it is look like this <code>padding: CryptoJS.pad.Pkcs7</code> , so if this is the problem I don&#39;t know any other way to change it"}, {"owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "edited": false, "score": 0, "creation_date": 1573046329, "post_id": 58729774, "comment_id": 103752609, "body": "1. use the same key when dec. 2. remove this pad function. Then you could get a string &quot;cryption&quot;. I am tring to get the true answer, guessing a problem of iv or pad."}], "answers": [{"comments": [{"owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "edited": false, "score": 0, "creation_date": 1573047964, "post_id": 58731452, "comment_id": 103753622, "body": "And a note, pad the cipher text if needed."}, {"owner": {"reputation": 15, "user_id": 4394183, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001289082499/picture?type=large", "display_name": "Alaa Radwan", "link": "https://stackoverflow.com/users/4394183/alaa-radwan"}, "edited": false, "score": 0, "creation_date": 1573051239, "post_id": 58731452, "comment_id": 103755436, "body": "thanks a lot its works for me but ,could you tell me how I get the <code>types of pads</code> in <code>Go</code> so I will try it in the future ?? to match it with typescript"}, {"owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "reply_to_user": {"reputation": 15, "user_id": 4394183, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001289082499/picture?type=large", "display_name": "Alaa Radwan", "link": "https://stackoverflow.com/users/4394183/alaa-radwan"}, "edited": false, "score": 0, "creation_date": 1573053202, "post_id": 58731452, "comment_id": 103756618, "body": "@AlaaRadwan In your case: 1. your source text is 32 bytes, multipul of 16, thus no need to pad. 2. the pad function pads even the text length is multipul of 16. Not a cryptographer, I cannot tell you about <code>types of pads</code>, just @me when you have questions in any time."}, {"owner": {"reputation": 392, "user_id": 9941514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc1269982f72792a7506deb54beaf77c?s=128&d=identicon&r=PG&f=1", "display_name": "Sayooj Samuel", "link": "https://stackoverflow.com/users/9941514/sayooj-samuel"}, "edited": false, "score": 0, "creation_date": 1602822848, "post_id": 58731452, "comment_id": 113846867, "body": "@p1gd0g it is necessary to pad the function irrespective of the pad length. If the source is already a multiple of blocksize, another complete block of padding according to the pkcs#7 standard."}], "tags": [], "owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "is_accepted": true, "score": 0, "last_activity_date": 1573047413, "creation_date": 1573047413, "answer_id": 58731452, "question_id": 58729774, "link": "https://stackoverflow.com/questions/58729774/aes-encryption-in-typescript-decryption-in-go/58731452#58731452", "title": "AES encryption in typescript decryption in Go", "body": "<ol>\n<li>Please use the same key \"7061737323313233\".</li>\n<li>Use the same iv.</li>\n<li>Dec the full text.</li>\n</ol>\n\n<pre><code>func main() {\n\n    d2, err := Decrypt(\"VMlk9qzp2BKZi5wZjlzst2iwEre0uD/VHVc6xm2bhXY=\", \"7061737323313233\")\n    if err != nil {\n        log.Println(err)\n        return\n    }\n    fmt.Println(d2)\n\n}\n\n// Decrypt decrypts cipher text string into plain text string\nfunc Decrypt(encrypted string, CIPHER_KEY string) (string, error) {\n    key := []byte(CIPHER_KEY)\n    cipherText, _ := base64.StdEncoding.DecodeString(encrypted) ////hex.DecodeString(encrypted)\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    if len(cipherText) &lt; aes.BlockSize {\n        panic(\"cipherText too short\")\n    }\n    // iv := cipherText[:aes.BlockSize]\n    iv := []byte(\"7061737323313233\")\n\n    cipherText = cipherText[:]\n    if len(cipherText)%aes.BlockSize != 0 {\n        panic(\"cipherText is not a multiple of the block size\")\n    }\n\n    // cipherText, _ = Pad(cipherText, aes.BlockSize)\n\n    mode := cipher.NewCBCDecrypter(block, iv)\n    mode.CryptBlocks(cipherText, cipherText)\n\n    return fmt.Sprintf(\"%s\", cipherText), nil\n}\n\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4394183, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001289082499/picture?type=large", "display_name": "Alaa Radwan", "link": "https://stackoverflow.com/users/4394183/alaa-radwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1713, "favorite_count": 0, "accepted_answer_id": 58731452, "answer_count": 1, "score": 0, "last_activity_date": 1573047413, "creation_date": 1573041837, "last_edit_date": 1573042417, "question_id": 58729774, "link": "https://stackoverflow.com/questions/58729774/aes-encryption-in-typescript-decryption-in-go", "title": "AES encryption in typescript decryption in Go", "body": "<p>I'm trying to encrypt data in typescript and take the encryption output the pass it to the decryption function in Go but the output in Go does not match the input in typescript so what is the problem?</p>\n\n<p>This is my typescript code:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>import * as CryptoJS from 'crypto-js';\nvar key = CryptoJS.enc.Utf8.parse('7061737323313233');\nvar iv = CryptoJS.enc.Utf8.parse('7061737323313233');\nvar encrypted = CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(\"Im new in aes encryption\"), key,\n    {\n        keySize: 128 / 8,\n        iv: iv,\n        mode: CryptoJS.mode.CBC,\n        padding: CryptoJS.pad.Pkcs7\n    });\n\nvar decrypted = CryptoJS.AES.decrypt(encrypted, key, {\n    keySize: 128 / 8,\n    iv: iv,\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.Pkcs7\n});\n\nconsole.log('Encrypted :' + encrypted);\nconsole.log('Key :' + encrypted.key);\nconsole.log('Salt :' + encrypted.salt);\nconsole.log('iv :' + encrypted.iv);\nconsole.log('Decrypted : ' + decrypted);\nconsole.log('utf8 = ' + decrypted.toString(CryptoJS.enc.Utf8));\n</code></pre>\n\n<p>This is my Go code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    d2, _ := Decrypt(\"VMlk9qzp2BKZi5wZjlzst2iwEre0uD/VHVc6xm2bhXY=\", \"37303631373337333233333133323333\")\n    fmt.Println(d2)\n}\n// Decrypt decrypts cipher text string into plain text string\nfunc Decrypt(encrypted string, CIPHER_KEY string) (string, error) {\n    key := []byte(CIPHER_KEY)\n    cipherText, _ := base64.StdEncoding.DecodeString(encrypted) ////hex.DecodeString(encrypted)\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    if len(cipherText) &lt; aes.BlockSize {\n        panic(\"cipherText too short\")\n    }\n    iv := cipherText[:aes.BlockSize]\n\n    cipherText = cipherText[aes.BlockSize:]\n    if len(cipherText)%aes.BlockSize != 0 {\n        panic(\"cipherText is not a multiple of the block size\")\n    }\n    mode := cipher.NewCBCDecrypter(block, iv)\n    mode.CryptBlocks(cipherText, cipherText)\n\n    cipherText, _ = pkcs7.Pad(cipherText, aes.BlockSize)\n    return fmt.Sprintf(\"%s\", cipherText), nil\n}\n</code></pre>\n"}, {"tags": ["go", "server"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1573035564, "post_id": 58727689, "comment_id": 103746751, "body": "No, there&#39;s not. It wouldn&#39;t really make sense in Go, either, since Go isn&#39;t single-threaded like PHP."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1573035719, "post_id": 58727689, "comment_id": 103746837, "body": "The only similar timeouts Go offers are the various Timeouts in the <a href=\"https://golang.org/pkg/net/http/#Server\" rel=\"nofollow noreferrer\"><code>http.Server</code></a> struct. And they can only be set on startup (although you could construct a program that would re-start a server when config changes, without restarting the whole process--but probably not worth it)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1573035757, "post_id": 58727689, "comment_id": 103746860, "body": "A more dynamic approach would be to set a context timeout (perhaps in middleware) per connection. That could easily be done without restarting, but would only affect new connections."}, {"owner": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573038303, "post_id": 58727689, "comment_id": 103748285, "body": "The context approach as suggested by @Flimzy is how I go about it. I have a <code>middleware</code> per se, which calls <code>context.WithTimeout</code> to create a new context. To make it dynamic, you can pick the value from an env variable to avoid restarting"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "edited": false, "score": 1, "creation_date": 1573038524, "post_id": 58727689, "comment_id": 103748391, "body": "@AyushGupta: You cannot reset an ENV variable without restarting, though."}, {"owner": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573038970, "post_id": 58727689, "comment_id": 103748617, "body": "@Flimzy oh is that? Then maybe another mechanism. Personally I would want(expect, perhaps) to pick the latest env variable value, but I guess caching that makes sense too(I believe it&#39;s cached at a shell level). Good to know, thanks"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "edited": false, "score": 2, "creation_date": 1573039086, "post_id": 58727689, "comment_id": 103748679, "body": "@AyushGupta: See here: <a href=\"https://stackoverflow.com/q/205064/13860\">stackoverflow.com/q/205064/13860</a> TL;DR; There are hacky ways to change an env variable while the process is running, but there&#39;s no standard way to tell the process to re-read the env variables, so in practice, it&#39;s impossible. (And I&#39;m sure the Go runtime doesn&#39;t support it, so you&#39;d be stuck doing some low-level system calls to re-read the env)"}], "answers": [{"tags": [], "owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "is_accepted": false, "score": 0, "last_activity_date": 1573042715, "last_edit_date": 1573042715, "creation_date": 1573042208, "answer_id": 58729875, "question_id": 58727689, "link": "https://stackoverflow.com/questions/58727689/how-to-increase-the-server-timeout-on-the-fly/58729875#58729875", "title": "How to increase the server timeout on the fly", "body": "<p>Heres a script that allows you to set a program timeout and dynamically change timeout during execution.\n<a href=\"https://play.golang.org/p/qRvVMPnp9g2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qRvVMPnp9g2</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"os\"\n)\n\nvar (\n    oldDuration time.Duration = 10 * time.Second\n    timer *time.Timer = time.NewTimer(oldDuration)\n    start time.Time = time.Now()\n)\n\n// The init function is called before main\nfunc init(){\n    // function asynchronously monitors and terminates script after timeout\n    go func(){\n        &lt;- timer.C\n        fmt.Println(\"Exit\")\n        os.Exit(1)\n    }()\n}\n\nfunc main() {\n\n    // Do some work\n    &lt;-time.After(2 * time.Second)\n    fmt.Println(\"Hello World\")\n\n    // Change timeout interval dynamically\n    setTimeout(5 * time.Second)\n\n    // Do more work\n    &lt;-time.After(5 * time.Second)\n    fmt.Println(\"Shouldn't be reached as script terminates after 5 seconds of which 2 seconds have been used earlier\")\n}\n\nfunc setTimeout(newDuration time.Duration){\n\n     // Stop timer - prevent program terminating in setTimeout function\n     timer.Stop()\n\n     // Compute remaining time\n     var timePassed time.Duration = time.Since(start)\n     var timeToTermination time.Duration = newDuration - timePassed\n\n     // Restart timer - continuing from however many second \n     // have elapsed since the program started\n     oldDuration = newDuration\n     timer.Reset(timeToTermination)\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12331087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0926ff3e6e6e3f52c0dc1254d6e3c96f?s=128&d=identicon&r=PG&f=1", "display_name": "Abhaya", "link": "https://stackoverflow.com/users/12331087/abhaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1573042715, "creation_date": 1573035097, "last_edit_date": 1573038198, "question_id": 58727689, "link": "https://stackoverflow.com/questions/58727689/how-to-increase-the-server-timeout-on-the-fly", "title": "How to increase the server timeout on the fly", "body": "<p>In PHP we have <code>ini_set('max_execution_time', 180)</code> by which we can change the execution time on the fly.\nIs there anything similar to this in Go?</p>\n"}, {"tags": ["arrays", "go", "struct", "interface"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1573032699, "post_id": 58726751, "comment_id": 103745143, "body": "How could that ever work? Take a look at how the stdlib does such things e.g. in encoding/json."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1573032765, "post_id": 58726751, "comment_id": 103745180, "body": "Reassigning objects does nothing for the caller. It&#39;s the same as if you would pass, say, an int. Everything is passed by value in Go."}, {"owner": {"reputation": 145, "user_id": 8977506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2ee24fcf3227c57fa268e0a2b60225?s=128&d=identicon&r=PG", "display_name": "Chaoming Li", "link": "https://stackoverflow.com/users/8977506/chaoming-li"}, "edited": false, "score": 0, "creation_date": 1573033121, "post_id": 58726751, "comment_id": 103745398, "body": "if the <code>interface{}</code> is assigned as a struct, it works. I can read a single document (different code to read a document instead of a collection) and update the values in the struct that&#39;s passed to the function."}, {"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "edited": false, "score": 1, "creation_date": 1573033530, "post_id": 58726751, "comment_id": 103745618, "body": "that definitely should be a pointer as @mkopriva said"}, {"owner": {"reputation": 145, "user_id": 8977506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2ee24fcf3227c57fa268e0a2b60225?s=128&d=identicon&r=PG", "display_name": "Chaoming Li", "link": "https://stackoverflow.com/users/8977506/chaoming-li"}, "edited": false, "score": 0, "creation_date": 1573033678, "post_id": 58726751, "comment_id": 103745724, "body": "Sorry, I tried <code>fc.ReadCollection(&quot;mycollection&quot;, &amp;ss)</code> but no difference."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1573033761, "post_id": 58726751, "comment_id": 103745778, "body": "@ChaomingLi You have to pass a pointer, there is no way around that, however your implementation has a lot more problems then just that so that&#39;s why &quot;no difference&quot;."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573034119, "post_id": 58726751, "comment_id": 103745979, "body": "Why are you passing an interface? You seem to know that it&#39;s a slice, so why not just pass a (pointer to a) slice?"}, {"owner": {"reputation": 145, "user_id": 8977506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2ee24fcf3227c57fa268e0a2b60225?s=128&d=identicon&r=PG", "display_name": "Chaoming Li", "link": "https://stackoverflow.com/users/8977506/chaoming-li"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573034420, "post_id": 58726751, "comment_id": 103746151, "body": "@Flimzy because I don&#39;t know the struct type in the slice. I want to keep it flexible to handle different collections (e.g. user, room, etc) Each of these collections will have a struct to map the structure."}, {"owner": {"reputation": 145, "user_id": 8977506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2ee24fcf3227c57fa268e0a2b60225?s=128&d=identicon&r=PG", "display_name": "Chaoming Li", "link": "https://stackoverflow.com/users/8977506/chaoming-li"}, "edited": false, "score": 0, "creation_date": 1573034602, "post_id": 58726751, "comment_id": 103746252, "body": "If I passed the result as <code>[]interface{}</code> alongside with <code>error</code>, use type assertion to assign the element one by one from the interface array to the struct array, it works. But that means extra code outside of the ReadCollection every time."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573034910, "post_id": 58726751, "comment_id": 103746410, "body": "@ChaomingLi to make it work you should do something like this: <a href=\"https://play.golang.com/p/LWWPJZI7mXn\" rel=\"nofollow noreferrer\">play.golang.com/p/LWWPJZI7mXn</a> (note i haven&#39;t actually tested that so there will, most probably, be bugs... but in general it should give you an idea of what you need to do)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573035258, "post_id": 58726751, "comment_id": 103746577, "body": "@ChaomingLi one issue that i&#39;ve already noticed is that i&#39;ve used <code>reflect.AppendSlice</code> which is incorrect, it should be <code>reflect.Append(dest, obj.Elem())</code>"}, {"owner": {"reputation": 145, "user_id": 8977506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2ee24fcf3227c57fa268e0a2b60225?s=128&d=identicon&r=PG", "display_name": "Chaoming Li", "link": "https://stackoverflow.com/users/8977506/chaoming-li"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573035934, "post_id": 58726751, "comment_id": 103746957, "body": "@mkopriva thank you. <code>dest</code> seems the array I want. but how can I modify <code>objects</code> to the pointer of <code>dest</code>?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573036242, "post_id": 58726751, "comment_id": 103747140, "body": "@ChaomingLi <a href=\"https://play.golang.com/p/nX7na1NetcV\" rel=\"nofollow noreferrer\">play.golang.com/p/nX7na1NetcV</a> fixed it up a bit, removed the firestore stuff so that it can be executed on playground and now you can see that the slice getting modified."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573036449, "post_id": 58726751, "comment_id": 103747273, "body": "@ChaomingLi variation using append <a href=\"https://play.golang.com/p/nt6xg5qyRZh\" rel=\"nofollow noreferrer\">play.golang.com/p/nt6xg5qyRZh</a>"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 8977506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2ee24fcf3227c57fa268e0a2b60225?s=128&d=identicon&r=PG", "display_name": "Chaoming Li", "link": "https://stackoverflow.com/users/8977506/chaoming-li"}, "is_accepted": true, "score": 2, "last_activity_date": 1573036719, "creation_date": 1573036719, "answer_id": 58728190, "question_id": 58726751, "link": "https://stackoverflow.com/questions/58726751/how-to-pass-array-of-struct-as-interface-by-reference/58728190#58728190", "title": "How to pass array of struct as interface by reference", "body": "<p>Thanks to @mkopriva, the following code works:</p>\n\n<pre><code>func (fc *FirebaseClient) ReadCollection(collectionPath string, objects interface{}) error {\n    ctx := context.Background()\n    opt := option.WithCredentialsJSON([]byte(os.Getenv(\"FIREBASE_CREDENTIALS\")))\n    client, err := firestore.NewClient(ctx, os.Getenv(\"FIREBASE_PROJECT_ID\"), opt)\n    if err != nil {\n        return err\n    }\n    defer client.Close()\n\n    collectionRef := client.Collection(collectionPath)\n    docs, err := collectionRef.DocumentRefs(ctx).GetAll()\n    if err != nil {\n        return err\n    }\n    log.Printf(\"Total documents: %i\", len(docs))\n\n    dest := reflect.ValueOf(objects).Elem()\n\n\n    log.Printf(\"dest: %v\", dest)\n    for _, doc := range docs {\n        docsnap, err := doc.Get(ctx)\n        if err != nil {\n            return err\n        }\n\n        obj := reflect.New(dest.Type().Elem())\n\n        if err := docsnap.DataTo(obj.Interface()); err != nil {\n            return err\n        }\n        log.Printf(\"obj: %v\", obj)\n        dest = reflect.Append(dest, obj.Elem())\n\n\n    }\n\n    reflect.ValueOf(objects).Elem().Set(dest)\n    log.Printf(\"objects: %v\", dest)\n    return nil\n}\n</code></pre>\n\n<pre><code>    var ss []SomeStruct\n\n    fc := new(insightech.FirebaseClient)\n    if err := fc.ReadCollection(\"mycollection\", &amp;ss); err != nil {\n        return\n    }\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 8977506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2ee24fcf3227c57fa268e0a2b60225?s=128&d=identicon&r=PG", "display_name": "Chaoming Li", "link": "https://stackoverflow.com/users/8977506/chaoming-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 58728190, "answer_count": 1, "score": -1, "last_activity_date": 1573036719, "creation_date": 1573032054, "last_edit_date": 1573033908, "question_id": 58726751, "link": "https://stackoverflow.com/questions/58726751/how-to-pass-array-of-struct-as-interface-by-reference", "title": "How to pass array of struct as interface by reference", "body": "<p>I am trying to read all documents under a given Firestore collection and return the documents as an array of struct. The log within the function output the data as the Firestore documents, but the array of struct outside of the function is always an empty array.</p>\n\n<p>The function to read all documents under a collection.</p>\n\n<pre><code>func (fc *FirebaseClient) ReadCollection(collectionPath string, objects interface{}) error {\n    ctx := context.Background()\n    opt := option.WithCredentialsJSON([]byte(os.Getenv(\"FIREBASE_CREDENTIALS\")))\n    client, err := firestore.NewClient(ctx, os.Getenv(\"FIREBASE_PROJECT_ID\"), opt)\n    if err != nil {\n        return err\n    }\n    defer client.Close()\n\n    collectionRef := client.Collection(collectionPath)\n    docs, err := collectionRef.DocumentRefs(ctx).GetAll()\n    if err != nil {\n        return err\n    }\n    log.Printf(\"Total documents: %i\", len(docs))\n    objs := make([]interface{}, len(docs))\n    for i, doc := range docs {\n        docsnap, err := doc.Get(ctx)\n        if err != nil {\n            return err\n        }\n\n        if err := docsnap.DataTo(&amp;objs[i]); err != nil {\n            return err\n        }\n        log.Printf(\"obj: %v\", objs[i])\n\n    }\n\n    objects = objs\n    log.Printf(\"objects: %v\", objects)\n    return nil\n}\n</code></pre>\n\n<p>The code to call the function</p>\n\n<pre><code>    var ss []SomeStruct\n\n    fc := new(insightech.FirebaseClient)\n    if err := fc.ReadCollection(\"mycollection\", ss); err != nil {\n        return\n    }\n</code></pre>\n\n<p><code>ss</code> is an empty array always.</p>\n\n<p>The reason I don't want to specify the type of struct is make the ReadCollection function generic so I can call it to read different collections.</p>\n\n<p>The code doesn't trigger any error, but the outcome is an empty array even though the <code>objects</code> interface is definitely an array with elements.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 1540, "user_id": 9338645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F3UWT.jpg?s=128&g=1", "display_name": "Chr\u1d09z supports Monica", "link": "https://stackoverflow.com/users/9338645/chr%e1%b4%89z-supports-monica"}, "edited": false, "score": 0, "creation_date": 1573031621, "post_id": 58726546, "comment_id": 103744521, "body": "Wouldn&#39;t <code>^[a-zA-Z0-9]+(-[a-zA-Z0-9]+){0,2}$</code>fit here?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1573031734, "post_id": 58726546, "comment_id": 103744576, "body": "Why use a regex? This is easier, and more efficiently done, in other ways."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1573031807, "post_id": 58726546, "comment_id": 103744608, "body": "Not everything that can be validated by a regexp should be. Normal code is better for stuff like this."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1573032023, "post_id": 58726546, "comment_id": 103744739, "body": "In GO RE2-based regex, you can&#39;t use lookarounds, so checking length limit can only be done either with another regex, or with regular string length checking. See <a href=\"https://play.golang.org/p/EZU507Gnhr-\" rel=\"nofollow noreferrer\">this demo</a>"}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1573033545, "last_edit_date": 1573033545, "creation_date": 1573032819, "answer_id": 58726961, "question_id": 58726546, "link": "https://stackoverflow.com/questions/58726546/github-username-convention-using-regex/58726961#58726961", "title": "Github username convention using regex", "body": "<p>In Go RE2-based regex, you can't use lookarounds, so checking length limit can only be done either with another regex, or with regular string length checking. </p>\n\n<p>A fully non-regex approach (<a href=\"https://play.golang.org/p/4_MMSpv-dVU\" rel=\"nofollow noreferrer\">demo</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\nfunc IsAlnumOrHyphen(s string) bool {\n    for _, r := range s {\n        if (r &lt; 'a' || r &gt; 'z') &amp;&amp; (r &lt; 'A' || r &gt; 'Z') &amp;&amp; (r &lt; '0' || r &gt; '9') &amp;&amp; r != '-' {\n            return false\n        }\n    }\n    return true\n}\n\nfunc main() {\n    s := \"abc-abc-abc\"\n    if  len(s) &lt; 40 &amp;&amp; len(s) &gt; 0 &amp;&amp; !strings.HasPrefix(s, \"-\") &amp;&amp; !strings.Contains(s, \"--\") &amp;&amp; !strings.HasSuffix(s, \"-\") &amp;&amp; IsAlnumOrHyphen(s) {\n        fmt.Println(\"true\")\n    } else {\n\n        fmt.Println(\"false\")\n    }\n}\n</code></pre>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>len(s) &lt; 40 &amp;&amp; len(s) &gt; 0</code> - Length restriction, from 1 to 39 chars are allowed</li>\n<li><code>!strings.HasPrefix(s, \"-\")</code> - should not start with <code>-</code>  </li>\n<li><code>!strings.Contains(s, \"--\")</code> - should not contain <code>--</code></li>\n<li><code>!strings.HasSuffix(s, \"-\")</code> - should not end with <code>-</code></li>\n<li><code>IsAlnumOrHyphen(s)</code> -  can only contain ASCII alphanumeric and hyphens.</li>\n</ul>\n\n<p>For a partially regex approach, see <a href=\"https://play.golang.org/p/eV6KrJ70IBD\" rel=\"nofollow noreferrer\">this Go demo</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    usernameConvention := \"^[a-zA-Z0-9]+(?:-[a-zA-Z0-9]+)*$\"\n    re,_ := regexp.Compile(usernameConvention)\n    s := \"abc-abc-abc\"\n    if len(s) &lt; 40 &amp;&amp; len(s) &gt; 0 &amp;&amp; re.MatchString(s) {\n        fmt.Println(\"true\")\n    } else {\n\n        fmt.Println(\"false\")\n    }\n}\n</code></pre>\n\n<p>Here, the <code>^[a-zA-Z0-9]+(?:-[a-zA-Z0-9]+)*$</code> regex matches</p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>[a-zA-Z0-9]+</code> - 1 or more ASCII alphanumeric chars</li>\n<li><code>(?:-[a-zA-Z0-9]+)*</code> - 0 or more repetitions of <code>-</code> and then 1 or more ASCII alphanumeric chars</li>\n<li><code>$</code> - end of string.</li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 12330832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38ae56d22cbda45cc389d1176c55b9?s=128&d=identicon&r=PG&f=1", "display_name": "celtic", "link": "https://stackoverflow.com/users/12330832/celtic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 0, "accepted_answer_id": 58726961, "answer_count": 1, "score": 1, "last_activity_date": 1573033545, "creation_date": 1573031418, "last_edit_date": 1573031649, "question_id": 58726546, "link": "https://stackoverflow.com/questions/58726546/github-username-convention-using-regex", "title": "Github username convention using regex", "body": "<p>I've been trying to convert the Github username convention using regex in Go for a while now and I couldn't do it. Also the username length <strong>shouldn't exceed more than 39 characters</strong>.</p>\n\n<p>Below is the username convention from Github</p>\n\n<blockquote>\n  <p>Username may only contain alphanumeric characters or single hyphens, and cannot begin or end with a hyphen.</p>\n</blockquote>\n\n<p>and for the length</p>\n\n<blockquote>\n  <p>Username is too long (maximum is 39 characters). </p>\n</blockquote>\n\n<p>Here is the code I've written. You could check here in <a href=\"https://play.golang.org/p/PTu76U_512w\" rel=\"nofollow noreferrer\">Go playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    usernameConvention := \"^[a-zA-Z0-9]*[-]?[a-zA-Z0-9]*$\"\n\n    if re, _ := regexp.Compile(usernameConvention); !re.MatchString(\"abc-abc\") {\n        fmt.Println(\"false\")\n    } else {\n        fmt.Println(\"true\")\n    }\n}\n\n</code></pre>\n\n<p>Currently, I could achieve these:</p>\n\n<pre><code>a-b // true - Working!\n-ab // false - Working!\nab- // false - Working!\n0-0 // true - Working!\n</code></pre>\n\n<p>But the problem I'm facing is that I couldn't find the regex pattern which should work for the below scenario:</p>\n\n<pre><code>a-b-c // false - Should be true\n</code></pre>\n\n<p>Also it has to be within 39 characters which I've found that we could use <code>{1,38}</code>, but I don't know where exactly should I add that in the regex pattern.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2867, "user_id": 478311, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f33a325b11dd39195f5f1249586e791b?s=128&d=identicon&r=PG", "display_name": "tomcam", "link": "https://stackoverflow.com/users/478311/tomcam"}, "edited": false, "score": 0, "creation_date": 1573025685, "post_id": 58725118, "comment_id": 103741870, "body": "Thanks. I read that but I think the docs are wrong? Because if I just run the program foo like this: &quot;foo init -site=test&quot; it still both assigns the value of -site= to initSiteName as it should, but ALSO falls through to the default."}, {"owner": {"reputation": 722, "user_id": 4671382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55c20cb0c0d8044ffc5866b179ac8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/4671382/cl%c3%a9ment"}, "reply_to_user": {"reputation": 2867, "user_id": 478311, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f33a325b11dd39195f5f1249586e791b?s=128&d=identicon&r=PG", "display_name": "tomcam", "link": "https://stackoverflow.com/users/478311/tomcam"}, "edited": false, "score": 2, "creation_date": 1573027024, "post_id": 58725118, "comment_id": 103742417, "body": "I don&#39;t think FlagSet is meant to be used this way. In your loop, you are iterating manually over the program args anyway, not using <code>flag.Args()</code>.  The doc is correct, but you are using the package differently than intended."}], "tags": [], "owner": {"reputation": 722, "user_id": 4671382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55c20cb0c0d8044ffc5866b179ac8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/4671382/cl%c3%a9ment"}, "is_accepted": true, "score": 3, "last_activity_date": 1573025896, "last_edit_date": 1573025896, "creation_date": 1573025496, "answer_id": 58725118, "question_id": 58725072, "link": "https://stackoverflow.com/questions/58725072/how-do-i-iterate-through-command-line-arguments-and-collect-whats-left-over-aft/58725118#58725118", "title": "How do I iterate through command line arguments and collect what&#39;s left over after the flags?", "body": "<p>It's not very convenient using the <code>flag</code> package. From the <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">doc</a>:</p>\n\n<blockquote>\n  <p>Flag parsing stops just before the first non-flag argument (\"-\" is a non-flag argument) or after the terminator \"--\".</p>\n</blockquote>\n\n<p>You would have to do it manually:</p>\n\n<blockquote>\n  <p>After parsing, the arguments following the flags are available as the slice flag.Args() or individually as flag.Arg(i).</p>\n</blockquote>\n\n<p>Or you can use another package.</p>\n"}], "owner": {"reputation": 2867, "user_id": 478311, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f33a325b11dd39195f5f1249586e791b?s=128&d=identicon&r=PG", "display_name": "tomcam", "link": "https://stackoverflow.com/users/478311/tomcam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 58725118, "answer_count": 1, "score": 0, "last_activity_date": 1573030693, "creation_date": 1573025289, "last_edit_date": 1573030693, "question_id": 58725072, "link": "https://stackoverflow.com/questions/58725072/how-do-i-iterate-through-command-line-arguments-and-collect-whats-left-over-aft", "title": "How do I iterate through command line arguments and collect what&#39;s left over after the flags?", "body": "<p>My goal is for \"init\", \"init -site=test\", both versions of init and also the standalone \"debug\" command to be accepted at the command line, and to treat anything left over as a filename.</p>\n\n<p>What actually happens is that in the case of \"init -site=test\" for some reason the \"-site=test\" is also accepted as a filename. How can I stop that from happening?</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    initCmd := flag.NewFlagSet(\"init\", flag.ExitOnError)\n    initSiteName := initCmd.String(\"site\", \"\", \"Main name for your site\")\n    flag.Parse()\n    for pos, cmd := range os.Args {\n        switch cmd {\n        case \"debug\":\n            fmt.Printf(\"debug\\n\")\n        case \"init\":\n            initCmd.Parse(os.Args[pos+1:])\n            fmt.Printf(\"init\\n  site name:%v\\n\", *initSiteName)\n        default:\n            fmt.Printf(\"Filename: %v\\n\", cmd);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "go", "reflection"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573027697, "post_id": 58724914, "comment_id": 103742695, "body": "<a href=\"https://play.golang.com/p/rBWy9pufl2-\" rel=\"nofollow noreferrer\">play.golang.com/p/rBWy9pufl2-</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1573028576, "post_id": 58724914, "comment_id": 103743061, "body": "Duplicate. This comes ups soooo often...."}], "answers": [{"comments": [{"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1573029265, "post_id": 58725027, "comment_id": 103743363, "body": "Thank you for your answer. I tested your first variant. Why you set <code>float64</code> instead of <code>int</code>? In my example <code>1556895</code> is <code>int</code>, right?"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1573050399, "post_id": 58725027, "comment_id": 103754961, "body": "The stdlib json unmarshaler unmarshals all numbers as float64. You can use a <code>json.Decoder</code> instead, call <code>decoder.UseNumber()</code>, and get json.Number values instead of float64."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1573118496, "post_id": 58725027, "comment_id": 103779852, "body": "Can I ask you one more question?! How convert <code>int</code> to <code>json.RawMessage</code>? I need to set <code>int</code> value to <code>ID</code> field of the <code>Section</code> struct."}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 1, "creation_date": 1573135049, "post_id": 58725027, "comment_id": 103788822, "body": "section.ID=json.RawMessage(json.Marshal(value)) works for all types of value."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 1, "last_activity_date": 1573025162, "creation_date": 1573025162, "answer_id": 58725027, "question_id": 58724914, "link": "https://stackoverflow.com/questions/58724914/handling-request-body-with-different-types/58725027#58725027", "title": "Handling request body with different types", "body": "<p>There's a few ways you can do this:</p>\n\n<pre><code>type Section struct {\n   ID interface{} `json:\"section_id\"`\n   SectionName string `json:\"section_name\"\n}\n\nfor _, section := range sections {\n   if str,ok:=section.ID.(string); ok {\n   } else if number, ok:=section.ID.(float64); ok {\n   }\n}\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>type Section struct {\n   ID json.RawMessage `json:\"section_id\"`\n   SectionName string `json:\"section_name\"\n}\n\nfor _, section := range sections {\n   if value, err:=strconv.Atoi(string(section.ID)); err==nil {\n\n   } else {\n   }\n}\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1573029766, "post_id": 58725028, "comment_id": 103743606, "body": "Thank you for your answer. The only mistake here is the part where you check the type of the id. I changed it to <code>if reflect.TypeOf(section.ID).String() == &quot;string&quot;</code> etc. Also I notice that <code>1556895</code> value return <code>float64</code> type. I thought it must be <code>int</code>. So strange."}, {"owner": {"reputation": 722, "user_id": 4671382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55c20cb0c0d8044ffc5866b179ac8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/4671382/cl%c3%a9ment"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1573031082, "post_id": 58725028, "comment_id": 103744244, "body": "About <code>float64</code>, this is what happens by default for numbers when type is given as <code>interface{}</code>. There is a <code>UseNumber()</code> option on the JSON decoder to keep numbers as a json.Number, you can convert it later."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1573034519, "post_id": 58725028, "comment_id": 103746192, "body": "I have such error <code>Cannot use requestBody (type []byte) as type io.Reador</code> in this part of the code: <code>json.NewDecoder(requestBody)</code>."}, {"owner": {"reputation": 722, "user_id": 4671382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55c20cb0c0d8044ffc5866b179ac8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/4671382/cl%c3%a9ment"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1573034949, "post_id": 58725028, "comment_id": 103746432, "body": "Don&#39;t use <code>requestBody</code>, just <code>request.Body</code>."}], "tags": [], "owner": {"reputation": 722, "user_id": 4671382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55c20cb0c0d8044ffc5866b179ac8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/4671382/cl%c3%a9ment"}, "is_accepted": true, "score": 1, "last_activity_date": 1573034971, "last_edit_date": 1573034971, "creation_date": 1573025162, "answer_id": 58725028, "question_id": 58724914, "link": "https://stackoverflow.com/questions/58724914/handling-request-body-with-different-types/58725028#58725028", "title": "Handling request body with different types", "body": "<p>You can try with this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type section struct {\n    ID interface{} `json:\"section_id\"`\n    Name string `json:\"section_name\"`\n}\n\ndec := json.NewDecoder(requestBody)\ndec.UseNumber()\nvar sections []section\nif err := dec.Decode([]byte(request.Body), &amp;sections); err != nil {\n    println(err)\n}\n\nfor _, section := range sections {\n    if reflect.TypeOf(section.ID).String() == \"string\" {\n        // block 1\n    } reflect.TypeOf(section.ID).String() == \"json.Number\" {\n        n := section.ID.Int64()\n        // block 2\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1573030652, "accepted_answer_id": 58725028, "answer_count": 2, "score": -2, "last_activity_date": 1573034971, "creation_date": 1573024672, "last_edit_date": 1573030571, "question_id": 58724914, "link": "https://stackoverflow.com/questions/58724914/handling-request-body-with-different-types", "closed_reason": "Duplicate", "title": "Handling request body with different types", "body": "<p>Let's say a back end application has such a request. As you can see this is an array of objects.</p>\n\n<pre><code>[\n    {\n        \"section_id\": \"8ad1f7cc-a510-48ee-b4fa-bedbee444a84\", // (uuid - string)\n        \"section_name\": \"First section\"\n    },\n    {\n        \"section_id\": 1556895, // (int)\n        \"section_name\": \"Second section\"\n    }\n]\n</code></pre>\n\n<p>I want to parse this array. Depending on the section id type, the application needs to do different things. How to bypass strict typing?</p>\n\n<pre><code>requestBody, err := ioutil.ReadAll(request.Body)\n\nif err = json.Unmarshal([]byte(requestBody), &amp;sections); err != nil {\n    println(err)\n}\n\nfor _, section := range sections {\n    if reflect.TypeOf(section.ID) == string {\n        // block 1\n    } reflect.TypeOf(section.ID) == int {\n        // block 2\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "gitlab", "go-get"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 1577432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f6409eee94a15a0557783dc7b5e74e?s=128&d=identicon&r=PG", "display_name": "htphuongse", "link": "https://stackoverflow.com/users/1577432/htphuongse"}, "is_accepted": false, "score": 1, "last_activity_date": 1573027050, "creation_date": 1573027050, "answer_id": 58725462, "question_id": 58724470, "link": "https://stackoverflow.com/questions/58724470/not-able-to-import-private-gitlab-repository/58725462#58725462", "title": "Not able to import private gitlab repository", "body": "<p>You can run command</p>\n\n<pre><code>git config --global url.git@gitlab.com:.insteadOf https://gitlab.com/\n</code></pre>\n\n<p>and try again, it'll use your git credential to work with gitlab.</p>\n\n<p>For example, your repository is located at <a href=\"https://gitlab.com/yourname/hello\" rel=\"nofollow noreferrer\">https://gitlab.com/yourname/hello</a></p>\n\n<p>you run</p>\n\n<pre><code>go get gitlab.com/yourname/hello\n</code></pre>\n"}], "owner": {"reputation": 271, "user_id": 7011918, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c3b5399e4840423f54e1ebf3d57376da?s=128&d=identicon&r=PG&f=1", "display_name": "ashutosh srivastava", "link": "https://stackoverflow.com/users/7011918/ashutosh-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1573030540, "answer_count": 1, "score": -1, "last_activity_date": 1573030519, "creation_date": 1573022705, "last_edit_date": 1573030519, "question_id": 58724470, "link": "https://stackoverflow.com/questions/58724470/not-able-to-import-private-gitlab-repository", "closed_reason": "Duplicate", "title": "Not able to import private gitlab repository", "body": "<p>I am trying to import a private gitlab repository into my Go code.\nI want to use the user access token for authentication. Is there a way in which I could pass the access token in the import command.</p>\n\n<p>I tried using the basic oauth2 url in the import command, but the import command only accepts a path.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 8, "last_activity_date": 1573020373, "creation_date": 1573020373, "answer_id": 58723992, "question_id": 58723940, "link": "https://stackoverflow.com/questions/58723940/how-to-create-file-with-directory/58723992#58723992", "title": "How to create file with directory", "body": "<p>You cannot create all missing directories and then the file with one function call. You can create all missing directories, and then the file, as follows:</p>\n\n<pre><code>_,err:=os.MkdirAll(\"a/b/c\",perm)\nf, err:=os.Create(\"a/b/c/d.txt\")\n</code></pre>\n\n<p>You can also achieve this with:</p>\n\n<pre><code>name:=\"a/b/c/d.txt\"\nos.MkdirAll(filepath.Dir(name),perm)\nf, err:=os.Create(name)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8872904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d13838c5a48a6d8ec08992527ba7a5dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/8872904/amit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 58723992, "answer_count": 1, "score": 0, "last_activity_date": 1573030727, "creation_date": 1573020102, "last_edit_date": 1573030727, "question_id": 58723940, "link": "https://stackoverflow.com/questions/58723940/how-to-create-file-with-directory", "title": "How to create file with directory", "body": "<p>I am trying to create a file with directories and sub-directories. But Go always returns an error saying path not found. I want to create file with directories.\nI want a, b, c directories to be created(a/b/c) and c directory should have a file d.txt\nI have used os.Create and os.OpenFile</p>\n\n<pre><code>_, cerr := os.OpenFile(\"a/b/c/d.txt\")\n    if cerr != nil {\n        log.Fatal(\"error creating a/b/c\", cerr)\n    }\n\n_, cerr := os.Create(\"a/b/c/d.txt\")\n    if cerr != nil {\n        log.Fatal(\"error creating a/b/c\", cerr)\n    }\n</code></pre>\n\n<p>path error</p>\n"}, {"tags": ["loops", "for-loop", "go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 3, "creation_date": 1573020113, "post_id": 58723887, "comment_id": 103739737, "body": "sum is initialized to 0, and it never changes after that. The for loop will never terminate."}], "answers": [{"tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 2, "last_activity_date": 1573020009, "creation_date": 1573020009, "answer_id": 58723926, "question_id": 58723887, "link": "https://stackoverflow.com/questions/58723887/how-to-meet-if-condition-inside-for-loop/58723926#58723926", "title": "How to meet if condition inside for loop", "body": "<p>Maybe you're looking to something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc looper(x int) {\n    for sum := 0; sum &lt; 10; sum++ {\n        if x == sum {\n            fmt.Print(\"Match\")\n            return\n        } else {\n            fmt.Println(\"No Match\")\n        }\n    }\n}\n\nfunc main() {\n    looper(8)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23450, "user_id": 942391, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/hcwVP.jpg?s=128&g=1", "display_name": "Sumit Singh", "link": "https://stackoverflow.com/users/942391/sumit-singh"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1573021189, "post_id": 58723970, "comment_id": 103740049, "body": "@CeriseLim&#243;n thanks, sry for error, not an JS developer."}], "tags": [], "owner": {"reputation": 23450, "user_id": 942391, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/hcwVP.jpg?s=128&g=1", "display_name": "Sumit Singh", "link": "https://stackoverflow.com/users/942391/sumit-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1573021191, "last_edit_date": 1573021191, "creation_date": 1573020245, "answer_id": 58723970, "question_id": 58723887, "link": "https://stackoverflow.com/questions/58723887/how-to-meet-if-condition-inside-for-loop/58723970#58723970", "title": "How to meet if condition inside for loop", "body": "<p>looks like your loop have only condition, check <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Loops_and_iteration\" rel=\"nofollow noreferrer\">Loops and iteration</a></p>\n\n<p>use:</p>\n\n<pre><code>for sum := 0; sum &lt; 10; sum++{}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 521, "user_id": 6422305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/906785c6d5b1072f87fe6c3b75bb766c?s=128&d=identicon&r=PG&f=1", "display_name": "dswdsyd", "link": "https://stackoverflow.com/users/6422305/dswdsyd"}, "is_accepted": false, "score": 1, "last_activity_date": 1573030218, "last_edit_date": 1573030218, "creation_date": 1573021011, "answer_id": 58724122, "question_id": 58723887, "link": "https://stackoverflow.com/questions/58723887/how-to-meet-if-condition-inside-for-loop/58724122#58724122", "title": "How to meet if condition inside for loop", "body": "<p>The main reason why your code is not working is because you do not have a counter in your for loop, hence its actually in an endless loop and will not terminate.</p>\n\n<p>The format of a for loop is as per below:</p>\n\n<pre><code>for i := 0; i &lt; &lt;some_terminating_value&gt;; i++ {\n    do stuff\n}\n</code></pre>\n\n<p><strong><em>Requirement: \"I expect 'Match' to be printed when 8 equals the iterator variable 'sum' value. Instead, I get many 'No Match' instead.\"</em></strong></p>\n\n<p>Just looking are your code and your explanation of what you are attempting to do appears to conflict.</p>\n\n<p>Your requirement seems to specify print \"Match\" when there sum == x and nothing else, however your code is printing Not Match 7 times and Match on the 8th iteration.</p>\n\n<p>Just going off your requirement, your code should look like this:</p>\n\n<pre><code>\npackage main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc looper(x int) {\n    for i := 0; i &lt;= x; i++ {\n        if i == x {\n            fmt.Print(\"Value: \" + strconv.Itoa(i) + \" = Match\")\n            return\n        }\n    }\n}\n\nfunc main() {\n    looper(8)\n}\n\n</code></pre>\n\n<p>Going off your code, the function should look like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc looper(x int) {\n    for i := 0; i &lt;= x; i++ {\n        if i == x {\n            fmt.Print(\"Match\")\n            return\n        } else {\n            fmt.Println(\"No Match\")\n        }\n    }\n}\n\nfunc main() {\n    looper(8)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1995, "user_id": 6303364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QpkwE.jpg?s=128&g=1", "display_name": "TBouder", "link": "https://stackoverflow.com/users/6303364/tbouder"}, "is_accepted": true, "score": 1, "last_activity_date": 1573030536, "creation_date": 1573030536, "answer_id": 58726304, "question_id": 58723887, "link": "https://stackoverflow.com/questions/58723887/how-to-meet-if-condition-inside-for-loop/58726304#58726304", "title": "How to meet if condition inside for loop", "body": "<p>If you want to use a <code>while</code> style loop, you just have to increment the <code>sum</code> variable</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc looper(x int) {\n    sum := 0\n    for sum &lt; 10 {\n        if x == sum {\n            fmt.Print(\"Match\")\n            return\n        } else {\n            fmt.Println(\"No Match\")\n        }\n        sum++ //&lt;----------------------------HERE\n    }\n}\n\nfunc main() {\n    looper(8)\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6613268, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6i2OxPWDK8Y/AAAAAAAAAAI/AAAAAAAABoM/J-88HToCCuQ/photo.jpg?sz=128", "display_name": "Mark Cosgrave", "link": "https://stackoverflow.com/users/6613268/mark-cosgrave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 58726304, "answer_count": 4, "score": 1, "last_activity_date": 1573030536, "creation_date": 1573019808, "question_id": 58723887, "link": "https://stackoverflow.com/questions/58723887/how-to-meet-if-condition-inside-for-loop", "title": "How to meet if condition inside for loop", "body": "<p>Complete newbie to Go here, coming from Javascript. \nI wish to do a basic loop, with an if statement inside, however, I am not getting the expected results. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc looper(x int) {\n    sum := 0\n    for sum &lt; 10 {\n        if x == sum {\n            fmt.Print(\"Match\")\n            return\n        } else {\n            fmt.Println(\"No Match\")\n        }\n    }\n}\n\nfunc main() {\n    looper(8)\n}\n\n</code></pre>\n\n<p>I expect 'Match' to be printed when 8 equals the iterator variable 'sum' value.</p>\n\n<p>Instead, I get many 'No Match' instead.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 764, "user_id": 799813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2eff6901bd6599cd9a6f808a2a960b46?s=128&d=identicon&r=PG", "display_name": "Tommie Jones", "link": "https://stackoverflow.com/users/799813/tommie-jones"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1573016505, "post_id": 58723175, "comment_id": 103738754, "body": "The Read command is returning invalid type"}, {"owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 1, "creation_date": 1573019609, "post_id": 58723175, "comment_id": 103739568, "body": "I don&#39;t think we can help you without seeing any of the code in question. Did you pass your <code>getSessionsResponseIPDR</code> object as a pointer? Please show the code that reads it. It also might be that the <code>encoding&#47;binary</code> package doesn&#39;t support strings, please check if <a href=\"https://godoc.org/encoding/binary#Size\" rel=\"nofollow noreferrer\"><code>Size</code></a> returns <code>-1</code>"}, {"owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1573019878, "post_id": 58723175, "comment_id": 103739666, "body": "I think it doesn&#39;t support strings, see here: <a href=\"https://play.golang.org/p/BwCPGsEqQ52\" rel=\"nofollow noreferrer\">play.golang.org/p/BwCPGsEqQ52</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "is_accepted": false, "score": 1, "last_activity_date": 1573020268, "creation_date": 1573020268, "answer_id": 58723974, "question_id": 58723175, "link": "https://stackoverflow.com/questions/58723175/decoding-binary-data-when-structures-include-strings/58723974#58723974", "title": "decoding binary data when structures include strings", "body": "<p>It seems like this isn't possible with <code>encoding/binary</code>, as it only supports fixed-size objects. This means that strings aren't supported at all.</p>\n\n<p>If you don't have control over the sending end, you must implement it \"manually\", as in reading from the connection and interpreting the read bytes correctly.</p>\n\n<p>If you have control over the sending end, you can use something like <a href=\"https://godoc.org/encoding/gob\" rel=\"nofollow noreferrer\"><code>encoding/gob</code></a> or <a href=\"https://godoc.org/encoding/json\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a>.</p>\n"}], "owner": {"reputation": 764, "user_id": 799813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2eff6901bd6599cd9a6f808a2a960b46?s=128&d=identicon&r=PG", "display_name": "Tommie Jones", "link": "https://stackoverflow.com/users/799813/tommie-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573020268, "creation_date": 1573014955, "question_id": 58723175, "link": "https://stackoverflow.com/questions/58723175/decoding-binary-data-when-structures-include-strings", "title": "decoding binary data when structures include strings", "body": "<p>Im trying to parse a binary protocol using golang\nI am using encoding/binary library's Read function to map the data to a struct</p>\n\n<p>My struct looks like this</p>\n\n<pre><code>type getSessionsResponseIPDR struct {\n    RequestID     uint16\n    VendorID      string\n    Name          string\n}\n</code></pre>\n\n<p>However it doesnt look like the binary.Read function does not handle strings ending in '\\0'</p>\n\n<p>Is there another way to read this object</p>\n"}, {"tags": ["go", "google-cloud-platform", "serverless"], "answers": [{"tags": [], "owner": {"reputation": 1030, "user_id": 4624877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91dadad091002fe1a5a4867bc954721?s=128&d=identicon&r=PG&f=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/4624877/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1573014397, "creation_date": 1573014397, "answer_id": 58723097, "question_id": 58722009, "link": "https://stackoverflow.com/questions/58722009/how-to-call-a-go-cloud-function-from-another-go-cloud-function-in-gcp/58723097#58723097", "title": "How to call a Go Cloud Function from another Go Cloud Function in GCP", "body": "<p>It is likely each cloud function defined in the console is independent of the other. If you want code reuse, it's best to structure it as per the following document and deploy it using gcloud command.</p>\n\n<p><a href=\"https://cloud.google.com/functions/docs/writing/#structuring_source_code\" rel=\"nofollow noreferrer\">https://cloud.google.com/functions/docs/writing/#structuring_source_code</a></p>\n"}, {"tags": [], "owner": {"reputation": 31223, "user_id": 11372593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=128", "display_name": "guillaume blaquiere", "link": "https://stackoverflow.com/users/11372593/guillaume-blaquiere"}, "is_accepted": false, "score": 0, "last_activity_date": 1573044874, "creation_date": 1573044874, "answer_id": 58730681, "question_id": 58722009, "link": "https://stackoverflow.com/questions/58722009/how-to-call-a-go-cloud-function-from-another-go-cloud-function-in-gcp/58730681#58730681", "title": "How to call a Go Cloud Function from another Go Cloud Function in GCP", "body": "<p>You are mixing things: package management and function deployment.</p>\n\n<p>When you deploy a Cloud Function, if you want to (re)use it, you have to call if with http package.</p>\n\n<p>If you build a package that you want to include in your source code, you have to rely on package manager. With Go, Git repository, like Github, is the best way to achieve this (Don't forget to perform a release and to name it as expected by Go mod: vX.Y.Z)</p>\n\n<p>Here your code can't work without more engineering and package publication/management.</p>\n\n<p>I achieve the same things but with a Dockerfile and I deplored my code in Cloud Run (that I recommend you if you aren't event oriented and only HTTP oriented. I wrote a <a href=\"https://medium.com/google-cloud/cloud-run-vs-cloud-functions-whats-the-lowest-cost-728d59345a2e\" rel=\"nofollow noreferrer\">comparison on Medium</a>)</p>\n\n<ul>\n<li>Root\n\n<ul>\n<li>go.mod</li>\n<li>pkg/foo.go</li>\n<li>pkg/go.mod</li>\n<li>service/Helloworld.go</li>\n<li>service/go.mod</li>\n</ul></li>\n</ul>\n\n<p>In my <code>helloworld.go</code>, I can reuse the package <code>foo</code>. For this I perform this in my <code>service/go.mod</code> file</p>\n\n<pre><code>module service/helloworld\n\ngo 1.12\n\nrequire pkg/foo v0.0.0\n\nreplace pkg/foo v0.0.0 =&gt; ../pkg\n</code></pre>\n\n<p>Then when you build your container, you run your <code>go build service/Helloworld.go</code> from the root directory.</p>\n"}, {"tags": [], "owner": {"reputation": 2060, "user_id": 8791788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i9p20.jpg?s=128&g=1", "display_name": "Nibrass H", "link": "https://stackoverflow.com/users/8791788/nibrass-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1573049483, "creation_date": 1573049483, "answer_id": 58732043, "question_id": 58722009, "link": "https://stackoverflow.com/questions/58722009/how-to-call-a-go-cloud-function-from-another-go-cloud-function-in-gcp/58732043#58732043", "title": "How to call a Go Cloud Function from another Go Cloud Function in GCP", "body": "<p>You can\u2019t invoke a cloud function from another one, because each function is in its own  container independently.</p>\n\n<p>So If you want to deploy the function with a dependency that can't be downloaded from a package manager you need to put the code together like <a href=\"https://cloud.google.com/functions/docs/writing/#functions-writing-file-structuring-nodejs\" rel=\"nofollow noreferrer\">here</a> and deploy using the <a href=\"https://cloud.google.com/functions/docs/deploying/filesystem\" rel=\"nofollow noreferrer\">CLI</a> </p>\n"}], "owner": {"reputation": 2295, "user_id": 839108, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/1Gp9M.jpg?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/839108/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 58732043, "answer_count": 3, "score": 1, "last_activity_date": 1573049483, "creation_date": 1573005369, "question_id": 58722009, "link": "https://stackoverflow.com/questions/58722009/how-to-call-a-go-cloud-function-from-another-go-cloud-function-in-gcp", "title": "How to call a Go Cloud Function from another Go Cloud Function in GCP", "body": "<p><strong>Goal:</strong> I want to reuse many Go functions from two Go functions with HTTP triggers.</p>\n\n<p><strong>What I have tried and steps to reproduce the problem:</strong></p>\n\n<ol>\n<li>In GCP, create a new Go 1.11 Cloud Function, HTTP Trigger</li>\n<li>Name it: <code>MyReusableHelloWorld</code></li>\n<li>In <code>function.go</code>, paste this: </li>\n</ol>\n\n<pre><code>package Potatoes\n\nimport (   \n    \"net/http\"\n)\n\n\n// Potatoes return potatoes\nfunc Potatoes(http.ResponseWriter, *http.Request) {\n\n}\n</code></pre>\n\n<ol start=\"4\">\n<li>In <code>go.mod</code>, paste this: <code>module example.com/foo</code></li>\n<li>In function to execute, paste this: <code>Potatoes</code></li>\n<li>Click on deploy. It works.</li>\n<li>Create another Go serverless function in GCP</li>\n<li>In function. go, paste this:</li>\n</ol>\n\n<pre><code>// Package p contains an HTTP Cloud Function.\npackage p\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"html\"\n    \"net/http\"\n    \"example.com/foo/Potatoes\"\n)\n\n// HelloWorld prints the JSON encoded \"message\" field in the body\n// of the request or \"Hello, World!\" if there isn't one.\nfunc HelloWorld(w http.ResponseWriter, r *http.Request) {\n    var d struct {\n        Message string `json:\"message\"`\n    }\n    if err := json.NewDecoder(r.Body).Decode(&amp;d); err != nil {\n        fmt.Fprint(w, \"error here!\")\n        return\n    }\n    if d.Message == \"\" {\n        fmt.Fprint(w, \"oh boy Hello World!\")\n        return\n    }\n    fmt.Fprint(w, html.EscapeString(d.Message))\n}\n</code></pre>\n\n<ol start=\"9\">\n<li>In <code>go.mod</code>, paste this: <code>module example.com/foo</code></li>\n<li>In function to execute, paste this: <code>HelloWorld</code></li>\n<li>Click on deploy. <strong>It doesn't work.</strong> <strong>You have the error:</strong> <code>unknown import path \"example.com/foo/Potatoes\": cannot find module providing package example.com/foo/Potatoes</code></li>\n</ol>\n\n<p>I have also tried all kinds of combinations for the module/packages to import. \nI have tried without the example.com/  part.</p>\n\n<p><strong>Other smaller issue:</strong>\nThe functions I want to reuse could all be in the same file and don't really need any trigger, but it doesn't seem that having no trigger is possible.</p>\n\n<p><strong>Related questions and documentation with which I could not achieve my goal:</strong></p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/54255485/how-can-i-use-a-sub-packages-with-go-on-google-cloud-functions\">How can I use a sub-packages with Go on Google Cloud Functions?</a></li>\n<li><a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules</a> , section go.mod</li>\n</ol>\n"}, {"tags": ["go", "biginteger", "logarithm"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1572995555, "post_id": 58720776, "comment_id": 103734377, "body": "To what kind of precision? If around 15 digits is fine, just parse it as a float. If you need something comparable to the number of digits in the input, you&#39;re in for some work."}, {"owner": {"reputation": 71, "user_id": 11897240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde3ef16d18bdc0ef389576950b1b9e8?s=128&d=identicon&r=PG&f=1", "display_name": "roAl", "link": "https://stackoverflow.com/users/11897240/roal"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1572995696, "post_id": 58720776, "comment_id": 103734418, "body": "@hobbs the second option."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1572996005, "post_id": 58720776, "comment_id": 103734491, "body": "Is this a homework assignment? This sounds like a problem that&#39;s expecting you to use the basic log identities, and not a library function."}, {"owner": {"reputation": 734, "user_id": 7731997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COdcu.jpg?s=128&g=1", "display_name": "Gabriel Jablonski", "link": "https://stackoverflow.com/users/7731997/gabriel-jablonski"}, "edited": false, "score": 2, "creation_date": 1572996257, "post_id": 58720776, "comment_id": 103734544, "body": "In most situations, I don&#39;t see why you&#39;d need a precision higher than the one offered by <code>float64</code>. But if you REALLY need it for some crazy reason, <a href=\"https://github.com/robpike/ivy/blob/master/value/log.go\" rel=\"nofollow noreferrer\">this function</a> by one of the golang devs might be useful."}, {"owner": {"reputation": 71, "user_id": 11897240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde3ef16d18bdc0ef389576950b1b9e8?s=128&d=identicon&r=PG&f=1", "display_name": "roAl", "link": "https://stackoverflow.com/users/11897240/roal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1572996693, "post_id": 58720776, "comment_id": 103734651, "body": "@JimB not really, it&#39;s just some midnight crazy idea that hit my mind. I think I will go on now with the option with less precision."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 734, "user_id": 7731997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COdcu.jpg?s=128&g=1", "display_name": "Gabriel Jablonski", "link": "https://stackoverflow.com/users/7731997/gabriel-jablonski"}, "edited": false, "score": 0, "creation_date": 1572998881, "post_id": 58720776, "comment_id": 103735217, "body": "Unfortunately Go&#39;s arbitrary-precision package provides no help on its own, <i>and</i> there&#39;s no usable interface to GMP or PARI (at least, that go-search can find). So doing the Maclaurin series yourself as Rob Pike did in the function @Gabriel linked seems to be the only answer apart from &quot;use another language&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 734, "user_id": 7731997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COdcu.jpg?s=128&g=1", "display_name": "Gabriel Jablonski", "link": "https://stackoverflow.com/users/7731997/gabriel-jablonski"}, "is_accepted": false, "score": 1, "last_activity_date": 1573041486, "creation_date": 1573041486, "answer_id": 58729662, "question_id": 58720776, "link": "https://stackoverflow.com/questions/58720776/how-to-get-the-natural-log-of-a-big-integer/58729662#58729662", "title": "How to get the natural log of a big integer", "body": "<p>There are very few situations in which you'd need a precision greater than the one provided by the standard <code>float64</code> type. </p>\n\n<p>But just to satisfy any \"midnight crazy ideas\" (or even some very in-depth scientific research!) anyone might run into, Rob Pike's <a href=\"https://github.com/robpike/ivy/tree/master/value\" rel=\"nofollow noreferrer\">implementations of some operations with big floats</a> are probably the best you can get right now with Go. The <code>log</code> function can be found <a href=\"https://github.com/robpike/ivy/blob/master/value/log.go\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 71, "user_id": 11897240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde3ef16d18bdc0ef389576950b1b9e8?s=128&d=identicon&r=PG&f=1", "display_name": "roAl", "link": "https://stackoverflow.com/users/11897240/roal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1573041486, "creation_date": 1572995036, "last_edit_date": 1573030821, "question_id": 58720776, "link": "https://stackoverflow.com/questions/58720776/how-to-get-the-natural-log-of-a-big-integer", "title": "How to get the natural log of a big integer", "body": "<p>I am trying to convert a string to integer and then to calculate its log.\nMy first approach was to convert the string using <code>strconv</code> library, but I got an error about the length of the string to be converted.</p>\n\n<p>After that, I used <code>math/big</code> library which worked fine. Now I am not able to apply <code>math.Log()</code>on the resulted big integer.</p>\n\n<p>Code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"math/big\"\n)\n\nfunc main() {\n    bb := \"11948904162160164791281681976941230184120142151411311314211115130161285142991119211447\"\n    bi := big.NewInt(0)\n    if _, ok := bi.SetString(bb, 10); ok {\n        fmt.Println(math.Log(bi))\n    } else {\n        fmt.Printf(\"error parsing line %#v\\n\", bb)\n    }\n\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>cannot use bi (type *big.Int) as type float64 in argument to math.Log\n</code></pre>\n"}, {"tags": ["go", "reflection", "go-reflect"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572986271, "post_id": 58719035, "comment_id": 103731109, "body": "I hope I understood your question correctly, If not, please advise."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1572986316, "post_id": 58719035, "comment_id": 103731136, "body": "The value passed to reflect.TypeOf has anonymous type <code>func() *Foo</code>. Anonymous types do not have a package path.  Describe the higher-level problem that you are trying to solve. There may be a solution to that problem."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1572986584, "post_id": 58719035, "comment_id": 103731226, "body": "For example: <a href=\"https://play.golang.org/p/qyUvU1Ej1Jq\" rel=\"nofollow noreferrer\">play.golang.org/p/qyUvU1Ej1Jq</a>"}, {"owner": {"reputation": 2507, "user_id": 769097, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ee769c59ea4469d8251105086b4b6cee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/769097/alex"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1572986860, "post_id": 58719035, "comment_id": 103731342, "body": "@CeriseLim&#243;n added a problem I&#39;m trying to solve. Seeing example above it seems I can&#39;t solve it using reflection alone as I&#39;d need to define a type somehow."}, {"owner": {"reputation": 2507, "user_id": 769097, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ee769c59ea4469d8251105086b4b6cee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/769097/alex"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572987003, "post_id": 58719035, "comment_id": 103731397, "body": "@Flimzy updated context for this question. Looks like the answer is still no, but wanted to see if there are possible options. Question that you reference deals with the type reference, not the function reference as in my snippet above."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1572987192, "post_id": 58719035, "comment_id": 103731475, "body": "Package functions have anonymous types. There&#39;s no way to get any package information from an anonymous type; it&#39;s anonymous. It also has no name, for the same reason. You can see here: <a href=\"https://play.golang.org/p/nRfKzxjVzph\" rel=\"nofollow noreferrer\">play.golang.org/p/nRfKzxjVzph</a>"}, {"owner": {"reputation": 2507, "user_id": 769097, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ee769c59ea4469d8251105086b4b6cee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/769097/alex"}, "edited": false, "score": 0, "creation_date": 1572987331, "post_id": 58719035, "comment_id": 103731536, "body": "Understood, that&#39;s what I thought is happening too. So, in order to refer to those functions, I have no other way but to give package information along with reflect.TypeOf(somePackageFunction).  Passing package names seems like a hack, but looks like I can&#39;t avoid it. Thanks!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1572987447, "post_id": 58719035, "comment_id": 103731586, "body": "Code generators typically work from the source code, not from the runtime values.   The import path of the function is known to the programmer who typed the expression <code>foo.New</code>.  Explicitly include that path in the code if you go down the path of using runtime values."}, {"owner": {"reputation": 2507, "user_id": 769097, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ee769c59ea4469d8251105086b4b6cee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/769097/alex"}, "edited": false, "score": 0, "creation_date": 1572987665, "post_id": 58719035, "comment_id": 103731666, "body": "I see, I had my reasons to do it that way - primarily due to extreme simplicity of the code generator - I wanted to have things defined in one place, instructions to code generator are too lengthy to pack them into a list of parameters to go generate."}], "owner": {"reputation": 2507, "user_id": 769097, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ee769c59ea4469d8251105086b4b6cee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/769097/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1572986195, "answer_count": 0, "score": 0, "last_activity_date": 1572986809, "creation_date": 1572985926, "last_edit_date": 1572986809, "question_id": 58719035, "link": "https://stackoverflow.com/questions/58719035/is-there-a-way-to-extract-package-path-from-reflect-func", "closed_reason": "Duplicate", "title": "Is there a way to extract package path from reflect.Func?", "body": "<p>When <code>reflect.TypeOf</code> is used on functions, resultant object has empty <code>PkgPath()</code>.\nFull example showing this is as follows:</p>\n\n<pre><code>// file 1, package foo:\nfunc New() *Foo {\n  return nil\n}\n\n// file 2, package main, main func:\ntyp := reflect.TypeOf(foo.New)\nfmt.Printf(\"typ.PkgPath() is '%s'\\n\", typ.PkgPath())\n</code></pre>\n\n<p>Do I understand right that there is no need to get pkg path from functions and there is no way to learn it given reflect.Type alone for funcs?\nIf not - is there still a way to extract it somehow?</p>\n\n<p>Edit 1: the problem I'm trying to solve is to write a code generator that would create a code doing something with the functions that I'm passing to that code generator. Code generator is a library that gets called in my utility's main function that should somehow take functions that I define in some packages and create code that somehow uses those functions.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1572983988, "post_id": 58718552, "comment_id": 103730156, "body": "<code>multiplyByTwo</code> is only receiving a single value, where do you think the other 3 values are supposed to go? (you&#39;re not putting any values &quot;into&quot; the channel, it holds 0 values)"}, {"owner": {"reputation": 2732, "user_id": 2061886, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dkfiz.jpg?s=128&g=1", "display_name": "lightweight", "link": "https://stackoverflow.com/users/2061886/lightweight"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1572984280, "post_id": 58718552, "comment_id": 103730290, "body": "so something like <code>in &lt;- 3</code> and <code>in &lt;- 6</code> isn&#39;t actually putting stuff in the channel?? this is where i&#39;m confused...how do you keep putting stuff into the channel and have it process while stuff gets added"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1572984342, "post_id": 58718552, "comment_id": 103730316, "body": "No. The channel is unbuffered, so those send operations don&#39;t store anything in the channel."}, {"owner": {"reputation": 2732, "user_id": 2061886, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dkfiz.jpg?s=128&g=1", "display_name": "lightweight", "link": "https://stackoverflow.com/users/2061886/lightweight"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1572984482, "post_id": 58718552, "comment_id": 103730370, "body": "so then how does one keep &quot;sending&quot; stuff through the channel in this example?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1572984695, "post_id": 58718552, "comment_id": 103730459, "body": "You have something receiving an each item from the channel. Normally to do something more than once you would use a <code>for</code> loop. Maybe go through the official docs first, like the <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow noreferrer\">Concurrency</a> section in &quot;Tour of Go&quot;"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1572984698, "post_id": 58718552, "comment_id": 103730462, "body": "Something has to receive on the other end. Every send operation should have a receive operation somewhere for the operation to complete."}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 3, "last_activity_date": 1572984832, "creation_date": 1572984832, "answer_id": 58718768, "question_id": 58718552, "link": "https://stackoverflow.com/questions/58718552/another-golang-channels-questions-on-understanding-how-it-processes/58718768#58718768", "title": "another golang channels questions on understanding how it processes", "body": "<p>The goroutine processes one value, and then terminates. You can only send the first value to your goroutine, after that, the goroutine is gone, and there's nothing listening to your channel. That's why you get deadlock, you're trying to send data to a channel where there are no listeners.</p>\n\n<p>Your channels are unbuffered. That means, data exchange through the channel happens only when there is at least one listener reading from the channel, and some other goroutine writes to it.  If you create buffered channels, you can keep adding to them until the buffer is full. Otherwise, for the write operation to succeed, there must be a matching read operation.</p>\n\n<p>This would work:</p>\n\n<pre><code>func multiplyByTwo(in &lt;-chan int) {\n    for num:=range in {\n       // process num\n    }\n    // If here, then channel in is closed\n}\n\nin &lt;- n\nin &lt;- 3\nin &lt;- 6\nin &lt;- 10\nclose(in)\n// Wait for the goroutine to finish\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": true, "score": 1, "last_activity_date": 1572995068, "last_edit_date": 1572995068, "creation_date": 1572990594, "answer_id": 58719997, "question_id": 58718552, "link": "https://stackoverflow.com/questions/58718552/another-golang-channels-questions-on-understanding-how-it-processes/58719997#58719997", "title": "another golang channels questions on understanding how it processes", "body": "<p>You can, if you like, think of a channel as a sort of mailbox (perhaps with special teleportation abilities, like a portal from <a href=\"https://en.wikipedia.org/wiki/Portal_(video_game)\" rel=\"nofollow noreferrer\">the game Portal</a>).</p>\n\n<p>An <em>unbuffered</em> channel is a mailbox that has no room at all for any packages.  For someone to mail a package (send a value), they must wait until the receiver's hand pokes out of the mailbox.  They can then drop the package into the hand, which will withdraw back into the mailbox, taking the package with it.  If someone else is in line, you must get in line behind the someone-else.</p>\n\n<p>A <em>buffered</em> channel is a mailbox that can hold one or more packages.  To send a package, get into the line if there is one.  When you reach the head of the line, you may look at the box.  If there is room for your package, you put it in and go on about your business.  If not, you can wait until there is room, then put the package in and go on about your business.</p>\n\n<p>So there is a general pattern to send:</p>\n\n<ol>\n<li>Get in line if you have to.</li>\n<li>When you reach the head of the queue, put your package in if there is room, otherwise wait for room\u2014or, for an unbuffered channel, for someone to come to the other (receive) side and put their hand in to receive.</li>\n</ol>\n\n<p>Meanwhile, if you want to <em>receive</em> from a channel, you queue up if needed, just as for sending.  Once you're at the head of the line, you can take a package out of the box, or\u2014for an unbuffered channel\u2014wait with your hand sticking out of the other side of the box-with-no-room for someone to come along and put something in it.</p>\n\n<p>Each goroutine is, in this analogy, like a person, or a <a href=\"https://blog.golang.org/gopher\" rel=\"nofollow noreferrer\">Go gopher</a>.  It (or he or she or whatever pronoun you prefer) can queue up if needed, and put things into, or take them out of, one of these channels.  Your program starts with one goroutine, which invokes <code>main</code>.</p>\n\n<p>In your code, you spin off a second goroutine, which begins at <code>multiplyByTwo</code>.  This one goroutine waits\u2014<em>once</em>\u2014for a number to show up in the channel, or in this case, for someone to be waiting to <em>send</em> a number since the channel is unbuffered.  It then doubles the (single) number it got, prints the result, and quits / dies / gets buried, never to exist again.</p>\n\n<p>Meanwhile your <code>main</code> waits for someone to be receiving\u2014that would be your second goroutine\u2014until it's ready to take the number <code>3</code> that's in <code>n</code>.  That part succeeds.  Then your <code>main</code> waits for another receive so that it can send the constant <code>3</code>.</p>\n\n<p>While your <code>main</code> is waiting, your other goroutine is doing its work\u2014or maybe has finished its work\u2014and exits.  Now there is only one \"person\" (or gopher or whatever) in the whole system, waiting for a second person\u2014who does not exist and will not ever be born\u2014to come along to take the number.  The underlying Go system can tell that this event won't ever happen, and that's when you get the message:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>(this also terminates the program).</p>\n\n<p><a href=\"https://stackoverflow.com/a/58718768/1256452\">Burak Serdar's answer</a> shows how you can have your second goroutine <em>keep reading</em> numbers from the channel.  This introduces a new problem: how do you tell the second goroutine that no more numbers are coming?  The answer is that you can <em>close</em> the channel, with <code>close</code>.</p>\n\n<p>If we stick with the mailbox analogy, you can think of closing the channel as putting a special sticker or label on the send side of the channel.  This prevents anyone from doing any further putting-values-in.  Any packages that are <em>in</em> the channel already are safe\u2014they stay there until someone receives them\u2014but no <em>new</em> packages can go in.  On the receiver side, it's easy to tell the difference between a package and this special sticker: so when you encounter the \"closed\" sticker, you know no more values will ever come through.  If the channel is unbuffered, you can see this sticker immediately.  If it's buffered, you'll have to take out all the existing packages first, before you can see it.</p>\n\n<p>In general, the sender <em>should</em> close the channel so that receivers know they will not get anything more from it.  (In many specific cases, you can get away without closing the channel.  In particular, if the goroutine running <code>main</code> returns from its call to <code>main</code>, all the other goroutines die more or less immediately.)</p>\n\n<p>Note that once closed, <em>no</em> sender can close the channel <em>again</em>, so this means that if you have a single channel that you <em>share</em> across multiple senders, only one of them can close the channel!  Making that work right is tricky, so it's more common to avoid sharing a channel across more than one writing-goroutine like this.</p>\n"}], "owner": {"reputation": 2732, "user_id": 2061886, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dkfiz.jpg?s=128&g=1", "display_name": "lightweight", "link": "https://stackoverflow.com/users/2061886/lightweight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58719997, "answer_count": 2, "score": -4, "last_activity_date": 1572995068, "creation_date": 1572983735, "question_id": 58718552, "link": "https://stackoverflow.com/questions/58718552/another-golang-channels-questions-on-understanding-how-it-processes", "title": "another golang channels questions on understanding how it processes", "body": "<p>I'm walking through this <a href=\"https://www.sohamkamani.com/blog/2017/08/24/golang-channels-explained/\" rel=\"nofollow noreferrer\">blog post</a> to understand channels and I have a question on the <a href=\"https://www.sohamkamani.com/blog/2017/08/24/golang-channels-explained/#example-2---two-single-directional-channels\" rel=\"nofollow noreferrer\">2nd example</a>. I modified it a bit in the playground to <a href=\"https://play.golang.org/p/1wX23HAn7Fg\" rel=\"nofollow noreferrer\">this</a>, where I'm putting more items in the channel like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    n := 3\n    in := make(chan int)\n    out := make(chan int)\n\n    // We now supply 2 channels to the `multiplyByTwo` function\n    // One for sending data and one for receiving\n    go multiplyByTwo(in, out)\n\n    // We then send it data through the channel and wait for the result\n    in &lt;- n\n    in &lt;- 3\n    in &lt;- 6\n    in &lt;- 10\n    fmt.Println(&lt;-out)\n}\n\nfunc multiplyByTwo(in &lt;-chan int, out chan&lt;- int) {\n    // This line is just to illustrate that there is code that is\n    // executed before we have to wait on the `in` channel\n    fmt.Println(\"Initializing goroutine...\")\n\n    // The goroutine does not proceed until data is received on the `in` channel\n    num := &lt;-in\n\n    // The rest is unchanged\n    result := num * 2\n    out &lt;- result\n}\n</code></pre>\n\n<p>but this throws an error: </p>\n\n<pre><code>Initializing goroutine...\nfatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan send]:\nmain.main()\n    /tmp/sandbox639017164/prog.go:18 +0xe0\n\ngoroutine 6 [chan send]:\nmain.multiplyByTwo(0x430080, 0x4300c0)\n    /tmp/sandbox639017164/prog.go:34 +0xe0\ncreated by main.main\n    /tmp/sandbox639017164/prog.go:14 +0xa0\n</code></pre>\n\n<p>my interpretation of this is that the channels should process data that comes in, so why would it throw an error if I'm just simply adding more to the channel? I'd assume that it would pass in the other numbers too and run those through the function as well.</p>\n\n<p>if I run it like this without an out channel:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    n := 3\n    in := make(chan int)\n    //out := make(chan int)\n\n    // We now supply 2 channels to the `multiplyByTwo` function\n    // One for sending data and one for receiving\n    go multiplyByTwo(in)\n\n    // We then send it data through the channel and wait for the result\n    in &lt;- n\n    in &lt;- 3\n    in &lt;- 6\n    in &lt;- 10\n}\n\nfunc multiplyByTwo(in &lt;-chan int) {\n    // This line is just to illustrate that there is code that is\n    // executed before we have to wait on the `in` channel\n    fmt.Println(\"Initializing goroutine...\")\n\n    // The goroutine does not proceed until data is received on the `in` channel\n    num := &lt;-in\n\n    // The rest is unchanged\n    result := num * 2\n    fmt.Println(result)\n}\n</code></pre>\n\n<p>it process the first input into the channel but then errors out again. <code>fatal error: all goroutines are asleep - deadlock!</code></p>\n"}, {"tags": ["go", "couchbase", "n1ql"], "answers": [{"comments": [{"owner": {"reputation": 5033, "user_id": 6080536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c5a7c933cab9e8e2a926db17b058e12?s=128&d=identicon&r=PG&f=1", "display_name": "vsr", "link": "https://stackoverflow.com/users/6080536/vsr"}, "edited": false, "score": 1, "creation_date": 1572997223, "post_id": 58715985, "comment_id": 103734789, "body": "Installation must have created it. Check this out <a href=\"https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/backfill.html\" rel=\"nofollow noreferrer\">docs.couchbase.com/server/current/n1ql/n1ql-language-referen&zwnj;&#8203;ce/&hellip;</a>"}], "tags": [], "owner": {"reputation": 647, "user_id": 1540415, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a193205987f1f85cb1bbfadd9907dca4?s=128&d=identicon&r=PG", "display_name": "Siraf", "link": "https://stackoverflow.com/users/1540415/siraf"}, "is_accepted": false, "score": 1, "last_activity_date": 1572972770, "creation_date": 1572972770, "answer_id": 58715985, "question_id": 58715793, "link": "https://stackoverflow.com/questions/58715793/couchbase-query-error-5000-open-c-couchbase-server-var-lib-couchbase-tmp-scan/58715985#58715985", "title": "Couchbase query error 5000 (open C:\\Couchbase\\Server\\var\\lib\\couchbase\\tmp\\scan-results5960831968761: The system cannot find the path specified", "body": "<p>we solved the problem by creating an empty tmp folder in var\\lib\\couchbase on all nodes. after that the query error above didn't occur.</p>\n"}], "owner": {"reputation": 647, "user_id": 1540415, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a193205987f1f85cb1bbfadd9907dca4?s=128&d=identicon&r=PG", "display_name": "Siraf", "link": "https://stackoverflow.com/users/1540415/siraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572972770, "creation_date": 1572972071, "question_id": 58715793, "link": "https://stackoverflow.com/questions/58715793/couchbase-query-error-5000-open-c-couchbase-server-var-lib-couchbase-tmp-scan", "title": "Couchbase query error 5000 (open C:\\Couchbase\\Server\\var\\lib\\couchbase\\tmp\\scan-results5960831968761: The system cannot find the path specified", "body": "<p>We have a 3 node Couchbase server 6.0.2 EE cluster on Windows 2016. We fire n1ql queries against a bucket using golang SDK. Every third query execution generates this error:</p>\n\n<pre><code>[5000] open D:\\\\Couchbase\\\\Server\\\\var\\\\lib\\\\couchbase\\\\tmp\\\\scan-results5960831968761: The system cannot find the path specified.\n</code></pre>\n\n<p>We tried to restart/kill the query job on all three nodes, that didn't solve the issue! Couchbase was still insisting to find the scan-results[\\d]+</p>\n\n<p>We didn't find anything in couchbase public forums</p>\n\n<p>any ideas?</p>\n\n<p>Regards,\nSirag</p>\n"}, {"tags": ["go", "module"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572969249, "post_id": 58714966, "comment_id": 103723201, "body": "Did you <code>go get</code> first?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572972136, "post_id": 58714966, "comment_id": 103724882, "body": "Your question says you&#39;re using 1.10 but the output mentions modules which were introduced in 1.11. Can you clarify?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572976363, "post_id": 58714966, "comment_id": 103726870, "body": "Now your question says 1.12 but your comment says 1.13 - but either way you have modules so it makes some sense. Did you <code>go get</code> first before building?"}, {"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572978688, "post_id": 58714966, "comment_id": 103727908, "body": "yup, edited the question to the current version (1.12.8) , deleting that comment."}, {"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572978726, "post_id": 58714966, "comment_id": 103727927, "body": "And, to answer your other question, no - im not <code>go getting</code> at all."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572979663, "post_id": 58714966, "comment_id": 103728271, "body": "Then that may be your issue - if you haven&#39;t downloaded your dependencies, you&#39;re not going to be able to build."}, {"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573041635, "post_id": 58714966, "comment_id": 103750055, "body": "Hmmm, My build is fetching several other repositories... are you sure go get is always required ?"}, {"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1573057345, "post_id": 58714966, "comment_id": 103759091, "body": "Interestingly im finding that the ` go: error loading module requirements` happens at a different time during my builds... so im suspecting some kind of http timeout which may occur, and thus am wondering if there is a way to debug the go get command that is occuring."}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 7157204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9a579276141bae5f9c8531dd720c23?s=128&d=identicon&r=PG&f=1", "display_name": "learning2learn", "link": "https://stackoverflow.com/users/7157204/learning2learn"}, "edited": false, "score": 0, "creation_date": 1595610609, "post_id": 58756001, "comment_id": 111544841, "body": "did you find a way to disable the go build concurrency? I tried doing so with  GOMAXPROCS=1 but that does not appear to help. In the analogous issue I am debugging now, that&#39;s exactly the problem, a different build log every time. A go mod tidy (on 1.12) does not help me. But I will take the advice you have for now and review my logs very carefully."}], "tags": [], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "is_accepted": false, "score": 1, "last_activity_date": 1573156549, "last_edit_date": 1573156549, "creation_date": 1573156230, "answer_id": 58756001, "question_id": 58714966, "link": "https://stackoverflow.com/questions/58714966/why-do-go-modules-fail-without-detailed-information-at-pulling-certain-correct/58756001#58756001", "title": "Why do go modules fail without detailed information, at pulling certain correct commits which are valid?", "body": "<p>The answer to this question is: that the question is based on a false premise.  </p>\n\n<p>That is, I originally assumed that the last statement before my go build failure was the one that failed, but I was wrong.  In fact, if a module is not pullable, you will get explicit error reports for it, for example:</p>\n\n<pre><code>go: github.com/golang/glog@v0.0.0-20160126235308-23def4e6c14b: unexpected status (https://***.***@artifacts.domain.com/api/go/go-domain/github.com/golang/glog/@v/23def4e6c14b.mod): 404 Not Found\n</code></pre>\n\n<p>But you might have many more succesfull operations which occur, before the build is failed and reported as failing to satisfy module requirements.\nThus, if you have a module which is fundamentally broken, you might get a completely different build log every time.  This is because the nature of how <code>go build</code> triggers the fetching <code>finding</code> operations - if (1) Go modules are enabled and (2) the go module you are searching for is <em>not</em> in the current GOPATH , then you will see something like this:</p>\n\n<pre><code>jayunit100@k8s-vmware:~/mygoapp# go build\ngo: finding github.com/jayunit100/blah v1.2.3\ngo: downloading github.com/jayunit100/blah v1.2.3\n</code></pre>\n\n<p>That is, the module is pulled down at build time, however, go build's fetching of repositories is done in a non-deterministic order, as you can see in the following logs (see how the download for <code>logrus</code> starts, and several other downloads start during that time, and then half a second later, the extraction of the <code>logrus</code> happens later on.</p>\n\n<pre><code>2019-11-06 11:46:46 gobuilds.Compile : 11:46:46.438 calico_all_build INFO         go: downloading github.com/projectcalico/logrus v1.0.4-calico\n2019-11-06 11:46:46 gobuilds.Compile : 11:46:46.440 calico_all_build INFO         go: downloading github.com/prometheus/client_golang v0.9.1\n2019-11-06 11:46:46 gobuilds.Compile : 11:46:46.444 calico_all_build INFO         go: downloading github.com/docopt/docopt-go v0.0.0-20160216232012-784ddc588536\n2019-11-06 11:46:46 gobuilds.Compile : 11:46:46.454 calico_all_build INFO         go: downloading k8s.io/client-go v12.0.0+incompatible\n2019-11-06 11:46:46 gobuilds.Compile : 11:46:46.477 calico_all_build INFO         go: downloading k8s.io/apimachinery v0.0.0-20190612205821-1799e75a0719\n2019-11-06 11:46:46 gobuilds.Compile : 11:46:46.504 calico_all_build INFO         go: downloading github.com/coreos/go-semver v0.3.0\n2019-11-06 11:46:46 gobuilds.Compile : 11:46:46.510 calico_all_build INFO         go: extracting github.com/projectcalico/logrus v1.0.4-calico\n</code></pre>\n\n<p>Ultimately in the above question, the failure which occured wasn't actually associated with the repositories in the logging but rather with repositories which were pulled down much earlier in the build stage.  </p>\n\n<p>That is, when you see that a go module <code>fetch</code> happens followed by a go module <code>error loading module requirements</code>, you should look at all the logs before the failure , to find the error message, and never assume that the <em>last</em> operation before the error report, is the <em>actual</em> operation which failed.</p>\n\n<p>I do not know exactly how long it takes for go build to 'fail' after an error, but, it does appear that certain errors can happen and gomodules will continue attempting to do more work for some period of time do to various other concurrenct finding/fetching operations.</p>\n\n<p>TL;DR, go build has concurrency elements in it, pay attention to that when debugging complex module pulls.</p>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573156549, "creation_date": 1572969156, "last_edit_date": 1573053127, "question_id": 58714966, "link": "https://stackoverflow.com/questions/58714966/why-do-go-modules-fail-without-detailed-information-at-pulling-certain-correct", "title": "Why do go modules fail without detailed information, at pulling certain correct commits which are valid?", "body": "<p>I have a dependency in an upstream repository in my go.sub file: <code>github.com/prometheus/common v0.0.0-20190416093430-c873fb1f9420</code> which clearly exists in the real world: <a href=\"https://github.com/prometheus/common/commit/c873fb1f9420b83ee703b4361c61183b4619f74d\" rel=\"nofollow noreferrer\">https://github.com/prometheus/common/commit/c873fb1f9420b83ee703b4361c61183b4619f74d</a>.  Is there any reason why go <code>finding:...</code> steps which run in my build, would fail on this.  </p>\n\n<p>It's clearly a valid SHA... however, When I run my builds, I get the following output:</p>\n\n<pre><code>2019-11-05 06:24:37 gobuilds.Compile : 06:24:37.496 calico_all_build INFO         go: finding github.com/prometheus/common v0.0.0-20190416093430-c873fb1f9420\n2019-11-05 06:24:41 gobuilds.Compile : 06:24:41.644 calico_all_build INFO         go: error loading module requirements\n2019-11-05 06:24:42 gobuilds.Compile : 06:24:42.425 calico_all_build INFO         make[1]: *** [bin/calico-typha-amd64] Error 1\n</code></pre>\n\n<p>The version I'm using is 1.12.8 (edit, typo before).</p>\n\n<p><em>UPDATE</em></p>\n\n<p>One follow up question I have - is there a way to add fine grained debugging information to the go build calls which lead to the go get <code>fetching</code> of repositories?  Ultimately, that is at the crux of the issue Im having. </p>\n"}, {"tags": ["if-statement", "go", "conditional-statements", "go-templates", "go-html-template"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1572968426, "post_id": 58714709, "comment_id": 103722697, "body": "What does &quot;But this does not seem to work&quot; mean?"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1572968700, "post_id": 58714709, "comment_id": 103722870, "body": "What you said did not work should work. What did it do?"}, {"owner": {"reputation": 25, "user_id": 7393681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff443c258f65507a9f81f47e54d282c?s=128&d=identicon&r=PG&f=1", "display_name": "Fradifrad", "link": "https://stackoverflow.com/users/7393681/fradifrad"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1572968715, "post_id": 58714709, "comment_id": 103722886, "body": "@Peter my condition is true, but once compiled, my html only displays &lt;a href&gt;"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1572969818, "post_id": 58714709, "comment_id": 103723554, "body": "Based on that output, <code>AppCtx.Link</code> is nil or empty"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1572969883, "post_id": 58714709, "comment_id": 103723597, "body": "<a href=\"https://play.golang.com/p/_Q-3VAhHn45\" rel=\"nofollow noreferrer\">play.golang.com/p/_Q-3VAhHn45</a>"}, {"owner": {"reputation": 25, "user_id": 7393681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff443c258f65507a9f81f47e54d282c?s=128&d=identicon&r=PG&f=1", "display_name": "Fradifrad", "link": "https://stackoverflow.com/users/7393681/fradifrad"}, "edited": false, "score": 0, "creation_date": 1572970973, "post_id": 58714709, "comment_id": 103724229, "body": "Ok, thanks a lot ! The issue must be somewhere else ; I&#39;m looking into it. Now I know my syntax in gohtml is not the issue :)"}], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 2525739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d6a56ce774bbe115f5ee92a856bf58?s=128&d=identicon&r=PG", "display_name": "dragunfli", "link": "https://stackoverflow.com/users/2525739/dragunfli"}, "is_accepted": false, "score": 0, "last_activity_date": 1572973203, "creation_date": 1572973203, "answer_id": 58716108, "question_id": 58714709, "link": "https://stackoverflow.com/questions/58714709/how-can-i-inject-a-if-statement-in-an-html-attribute/58716108#58716108", "title": "How can I inject a if statement in an HTML attribute?", "body": "<p>Did you mean to do this instead?</p>\n\n<pre><code>&lt;a href=\"{{ if .AppCtx.Title}}{{.AppCtx.Title}} {{end}}\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7393681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff443c258f65507a9f81f47e54d282c?s=128&d=identicon&r=PG&f=1", "display_name": "Fradifrad", "link": "https://stackoverflow.com/users/7393681/fradifrad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572977415, "creation_date": 1572968299, "last_edit_date": 1572977415, "question_id": 58714709, "link": "https://stackoverflow.com/questions/58714709/how-can-i-inject-a-if-statement-in-an-html-attribute", "title": "How can I inject a if statement in an HTML attribute?", "body": "<p>I'm trying to create a go html (Go 1.13) <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">with a context</a> {{.}}.</p>\n\n<p>I've managed to display context variables as div values, but I can't find the right way to put context variables inside HTML attributes.</p>\n\n<p>For instance, this code works:</p>\n\n<pre><code>{{ if .AppCtx.Title }} \n&lt;a href=\"/\"&gt;{{ .AppCtx.Title }}&lt;/a&gt;\n{{end}}\n</code></pre>\n\n<p>But this does not seem to work :</p>\n\n<pre><code>&lt;a href=\"{{ if .AppCtx.Link }}{{.AppCtx.Link}} {{end}}\"&gt;\n</code></pre>\n\n<p>I' ve tried different syntaxes :</p>\n\n<ul>\n<li>single quotes :</li>\n</ul>\n\n<pre><code>&lt;a href='{{ if .AppCtx.Link }}{{.AppCtx.Link}} {{end}}'&gt;\n</code></pre>\n\n<ul>\n<li>double quotes in front of the conditional statement:</li>\n</ul>\n\n<pre><code>&lt;a href=\"\"{{ if .AppCtx.Link }}{{.AppCtx.Link}} {{end}}&gt;\n</code></pre>\n\n<ul>\n<li>double quotes around :</li>\n</ul>\n\n<pre><code>&lt;a href=\"{{ if .AppCtx.Link }}{{.AppCtx.Link}} {{end}}\"&gt;\n</code></pre>\n\n<p>I've read <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/html/template/</a> but didn't find any clue in it. </p>\n"}, {"tags": ["go", "google-cloud-platform", "redis", "google-compute-engine"], "comments": [{"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 1, "creation_date": 1572969170, "post_id": 58714429, "comment_id": 103723161, "body": "Redis is at <code>10.169.12.195:6379</code> and you are trying to connect to <code>10.0.0.27 6379</code>?"}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1572974129, "post_id": 58714429, "comment_id": 103725871, "body": "No I try to connect at the given IP. However, <code>telnet 10.0.0.27 6379</code> in the given link doesn&#39;t work for me and I don&#39;t get why"}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1572974560, "post_id": 58714429, "comment_id": 103726063, "body": "Why would you expect it to work on <code>10.0.0.27</code>? Do you have a redis service on that IP address?"}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1572974668, "post_id": 58714429, "comment_id": 103726127, "body": "I don\u2019t really expect it to work, it\u2019s just that, in order to test a simple ping, the documentation is using that IP and when I do, it doesn\u2019t work. My service does work if I put the IP of the instance, I can ping as well. However, the given address from the doc doesn\u2019t work and I am not understanding why.. sorry if it\u2019s something stupid but I don\u2019t get it"}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1572974826, "post_id": 58714429, "comment_id": 103726187, "body": "The address in the documentation is an example. You need to modify to match your environment/configuration."}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1572974898, "post_id": 58714429, "comment_id": 103726221, "body": "Wooow alright I thought it was just a simple \u201cIP mapping\u201d or a default configuration of the machine.. thanks for your answer ! If you post an answer I will validate it then, so stupid I am !"}], "answers": [{"comments": [{"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "edited": false, "score": 0, "creation_date": 1572975156, "post_id": 58716587, "comment_id": 103726350, "body": "Thanks for your answer John !"}], "tags": [], "owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "is_accepted": true, "score": 2, "last_activity_date": 1572975114, "creation_date": 1572975114, "answer_id": 58716587, "question_id": 58714429, "link": "https://stackoverflow.com/questions/58714429/gcp-memorystore-unaccessible-from-compute-engine-on-same-region/58716587#58716587", "title": "GCP MemoryStore unaccessible from Compute Engine on same region", "body": "<p>The documentation specifies the command <code>telnet 10.0.0.27 6379</code>. This is an example that you need to modify for your environment.</p>\n\n<p>Change the command to:</p>\n\n<pre><code>telnet 10.169.12.195 6379\n</code></pre>\n"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58716587, "answer_count": 1, "score": 0, "last_activity_date": 1572975114, "creation_date": 1572967267, "question_id": 58714429, "link": "https://stackoverflow.com/questions/58714429/gcp-memorystore-unaccessible-from-compute-engine-on-same-region", "title": "GCP MemoryStore unaccessible from Compute Engine on same region", "body": "<p>I followed the two following tutorials:</p>\n\n<ul>\n<li><a href=\"https://cloud.google.com/go/docs/tutorials/bookshelf-on-compute-engine\" rel=\"nofollow noreferrer\">https://cloud.google.com/go/docs/tutorials/bookshelf-on-compute-engine</a></li>\n<li><a href=\"https://cloud.google.com/memorystore/docs/redis/creating-managing-instances?authuser=1\" rel=\"nofollow noreferrer\">https://cloud.google.com/memorystore/docs/redis/creating-managing-instances?authuser=1</a></li>\n</ul>\n\n<p>The only thing I did different is that I deployed the code of Redis from the second tutorial, not from the first link.</p>\n\n<p>As mentioned <a href=\"https://cloud.google.com/memorystore/docs/redis/connecting-redis-instance\" rel=\"nofollow noreferrer\">\"Connecting to a Redis instance\"</a> <code>You can connect to the Redis instance from any Compute Engine VM instance located within the same project, region and network as the Redis instance.</code></p>\n\n<blockquote>\n  <p>my-service: <em>10.162.0.17 (nic0)</em></p>\n  \n  <p>redis: <em>10.169.12.195:6379</em></p>\n  \n  <p>Same project, same region, same zone (a)</p>\n</blockquote>\n\n<p>However, when I do:</p>\n\n<pre><code>user@my-service:~$ telnet 10.0.0.27 6379\nTrying 10.0.0.27...\n</code></pre>\n\n<p>Nothing happens..</p>\n"}, {"tags": ["go", "module"], "comments": [{"owner": {"reputation": 1437, "user_id": 4038702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/364QK.jpg?s=128&g=1", "display_name": "Pandelis", "link": "https://stackoverflow.com/users/4038702/pandelis"}, "edited": false, "score": 0, "creation_date": 1572965864, "post_id": 58713903, "comment_id": 103721127, "body": "you might need to run <code>go mod verify</code> in the directory before go build"}, {"owner": {"reputation": 1, "user_id": 12326726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/171689400cebb1663b38484b1deee7bf?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/12326726/sandy"}, "reply_to_user": {"reputation": 1437, "user_id": 4038702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/364QK.jpg?s=128&g=1", "display_name": "Pandelis", "link": "https://stackoverflow.com/users/4038702/pandelis"}, "edited": false, "score": 0, "creation_date": 1572971294, "post_id": 58713903, "comment_id": 103724418, "body": "Thanks for the suggestion. If I run &#39;go mod verify&#39;, then it reports <code>all modules verified</code>. But <code>go build .</code> still fails."}, {"owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "edited": false, "score": 0, "creation_date": 1584041647, "post_id": 58713903, "comment_id": 107322676, "body": "What is the exact error message you&#39;re getting, ideally using Go 1.14?"}], "owner": {"reputation": 1, "user_id": 12326726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/171689400cebb1663b38484b1deee7bf?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/12326726/sandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572965525, "creation_date": 1572965525, "question_id": 58713903, "link": "https://stackoverflow.com/questions/58713903/cant-find-package-problem-with-go-modules-and-golang-1-13-4", "title": "Can&#39;t find package problem with Go modules and Golang 1.13.4", "body": "<p>I am migrating to using Go modules with Go v1.13.4, and have hit a weird problem with importing packages from a local private repository.</p>\n\n<p>The project structure consists of two library modules, each of which has its own Git repository in our company Gitea server.</p>\n\n<pre><code>mycompany.com\n\u251c\u2500\u2500 libraryA\n\u251c\u2500\u2500 \u251c\u2500\u2500 go.mod\n\u251c\u2500\u2500 \u251c\u2500\u2500 various .go files\n\u251c\u2500\u2500 libraryB\n\u251c\u2500\u2500 \u251c\u2500\u2500 go.mod\n\u251c\u2500\u2500 \u251c\u2500\u2500 various .go files\n\u251c\u2500\u2500 \u251c\u2500\u2500 test\n\u251c\u2500\u2500 \u251c\u2500\u2500 \u251c\u2500\u2500 main.go\n\u251c\u2500\u2500 applicationC\n\u251c\u2500\u2500 \u251c\u2500\u2500 go.mod\n\u251c\u2500\u2500 \u251c\u2500\u2500 various .go files\n</code></pre>\n\n<p>Library B makes use of features in library A, and so imports library A.\nApplication C makes use of both library A and library B</p>\n\n<p>I have set GOPRIVATE=mycompany.com, and enabled an authentication helper, so that the Go tools can correctly extract packages from the private Gitea server, while still pulling public packages from GitHub and so on.</p>\n\n<p>The symptoms are as follows:</p>\n\n<ol>\n<li>Typing \"go build .\" and \"go test .\" in root of library A both work fine.</li>\n<li>Typing \"go test .\" in root of library B works fine</li>\n<li>Typing \"go build .\" in test sub-folder of library B works fine</li>\n<li>Typing \"go build .\" in root of application C works fine</li>\n<li><p>Typing \"go build .\" in root library B FAILS with an error message , saying \"cannot find package\" at every point where library B Go files attempt to import library A via</p>\n\n<p>import \"mycompany.com/libraryA</p></li>\n</ol>\n\n<p>What's weird is that identical import statements in Go files that are part of the test package(ie with a _test suffix), or in application C work fine.</p>\n\n<p>Any suggestions as to what is going on??</p>\n\n<p>Thanks\nSandy</p>\n"}, {"tags": ["go", "ethereum", "solidity", "go-ethereum"], "answers": [{"tags": [], "owner": {"reputation": 1995, "user_id": 6303364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QpkwE.jpg?s=128&g=1", "display_name": "TBouder", "link": "https://stackoverflow.com/users/6303364/tbouder"}, "is_accepted": true, "score": 0, "last_activity_date": 1572978741, "last_edit_date": 1572978741, "creation_date": 1572978418, "answer_id": 58717362, "question_id": 58711371, "link": "https://stackoverflow.com/questions/58711371/how-to-get-the-result-and-the-status-of-a-transaction/58717362#58717362", "title": "How to get the result and the status of a transaction", "body": "<p>I didn't found any way to subscribe to a specific status change for a transaction, but a workaround :<br>\nThe <code>go-ethereum</code> package provides 2 functions <code>SubscribeFilterLogs</code> and <code>SubscribeNewHead</code>. We can use the first one to get the logs (if relevant) and the second one to get a block information :</p>\n\n<blockquote>\n  <p>SubscribeNewHead subscribes to notifications about the current\n  blockchain head on the given channel.</p>\n</blockquote>\n\n<p>A transaction can be validated or rejected/reverted when a block is mined, so we can use this 'trick' </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func checkTransactionReceipt(_txHash string) int {\n    client, _ := getClient(\"https://ropsten.infura.io/v3/XXXXXX\")\n    txHash := common.HexToHash(_txHash)\n    tx, err := client.TransactionReceipt(context.Background(), txHash)\n    if (Error.HasError(err)) {\n        return (-1)\n    }\n    return (int(tx.Status))\n}\n\nfunc    WaitForBlockCompletation(data EthData, hashToRead string) int {\n    soc := make(chan *types.Header)\n    sub, err := data.WssClient.SubscribeNewHead(context.Background(), soc)\n    if (err != nil) {\n        return -1\n    }\n\n    for {\n        select {\n            case err := &lt;-sub.Err():\n                _ = err\n                return -1\n            case header := &lt;-soc:\n                logs.Info(header.TxHash.Hex())\n                transactionStatus := checkTransactionReceipt(hashToRead)\n                if (transactionStatus == 0) {\n                    //FAILURE\n                    sub.Unsubscribe()\n                    return 0\n                } else if (transactionStatus == 1) {\n                    //SUCCESS\n                    sub.Unsubscribe()\n                    return 1\n                }\n        }\n    }\n}\n</code></pre>\n\n<p>Basically we are waiting for the block to be mined, then we check the <code>TransactionReceipt</code> which fail with an error (<code>not found</code>) if the transaction is not yet validated/rejected. Then, if the transaction is, we can unsubscribe the subscription and return the transaction status (0 fail, 1 success).</p>\n\n<p>Not sure if it's the worst, best, only method, but it's working ! Be free to improve this solution !</p>\n"}], "owner": {"reputation": 1995, "user_id": 6303364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QpkwE.jpg?s=128&g=1", "display_name": "TBouder", "link": "https://stackoverflow.com/users/6303364/tbouder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1563, "favorite_count": 0, "accepted_answer_id": 58717362, "answer_count": 1, "score": 0, "last_activity_date": 1572978741, "creation_date": 1572956902, "last_edit_date": 1572965580, "question_id": 58711371, "link": "https://stackoverflow.com/questions/58711371/how-to-get-the-result-and-the-status-of-a-transaction", "title": "How to get the result and the status of a transaction", "body": "<p>I am trying to work with the Ethereum blockchain, with the Solidity contracts.\nI am currently deploying a contract and performing some actions on it, but I would like to know how to get some 'feedback/callback/returns' of a specific transaction.</p>\n\n<p>Is there a way to set the status of a transaction to 0 (error) and still get events, for example ?</p>\n\n<pre><code>if (id.length &lt;= 0) {\n    emit Result(\"KO\", \"1\");\n    revert();\n} \n</code></pre>\n\n<p>This will not work (no event) because I revert everything, but the status will be set to 0</p>\n\n<pre><code>if (id.length &lt;= 0) {\n    emit Result(\"KO\", \"1\");\n    return;\n} \n</code></pre>\n\n<p>I will get some event, but the status will stay 1</p>\n\n<pre><code>if (id.length &lt;= 0) {\n    revert(\"KO_1\");\n} \n</code></pre>\n\n<p>The status will be 0, but I will not have any event</p>\n\n<p>Here is my go code to perform the action :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func    testFunction(id []byte) {\n    //...\n    //...\n    tx, err := instance.Action(opt, id)\n    if (errors.HasError(err)) {\n        return\n    }\n    callbackValue := subscribeToContract(tx.Hash().Hex())\n    logs.Pretty(tx, callbackValue)\n    //...\n    //...\n}\n\nfunc    subscribeToContract(hashToRead string) myStruct {\n    query := ethereum.FilterQuery{\n        Addresses: []common.Address{address},\n    }\n    soc := make(chan types.Log)\n\n    sub, err := WssClient.SubscribeFilterLogs(context.Background(), query, soc)\n    if err != nil {\n        logs.Error(err)\n    }\n\n    for {\n        select {\n        case err := &lt;-sub.Err():\n            logs.Info(`SOMETHING ERROR`)\n            logs.Error(err)\n        case vLog := &lt;-soc:\n        logs.Info(`SOMETHING`)\n        contractAbi, _ := abi.JSON(strings.NewReader(string(SignABI)))  \n        event := myStruct{}\n    contractAbi.Unpack(&amp;event, \"Result\", vLog.Data)\n    logs.Info(`New Event from [` + vLog.TxHash.Hex() + `] : ` + event.Message)\n        }\n    }\n}\n\n</code></pre>\n\n<p>If <code>id.length &gt; 0</code>, all good.\nBut if <code>id.length &lt;= 0</code>, I have no callback from the <code>subscribeToContract</code> function.</p>\n\n<p>Is there a way to directly have the result status, or should loop with <code>tx, err := client.TransactionReceipt(context.Background(), txHash)</code> until I get a Status?</p>\n"}, {"tags": ["go", "plugins"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1572956603, "post_id": 58711111, "comment_id": 103716154, "body": "What is the reason for the &quot;without requiring the monitored program to include the monitoring code&quot; requirement?"}, {"owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572956948, "post_id": 58711111, "comment_id": 103716304, "body": "Because I want this to be a standalone program + so plugin that doesn&#39;t require a rebuild of the binary-to-be-monitored (so that I can check already deployed apps)."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1572958836, "post_id": 58711111, "comment_id": 103717238, "body": "You&#39;re saying <code>I wouldn&#39;t need to rebuild the server binary to add this functionality</code> which implies you&#39;re just using the binary as-is. That leaves you with running a completely separate process on its own. It&#39;s just another job running on your machine, how you do that depends on your orchestration."}, {"owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "edited": false, "score": 0, "creation_date": 1572959414, "post_id": 58711111, "comment_id": 103717534, "body": "I&#39;m talking about making a Go executable <code>monitor</code>, with which I can monitor a Go executable <code>server</code> by calling <code>.&#47;monitor -exepath=.&#47;server</code>. <code>monitor</code> forks and launches (or execs or whatever) <code>server</code>, injects code into it to load the <code>monitor.so</code> plugin, whose <code>init()</code> function starts a monitoring goroutine. Then the server continues running and doing its thing, while the monitoring goroutine monitors it from the inside and reports from time to time."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572959799, "post_id": 58711111, "comment_id": 103717718, "body": "What kinds of things do you hope to monitor here? Any meaningful monitoring I can think of, other than just a ping to see if the process is up, will require a lot more than loading a plugin. In other words, you&#39;ll have to re-compile with monitoring support anyway. All that can go in a plugin is the communication protocol to talk to the other process."}, {"owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "edited": false, "score": 0, "creation_date": 1572959946, "post_id": 58711111, "comment_id": 103717809, "body": "It doesn&#39;t matter what I want to monitor. There are tons of things that you can only activate/see from within a process. Once the plugin loads and executes, you&#39;re only limited by what code you&#39;ve put in the plugin. My question is <b>HOW</b> to do it, not <b>WHETHER</b> I should do it. Comments to the latter are off-topic."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1572961068, "post_id": 58711111, "comment_id": 103718363, "body": "This looks like an XY Problem. Asking about why you&#39;re doing something that seems off is almost always on-topic, when it comes to helping solve the problem."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572961164, "post_id": 58711111, "comment_id": 103718405, "body": "&quot;There are tons of things that you can only activate/see from within a process&quot; Yes, no doubt. But the vast majority of these things are so lightweight to monitor, that there&#39;s no reason to bother with the overhead and complexity of plugins. Just add 2kb to your executable. The other things that are interesting, which would add enough overhead not to want to re-compile, probably require instrumentation to be present throughout the code, making a plugin worthless."}, {"owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "edited": false, "score": 1, "creation_date": 1572962007, "post_id": 58711111, "comment_id": 103718883, "body": "Ugh this is why SO can be so infuriating. If anyone knowledgeable about Go&#39;s internals would like to chime in, I&#39;m hoping to build something along similar lines to SystemTap <a href=\"https://developers.redhat.com/blog/2019/07/24/probing-golang-runtime-using-systemtap\" rel=\"nofollow noreferrer\">developers.redhat.com/blog/2019/07/24/&hellip;</a> but obviously MUCH more simple (as in: launch a Go app, force it to load a plugin, end of story)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1572962564, "post_id": 58711111, "comment_id": 103719188, "body": "Actually what Flimzy wrote is handy. It tells even they didn&#39;t find any workaround other than modifying the standard lib, which must be used to build the app (not the original standard lib)."}, {"owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "edited": false, "score": 0, "creation_date": 1572963111, "post_id": 58711111, "comment_id": 103719506, "body": "Actually, what Flimzy wrote is wrong. SystemTap doesn&#39;t modify the standard lib. Everything is done at runtime, with no modification to any files required. That&#39;s the whole point. PTrace exists for runtime monitoring and modification. I only want to know the best way to use the Go interface to ptrace or whatever other low-level API, for the purpose of injecting code, and how to do it as safely as possible."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1572963374, "post_id": 58711111, "comment_id": 103719671, "body": "Oh I see now. It injects code at that location at runtime. That&#39;s clever. But doesn&#39;t help with your goal of loading a go plugin. SystemTap is operating at a layer beneath the Go runtime. You need something that integrates with the Go runtime."}, {"owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "edited": false, "score": 1, "creation_date": 1572963690, "post_id": 58711111, "comment_id": 103719896, "body": "... thus my original question. I have all the basic research done for how to do this (spread across 15 blog posts), but I&#39;m looking for an expert who can guide me in the safest approach to take."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1572963721, "post_id": 58711111, "comment_id": 103719912, "body": "What you&#39;re attempting is not supported by Go. This probably means there are no experts who can guide you, because nobody&#39;s ever done it before."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1572965701, "post_id": 58711111, "comment_id": 103721044, "body": "A program will only load a plugin if it is written to load a plugin. You&#39;ll have to modify and recompile the program, period."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1572979099, "post_id": 58711111, "comment_id": 103728058, "body": "@Karl: There&#39;s no way to do this &quot;safely&quot;, as &quot;safe&quot; implies working within the language specification, which doesn&#39;t cover this use case. Most of the people who work on Go don&#39;t frequent this site, and you&#39;re more likely to find someone on the mailing list who can direct you through a specific implementation of Go&#39;s linking, calling conventions, memory layout, initialization routines, etc."}], "answers": [{"comments": [{"owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "edited": false, "score": 0, "creation_date": 1572962652, "post_id": 58712561, "comment_id": 103719239, "body": "The linux kernel includes things such as uprobe, and Go has APIs for ptrace. There are ways to inject code into a running Go process, and I&#39;m in the process of researching how to do it, but I&#39;d be a lot happier hearing from someone knowledgeable on the subject who can offer best practices for Go, since there are a lot of ways to go about this, ranging from live patching to trampolines to syscall interception, CPU register modification, etc."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "edited": false, "score": 1, "creation_date": 1572962834, "post_id": 58712561, "comment_id": 103719324, "body": "@Karl Those seem waaaaay more harder than the hassle of having to rebuild the app with importing your lib. Unless you don&#39;t have its sources."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1572961202, "creation_date": 1572961202, "answer_id": 58712561, "question_id": 58711111, "link": "https://stackoverflow.com/questions/58711111/how-do-i-force-a-go-subprocess-to-load-a-plugin/58712561#58712561", "title": "How do I force a go subprocess to load a plugin?", "body": "<p>An already built Go app does not support loading \"predefined\" or other plugins by default. You have to alter the app, you have to <em>make</em> it search for or expect the plugin to be loaded.</p>\n\n<p>While something like this would easily be possible if the go tool would generate a binary that would look for a \"default.so\" plugin or a command line flag like <code>-autoload=pluginname</code>, but this is not the case.</p>\n\n<p>Most libraries solve this by requiring the app to import them, which launches whatever monitoring process they desire. Which is fine for most uses.</p>\n"}], "owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1572961202, "creation_date": 1572955935, "last_edit_date": 1572956519, "question_id": 58711111, "link": "https://stackoverflow.com/questions/58711111/how-do-i-force-a-go-subprocess-to-load-a-plugin", "title": "How do I force a go subprocess to load a plugin?", "body": "<p>I'd like to write a small Go program that monitors another Go program, reporting periodic telemetry about it. However, I want to do this without requiring the monitored program to include the monitoring code, or to explicitly load the monitoring code.</p>\n\n<p>So for example, given the following amazing server program:</p>\n\n<p>server.go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    for {\n        fmt.Println(\"ping\")\n        time.Sleep(2 * time.Second)\n    }\n}\n</code></pre>\n\n<p>And the following awesome monitoring code, built as a plugin:</p>\n\n<p>monitor.go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc init() {\n    go func() {\n        for {\n            fmt.Println(\"doing monitoring stuff...\")\n            time.Sleep(1 * time.Second)\n        }\n    }()\n}\n\n</code></pre>\n\n<p>I want to launch the server binary via an <code>exec</code> call or whatever, force the server's process to load <code>monitor.so</code> as a plugin (which runs the monitor's <code>init()</code> function), after which the server carries on doing what it would normally do as if nothing had happened.</p>\n\n<p>The end result would be that <code>server</code> is still doing its regular ping thing, but there's also a running goroutine doing the monitoring when launched via my little program. The server didn't need to know about monitor at all when it was being built from source (i.e. I wouldn't need to rebuild the server binary to add this functionality).</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>How would I do this in Go (so that I can run it in a debug env at the very least, even if it's a little flaky)?</p></li>\n<li><p>How would I do this <strong>SAFELY</strong> in Go (so that I can run it in a production env without launching all nukes)?</p></li>\n</ol>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1572952265, "post_id": 58710055, "comment_id": 103714023, "body": "Please redo the whole tour once more: <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour.golang.org/welcome/1</a>"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1572953235, "post_id": 58710055, "comment_id": 103714502, "body": "usersmap is a type, not a value. Perhaps you meant <code>var usersmap map[string]UserProfile</code>?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572965889, "post_id": 58710055, "comment_id": 103721144, "body": "&quot;I am trying to dereference a channel&quot; - no you&#39;re not. I&#39;m not sure what you&#39;re actually trying to do, but &quot;dereference a channel&quot; isn&#39;t a thing that exists."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1572953141, "creation_date": 1572953141, "answer_id": 58710364, "question_id": 58710055, "link": "https://stackoverflow.com/questions/58710055/deferencing-type-maps/58710364#58710364", "title": "Deferencing type maps", "body": "<pre><code>type usersmap map[string]UserProfile\n</code></pre>\n\n<p>This is a <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">type declaration</a>, it does not create a variable named <code>usersmap</code>. After this type declaration you may use the <code>usersmap</code> (type) identifier to create a variable like this:</p>\n\n<pre><code>var umap usersmap\n</code></pre>\n\n<p>And to initialize it:</p>\n\n<pre><code>umap = make(usersmap)\n</code></pre>\n\n<p>Or in one line:</p>\n\n<pre><code>var umap = make(usersmap)\n</code></pre>\n\n<p>Or using a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a> with initialization: </p>\n\n<pre><code>umap := usersmap{}\n</code></pre>\n\n<p>Also to create a variable of map type you don't necessarily have to create a new type, you may simply write:</p>\n\n<pre><code>var umap = make(map[string]UserProfile)\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 1200717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd940f107d3250db3be83a29fffd2da2?s=128&d=identicon&r=PG", "display_name": "chandra", "link": "https://stackoverflow.com/users/1200717/chandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573043235, "creation_date": 1572952029, "last_edit_date": 1573043235, "question_id": 58710055, "link": "https://stackoverflow.com/questions/58710055/deferencing-type-maps", "title": "Deferencing type maps", "body": "<p>I am trying to dereference a channel and use the payload in the channel to check if there is an entry in the map or not.</p>\n\n<p>If the map is of not type it works but if the map has a type I always get the error that type <code>&lt;map&gt;</code> is not an expression. </p>\n\n<pre><code>type writechan chan UserProfile\ntype usersmap map[string]UserProfile\nvar  myuserprofile UserProfile\nmyuserprofile = &lt;-myuserchannel\nvar username = myuserprofile.name\n\nif _, ok := usersmap[username]; ok {\n    fmt.Println(\"Already registered \")\n} else {\n    usersmap[username] = myuserprofile\n}\n</code></pre>\n\n<p>The error message says type usersmap is not an expression\" in the if line . If I don't use the type usermap but a normal map say map[string]string it works fine. </p>\n"}, {"tags": ["go", "command-line-interface"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1572951685, "post_id": 58709577, "comment_id": 103713728, "body": "<a href=\"https://golang.org/pkg/os/exec/#ExitError.Stderr\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec/#ExitError.Stderr</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1572951956, "post_id": 58709577, "comment_id": 103713857, "body": "Why not use golang.org/x/crypto/ssh directly?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572965980, "post_id": 58709577, "comment_id": 103721197, "body": "And if you&#39;re going to fork to ssh, why do it via <code>bash -c</code>?"}, {"owner": {"reputation": 1118, "user_id": 3768458, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6390ef247a24bb001452688ecb0c8010?s=128&d=identicon&r=PG&f=1", "display_name": "b-m-f", "link": "https://stackoverflow.com/users/3768458/b-m-f"}, "edited": false, "score": 0, "creation_date": 1572966705, "post_id": 58709577, "comment_id": 103721649, "body": "Using ssh from golang is unnecessary at this point. Id rather go with the battle proven version of my system. <code>bash -c</code> is used to make use of pipes for more complex commands."}], "answers": [{"tags": [], "owner": {"reputation": 4059, "user_id": 8763847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k2myi.png?s=128&g=1", "display_name": "sayboras", "link": "https://stackoverflow.com/users/8763847/sayboras"}, "is_accepted": false, "score": 2, "last_activity_date": 1572964933, "last_edit_date": 1572964933, "creation_date": 1572950588, "answer_id": 58709650, "question_id": 58709577, "link": "https://stackoverflow.com/questions/58709577/how-to-read-stdout-from-failed-command/58709650#58709650", "title": "How to read Stdout from failed command", "body": "<p>Please try to use <code>CombinedOutput</code> instead, as this will capture both stdout and stderr. Meanwhile, <code>Output</code> only returns stdout.</p>\n\n<p><a href=\"https://golang.org/pkg/os/exec/#Cmd.CombinedOutput\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/#Cmd.CombinedOutput</a></p>\n\n<p>If you want to still use Output, please cast the error to ExitError and check ExitError.Stderr as well.</p>\n\n<p><a href=\"https://golang.org/pkg/os/exec/#Cmd.Output\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/#Cmd.Output</a></p>\n"}], "owner": {"reputation": 1118, "user_id": 3768458, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6390ef247a24bb001452688ecb0c8010?s=128&d=identicon&r=PG&f=1", "display_name": "b-m-f", "link": "https://stackoverflow.com/users/3768458/b-m-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572964933, "creation_date": 1572950371, "last_edit_date": 1572952225, "question_id": 58709577, "link": "https://stackoverflow.com/questions/58709577/how-to-read-stdout-from-failed-command", "title": "How to read Stdout from failed command", "body": "<p>I have the following code to check if an SSH connection to a given host is working.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func IsSSHConnectionWorking(Host Host) bool {\n    cmd :=\n        fmt.Sprintf(\"ssh -o \\\"PasswordAuthentication no\\\" -i %s -p %s %s@%s\", Host.IdentityFile, Host.Port, Host.User, Host.IP)\n\n    fmt.Printf(\"Connecting to %s with %s\", Host.IP, cmd)\n\n    output, err := exec.Command(\"bash\", \"-c\", cmd).Output()\n\n    if err != nil {\n        log.Println(err)\n        log.Printf(\"Failed to connect to Host: %s\\n Error: %s\", Host.IP, output)\n        return false\n    }\n\n    return true\n}\n</code></pre>\n\n<p>I have noted though that should a parameter be wrong, the err that is returned back into the program is <code>exit status 255</code> and the output is empty.</p>\n\n<p>Executing a problematic command on the CLI itself will return <code>user@host: Permission denied (publickey,password).</code> </p>\n\n<p>Is there a way to capture this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12237173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a717fabb446b6409de90211fe424ff1b?s=128&d=identicon&r=PG&f=1", "display_name": "Skyfan", "link": "https://stackoverflow.com/users/12237173/skyfan"}, "edited": false, "score": 0, "creation_date": 1572953634, "post_id": 58710005, "comment_id": 103714701, "body": "Thank you for your answer. <code>printenv</code> does show that my GOPATH is set, but the problem is, as you pointed out, that I should use Go modules. The reason I tried not to use it is I am using depencies that don&#39;t exist in github any more, so I need a static vendor."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1572952181, "last_edit_date": 1572952181, "creation_date": 1572951846, "answer_id": 58710005, "question_id": 58709523, "link": "https://stackoverflow.com/questions/58709523/how-to-fix-gopath-not-set-error-when-using-go-build/58710005#58710005", "title": "How to fix &#39;GOPATH not set&#39; error when using go build", "body": "<p>This is all wrong.</p>\n\n<ol>\n<li><p><code>go env</code> does <strong>not</strong> work like <code>printenv</code>: It prints the values <em>used</em> which are values deliberately set or the default values. Your GOPATH is unset and <code>go env</code>prints the default.</p></li>\n<li><p>Never, literally <strong>NEVER</strong> set GOROOT. Never. GOROOT is for experts doing expert stuff. It is <em>never</em> needed to build, compile, test, whatnot normal Go code if you have a properly set up Go installation.</p></li>\n<li><p>Never do <code>sudo go whatever</code>. Sudo is not the magical make-it-work!! hammer.</p></li>\n<li><p>The README of govendor says: <strong>Use Go modules</strong>.</p></li>\n</ol>\n\n<p>Just stop trying to be clever. Install Go according to the official installation instructions, do not mess with GOROOT. Set or don't set GOPATH. If working in GOPATH-mode you <strong>must</strong> <code>go get</code> the dependencies yourself before compiling your code. Use Go modules.</p>\n"}], "owner": {"reputation": 21, "user_id": 12237173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a717fabb446b6409de90211fe424ff1b?s=128&d=identicon&r=PG&f=1", "display_name": "Skyfan", "link": "https://stackoverflow.com/users/12237173/skyfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572952181, "creation_date": 1572950194, "question_id": 58709523, "link": "https://stackoverflow.com/questions/58709523/how-to-fix-gopath-not-set-error-when-using-go-build", "title": "How to fix &#39;GOPATH not set&#39; error when using go build", "body": "<p>I am trying to build some go project. Running <code>go build</code> from the project directory returns following error:</p>\n\n<pre><code>../../../github.com/getsentry/sentry-go/integrations.go:4:2: cannot find package \"bufio\" in any of:\n    /home/user/go/src/bufio (from $GOROOT)\n    ($GOPATH not set. For more details see: 'go help gopath')\nvendor/github.com/getsentry/raven-go/client.go:5:2: cannot find package \"bytes\" in any of:\n    /home/user/go/src/gitlab.com/company/bc_to_influx/vendor/bytes (vendor tree)\n    /home/user/go/src/bytes (from $GOROOT)\n    ($GOPATH not set. For more details see: 'go help gopath')\nvendor/github.com/getsentry/raven-go/client.go:6:2: cannot find package \"compress/zlib\" in any of:\n    /home/user/go/src/gitlab.com/company/bc_to_influx/vendor/compress/zlib (vendor tree)\n    /home/user/go/src/compress/zlib (from $GOROOT)\n    ($GOPATH not set. For more details see: 'go help gopath')\n../../../github.com/getsentry/sentry-go/client.go:4:2: cannot find package \"context\" in any of:\n    /home/user/go/src/context (from $GOROOT)\n    ($GOPATH not set. For more details see: 'go help gopath')\nvendor/github.com/getsentry/raven-go/client.go:7:2: cannot find package \"crypto/rand\" in any of:\n    /home/user/go/src/gitlab.com/company/bc_to_influx/vendor/crypto/rand (vendor tree)\n    /home/user/go/src/crypto/rand (from $GOROOT)\n    ($GOPATH not set. For more details see: 'go help gopath')\n</code></pre>\n\n<p>and so on for the various packages required by the project.\nThere are many issues that arise:</p>\n\n<ul>\n<li><p>GOPATH is declared as 'not set', whereas it is actually set to \"/home/user/go\", as I could see by running <code>go env</code> (btw, GOROOT is set to \"/home/user/go\", which I believe may cause some trouble as I've understood GOPATH and GOROOT should be different)</p></li>\n<li><p>go seems to look for packages such as bufio for example in \"/home/user/go/src/bufio\" whereas I would like it to search in \"/home/user/go/src/github.com/bufio\"</p></li>\n</ul>\n\n<p>A workaround is to use <code>sudo go build</code>, which works fine, but I'd like to properly fix the issue. For root user, GOPATH is set to \"/root/go\" and GOROOT is set to \"/snap/go/4762\".</p>\n\n<p>I am using govendor, and GO111MODULE is set to off.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572966232, "post_id": 58707571, "comment_id": 103721346, "body": "If you don&#39;t rebuild, you&#39;re calling the binary built with the old code. Changing source has no impact on the binary until you rebuild it."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1572964580, "last_edit_date": 1572964580, "creation_date": 1572944839, "answer_id": 58707842, "question_id": 58707571, "link": "https://stackoverflow.com/questions/58707571/how-to-clear-the-execution-cache-in-go/58707842#58707842", "title": "How to clear the execution cache in go", "body": "<p>Go is a <a href=\"https://en.wikipedia.org/wiki/Compiled_language\" rel=\"nofollow noreferrer\">compiled language</a>. When you run <code>go build</code>, it will compile your sources and create an executable binary. This is what you run when executing <code>./main doSomething1</code>.</p>\n\n<p>When you change your sources and run <code>./main doSomething1</code>, you are not compiling again, you just run the previously built (and unchanged) binary.</p>\n\n<p>To quickly test changes, use <code>go run</code> instead:</p>\n\n<pre><code>go run main.go doSomething1\n</code></pre>\n\n<p>That will always compile your sources, build a binary in a temporary folder, launch it and clear it once your app exits.</p>\n\n<p>For details, see <a href=\"https://stackoverflow.com/questions/30612611/what-does-go-build-build\">What does go build build?</a></p>\n"}], "owner": {"reputation": 2314, "user_id": 9768260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604c85a549d2603e8119880c100b5aae?s=128&d=identicon&r=PG", "display_name": "ccd", "link": "https://stackoverflow.com/users/9768260/ccd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 58707842, "answer_count": 1, "score": -1, "last_activity_date": 1572964580, "creation_date": 1572943816, "question_id": 58707571, "link": "https://stackoverflow.com/questions/58707571/how-to-clear-the-execution-cache-in-go", "title": "How to clear the execution cache in go", "body": "<p>When I use flag package</p>\n\n<pre><code>// main.go\n\nimport (\n  ...\n  \"flag\"  \n)\n\nfunc main() {\n  ...\n  flag.Parse()\n\n  switch flag.Arg(0) {\n  case \"doSomething1\":\n    ...\n  case \"doSomething2\":\n    ...\n  }\n\n}\n</code></pre>\n\n<p>If doSomething1 argument print some error message for me, whatever I fix the source code, it can not remove the old error code and compile again.</p>\n\n<pre><code>// command-line\n\n# go build ./main.go\n# ./main doSomething1\n# error doSomething1 can not work\n\n-- I fix my code\n\n# ./main doSomething1\n# error doSomething1 can not work\n\n-- the error message also show me again\n-- I have to delete main and build again\n\n# rm ./main\n# go build ./main.go\n# ./main.go doSomething1\n# doSomething1 now can work\n</code></pre>\n"}, {"tags": ["database", "go", "testing", "integration-testing"], "comments": [{"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 3, "creation_date": 1572941497, "post_id": 58707005, "comment_id": 103708265, "body": "What have you tried so far?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572941992, "post_id": 58707005, "comment_id": 103708496, "body": "You can utilize <a href=\"https://golang.org/pkg/testing/#M\" rel=\"nofollow noreferrer\">TestMain</a> to initialize your db and load data into it."}, {"owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "reply_to_user": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1572952525, "post_id": 58707005, "comment_id": 103714143, "body": "@iLoveReflection I&#39;m at starting point to do that. Earlier I did mocks for such tasks. I sew some solutions: temp schema [1] <a href=\"https://hackernoon.com/integration-test-with-database-in-golang-355dc123fdc9\" rel=\"nofollow noreferrer\">hackernoon.com/&hellip;</a> and [2] <a href=\"https://medium.com/kongkow-it-medan/parallel-database-integration-test-on-go-application-8706b150ee2e\" rel=\"nofollow noreferrer\">medium.com/kongkow-it-medan/&hellip;</a>, and a solution with create/revert functions here [3] <a href=\"https://www.reddit.com/r/golang/comments/dmuxx8/test_with_database/\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/dmuxx8/test_with_database</a>"}, {"owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572954240, "post_id": 58707005, "comment_id": 103715032, "body": "@mkopriva But what approach to use at individual test? What if you need firt try Add, List, Update operations. And the List() would expect a predefined list."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572954614, "post_id": 58707005, "comment_id": 103715235, "body": "@Dr.eel if you want to test multiple queries that depend on each other then test them within a single test function, e.g. <code>TestAddAndList</code>..."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572954713, "post_id": 58707005, "comment_id": 103715288, "body": "@Dr.eel if you want to test queries separately, and you want to make sure that the data from one query does not conflict with the data from another query, then execute those queries in their own test functions and execute them within transactions."}, {"owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572956649, "post_id": 58707005, "comment_id": 103716177, "body": "@mkopriva this way thay won&#39;t be Parallel."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572956859, "post_id": 58707005, "comment_id": 103716276, "body": "@Dr.eel those that depend on each other should not be parallel, how else would you make sure that add is executed before list? Those that are separate and are executed in their own functions will be parallel, i mean its subject to how they are then executed by <code>go test</code> but since they are in their own test functions there&#39;s no synchronization between them."}, {"owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573018836, "post_id": 58707005, "comment_id": 103739321, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/201923/discussion-between-dr-eel-and-mkopriva\">continue this discussion in chat</a>."}], "owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1572942122, "answer_count": 0, "score": 0, "last_activity_date": 1572951998, "creation_date": 1572941439, "last_edit_date": 1572951998, "question_id": 58707005, "link": "https://stackoverflow.com/questions/58707005/an-integration-test-with-the-real-database", "closed_reason": "Duplicate", "title": "An integration test with the real database", "body": "<p>In my integration test, I want to check how my code works with a real database instance (Postgresql). I don't need to mock it. It has to be a real database.\nIt would be great if I can run test in parallel.\nMy code contains database transactions.</p>\n\n<p>To share the connection I've created a <code>db</code> package:</p>\n\n<pre><code>package db\n\nimport (\n    \"flag\"\n    \"fmt\"\n\n    \"github.com/jmoiron/sqlx\"\n)\n\nvar cachedDBConn *sqlx.DB\n\nfunc GetConnection(host string, port uint16, user string, password string, databaseName string) (*sqlx.DB, error) {\n    if cachedDBConn != nil {\n        return cachedDBConn, nil\n    }\n    dbConnStr := fmt.Sprintf(\"host=%s port=%d user=%s password=%s dbname=%s sslmode=disable\",\n        host, port, user, password, databaseName)\n    cachedDBConn, err := sqlx.Open(\"postgres\", dbConnStr)\n    if err != nil {\n        return nil, err\n    }\n    return cachedDBConn, nil\n}\n\n// allow to redefine connection settings for tests in CI\nvar (\n    dbHost     = flag.String(\"test.dbhost\", \"localhost\", \"Test Database host address\")\n    dbPort     = flag.Int(\"test.dbport\", 5432, \"Test Database port number\")\n    dbUser     = flag.String(\"test.dbuser\", \"ccm_test\", \"Test Database user name\")\n    dbPassword = flag.String(\"test.dbpass\", \"ccm_test\", \"Test Database user password\")\n    dbName     = flag.String(\"test.dbname\", \"ezan_ccm_test\", \"Test Database name\")\n)\n\n// MustGetTestConnection panics if can't create connection\nfunc MustGetTestConnection() (conn *sqlx.DB) {\n    db, err := GetConnection(*dbHost, uint16(*dbPort), *dbUser, *dbPassword, *dbName)\n    if err != nil {\n        panic(fmt.Sprintf(\"Failed to create DB connection: %v\", err))\n    }\n    return db\n}\n</code></pre>\n\n<p>I've already saw a solution with <a href=\"https://hackernoon.com/integration-test-with-database-in-golang-355dc123fdc9\" rel=\"nofollow noreferrer\">temp schema fo Postgres</a> and <a href=\"https://www.reddit.com/r/golang/comments/dmuxx8/test_with_database/\" rel=\"nofollow noreferrer\">a solution with revert fuction</a>  </p>\n\n<p><strong>What method is better to use respecting parallel run and transactions?</strong></p>\n"}, {"tags": ["string", "go", "tcp", "newline"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1572934501, "post_id": 58705245, "comment_id": 103705660, "body": "This does not work. You cannot have end-of-message strings and encryted ( and thus arbitrary) messages. Redesign!"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1572942554, "post_id": 58705245, "comment_id": 103708748, "body": "Since you think that you can give special meaning to any particular byte in a ciphertext this suggests that your IVs/nonces are not random bytes, else your assumption would have fallen apart right there. Consider using TLS for encryption. If the client doesn&#39;t care about the server&#39;s identity the server can just generate a certificate on start up and you still get good, correct encryption."}], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 4902496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9521a1df3945b0fa064cedcebe6278?s=128&d=identicon&r=PG&f=1", "display_name": "chopper24", "link": "https://stackoverflow.com/users/4902496/chopper24"}, "edited": false, "score": 0, "creation_date": 1572964399, "post_id": 58706195, "comment_id": 103720333, "body": "This works perfectly, and was very quick to implement, just adding encoding/decoding just before/after the encryption algorithm. This hit the nail on the head for this particular issue. Will mark this as the solution, many thanks. For the benefit of others, <a href=\"https://gobyexample.com/base64-encoding\" rel=\"nofollow noreferrer\">gobyexample.com/base64-encoding</a> and the wiki article for base64 were good starting points for me."}], "tags": [], "owner": {"reputation": 722, "user_id": 4671382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55c20cb0c0d8044ffc5866b179ac8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/4671382/cl%c3%a9ment"}, "is_accepted": true, "score": 0, "last_activity_date": 1572938765, "last_edit_date": 1572938765, "creation_date": 1572937993, "answer_id": 58706195, "question_id": 58705245, "link": "https://stackoverflow.com/questions/58705245/bufio-scanner-and-handling-new-lines/58706195#58706195", "title": "bufio scanner and handling new lines", "body": "<p>Your communication \"protocol\" (one line being one message, not quite a protocol) clearly cannot handle binary data. If you want to send text data in your protocol, you could convert your binary data to text, using a Base64 encoding for example. You would also need some semantics to indicate that some text was converted from binary.</p>\n\n<p>Or you could change your protocol to handle binary data natively. You could prepend the length of the binary data to follow, so that you know you have to read this data as binary and not interpret a newline character as the end of the message.</p>\n\n<p>There are many protocols doing this very well, perhaps you don't need to come up with your custom one. If you want to send text messages, HTTP is very simple to use, you could format your data as JSON, using Base64 to convert your binary data to text:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>{\n    \"command\": \"string\",\n    \"args\": [\n        \"binaryDataAsBase64\"\n    ]\n}\n</code></pre>\n"}], "owner": {"reputation": 70, "user_id": 4902496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9521a1df3945b0fa064cedcebe6278?s=128&d=identicon&r=PG&f=1", "display_name": "chopper24", "link": "https://stackoverflow.com/users/4902496/chopper24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 58706195, "answer_count": 1, "score": 0, "last_activity_date": 1572939998, "creation_date": 1572933160, "question_id": 58705245, "link": "https://stackoverflow.com/questions/58705245/bufio-scanner-and-handling-new-lines", "title": "bufio scanner and handling new lines", "body": "<p>I've got 2 processes communicating over TCP sockets. Side A sends a string to side B, which is sometimes encrypted using standard crypto/cipher package. The resulting string may include a new line character but Side B's bufio scanner is interpreting it as the end of the request. I want side B to continue accepting lines, append them and wait for a known end-of-command character before further processing it. Side B will return a response to Side A, so the connection remains open and therefore cannot use a close-connection event as a command delimiter.</p>\n\n<p>Everything is working fine for single-line commands, but these new line characters in the encrypted output cause issues (about 10% of the time).</p>\n\n<p>Side A will send in the following formats (the third is a legitimate example of a problem string I'm trying to process correctly):</p>\n\n<p>callCommand()</p>\n\n<p>callCommand(\"one\",\"two\",\"three\")</p>\n\n<p>callCommand(\"string\",\"encrypted-data-to-follow\",\"[7b\ufffd\ufffdCr\ufffd\ufffdl\ufffd\ufffdG\ufffd\ufffd\ufffdbH\ufffd@x\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd(z\ufffd$\ufffda\ufffd\ufffd0\ufffd\ufffd\u06a25Y7+\ufffd\ufffdU\ufffdQT\ufffd\u0390l\ufffdK\ufffd(\ufffdn\ufffdU\ufffd\ufffdJ\ufffd\ufffd\ufffd\ufffdQK\ufffdBX\ufffd+\ufffdl\\8H\ufffd\ufffd-g\ufffdy.\ufffd.\ufffd1\ufffdf\ufffd\ufffdI\ufffdC\ufffd\u0212\u3cff\ufffd\ufffd\ufffdo\ufffdxz\ufffd8?\ufffd\ufffdc\ufffde \ufffd\u0010\ufffdTb\ufffd\ufffd?4\ufffdhD\u000bW\ufffd\ufffd\ufffd\n\ufffd&lt;\ufffd\ufffd\ufffd\u0415\ufffdgc\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdN\ufffdV\ufffd\ufffd\ufffd\u06d3P8       \ufffd\ufffd\ufffd\ufffd\ufffdO3\")</p>\n\n<p>We can fairly reliably say the end-of-command keys are a close parentheses \")\" and a new line character.</p>\n\n<p>Side A's function to send to side B:</p>\n\n<pre><code>func writer(text string) string {\n    conn, err := net.Dial(\"tcp\", TCPdest)\n    t := time.Now()\n    if err != nil {\n        if _, t := err.(*net.OpError); t {\n            fmt.Println(\"Some problem connecting.\\r\\n\")\n        } else {\n            fmt.Println(\"Unknown error: \" + err.Error()+\"\\r\\n\")\n        }\n    } else {\n        conn.SetWriteDeadline(time.Now().Add(1 * time.Second))\n        _, err = conn.Write([]byte(text+\"\\r\\n\"))\n        if err != nil {\n            fmt.Println(\"Error writing to stream.\\r\\n\")\n        } else {\n            timeNow := time.Now()           \n            if timeNow.Sub(t.Add(time.Duration(5*time.Second))).Seconds() &gt; 5 {\n                return \"timeout\"\n            }\n            scanner := bufio.NewScanner(conn)\n            for {\n                ok := scanner.Scan()\n                if !ok {\n                    break\n                }\n                if strings.HasPrefix(scanner.Text(), \"callCommand(\") &amp;&amp; strings.HasSuffix(scanner.Text(), \")\") {\n                    conn.Close()\n                    return scanner.Text()\n                }\n            }\n        }\n    }\n    return \"unspecified error\"\n}\n</code></pre>\n\n<p>Side B's handling of incoming connections:</p>\n\n<pre><code>src := \"192.168.68.100:9000\"\nlistener, _ := net.Listen(\"tcp\", src)\n\ndefer listener.Close()\n\nfor {\n    conn, err := listener.Accept()\n    if err != nil {\n        fmt.Println(\"Some connection error: %s\\r\\n\", err)\n    }\n    go handleConnection(conn)\n}   \n\nfunc handleConnection(conn net.Conn) {\n    remoteAddr := conn.RemoteAddr().String()\n    fmt.Println(\"Client connected from \" + remoteAddr + \"\\r\\n\")\n\n    scanner := bufio.NewScanner(conn)\n    wholeString := \"\"\n    for {\n        ok := scanner.Scan()\n\n        if !ok {\n            break\n        }\n\n        //Trying to find the index of a new-line character, to help me understand how it's being processed\n        fmt.Println(strings.Index(scanner.Text(), \"\\n\"))\n        fmt.Println(strings.Index(wholeString, \"\\n\"))\n\n        //for the first line received, add it to wholeString\n        if len(wholeString) == 0 {\n            wholeString = scanner.Text()\n        }\n\n        re := regexp.MustCompile(`[a-zA-Z]+\\(.*\\)\\r?\\n?`)\n\n        if re.Match([]byte(wholeString)) {\n            fmt.Println(\"Matched command format\")\n            handleRequest(wholeString, conn)\n        } else if len(wholeString) &gt; 0 &amp;&amp; !re.Match([]byte(wholeString)) {\n            //Since we didn't match regex, we can assume there's a new-line mid string, so append to wholeString\n            wholeString += \"\\n\"+scanner.Text()\n        }\n\n    }\n    conn.Close()\n    fmt.Println(\"Client at \" + remoteAddr + \" disconnected.\\r\\n\")\n}\n\nfunc handleRequest(request string, conn net.Conn) {\n    fmt.Println(\"Received: \"+request)\n}\n</code></pre>\n\n<p>I'm not really sure this approach on Side B is correct but included my code above. I've seen a few implementations but a lot seem to rely on a close of connection to begin processing the request, which doesn't suit my scenario.</p>\n\n<p>Any pointers appreciated, thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1572934272, "post_id": 58705227, "comment_id": 103705592, "body": "And what is your actual question? Note that there is not much you can do about request Close returning an error."}, {"owner": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1573036615, "post_id": 58705227, "comment_id": 103747346, "body": "Thanks for reply. I just want to know how everyone writes when writing a defer with a method returns a error. Because some linter and IDE warn unhandled error."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "edited": false, "score": 0, "creation_date": 1572938536, "post_id": 58705506, "comment_id": 103707073, "body": "I wrote the code as an example, so I skipped some error handling."}, {"owner": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "edited": false, "score": 0, "creation_date": 1572939048, "post_id": 58705506, "comment_id": 103707262, "body": "Is this an additional issue? is this a different issue checking <code>res.Body</code> from handling error with defer?"}, {"owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "reply_to_user": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "edited": false, "score": 0, "creation_date": 1572939218, "post_id": 58705506, "comment_id": 103707324, "body": "Handling error using defer is not an issue. Accessing <code>.Body</code> from a nil is an issue"}, {"owner": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "edited": false, "score": 0, "creation_date": 1573027430, "post_id": 58705506, "comment_id": 103742587, "body": "I just want to know how everyone writes when writing a defer with a method returns a error. Because some linter and IDE warn unhandled error."}, {"owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "reply_to_user": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "edited": false, "score": 0, "creation_date": 1573032912, "post_id": 58705506, "comment_id": 103745269, "body": "Warning for unhandled error will be regardless of whether you put it in a defer or not. This warning is just purely based on the fact that the error is not correctly handled."}], "tags": [], "owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "is_accepted": false, "score": 0, "last_activity_date": 1572934698, "creation_date": 1572934698, "answer_id": 58705506, "question_id": 58705227, "link": "https://stackoverflow.com/questions/58705227/how-to-write-a-defer-block-with-a-method-returns-error/58705506#58705506", "title": "How to write a defer block with a method returns error", "body": "<p>The issue here is not the defer, actually its the fact that u are using <code>res.Body</code> without checking for whether res.Body == nil </p>\n\n<p>So the part here is missing is the error handling when cli.Do(req) returns an error and nil for res. </p>\n\n<p>You can still do the same differ by adding in a check for the res being nil.\nOr you can stop early when cli.Do(req) returns an error </p>\n\n<p>Here is an example <a href=\"https://play.golang.org/p/pnETOjhNCKs\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pnETOjhNCKs</a> </p>\n"}], "owner": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "closed_date": 1572940605, "answer_count": 1, "score": -2, "last_activity_date": 1572943960, "creation_date": 1572933085, "last_edit_date": 1572943960, "question_id": 58705227, "link": "https://stackoverflow.com/questions/58705227/how-to-write-a-defer-block-with-a-method-returns-error", "closed_reason": "Duplicate", "title": "How to write a defer block with a method returns error", "body": "<p>Error handling is not possible when I write a method that returns an error with defer in one-liner.\nIt will be warned by IDE linter etc.</p>\n\n<p>I write the following code to avoid it.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    req, _ := http.NewRequest(\"GET\", \"https://example.com\", nil)\n    cli := &amp;http.Client{}\n    res, _ := cli.Do(req)\n\n    defer func() {\n        _ = res.Body.Close() // catch the error\n    }()\n\n    b, _ := ioutil.ReadAll(res.Body)\n    log.Println(string(b))\n}\n\n</code></pre>\n"}, {"tags": ["windows", "git", "docker", "go", "amd"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1572932318, "last_edit_date": 1592644375, "creation_date": 1572932318, "answer_id": 58705096, "question_id": 58705028, "link": "https://stackoverflow.com/questions/58705028/getting-no-matching-manifest-for-windows-amd64-10-0-18362-in-the-manifest-list/58705096#58705096", "title": "Getting : no matching manifest for windows/amd64 10.0.18362 in the manifest list entries", "body": "<p>This is followed by <a href=\"https://github.com/docker/doodle/issues/9\" rel=\"nofollow noreferrer\">docker/doodle issue 9</a>, and it <a href=\"https://github.com/docker/doodle/issues/9#issuecomment-524853363\" rel=\"nofollow noreferrer\">includes a workaround</a>.</p>\n<p>But also the simpler advice:</p>\n<blockquote>\n<p>An alternative is to go to Docker Desktop and select <strong><code>Switch to Linux Containers</code></strong>.</p>\n<p>The problem is due to the <code>-alpine</code> part of the tag which unfortunately there is no alpine Linux container which will run on Windows.</p>\n</blockquote>\n"}], "owner": {"reputation": 153, "user_id": 9801711, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EGGJN8yfMxE/AAAAAAAAAAI/AAAAAAAAN_8/1RB_hAL4sqE/photo.jpg?sz=128", "display_name": "cptiwari20", "link": "https://stackoverflow.com/users/9801711/cptiwari20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5368, "favorite_count": 3, "accepted_answer_id": 58705096, "answer_count": 1, "score": 3, "last_activity_date": 1572932318, "creation_date": 1572931871, "question_id": 58705028, "link": "https://stackoverflow.com/questions/58705028/getting-no-matching-manifest-for-windows-amd64-10-0-18362-in-the-manifest-list", "title": "Getting : no matching manifest for windows/amd64 10.0.18362 in the manifest list entries", "body": "<p>I am just getting started with the docker.\nI installed the windows version of the docker and followed some basic steps as given in <a href=\"https://hub.docker.com/?overlay=onboarding\" rel=\"nofollow noreferrer\">https://hub.docker.com/?overlay=onboarding</a>.\nUnable to build the docker file.</p>\n\n<p>I just cloned a git repo from that\nby : \n<code>git clone https://github.com/docker/doodle.git</code></p>\n\n<p>then try to build the docker\n<code>cd doodle\\cheers2019 ;\n docker build -t myrepo/cheers2019 .</code></p>\n\n<p>I am getting the response on the command line:\n<code>Sending build context to Docker daemon  13.31kB\nStep 1/9 : FROM golang:1.11-alpine AS builder\n1.11-alpine: Pulling from library/golang\nno matching manifest for windows/amd64 10.0.18362 in the manifest list entries</code></p>\n\n<p>DokerFile has</p>\n\n<pre><code>FROM golang:1.11-alpine AS builder\nRUN apk add --no-cache git\nRUN go get github.com/pdevine/go-asciisprite\nWORKDIR /project\nCOPY cheers.go .\nRUN CGO_ENABLED=0 GOOS=linux go build -a -ldflags '-extldflags \"-static\"' -o cheers cheers.go\n\nFROM scratch\nCOPY --from=builder /project/cheers /cheers\nENTRYPOINT [\"/cheers\"]\n</code></pre>\n\n<p>My PC specs:\nWindows 10 - AMD Ryzen5 Processor</p>\n\n<p>Is there is an issue with the AMD processor? Please suggest me some way to solve this.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1572929586, "post_id": 58704389, "comment_id": 103704325, "body": "<code>headers</code> is a slice of strings."}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1572929624, "creation_date": 1572929624, "answer_id": 58704720, "question_id": 58704389, "link": "https://stackoverflow.com/questions/58704389/cannot-get-response-header-with-the-same-key-name-http-header/58704720#58704720", "title": "Cannot get response header with the same key name (*http.Header)", "body": "<p><code>http.Header</code> is already a <code>map[string][]string</code> so there should be no need to pass the address of it around. If you somehow passed <code>&amp;request.Header</code>, then you should pass it directly instead, without taking the address. If you have to pass the address for some reason, range over <code>*headers</code> instead of <code>headers</code>:</p>\n\n<pre><code>for key,value := range *headers {\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 9383505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qBZAW.png?s=128&g=1", "display_name": "hayashi-ay", "link": "https://stackoverflow.com/users/9383505/hayashi-ay"}, "is_accepted": false, "score": 1, "last_activity_date": 1607524935, "creation_date": 1607524935, "answer_id": 65219010, "question_id": 58704389, "link": "https://stackoverflow.com/questions/58704389/cannot-get-response-header-with-the-same-key-name-http-header/65219010#65219010", "title": "Cannot get response header with the same key name (*http.Header)", "body": "<p>Use <code>Values</code> instead of <code>Get</code>. <a href=\"https://golang.org/pkg/net/http/#Header.Values\" rel=\"nofollow noreferrer\">Values</a> returns all values associated with the given key.</p>\n"}], "owner": {"reputation": 45, "user_id": 1072899, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a42cf353e0a78d7ccd2afdff57cd388f?s=128&d=identicon&r=PG", "display_name": "Mega", "link": "https://stackoverflow.com/users/1072899/mega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 58704720, "answer_count": 2, "score": 0, "last_activity_date": 1607524935, "creation_date": 1572927055, "last_edit_date": 1572943998, "question_id": 58704389, "link": "https://stackoverflow.com/questions/58704389/cannot-get-response-header-with-the-same-key-name-http-header", "title": "Cannot get response header with the same key name (*http.Header)", "body": "<p>Let's say I have 2 response headers with the same name \"Set-Cookie\"</p>\n\n<p>The .Get method can only get the first value</p>\n\n<p>In the document it said:\n<code>To access multiple values of a key, or to use non-canonical keys, access the map directly.</code></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>fmt.Println(headers.Get(\"Set-Cookie\"))\n// -&gt; Can only get the first one\n</code></pre>\n\n<p>However when read the map</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>for key,value := range headers {\n  fmt.Println(key, value)\n}\n// -&gt; cannot range over headers (type *http.Header)\n</code></pre>\n\n<p>Currently I'm not sure the right way to read this data.</p>\n"}, {"tags": ["python", "tensorflow", "go"], "answers": [{"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": false, "score": 1, "last_activity_date": 1574883074, "creation_date": 1574883074, "answer_id": 59077293, "question_id": 58702811, "link": "https://stackoverflow.com/questions/58702811/how-to-interact-with-tf-model-in-tfgo-after-importing/59077293#59077293", "title": "How to interact with TF model in tfgo after importing", "body": "<p>Yes, using to Go bindings and tfgo you have to know the exact operation name.</p>\n\n<p>Getting all the names, under the \"serve\" tags, by the way, it's straightforward using the <code>saved_model_cli</code> CLI tool, shipped together with the TensorFlow Python package.</p>\n\n<pre><code>saved_model_cli show --all --dir &lt;path of your SavedModel&gt;\n</code></pre>\n\n<p>It will give you all the information needed, for every tag available into the SavedModel. In your case, you have to give a look at the <code>signature_def</code> with the key \"serve\" or \"serving_default\".</p>\n\n<p>Disclaimer: I'm the author of the tfgo package. I've also covered this topic in chapter 10 of the book Hands-On Neural networks with TensorFlow 2.0 - in the section dedicated to the SavedModel serialization format.</p>\n"}], "owner": {"reputation": 5764, "user_id": 1336532, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93e5830761f6e85757991d5915369349?s=128&d=identicon&r=PG", "display_name": "Mahoni", "link": "https://stackoverflow.com/users/1336532/mahoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574883074, "creation_date": 1572913164, "question_id": 58702811, "link": "https://stackoverflow.com/questions/58702811/how-to-interact-with-tf-model-in-tfgo-after-importing", "title": "How to interact with TF model in tfgo after importing", "body": "<p>I followed the TensorFlow tutorial on <a href=\"https://www.tensorflow.org/tutorials/keras/text_classification\" rel=\"nofollow noreferrer\">https://www.tensorflow.org/tutorials/keras/text_classification</a> and saved the model.</p>\n\n<p>I was able to successfully import into Go using the tfgo library:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    tg \"github.com/galeone/tfgo\"\n    tf \"github.com/tensorflow/tensorflow/tensorflow/go\"\n)\n\nfunc main() {\n    model := tg.LoadModel(\"movie_reviews\", []string{\"serve\"}, nil)\n    root := tg.NewRoot()\n    t := tg.NewTensor(root, tg.Const(root, [3]int32{1, 2, 3}))\n    fake, _ := tf.NewTensor([3]int32{1, 2, 3})\n    model.Exec([]tf.Output{t.Output}, map[tf.Output]*tf.Tensor{\n        model.Op(\"input\", 0): fake,\n    })\n    fmt.Println(model)\n}\n</code></pre>\n\n<p>But now I don't know how to interact with it. In Python you have all these model methods, i.e. <code>predict</code>, <code>evaluate</code>, etc.</p>\n\n<p>With the Go binding it seems you need to know the exact operation name in order to interact with it?</p>\n\n<p>How would I find out about that?</p>\n"}, {"tags": ["javascript", "html", "user-interface", "go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1572922369, "post_id": 58702750, "comment_id": 103703058, "body": "And what the heck is a Go <i>script</i>? Go is a compiled language. Just because you happen to be able to run <code>go run main.go</code> does not make it an interpreted language."}, {"owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1572929913, "post_id": 58702750, "comment_id": 103704398, "body": "With &quot;connect html input to my backend&quot;, do you mean stuff like form submissions? You&#39;ll probably need to start a http server in another goroutine and then handle it like a normal server application using <code>net&#47;http</code>, then point your gotron window to it using the <a href=\"https://godoc.org/github.com/Equanox/gotron#BrowserWindow.LoadURL\" rel=\"nofollow noreferrer\"><code>LoadURL</code> function</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 12445665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e467115bb1864fd954fb33e4bc36da2a?s=128&d=identicon&r=PG&f=1", "display_name": "anardin", "link": "https://stackoverflow.com/users/12445665/anardin"}, "is_accepted": false, "score": 0, "last_activity_date": 1619252237, "creation_date": 1619252237, "answer_id": 67240691, "question_id": 58702750, "link": "https://stackoverflow.com/questions/58702750/how-do-i-connect-a-go-script-with-gotron-frontend-when-making-a-gui/67240691#67240691", "title": "How do I connect a Go script with Gotron frontend when making a GUI?", "body": "<p>I think that the code that the tutorial relies on is no longer maintained and likely a malware. However, if you look in the official golang documentation, <a href=\"https://golangr.com/gui/\" rel=\"nofollow noreferrer\">which you can find here,</a> you can find several ways to provide an html/css frontend to golang gui applications.</p>\n<p>They suggest using gowd, go-astilectron or go-sciter, which are all well documented and there are several tutorials to quick start your gui project.</p>\n<p>These systems work well, but they have the downside of creating very large binaries that may complicate distribution. As an alternative you can try using <a href=\"https://github.com/therecipe/qt\" rel=\"nofollow noreferrer\">Qt bindings</a> or <a href=\"https://github.com/gotk3/gotk3\" rel=\"nofollow noreferrer\">Gtk bindings</a> for go.</p>\n"}], "owner": {"reputation": 1, "user_id": 12323303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCkKpLRHFCGGq-VgYNhN25mMprTnI5825RV6Yha-Q=k-s128", "display_name": "eSpike", "link": "https://stackoverflow.com/users/12323303/espike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1619252237, "creation_date": 1572912386, "last_edit_date": 1572923346, "question_id": 58702750, "link": "https://stackoverflow.com/questions/58702750/how-do-i-connect-a-go-script-with-gotron-frontend-when-making-a-gui", "title": "How do I connect a Go script with Gotron frontend when making a GUI?", "body": "<p>I have been following this tutorial online about how to make a GUI using Go:\n<a href=\"https://medium.com/benchkram/tutorial-adding-a-gui-to-golang-6aca601e277d\" rel=\"nofollow noreferrer\">https://medium.com/benchkram/tutorial-adding-a-gui-to-golang-6aca601e277d</a>\nand i was wondering how i can connect html input to my backend that is written in Go.\nI hope this makes sense.\nAny links or help would be very much appreciated. </p>\n\n<p>The code:</p>\n\n<pre><code>package main\nimport (\n    \"github.com/Equanox/gotron\"\n)\n\nfunc main() {\n    // Create a new browser window instance\n    window, err := gotron.New(\"webapp\")\n    if err != nil {\n        panic(err)\n    }\n\n    // Alter default window size and window title.\n    window.WindowOptions.Width = 1200\n    window.WindowOptions.Height = 980\n    window.WindowOptions.Title = \"Gotron\"\n\n    // Start the browser window.\n    // This will establish a golang &lt;=&gt; nodejs bridge using websockets,\n    // to control ElectronBrowserWindow with our window object.\n    done, err := window.Start()\n    if err != nil {\n        panic(err)\n    }\n\n    // Open dev tools must be used after window.Start\n    // window.OpenDevTools()\n\n    // Wait for the application to close\n    &lt;-done\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1572906194, "post_id": 58701872, "comment_id": 103699671, "body": "<code>reflect.TypeOf(c).Elem()</code>... You&#39;re passing in the <i>type</i> of <code>c</code> not its <i>value</i>, you won&#39;t be able to set anything to a type. <code>reflect.Type</code> as the argument to your set config func is the first problem, it should be <code>reflect.Value</code> and it should be addressable."}, {"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572906963, "post_id": 58701872, "comment_id": 103699928, "body": "This is so confusing lol"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1572907284, "post_id": 58701872, "comment_id": 103699999, "body": "Apologies. You want to populate the fields of the \u2018c\u2019 value right? Well that is not possible through its type. That means that \u2018reflects.Type\u2019 is the wrong choice for the argument type to your setconfigflags function. Is that a bit more clear?"}, {"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572907360, "post_id": 58701872, "comment_id": 103700021, "body": "Yes, it was totally clear. I&#39;m trying to re-adapt my example now to use reflect.Value as the param. I&#39;m on my way :p"}], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1572916532, "post_id": 58702346, "comment_id": 103702000, "body": "Your handle is perfect for responding to my question. Thanks iLoveReflection, I&#39;ll implement your changes and report back. :-)"}, {"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1572961927, "post_id": 58702346, "comment_id": 103718842, "body": "Follow up question, how can I trigger a method named Parse on the struct? I&#39;ve declared Parse on my structs and am trying to do this:  method := reflect.ValueOf(field).MethodByName(&quot;Parse&quot;) if method.Kind() != reflect.Invalid { method.Call(make([]reflect.Value, 0)) }. All the values return invalid so it&#39;s never triggered :-/"}, {"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "reply_to_user": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1573057997, "post_id": 58702346, "comment_id": 103759438, "body": "@ddibiase  You are calling reflect.ValueOf on a reflect.Value.  Use this code: <code>method :=field.MethodByName(&quot;Parse&quot;)</code>"}, {"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1573062134, "post_id": 58702346, "comment_id": 103761720, "body": "Hmmm, what if I want to find the method outside the loop? directly against the v property? It comes in as value but if I attempt method := v.MethodByName(&quot;Parse&quot;) it returns an invalid reflect.Value :-/"}, {"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "reply_to_user": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1573065266, "post_id": 58702346, "comment_id": 103763161, "body": "I cannot intuit what code might cause the problem described in your previous comment. Ask a new question showing the code that you are using."}, {"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1573065837, "post_id": 58702346, "comment_id": 103763400, "body": "Good point, I posted it here: <a href=\"https://stackoverflow.com/questions/58736651/calling-struct-method-with-reflection\" title=\"calling struct method with reflection\">stackoverflow.com/questions/58736651/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "is_accepted": true, "score": 3, "last_activity_date": 1572909129, "creation_date": 1572909129, "answer_id": 58702346, "question_id": 58701872, "link": "https://stackoverflow.com/questions/58701872/trouble-setting-the-value-of-a-struct-in-reflection/58702346#58702346", "title": "Trouble setting the value of a struct in reflection", "body": "<p>As comments by mkopriva have noted, the code is attempting to set a value on a type.  Use a value.</p>\n\n<pre><code>func setConfigFlags(v reflect.Value, viper *viper.Viper) {\n    t := v.Type()\n    for i := 0; i &lt; t.NumField(); i++ {\n        field := t.Field(i)\n        switch field.Type.Kind() {\n        case reflect.Struct:\n            setConfigFlags(v.Field(i), viper)\n            continue\n        case reflect.String:\n            v.Field(i).SetString(viper.GetString(field.Tag.Get(\"name\")))\n        }\n    }\n}\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>func NewConfig(c Configer) {\n    setConfigFlags(reflect.Value(c).Elem(), c.GetViper())\n}\n</code></pre>\n"}], "owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 58702346, "answer_count": 1, "score": 0, "last_activity_date": 1572909129, "creation_date": 1572905774, "question_id": 58701872, "link": "https://stackoverflow.com/questions/58701872/trouble-setting-the-value-of-a-struct-in-reflection", "title": "Trouble setting the value of a struct in reflection", "body": "<p>Let's say I have a base struct that's a composite of two others:</p>\n\n<pre><code>type Config struct {\n    common.Config\n    common.ServerConfig\n    APIPath      string `type:\"string\" name:\"apipath\" default:\"localhost:8443\" desc:\"Path to the gRPC API server\"`\n    ServePath    string `type:\"string\" name:\"servepath\" default:\"/\" desc:\"Path to serve the API from\"`\n    Organization string `type:\"string\" name:\"organization\" default:\"\" desc:\"Default organization name\"`\n}\n</code></pre>\n\n<p>I'd like to iterate through every field in the struct and pull values into the struct:</p>\n\n<pre><code>func NewConfig(c Configer) {\n    setConfigFlags(reflect.TypeOf(c).Elem(), c.GetViper())\n}\n</code></pre>\n\n<p>So I'd call it so:</p>\n\n<pre><code>conf := Config{}\ncommon.NewConfig(&amp;conf)\n</code></pre>\n\n<p>My setConfigFlags is doing some recursion:</p>\n\n<pre><code>func setConfigFlags(t reflect.Type, viper *viper.Viper) {\n    for i := 0; i &lt; t.NumField(); i++ {\n        field := t.Field(i)\n        switch field.Type.Kind() {\n        case reflect.Struct:\n            setConfigFlags(field.Type, viper)\n            continue\n        case reflect.String:\n            fieldValue := reflect.ValueOf(&amp;field).Elem()\n            if !fieldValue.IsValid() || !fieldValue.CanSet() {\n                return\n            }\n            fieldValue.SetString(\n                viper.GetString(field.Tag.Get(\"name\")),\n            )\n        }\n    }\n}\n</code></pre>\n\n<p>Now once I hit the SetString line towards the bottom I'm getting this error:</p>\n\n<pre><code>panic: reflect: call of reflect.Value.SetString on struct Value\n</code></pre>\n\n<p>When I look at the type of fieldValue at that point it's a structfield. I'm having trouble trying to address the value and change the value of the field. I believe I'm not grabbing the address of the actual struct field properly. The examples and documentation surely isn't helping.</p>\n\n<p>In this particular example I'm pulling viper values. Basically looking for a way to define my viper definitions via struct tags, that's the ultimately goal.</p>\n"}, {"tags": ["go", "terraform"], "comments": [{"owner": {"reputation": 39151, "user_id": 2291321, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24a41cddd8faf69e3fbd0a778ba6fedf?s=128&d=identicon&r=PG&f=1", "display_name": "ydaetskcoR", "link": "https://stackoverflow.com/users/2291321/ydaetskcor"}, "edited": false, "score": 0, "creation_date": 1572902748, "post_id": 58700756, "comment_id": 103698433, "body": "What&#39;s the exact error you get? If you could include the exact command you ran as well then that would also be useful."}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1572956705, "post_id": 58700756, "comment_id": 103716199, "body": "Is this using the new SDK for Terraform providers or not?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 12322684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a3bfecb1fe591b2f00d6013d87f715?s=128&d=identicon&r=PG&f=1", "display_name": "loudcrowd", "link": "https://stackoverflow.com/users/12322684/loudcrowd"}, "edited": false, "score": 2, "creation_date": 1573050022, "post_id": 58701749, "comment_id": 103754728, "body": "Thanks for the explanation, I am relatively new to Go so I appreciate the clarification.  I placed the sample Terraform code outside of my <code>GOPATH</code> and made it a module, <code>go mod init mymodule&#47;test</code>.  Then I attempted to build using <code>go build -o terraform-provider-example</code> and everything worked nicely.  Thanks again!!"}, {"owner": {"reputation": 68, "user_id": 2134965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/egFKN.jpg?s=128&g=1", "display_name": "Prabhas Gupte", "link": "https://stackoverflow.com/users/2134965/prabhas-gupte"}, "edited": false, "score": 0, "creation_date": 1576230704, "post_id": 58701749, "comment_id": 104840208, "body": "@martin-atkins I followed this. However, when I <code>go build -o</code>, I get following:  &lt;code&gt; # runtime /usr/local/go/src/runtime/stubs_x86.go:10:6: stackcheck redeclared in this block         previous declaration at /usr/local/go/src/runtime/stubs_amd64x.go:10:6 /usr/local/go/src/runtime/unaligned1.go:11:6: readUnaligned32 redeclared in this block         previous declaration at /usr/local/go/src/runtime/alg.go:321:40 /usr/local/go/src/runtime/unaligned1.go:15:6: readUnaligned64 redeclared in this block         previous declaration at /usr/local/go/src/runtime/alg.go:329:40 &lt;code&gt;"}, {"owner": {"reputation": 28957, "user_id": 281848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w7nJW.jpg?s=128&g=1", "display_name": "Martin Atkins", "link": "https://stackoverflow.com/users/281848/martin-atkins"}, "reply_to_user": {"reputation": 68, "user_id": 2134965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/egFKN.jpg?s=128&g=1", "display_name": "Prabhas Gupte", "link": "https://stackoverflow.com/users/2134965/prabhas-gupte"}, "edited": false, "score": 1, "creation_date": 1576282626, "post_id": 58701749, "comment_id": 104861772, "body": "@PrabhasGupte those error messages refer to code from the Go standard library rather than from any Terraform code. I think there&#39;s something wrong with your Go installation; perhaps you could ask about it as a new question on Stack Overflow."}, {"owner": {"reputation": 68, "user_id": 2134965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/egFKN.jpg?s=128&g=1", "display_name": "Prabhas Gupte", "link": "https://stackoverflow.com/users/2134965/prabhas-gupte"}, "edited": false, "score": 0, "creation_date": 1576485151, "post_id": 58701749, "comment_id": 104900831, "body": "Thanks @MartinAtkins indeed those were Go specifics. I had to remove the <code>pkg</code> directory and reinstall the golang (to be safer side). Apparently there were some packages brought in by older golang version, mixed with some downloaded by newer."}], "tags": [], "owner": {"reputation": 28957, "user_id": 281848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w7nJW.jpg?s=128&g=1", "display_name": "Martin Atkins", "link": "https://stackoverflow.com/users/281848/martin-atkins"}, "is_accepted": true, "score": 2, "last_activity_date": 1572905130, "creation_date": 1572905130, "answer_id": 58701749, "question_id": 58700756, "link": "https://stackoverflow.com/questions/58700756/setting-up-go-environment-for-creating-custom-terraform-providers/58701749#58701749", "title": "Setting up Go environment for creating custom Terraform providers", "body": "<p>Terraform Core and Terraform provider development requires using the Go toolchain in the new \"modules mode\", which in current versions of Go is not the default.</p>\n\n<p>The easiest way to ensure you're working in modules mode is to clone the repository you want to work on <em>outside</em> the <code>$GOPATH/src</code> directory. Development outside of <code>GOPATH</code> is only supported in Modules mode, and so the Go toolchain assumes that you intend to use modules mode if you are working in that way.</p>\n\n<p>One reason why Terraform development requires modules mode (though not the only one) is that it has a dependency on <code>github.com/hashicorp/hcl/v2</code>, which is a module path type that is not supported in the old <code>GOPATH</code> mode because previously the Go toolchain was only able to install from the <code>master</code> branch of a particular remote dependency in a Git repository. The module path <code>github.com/hashicorp/hcl/v2</code> is the Go Modules way to specify using the second major version of HCL, whereas <code>github.com/hashicorp/hcl</code> is the first major version.</p>\n\n<p>In modules mode, it should be sufficient to just run <code>go build -o terraform-provider-example</code> (or, if you prefer, <code>go install</code>) and it will automatically fetch the dependencies to the local modules cache and use them from there. In modules mode, <code>go get</code> is for changing the dependencies recorded in <code>go.mod</code> rather than for installing existing dependencies.</p>\n"}], "owner": {"reputation": 45, "user_id": 12322684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a3bfecb1fe591b2f00d6013d87f715?s=128&d=identicon&r=PG&f=1", "display_name": "loudcrowd", "link": "https://stackoverflow.com/users/12322684/loudcrowd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 2, "accepted_answer_id": 58701749, "answer_count": 1, "score": 2, "last_activity_date": 1572905130, "creation_date": 1572900125, "question_id": 58700756, "link": "https://stackoverflow.com/questions/58700756/setting-up-go-environment-for-creating-custom-terraform-providers", "title": "Setting up Go environment for creating custom Terraform providers", "body": "<p>I am getting a stuck while trying to create a Terraform provider.  I have been following the advice given on <a href=\"https://i.stack.imgur.com/fAZGv.png\" rel=\"nofollow noreferrer\">https://www.terraform.io/docs/extend/writing-custom-providers.html</a> but when I go to build my binaries via Go <code>go build -o terraform-provider-example</code> I get several missing packages errors.  </p>\n\n<p>So I then work my way down the list of missing packages and use <code>go get ...</code> to get those packages installed in my Go libraries.</p>\n\n<p>I get an error indicating that <code>github.com/hashicorp/hcl/v2</code> cannot be found.  I navigate to the location and sure enough it doesn't exist.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/fAZGv.png\" rel=\"nofollow noreferrer\">Package not available at install time screen shot</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/MQnv0.png\" rel=\"nofollow noreferrer\">Package not available with go get</a></p>\n\n<p>So I am getting stuck and unable to build these providers.  I have looked for a while now trying to find something which describes how to setup the environment for creating providers but have been unsuccessful so far. Can anyone help get me going?</p>\n"}, {"tags": ["dictionary", "go", "methods"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572896679, "post_id": 58699971, "comment_id": 103696199, "body": "That&#39;s pretty much it - you have a map that either defines a function to put into a <code>func</code> field, or you have a map that defines a type to use for each kind of value in place of the generic <code>pet</code> type."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572900980, "post_id": 58699971, "comment_id": 103697774, "body": "Your <code>pet</code> type has no <code>speakMap</code> so <code>tempPet.speakMap</code> cannot work, but lets say it has one, then you&#39;re not initializing it, so <code>tempPet.speakMap[p.breed]</code> as well would not work. Maybe something like this? <a href=\"https://play.golang.com/p/scJUe9SgVpc\" rel=\"nofollow noreferrer\">play.golang.com/p/scJUe9SgVpc</a>"}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 1, "last_activity_date": 1572897111, "creation_date": 1572897111, "answer_id": 58700173, "question_id": 58699971, "link": "https://stackoverflow.com/questions/58699971/best-way-to-assign-pre-defined-methods-based-on-a-string/58700173#58700173", "title": "Best way to assign pre-defined methods based on a string", "body": "<p>How about this:</p>\n\n<pre><code>type pet struct {\n    breed   string  // cat, dog, or cow\n    name    string\n    goodboy bool\n}\n\nfunc (p *pet) speak() {\n   funcMap[p.breed](p)\n}\n\nfunc woof(p *pet){\n    fmt.Println(\"woof\")\n    p.goodboy = true\n}\n\nvar funcMap=map[string]func(*pet){}\n</code></pre>\n\n<p>If you really want to use function pointers:</p>\n\n<pre><code>type pet struct {\n    breed   string  // cat, dog, or cow\n    name    string\n    goodboy bool\n    speak   func()\n}\n\nfunc woof(p *pet){\n    fmt.Println(\"woof\")\n    p.goodboy = true\n}\n\nvar funcMap=map[string]func(*pet){}\n\nvar p pet\np.breed=\"cat\"\np.speak=func() { funcMap[p.breed](&amp;p) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "is_accepted": false, "score": 1, "last_activity_date": 1572939077, "creation_date": 1572939077, "answer_id": 58706459, "question_id": 58699971, "link": "https://stackoverflow.com/questions/58699971/best-way-to-assign-pre-defined-methods-based-on-a-string/58706459#58706459", "title": "Best way to assign pre-defined methods based on a string", "body": "<p>A better idea would be to have a map of an </p>\n\n<pre><code>map[AvailableFunc]func c() {}\n</code></pre>\n\n<p>where </p>\n\n<pre><code>type AvailableFunc string \n\nconst (\nFunc1 AvailableFunc = \"Func1\"\n)\n</code></pre>\n\n<p>That way it would be more strongly typed as compared to just the string. </p>\n"}], "owner": {"reputation": 187, "user_id": 5623153, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/3JAz2.png?s=128&g=1", "display_name": "WarBro", "link": "https://stackoverflow.com/users/5623153/warbro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58700173, "answer_count": 2, "score": -1, "last_activity_date": 1572939077, "creation_date": 1572896236, "last_edit_date": 1572897894, "question_id": 58699971, "link": "https://stackoverflow.com/questions/58699971/best-way-to-assign-pre-defined-methods-based-on-a-string", "title": "Best way to assign pre-defined methods based on a string", "body": "<p>I am trying to have an array of objects that all have the same member properties and a single method, however each object will have a slightly different method. I am struggling in finding the best way to assign the method to the instance based on another field, which is just a string. For example, I have the object</p>\n\n<pre><code>type pet struct {\n    breed   string  // cat, dog, or cow\n    name    string\n    goodboy bool\n    speak   func()\n}\n</code></pre>\n\n<p>and then I have the methods</p>\n\n<pre><code>func (p *pet) woof(){\n    fmt.Println(\"woof\")\n    p.goodboy = true\n}\n\nfunc (p *pet) meow(){\n    fmt.Println(\"meow\")\n    p.goodboy = true\n}\n\nfunc (p *pet) moo(){\n    fmt.Println(\"moo\")\n    p.goodboy = true\n}\n</code></pre>\n\n<p>I can instantiate a pet and assign speak to the method easily enough with <code>spot.speak = spot.woof</code>. However, I am pulling in the pets from an XML document and storing them in an array. Ideally, I want to loop through all the pets from the XML doc and assign the speak method, and then later be able to call on any <code>speak()</code> method for any object in the pets array. Initially I thought of creating a map, but you can't store receivers in a map of functions. This was my thought process for something like how it should work:</p>\n\n<pre><code>for _, p := range petsFromXML{\n    var tempPet pet\n    tempPet.breed = p.breed\n    tempPet.name = p.name\n    tempPet.goodboy = false\n    tempPet.speak = tempPet.speakMap[p.breed]\n    pets = append(pets, tempPet)\n}\n</code></pre>\n\n<p>but obviously this does not work. I have already started thinking about various different workarounds and I am just wondering what the best way of going about this would be.</p>\n"}, {"tags": ["docker", "go", "prometheus", "grafana", "docker-networking"], "comments": [{"owner": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "edited": false, "score": 1, "creation_date": 1572896082, "post_id": 58699648, "comment_id": 103695985, "body": "use your host ip to connect or use --network host in your docker run container and use localhost to conect"}], "answers": [{"comments": [{"owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "edited": false, "score": 0, "creation_date": 1572897298, "post_id": 58700146, "comment_id": 103696446, "body": "If I try this and try to <code>curl http:&#47;&#47;localhost:3000&#47;</code>, I get <code>Failed to connect to localhost port 3000: Connection refused</code> (that is, I&#39;m not able to see the Grafana dashboard at all)"}, {"owner": {"reputation": 5515, "user_id": 1264304, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/bd81fb6370a901321913b1465efa8e51?s=128&d=identicon&r=PG", "display_name": "rok", "link": "https://stackoverflow.com/users/1264304/rok"}, "reply_to_user": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "edited": false, "score": 0, "creation_date": 1572897346, "post_id": 58700146, "comment_id": 103696464, "body": "did Grafana container start? it&#39;s probably down."}, {"owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "edited": false, "score": 0, "creation_date": 1572900642, "post_id": 58700146, "comment_id": 103697657, "body": "The service is running, I can see <code>grafana_1  | t=2019-11-04T20:48:07+0000 lvl=info msg=&quot;HTTP Server Listen&quot; logger=http.server address=0.0.0.0:3000 protocol=http subUrl= socket=</code> in the logs from <code>docker-compose up</code> (in the second example where I specify <code>network: &quot;host&quot;</code> in the <code>docker-compose.yml</code>)."}], "tags": [], "owner": {"reputation": 5515, "user_id": 1264304, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/bd81fb6370a901321913b1465efa8e51?s=128&d=identicon&r=PG", "display_name": "rok", "link": "https://stackoverflow.com/users/1264304/rok"}, "is_accepted": false, "score": 0, "last_activity_date": 1572896965, "creation_date": 1572896965, "answer_id": 58700146, "question_id": 58699648, "link": "https://stackoverflow.com/questions/58699648/how-to-connect-grafana-running-in-a-docker-container-to-a-prometheus-data-source/58700146#58700146", "title": "How to connect Grafana running in a Docker container to a Prometheus data source running on the host machine (on Docker for Mac)?", "body": "<p>Add <code>--network host</code> to your <code>docker run</code> command:</p>\n\n<p><code>docker run --network host...</code></p>\n\n<p>Then use <code>localhost:[prometheus_port]</code> in Grafana settings</p>\n\n<p>Relevant <a href=\"https://docs.docker.com/network/host/\" rel=\"nofollow noreferrer\">docs</a></p>\n"}, {"tags": [], "owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "is_accepted": true, "score": 4, "last_activity_date": 1572906640, "creation_date": 1572906640, "answer_id": 58702022, "question_id": 58699648, "link": "https://stackoverflow.com/questions/58699648/how-to-connect-grafana-running-in-a-docker-container-to-a-prometheus-data-source/58702022#58702022", "title": "How to connect Grafana running in a Docker container to a Prometheus data source running on the host machine (on Docker for Mac)?", "body": "<p>It turns out I didn't quite understand how Prometheus works. The Go application in the example creates a Prometheus <em>exporter</em>, which still has to be scraped by a Prometheus <em>server</em>, which in turn is the data source for Grafana.</p>\n\n<p>I modified the directory structure to be like this:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 prometheus\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Dockerfile\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 prometheus.yml\n\u2514\u2500\u2500 server\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 go.mod\n    \u251c\u2500\u2500 go.sum\n    \u2514\u2500\u2500 main.go\n</code></pre>\n\n<p>where <code>docker-compose.yml</code> is</p>\n\n<pre><code>version: '3'\nservices:\n  server:\n    build: ./server\n    ports:\n      - \"8080:8080\"\n      - \"57475:57475\"\n  grafana:\n    image: grafana/grafana\n    ports:\n      - \"3000:3000\"\n  prometheus:\n    build: ./prometheus\n    ports:\n      - \"9090:9090\"\n</code></pre>\n\n<p>and the <code>prometheus/Dockerfile</code> is</p>\n\n<pre><code>FROM prom/prometheus\n\nADD prometheus.yml /etc/prometheus\n</code></pre>\n\n<p>and the <code>prometheus/prometheus.yml</code> is</p>\n\n<pre><code>global:\n  scrape_interval:     15s\n\nscrape_configs:\n  - job_name: 'server'\n\n    static_configs:\n      - targets: ['server:57475']\n</code></pre>\n\n<p>Now I'm able to add <code>prometheus:9090</code> as a data source URL:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ufDQL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ufDQL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4286, "favorite_count": 1, "accepted_answer_id": 58702022, "answer_count": 2, "score": 5, "last_activity_date": 1572906640, "creation_date": 1572894548, "last_edit_date": 1572897898, "question_id": 58699648, "link": "https://stackoverflow.com/questions/58699648/how-to-connect-grafana-running-in-a-docker-container-to-a-prometheus-data-source", "title": "How to connect Grafana running in a Docker container to a Prometheus data source running on the host machine (on Docker for Mac)?", "body": "<p>I've started a Prometheus server at <code>localhost:57475/metrics</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SqOB3.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/SqOB3.png\" alt=\"enter image description here\"></a></p>\n\n<p>using the following Go code:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"contrib.go.opencensus.io/exporter/prometheus\"\n    log \"github.com/sirupsen/logrus\"\n    \"go.opencensus.io/plugin/ochttp\"\n    \"go.opencensus.io/stats/view\"\n)\n\nfunc main() {\n    stop := make(chan struct{})\n\n    server := &amp;http.Server{Addr: \":8080\"}\n\n    statsMux := http.NewServeMux()\n    statsServer := &amp;http.Server{Handler: statsMux, Addr: \":57475\"}\n\n    if err := view.Register(ochttp.DefaultServerViews...); err != nil {\n        log.WithError(err).Fatal(\"register HTTP metrics view\")\n    }\n\n    exporter, err := prometheus.NewExporter(prometheus.Options{\n        Namespace: \"default\",\n    })\n    if err != nil {\n        log.WithError(err).Fatal(\"create Prometheus exporter\")\n    }\n\n    view.RegisterExporter(exporter)\n\n    statsMux.Handle(\"/metrics\", exporter)\n\n    originalHandler := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"Hello, World!\"))\n    })\n    och := &amp;ochttp.Handler{\n        Handler: originalHandler,\n    }\n\n    server.Handler = och\n\n    go func() {\n        log.Info(\"Starting stats server...\")\n        if err := statsServer.ListenAndServe(); err != nil {\n            log.WithError(err).Fatal(\"listen and serve stats\")\n        }\n    }()\n\n    go func() {\n        log.Info(\"Starting server...\")\n        if err := server.ListenAndServe(); err != nil {\n            log.WithError(err).Fatal(\"listen and serve service endpoints\")\n        }\n    }()\n\n    &lt;-stop\n}\n</code></pre>\n\n<p>I've also started Grafana in a container using the following command (following <a href=\"https://grafana.com/docs/installation/docker/\" rel=\"noreferrer\">https://grafana.com/docs/installation/docker/</a>):</p>\n\n<pre><code>&gt; docker run --detach --publish 3000:3000  --env \"GF_SECURITY_ADMIN_PASSWORD=secret\" grafana/grafana\n2a17ad2bcc05e2955190129b981b3329cd2c5e89098e28b443337ac79ed607f2\n</code></pre>\n\n<p>In Grafana, I would like to connect to the Prometheus exporter running on my Mac <code>localhost</code>. Following <a href=\"https://docs.docker.com/docker-for-mac/networking/\" rel=\"noreferrer\">https://docs.docker.com/docker-for-mac/networking/</a>, I've tried to use the special DNS name <code>host.docker.internal</code>, so specifying the URL as <code>http://host.docker.internal:57475/metrics</code>. However, this results in an <code>HTTP Error Not Found</code> when I click \"Save &amp; Test\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/NtlEJ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/NtlEJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any idea why this is not working?</p>\n\n<h2>Update</h2>\n\n<p>Instead of using the special DNS name <code>host.docker.internal</code>, I tried combining the server and Grafana into a Docker Compose multi-container application and using the Docker bridge to connect them, but this also didn't work. With the follwoing directory structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 server\n    \u251c\u2500\u2500 Dockerfile\n    \u251c\u2500\u2500 go.mod\n    \u251c\u2500\u2500 go.sum\n    \u2514\u2500\u2500 main.go\n</code></pre>\n\n<p>and the following <code>docker-compose.yml</code>:</p>\n\n<pre><code>version: '3'\nservices:\n  server:\n    build: ./server\n    ports:\n      - \"8080:8080\"\n      - \"57475:57475\"\n  grafana:\n    image: grafana/grafana\n    ports:\n      - \"3000:3000\"\n</code></pre>\n\n<p>and the following <code>Dockerfile</code>:</p>\n\n<pre><code>FROM golang:1.12\n\nWORKDIR /go/src/app\nCOPY . .\n\nRUN go get -d -v ./...\nRUN go install -v ./...\n\nCMD [\"app\"]\n</code></pre>\n\n<p>If I attach to the Grafana container and curl <code>server:8080</code> or <code>server:57475/metrics</code>, I get a response:</p>\n\n<pre><code>useprometheus&gt; docker exec -it --user root useprometheus_grafana_1 /bin/ash\n/usr/share/grafana # apk add curl\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.10/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.10/community/x86_64/APKINDEX.tar.gz\n(1/3) Installing nghttp2-libs (1.39.2-r0)\n(2/3) Installing libcurl (7.66.0-r0)\n(3/3) Installing curl (7.66.0-r0)\nExecuting busybox-1.30.1-r2.trigger\nOK: 17 MiB in 24 packages\n/usr/share/grafana # curl server:8080\nHello, World!/usr/share/grafana # curl server:57475/metrics\n# HELP default_opencensus_io_http_server_latency Latency distribution of HTTP requests\n# TYPE default_opencensus_io_http_server_latency histogram\ndefault_opencensus_io_http_server_latency_bucket{le=\"1\"} 1\ndefault_opencensus_io_http_server_latency_bucket{le=\"2\"} 1\ndefault_opencensus_io_http_server_latency_bucket{le=\"3\"} 1\ndefault_opencensus_io_http_server_latency_bucket{le=\"4\"} 1\n</code></pre>\n\n<p>However, if I try to add the same URL in the Grafana admin, I get the same error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LdXRx.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/LdXRx.png\" alt=\"enter image description here\"></a></p>\n\n<p>In other words, although I am able to <code>curl</code> this endpoint from the Grafana container, I can't use it as a data source URL in the Grafana dashboard, making me think this is something Grafana-specific. Any idea why this is not working?</p>\n"}, {"tags": ["go", "sap", "hana"], "comments": [{"owner": {"reputation": 93, "user_id": 5268678, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wGN2FV1_zJk/AAAAAAAAAAI/AAAAAAAAA3E/RLNmGaWWLsU/photo.jpg?sz=128", "display_name": "pedrualves", "link": "https://stackoverflow.com/users/5268678/pedrualves"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572888946, "post_id": 58698188, "comment_id": 103693206, "body": "@Flimzy how to do this? Are you know Hana Database ? Because SAP Hana Database is something differente from others databases =/"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1572894275, "post_id": 58698188, "comment_id": 103695321, "body": "Are you actually using <code>&quot;hdb:&#47;&#47;user:password@hostname:port&quot;</code>, or are you substituting in your own username, password, host, and port?"}, {"owner": {"reputation": 93, "user_id": 5268678, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wGN2FV1_zJk/AAAAAAAAAAI/AAAAAAAAA3E/RLNmGaWWLsU/photo.jpg?sz=128", "display_name": "pedrualves", "link": "https://stackoverflow.com/users/5268678/pedrualves"}, "edited": false, "score": 0, "creation_date": 1572901039, "post_id": 58698188, "comment_id": 103697796, "body": "I have substituted host,user,password and port with my real values. Values wich I use to connect using Dbeaver."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5268678, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wGN2FV1_zJk/AAAAAAAAAAI/AAAAAAAAA3E/RLNmGaWWLsU/photo.jpg?sz=128", "display_name": "pedrualves", "link": "https://stackoverflow.com/users/5268678/pedrualves"}, "edited": false, "score": 0, "creation_date": 1572958507, "post_id": 58706618, "comment_id": 103717034, "body": "I&#39;m using the official hana go client. But encrypt=true don&#39;t works."}], "tags": [], "owner": {"reputation": 357, "user_id": 12066099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb05c67295cbea914ac30662246cb12?s=128&d=identicon&r=PG&f=1", "display_name": "kai-morich", "link": "https://stackoverflow.com/users/12066099/kai-morich"}, "is_accepted": false, "score": 1, "last_activity_date": 1572939748, "creation_date": 1572939748, "answer_id": 58706618, "question_id": 58698188, "link": "https://stackoverflow.com/questions/58698188/how-to-connect-ssl-on-hana-db-sap-sql-error-4321-only-secure-connections-ar/58706618#58706618", "title": "How to connect SSL on Hana DB - SAP [SQL Error 4321 - only secure connections are allowed]", "body": "<p>The pure Go HANA SQL client library very likely does not support encryption (similar to the pure Python client). You should use the official HANA go client (<a href=\"https://help.sap.com/viewer/0eec0d68141541d1b07893a39944924e/2.0.04/en-US/0ffbe86c9d9f44338441829c6bee15e6.html\" rel=\"nofollow noreferrer\">https://help.sap.com/viewer/0eec0d68141541d1b07893a39944924e/2.0.04/en-US/0ffbe86c9d9f44338441829c6bee15e6.html</a>) and set connection properties:</p>\n\n<ul>\n<li>encrypt=true</li>\n<li>validateCertificate=false</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 5268678, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wGN2FV1_zJk/AAAAAAAAAAI/AAAAAAAAA3E/RLNmGaWWLsU/photo.jpg?sz=128", "display_name": "pedrualves", "link": "https://stackoverflow.com/users/5268678/pedrualves"}, "is_accepted": true, "score": 1, "last_activity_date": 1572958921, "creation_date": 1572958921, "answer_id": 58711943, "question_id": 58698188, "link": "https://stackoverflow.com/questions/58698188/how-to-connect-ssl-on-hana-db-sap-sql-error-4321-only-secure-connections-ar/58711943#58711943", "title": "How to connect SSL on Hana DB - SAP [SQL Error 4321 - only secure connections are allowed]", "body": "<p>after a lot of tests I found this palliative solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"database/sql\"\n    \"github.com/SAP/go-hdb/driver\"\n    _ \"github.com/SAP/go-hdb/driver\"\n    \"log\"\n)\n\nconst (\n    HOST     = \"host\"\n    PORT     = \":port\"\n    USERNAME = \"user\"\n    PASSWORD = \"password\"\n)\n\nfunc main() {\n    c := driver.NewBasicAuthConnector(\n        HOST+PORT,\n        USERNAME,\n        PASSWORD)\n\n    tlsConfig := tls.Config{\n        InsecureSkipVerify: false,\n        ServerName:         HOST,\n    }\n\n    c.SetTLSConfig(&amp;tlsConfig)\n\n    db := sql.OpenDB(c)\n\n    var id int\n    var name string\n    res := db.QueryRow(\"SELECT * FROM SCHEMA.TABLE LIMIT 1\")\n\n    res.Scan(&amp;id, &amp;name)\n\n    log.Println(\"res \", id, name)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5268678, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wGN2FV1_zJk/AAAAAAAAAAI/AAAAAAAAA3E/RLNmGaWWLsU/photo.jpg?sz=128", "display_name": "pedrualves", "link": "https://stackoverflow.com/users/5268678/pedrualves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 58711943, "answer_count": 2, "score": 3, "last_activity_date": 1572958921, "creation_date": 1572887663, "last_edit_date": 1572889978, "question_id": 58698188, "link": "https://stackoverflow.com/questions/58698188/how-to-connect-ssl-on-hana-db-sap-sql-error-4321-only-secure-connections-ar", "title": "How to connect SSL on Hana DB - SAP [SQL Error 4321 - only secure connections are allowed]", "body": "<p>following the link <a href=\"https://help.sap.com/viewer/0eec0d68141541d1b07893a39944924e/2.0.02/en-US/8d61ae225ae44b0bab2fb2285009f68d.html\" rel=\"nofollow noreferrer\">SAP - Go (golang) Support</a> a made the code below:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"database/sql\"\n    _ \"github.com/SAP/go-hdb/driver\"\n    \"log\"\n)\n\nconst (\n    driverName = \"hdb\"\n    hdbDsn     = \"hdb://user:password@hostname:port\"\n)\n\nfunc main() {\n\n    db, err := sql.Open(driverName, hdbDsn)\n\n    if err != nil {\n        log.Print(\"error on sql open =&gt; \" ,err)\n    }\n\n    err = db.Ping()\n\n    if err != nil {\n        log.Print(\"error on db.Ping() =&gt; \" ,err)\n    }\n\n}\n\n</code></pre>\n\n<p>but I have the following problem:</p>\n\n<pre><code>2019/11/04 14:59:24 error on db.Ping() =&gt; SQL Error 4321 - only secure connections are allowed\n</code></pre>\n\n<p>I, tried too this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>hdbDsn     = \"hdb://user:password@hostname:port?encrypt=true\"\n</code></pre>\n\n<p>but is not possible connect to Hana database.</p>\n\n<p>Someone could help me?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1572885550, "post_id": 58697521, "comment_id": 103691584, "body": "Go is not NodeJS. What are you actually trying to accomplish (i.e. why are you looking for different behavior)?"}, {"owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572886589, "post_id": 58697521, "comment_id": 103692098, "body": "Hi Adrian, I know that go is not node.js but the modules feature was created to mimic the feature of package managers like npm, yarn, etc and that works correctly for me, but I want each of my projects to have their dependencies in their workspace."}, {"owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572886895, "post_id": 58697521, "comment_id": 103692226, "body": "All the dependencies of all my projects are installed in C:\\Users&#91;user]\\go\\pkg, this is disastrous to be managed correctly.  Surely it is because of my lack of experience in this new feature, but I want to know what would be the correct way to perform this behavior."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1572887899, "post_id": 58697521, "comment_id": 103692698, "body": "Why is that disastrous? It caches each version independently, so it&#39;s not like it will break something if different projects use different versions. If they use the same version, they&#39;ll get the same code. What problem are you trying to solve?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1572888588, "post_id": 58697521, "comment_id": 103693053, "body": "Get used to it. there is nothing wrong with how it is done."}, {"owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572889238, "post_id": 58697521, "comment_id": 103693331, "body": "@Adrian Of course I understand, but if I have multiple projects I will have a quantity of &quot;garbage&quot;, as I delete the data that corresponds to each project in a simple way. I am working offline, Should I create a bash script to eliminate each dependency?, or what is the correct way to eliminate the dependencies that I no longer require that exist on my computer, (go get) does not have a functionality to remove dependencies :("}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1572889441, "post_id": 58697521, "comment_id": 103693424, "body": "No, <code>go get</code> is for getting things, not deleting them. See <code>go help clean</code>."}, {"owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572889692, "post_id": 58697521, "comment_id": 103693535, "body": "@Adrian haha, thanks for your time Adrian, I&#39;m going to investigate what I can do with go clean"}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "edited": false, "score": 0, "creation_date": 1572886334, "post_id": 58697696, "comment_id": 103691958, "body": "Hi thanks, I&#39;m already using that mode &quot;golang Modules&quot;, the problem is that the modules are installed in C: \\Users&#91;user]\\go\\pkg, and I want them to be installed locally in my workspace."}], "tags": [], "owner": {"reputation": 76, "user_id": 2549196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907faca6f0dcefb7d9a441b66402a309?s=128&d=identicon&r=PG", "display_name": "Huholoman", "link": "https://stackoverflow.com/users/2549196/huholoman"}, "is_accepted": false, "score": 2, "last_activity_date": 1572885829, "creation_date": 1572885829, "answer_id": 58697696, "question_id": 58697521, "link": "https://stackoverflow.com/questions/58697521/install-packages-locally-in-golang-module-feature/58697696#58697696", "title": "Install packages locally in golang module feature", "body": "<p>There is little bit different approach. Go lock versions based on github (gitlab, etc) current commit. When you want to use specific versions of packages and not master all the time you want to use go modules (this is official way to do it, but there are some other tools). You init module in you project</p>\n\n<pre><code>go mod init [possible custom package name]\n</code></pre>\n\n<p>And everytime you call \"go get somepackage\" it writes versions it uses to a file called <code>go.mod</code>.</p>\n\n<p>You can read more <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "is_accepted": true, "score": 8, "last_activity_date": 1614926726, "last_edit_date": 1614926726, "creation_date": 1572897611, "answer_id": 58700267, "question_id": 58697521, "link": "https://stackoverflow.com/questions/58697521/install-packages-locally-in-golang-module-feature/58700267#58700267", "title": "Install packages locally in golang module feature", "body": "<p>As others have mentioned, you can create your module files like this:</p>\n<pre><code>go mod init [import path]\n</code></pre>\n<p>After that you can run this command any time to move all dependencies into the <code>vendor</code> directory:</p>\n<pre><code>go mod vendor\n</code></pre>\n<p>This is very similar to the behaviour of the <code>node_modules</code> directory.\nTo build using the dependencies in this directory, you can add <code>-mod vendor</code> to your build command:</p>\n<pre><code>go build -mod vendor\n</code></pre>\n<p>This way you can copy your project to any machine without go-getting anything on that other machine.</p>\n<p>According to the <a href=\"https://golang.org/ref/mod#vendoring\" rel=\"nofollow noreferrer\">docs</a>, the <code>-mod=vendor</code> flag is set automatically if the Go version in the <code>go.mod</code> file is <code>1.14</code> or higher and a <code>vendor</code> directory exists.</p>\n<p>To clean unused dependencies from the <code>vendor</code> directory, you can run</p>\n<pre><code>go mod tidy\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2150, "favorite_count": 1, "closed_date": 1572932015, "accepted_answer_id": 58700267, "answer_count": 2, "score": 0, "last_activity_date": 1614926726, "creation_date": 1572885139, "question_id": 58697521, "link": "https://stackoverflow.com/questions/58697521/install-packages-locally-in-golang-module-feature", "closed_reason": "Needs details or clarity", "title": "Install packages locally in golang module feature", "body": "<p>When I install a package using go get, in the golang module mode, these are installed in the go root folder.</p>\n\n<p>I would like to be able to install the modules in the same way that npm or yarn does for node.js, global or local.</p>\n\n<p>what would be the right way to achieve this behavior.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 699354, "user_id": 218196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4P5DY.jpg?s=128&g=1", "display_name": "Felix Kling", "link": "https://stackoverflow.com/users/218196/felix-kling"}, "edited": false, "score": 3, "creation_date": 1572882444, "post_id": 58696604, "comment_id": 103689983, "body": "You should be able to do <code>RBody{ ... struct{Start, Rows int}{ Start: 42, Rows: 42}}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 2031060, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/74b9198b642d443dcfa94112a3777a90?s=128&d=identicon&r=PG", "display_name": "darthvading", "link": "https://stackoverflow.com/users/2031060/darthvading"}, "edited": false, "score": 0, "creation_date": 1572889198, "post_id": 58696811, "comment_id": 103693316, "body": "Cool. As I said, I got that working by naming the anonymous struct which is definitely &quot;not ugly&quot; but just wanted to know if there&#39;s a way around that."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1572882594, "creation_date": 1572882594, "answer_id": 58696811, "question_id": 58696604, "link": "https://stackoverflow.com/questions/58696604/initalizing-the-nested-anonymous-structures/58696811#58696811", "title": "Initalizing the nested anonymous structures", "body": "<p>This works, but it is ugly:</p>\n\n<pre><code>bd := RBody { Fields :  []string{\"time\",\"id\",\"status\",\"customerId\",\"additionalDetail\"},\nPageInfo : struct {Start int `json:\"start\"`\nRows int `json:\"rows\"`} {Start:1,Rows:2}}\n</code></pre>\n\n<p>I suggest you either name the anonymous struct, or initialize Fields in the declaration, and PageInfo using assignments later.</p>\n"}], "owner": {"reputation": 809, "user_id": 2031060, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/74b9198b642d443dcfa94112a3777a90?s=128&d=identicon&r=PG", "display_name": "darthvading", "link": "https://stackoverflow.com/users/2031060/darthvading"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 58696811, "answer_count": 1, "score": -3, "last_activity_date": 1572882594, "creation_date": 1572881869, "question_id": 58696604, "link": "https://stackoverflow.com/questions/58696604/initalizing-the-nested-anonymous-structures", "title": "Initalizing the nested anonymous structures", "body": "<p>I am having a json as </p>\n\n<pre><code>{\n\"fields\": [\"time\",\"id\",\"status\",\"customerId\",\"additionalDetail\"],\n\"pageInfo\": {\"start\": 0, \"rows\": 1000}\n}\n</code></pre>\n\n<p>I wanted to Marshal my structure to above json and create the structure as below -</p>\n\n<pre><code>type RBody struct {\nFields []string `json:\"fields\"`\nPageInfo struct {\n    Start int `json:\"start\"`\n    Rows int `json:\"start\"`\n    } `json:\"pageInfo\"`\n}\n</code></pre>\n\n<p>I am having trouble in initializing the above structure. I am not sure how to initialize the anonymous struct in below fashion :</p>\n\n<pre><code>bd := RBody {\nFields : []string{\"time\",\"id\",\"status\",\"customerId\",\"additionalDetail\"},\nPageInfo : ???\n}\n</code></pre>\n\n<p>I worked around this by creating a separate structure for page info and attaching that with parent struct. However there's got to be some way to perform the initialisation of the <strong>anonymous</strong> nested struct, in the same way I did with <strong>Fields</strong> (string slice) above. Can anyone redirect me to some guide to do that ?</p>\n"}, {"tags": ["forms", "go", "http-headers", "microservices", "distributed-tracing"], "answers": [{"comments": [{"owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "edited": false, "score": 0, "creation_date": 1572882522, "post_id": 58696691, "comment_id": 103690017, "body": "what I have missed <code>req.Header.Set(&quot;Content-Type&quot;, &quot;application&#47;x-www-form-urlencoded&quot;)</code>."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 4, "last_activity_date": 1572882162, "creation_date": 1572882162, "answer_id": 58696691, "question_id": 58696512, "link": "https://stackoverflow.com/questions/58696512/post-data-faild-using-http-newrequest/58696691#58696691", "title": "POST data faild using http.NewRequest", "body": "<p><a href=\"https://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\">From the docs for ParseForm</a>:</p>\n\n<blockquote>\n  <p>[...] when the Content-Type is not application/x-www-form-urlencoded, the request Body is not read, and r.PostForm is initialized to a non-nil, empty value.</p>\n</blockquote>\n\n<p>PostForm sets the Content-Type automatically, but now you have to do it yourself:</p>\n\n<pre><code>req, err := http.NewRequest(\"POST\", userserviceUrl, strings.NewReader(form.Encode()))\n// TODO: handle error\nreq.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n</code></pre>\n"}], "owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 58696691, "answer_count": 1, "score": 1, "last_activity_date": 1572886871, "creation_date": 1572881479, "last_edit_date": 1572886871, "question_id": 58696512, "link": "https://stackoverflow.com/questions/58696512/post-data-faild-using-http-newrequest", "title": "POST data faild using http.NewRequest", "body": "<p>I am trying to pass data from one golang service to another using <code>http.NewRequest()</code>. To do it I used following code:</p>\n\n<pre><code>        httpClient := http.Client{}\n\n        userserviceUrl := \"http://user:7071/checkemail\"\n\n        form := url.Values{}\n        form.Set(\"uuid\", uuid)\n        form.Set(\"email\", email)\n\n        b := bytes.NewBufferString(form.Encode())\n        req, err := http.NewRequest(\"POST\", userserviceUrl, b)\n        if err != nil {\n            log.Println(err)\n        }\n\n        opentracing.GlobalTracer().Inject(\n            validateEmailSpan.Context(),\n            opentracing.HTTPHeaders,\n            opentracing.HTTPHeadersCarrier(req.Header))\n\n        resp, err := httpClient.Do(req)\n        //_, err = http.PostForm(\"http://user:7071/checkemail\", url.Values{\"uuid\": {uuid}, \"email\": {email}})\n\n        if err != nil {\n            log.Println(\"Couldnt verify email address user service sends an error : \", err)\n        }\n        defer resp.Body.Close()\n</code></pre>\n\n<p>I got this from <a href=\"https://stackoverflow.com/questions/28624969/golang-http-newrequest-post-with-json-payload-returns-error-500\">Golang: http.NewRequest POST</a></p>\n\n<p>When I try to dump received data from user service:</p>\n\n<pre><code>    req.ParseForm()\n    log.Println(\"Form values : \", req.Form)\n</code></pre>\n\n<p>I get an empty <code>map[]</code></p>\n\n<p>Here I just try to inject tracing span to my request, previously I have used <code>http.PostForm()</code> to pass data, it worked perfectly. But I have <a href=\"https://stackoverflow.com/questions/58672447/distributed-tracing-with-golang-http-postform\">no idea to pass <code>tracing</code> to it</a>.</p>\n"}, {"tags": ["git", "go", "google-compute-engine", "startup"], "comments": [{"owner": {"reputation": 13407, "user_id": 291180, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Crlpe.png?s=128&g=1", "display_name": "Travis Webb", "link": "https://stackoverflow.com/users/291180/travis-webb"}, "edited": false, "score": 0, "creation_date": 1572882988, "post_id": 58696228, "comment_id": 103690254, "body": "If you had to use <code>sudo</code> to run <code>curl</code>, you&#39;ve got other problems in your environment that are beyond the scope of that tutorial. Try following the tutorial exactly, first, before trying to apply it to your own application."}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "reply_to_user": {"reputation": 13407, "user_id": 291180, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Crlpe.png?s=128&g=1", "display_name": "Travis Webb", "link": "https://stackoverflow.com/users/291180/travis-webb"}, "edited": false, "score": 0, "creation_date": 1572883103, "post_id": 58696228, "comment_id": 103690310, "body": "I edited my question so you can see how I create my instance"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572886904, "creation_date": 1572880456, "last_edit_date": 1572886904, "question_id": 58696228, "link": "https://stackoverflow.com/questions/58696228/issues-while-deploying-a-service-from-gitlab-repository-using-startup-script", "title": "Issues while deploying a service from Gitlab repository using startup script", "body": "<p>I am currently having issues while trying to deploy my app (currently the first service of my microservices).</p>\n\n<p>I followed <a href=\"https://cloud.google.com/go/docs/tutorials/bookshelf-on-compute-engine\" rel=\"nofollow noreferrer\">https://cloud.google.com/go/docs/tutorials/bookshelf-on-compute-engine</a> but using my own service, hosted on gitlab.</p>\n\n<p>I, however, had to edit the script since it doesn't work (sudo issue so I have to give the privileges to each of my commands):</p>\n\n<pre><code>set -ex\n\n# Talk to the metadata server to get the project id and location of the application binary.\nPROJECTID=$(curl -s \"http://metadata.google.internal/computeMetadata/v1/project/project-id\" -H \"Metadata-Flavor: Google\")\n\n# Install logging monitor. The monitor will automatically pick up logs send to\n# syslog.\nsudo curl -s \"https://storage.googleapis.com/signals-agents/logging/google-fluentd-install.sh\" | sudo bash\nsudo service google-fluentd restart &amp;\n\n# Install dependencies from apt\nsudo apt-get update\nsudo apt-get install -yq ca-certificates supervisor git emacs\n\necho \"alias ne='emacs -nw'\" &gt;&gt; .bashrc\nsource /.bashrc\n\n# Creating .ssh dir\nsudo mkdir -p ~/.ssh\n\n# Generating ssh requirements\nsudo ssh-keygen -q -t rsa -f ~/.ssh/id_rsa -N ''\n\n# Injecting ssh key\nsudo echo \"ssh-rsa xxxx...... john@doe.com\" &gt; micro_service.pub\nsudo mv micro_service.pub ~/.ssh/\n\nsudo echo \"-----BEGIN OPENSSH PRIVATE KEY-----\nxxxxxxxxxxxxxxxxxxxxx......\n-----END OPENSSH PRIVATE KEY-----\" &gt; micro_service\nsudo mv micro_service ~/.ssh/\n\n# Injecting conf\nsudo echo \"Host gitlab\n    Hostname gitlab.com\n    IdentityFile ~/.ssh/micro_service\n    User john@doe.com\" &gt; config\nsudo mv config ~/.ssh/\n\n# adding knows hosts\nssh-keyscan -t rsa gitlab.com &gt;&gt; ~/.ssh/known_hosts\n\n# Get the service's source code.\ngit clone git@gitlab.com:PROJECT/MY-SERVICE.git service\n\n# Create a goapp user. The application will run as this user.\nsudo getent passwd goapp || sudo /usr/sbin/useradd -m -d /home/goapp goapp\nsudo chown -R goapp:goapp /service\n\n# Configure supervisor to run the Go app.\nsudo echo \"\n[program:goapp]\ndirectory=/service\ncommand=/service/main argument1 argument2\nautostart=true\nautorestart=true\nuser=goapp\nenvironment=HOME=\\\"/home/goapp\\\",USER=\\\"goapp\\\"\nstdout_logfile=syslog\nstderr_logfile=syslog\n\" &gt; goapp.conf\n\nsudo mv goapp.conf /etc/supervisor/conf.d/goapp.conf\n\nsudo supervisorctl reread\nsudo supervisorctl update\n\n# Application should now be running under supervisor\n</code></pre>\n\n<p>After all of this, it still doesn't work (now stuck on some new gitlab issues..).</p>\n\n<p>Do I have the right approach? Is it really the way to go because it seems really hard when it should be way easier... (I create the instance, script gets ran. It clones the service and run it using <code>supervisor</code>).</p>\n\n<p>There is the CLI I am using to create my instance:</p>\n\n<pre><code>gcloud compute instances create my-instance \\\n    --image-family=debian-9 \\\n    --image-project=debian-cloud \\\n    --machine-type=g1-small \\\n    --scopes userinfo-email,cloud-platform \\\n    --metadata-from-file startup-script=startup-script.sh \\\n    --zone us-central1-f \\\n    --tags http-server\n</code></pre>\n"}, {"tags": ["go", "concurrency"], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 1, "last_activity_date": 1572879630, "creation_date": 1572879630, "answer_id": 58695998, "question_id": 58695909, "link": "https://stackoverflow.com/questions/58695909/how-to-handle-concurrency-map-for-range/58695998#58695998", "title": "How to handle concurrency map for range", "body": "<p>You do not have a concurrency problem. There is no guarantee to the ordering of keys in a map. If you need ordered pairs, use a struct slice:</p>\n\n<pre><code>type pair struct {\n   Key string\n   Value string\n}\n\nmapPagination := []pair{{Key:`OFFSET`,Value:offset}, \n   {Key:`ROWS FETCH FIRST`,Value: limit},\n   {Key:`ROW ONLY:keyOnly`}}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4019226, "user_type": "registered", "profile_image": "https://graph.facebook.com/1796966002/picture?type=large", "display_name": "Viko Wijaya", "link": "https://stackoverflow.com/users/4019226/viko-wijaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1572887060, "answer_count": 1, "score": -3, "last_activity_date": 1572887157, "creation_date": 1572879326, "last_edit_date": 1572886996, "question_id": 58695909, "link": "https://stackoverflow.com/questions/58695909/how-to-handle-concurrency-map-for-range", "closed_reason": "Duplicate", "title": "How to handle concurrency map for range", "body": "<p>I want to for range map so the result can be OFFSET, ROWS FETCH FIRST, ROW ONLY. </p>\n\n<p>But because of concurrent my code can become OFFSET, ROW ONLY, ROWS FETCH FIRST. </p>\n\n<p>How to keep the order like OFFSET, ROWS FETCH FIRST, ROW ONLY? or maybe prevent the concurrent.</p>\n\n<p>Already tried using WaitGroup, wg.Add wg.Done wg.Wait and still not working</p>\n\n<pre><code>mapPagination := map[string]interface{}{`OFFSET`: offset, `ROWS FETCH FIRST`: limit, `ROW ONLY:keyOnly`: ``}\n\nfor kPagination, vPagination := range pagination {\n    if strings.Contains(kPagination, \"keyOnly\") {\n        kPagination = strings.Replace(kPagination, \":keyOnly\", \"\", 1)\n        slicesPagination = append(slicesPagination, fmt.Sprintf(\"%s\", kPagination))\n    } else {\n        slicesPagination = append(slicesPagination, fmt.Sprintf(\"%s $%s\", kPagination, ParseString(index)))\n        values = append(values, vPagination)\n    }\n\n    index++\n}\n</code></pre>\n"}, {"tags": ["bash", "go", "makefile", "circleci"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572944166, "post_id": 58695168, "comment_id": 103709536, "body": "Why not use the official <a href=\"https://github.com/golangci/golangci-lint/releases\" rel=\"nofollow noreferrer\">golangci-lint Docker images</a>?"}, {"owner": {"reputation": 203, "user_id": 4944549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-SLFKgr8IBRY/AAAAAAAAAAI/AAAAAAAAF3A/71fQPA6bYRE/photo.jpg?sz=128", "display_name": "vijay krishna", "link": "https://stackoverflow.com/users/4944549/vijay-krishna"}, "edited": false, "score": 0, "creation_date": 1572950348, "post_id": 58695168, "comment_id": 103713020, "body": "<a href=\"https://circleci.com/orbs/registry/orb/gotest/tools#commands-install-golangci-lint\" rel=\"nofollow noreferrer\">circleci.com/orbs/registry/orb/gotest/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 693, "user_id": 3297761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGv4e.jpg?s=128&g=1", "display_name": "EduLopez", "link": "https://stackoverflow.com/users/3297761/edulopez"}, "is_accepted": true, "score": 1, "last_activity_date": 1572988580, "creation_date": 1572988580, "answer_id": 58719587, "question_id": 58695168, "link": "https://stackoverflow.com/questions/58695168/using-golang-ci-lint-in-circleci/58719587#58719587", "title": "Using golang-ci-lint in circleci", "body": "<p>The way I do it is</p>\n\n<p>1- I let circle CI install golangci-lint </p>\n\n<p><code>curl -sfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh| sh -s -- -b $(go env GOPATH)/bin v1.20.0</code></p>\n\n<p>2- My make file only has the golangci-lint call</p>\n\n<pre><code>lint: \n    @golangci-lint run\n</code></pre>\n\n<p>3-Circle CI step call my makefile</p>\n\n<pre><code>validate-lint:\n    ...\n    steps:\n      - run:\n          name: \"Validate lint\"\n          command: |\n            curl -sfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh| sh -s -- -b $(go env GOPATH)/bin v1.20.0\n            make lint\n</code></pre>\n"}], "owner": {"reputation": 637, "user_id": 10817276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3483337c13bdb9f2146744dc76999f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny M", "link": "https://stackoverflow.com/users/10817276/jenny-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1484, "favorite_count": 2, "accepted_answer_id": 58719587, "answer_count": 1, "score": 1, "last_activity_date": 1572988580, "creation_date": 1572876623, "last_edit_date": 1572938583, "question_id": 58695168, "link": "https://stackoverflow.com/questions/58695168/using-golang-ci-lint-in-circleci", "title": "Using golang-ci-lint in circleci", "body": "<p>I've a <code>Makefile</code> which is running some targets on circleci\nThis is the target of the <code>Makefile</code></p>\n\n<pre><code>install_lint:\n    curl -sfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh| sh -s v1.21.0\n</code></pre>\n\n<p>When I run on the second target <code>golangci-lint --version</code> I got error <code>golangci-lint: Command not found</code> </p>\n\n<p>I tried also with this </p>\n\n<p><code>curl -sfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh| sh -s -- -b $(go env GOPATH)/bin v1.21.0</code></p>\n\n<p>as Im runnig docker <code>1.13.2</code> </p>\n\n<pre><code>version: 2\njobs:\n  build:\n    docker:\n      - image: circleci/golang:1.13.3\n\n</code></pre>\n\n<p>Any idea what am I missing here ? how to make the binary usable ?</p>\n\n<p>I've also tried something like </p>\n\n<pre><code>install_lint:\n\n    curl -sLO https://github.com/golangci/golangci-lint/releases/download/v${GOLANGCI_VERSION}/golangci-lint-${GOLANGCI_VERSION}-linux-amd64.tar.gz\n    tar -xzvf golangci-lint-${GOLANGCI_VERSION}-linux-amd64.tar.gz\n    cp golangci-lint-${GOLANGCI_VERSION}-linux-amd64/golangci-lint /usr/local/bin/golangci-lint &amp;&amp; chmod +x /usr/local/bin/golangci-lint\n</code></pre>\n\n<p>and I got error </p>\n\n<p><code>cp: cannot create regular file '/usr/local/bin/golangci-lint': Permission denied</code> </p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 369, "user_id": 5530652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44f2a3b25fb8c1f1f09200dceae37ded?s=128&d=identicon&r=PG&f=1", "display_name": "Yosi Karl", "link": "https://stackoverflow.com/users/5530652/yosi-karl"}, "is_accepted": false, "score": 0, "last_activity_date": 1572880224, "creation_date": 1572880224, "answer_id": 58696159, "question_id": 58694500, "link": "https://stackoverflow.com/questions/58694500/how-to-get-decodebytes-output-without-canonical-extended-json-additions/58696159#58696159", "title": "How to get DecodeBytes() output without canonical extended JSON additions", "body": "<p>The solution was to use <code>Decode</code> function to <code>bson.M</code> and than <code>json.Marshal</code> it:</p>\n\n<pre><code>    var document bson.M\n    err := findResult.Decode(&amp;document)\n    if err != nil {\n        fmt.Println(err.Error())\n        return \"\"\n    }\n    resBytes, err := json.Marshal(document)\n    if err != nil {\n        fmt.Println(err)\n        return \"\"\n    }\n    return string(resBytes)\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 5530652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44f2a3b25fb8c1f1f09200dceae37ded?s=128&d=identicon&r=PG&f=1", "display_name": "Yosi Karl", "link": "https://stackoverflow.com/users/5530652/yosi-karl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572880224, "creation_date": 1572874318, "last_edit_date": 1572876003, "question_id": 58694500, "link": "https://stackoverflow.com/questions/58694500/how-to-get-decodebytes-output-without-canonical-extended-json-additions", "title": "How to get DecodeBytes() output without canonical extended JSON additions", "body": "<p>I use <code>DecodeBytes()</code> function to get the data from mongoDB (as the struct of the data can varies) with mongo-driver for Go.<br>\nMy problem is when one of the values is int/double (and not string).<br>\n In that case it add adds some stuff of canonical extended JSON, for example <code>3</code> to <code>\"$numberDouble\": \"3.0\"</code>.</p>\n\n<p>How can I remove those additions of the canonical extended JSON?</p>\n\n<pre><code>func (m *Mongoclient) Find(collection string, filter interface{}) string {\n    findResult := m.Db.Collection(collection).FindOne(m.Ctx, filter)\n    if findResult.Err() != nil {\n        fmt.Println(findResult.Err().Error())\n        return \"\"\n    }\n    db, err := findResult.DecodeBytes()\n    if err != nil {\n        fmt.Println(err.Error())\n        return \"\"\n    }\n    return db.String()\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572875435, "post_id": 58693733, "comment_id": 103686247, "body": "Could you create a mcve? client sessions and write concern are not related to the usecase with a standalone db. It would be great to see the code to confirm you are waiting for write operation to complete before trying to read."}, {"owner": {"reputation": 701, "user_id": 2342806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f6fc4a06026c58a43fb5f515d98e8c4?s=128&d=identicon&r=PG", "display_name": "Kostya Vasilyev", "link": "https://stackoverflow.com/users/2342806/kostya-vasilyev"}, "reply_to_user": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572876711, "post_id": 58693733, "comment_id": 103686880, "body": "Alex, my code on the update side is like this:  \tres, err := collection.UpdateOne(context.Background(), \t\tbson.M{&quot;_id&quot;: folder.Id}, \t\tbson.M{ \t\t\t&quot;$set&quot;: values, \t\t}, \t)"}, {"owner": {"reputation": 701, "user_id": 2342806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f6fc4a06026c58a43fb5f515d98e8c4?s=128&d=identicon&r=PG", "display_name": "Kostya Vasilyev", "link": "https://stackoverflow.com/users/2342806/kostya-vasilyev"}, "reply_to_user": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572876828, "post_id": 58693733, "comment_id": 103686946, "body": "Alex,  Re: &quot;confirm you are waiting for write operation to complete before trying to read&quot;  Sorry how do I do that?  I thought casual consistency meant that Mongo would guarantee that a read that &quot;happens after&quot; a write would see the write&#39;s effects, automatically? Is this assumption wrong?"}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572877674, "post_id": 58693733, "comment_id": 103687376, "body": "That&#39;s right but only if your guarantee your reads &quot;happen after&quot; the writes. That&#39;s why I asked to see how you sync your gouroutines. Mongo knows nothing about them. It&#39;s your job to ensure read requests are sent to the db after write requests. Then the db will guarantee the consistency on its side - the reads will see results of writes."}, {"owner": {"reputation": 701, "user_id": 2342806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f6fc4a06026c58a43fb5f515d98e8c4?s=128&d=identicon&r=PG", "display_name": "Kostya Vasilyev", "link": "https://stackoverflow.com/users/2342806/kostya-vasilyev"}, "reply_to_user": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572877763, "post_id": 58693733, "comment_id": 103687425, "body": "Re: It&#39;s your job to ensure read requests are sent to the db after write requests.  Ah thanks. Yes my reads are after my writes, first it&#39;s how the code is structured and second there are logging Printf&#39;s which I see in the terminal window.  How can I check if casual consistency is in fact enabled?"}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572883129, "post_id": 58693733, "comment_id": 103690318, "body": "I would enable oplog to confirm the order of requests on the db side agrees with what you se in the console on the client. &quot;How the code is structured&quot; - that&#39;s exactly what I am asking to check. Goroutines are not real threads after all. Casual consistency is enabled from v3.6 (with fCV 3.6+) for all queries within the same session. A standalone db instead of replicaset significantly simplifies data logistic and should be consistent anyway. If it the issue is reproducible I&#39;d report it."}, {"owner": {"reputation": 701, "user_id": 2342806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f6fc4a06026c58a43fb5f515d98e8c4?s=128&d=identicon&r=PG", "display_name": "Kostya Vasilyev", "link": "https://stackoverflow.com/users/2342806/kostya-vasilyev"}, "reply_to_user": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572886695, "post_id": 58693733, "comment_id": 103692141, "body": "Thank you. I&#39;m working on a mcve, no luck so far. I&#39;ll double check my concurrency but there actually is a fairly good (1/2 second or so) delay between the write and the read: post-write, the code sends a network message to a &quot;client&quot; and the client then comes back over http which performs the read."}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572892076, "post_id": 58693733, "comment_id": 103694495, "body": "Receiving stale data after 500 millis on an idle standalone database is quite unusual. It cant be because of concurrency alone. It would be great if you can extract and share the minimal code that reproduces it."}, {"owner": {"reputation": 701, "user_id": 2342806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f6fc4a06026c58a43fb5f515d98e8c4?s=128&d=identicon&r=PG", "display_name": "Kostya Vasilyev", "link": "https://stackoverflow.com/users/2342806/kostya-vasilyev"}, "reply_to_user": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1572896668, "post_id": 58693733, "comment_id": 103696194, "body": "I keep trying with the minimal code, nothing yet. In my real project the failure is more likely to occur if just prior to the &quot;bad&quot; section, there is also data being inserted (to a different collection).  I also added &quot;sanity check&quot; code to read back the just updated values immediately after UpdateOne with FindOne - and when the larger failure occurs (between two coroutines), the sanity check also fails.  More details if you could read this please:  <a href=\"https://groups.google.com/d/msg/mongodb-go-driver/Y-AA_hjzMpU/D6rlfbVCBAAJ\" rel=\"nofollow noreferrer\">groups.google.com/d/msg/mongodb-go-driver/Y-AA_hjzMpU/&hellip;</a>  And thanks for your help so far!"}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 1, "creation_date": 1572908040, "post_id": 58693733, "comment_id": 103700203, "body": "Causal Consistency requires the use of explicit session. Please see <a href=\"https://docs.mongodb.com/manual/core/causal-consistency-read-write-concerns/\" rel=\"nofollow noreferrer\">docs.mongodb.com/manual/core/&hellip;</a>"}, {"owner": {"reputation": 701, "user_id": 2342806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f6fc4a06026c58a43fb5f515d98e8c4?s=128&d=identicon&r=PG", "display_name": "Kostya Vasilyev", "link": "https://stackoverflow.com/users/2342806/kostya-vasilyev"}, "edited": false, "score": 0, "creation_date": 1572932203, "post_id": 58693733, "comment_id": 103704981, "body": "Thank you Wan I think this was the missing piece."}, {"owner": {"reputation": 701, "user_id": 2342806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f6fc4a06026c58a43fb5f515d98e8c4?s=128&d=identicon&r=PG", "display_name": "Kostya Vasilyev", "link": "https://stackoverflow.com/users/2342806/kostya-vasilyev"}, "reply_to_user": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1572938840, "post_id": 58693733, "comment_id": 103707192, "body": "@WanBachtiar - Seems I can make the issue go away by using readConcern = Local  Is this an appropriate fix if I&#39;m interested in SQL-like behavior, where a read that starts after a write has completed is guaranteed to see the results of that write?  I&#39;m having trouble finding answers in the docs which seem to focus a lot on replication and multi-node installations."}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1573523969, "post_id": 58693733, "comment_id": 103901260, "body": "@KostyaVasilyev I don&#39;t think <code>readConcern</code> local guarantees the behaviour that you desired. Without an mcve to look into, it&#39;s quite hard to tell how your co-routines guarantees order of execution in itself."}], "owner": {"reputation": 701, "user_id": 2342806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f6fc4a06026c58a43fb5f515d98e8c4?s=128&d=identicon&r=PG", "display_name": "Kostya Vasilyev", "link": "https://stackoverflow.com/users/2342806/kostya-vasilyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572872311, "creation_date": 1572871444, "last_edit_date": 1572872311, "question_id": 58693733, "link": "https://stackoverflow.com/questions/58693733/causal-consistency-with-mongo-4-2-1-and-go-driver-1-1-2", "title": "Causal consistency with Mongo 4.2.1 and Go driver 1.1.2", "body": "<p>I'm seeing some violations of \"read what you wrote\" with Mongo 4.2.1 and Go driver 1.1.2</p>\n\n<p>This is on my development machine (Ubuntu), there is no cluster, just a single database, and it's quite small (hundreds of documents if that).</p>\n\n<p>It has plenty of memory (32 gigabytes) and a fast disk (NVME). The file system is ext4 (I know XFS is preferred for performance, but there is barely any load here).</p>\n\n<p>What happens is: one GO coroutine issues an update of a small document, setting a integer (Number) to a new value.</p>\n\n<p>A second or so later, another thread does a read and does not see the write. Sometimes.</p>\n\n<p>Repeating the read a few seconds later will then properly read back the new value.</p>\n\n<p>Both threads (GO coroutines) use the same Mongo connection.</p>\n\n<p>I tried to configure a read and a write concern like below, even though it's my understanding that \"majority\" is the default for both. It did not help.</p>\n\n<pre><code>readConcern := readconcern.Majority()\n\nwriteConcern := &amp;writeconcern.WriteConcern{}\nwriteConcern = writeConcern.WithOptions(\n   writeconcern.WMajority())\n\nmongoConn, mongoErr := mongo.Connect(mongoCtx, &amp;options.ClientOptions{\n   Hosts:        []string{\"localhost\"},\n   ReadConcern:  readConcern,\n   WriteConcern: writeConcern})\n</code></pre>\n\n<p>From reading the docs*, I'm not clear if casual consistency should be automatically enabled for Mongo 3.6 or newer, or if it's something that needs to be enabled by the application or the driver.</p>\n\n<p>If the latter, how do I enable casual consistency with the official GO driver?</p>\n\n<p>[*] <a href=\"https://docs.mongodb.com/manual/core/read-isolation-consistency-recency/#sessions\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/core/read-isolation-consistency-recency/#sessions</a></p>\n"}, {"tags": ["go", "import", "package"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1572876456, "post_id": 58693718, "comment_id": 103686757, "body": "It means you&#39;re importing the package with a different path. But since you haven&#39;t included your code, it&#39;s impossible to tell you exactly what to fix."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1572876738, "post_id": 58695160, "comment_id": 103686895, "body": "@Coolman, please do not let &quot;quickly ask on SO without putting any thought into the problem&quot; be your main problem-solving tactic\u2014it&#39;s impossibe to become proficient in software engeneering while posessing this anti-skill. Please read <a href=\"https://whathaveyoutried.com/\" rel=\"nofollow noreferrer\">this</a> for more background."}, {"owner": {"reputation": 2617, "user_id": 81845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b73333fa9a02be19ceedc0fddb87587?s=128&d=identicon&r=PG", "display_name": "Matt Good", "link": "https://stackoverflow.com/users/81845/matt-good"}, "edited": false, "score": 0, "creation_date": 1587512189, "post_id": 58695160, "comment_id": 108540061, "body": "While these suggestions are probably helpful for other vendoring problems, it&#39;s not as obvious here since the problem is actually with packages vendored in the Go standard library (<code>go-1.10&#47;src&#47;vendor&#47;golang_org</code>). It does also happen specifically with the debugger. As I mentioned in my answer I&#39;m not certain if it&#39;s general problem with Delve or just how VSCode is calling it. The OP could have provided more details, but the answer isn&#39;t as obvious in this situation since it isn&#39;t from packages in their own project, but an odd interaction between multiple Go versions and the debugger."}, {"owner": {"reputation": 175, "user_id": 13345667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b4c88ba8d10ab098c273e2a02b0049?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Naden", "link": "https://stackoverflow.com/users/13345667/anna-naden"}, "edited": false, "score": 0, "creation_date": 1600139828, "post_id": 58695160, "comment_id": 112986299, "body": "I too get the message that my code &quot;expects&quot; an import. What does it mean that code &quot;expects&quot; something? It seems to be finding the package - when I change the name I am trying to import, I get a different message, so that means that it sees the package I guess. So what is the expectation and what does it mean that the expectaition is not fulfiled. THe package I am trying to import is the standard tutorial package rsc.io/quote \u2013"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 175, "user_id": 13345667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b4c88ba8d10ab098c273e2a02b0049?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Naden", "link": "https://stackoverflow.com/users/13345667/anna-naden"}, "edited": false, "score": 0, "creation_date": 1600163307, "post_id": 58695160, "comment_id": 112994510, "body": "Hi, @AnnaNaden! Have you read that bit about canonical imports I gave a link to in my answer? I&#39;m asking because your remarks appear to me as if you are not familiar with what &quot;canonical imports&quot; are about, which is a bit strange given the current context."}, {"owner": {"reputation": 175, "user_id": 13345667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b4c88ba8d10ab098c273e2a02b0049?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Naden", "link": "https://stackoverflow.com/users/13345667/anna-naden"}, "edited": false, "score": 0, "creation_date": 1600229122, "post_id": 58695160, "comment_id": 113017938, "body": "@kostix, I read it but it was difficult to relate it to my problem. It sounds like perhaps the messages &quot;code expects import...&quot; is the refusal to import that is mentioned in the reference you provided. Is that right? *My question is how to interepret the &quot;code expects import...&quot; message. The reference says to remove a package &quot;manually.&quot; I don&#39;t know what that means. Presumably there are some files there that one deletes and that is &quot;manual removal.&quot; Is that right?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 175, "user_id": 13345667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b4c88ba8d10ab098c273e2a02b0049?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Naden", "link": "https://stackoverflow.com/users/13345667/anna-naden"}, "edited": false, "score": 0, "creation_date": 1600255214, "post_id": 58695160, "comment_id": 113028292, "body": "@AnnaNaden, can you re-ask your question using <a href=\"https://github.com/golang/go/wiki#the-go-community\" rel=\"nofollow noreferrer\">a venue other than SO</a>? Solving your issues requires multiple backs-and-forths, and SO is absolutely unfit for such exchanges (and they are actually prohibited by the rules). <code>r&#47;golang</code> on Reddit or the mailing list would be fine. Please be sure to include exact names of packages and error messages. A piece of code which could be used to recreate the problem would be ideal."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1572876601, "creation_date": 1572876601, "answer_id": 58695160, "question_id": 58693718, "link": "https://stackoverflow.com/questions/58693718/error-code-in-directory-expects-import-what-do-i-do/58695160#58695160", "title": "Error: code in directory ... expects import &quot;...&quot; - what do I do?", "body": "<p>Your problem has nothing to do with the debugger. If you <a href=\"https://stackoverflow.com/search?q=%5Bgo%5D+code+in+directory+expects+import\">would have searched for the key parts of these errors</a>, you would have discovered that the error is due to the fact since v1.4 Go supports so-called <a href=\"https://golang.org/doc/go1.4#canonicalimports\" rel=\"nofollow noreferrer\">\"canonical imports\"</a>.</p>\n\n<p>Most probably some packages in your project were vendored using their \"hosting\" URLs (such as <code>github.com/what/ever</code>) instead of their canonical URLs suggested by the error message.</p>\n\n<p>The proper solution is to revendor the affecting packages the correct way.</p>\n\n<p>If you merely want the code to build \"as is\" no matter what, you could edit the code of these packages to remove \"canonical import comments\" from them.</p>\n"}, {"tags": [], "owner": {"reputation": 2617, "user_id": 81845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b73333fa9a02be19ceedc0fddb87587?s=128&d=identicon&r=PG", "display_name": "Matt Good", "link": "https://stackoverflow.com/users/81845/matt-good"}, "is_accepted": false, "score": 1, "last_activity_date": 1587511607, "creation_date": 1587511607, "answer_id": 61354862, "question_id": 58693718, "link": "https://stackoverflow.com/questions/58693718/error-code-in-directory-expects-import-what-do-i-do/61354862#61354862", "title": "Error: code in directory ... expects import &quot;...&quot; - what do I do?", "body": "<p>This seems to happen when you have a newer version of Go available on your <code>PATH</code>.</p>\n\n<p>I worked around it by uninstalling Go 1.13 from /usr/local, but there may be better ways to handle it if you need to have multiple versions installed.</p>\n\n<p>I had the VSCode Go debugger working with <code>go.goroot</code> set to a Go 1.11 install I was using for my project. I installed Go 1.13 into /usr/local to test out a feature and then ran into this same error.</p>\n\n<p>If you have a different Go version on the <code>PATH</code> it seems like it's using that compiler, but compiling against the standard library sources in your other Go version. In later Go versions this directory has been renamed back to <code>vendor/golang.org</code>, and it doesn't recognize the <code>golang_org</code> hack that was used previously:\n<a href=\"https://github.com/golang/go/commit/4d00937cecdea85b6f1eb894a6d28a53f5f2ff8a#diff-44c7c5a1dcc556d22e115d30ec0f11c9\" rel=\"nofollow noreferrer\">https://github.com/golang/go/commit/4d00937cecdea85b6f1eb894a6d28a53f5f2ff8a#diff-44c7c5a1dcc556d22e115d30ec0f11c9</a></p>\n\n<p>I'm not certain if this is a general problem with Delve, or an issue with how the VSCode Go extension calls it, but the simplest solution in my situation was to uninstall Go 1.13 and the debugger started working again.</p>\n"}], "owner": {"reputation": 66, "user_id": 7794201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/304ca6e020a45cdb7afd74aaed77b423?s=128&d=identicon&r=PG&f=1", "display_name": "Coolman", "link": "https://stackoverflow.com/users/7794201/coolman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1408, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1587511607, "creation_date": 1572871398, "last_edit_date": 1572876410, "question_id": 58693718, "link": "https://stackoverflow.com/questions/58693718/error-code-in-directory-expects-import-what-do-i-do", "title": "Error: code in directory ... expects import &quot;...&quot; - what do I do?", "body": "<p>I have project in Go. After I set up debugger and launch in Visual Code,\nit failed with this error output. I am using go 1.13.4 in <code>/usr/local/go</code></p>\n\n<p><code>/usr/lib/go-1.10/src/crypto/tls/cipher_suites.go:18:2: code in directory /usr/lib/go-1.10/src/vendor/golang_org/x/crypto/chacha20poly1305 expects import \"golang.org/x/crypto/chacha20poly1305\"\n/usr/lib/go-1.10/src/crypto/x509/x509.go:36:2: code in directory /usr/lib/go-1.10/src/vendor/golang_org/x/crypto/cryptobyte expects import \"golang.org/x/crypto/cryptobyte\"\n/usr/lib/go-1.10/src/crypto/x509/x509.go:37:2: code in directory /usr/lib/go-1.10/src/vendor/golang_org/x/crypto/cryptobyte/asn1 expects import \"golang.org/x/crypto/cryptobyte/asn1\"\n/usr/lib/go-1.10/src/crypto/tls/key_agreement.go:20:2: code in directory /usr/lib/go-1.10/src/vendor/golang_org/x/crypto/curve25519 expects import \"golang.org/x/crypto/curve25519\"\n/usr/lib/go-1.10/src/net/http/h2_bundle.go:48:2: code in directory /usr/lib/go-1.10/src/vendor/golang_org/x/net/idna expects import \"golang_org/x/text/internal/export/idna\"\n/usr/lib/go-1.10/src/net/http/transport.go:32:2: code in directory /usr/lib/go-1.10/src/vendor/golang_org/x/net/proxy expects import \"golang.org/x/net/proxy\"</code></p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 13, "user_id": 6514038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZwQy2b6z-4Y/AAAAAAAAAAI/AAAAAAAAABc/_8oUo5vOrjw/photo.jpg?sz=128", "display_name": "Abhi_FCB", "link": "https://stackoverflow.com/users/6514038/abhi-fcb"}, "edited": false, "score": 0, "creation_date": 1572865385, "post_id": 58692089, "comment_id": 103681425, "body": "Can someone please explain what will be the flow of execution here?"}, {"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "edited": false, "score": 0, "creation_date": 1572865530, "post_id": 58692089, "comment_id": 103681503, "body": "what exactly do you need? diagram?"}, {"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "edited": false, "score": 0, "creation_date": 1572865746, "post_id": 58692089, "comment_id": 103681583, "body": "brief desc: you take two numbers and make a <i>channel</i> form it with <code>gen</code>. then you pass that channel to <code>sq</code> and <code>sq</code> read data from channel until it closed (actually it closed in <code>gen</code>). <code>sq</code> makes new channel pass there two element then close it. then you read two elements with <code>fmt</code>"}, {"owner": {"reputation": 13, "user_id": 6514038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZwQy2b6z-4Y/AAAAAAAAAAI/AAAAAAAAABc/_8oUo5vOrjw/photo.jpg?sz=128", "display_name": "Abhi_FCB", "link": "https://stackoverflow.com/users/6514038/abhi-fcb"}, "reply_to_user": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "edited": false, "score": 0, "creation_date": 1572867584, "post_id": 58692089, "comment_id": 103682396, "body": "A diagram explanation might be helpful."}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 2, "last_activity_date": 1572873313, "last_edit_date": 1572873313, "creation_date": 1572865819, "answer_id": 58692219, "question_id": 58692089, "link": "https://stackoverflow.com/questions/58692089/how-will-the-flow-of-execution-of-the-given-code-will-be-and-also-how-will-the/58692219#58692219", "title": "How will the flow of execution of the given code will be? And also how will the go-routines will execute here?", "body": "<p>Once calls to <code>gen</code> and <code>sq</code> are finished there are 3 goroutines running concurrently. They pass data between with channels and therefore the execution produces the same results.</p>\n\n<ol>\n<li>gen-inner</li>\n<li>sq-inner</li>\n<li>main</li>\n</ol>\n\n<p>They always pass at least 2 pieces of information through and therefore run their code in the order below</p>\n\n<ol>\n<li>gen-inner <code>out &lt;- n</code> -2-> sq-inner <code>out &lt;- n * n</code> -4-> main <code>println(&lt;-out)</code></li>\n<li>gen-inner <code>out &lt;- n</code> -3-> sq-inner <code>out &lt;- n * n</code> -9-> main <code>println(&lt;-out)</code></li>\n</ol>\n\n<p>There is also a third pass that may happen but it may be skipped as <code>main</code> goroutine ends.</p>\n\n<ol start=\"3\">\n<li>gen-inner <code>close()</code> -close-> sq-inner <code>close(out)</code> -close-></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "is_accepted": true, "score": 2, "last_activity_date": 1572870973, "last_edit_date": 1592644375, "creation_date": 1572870973, "answer_id": 58693599, "question_id": 58692089, "link": "https://stackoverflow.com/questions/58692089/how-will-the-flow-of-execution-of-the-given-code-will-be-and-also-how-will-the/58693599#58693599", "title": "How will the flow of execution of the given code will be? And also how will the go-routines will execute here?", "body": "<p><a href=\"https://i.stack.imgur.com/EJVsH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EJVsH.png\" alt=\"enter image description here\" /></a></p>\n<p>Hope it helps. It goroutine pipeline diagram. So there are three goroutines and two channels</p>\n"}], "owner": {"reputation": 13, "user_id": 6514038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZwQy2b6z-4Y/AAAAAAAAAAI/AAAAAAAAABc/_8oUo5vOrjw/photo.jpg?sz=128", "display_name": "Abhi_FCB", "link": "https://stackoverflow.com/users/6514038/abhi-fcb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 58693599, "answer_count": 2, "score": 1, "last_activity_date": 1572873313, "creation_date": 1572865333, "question_id": 58692089, "link": "https://stackoverflow.com/questions/58692089/how-will-the-flow-of-execution-of-the-given-code-will-be-and-also-how-will-the", "title": "How will the flow of execution of the given code will be? And also how will the go-routines will execute here?", "body": "<p>(New to concurrent programming)\nHad a doubt about why is the flow of execution of goroutines a bit weird here? </p>\n\n<p>Beginner to goroutines and channels stuff in golang.</p>\n\n<pre><code>func main() {\n    // Set up the pipeline.\n    c := gen(2, 3)\n    out := sq(c)\n\n    // Consume the output.\n    fmt.Println(&lt;-out) // 4\n    fmt.Println(&lt;-out) // 9\n}\n\nfunc sq(in &lt;-chan int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        for n := range in {\n            out &lt;- n * n\n        }\n        close(out)\n    }()\n    return out\n}\n\nfunc gen(nums ...int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        for _, n := range nums {\n            out &lt;- n\n        }\n        close(out)\n    }()\n    return out\n}\n</code></pre>\n"}, {"tags": ["azure", "go", "azure-storage", "azure-storage-blobs"], "comments": [{"owner": {"reputation": 2560, "user_id": 5273580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/R28Ti.png?s=128&g=1", "display_name": "Falco Alexander", "link": "https://stackoverflow.com/users/5273580/falco-alexander"}, "edited": false, "score": 0, "creation_date": 1572863807, "post_id": 58691342, "comment_id": 103680716, "body": "afaik there are no real folders below the container level. Folders are only names and  part of the path"}, {"owner": {"reputation": 8769, "user_id": 1537195, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/xRBvI.jpg?s=128&g=1", "display_name": "silent", "link": "https://stackoverflow.com/users/1537195/silent"}, "edited": false, "score": 0, "creation_date": 1572863838, "post_id": 58691342, "comment_id": 103680731, "body": "Can you use azcopy? <code>azcopy sync &quot;https:&#47;&#47;[account].blob.core.windows.net&#47;[container]&#47;[path&#47;t&zwnj;&#8203;o&#47;virtual&#47;dir]?[SAS]&zwnj;&#8203;&quot; &quot;https:&#47;&#47;[account].blob.core.windows.net&#47;[container]&#47;[path&#47;t&zwnj;&#8203;o&#47;virtual&#47;dir]&quot; --recursive=true  </code> From: <a href=\"https://docs.microsoft.com/en-us/azure/storage/common/storage-ref-azcopy-sync?toc=%2fazure%2fstorage%2fblobs%2ftoc.json\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/azure/storage/common/&hellip;</a>"}, {"owner": {"reputation": 2249, "user_id": 2450936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/174d70ca270f9c1bdadb37ac9eaf8fe0?s=128&d=identicon&r=PG", "display_name": "howie", "link": "https://stackoverflow.com/users/2450936/howie"}, "edited": false, "score": 0, "creation_date": 1572864196, "post_id": 58691342, "comment_id": 103680875, "body": "@slient but I want to control by program, I know I can use go to control cmd by use azcopy"}, {"owner": {"reputation": 98670, "user_id": 188096, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hqrh.png?s=128&g=1", "display_name": "Gaurav Mantri", "link": "https://stackoverflow.com/users/188096/gaurav-mantri"}, "edited": false, "score": 0, "creation_date": 1572865778, "post_id": 58691342, "comment_id": 103681596, "body": "Please share any code that you have written."}], "answers": [{"comments": [{"owner": {"reputation": 2249, "user_id": 2450936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/174d70ca270f9c1bdadb37ac9eaf8fe0?s=128&d=identicon&r=PG", "display_name": "howie", "link": "https://stackoverflow.com/users/2450936/howie"}, "edited": false, "score": 0, "creation_date": 1572922334, "post_id": 58698664, "comment_id": 103703051, "body": "I don&#39;t get your point? For now I copy blob by full path (include virtual path), but I want to know is there any method I can just copy by virtual folder without traverse all blob within this virtual folder."}, {"owner": {"reputation": 2255, "user_id": 6591675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DvSsj.jpg?s=128&g=1", "display_name": "Adam Smith - Microsoft Azure", "link": "https://stackoverflow.com/users/6591675/adam-smith-microsoft-azure"}, "reply_to_user": {"reputation": 2249, "user_id": 2450936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/174d70ca270f9c1bdadb37ac9eaf8fe0?s=128&d=identicon&r=PG", "display_name": "howie", "link": "https://stackoverflow.com/users/2450936/howie"}, "edited": false, "score": 0, "creation_date": 1572924662, "post_id": 58698664, "comment_id": 103703450, "body": "Not really, not by virtual folder , only by path"}], "tags": [], "owner": {"reputation": 2255, "user_id": 6591675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DvSsj.jpg?s=128&g=1", "display_name": "Adam Smith - Microsoft Azure", "link": "https://stackoverflow.com/users/6591675/adam-smith-microsoft-azure"}, "is_accepted": false, "score": 1, "last_activity_date": 1572889734, "creation_date": 1572889734, "answer_id": 58698664, "question_id": 58691342, "link": "https://stackoverflow.com/questions/58691342/can-i-copy-azure-blob-folder-without-traverse-each-blob-file/58698664#58698664", "title": "Can I copy azure blob folder without traverse each blob file?", "body": "<p>Folder structure within azure blobs doesn't exist, instead it's using a path name, so if you want to copy blobs within a \"virtual folder\", all you need to do is use the path, below is an example in python listing blobs:</p>\n\n<pre><code>  ['Virtual-Folder/Boards.png', 'storage2.gif']\n</code></pre>\n\n<p>So in order to transfer the Boards.png blob, you'd have to append the folder name before it and not look within the folder. I wrote some tutorials in python pertaining to this example/issue: <a href=\"https://github.com/adamsmith0016/Azure-storage\" rel=\"nofollow noreferrer\">https://github.com/adamsmith0016/Azure-storage</a></p>\n"}], "owner": {"reputation": 2249, "user_id": 2450936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/174d70ca270f9c1bdadb37ac9eaf8fe0?s=128&d=identicon&r=PG", "display_name": "howie", "link": "https://stackoverflow.com/users/2450936/howie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572896679, "creation_date": 1572862729, "last_edit_date": 1572896679, "question_id": 58691342, "link": "https://stackoverflow.com/questions/58691342/can-i-copy-azure-blob-folder-without-traverse-each-blob-file", "title": "Can I copy azure blob folder without traverse each blob file?", "body": "<p>Currently I use golang to implement copy file from one storage account to another storage account.</p>\n\n<p>For example:</p>\n\n<pre><code>https://storage1.blob.core.windows.net/container/A/B/file1.mp4\nhttps://storage1.blob.core.windows.net/container/A/B/file2.mp4\nhttps://storage1.blob.core.windows.net/container/A/B/file3.mp4\n\n\nCopy from\n\nhttps://storage1.blob.core.windows.net/container/A/B/\nto \nhttps://storage2.blob.core.windows.net/container/A/B/\n</code></pre>\n\n<p>Can I copy entire folder without traverse all files in folder A/B?</p>\n\n<p>Here is my sample code</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\n\nfunc (css StorageOperator) NestedListBlobs(ctx context.Context, srcFolderPath string) ([]azblob.BlobURL, error) {\n\n    containerName, folderPath := css.getContainerNameAndPath(srcFolderPath)\n    containerRawUrl := \"https://\" + css.StorageName + \".\" + lib.AzureBlobUrl + \"/\" + containerName\n    containerUrl, _ := url.Parse(containerRawUrl)\n    po := azblob.NewPipeline(css.sharedKeyCredential, css.createPipelineOptions())\n    container := azblob.NewContainerURL(*containerUrl, po)\n\n    var blobUrls []azblob.BlobURL\n\n    // List the blob(s) in our container; since a container may hold millions of blobs, this is done 1 segment at a time.\n    for marker := (azblob.Marker{}); marker.NotDone(); {\n        // The parens around Marker{} are required to avoid compiler error.\n        // Get a result segment starting with the blob indicated by the current Marker.\n        listBlob, err := container.ListBlobsFlatSegment(ctx, marker, azblob.ListBlobsSegmentOptions{\n            Prefix: folderPath,\n        })\n        if err != nil {\n            return nil, err\n        }\n        // IMPORTANT: ListBlobs returns the start of the next segment; you MUST use this to get\n        // the next segment (after processing the current result segment).\n        marker = listBlob.NextMarker\n\n        // Process the blobs returned in this result segment (if the segment is empty, the loop body won't execute)\n        for _, blobInfo := range listBlob.Segment.BlobItems {\n            css.logger.Debugf(\"Blob name: \" + containerRawUrl + \"/\" + blobInfo.Name)\n\n            blobUrl, _ := url.Parse(containerRawUrl + \"/\" + blobInfo.Name)\n            blobUrls = append(blobUrls, azblob.NewBlobURL(*blobUrl, po))\n        }\n    }\n\n    return blobUrls, nil\n}\n\nfunc (css StorageOperator) parallelCopyFileToDst(ctx context.Context, po pipeline.Pipeline, dstRawUrl string, srcBlobs []azblob.BlobURL) error {\n\n\nfor _, srcBlob := range srcBlobs {\n\n\ndstUrl, _ := url.Parse(dstRawUrl + css.extractBlobPath(srcBlob))\n\ndstBlobURL := azblob.NewBlobURL(*dstUrl, po)\nsrcSASUrl, err := css.createSASURL(css.lukeSharedKeyCredential, srcBlob.String())\nif err != nil {\n    css.logger.Errorf(\"createSASURL fail:%v\", err)\n    return\n}\nstartCopy, err := dstBlobURL.StartCopyFromURL(ctx,\n                *srcSASUrl,\n                azblob.Metadata{},\n                azblob.ModifiedAccessConditions{},\n                azblob.BlobAccessConditions{})\n\nif err != nil {\n    css.logger.Errorf(\"startCopy fail:%v\", err)\n    return\n}\n\nif err = css.checkCopyStatus(ctx, dstBlobURL, startCopy); err != nil {\n                css.logger.Errorf(\"checkCopyStatus fail:%v\", err)\n                return\n}\n\n\n}//for\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 6763932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8519ce28a7a59b933ffd5d23aa9db90a?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Brasi", "link": "https://stackoverflow.com/users/6763932/luca-brasi"}, "edited": false, "score": 0, "creation_date": 1572864405, "post_id": 58691541, "comment_id": 103680962, "body": "Thanks @Peter. With the addition of a mutex, I don&#39;t have anymore truncated/unordered output"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1572863450, "creation_date": 1572863450, "answer_id": 58691541, "question_id": 58691154, "link": "https://stackoverflow.com/questions/58691154/bufio-scanner-goroutine-truncated-unordered-output/58691541#58691541", "title": "Bufio Scanner Goroutine - truncated/unordered output", "body": "<p><a href=\"https://golang.org/pkg/bufio/#Scanner.Bytes\" rel=\"nofollow noreferrer\">From the Scanner docs</a>:</p>\n\n<blockquote>\n  <p>Bytes returns the most recent token generated by a call to Scan. <em>The underlying array may point to data that will be overwritten by a subsequent call to Scan</em>. It does no allocation.</p>\n</blockquote>\n\n<p>gRPC does its own buffering. This means that when Send returns, the bytes have not necessarily been written to the wire yet, and the next Scan call modifies the yet-to-be-written bytes.</p>\n\n<p>Copy the bytes returned by Scan and you should be fine:</p>\n\n<pre><code>for scanner.Scan() {\n    b := append([]byte(nil), scanner.Bytes()...)\n    stream.Send(&amp;agentpb.ScanResultsResponse{\n        ScanLogsWebsocket: &amp;agentpb.ScanLogFileResponseWB{\n            ScanLogs: b,\n        },\n    })\n}\n</code></pre>\n"}], "owner": {"reputation": 433, "user_id": 6763932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8519ce28a7a59b933ffd5d23aa9db90a?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Brasi", "link": "https://stackoverflow.com/users/6763932/luca-brasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58691541, "answer_count": 1, "score": 0, "last_activity_date": 1572863450, "creation_date": 1572862133, "question_id": 58691154, "link": "https://stackoverflow.com/questions/58691154/bufio-scanner-goroutine-truncated-unordered-output", "title": "Bufio Scanner Goroutine - truncated/unordered output", "body": "<p>I'm writing a program that reads stderr from a CLI command and streams the stderr logs via a gRPC stream to the client.</p>\n\n<p>The cmd is instantiated as below (the CLI command requires configuration which I pass as stdin):</p>\n\n<pre><code>ctxTimeout, cancel := context.WithTimeout(context.Background(), time.Duration(t)*time.Second)\n\ndefer cancel()\n\ncmd := exec.CommandContext(ctxTimeout, \"java\",\n    \"-jar\", \"/opt/myapp/myapp.jar\", \"scan\", \"-config\", \"-\",\n)\n\ncmd.Stdin = config\n</code></pre>\n\n<p>I'm using two separate buffers: one to stream the stderr \"live\" to a client, the other to persist the logs in a DB. For that, I use io.MultiWriter and map it to the cmd stdin:</p>\n\n<pre><code>bufStream := bytes.NewBuffer(make([]byte, 0, 4096))\n\nbufPersist := new(bytes.Buffer)\n\n\nstderr := io.MultiWriter(bufStream, bufPersist)\n\n// Map the command Standard Error Output to the multiwriter\ncmd.Stderr = stderr\n</code></pre>\n\n<p>Finally, before launching the command I have a goroutine below which uses bufio.Scanner in order to read the stderr buffer and stream line by line via gRPC:</p>\n\n<pre><code>// Go Routine to stream the scan job logs\ngo func() {\n    for {\n        select {\n        case &lt;-done:\n            return\n        default:\n            scanner := bufio.NewScanner(bufStream)\n            for scanner.Scan() {\n                time.Sleep(3 * time.Second)\n                logging.MyAppLog(\"warning\", \"%v\", scanner.Text())\n                _ = stream.Send(&amp;agentpb.ScanResultsResponse{\n                    ScanLogsWebsocket: &amp;agentpb.ScanLogFileResponseWB{ScanLogs: scanner.Bytes()},\n                },\n                )\n            }\n\n        }\n    }\n\n}()\nerr := cmd.Run()\n\ndone &lt;- true\n</code></pre>\n\n<p>My issue is I have to use <code>time.sleep(time.Seconds * 3)</code> in the goroutine in order to get the right output. If not, I'm getting the output in incorrect order and truncated. </p>\n\n<p>I believe it is due to the io.multiwriter and bufio.scanner not \"in sync\" but I would like some guidance on the best approach.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 2, "creation_date": 1572851822, "post_id": 58688655, "comment_id": 103675486, "body": "See <a href=\"https://stackoverflow.com/q/40828156/1256452\">stackoverflow.com/q/40828156/1256452</a>: Why interface don&#39;t implement method with pointer reference while direct access is still possible? - does that cover the cases you&#39;re wondering about?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1572853728, "post_id": 58688655, "comment_id": 103676133, "body": "&quot;when can&#39;t the compiler take a value to a pointer receiver value?&quot; As explained in the second paragraph cited from the spec: Always. If you are interested in part marked bold in the spec: Some things are not addressable, e.g. a function: It is impossible to take the address of function. (if you are new to Go: This is pretty much uninteresting.)"}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1572863923, "creation_date": 1572863923, "answer_id": 58691681, "question_id": 58688655, "link": "https://stackoverflow.com/questions/58688655/when-a-receiver-method-t-cannot-take-t/58691681#58691681", "title": "When a receiver method T cannot take *T?", "body": "<p>Addressable is defined in the <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Address_operators</a>:</p>\n\n<blockquote>\n  <p>For an operand x of type T, the address operation &amp;x generates a pointer of type *T to x. The operand must be <em>addressable</em>, that is, either a variable, pointer indirection, or slice indexing operation; or a field selector of an addressable struct operand; or an array indexing operation of an addressable array. As an exception to the addressability requirement, x may also be a (possibly parenthesized) composite literal.</p>\n</blockquote>\n\n<p>A counter examples include map values and functions:</p>\n\n<pre><code>func f() {}\n\nfunc main() {\n    var m map[string]string\n    p1 := &amp;m[\"foo\"] // cannot take the address of m[\"foo\"]\n    p2 := &amp;f        // cannot take the address of f\n}\n</code></pre>\n"}], "owner": {"reputation": 2356, "user_id": 1028741, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b724fd562ebada6c12d82ec07b7ec58?s=128&d=identicon&r=PG", "display_name": "user1028741", "link": "https://stackoverflow.com/users/1028741/user1028741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572863923, "creation_date": 1572851238, "last_edit_date": 1572855057, "question_id": 58688655, "link": "https://stackoverflow.com/questions/58688655/when-a-receiver-method-t-cannot-take-t", "title": "When a receiver method T cannot take *T?", "body": "<p>The official Go site <a href=\"https://golang.org/doc/faq#different_method_sets\" rel=\"nofollow noreferrer\">writes as follows</a>:</p>\n\n<blockquote>\n  <p>As the Go specification says, the method set of a type T consists of\n  all methods with receiver type T, while that of the corresponding\n  pointer type *T consists of all methods with receiver *T or T. That\n  means the method set of *T includes that of T, but not the reverse.</p>\n  \n  <p>This distinction arises because if an interface value contains a\n  pointer *T, a method call can obtain a value by dereferencing the\n  pointer, but if an interface value contains a value T, there is no\n  safe way for a method call to obtain a pointer. (Doing so would allow\n  a method to modify the contents of the value inside the interface,\n  which is not permitted by the language specification.)</p>\n  \n  <p><strong>Even in cases where the compiler could take the address of a value to\n  pass to the method</strong>, if the method modifies the value the changes will\n  be lost in the caller.</p>\n</blockquote>\n\n<p>My question is, when <strong>can't</strong> the compiler take a value to a pointer receiver value?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1572851336, "post_id": 58688578, "comment_id": 103675309, "body": "Select chooses the &#39;default&#39; case if it cannot receive from the channel, or the channel is nil."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1572853890, "post_id": 58688578, "comment_id": 103676201, "body": "<a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Select_statements</a> (Rule of thumb: Always consult the language spec first. Contrary to other languages, Go&#39;s spec is understandable.)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572881891, "post_id": 58688578, "comment_id": 103689652, "body": "If the spec is too technical, there&#39;s an entire page of the tour dedicated to default in select: <a href=\"https://tour.golang.org/concurrency/6\" rel=\"nofollow noreferrer\">tour.golang.org/concurrency/6</a>"}], "answers": [{"tags": [], "owner": {"reputation": 722, "user_id": 4671382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55c20cb0c0d8044ffc5866b179ac8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/4671382/cl%c3%a9ment"}, "is_accepted": false, "score": 0, "last_activity_date": 1572851326, "creation_date": 1572851326, "answer_id": 58688671, "question_id": 58688578, "link": "https://stackoverflow.com/questions/58688578/how-does-go-select-decide-to-run-into-the-default-branch/58688671#58688671", "title": "How does Go select decide to run into the default branch?", "body": "<p>It depends on the scheduler, but between the time you consume a value from the channel and the time another goroutine gets execution time allocated by the scheduler (which would add a value in the channel), the main goroutine may have enough time to run the case and go back to the <code>select</code> statement before a value is added to the channel, it would then run the <code>default</code> case.</p>\n\n<p>You could reduce this by using a buffered channel.</p>\n"}], "owner": {"reputation": 26911, "user_id": 225262, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/10f7602ff38f6486cb1580052746fc05?s=128&d=identicon&r=PG", "display_name": "satoru", "link": "https://stackoverflow.com/users/225262/satoru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1572851326, "creation_date": 1572850815, "question_id": 58688578, "link": "https://stackoverflow.com/questions/58688578/how-does-go-select-decide-to-run-into-the-default-branch", "title": "How does Go select decide to run into the default branch?", "body": "<p>I have a program in which I have 256 goroutines generating test data and sending them to a channel.</p>\n\n<p>In the consuming part of the program, I set up a select like this:</p>\n\n<pre><code>select {\ncase c := &lt;-theChan:\n    // Do some stuff with c\ndefault:\n    //\n}\n</code></pre>\n\n<p>What surprise me is that while the 256 goroutines keep sending items to the channel and the processing of the items take time? The program runs into the <code>default</code> branch several times.</p>\n\n<p>I wonder how does the <code>select</code> statement decide that <code>theChan</code> is empty and run into <code>default</code>.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1572846224, "creation_date": 1572846224, "answer_id": 58687792, "question_id": 58687502, "link": "https://stackoverflow.com/questions/58687502/variance-in-bytes-sent-while-using-fprintf/58687792#58687792", "title": "Variance in bytes sent while using Fprintf", "body": "<p>If you look at the printed string, you can see the problem:</p>\n\n<pre><code>Br%!(NOVERB)\n</code></pre>\n\n<p>Here, when the last byte is 0x25, which is '%', Fprintf tries to read the next formatting verb from the input, which is not there, so it prints out an error message !(NOVERB). That's your extra bytes. Instead of Fprintf, use FPrint, and it should print 4 bytes.</p>\n"}], "owner": {"reputation": 75, "user_id": 5248496, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eUeIwoVXr0o/AAAAAAAAAAI/AAAAAAAABnk/7NA1Tq0ICcE/photo.jpg?sz=128", "display_name": "Rajesh S", "link": "https://stackoverflow.com/users/5248496/rajesh-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58687792, "answer_count": 1, "score": -2, "last_activity_date": 1572846224, "creation_date": 1572844263, "last_edit_date": 1572845099, "question_id": 58687502, "link": "https://stackoverflow.com/questions/58687502/variance-in-bytes-sent-while-using-fprintf", "title": "Variance in bytes sent while using Fprintf", "body": "<p>Requirement: I would like to get \"4 bytes sent\" - when i send the following hex message - i see them working for one hex message and does not work for the other one when sent with a minor change</p>\n\n<p>The following code explains my problem better - first the working hex with 4 bytes sent as expected and second with another hex message which sends additional bytes - i need to figure out a way to get 4 bytes sent for the second hex too</p>\n\n<h2>Working hex:</h2>\n\n<pre><code>\nimport (\n    \"fmt\"\n    \"os\"\n    \"encoding/hex\"\n)\n\nfunc main() {\n    hexString, _ := hex.DecodeString(\"4214722e\")\n\n    n, err := fmt.Fprintf(os.Stdout, string(hexString))\n\n    // The n and err return values from Fprintf are\n    // those returned by the underlying io.Writer.\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Fprintf: %v\\n\", err)\n    }\n    fmt.Printf(\"\\n%d bytes written.\\n\", n)\n    fmt.Println([]byte(hexString))\n    fmt.Println(hex.Dump(hexString))\n\n}\n</code></pre>\n\n<p>Produces the following as output:</p>\n\n<pre><code>4 bytes written.\n[66 20 114 46]\n00000000  42 14 72 2e                                       |B.r.|\n</code></pre>\n\n<h2>Not working hex - with just one value changed: (Need 4 bytes here somehow but i get 13)</h2>\n\n<p><a href=\"https://play.golang.org/p/UNLsLdLk6g0\" rel=\"nofollow noreferrer\">https://play.golang.org/p/UNLsLdLk6g0</a></p>\n\n<pre><code>\nimport (\n    \"fmt\"\n    \"os\"\n    \"encoding/hex\"\n)\n\nfunc main() {\n    hexString, _ := hex.DecodeString(\"42147225\")\n\n    n, err := fmt.Fprintf(os.Stdout, string(hexString))\n\n    // The n and err return values from Fprintf are\n    // those returned by the underlying io.Writer.\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Fprintf: %v\\n\", err)\n    }\n    fmt.Printf(\"\\n%d bytes written.\\n\", n)\n    fmt.Println([]byte(hexString))\n    fmt.Println(hex.Dump(hexString))\n\n}\n</code></pre>\n\n<p>Produces the following output which is not what is expected, even if the bytes when printed looks to be 4</p>\n\n<pre><code>13 bytes written.\n[66 20 114 37]\n00000000  42 14 72 25                                       |B.r%|\n</code></pre>\n\n<p>Need 4 bytes to be sent in the second example - please help me out with the same</p>\n\n<p>Note: Why am i using Fprintf here? I need this message to be sent via a TCP socket, but for the example above - i am sending the same hex message but to the stdout instead so that its easy for us to take a look at this. As long as the solution can be used for sending info to sockets - i dont really care if its Fprintf or something else </p>\n"}, {"tags": ["function", "pointers", "go", "parameters"], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 2, "last_activity_date": 1572845560, "last_edit_date": 1572845560, "creation_date": 1572844999, "answer_id": 58687600, "question_id": 58687462, "link": "https://stackoverflow.com/questions/58687462/why-go-doesnt-report-compile-error-when-passing-a-pointer-to-function-as-value/58687600#58687600", "title": "Why Go doesn&#39;t report compile error when passing a pointer to function as value?", "body": "<p><code>f(&amp;s)</code> is passing the pointer address of <code>s</code> by value - just like any other go function call. The fact that the function takes an interface parameter does not change this fact.</p>\n\n<p>Now regarding how the interface works: an interface value contains 2 items: the value &amp; the underlying type. The value in this case is the pointer to the struct. The type verifies that <code>s</code> satisfies the interface - because it implements the Get/Set function signatures.</p>\n\n<p>Since a pointer receiver of a method can alter the receiver's data fields - the <code>&amp;s</code> can be altered by the <code>Set</code> method. And by extension, calling <code>f(&amp;s)</code> - which invokes Set - thus also alters the struct <code>s</code>'s state.</p>\n\n<p>P.S. this behavior is crucial for most of the go standard library. Many packages e.g. <code>http</code> rely on the <code>io.Reader</code> &amp; <code>io.Writer</code> interfaces. Functions &amp; methods that accept values that implement these interfaces, rely on the underlying concrete types changing state, reading network ports, flushing caches etc. to work - all the while not burdening the caller with these internal side effects.</p>\n"}, {"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": true, "score": 2, "last_activity_date": 1572847323, "creation_date": 1572847323, "answer_id": 58687976, "question_id": 58687462, "link": "https://stackoverflow.com/questions/58687462/why-go-doesnt-report-compile-error-when-passing-a-pointer-to-function-as-value/58687976#58687976", "title": "Why Go doesn&#39;t report compile error when passing a pointer to function as value?", "body": "<p>See <a href=\"https://stackoverflow.com/a/58687600/1256452\">colminator's answer</a>, but, for a rather imperfect analogy to straight C code, imagine that:</p>\n\n<pre><code>var x interface{ ... } // fill in the `...` part with functions\n</code></pre>\n\n<p>\u2014or in this case, declaring <code>i I</code> to make <code>i</code> have the interface type you defined\u2014is like declaring a C <code>struct</code> with two members, one to hold a type, and one to hold a value of that type:</p>\n\n<pre><code>struct I {\n    struct type_info *type;\n    union {\n        void *p;\n        int i;\n        double d;\n        // add more types if/as needed here\n    } u;\n};\nstruct I i;\n</code></pre>\n\n<p>The compiler fills in the <code>i.type</code> slot when you pass <code>&amp;s</code> to <code>i</code>, and fills in <code>i.u.p</code> to point to the object <code>s</code>.<sup>1</sup></p>\n\n<p>When you invoke <code>i.Set(10)</code>, the Go compiler turns this into the equivalent of:</p>\n\n<pre><code>(*__lookup_func(i, \"Set\"))(i.u.p)\n</code></pre>\n\n<p>where <code>__lookup_func</code> finds the actual <code>func (s *S) Set(age int)</code> and an excessive amount of magic discovers that it should pass the pointer to <code>s</code> (from <code>i.u.p</code>) to that setter function.<sup>2</sup></p>\n\n<p>The fact that a variable of some interface types has these two slots\u2014the \"type\" part, and the union-like part that holds the current value\u2014is the real secret sauce here.  You can use a type-assertion:</p>\n\n<pre><code>v, ok := i.(int)\n</code></pre>\n\n<p>or a type-switch:</p>\n\n<pre><code>switch v := i.(type) {\ncase int: // code where `v` is `var v int`\ncase float64: // code where `v` is `var v float64` ...\n// add more cases as desired\n}\n</code></pre>\n\n<p>to check the type slot while also copying the value slot to a new variable <code>v</code>.<sup>3</sup></p>\n\n<p>Note that an <code>interface</code> variable compares equal to <code>nil</code> <em>if and only if <strong>both</strong> slots</em> (<code>i.type</code> and <code>i.u</code>) are nil.  The thing that trips people up all the time is that if you initialize an <code>interface</code> value from some non-interface type, its <code>type</code> slot is no longer nil, and the test:</p>\n\n<pre><code>if i == nil { // handle the case ...\n</code></pre>\n\n<p>doesn't work, <em>even if the value slot</em> (<code>i.u.p</code> in our analogy here) <em>is</em> <code>nil</code>.</p>\n\n<hr>\n\n<p><sup>1</sup>I show this as a union of several C types, but don't include <code>struct</code> types.  In fact, the size of the second slot of an <code>interface</code> value is not something the compiler makes any promises about, though in current compilers, it's just 8 bytes like any other pointer.  If whatever value type you have is too big for the actual underlying implementation, though, the compiler inserts an allocation: the value goes into some additional memory, and the union's pointer field is set to point the value.</p>\n\n<p>The compiler checks, at compile time, that the type of the <em>actual</em> value you're stuffing into some interface, fits into that interface.  An interface type has a list of functions that it must support.  If the underlying type has those functions, the assignment is OK (and the compiler knows to build the appropriate vtable-like data mentioned in footnote 2).  If the underlying type is missing some function(s), you get a compile-time error.  So you're definitely guaranteed that a later function-lookup on the interface variable will always succeed.</p>\n\n<p><sup>2</sup>The lookup is faster than the implied string lookup here as <code>Set</code> has an integer code value that the compiler assigned at compile time to that particular interface type, and the internal <code>struct type_info</code> stuff has various fast lookup tables, somewhat akin to C++ vtables, to help it out as well.</p>\n\n<p>The \"excessive amount of magic\" is greatly reduced in most cases to just \"put the right parameter in the right argument register or stack location\": it's harmless to copy extra bytes that the callee never reads.  If integer vs floating-point requires different argument registers, though, it gets a little tricky, and I'm not sure what current Go compilers actually do here.</p>\n\n<p><sup>3</sup>In the <code>v, ok := i.(int)</code> form, if the type slot <em>doesn't</em> hold <code>int</code>, <code>v</code> is set to zero, and <code>ok</code> is set to <code>false</code>.  This holds regardless of the actual type: <em>all</em> types have a default zero value, and <code>v</code> becomes a zero-value of the type you gave.</p>\n"}], "owner": {"reputation": 5623, "user_id": 6164172, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cfe3f1dd56fc9c05a01393d3c618d727?s=128&d=identicon&r=PG&f=1", "display_name": "Troskyvs", "link": "https://stackoverflow.com/users/6164172/troskyvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58687976, "answer_count": 2, "score": -3, "last_activity_date": 1572855230, "creation_date": 1572843994, "last_edit_date": 1572855230, "question_id": 58687462, "link": "https://stackoverflow.com/questions/58687462/why-go-doesnt-report-compile-error-when-passing-a-pointer-to-function-as-value", "title": "Why Go doesn&#39;t report compile error when passing a pointer to function as value?", "body": "<p>I suppose if I try to pass a pointer to a function, then this function declaration should also receive a pointer? Not sure, I tried this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\ntype I interface {\n    Get() int\n    Set(int)\n}\n\ntype S struct {\n    Age int\n}\nfunc (s S) Get() int {\n    return s.Age\n}\nfunc (s *S) Set(age int) {\n    s.Age = age\n}\nfunc f(i I) {\n    i.Set(10)\n    fmt.Println(i.Get())\n}\nfunc main() {\n    s := S{}\n    f(&amp;s) //4\n    fmt.Println(s.Get())\n}\n</code></pre>\n\n<p>It prints </p>\n\n<pre><code>10\n10\n</code></pre>\n\n<p>We see that function of f is</p>\n\n<pre><code>func f(i I)\n</code></pre>\n\n<p>I'm not sure if this is a \"pass by value\" declaration, if by value, then \"i\" shouldn't be changed outside function \"f\" right, which is a copy inside \"f\".</p>\n\n<p>So which point did I get wrong?</p>\n"}, {"tags": ["go", "dockerfile", "hashicorp-vault"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9989847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LsA2tYq6IZo/AAAAAAAAAAI/AAAAAAAAAf0/HggTESEl_DU/photo.jpg?sz=128", "display_name": "Abhishek Padadale", "link": "https://stackoverflow.com/users/9989847/abhishek-padadale"}, "edited": false, "score": 0, "creation_date": 1572868715, "post_id": 58690585, "comment_id": 103682945, "body": "Thank you for the solution I tried importing specific version. However I am getting error <code>go: cannot use path@version syntax in GOPATH mode</code>"}, {"owner": {"reputation": 2024, "user_id": 4113638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef898b2e31f790674840927909d0996c?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio De La Quintana", "link": "https://stackoverflow.com/users/4113638/mauricio-de-la-quintana"}, "reply_to_user": {"reputation": 13, "user_id": 9989847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LsA2tYq6IZo/AAAAAAAAAAI/AAAAAAAAAf0/HggTESEl_DU/photo.jpg?sz=128", "display_name": "Abhishek Padadale", "link": "https://stackoverflow.com/users/9989847/abhishek-padadale"}, "edited": false, "score": 0, "creation_date": 1572879215, "post_id": 58690585, "comment_id": 103688222, "body": "Can you try adding this <code>export GO111MODULE=on</code> to your <code>.bashrc</code> or <code>.zshrc</code>  more info <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Modules</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1572882473, "post_id": 58690585, "comment_id": 103689996, "body": "Just turning on GO111MODULE isn&#39;t going to fix the issue. You need to <code>go mod init</code> and establish your project as a Go module properly."}, {"owner": {"reputation": 13, "user_id": 9989847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LsA2tYq6IZo/AAAAAAAAAAI/AAAAAAAAAf0/HggTESEl_DU/photo.jpg?sz=128", "display_name": "Abhishek Padadale", "link": "https://stackoverflow.com/users/9989847/abhishek-padadale"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1573436088, "post_id": 58690585, "comment_id": 103870551, "body": "@MauricioDeLaQuintana Sorry for getting back so late . Yes I had to set <code>GO111MODULE=on</code> and also as @Adrian mentioned had to do <code>go mod init .</code>"}], "tags": [], "owner": {"reputation": 2024, "user_id": 4113638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef898b2e31f790674840927909d0996c?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio De La Quintana", "link": "https://stackoverflow.com/users/4113638/mauricio-de-la-quintana"}, "is_accepted": true, "score": 2, "last_activity_date": 1572860162, "creation_date": 1572860162, "answer_id": 58690585, "question_id": 58687150, "link": "https://stackoverflow.com/questions/58687150/getting-errors-running-go-get-github-com-hashicorp-vault-command/58690585#58690585", "title": "Getting Errors running `go get github.com/hashicorp/vault/command`", "body": "<p>the get command pulls the lattest version of the library your are using, but in your case you may want to use the previous version which was already working.</p>\n\n<p>Based on here </p>\n\n<p><a href=\"https://github.com/hashicorp/vault/releases\" rel=\"nofollow noreferrer\">https://github.com/hashicorp/vault/releases</a></p>\n\n<p>You only have to import the version with this command </p>\n\n<pre><code>go get github.com/hashicorp/vault/command@v1.2.3\n</code></pre>\n\n<p>Hope it helps</p>\n"}], "owner": {"reputation": 13, "user_id": 9989847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LsA2tYq6IZo/AAAAAAAAAAI/AAAAAAAAAf0/HggTESEl_DU/photo.jpg?sz=128", "display_name": "Abhishek Padadale", "link": "https://stackoverflow.com/users/9989847/abhishek-padadale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "accepted_answer_id": 58690585, "answer_count": 1, "score": 1, "last_activity_date": 1572860162, "creation_date": 1572841206, "last_edit_date": 1572849026, "question_id": 58687150, "link": "https://stackoverflow.com/questions/58687150/getting-errors-running-go-get-github-com-hashicorp-vault-command", "title": "Getting Errors running `go get github.com/hashicorp/vault/command`", "body": "<p>I have not had any errors get/install the package below up until 30/10/2019. Was something committed that caused it? How can i fix it? Thanks!</p>\n\n<p>Command:</p>\n\n<pre><code>go get github.com/hashicorp/vault/command\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code> github.com/hashicorp/vault/builtin/logical/rabbitmq\n/go/src/github.com/hashicorp/vault/builtin/logical/rabbitmq/path_role_create.go:100:23: client.UpdateTopicPermissionsIn undefined (type *rabbithole.Client has no field or method UpdateTopicPermissionsIn)\n /go/src/github.com/hashicorp/vault/builtin/logical/rabbitmq/path_role_create.go:100:66: undefined: rabbithole.TopicPermissions\n</code></pre>\n\n<p>go version: golang:1.12.9-alpine3.9</p>\n"}, {"tags": ["go", "string-interpolation"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1572846728, "post_id": 58686609, "comment_id": 103673963, "body": "Do not do this! Use packge encoding/json to generate JSON and nothing else."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1572855307, "post_id": 58686609, "comment_id": 103676754, "body": "There is no string interpolation in Go. You&#39;d have to use a package (possibly the stdlib template package). But that&#39;s a silly approach in your specific example. Just use the proper json marshaler instead."}], "answers": [{"comments": [{"owner": {"reputation": 4669, "user_id": 3709060, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/MnFyD.jpg?s=128&g=1", "display_name": "edmamerto", "link": "https://stackoverflow.com/users/3709060/edmamerto"}, "edited": false, "score": 0, "creation_date": 1572836630, "post_id": 58686637, "comment_id": 103672167, "body": "so what do I grab to pass in as payload? <code>req, err := http.NewRequest(&quot;POST&quot;, url, bytes.NewBuffer(jsonStr))</code> &lt;--- this doesn&#39;t work"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 4669, "user_id": 3709060, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/MnFyD.jpg?s=128&g=1", "display_name": "edmamerto", "link": "https://stackoverflow.com/users/3709060/edmamerto"}, "edited": false, "score": 0, "creation_date": 1572836835, "post_id": 58686637, "comment_id": 103672203, "body": "The buffer has your string: <code>http.NewRequest(&quot;POST&quot;,url,&amp;out)</code>"}, {"owner": {"reputation": 4669, "user_id": 3709060, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/MnFyD.jpg?s=128&g=1", "display_name": "edmamerto", "link": "https://stackoverflow.com/users/3709060/edmamerto"}, "edited": false, "score": 0, "creation_date": 1572837205, "post_id": 58686637, "comment_id": 103672268, "body": "doesn&#39;t work :( <code>cannot use &#39;&amp;out&#39; (type *Buffer) as type []byte</code>"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 4669, "user_id": 3709060, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/MnFyD.jpg?s=128&g=1", "display_name": "edmamerto", "link": "https://stackoverflow.com/users/3709060/edmamerto"}, "edited": false, "score": 3, "creation_date": 1572837454, "post_id": 58686637, "comment_id": 103672307, "body": "<code>http.NewRequest</code> takes an <code>io.Reader</code>, are you sure you&#39;re getting the error at that line? In any case, &amp;out is an <code>io.Reader</code>, and if you need ` []byte` from it, call <code>out.Bytes()</code>."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 3, "last_activity_date": 1572836226, "creation_date": 1572836226, "answer_id": 58686637, "question_id": 58686609, "link": "https://stackoverflow.com/questions/58686609/adding-string-interpolation-within-backticked-strings/58686637#58686637", "title": "Adding string interpolation within backticked strings", "body": "<p>You can use a template:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"bytes\"\n    \"text/template\"\n)\n\n\nfunc main() {\n  myVar := \"this is my var\"\n  var jsonStr = `{\n  \"attachments\": [\n        {   \n            \"text\": \"Hello World! {{.myVar}}\"\n\n        }\n    ]\n}`\n t,_:=template.New(\"text\").Parse(jsonStr)\n out:=bytes.Buffer{}\n t.Execute(&amp;out,map[string]interface{}{\"myVar\":myVar})\n}\n</code></pre>\n"}], "owner": {"reputation": 4669, "user_id": 3709060, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/MnFyD.jpg?s=128&g=1", "display_name": "edmamerto", "link": "https://stackoverflow.com/users/3709060/edmamerto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1572855254, "creation_date": 1572835873, "last_edit_date": 1572855254, "question_id": 58686609, "link": "https://stackoverflow.com/questions/58686609/adding-string-interpolation-within-backticked-strings", "title": "Adding string interpolation within backticked strings", "body": "<p>I am trying to figure out how to interpolate within backticked string literals.</p>\n\n<p>i.e. </p>\n\n<pre><code>myVar := \"this is my var\"\nvar jsonStr = []byte(`{\n  \"attachments\": [\n        {   \n            \"text\": \"Hello World! {{myVar}}\"\n\n        }\n    ]\n}`)\n</code></pre>\n\n<p><code>{{myVar}}</code> this is just pseudo code to get my intent across, but how would I do this in golang?</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": false, "score": 2, "last_activity_date": 1572839167, "last_edit_date": 1592644375, "creation_date": 1572839167, "answer_id": 58686946, "question_id": 58686458, "link": "https://stackoverflow.com/questions/58686458/program-changes-memory-values-when-using-calloc-vs-make-for-slices/58686946#58686946", "title": "Program changes memory values when using calloc() vs make() for slices", "body": "<blockquote>\n<p>I am trying to build a slice of pointers manually and with C.calloc() for allocating the array portion of the slice.</p>\n</blockquote>\n<p>This is explicitly forbidden.</p>\n<p>To quote from the <a href=\"https://golang.org/cmd/cgo/#hdr-Passing_pointers\" rel=\"nofollow noreferrer\">official cgo documentation</a>:</p>\n<blockquote>\n<p>Go is a garbage collected language, and the garbage collector needs to know the location of every pointer to Go memory. Because of this, there are restrictions on passing pointers between Go and C.</p>\n<p>In this section the term Go pointer means a pointer to memory allocated by Go (such as by using the &amp; operator or calling the predefined new function) and the term C pointer means a pointer to memory allocated by C (such as by a call to C.malloc). Whether a pointer is a Go pointer or a C pointer is a dynamic property determined by how the memory was allocated; it has nothing to do with the type of the pointer.</p>\n<p><strong>Note that values of some Go types, other than the type's zero value, always include Go pointers. This is true of string, slice, interface, channel, map, and function types.</strong> A pointer type may hold a Go pointer or a C pointer. Array and struct types may or may not include Go pointers, depending on the element types. All the discussion below about Go pointers applies not just to pointer types, but also to other types that include Go pointers.</p>\n</blockquote>\n<p>The boldface above is mine.  It means that you <em>must not</em> allocate any of these types via C's allocators.</p>\n<blockquote>\n<p>It is possible to defeat this enforcement by using the unsafe package, and of course there is nothing stopping the C code from doing anything it likes. However, <strong>programs that break these rules are likely to fail in unexpected and unpredictable ways.</strong></p>\n</blockquote>\n<p>This bit of your own code:</p>\n<blockquote>\n<pre><code>newTable.table=*(*[]*entry)(unsafe.Pointer(&amp;temp));\n</code></pre>\n</blockquote>\n<p>violates the rules, but defeats their enforcement.  You have allocated C memory, and are now trying to use it as if it were Go memory, in the form of a slice.</p>\n"}], "owner": {"reputation": 883, "user_id": 11322131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da67a1ade1072d432684e55adbb5d57?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/11322131/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572855324, "creation_date": 1572834193, "last_edit_date": 1572855324, "question_id": 58686458, "link": "https://stackoverflow.com/questions/58686458/program-changes-memory-values-when-using-calloc-vs-make-for-slices", "title": "Program changes memory values when using calloc() vs make() for slices", "body": "<p>I am trying to build a slice of pointers manually and with C.calloc() for allocating the array portion of the slice. I am able to do this successfully though when I try and add pointers that I allocate with make() some of the values (of what the pointers point to) get changed seemingly randomly. On the other hand if I C.calloc() space for the pointers I will be adding, the value are not changed. Or, if I allocate the slices with make() and the pointers I add are allocated with make() the values are not changed.</p>\n\n<p>I do notice that the memory locations of the pointers when using C.calloc() vs make() are very different but I don't see why this should cause the memory to be changed randomly. I am new to Go so please forgive me if I am overlooking some very simple.</p>\n\n<p>Here is the code I use for allocating my slices manually:</p>\n\n<pre><code>type caster struct {\n    ptr *byte;\n    len int64;\n    cap int64;\n}\n\nvar temp caster;\ntemp.ptr=(*byte)(C.calloc(C.ulong(size),8));\ntemp.len=int64(size);\ntemp.cap=int64(size);\nnewTable.table=*(*[]*entry)(unsafe.Pointer(&amp;temp));\n</code></pre>\n\n<p>This works if the entries I add are allocated as follows:</p>\n\n<pre><code>var temp caster;\nvar e []entry;\ntemp.ptr=(*byte)(C.calloc(C.ulong(ninserts),8));\ntemp.len=int64(ninserts);\ntemp.cap=int64(ninserts);\ne=*(*[]entry)(unsafe.Pointer(&amp;temp));\n\nfor i:=0;i&lt;ninserts;i++ {\n    e[i].val=hint64(rand.Int63());\n}\n\nfor i:=0;i&lt;ninserts;i++ {\n    ht.insert(&amp;e[i]);\n}\n</code></pre>\n\n<p>though the memory of of the entries gets randomly changed if they are allocated as follows:</p>\n\n<pre><code>var e []entry = make([]entry, ninserts); \n\nfor i:=0;i&lt;ninserts;i++ {\n    e[i].val=hint64(rand.Int63());\n}\n\nfor i:=0;i&lt;ninserts;i++ {\n    ht.insert(&amp;e[i]);\n}\n</code></pre>\n\n<p>Unless I build my slices normally as follows:</p>\n\n<pre><code>newTable.table = make([]*entry,  size);\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1572834045, "creation_date": 1572834045, "answer_id": 58686441, "question_id": 58686402, "link": "https://stackoverflow.com/questions/58686402/how-to-escape-backticks-in-string-literal/58686441#58686441", "title": "How to escape backticks in string literal", "body": "<p>You can't escape backticks. When there's long text like this, one thing you can do is to replace them:</p>\n\n<pre><code>var jsonstr=[]byte(strings.Replace(`{\nSome json string with ^backticks^\n}`,\"^\",\"`\",-1))\n</code></pre>\n\n<p>Another option is to add string segments:</p>\n\n<pre><code>var jsonstr=[]byte(`{\nSome json string with `+\"`backticks`\"+`\n}`)\n</code></pre>\n"}], "owner": {"reputation": 4669, "user_id": 3709060, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/MnFyD.jpg?s=128&g=1", "display_name": "edmamerto", "link": "https://stackoverflow.com/users/3709060/edmamerto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "closed_date": 1572855397, "accepted_answer_id": 58686441, "answer_count": 1, "score": 0, "last_activity_date": 1572855367, "creation_date": 1572833645, "last_edit_date": 1572855367, "question_id": 58686402, "link": "https://stackoverflow.com/questions/58686402/how-to-escape-backticks-in-string-literal", "closed_reason": "Duplicate", "title": "How to escape backticks in string literal", "body": "<p>I have a slack payload that would format to markdown. And I'm trying to figure out how to preserve the backtick</p>\n\n<pre><code>var jsonStr = []byte(`{\n  \"channel\": \"#edtest\",\n  \"username\": \"snapshot\",\n  \"attachments\": [\n        {   \n            \"mkdwn\": true,\n            \"text\": \"`this backtick doesn't work`\",\n        }\n    ]\n}`)\n</code></pre>\n\n<p>if you look at the text field, that backtick won't work</p>\n"}, {"tags": ["go", "mocking", "amazon-emr", "aws-sdk-go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1572855483, "post_id": 58685900, "comment_id": 103676815, "body": "<code>DescribeClusterOutput</code> is a struct. You can&#39;t mock structs."}, {"owner": {"reputation": 36140, "user_id": 6463558, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/g22sX.jpg?s=128&g=1", "display_name": "slideshowp2", "link": "https://stackoverflow.com/users/6463558/slideshowp2"}, "edited": false, "score": 0, "creation_date": 1602573284, "post_id": 58685900, "comment_id": 113755102, "body": "Is there any error? Besides, are you using the <code>testify</code> package?"}], "owner": {"reputation": 199, "user_id": 1619706, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/12c7a2ca97ca7add3724de6489fe3310?s=128&d=identicon&r=PG", "display_name": "jackysatpal", "link": "https://stackoverflow.com/users/1619706/jackysatpal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572855444, "creation_date": 1572827678, "last_edit_date": 1572855444, "question_id": 58685900, "link": "https://stackoverflow.com/questions/58685900/how-to-mock-describeclusteroutput", "title": "How to mock DescribeClusterOutput", "body": "<p>I have written a code that will interact with EMR service and based on a clusterId it will return the cluster status.\nI am trying to unit test it but I couldn't figure out. </p>\n\n<p>code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (hc *HandlerConfig) Handler(c entities.Cluster) (string, error) {\n    clusterID := aws.String(c.ClusterID)\n\n    clusterDetails, err := hc.EMRClient.DescribeCluster(&amp;emr.DescribeClusterInput{ClusterId: clusterID})\n    if err != nil {\n        return \"error\", err\n    }\n\n    clusterStatus := *clusterDetails.Cluster.Status.State\n\n    return fmt.Sprintf(clusterStatus), nil\n}\n</code></pre>\n\n<p>unit testing code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func TestHandler(t *testing.T) {\n    emrClient := new(emrtestutils.MockEMR)\n    hc := HandlerConfig{\n        EMRClient: emrClient,\n    }\n\n    input := &amp;emr.DescribeClusterInput{ClusterId: aws.String(\"j-dfdslkj3kl213kj\")}\n\n    // I'M STUCK HERE\n    output := &amp;emr.DescribeClusterOutput{\n        Cluster\n    }\n\n    emrClient.On(\"DescribeCluster\", input).Return(*output.Status.State)\n    res, err := hc.Handler(entities.Cluster{ClusterID: \"j-dfdslkj3kl213kj\"})\n\n    assert.NoError(t, err)\n    emrClient.AssertExpectations(t)\n    assert.Equal(t, res, output)\n\n}\n</code></pre>\n\n<p>I want to provide mock value of DescribeClusterOutput.</p>\n\n<p>link: <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/emr/#EMR.DescribeCluster\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/emr/#EMR.DescribeCluster</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1572825969, "post_id": 58684099, "comment_id": 103670438, "body": "None of the FileInfo methods return errors, meaning they cannot fail. That&#39;s only feasible if the information is cached."}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 3, "last_activity_date": 1572813587, "creation_date": 1572813587, "answer_id": 58684419, "question_id": 58684099, "link": "https://stackoverflow.com/questions/58684099/is-os-fileinfo-actively-querying-the-filesystem-or-is-it-the-result-of-such-a-q/58684419#58684419", "title": "Is os.FileInfo actively querying the filesystem, or is it the result of such a query?", "body": "<p>Checking the source:</p>\n\n<p>os/types_unix.go:\nThis defines fileStat as a static structure, so for unix, stat performs the query and fileStat is static.</p>\n\n<p>os/types_windows.go:\nThe fileStat for windows is much more involved. However, Size(), ModTime(), and Mode() are functions that return fixed values without making any other system calls. </p>\n\n<p>So at least for these two systems, Stat() constructs an os-specific structure that is a snapshot of the values at the time Stat() was called.</p>\n"}], "owner": {"reputation": 207, "user_id": 2277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c6d650bdf7af615cc0643e222867ef?s=128&d=identicon&r=PG", "display_name": "lurf jurv", "link": "https://stackoverflow.com/users/2277831/lurf-jurv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 58684419, "answer_count": 1, "score": 2, "last_activity_date": 1572827761, "creation_date": 1572811194, "last_edit_date": 1572827761, "question_id": 58684099, "link": "https://stackoverflow.com/questions/58684099/is-os-fileinfo-actively-querying-the-filesystem-or-is-it-the-result-of-such-a-q", "title": "Is os.FileInfo actively querying the filesystem, or is it the result of such a query?", "body": "<p>Concretely: if I os.Stat a file and save the result in a variable I call \"stat\", then the file is appended to, then I do \"stat.Size()\", will it be the old size or the new size? Is this behavior guaranteed cross platform? It appears to be the former on Linux.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 47, "user_id": 1738245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e93bf5ff46f38f07857f521720a94a9f?s=128&d=identicon&r=PG", "display_name": "Andrqxa", "link": "https://stackoverflow.com/users/1738245/andrqxa"}, "edited": false, "score": 1, "creation_date": 1572801887, "post_id": 58682681, "comment_id": 103664944, "body": "Sorry, it is my fault - type job is hided by name of variable in loop!"}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 0, "last_activity_date": 1572801659, "creation_date": 1572801659, "answer_id": 58682708, "question_id": 58682681, "link": "https://stackoverflow.com/questions/58682681/error-of-parameter-of-anonymus-function-is-not-a-type/58682708#58682708", "title": "Error of parameter of anonymus function - is not a type", "body": "<p>It is because of this for-loop:</p>\n\n<pre><code>for _, job := range jobs {\n   // In here, job is the loop variable\n}\n</code></pre>\n\n<p>The loop variable <code>job</code> is shadowing the type name <code>job</code>. If you rename the loop variable to something else, it should work.</p>\n"}, {"comments": [{"owner": {"reputation": 19193, "user_id": 5193536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZGlox.png?s=128&g=1", "display_name": "nbk", "link": "https://stackoverflow.com/users/5193536/nbk"}, "edited": false, "score": 0, "creation_date": 1572812881, "post_id": 58682771, "comment_id": 103667936, "body": "Could you please add some explanation to the source code"}], "tags": [], "owner": {"reputation": 47, "user_id": 1738245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e93bf5ff46f38f07857f521720a94a9f?s=128&d=identicon&r=PG", "display_name": "Andrqxa", "link": "https://stackoverflow.com/users/1738245/andrqxa"}, "is_accepted": false, "score": -1, "last_activity_date": 1572802145, "creation_date": 1572802145, "answer_id": 58682771, "question_id": 58682681, "link": "https://stackoverflow.com/questions/58682681/error-of-parameter-of-anonymus-function-is-not-a-type/58682771#58682771", "title": "Error of parameter of anonymus function - is not a type", "body": "<pre><code>type job func(in, out chan interface{})\n\n.\n.\n.\n    for _, jb := range jobs {\n        .\n        .\n        .\n        }(jb, wg, in, out)\n\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 1738245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e93bf5ff46f38f07857f521720a94a9f?s=128&d=identicon&r=PG", "display_name": "Andrqxa", "link": "https://stackoverflow.com/users/1738245/andrqxa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1572802145, "creation_date": 1572801485, "question_id": 58682681, "link": "https://stackoverflow.com/questions/58682681/error-of-parameter-of-anonymus-function-is-not-a-type", "title": "Error of parameter of anonymus function - is not a type", "body": "<p>could somebody clarify to me, please why golang complains on the code - \"job is not a type\"  in goroutine</p>\n\n<pre><code>type job func(in, out chan interface{})\n\nfunc Execute(jobs ...job) {\n    in := make(chan interface{}, 100)\n    out := make(chan interface{}, 100)\n\n    wg := &amp;sync.WaitGroup{}\n    for _, job := range jobs {\n        wg.Add(1)\n        go func(j job, waiter *sync.WaitGroup, in, out chan interface{}) {\n            defer waiter.Done()\n            defer close(out)\n            j(in, out)\n        }(job, wg, in, out)\n        in = out\n        out = make(chan interface{}, 100)\n    }\n\n    wg.Wait()\n}\n</code></pre>\n\n<p>If I create separate function, or carry goroutine out of loops - all compiles fine</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1572800125, "post_id": 58682376, "comment_id": 103664420, "body": "Use a logger instead of fmt.Print(), so you can configure."}], "answers": [{"tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 2, "last_activity_date": 1572801316, "last_edit_date": 1572801316, "creation_date": 1572800079, "answer_id": 58682468, "question_id": 58682376, "link": "https://stackoverflow.com/questions/58682376/how-to-stop-fmt-print-from-printing-to-the-output/58682468#58682468", "title": "How to stop fmt.print() from printing to the output?", "body": "<p>Yes, just divert <code>os.Stdout</code> and/or <code>os.Stderr</code> e.g.:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    temp := os.Stdout\n    os.Stdout = nil    // turn it off\n    packageFunctions() // call you package functions here\n    os.Stdout = temp   // restore it\n    fmt.Println(\"Bye\")\n}\nfunc packageFunctions() {\n    fmt.Println(\"Hi\")\n}\n\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Bye\n</code></pre>\n\n<hr>\n\n<p>You may divert it to a temp file:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    tmpfile, err := ioutil.TempFile(\"\", \"example\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(tmpfile.Name())\n    // defer os.Remove(tmpfile.Name()) // clean up\n\n    temp := os.Stdout\n    os.Stdout = tmpfile\n    packageFunctions() // call you package functions here\n\n    if err := tmpfile.Close(); err != nil {\n        log.Fatal(err)\n    }\n\n    os.Stdout = temp // restore it\n    fmt.Println(\"Bye\")\n}\nfunc packageFunctions() {\n    fmt.Println(\"Hi\")\n}\n</code></pre>\n\n<hr>\n\n<p>And see:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/51183462/how-to-copy-os-stdout-output-to-string-variable\">How to copy os.Stdout output to string variable</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/31663229/how-can-stdout-be-captured-or-suppressed-for-golang-testing\">How can stdout be captured or suppressed for Go(lang) testing?</a></p>\n"}], "owner": {"reputation": 110, "user_id": 10086742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a08eba23183def103897ea65339180?s=128&d=identicon&r=PG&f=1", "display_name": "mahdi", "link": "https://stackoverflow.com/users/10086742/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 58682468, "answer_count": 1, "score": -2, "last_activity_date": 1572955876, "creation_date": 1572799492, "last_edit_date": 1572955876, "question_id": 58682376, "link": "https://stackoverflow.com/questions/58682376/how-to-stop-fmt-print-from-printing-to-the-output", "title": "How to stop fmt.print() from printing to the output?", "body": "<p>I'm using a package which has some <code>fmt.print()</code>s in the code, and I want to stop them from printing to the output. I want to suppress them without changing the code inside the package and only by adding some lines to my <code>main.go</code>. </p>\n\n<p>Is it possible to force <code>fmt</code> not to log prints to the output?</p>\n"}, {"tags": ["json", "forms", "go"], "answers": [{"comments": [{"owner": {"reputation": 600, "user_id": 713844, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/087d06c94e96171dc78fe6121e0fb5ba?s=128&d=identicon&r=PG", "display_name": "stanm87", "link": "https://stackoverflow.com/users/713844/stanm87"}, "edited": false, "score": 1, "creation_date": 1572800504, "post_id": 58682467, "comment_id": 103664532, "body": "amazing thanks. I had tried the <code>TextUnmarshaler</code> interface but didn&#39;t know about this named type constraint."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1572800076, "creation_date": 1572800076, "answer_id": 58682467, "question_id": 58682335, "link": "https://stackoverflow.com/questions/58682335/parsing-a-json-string-nested-in-a-form-urlencoded-post/58682467#58682467", "title": "Parsing a JSON string nested in a form-urlencoded POST", "body": "<p>You can implement the <code>TextUnmarshaler</code> interface, the <code>schema</code> package will use that interface instead of executing the default procedure and this allows for custom unmarshaling.</p>\n\n<hr>\n\n<p><strong>1.</strong> Declare a <em>named</em> type and use that as the type of the <code>Attachments</code> field. <code>[]StoredAttachment</code> is unnamed. So, for example:</p>\n\n<pre><code>type AttachmentList []StoredAttachment\n</code></pre>\n\n<p>Why? Because <em>methods</em> can be declared only on named types.</p>\n\n<p><strong>2.</strong> Implement <code>TextUnmarhsaler</code> interface and do the json unmashaling there.</p>\n\n<pre><code>func (ls *AttachmentList) UnmarshalText(text []byte) (err error) {\n    return json.Unmarshal(text, (*[]StoredAttachment)(ls))\n}\n</code></pre>\n\n<p>That's it.</p>\n\n<p><a href=\"https://play.golang.org/p/t65mI7JRFfS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/t65mI7JRFfS</a></p>\n"}], "owner": {"reputation": 600, "user_id": 713844, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/087d06c94e96171dc78fe6121e0fb5ba?s=128&d=identicon&r=PG", "display_name": "stanm87", "link": "https://stackoverflow.com/users/713844/stanm87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 58682467, "answer_count": 1, "score": -1, "last_activity_date": 1572855637, "creation_date": 1572799228, "last_edit_date": 1572855637, "question_id": 58682335, "link": "https://stackoverflow.com/questions/58682335/parsing-a-json-string-nested-in-a-form-urlencoded-post", "title": "Parsing a JSON string nested in a form-urlencoded POST", "body": "<p>I'm trying to parse part of the Mailgun notify webhook.\nIt's a POST request with a <code>x-www-form-urlencoded</code> body.\nHere's part of the body:</p>\n\n<pre><code>sender: some@email.com\nattachments: [{\"url\": \"https://storage.eu.mailgun.net/v3/domains/beep.boop/messages/randomstring/attachments/0\", \"content-type\": \"application/pdf\", \"name\": \"example.pdf\", \"size\": 345}]\"]\n</code></pre>\n\n<p>The <code>attachments</code> value is a <code>json</code> encoded array</p>\n\n<p>I would like to decode this string from JSON to a <code>StoredAttachment</code> nested struct as I am decoding the response as <code>x-www-form-urlencoded</code> but I don't know how to do it. The target <code>structs</code> are as follow:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type NotifiedMessage struct {\n    Sender      string `schema:\"sender\"`\n    Subject     string `schema:\"subject\"`\n    Attachments []StoredAttachment `schema:\"attachments\"`\n    MessageUrl  string `schema:\"message-url\"`\n}\n\n// StoredAttachment structures contain information on an attachment associated with a stored message.\ntype StoredAttachment struct {\n    Size        int    `json:\"size\"`\n    Url         string `json:\"url\"`\n    Name        string `json:\"name\"`\n    ContentType string `json:\"content-type\"`\n}\n</code></pre>\n\n<p>Here is my non-working code so far: <a href=\"https://play.golang.org/p/Ofbw2VAYV28\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Ofbw2VAYV28</a></p>\n"}, {"tags": ["function", "go", "module", "func", "writefile"], "answers": [{"comments": [{"owner": {"reputation": 3580, "user_id": 242457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c6dfaac50b9c43815dd18081e87f3e3?s=128&d=identicon&r=PG", "display_name": "David Jones", "link": "https://stackoverflow.com/users/242457/david-jones"}, "edited": false, "score": 1, "creation_date": 1591469650, "post_id": 58681458, "comment_id": 110070413, "body": "For ordinary files the file is truncated on opening, which is before writing. And may, in the general case, be arbitrarily long before writing. You can truncate a file by opening it with O_TRUNC and closing it without writing anything."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 5, "last_activity_date": 1591469692, "last_edit_date": 1591469692, "creation_date": 1572793663, "answer_id": 58681458, "question_id": 58681331, "link": "https://stackoverflow.com/questions/58681331/what-does-os-o-trunc-do/58681458#58681458", "title": "What does os.O_TRUNC do?", "body": "<p>There was some confusion on previous definitions of <code>os.O_TRUNC</code> using the verbiage \"if possible\" - see <a href=\"https://github.com/golang/go/issues/28699\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Today the <a href=\"https://golang.org/pkg/os/#pkg-constants\" rel=\"nofollow noreferrer\">docs</a> read:</p>\n\n<pre><code>O_TRUNC  int = syscall.O_TRUNC  // truncate regular writable file when opened.\n</code></pre>\n\n<p>So</p>\n\n<blockquote>\n  <p>Does \"O_TRUNC\" empty the entire file before writing ?</p>\n</blockquote>\n\n<p>Yes. It essentially clobbers the file's contents - if the file path exists already (and is a file or symlink to an existing file).</p>\n\n<p>Similarly from <a href=\"https://golang.org/pkg/io/ioutil/#WriteFile\" rel=\"nofollow noreferrer\">ioutil.WriteFile docs</a>:</p>\n\n<blockquote>\n  <p>... WriteFile truncates it before writing.</p>\n</blockquote>\n"}], "owner": {"reputation": 53, "user_id": 12316120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e1da1008185f343142bbb8c490f195?s=128&d=identicon&r=PG&f=1", "display_name": "Lamine", "link": "https://stackoverflow.com/users/12316120/lamine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1643, "favorite_count": 0, "accepted_answer_id": 58681458, "answer_count": 1, "score": 4, "last_activity_date": 1591469692, "creation_date": 1572792713, "last_edit_date": 1572794886, "question_id": 58681331, "link": "https://stackoverflow.com/questions/58681331/what-does-os-o-trunc-do", "title": "What does os.O_TRUNC do?", "body": "<p><code>func OpenFile(name string, flag int, perm FileMode) (*File, error)</code></p>\n\n<pre><code>f, err := os.OpenFile(\"notes.txt\", os.O_RDWR|os.O_CREATE|O_TRUNC, 0755)\n</code></pre>\n\n<p>Does \"O_TRUNC\" empty the entire file before writing?\nWhat do they mean with \"truncates\"?</p>\n\n<p>Also, does the function <code>ioutil.WriteFile()</code> empty the entire file before writing?</p>\n"}, {"tags": ["go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 988768, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/ebc52fff1a9620d23316855c2f86245b?s=128&d=identicon&r=PG", "display_name": "Herb Stahl", "link": "https://stackoverflow.com/users/988768/herb-stahl"}, "edited": false, "score": 0, "creation_date": 1572799175, "post_id": 58681516, "comment_id": 103664158, "body": "makes perfect sense.  In one of my tests, I spawned 100s of go routines.  Doing a wg.Wait()  works well for that test, and then I go through all the stored confirm channels.  Both of your approaches work.  Thanks."}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": false, "score": 1, "last_activity_date": 1572793987, "creation_date": 1572793987, "answer_id": 58681516, "question_id": 58681285, "link": "https://stackoverflow.com/questions/58681285/go-routine-channel-waitgroup-fatal-error-all-goroutines-are-asleep-deadlock/58681516#58681516", "title": "go routine channel &amp; WaitGroup fatal error: all goroutines are asleep - deadlock", "body": "<p>You get deadlock as in case of unbuffered confirm chan there is no reader so the send operation blocks. At the same time you're waiting the goroutine to return (the <code>wg.Wait()</code> statement) in the main. And so both the main and goroutine are blocked.</p>\n\n<p>Using buffered chan allows the goroutine to complete the send operation and exit and thus the <code>wg.Wait()</code> statement succeeds and main continiues after that.</p>\n\n<p>One way to fix unbuffered chan case is to change the place where you wait for the goroutine(s) to finish, ie</p>\n\n<pre><code>reply := &lt;-request.Confirm\nfmt.Println(reply.Value)\nwg.Wait()\n</code></pre>\n\n<p>wouldn't deadlock as you read from the chan before you block the main thus allowing the goroutine(s) to exit.</p>\n"}], "owner": {"reputation": 367, "user_id": 988768, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/ebc52fff1a9620d23316855c2f86245b?s=128&d=identicon&r=PG", "display_name": "Herb Stahl", "link": "https://stackoverflow.com/users/988768/herb-stahl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572793987, "creation_date": 1572792461, "question_id": 58681285, "link": "https://stackoverflow.com/questions/58681285/go-routine-channel-waitgroup-fatal-error-all-goroutines-are-asleep-deadlock", "title": "go routine channel &amp; WaitGroup fatal error: all goroutines are asleep - deadlock", "body": "<p>Can someone explain why I am getting a deadlock when pushing a reply to a channel that has no buffer size indicated?</p>\n\n<p>My test deadlocks when I create a confirm channel this way;<br>\nthis one deadlocks: <a href=\"https://play.golang.org/p/i8QHCURHFeL\" rel=\"nofollow noreferrer\">deadlock</a>   </p>\n\n<pre><code>   request := RequestMessage{\n        Value:   \"make it rain\",\n        Confirm: make(chan *ReplyMessage),\n    }\n</code></pre>\n\n<p>but not when I created as such;<br>\nthis one does not deadlock: <a href=\"https://play.golang.org/p/c4XQRQsW1ol\" rel=\"nofollow noreferrer\">no deadlock</a></p>\n\n<pre><code>    request := RequestMessage{\n        Value:   \"make it rain\",\n        Confirm: make(chan *ReplyMessage,1),\n    }\n</code></pre>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype ReplyMessage struct {\n    Value string\n}\n\ntype RequestMessage struct {\n    Value   string\n    Confirm chan *ReplyMessage\n}\n\nvar requestChannel chan *RequestMessage\n\nfunc main() {\n    requestChannel = make(chan *RequestMessage, 10) // 8 is channel buffer size\n    request := RequestMessage{\n        Value:   \"make it rain\",\n        Confirm: make(chan *ReplyMessage),\n    }\n    requestChannel &lt;- &amp;request\n\n    var wg sync.WaitGroup\n    wg.Add(1)\n    go func() {\n        defer wg.Done() // invoke Done on the WaitGroup when finished\n        request := &lt;-requestChannel\n        fmt.Printf(\"Got Request: %s\\n\", request.Value)\n        reply := ReplyMessage{Value: \"hi\"}\n        request.Confirm &lt;- &amp;reply\n\n    }()\n\n    wg.Wait()\n\n    reply := &lt;-request.Confirm\n    fmt.Println(reply.Value)\n}\n</code></pre>\n"}, {"tags": ["go", "synchronization", "channel"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1572788487, "post_id": 58680607, "comment_id": 103661195, "body": "A bit of nitpicking: technically speaking, <code>mysl[i]</code> could not be a variable even in an otherwise correct context: <code>mysl</code> is a (compound) variable but <code>mysl[i]</code> merely refers to an element of it."}], "tags": [], "owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "is_accepted": true, "score": 3, "last_activity_date": 1572787676, "last_edit_date": 1592644375, "creation_date": 1572787676, "answer_id": 58680607, "question_id": 58680519, "link": "https://stackoverflow.com/questions/58680519/non-name-on-left-side-of/58680607#58680607", "title": "non-name on left side of :=", "body": "<p>You're using the &quot;short variable declaration&quot; syntax. From the <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">language specification</a>:</p>\n<blockquote>\n<p>It is shorthand for a regular variable declaration with initializer expressions but no types</p>\n<p>...</p>\n<p>Unlike regular variable declarations, a short variable declaration may redeclare\nvariables provided they were originally declared earlier in the same block (or the parameter lists if the block is the function body) with the same type, and at least one of the non-blank variables is new.</p>\n</blockquote>\n<p>Put differently: your code tries redeclaring <code>mysl[i]</code>. This does not conform to the &quot;at least one of the non-blank variables is new&quot; rule, so the compiler complains. Instead, you'll want to do only an assignment - using the <code>=</code> operator.</p>\n"}], "owner": {"reputation": 9276, "user_id": 2409793, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/QDLY9.png?s=128&g=1", "display_name": "pkaramol", "link": "https://stackoverflow.com/users/2409793/pkaramol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2537, "favorite_count": 0, "closed_date": 1572792250, "accepted_answer_id": 58680607, "answer_count": 1, "score": 1, "last_activity_date": 1572792288, "creation_date": 1572787080, "last_edit_date": 1572792155, "question_id": 58680519, "link": "https://stackoverflow.com/questions/58680519/non-name-on-left-side-of", "closed_reason": "Duplicate", "title": "non-name on left side of :=", "body": "<p>I am practicing / experimenting a bit with synchronisation mechanics in <code>go</code>.</p>\n\n<p>Why does the last <code>for</code> iteration fail to assign the values held by the buffered channel <code>valchan</code> into <code>mysl</code> slice?</p>\n\n<p>The error is </p>\n\n<blockquote>\n  <p>./myprog.go:28:7: non-name mysl[i] on left side of :=</p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"sync\"\n)\n\nconst NUM_ROUTINES = 2\n\nfunc sendValue(c chan string) {\n    c &lt;- \"HelloWorld\"\n}\n\nfunc main() {\n    valchan := make(chan string, NUM_ROUTINES)\n    var wg sync.WaitGroup\n    wg.Add(NUM_ROUTINES)\n\n    for i := 0; i &lt; NUM_ROUTINES; i++ {\n        go func() {\n            sendValue(valchan)\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n\n    mysl := make([]string, 2, 2)\n    for i := 0; i &lt; NUM_ROUTINES; i++ {\n        mysl[i] := &lt;-valchan\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 5341, "user_id": 8597510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I3rOM.jpg?s=128&g=1", "display_name": "Tsvetan Ganev", "link": "https://stackoverflow.com/users/8597510/tsvetan-ganev"}, "edited": false, "score": 0, "creation_date": 1572777055, "post_id": 58679242, "comment_id": 103658671, "body": "I think you have a typo - <code>json:&quot;nested&quot;</code> (Go) -&gt; &quot;neted&quot; (actual JSON)"}, {"owner": {"reputation": 31, "user_id": 10407033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XhfVVJUg6L8/AAAAAAAAAAI/AAAAAAAAAak/RtHx_zrmezw/photo.jpg?sz=128", "display_name": "Claudio Merli", "link": "https://stackoverflow.com/users/10407033/claudio-merli"}, "reply_to_user": {"reputation": 5341, "user_id": 8597510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I3rOM.jpg?s=128&g=1", "display_name": "Tsvetan Ganev", "link": "https://stackoverflow.com/users/8597510/tsvetan-ganev"}, "edited": false, "score": 0, "creation_date": 1572777565, "post_id": 58679242, "comment_id": 103658780, "body": "Thank you! What about the <code>project</code> key?"}, {"owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1572778912, "post_id": 58679242, "comment_id": 103659072, "body": "You can also use <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">tools like this one</a> to convert your JSON to a go struct; that usually prevents hard to find typo problems."}], "answers": [{"tags": [], "owner": {"reputation": 1161, "user_id": 6013663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a7b2e785ad782e5103fd679b9ec849?s=128&d=identicon&r=PG", "display_name": "Masudur Rahman", "link": "https://stackoverflow.com/users/6013663/masudur-rahman"}, "is_accepted": false, "score": 1, "last_activity_date": 1572778463, "creation_date": 1572778463, "answer_id": 58679460, "question_id": 58679242, "link": "https://stackoverflow.com/questions/58679242/how-to-unmarshal-nested-struct-json/58679460#58679460", "title": "How to unmarshal nested struct JSON", "body": "<p>You have another typo in your <code>project</code> key.</p>\n\n<p>You have a space in <code>\"project \"</code>. Remove the space and it will work fine.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>document:= []byte(`\n    {\n        \"project\" : {\"name\" : \"Project 1\"},\n        \"hours\" : 4,\n        \"date\" : \"2019-11-03\",\n        \"nested\" : {\"nested_field\" : \"test\"}\n    }\n`)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10407033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XhfVVJUg6L8/AAAAAAAAAAI/AAAAAAAAAak/RtHx_zrmezw/photo.jpg?sz=128", "display_name": "Claudio Merli", "link": "https://stackoverflow.com/users/10407033/claudio-merli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572792541, "creation_date": 1572776752, "last_edit_date": 1572792541, "question_id": 58679242, "link": "https://stackoverflow.com/questions/58679242/how-to-unmarshal-nested-struct-json", "title": "How to unmarshal nested struct JSON", "body": "<p>I'm studying about JSON encoding and decoding, but I'm stuck on nested struct unmarshaling.</p>\n\n<p>I tried to declare both the children struct as external type and explicit struct in the parent as follow:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type WorkingSession struct {\n    Project Project `json:\"project\"`\n    Hours int    `json:\"hours\"`\n    Date  string `json:\"date\"`\n    Nested struct{\n        NestedField string `json:\"nested_field\"`\n    } `json:\"nested\"`\n}\n\ntype Project struct {\n    Name string `json:\"name\"`\n}\n</code></pre>\n\n<p>But when I execute my main:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    document:= []byte(`\n        {\n            \"project \" : {\"name\" : \"Project 1\"},\n            \"hours\" : 4,\n            \"date\" : \"2019-11-03\",\n            \"nested\" : {\"nested_field\" : \"test\"}\n        }\n    `)\n\n    var ws WorkingSession\n\n    err := json.Unmarshal(document, &amp;ws)\n\n    log.Println(ws)\n    if err != nil {\n        log.Fatal(err.Error())\n    }\n\n}\n</code></pre>\n\n<p>It does not print the <code>project</code> nested fields:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>2019/11/03 11:24:04 {{} 4 2019-11-03 {test}}\n</code></pre>\n\n<p>What is wrong?</p>\n"}, {"tags": ["go", "goland", "go-get"], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 3935209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xDm8d.jpg?s=128&g=1", "display_name": "V&#237;ctor M", "link": "https://stackoverflow.com/users/3935209/v%c3%adctor-m"}, "edited": false, "score": 0, "creation_date": 1573485330, "post_id": 58797099, "comment_id": 103887927, "body": "I will try it and tell you. Thank you for the reply"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1573498968, "post_id": 58797099, "comment_id": 103893906, "body": "You should enable modules support in the IDE, Settings/Preferences | Go | Go Modules (vgo) for Go Modules to work."}, {"owner": {"reputation": 307, "user_id": 3935209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xDm8d.jpg?s=128&g=1", "display_name": "V&#237;ctor M", "link": "https://stackoverflow.com/users/3935209/v%c3%adctor-m"}, "edited": false, "score": 0, "creation_date": 1573592632, "post_id": 58797099, "comment_id": 103929855, "body": "It is enabled. I have opened a ticket on jetbrains web page because the previous EAP version worked great"}, {"owner": {"reputation": 181, "user_id": 6807086, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EgGUrIGO12c/AAAAAAAAAAI/AAAAAAAAAWQ/qC7HPFxqxOM/photo.jpg?sz=128", "display_name": "JWang", "link": "https://stackoverflow.com/users/6807086/jwang"}, "edited": false, "score": 0, "creation_date": 1573618250, "post_id": 58797099, "comment_id": 103936209, "body": "Yes, the EAP version is unstable"}, {"owner": {"reputation": 307, "user_id": 3935209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xDm8d.jpg?s=128&g=1", "display_name": "V&#237;ctor M", "link": "https://stackoverflow.com/users/3935209/v%c3%adctor-m"}, "edited": false, "score": 1, "creation_date": 1573651621, "post_id": 58797099, "comment_id": 103950607, "body": "I have received their response from the ticket I have opened: &quot;Thank you for reporting the problem. This is a known issue and it has already been fixed. The fix will be included in the next EAP version.&quot;"}], "tags": [], "owner": {"reputation": 181, "user_id": 6807086, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EgGUrIGO12c/AAAAAAAAAAI/AAAAAAAAAWQ/qC7HPFxqxOM/photo.jpg?sz=128", "display_name": "JWang", "link": "https://stackoverflow.com/users/6807086/jwang"}, "is_accepted": true, "score": 1, "last_activity_date": 1573457066, "creation_date": 1573457066, "answer_id": 58797099, "question_id": 58679154, "link": "https://stackoverflow.com/questions/58679154/go-get-returns-go-flag-needs-an-argument-mod/58797099#58797099", "title": "go get returns go: flag needs an argument: -mod", "body": "<p><a href=\"https://i.stack.imgur.com/q8ySr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q8ySr.png\" alt=\"enter image description here\"></a></p>\n\n<p>I think the problem is with you IDE: Goland</p>\n\n<p>Use <code>go env</code> in the terminal</p>\n\n<p>Your will see a env value called GOFLAGS, that is the problem</p>\n\n<p>Just unset the env value by using <code>unset GOFLAGS</code></p>\n"}], "owner": {"reputation": 307, "user_id": 3935209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xDm8d.jpg?s=128&g=1", "display_name": "V&#237;ctor M", "link": "https://stackoverflow.com/users/3935209/v%c3%adctor-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 58797099, "answer_count": 1, "score": 0, "last_activity_date": 1573495905, "creation_date": 1572775990, "last_edit_date": 1573495905, "question_id": 58679154, "link": "https://stackoverflow.com/questions/58679154/go-get-returns-go-flag-needs-an-argument-mod", "title": "go get returns go: flag needs an argument: -mod", "body": "<p>I have updated my go version from go1.12.4 to go1.13.4. I have created a project and initialized it with <code>go mod init myproject</code> creating a <code>go.mod</code> file with the information:</p>\n\n<pre><code>module myproject\n\ngo 1.13\n</code></pre>\n\n<p>When I try to download a dependency</p>\n\n<pre><code> go get github.com/kelseyhightower/envconfig\n</code></pre>\n\n<p>It returns the following message:</p>\n\n<pre><code>go: flag needs an argument: -mod (from $GOFLAGS)\nusage: go get [-d] [-t] [-u] [-v] [-insecure] [build flags] [packages]\nRun 'go help get' for details.\n</code></pre>\n\n<p>I have reviewed the doc from <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">golang modules wiki</a> and from its <a href=\"https://goissues.org/other\" rel=\"nofollow noreferrer\">github issues</a> but couldn't find any solution.</p>\n\n<p>I have downgraded to go1.12.13 version, but I still have the same problem.</p>\n\n<p>My <code>go env</code> variables are:</p>\n\n<pre><code>GO111MODULE=\"on\"\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOCACHE=\"/home/user/.cache/go-build\"\nGOENV=\"/home/usser/.config/go/env\"\nGOEXE=\"\"\nGOFLAGS=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGONOPROXY=\"\"\nGONOSUMDB=\"\"\nGOOS=\"linux\"\nGOPATH=\"/home/user/go\"\nGOPRIVATE=\"\"\nGOPROXY=\"https://proxy.golang.org,direct\"\nGOROOT=\"/usr/local/go\"\nGOSUMDB=\"sum.golang.org\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nAR=\"ar\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nGOMOD=\"/dev/null\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build555598313=/tmp/go-build -gno-record-gcc-switches\"\n</code></pre>\n\n<p>Thank you so much</p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1572775336, "post_id": 58678876, "comment_id": 103658281, "body": "Because the language spec says so."}, {"owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1572778479, "post_id": 58678876, "comment_id": 103658974, "body": "All arguments are evaluated at the time the <code>go</code> keyword is encountered, then the goroutine starts with these calculated values. If you don&#39;t want this, you&#39;ll need to start a <code>func</code> that calculates these values, like this: <code>go func() { yourFuncWithArgs(arg1.Text(), arg2) }()</code>; however, that often doesn&#39;t make sense. The same behaviour is also valid for <code>defer</code>"}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 2218931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/962ce6ae1a76fac9ab25b139666d7443?s=128&d=identicon&r=PG", "display_name": "ponypaver", "link": "https://stackoverflow.com/users/2218931/ponypaver"}, "edited": false, "score": 0, "creation_date": 1572940250, "post_id": 58679714, "comment_id": 103707731, "body": "Thank you for your swift reply, but I dont&#39;t understand <a href=\"https://play.golang.org/p/RFiuFce-icI\" rel=\"nofollow noreferrer\"><i>this code</i></a> could you please explain the output ?"}, {"owner": {"reputation": 251, "user_id": 2218931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/962ce6ae1a76fac9ab25b139666d7443?s=128&d=identicon&r=PG", "display_name": "ponypaver", "link": "https://stackoverflow.com/users/2218931/ponypaver"}, "edited": false, "score": 0, "creation_date": 1573019794, "post_id": 58679714, "comment_id": 103739633, "body": "I understand the rewritten pattern, but I don&#39;t understand the output, the point is the output, not how to rewrite it. Like why that is the first evaluated, the why that is second, etc... Thanks in advance."}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 251, "user_id": 2218931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/962ce6ae1a76fac9ab25b139666d7443?s=128&d=identicon&r=PG", "display_name": "ponypaver", "link": "https://stackoverflow.com/users/2218931/ponypaver"}, "edited": false, "score": 0, "creation_date": 1573024775, "post_id": 58679714, "comment_id": 103741465, "body": "See <b>Explanation</b>, I hope this helps."}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 0, "last_activity_date": 1573472677, "last_edit_date": 1573472677, "creation_date": 1572780575, "answer_id": 58679714, "question_id": 58678876, "link": "https://stackoverflow.com/questions/58678876/why-input-text-is-evaluated-in-the-main-goroutine/58679714#58679714", "title": "why input.Text() is evaluated in the main goroutine", "body": "<p>How <code>go</code> keyword works in Go, see\n<a href=\"https://golang.org/ref/spec#Go_statements\" rel=\"nofollow noreferrer\">Go_statements</a>:  </p>\n\n<blockquote>\n  <p>The <strong>function value</strong> and <strong>parameters</strong> are <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">evaluated as usual</a> in the calling goroutine, but unlike with a regular call, program execution does not wait for the invoked function to complete. Instead, the function begins executing independently in a new goroutine. When the function terminates, its goroutine also terminates. If the function has any return values, they are discarded when the function completes.</p>\n</blockquote>\n\n<hr>\n\n<p>The <strong>function value</strong> and <strong>parameters</strong> are <strong>evaluated</strong> in place with the <code>go</code> keyword (same for the <code>defer</code> keyword see an <a href=\"https://stackoverflow.com/a/58661114/8208215\">example for <code>defer</code> keyword</a>).</p>\n\n<hr>\n\n<p>To understand the evaluation order, let's try this:</p>\n\n<pre><code>go have()(fun(\"with Go.\"))\n</code></pre>\n\n<p>Let's run <a href=\"https://play.golang.org/p/2-13guGXeZj\" rel=\"nofollow noreferrer\">this</a> and read the code comments for the evaluation order:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    go have()(fun(\"with Go.\"))\n\n    fmt.Print(\"some \") // evaluation order: ~ 3\n    wg.Wait()\n}\n\nfunc have() func(string) {\n    fmt.Print(\"Go \") // evaluation order: 1\n    return funWithGo\n}\n\nfunc fun(msg string) string {\n    fmt.Print(\"have \") // evaluation order: 2\n    return msg\n}\n\nfunc funWithGo(msg string) {\n    fmt.Println(\"fun\", msg) // evaluation order: 4\n    wg.Done()\n}\n\nfunc init() {\n    wg.Add(1)\n}\n\nvar wg sync.WaitGroup\n\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Go have some fun with Go.\n</code></pre>\n\n<p><strong>Explanation</strong> <code>go have()(fun(\"with Go.\"))</code>:<br>\nFirst in place evaluation takes place here:<br>\n<code>go have()(...)</code> first <code>have()</code> part runs and the result is <code>fmt.Print(\"Go \")</code> and <code>return funWithGo</code>, then <code>fun(\"with Go.\")</code> runs, and the result is <code>fmt.Print(\"have \")</code> and <code>return \"with Go.\"</code>; now we have <code>go funWithGo(\"with Go.\")</code>.   </p>\n\n<p>So the final <strong>goroutine</strong> call is <code>go funWithGo(\"with Go.\")</code><br>\nThis is a call to start a new goroutine so really we don't know when it will run. So there is a chance for the next line to run: <code>fmt.Print(\"some \")</code>, then we wait here <code>wg.Wait()</code>. Now the goroutine runs this <code>funWithGo(\"with Go.\")</code> and the result is <code>fmt.Println(\"fun\", \"with Go.\")</code> then <code>wg.Done()</code>; that is all.</p>\n\n<p>Let's rewrite the above code, just replace named functions with anonymous one, so this code is same as above:<br>\nFor example see:</p>\n\n<pre><code>func have() func(string) {\n    fmt.Print(\"Go \") // evaluation order: 1\n    return funWithGo\n}\n</code></pre>\n\n<p>And cut this code select the <code>have</code> part in the <code>go have()</code> and paste then select the <code>have</code> part in <code>func have()</code> and press <code>Delete</code> on the keyboard, then you'll have this:<br>\n<a href=\"https://play.golang.org/p/RFiuFce-icI\" rel=\"nofollow noreferrer\">This</a> is even more beautiful, with the same result, just replace all functions with anonymous functions:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(1)\n\n    go func() func(string) {\n        fmt.Print(\"Go \") // evaluation order: 1\n        return func(msg string) {\n            fmt.Println(\"fun\", msg) // evaluation order: 4\n            wg.Done()\n        }\n    }()(func(msg string) string {\n        fmt.Print(\"have \") // evaluation order: 2\n        return msg\n    }(\"with Go.\"))\n\n    fmt.Print(\"some \") // evaluation order: ~ 3\n    wg.Wait()\n}\n</code></pre>\n\n<hr>\n\n<p>Let me explain it with a simple example:<br>\n1. Consider this simple code:  </p>\n\n<pre><code>i := 1\ngo fmt.Println(i) // 1\n</code></pre>\n\n<p>This is clear enough: the output is <code>1</code>.  </p>\n\n<p>But if the Go designers decided to evaluate the function argument at <s>the function run-time</s> nobody knows the value of <code>i</code>; you might change the <code>i</code> in your code (see the next example)</p>\n\n<hr>\n\n<ol start=\"2\">\n<li>Now let's do this closure:  </li>\n</ol>\n\n<pre><code>i := 1\ngo func() {\n    time.Sleep(1 * time.Second)\n    fmt.Println(i) // ?\n}()\n</code></pre>\n\n<p>The output is really <strong>unknown</strong>, and if the <code>main</code> goroutine exits sooner, it even won't have a chance to run: Wake up and print the <code>i</code>, which is <code>i</code> itself may change to that specific moment.</p>\n\n<hr>\n\n<ol start=\"3\">\n<li>Now let's solve it like so:</li>\n</ol>\n\n<pre><code>i := 1\ngo func(i int) { \n    fmt.Printf(\"Step 3 i is: %d\\n\", i) // i = 1\n}(i)\n</code></pre>\n\n<p>This anonymous function argument is of type <code>int</code> and it is a value type, and the value of <code>i</code> is known, and <strong>the compiler-generated code</strong> pushes the value <code>1</code> (<code>i</code>) to the stack, so this function, will use the value <code>1</code>, when the time comes (A time in the future).</p>\n\n<hr>\n\n<ol start=\"4\">\n<li>All (<a href=\"https://play.golang.org/p/PbdXU_fQYrl\" rel=\"nofollow noreferrer\">The Go Playground</a>):  </li>\n</ol>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    i := 1\n    go fmt.Println(i) // 1 (when = unknown)\n    go fmt.Println(2) // 2 (when = unknown)\n\n    go func() { // closure\n        time.Sleep(1 * time.Second)\n        fmt.Println(\" This won't have a chance to run\", i) // i = unknown  (when = unknown)\n    }()\n\n    i = 3\n    wg := new(sync.WaitGroup)\n    wg.Add(1)\n    go func(i int) {\n        defer wg.Done()\n        fmt.Printf(\"Step 3 i is: %d\\n\", i) // i = 3 (when = unknown)\n    }(i)\n\n    i = 4\n\n    go func(step int) { // closure\n        fmt.Println(step, i) // i=? (when = unknown)\n    }(5)\n    i = 5\n    fmt.Println(i) // i=5\n\n    wg.Wait()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>5\n5 5\n2\n1\nStep 3 i is: 3\n</code></pre>\n\n<p>The Go Playground output:</p>\n\n<pre><code>5\n5 5\n1\n2\nStep 3 i is: 3\n</code></pre>\n\n<p>As you may be noticed, the order of <code>1</code> and <code>2</code> is random, and your output may differ (See the code comments).</p>\n"}], "owner": {"reputation": 251, "user_id": 2218931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/962ce6ae1a76fac9ab25b139666d7443?s=128&d=identicon&r=PG", "display_name": "ponypaver", "link": "https://stackoverflow.com/users/2218931/ponypaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 58679714, "answer_count": 1, "score": -2, "last_activity_date": 1573472677, "creation_date": 1572773334, "last_edit_date": 1572775506, "question_id": 58678876, "link": "https://stackoverflow.com/questions/58678876/why-input-text-is-evaluated-in-the-main-goroutine", "title": "why input.Text() is evaluated in the main goroutine", "body": "<p>In chapter 8 of <a href=\"https://books.google.com.hk/books?id=SJHvCgAAQBAJ&amp;pg=PT296&amp;lpg=PT296&amp;dq=input.Text()+is+evaluated+in+the+main+goroutine&amp;source=bl&amp;ots=qzkHFYgXuf&amp;sig=ACfU3U2KCRpP3d2H-kX3bek5D4juin1aPw&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwje8K2v3c3lAhU0zIsBHbfhCdkQ6AEwAHoECAkQAQ#v=onepage&amp;q=input.Text()%20is%20evaluated%20in%20the%20main%20goroutine&amp;f=false\" rel=\"nofollow noreferrer\"><em>The Go Programming Language</em></a>, there is a description to the concurrency echo server as below:</p>\n\n<blockquote>\n  <p>The arguments to the function started by go are evaluated when the go statement itself is executed; thus input.Text() is evaluated in the main goroutine.</p>\n</blockquote>\n\n<p>I don't understand this. Why the <code>input.Text()</code> is evaluated at the main goroutine? Shouldn't it be in the go echo() goroutine?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Copyright \u00a9 2016 Alan A. A. Donovan &amp; Brian W. Kernighan.\n// License: https://creativecommons.org/licenses/by-nc-sa/4.0/\n\n// See page 224.\n\n// Reverb2 is a TCP server that simulates an echo.\npackage main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"strings\"\n    \"time\"\n)\n\nfunc echo(c net.Conn, shout string, delay time.Duration) {\n    fmt.Fprintln(c, \"\\t\", strings.ToUpper(shout))\n    time.Sleep(delay)\n    fmt.Fprintln(c, \"\\t\", shout)\n    time.Sleep(delay)\n    fmt.Fprintln(c, \"\\t\", strings.ToLower(shout))\n}\n\n//!+\nfunc handleConn(c net.Conn) {\n    input := bufio.NewScanner(c)\n    for input.Scan() {\n        go echo(c, input.Text(), 1*time.Second)\n    }\n    // NOTE: ignoring potential errors from input.Err()\n    c.Close()\n}\n\n//!-\n\nfunc main() {\n    l, err := net.Listen(\"tcp\", \"localhost:8000\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    for {\n        conn, err := l.Accept()\n        if err != nil {\n            log.Print(err) // e.g., connection aborted\n            continue\n        }\n        go handleConn(conn)\n    }\n}\n</code></pre>\n\n<p>code is here: <a href=\"https://github.com/adonovan/gopl.io/blob/master/ch8/reverb2/reverb.go\" rel=\"nofollow noreferrer\">https://github.com/adonovan/gopl.io/blob/master/ch8/reverb2/reverb.go</a></p>\n"}, {"tags": ["go", "proxy", "tls1.2"], "owner": {"reputation": 11, "user_id": 12315055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBBv2B5d76vlWk7BMDGN-3ewNHO5qrFs90uXhp6kQ=k-s128", "display_name": "pharaohW", "link": "https://stackoverflow.com/users/12315055/pharaohw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572770522, "creation_date": 1572768225, "last_edit_date": 1572770522, "question_id": 58678405, "link": "https://stackoverflow.com/questions/58678405/in-go-http-transport-how-to-set-up-proxy-with-dialtls", "title": "In Go/http/transport\uff0chow to set up proxy with DialTLS?", "body": "<p>I want to modify ClientHello content with <a href=\"https://github.com/refraction-networking/utls\" rel=\"nofollow noreferrer\">utls</a>, and I try to use utls with http.Transport. But the DialTLS says it's for non-proxied HTTPS requests, I want to request with utls and proxy. How can I do that? How to make DialTLS for proxied HTTPS requests?</p>\n\n<pre><code>// DialTLS specifies an optional dial function for creating\n// TLS connections for non-proxied HTTPS requests.\nDialTLS func(network, addr string) (net.Conn, error)\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 2, "creation_date": 1572742795, "post_id": 58676589, "comment_id": 103654129, "body": "Check Unmarshal&#39;s return value."}, {"owner": {"reputation": 99, "user_id": 12314207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e17881d0b36af17b44209be754cf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "KingdomGnark", "link": "https://stackoverflow.com/users/12314207/kingdomgnark"}, "reply_to_user": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 0, "creation_date": 1572743645, "post_id": 58676589, "comment_id": 103654226, "body": "0 0 0 0 was the value when printing daily"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1572745005, "post_id": 58676589, "comment_id": 103654361, "body": "Your struct does only remotely resemble the input, namely a part of it. You need to unmarshal the <i>whole</i> input into a fitting struct, and then select from it what you actually need. Oh, and btw, <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">Unmarshal returns an error</a>, which prolly will tell you that your json is invalid in the first place. <b>NEVER skip evaluation of errors.</b>"}, {"owner": {"reputation": 99, "user_id": 12314207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e17881d0b36af17b44209be754cf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "KingdomGnark", "link": "https://stackoverflow.com/users/12314207/kingdomgnark"}, "edited": false, "score": 0, "creation_date": 1572748223, "post_id": 58676589, "comment_id": 103654791, "body": "I have changed the types to properly reflect those in the json, and using struct{Main Daily} I can return the proper values, but I still can&#39;t reference the original struct to put the values into a string."}], "answers": [{"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": true, "score": 3, "last_activity_date": 1572748548, "creation_date": 1572748548, "answer_id": 58676983, "question_id": 58676589, "link": "https://stackoverflow.com/questions/58676589/json-integers-returning-as-0-when-they-should-be-values/58676983#58676983", "title": "JSON integers returning as 0 when they should be values", "body": "<p>First, your sample JSON input is badly formatted: it ends with <code>},</code> when it should end with <code>}}</code>.  This causes <code>json.Unmarshal</code> to return an error:</p>\n\n<pre><code>unexpected EOF\n</code></pre>\n\n<p>Fixing that leads to lots more problems, many of which people have noted in comments.  For instance, your input does not have the same structure as your <code>struct</code>, and JSON numbers decode to <code>float64</code>, not <code>int</code>.  One of the values\u2014the one with the key <code>\"temp\"</code>\u2014is <code>73.26</code>, which is not an integer.</p>\n\n<p>I have a mild dislike of quietly ignoring unknown fields, so I like to use a <code>json.Decoder</code> in which unknown fields are disallowed.  This helps make sure you didn't screw up the data structure by using the wrong tag or a tag at the wrong level, because when you <em>do</em>, you just get all the missing fields as zero.  So I like to add an \"ignored\" decoder for explicitly ignoring fields:</p>\n\n<pre><code>type ignored [0]byte\nfunc (i *ignored) UnmarshalJSON([]byte) error {\n    return nil\n}\n</code></pre>\n\n<p>You can then declare fields of type <code>ignored</code> and yet still give them json tags (though the default of matching the name of the field tends to suffice):</p>\n\n<pre><code>type overall struct {\n    Coord   ignored\n    Weather ignored\n    Base    ignored\n    Main    Daily\n}\n</code></pre>\n\n<p>If you really want to unmarshal directly to an integer type, you need to get fancy again, which I did in my example.  It's probably wiser just to unmarshal straight to <code>float64</code> though.  If you do that\u2014use <code>float64</code> and don't add a special type just to ignore certain fields\u2014you can drop the use of <code>json.NewDecoder</code>.</p>\n\n<p>You can get even fancier and use pointers to be able to tell if your fields were filled in or not, but I did not do this in my example.  I snipped out the file reading (and the lack of error checking on the read call) and used hardcoded input data instead.  The final version, in which decoding does work, is <a href=\"https://play.golang.org/p/L_jU1bulNaA\" rel=\"nofollow noreferrer\">here on the Go Playground</a>.</p>\n"}], "owner": {"reputation": 99, "user_id": 12314207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e17881d0b36af17b44209be754cf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "KingdomGnark", "link": "https://stackoverflow.com/users/12314207/kingdomgnark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58676983, "answer_count": 1, "score": -2, "last_activity_date": 1572748548, "creation_date": 1572742640, "last_edit_date": 1572742868, "question_id": 58676589, "link": "https://stackoverflow.com/questions/58676589/json-integers-returning-as-0-when-they-should-be-values", "title": "JSON integers returning as 0 when they should be values", "body": "<p>I have the following JSON file and am trying to Parse it out. </p>\n\n<pre><code>{\n\"coord\":\n{\n\"lon\":-121.31,\n\"lat\":38.7},\n\"weather\":[\n{\n\"id\":800,\n\"main\":\"Clear\",\n\"description\":\"clear sky\",\n\"icon\":\"01d\"}\n],\n\"base\":\"stations\",\n\"main\":\n{\n\"temp\":73.26,\n\"pressure\":1018,\n\"humidity\":17,\n\"temp_min\":68,\n\"temp_max\":77},\n</code></pre>\n\n<p>The expected output is:<br />\nCurrent Temperature:73<br />\nToday's Low:68<br />\nToday's High:77<br />\nCurrent Humidity:17%<br /></p>\n\n<p>but it is instead returning:<br />\nCurrent Temperature:0<br />\nToday's Low:0<br />\nToday's High:0<br />\nCurrent Humidity:0%<br /></p>\n\n<p>This is the code I am trying to use to get the desired return:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"strconv\"\n)\n\n\ntype Daily struct {\n    Currenttemp int `json:\"temp\"`\n    Mintemp     int `json:\"temp_min\"`\n    Maxtemp     int `json:\"temp_max\"`\n    Humidity    int `json:\"humidity\"`\n}\n\n\nfunc main() {\n    jsonFile, err := os.Open(\"jsontest1.json\")\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(\"Successfully Opened jsontest1.json\")\n\n    defer jsonFile.Close()\n\n    byteValue, _ := ioutil.ReadAll(jsonFile)\n\n    var daily Daily\n\n    json.Unmarshal(byteValue, &amp;daily)\n\n\n    fmt.Println(\"Current Temperature:\"+strconv.Itoa(daily.Currenttemp))\n    fmt.Println(\"Today's Low:\"+strconv.Itoa(daily.Mintemp))\n    fmt.Println(\"Today's High:\"+strconv.Itoa(daily.Maxtemp))\n    fmt.Println(\"Current Humidity:\"+strconv.Itoa(daily.Humidity)+\"%\")\n\n\n}\n</code></pre>\n\n<p>what am I missing?</p>\n"}, {"tags": ["go", "cryptography"], "answers": [{"comments": [{"owner": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 0, "creation_date": 1572739117, "post_id": 58676303, "comment_id": 103653683, "body": "Got it. I will switch to SHA256 for sure. I thought when we save state object to disk its possible to combine those. But it makes sense now after reading your answer. For hash, I need that for file integrity. So, unique hash won&#39;t help me anyway. I use UUIDv4 identifiers for uniqueness."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 1, "creation_date": 1572739333, "post_id": 58676303, "comment_id": 103653697, "body": "Secure hashes values are considered unique because it is - or should be - impossible to create a collision. This is what you <i>need</i> to provide integrity, at least when you assume an attacker. For e.g. transmission errors it may be that a CRC is more efficient and better at correcting multi-bit mistakes (because hash values themselves may also be changed through an error, and CRC takes that into account)."}, {"owner": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 0, "creation_date": 1572739757, "post_id": 58676303, "comment_id": 103653773, "body": "Glad to hear this because in this application, I also have CRC. Thank you for this valuable information."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 1, "creation_date": 1572739968, "post_id": 58676303, "comment_id": 103653805, "body": "CRC is fast enough, just use both. As long as you use CRC for error detection and SHA-256 to protect against deliberate changes. Of course, a hash only provides protection if it can be validated <i>separately</i> from the data, otherwise an attacker can just change both. If you have to store it next to the data then you should use a signature (over the hashes if required)."}, {"owner": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 0, "creation_date": 1572740112, "post_id": 58676303, "comment_id": 103653829, "body": "Implementing this at the moment. Thanks again."}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "reply_to_user": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 0, "creation_date": 1574092345, "post_id": 58676303, "comment_id": 104098072, "body": "@Pratha did this answer your question? If yes, please remember accepting it :-)"}, {"owner": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "edited": false, "score": 0, "creation_date": 1574182134, "post_id": 58676303, "comment_id": 104136667, "body": "Sorry! I thought I accepted it before. Thank you for reminding me. Answer is accepted."}], "tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": true, "score": 4, "last_activity_date": 1572739756, "last_edit_date": 1572739756, "creation_date": 1572738829, "answer_id": 58676303, "question_id": 58676250, "link": "https://stackoverflow.com/questions/58676250/is-it-possible-to-combine-multiple-sha1-states-to-get-a-final-state-in-golang/58676303#58676303", "title": "Is it possible to combine multiple SHA1 states to get a final state in Golang?", "body": "<p>Assuming you mean the final hash over the whole file, then no, you cannot combine multiple SHA-1 hashes over partial data to create a hash over the whole file, as if it was calculated at once. The reason for this is that the initial SHA-1 state is always the same, and rehashing will restart at that specific state. Furthermore, the final block is padded and a length is added (internal to the hash function) before the final hash value is calculated.</p>\n\n<p>However, you can of course create a hash list or hash tree, where <em>you</em> define how big the blocks are. Then you can hash all the hashes over the chunk to create a topmost hash value. Now you have a different hash value than just the SHA-1 over the file, but the hash is consistent with <em>your</em> definition and can be recalculated, even in a multi-threaded fashion. It is still unique for the data within the file (assuming of course that put in the hash values sequentially) so it can be used to validate the integrity of the file. And, as far as I know, that's for normal secure hash function the <em>only</em> way to use multi-threaded hash calculation.</p>\n\n<p>For more information, Google about <a href=\"https://en.wikipedia.org/wiki/Merkle_tree\" rel=\"nofollow noreferrer\">Merkle-trees</a>.</p>\n\n<hr>\n\n<p>Of course, SHA-1 has been broken for collision resistance. Unfortunately, that's exactly what you are using it for. So please use SHA-256. If 256 bits is too much then using SHA-256 and taking the leftmost 160 bits is a more secure alternative.</p>\n"}], "owner": {"reputation": 1315, "user_id": 7412183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a73ddfb4eba2ce63e534ab68317210dc?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7412183/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 58676303, "answer_count": 1, "score": 2, "last_activity_date": 1572739756, "creation_date": 1572738216, "last_edit_date": 1572738620, "question_id": 58676250, "link": "https://stackoverflow.com/questions/58676250/is-it-possible-to-combine-multiple-sha1-states-to-get-a-final-state-in-golang", "title": "Is it possible to combine multiple SHA1 states to get a final state in Golang?", "body": "<p>In <code>Go1.13</code>, I have an upload server. This server accepts 2 types of upload. </p>\n\n<p><strong>Chunked</strong> and <strong>Chunked+Threaded</strong>. On chunked uploads everything works expected. I calculate every chunk while they are writing to disk. User can upload multiple chunks one-by-one in good order.</p>\n\n<p>This means, I can save every chunk's <code>SHA1</code> state to disk using <code>BinaryMarshaler</code>, then read previous state and continue to calculate next chunks until I find final hash. Final hash gives me whole file's <code>SHA1</code> perfectly.</p>\n\n<p>When its ordered, I can append to existing state. But problem starts on threaded.... (Simultaneously)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    hashComplete := sha256.New()\n    // read previous sttate from disk\n    state, err := ioutil.ReadFile(ctxPath)\n    if err != nil {\n        return err\n    }\n\n    if len(state) &gt; 0 {\n        unmarshaler, _ := hashComplete.(encoding.BinaryUnmarshaler)\n        if err := unmarshaler.UnmarshalBinary(state); err != nil {\n            return err\n        }\n    }\n\n    // In here im writing file to disk and hash. file object is simple File.\n    writer := io.MultiWriter(file, hashComplete)\n    n, err := io.Copy(writer, src) // src is source (io.Reader)\n\n    marshaler, _ := hashComplete.(encoding.BinaryMarshaler)\n    newState, err := marshaler.MarshalBinary()\n    if err != nil {\n        return err\n    }\n\n    shaCtxFile.Write(newState) // Here im saving last state to disk.\n\n    // Then later, after upload finishes, I read this file and get the SHA1 hex from it. It is correct.\n</code></pre>\n\n<p>Now this is chunked upload in specific/good order. The other upload method is Chunked+Threaded. This mean, User can upload chunks simultaneously at the same time then send a request to concatenate them together in given order (at last request).</p>\n\n<p>I already calculate each chunk's <code>SHA1</code> and save it to disk.</p>\n\n<p>My <strong>question</strong> is it is possible to combine those states and get the final hash or do I need to rehash after concatenate. Is there a way to combine those states?</p>\n"}, {"tags": ["go", "telegram", "telegram-bot", "telegram-webhook"], "comments": [{"owner": {"reputation": 1230, "user_id": 8817146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PumT2uwEpIM/AAAAAAAAAAI/AAAAAAAAABU/uws_6uoMmkw/photo.jpg?sz=128", "display_name": "rotimi-best", "link": "https://stackoverflow.com/users/8817146/rotimi-best"}, "edited": false, "score": 0, "creation_date": 1572871247, "post_id": 58676136, "comment_id": 103684161, "body": "What is an input request and why do you need to send one? Why not just reply the user with a message?"}, {"owner": {"reputation": 11, "user_id": 12313992, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184466461661917/picture?type=large", "display_name": "Vsevolod Molchanov", "link": "https://stackoverflow.com/users/12313992/vsevolod-molchanov"}, "reply_to_user": {"reputation": 1230, "user_id": 8817146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PumT2uwEpIM/AAAAAAAAAAI/AAAAAAAAABU/uws_6uoMmkw/photo.jpg?sz=128", "display_name": "rotimi-best", "link": "https://stackoverflow.com/users/8817146/rotimi-best"}, "edited": false, "score": 0, "creation_date": 1572961048, "post_id": 58676136, "comment_id": 103718356, "body": "@rotimi-best, I mean, for example, the bot asks a user of they name (i called in &quot;input request&quot;) and then prints &quot;Hello, &lt;name&gt;&quot;"}], "owner": {"reputation": 11, "user_id": 12313992, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184466461661917/picture?type=large", "display_name": "Vsevolod Molchanov", "link": "https://stackoverflow.com/users/12313992/vsevolod-molchanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572766530, "creation_date": 1572736845, "last_edit_date": 1572766530, "question_id": 58676136, "link": "https://stackoverflow.com/questions/58676136/how-to-send-an-input-request-to-user-and-store-the-answer-in-telegram-bot", "title": "How to send an input request to user and store the answer in telegram bot", "body": "<p>I'm writing a telegram bot in golang using github.com/Syfaro/telegram-bot-api. And I need following:</p>\n\n<ol>\n<li>A user sends a command</li>\n<li>Bot asks the user a question</li>\n<li>The user answers</li>\n<li>Then bot does some calculations and sends an answer</li>\n</ol>\n\n<p>I can't find how to send the user an input request. Can anyone, please, help me with it?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>updates := bot.ListenForWebhook(\"/\" + bot.Token)\n\nfor update := range updates {\n        chatID := update.Message.Chat.ID\n\n        if update.Message.IsCommand() {\n            msg := tgbotapi.NewMessage(chatID, \"\")\n            switch update.Message.Command() {\n            case \"command\":\n                response := tgbotapi.inputRequest(chatId, \"Enter some text:\")  //pseudocode\n                msg.Text = response.Text                                      //\n                bot.Send(msg)                                                //\n            }\n        } else {\n            bot.Send(tgbotapi.NewMessage(chatID, \"I don't know what to say\"))\n        }\n    }\n</code></pre>\n"}, {"tags": ["go", "channels"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1572730475, "post_id": 58675464, "comment_id": 103652172, "body": "The first program deadlocks because the main program executes three receive operations <code>&lt;-</code>, but only two values are sent."}], "answers": [{"tags": [], "owner": {"reputation": 264, "user_id": 7248819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fbca2c28960829c50c21ac2574676bd?s=128&d=identicon&r=PG&f=1", "display_name": "V. Dalechyn", "link": "https://stackoverflow.com/users/7248819/v-dalechyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1572730463, "creation_date": 1572730463, "answer_id": 58675513, "question_id": 58675464, "link": "https://stackoverflow.com/questions/58675464/writing-twice-to-an-unbuffered-channel-lead-to-different-results-depending-on-th/58675513#58675513", "title": "Writing twice to an unbuffered channel lead to different results depending on the select usage. Why?", "body": "<p>Ok, It looks like using <code>case &lt;-c</code> actually reads from the channel and does not simply check it for having a value as I thought.</p>\n"}], "owner": {"reputation": 264, "user_id": 7248819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fbca2c28960829c50c21ac2574676bd?s=128&d=identicon&r=PG&f=1", "display_name": "V. Dalechyn", "link": "https://stackoverflow.com/users/7248819/v-dalechyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 58675513, "answer_count": 1, "score": -2, "last_activity_date": 1572730463, "creation_date": 1572730142, "question_id": 58675464, "link": "https://stackoverflow.com/questions/58675464/writing-twice-to-an-unbuffered-channel-lead-to-different-results-depending-on-th", "title": "Writing twice to an unbuffered channel lead to different results depending on the select usage. Why?", "body": "<p>Consider two examples:</p>\n\n<p>First one:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n        c := make(chan int)\n        go func(){\n                c &lt;- 1\n        }()\n        go func(){\n                c &lt;- 2\n        }()\n        select {\n        case &lt;-c:\n                fmt.Println(\"&lt;-c:\", &lt;-c)\n                fmt.Println(\"&lt;-c:\", &lt;-c)\n        }\n}\n</code></pre>\n\n<p>As far as I know, what should happen is: Two goroutines spawn and write to the same channel, one of them blocks and waits for the main goroutine to read.</p>\n\n<p>But I don't understand what happens with the second goroutine. Does it block because the channel is unbuffered, and it <strong>can't</strong> hold two values by <strong>design</strong>.</p>\n\n<p>With this piece I am getting a deadlock. I found a similar question <a href=\"https://stackoverflow.com/questions/41860130/how-to-get-the-number-of-elements-in-an-unbuffered-channel\">here</a>.</p>\n\n<p>And if so, how this code is running then?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n        c := make(chan int)\n        go func(){\n                c &lt;- 1\n        }()\n        go func(){\n                c &lt;- 2\n        }()\n        select {\n        case forget := &lt;-c:\n                fmt.Println(\"forget:\", forget)\n                fmt.Println(\"&lt;-c:\", &lt;-c)\n        }\n}\n</code></pre>\n"}, {"tags": ["bash", "shell", "go"], "comments": [{"owner": {"reputation": 69, "user_id": 3504236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c6e8829834f9aa50ebad86e702fa5a4?s=128&d=identicon&r=PG&f=1", "display_name": "atye", "link": "https://stackoverflow.com/users/3504236/atye"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1572735196, "post_id": 58675414, "comment_id": 103653076, "body": "This comment is correct. If you answer, I can mark it accepted. @CeriseLim&#243;n"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1572738955, "creation_date": 1572738955, "answer_id": 58676317, "question_id": 58675414, "link": "https://stackoverflow.com/questions/58675414/how-to-preserve-shell-script-line-spacing-when-reading-stdout/58676317#58676317", "title": "How to preserve shell script line spacing when reading stdout?", "body": "<p>View the source and will find that whitespace is preserved by the template. The problem is that the browser is collapsing sequences of whitespace. See <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/white-space\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/CSS/white-space</a>.</p>\n"}], "owner": {"reputation": 69, "user_id": 3504236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c6e8829834f9aa50ebad86e702fa5a4?s=128&d=identicon&r=PG&f=1", "display_name": "atye", "link": "https://stackoverflow.com/users/3504236/atye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58676317, "answer_count": 1, "score": 0, "last_activity_date": 1572738955, "creation_date": 1572729677, "question_id": 58675414, "link": "https://stackoverflow.com/questions/58675414/how-to-preserve-shell-script-line-spacing-when-reading-stdout", "title": "How to preserve shell script line spacing when reading stdout?", "body": "<p>I am executing a shell script on Windows 10 via Cygwin, reading stdout and stderr to a string, and passing that string to a struct that is used to execute an html template. </p>\n\n<p>The issue is that the spacing of the output is not preserved after executing the template. Here is how I am executing a command and setting the command output to my data struct.</p>\n\n<pre><code>var outbuf, errbuf bytes.Buffer\ncmd.Stdout = &amp;outbuf\ncmd.Stderr = &amp;errbuf\n\nerr = cmd.Run()\nif err != nil {\n    log.Printf(\"Error running command: %s\", err)\n    data.Output = errbuf.String()\n    return data\n}\nlog.Printf(\"%v\", outbuf.String())\ndata.Output = outbuf.String()\nreturn data\n</code></pre>\n\n<p>The log.Printf would produce something like this, which is what I expect. New lines are shown.</p>\n\n<pre><code>If the same archived message file is in both system/logs and archived_logs, it will be searched/counted twice!\n\n====X1-SC1====\n\n\n\nDone\n</code></pre>\n\n<p>After the command is run and my data struct is updated, the data is executed with an html template.</p>\n\n<pre><code>err = t.Execute(w, data)\nif err != nil {\n    log.Println(err)\n    w.WriteHeader(http.StatusInternalServerError)\n    w.Write([]byte(fmt.Sprintf(\"Failed to execute html: %v\", err)))\n    return\n    }\n}\n</code></pre>\n\n<pre><code>&lt;div style=\"text-align:center\"&gt;\n   {{.Output}}\n&lt;/div&gt;\n</code></pre>\n\n<p>After browsing to where my project is exposed, I see the output I expect but it's all on one line. The spacing was not preserved. It seems that html/template execution is removing extra white space, or lines, or something like that. Is there a way around this?</p>\n\n<pre><code>If the same archived message file is in both system/logs and archived_logs, it will be searched/counted twice! Maybe it'll be fixed in the future.. ====X1-SC1==== Done\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1572730159, "post_id": 58674794, "comment_id": 103652114, "body": "Basic language features are explained in detail in the Tour of Go."}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 3, "last_activity_date": 1572725165, "creation_date": 1572725165, "answer_id": 58674866, "question_id": 58674794, "link": "https://stackoverflow.com/questions/58674794/checking-if-key-is-present-in-a-map-as-if-statement-condition/58674866#58674866", "title": "Checking if key is present in a map as &quot;if statement&quot; condition", "body": "<p>There are two ways you can read a value from a map. First is:</p>\n\n<pre><code>x:=m[key]\n</code></pre>\n\n<p>This will check if <code>m</code> has a value for <code>key</code>, and it will assign a copy of that value to <code>x</code> if so. If not, <code>x</code> will have its zero value. So if <code>m</code> is a, say, map[int]int, then <code>x</code> will have 0 if key is not in the map. This is not distinguishable from <code>m</code> having 0 for the given key.</p>\n\n<p>You can use the second form of map read:</p>\n\n<pre><code>x, ok:=m[key]\n</code></pre>\n\n<p>If <code>m</code> has a value for <code>key</code>, this will set <code>x</code> to that value, and set <code>ok</code> to true. If <code>m</code> does not have a value for <code>key</code>, this will set <code>x</code> to its zero value, and set <code>ok</code> to <code>false</code>.</p>\n\n<p>In <code>if _,ok:=m[\"bar\"]; ok</code>, the <code>_</code> ignores the value returned from the map, but whether or not the map contains the key is now known from the value of <code>ok</code>. The if statement first evaluates an assignment, then checks the condition, which is here the boolean value <code>ok</code>.</p>\n\n<p>In short, that if statement checks if the key is in the map, and if so, does something.</p>\n"}], "owner": {"reputation": 3789, "user_id": 5084982, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/1Y3cg.jpg?s=128&g=1", "display_name": "Le garcon", "link": "https://stackoverflow.com/users/5084982/le-garcon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58674866, "answer_count": 1, "score": -1, "last_activity_date": 1572725165, "creation_date": 1572724611, "question_id": 58674794, "link": "https://stackoverflow.com/questions/58674794/checking-if-key-is-present-in-a-map-as-if-statement-condition", "title": "Checking if key is present in a map as &quot;if statement&quot; condition", "body": "<p>I was solving katas on codewars and stumbled accross a way of checking if map has value associated with a given key. The code below is my own dummy example that returns (in a very inefficient way) \"bar\" string if function parameter is equal to 10.  </p>\n\n<p>I'm having hard times understanding how the <code>if</code> statement works here.</p>\n\n<pre><code>func Bar(x int) string {\n\n    var m = make(map[string]int)\n\n    if x == 10 {\n        m[\"bar\"] = x\n    }\n\n    if _, ok := m[\"bar\"]; ok {\n        return \"bar\"\n    }\n\n    return \"foo\"\n}\n</code></pre>\n\n<p>If I make <code>if</code> statement look like this (removing <code>_</code>)</p>\n\n<pre><code>if ok := m[\"bar\"];ok {\n</code></pre>\n\n<p>The code won't run, but I have no idea why. I don't know if this pattern is appropriate and the mechanisms behind it. For now it looks like a dirty trick as <code>if</code> evaluates only boolean expressions. So my theory is that the <code>_</code> somehow makes <code>if</code> statement think that it has a boolean condition, but I'd very much appreciate if someone guided my in the right direction</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4174, "user_id": 553994, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5631ab903c74aea4375f39259e52ccd1?s=128&d=identicon&r=PG", "display_name": "David Xia", "link": "https://stackoverflow.com/users/553994/david-xia"}, "edited": false, "score": 0, "creation_date": 1572796148, "post_id": 58674182, "comment_id": 103663248, "body": "Let me know how to improve my question if you downvoted it."}], "answers": [{"comments": [{"owner": {"reputation": 4174, "user_id": 553994, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5631ab903c74aea4375f39259e52ccd1?s=128&d=identicon&r=PG", "display_name": "David Xia", "link": "https://stackoverflow.com/users/553994/david-xia"}, "edited": false, "score": 0, "creation_date": 1572796314, "post_id": 58674845, "comment_id": 103663317, "body": "Thanks for answering. So is my second code snippet of using two type assertions a good approach? Also curious of other ways other than type switches to do this, if any."}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "reply_to_user": {"reputation": 4174, "user_id": 553994, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5631ab903c74aea4375f39259e52ccd1?s=128&d=identicon&r=PG", "display_name": "David Xia", "link": "https://stackoverflow.com/users/553994/david-xia"}, "edited": false, "score": 0, "creation_date": 1572806943, "post_id": 58674845, "comment_id": 103666317, "body": "Well, define &quot;good&quot;. :-) If you use <code>json.Unmarshal</code> into an <code>interface{}</code> you <i>must</i> test the result somehow in order to use it, and there are only a few variants of the somehow: type switch, type assertion with <code>ok</code> variable, or type assertion without <code>ok</code> variable (which will panic at runtime if the type is not what you claim it must be). The <i>only</i> way to avoid this is to call <code>json.Unmarshal</code> with a pointer to a variable of some type other than <code>interface{}</code>. That in turn means &quot;inspect the json to see what to expect&quot;. Pick one of these two methods."}], "tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": true, "score": 3, "last_activity_date": 1572725329, "last_edit_date": 1572725329, "creation_date": 1572725027, "answer_id": 58674845, "question_id": 58674182, "link": "https://stackoverflow.com/questions/58674182/how-to-check-variable-declared-as-mapstringinterface-is-actually-mapstring/58674845#58674845", "title": "How to check variable declared as map[string]interface{} is actually map[string]string?", "body": "<p>If you declare a variable as type <code>interface{}</code>, it <em>is</em> type <code>interface{}</code>.  It <em>is not</em>, ever, some <code>map[keytype]valuetype</code> value.  But a variable of type <code>interface{}</code> can <em>hold</em> a value that has some other concrete type.  When it does so, it does so\u2014that's all there is to it.  It still <em>is</em> type <code>interface{}</code>, but it <em>holds</em> a value of some other type.</p>\n\n<h3>An interface value has two parts</h3>\n\n<p>The key distinction here is between what an <code>interface{}</code> variable <em>is</em>, and what it <em>holds</em>.  Any interface variable actually has two slots inside it: one to hold what <em>type</em> is stored in it, and one to hold what <em>value</em> is stored in it.  Any time you\u2014or anyone\u2014assign a value <em>to</em> the variable, the compiler fills in both slots: the type, from the type of the value you used, and the value, from the value you used.<sup>1</sup>  The interface variable compares equal to nil if it has <code>nil</code> in <em>both</em> slots; and that's also the default zero value.</p>\n\n<p>Hence, your runtime test:</p>\n\n<pre><code>valueMap, ok := myMap.(map[string]interface{})\n</code></pre>\n\n<p>is a sensible thing to do: if <code>myMap</code> holds a value that has type <code>map[string]interface</code>, <code>ok</code> gets set to <code>true</code> and <code>valueMap</code> contains the value (which has that type).  If <code>myMap</code> holds a value with some other type, <code>ok</code> gets set to <code>false</code> and <code>valueMap</code> gets set to the zero-value of type <code>map[string]interface{}</code>.  In other words, at runtime, the code checks the type-slot first, then either copies the value-slot across to <code>valueMap</code> and sets <code>ok</code> to true, or sets <code>valueMap</code> to <code>nil</code> and sets <code>ok</code> to false.</p>\n\n<p>If and when <code>ok</code> has been set to <code>true</code>, each <code>valueMap[k]</code> value <em>is</em> type <code>interface{}</code>.   As before, for <code>myMap</code> itself, each of these <code>interface{}</code> variables can\u2014but do not have to\u2014hold a value of type <code>string</code>, and you <em>must</em> use some sort of \"what is the actual type-and-value\" run-time test to tease them apart.</p>\n\n<p>When you use <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal</code></a> to stuff decoded JSON into a variable of type <code>interface{}</code>, it is capable of deserializing any of these documented JSON types.  The list then tells you what <em>type</em> gets stuffed into the interface variable:</p>\n\n<blockquote>\n<pre><code>bool, for JSON booleans\nfloat64, for JSON numbers\nstring, for JSON strings\n[]interface{}, for JSON arrays\nmap[string]interface{}, for JSON objects\nnil for JSON null\n</code></pre>\n</blockquote>\n\n<p>So after doing <code>json.Unmarshal</code> into a variable of type <code>interface{}</code>, you <em>should</em> check what type got put into the type-slot of the variable.  You can do this with an assertion and an <code>ok</code> boolean, or you can, if you prefer, use a <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\"><em>type switch</em></a> to decode it:</p>\n\n<pre><code>var i interface\nif err := json.Unmarshal(data, &amp;i); err != nil {\n    panic(err)\n}\nswitch v := i.(type) {\ncase string:\n    ... code ...\ncase map[string]interface{}:\n    ... code ...\n... add some or all of the types listed ...\n}\n</code></pre>\n\n<p>The thing is, no matter what you do in code here, you <em>did</em> have <code>json.Unmarshal</code> put something into an <code>interface{}</code>, and <code>interface{}</code> <em>is</em> the type of <code>i</code>.  You must test at runtime what <em>type and value pair</em> the interface holds.</p>\n\n<p>Your other option is to inspect your JSON strings manually and decide what type of variable to provide to <code>json.Unmarshal</code>.  That gives you less code to write <em>after</em> the <code>Unmarshal</code>, but more code to write <em>before</em> it.</p>\n\n<p>There's a more complete example <a href=\"https://play.golang.org/p/IKD4kM1Q6u-\" rel=\"nofollow noreferrer\">here, on the Go playground</a>, of using type switches to inspect the result from a <code>json.Unmarshal</code>.  It's deliberately incomplete but, I think, has enough input and output cases to let you work out how to handle everything, given the quote above about what <code>json.Unmarshal</code> writes into a variable of type <code>interface{}</code>.</p>\n\n<hr>\n\n<p><sup>1</sup>Of course, if you assign one <code>interface{}</code> from some other <code>interface{}</code>:</p>\n\n<pre><code>var i1, i2 interface{}\n... set i1 from some actual value ...\n// more code, then:\ni2 = i1\n</code></pre>\n\n<p>the compiler just copies both slots from <code>i1</code> into <code>i2</code>.  The two-separate-slots thing becomes clearer when you do:</p>\n\n<pre><code>var f float64\n... code that sets f to, say, 1.5 ...\ni2 = f\n</code></pre>\n\n<p>for instance, as that writes <code>float64</code> into the type-slot, and the value <code>1.5</code> into the value-slot.  The compiler <em>knows</em> that <code>f</code> is <code>float64</code> so the type-setting just means \"stick a constant in it\".  The compiler doesn't necessarily know the <em>value</em> of <code>f</code> so the value-setting is a copy of whatever the actual value is.</p>\n"}], "owner": {"reputation": 4174, "user_id": 553994, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5631ab903c74aea4375f39259e52ccd1?s=128&d=identicon&r=PG", "display_name": "David Xia", "link": "https://stackoverflow.com/users/553994/david-xia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 58674845, "answer_count": 1, "score": 2, "last_activity_date": 1572725329, "creation_date": 1572720180, "question_id": 58674182, "link": "https://stackoverflow.com/questions/58674182/how-to-check-variable-declared-as-mapstringinterface-is-actually-mapstring", "title": "How to check variable declared as map[string]interface{} is actually map[string]string?", "body": "<p>I have a variable that needs to be either a <code>string</code> or <code>map[string]string</code> (will be deserializing from JSON). So I declare it as <code>interface{}</code>. How can I check that the value is <code>map[string]string</code>?</p>\n\n<p>This question <a href=\"https://stackoverflow.com/questions/40384879/how-to-check-interface-is-a-mapstringstring-in-golang\">How to check interface is a map[string]string in golang</a> almost answers my question. But the accepted answer only works if the variable is declared as a <code>map[string]string</code> not if the variable is <code>interface{}</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    var myMap interface{}\n    myMap = map[string]interface{}{\n        \"foo\": \"bar\",\n    }\n    _, ok := myMap.(map[string]string)\n    if !ok {\n        fmt.Println(\"This will be printed\")\n    }\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/mA-CVk7bdb9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mA-CVk7bdb9</a></p>\n\n<p>I can use two type assertions though. One on the map and one on the map value.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var myMap interface{}\n    myMap = map[string]interface{}{\n        \"foo\": \"bar\",\n    }\n\n    valueMap, ok := myMap.(map[string]interface{})\n    if !ok {\n        fmt.Println(\"will not be printed\")\n    }\n    for _, v := range valueMap {\n        if _, ok := v.(string); !ok {\n            fmt.Println(\"will not be printed\")\n        }\n    }\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/hCl8eBcKSqE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hCl8eBcKSqE</a></p>\n\n<p>Question: is there a better way?</p>\n"}, {"tags": ["c", "arrays", "go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 0, "last_activity_date": 1572814470, "last_edit_date": 1572814470, "creation_date": 1572723278, "answer_id": 58674615, "question_id": 58673984, "link": "https://stackoverflow.com/questions/58673984/how-to-send-uint8-t-array-from-c-to-go/58674615#58674615", "title": "How to send uint8_t array from C to GO", "body": "<blockquote>\n  <p>I want to send uint8_t array from C to Go [and as an array or a slice]</p>\n</blockquote>\n\n<hr>\n\n<p>For your example,</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdint.h&gt;\n\nuint8_t Plaintext[16] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};\n\nuint8_t *send_data( ) {\n    return  Plaintext;\n}\n*/\nimport \"C\"\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"unsafe\"\n)\n\nfunc main() {\n    // your example\n    data := (*[16]byte)(unsafe.Pointer(C.send_data()))\n    fmt.Printf(\"\\n%T:\\n%d %d : %v\\n\", data, len(data), cap(data), *data)\n\n    // array example\n    const c = 16 // array length is constant\n    a := (*[c]byte)(unsafe.Pointer(C.send_data()))\n    fmt.Printf(\"\\n%T:\\n%d %d : %v\\n\", a, len(a), cap(a), *a)\n\n    // slice example\n    var v = 16 // slice length is variable\n    var s []byte\n    const vmax = math.MaxInt32 / unsafe.Sizeof(s[0])\n    s = (*[vmax]byte)(unsafe.Pointer(C.send_data()))[:v:v]\n    fmt.Printf(\"\\n%T:\\n%d %d : %v\\n\", s, len(s), cap(s), s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15]\n\n*[16]uint8:\n16 16 : [0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15]\n\n[]uint8:\n16 16 : [0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15]\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10986180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Lff_VSb4xUk/AAAAAAAAAAI/AAAAAAAAAOE/4czV1FHjOLE/photo.jpg?sz=128", "display_name": "jayen marco", "link": "https://stackoverflow.com/users/10986180/jayen-marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 1, "accepted_answer_id": 58674615, "answer_count": 1, "score": 1, "last_activity_date": 1572814470, "creation_date": 1572718760, "question_id": 58673984, "link": "https://stackoverflow.com/questions/58673984/how-to-send-uint8-t-array-from-c-to-go", "title": "How to send uint8_t array from C to GO", "body": "<p>I want to send  uint8_t array from C to GO, but whene i send my array like pointer, i don't know how i can read it and save it in GO like byte[] array : </p>\n\n<pre><code>package main\n/*\n#include &lt;stdint.h&gt;\n\nuint8_t Plaintext[16] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};\n\nuint8_t * send_data( )\n   {\n     return  Plaintext;\n   }\n\n*/\nimport \"C\"\nimport \"unsafe\"\nimport \"fmt\"\n\nfunc main() {\n\n    data := [16]byte{}\n    p := C.send_data()\n    //already try  data = C.send_data()\n    fmt.Println(p)\n    data = p // don't know how do this ?\n\n}\n</code></pre>\n\n<p>The objectif is to have data byte array in go  like : </p>\n\n<pre><code>data[16] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f}\n</code></pre>\n\n<p>i try lot of solution, but every time i have log that say \" cannot use (func literal)() (type *_Ctype_uchar) as type\"uint8\" or \"byte\" ...</p>\n\n<p>Thanks guys for your help ! </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 1, "last_activity_date": 1572716889, "creation_date": 1572716889, "answer_id": 58673681, "question_id": 58673659, "link": "https://stackoverflow.com/questions/58673659/reading-yaml-config-files-in-golang-do-i-always-need-structs/58673681#58673681", "title": "Reading yaml config files in golang, do I always need structs?", "body": "<p>You can unmarshal a yaml file into an interface{}:</p>\n\n<pre><code>var data interface{}\nyaml.Unmarshal(input,&amp;data)\n</code></pre>\n\n<p>One thing to note is that the <a href=\"https://gopkg.in/yaml.v2\" rel=\"nofollow noreferrer\">https://gopkg.in/yaml.v2</a> library unmarshals to map[interface{}]interface{}, instead of a map[string]interface{}.</p>\n"}], "owner": {"reputation": 579, "user_id": 3794343, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9J3pf.png?s=128&g=1", "display_name": "ferralucho", "link": "https://stackoverflow.com/users/3794343/ferralucho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 58673681, "answer_count": 1, "score": 0, "last_activity_date": 1572734337, "creation_date": 1572716732, "last_edit_date": 1572734337, "question_id": 58673659, "link": "https://stackoverflow.com/questions/58673659/reading-yaml-config-files-in-golang-do-i-always-need-structs", "title": "Reading yaml config files in golang, do I always need structs?", "body": "<p>I would like to read configuration constants from a yaml in Golang. </p>\n\n<p>Example:\nI have config.yml</p>\n\n<pre><code>server:\n  host: \"localhost\"\n  port: 8080\n</code></pre>\n\n<p>And a config struct</p>\n\n<pre><code>type Config struct {\n    Server struct {\n        Port string `yaml:\"port\"`\n        Host string `yaml:\"host\"`\n    } `yaml:\"server\"`\n}\n</code></pre>\n\n<p>Then I could read it like this:</p>\n\n<pre><code>f, err := os.Open(\"config.yml\")\nif err != nil {\n    processError(err)\n}\n\nvar cfg Config\ndecoder := yaml.NewDecoder(f)\nerr = decoder.Decode(&amp;cfg)\nif err != nil {\n    processError(err)\n}\n</code></pre>\n\n<p>I'm using gopkg.in/yaml.v2</p>\n\n<p>I want to parse it and then read the constants, do I need to have a struct with the configuration \nstructure ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go", "constants"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1572727540, "post_id": 58673656, "comment_id": 103651537, "body": "You can&#39;t do that in Go, it is simply not possible to reference an identifier by using strings. That means that you have to options, either use the identifier as you&#39;ve declared it, or don&#39;t use it at all, use something else instead. Probably the most simple solution to what you need is to do a conditional, <code>if</code> or <code>switch</code> on the <code>env</code> value and then set the <code>envUrl</code> by referencing the full identifier."}], "answers": [{"tags": [], "owner": {"reputation": 2211, "user_id": 788833, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/WJfHU.png?s=128&g=1", "display_name": "dmigo", "link": "https://stackoverflow.com/users/788833/dmigo"}, "is_accepted": true, "score": 1, "last_activity_date": 1572717260, "creation_date": 1572717260, "answer_id": 58673734, "question_id": 58673656, "link": "https://stackoverflow.com/questions/58673656/how-to-access-a-member-of-const-enum-indirectly-through-a-variable/58673734#58673734", "title": "How to access a member of const enum indirectly through a variable?", "body": "<p>To me it seems that your use-case asks for a <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">map</a>. With a map you can write your code like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>baseurls := map[string]string{\n    \"PROD\": \"http://prod.abc.com\",\n    \"TEST\": \"http://test.abc.com\",\n}\n\nenvUrl := baseurls[env]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 0, "last_activity_date": 1572718716, "creation_date": 1572718716, "answer_id": 58673974, "question_id": 58673656, "link": "https://stackoverflow.com/questions/58673656/how-to-access-a-member-of-const-enum-indirectly-through-a-variable/58673974#58673974", "title": "How to access a member of const enum indirectly through a variable?", "body": "<p>One way you can do this is by using structs, instead of constants:</p>\n\n<pre><code>type EnvSet struct {\n   BaseURL string\n   // other env specific setting\n}\n\nvar Prod =EnvSet{BaseURL:\"...\",...}\nvar Dev = EnvSet{BaseURL:\"...\",...}\n\nvar selectedEnv EnvSet\nswitch env {\n  case \"prod\": selectedEnv=Prod\n  case \"dev\": selectedEnv=Dev\n}\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5097354, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49b28bc5188b5bb689f957e7340f7547?s=128&d=identicon&r=PG&f=1", "display_name": "Anshika Jain", "link": "https://stackoverflow.com/users/5097354/anshika-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58673734, "answer_count": 2, "score": 1, "last_activity_date": 1572773809, "creation_date": 1572716720, "last_edit_date": 1572773809, "question_id": 58673656, "link": "https://stackoverflow.com/questions/58673656/how-to-access-a-member-of-const-enum-indirectly-through-a-variable", "title": "How to access a member of const enum indirectly through a variable?", "body": "<p>I have a const enum like </p>\n\n<pre><code>const(\nPROD_BASEURL=\"http://prod.abc.com\"\nTEST_BASEURL=\"http://test.abc.com\"\n)\n</code></pre>\n\n<p>In one of my functions, I am taking environment as input and want to access the const members accordingly.</p>\n\n<pre><code>envUrl := env + \"_BASEURL\"\n</code></pre>\n\n<p>Here env is the input which can be PROD or TEST.\nNow, how can I access the const members through <code>envUrl</code> variable without directly specifying \n<code>PROD_BASEURL</code>?</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 8, "creation_date": 1572709870, "post_id": 58672667, "comment_id": 103647143, "body": "You&#39;re ignoring errors. Don&#39;t do that. The error will tell you what the problem is."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1572710372, "post_id": 58672667, "comment_id": 103647282, "body": "Also a note on terminology: The template doesn&#39;t render in the browser at all. It renders on the server, then is sent to the browser. If you want rendering in the browser, you must use client-side code, probably written in JavaScript."}, {"owner": {"reputation": 225, "user_id": 8586651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209618129469600/picture?type=large", "display_name": "Kent Martin", "link": "https://stackoverflow.com/users/8586651/kent-martin"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572720105, "post_id": 58672667, "comment_id": 103649925, "body": "Thank you for your answer. When you say I ignore errors, are you referring to <b>html/template.Template.Must</b>?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1572750896, "post_id": 58672667, "comment_id": 103655114, "body": "@KentMartin The error returned from <code>tmpl.Execute(w, data)</code> is ignored."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1572710282, "post_id": 58672737, "comment_id": 103647256, "body": "There&#39;s also a good chance it cannot find the template--the local directory during compilation has nothing to do with the local directory during execution."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572710408, "post_id": 58672737, "comment_id": 103647294, "body": "Good catch, @Flimzy. The way <code>net&#47;http</code> is written, makes all panics in HTTP handlers be caught and logged; so they should appear on the program&#39;s standard error stream. Since the panics are caught and logged, the program does not blow up even if <code>template.Must</code> supposedly does."}, {"owner": {"reputation": 225, "user_id": 8586651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209618129469600/picture?type=large", "display_name": "Kent Martin", "link": "https://stackoverflow.com/users/8586651/kent-martin"}, "edited": false, "score": 0, "creation_date": 1572721000, "post_id": 58672737, "comment_id": 103650141, "body": "Thank you both for the input. I have capitalized the fields in <i>pageData</i> but I still can&#39;t see anything in the browser. I&#39;m new to <b>Go</b> and don&#39;t really know what I&#39;m doing, but I get that I should look into error-handling next."}, {"owner": {"reputation": 225, "user_id": 8586651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209618129469600/picture?type=large", "display_name": "Kent Martin", "link": "https://stackoverflow.com/users/8586651/kent-martin"}, "edited": false, "score": 0, "creation_date": 1572726082, "post_id": 58672737, "comment_id": 103651235, "body": "After inspecting the error returned by <b>tmpl.Execute()</b> I found that I had forgotten to close the <code>&lt;title&gt;</code>-tag in <i>base.html</i>. Now everything works as expected. Again, thanks for the help."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 4, "last_activity_date": 1572712303, "last_edit_date": 1572712303, "creation_date": 1572710163, "answer_id": 58672737, "question_id": 58672667, "link": "https://stackoverflow.com/questions/58672667/why-doesnt-my-template-get-rendered-in-the-browser/58672737#58672737", "title": "Why doesn&#39;t my template get rendered in the browser?", "body": "<p>The fields of pageData are not exported, so the template engine cannot access them. Capitalize the field names and the references to those in the template. Also, do not ignore the template execution errors.</p>\n"}], "owner": {"reputation": 225, "user_id": 8586651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209618129469600/picture?type=large", "display_name": "Kent Martin", "link": "https://stackoverflow.com/users/8586651/kent-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58672737, "answer_count": 1, "score": -2, "last_activity_date": 1572804597, "creation_date": 1572709741, "last_edit_date": 1572804597, "question_id": 58672667, "link": "https://stackoverflow.com/questions/58672667/why-doesnt-my-template-get-rendered-in-the-browser", "title": "Why doesn&#39;t my template get rendered in the browser?", "body": "<p>I want to render a template to the browser. However, nothing shows up. \nHere's the code I'm running, <strong>main.go</strong>:</p>\n\n<pre><code>    package main\n\n    import (\n        \"html/template\"\n        \"net/http\"\n        \"log\"\n    )\n\n\n    func main() {\n        mux := http.NewServeMux()\n        mux.HandleFunc(\"/\", home)\n        log.Fatal(http.ListenAndServe(\"0.0.0.0:8000\", mux))\n    }\n\n\n    func home(w http.ResponseWriter, r *http.Request) {\n        data := pageData{\"MyTabTitle\", \"MyPageName\"}\n\n        tmpl := template.Must(template.ParseFiles(\"base.html\"))\n        tmpl.Execute(w, data)\n    }\n\n\n    type pageData struct {\n        tabTitle, pageName string\n    }\n\n</code></pre>\n\n<p>In the same directory I also have the <strong>base.html</strong>-file</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>    &lt;!doctype html&gt;\n    &lt;html&gt;\n        &lt;head&gt;\n            &lt;title&gt; {{ .tabTitle }}\n        &lt;/head&gt;\n        &lt;body&gt;\n            &lt;header&gt;\n                &lt;h1&gt; {{ .pageName }} &lt;/h1&gt;\n            &lt;/header&gt;\n        &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>\n"}, {"tags": ["go", "microservices", "trace", "opentracing", "distributed-tracing"], "answers": [{"tags": [], "owner": {"reputation": 6867, "user_id": 5459201, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1vP26jxAeV8/AAAAAAAAAAI/AAAAAAAAADQ/IA9dEBqNa5s/photo.jpg?sz=128", "display_name": "Shashank V", "link": "https://stackoverflow.com/users/5459201/shashank-v"}, "is_accepted": false, "score": 1, "last_activity_date": 1578771016, "creation_date": 1578771016, "answer_id": 59697933, "question_id": 58672447, "link": "https://stackoverflow.com/questions/58672447/distributed-tracing-with-golang-http-postform/59697933#59697933", "title": "Distributed tracing with golang http.PostForm", "body": "<p>I don't think it can be done from <code>PostForm</code>. You would need to use <code>http.NewRequest</code> to create the POST request, <code>Inject</code> the span in headers and use <code>Client.Do</code> to send the request. </p>\n"}], "owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578771016, "creation_date": 1572708155, "question_id": 58672447, "link": "https://stackoverflow.com/questions/58672447/distributed-tracing-with-golang-http-postform", "title": "Distributed tracing with golang http.PostForm", "body": "<p>In my project, I try to implement distributed tracing using <code>opentracing</code>.</p>\n\n<p>My microservice has following structure.</p>\n\n<pre><code>-- API-Gateway\n       |_ User-Service\n       |_ Notification \n</code></pre>\n\n<p>In my API-gateway, I start and in API gateway, I use a to a function to start tracing, code is taken from <a href=\"https://opentracing.io/guides/golang/quick-start/\" rel=\"nofollow noreferrer\">Setting up your tracer</a></p>\n\n<p>in <code>main()</code>:</p>\n\n<pre><code>gatewayTracer := &amp;apiTracer{tracer: startTracing(\"API Gateway\")}\n\nhttp.HandleFunc(\"/getemail\", gatewayTracer.validatemail)\n\nfunc (apitracer apiTracer) validatemail(res http.ResponseWriter, req *http.Request) {\n\n    validateEmailSpan := apitracer.tracer.StartSpan(\"Validate Email\")\n}\n</code></pre>\n\n<p>I call to my User-service from <code>validateemail()</code> using <code>http.PostForm()</code>. </p>\n\n<p><code>_, err := http.PostForm(\"http://user:7071/checkemail\", url.Values{\"uuid\": {uuid}, \"email\": {email}})</code></p>\n\n<p>Here <code>uuid</code> is for separate task, not for tracing.\nI can not post this <code>Span</code> to the next service using <code>PostForm()</code>.</p>\n\n<p>How to overcome this issue? </p>\n"}, {"tags": ["sql", "postgresql", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1572706566, "post_id": 58672223, "comment_id": 103646227, "body": "<code>fmt.Println(err.Error())</code> can be shortened to <code>fmt.Println(err)</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572706596, "post_id": 58672223, "comment_id": 103646239, "body": "What is the data type of the <code>prefix</code> column?"}, {"owner": {"reputation": 63, "user_id": 10438002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xCCxVWe_k9Q/AAAAAAAAAAI/AAAAAAAAAAs/ETM4SsXbSLw/photo.jpg?sz=128", "display_name": "Dylee", "link": "https://stackoverflow.com/users/10438002/dylee"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1572708247, "post_id": 58672223, "comment_id": 103646683, "body": "@Flimzy Data type of <code>prefix</code> column is text"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1572709156, "post_id": 58672223, "comment_id": 103646949, "body": "@Dylee If you&#39;re certain you&#39;re connected to the same db, what happens if you prefix your table, in both Go and psql, with a schema name, for example <code>public.servers</code> or wherever the table is defined, do you still get the same result? And is the prefix column nullable, if so what is the output of <code>\\pset null</code>?"}, {"owner": {"reputation": 63, "user_id": 10438002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xCCxVWe_k9Q/AAAAAAAAAAI/AAAAAAAAAAs/ETM4SsXbSLw/photo.jpg?sz=128", "display_name": "Dylee", "link": "https://stackoverflow.com/users/10438002/dylee"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572715419, "post_id": 58672223, "comment_id": 103648735, "body": "@mkopriva I followed what you said and tried this <code>SELECT servers.prefix FROM public.servers WHERE serverid = 1234;</code> And it still didn&#39;t work, output of <code>\\pset null</code> is  <code>Null display is &quot;&quot;.</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572715809, "post_id": 58672223, "comment_id": 103648830, "body": "And you&#39;re using <code>lib&#47;pq</code> as the dirver?"}, {"owner": {"reputation": 63, "user_id": 10438002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xCCxVWe_k9Q/AAAAAAAAAAI/AAAAAAAAAAs/ETM4SsXbSLw/photo.jpg?sz=128", "display_name": "Dylee", "link": "https://stackoverflow.com/users/10438002/dylee"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572716378, "post_id": 58672223, "comment_id": 103648967, "body": "@mkopriva Yes, these are my imports <code>import ( \t&quot;database&#47;sql&quot; \t&quot;fmt&quot;  \t&quot;github.com&#47;davecgh&#47;go-spew&#47;spew&quot; \t_ &quot;github.com&#47;lib&#47;pq&quot; )</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572716503, "post_id": 58672223, "comment_id": 103648997, "body": "@Dylee I&#39;ve tried your example code just now and I can&#39;t recreate the issue, everything works as it should. The problem must be somewhere in your setup / environment or in the way in which you execute your program... which makes it close to impossible to tell what&#39;s wrong from just the content of the question, since that all looks alright. <a href=\"https://imgur.com/a/bo0dI95\" rel=\"nofollow noreferrer\">imgur.com/a/bo0dI95</a>"}, {"owner": {"reputation": 63, "user_id": 10438002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xCCxVWe_k9Q/AAAAAAAAAAI/AAAAAAAAAAs/ETM4SsXbSLw/photo.jpg?sz=128", "display_name": "Dylee", "link": "https://stackoverflow.com/users/10438002/dylee"}, "edited": false, "score": 0, "creation_date": 1572717186, "post_id": 58672223, "comment_id": 103649171, "body": "Okay, let me give more info My main folder/workspace has only 1 folder and 1 file which are  <code>utils&#47;utils.go</code><a href=\"https://pastiebin.com/5dbdc1318a4c1\" rel=\"nofollow noreferrer\">Here</a>  and  <code>main.go</code><a href=\"https://pastiebin.com/5dbdc16c8942a\" rel=\"nofollow noreferrer\">Here</a>  Finally, I am running my code with <code>go run main.go</code> from the main folder"}, {"owner": {"reputation": 63, "user_id": 10438002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xCCxVWe_k9Q/AAAAAAAAAAI/AAAAAAAAAAs/ETM4SsXbSLw/photo.jpg?sz=128", "display_name": "Dylee", "link": "https://stackoverflow.com/users/10438002/dylee"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572717398, "post_id": 58672223, "comment_id": 103649228, "body": "Also @mkopriva in my table, <code>serverid</code> is of type <code>bigint</code> and not <code>int</code>, just to point out because in your screenshot, it&#39;s of type <code>int</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1572717443, "post_id": 58672223, "comment_id": 103649239, "body": "The id you pass in go does not match the id you got back from psql. <code>118456055842734083</code> is not <code>1234</code>."}, {"owner": {"reputation": 63, "user_id": 10438002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xCCxVWe_k9Q/AAAAAAAAAAI/AAAAAAAAAAs/ETM4SsXbSLw/photo.jpg?sz=128", "display_name": "Dylee", "link": "https://stackoverflow.com/users/10438002/dylee"}, "edited": false, "score": 0, "creation_date": 1572718301, "post_id": 58672223, "comment_id": 103649469, "body": "sorry I just recently added that, it still doesn&#39;t work"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1572718360, "post_id": 58672223, "comment_id": 103649482, "body": "@Dylee note also that the first version of the go code on pastebin that you&#39;ve linked had <code>118456055842734083</code> as an <code>int</code> argument, however that number don&#39;t fit into an <code>int</code>. Please make sure your code is in order, compiles, and executes. You could also try <a href=\"https://stackoverflow.com/questions/722221/how-to-log-postgresql-queries\">turning on logs for your queries</a> and compare the logs against what you think should be executed."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1572718532, "post_id": 58672223, "comment_id": 103649534, "body": "@Dylee also please never ever, when you receive back a non-nil error, continue as if nothing happend. Your code should exit if it encounters an error, but instead your code continues right where it left off after printing an error."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 10438002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xCCxVWe_k9Q/AAAAAAAAAAI/AAAAAAAAAAs/ETM4SsXbSLw/photo.jpg?sz=128", "display_name": "Dylee", "link": "https://stackoverflow.com/users/10438002/dylee"}, "is_accepted": true, "score": 0, "last_activity_date": 1572720303, "creation_date": 1572720303, "answer_id": 58674195, "question_id": 58672223, "link": "https://stackoverflow.com/questions/58672223/why-is-queryrow-scan-returning-an-empty-string-when-it-is-not-empty-in-table/58674195#58674195", "title": "Why is QueryRow().Scan() returning an empty string when it is not empty in table?", "body": "<p>Apparently it was not working because SSL mode was disabled on my server but I was trying to connect without specifying it was disabled.</p>\n\n<p>Changing <code>postgres://postgres:7890@localhost:5432/mewbot</code> to <code>postgres://postgres:7890@localhost:5432/mewbot?sslmode=disable</code> solved my issue.</p>\n"}], "owner": {"reputation": 63, "user_id": 10438002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xCCxVWe_k9Q/AAAAAAAAAAI/AAAAAAAAAAs/ETM4SsXbSLw/photo.jpg?sz=128", "display_name": "Dylee", "link": "https://stackoverflow.com/users/10438002/dylee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58674195, "answer_count": 1, "score": -1, "last_activity_date": 1572720303, "creation_date": 1572706462, "last_edit_date": 1572706529, "question_id": 58672223, "link": "https://stackoverflow.com/questions/58672223/why-is-queryrow-scan-returning-an-empty-string-when-it-is-not-empty-in-table", "title": "Why is QueryRow().Scan() returning an empty string when it is not empty in table?", "body": "<p>I am trying to Query a single row from a PostgreSQL database table.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func getPrefix(serverID int64, db *sql.DB) string {\n    var prefix string\n    err := db.QueryRow(\"SELECT prefix FROM servers WHERE serverid = 1234\").Scan(&amp;prefix)\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    spew.Dump(prefix)\n    fmt.Println(\"Prefix is \" + prefix)\n    return prefix\n}\n</code></pre>\n\n<p>Apparently, the variable <code>prefix</code> is an empty String, but when I query it in the database, it's not empty</p>\n\n<pre><code>You are now connected to database \"mewbot\" as user \"postgres\".\nmewbot=# select * from servers;\n serverid | prefix\n----------+--------\n     1234 | ;\n(1 row)\n\n\nmewbot=#\n</code></pre>\n\n<p>My question is, why is it returning an Empty String when it should be <code>;</code>\nAll checks taken; I've made sure I'm connected to the same database et al</p>\n"}]