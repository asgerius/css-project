[{"tags": ["go", "oauth-2.0", "twitter-oauth"], "answers": [{"tags": [], "owner": {"reputation": 262, "user_id": 5528070, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-IYABogD9sxI/AAAAAAAAAAI/AAAAAAAACNE/ZIt8C6XSB3U/photo.jpg?sz=128", "display_name": "Christopher", "link": "https://stackoverflow.com/users/5528070/christopher"}, "is_accepted": false, "score": 8, "last_activity_date": 1452731991, "creation_date": 1452731991, "answer_id": 34779732, "question_id": 34779108, "link": "https://stackoverflow.com/questions/34779108/cant-get-oauth2-twitter-to-work-returns-invalid-token/34779732#34779732", "title": "Can&#39;t get Oauth2 (Twitter) to work - returns invalid token", "body": "<p>So turned out I wasn't leveraging the client credentials oauth2 package. I was able to get it to work.</p>\n\n<p>Hope this helps someone in the future:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"io/ioutil\"\nimport \"golang.org/x/oauth2\"\nimport \"golang.org/x/oauth2/clientcredentials\"\n\nfunc main() {\n    config := &amp;clientcredentials.Config{\n        ClientID:     \"{App Key}\",\n        ClientSecret: \"{App Secret}\",\n        TokenURL:     \"https://api.twitter.com/oauth2/token\",\n    }\n    tok, err := config.Token(oauth2.NoContext)\n    httpClient := config.Client(oauth2.NoContext)\n    resp, err := httpClient.Get(\"https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=google\")\n    if (err != nil) {\n        fmt.Printf(\"Error: %s\", err)\n    }\n    defer resp.Body.Close();\n    body, err :=  ioutil.ReadAll(resp.Body);\n    if (err != nil) {\n        fmt.Printf(\"Error: %s\", err)\n    }\n    fmt.Printf(\"Access Token: %s\\nToken: %s\\nResponse: %s\\n\", tok, body)\n}\n</code></pre>\n"}], "owner": {"reputation": 262, "user_id": 5528070, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-IYABogD9sxI/AAAAAAAAAAI/AAAAAAAACNE/ZIt8C6XSB3U/photo.jpg?sz=128", "display_name": "Christopher", "link": "https://stackoverflow.com/users/5528070/christopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1452731991, "creation_date": 1452728102, "question_id": 34779108, "link": "https://stackoverflow.com/questions/34779108/cant-get-oauth2-twitter-to-work-returns-invalid-token", "title": "Can&#39;t get Oauth2 (Twitter) to work - returns invalid token", "body": "<p>So I'm a bit of a newbie to Go, so excuse my ignorance. I'm trying to do a simple REST API call to twitter using oauth2 for an \"application only\" calls, but I keep getting \"Invalid or expired token\" back as an error. </p>\n\n<p>Anyone have experience with setting something like this up?</p>\n\n<p>Response is: {\"errors\":[{\"code\":89,\"message\":\"Invalid or expired token.\"}]}</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/base64\"\nimport \"io/ioutil\"\nimport \"time\"\nimport \"golang.org/x/oauth2\"\n\nfunc main() {\n    config := &amp;oauth2.Config{\n        Endpoint: oauth2.Endpoint{\n            AuthURL: \"https://api.twitter.com/oauth2/token\",\n            TokenURL: \"https://api.twitter.com/oauth/request_token\",\n        },\n    }\n    accessToken := base64.StdEncoding.EncodeToString([]byte(\"{Consumer Key (API Key)}:{Consumer Secret (API Secret)}\"));\n    token := &amp;oauth2.Token{\n        AccessToken: accessToken, \n        Expiry: time.Now().Add(time.Duration(24)*time.Hour)\n    }\n    httpClient := config.Client(oauth2.NoContext, token)\n    resp, err := httpClient.Get(\"https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=google\")\n    if (err != nil) {\n        fmt.Printf(\"Error: %s\", err)\n    }\n    defer resp.Body.Close();\n    body, err :=  ioutil.ReadAll(resp.Body);\n    if (err != nil) {\n        fmt.Printf(\"Error: %s\", err)\n    }\n    fmt.Printf(\"Access Token: %s\\nToken: %s\\nResponse: %s\\n\", accessToken, token, body)\n}\n</code></pre>\n"}, {"tags": ["eclipse", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452715896, "post_id": 34775953, "comment_id": 57297439, "body": "Never set GOROOT (unless you&#39;re certain you need it -- you don&#39;t here). You will need a GOPATH."}, {"owner": {"reputation": 1292, "user_id": 3611981, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1fbc8b3294b1d9c9f42c69002ffbe6b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarshallLee", "link": "https://stackoverflow.com/users/3611981/marshalllee"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452715943, "post_id": 34775953, "comment_id": 57297464, "body": "@JimB Then should I change that <code>GOROOT</code> to <code>GOPATH</code> in the <code>bach_profile</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452716051, "post_id": 34775953, "comment_id": 57297525, "body": "No, your GOPATH should never be in GOROOT. Start here: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>"}, {"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1452759835, "post_id": 34775953, "comment_id": 57313328, "body": "My setup is GOROOT to /usr/local/go and GOPATH /Users/myname/go. I am using IntelliJ Idea. I am not really running any go from IDE but from iTerm. I find IDE using useful only because of autocomplete and references to some go lib (CMD+click). My projects are located at my $GOPATH/src. I am not sure that this will help you, maybe you will figure out from this."}], "answers": [{"comments": [{"owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "edited": false, "score": 3, "creation_date": 1463657447, "post_id": 35857783, "comment_id": 62163125, "body": "I am using GoClipse on Windows 10. My golang is installed in &quot;F:\\Go&quot; and I created a Go Project named as &quot;HelloWorld&quot; in &quot;E:\\Users\\User\\Desktop\\workspace\\HelloWorld&quot;, so I set GOROOT to &quot;F:\\Go&quot; and GOPATH to &quot;E:\\Users\\User\\Desktop\\workspace\\HelloWorld&quot;. However, I got &quot;Resource doesn&#39;t have a corresponding Go package\u201d when I run the file. How can I solve it?"}], "tags": [], "owner": {"reputation": 1, "user_id": 6032096, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/dbe488784b39f1fd7a8056c5308886f8?s=128&d=identicon&r=PG", "display_name": "Sovannrith Lay", "link": "https://stackoverflow.com/users/6032096/sovannrith-lay"}, "is_accepted": false, "score": 0, "last_activity_date": 1457403834, "creation_date": 1457403834, "answer_id": 35857783, "question_id": 34775953, "link": "https://stackoverflow.com/questions/34775953/golang-on-eclipse-resource-doesnt-have-a-corresponding-go-package-on-mac/35857783#35857783", "title": "Golang on eclipse: &quot;Resource doesn&#39;t have a corresponding Go package&quot; on Mac", "body": "<p>Because the executable path is not right.<br/>\nGoClipse compiles source into $project/bin, so we must set GOPATH = $project</p>\n\n<p>Select project > Alt+Enter > Go Compiler > Use project specific settings > Eclipse GOPATH</p>\n\n<p>In my case of wiki tutorial, <code>GOPATH = :/home/sovann/go/wiki</code>.<br/>\nThen the IDE is able to locate /home/sovann/go/wiki/bin/main</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6407175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e42deb7e422a56b74721c8b6ee3f5a?s=128&d=identicon&r=PG&f=1", "display_name": "Venugopal V", "link": "https://stackoverflow.com/users/6407175/venugopal-v"}, "is_accepted": false, "score": 5, "last_activity_date": 1464745121, "creation_date": 1464745121, "answer_id": 37558136, "question_id": 34775953, "link": "https://stackoverflow.com/questions/34775953/golang-on-eclipse-resource-doesnt-have-a-corresponding-go-package-on-mac/37558136#37558136", "title": "Golang on eclipse: &quot;Resource doesn&#39;t have a corresponding Go package&quot; on Mac", "body": "<p>Go to 'Run Configurations' -> Filter with Go Application -> select your project and then click the Environment tab, then click on select button and tick the GOPATH environment. select apply and then Run.  </p>\n"}, {"comments": [{"owner": {"reputation": 443, "user_id": 5948237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338252eadaab6846d185b8927a05e621?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek Chavda", "link": "https://stackoverflow.com/users/5948237/vivek-chavda"}, "edited": false, "score": 0, "creation_date": 1504713111, "post_id": 44353667, "comment_id": 79120472, "body": "Thanks, this was my issue"}], "tags": [], "owner": {"reputation": 121, "user_id": 6097178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EIKOKNkVq0A/AAAAAAAAAAI/AAAAAAAAC_0/qjxo4B1E0GU/photo.jpg?sz=128", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/6097178/ahmad-bilal"}, "is_accepted": false, "score": 12, "last_activity_date": 1496577651, "last_edit_date": 1496577651, "creation_date": 1496576434, "answer_id": 44353667, "question_id": 34775953, "link": "https://stackoverflow.com/questions/34775953/golang-on-eclipse-resource-doesnt-have-a-corresponding-go-package-on-mac/44353667#44353667", "title": "Golang on eclipse: &quot;Resource doesn&#39;t have a corresponding Go package&quot; on Mac", "body": "<p>I had the same error. Putting the source file under a sub-folder in src fixed it.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 6365873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQQ6U.jpg?s=128&g=1", "display_name": "Rub&#233;n M.", "link": "https://stackoverflow.com/users/6365873/rub%c3%a9n-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1513250835, "creation_date": 1513250835, "answer_id": 47812228, "question_id": 34775953, "link": "https://stackoverflow.com/questions/34775953/golang-on-eclipse-resource-doesnt-have-a-corresponding-go-package-on-mac/47812228#47812228", "title": "Golang on eclipse: &quot;Resource doesn&#39;t have a corresponding Go package&quot; on Mac", "body": "<p>I had the same problem and I did two things to solve it:</p>\n\n<ol>\n<li>I opened Run configurations, filtered using \"Go\" and created a new configuration (right click on \"Go Application\" as a result of the filter). In the Environment tab added a new variable: GOPATH = [path to your workspace]. </li>\n<li>I had .go files right under src folder, and this is wrong. I created a folder under src folder and moved .go files to that folder.</li>\n</ol>\n\n<p>The first step could be replaced by creating a system environment and adding it to the list using the \"Select\" option instead of creating a new one. I prefered to create a new one so I can run differente projects in the same laptop without having to change the value of the system environment.</p>\n"}], "owner": {"reputation": 1292, "user_id": 3611981, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1fbc8b3294b1d9c9f42c69002ffbe6b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarshallLee", "link": "https://stackoverflow.com/users/3611981/marshalllee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12324, "favorite_count": 0, "answer_count": 4, "score": 5, "last_activity_date": 1582436299, "creation_date": 1452715287, "last_edit_date": 1452715600, "question_id": 34775953, "link": "https://stackoverflow.com/questions/34775953/golang-on-eclipse-resource-doesnt-have-a-corresponding-go-package-on-mac", "title": "Golang on eclipse: &quot;Resource doesn&#39;t have a corresponding Go package&quot; on Mac", "body": "<p>As stated in the title, I have a problem running the Golang code on Eclipse. I'm currently using Mac, and I installed go by using homebrew.</p>\n\n<p>Currently, the folder where go is installed is as follows.</p>\n\n<p><code>/usr/local/Cellar/go/1.5.2/..</code></p>\n\n<p>and after running Terminal and typing <code>open ~/.bash_profile</code> I added the following.</p>\n\n<pre><code>export GOROOT=\"/usr/local/Cellar/go/1.5.2/\"\nexport PATH=$PATH:$GOROOT/bin\n</code></pre>\n\n<p>Am I still missing something else?</p>\n\n<p><strong>PS</strong> If I run the code using Terminal like <code>go run main.go</code>, I have absolutely no problem. The problem must be due to some misconfiguration in Eclipse.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1452714776, "post_id": 34775722, "comment_id": 57296803, "body": "you can use vendored imports. By designing <code>go get</code> to pull from HEAD, it allows easier pulls of bugfixes and forces API developers to be more mindful of backwards-incompatible changes. That said, this is clearly an opinion-based question, which isn&#39;t on-topic for StackOverflow."}, {"owner": {"reputation": 2669, "user_id": 1970990, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/2ociD.jpg?s=128&g=1", "display_name": "raulk", "link": "https://stackoverflow.com/users/1970990/raulk"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1452715030, "post_id": 34775722, "comment_id": 57296957, "body": "I see. I&#39;ve changed the wording to avoid opinion-based answers. If you could elaborate on vendor imports \u2013 or other tactics to deploy Go in the enterprise without having to deal with constant upstream changes, I&#39;d appreciate it."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1452716395, "last_edit_date": 1452716395, "creation_date": 1452715265, "answer_id": 34775947, "question_id": 34775722, "link": "https://stackoverflow.com/questions/34775722/package-version-management-in-go-1-5/34775947#34775947", "title": "Package version management in Go 1.5", "body": "<p>It is being addressed by <a href=\"https://golang.org/s/go15vendor\" rel=\"noreferrer\">vendoring</a> which is part of Go 1.5 as an experimental feature, it can be enabled if the go command is run with <code>GO15VENDOREXPERIMENT=1</code> in its environment, and will be a \"full\" feature in Go 1.6. Also see <a href=\"https://golang.org/cmd/go/#hdr-Vendor_Directories\" rel=\"noreferrer\">Vendor Directories</a>.</p>\n\n<p>The original discussion that led to the Go 1.5 Vedor Experiment can be found <a href=\"https://groups.google.com/forum/#!msg/golang-dev/74zjMON9glU/4lWCRDCRZg0J\" rel=\"noreferrer\">here</a>.</p>\n\n<p>The essence of vendoring is that you create a folder named <code>vendor</code>, and you put the exact version of the packages that your code relies on. Code inside the <code>vendor</code> folder is only importable by the code in the directory tree rooted at the parent of <code>vendor</code>, and you can import packages from <code>vendor</code> with an import path as if <code>vendor</code> would be the <code>workspace/src</code> folder (that is, with an import path that omits the prefix up to and including the vendor element).</p>\n\n<p>Example:</p>\n\n<pre><code>/home/user/goworkspace/\n    src/\n        mymath/\n            mymath.go\n            vendor/\n                github.com/somebob/math\n                    math.go\n</code></pre>\n\n<p>In this example <code>github.com/somebob/math</code> is an external package used by <code>mymath</code> package (from <code>mymath.go</code>). It can be used from <code>mymath.go</code> if it is imported like:</p>\n\n<pre><code>import \"github.com/somebob/math\"\n</code></pre>\n\n<p>(And not as <code>import mymath/vendor/github.com/somebob/math</code> which would be bad.)</p>\n"}, {"comments": [{"owner": {"reputation": 2669, "user_id": 1970990, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/2ociD.jpg?s=128&g=1", "display_name": "raulk", "link": "https://stackoverflow.com/users/1970990/raulk"}, "edited": false, "score": 0, "creation_date": 1452763180, "post_id": 34783724, "comment_id": 57315330, "body": "My point was that Java didn&#39;t even make an attempt to solve 3rd party package sourcing within the standard toolkit. Java left a void that was filled by Maven + other Maven repository based tools, and Maven has gone on to become the de-facto tool for this. Conversely, Go did address 3rd party package sourcing within its toolset, so it looked like an omission not to think earlier about version or vendor management. Finally, when I mentioned transitive dependencies, I meant Maven&#39;s semantics for version addressing and conflict reporting at build time."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 2669, "user_id": 1970990, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/2ociD.jpg?s=128&g=1", "display_name": "raulk", "link": "https://stackoverflow.com/users/1970990/raulk"}, "edited": false, "score": 0, "creation_date": 1452763842, "post_id": 34783724, "comment_id": 57315780, "body": "Sorry, but this wasn&#39;t very clear from your question. I can only guess that go toolchain lacks version support because it was never a problem for its authors (and many other people ;). As far as I know Maven doesn&#39;t report any version conflicts. It tries its best to resolve versions of transitive dependencies, though often you will have to explicitly specify them anyway."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 1, "last_activity_date": 1452755955, "creation_date": 1452755955, "answer_id": 34783724, "question_id": 34775722, "link": "https://stackoverflow.com/questions/34775722/package-version-management-in-go-1-5/34783724#34783724", "title": "Package version management in Go 1.5", "body": "<p>While Go doesn't come with the standard package manager there are enough options to make builds reproducible (even in an enterprise with limited manpower).</p>\n\n<ol>\n<li><p>Vendoring, which is described in another answer by @icza. This is almost complete equivalent of checking in versioned jar files in Java. This was very common approach with ant build tool before maven became popular. Actually vendoring is much better because you cannot lose source code.</p></li>\n<li><p>This is slight variation of the first option. Instead of checking in vendored source code you can populate vendor folder during build by checking out predefined versions of the dependencies. There tools (e.g. glide) that automate this process.</p></li>\n<li><p>Finally you can maintain predefined versions of all 3-rd party libraries in the internal repository and add it to GOPATH. This approach is described in detail in <a href=\"https://blog.gopheracademy.com/advent-2015/go-in-a-monorepo/\" rel=\"nofollow\">https://blog.gopheracademy.com/advent-2015/go-in-a-monorepo/</a></p></li>\n</ol>\n\n<p>Note that incompatible transitive dependencies are not specific to Go. They exist in Java (and most other languages) too, though Java has a mechanism to partially solve this problem by making programs more complex - class loaders. Note that Go will report all incompatibilities at compile time while in Java some of the incompatibilities are triggered only at run time (because of late linking).</p>\n\n<p>Java toolchain doesn't have concept of versions. It is provided by the external tool - maven. I believe by the time Go becomes more mature and popular a similar standard dependency management tool will emerge.</p>\n"}], "owner": {"reputation": 2669, "user_id": 1970990, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/2ociD.jpg?s=128&g=1", "display_name": "raulk", "link": "https://stackoverflow.com/users/1970990/raulk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 2, "accepted_answer_id": 34775947, "answer_count": 2, "score": 5, "last_activity_date": 1452755955, "creation_date": 1452714457, "last_edit_date": 1452715373, "question_id": 34775722, "link": "https://stackoverflow.com/questions/34775722/package-version-management-in-go-1-5", "title": "Package version management in Go 1.5", "body": "<p>I'm getting my hands dirty with Go, and while I understand and appreciate the principle of <em>simplicity</em> that Go was built upon, I'd like to grasp the rationale behind forgoing a <strong>built-in package versioning method</strong> in their dependency-fetching tool <code>go get</code> and the <code>import</code> statement.</p>\n\n<p>If I understand correctly, <code>go get</code> and <code>import</code> fetch the package from <code>HEAD</code> and they are unable to refer to a branch or a tag. While there are tools like <a href=\"http://labix.org/gopkg.in\" rel=\"noreferrer\">gopkg.in</a> that circumvent this limitation, the official toolchain:</p>\n\n<ol>\n<li>Forces developers to create separate repos for major (breaking) versions of their products.</li>\n<li>It doesn't allow consumers to downgrade between minor or micro versions in case bugs are found in newer ones.</li>\n</ol>\n\n<p>Truth be told, things are not so easy because package versioning would require a strategy to deal with conflicting transitive dependencies, e.g. <code>X</code> depends on <code>A</code> and <code>B</code>, each of which depend on different versions of <code>C</code>.</p>\n\n<p>Coming from a Java background, it does appear that this limitation poses some risks and problems, amongst others:</p>\n\n<ol>\n<li><p>Product/package evolution and breakage of public APIs of 3rd party deps is unavoidable, therefore versioning must be a first-class citizen in the toolchain IMHO.</p></li>\n<li><p>The <em>Git-repo-per-version</em> policy is highly inefficient: </p>\n\n<ul>\n<li>The overall Git history of the package is lost or scattered across repos (merges between versions, backports, etc.) </li>\n<li>Conflicts with transitive dependencies may still occur, and will go about undetected because the language nor the toolchain impose any semantics to allow detection in the first place.</li>\n</ul></li>\n<li><p>Enterprise adoption may be hindered and development teams may shy away from the language, given that:</p>\n\n<ul>\n<li>Always dragging in <code>HEAD</code> means that they can't control or freeze their 3rd party deps, leading to a potentially unpredictable end product.</li>\n<li>May lack the manpower to keep their product constantly updated and tested with upstream's <code>HEAD</code> (not every company in the world is Google :)).</li>\n</ul></li>\n</ol>\n\n<p>While I do understand that the latter risk can be \u2013 and must be \u2013 mitigated with Continuous Integration, it does not solve the underlying root of the problem.</p>\n\n<p>What information am I missing? How do you deal with package upstream changes when deploying Go in an enterprise with limited manpower?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1452711165, "post_id": 34774615, "comment_id": 57294609, "body": "Examples in the stdlib: <a href=\"https://golang.org/pkg/net/url/#Parse\" rel=\"nofollow noreferrer\">url.Parse</a>, <a href=\"https://golang.org/pkg/net/http/#NewRequest\" rel=\"nofollow noreferrer\"><code>http.NewRequest</code></a>, and so on."}, {"owner": {"reputation": 324, "user_id": 3865753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d27d53ce4147ac3abfc602425c1b6e2c?s=128&d=identicon&r=PG&f=1", "display_name": "We Stan Test Coverage", "link": "https://stackoverflow.com/users/3865753/we-stan-test-coverage"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452711910, "post_id": 34774615, "comment_id": 57295048, "body": "What led to me asking this question was <a href=\"https://golang.org/doc/effective_go.html#composite_literals\" rel=\"nofollow noreferrer\">this example</a>. Instead of returning an error, the example returns a <code>nil</code> value, so you can see my confusion. These examples help clarify what a proper function should look like, in this use case, thank you."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1452714017, "post_id": 34774615, "comment_id": 57296328, "body": "@battery.cord The <a href=\"https://golang.org/doc/effective_go.html#errors\" rel=\"nofollow noreferrer\">section on errors</a> in the same document says it&#39;s good style to return an error instead of nil.  The example you linked  to comes before the section on errors.  Perhaps the author glossed over error handling because the topic is covered later."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 17, "last_activity_date": 1524843577, "last_edit_date": 1524843577, "creation_date": 1452710977, "answer_id": 34774731, "question_id": 34774615, "link": "https://stackoverflow.com/questions/34774615/should-a-constructor-function-return-an-error-or-a-null-value/34774731#34774731", "title": "Should a &quot;constructor&quot; function return an error or a null value?", "body": "<p>Return an <code>error</code>. It is not idiomatic to use a distinguished value (such as <code>nil</code>) to indicate an error.  </p>\n\n<pre><code>func NewSomething(name, color string) (*Something, error) {\n  if name == \"\" {\n    return nil, errors.New(\"bad name\")\n  }\n\n  if color == \"\" {\n    return nil, errors.New(\"bad color\")\n  }\n\n  s := Something{name, color}\n  return &amp;s, nil\n}\n</code></pre>\n\n<p>Aside: The expression <code>&amp;anyVariable == nil</code> always evaluates to <code>false</code>. Simplify the checks to <code>len(color) == 0</code> or <code>color == \"\"</code>.</p>\n"}], "owner": {"reputation": 324, "user_id": 3865753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d27d53ce4147ac3abfc602425c1b6e2c?s=128&d=identicon&r=PG&f=1", "display_name": "We Stan Test Coverage", "link": "https://stackoverflow.com/users/3865753/we-stan-test-coverage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3112, "favorite_count": 1, "accepted_answer_id": 34774731, "answer_count": 1, "score": 12, "last_activity_date": 1544262487, "creation_date": 1452710582, "last_edit_date": 1452712685, "question_id": 34774615, "link": "https://stackoverflow.com/questions/34774615/should-a-constructor-function-return-an-error-or-a-null-value", "title": "Should a &quot;constructor&quot; function return an error or a null value?", "body": "<p>Given the a constructor function such as </p>\n\n<pre><code>func NewSomething(name, color string) *Something {\n    s := Something{name, color}\n    return &amp;s\n}\n</code></pre>\n\n<p>Should this function include sanity checks, such as <code>&amp;name == nil</code>, or <code>len(name) == 0</code>? If this function should contain sanity checks, what value should be returned from the constructor? A <code>nil</code> value, or an error (<code>errors.New(...)</code>)? An example is included below. </p>\n\n<pre><code>func NewSomething(name, color string) *Something {\n    if &amp;name == nil || len(name) == 0 {\n        return nil\n    }\n\n    if &amp;color== nil || len(color) == 0 {\n        return nil\n    }\n\n    s := Something{name, color}\n    return &amp;s\n}\n</code></pre>\n"}, {"tags": ["serialization", "go"], "answers": [{"tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": false, "score": 3, "last_activity_date": 1452971089, "last_edit_date": 1452971089, "creation_date": 1452832358, "answer_id": 34804457, "question_id": 34773908, "link": "https://stackoverflow.com/questions/34773908/serializing-models-in-golang/34804457#34804457", "title": "Serializing Models in Golang", "body": "<p>It looks like you are actually trying to translate between your internal structs and json. We can start by taking advantage of the json library.</p>\n\n<p>If you want certain libraries to handle your struct fields in certain ways, there are tags. This example shows how json tags tell json to never marshal the field <code>age</code> into json, and to only add the field <code>jobTitle</code> if it is not empty, and that the field <code>jobTitle</code> is actually called <code>title</code> in json. This renaming feature is very useful when structs in go contain capitalized (exported) fields, but the json api you're connecting to uses lowercase keys. </p>\n\n<pre><code>type A struct {\n  Name     string\n  Age      int `json:\"-\"`// do not marshal me\n  location      string // unexported (private) fields are not included in the json marshal output\n  JobTitle string `json:\"title,omitempty\"` // in our json, this field is called \"title\", but we only want to write the key if the field is not empty.\n}\n</code></pre>\n\n<p>If you need to precompute a field, or simply add a field in your json output of a struct that isn't a member of that struct, we can do that with some magic. When json objects are decoded again into golang structs, fields that don't fit (after checking renamed fields and capitalization differences) are simply ignored. </p>\n\n<pre><code>// AntiRecursionMyStruct avoids infinite recursion in MashalJSON. Only intended for the json package to use.\ntype AntiRecursionMyStruct MyStruct\n\n// MarshalJSON implements the json.Marshaller interface. This lets us marshal this struct into json however we want. In this case, we add a field and then cast it to another type that doesn't implement the json.Marshaller interface, and thereby letting the json library marshal it for us.\nfunc (t MyStruct) MarshalJSON() ([]byte, error) {\n    return json.Marshal(struct {\n        AntiRecursionMyStruct\n        Kind string // the field we want to add, in this case a text representation of the golang type used to generate the struct\n    }{\n        AntiRecursionMyStruct: AntiRecursionMyStruct(t),\n        Kind: fmt.Sprintf(\"%T\", MyStruct{}),\n    })\n}\n</code></pre>\n\n<p>Keep in mind that json will only include your exported (capitalized) struct members. I've made this misstake multiple times. </p>\n\n<p>As a general rule, if something seems too complicated, there's probably a better way to do it.</p>\n"}], "owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452971089, "creation_date": 1452708281, "question_id": 34773908, "link": "https://stackoverflow.com/questions/34773908/serializing-models-in-golang", "title": "Serializing Models in Golang", "body": "<p>I'm trying to separate my code into models and serializers with the idea that there be defined serializers that handles all json responsibilities, i.e. separation of concerns.  I also want to be able to call a model object <code>obj.Serialize()</code> to get the serializer struct obj that I can then marshal.  Therefore, I've come up with the following design.  To avoid circular import I had to use interfaces in my serializers which leads to using getters in my models.  I've read that getters/setters aren't idiomatic go code and I would prefer not to have \"boilerplate\" getter code all over my models.  Is there a better solution to what I want to accomplish, keeping in mind I want separation of concerns and <code>obj.Serialize()</code>?</p>\n\n<pre><code>src/\n    models/\n        a.go\n    serializers/\n        a.go\n</code></pre>\n\n<p><code>models/a.go</code></p>\n\n<pre><code>import \"../serializers\"\n\ntype A struct {\n  name string\n  age int // do not marshal me\n}\n\nfunc (a *A) Name() string {\n  return a.name\n}\n\n// Serialize converts A to ASerializer\nfunc (a *A) Serialize() interface{} {\n    s := serializers.ASerializer{}\n    s.SetAttrs(a)\n    return s\n}\n</code></pre>\n\n<p><code>serializers/a.go</code></p>\n\n<pre><code>// AInterface used to get Post attributes\ntype AInterface interface {\n  Name() string\n}\n\n// ASerializer holds json fields and values\ntype ASerializer struct {\n  Name `json:\"full_name\"`\n}\n\n// SetAttrs sets attributes for PostSerializer\nfunc (s *ASerializer) SetAttrs(a AInterface) {\n  s.Name = a.Name()\n}\n</code></pre>\n"}, {"tags": ["json", "go", "marshalling"], "comments": [{"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 2, "creation_date": 1452707574, "post_id": 34773490, "comment_id": 57292327, "body": "You have a <code>&quot;</code> missing in <code>json:pointer,omitempty&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1452707567, "creation_date": 1452707567, "answer_id": 34773640, "question_id": 34773490, "link": "https://stackoverflow.com/questions/34773490/golang-fomatting-struct-to-json/34773640#34773640", "title": "golang - fomatting struct to json", "body": "<p>You've missed a few quotes:</p>\n\n<pre><code>Pointer   string `json:pointer,omitempty\"`\nParameter string `json:parameter,omitempty\"`\n                  // ^^^ Here.\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/P3oHK29VKQ\" rel=\"nofollow\">https://play.golang.org/p/P3oHK29VKQ</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 5785762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208390963561027/picture?type=large", "display_name": "Arild Belsvik", "link": "https://stackoverflow.com/users/5785762/arild-belsvik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 34773640, "answer_count": 1, "score": 0, "last_activity_date": 1452707567, "creation_date": 1452707056, "question_id": 34773490, "link": "https://stackoverflow.com/questions/34773490/golang-fomatting-struct-to-json", "title": "golang - fomatting struct to json", "body": "<p>Does anyone know how to set the tag names for multilevel structs?\nThe top level tag-names of the struct works ok, but all sublevels tag names have the same name as in the struct. Trying to set all tag-name to lowercase.</p>\n\n<p>The code can be run <a href=\"https://play.golang.org/p/kmn0wmMGGF\" rel=\"nofollow\">here</a>: </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"log\"\n)\n\ntype Source struct {\n    Pointer   string `json:pointer,omitempty\"`\n    Parameter string `json:parameter,omitempty\"`\n}\n\ntype Error struct {\n    Status int     `json:\"status,omitempty\"`\n    Source *Source `json:\"source,omitempty\"`\n    Title  string  `json:\"title,omitempty\"`\n    Detail string  `json:\"detail,omitempty\"`\n}\n\ntype Errors struct {\n    Errors *[]Error `json:\"errors\"`\n}\n\nfunc main() {\n    errors := new(Errors)\n    errors.Errors = new([]Error)\n    error := new(Error)\n    error.Source = new(Source)\n    error.Source.Pointer = \"pointer\"\n    error.Status = 401\n    error.Title = \"title\"\n    error.Detail = \"detail\"\n    *errors.Errors = append(*(errors.Errors), *error)\n    response, _ := json.Marshal(errors)\n    log.Println(\"response\", string(response))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\n   \"errors\": [\n   {\n      \"status\": 400,\n      \"source\": {\n        \"Pointer\": \"pointer\",\n        \"Parameter\": \"\"\n      },\n      \"title\": \"title\",\n      \"detail\": \"detail\"\n    }\n  ]\n}\n</code></pre>\n"}, {"tags": ["logging", "go", "panic"], "comments": [{"owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "edited": false, "score": 0, "creation_date": 1469785446, "post_id": 34772012, "comment_id": 64692377, "body": "I think <code>recover</code> is better than redirect the output. <code>debug.PrintStack</code> can print the logs of you need. Some other logs, for example, the GC message, can still stay in the stderr."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1452704526, "post_id": 34772516, "comment_id": 57290361, "body": "I would note that you can only recover from within your own goroutine. I think OP may be looking for a global &quot;recover&quot;, which you can&#39;t do."}, {"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452704568, "post_id": 34772516, "comment_id": 57290392, "body": "True, indeed. I&#39;ll edit that in, thanks for the hint."}, {"owner": {"reputation": 263, "user_id": 1324793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848aefd5498d20858883e9a3fc5fad27?s=128&d=identicon&r=PG", "display_name": "David Frascone", "link": "https://stackoverflow.com/users/1324793/david-frascone"}, "edited": false, "score": 0, "creation_date": 1452707551, "post_id": 34772516, "comment_id": 57292315, "body": "Well, I don&#39;t need to stop the panic, I just want the backtrace to appear in my log, not to stderr.  I guess I could replace os.Stderr with my logger?    Nope -- just checked, even with os.Stderr being my logfile handle, the panic still goes to stderr."}, {"owner": {"reputation": 627, "user_id": 1086647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14e5b65b387ab3a473ff1b116f9c0934?s=128&d=identicon&r=PG", "display_name": "blamblambunny", "link": "https://stackoverflow.com/users/1086647/blamblambunny"}, "edited": false, "score": 0, "creation_date": 1553704556, "post_id": 34772516, "comment_id": 97486647, "body": "keep in mind that calling <code>panic(x)</code>, even in recovery, will kill your process. if you just want the stack, call <code>debug.PrintStack()</code>"}, {"owner": {"reputation": 63, "user_id": 1853733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95fa0e937eaadf84f06a427a5b2d8655?s=128&d=identicon&r=PG", "display_name": "hunter_tech", "link": "https://stackoverflow.com/users/1853733/hunter-tech"}, "edited": false, "score": 0, "creation_date": 1587893475, "post_id": 34772516, "comment_id": 108683008, "body": "That&#39;s just what I wanted"}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 10, "last_activity_date": 1452704722, "last_edit_date": 1452704722, "creation_date": 1452704100, "answer_id": 34772516, "question_id": 34772012, "link": "https://stackoverflow.com/questions/34772012/capturing-panic-in-golang/34772516#34772516", "title": "Capturing panic() in golang", "body": "<p>You can use <a href=\"https://golang.org/ref/spec#Handling_panics\" rel=\"noreferrer\"><code>recover()</code></a> to recover panics from the same goroutine. When calling <code>recover()</code> in a deferred method (remember that deferred methods will still be called, even when <code>panic()</code>ing), it will return whatever was passed into the last <code>panic()</code> call as argument (or <code>nil</code> when the program is not panicking).</p>\n\n<pre><code>defer func() {\n    if x := recover(); x != nil {\n        // recovering from a panic; x contains whatever was passed to panic()\n        log.Printf(\"run time panic: %v\", x)\n\n        // if you just want to log the panic, panic again\n        panic(x)\n    }\n}()\n\npanic(\"foo\");\n</code></pre>\n\n<p><strong>Note however</strong>, that you cannot recover from panics that were triggered in a different goroutine (thanks to JimB for the hint). Using a single <code>recover()</code> to recover from panics from any goroutine is not possible.</p>\n"}, {"comments": [{"owner": {"reputation": 263, "user_id": 1324793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848aefd5498d20858883e9a3fc5fad27?s=128&d=identicon&r=PG", "display_name": "David Frascone", "link": "https://stackoverflow.com/users/1324793/david-frascone"}, "edited": false, "score": 0, "creation_date": 1452796819, "post_id": 34773942, "comment_id": 57337615, "body": "This worked for me -- panics going to my fd instead of stderr solved my issue."}, {"owner": {"reputation": 3115, "user_id": 67865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a784a4cf0b9923a7dc133292ad783cc?s=128&d=identicon&r=PG", "display_name": "Tim Lewis", "link": "https://stackoverflow.com/users/67865/tim-lewis"}, "edited": false, "score": 0, "creation_date": 1508419967, "post_id": 34773942, "comment_id": 80609611, "body": "I tried this and the unix side worked for me but the windows side did not... any insight? -- <a href=\"https://play.golang.org/p/jQaN1bNypx\" rel=\"nofollow noreferrer\">play.golang.org/p/jQaN1bNypx</a>"}, {"owner": {"reputation": 3115, "user_id": 67865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a784a4cf0b9923a7dc133292ad783cc?s=128&d=identicon&r=PG", "display_name": "Tim Lewis", "link": "https://stackoverflow.com/users/67865/tim-lewis"}, "edited": false, "score": 0, "creation_date": 1508421211, "post_id": 34773942, "comment_id": 80610575, "body": "I did some more experimenting and on window&#39;s you must also do <code>os.Stderr = f</code> since <code>SetStdHandle</code> does not affect the prior reference to stderr. On unix it is not necessary since the <code>Dup2</code> does affect the prior reference to stderr. <a href=\"https://play.golang.org/p/mXjw6lOrG9\" rel=\"nofollow noreferrer\">play.golang.org/p/mXjw6lOrG9</a>"}, {"owner": {"reputation": 2256, "user_id": 2692528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3439ab638c65dcfd26246e827b7ff2e0?s=128&d=identicon&r=PG&f=1", "display_name": "Svartalf", "link": "https://stackoverflow.com/users/2692528/svartalf"}, "edited": false, "score": 0, "creation_date": 1571954731, "post_id": 34773942, "comment_id": 103420288, "body": "See Jakob&#39;s answer down below.  If you&#39;re on a POSIX-like or BSD-like supported by Go, this will work.  I&#39;m currently working with him to see if we can clean up some of the results of this so that logging is more consistent, etc. for gocryptfs."}, {"owner": {"reputation": 578, "user_id": 7823423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kkX4Xjrf1fA/AAAAAAAAAAI/AAAAAAAAAEw/cDaurOcupnw/photo.jpg?sz=128", "display_name": "Sabyasachi Patra", "link": "https://stackoverflow.com/users/7823423/sabyasachi-patra"}, "reply_to_user": {"reputation": 3115, "user_id": 67865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a784a4cf0b9923a7dc133292ad783cc?s=128&d=identicon&r=PG", "display_name": "Tim Lewis", "link": "https://stackoverflow.com/users/67865/tim-lewis"}, "edited": false, "score": 1, "creation_date": 1582638916, "post_id": 34773942, "comment_id": 106840683, "body": "Is there a way to redirect entire stderr to file in windows? I am trying this for all the messages, but it only puts the panic to the file. I am able to redirect all STDOUT but not error. @TimLewis"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 18, "last_activity_date": 1508421566, "last_edit_date": 1508421566, "creation_date": 1452708399, "answer_id": 34773942, "question_id": 34772012, "link": "https://stackoverflow.com/questions/34772012/capturing-panic-in-golang/34773942#34773942", "title": "Capturing panic() in golang", "body": "<p>As far as I know, you can't redirect the output from panic away from standard error, or to your logger.  The best thing you can do is redirect standard error to a file which you can do externally, or inside your program.</p>\n\n<p>For my <a href=\"http://github.com/ncw/rclone\" rel=\"noreferrer\">rclone</a> program I redirected standard error to capture everything to a file on an option which is unfortunately isn't particularly easy to do in a cross platform way.  Here is how I did it (see the redirect*.go files)</p>\n\n<p>For linux/unix</p>\n\n<pre><code>// Log the panic under unix to the log file\n\n//+build unix\n\npackage main\n\nimport (\n    \"log\"\n    \"os\"\n    \"syscall\"\n)\n\n// redirectStderr to the file passed in\nfunc redirectStderr(f *os.File) {\n    err := syscall.Dup2(int(f.Fd()), int(os.Stderr.Fd()))\n    if err != nil {\n        log.Fatalf(\"Failed to redirect stderr to file: %v\", err)\n    }\n}\n</code></pre>\n\n<p>and for windows</p>\n\n<pre><code>// Log the panic under windows to the log file\n//\n// Code from minix, via\n//\n// http://play.golang.org/p/kLtct7lSUg\n\n//+build windows\n\npackage main\n\nimport (\n    \"log\"\n    \"os\"\n    \"syscall\"\n)\n\nvar (\n    kernel32         = syscall.MustLoadDLL(\"kernel32.dll\")\n    procSetStdHandle = kernel32.MustFindProc(\"SetStdHandle\")\n)\n\nfunc setStdHandle(stdhandle int32, handle syscall.Handle) error {\n    r0, _, e1 := syscall.Syscall(procSetStdHandle.Addr(), 2, uintptr(stdhandle), uintptr(handle), 0)\n    if r0 == 0 {\n        if e1 != 0 {\n            return error(e1)\n        }\n        return syscall.EINVAL\n    }\n    return nil\n}\n\n// redirectStderr to the file passed in\nfunc redirectStderr(f *os.File) {\n    err := setStdHandle(syscall.STD_ERROR_HANDLE, syscall.Handle(f.Fd()))\n    if err != nil {\n        log.Fatalf(\"Failed to redirect stderr to file: %v\", err)\n    }\n    // SetStdHandle does not affect prior references to stderr\n    os.Stderr = f\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 152, "user_id": 1380267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8f66731f1d41159acfffefa3593b51?s=128&d=identicon&r=PG", "display_name": "Jakob", "link": "https://stackoverflow.com/users/1380267/jakob"}, "is_accepted": false, "score": 1, "last_activity_date": 1495649413, "creation_date": 1495649413, "answer_id": 44165740, "question_id": 34772012, "link": "https://stackoverflow.com/questions/34772012/capturing-panic-in-golang/44165740#44165740", "title": "Capturing panic() in golang", "body": "<p>Expanding @nick-craig-wood's answer:\nIf you are on Linux you can spawn a logger(1) instance and redirect stderr to it. That way you get the full backtrace into syslog. This is what <a href=\"https://github.com/rfjakob/gocryptfs\" rel=\"nofollow noreferrer\">gocryptfs</a> does:</p>\n\n<pre><code>// redirectStdFds redirects stderr and stdout to syslog; stdin to /dev/null\nfunc redirectStdFds() {\n    // stderr and stdout\n    pr, pw, err := os.Pipe()\n    if err != nil {\n        tlog.Warn.Printf(\"redirectStdFds: could not create pipe: %v\\n\", err)\n        return\n    }\n    tag := fmt.Sprintf(\"gocryptfs-%d-logger\", os.Getpid())\n    cmd := exec.Command(\"logger\", \"-t\", tag)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    cmd.Stdin = pr\n    err = cmd.Start()\n    if err != nil {\n        tlog.Warn.Printf(\"redirectStdFds: could not start logger: %v\\n\", err)\n    }\n    pr.Close()\n    err = syscall.Dup2(int(pw.Fd()), 1)\n    if err != nil {\n        tlog.Warn.Printf(\"redirectStdFds: stdout dup error: %v\\n\", err)\n    }\n    syscall.Dup2(int(pw.Fd()), 2)\n    if err != nil {\n        tlog.Warn.Printf(\"redirectStdFds: stderr dup error: %v\\n\", err)\n    }\n    pw.Close()\n\n    // stdin\n    nullFd, err := os.Open(\"/dev/null\")\n    if err != nil {\n        tlog.Warn.Printf(\"redirectStdFds: could not open /dev/null: %v\\n\", err)\n        return\n    }\n    err = syscall.Dup2(int(nullFd.Fd()), 0)\n    if err != nil {\n        tlog.Warn.Printf(\"redirectStdFds: stdin dup error: %v\\n\", err)\n    }\n    nullFd.Close()\n}\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 1324793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848aefd5498d20858883e9a3fc5fad27?s=128&d=identicon&r=PG", "display_name": "David Frascone", "link": "https://stackoverflow.com/users/1324793/david-frascone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11234, "favorite_count": 9, "accepted_answer_id": 34773942, "answer_count": 3, "score": 21, "last_activity_date": 1508421566, "creation_date": 1452702727, "question_id": 34772012, "link": "https://stackoverflow.com/questions/34772012/capturing-panic-in-golang", "title": "Capturing panic() in golang", "body": "<p>We have a large-ish golang application that uses the logger (actually, a custom logger), to write output to a log file that is periodically rotated.</p>\n\n<p>However, when an application crashes or panic()'s, those messages go to standard error.</p>\n\n<p>Is there any way to override the panic functionality to use our logger?</p>\n"}, {"tags": ["string", "go", "split", "string-split"], "answers": [{"comments": [{"owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "edited": false, "score": 0, "creation_date": 1452702571, "post_id": 34771816, "comment_id": 57288787, "body": "This seems like an elegant solution. I am wondering, is there a way to split before the word rather than replacing it on the split?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "edited": false, "score": 0, "creation_date": 1452702780, "post_id": 34771816, "comment_id": 57288971, "body": "@JamesMilner: Please show what you mean by &quot;split before the word&quot;."}, {"owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "edited": false, "score": 0, "creation_date": 1452702851, "post_id": 34771816, "comment_id": 57289021, "body": "I.e. return &quot;Dogs&quot;, &quot;and Cats&quot;, &quot;are Great&quot; rather than &quot;Dogs&quot;, &quot;Cats&quot;, &quot;Great&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "edited": false, "score": 1, "creation_date": 1452704006, "post_id": 34771816, "comment_id": 57289969, "body": "@JamesMilner: I would find the indexes of the matches (using something like <code>FindAllStringIndex</code>), and slice the string based on that."}, {"owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "edited": false, "score": 0, "creation_date": 1452706011, "post_id": 34771816, "comment_id": 57291356, "body": "I think that&#39;s the best solution. Thanks for your help."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1452702716, "last_edit_date": 1452702716, "creation_date": 1452702186, "answer_id": 34771816, "question_id": 34771452, "link": "https://stackoverflow.com/questions/34771452/splitting-a-string-on-a-list-of-strings-in-go/34771816#34771816", "title": "Splitting a string on a list of strings in Go", "body": "<p>You can use a regular expression: <a href=\"http://play.golang.org/p/vCRCv4rt7s\" rel=\"nofollow\">http://play.golang.org/p/vCRCv4rt7s</a></p>\n\n<pre><code>re := regexp.MustCompile(`and|are`)\nfmt.Printf(\"%q\\n\", re.Split(\"Dogs and Cats are Great\", -1))\n</code></pre>\n"}], "owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 34771816, "answer_count": 1, "score": 3, "last_activity_date": 1452702716, "creation_date": 1452701222, "question_id": 34771452, "link": "https://stackoverflow.com/questions/34771452/splitting-a-string-on-a-list-of-strings-in-go", "title": "Splitting a string on a list of strings in Go", "body": "<p>Is it possible to split not just on one string but also a slice of strings? I.e.</p>\n\n<pre><code>strings.Split(\"Dogs and Cats are Great\", \"and\"))\n</code></pre>\n\n<p>But instead of using one string, a slice of strings as so:</p>\n\n<pre><code>strings.Split(\"Dogs and Cats are Great\", []string{\"and\", \"are\"}))\n</code></pre>\n"}, {"tags": ["node.js", "go", "karma-runner", "travis-ci", "drone"], "answers": [{"tags": [], "owner": {"reputation": 1753, "user_id": 570293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DuOBG.png?s=128&g=1", "display_name": "moin moin", "link": "https://stackoverflow.com/users/570293/moin-moin"}, "is_accepted": true, "score": 1, "last_activity_date": 1452707963, "creation_date": 1452707963, "answer_id": 34773791, "question_id": 34767628, "link": "https://stackoverflow.com/questions/34767628/how-to-run-golang-and-karma-tests-within-one-project-on-travis-ci/34773791#34773791", "title": "How to run Golang and Karma tests within one project on Travis CI", "body": "<p>sometimes the problem sits in front of the machine... I found a great workaround and I want to share it with you.</p>\n\n<p>I created an account on <a href=\"https://drone.io/\" rel=\"nofollow\">https://drone.io/</a> in the settings tab I selected a build for \"Go1\" and added the following commands:</p>\n\n<pre><code># install gogrinder dependencies\ngo get ./...\n\n# install test dependencies\ngo get golang.org/x/tools/cmd/cover\ngo get -v github.com/axw/gocov\ngo install github.com/axw/gocov/gocov\n\n# install nodejs requirements\nnpm -d install\n./node_modules/bower/bin/bower install\n\n# run the tests on the go code\ngocov test | gocov report\n\n# run the tests on the Angularjs frontend\nnpm test\n</code></pre>\n\n<p>Now I am back on track with a CI server that runs both Golang and Karma tests.</p>\n"}, {"tags": [], "owner": {"reputation": 9858, "user_id": 973380, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b760f503c84d1bf47322f401066c753f?s=128&d=identicon&r=PG", "display_name": "fiatjaf", "link": "https://stackoverflow.com/users/973380/fiatjaf"}, "is_accepted": false, "score": 1, "last_activity_date": 1490834339, "creation_date": 1490834339, "answer_id": 43106527, "question_id": 34767628, "link": "https://stackoverflow.com/questions/34767628/how-to-run-golang-and-karma-tests-within-one-project-on-travis-ci/43106527#43106527", "title": "How to run Golang and Karma tests within one project on Travis CI", "body": "<p>I gave a solution to this on <a href=\"http://entulho.fiatjaf.alhur.es/guias/how-to-use-node-along-with-other-language-on-travis-ci/\" rel=\"nofollow noreferrer\">http://entulho.fiatjaf.alhur.es/guias/how-to-use-node-along-with-other-language-on-travis-ci/</a> a long time ago, but it still works today:</p>\n\n<p>Basically you just add</p>\n\n<pre><code>install:\n  - . $HOME/.nvm/nvm.sh\n  - nvm install stable\n  - nvm use stable\n  - npm install\n</code></pre>\n\n<p>to your <code>.travis.yml</code>, which must be set to a different language, and it will install <code>node</code> and <code>npm</code>.</p>\n"}], "owner": {"reputation": 1753, "user_id": 570293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DuOBG.png?s=128&g=1", "display_name": "moin moin", "link": "https://stackoverflow.com/users/570293/moin-moin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "accepted_answer_id": 34773791, "answer_count": 2, "score": 1, "last_activity_date": 1495128618, "creation_date": 1452690662, "last_edit_date": 1495535490, "question_id": 34767628, "link": "https://stackoverflow.com/questions/34767628/how-to-run-golang-and-karma-tests-within-one-project-on-travis-ci", "title": "How to run Golang and Karma tests within one project on Travis CI", "body": "<p>I think my question is related to these ones but the solution did not work in my case: <a href=\"https://stackoverflow.com/questions/31235146/how-to-run-node-js-and-ruby-tests-within-one-project-on-travis-ci\">How to run Node.js and Ruby tests within one project on Travis CI</a> and <a href=\"https://stackoverflow.com/questions/18456611/is-it-possible-to-set-up-travis-to-run-tests-for-several-languages?rq=1\">Is it possible to set up travis to run tests for several languages?</a></p>\n\n<p>I have a github repo that contains a little Golang application with a tiny Angularjs frontend. I want to run both go-tests and Karma-tests.\nI see two options:</p>\n\n<ol>\n<li><p>Run two travis-ci builds for one repo (I could not figure out how to\ndo that)</p></li>\n<li><p>Run both tests in one build (did not work since the node version in travis-ci is too old (0.10).</p></li>\n</ol>\n\n<p>The build runs for 60+ minutes and then stops with \"FATAL ERROR: CALL_AND_RETRY_2 Allocation failed - process out of memory\". The build shows tons of warnings like this one: npm WARN engine escodegen@1.8.0: wanted: {\"node\":\">=0.12.0\"} (current: {\"node\":\"0.10.36\",\"npm\":\"1.4.28\"})</p>\n\n<p>I tried to run the build as <strong>node_js</strong> but then the \"go get xyz\" does not work.</p>\n\n<p>my <strong>.travis.yml</strong> file:</p>\n\n<pre><code>language: go\n\ngo:\n  - 1.5\n\nenv:\n  - TRAVIS_NODE_VERSION=\"0.12\"\n\ninstall:\n  - export PATH=$HOME/gopath/bin:$PATH\n  - go get golang.org/x/tools/cmd/cover\n  - go get -v github.com/axw/gocov\n  - go install github.com/axw/gocov/gocov\n  - go get github.com/GeertJohan/go.rice\n  # we do not need the rice tool!\n  - go get github.com/xeipuuv/gojsonschema\n  - go get github.com/finklabs/ttime\n  - go get github.com/finklabs/graceful\n  - go get github.com/gorilla/mux\n\nbefore_script:\n  - npm install bower\n  - npm install --dev\n  - bower install\n\nscript:\n  - gocov test | gocov report\n  - npm test\n</code></pre>\n"}, {"tags": ["go", "couchbase"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1452690049, "post_id": 34767338, "comment_id": 57279575, "body": "Whenever you use a package that isn&#39;t in std it&#39;s a good practice to add a link to the package docs in your question."}, {"owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1452690197, "post_id": 34767338, "comment_id": 57279679, "body": "sure, package name added."}], "answers": [{"tags": [], "owner": {"reputation": 1884, "user_id": 430996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c6df24b3ea79f562bd316152cdfd11?s=128&d=identicon&r=PG", "display_name": "Matt Ingenthron", "link": "https://stackoverflow.com/users/430996/matt-ingenthron"}, "is_accepted": true, "score": 2, "last_activity_date": 1453173085, "last_edit_date": 1453173085, "creation_date": 1453172153, "answer_id": 34867787, "question_id": 34767338, "link": "https://stackoverflow.com/questions/34767338/golang-couchbase-gocb-removeop-doesnt-removes-all/34867787#34867787", "title": "golang couchbase gocb.RemoveOp - doesnt removes all", "body": "<p>By default, queries against N1QL use a consistency level called 'request plus'.  Thus, your second time running the program to query will use whatever index update is valid at the time of the query, rather than considering all of your previous mutations by waiting until the index is up to date.  You can read more about this in <a href=\"http://developer.couchbase.com/documentation/server/4.1/developer-guide/query-consistency.html\" rel=\"nofollow\">Couchbase's Developer Guide</a> and it looks like the you'll want to add the <a href=\"https://godoc.org/github.com/couchbase/gocb#RequestPlus\" rel=\"nofollow\"><code>RequestPlus</code> parameter</a> to your myquery <a href=\"https://godoc.org/github.com/couchbase/gocb#N1qlQuery.Consistency\" rel=\"nofollow\">through the consistency method on the query</a>.</p>\n\n<p>This kind of eventually consistent secondary indexing and the flexibility is pretty powerful because it gives you as a developer the ability to decide what level of consistency you want to pay for since index recalculations have a cost.</p>\n"}], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 34867787, "answer_count": 1, "score": 3, "last_activity_date": 1453173085, "creation_date": 1452689742, "last_edit_date": 1452694050, "question_id": 34767338, "link": "https://stackoverflow.com/questions/34767338/golang-couchbase-gocb-removeop-doesnt-removes-all", "title": "golang couchbase gocb.RemoveOp - doesnt removes all", "body": "<p>I think I did a silly mistake somewhere, but could not figure where for long time already :( The code is rough, I just testing things.\nIt deletes, but by some reasons not all documents, I have rewritten to delete it all one by one, and that went OK.\nI use official package for Couchbase  <a href=\"http://github.com/couchbase/gocb\" rel=\"nofollow\">http://github.com/couchbase/gocb</a>\nHere is code:   </p>\n\n<pre><code>var items []gocb.BulkOp\nmyQuery := gocb.NewN1qlQuery([Selecting ~ 283k documents from 1.5mln])\nrows, err := myBucket.ExecuteN1qlQuery(myQuery, nil)\ncheckErr(err)\nvar idToDelete map[string]interface{}\n\nfor rows.Next(&amp;idToDelete) {\n    items = append(items, &amp;gocb.RemoveOp{Key: idToDelete[\"id\"].(string)})\n}\n\nif err := rows.Close(); err != nil {\n    fmt.Println(err.Error())\n}\nif err := myBucket.Do(items);err != nil {\n    fmt.Println(err.Error())\n}\n</code></pre>\n\n<p>This way it deleted ~70k documents, I run it again it got deleted 43k more.. </p>\n\n<p>Then I just let it delete one by one, and it worked fine:</p>\n\n<pre><code>//var items []gocb.BulkOp\nmyQuery := gocb.NewN1qlQuery([Selecting ~ 180k documents from ~1.3mln])\nrows, err := myBucket.ExecuteN1qlQuery(myQuery, nil)\ncheckErr(err)\nvar idToDelete map[string]interface{}\nfor rows.Next(&amp;idToDelete) {\n  //items = append(items, &amp;gocb.RemoveOp{Key: idToDelete[\"id\"].(string)})\n  _, err := myBucket.Remove(idToDelete[\"id\"].(string), 0)\n  checkErr(err)\n}\n\nif err := rows.Close(); err != nil {\n  fmt.Println(err.Error())\n}\n//err = myBucket.Do(items)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3014, "user_id": 1094048, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb4155fc0e3db87bea408b25bf836cfa?s=128&d=identicon&r=PG", "display_name": "pkuderov", "link": "https://stackoverflow.com/users/1094048/pkuderov"}, "edited": false, "score": 0, "creation_date": 1452686263, "post_id": 34765944, "comment_id": 57277087, "body": "if variable not needed use underscore <a href=\"https://play.golang.org/p/S9kzv_dBlk\" rel=\"nofollow noreferrer\">play.golang.org/p/S9kzv_dBlk</a>"}, {"owner": {"reputation": 3014, "user_id": 1094048, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb4155fc0e3db87bea408b25bf836cfa?s=128&d=identicon&r=PG", "display_name": "pkuderov", "link": "https://stackoverflow.com/users/1094048/pkuderov"}, "edited": false, "score": 5, "creation_date": 1452686598, "post_id": 34765944, "comment_id": 57277290, "body": "duplicate for <a href=\"http://stackoverflow.com/questions/21743841/how-to-avoid-annoying-error-declared-and-not-used-from-golang\" title=\"how to avoid annoying error declared and not used from golang\">stackoverflow.com/questions/21743841/&hellip;</a>. There&#39;s a nice explanation of why go language creators added this check."}], "answers": [{"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 2, "last_activity_date": 1452687024, "creation_date": 1452687024, "answer_id": 34766376, "question_id": 34765944, "link": "https://stackoverflow.com/questions/34765944/declared-but-not-used-variable-in-fors-condition-expression/34766376#34766376", "title": "&quot;Declared but not used&quot; variable in for&#39;s condition expression", "body": "<p>You are declaring a variable (<code>moreline</code>) which you don't use it. You have two options here: either to replace the <code>moreline</code> with underscore, which means you can omit the return value.</p>\n\n<pre><code>for moreline {\n        line, _, err := bio.ReadLine()\n        if err != nil {\n                log.Fatal(err)\n        }\n        fmt.Println(line)\n}\n</code></pre>\n\n<p>But a better option will be to use the <code>ReadScanner</code>, <code>ReadBytes('\\n')</code> or <code>ReadString('\\n')</code>.</p>\n\n<p>Checking the <code>bufio.go</code> file this is what you get as description for the <code>ReadLine</code> method:</p>\n\n<blockquote>\n  <p>ReadLine is a low-level line-reading primitive. Most callers should\n  use ReadBytes('\\n') or ReadString('\\n') instead or use a Scanner.</p>\n</blockquote>\n\n<p>Calling <code>UnreadByte</code> after <code>ReadLine</code> will always unread the last byte read (possibly a character belonging to the line end) even if that byte is not part of the line returned by <code>ReadLine</code>. <code>ReadLine</code> either returns a non-nil line or it returns an error, never both.</p>\n\n<p>So this would be a better option: </p>\n\n<pre><code>scanner := bufio.NewScanner(bio)\n\nfor scanner.Scan() {\n    line := scanner.Text()\n    fmt.Printf(\"%v\\n\", line)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "is_accepted": true, "score": 1, "last_activity_date": 1452688778, "creation_date": 1452688778, "answer_id": 34767000, "question_id": 34765944, "link": "https://stackoverflow.com/questions/34765944/declared-but-not-used-variable-in-fors-condition-expression/34767000#34767000", "title": "&quot;Declared but not used&quot; variable in for&#39;s condition expression", "body": "<p>You use <code>:=</code> which discards the previous contents of the variables. You don't use <code>morelines</code> in that scope, thus the error message.</p>\n\n<p>If you declare your variables beforehand and don't use <code>:=</code>, it works fine. The function <code>ReadLine()</code> might not do what you think it should do.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    bio := bufio.NewReader(os.Stdin)\n    var line []byte\n    var err error\n    moreline := true\n    for moreline {\n        line, moreline, err = bio.ReadLine()\n        if err != nil {\n            log.Fatal(err)\n        }\n        fmt.Println(line)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 1937358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd174b6446235bc6831243f9fc7493c?s=128&d=identicon&r=PG", "display_name": "user1937358", "link": "https://stackoverflow.com/users/1937358/user1937358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1452689775, "accepted_answer_id": 34767000, "answer_count": 2, "score": -4, "last_activity_date": 1452688778, "creation_date": 1452685752, "question_id": 34765944, "link": "https://stackoverflow.com/questions/34765944/declared-but-not-used-variable-in-fors-condition-expression", "closed_reason": "Not suitable for this site", "title": "&quot;Declared but not used&quot; variable in for&#39;s condition expression", "body": "<p>My intuitive approach:\n<a href=\"https://play.golang.org/p/6xzg7TK1IH\" rel=\"nofollow\">https://play.golang.org/p/6xzg7TK1IH</a></p>\n\n<p>and it doesn't work.</p>\n\n<p>Can you share some alternative ways?</p>\n"}, {"tags": ["go", "imagemagick", "magickwand"], "comments": [{"owner": {"reputation": 82600, "user_id": 496445, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/db00d7b4388686c6d280e8f0578c7e39?s=128&d=identicon&r=PG", "display_name": "jdi", "link": "https://stackoverflow.com/users/496445/jdi"}, "edited": false, "score": 0, "creation_date": 1452895491, "post_id": 34764612, "comment_id": 57383865, "body": "This is being tracked by issue <a href=\"https://github.com/gographics/imagick/issues/68\" rel=\"nofollow noreferrer\">#68</a>. Once I confirm and commit a fix, I will type up an answer explaining why this is occurring."}], "answers": [{"comments": [{"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1452754433, "post_id": 34767783, "comment_id": 57310748, "body": "I am still getting the error <code>could not determine kind of name for C.FlattenAlphaChannel could not determine kind of name for C.RemoveAlphaChannel</code>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1452762514, "post_id": 34767783, "comment_id": 57314850, "body": "What is your OS and Go version? My solution works for your original error, but I cannot reproduce these."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1452764438, "post_id": 34767783, "comment_id": 57316148, "body": "ubuntu 12.04 and go1.5.2.linux-386"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1452848867, "post_id": 34767783, "comment_id": 57357343, "body": "@Naresh Sorry, I&#39;m on 14.04 and can&#39;t reproduce. The package maintainer has given <a href=\"https://github.com/gographics/imagick/issues/24#issuecomment-66534047\" rel=\"nofollow noreferrer\">this example</a> in the issues. If this doesn&#39;t help either you might try to raise a new issue about this."}, {"owner": {"reputation": 82600, "user_id": 496445, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/db00d7b4388686c6d280e8f0578c7e39?s=128&d=identicon&r=PG", "display_name": "jdi", "link": "https://stackoverflow.com/users/496445/jdi"}, "edited": false, "score": 1, "creation_date": 1452895446, "post_id": 34767783, "comment_id": 57383848, "body": "I&#39;m a maintainer of the imagick bindings. Please refer to the issue tracker, <a href=\"https://github.com/gographics/imagick/issues/68\" rel=\"nofollow noreferrer\">#68</a>"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1452691130, "creation_date": 1452691130, "answer_id": 34767783, "question_id": 34764612, "link": "https://stackoverflow.com/questions/34764612/unable-to-build-magick-for-golang/34767783#34767783", "title": "unable to build magick for golang", "body": "<p>Their docs <a href=\"https://github.com/gographics/imagick#build-tags\" rel=\"nofollow\">mention</a> that <code>no_pkgconfig</code> must be used with manually set <code>GCO_CFLAGS</code> and <code>CGO_LDFLAGS</code>. So something like this should work:</p>\n\n<pre><code>export CGO_CFLAGS=\"$(pkg-config --cflags MagickWand)\"\nexport CGO_LDFLAGS=\"$(pkg-config --libs MagickWand)\"\ngo build -tags no_pkgconfig\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 82600, "user_id": 496445, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/db00d7b4388686c6d280e8f0578c7e39?s=128&d=identicon&r=PG", "display_name": "jdi", "link": "https://stackoverflow.com/users/496445/jdi"}, "is_accepted": true, "score": 1, "last_activity_date": 1452973752, "creation_date": 1452973752, "answer_id": 34831361, "question_id": 34764612, "link": "https://stackoverflow.com/questions/34764612/unable-to-build-magick-for-golang/34831361#34831361", "title": "unable to build magick for golang", "body": "<p>As mentioned on <a href=\"https://github.com/gographics/imagick/issues/68\" rel=\"nofollow\">#68</a> of the issue tracker, you are using way too old of a version of ImageMagick, which predates the versions that were tested for the master branch. Your Linux distro is older than the current available stable release. </p>\n\n<p>You should manually install a newer ImageMagick, and remove the, one from apt. Or use some solution that allows you to manage multiple versions. </p>\n"}], "owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1910, "favorite_count": 0, "accepted_answer_id": 34831361, "answer_count": 2, "score": 3, "last_activity_date": 1452973752, "creation_date": 1452681965, "last_edit_date": 1452682428, "question_id": 34764612, "link": "https://stackoverflow.com/questions/34764612/unable-to-build-magick-for-golang", "title": "unable to build magick for golang", "body": "<p>I am following this <a href=\"https://github.com/gographics/imagick\" rel=\"nofollow\">document</a> for building the Go Imagick library. </p>\n\n<p>When i ran the following command </p>\n\n<pre><code>go build -tags no_pkgconfig imagick\n</code></pre>\n\n<p>It throws the following exception : </p>\n\n<pre><code># imagick\nsrc/imagick/affine_matrix.go:8:29: fatal error: wand/MagickWand.h: No such file or directory\ncompilation terminated\n</code></pre>\n\n<p>Now to resolve that i have also installed the following packages as many people suggested to resolve the error. But it didn't work either.</p>\n\n<pre><code>sudo apt-get install libmagickwand-dev libmagickcore-dev imagemagick\n</code></pre>\n\n<p>Moreover, when i run <code>go build imagick</code>\nIt throws the following error :</p>\n\n<pre><code># imagick\ncould not determine kind of name for C.FlattenAlphaChannel\ncould not determine kind of name for C.RemoveAlphaChannel\n</code></pre>\n\n<p>Output of  <code>pkg-config --cflags --libs MagickWand</code> gives the correct output </p>\n\n<pre><code>-fopenmp -I/usr/include/ImageMagick  -lMagickWand -lMagickCore\n</code></pre>\n\n<p>ImageMagick is installed to this path(/usr/include/ImageMagick) only.</p>\n"}, {"tags": ["templates", "go", "consul", "consul-template"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1452681702, "post_id": 34761716, "comment_id": 57273945, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28674199/in-a-go-template-range-loop-are-variables-declared-outside-the-loop-reset-on-ea\">In a Go template range loop, are variables declared outside the loop reset on each iteration?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3465, "user_id": 232250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/df589218079514d46c56905ca8c6aa0b?s=128&d=identicon&r=PG", "display_name": "\u211daphink", "link": "https://stackoverflow.com/users/232250/%e2%84%9daphink"}, "edited": false, "score": 0, "creation_date": 1452677442, "post_id": 34762741, "comment_id": 57270877, "body": "Thank you. In consul-template, I&#39;m guessing I&#39;d need to write a <a href=\"https://github.com/hashicorp/consul-template#plugins\" rel=\"nofollow noreferrer\">plugin</a> to in order to write Go code for that?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 3465, "user_id": 232250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/df589218079514d46c56905ca8c6aa0b?s=128&d=identicon&r=PG", "display_name": "\u211daphink", "link": "https://stackoverflow.com/users/232250/%e2%84%9daphink"}, "edited": false, "score": 0, "creation_date": 1452679275, "post_id": 34762741, "comment_id": 57272231, "body": "@\u211daphink Looking at their docs it seems like you can write a plugin in any language, not just Go. Also, now that I think of it, moving the part after the loop inside is not actually a bad idea, unless you need to ensure that it only prints once."}, {"owner": {"reputation": 3465, "user_id": 232250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/df589218079514d46c56905ca8c6aa0b?s=128&d=identicon&r=PG", "display_name": "\u211daphink", "link": "https://stackoverflow.com/users/232250/%e2%84%9daphink"}, "edited": false, "score": 0, "creation_date": 1452679426, "post_id": 34762741, "comment_id": 57272344, "body": "Well in that case actually, it wouldn&#39;t hurt if I printed a line for <code>server_name</code> as well as <code>.Name</code>, so I might actually do that."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1452679383, "last_edit_date": 1452679383, "creation_date": 1452677029, "answer_id": 34762741, "question_id": 34761716, "link": "https://stackoverflow.com/questions/34761716/overriding-a-variable-in-a-loop-in-consul-template/34762741#34762741", "title": "Overriding a variable in a loop in consul-template", "body": "<p>Inner <code>$server_name</code> and outer <code>$server_name</code> are different variables. You can't set a variable from outer scope in Go templates: <a href=\"http://play.golang.org/p/0fuOmqXrSK\" rel=\"nofollow\">http://play.golang.org/p/0fuOmqXrSK</a>.</p>\n\n<p>You could try and rewrite your template to print the <code>acl</code> etc. part inside the inner <code>if</code> which would work unless you need to execute that part just once. Go templates are not designed as a scripting language for complex logic, it's a tool for showing pre-computed information. A <code>fmt.Printf</code> on steroids if you will. All logic including search and replacement should be in Go, it'll be faster, safer, easier to maintain and debug.</p>\n"}, {"comments": [{"owner": {"reputation": 5876, "user_id": 2347677, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1fWTO.png?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/2347677/greg"}, "edited": false, "score": 0, "creation_date": 1500049975, "post_id": 42705494, "comment_id": 77186756, "body": "nice nice nice nice"}], "tags": [], "owner": {"reputation": 136, "user_id": 1141913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/419739b949b0b7e391486f5466d6a895?s=128&d=identicon&r=PG", "display_name": "vassilvk", "link": "https://stackoverflow.com/users/1141913/vassilvk"}, "is_accepted": false, "score": 4, "last_activity_date": 1489093961, "creation_date": 1489093961, "answer_id": 42705494, "question_id": 34761716, "link": "https://stackoverflow.com/questions/34761716/overriding-a-variable-in-a-loop-in-consul-template/42705494#42705494", "title": "Overriding a variable in a loop in consul-template", "body": "<p>In a <code>consul-template</code> template, you can use <a href=\"https://github.com/hashicorp/consul-template#scratch\" rel=\"nofollow noreferrer\">the scratch</a> - a temporary key-value store available throughout the lifetime of a template.</p>\n\n<p>Your code would look like this:</p>\n\n<pre><code>{{ range services }}\n  {{ $server_name := .Name | replaceAll \"_\" \".\" }}\n  {{ scratch.Set \"server_name\" $server_name }}\n  {{ range .Tags }}\n    {{ if . | regexMatch \"server_name=\" }}\n      # found matching server_name in {{ . }}\n      {{ $server_name := . | regexReplaceAll \".*=\" \"\" }}\n      {{ scratch.Set \"server_name\" $server_name }}\n    {{ end }}\n  {{ end }}\n  # server_name = {{ scratch.Get \"server_name\" }}\n        acl host_{{ .Name }} hdr(host) -i {{ $server_name }}\n        use_backend {{ .Name }}_backend if host_{{ .Name }}\n{{ end }}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 6812932, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-97HiNNwly2Y/AAAAAAAAAAI/AAAAAAAADAo/M5AQa317CuM/photo.jpg?sz=128", "display_name": "Tomek Habiger", "link": "https://stackoverflow.com/users/6812932/tomek-habiger"}, "is_accepted": false, "score": 1, "last_activity_date": 1612509174, "creation_date": 1612509174, "answer_id": 66059067, "question_id": 34761716, "link": "https://stackoverflow.com/questions/34761716/overriding-a-variable-in-a-loop-in-consul-template/66059067#66059067", "title": "Overriding a variable in a loop in consul-template", "body": "<p>Since <a href=\"https://tip.golang.org/doc/go1.11#text/template\" rel=\"nofollow noreferrer\">Go 1.11 release</a> it's possible to modify variables via assignements within templates. So this is working now:</p>\n<pre><code>  {{ $v := &quot;init&quot; }}\n  {{ if true }}\n    {{ $v = &quot;changed&quot; }}\n  {{ end }}\n  v: {{ $v }} {{/* &quot;changed&quot; */}}\n</code></pre>\n<p>This version was <a href=\"https://github.com/hashicorp/consul-template/commit/60b846f4406ce87acec7c3c1de5d0725a54e4522#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52\" rel=\"nofollow noreferrer\">introduced</a> to Consul Template with the <a href=\"https://github.com/hashicorp/consul-template/releases/tag/v0.25.1\" rel=\"nofollow noreferrer\">v0.25.1</a> release.</p>\n"}], "owner": {"reputation": 3465, "user_id": 232250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/df589218079514d46c56905ca8c6aa0b?s=128&d=identicon&r=PG", "display_name": "\u211daphink", "link": "https://stackoverflow.com/users/232250/%e2%84%9daphink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2473, "favorite_count": 0, "accepted_answer_id": 34762741, "answer_count": 3, "score": 3, "last_activity_date": 1612509174, "creation_date": 1452673794, "last_edit_date": 1452674833, "question_id": 34761716, "link": "https://stackoverflow.com/questions/34761716/overriding-a-variable-in-a-loop-in-consul-template", "title": "Overriding a variable in a loop in consul-template", "body": "<p>I'm using the following template in consul-template:</p>\n\n<pre><code>{{ range services }}\n  {{ $server_name := .Name | replaceAll \"_\" \".\" }}\n  {{ range .Tags }}\n    {{ if . | regexMatch \"server_name=\" }}\n      # found matching server_name in {{ . }}\n      {{ $server_name := . | regexReplaceAll \".*=\" \"\" }}\n    {{ end }}\n  {{ end }}\n  # server_name = {{ $server_name }}\n        acl host_{{ .Name }} hdr(host) -i {{ $server_name }}\n        use_backend {{ .Name }}_backend if host_{{ .Name }}\n{{ end }}\n</code></pre>\n\n<p>which produces</p>\n\n<pre><code>  # found matching server_name in server_name=geoserver.hello.org\n\n\n\n\n\n\n  # server_name = geoserver.dev.hello.org\n        acl host_geoserver_dev_hello_org hdr(host) -i geoserver.dev.hello.org\n        use_backend geoserver_dev_hello_org_backend if host_geoserver_dev_hello_org\n</code></pre>\n\n<p>where <code>.Name</code> is <code>geoserver_dev_hello_org</code> and there is a <code>server_name=geoserver.hello.org</code> tag. I expect that by the end of the <code>.Tags</code> range loop, <code>$server_name</code> should have value <code>geoserver.hello.org</code>, but it still has its original value of <code>geoserver.dev.hello.org</code>.</p>\n\n<p>How can I make it so that the loop overrides <code>$server_name</code> (and exit the loop when the value is found)?</p>\n"}, {"tags": ["go", "uninstallation", "wmic", "windows-installer"], "comments": [{"owner": {"reputation": 46996, "user_id": 1163423, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/HmDO9.jpg?s=128&g=1", "display_name": "Martin Brandl", "link": "https://stackoverflow.com/users/1163423/martin-brandl"}, "edited": false, "score": 1, "creation_date": 1452672686, "post_id": 34761184, "comment_id": 57267836, "body": "How is this question related to powershell?"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 2, "last_activity_date": 1452681827, "last_edit_date": 1452681827, "creation_date": 1452681516, "answer_id": 34764440, "question_id": 34761184, "link": "https://stackoverflow.com/questions/34761184/uninstalling-an-application-by-its-guid/34764440#34764440", "title": "Uninstalling an application by its GUID", "body": "<p>(This question for the most part has nothing to do with Go.)</p>\n\n<p>A couple of things to note though:</p>\n\n<ol>\n<li><p>Don't call to <code>cmd.exe</code>: it's for running scripts, and you're not running a script but merely calling a program.  So your call becomes</p>\n\n<pre><code> out, err := exec.Command(\"wmic.exe\", \"product\", \"where\",\n      `IdentifyingNumber=\"{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}\"`,\n      \"call\", \"uninstall\").Output()\n</code></pre>\n\n<p>(Notice the usage of the backquotes to make a \"raw\" string&mdash;this helps preventing \"backslashity\".</p></li>\n<li><p>You don't grab the standard error stream of the program you're running.</p>\n\n<p>Consider using the <code>CombinedOutput()</code> of the <code>exec.Cmd</code> type.</p>\n\n<p>One another point: unless your Go program is of \"GUI\" subsystem (that is, not intended to run in a console window) it's typically more sensible to just let the spawned program output whatever it outputs to the same media as its host process.  To do this, you just connect its standard streams to those of your process:</p>\n\n<pre><code>cmd := exec.Command(\"foo.exe\", ...)\ncmd.Stdin = os.Stdin\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\nerr := cmd.Run()\n</code></pre></li>\n<li><p>You don't need <code>wmic</code> either&mdash;just call out to <code>msiexec</code> directly:</p>\n\n<pre><code>msiexec.exe /uninstall {GUID}\n</code></pre>\n\n<p>The reason is that <code>wmic</code> would end up calling <code>msiexec</code> anyway because there's no other way to uninstall a Windows application other than calling its uninstaller.</p></li>\n</ol>\n"}], "owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 34764440, "answer_count": 1, "score": 0, "last_activity_date": 1452681827, "creation_date": 1452671828, "last_edit_date": 1452681580, "question_id": 34761184, "link": "https://stackoverflow.com/questions/34761184/uninstalling-an-application-by-its-guid", "title": "Uninstalling an application by its GUID", "body": "<p>Hi I tried to uninstall a product using a GUID, it worked fine when I directly executed it in command prompt however, I get an error message when I try to execute it using Golang</p>\n\n<p>My Code:</p>\n\n<pre><code>// Powershell_Command\npackage main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    out, err := exec.Command(\"cmd\",\"/C\",\"wmic\",\"product\",\"where\",\"IdentifyingNumber=\\\"{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}\\\"\",\"call\",\"uninstall\").Output()\n    fmt.Println(\"err::\",err)\n    fmt.Println(\"out::\",string(out))\n}\n</code></pre>\n\n<p>the output is:</p>\n\n<blockquote>\n  <p>err:: exit status 2147749911</p>\n  \n  <p>out::</p>\n</blockquote>\n\n<p>Thanks in Advance</p>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1452671695, "post_id": 34761129, "comment_id": 57267321, "body": "If you&#39;re only doing <code>map[int]map[int] ... map[int]type</code> why are you using a map? This would be better handled by <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\"><code>slices</code></a> <code>[][] .. []type</code>"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1452671850, "post_id": 34761129, "comment_id": 57267384, "body": "Slices not a good idea, because keys undefined. And only Maps give &quot;not a fatal error&quot; when try to access to undefined key."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1452672786, "post_id": 34761129, "comment_id": 57267893, "body": "Out of curiosity what are you doing with this?"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1452673858, "post_id": 34761129, "comment_id": 57268553, "body": "Yes, I show in the example of words: I have two words: &quot;help&quot; and &quot;hello&quot;, I can get a one map is <code>m[h][e][l][p] = true</code> and other map <code>m[h][e][l][l][o] = true</code>. If I try to another key, such as <code>map[h][e]</code> the result must be false, not a fatal error. )"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 1, "creation_date": 1452672789, "post_id": 34761371, "comment_id": 57267897, "body": "It&#39;s my mistake, sorry... Hierarchical is <b>important!</b>."}], "tags": [], "owner": {"reputation": 4376, "user_id": 959140, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/66Jhu.png?s=128&g=1", "display_name": "Robin Andersson", "link": "https://stackoverflow.com/users/959140/robin-andersson"}, "is_accepted": false, "score": 0, "last_activity_date": 1452672577, "creation_date": 1452672577, "answer_id": 34761371, "question_id": 34761129, "link": "https://stackoverflow.com/questions/34761129/golang-how-to-create-unknown-dynamic-map-length/34761371#34761371", "title": "Golang: How to create unknown (dynamic) Map length", "body": "<p>If you don't need the hierarchical map structure and just want to use keys with variable length one approach could be to simply use strings as keys and one single map.</p>\n\n<pre><code>m := make(map[string]bool)\nk := fmt.Sprintf(\"%v_%v_%v\", 1, 2, 3)\n\nm[k] = true\n\nfmt.Println(m[k])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452675919, "post_id": 34762165, "comment_id": 57269842, "body": "Ok, and what about solutions based on a structs? Any idea? Thanks!"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452676254, "post_id": 34762165, "comment_id": 57270037, "body": "That <i>was</i> the idea. Maybe I do not understand your last question?"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452676777, "post_id": 34762165, "comment_id": 57270414, "body": "I can&#39;t did redesign.. All logic based on map, or, probably I can modify to structs (like Btree), but I don&#39;t know how to do this... And I ask you: do you have any idea based on struct (*Tree) solution? Important things: 1. Create/Get any depth element. 2. If element doesn&#39;t exists would return False (not a access error). Thanks."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452679751, "post_id": 34762165, "comment_id": 57272574, "body": "I admit have no idea how to answer this question. Of course you <b>will</b> have to redesign as Go&#39;s map type cannot do what you need to do. And yes, this redesign probably will boil down to some kind of tree-like data structure (but hey, which problem in CS doesn&#39;t?). And yes, your code should not panic but return false. So what exactly is the question?"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452683785, "post_id": 34762165, "comment_id": 57275434, "body": "So sorry, probably I very bad speak in English and very bad know &quot;Go&quot; to be correctly ask. Below I got answer. Sorry again."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1452675265, "creation_date": 1452675265, "answer_id": 34762165, "question_id": 34761129, "link": "https://stackoverflow.com/questions/34761129/golang-how-to-create-unknown-dynamic-map-length/34762165#34762165", "title": "Golang: How to create unknown (dynamic) Map length", "body": "<p>You cannot do this as this sort of type is not representable in Go's type system.</p>\n\n<p>You will have to redesign.</p>\n\n<p>E.g. a type <code>arbitrarilyKeyedMap</code>with a method <code>lookup(vals ...int) bool</code>.\nProbably you'll need methods for setting and deletion too.</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452675828, "post_id": 34762210, "comment_id": 57269788, "body": "Thank you very much! Try to understand your idea. )"}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452675937, "post_id": 34762210, "comment_id": 57269852, "body": "I don&#39;t know if it is perfectly working or if I added a bunch of stuff I didn&#39;t need, I wrote this really quickly. I think it is fairly ugly code for the record. I also don&#39;t expect it to have that good of performance."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452676084, "post_id": 34762210, "comment_id": 57269937, "body": "About performance don&#39;t panic :) In the real mode it will be 40-50 iteration on every run... I try to use (concat) your code with my :)"}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452682174, "post_id": 34762210, "comment_id": 57274315, "body": "I gave a much more sane implementation. Still no guarantees, but should get you started"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452683332, "post_id": 34762210, "comment_id": 57275111, "body": "Yeah ) Big Thanks! It&#39;s more useful solution! Of course, not directly ready with my code, but solution is GOOD, Really Good!"}], "tags": [], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "is_accepted": true, "score": 1, "last_activity_date": 1452682140, "last_edit_date": 1452682140, "creation_date": 1452675377, "answer_id": 34762210, "question_id": 34761129, "link": "https://stackoverflow.com/questions/34761129/golang-how-to-create-unknown-dynamic-map-length/34762210#34762210", "title": "Golang: How to create unknown (dynamic) Map length", "body": "<p>Ok I had some fun playing with this a bit. Here is a much better implementation than what I did before:</p>\n\n<pre><code>type mymap map[int]*myentry\n\ntype myentry struct {\n    m mymap\n    b bool\n}\n\nfunc (mm mymap) get(idx ...int) *myentry {\n    if len(idx) == 0 {\n        return nil\n    }\n    entry, ok := mm[idx[0]]\n    if !ok {\n        return nil\n    } else if len(idx) == 1 {\n        return entry\n    }\n    for i := 1; i &lt; len(idx); i++ {\n        if entry == nil || entry.m == nil {\n            return nil\n        }\n        entry = entry.m[idx[i]]\n    }\n    return entry\n}\n\nfunc (mm mymap) setbool(v bool, idx ...int) {\n    if len(idx) == 0 {\n        return\n    }\n    if mm[idx[0]] == nil {\n        mm[idx[0]] = &amp;myentry{m: make(mymap), b: false}\n    } else if mm[idx[0]].m == nil {\n        mm[idx[0]].m = make(mymap)\n    }\n    if len(idx) == 1 {\n        mm[idx[0]].b = v\n        return\n    }\n    entry := mm[idx[0]]\n    for i := 1; i &lt; len(idx); i++ {\n        if entry.m == nil {\n            entry.m = make(mymap)\n            entry.m[idx[i]] = &amp;myentry{m: make(mymap), b: false}\n        } else if entry.m[idx[i]] == nil {\n            entry.m[idx[i]] = &amp;myentry{m: make(mymap), b: false}\n        }\n        entry = entry.m[idx[i]]\n    }\n    entry.b = v\n}\n\nfunc (m mymap) getbool(idx ...int) bool {\n    if val := m.get(idx...); val != nil {\n        return val.b\n    }\n    return false\n}\n\nfunc (m mymap) getmap(idx ...int) mymap {\n    if val := m.get(idx...); val != nil {\n        return val.m\n    }\n    return nil\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/bwBEVKeBar\" rel=\"nofollow\">Playground link</a></p>\n\n<p>Something like that ought to get you started</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452768926, "post_id": 34783702, "comment_id": 57319004, "body": "WOW! Thank you very much! Extended explain helps me to understand Map. #3 (recursive type definition) is absolutely fantastic method. I didn&#39;t knew about recursive definition. #3 most identical with my algorithm. Thank you very much again!"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1452769937, "post_id": 34783702, "comment_id": 57319635, "body": "Sorry, I can&#39;t click +1 (not enough &quot;mana&quot;), but if my idea will have commercial success I will find you and will make a present! ;)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1494787648, "last_edit_date": 1494787648, "creation_date": 1452755877, "answer_id": 34783702, "question_id": 34761129, "link": "https://stackoverflow.com/questions/34761129/golang-how-to-create-unknown-dynamic-map-length/34783702#34783702", "title": "Golang: How to create unknown (dynamic) Map length", "body": "<p>The <a href=\"https://golang.org/ref/spec#Map_types\" rel=\"nofollow noreferrer\">map type</a>:</p>\n\n<blockquote>\n  <p>A map is an unordered group of elements of one type, called the element type, indexed by a set of unique keys of another type, called the key type.</p>\n</blockquote>\n\n<p>A map type must have a specific value type and a specific key type. What you want does not qualify for this: you want a map where the value is <em>sometimes</em> another map (of the same type), and <em>sometimes</em> it's a <code>bool</code>.</p>\n\n<p>Your options:</p>\n\n<h3>1. With a wrapper value type</h3>\n\n<p>The idea here is to not use just a simple (<code>bool</code>) value type, but a wrapper which holds both of your potential values: both a <code>map</code> and the simple value (<code>bool</code>):</p>\n\n<pre><code>type Value struct {\n    Children MapType\n    V        bool\n}\n\ntype MapType map[int]*Value\n\nvar m MapType\n</code></pre>\n\n<p>This is basically what user3591723 suggested, so I won't detail it further.</p>\n\n<h3>2. With a tree</h3>\n\n<p>This is a variant of #1, but this way we clearly communicate it's a tree.</p>\n\n<p>The cleanest way to implement your hierarchical structure would be to use a tree, where a node could look like this:</p>\n\n<pre><code>type KeyType int\ntype ValueType string\n\ntype Node struct {\n    Children map[KeyType]*Node\n    Value    ValueType\n}\n</code></pre>\n\n<p>This has the advantage that you may choose the value type (which is <code>bool</code> in your case, but you can change it to whatever type - I used <code>string</code> for presentation).</p>\n\n<p>For easily build / manage your tree, we can add some methods to our <code>Node</code> type:</p>\n\n<pre><code>func (n *Node) Add(key KeyType, v ValueType) {\n    if n.Children == nil {\n        n.Children = map[KeyType]*Node{}\n    }\n    n.Children[key] = &amp;Node{Value: v}\n}\n\nfunc (n *Node) Get(keys ...KeyType) *Node {\n    for _, key := range keys {\n        n = n.Children[key]\n    }\n    return n\n}\n\nfunc (n *Node) Set(v ValueType, keys ...KeyType) {\n    n = n.Get(keys...)\n    n.Value = v\n}\n</code></pre>\n\n<p>And using it: 1. build a tree, 2. query some values, 3. change a value:</p>\n\n<pre><code>root := &amp;Node{Value: \"root\"}\nroot.Add(0, \"first\")\nroot.Get(0).Add(9, \"second\")\nroot.Get(0, 9).Add(3, \"third\")\nroot.Get(0).Add(4, \"fourth\")\n\nfmt.Println(root)\nfmt.Println(root.Get(0, 9, 3))\nfmt.Println(root.Get(0, 4))\n\nroot.Set(\"fourthMod\", 0, 4)\nfmt.Println(root.Get(0, 4))\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/2wVN_N-_q1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{map[0:0x104382f0] root}\n&amp;{map[] third}\n&amp;{map[] fourth}\n&amp;{map[] fourthMod}\n</code></pre>\n\n<h3>3. With a recursive type definition</h3>\n\n<p>It may be surprising but it is possible to define a <code>map</code> type in Go which has unlimited or dynamic \"depth\", using a recursive definition:</p>\n\n<pre><code>type X map[int]X\n</code></pre>\n\n<p>It is what it says: it's a <code>map</code> with <code>int</code> keys, and values of the same type as the map itself.</p>\n\n<p>The big downside of this recursive type is that it can't store any \"useful\" data in the value type. It can only store the \"fact\" whether a value is present which is identical to a <code>bool</code>-like information (<code>bool</code> type: <code>true</code> or <code>false</code>), which may be enough in rare cases, but not in most.</p>\n\n<p>Let's see an example building a \"tree\":</p>\n\n<pre><code>var x X\nx = map[int]X{}\nx[0] = map[int]X{}\nx[0][9] = map[int]X{}\nx[0][9][3] = map[int]X{}\nx[0][4] = map[int]X{}\nfmt.Println(x)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>map[0:map[9:map[3:map[]] 4:map[]]]\n</code></pre>\n\n<p>If we want to test if there is a \"value\" based on a series of keys, we have 2 options: either use the special <code>v, ok := m[i]</code> indexing (which reports if a value for the specified key exists), or test if the value is not <code>nil</code>, e.g. <code>m[i] != nil</code>.</p>\n\n<p>Let's see some examples testing the above built map:</p>\n\n<pre><code>var ok bool\n_, ok = x[0][9][3]\nfmt.Println(\"x[0][9][3] exists:\", ok, \"; alternative way:\", x[0][9][3] != nil)\n_, ok = x[0][9][4]\nfmt.Println(\"x[0][9][4] exists:\", ok, \"; alternative way:\", x[0][9][4] != nil)\n_, ok = x[0][4]\nfmt.Println(\"x[0][4] exists:\", ok, \"; alternative way:\", x[0][4] != nil)\n_, ok = x[0][4][9][9][9]\nfmt.Println(\"x[0][4][9][9][9] exists:\", ok, \"; alternative way:\", x[0][4][9][9][9] != nil)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>x[0][9][3] exists: true ; alternative way: true\nx[0][9][4] exists: false ; alternative way: false\nx[0][4] exists: true ; alternative way: true\nx[0][4][9][9][9] exists: false ; alternative way: false\n</code></pre>\n\n<p>Try these on the <a href=\"http://play.golang.org/p/qzHfuZDLar\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Note:</strong> Even though <code>x[0][4]</code> is the last \"leaf\", indexing further like <code>x[0][4][9][9][9]</code> will not cause a panic as a <code>nil</code> map can be indexed and yields the zero value of the value type (which is <code>nil</code> in case the value type is a map type).</p>\n"}], "owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5814, "favorite_count": 0, "accepted_answer_id": 34762210, "answer_count": 4, "score": 2, "last_activity_date": 1494787648, "creation_date": 1452671554, "last_edit_date": 1452759309, "question_id": 34761129, "link": "https://stackoverflow.com/questions/34761129/golang-how-to-create-unknown-dynamic-map-length", "title": "Golang: How to create unknown (dynamic) Map length", "body": "<p>I can create a \"static\" map via</p>\n\n<pre><code>type m map[int]map[int]map[int]bool\n</code></pre>\n\n<p>but the length of \"keys\" will be dynamic:</p>\n\n<pre><code> |---unknown len--|\nm[1][2][3][4][2][0] = true\n</code></pre>\n\n<p>or </p>\n\n<pre><code>|---unk len--|\nm[1][2][3][4] = true\n</code></pre>\n\n<p>How I can create this map in Go? Or any way exists?</p>\n\n<p>Added: Hierarchical is <strong>IMPORTANT</strong></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["pointers", "struct", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1452671217, "post_id": 34760950, "comment_id": 57267093, "body": "Most likely because you operate on a <i>copy</i> and not on the slice element. How do you create <code>user_ptr</code>?"}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1452671249, "post_id": 34760950, "comment_id": 57267104, "body": "Can you please <code>gofmt</code> and show your actual code, ie where <code>user_ptr</code> comes from?"}, {"owner": {"reputation": 227, "user_id": 4045078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/375906045c619617cf26aa3378b6ac62?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis S", "link": "https://stackoverflow.com/users/4045078/dennis-s"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1452671833, "post_id": 34760950, "comment_id": 57267377, "body": "@icza Updated, please see edit at the end of question"}, {"owner": {"reputation": 227, "user_id": 4045078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/375906045c619617cf26aa3378b6ac62?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis S", "link": "https://stackoverflow.com/users/4045078/dennis-s"}, "reply_to_user": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1452671891, "post_id": 34760950, "comment_id": 57267400, "body": "@user3591723, question updated with relevant piece"}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1452672098, "post_id": 34760950, "comment_id": 57267508, "body": "@DensiTensy you haven&#39;t added enough relevant information and still no <code>gofmt</code>. Just show your entire <code>dataHandler</code> function as it is actually written in your code. This can&#39;t possibly be it; there would be compile errors everywhere."}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 4045078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/375906045c619617cf26aa3378b6ac62?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis S", "link": "https://stackoverflow.com/users/4045078/dennis-s"}, "edited": false, "score": 0, "creation_date": 1452673276, "post_id": 34761287, "comment_id": 57268182, "body": "Many thanks, I&#39;d never guessed this <i>range</i> behavior differences"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1489468479, "last_edit_date": 1489468479, "creation_date": 1452672256, "answer_id": 34761287, "question_id": 34760950, "link": "https://stackoverflow.com/questions/34760950/assigned-pointer-field-becomes-nil/34761287#34761287", "title": "Assigned pointer field becomes &lt;nil&gt;", "body": "<p>This is because you operate on a <em>copy</em> and not on the slice element itself.</p>\n\n<p>In your <code>haveUserId()</code> function the <code>for ... range</code> makes a copy of the elements it loops over, and you return the address of this copy. And so later you will modify this copy which is independent from the value in the slice. So if later you check the address in the slice element, it will still be unchanged (<code>nil</code>).</p>\n\n<p>Possible fix: return the address of the slice element: <code>&amp;h.users[i]</code></p>\n\n<pre><code>func (h *Hall) haveUserId(id string) (bool, *user) {\n    for i := range h.users {\n        if h.users[i].Id == id {\n            fmt.Println(\"UID found\")\n            return true, &amp;h.users[i]\n        }\n    }\n    return false, nil\n}\n</code></pre>\n\n<p>To demonstrate this, see this example:</p>\n\n<pre><code>type Point struct{ x, y int }\nps := []Point{{1, 2}, {3, 4}}\nfmt.Println(ps) // Output: [{1 2} {3 4}]\n\nfor _, v := range ps {\n    v.x += 10 // Modifies just the copy\n}\nfmt.Println(ps) // Output (unchanged): [{1 2} {3 4}]\n\nfor i := range ps {\n    ps[i].x += 10 // Modifies value in slice\n}\nfmt.Println(ps) // Output (changed): [{11 2} {13 4}]\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/4B54nwVPA9\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 227, "user_id": 4045078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/375906045c619617cf26aa3378b6ac62?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis S", "link": "https://stackoverflow.com/users/4045078/dennis-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 1, "accepted_answer_id": 34761287, "answer_count": 1, "score": 2, "last_activity_date": 1489468479, "creation_date": 1452670857, "last_edit_date": 1452674026, "question_id": 34760950, "link": "https://stackoverflow.com/questions/34760950/assigned-pointer-field-becomes-nil", "title": "Assigned pointer field becomes &lt;nil&gt;", "body": "<p>I have a struct:</p>\n\n<pre><code>type user struct {\nId string\n..\ndata_ptr *userData\n}\n</code></pre>\n\n<p>And I store slice of users in global scope:</p>\n\n<pre><code>type Hall struct {\n    users []user\n}\n\nvar hall = Hall{}    //global\n</code></pre>\n\n<p>Finally, http handler:</p>\n\n<pre><code>func dataHandler(response http.ResponseWriter, request *http.Request) {\n    userExist, user_ptr := hall.haveUserId()    //works fine\n    switch requestType {\n    case \"load\":    \n        user_ptr.loadData()   //data loaded and user_ptr.data_ptr is set\n    case \"newData\":\n        user_ptr.data_ptr = newData  // &lt;-- this is it, now previously set data_ptr == nil\n</code></pre>\n\n<p>So, why the heck, I mean I send \"load\" request, it loads data, sets <code>data_ptr</code> for <code>user_ptr</code>. But on next call, \"newData\" request, <code>user_ptr.data_ptr</code> is <code>nil</code>?</p>\n\n<p>Just in case, here is <code>loadData()</code>:</p>\n\n<pre><code>func (p *user) loadData(userId) {\n    ..\n    data := userData {}\n    p.data_ptr = &amp;data\n}\n</code></pre>\n\n<p><strong>EDIT:</strong> where <code>user_ptr</code> comes from:</p>\n\n<pre><code>func (h *Hall) haveUserId(id string) (bool, *user) {\n    for _, u := range h.users {\n        if u.Id == id {\n            fmt.Println(\"UID found\")\n            return true, &amp;u\n        }\n    }\n    return false, nil\n}\n</code></pre>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": false, "score": 1, "last_activity_date": 1452669249, "creation_date": 1452669249, "answer_id": 34760499, "question_id": 34760364, "link": "https://stackoverflow.com/questions/34760364/how-to-send-and-receive-values-to-from-the-channel-within-the-same-loop/34760499#34760499", "title": "How to send and receive values to/from the channel within the same loop?", "body": "<p>You use unbuffered channel, so your goroutine hang on <code>c &lt;- num</code><br>\nYou should use buffered channel, like this: <code>c := make(chan int, 1)</code></p>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/RC5zab-4m5\" rel=\"nofollow\"><kbd>Go playground</kbd></a></p>\n"}, {"tags": [], "owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "is_accepted": false, "score": 2, "last_activity_date": 1452669281, "creation_date": 1452669281, "answer_id": 34760509, "question_id": 34760364, "link": "https://stackoverflow.com/questions/34760364/how-to-send-and-receive-values-to-from-the-channel-within-the-same-loop/34760509#34760509", "title": "How to send and receive values to/from the channel within the same loop?", "body": "<p>You create an unbuffered channel <code>c</code> with</p>\n\n<pre><code>c := make(chan int)\n</code></pre>\n\n<p>On unbuffered channels, operations are symmentrical, i.e. every send on a channel needs exactly one receive, every receive needs exactly one send. You send your <code>i</code> into the channel, the goroutine receives it into <code>num</code>. After that, the goroutine sends the incremented <code>num</code> into the channel, but nobody is there to receive it.</p>\n\n<p>In short: The statement</p>\n\n<pre><code>c &lt;- num\n</code></pre>\n\n<p>will block.</p>\n\n<p>You could use a 1-buffered channel, that should work.</p>\n\n<p>There is another problem with your code that you solved by waiting ten seconds in <code>main</code>: You don't know when your goroutine finishes. Typically, a <code>sync.WaitGroup</code> is used in these situations. <em>But</em>: Your goroutine does not finish. It's idiomatic to introduce a <code>chan struct{}</code> that you close in your main goroutine after a while and <code>select</code> over both channels in the worker goroutine.</p>\n"}, {"comments": [{"owner": {"reputation": 555, "user_id": 5058168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2VxPP.png?s=128&g=1", "display_name": "RhinoLarva", "link": "https://stackoverflow.com/users/5058168/rhinolarva"}, "edited": false, "score": 0, "creation_date": 1452670053, "post_id": 34760618, "comment_id": 57266450, "body": "Thank you for the detailed explanation."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1452670567, "post_id": 34760618, "comment_id": 57266732, "body": "Note that your last <code>main()</code> function returns after starting the 2nd goroutine, and thus the program may exit immediately (it does not wait for non-<code>main</code> goroutines to complete). It may be <code>pump()</code> and <code>receive()</code> will not even be called."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 5, "last_activity_date": 1452671346, "last_edit_date": 1452671346, "creation_date": 1452669685, "answer_id": 34760618, "question_id": 34760364, "link": "https://stackoverflow.com/questions/34760364/how-to-send-and-receive-values-to-from-the-channel-within-the-same-loop/34760618#34760618", "title": "How to send and receive values to/from the channel within the same loop?", "body": "<p>By default the goroutine communication is <code>synchronous</code> and <code>unbuffered</code>: sends do not complete until there is a receiver to accept the value. There must be a receiver ready to receive data from the channel and then the sender can hand it over directly to the receiver. </p>\n\n<p>So channel send/receive operations block until the other side is ready:</p>\n\n<p><strong>1.</strong> A send operation on a channel blocks until a receiver is available for the same channel: if there\u2019s no recipient for the value on <code>ch</code>, no other value can be put in the channel. And the other way around: no new value can be sent in <code>ch</code> when the channel is not empty! So the send operation will wait until <code>ch</code> becomes available again.</p>\n\n<p><strong>2.</strong> A receive operation for a channel blocks until a sender is available for the same channel: if there is no value in the channel, the receiver blocks.</p>\n\n<p>This is illustrated in the below example:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {\n    ch1 := make(chan int)\n    go pump(ch1) // pump hangs\n    fmt.Println(&lt;-ch1) // prints only 0\n}\n\nfunc pump(ch chan int) {\n    for i:= 0; ; i++ {\n        ch &lt;- i\n    }\n}\n</code></pre>\n\n<p>Because there is no receiver the goroutine hangs and print only the first number.</p>\n\n<p>To workaround this we need to define a new goroutine which reads from the channel in an infinite loop.</p>\n\n<pre><code>func receive(ch chan int) {\n    for {\n        fmt.Println(&lt;- ch)\n    }\n}\n</code></pre>\n\n<p>Then in <code>main()</code>:</p>\n\n<pre><code>func main() {\n    ch := make(chan int)\n    go pump(ch)\n    go receive(ch)\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/IHWFPEWxEP\" rel=\"nofollow\">Go Playground</a></kbd></p>\n"}], "owner": {"reputation": 555, "user_id": 5058168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2VxPP.png?s=128&g=1", "display_name": "RhinoLarva", "link": "https://stackoverflow.com/users/5058168/rhinolarva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1684, "favorite_count": 0, "accepted_answer_id": 34760618, "answer_count": 3, "score": 0, "last_activity_date": 1452671346, "creation_date": 1452668743, "question_id": 34760364, "link": "https://stackoverflow.com/questions/34760364/how-to-send-and-receive-values-to-from-the-channel-within-the-same-loop", "title": "How to send and receive values to/from the channel within the same loop?", "body": "<p>Here is an example:</p>\n\n<pre><code>func main() {\n    c := make(chan int)\n    i := 0\n\n    go goroutine(c)\n\n    c &lt;- i\n    time.Sleep(10 * time.Second)\n\n}\n\nfunc goroutine(c chan int) {\n    for {\n        num := &lt;- c\n        fmt.Println(num)\n        num++\n        time.Sleep(1 * time.Second)\n        c &lt;- num\n    }\n}\n</code></pre>\n\n<p>What I'm trying to do inside of goroutine is to receive number from channel, print it, increment and after one second send it back to the channel. After this I want to repeat the action.</p>\n\n<p>But as a result, operation is only done once.</p>\n\n<p>Output:</p>\n\n<pre><code>0\n</code></pre>\n\n<p>Am I doing something wrong?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 0, "creation_date": 1452655466, "post_id": 34757799, "comment_id": 57261334, "body": "Nice :D See I knew I had to ask this first on stackoverflow before I start doing this myself and cram 100 fields into one line haha"}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 0, "creation_date": 1452655894, "post_id": 34757799, "comment_id": 57261412, "body": "Ps I added a bonus question if you are interested :)"}, {"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "reply_to_user": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 1, "creation_date": 1452693043, "post_id": 34757799, "comment_id": 57281601, "body": "To accomplish your bonus question it becomes a bit more complex but simply take a look at how how the <code>json</code> package does the tags check (e.g using reflection to get the tag fields). Or check out an example of what you&#39;re trying to accomplish... <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx</a>"}], "tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": true, "score": 1, "last_activity_date": 1452654881, "creation_date": 1452654881, "answer_id": 34757799, "question_id": 34757726, "link": "https://stackoverflow.com/questions/34757726/insert-into-mytable-name-age/34757799#34757799", "title": "INSERT INTO MyTable (name, age, ...)", "body": "<p>There are different ways to do this, one of the ways I've done is create arrays of keys and values which you can then use to iterate and build up your query with placeholders.</p>\n\n<p>You would then use variadic arguments to fill the placeholders.</p>\n\n<p>It would look something like this</p>\n\n<pre><code>keys := []string{\"your\", \"keys\", ...}\nvalues := []interface{}{1, \"two\", ...}\nplaceholders := make([]string, len(values))\nfor idx := range values {\n    placeholders[idx] = \"?\"\n}\nquery := fmt.Sprintf(\"INSERT INTO (%s) VALUES (%s)\", strings.Join(keys, \", \"), strings.Join(placeholders, \", \"))\n\nresult, err := db.Exec(query, values...)\n</code></pre>\n\n<p>This playground shows something similar done with <code>fmt.Printf</code></p>\n\n<p><a href=\"http://play.golang.org/p/NruF92EJqM\" rel=\"nofollow\">http://play.golang.org/p/NruF92EJqM</a></p>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 34757799, "answer_count": 1, "score": 0, "last_activity_date": 1452656370, "creation_date": 1452654333, "last_edit_date": 1452656370, "question_id": 34757726, "link": "https://stackoverflow.com/questions/34757726/insert-into-mytable-name-age", "title": "INSERT INTO MyTable (name, age, ...)", "body": "<p>How can I structure this using the go <a href=\"https://github.com/golang/go/wiki/SQLInterface#executing-queries\" rel=\"nofollow\">standard</a> sql package so others can read it?\nI need to add many many fields. </p>\n\n<pre><code>result, err := db.Exec(\n    \"INSERT INTO MyTable (name, age, ...ALLLOOOT...) VALUES ($1, $2, ...ALLLOOOT...)\",\n    \"gopher\",\n    27,\n    ...ALLLOOOT...\n)\n</code></pre>\n\n<p>EDIT: Bonus question, can you use something like this and extract field names from <code>db:\"...\"</code>?</p>\n\n<pre><code>type MyTable struct {\n    Age   int64   `db:\"age\" json:\"age\"`\n    Name  string  `db:\"name\" json:\"name\"`\n    ....\n}\n</code></pre>\n"}, {"tags": ["go", "deadlock", "goroutine"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1452648065, "post_id": 34756537, "comment_id": 57259479, "body": "I could be wrong ... but, you&#39;re closing them before the waitgroup <code>Wait()</code> call. This means that by the time the scheduler is running your goroutines they&#39;ll be closed and your <code>Done()</code> calls on the wait group can never run."}], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "is_accepted": true, "score": 3, "last_activity_date": 1452654210, "creation_date": 1452654210, "answer_id": 34757709, "question_id": 34756537, "link": "https://stackoverflow.com/questions/34756537/go-deadlock-all-goroutines-asleep/34757709#34757709", "title": "Go deadlock all goroutines asleep", "body": "<p>You're not really paying attention to your pipeline design here. You have to ask yourself \"When is section X done? What should happen when it is done? What happens after it is done?\" for every section of the pipeline.</p>\n\n<p>You start up <code>head</code>, <code>tail</code>, and <code>worker</code> to range over channels. The only way these functions are going to return successfully is if these channels are closed.</p>\n\n<p>Draw it out of you need to.</p>\n\n<ol>\n<li><code>head(in)</code> feeds in to <code>in</code> </li>\n<li><code>worker(out, in, &amp;wg)</code> ranges over <code>in</code>, feeds into <code>out</code>, and tells you it is done with <code>wg</code> once <code>in</code> is closed </li>\n<li><code>tail(out)</code> ranges over <code>out</code></li>\n</ol>\n\n<p>So what do you need to do to:</p>\n\n<ol>\n<li>Make sure all input is processed?</li>\n<li>Make sure all goroutines return?</li>\n</ol>\n\n<p>Like so:</p>\n\n<ol>\n<li>You need to close <code>in</code> from <code>head</code> once it is done processing all of the files. </li>\n<li>This will cause <code>worker</code> to actually return once all items it can get from <code>in</code> are processed, causing <code>wg.Wait()</code> to return</li>\n<li>it is now safe to close <code>out</code> since nothing is feeding in to it and this will cause <code>tail</code> to eventually return. </li>\n</ol>\n\n<p>But you'll probably need another <code>sync.WaitGroup</code> associated with <code>tail</code> for this particular design because the whole program will exit right when <code>wg.Wait()</code> returns, thus possibly not finishing all of the work that <code>tail</code> is doing. <a href=\"https://golang.org/ref/spec#Program_execution\" rel=\"nofollow\">See here</a>. Specifically:</p>\n\n<blockquote>\n  <p>Program execution begins by initializing the main package and then\n  invoking the function main. When that function invocation returns, the\n  program exits. It does not wait for other (non-main) goroutines to\n  complete.</p>\n</blockquote>\n\n<p>You'll probably also want to use buffered channels <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"nofollow\">referenced here</a> to aid in not having switch execution between goroutines so much. With your current design you're wasting a lot of time with context switching.</p>\n"}], "owner": {"reputation": 161, "user_id": 2784831, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7185139c911df0481bd379b60aeee4c?s=128&d=identicon&r=PG&f=1", "display_name": "tvishwa107", "link": "https://stackoverflow.com/users/2784831/tvishwa107"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 34757709, "answer_count": 1, "score": -3, "last_activity_date": 1452654210, "creation_date": 1452646030, "question_id": 34756537, "link": "https://stackoverflow.com/questions/34756537/go-deadlock-all-goroutines-asleep", "title": "Go deadlock all goroutines asleep", "body": "<p>This is a follow up to my earlier post: </p>\n\n<pre><code>    http://stackoverflow.com/questions/34736825/goroutine-exit-status-2-what-does-it-mean-why-is-it-happening?noredirect=1#comment57238789_34736825\n</code></pre>\n\n<p>I'm still having trouble figuring out where the channels should be closed, after reading multiple topics and articles both on and off SO. </p>\n\n<p>This program will open a list of files, create an output file for each input file (with the same name),visit all the urls in each input file and get all href links from these - which are saved to the corresponding output file. \nHowever, I'm getting the following error:</p>\n\n<pre><code>    http://play.golang.org/p/8X-1rM3aXC\n</code></pre>\n\n<p>The linkgetter, and getHref functions are mainly for processing. Head and tail are run as separate goroutines, and worker does the processing.</p>\n\n<pre><code>    package main\n\n    import (\n    \"bufio\"\n    \"bytes\"\n    \"fmt\"\n    \"golang.org/x/net/html\"\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"path/filepath\"\n    \"regexp\"\n    \"sync\"\n    )\n\n    type Work struct {\n    Link     string\n    Filename string\n    }\n\n    type Output struct {\n    Href     string\n    Filename string\n    }\n\n    func getHref(t html.Token) (href string, ok bool) {\n    // Iterate over all of the Token's attributes until we find an    \"href\"\n    for _, a := range t.Attr {\n            if a.Key == \"href\" {\n                    href = a.Val\n                    ok = true\n            }\n    }\n    return\n    }\n\n    func linkGetter(out chan&lt;- Output, r io.Reader, filename string) {\n    z := html.NewTokenizer(r)\n    for {\n            tt := z.Next()\n            switch {\n            case tt == html.ErrorToken:\n                    return\n            case tt == html.StartTagToken:\n                    t := z.Token()\n                    isAnchor := t.Data == \"a\"\n                    if !isAnchor {\n                            continue\n                    }\n\n                    // Extract the href value, if there is one\n                    url, ok := getHref(t)\n                    if !ok {\n                            continue\n                    }\n\n                    out &lt;- Output{url, filename}\n            }\n    }\n    }\n\n    func worker(out chan&lt;- Output, in &lt;-chan Work, wg *sync.WaitGroup)    {\n    defer wg.Done()\n    for work := range in {\n            resp, err := http.Get(work.Link)\n            if err != nil {\n                    continue\n            }\n            body, err := ioutil.ReadAll(resp.Body)\n            if err != nil {\n                    continue\n            }\n            if err = resp.Body.Close(); err != nil {\n                    fmt.Println(err)\n            }\n            linkGetter(out, bytes.NewReader(body), work.Filename)\n    }\n    }\n\n    func head(c chan&lt;- Work) {\n    r, _ := regexp.Compile(\"(.*)(?:.json)\")\n    files, _ := filepath.Glob(\"*.json\")\n\n    for _, elem := range files {\n            res := r.FindStringSubmatch(elem)\n            for k, v := range res {\n\n                    if k == 0 {\n                            outpath, _ :=  filepath.Abs(fmt.Sprintf(\"go_tester/%s\", v))\n\n                            abspath, _ := filepath.Abs(fmt.Sprintf(\"url_links/%s\", v))\n                            f, _ := os.Open(abspath)\n                            scanner := bufio.NewScanner(f)\n\n                            for scanner.Scan() {\n                                    c &lt;- Work{outpath, scanner.Text()}\n                            }\n\n                    }\n            }\n\n    }\n\n\n    }\n\n    func tail(c &lt;-chan Output) {\n    currentfile := \"\"\n    var f *os.File\n    var err error\n    for out := range c {\n            if out.Filename != currentfile {\n                    if err = f.Close(); err != nil { // might cause an error on first run\n                            fmt.Println(err)\n                    }\n                    f, err = os.OpenFile(out.Filename, os.O_APPEND|os.O_WRONLY, 0600)\n                    if err != nil {\n                            log.Fatal(err)\n                    }\n                    currentfile = out.Filename\n            }\n            if _, err = f.WriteString(out.Href + \"\\n\"); err != nil {\n                    fmt.Println(err)\n            }\n    }\n\n    }\n\n    const (\n    nworkers = 80\n    )\n\n    func main() {\n    //fmt.Println(\"hi\")\n    in := make(chan Work)\n    out := make(chan Output)\n\n    go head(in)\n    go tail(out)\n\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 85; i++ {\n            wg.Add(1)\n            go worker(out, in, &amp;wg)\n    }\n    close(in)   \n    close(out)    \n    wg.Wait()\n\n\n    }\n</code></pre>\n\n<p>What is wrong with the way the channels are closed?</p>\n"}, {"tags": ["go", "runtime", "bootstrapping"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1452645005, "post_id": 34756262, "comment_id": 57258685, "body": "This question might be useful: <a href=\"http://stackoverflow.com/q/193560/142162\">Writing a compiler in its own language</a>"}, {"owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1452645538, "post_id": 34756262, "comment_id": 57258835, "body": "@TimCooper - Thanks, that is useful. It seems that writing a compiler for a language in that language is possible because, once bootstrapped, a compiler is able to compile itself. However, it does not seem possible to me that a runtime can support itself: for example, can a garbage collector collect its own garbage?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1452646506, "post_id": 34756262, "comment_id": 57259068, "body": "Why is it hard to understand that a language can use libraries (and frameworks) written in that same language (and compiled by that same compiler)? And why would it <i>not</i> be able to do it&#39;s own garbage collection just like anything else using that language?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1452648897, "post_id": 34756262, "comment_id": 57259718, "body": "don&#39;t think of go&#39;s runtime like Ruby or Java&#39;s.  Go&#39;s runtime is really just a library linked in to your native app that does stuff like GC, manage network I/O, etc...   vs say, Java who&#39;s runtime can&#39;t be written in java due to java lacking native compilation."}], "answers": [{"tags": [], "owner": {"reputation": 436, "user_id": 5511980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0174993a67ce7b3ad2bcb2f12e135661?s=128&d=identicon&r=PG&f=1", "display_name": "W. Cybriwsky", "link": "https://stackoverflow.com/users/5511980/w-cybriwsky"}, "is_accepted": true, "score": 4, "last_activity_date": 1452659573, "creation_date": 1452659573, "answer_id": 34758468, "question_id": 34756262, "link": "https://stackoverflow.com/questions/34756262/how-is-it-possible-for-the-go-runtime-to-be-written-in-go/34758468#34758468", "title": "How is it possible for the Go runtime to be written in Go?", "body": "<p>In short: carefully.</p>\n\n<p>In long: The unsafe package lets you do pointer arithmetic and arbitrary casts,  which you need to implement go's gc. You avoid using the gc in the gc go code just like you do in normal go code: by using stack- or static-allocated data. The link below mentions that the mainline go compiler enforces this in the runtime via an undocumented option. Some assembly bits let you make syscalls, which lets you do everything from spawning processes to opening files.</p>\n\n<p>In longer and more authoritativer: see <a href=\"https://groups.google.com/forum/#!searchin/golang-nuts/runtime$20no$20allocation$20comment/golang-nuts/uIC5APWVXjQ/CxMolj82WSAJ%20Ian%20Lance%20Taylor%20(of%20the%20go%20team)&#39;s%20post%20on%20golang-nuts\" rel=\"nofollow\">Ian Lance Taylor (of the go team)'s post on golang-nuts</a>.</p>\n"}], "owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 1, "accepted_answer_id": 34758468, "answer_count": 1, "score": 2, "last_activity_date": 1452659573, "creation_date": 1452644178, "last_edit_date": 1452646123, "question_id": 34756262, "link": "https://stackoverflow.com/questions/34756262/how-is-it-possible-for-the-go-runtime-to-be-written-in-go", "title": "How is it possible for the Go runtime to be written in Go?", "body": "<p>I <a href=\"https://golang.org/doc/go1.4\" rel=\"nofollow\">read</a> that from Go 1.4, the Go runtime is written in Go itself (rather than in C).</p>\n\n<p>How is this possible? If Go programs run on top of the runtime, and the runtime is a Go program, does the runtime run on top of itself?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452635505, "post_id": 34754210, "comment_id": 57255003, "body": "Go doesn&#39;t define &quot;nil methods&quot; (there&#39;s isn&#39;t such a thing). You&#39;re calling a method on a nil interface. It works exactly the same as if you embed a pointer."}], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 4, "last_activity_date": 1452636026, "last_edit_date": 1452636026, "creation_date": 1452635719, "answer_id": 34754495, "question_id": 34754210, "link": "https://stackoverflow.com/questions/34754210/why-does-embedding-an-interface-in-a-struct-cause-the-interface-methodset-to-be/34754495#34754495", "title": "Why does embedding an Interface in a struct cause the Interface methodset to be defined as nil pointer?", "body": "<p>You're wrong about the <code>nil</code> method, it's the <code>interface</code> embedded into the <code>struct Bar</code> that is <code>nil</code>.\nWhen you use the methods of the interface, that is this interface that is called. The trick allow you to override an interface method with our own.</p>\n\n<p>To understand the usage and goals of embedding <code>interfaces</code> into <code>struct</code>, the best example is in the <code>sort</code> package:</p>\n\n<pre><code>type reverse struct {\n    // This embedded Interface permits Reverse to use the methods of\n    // another Interface implementation.\n    Interface\n}\n\n// Less returns the opposite of the embedded implementation's Less method.\nfunc (r reverse) Less(i, j int) bool {\n    return r.Interface.Less(j, i)\n}\n\n// Reverse returns the reverse order for data.\nfunc Reverse(data Interface) Interface {\n    return &amp;reverse{data}\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4611978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bae9c5e6962b85de89c894099158583?s=128&d=identicon&r=PG&f=1", "display_name": "mcquackers", "link": "https://stackoverflow.com/users/4611978/mcquackers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 1, "accepted_answer_id": 34754495, "answer_count": 1, "score": 2, "last_activity_date": 1452636026, "creation_date": 1452634526, "question_id": 34754210, "link": "https://stackoverflow.com/questions/34754210/why-does-embedding-an-interface-in-a-struct-cause-the-interface-methodset-to-be", "title": "Why does embedding an Interface in a struct cause the Interface methodset to be defined as nil pointer?", "body": "<p>I'm working through learning Go, and I've come across embedding Interfaces into structs in Go.</p>\n\n<p>I understand the joys of Interfaces and their implementations, but I'm confused as the reasoning for the current execution of embedding one inside a struct.</p>\n\n<p>When I embed an interface in a struct, the struct gains the methodset of the Interface and can now be used as a value of an Interface type variable, eg:</p>\n\n<pre><code>type Foo interface {\n  SetBaz(baz) \n  GetBaz() baz\n}\n\ntype Bar struct {\n  Foo\n}\n</code></pre>\n\n<p>So now we have a struct type <code>Bar</code> which embeds <code>Foo</code>.  Because <code>Bar</code> embeds <code>Foo</code>, <code>Bar</code> now satisfies any receivers or arguments that require type <code>Foo</code>, even though <code>Bar</code> hasn't even defined them.</p>\n\n<p>Trying to call <code>Bar.GetBaz()</code> causes the runtime error: <code>panic: runtime error: invalid memory address or nil pointer dereference</code>.</p>\n\n<p>Why does Go define nil methods on a struct that embeds an interface instead of explicitly requiring those methods to be defined through the compiler?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 597, "user_id": 515320, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/56bb98d5e22200a138bbcbf68047cb6f?s=128&d=identicon&r=PG", "display_name": "Andy Haskell", "link": "https://stackoverflow.com/users/515320/andy-haskell"}, "is_accepted": true, "score": 0, "last_activity_date": 1452630914, "creation_date": 1452630914, "answer_id": 34753280, "question_id": 34751121, "link": "https://stackoverflow.com/questions/34751121/invalid-request-error-in-pull-taskqueues/34753280#34753280", "title": "INVALID_REQUEST error in pull taskqueues", "body": "<p>Nvm in my real code I was leasing 2000 tasks but the max I can lease is actually 1000.</p>\n"}], "owner": {"reputation": 597, "user_id": 515320, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/56bb98d5e22200a138bbcbf68047cb6f?s=128&d=identicon&r=PG", "display_name": "Andy Haskell", "link": "https://stackoverflow.com/users/515320/andy-haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 34753280, "answer_count": 1, "score": 4, "last_activity_date": 1452630914, "creation_date": 1452622981, "question_id": 34751121, "link": "https://stackoverflow.com/questions/34751121/invalid-request-error-in-pull-taskqueues", "title": "INVALID_REQUEST error in pull taskqueues", "body": "<p>I'm using a pull queue in Appengine for Go and while locally leasing tasks worked just fine, when I deployed my code, the call to taskqueue.Lease gave me this error:</p>\n\n<p><code>API error 13 (taskqueue: INVALID_REQUEST)</code></p>\n\n<p>My lease call was:</p>\n\n<p><code>tasks, err := taskqueue.Lease(ctx, 100, \"pullqueue\", 60)</code></p>\n\n<p>And it has happened no matter what parameters I pass in, like parameters for a blank queue name. Has anyone else gotten this error? Thanks in advance for the help!</p>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1452622646, "post_id": 34750679, "comment_id": 57247791, "body": "That&#39;s what garbage collection does. If you can&#39;t reference the memory, it can be reclaimed by the GC."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 2, "creation_date": 1452671415, "post_id": 34750679, "comment_id": 57267192, "body": "It might be useful to read up on some stuff in the <a href=\"https://golang.org/pkg/runtime/\" rel=\"nofollow noreferrer\">runtime</a> if you&#39;re interested in this (the <code>GODEBUG</code> environmental variable as well can be helpful). <code>pprof</code> is also really useful."}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 0, "last_activity_date": 1452692478, "creation_date": 1452692478, "answer_id": 34768235, "question_id": 34750679, "link": "https://stackoverflow.com/questions/34750679/how-does-gc-behave-when-a-pointer-to-struct-is-replaced/34768235#34768235", "title": "how does GC behave when a pointer to struct is replaced", "body": "<p>The memory will be reclaimed by the garbage collector.</p>\n\n<p>If you want to replace the struct you can do it this way:</p>\n\n<pre><code>func main() {\n    myType := &amp;MyType{...}\n    //...\n    *myType = MyType{...}\n}\n</code></pre>\n\n<p>The difference will probably be negligible though.</p>\n"}], "owner": {"reputation": 15792, "user_id": 816721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8444cf72fac7e9065e0c68d70246a36d?s=128&d=identicon&r=PG", "display_name": "rkmax", "link": "https://stackoverflow.com/users/816721/rkmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452692478, "creation_date": 1452621504, "last_edit_date": 1452660643, "question_id": 34750679, "link": "https://stackoverflow.com/questions/34750679/how-does-gc-behave-when-a-pointer-to-struct-is-replaced", "title": "how does GC behave when a pointer to struct is replaced", "body": "<p>I'm learning Go and I'm reading examples from libraries. I found that some examples are using:</p>\n\n<pre><code>type MyType struct {\n  Code string\n  //...\n}\n\n\nfunc main() {\n  myType := &amp;MyType{...}\n  //...\n  myType = &amp;MyType{...}\n}\n</code></pre>\n\n<p>Basically they are reusing variables. I understand that <code>&amp;MyType{..}</code> returns a pointer, later I can replace that pointer. What happens with the previous pointed memory. Will the GC reclaim that memory or will I waste that memory. Maybe this is a silly question and I'm concerned for nothing but I'm trying to learn Go to build performance APIs :)</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452620555, "post_id": 34750323, "comment_id": 57246510, "body": "Two goroutines (not threads) concurrently modifying anything is a data race, and there are no benign data races. Always check your concurrent coded with the race detector."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1452629208, "post_id": 34750323, "comment_id": 57251684, "body": "I think the best way to use this is to use channels to modify the string. Have a goroutine listening on the channel for the change you want to do to the string, and where you are currently modifying the string just write the change you want to the channel."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1452637814, "post_id": 34750323, "comment_id": 57256164, "body": "@Topo: no, that&#39;s not the &quot;best way&quot;. There are often very good reasons to use mutexes or atomic operations."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452648153, "post_id": 34750323, "comment_id": 57259504, "body": "@JimB I know there are good reasons for using mutexes, my comment wasn&#39;t on the best way to do something like this, but on this specific example."}], "answers": [{"comments": [{"owner": {"reputation": 3215, "user_id": 1574959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa0d5afe9854289a5c4724e724eb74c3?s=128&d=identicon&r=PG", "display_name": "Phil Frost", "link": "https://stackoverflow.com/users/1574959/phil-frost"}, "edited": false, "score": 0, "creation_date": 1601494945, "post_id": 34750346, "comment_id": 113429478, "body": "You didn&#39;t quote the next sentence: &quot;If you must read the rest of this document to understand the behavior of your program, you are being too clever.&quot; The quoted section isn&#39;t describing the memory model, but suggesting the reader not be clever rather than rely on the details of the memory model. Is there anything in the document that actually says variable assignment is or is not atomic? If not, you haven&#39;t actually answered the question."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3215, "user_id": 1574959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa0d5afe9854289a5c4724e724eb74c3?s=128&d=identicon&r=PG", "display_name": "Phil Frost", "link": "https://stackoverflow.com/users/1574959/phil-frost"}, "edited": false, "score": 0, "creation_date": 1604418006, "post_id": 34750346, "comment_id": 114338383, "body": "Assignment is not atomic, which is implied by the first sentence in the quoted documentation, and reinforced through the document as the conditions on observability are described. If that is unsatisfactory, I suggest you raise an issue with the go project for clarification in the documentation."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 14, "last_activity_date": 1452623228, "last_edit_date": 1452623228, "creation_date": 1452620424, "answer_id": 34750346, "question_id": 34750323, "link": "https://stackoverflow.com/questions/34750323/is-variable-assignment-atomic-in-go/34750346#34750346", "title": "Is variable assignment atomic in go?", "body": "<p>No. If you need atomic operations, there is <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"noreferrer\"><code>sync/atomic</code></a>.</p>\n\n<p>The <a href=\"https://golang.org/ref/mem\" rel=\"noreferrer\">Go Memory Model</a> will have all the related details. From the top of the Memory Model document:</p>\n\n<blockquote>\n  <p>Programs that modify data being simultaneously accessed by multiple\n  goroutines must serialize such access.</p>\n  \n  <p>To serialize access, protect the data with channel operations or other\n  synchronization primitives such as those in the <code>sync</code> and <code>sync/atomic</code>\n  packages.</p>\n</blockquote>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3268, "favorite_count": 0, "accepted_answer_id": 34750346, "answer_count": 1, "score": 9, "last_activity_date": 1452623228, "creation_date": 1452620355, "question_id": 34750323, "link": "https://stackoverflow.com/questions/34750323/is-variable-assignment-atomic-in-go", "title": "Is variable assignment atomic in go?", "body": "<p>If I have two threads concurrently modifying a string field on a struct, will I always see one or the other string assigned to the field, but nothing else?</p>\n"}, {"tags": ["go", "google-drive-api"], "comments": [{"owner": {"reputation": 2412, "user_id": 4044241, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cjm4iO9thmU/AAAAAAAAAAI/AAAAAAAAEJo/h1OhN37GfQQ/photo.jpg?sz=128", "display_name": "Gerardo", "link": "https://stackoverflow.com/users/4044241/gerardo"}, "edited": false, "score": 0, "creation_date": 1452644523, "post_id": 34749158, "comment_id": 57258552, "body": "I&#39;m not sure about the parent reference, but for Drive v3, the method is called &#39;create&#39; instead of insert: <a href=\"https://developers.google.com/drive/v3/reference/files/create\" rel=\"nofollow noreferrer\">developers.google.com/drive/v3/reference/files/create</a>"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 320691, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9dd7ff2100671b78c6884dc5695ff888?s=128&d=identicon&r=PG", "display_name": "user320691", "link": "https://stackoverflow.com/users/320691/user320691"}, "edited": false, "score": 0, "creation_date": 1453087617, "post_id": 34830165, "comment_id": 57433910, "body": "You are right.  I should go to the source more and I do with community driven open source code but, for projects backed by a commercial entity like Google, I expect top notch, up-to-date documentation.  Your suggestion worked almost verbatim.  The d in do() should be capitalized.  Thank you Jeff."}], "tags": [], "owner": {"reputation": 1525, "user_id": 2119660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae09f6f1f1e7eabb4438fcde4ddef8b?s=128&d=identicon&r=PG", "display_name": "Jeff Sisson", "link": "https://stackoverflow.com/users/2119660/jeff-sisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1452966668, "creation_date": 1452966668, "answer_id": 34830165, "question_id": 34749158, "link": "https://stackoverflow.com/questions/34749158/file-uploads-in-version-3-of-the-google-drive-sdk/34830165#34830165", "title": "File uploads in Version 3 of the Google Drive SDK", "body": "<p>It's worth perusing the Google API go source code <a href=\"https://github.com/google/google-api-go-client/blob/master/drive/\" rel=\"nofollow\">here</a>. You can see how <code>ParentReference</code> <a href=\"https://github.com/google/google-api-go-client/blob/master/drive/v2/drive-gen.go#L1714\" rel=\"nofollow\">exists in the v2 API code</a> but <a href=\"https://github.com/google/google-api-go-client/blob/master/drive/v3/drive-gen.go\" rel=\"nofollow\">does not exist in v3</a>. The API appears to have changed significantly from v2 to v3.</p>\n\n<p>Extrapolating from these changes, here's a sketch of what the v3 equivalent for uploading a file might look like:</p>\n\n<pre><code>import \"google.golang.org/api/drive/v3\"\nfunc InsertFile(d *drive.Service, title string, description string, mimeType string, filename string) (*drive.File, error) {\n    f := &amp;drive.File{Name: filename, Description: description, MimeType: mimeType}\n    return d.Files.Create(f).do()\n}\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 320691, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9dd7ff2100671b78c6884dc5695ff888?s=128&d=identicon&r=PG", "display_name": "user320691", "link": "https://stackoverflow.com/users/320691/user320691"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 34830165, "answer_count": 1, "score": 0, "last_activity_date": 1452966668, "creation_date": 1452616954, "question_id": 34749158, "link": "https://stackoverflow.com/questions/34749158/file-uploads-in-version-3-of-the-google-drive-sdk", "title": "File uploads in Version 3 of the Google Drive SDK", "body": "<p>I have some code that is based on the following Golang example at <a href=\"https://developers.google.com/drive/v2/reference/files/insert\" rel=\"nofollow\">https://developers.google.com/drive/v2/reference/files/insert</a>.</p>\n\n<pre><code>// InsertFile creates a new file in Drive from the given file and details\nfunc InsertFile(d *drive.Service, title string, description string,\nparentId string, mimeType string, filename string) (*drive.File, error) {\n             .\n             .\n             . \n  f := &amp;drive.File{Title: title, Description: description, MimeType: mimeType}\n  if parentId != \"\" {\n    p := &amp;drive.ParentReference{Id: parentId}\n    f.Parents = []*drive.ParentReference{p}\n  }\n  r, err := d.Files.Insert(f).Media(m).Do()\n  if err != nil {\n    fmt.Printf(\"An error occurred: %v\\n\", err)\n    return nil, err\n  }\n  return r, nil\n}\n</code></pre>\n\n<p>When I switch to version 3, the errors below are thrown.</p>\n\n<pre><code>./main.go:125: unknown drive.File field 'Title' in struct literal\n./main.go:127: undefined: drive.ParentReference\n./main.go:128: undefined: drive.ParentReference\n./main.go:131: service.Files.Insert undefined (type *drive.FilesService has no field or method Insert)\n</code></pre>\n\n<p>I know that Title should be changed to Name in the first error but I'm not sure what replaced drive.ParentReference or service.Files.Insert in Version 3 of the SDK and I haven't been able to find anything equivalent to the link above in the V3 docs.</p>\n"}, {"tags": ["ssl", "go", "apache2", "reverse-proxy", "sni"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "edited": false, "score": 0, "creation_date": 1452672782, "post_id": 34746261, "comment_id": 57267890, "body": "Thank you for your good idea and solution. You&#39;re right I didn&#39;t thought about that. But I Have a problem with that. First of all my req.Header doesn&#39;t had a Host field at all. I added the x-forwarded host manually. But setting only the Host-Header didn&#39;t solved it, i got the same error. So I tried to Set req.Host directly. Then the Apache Error is solved, but my site doesn&#39;t load anything else, i think my php on apache have then a error. I think there is then a problem with the request because i changed the host?"}, {"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "edited": false, "score": 0, "creation_date": 1452675668, "post_id": 34746261, "comment_id": 57269679, "body": "So I think it solved the Problem. But you have to use req.Host = mainServer because the request header will not used think it belongs to that issue here :  \t Think have something to do with that: <a href=\"http://github.com/golang/go/issues/7682\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/7682</a> The Problem i mentioned in the comment before is my AngularJS because of insecure ressource loading because my reverseproxy runs on a different ip than my angularjs. <a href=\"https://docs.angularjs.org/error/$sce/insecurl\" rel=\"nofollow noreferrer\">docs.angularjs.org/error/$sce/insecurl</a> Tank you @helmbert. You made my day :)"}, {"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "reply_to_user": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "edited": false, "score": 0, "creation_date": 1452676423, "post_id": 34746261, "comment_id": 57270149, "body": "Happy to help. I&#39;ve also updated my answer to reflect the <code>req.Host = mainServer</code> change."}, {"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "edited": false, "score": 0, "creation_date": 1452682176, "post_id": 34746261, "comment_id": 57274316, "body": "Think had another Problem, i didn&#39;t get any new Requests on my ReverseProxy when i change req.Host. Perhaps because the Host to send response or new requests is wrong now? I don&#39;t now. I mean the apache problem is solved but now my reverseProxy doesn&#39;t work how he should. He serves my website from apache but he doesn&#39;t get a new request, when the user do something on it."}, {"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "reply_to_user": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "edited": false, "score": 0, "creation_date": 1452682491, "post_id": 34746261, "comment_id": 57274515, "body": "Might be worth a new question, if it&#39;s a different issue. Maybe <a href=\"http://stackoverflow.com/questions/34724160/go-http-send-incoming-http-request-to-an-other-server-using-client-do\">this question</a> will also help you."}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 4, "last_activity_date": 1452676387, "last_edit_date": 1592644375, "creation_date": 1452608835, "answer_id": 34746261, "question_id": 34745654, "link": "https://stackoverflow.com/questions/34745654/golang-reverseproxy-with-apache2-sni-hostname-error/34746261#34746261", "title": "Golang ReverseProxy with Apache2 SNI/Hostname error", "body": "<h3>Short example</h3>\n<p>Say you're starting an HTTP request to <code>https://your-proxy.local</code>. Your request handler takes the <code>http.Request</code> struct and rewrites its <code>URL</code> field to <code>https://your-apache-backend.local</code>.</p>\n<p>What you have not considered, is that the original HTTP request also contained a <code>Host</code> header (<code>Host: your-proxy.local</code>). When passing that same request to <code>http://your-apache-backend.local</code>, the <code>Host</code> header in that request still says <code>Host: your-proxy.local</code>. And that's what Apache is complaining about.</p>\n<h3>Explanation</h3>\n<p>As you're using TLS with Server Name Indication (SNI), the request hostname will not only be used for DNS resolution, but also to select the SSL certificate that should be used to establish the TLS connection. The HTTP 1.1 <code>Host</code> header on the other hand is used to distinguish several virtual hosts by Apache. Both names <strong>must match</strong>. This issue is also mentioned in the <a href=\"https://wiki.apache.org/httpd/NameBasedSSLVHostsWithSNI\" rel=\"nofollow noreferrer\">Apache HTTPD wiki</a>:</p>\n<blockquote>\n<p><strong>SNI/Request hostname mismatch, or SNI provides hostname and request doesn't.</strong></p>\n<p>This is a browser bug. Apache will reject the request with a 400-type error.</p>\n</blockquote>\n<h3>Solution</h3>\n<p>Also rewrite the <code>Host</code> header. If you want to preserve the original <code>Host</code> header, you can store it in an <code>X-Forwarded-Host</code> header (that's a non-standard header, but it's widely used in reverse proxies):</p>\n<pre><code>func (p *Proxy) directorApache(req *http.Request) {\n    mainServer := fmt.Sprintf(&quot;%s:%d&quot;, Config.HostMain, Config.PortMain)\n    req.URL.Scheme = &quot;https&quot;\n    req.URL.Host = mainServer\n    req.Header.Set(&quot;X-Forwarded-Host&quot;, req.Header().Get(&quot;Host&quot;))\n    req.Host = mainServer\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1527, "favorite_count": 0, "accepted_answer_id": 34746261, "answer_count": 1, "score": 1, "last_activity_date": 1452676387, "creation_date": 1452607109, "last_edit_date": 1452609307, "question_id": 34745654, "link": "https://stackoverflow.com/questions/34745654/golang-reverseproxy-with-apache2-sni-hostname-error", "title": "Golang ReverseProxy with Apache2 SNI/Hostname error", "body": "<p>i am writing my own ReverseProxy in Go.The ReverseProxy should connect my go-webserver and my apache2 webserver. But when I run my reverseproxy on another IP-Adress then my Apache2 webserver I got following error in my apache-logfile, when the reverseproxy sends the request to apache.</p>\n\n<pre><code>\"Hosname xxxx provided via sni and hostname xxxx2 provided via http are different\"\n</code></pre>\n\n<p>My Reverse Proxy and apache-webserver running on https.</p>\n\n<p>Here some code:</p>\n\n<pre><code>func (p *Proxy) directorApache(req *http.Request) {\n    mainServer := fmt.Sprintf(\"%s:%d\", Config.HostMain, Config.PortMain)\n    req.URL.Scheme = \"https\"\n    req.URL.Host = mainServer\n}\n\nfunc (p *Proxy) directorGo(req *http.Request) {\n    goServer := fmt.Sprintf(\"%s:%d\", Config.GoHost, Config.GoPort)\n    req.URL.Scheme = \"http\"\n    req.URL.Host = goServer\n}\n\n\nfunc (p *Proxy) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    fmt.Println(req.URL.Path)\n    if p.isGoRequest(req) {\n        fmt.Println(\"GO\")\n        p.goProxy.ServeHTTP(rw, req)\n        return\n    }\n    p.httpProxy.ServeHTTP(rw, req)\n}\nfunc main() {\n\n    var configPath = flag.String(\"conf\", \"./configReverse.json\", \"Path to the Json config file.\")\n\n    flag.Parse()\n    proxy := New(*configPath)\n    cert, err := tls.LoadX509KeyPair(Config.PathCert, Config.PathPrivateKey)\n    if err != nil {\n        log.Fatalf(\"server: loadkeys: %s\", err)\n    }\n    config := tls.Config{InsecureSkipVerify: true, Certificates: []tls.Certificate{cert}}\n\n    listener, err := net.Listen(\"tcp\",\n    net.JoinHostPort(proxy.Host, strconv.Itoa(proxy.Port)))\n    if err != nil {\n        log.Fatalf(\"server: listen: %s\", err)\n    }\n    log.Printf(\"server: listening on %s\")\n    proxy.listener = tls.NewListener(listener, &amp;config)\n\n    serverHTTPS := &amp;http.Server{\n        Handler:   proxy.mux,\n        TLSConfig: &amp;config,\n    }\n\n    if err := serverHTTPS.Serve(proxy.listener); err != nil {\n        log.Fatal(\"SERVER ERROR:\", err)\n    }\n}\n</code></pre>\n\n<p>Perhaps someone has a idea about that issue.</p>\n"}, {"tags": ["command-line", "go"], "comments": [{"owner": {"reputation": 1239, "user_id": 854951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/301fd62e0d28d0cec2b520267572eaf6?s=128&d=identicon&r=PG", "display_name": "Patrick Wolf", "link": "https://stackoverflow.com/users/854951/patrick-wolf"}, "edited": false, "score": 0, "creation_date": 1452604852, "post_id": 34744648, "comment_id": 57235010, "body": "What happens when you put the absolute path to vim?"}, {"owner": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "reply_to_user": {"reputation": 1239, "user_id": 854951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/301fd62e0d28d0cec2b520267572eaf6?s=128&d=identicon&r=PG", "display_name": "Patrick Wolf", "link": "https://stackoverflow.com/users/854951/patrick-wolf"}, "edited": false, "score": 0, "creation_date": 1452604996, "post_id": 34744648, "comment_id": 57235128, "body": "Just nothing changes."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1452608976, "post_id": 34745168, "comment_id": 57238142, "body": "To be more precise, Vim, being a full-screen text editor expects at least its standard input and output streams to be connected to a device having capabilities of a terminal.  That is, if you&#39;d run your program which spawns Vim with its stdin/strout redirected to <code>&#47;dev&#47;null</code> vim would seize to work in exactly the same way. So the key reason Vim failed to work is that it can only sensibly work on a terminal."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1452609171, "post_id": 34745168, "comment_id": 57238291, "body": "To make my comment complete, sometimes one might need to run a program wich expects to be connected to a terminal device in an unattended way (one example is running something asking for a password interactively, such as a stock OpenSSH client). For this, pseudo terminal subsystem might be used, via a package such as <a href=\"https://github.com/kr/pty\" rel=\"nofollow noreferrer\"><code>github.com&#47;kr&#47;pty</code></a>. JFTR, terminal emulators, like <code>xterm</code>, and terminal multiplexers such as <code>screen</code> and <code>tmux</code> use PTYs to run their client programs."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 7, "last_activity_date": 1452605786, "creation_date": 1452605786, "answer_id": 34745168, "question_id": 34744648, "link": "https://stackoverflow.com/questions/34744648/can-not-call-vim-within-go-code/34745168#34745168", "title": "Can not call `vim` within go code", "body": "<p>In order for vim to render its interface, you need to attach the standard input/output streams to the process:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"os\"\n        \"os/exec\"\n)\n\nfunc main() {\n        cmd := exec.Command(\"vim\", \"a.txt\")\n        cmd.Stdin = os.Stdin\n        cmd.Stdout = os.Stdout\n        cmd.Stderr = os.Stderr\n        err := cmd.Run()\n        if err != nil {\n                fmt.Println(err)\n        }\n        os.Exit(0)\n}\n</code></pre>\n\n<p>Not attaching the streams is similar to running the following command from your shell:</p>\n\n<pre><code>vim &lt; /dev/null &gt; /dev/null 2&gt; /dev/null\n</code></pre>\n"}], "owner": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "accepted_answer_id": 34745168, "answer_count": 1, "score": 2, "last_activity_date": 1452605786, "creation_date": 1452604318, "question_id": 34744648, "link": "https://stackoverflow.com/questions/34744648/can-not-call-vim-within-go-code", "title": "Can not call `vim` within go code", "body": "<p>I try to call <code>vim</code> within go program, which code similar to this:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"os\"\n        \"os/exec\"\n)\n\nfunc main() {\n        err := exec.Command(\"vim\", \"a.txt\").Run()\n        if err != nil {\n                fmt.Println(err)\n        }\n        os.Exit(0)\n}\n</code></pre>\n\n<p>I ran <code>go run mycode.go</code> then got:</p>\n\n<pre><code>exit status 1\n</code></pre>\n\n<p>I have tried several ways to succeed this e.g. replace <code>Run()</code> by <code>Start()</code>, <code>Output()</code>, <code>...</code>, but it seems not work. Finally, What I try to do is I try to call <code>vim</code> and stop my current go program. I just want to see <code>vim</code> appear, that's all.</p>\n"}, {"tags": ["apache", "go", "proxy", "reverse-proxy", "mod-proxy"], "comments": [{"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 0, "creation_date": 1452589202, "post_id": 34738551, "comment_id": 57224293, "body": "Just a quick thought, but isn&#39;t <b>not closing the connection</b> exactly what the <code>keepalive=on</code> flag in your proxy configuration is supposed to be doing?"}, {"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "reply_to_user": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 0, "creation_date": 1452590633, "post_id": 34738551, "comment_id": 57225166, "body": "that flag prevents the firewall from dropping the connection when the connection is inactive. So i tried your idea and removed the flag, but i have the same problem."}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1452591044, "post_id": 34738551, "comment_id": 57225435, "body": "maybe apache uses a pool of connections to your go server?"}, {"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "edited": false, "score": 0, "creation_date": 1452591509, "post_id": 34738551, "comment_id": 57225756, "body": "How do i know, if apache uses a pool?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1452617195, "post_id": 34738551, "comment_id": 57244182, "body": "@user2715821, Error log level &quot;debug&quot; dumps these gory details (such as initializing workers, selecting them etc) into the log sink associated with your virtual host / whatever."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1452607064, "creation_date": 1452607064, "answer_id": 34745641, "question_id": 34738551, "link": "https://stackoverflow.com/questions/34738551/golang-doesnt-recognize-close-notifier/34745641#34745641", "title": "Golang doesn&#39;t recognize Close-Notifier", "body": "<p>The Apache server isn't going to close the connection when the client disconnects. It's much more efficient for it to reuse the connection for as long as possible. </p>\n\n<p>If you <em>really</em> want the reverse proxy to reconnect every time (beware you may run into performance or port allocation issues), you can force <code>mod_proxy</code> to use HTTP/1.0 or explicitly close the connections every time with either of:</p>\n\n<pre><code>SetEnv force-proxy-request-1.0 1\nSetEnv proxy-nokeepalive 1\n</code></pre>\n\n<p><a href=\"https://httpd.apache.org/docs/2.4/mod/mod_proxy.html#envsettings\" rel=\"nofollow\">https://httpd.apache.org/docs/2.4/mod/mod_proxy.html#envsettings</a></p>\n"}], "owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452607064, "creation_date": 1452586603, "question_id": 34738551, "link": "https://stackoverflow.com/questions/34738551/golang-doesnt-recognize-close-notifier", "title": "Golang doesn&#39;t recognize Close-Notifier", "body": "<p>when I use Apache mod_proxy to forward my go-requests to my golang-webserver, my go-server doesn't recognize when client disconnects. I am using the close notifier: </p>\n\n<pre><code>notify := rw.(http.CloseNotifier).CloseNotify()\ngo func() {\n        &lt;-notify\n        brk.closingClients &lt;- cl.session.Value\n}\n</code></pre>\n\n<p>When I use firewall sitepath rooting it doesn't work either.\nBut when I use my own golang reverse proxy it works verry well without any problems.\nWith my apache mod_proxy the client receives the notify after some more real data sended to the go webserver.</p>\n\n<p>Perhaps somebody have a idea how can i solve my problem, that i recognize when clients disconnect directly, so without receiving any more data.</p>\n\n<p>Here my mod_proxy configs</p>\n\n<pre><code>     SSLProxyEngine On\n    ProxyRequests On\n    SSLProxyVerify none\n    SSLProxyCheckPeerCN off\n    SSLProxyCheckPeerName off\n    ProxyPass /event https://xxx.xxx.xxx.xxx:8888/event flushpackets=on  keepalive=on\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1452583269, "post_id": 34737124, "comment_id": 57221247, "body": "not to answer the big design problem, but you can implement a interface with struct other than struct pointer. meaning turn <code>func (c *CoolType) Select(vars ...string) error</code> to <code>func (c CoolType) Select(vars ...string) error</code>, to make sure not change the struct content in some method."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1452583453, "post_id": 34737124, "comment_id": 57221336, "body": "Yea I think I could just do that. I was hesitant because the structs can be quite large. I am mostly just interested in other solutions. What do you mean by not to answer the big design problem? Do you see a big glaring flaw in this way to go about this? Sometimes you get so stuck on the first way you wrote something that it is almost impossible to see the obviously better way."}], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1452648282, "post_id": 34745721, "comment_id": 57259538, "body": "Yea I guess that is the way I&#39;m probably going to have to do it. Nice to have other people look at things sometimes"}], "tags": [], "owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "is_accepted": false, "score": 1, "last_activity_date": 1452607239, "creation_date": 1452607239, "answer_id": 34745721, "question_id": 34737124, "link": "https://stackoverflow.com/questions/34737124/creating-handlers-from-an-interface/34745721#34745721", "title": "Creating handlers from an interface", "body": "<p>If you are afraid of mutations pass a copy of the value. To do it you probably have to change your interface to something like:</p>\n\n<pre><code>type Selecter interface {\n    Select(vars ...string) (Selecter, error)\n}\n</code></pre>\n\n<p>And change your Select method to take a value receiver to fulfill the interface. It would be <code>func (c CoolType) Select(vars ...string) (CoolType, error)</code></p>\n\n<p>Then pass your <code>s</code> as a value instead of pointer and call Select like:</p>\n\n<pre><code>if s, err := s.Select(v1, v2); err != nil {\n     //... blah blah errors ...\n}\n</code></pre>\n\n<p>You can argue that you lose information about the type, but you already lost it while passing the value as a Selecter interface.</p>\n\n<p>But in general your implementation is good. My feeling is that in Go elegant is something different than in other languages. I'd say that in Go elegant is readable, maintainable and accurate - not bureaucracy and trying to protect you from yourself.</p>\n"}], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452607239, "creation_date": 1452580972, "question_id": 34737124, "link": "https://stackoverflow.com/questions/34737124/creating-handlers-from-an-interface", "title": "Creating handlers from an interface", "body": "<p>Let's say I have this interface</p>\n\n<pre><code>type Selecter interface {\n    Select(vars ...string) error\n}\n</code></pre>\n\n<p>and I want to make handlers that pretty much just return JSON forms of that interface after it has called the <code>Select</code> function. Like this:</p>\n\n<pre><code>func MakeHandler(s Selecter) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        //... do some stuff to get vars ...\n        if err := s.Select(v1, v2); err != nil {\n            //... blah blah errors ...\n        }\n        b, err := json.Marshal(s)\n        if err != nil {\n            //... blah blah errors ...\n        }\n        w.Write(b)\n    }\n}\n</code></pre>\n\n<p>So if <code>CoolType</code> is a <code>Selecter</code> I can do something like this</p>\n\n<pre><code>type CoolType struct {\n    CoolString string `json:\"cool_string\"`\n    CoolInt int       `json:\"cool_int\"`\n    CoolBool bool     `json:\"cool_bool\"`\n}\n\nfunc (c *CoolType) Select(vars ...string) error {\n    // fill up c using vars\n    return nil\n}\n\n// this looks kinda ugly to me too\nfn := MakeHandler(CoolType{})\n</code></pre>\n\n<p>The underlying problem I have with this is that <code>s</code> is an interface and uses a pointer. This would make this not safe in goroutines since <code>s</code> could be modified between the calls to <code>Select</code> and the call to <code>Marshal</code>. </p>\n\n<p>I really think this is the way I'd like to go about implementing this since it is fairly concise and easy for me to change, but I think I'm missing something. I could use <code>reflect</code> or change the <code>Selecter</code> interface to have <code>Select</code> return an <code>interface{}</code> instead since I don't particularly care what the type is. Then I'd just make a new copy of the type in every implementation of <code>Select</code> I guess. Or a mutex would work. Or perhaps the better way to do this would be to have all of my <code>Selecter</code> types just implement <code>ServeHTTP</code> and be an <code>http.Handler</code>.</p>\n\n<p>Anyway I assume people have tried something like this and have come up with possibly more elegant solutions so I'd like to hear some ideas.</p>\n"}, {"tags": ["logging", "go", "io"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1452557803, "post_id": 34733503, "comment_id": 57213335, "body": "The problem is that you are opening the file with Notepad."}, {"owner": {"reputation": 19, "user_id": 5776244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249505b01f4d10208c5811479b934bdb?s=128&d=identicon&r=PG&f=1", "display_name": "Oyang", "link": "https://stackoverflow.com/users/5776244/oyang"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1452560429, "post_id": 34733503, "comment_id": 57214118, "body": "@Tim-Cooper You&#39;re correct. Thank you for that information. Do you know of a way to make it editor independent, if that is possible?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1452567047, "post_id": 34733503, "comment_id": 57215840, "body": "@Oyang use any editor that knows how to render <code>\\n</code>."}, {"owner": {"reputation": 376, "user_id": 2348705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a37cab3b0733af5c7829aa1d8278b1?s=128&d=identicon&r=PG", "display_name": "Igor Dubinskiy", "link": "https://stackoverflow.com/users/2348705/igor-dubinskiy"}, "edited": false, "score": 0, "creation_date": 1452569155, "post_id": 34733503, "comment_id": 57216385, "body": "Adding <code>\\r</code> at the end of the string should work as well."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 376, "user_id": 2348705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a37cab3b0733af5c7829aa1d8278b1?s=128&d=identicon&r=PG", "display_name": "Igor Dubinskiy", "link": "https://stackoverflow.com/users/2348705/igor-dubinskiy"}, "edited": false, "score": 0, "creation_date": 1452589209, "post_id": 34733503, "comment_id": 57224298, "body": "@IgorDubinskiy Breaking portability..."}, {"owner": {"reputation": 376, "user_id": 2348705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a37cab3b0733af5c7829aa1d8278b1?s=128&d=identicon&r=PG", "display_name": "Igor Dubinskiy", "link": "https://stackoverflow.com/users/2348705/igor-dubinskiy"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1452620786, "post_id": 34733503, "comment_id": 57246672, "body": "@MarkusWMahlberg Sure, but not everyone needs portability. And I think many editors on Unix-like systems essentially ignore <code>\\r</code> much like Notepad ignores <code>\\n</code>."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 376, "user_id": 2348705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a37cab3b0733af5c7829aa1d8278b1?s=128&d=identicon&r=PG", "display_name": "Igor Dubinskiy", "link": "https://stackoverflow.com/users/2348705/igor-dubinskiy"}, "edited": false, "score": 0, "creation_date": 1452641283, "post_id": 34733503, "comment_id": 57257527, "body": "@IgorDubinskiy Not on any of my machines. All of the text editors I use (vim both on Linux and OSX, Textmate) recognize Windows line endings. And I would not go so far to call Notepad an editor - it is more of a text file viewer with very limited modification capabilities. ;)"}, {"owner": {"reputation": 19, "user_id": 5776244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249505b01f4d10208c5811479b934bdb?s=128&d=identicon&r=PG&f=1", "display_name": "Oyang", "link": "https://stackoverflow.com/users/5776244/oyang"}, "reply_to_user": {"reputation": 376, "user_id": 2348705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a37cab3b0733af5c7829aa1d8278b1?s=128&d=identicon&r=PG", "display_name": "Igor Dubinskiy", "link": "https://stackoverflow.com/users/2348705/igor-dubinskiy"}, "edited": false, "score": 0, "creation_date": 1452651531, "post_id": 34733503, "comment_id": 57260458, "body": "I used \\r, it does what I need it to and works fine with the editors we use regularly.   Thank you, @IgorDubinskiy."}], "answers": [{"comments": [{"owner": {"reputation": 376, "user_id": 2348705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a37cab3b0733af5c7829aa1d8278b1?s=128&d=identicon&r=PG", "display_name": "Igor Dubinskiy", "link": "https://stackoverflow.com/users/2348705/igor-dubinskiy"}, "edited": false, "score": 3, "creation_date": 1452620955, "post_id": 34739440, "comment_id": 57246784, "body": "Or something cross-platform like Atom, Sublime Text, or Visual Studio Code."}], "tags": [], "owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1452589775, "creation_date": 1452589775, "answer_id": 34739440, "question_id": 34733503, "link": "https://stackoverflow.com/questions/34733503/appending-line-to-file-with-golang-package-log-not-getting-a-new-line/34739440#34739440", "title": "Appending line to file with Golang Package log, not getting a new line.", "body": "<p>As already mentioned inside the comments, your editor doesn't understand unix-style <a href=\"https://en.wikipedia.org/wiki/Newline#Representations\" rel=\"nofollow\">\"LF\"</a> <code>\\n</code> newlines. <br />\nConsider using Notepad++</p>\n\n<p><a href=\"https://notepad-plus-plus.org/\" rel=\"nofollow\">https://notepad-plus-plus.org/</a></p>\n"}, {"comments": [{"owner": {"reputation": 7988, "user_id": 584947, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5c0e998a5b4fdce4f95cbec31e6dab22?s=128&d=identicon&r=PG", "display_name": "anon58192932", "link": "https://stackoverflow.com/users/584947/anon58192932"}, "edited": false, "score": 1, "creation_date": 1468333589, "post_id": 34757343, "comment_id": 64077834, "body": "This is a really bad idea in general as it is not cross-platform.  Windows expects \\r\\n and unix expects \\n. \\r therefore would not work on *nix platforms. you might develop on windows right now but don&#39;t expect to do that for the rest of your life. building healthy habits early on is a good idea.  You won&#39;t need \\r anywhere expect a windows-based text editor. Any code you execute should look for \\n and any code you write should insert \\n therefore regardless even if you&#39;re on windows the code will execute correctly and be cross-platform compatible."}], "tags": [], "owner": {"reputation": 19, "user_id": 5776244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249505b01f4d10208c5811479b934bdb?s=128&d=identicon&r=PG&f=1", "display_name": "Oyang", "link": "https://stackoverflow.com/users/5776244/oyang"}, "is_accepted": false, "score": -1, "last_activity_date": 1452651670, "creation_date": 1452651670, "answer_id": 34757343, "question_id": 34733503, "link": "https://stackoverflow.com/questions/34733503/appending-line-to-file-with-golang-package-log-not-getting-a-new-line/34757343#34757343", "title": "Appending line to file with Golang Package log, not getting a new line.", "body": "<p>I used \\r for a carriage return. It works fine for all of the editors we use internally.  </p>\n"}], "owner": {"reputation": 19, "user_id": 5776244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249505b01f4d10208c5811479b934bdb?s=128&d=identicon&r=PG&f=1", "display_name": "Oyang", "link": "https://stackoverflow.com/users/5776244/oyang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2317, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1452651670, "creation_date": 1452557762, "question_id": 34733503, "link": "https://stackoverflow.com/questions/34733503/appending-line-to-file-with-golang-package-log-not-getting-a-new-line", "title": "Appending line to file with Golang Package log, not getting a new line.", "body": "<p>I am using the golang package \"log\" when I use log to write to a text file, it does not append a new line of text to the end. It puts everything inline. </p>\n\n<p><a href=\"http://i.stack.imgur.com/5wJQD.png\" rel=\"nofollow\">This is how it looks.</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/5C7cO.png\" rel=\"nofollow\">How I would like it to look. </a></p>\n\n<p>Current Code.</p>\n\n<pre><code>f, err := os.OpenFile(\"D:\\\\temp2\\\\testlogfile.txt\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\nif err != nil {\n    Error.Fatalf(\"error opening file: %v\", err)\n}\ndefer f.Close()\nmulti := io.MultiWriter(os.Stdout, f)\nlog.SetOutput(multi)\nlog.Println(\"testy1\")\nlog.Println(\"testy2\")\n</code></pre>\n\n<p>Does anyone have any ideas? </p>\n"}, {"tags": ["postgresql", "api", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1452555729, "post_id": 34733120, "comment_id": 57212676, "body": "Can you show your main where you set up the routes ect?"}, {"owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1452555920, "post_id": 34733120, "comment_id": 57212741, "body": "I&#39;ve left the full code for you to dissect if you so wish :)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1452557910, "post_id": 34733120, "comment_id": 57213372, "body": "Some debugging tips: Set log output once in main instead of setting it on every call to the handler.  Every call to handleError should be replaced by <code>if err != nil { handleError(err); return }</code>. Log the error returned from the call to the JSON encoder."}, {"owner": {"reputation": 642, "user_id": 5093622, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-Qcnb6Yl0ZdM/AAAAAAAAAAI/AAAAAAAAACg/tTkKtjt6Rjk/photo.jpg?sz=128", "display_name": "LongBeard_Boldy", "link": "https://stackoverflow.com/users/5093622/longbeard-boldy"}, "edited": false, "score": 0, "creation_date": 1452582537, "post_id": 34733120, "comment_id": 57220918, "body": "not familiar with go, if there is no response, that means response thread is crashed or hang. file handling in &quot;func handler&quot; is a call for a disaster if simultaneously 2 ruining requests appear. you should trap any errors in &quot;handler&quot; so that no errors will be raised directly and in case of failure, it cold respond to client with a response."}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1452701140, "post_id": 34758038, "comment_id": 57287699, "body": "If <code>err</code> is an error interface then err.Error() must be a string by definition. It also wouldn&#39;t compile."}], "tags": [], "owner": {"reputation": 104, "user_id": 583485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/801fe213cdb250491b89b962d1fa2876?s=128&d=identicon&r=PG", "display_name": "jpweber", "link": "https://stackoverflow.com/users/583485/jpweber"}, "is_accepted": false, "score": -1, "last_activity_date": 1452656660, "creation_date": 1452656660, "answer_id": 34758038, "question_id": 34733120, "link": "https://stackoverflow.com/questions/34733120/cant-get-go-http-to-return-an-error-no-data-recieved/34758038#34758038", "title": "Can&#39;t get Go http to return an error; &#39;No data recieved&#39;", "body": "<p>When you are using the http.Error function the error message should a string. For simple testing I would suggest take this line </p>\n\n<pre><code>http.Error(w, err.Error(), http.StatusInternalServerError)\n</code></pre>\n\n<p>and change it to something like </p>\n\n<pre><code>http.Error(w,\"there was an error\", http.StatusInternalServerError)\n</code></pre>\n\n<p>and see if that response comes through. If it does its likely that you are trying to pass something that isn't a string in http.Error()</p>\n"}, {"tags": [], "owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "is_accepted": false, "score": 0, "last_activity_date": 1452701475, "last_edit_date": 1452701475, "creation_date": 1452700322, "answer_id": 34771122, "question_id": 34733120, "link": "https://stackoverflow.com/questions/34733120/cant-get-go-http-to-return-an-error-no-data-recieved/34771122#34771122", "title": "Can&#39;t get Go http to return an error; &#39;No data recieved&#39;", "body": "<p>The following appeared to allow me to return JSON Errors:</p>\n\n<pre><code>func handleError(w http.ResponseWriter, err string) {\n    type APIError struct {\n        Error string\n    }\n    re, _ := json.Marshal(APIError{Error: err})\n    io.WriteString(w, string(re))\n}\n</code></pre>\n\n<p>Used like so:</p>\n\n<pre><code>rows, err := db.Query( fmt.Sprintf(\"SELECT %s, ST_AsText(geom) FROM %s WHERE %s = $1\", identifier, table, identifier), feature)\n        if err != nil {\n            handleError(w, err.Error())\n            return\n        }\n</code></pre>\n\n<p>Not suggesting this is the best method, but worked in my case.</p>\n"}], "owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1452701475, "creation_date": 1452555436, "last_edit_date": 1452555883, "question_id": 34733120, "link": "https://stackoverflow.com/questions/34733120/cant-get-go-http-to-return-an-error-no-data-recieved", "title": "Can&#39;t get Go http to return an error; &#39;No data recieved&#39;", "body": "<p>I am doing attempting to build a basic API using Go which returns the results of a SQL query using the <a href=\"https://github.com/lib/pq\" rel=\"nofollow\">PostgreSQL library</a>. </p>\n\n<p>At the moment I can make the program return the values, but I can't get it to return a failed message to the user i.e. some JSON with an error message.</p>\n\n<p>I have an error function as follows :</p>\n\n<pre><code>func handleError(w http.ResponseWriter, err error) {\n    if err != nil {\n        log.Print(err.Error() + \"\\r\\n\") // Logging\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n}\n</code></pre>\n\n<p>However the http.Error method doesn't appear to ever return anything. The error thrown is a table that doesn't exist in the database (which gets logged to a text file: i.e. 2016/01/11 23:28:19 pq: relation \"building_roof\" does not exist</p>\n\n<p>My programmes query code looks like this:</p>\n\n<pre><code>table := pq.QuoteIdentifier(table)\nidentifier := pq.QuoteIdentifier(\"ID\")\nrows, err := db.Query( fmt.Sprintf(\"SELECT %s, ST_AsText(geom) FROM %s WHERE %s = $1\", identifier, table, identifier), feature)\nhandleError(w, err)\n</code></pre>\n\n<p>Causing an error just gives a Chrome error:</p>\n\n<p>No data received</p>\n\n<p>ERR_EMPTY_RESPONSE</p>\n\n<p>EDIT Full Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n    \"os\"\n    \"log\"\n    \"net/http\"\n    \"database/sql\"\n    \"strings\"\n    \"time\"\n    \"github.com/lib/pq\"\n)\n\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n\n    f, err := os.OpenFile(\"pgdump_errorlog.txt\", os.O_RDWR | os.O_CREATE | os.O_APPEND, 0666)\n    log.Print(\"Couldn't open file\")\n    defer f.Close()\n    log.SetOutput(f)\n\n    // Timing\n    start := time.Now()\n\n    // Postgres Credentials\n    const (\n        DB_USER     = \"postgres\"\n        DB_PASSWORD = \"OMITTED\" // Removed details !\n        DB_PORT     = \"OMITTED\"\n        DB_NAME     = \"OMITTED\"\n    )\n\n    // Postgres Connect\n    dbinfo := fmt.Sprintf(\"user=%s password=%s dbname=%s port=%s sslmode=disable\",\n                           DB_USER, DB_PASSWORD, DB_NAME, DB_PORT)\n    db, err := sql.Open(\"postgres\", dbinfo)\n    handleError(w, err)\n    defer db.Close()\n\n    table := r.FormValue(\"table\")\n    feature := r.FormValue(\"id\")\n    if table != \"\" {\n\n        //Postgres Query\n        var (\n            id int\n            geom string\n        )\n\n        table := pq.QuoteIdentifier(table)\n        identifier := pq.QuoteIdentifier(\"ID\")\n        rows, qerr := db.Query( fmt.Sprintf(\"SELECT %s, ST_AsText(geom) FROM %s WHERE %s = $1\", identifier, table, identifier), feature)\n        handleError(w, err)\n        defer rows.Close()\n        for rows.Next() {\n            err := rows.Scan(&amp;id, &amp;geom)\n            handleError(w, err)\n        }\n        err = rows.Err()\n        handleError(w, err)\n\n        // Maniplate Strings\n        returngeom := strings.Replace(geom, \"1.#QNAN\", \"\", -1)\n        i := strings.Index(returngeom, \"(\")\n        wkt := strings.TrimSpace(returngeom[:i])\n        returngeom = returngeom[i:]\n\n        type WTKJSON struct {\n            WTKType   string\n            Geometry  string\n            Elapsed   time.Duration\n        }\n\n        returnjson := WTKJSON{Geometry:  returngeom, WTKType: wkt , Elapsed: time.Since(start)/1000000.0}\n        json.NewEncoder(w).Encode(returnjson)\n\n    }\n\n}\n\nfunc handleError(w http.ResponseWriter, err error) {\n    if err != nil {\n        log.Print(err.Error() + \"\\r\\n\") // Logging\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n}\n\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "thread-safety"], "comments": [{"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1452553163, "post_id": 34732483, "comment_id": 57211755, "body": "They are safe for concurrent read (all types are), but I don&#39;t know about what exact exciting ways maps can break on concurrent writes. My guess is the biggest danger is at reallocation or hash collision."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1452553281, "post_id": 34732483, "comment_id": 57211801, "body": "Some data structures modify state on reads. Trees using the rotate-to-root heuristic is one example."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1452553721, "post_id": 34732483, "comment_id": 57211985, "body": "IIRC the recommended way to isolate a map for thread safety is a RWLock, which implies that concurrent reads are okay as long as there aren&#39;t any writes."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1452553744, "post_id": 34732483, "comment_id": 57211992, "body": "You will corrupt the internal state of the map (and possibly other memory). In go1.6 there is new check that will crash your app with the message &quot;concurrent map writes&quot; or &quot;concurrent map read and map write&quot; in cases where it can be detected."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1452553799, "post_id": 34732483, "comment_id": 57212020, "body": "reference on this - <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">blog.golang.org/go-maps-in-action</a> seems that concurrent read access is supported as a defined behavior."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 2, "creation_date": 1452554115, "post_id": 34732483, "comment_id": 57212128, "body": "@FilipHaglund What I meant by &quot;all types are safe for concurrent read&quot; is that if you can read them without calling a function. The second there&#39;s a function call involved in the read (which is what would be required for the tree example) all bets are off unless concurrency is documented. This is true of all builtin go types. (i.e. it&#39;s safe to read an arbitrary struct with <code>=</code> too)"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "closed_date": 1452560578, "answer_count": 0, "score": 0, "last_activity_date": 1452552031, "creation_date": 1452552031, "question_id": 34732483, "link": "https://stackoverflow.com/questions/34732483/what-happens-if-i-concurrently-access-a-single-go-map", "closed_reason": "Duplicate", "title": "What happens if I concurrently access a single go map?", "body": "<p>I know that go maps are not safe for concurrent access, but what happens if I do access them concurrently? Are they safe for concurrent read-access? Could I break it to a point where it loses all or some of its data? Is there a point where the whole program could crash if I modify it and read it at the same time? Do I need to have two different processes modifying it concurrently to mess things up?</p>\n\n<p>I'm interested in both the standard go compiler, and gccgo.</p>\n\n<p>What can happen if I concurrently access/modify a go map?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 7, "last_activity_date": 1452548813, "creation_date": 1452548813, "answer_id": 34731735, "question_id": 34731502, "link": "https://stackoverflow.com/questions/34731502/defer-on-a-struct-sqlx-close-ends-in-a-stack-overflow/34731735#34731735", "title": "Defer on a struct sqlx.Close() ends in a stack overflow", "body": "<p>You're triggering an infinite recursion in your <code>Close()</code> method:</p>\n\n<pre><code>func (db *DB) Close() {\n    db.Close() // you're currently IN this exact method!\n}\n</code></pre>\n\n<p>What you're probably meaning to do is calling the <code>Close()</code> method of the <code>sqlx.DB</code> struct that's embedded in your custom <code>DB</code> struct. I'm not that familiar with the <code>sqlx</code> package, but <a href=\"http://jmoiron.github.io/sqlx/#connecting\">according to the documentation</a> that type does not even have a <code>Close()</code> method. This is most probably because the <code>sqlx.DB</code> does not actually represent a single connection, but a connection pool that creates and closes connections transparently:</p>\n\n<blockquote>\n  <p>A DB instance is not a connection, but an abstraction representing a Database. This is why creating a DB does not return an error and will not panic. It maintains a connection pool internally, and will attempt to connect when a connection is first needed.</p>\n</blockquote>\n\n<p>The <a href=\"http://jmoiron.github.io/sqlx/#connectionPool\">documentation</a> explains in-depth how to handle this connection pool (emphasis mine):</p>\n\n<blockquote>\n  <p>By default, the pool grows unbounded, and connections will be created whenever there isn't a free connection available in the pool. You can use DB.SetMaxOpenConns to set the maximum size of the pool. <strong>Connections that are not being used are marked idle and then closed if they aren't required</strong>. To avoid making and closing lots of connections, set the maximum idle size with DB.SetMaxIdleConns to a size that is sensible for your query loads.</p>\n  \n  <p>It is easy to get into trouble by accidentally holding on to connections. To prevent this:</p>\n  \n  <ol>\n  <li>Ensure you Scan() every Row object</li>\n  <li><strong>Ensure you either Close() or fully-iterate via Next() every Rows object</strong></li>\n  <li>Ensure every transaction returns its connection via Commit() or Rollback()</li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 245, "user_id": 1496317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8aaed7a968f12467148e2a8a8c4ac2c0?s=128&d=identicon&r=PG", "display_name": "tsdtsdtsd", "link": "https://stackoverflow.com/users/1496317/tsdtsdtsd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "accepted_answer_id": 34731735, "answer_count": 1, "score": 0, "last_activity_date": 1452548813, "creation_date": 1452547995, "last_edit_date": 1592644375, "question_id": 34731502, "link": "https://stackoverflow.com/questions/34731502/defer-on-a-struct-sqlx-close-ends-in-a-stack-overflow", "title": "Defer on a struct sqlx.Close() ends in a stack overflow", "body": "<p>I just started learning Go. Lesson of the day was to wrap my database handler in a struct to avoid using global scope variables. Thought I understood it so far and wanted to defer the Close() method as I did before, which ended in an stack overflow.</p>\n<p>I couldn't find an explanation why this happen, nor what's the propper way to do this.</p>\n<p>Here is the key code:</p>\n<pre><code>package exporter\n\ntype DB struct {\n    *sqlx.DB\n    queriesExecuted int\n}\n\nfunc Open(dataSourceName string) *DB {\n    connection := sqlx.MustConnect(&quot;mysql&quot;, dataSourceName)\n    db := &amp;DB{connection, 0}\n    return db\n}\n\nfunc (db *DB) Close() {\n    db.Close() // this is where the stack growth happens\n}\n\nfunc (db *DB) GetArticles() []oxarticle {\n  ... \n}\n</code></pre>\n<hr />\n<pre><code>package main\n\nfunc main() {\n    exporter := feedexporter.Open(&quot;root:pass@/feedexport&quot;)\n    defer exporter.Close()\n\n    articles := exporter.GetArticles()\n}\n</code></pre>\n<p>Everything works fine without the defer exporter.Close(), including it ends in:</p>\n<blockquote>\n<p>runtime: goroutine stack exceeds 1000000000-byte limit</p>\n<p>fatal error: stack overflow</p>\n</blockquote>\n<p>It feels so bad to not close connections ;) What's the propper way to handle this?</p>\n"}, {"tags": ["jenkins", "go", "continuous-integration"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1452549554, "post_id": 34731416, "comment_id": 57210078, "body": "What do you mean by &quot;build just do nothing ...&quot;? Please show what you&#39;re doing, what your result is, and what you expect to happen."}, {"owner": {"reputation": 117, "user_id": 5293751, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3f64678fcaee742970a008c58d857b64?s=128&d=identicon&r=PG&f=1", "display_name": "Pavlo I.", "link": "https://stackoverflow.com/users/5293751/pavlo-i"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452708534, "post_id": 34731416, "comment_id": 57292883, "body": "I&#39;ve update starting post with details. Previous was totally uninformative."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452709134, "post_id": 34731416, "comment_id": 57293239, "body": "The error is because you&#39;re putting the <code>-o</code> flag after the file arguments. You don&#39;t need to name your <code>.go</code> files, you use the implied cwd (<code>go build -o server</code>), or the import path (<code>go install github.com&#47;Agnikay&#47;Test-Go-Jenkins</code>, <code>go build -o github.com&#47;Agnikay&#47;Test-Go-Jenkins</code>). See the docs:<a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>, <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">The Go Command</a>, and/or the help output of each command."}], "answers": [{"tags": [], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "is_accepted": true, "score": 0, "last_activity_date": 1564432000, "creation_date": 1564432000, "answer_id": 57260941, "question_id": 34731416, "link": "https://stackoverflow.com/questions/34731416/go-app-ci-with-jenkins/57260941#57260941", "title": "Go app CI with Jenkins", "body": "<blockquote>\n  <p>named files must be .go files</p>\n</blockquote>\n\n<p>You need to put the <code>.go</code> file last on the command-line.</p>\n\n<pre><code>go build -o server main.go\n</code></pre>\n\n<p>See:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/issues/19717\" rel=\"nofollow noreferrer\">Order of arguments matters with go build -o</a></li>\n</ul>\n\n<p>Related: </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/42706246/86967\">How to build executable with name other than Golang package</a></li>\n</ul>\n"}], "owner": {"reputation": 117, "user_id": 5293751, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3f64678fcaee742970a008c58d857b64?s=128&d=identicon&r=PG&f=1", "display_name": "Pavlo I.", "link": "https://stackoverflow.com/users/5293751/pavlo-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 947, "favorite_count": 0, "accepted_answer_id": 57260941, "answer_count": 1, "score": 1, "last_activity_date": 1564432000, "creation_date": 1452547667, "last_edit_date": 1452602245, "question_id": 34731416, "link": "https://stackoverflow.com/questions/34731416/go-app-ci-with-jenkins", "title": "Go app CI with Jenkins", "body": "<p>I try to setup CI for Go app and Jenkins. Jenkins Go Plugin has been installed, it gets correct version of Go(currently it's 1.5.2). </p>\n\n<p>Currently I have next:</p>\n\n<ol>\n<li><p>Test repository with simple app <a href=\"https://github.com/Agnikay/Test-Go-Jenkins\" rel=\"nofollow\">https://github.com/Agnikay/Test-Go-Jenkins</a></p></li>\n<li><p>Jenkins with installed Go Plugin(on VPS, Ubuntu 14.04, x86)</p></li>\n<li><p>For build in Jenkins added as build step next: </p>\n\n<p><code>cd src/main \n go build main.go</code></p></li>\n</ol>\n\n<p>As result in artifacts existing 2 files - <em>main.go</em>(sources) and <em>main</em> (executable) for linux x86. If i use as build command <code>go build main.go -o server</code> error received: \"named files must be .go files\".\nSo, my questions are</p>\n\n<ol>\n<li>If my app will contain much more code file, packages etc. should i still build it as <code>go build main.go</code>?</li>\n<li>How correctly give name for <code>go build</code> output file to add it to the artifacts?</li>\n<li>Should i use some kind of make file/script etc to collect dependencies on build machine? What is best practice here?</li>\n</ol>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1452546030, "post_id": 34730941, "comment_id": 57208110, "body": "In same fashion that you start the process you can kill it using the Bash command of your choosing (like killall) and the <code>exec</code> package. Just create a clean up function and call it with <code>defer</code> in your main."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1452547411, "post_id": 34730941, "comment_id": 57208853, "body": "@evanmcdonnal: a defer doesn&#39;t run when you receive a signal, since the function isn&#39;t returning. You need a signal handler to catch it."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1452617505, "post_id": 34730941, "comment_id": 57244391, "body": "Tangentially related but worth linking to: <a href=\"http://stackoverflow.com/q/392022/720999\">killing a whole process group on Linux</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1822, "user_id": 176300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ooflm.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/176300/nick"}, "edited": false, "score": 3, "creation_date": 1452556269, "post_id": 34731014, "comment_id": 57212846, "body": "note that the syscall package is deprecated as of Go 1.4 (see <a href=\"https://golang.org/s/go1.4-syscall\" rel=\"nofollow noreferrer\">golang.org/s/go1.4-syscall</a>) and you&#39;re supposed to use <a href=\"https://godoc.org/golang.org/x/sys\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/sys</a> - I think Prctl is the method that gives you the equivalent behaviour"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1822, "user_id": 176300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ooflm.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/176300/nick"}, "edited": false, "score": 0, "creation_date": 1452556969, "post_id": 34731014, "comment_id": 57213068, "body": "@Nick, that&#39;s incorrect. The syscall package is mostly frozen, but not &quot;deprecated&quot;. Much of the stdlib depends on it."}, {"owner": {"reputation": 1822, "user_id": 176300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ooflm.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/176300/nick"}, "edited": false, "score": 0, "creation_date": 1452557443, "post_id": 34731014, "comment_id": 57213227, "body": "The document says &quot;We can freeze and, in effect, deprecate it, however.&quot; Maybe the document should be edited to clarify what people are supposed to do"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1822, "user_id": 176300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ooflm.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/176300/nick"}, "edited": false, "score": 0, "creation_date": 1452560840, "post_id": 34731014, "comment_id": 57214237, "body": "@Nick, that was just the proposal document, from when the syscall &quot;freeze&quot; was implemented. It&#39;s not official documentation, and is out of date."}, {"owner": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "edited": false, "score": 2, "creation_date": 1557264382, "post_id": 34731014, "comment_id": 98704896, "body": "However, the Pdeathsig <i>is</i> deprecated"}, {"owner": {"reputation": 841, "user_id": 127316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cf38858a3a705d200e722c77b4f8a5?s=128&d=identicon&r=PG", "display_name": "John Eikenberry", "link": "https://stackoverflow.com/users/127316/john-eikenberry"}, "reply_to_user": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "edited": false, "score": 0, "creation_date": 1564858986, "post_id": 34731014, "comment_id": 101170890, "body": "@Rambatino, do you have reference for that? I can&#39;t find anything in offcial documentation or source code that says its deprecated."}, {"owner": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "edited": false, "score": 0, "creation_date": 1565084525, "post_id": 34731014, "comment_id": 101231129, "body": "I&#39;ve just had a look at the source code, and I too cannot find where I got that from. But I would have come across it having commented on here."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 14, "last_activity_date": 1452547237, "last_edit_date": 1495541233, "creation_date": 1452546151, "answer_id": 34731014, "question_id": 34730941, "link": "https://stackoverflow.com/questions/34730941/ensure-executables-called-in-go-process-get-killed-when-process-is-killed/34731014#34731014", "title": "Ensure executables called in Go Process get killed when Process is killed", "body": "<p>The only ways to ensure that the child process is killed, is to start it in the same process group, and kill the process group as a whole, or set <code>Pdeadthsig</code> in the <a href=\"https://golang.org/pkg/syscall/#SysProcAttr\" rel=\"noreferrer\"><code>syscall.SetProcAddr</code></a>.</p>\n\n<p>You can setup a signal handler for common signals like <code>SIG_INT</code> and <code>SIG_TERM</code>, and kill your child processes before exiting, but since you can't catch <code>SIG_KILL</code> that's often not worth the effort.</p>\n\n<p>See: <a href=\"https://stackoverflow.com/questions/34095254/panic-in-other-goroutine-not-stopping-child-process/34095869#34095869\">Panic in other goroutine not stopping child process</a></p>\n\n<pre><code>cmd := exec.Command(\"./long-process\")\n\ncmd.SysProcAttr = &amp;syscall.SysProcAttr{\n    Pdeathsig: syscall.SIGTERM,\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 772, "user_id": 2177445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a2a5ad356c78484d79a3ad4b99209f?s=128&d=identicon&r=PG", "display_name": "likebike", "link": "https://stackoverflow.com/users/2177445/likebike"}, "edited": false, "score": 0, "creation_date": 1522515734, "post_id": 40797379, "comment_id": 86188262, "body": "You are mistaken -- <code>Pdeathsig</code> is still in Go&#39;s Linux <code>SysProcAttr</code>."}, {"owner": {"reputation": 772, "user_id": 2177445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a2a5ad356c78484d79a3ad4b99209f?s=128&d=identicon&r=PG", "display_name": "likebike", "link": "https://stackoverflow.com/users/2177445/likebike"}, "edited": false, "score": 0, "creation_date": 1522515754, "post_id": 40797379, "comment_id": 86188268, "body": "The <code>unix</code> package being used in the example code comes from here: <a href=\"https://godoc.org/golang.org/x/sys/unix\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/sys/unix</a>"}, {"owner": {"reputation": 2675, "user_id": 545475, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zl64v.jpg?s=128&g=1", "display_name": "Arnavion", "link": "https://stackoverflow.com/users/545475/arnavion"}, "edited": false, "score": 0, "creation_date": 1531865830, "post_id": 40797379, "comment_id": 89753930, "body": "Note that this answer only applies if the <i>children</i> processes are written in golang, since they have to be changed to call unix.Prctl on themselves."}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1615821263, "post_id": 40797379, "comment_id": 117803401, "body": "Note that the death-signal stuff is not implemented in all Unix variants."}], "tags": [], "owner": {"reputation": 2364, "user_id": 4206629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ea9a378d5409478f2717aae6354396?s=128&d=identicon&r=PG", "display_name": "YongHao Hu", "link": "https://stackoverflow.com/users/4206629/yonghao-hu"}, "is_accepted": false, "score": 0, "last_activity_date": 1531885073, "last_edit_date": 1531885073, "creation_date": 1480045441, "answer_id": 40797379, "question_id": 34730941, "link": "https://stackoverflow.com/questions/34730941/ensure-executables-called-in-go-process-get-killed-when-process-is-killed/40797379#40797379", "title": "Ensure executables called in Go Process get killed when Process is killed", "body": "<p>I would suggest you to use unix.Prctl.</p>\n\n<pre><code>flag := unix.SIGHUP\nif err := unix.Prctl(unix.PR_SET_PDEATHSIG, uintptr(flag), 0, 0, 0); err != nil {\n    return\n}\n</code></pre>\n\n<p>A detailed example is below, new.go for child process and main.go as parent process.</p>\n\n<pre><code>//new.go\npackage main\n\nfunc main() {\n    flag := unix.SIGHUP\n\n    if err := unix.Prctl(unix.PR_SET_PDEATHSIG, uintptr(flag), 0, 0, 0); err != nil {\n    return\n    }\n\n    f, _ := os.Create(\"./dat2\")\n    defer f.Close()\n    i := 0\n    for {\n        n3, _ := f.WriteString(\"writes \" + string(i) + \"\\n\")\n        fmt.Printf(\"wrote %d bytes\\n\", n3)\n        f.Sync()\n        i += 2\n        time.Sleep(2 * time.Second)\n    }\n\n    for {\n        n3, _ := f.WriteString(\"newwrites\\n\")\n        fmt.Printf(\"wrote %d bytes\\n\", n3)\n        f.Sync()\n        time.Sleep(2 * time.Second)\n    }\n}\n\n\n//main.go\npackage main\n\nimport \"os/exec\"\n\nfunc main() {\n    commandA := exec.Command(\"./new\")\n    commandA.Start()\n    commandB := exec.Command(\"./new\")\n    commandB.Start()\n    for {\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 515, "user_id": 7804714, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9e70292d73d503d0ef63de4cda71b1ac?s=128&d=identicon&r=PG", "display_name": "hallazzang", "link": "https://stackoverflow.com/users/7804714/hallazzang"}, "is_accepted": false, "score": 0, "last_activity_date": 1561388184, "creation_date": 1561388184, "answer_id": 56739249, "question_id": 34730941, "link": "https://stackoverflow.com/questions/34730941/ensure-executables-called-in-go-process-get-killed-when-process-is-killed/56739249#56739249", "title": "Ensure executables called in Go Process get killed when Process is killed", "body": "<p>If you're on Windows, you might find this snippet helpful:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n    \"unsafe\"\n\n    \"golang.org/x/sys/windows\"\n)\n\n// We use this struct to retreive process handle(which is unexported)\n// from os.Process using unsafe operation.\ntype process struct {\n    Pid    int\n    Handle uintptr\n}\n\ntype ProcessExitGroup windows.Handle\n\nfunc NewProcessExitGroup() (ProcessExitGroup, error) {\n    handle, err := windows.CreateJobObject(nil, nil)\n    if err != nil {\n        return 0, err\n    }\n\n    info := windows.JOBOBJECT_EXTENDED_LIMIT_INFORMATION{\n        BasicLimitInformation: windows.JOBOBJECT_BASIC_LIMIT_INFORMATION{\n            LimitFlags: windows.JOB_OBJECT_LIMIT_KILL_ON_JOB_CLOSE,\n        },\n    }\n    if _, err := windows.SetInformationJobObject(\n        handle,\n        windows.JobObjectExtendedLimitInformation,\n        uintptr(unsafe.Pointer(&amp;info)),\n        uint32(unsafe.Sizeof(info))); err != nil {\n        return 0, err\n    }\n\n    return ProcessExitGroup(handle), nil\n}\n\nfunc (g ProcessExitGroup) Dispose() error {\n    return windows.CloseHandle(windows.Handle(g))\n}\n\nfunc (g ProcessExitGroup) AddProcess(p *os.Process) error {\n    return windows.AssignProcessToJobObject(\n        windows.Handle(g),\n        windows.Handle((*process)(unsafe.Pointer(p)).Handle))\n}\n\nfunc main() {\n    g, err := NewProcessExitGroup()\n    if err != nil {\n        panic(err)\n    }\n    defer g.Dispose()\n\n    cmd := exec.Command(\"notepad.exe\", \"noname\")\n    if err := cmd.Start(); err != nil {\n        panic(err)\n    }\n\n    if err := g.AddProcess(cmd.Process); err != nil {\n        panic(err)\n    }\n\n    if err := cmd.Wait(); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Original link: <a href=\"https://gist.github.com/hallazzang/76f3970bfc949831808bbebc8ca15209\" rel=\"nofollow noreferrer\">https://gist.github.com/hallazzang/76f3970bfc949831808bbebc8ca15209</a></p>\n"}, {"tags": [], "owner": {"reputation": 530, "user_id": 10753492, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vpFmr9vacTw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jiHeIG7f13oRVc9pqOOOdXPCY9Gg/mo/photo.jpg?sz=128", "display_name": "user10753492", "link": "https://stackoverflow.com/users/10753492/user10753492"}, "is_accepted": false, "score": 1, "last_activity_date": 1567562015, "creation_date": 1567562015, "answer_id": 57780543, "question_id": 34730941, "link": "https://stackoverflow.com/questions/34730941/ensure-executables-called-in-go-process-get-killed-when-process-is-killed/57780543#57780543", "title": "Ensure executables called in Go Process get killed when Process is killed", "body": "<p>One possible strategy is to keep a list of processes you're running in a global array <code>var childProcesses = make([]*os.Process, 0)</code> and append to it every time you start a process.</p>\n\n<p>Have your own <code>Exit</code> function. Make sure that you never call <code>os.Exit</code> anywhere in your code, and always call your own <code>Exit</code> function instead. Your Exit function will kill all the <code>childProcesses</code></p>\n\n<pre><code>for _, p := range childProcesses {\n    p.Kill()\n}\n</code></pre>\n\n<p>Handle signals so they go through your own exit function, for example by doing this during initialization (somewhere near the top of your main function)</p>\n\n<pre><code>sigs := make(chan os.Signal, 1)\nsignal.Notify(sigs, syscall.SIGINT, syscall.SIGTERM, syscall.SIGKILL, syscall.SIGQUIT)\ngoUnsafe(func() {\n    var signal = &lt;-sigs\n    log.Println(\"Got Signal\", signal)\n    Exit(0)\n})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1615821106, "post_id": 57879001, "comment_id": 117803304, "body": "<code>setgid</code> is for the group ID of the running process, as distinguished from the <i>process</i> group to which the process belongs. That is, files have uid-and-gid and this gid is a file-gid, not a process-group-ID."}, {"owner": {"reputation": 1820, "user_id": 716079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f11f2194cf100ed811a2e55cc285ea?s=128&d=identicon&r=PG", "display_name": "Lourenco", "link": "https://stackoverflow.com/users/716079/lourenco"}, "reply_to_user": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 1, "creation_date": 1615914388, "post_id": 57879001, "comment_id": 117837779, "body": "@torek, you are alright.  I did a type when wrote this; I mean <code>setpgid(2)</code>.  Just corrected it in my answer. Thanks."}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1615914646, "post_id": 57879001, "comment_id": 117837905, "body": "Much better - note that you not only need to use <code>setpgid</code> but also need to make sure that whatever is sending the signal is doing it with the process group IDs and <code>killpg</code>. (But that&#39;s up to whatever is <i>sending</i> the signal, i.e., there&#39;s not too much you can do in your own Go program.)"}], "tags": [], "owner": {"reputation": 1820, "user_id": 716079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f11f2194cf100ed811a2e55cc285ea?s=128&d=identicon&r=PG", "display_name": "Lourenco", "link": "https://stackoverflow.com/users/716079/lourenco"}, "is_accepted": false, "score": 0, "last_activity_date": 1615914464, "last_edit_date": 1615914464, "creation_date": 1568155084, "answer_id": 57879001, "question_id": 34730941, "link": "https://stackoverflow.com/questions/34730941/ensure-executables-called-in-go-process-get-killed-when-process-is-killed/57879001#57879001", "title": "Ensure executables called in Go Process get killed when Process is killed", "body": "<blockquote>\n<p>I have some code that in Go (golang), has a few different threads running a separate executable. I want to ensure that if a user kills my process in Go, that I have a way of killing the executables I've called, is there a way to do that?</p>\n</blockquote>\n<p>It is not clear to me what you mean by &quot;different threads running.&quot;  I will assume:</p>\n<ul>\n<li>Those threads belong to &quot;executables I've called&quot;</li>\n<li>Those threads have not necessarily written in golang</li>\n<li>You cannot control their execution (i.e., you unable to change their code)</li>\n</ul>\n<p>In this sense, we are talking about to create a process group and ensure that when you kill a process, every other process in that group must stop too.  This mechanism is Operating System dependent.</p>\n<p>In the current version, there are two possibilities (see package <a href=\"https://godoc.org/golang.org/x/sys\" rel=\"nofollow noreferrer\">x/sys</a>):</p>\n<ul>\n<li><p><strong>Unix</strong>: it is about to <a href=\"https://godoc.org/golang.org/x/sys/unix#Setgid\" rel=\"nofollow noreferrer\"><code>setpgid(2)</code></a></p>\n</li>\n<li><p><strong>Windows</strong>: it is about to <a href=\"https://godoc.org/golang.org/x/sys/windows#CreateProcess\" rel=\"nofollow noreferrer\"><code>CreateProcess</code></a>.  Please, refer to the <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">MS Windows documentation CreateProcess</a>.  You must pass the <code>CREATE_NEW_PROCESS_GROUP</code> flag (<a href=\"https://docs.microsoft.com/en-us/windows/console/console-process-groups\" rel=\"nofollow noreferrer\">see</a>)</p>\n</li>\n</ul>\n"}], "owner": {"reputation": 111, "user_id": 5775632, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ljaw3uaAT-8/AAAAAAAAAAI/AAAAAAAAAAA/VIPvQkasPV0/photo.jpg?sz=128", "display_name": "Ali Sakr", "link": "https://stackoverflow.com/users/5775632/ali-sakr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4322, "favorite_count": 3, "answer_count": 5, "score": 11, "last_activity_date": 1615914464, "creation_date": 1452545890, "last_edit_date": 1452546058, "question_id": 34730941, "link": "https://stackoverflow.com/questions/34730941/ensure-executables-called-in-go-process-get-killed-when-process-is-killed", "title": "Ensure executables called in Go Process get killed when Process is killed", "body": "<p>I have some code that in Go (golang), has a few different threads running a separate executable. I want to ensure that if a user kills my process in Go, that I have a way of killing the executables I've called, is there a way to do that?</p>\n"}, {"tags": ["linux", "go", "docker", "alpine"], "comments": [{"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 0, "creation_date": 1452541582, "post_id": 34729748, "comment_id": 57205705, "body": "Did you run <code>ldd</code> on your host or within the alpine container? Did you check if the library files listed in the <code>ldd</code> output actually exist in the alpine image?"}, {"owner": {"reputation": 7819, "user_id": 25991, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVQuy.jpg?s=128&g=1", "display_name": "Everett Toews", "link": "https://stackoverflow.com/users/25991/everett-toews"}, "reply_to_user": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 0, "creation_date": 1452541911, "post_id": 34729748, "comment_id": 57205878, "body": "Ran <code>ldd</code> within the container. The library files listed in the <code>ldd</code> output do <i>not</i> exist in the Alpine image."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452541950, "post_id": 34729748, "comment_id": 57205898, "body": "rack is linked to gnu libc, alipne uses musl libc."}, {"owner": {"reputation": 7819, "user_id": 25991, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVQuy.jpg?s=128&g=1", "display_name": "Everett Toews", "link": "https://stackoverflow.com/users/25991/everett-toews"}, "edited": false, "score": 0, "creation_date": 1452541954, "post_id": 34729748, "comment_id": 57205901, "body": "Also when I run <code>ldd &#47;usr&#47;local&#47;bin&#47;docker</code> within the container, I get the output <code>ldd: &#47;usr&#47;local&#47;bin&#47;docker: Not a valid dynamic program</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452542020, "post_id": 34729748, "comment_id": 57205943, "body": "<code>ldd</code> is for printing shared library dependencies, the <code>docker</code> binary is statically linked."}, {"owner": {"reputation": 7819, "user_id": 25991, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVQuy.jpg?s=128&g=1", "display_name": "Everett Toews", "link": "https://stackoverflow.com/users/25991/everett-toews"}, "edited": false, "score": 0, "creation_date": 1452542707, "post_id": 34729748, "comment_id": 57206335, "body": "Thanks for the helpful comments. I&#39;ve opened up the issue <a href=\"https://github.com/rackspace/rack/issues/381\" rel=\"nofollow noreferrer\">Statically link the rack binary</a>."}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 799216, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5285ca39a1182b2594d23a40c2d13c51?s=128&d=identicon&r=PG", "display_name": "Nils", "link": "https://stackoverflow.com/users/799216/nils"}, "edited": false, "score": 4, "creation_date": 1469607829, "post_id": 35613430, "comment_id": 64601863, "body": "The command fixed the issue for me. Could you elaborate why that is needed and if there is a way to avoid that when compiling the Go lib? thx"}, {"owner": {"reputation": 2354, "user_id": 1563673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6338adc53993aa3e27054370489014d9?s=128&d=identicon&r=PG", "display_name": "sheldonk", "link": "https://stackoverflow.com/users/1563673/sheldonk"}, "reply_to_user": {"reputation": 715, "user_id": 799216, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5285ca39a1182b2594d23a40c2d13c51?s=128&d=identicon&r=PG", "display_name": "Nils", "link": "https://stackoverflow.com/users/799216/nils"}, "edited": false, "score": 4, "creation_date": 1470362818, "post_id": 35613430, "comment_id": 64931292, "body": "The installed Go version was compiled with glibc and on Alpine that is not installed by default. You can compile your Go with muslc, which is the default for Alpine, or do the symlink as above."}, {"owner": {"reputation": 27292, "user_id": 100208, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e2fda105627061de42901c671680638b?s=128&d=identicon&r=PG&f=1", "display_name": "atp", "link": "https://stackoverflow.com/users/100208/atp"}, "edited": false, "score": 0, "creation_date": 1516133209, "post_id": 35613430, "comment_id": 83562951, "body": "@GuerlandoOCs <code>music</code> was probably a typo for <code>musl libc</code>"}, {"owner": {"reputation": 1973, "user_id": 2056426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ge8I5.png?s=128&g=1", "display_name": "delos", "link": "https://stackoverflow.com/users/2056426/delos"}, "edited": false, "score": 2, "creation_date": 1520960657, "post_id": 35613430, "comment_id": 85527381, "body": "Adding this line to the Dockerfile gives the following error <code># Error relocating .&#47;my_go_binary: __fprintf_chk: symbol not found</code>. Seems to be an incompatibility between the C libraries. Anyone else getting this error?"}, {"owner": {"reputation": 1702, "user_id": 446220, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ef06aba3fec716664adf74b3e7c0af56?s=128&d=identicon&r=PG", "display_name": "psmith", "link": "https://stackoverflow.com/users/446220/psmith"}, "edited": false, "score": 2, "creation_date": 1527645216, "post_id": 35613430, "comment_id": 88199707, "body": "While this worked for me, it&#39;s still a workaround. At the end I chose to follow Kuldeep&#39;s answer and used <code>CGO_ENABLED=0 go build</code>. The resulting binary worked on Alpine."}, {"owner": {"reputation": 153, "user_id": 2291886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d94d277ece247295c9ca745b28c60067?s=128&d=identicon&r=PG", "display_name": "Gianfranco Reppucci", "link": "https://stackoverflow.com/users/2291886/gianfranco-reppucci"}, "edited": false, "score": 0, "creation_date": 1558027153, "post_id": 35613430, "comment_id": 98973778, "body": "this answer is not correct as it is a workaround. the correct one is Kuldeep&#39;s one.  you need to compile the program with <code>CGO_ENABLED=0</code> option"}], "tags": [], "owner": {"reputation": 2354, "user_id": 1563673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6338adc53993aa3e27054370489014d9?s=128&d=identicon&r=PG", "display_name": "sheldonk", "link": "https://stackoverflow.com/users/1563673/sheldonk"}, "is_accepted": true, "score": 124, "last_activity_date": 1456353409, "last_edit_date": 1456353409, "creation_date": 1456349083, "answer_id": 35613430, "question_id": 34729748, "link": "https://stackoverflow.com/questions/34729748/installed-go-binary-not-found-in-path-on-alpine-linux-docker/35613430#35613430", "title": "Installed Go binary not found in path on Alpine Linux Docker", "body": "<pre><code>RUN mkdir /lib64 &amp;&amp; ln -s /lib/libc.musl-x86_64.so.1 /lib64/ld-linux-x86-64.so.2\n</code></pre>\n\n<p>Since the musl and glibc so are compatible, you can make this symlink and it will fix the missing dependency. </p>\n"}, {"comments": [{"owner": {"reputation": 5639, "user_id": 1277048, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/tGJVH.jpg?s=128&g=1", "display_name": "FuzzyAmi", "link": "https://stackoverflow.com/users/1277048/fuzzyami"}, "edited": false, "score": 1, "creation_date": 1500365196, "post_id": 41128211, "comment_id": 77290120, "body": "perhaps not terribly surprising, I found that when compiling for alpine docker on a mac machine, I needed the &quot;GOOS=linux GOARCH=amd64&quot; flags in addition to the &quot;CGO_ENABLED=0&quot; flag."}, {"owner": {"reputation": 584, "user_id": 1142314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7270b98811d8bfc5c887e354029b751?s=128&d=identicon&r=PG", "display_name": "Ben Elgar", "link": "https://stackoverflow.com/users/1142314/ben-elgar"}, "edited": false, "score": 0, "creation_date": 1523886597, "post_id": 41128211, "comment_id": 86732692, "body": "For anyone using Bazel, the above can be accomplished with the <code>--features=static --features=pure</code> flags."}, {"owner": {"reputation": 178, "user_id": 4443200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GvtQC.png?s=128&g=1", "display_name": "BBerastegui", "link": "https://stackoverflow.com/users/4443200/bberastegui"}, "edited": false, "score": 0, "creation_date": 1574180673, "post_id": 41128211, "comment_id": 104135711, "body": "If you want to do this with a package and &quot;go get&quot; you can directly do:  <code>CGO_ENABLED=0 go get -u YOUR_PACKAGE</code> and obtain a binary that will work in alpine."}], "tags": [], "owner": {"reputation": 470, "user_id": 2451352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cebfb9198e9a4ad6de165354d3768cb5?s=128&d=identicon&r=PG", "display_name": "Kuldeep Singh Pal", "link": "https://stackoverflow.com/users/2451352/kuldeep-singh-pal"}, "is_accepted": false, "score": 37, "last_activity_date": 1481654144, "creation_date": 1481654144, "answer_id": 41128211, "question_id": 34729748, "link": "https://stackoverflow.com/questions/34729748/installed-go-binary-not-found-in-path-on-alpine-linux-docker/41128211#41128211", "title": "Installed Go binary not found in path on Alpine Linux Docker", "body": "<p>I compiled go binary in alpine with these options</p>\n\n<pre><code>GOOS=linux GOARCH=amd64 CGO_ENABLED=0 go build -o [name of binary]\n</code></pre>\n\n<p>It worked.</p>\n"}, {"comments": [{"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "edited": false, "score": 0, "creation_date": 1522534648, "post_id": 43864224, "comment_id": 86193507, "body": "Do you mean for compilation or as the runtime environment? Would using this image for compilation automatically compile a binary linked to musl? A bit more details in your answer would be great :)"}, {"owner": {"reputation": 2053, "user_id": 841567, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c5c1f8994087dc107e3aaa09fac4ce63?s=128&d=identicon&r=PG", "display_name": "jotrocken", "link": "https://stackoverflow.com/users/841567/jotrocken"}, "reply_to_user": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "edited": false, "score": 0, "creation_date": 1522919014, "post_id": 43864224, "comment_id": 86346468, "body": "Thanks for asking! I&#39;ve updated the answer accordingly."}, {"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "edited": false, "score": 1, "creation_date": 1522937765, "post_id": 43864224, "comment_id": 86359994, "body": "Is there any reason for using <code>golang:alpine</code> for running the application over just using the <i>much</i> smaller <code>alpine</code> image? <code>golang:1.10-alpine</code> is 376 MB while <code>alpine:3.7</code> is 4.15 MB."}, {"owner": {"reputation": 2053, "user_id": 841567, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c5c1f8994087dc107e3aaa09fac4ce63?s=128&d=identicon&r=PG", "display_name": "jotrocken", "link": "https://stackoverflow.com/users/841567/jotrocken"}, "reply_to_user": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "edited": false, "score": 0, "creation_date": 1522939994, "post_id": 43864224, "comment_id": 86361744, "body": "Maintenance effort I guess. It is still half the size of golang:latest. But you are right, if space matters more than maintainability, going with a plain alpine (pun intended) is the way to go."}], "tags": [], "owner": {"reputation": 2053, "user_id": 841567, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c5c1f8994087dc107e3aaa09fac4ce63?s=128&d=identicon&r=PG", "display_name": "jotrocken", "link": "https://stackoverflow.com/users/841567/jotrocken"}, "is_accepted": false, "score": 0, "last_activity_date": 1522918944, "last_edit_date": 1522918944, "creation_date": 1494316494, "answer_id": 43864224, "question_id": 34729748, "link": "https://stackoverflow.com/questions/34729748/installed-go-binary-not-found-in-path-on-alpine-linux-docker/43864224#43864224", "title": "Installed Go binary not found in path on Alpine Linux Docker", "body": "<p>Alternatively, you can (meanwhile) use the <code>golang:alpine</code> image from <a href=\"https://hub.docker.com/r/library/golang/tags/\" rel=\"nofollow noreferrer\">Docker Hub</a> to compile and run your code.</p>\n\n<pre><code>docker run -v ${YOUR_CODE_PATH}:/go/src/example -it golang:alpine sh\ncd src/example\ngo build .\nldd example\n    /lib/ld-musl-x86_64.so.1 (0x7f677fcf7000)\n    libc.musl-x86_64.so.1 =&gt; /lib/ld-musl-x86_64.so.1 (0x7f677fcf7000)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60, "user_id": 3881754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95674a8a9300debe5857319456852ed9?s=128&d=identicon&r=PG&f=1", "display_name": "johannzhaojohann", "link": "https://stackoverflow.com/users/3881754/johannzhaojohann"}, "is_accepted": false, "score": 1, "last_activity_date": 1494880840, "creation_date": 1494880840, "answer_id": 43988468, "question_id": 34729748, "link": "https://stackoverflow.com/questions/34729748/installed-go-binary-not-found-in-path-on-alpine-linux-docker/43988468#43988468", "title": "Installed Go binary not found in path on Alpine Linux Docker", "body": "<p>Depending on the nature of the program, you might want to compile your go program with static link options, such as the following:</p>\n\n<p>-x -a -tags netgo -installsuffix netgo</p>\n\n<p>Afterwards you do not need to worry about linking the correct libraries.</p>\n"}, {"tags": [], "owner": {"reputation": 5422, "user_id": 649167, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/e56e7f730847a9d1ebb6b7669a83e003?s=128&d=identicon&r=PG", "display_name": "knite", "link": "https://stackoverflow.com/users/649167/knite"}, "is_accepted": false, "score": 17, "last_activity_date": 1528758564, "creation_date": 1528758564, "answer_id": 50807237, "question_id": 34729748, "link": "https://stackoverflow.com/questions/34729748/installed-go-binary-not-found-in-path-on-alpine-linux-docker/50807237#50807237", "title": "Installed Go binary not found in path on Alpine Linux Docker", "body": "<p>When building under Debian 9 (Stretch) / Go 1.10.2 and running under Alpine 3.7.0:</p>\n\n<pre><code>CGO_ENABLED=0 go build\n</code></pre>\n\n<p>Neither <code>GOOS=linux</code> nor <code>GOARCH=amd6</code> was necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 136, "user_id": 3711885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/1PT4j.jpg?s=128&g=1", "display_name": "Amine Zaine", "link": "https://stackoverflow.com/users/3711885/amine-zaine"}, "edited": false, "score": 0, "creation_date": 1617289462, "post_id": 59367690, "comment_id": 118268448, "body": "I think that&#39;s the cleanest answer from a &quot;consumer of the binary&quot; point-of-view."}, {"owner": {"reputation": 17090, "user_id": 433814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/f3DHU.jpg?s=128&g=1", "display_name": "Marcello de Sales", "link": "https://stackoverflow.com/users/433814/marcello-de-sales"}, "edited": false, "score": 0, "creation_date": 1617359522, "post_id": 59367690, "comment_id": 118287470, "body": "I did, but I still got errors not finding symbols Error loading shared library libstdc++.so.6: No such file or directory"}], "tags": [], "owner": {"reputation": 2249, "user_id": 2450936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/174d70ca270f9c1bdadb37ac9eaf8fe0?s=128&d=identicon&r=PG", "display_name": "howie", "link": "https://stackoverflow.com/users/2450936/howie"}, "is_accepted": false, "score": 16, "last_activity_date": 1576557465, "creation_date": 1576557465, "answer_id": 59367690, "question_id": 34729748, "link": "https://stackoverflow.com/questions/34729748/installed-go-binary-not-found-in-path-on-alpine-linux-docker/59367690#59367690", "title": "Installed Go binary not found in path on Alpine Linux Docker", "body": "<p>You can install libc6-compat</p>\n\n<pre><code>RUN apk add --no-cache libc6-compat\n</code></pre>\n"}], "owner": {"reputation": 7819, "user_id": 25991, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVQuy.jpg?s=128&g=1", "display_name": "Everett Toews", "link": "https://stackoverflow.com/users/25991/everett-toews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34003, "favorite_count": 31, "accepted_answer_id": 35613430, "answer_count": 6, "score": 57, "last_activity_date": 1576557465, "creation_date": 1452541443, "last_edit_date": 1495542879, "question_id": 34729748, "link": "https://stackoverflow.com/questions/34729748/installed-go-binary-not-found-in-path-on-alpine-linux-docker", "title": "Installed Go binary not found in path on Alpine Linux Docker", "body": "<p>I've got a Go binary I'm trying to run on the Alpine Docker image.</p>\n\n<p>This works fine for the Docker Go binary.</p>\n\n<pre><code>docker run -it alpine:3.3 sh\napk add --no-cache curl\n\nDOCKER_BUCKET=get.docker.com\nDOCKER_VERSION=1.9.1\ncurl -fSL \"https://${DOCKER_BUCKET}/builds/Linux/x86_64/docker-$DOCKER_VERSION\" -o /usr/local/bin/docker\nchmod +x /usr/local/bin/docker\ndocker help\nUsage: docker [OPTIONS] COMMAND [arg...]\n...\n</code></pre>\n\n<p>However, for the Go binary I want to install.</p>\n\n<pre><code>RACK_BUCKET=ec4a542dbf90c03b9f75-b342aba65414ad802720b41e8159cf45.ssl.cf5.rackcdn.com\nRACK_VERSION=1.1.0-beta1\ncurl -fSL \"https://${RACK_BUCKET}/${RACK_VERSION}/Linux/amd64/rack\" -o /usr/local/bin/rack\nchmod +x /usr/local/bin/rack\n\nrack help\nsh: rack: not found\n\n/usr/local/bin/rack help\nsh: /usr/local/bin/rack: not found\n\nls -al /usr/local/bin/\ntotal 43375\ndrwxr-xr-x    2 root     root          1024 Jan 11 18:10 .\ndrwxr-xr-x    8 root     root          1024 Jan 11 18:09 ..\n-rwxr-xr-x    1 root     root      30222575 Jan 11 18:09 docker\n-rwxr-xr-x    1 root     root      14190576 Jan 11 18:10 rack\n\nwhich rack\n/usr/local/bin/rack\n</code></pre>\n\n<p>I thought it might have something to do with <a href=\"https://stackoverflow.com/a/33240548/25991\">this answer</a> but I don't get the same error when running <code>ldd</code>.</p>\n\n<pre><code>ldd /usr/local/bin/rack\n    /lib64/ld-linux-x86-64.so.2 (0x7fdd15cd0000)\n    libpthread.so.0 =&gt; /lib64/ld-linux-x86-64.so.2 (0x7fdd15cd0000)\n    libc.so.6 =&gt; /lib64/ld-linux-x86-64.so.2 (0x7fdd15cd0000)\n</code></pre>\n\n<p>Any idea with this installed Go binary is not found in path on Alpine Linux Docker?</p>\n"}, {"tags": ["networking", "go", "ip", "ip-address", "cidr"], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1452542830, "post_id": 34729915, "comment_id": 57206395, "body": "How so? Pretty sure the final value in the IP will <b>never</b> be the same... You need to compare subnet masks or a substring of the IP."}, {"owner": {"reputation": 404, "user_id": 1164802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9a17bccaa575860b464a1739488782?s=128&d=identicon&r=PG", "display_name": "dahc", "link": "https://stackoverflow.com/users/1164802/dahc"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1452543211, "post_id": 34729915, "comment_id": 57206604, "body": "@evanmcdonnal I&#39;m not sure what you mean. IPNet.IP is the network number, not the IP that was parsed, and we just need containment."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1452543865, "post_id": 34729915, "comment_id": 57206934, "body": "Should work fine in that case. Guess I need to read the docs."}], "tags": [], "owner": {"reputation": 404, "user_id": 1164802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9a17bccaa575860b464a1739488782?s=128&d=identicon&r=PG", "display_name": "dahc", "link": "https://stackoverflow.com/users/1164802/dahc"}, "is_accepted": true, "score": 9, "last_activity_date": 1452542579, "last_edit_date": 1452542579, "creation_date": 1452542028, "answer_id": 34729915, "question_id": 34729158, "link": "https://stackoverflow.com/questions/34729158/how-to-detect-if-two-golang-net-ipnet-objects-intersect/34729915#34729915", "title": "How to detect if two Golang net.IPNet objects intersect?", "body": "<p>If (as your test cases seem to imply) you don't care about which side contains which, but just that there's overlap, this should be sufficient.</p>\n\n<pre><code>func intersect(n1, n2 *net.IPNet) bool {\n    return n2.Contains(n1.IP) || n1.Contains(n2.IP)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "edited": false, "score": 0, "creation_date": 1452542609, "post_id": 34729993, "comment_id": 57206284, "body": "&quot;It succeeds in all test cases from your question, except the first one. But after all, 1.1.0.2/16 is not really a subnet of 1.1.1.1/24 (it&#39;s the other way around).&quot; Thanks. However, I really need to detect any intersection, if n1 is subnet of n2, or if n2 is subnet of n1. I&#39;ll update the question to make this clear."}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 4, "last_activity_date": 1452542303, "creation_date": 1452542303, "answer_id": 34729993, "question_id": 34729158, "link": "https://stackoverflow.com/questions/34729158/how-to-detect-if-two-golang-net-ipnet-objects-intersect/34729993#34729993", "title": "How to detect if two Golang net.IPNet objects intersect?", "body": "<p>You can use the fact that IP addresses (<code>net.IP</code>) and netmasks (<code>net.IPMask</code>) are simply byte slices (<code>[]byte</code>) that contain the binary IP addresses. You can use the usual bitwise-operators on the network addresses and their masks to determine if one network is a subnet of another:</p>\n\n<pre><code>func intersect(n1, n2 *net.IPNet) bool {\n    for i := range n1.IP {\n        if n1.IP[i] &amp; n1.Mask[i] != n2.IP[i] &amp; n2.Mask[i] &amp; n1.Mask[i] {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n\n<p>This function is missing some basic sanity checks (for example, it would break when passed one IPv4 and one IPv6 address), but the example should be sufficient to get the gist of it.</p>\n\n<p>It succeeds in all test cases from your question, except the first one. But after all, <code>1.1.0.2/16</code> is not really a subnet of <code>1.1.1.1/24</code> (it's the other way around).</p>\n\n<blockquote>\n  <p><a href=\"https://play.golang.org/p/Kur5n2hfLg\" rel=\"nofollow\">https://play.golang.org/p/Kur5n2hfLg</a></p>\n</blockquote>\n"}], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3292, "favorite_count": 2, "accepted_answer_id": 34729915, "answer_count": 2, "score": 7, "last_activity_date": 1452542762, "creation_date": 1452539291, "last_edit_date": 1452542762, "question_id": 34729158, "link": "https://stackoverflow.com/questions/34729158/how-to-detect-if-two-golang-net-ipnet-objects-intersect", "title": "How to detect if two Golang net.IPNet objects intersect?", "body": "<p>How to detect if there is intersection between two Golang <a href=\"https://golang.org/pkg/net/#IPNet\" rel=\"noreferrer\">net.IPNet</a> objects?</p>\n\n<p>That is, how to check <strong>both</strong> if the first network is subnet of the second one <strong>OR</strong> if the second network is subnet of the first one.</p>\n\n<p>Does Go provide any utility function ready for this specific task?</p>\n\n<p>See test code below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    _, net1, _ := net.ParseCIDR(\"1.1.1.1/24\")\n    _, net2, _ := net.ParseCIDR(\"1.1.0.2/16\")\n    _, net3, _ := net.ParseCIDR(\"1.1.1.3/25\")\n    _, net4, _ := net.ParseCIDR(\"1.2.0.4/16\")\n\n    test(net1, net2, true)\n    test(net2, net1, true)\n    test(net1, net3, true)\n    test(net3, net1, true)\n    test(net1, net4, false)\n    test(net4, net1, false)\n}\n\nfunc test(n1, n2 *net.IPNet, expect bool) {\n    result := intersect(n1, n2)\n    var label string\n    if result == expect {\n        label = \"good\"\n    } else {\n        label = \"FAIL\"\n    }\n    fmt.Printf(\"test intersect(%v,%v)=%v expected=%v =&gt; %s\\n\", n1, n2, result, expect, label)\n}\n\nfunc intersect(n1, n2 *net.IPNet) bool {\n    return false // FIXME WRITEME\n}\n</code></pre>\n\n<p>Run it on <a href=\"http://play.golang.org/p/UZJ1tz5RQ5\" rel=\"noreferrer\">Go Playground</a></p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1452536688, "post_id": 34728033, "comment_id": 57202960, "body": "And what is that error that it returns?"}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 3434573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afe9a6d73e2dd14034dfff512ebce83c?s=128&d=identicon&r=PG&f=1", "display_name": "nico", "link": "https://stackoverflow.com/users/3434573/nico"}, "is_accepted": true, "score": 0, "last_activity_date": 1452588450, "creation_date": 1452588450, "answer_id": 34739050, "question_id": 34728033, "link": "https://stackoverflow.com/questions/34728033/google-app-engine-golang-datastore-getall-not-working/34739050#34739050", "title": "Google app engine: Golang datastore.GetAll() not working", "body": "<p>Okay, I now know what went wrong. When I finally figured out how to log an error in app engine, it said:</p>\n\n<pre><code>API error 1 (datastore_v3: BAD_REQUEST): cannot write more than 500 entities in a single call\n</code></pre>\n\n<p>So all I had to do, was to change the <em>Limit</em> parameter from <strong>1000</strong> to <strong>500</strong> like this:</p>\n\n<pre><code>query := datastore.NewQuery(\"Essen\").Limit(500).KeysOnly()\n</code></pre>\n\n<p>Now it works like intended.</p>\n"}], "owner": {"reputation": 126, "user_id": 3434573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afe9a6d73e2dd14034dfff512ebce83c?s=128&d=identicon&r=PG&f=1", "display_name": "nico", "link": "https://stackoverflow.com/users/3434573/nico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 34739050, "answer_count": 1, "score": 0, "last_activity_date": 1471490452, "creation_date": 1452535003, "last_edit_date": 1471490452, "question_id": 34728033, "link": "https://stackoverflow.com/questions/34728033/google-app-engine-golang-datastore-getall-not-working", "title": "Google app engine: Golang datastore.GetAll() not working", "body": "<p>Once a week a cron job calls the following function in one of my app engine projects:</p>\n\n<pre><code>func cleanMealsFromDatabase(context appengine.Context) error {\n    query := datastore.NewQuery(\"Essen\").Limit(1000).KeysOnly()\n    keys, err := query.GetAll(context, nil)\n    if err != nil {\n        return err\n    }\n    return datastore.DeleteMulti(context, keys)\n}\n</code></pre>\n\n<p>I'm trying to batch delete a bunch of datastore entities. The function gets called correctly, but</p>\n\n<pre><code>query.GetAll(context, nil)\n</code></pre>\n\n<p>seems to always return an error. Am I doing something wrong?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1452530800, "post_id": 34726573, "comment_id": 57199367, "body": "But why  necessarily struct?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452531056, "post_id": 34726573, "comment_id": 57199542, "body": "<code>T</code> doesn&#39;t need to be a struct, just any type declared in the package."}], "tags": [], "owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "is_accepted": true, "score": 2, "last_activity_date": 1452530190, "last_edit_date": 1452530190, "creation_date": 1452530080, "answer_id": 34726573, "question_id": 34726499, "link": "https://stackoverflow.com/questions/34726499/what-is-the-easy-way-to-make-method-from-function-in-go/34726573#34726573", "title": "What is the easy way to make method from function in Go?", "body": "<p>Assuming T is a struct, you could: </p>\n\n<pre><code>func (t T) Foo() {\n    Foo(t)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1452530639, "post_id": 34726597, "comment_id": 57199245, "body": "Yes I see and totally agree. Are you sure there are no another way? Can we wait a bit for miracle answer?"}, {"owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "edited": false, "score": 0, "creation_date": 1452530775, "post_id": 34726597, "comment_id": 57199351, "body": "IMHO there&#39;s no better solution."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1452532244, "post_id": 34726597, "comment_id": 57200386, "body": "Daniele D Nothing wrong. Just having so clear and concise Foo := T.Foo I wonder the same in opposite direction, which case is more frequent in practice. Semantically and technically operations looks symmetric."}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 3, "last_activity_date": 1452530131, "creation_date": 1452530131, "answer_id": 34726597, "question_id": 34726499, "link": "https://stackoverflow.com/questions/34726499/what-is-the-easy-way-to-make-method-from-function-in-go/34726597#34726597", "title": "What is the easy way to make method from function in Go?", "body": "<p>If you want to keep the function <code>Foo(t T)</code>, for example for backwards-compatibility, you can simply define a struct method that calls the already-existing function:</p>\n\n<pre><code>type T struct {\n    // ...\n}\n\nfunc Foo(t T) {\n    // ...\n}\n\n// Define new method that just calls the Foo function\nfunc (t T) Foo() {\n    Foo(t)\n}\n</code></pre>\n\n<p>Alternatively, you can easily change the function signature from <code>func Foo(t T)</code> to <code>func (t T) Foo()</code>. As long as you do not change the name of <code>t</code>, you will not have to rewrite the function itself any further.</p>\n"}, {"comments": [{"owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "edited": false, "score": 0, "creation_date": 1452582549, "post_id": 34726893, "comment_id": 57220924, "body": "that&#39;s so ugly but still a nice idea"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1452531358, "last_edit_date": 1452531358, "creation_date": 1452531054, "answer_id": 34726893, "question_id": 34726499, "link": "https://stackoverflow.com/questions/34726499/what-is-the-easy-way-to-make-method-from-function-in-go/34726893#34726893", "title": "What is the easy way to make method from function in Go?", "body": "<p>Others have already pointed out the best way to do this:</p>\n\n<pre><code>func (t T) Foo() { Foo(t) }\n</code></pre>\n\n<p>But if you for some reason need to do this at runtime, you can do something like this: </p>\n\n<pre><code>func (t *T) SetFoo(foo func(T)) {\n    t.foo = foo\n}\n\nfunc (t T) CallFoo() {\n    t.foo(t)\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/A3G-V0moyH\" rel=\"nofollow\">http://play.golang.org/p/A3G-V0moyH</a>.</p>\n\n<p>This is obviously not something you would normally do. Unless there is a reason, I'd suggest sticking with methods and functions as they are.</p>\n"}], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 34726573, "answer_count": 3, "score": 0, "last_activity_date": 1452531358, "creation_date": 1452529837, "question_id": 34726499, "link": "https://stackoverflow.com/questions/34726499/what-is-the-easy-way-to-make-method-from-function-in-go", "title": "What is the easy way to make method from function in Go?", "body": "<p>It's quite trivial to get function from method using method expression</p>\n\n<pre><code>func (t T) Foo(){}\nFoo := T.Foo       //yelds a function with signature Foo(t T)\n</code></pre>\n\n<p>Now suppose I already have</p>\n\n<pre><code>func Foo(t T)\n</code></pre>\n\n<p>can I get method <code>T.Foo()</code> without rewriting, or at least easy way?</p>\n"}, {"tags": ["go", "cassandra", "debian"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1452529671, "post_id": 34726401, "comment_id": 57198585, "body": "While it shouldn&#39;t affect any other part of your system, just install it via the official instructions: <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">golang.org/doc/install</a> and there won&#39;t be any issues."}], "owner": {"reputation": 131, "user_id": 5645343, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aceafcadfded241dc64799a0a326cf83?s=128&d=identicon&r=PG&f=1", "display_name": "batflaps", "link": "https://stackoverflow.com/users/5645343/batflaps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1452529515, "creation_date": 1452529515, "question_id": 34726401, "link": "https://stackoverflow.com/questions/34726401/golang-1-5-cassandra-from-debian-repos", "title": "golang 1.5/cassandra from debian repos?", "body": "<p>I found golang 1.5 in Debian unstable/testing (which I need for cassandra gocql driver), has anyone installed this successfully without breaking the rest of Jessie, or should I just compile? Jessie has golang 1.3</p>\n"}, {"tags": ["multithreading", "macos", "user-interface", "go", "goroutine"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1452526137, "post_id": 34724912, "comment_id": 57196036, "body": "I think it&#39;s way more common to write a web-interface for your go application, e.g. syncthing does that. You could achieve notifications with HTML5 (maybe?) and an icon with a simple url, or something like that"}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 2, "creation_date": 1452526381, "post_id": 34724912, "comment_id": 57196219, "body": "@mrd0ll4r and how would one add tray icon with HTML5? Afaik there is no way to do such thing. There is no window per se (yet). But only tray icon and notifications. Introducing entire web interface is not in the scope of this app"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452527778, "post_id": 34724912, "comment_id": 57197262, "body": "I think this is usually done with 2 processes and some IPC."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1452529410, "post_id": 34724912, "comment_id": 57198388, "body": "You did not tell us much, but from your question it appears you already use <i>something</i> to do the UI. I would then made that <i>something</i> accept a request to show things in the system tray icon, and then made your Go side do those requests. Exact implementation is highly dependent on what is used for the UI but I think if you&#39;ll ask a proper (that is, with much more details provided -- to stay away from &quot;The XY Problem&quot;) question on the <a href=\"https://groups.google.com/forum/#!forum/golang-nuts\" rel=\"nofollow noreferrer\">go-nuts mailing list</a> we&#39;ll be able to sort that problem out somehow."}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1452529765, "post_id": 34724912, "comment_id": 57198650, "body": "@kostix I not just use &quot;something&quot; but give direct reference to the libraries that I am using (check the links) since this may help someone with a knowledge to answer this question. This is a well known problem on OS X and there was no solution that I found so far. So someone familiar with the topic will have no difficulty understanding question and issue in it. Don&#39;t see how I could improve question apart of giving code snippets which again is not necessary as issue is well known."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1452530224, "post_id": 34724912, "comment_id": 57198953, "body": "Sure I did check the links; found nothing about the &quot;UI&quot; part. Hence I assumed your UI was something implemented in C or ObjC (or whatever). I, for one, still have no idea how the UI part is implemented. All in all, it&#39;s your question so if you think everything is okay with it, it&#39;s indeed probably okay for you. Hope you&#39;ll get the help sought."}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1452530326, "post_id": 34724912, "comment_id": 57199034, "body": "@kostix well, any advice on how to improve question is appreciated. Just saying &quot;need to improve&quot; does not show what&#39;s not understood. I will try to add code snippet later."}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1452550789, "post_id": 34724912, "comment_id": 57210687, "body": "@AlexKey ah yes, I mistook tray icons for something like pinned taskbar entries on windows, or an entry in the dock for OSX, sorry about that. I&#39;d still recommend to realize most of your UI as a web app. You could fix your problem by porting everything except the tray icon stuff..."}], "answers": [{"comments": [{"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 2, "creation_date": 1452530130, "post_id": 34726387, "comment_id": 57198895, "body": "I&#39;ve read description of LockOsThread. The problem is that using two libraries that both require their current thread being locked to system thread causes app to crash. This is because while one thread is locked second one tries to lock. There is no global mutex in LockOsThread. So need some solution to this problem. As said IPC is one of them where I can put those two libs each in separate process so that each can lock independently. But that is going to be big mess. Maybe there is better solution?"}], "tags": [], "owner": {"reputation": 6092, "user_id": 34441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b4df79451afb371e0d5f60e86d9988?s=128&d=identicon&r=PG", "display_name": "ellisbben", "link": "https://stackoverflow.com/users/34441/ellisbben"}, "is_accepted": false, "score": 2, "last_activity_date": 1452533536, "last_edit_date": 1452533536, "creation_date": 1452529465, "answer_id": 34726387, "question_id": 34724912, "link": "https://stackoverflow.com/questions/34724912/go-on-os-x-two-libraries-call-system-functions/34726387#34726387", "title": "go on OS X - Two libraries call system functions", "body": "<p>It looks like the two libraries that you are using both correctly use <code>runtime.LockOSThread</code> to make main-thread-only API calls; unfortunately, to use more than one such library, you'll have to do something fancier than the example code that either provides.  You'll need to write your own main thread / <code>main.Main</code>-invoked message loop that handles calls to multiple MTO APIs.</p>\n\n<p><a href=\"https://golang.org/pkg/runtime/#LockOSThread\" rel=\"nofollow\"><code>runtime.LockOSThread</code></a> is part of the solution to operating with APIs such as this; the golang wiki <a href=\"https://github.com/golang/go/wiki/LockOSThread\" rel=\"nofollow\">has a page</a> about how to use it to interact with \"call from main thread only\" APIs.</p>\n\n<p>An extremely short description of how your program should change:</p>\n\n<p>You'll want to use <a href=\"https://golang.org/pkg/runtime/#LockOSThread\" rel=\"nofollow\"><code>runtime.LockOSThread</code></a> in <code>main.init</code> to make sure that the main thread is running <code>main.Main</code>; <code>main.Main</code> should be refactored into two parts:</p>\n\n<ol>\n<li>starts a goroutine or goroutines that run what previously was in <code>main.Main</code>;</li>\n<li>enters a message loop receiving messages to take certain main-thread actions on one or more channels</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "is_accepted": false, "score": 3, "last_activity_date": 1452943834, "creation_date": 1452943834, "answer_id": 34826423, "question_id": 34724912, "link": "https://stackoverflow.com/questions/34724912/go-on-os-x-two-libraries-call-system-functions/34826423#34826423", "title": "go on OS X - Two libraries call system functions", "body": "<p>Since there is not enough traction on this question I've decided to post my own solution I found while trying to workaround this issue. This won't be marked as answer yet since someone else may provide better solution.</p>\n\n<p>I have moved one of the UI processes (namely part that uses systray) into another binary and call it using <code>cmd := exec.Command(...)</code> and <code>cmd.Start()</code> then I pipe <code>stdin</code> and <code>stdout</code> and communicate with this child process through those.</p>\n\n<p>The example code can be found on <a href=\"https://gist.github.com/akamensky/48ad7009af2cd9474447\" rel=\"nofollow\">Github</a>. <strong>Warning</strong> there is an error in this gist where after child exits main process will start burning through CPU cycles. Feel free to fix it yourself.</p>\n\n<p>The reason why I did not want to go through with RPC is because this will become slightly too complex to what I want to achieve and does not provide easy way to do two way communication.</p>\n"}], "owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1452943834, "creation_date": 1452525415, "question_id": 34724912, "link": "https://stackoverflow.com/questions/34724912/go-on-os-x-two-libraries-call-system-functions", "title": "go on OS X - Two libraries call system functions", "body": "<p>I am finding it difficult to write something with more or less common UI at least for Mac. My application has to have <a href=\"https://github.com/getlantern/systray\" rel=\"nofollow\">tray icon</a> and be able to show <a href=\"https://github.com/deckarep/gosx-notifier\" rel=\"nofollow\">system notifications</a></p>\n\n<p>The issue is the goroutines themselves. Any call to UI frameworks on Mac requires that the call is made from main thread, or at least in a thread-safe manner.</p>\n\n<p>The issue arise when I am already running UI (well, for GUI application that is a must, no?) and try to show notification. The reason for this seems to be that systray package Init function has to be locked to main thread using <code>runtime.LockOsThread</code> and never releases it. Then if I try to show notification which also requires <code>runtime.LockOsThread</code> it causes following error:</p>\n\n<pre><code>2016-01-11 22:56:27.973 main[30162:4094392] *** Assertion failure in +[NSUndoManager _endTopLevelGroupings], /Library/Caches/com.apple.xbs/Sources/Foundation/Foundation-1256.1/Misc.subproj/NSUndoManager.m:359\n2016-01-11 22:56:27.974 main[30162:4094392] +[NSUndoManager(NSInternal) _endTopLevelGroupings] is only safe to invoke on the main thread.\n2016-01-11 22:56:27.977 main[30162:4094392] (\n    0   CoreFoundation                      0x00007fff8d42bae2 __exceptionPreprocess + 178\n    1   libobjc.A.dylib                     0x00007fff8bb03f7e objc_exception_throw + 48\n    2   CoreFoundation                      0x00007fff8d42b8ba +[NSException raise:format:arguments:] + 106\n    3   Foundation                          0x00007fff8cb4c88c -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 198\n    4   Foundation                          0x00007fff8cad24c1 +[NSUndoManager(NSPrivate) _endTopLevelGroupings] + 170\n    5   AppKit                              0x00007fff8514206a -[NSApplication run] + 844\n    6   main                                0x0000000004166200 nativeLoop + 128\n    7   main                                0x0000000004165bca _cgo_8c6479959095_Cfunc_nativeLoop + 26\n    8   main                                0x000000000405a590 runtime.asmcgocall + 112\n)\n2016-01-11 22:56:27.977 main[30162:4094392] *** Assertion failure in +[NSUndoManager _endTopLevelGroupings], /Library/Caches/com.apple.xbs/Sources/Foundation/Foundation-1256.1/Misc.subproj/NSUndoManager.m:359\n2016-01-11 22:56:27.978 main[30162:4094392] An uncaught exception was raised\n2016-01-11 22:56:27.978 main[30162:4094392] +[NSUndoManager(NSInternal) _endTopLevelGroupings] is only safe to invoke on the main thread.\n</code></pre>\n\n<p>Is there a workaround that? All I could think of so far is to put UI and Notifications into separate binaries and make them to communicate with main over some sort of IPC. But I may be missing something.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1452527384, "post_id": 34724160, "comment_id": 57196977, "body": "You don&#39;t need to create a new <code>http.Client</code> for every request, they are intended to be use multiple times."}], "answers": [{"comments": [{"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "edited": false, "score": 0, "creation_date": 1452591827, "post_id": 34724481, "comment_id": 57225993, "body": "thanks for your answer, it seems to have some compilation error <code>$http.Client{}</code> the <code>$</code>,   and   http.NewRequest seems to require a string not a URL object"}, {"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "edited": false, "score": 1, "creation_date": 1452592935, "post_id": 34724481, "comment_id": 57226773, "body": "I also needed to add <code>url.Scheme = &quot;http&quot;</code>"}, {"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "edited": false, "score": 0, "creation_date": 1452592980, "post_id": 34724481, "comment_id": 57226806, "body": "and I don&#39;t know if it&#39;s needed, but replacing the double for loop by  <code>proxyReq.Header = req.Header</code> seems to work"}, {"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "reply_to_user": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "edited": false, "score": 0, "creation_date": 1452593104, "post_id": 34724481, "comment_id": 57226892, "body": "As long as you&#39;re not modifying the headers, that&#39;s fine. If you want to pass different headers to the other service (note I&#39;m adding a <code>X-Forwarded-For</code> header, in my example), it&#39;s usually better to actually copy the headers."}, {"owner": {"reputation": 2219, "user_id": 8608146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3B2gl.jpg?s=128&g=1", "display_name": "Phani Rithvij", "link": "https://stackoverflow.com/users/8608146/phani-rithvij"}, "edited": false, "score": 0, "creation_date": 1605820646, "post_id": 34724481, "comment_id": 114777389, "body": "There&#39;s a Header.Clone() method so no need to loop ourselves. Also copy headers to the <code>w</code> response via the sample loop over <code>proxyRes</code> proxy response like <code>w.Header().Add(header, value)</code> if forwarding a request"}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 10, "last_activity_date": 1452591879, "last_edit_date": 1452591879, "creation_date": 1452524195, "answer_id": 34724481, "question_id": 34724160, "link": "https://stackoverflow.com/questions/34724160/go-http-send-incoming-http-request-to-an-other-server-using-client-do/34724481#34724481", "title": "Go http, send incoming http.request to an other server using client.Do", "body": "<p>In my experience, the easiest way to achieve this was to simply create a new request and copy all request attributes that you need into the new request object:</p>\n\n<pre><code>func(rw http.ResponseWriter, req *http.Request) {\n    url := req.URL\n    url.Host = \"v2ofdoom.local:8081\"\n\n    proxyReq, err := http.NewRequest(req.Method, url.String(), req.Body)\n    if err != nil {\n        // handle error\n    }\n\n    proxyReq.Header.Set(\"Host\", req.Host)\n    proxyReq.Header.Set(\"X-Forwarded-For\", req.RemoteAddr)\n\n    for header, values := range req.Header {\n        for _, value := range values {\n            proxyReq.Header.Add(header, value)\n        }\n    }\n\n    client := &amp;http.Client{}\n    proxyRes, err := client.Do(proxyReq)\n\n    // and so on...\n</code></pre>\n\n<p>This approach has the benefit of not modifying the original request object (maybe your handler function or any middleware functions that are living in your stack still need the original object?).</p>\n"}, {"comments": [{"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "edited": false, "score": 0, "creation_date": 1452592461, "post_id": 34725635, "comment_id": 57226462, "body": "I needed to define  <code>httpClient := http.Client{}</code> , proxyscheme and proxyhost, but yoursolutions seems to work , thanks"}, {"owner": {"reputation": 355, "user_id": 2100241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64ca0d200d28e6ab5e6c4da304354d23?s=128&d=identicon&r=PG", "display_name": "Samuel Horwitz", "link": "https://stackoverflow.com/users/2100241/samuel-horwitz"}, "edited": false, "score": 2, "creation_date": 1563299062, "post_id": 34725635, "comment_id": 100650861, "body": "It appears that for Go 1.13 (which will be released next month I believe) this should be relatively simplified. You should be able to call <code>req.Clone(&lt;context&gt;)</code> and get back a cloned <code>*http.Request</code> with it&#39;s context set to the context of your choosing. <a href=\"https://go-review.googlesource.com/c/go/+/174324/\" rel=\"nofollow noreferrer\">go-review.googlesource.com/c/go/+/174324</a>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 28, "last_activity_date": 1452529467, "last_edit_date": 1452529467, "creation_date": 1452527320, "answer_id": 34725635, "question_id": 34724160, "link": "https://stackoverflow.com/questions/34724160/go-http-send-incoming-http-request-to-an-other-server-using-client-do/34725635#34725635", "title": "Go http, send incoming http.request to an other server using client.Do", "body": "<p>You need to copy the values you want into a new request. Since this is very similar to what a reverse proxy does, you may want to look at what <a href=\"https://golang.org/pkg/net/http/httputil/\" rel=\"noreferrer\">\"net/http/httputil\"</a> does for <code>ReverseProxy</code>.</p>\n\n<p>Create a new request, and copy only the parts of the request you want to send to the next server. You will also need to read and buffer the request body if you intend to use it both places:</p>\n\n<pre><code>func handler(w http.ResponseWriter, req *http.Request) {\n    // we need to buffer the body if we want to read it here and send it\n    // in the request. \n    body, err := ioutil.ReadAll(req.Body)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    // you can reassign the body if you need to parse it as multipart\n    req.Body = ioutil.NopCloser(bytes.NewReader(body))\n\n    // create a new url from the raw RequestURI sent by the client\n    url := fmt.Sprintf(\"%s://%s%s\", proxyScheme, proxyHost, req.RequestURI)\n\n    proxyReq, err := http.NewRequest(req.Method, url, bytes.NewReader(body))\n\n    // We may want to filter some headers, otherwise we could just use a shallow copy\n    // proxyReq.Header = req.Header\n    proxyReq.Header = make(http.Header)\n    for h, val := range req.Header {\n        proxyReq.Header[h] = val\n    }\n\n    resp, err := httpClient.Do(proxyReq)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusBadGateway)\n        return\n    }\n    defer resp.Body.Close()\n\n    // legacy code\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14483622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b4733cad3d878c5d8f6eba04135d43?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Kuznetsou", "link": "https://stackoverflow.com/users/14483622/artur-kuznetsou"}, "is_accepted": false, "score": 0, "last_activity_date": 1614159198, "creation_date": 1614159198, "answer_id": 66348132, "question_id": 34724160, "link": "https://stackoverflow.com/questions/34724160/go-http-send-incoming-http-request-to-an-other-server-using-client-do/66348132#66348132", "title": "Go http, send incoming http.request to an other server using client.Do", "body": "<p>I've seen the accepted anwser, but I would like to say that I dont like this. I've used this code for months with it working, but after some time you encounter requests that break (<code>POST</code> requests in my case). My preferred solution is the following:</p>\n<pre><code>r.URL.Host = &quot;example.com&quot;\nr.RequestURI = &quot;&quot;\nclient := &amp;http.Client{}\n\ndelete(r.Header, &quot;Accept-Encoding&quot;)\ndelete(r.Headers, &quot;Content-Length&quot;)\nresp, err := client.Do(r.WithContext(context.Background())\nif err != nil {\n    return nil, err\n}\nreturn resp, nil\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 475, "user_id": 1823890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc2776550b2995a9d0090bbb2005dcd1?s=128&d=identicon&r=PG", "display_name": "user1823890", "link": "https://stackoverflow.com/users/1823890/user1823890"}, "is_accepted": false, "score": 0, "last_activity_date": 1614868543, "creation_date": 1614868543, "answer_id": 66477187, "question_id": 34724160, "link": "https://stackoverflow.com/questions/34724160/go-http-send-incoming-http-request-to-an-other-server-using-client-do/66477187#66477187", "title": "Go http, send incoming http.request to an other server using client.Do", "body": "<p>Using original request (copy or duplicate only if original request still need):</p>\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    // Step 1: rewrite URL\n    URL, _ := url.Parse(&quot;https://full_generic_url:123/x/y&quot;)\n    r.URL.Scheme = URL.Scheme\n    r.URL.Host = URL.Host\n    r.URL.Path = singleJoiningSlash(URL.Path, r.URL.Path)\n    r.RequestURI = &quot;&quot;\n\n    // Step 2: adjust Header\n    r.Header.Set(&quot;X-Forwarded-For&quot;, r.RemoteAddr)\n\n    // note: client should be created outside the current handler()\n    client := &amp;http.Client{} \n    // Step 3: execute request\n    resp, err := client.Do(r)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    // Step 4: copy payload to response writer\n    copyHeader(w.Header(), resp.Header)\n    w.WriteHeader(resp.StatusCode)\n    io.Copy(w, resp.Body)\n    resp.Body.Close()\n}\n\n// copyHeader and singleJoiningSlash are copy from &quot;/net/http/httputil/reverseproxy.go&quot;\nfunc copyHeader(dst, src http.Header) {\n    for k, vv := range src {\n        for _, v := range vv {\n            dst.Add(k, v)\n        }\n    }\n}\n\nfunc singleJoiningSlash(a, b string) string {\n    aslash := strings.HasSuffix(a, &quot;/&quot;)\n    bslash := strings.HasPrefix(b, &quot;/&quot;)\n    switch {\n    case aslash &amp;&amp; bslash:\n        return a + b[1:]\n    case !aslash &amp;&amp; !bslash:\n        return a + &quot;/&quot; + b\n    }\n    return a + b\n}\n\n</code></pre>\n"}], "owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15621, "favorite_count": 8, "accepted_answer_id": 34725635, "answer_count": 4, "score": 19, "last_activity_date": 1614868543, "creation_date": 1452523221, "question_id": 34724160, "link": "https://stackoverflow.com/questions/34724160/go-http-send-incoming-http-request-to-an-other-server-using-client-do", "title": "Go http, send incoming http.request to an other server using client.Do", "body": "<p>Here my use case</p>\n\n<p>We have one services \"foobar\"  which has two version <code>legacy</code>  and <code>version_2_of_doom</code>   (both in go)</p>\n\n<p>In order to make the transition from <code>legacy</code> to <code>version_2_of_doom</code> , we would like in a first time, to have the  two version alongside, and have the POST request (as there's only one  POST api call in this ) received on both.</p>\n\n<p>The way I see how to do it. Would be</p>\n\n<ol>\n<li><p>modifying the code of <code>legacy</code>  at the beginning of the handler, in order to duplicate the request to <code>version_2_of_doom</code></p>\n\n<pre><code> func(w http.ResponseWriter, req *http.Request) {\n     req.URL.Host = \"v2ofdoom.local:8081\"\n     req.Host = \"v2ofdoom.local:8081\"\n     client := &amp;http.Client{}\n     client.Do(req)\n     // legacy code \n</code></pre></li>\n</ol>\n\n<p>but it seems to not be as straightforward as this </p>\n\n<p>it fails with  <code>http: Request.RequestURI can't be set in client requests.</code> </p>\n\n<p>Is there a well-known method to do this kind of action (i.e transfering without touching) a <code>http.Request</code> to an other server ?</p>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1452516437, "post_id": 34721037, "comment_id": 57189497, "body": "Sounds like this really might be GC."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1452517858, "post_id": 34721037, "comment_id": 57190469, "body": "Have you tried profiling your code to see where most allocations come from? You could also try to switch to 1.5 which has a better concurrent collector and see if it&#39;s any better."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 3, "creation_date": 1452519107, "post_id": 34721037, "comment_id": 57191278, "body": "Better yet, try it with Go 1.6 beta which should be even better with regards to GC pauses. but 3 second pauses on a 30G app seems plausible for go 1.4."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452520478, "post_id": 34721037, "comment_id": 57192225, "body": "Ae the others have said, use go1.5 or go1.6. If you suspect the GC, just run with gctrace on to see exactly what it&#39;s doing."}, {"owner": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1452563920, "post_id": 34721037, "comment_id": 57215063, "body": "@Not_a_Golfer Can you give some more info, blog preferred, about the gc behavior in golang 1.4."}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 0, "last_activity_date": 1452655206, "creation_date": 1452655206, "answer_id": 34757840, "question_id": 34721037, "link": "https://stackoverflow.com/questions/34721037/what-is-the-cpu-cores-caused-by-gc-in-golang-1-4-1/34757840#34757840", "title": "What is the cpu cores caused by GC in Golang 1.4.1", "body": "<p>You've really gotta profile to figure a problem like this out.</p>\n\n<p>That said you might be able to reduce the load you put on the garbage collector. Here are a couple of suggestions:</p>\n\n<ol>\n<li>Linked lists result in a lot of small allocations. Have you considered using a <code>[]map[string][]whatever_you_are_storing</code>?</li>\n<li>Are you adding and removing things from this giant map? Are the things you're adding and removing all basically the same? If so you may be able to use a <a href=\"https://godoc.org/sync#Pool\" rel=\"nofollow\"><code>sync.Pool</code></a>.</li>\n<li>Have you tried storing the item directly: <code>map[string]list</code> instead of <code>map[string]*list</code>. It will change the behavior of your program, but for a small struct it may make sense anyway.</li>\n</ol>\n\n<p>Those are shots in the dark.</p>\n"}], "owner": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1452655206, "creation_date": 1452513521, "question_id": 34721037, "link": "https://stackoverflow.com/questions/34721037/what-is-the-cpu-cores-caused-by-gc-in-golang-1-4-1", "title": "What is the cpu cores caused by GC in Golang 1.4.1", "body": "<p>I have recently come across a situation where one of our Golang app, consuming almost 30GB memory, will periodically eating all 24 cpu cores with nearly almost 100%. This will last maybe for more than 3 seconds. Our Golang version is 1.4.1 on linux 64-bit.</p>\n\n<p>I have googled for some info. Here is my assumption:  </p>\n\n<ul>\n<li>in our app, we use a data type <code>[]map[string]*list</code> and the instance of this type will contain more than 250K keys.</li>\n<li>maybe the gc in golang 1.4.1 consuming more cpu time and stop the world. However, i can not find the parameter to configure the parallelism of gc goroutines(threads). And, does it have some relationship with the <code>GOMAXPROCS</code> parameter.</li>\n</ul>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 1889, "user_id": 892404, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6c64aa7f128d8b6e4cfeafae93782ec7?s=128&d=identicon&r=PG", "display_name": "Parham Doustdar", "link": "https://stackoverflow.com/users/892404/parham-doustdar"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1452507370, "post_id": 34718430, "comment_id": 57183638, "body": "It makes perfect sense. Can you add it as an answer so that I can accept?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1452507798, "creation_date": 1452507798, "answer_id": 34719094, "question_id": 34718430, "link": "https://stackoverflow.com/questions/34718430/how-can-i-orchestrate-concurrent-request-response-flow/34719094#34719094", "title": "How can I orchestrate concurrent request-response flow?", "body": "<p>Create a per request response channel and include it in the value sent to the worker. The handler receives from the channel. The worker sends the result to the channel.</p>\n"}], "owner": {"reputation": 1889, "user_id": 892404, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6c64aa7f128d8b6e4cfeafae93782ec7?s=128&d=identicon&r=PG", "display_name": "Parham Doustdar", "link": "https://stackoverflow.com/users/892404/parham-doustdar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 34719094, "answer_count": 1, "score": 0, "last_activity_date": 1452507798, "creation_date": 1452505935, "last_edit_date": 1452507345, "question_id": 34718430, "link": "https://stackoverflow.com/questions/34718430/how-can-i-orchestrate-concurrent-request-response-flow", "title": "How can I orchestrate concurrent request-response flow?", "body": "<p>I'm new to concurrent programming, and have no idea what concepts to start with, so please be gentle.</p>\n\n<p>I am writing a webservice as a front-end to a TCP server. This server listens to the port I give it, and returns the response to the TCP connection for each request.</p>\n\n<p>Here is why I'm writing a web-service front-end for this server:</p>\n\n<ul>\n<li>The server can handle one request at a time, and I'm trying to make it be able to process several inputs concurrently, by launching multiple processes and giving them a different port to listen on. For example, I want to launch 30 instances and tell them to listen on ports 20000-20029.</li>\n<li>Our team uses PHP, and PHP does not have the capacity to launch server instances and maintain them concurrently, so I'm trying to write an API they can just send HTTP requests to.</li>\n</ul>\n\n<p>So, here is the structure I have thought of.</p>\n\n<ol>\n<li>I will have a <code>main()</code> function. This function launches the processes concurrently, then starts an HTTP server on port 80 and listens.</li>\n<li>I have an <code>http.Handler</code> that adds the content of a request to a channel,.</li>\n<li>I will have gorutines, one per server instance, that are in an infinite loop.</li>\n</ol>\n\n<p>The code for the function mentioned in item three would be something like this:</p>\n\n<pre><code>func handleRequest(queue chan string) {\n    for {\n        request := &lt;-queue\n        conn, err := connectToServer()\n        err = sendRequestToServer(conn)\n        response, err := readResponseFromServer(conn)\n    }\n}\n</code></pre>\n\n<p>So, my <code>http.Handler</code> can simply do something like <code>queue&lt;- request</code> to add the request to the queue, and <code>handleRequest</code>, which has blocked, waiting for the channel to have something to get, will simply get the request and continue on. When done, the loop finishes, execution comes back to the <code>request := &lt;-queue</code>, and the same thing continues.</p>\n\n<p>My problem starts in the <code>http.Handler</code>. It makes perfect sense to put requests in a channel, because multiple gorutines are all listening to it. However, how can these gorutines return the result to my <code>http.Handler</code>?</p>\n\n<p>One way is to use a channel, let's call it <code>responseQueue</code>, that all of these gorutines would then write to. The problem is that when a response is added to the channel, I don't know which request it belongs to. In other words, when multiple <code>http.Handler</code>s send requests, each executing handler will not know which response the current message in the channel belongs to.</p>\n\n<p>Is there a best practice, or a pattern, to send data to a gorutine from another gorutine and receive the data back?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1452505528, "post_id": 34718094, "comment_id": 57182392, "body": "Stop thinking like this. Child does <b>not</b> &quot;inherit&quot; anything from Parent. Really. Nothing. Stop thinking like this. Embedding anonymous fields is syntactic sugar which spares you unnecessary typing, it has nothing to do with &quot;inheritance&quot;. So to answer your question. No you cannot do this."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1452506189, "creation_date": 1452506189, "answer_id": 34718519, "question_id": 34718094, "link": "https://stackoverflow.com/questions/34718094/editing-tags-of-inherited-attributes-in-golang/34718519#34718519", "title": "Editing tags of inherited attributes in golang?", "body": "<p><em>Go doesn't have inheritance, only composition.</em> Instead of parent-child relationship think about it in terms of part-whole.</p>\n\n<p>In your example you can use  a mix of <code>json:\",omitempty\"</code> tag and \"field shadowing\" to get the result:</p>\n\n<pre><code>type Parent struct {\n    Name string `json:\"parent_name,omitempty\"`\n}\n\ntype Child struct {\n    Parent\n    Name string `json:\"child_name\"`\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/z72dCKOhYC\" rel=\"nofollow\">http://play.golang.org/p/z72dCKOhYC</a>.</p>\n\n<p>But this still misses the point (and breaks if <code>child.Parent.Name</code> isn't empty). If you're going to \"override\" a field in every struct that embeds <code>Parent</code>, why is it even there in the first place?</p>\n"}], "owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1452506189, "creation_date": 1452504849, "question_id": 34718094, "link": "https://stackoverflow.com/questions/34718094/editing-tags-of-inherited-attributes-in-golang", "title": "Editing tags of inherited attributes in golang?", "body": "<pre><code>type Parent struct {\n    Name string `json:\"parent_name\"`\n}\n\ntype Child struct {\n    Parent\n}\n</code></pre>\n\n<p>Say I have two structs <code>Parent</code> and <code>Child</code>.  I have two endpoints that read <code>json</code> using those two structs.</p>\n\n<pre><code>// Sample Parent endpoint payload\n{\n    \"parent_name\": \"Parent Name\"\n}\n\n// Sample Child endpoint payload\n{\n    \"child_name\": \"Child Name\"\n}\n</code></pre>\n\n<p>Both structs are being used to store similar data, but the <code>json</code> key is different for each endpoint payload.  Is there a way to edit the <code>json</code> tag on the <code>Child</code> struct such that <code>Child</code> still inherits from <code>Parent</code>, but the tag is now <code>json:\"child_name\"</code>?</p>\n"}, {"tags": ["go", "connection", "bufferedreader", "reader"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1452502444, "post_id": 34717331, "comment_id": 57180494, "body": "Well, that is dead obvious: <code>Read</code> reads <b>into</b> the provided <code>[]byte</code>. Your <code>[]byte</code> is empty, it has zero length and this whole zero length is filled. So technically your <code>Read</code>call worked as it completely filled the provided byte slice with data from the connection. You took the Tour of Go?"}, {"owner": {"reputation": 1889, "user_id": 892404, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6c64aa7f128d8b6e4cfeafae93782ec7?s=128&d=identicon&r=PG", "display_name": "Parham Doustdar", "link": "https://stackoverflow.com/users/892404/parham-doustdar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1452502817, "post_id": 34717331, "comment_id": 57180724, "body": "Thanks. I am new to a lot of the concepts, so some things I read in the tour or the first time I look at the documentation of a function goes over my head without me realizing it. Sorry for the irritation."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1452539867, "post_id": 34717372, "comment_id": 57204697, "body": "I&#39;d also note that novices often get tripped by a false expectation of <code>Read()</code> reading exactly so much data to fill the whole slice. The &quot;problem&quot; is in those &quot;up to&quot; words in the documentation string which actually stand to mean &quot;any number of bytes between 1 and the length of the input buffer&quot;. To fill the whole buffer, one should use <a href=\"https://golang.org/pkg/io/#ReadFull\" rel=\"nofollow noreferrer\"><code>io.ReadFull()</code></a>. This behaviour follows the semantics of the <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/read.html\" rel=\"nofollow noreferrer\"><code>read()</code> syscall of POSIX</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1452506744, "last_edit_date": 1452506744, "creation_date": 1452502418, "answer_id": 34717372, "question_id": 34717331, "link": "https://stackoverflow.com/questions/34717331/why-does-conn-read-write-nothing-into-a-byte-but-bufio-reader-readstring/34717372#34717372", "title": "Why does conn.Read() write nothing into a []byte, but bufio.Reader.ReadString() works?", "body": "<p>The <a href=\"https://golang.org/pkg/net/#Conn\" rel=\"noreferrer\"><code>Conn.Read()</code></a> method is to implement <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"noreferrer\"><code>io.Reader</code></a>, the general interface to read data from any source of bytes into a <code>[]byte</code>. Quoting from the doc of <code>Reader.Read()</code>:</p>\n\n<blockquote>\n  <p>Read reads up to len(p) bytes into p.</p>\n</blockquote>\n\n<p>So <code>Read()</code> reads up to <code>len(p)</code> bytes but since you pass a <code>nil</code> slice, it won't read anything (length of a <code>nil</code> slice is <code>0</code>). Please read the linked doc to know how <code>Reader.Read()</code> works.</p>\n\n<p><code>Reader.Read()</code> does not allocate a buffer (<code>[]byte</code>) where the read data will be stored, you have to create one and pass it, e.g.:</p>\n\n<pre><code>var buf = make([]byte, 100)\nn, err := conn.Read(buf)\n// n is the number of read bytes; don't forget to check err!\n</code></pre>\n\n<p>Don't forget to always check the returned <code>error</code> which may be <code>io.EOF</code> if end of data is reached. The general contract of <code>io.Reader.Read()</code> also allows returning some non-<code>nil</code> error (including <code>io.EOF</code>) and some read data (<code>n &gt; 0</code>) <em>at the same time</em>. The number of read bytes will be in <code>n</code>, which means only the first <code>n</code> bytes of the <code>buf</code> is useful (in other words: <code>buf[:n]</code>).</p>\n\n<p>Your other example using <a href=\"https://golang.org/pkg/bufio/#Reader\" rel=\"noreferrer\"><code>bufio.Reader</code></a> works because you called <a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"noreferrer\"><code>Reader.ReadString()</code></a> which doesn't require a <code>[]byte</code> argument. If you would've used the <a href=\"https://golang.org/pkg/bufio/#Reader.Read\" rel=\"noreferrer\"><code>bufio.Reader.Read()</code></a> method, you would also had to pass a non-<code>nil</code> slice in order to actually get some data.</p>\n"}], "owner": {"reputation": 1889, "user_id": 892404, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6c64aa7f128d8b6e4cfeafae93782ec7?s=128&d=identicon&r=PG", "display_name": "Parham Doustdar", "link": "https://stackoverflow.com/users/892404/parham-doustdar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3067, "favorite_count": 1, "accepted_answer_id": 34717372, "answer_count": 1, "score": 2, "last_activity_date": 1452506744, "creation_date": 1452502245, "last_edit_date": 1452506641, "question_id": 34717331, "link": "https://stackoverflow.com/questions/34717331/why-does-conn-read-write-nothing-into-a-byte-but-bufio-reader-readstring", "title": "Why does conn.Read() write nothing into a []byte, but bufio.Reader.ReadString() works?", "body": "<p>I have a connection, created like this:</p>\n\n<pre><code>conn, err = net.Dial(\"tcp\", \"127.0.0.1:20000\")\n</code></pre>\n\n<p>I have tried reading from this connection in two ways. I think they both must work, but the first option doesn't.</p>\n\n<p>Here is the first way of doing it:</p>\n\n<pre><code>var bytes []byte\nfor i := 0; i &lt; 4; i++ {\n    conn.Read(bytes)\n}\nfmt.Printf(\"%v\", bytes)\n</code></pre>\n\n<p>The output of this method is:</p>\n\n<pre><code>[]\n</code></pre>\n\n<p>And here is the same thing, done with <code>bufio.Reader</code>:</p>\n\n<pre><code>func readResponse(conn net.Conn) (response string, err error) {\n    reader := bufio.NewReader(conn)\n    _, err = reader.Discard(8)\n    if err != nil {\n        return\n    }\n\n    response, err = reader.ReadString('\\n')\n\n    return\n}\n</code></pre>\n\n<p>This function returns the response given by the server on the other end of the TCP connection.</p>\n\n<p>Why does <code>bufio.Reader.Read()</code> work, but <code>net.Conn.Read()</code> doesn't?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 1, "creation_date": 1452499844, "post_id": 34716700, "comment_id": 57179251, "body": "<code>for k,v := range os.Args[1:]</code>?"}, {"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1452500706, "post_id": 34716700, "comment_id": 57179630, "body": "@u_mulder If I want to output <code>Knuth, Donald, Author of The Art of Computer Programming.</code> while <code>Knuth, Donald</code> is the user input, I cannot figure out how."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1452538044, "post_id": 34716700, "comment_id": 57203672, "body": "@Nick is it important to separate on every two inputs? i.e. is it possible your user will call with <code>.&#47;myapp Knuth Donald Gates Bill</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 10229, "user_id": 195130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e8ae4e7eded8cd37805b4b31cc1f1c53?s=128&d=identicon&r=PG", "display_name": "Chandra Sekar", "link": "https://stackoverflow.com/users/195130/chandra-sekar"}, "is_accepted": false, "score": 9, "last_activity_date": 1452537952, "last_edit_date": 1452537952, "creation_date": 1452501099, "answer_id": 34717018, "question_id": 34716700, "link": "https://stackoverflow.com/questions/34716700/how-to-print-os-args1-without-braces-in-go/34717018#34717018", "title": "How to print os.args[1:] without braces in Go?", "body": "<p>You should use <a href=\"https://golang.org/pkg/strings/#Join\" rel=\"noreferrer\"><code>strings.Join</code></a> for this. Try,</p>\n\n<pre><code>fmt.Printf(\"%s, Author of The Art of Computer Programming\", strings.Join(os.Args[1:], \", \"))\n</code></pre>\n\n<p><code>Join</code> returns a <code>string</code> with <code>\", \"</code> inserted between each argument.</p>\n"}, {"tags": [], "owner": {"reputation": 438, "user_id": 5378868, "user_type": "registered", "profile_image": "https://graph.facebook.com/135713123447192/picture?type=large", "display_name": "Ozzadar", "link": "https://stackoverflow.com/users/5378868/ozzadar"}, "is_accepted": false, "score": 1, "last_activity_date": 1452516548, "creation_date": 1452516548, "answer_id": 34721983, "question_id": 34716700, "link": "https://stackoverflow.com/questions/34716700/how-to-print-os-args1-without-braces-in-go/34721983#34721983", "title": "How to print os.args[1:] without braces in Go?", "body": "<p>The reason it's outputting the brackets is because you're passing a slice into the print command.</p>\n\n<p>What you want to do is take each command and put them into a string to be printed as needed.</p>\n\n<pre><code>firstname := os.Args[1]\nlastname := os.Args[2]\nfmt.Println(lastname + \", \" + firstname)\n</code></pre>\n\n<p>You should also take a look at the <strong>strings</strong> package as was pointed out by Chandru. There's a bunch of goodies in there to help with dealing with strings.</p>\n\n<p>See: <a href=\"https://golang.org/pkg/strings/\" rel=\"nofollow\">https://golang.org/pkg/strings/</a></p>\n"}], "owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1696, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1452537952, "creation_date": 1452499693, "question_id": 34716700, "link": "https://stackoverflow.com/questions/34716700/how-to-print-os-args1-without-braces-in-go", "title": "How to print os.args[1:] without braces in Go?", "body": "<p>When I tried to print command line arguments using</p>\n\n<pre><code>    fmt.Println(os.Args[1:])\n</code></pre>\n\n<p>I got result like </p>\n\n<pre><code>[Gates Bill]\n</code></pre>\n\n<p>How can I get rid of the <code>[]</code> around the arguments? And <code>Go</code> seems to eat all the commas in the arguments, how can I get the output like</p>\n\n<pre><code>Last name, First name\nGates, Bill\n</code></pre>\n"}, {"tags": ["go", "grpc", "protocol-buffers", "proto3"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1452503907, "post_id": 34716238, "comment_id": 57181341, "body": "do you need the proto-buf working well? proto-buf need the tags."}, {"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1452504606, "post_id": 34716238, "comment_id": 57181826, "body": "the thing is @JiangYD , i am sending an 0 value with one of my int feild. but when i am sending an 0 value the grpc-gateway omits the value. i know there are other approach, but i would like to know how i can remove an omit empty tag."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1452510658, "post_id": 34716238, "comment_id": 57185715, "body": "@Sadlil I&#39;m not sure I understand your problem. If you send a <code>0</code> value, it will be omitted and thus the field will be left unchanged - properly leaving with value <code>0</code> if you used a zero-value struct (which you should anyway)."}, {"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "edited": false, "score": 0, "creation_date": 1452510828, "post_id": 34716238, "comment_id": 57185814, "body": "my problem is when i parsed the struct into json with a value 0 for Code. the value gets omitted from the json. but i need this value to be present."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 1, "creation_date": 1452519908, "post_id": 34716238, "comment_id": 57191827, "body": "@Sadlil if you explicitly state: <code>struct.Field = proto.Uint64(0)</code> it should not be empty."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 3628322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c8dbc707a957bb6408f0efb3e88a?s=128&d=identicon&r=PG&f=1", "display_name": "Peach", "link": "https://stackoverflow.com/users/3628322/peach"}, "edited": false, "score": 1, "creation_date": 1586551602, "post_id": 34734246, "comment_id": 108177598, "body": "You didn&#39;t put a permalink for the source, it&#39;s now <a href=\"https://github.com/golang/protobuf/blob/84668698ea25b64748563aa20726db66a6b8d299/protoc-gen-go/generator/generator.go#L2243\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 6, "last_activity_date": 1463699242, "last_edit_date": 1463699242, "creation_date": 1452562921, "answer_id": 34734246, "question_id": 34716238, "link": "https://stackoverflow.com/questions/34716238/golang-protobuf-remove-omitempty-tag-from-generated-json-tags/34734246#34734246", "title": "golang protobuf remove omitempty tag from generated json tags", "body": "<p>I found that the <code>omitempty</code> json tag is hard-coded into the protoc-gen-go <a href=\"https://github.com/golang/protobuf/blob/master/protoc-gen-go/generator/generator.go#L1778\" rel=\"noreferrer\">source</a> around line 1778:</p>\n\n<pre><code>tag := fmt.Sprintf(\"protobuf:%s json:%q\",\n    g.goTag(message, field, wiretype), jsonName+\",omitempty\")\n</code></pre>\n\n<p>it will be easy changing the source and make a new protoc-gen-go binary yourself.</p>\n\n<p>It's worth noting that this is likely inadvisable and not recommended for several reasons, particularly because you will then be responsible for ensuring that the hacked up binary <em>always</em> gets used if the protobufs need to be regenerated.</p>\n"}, {"tags": [], "owner": {"reputation": 11705, "user_id": 293064, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/KnorP.jpg?s=128&g=1", "display_name": "Jay Taylor", "link": "https://stackoverflow.com/users/293064/jay-taylor"}, "is_accepted": false, "score": 10, "last_activity_date": 1463699145, "creation_date": 1463699145, "answer_id": 37335452, "question_id": 34716238, "link": "https://stackoverflow.com/questions/34716238/golang-protobuf-remove-omitempty-tag-from-generated-json-tags/37335452#37335452", "title": "golang protobuf remove omitempty tag from generated json tags", "body": "<p>A [more] portable solution:</p>\n\n<p>Use <code>sed</code> to strip the tags after generating via <code>protoc</code>.</p>\n\n<p>Example of what I actually use in my go:generate script after having generated the *.pb.go files:</p>\n\n<pre><code>ls *.pb.go | xargs -n1 -IX bash -c 'sed s/,omitempty// X &gt; X.tmp &amp;&amp; mv X{.tmp,}'\n</code></pre>\n\n<hr>\n\n<p>Note: <code>sed -i</code> (inline-replacement) is not used here because that flag isn't portable between standard OS-X and Linux.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2875186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94fc154276c6e7f987cf7dba3ddf084a?s=128&d=identicon&r=PG&f=1", "display_name": "tailnode", "link": "https://stackoverflow.com/users/2875186/tailnode"}, "is_accepted": false, "score": 0, "last_activity_date": 1518177377, "creation_date": 1518177377, "answer_id": 48705278, "question_id": 34716238, "link": "https://stackoverflow.com/questions/34716238/golang-protobuf-remove-omitempty-tag-from-generated-json-tags/48705278#48705278", "title": "golang protobuf remove omitempty tag from generated json tags", "body": "<p>you can copy the encoding/json package to your own folder for example my_json, and modify <a href=\"https://github.com/golang/go/blob/release-branch.go1.9/src/encoding/json/encode.go#L1156\" rel=\"nofollow noreferrer\">omitEmpty</a> field to false, and use <code>my_json.Marshal()</code> to encode the struct to json string.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 7950879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3024cf123e91575e818da1924e612411?s=128&d=identicon&r=PG&f=1", "display_name": "DeeSilence", "link": "https://stackoverflow.com/users/7950879/deesilence"}, "is_accepted": false, "score": 15, "last_activity_date": 1524751152, "creation_date": 1524751152, "answer_id": 50044963, "question_id": 34716238, "link": "https://stackoverflow.com/questions/34716238/golang-protobuf-remove-omitempty-tag-from-generated-json-tags/50044963#50044963", "title": "golang protobuf remove omitempty tag from generated json tags", "body": "<p>If you are using grpc-gateway and you need the default values to be present during json marshaling, you may consider to add the following option when creating your servemux</p>\n\n<pre><code>    gwmux := runtime.NewServeMux(runtime.WithMarshalerOption(runtime.MIMEWildcard, &amp;runtime.JSONPb{OrigName: true, EmitDefaults: true}))\n</code></pre>\n\n<p>Outside of grpc-gateway, if you want to marshal your protocul buffer message, use <code>github.com/golang/protobuf/jsonpb</code> package instead of <code>encoding/json</code></p>\n\n<pre><code>func sendProtoMessage(resp proto.Message, w http.ResponseWriter) {\n    w.Header().Set(\"Content-Type\", \"application/json; charset=utf-8\")\n    m := jsonpb.Marshaler{EmitDefaults: true}\n    m.Marshal(w, resp) // You should check for errors here\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1612021263, "post_id": 52708091, "comment_id": 116638973, "body": "Nice! In addition, <code>gogo</code> supports custom tags e.g. <code>[ (gogoproto.moretags) = &quot;datastore:\\&quot;-\\&quot;&quot; ]</code>. To switch to <code>gogo</code>, simply change <code>protoc --go_out=</code> to <code>protoc --gogofast_out=</code> (note: gogofast is also 5..10 times faster than google proto!)"}], "tags": [], "owner": {"reputation": 91, "user_id": 9205275, "user_type": "registered", "profile_image": "https://graph.facebook.com/1283311288354591/picture?type=large", "display_name": "Sandesh Chopdekar", "link": "https://stackoverflow.com/users/9205275/sandesh-chopdekar"}, "is_accepted": false, "score": 9, "last_activity_date": 1539023141, "creation_date": 1539023141, "answer_id": 52708091, "question_id": 34716238, "link": "https://stackoverflow.com/questions/34716238/golang-protobuf-remove-omitempty-tag-from-generated-json-tags/52708091#52708091", "title": "golang protobuf remove omitempty tag from generated json tags", "body": "<p>You can try using gogo proto (<a href=\"https://github.com/gogo/protobuf\" rel=\"noreferrer\">https://github.com/gogo/protobuf</a>) \nWith the jsontag extension, your proto message would look like</p>\n\n<pre><code>message Status {\n  int32 code = 1 [(gogoproto.jsontag) = \"code\"];\n  string message = 2 [(gogoproto.jsontag) = \"message\"];\n}\n</code></pre>\n\n<p>You can also add more tags, if you like.</p>\n"}, {"tags": [], "owner": {"reputation": 5796, "user_id": 689956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fdc9740e5b7e8a10c83fcd06cfd99ac5?s=128&d=identicon&r=PG", "display_name": "Sathesh", "link": "https://stackoverflow.com/users/689956/sathesh"}, "is_accepted": false, "score": 2, "last_activity_date": 1554149830, "creation_date": 1554149830, "answer_id": 55462941, "question_id": 34716238, "link": "https://stackoverflow.com/questions/34716238/golang-protobuf-remove-omitempty-tag-from-generated-json-tags/55462941#55462941", "title": "golang protobuf remove omitempty tag from generated json tags", "body": "<p>The Marshaler under the jsonpb package has a EmitDefaults field. Setting this to true, will just ignore the omitempty tag in struct. </p>\n\n<p><a href=\"https://godoc.org/github.com/golang/protobuf/jsonpb#JSONPBMarshaler\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/golang/protobuf/jsonpb#JSONPBMarshaler</a></p>\n"}, {"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1572201685, "post_id": 58579950, "comment_id": 103478834, "body": "This answer from 3+ years ago already suggests using <code>sed</code> as a post-process: <a href=\"https://stackoverflow.com/a/37335452/1218512\">stackoverflow.com/a/37335452/1218512</a>"}], "tags": [], "owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "is_accepted": false, "score": 1, "last_activity_date": 1572184626, "last_edit_date": 1572184626, "creation_date": 1572183791, "answer_id": 58579950, "question_id": 34716238, "link": "https://stackoverflow.com/questions/34716238/golang-protobuf-remove-omitempty-tag-from-generated-json-tags/58579950#58579950", "title": "golang protobuf remove omitempty tag from generated json tags", "body": "<p>You could use \"sed\" command to remove this text from files like following</p>\n\n<pre><code>sed -i \"\" -e \"s/,omitempty//g\" ./api/proto/*.go\n</code></pre>\n\n<p>where args: </p>\n\n<ol>\n<li><code>-i \"\"</code> is meaning that keep same name of files </li>\n<li><code>-e \"s/,omitempty//g\"</code> = format to replace like <code>\"s/SEARCH/INSERT/g\"</code></li>\n</ol>\n"}], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15191, "favorite_count": 8, "answer_count": 7, "score": 25, "last_activity_date": 1572184626, "creation_date": 1452497528, "question_id": 34716238, "link": "https://stackoverflow.com/questions/34716238/golang-protobuf-remove-omitempty-tag-from-generated-json-tags", "title": "golang protobuf remove omitempty tag from generated json tags", "body": "<p>I am using google grpc with a json proxy. for some reason i need to remove the <code>omitempty</code> tags from the struct generated in the *.pb.go files.</p>\n\n<p>if i have a proto message like this</p>\n\n<pre><code>message Status {\n  int32 code = 1;\n  string message = 2;\n}\n</code></pre>\n\n<p>The generated struct looks like this</p>\n\n<pre><code>type Status struct {\n  Code int32 `protobuf:\"varint,1,opt,name=code\" json:\"code,omitempty\"`\n  Message string `protobuf:\"bytes,2,opt,name=message\" json:\"message,omitempty\"`\n}\n</code></pre>\n\n<p>But My need is to remove the <code>omitempty</code> tag from the generated structs. How can i do this?</p>\n"}, {"tags": ["go", "couchbase"], "answers": [{"tags": [], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "is_accepted": false, "score": 0, "last_activity_date": 1452539826, "creation_date": 1452539826, "answer_id": 34729306, "question_id": 34714956, "link": "https://stackoverflow.com/questions/34714956/golang-couchbase-n1ql-query-pass-params-to/34729306#34729306", "title": "golang Couchbase n1ql query pass params to?", "body": "<p>Just <a href=\"https://github.com/couchbaselabs/devguide-examples/blob/master/go/query-placeholders.go\" rel=\"nofollow\">found example</a> </p>\n\n<pre><code>        myQuery := gocb.NewN1qlQuery(\"SELECT airportname, city, country FROM `travel-sample` \" +\n        \"WHERE type='airport' AND city=$1 \")\n\n    // Setup an array for parameters\n    var myParams []interface{}\n    myParams = append(myParams, \"Reno\")\n\n    // Execute Query\n    rows, err := bucket.ExecuteN1qlQuery(myQuery, myParams)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "edited": false, "score": 0, "creation_date": 1452541038, "post_id": 34729551, "comment_id": 57205373, "body": "Do you think my link to the repo was not good enough? :-) This example solved all problems I had.  The problem was to find the example, it was not quite straight way, may be because I was expected more from couchbase  site"}, {"owner": {"reputation": 71, "user_id": 5775311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da5be31ca60176d7b4d4968375a8e2a0?s=128&d=identicon&r=PG&f=1", "display_name": "ToddGreenstein", "link": "https://stackoverflow.com/users/5775311/toddgreenstein"}, "reply_to_user": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "edited": false, "score": 1, "creation_date": 1452547790, "post_id": 34729551, "comment_id": 57209055, "body": "Mike, we are constantly working to improve the documentation--especially the dev guide.  Thanks for posting this question."}], "tags": [], "owner": {"reputation": 71, "user_id": 5775311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da5be31ca60176d7b4d4968375a8e2a0?s=128&d=identicon&r=PG&f=1", "display_name": "ToddGreenstein", "link": "https://stackoverflow.com/users/5775311/toddgreenstein"}, "is_accepted": true, "score": 4, "last_activity_date": 1452540719, "creation_date": 1452540719, "answer_id": 34729551, "question_id": 34714956, "link": "https://stackoverflow.com/questions/34714956/golang-couchbase-n1ql-query-pass-params-to/34729551#34729551", "title": "golang Couchbase n1ql query pass params to?", "body": "<p>The example you posted for how to do do this is from our developer guide repo on github:</p>\n\n<p><a href=\"https://github.com/couchbaselabs/devguide-examples/blob/master/go/query-placeholders.go\" rel=\"nofollow\">https://github.com/couchbaselabs/devguide-examples/blob/master/go/query-placeholders.go</a>.</p>\n\n<p>Basically, you're using $ which references an interface and a corresponding positional parameter beginning with 1.</p>\n\n<p>For your example it would look something like:</p>\n\n<pre><code>// Setup a new query with a placeholder\nmyQuery := gocb.NewN1qlQuery(\"SELECT * FROM default where a=$1 and b=$2\")\n\n// Setup an array for parameters\nvar myParams []interface{}\nmyParams = append(myParams,\"foo\")\nmyParams = append(myParams,\"bar\")\n\n// Execute Query\nrows, err := bucket.ExecuteN1qlQuery(myQuery, myParams)\nif err != nil {\n    fmt.Println(\"ERROR EXECUTING N1QL QUERY:\", err)\n}\n\n// Iterate through rows and print output\nvar row interface{}\nfor rows.Next(&amp;row) {\n    fmt.Printf(\"Results: %+v\\n\", row)\n}\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 0, "accepted_answer_id": 34729551, "answer_count": 2, "score": 2, "last_activity_date": 1452540719, "creation_date": 1452491369, "last_edit_date": 1452513627, "question_id": 34714956, "link": "https://stackoverflow.com/questions/34714956/golang-couchbase-n1ql-query-pass-params-to", "title": "golang Couchbase n1ql query pass params to?", "body": "<p>I'm trying to find a way to pass parameters to query, but not quite sure how. The API on the <a href=\"http://developer.couchbase.com/documentation/server/4.0/sdks/go-beta/querying.html\" rel=\"nofollow\">web site</a> looks a little bit outdated?</p>\n\n<pre><code>myQuery := gocb.NewN1qlQuery(\"SELECT * FROM default\")\nrows, err := myBucket.ExecuteN1qlQuery(myQuery)\nif err != nil {\n    fmt.Printf(\"N1QL query error: %s\\n\", err)\n}\nvar row interface{}\nfor rows.Next(&amp;row) {\n    fmt.Printf(\"Row: %+v\\n\", row)\n}\nif err := rows.Close(); err != nil {\n    fmt.Printf(\"N1QL query error: %s\\n\", err)\n}\n</code></pre>\n\n<p>Because, actually ExecuteN1qlQuery takes two params: </p>\n\n<pre><code>func (b *Bucket) ExecuteN1qlQuery(q *N1qlQuery, params interface{}) (ViewResults, error)\n</code></pre>\n\n<p>I am not sure just how to use it... Like I would like to create a query with placeholders, and pass values to  ExecuteN1qlQuery via params. Like with SQL (prepare -> execute). For example something like that:</p>\n\n<pre><code>    myQuery := gocb.NewN1qlQuery(\"SELECT * FROM default where a=? and b=?\")\n    rows, err := myBucket.ExecuteN1qlQuery(myQuery,[]string{\"b\",\"c\"})\n    if err != nil {\n        fmt.Printf(\"N1QL query error: %s\\n\", err)\n    }\n    var row interface{}\n    for rows.Next(&amp;row) {\n        fmt.Printf(\"Row: %+v\\n\", row)\n    }\n    if err := rows.Close(); err != nil {\n        fmt.Printf(\"N1QL query error: %s\\n\", err)\n    }\n</code></pre>\n"}, {"tags": ["selenium", "browser", "go", "automation"], "comments": [{"owner": {"reputation": 4547, "user_id": 4213132, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DJW55.jpg?s=128&g=1", "display_name": "Helping Hands", "link": "https://stackoverflow.com/users/4213132/helping-hands"}, "edited": false, "score": 0, "creation_date": 1452491448, "post_id": 34714948, "comment_id": 57176019, "body": "Does Selenium support <code>Go Lang?</code> I think no."}, {"owner": {"reputation": 13000, "user_id": 3190347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Fsjd6.jpg?s=128&g=1", "display_name": "Shubham Jain", "link": "https://stackoverflow.com/users/3190347/shubham-jain"}, "edited": false, "score": 0, "creation_date": 1452492536, "post_id": 34714948, "comment_id": 57176345, "body": "<a href=\"http://stackoverflow.com/questions/34588393/go-language-automation-testing\" title=\"go language automation testing\">stackoverflow.com/questions/34588393/&hellip;</a>"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1452493115, "post_id": 34714948, "comment_id": 57176551, "body": "why golang and &quot;a good tool&quot;? golang, as a programming language has it&#39;s tools."}, {"owner": {"reputation": 94, "user_id": 4953945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c10268fa4b4e8a1d21db8f4b3d3d3fe?s=128&d=identicon&r=PG&f=1", "display_name": "afrank", "link": "https://stackoverflow.com/users/4953945/afrank"}, "edited": false, "score": 0, "creation_date": 1491156195, "post_id": 34714948, "comment_id": 73417211, "body": "Checkout <a href=\"https://github.com/knq/chromedp\" rel=\"nofollow noreferrer\">github.com/knq/chromedp</a> -- it allows you to drive various browsers without external dependencies using the Chrome Debugging Protocol."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1500996205, "post_id": 34714948, "comment_id": 77576855, "body": "WebDriver client written in golang to target all modern browsers   <a href=\"https://github.com/tebeka/selenium\" rel=\"nofollow noreferrer\">github.com/tebeka/selenium</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6652, "user_id": 3931985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/VK8ND.png?s=128&g=1", "display_name": "ekostadinov", "link": "https://stackoverflow.com/users/3931985/ekostadinov"}, "is_accepted": false, "score": 2, "last_activity_date": 1500995414, "last_edit_date": 1500995414, "creation_date": 1452508428, "answer_id": 34719296, "question_id": 34714948, "link": "https://stackoverflow.com/questions/34714948/automation-in-go-lang-how-to-use-browser-automation-like-selenium/34719296#34719296", "title": "Automation in Go Lang - How to use browser automation like Selenium?", "body": "<p>If you are going to use GO for web automation testing - Selenium is a good option. Still it's nothing more than a library that allows you to interact with browsers. So you are going to need to develop your own framework or reuse someone already implemented. </p>\n\n<p>My advice is to consider <a href=\"https://blog.pivotal.io/labs/labs/agouti\" rel=\"nofollow noreferrer\">Agouti</a>, since it supports <a href=\"http://onsi.github.io/ginkgo/\" rel=\"nofollow noreferrer\">Ginkgo</a> BDD and xUnit <a href=\"http://onsi.github.io/gomega/\" rel=\"nofollow noreferrer\">Gomega</a>. Everything else is pretty much the same from architectural perspective. You can design it like any other language binding. There are <a href=\"https://code.google.com/p/selenium/wiki/DesignPatterns\" rel=\"nofollow noreferrer\">common patterns</a> that appear over and over again in browser automation frameworks, like </p>\n\n<ul>\n<li>PageObjects: A simple abstraction of the UI of your web app. </li>\n<li>LoadableComponent: Modeling PageObjects as components. </li>\n<li>BotStyleTests: command-based approach</li>\n</ul>\n\n<p>Another good resource for building your Test framework is the <a href=\"http://xunitpatterns.com/\" rel=\"nofollow noreferrer\">xunitpatterns</a> guide. It gives a great content overview of the patterns, smells and refactoring strategies you can use. Also look at this <a href=\"http://www.softwaretestinghelp.com/test-automation-frameworks-selenium-tutorial-20/\" rel=\"nofollow noreferrer\">test frameworks tutorial</a>. It'll help you choose the most proper solution for your case. </p>\n\n<p>My guess is that you are going to need some <a href=\"https://en.wikipedia.org/wiki/Continuous_integration\" rel=\"nofollow noreferrer\">CI</a> server support for </p>\n\n<blockquote>\n  <p>everything needs to be done auto for more users.</p>\n</blockquote>\n\n<p>Here is a <a href=\"http://jmcvetta.github.io/blog/2013/08/30/continuous-integration-for-go-code/\" rel=\"nofollow noreferrer\">good article</a> how-to achieve this with <a href=\"https://travis-ci.org/\" rel=\"nofollow noreferrer\">TravisCI</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "is_accepted": false, "score": 1, "last_activity_date": 1557833369, "creation_date": 1557833369, "answer_id": 56129378, "question_id": 34714948, "link": "https://stackoverflow.com/questions/34714948/automation-in-go-lang-how-to-use-browser-automation-like-selenium/56129378#56129378", "title": "Automation in Go Lang - How to use browser automation like Selenium?", "body": "<p>update:\nyou can use <a href=\"https://github.com/tebeka/selenium\" rel=\"nofollow noreferrer\">Selenium for Golang</a></p>\n"}, {"tags": [], "owner": {"reputation": 556, "user_id": 6512681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7aed06d4bbc78fe9c494f68da529a6d?s=128&d=identicon&r=PG", "display_name": "Max Schmitt", "link": "https://stackoverflow.com/users/6512681/max-schmitt"}, "is_accepted": false, "score": 1, "last_activity_date": 1609328881, "creation_date": 1609328881, "answer_id": 65506476, "question_id": 34714948, "link": "https://stackoverflow.com/questions/34714948/automation-in-go-lang-how-to-use-browser-automation-like-selenium/65506476#65506476", "title": "Automation in Go Lang - How to use browser automation like Selenium?", "body": "<p>You can also use <a href=\"https://github.com/mxschmitt/playwright-go\" rel=\"nofollow noreferrer\">Playwright for Go</a>, which is a wrapper for the <a href=\"https://github.com/microsoft/playwright\" rel=\"nofollow noreferrer\">Playwright</a> project. Playwright provides a single API to automate Chromium, Firefox, and WebKit to automate browsers which was created by Microsoft. With it you interact with the sites, record videos, make screenshots, and emulate other browser specific behaviour.</p>\n"}], "owner": {"reputation": 103, "user_id": 5742505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80145b164d3a44bba3a26111cc2980da?s=128&d=identicon&r=PG&f=1", "display_name": "gopinath", "link": "https://stackoverflow.com/users/5742505/gopinath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21940, "favorite_count": 5, "answer_count": 3, "score": 7, "last_activity_date": 1609328881, "creation_date": 1452491336, "last_edit_date": 1530273201, "question_id": 34714948, "link": "https://stackoverflow.com/questions/34714948/automation-in-go-lang-how-to-use-browser-automation-like-selenium", "title": "Automation in Go Lang - How to use browser automation like Selenium?", "body": "<p>I am new to Go lang. And I am looking for automating signup, login processes in a web app. Please suggest a good tool like Selenium and how can I implement it in go language.</p>\n\n<p>I want to do the following process automatically using Go Lang: </p>\n\n<ol>\n<li>Start a browser. Currently, I'm using <a href=\"https://github.com/skratchdot/open-golang\" rel=\"nofollow noreferrer\">https://github.com/skratchdot/open-golang</a></li>\n<li>Auto entry in signup page and auto submit a form.</li>\n<li>Login check for the registered user. Everything needs to be done automatically for more users.</li>\n</ol>\n"}, {"tags": ["html", "templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1452535193, "post_id": 34715423, "comment_id": 57202145, "body": "Thanks for your response. I updated the question with sample structs. <code>myKey</code> is <code>$foo.Name</code>. I tried {{$.Field2.foo.Name}} But it did not work."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1452536413, "post_id": 34715423, "comment_id": 57202798, "body": "@sumanj Then you do need to use the <code>{{index}}</code> action, for example: <code>{{index $.Field2 .Name}}</code>. See edited answer."}, {"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1452539251, "post_id": 34715423, "comment_id": 57204359, "body": "Awesome. But if<code>{{index $.Field2 .Name}}</code> is of type Foo2. and I need to print Id of Foo2 element. I tried <code>{{index $.Field2 .Name .Id}}</code>. It didn&#39;t work."}, {"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1452539381, "post_id": 34715423, "comment_id": 57204432, "body": "Nevermind. Got it. I had to use &quot;(&quot; and &quot;)&quot; around the pipeline snippet."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1487844518, "last_edit_date": 1487844518, "creation_date": 1452493878, "answer_id": 34715423, "question_id": 34714663, "link": "https://stackoverflow.com/questions/34714663/go-html-template-access-struct-fields-inside-range/34715423#34715423", "title": "Go html template access struct fields inside range", "body": "<p>No matter what the value of the pipeline is (which is denoted by the dot <code>.</code> in the template), you can use the <code>$</code> to refer to the data value you passed to <a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow noreferrer\"><code>Template.Execute()</code></a>. The <code>{{range}}</code> action iterates over the elements and it sets the pipeline (<code>.</code>) to the current item, so <code>.</code> always denotes the current item, <code>$</code> is absolutely refers to the \"top level\" data passed to <code>Template.Execute()</code>.</p>\n\n<p>This is documented in <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text/template</code></a>:</p>\n\n<blockquote>\n  <p>When execution begins, $ is set to the data argument passed to Execute, that is, to the starting value of dot.</p>\n</blockquote>\n\n<p>Also note that you have to export struct fields to be available in templates. So change your <code>MyPageData</code> type to:</p>\n\n<pre><code>type MyPageData struct {\n    Field1 []Foo\n    Field2 map[string]Bar\n}\n</code></pre>\n\n<p>Also note that you can simply access map elements using the <code>.</code> operator. So you can access the value of the <code>Field2</code> map associated with the <code>\"myKey\"</code> key like this, inside the <code>{{range}}</code> action too:</p>\n\n<pre><code>{{$.Field2.myKey}}\n</code></pre>\n\n<p>See this simple example:</p>\n\n<pre><code>type MyPageData struct {\n    Field1 []Foo\n    Field2 map[string]Bar\n}\n\ntype Foo struct {\n    Name string\n}\n\ntype Bar struct {\n    Name string\n}\n\nfunc main() {\n    t := template.Must(template.New(\"\").Parse(templ))\n    mpd := MyPageData{\n        Field1: []Foo{{\"First\"}, {\"Second\"}},\n        Field2: map[string]Bar{\"myKey\": {\"MyValue\"}},\n    }\n    t.Execute(os.Stdout, mpd)\n}\n\nconst templ = `{{range $idx, $foo := .Field1}}{{$.Field2.myKey}} {{$idx}} - {{$foo.Name}}\n{{end}}`\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/6GxoiWc1eG\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{MyValue} 0 - First\n{MyValue} 1 - Second\n</code></pre>\n\n<p>Also note that insdie the <code>{{range}}</code> instead of <code>$foo.Name</code> you can simply use <code>{{.Name}}</code> as the dot <code>.</code> denotes <code>$foo</code>, the current item.</p>\n\n<p>If you want to lookup a value from <code>Field2</code> with a dynamic key, you do need to use the <code>{{index}}</code> action. For example if you want the value associated with the key being <code>$foo.Name</code>:</p>\n\n<pre><code>{{index $.Field2 $foo.Name}}\n</code></pre>\n\n<p>Or short:</p>\n\n<pre><code>{{index $.Field2 .Name}}\n</code></pre>\n\n<p>And going forward, if the value associated with the key is a struct for example, and you only need a field of this struct, let's say <code>Id</code>, you can use parenthesis:</p>\n\n<pre><code>{{(index $.Field2 .Name).Id}}\n</code></pre>\n"}], "owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2686, "favorite_count": 1, "accepted_answer_id": 34715423, "answer_count": 1, "score": 2, "last_activity_date": 1487844518, "creation_date": 1452489711, "last_edit_date": 1452534845, "question_id": 34714663, "link": "https://stackoverflow.com/questions/34714663/go-html-template-access-struct-fields-inside-range", "title": "Go html template access struct fields inside range", "body": "<p>Given below struct, I want to access <code>field2</code> while iterating over <code>field1</code> data in html. How do I do this?</p>\n\n<pre><code>var MyPageData struct {\n      field1 []Foo\n      field2 map[string]Bar\n}\n</code></pre>\n\n<p>I tried: Inside Handler function:</p>\n\n<pre><code>err := myPageTemplate.Execute(w,MyPageData{ field1: field1Slice, field2 : myMapData})\n</code></pre>\n\n<p>Template:</p>\n\n<pre><code>     {{ range $index, $fooInstance := .field1}} \n        &lt;tr&gt;\n            &lt;td&gt;{{$fooInstance.Name}}&lt;/td&gt; //This prints the Name value\n            &lt;td&gt;{{ index .$field2 \"myKey\".Name }}&lt;/td&gt;\n</code></pre>\n\n<p>How do I access <code>field2</code> above and specify a key value to retrieve <code>Bar</code> instance?</p>\n\n<p><strong>UPDATE</strong> Adding Foo and Bar structs\n</p>\n\n<pre><code>type Foo2 struct {\n    Name string\n    Id  int \n}\n\n\ntype Foo struct {\n    Name string\n    element Foo2\n}\n\ntype Bar struct {\n    Name string\n}\n</code></pre>\n"}, {"tags": ["go", "content-management-system", "static-site", "incremental-build", "hugo"], "answers": [{"comments": [{"owner": {"reputation": 18285, "user_id": 325521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s8KPo.jpg?s=128&g=1", "display_name": "Shiva", "link": "https://stackoverflow.com/users/325521/shiva"}, "edited": false, "score": 0, "creation_date": 1452808746, "post_id": 34799833, "comment_id": 57344313, "body": "Thanks @bep Just saw your activity on <b>Hugo</b> discussion board. I was wondering, has anyone tested the build with 100K posts (realistic). I saw the youtube video 1 dude posted, but that is lorem ipsum with just 5K posts. Wondering, and thanks for this answer."}, {"owner": {"reputation": 1386, "user_id": 3973292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71393bd67bd84015884ff6127afc5ed1?s=128&d=identicon&r=PG&f=1", "display_name": "bep", "link": "https://stackoverflow.com/users/3973292/bep"}, "reply_to_user": {"reputation": 18285, "user_id": 325521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s8KPo.jpg?s=128&g=1", "display_name": "Shiva", "link": "https://stackoverflow.com/users/325521/shiva"}, "edited": false, "score": 1, "creation_date": 1452812526, "post_id": 34799833, "comment_id": 57346024, "body": "Have a look at <a href=\"https://discuss.gohugo.io/t/page-generation-performance-expectations/1335\" rel=\"nofollow noreferrer\">discuss.gohugo.io/t/page-generation-performance-expectations&zwnj;&#8203;/&hellip;</a>  That is currently pushing it, so for 600K posts to be a viable option, some kind of incremental building / caching would have to come into play. But it&#39;s not like there are any of the other contenders in the static generator market that does this today, is it?"}], "tags": [], "owner": {"reputation": 1386, "user_id": 3973292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71393bd67bd84015884ff6127afc5ed1?s=128&d=identicon&r=PG&f=1", "display_name": "bep", "link": "https://stackoverflow.com/users/3973292/bep"}, "is_accepted": true, "score": 3, "last_activity_date": 1452805922, "creation_date": 1452805922, "answer_id": 34799833, "question_id": 34714442, "link": "https://stackoverflow.com/questions/34714442/hugo-incremental-builds-is-there-an-undocumented-switch-somewhere/34799833#34799833", "title": "Hugo incremental builds . Is there an undocumented switch somewhere?", "body": "<p>Hugo currently has no incremental builds. The upcoming Hugo 0.16 will be smarter about building in server watch mode (i.e. it will detect what you change and only read that, testing indicates a ~15% improvement in the common case), but the builds will still be everything.</p>\n\n<p>It will eventually happen, but it is a hard problem to solve in a simple way... But Hugo is very, very fast at what it does.</p>\n"}], "owner": {"reputation": 18285, "user_id": 325521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/s8KPo.jpg?s=128&g=1", "display_name": "Shiva", "link": "https://stackoverflow.com/users/325521/shiva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 0, "accepted_answer_id": 34799833, "answer_count": 1, "score": 1, "last_activity_date": 1452805922, "creation_date": 1452488366, "last_edit_date": 1592644375, "question_id": 34714442, "link": "https://stackoverflow.com/questions/34714442/hugo-incremental-builds-is-there-an-undocumented-switch-somewhere", "title": "Hugo incremental builds . Is there an undocumented switch somewhere?", "body": "<p>I am evaluating <a href=\"http://gohugo.io\" rel=\"nofollow noreferrer\">Hugo</a> for generating my static site that will potentially generate about <strong>20 posts a day</strong>. So in about a year, there will be <strong>7000+ posts</strong> written in markdown, that will need to be build and deployed to my production server.</p>\n<p>I initially started with <strong>Jekyll</strong>, but the builds even for small number of pages is terribly slow, and I can't, for the life of me, understand how a seemingly basic requirement like incremental builds - building and generating only content that has changed -- is still not supported in Jekyll... #SMH.</p>\n<h3>So I would like to know if Hugo has incremental builds?</h3>\n<p>I didn't see anything in the documentation over at <a href=\"http://gohugo.io/overview/introduction/\" rel=\"nofollow noreferrer\">gohugo.io</a>,or in the <code>hugo help</code> commandline help.</p>\n<p>But Hugo seems to have everything else I am looking for, and the builds on a small batch of posts is blazing fast, so I would really like to give it a chance.</p>\n<p>Plus the language that it's written in, <kbd>GO</kbd>, was co-authored by 1 of my all-time favorite hackers -- Ken Thompson.</p>\n"}, {"tags": ["linux", "plugins", "go"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1452754164, "post_id": 34714320, "comment_id": 57310637, "body": "You could scan the <code>&#47;proc&#47;</code> directory and count the numerical subdirectories there (like <code>&#47;proc&#47;1234</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 5518497, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6129e8124e3bd4b7523a33b39364fc22?s=128&d=identicon&r=PG&f=1", "display_name": "Hippity Hoopla", "link": "https://stackoverflow.com/users/5518497/hippity-hoopla"}, "edited": false, "score": 0, "creation_date": 1452579308, "post_id": 34715154, "comment_id": 57219588, "body": "This is very similar to my code but how can you go about testing this to make sure it&#39;s working? Sorry if this isn&#39;t the right question. I&#39;m very new to Golang."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 58, "user_id": 5518497, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6129e8124e3bd4b7523a33b39364fc22?s=128&d=identicon&r=PG&f=1", "display_name": "Hippity Hoopla", "link": "https://stackoverflow.com/users/5518497/hippity-hoopla"}, "edited": false, "score": 0, "creation_date": 1452580906, "post_id": 34715154, "comment_id": 57220173, "body": "I am not sure I understand your question. When I compile this code and run the resulting application I see reasonable output. This code will not work on Windows or on play.golang.org. Probably you should start by reading <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">golang.org/doc/install</a>"}, {"owner": {"reputation": 58, "user_id": 5518497, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6129e8124e3bd4b7523a33b39364fc22?s=128&d=identicon&r=PG&f=1", "display_name": "Hippity Hoopla", "link": "https://stackoverflow.com/users/5518497/hippity-hoopla"}, "edited": false, "score": 0, "creation_date": 1452644591, "post_id": 34715154, "comment_id": 57258572, "body": "When I run that program it prints out <b>[50 48 53 10]</b>. I ran <code>ps -A --no-headers | wc -l</code> right after this and saw that I have 205 processes running. If I&#39;m reading the documentation correctly, the numbers your program is printing out are bytes. How do these numbers relate?"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 58, "user_id": 5518497, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6129e8124e3bd4b7523a33b39364fc22?s=128&d=identicon&r=PG&f=1", "display_name": "Hippity Hoopla", "link": "https://stackoverflow.com/users/5518497/hippity-hoopla"}, "edited": false, "score": 0, "creation_date": 1452652182, "post_id": 34715154, "comment_id": 57260602, "body": "what version of Go are you using? Try changing <code>fmt.Printf(&quot;Number of running processes: %s\\n&quot;, out)</code> to <code>fmt.Printf(&quot;Number of running processes: %s\\n&quot;, string(out))</code>"}, {"owner": {"reputation": 58, "user_id": 5518497, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6129e8124e3bd4b7523a33b39364fc22?s=128&d=identicon&r=PG&f=1", "display_name": "Hippity Hoopla", "link": "https://stackoverflow.com/users/5518497/hippity-hoopla"}, "edited": false, "score": 0, "creation_date": 1452748546, "post_id": 34715154, "comment_id": 57308898, "body": "That worked. I am using <code>go version go1.4</code>. New question for you: why did the <code>exec.Command(&quot;&#47;bin&#47;sh&quot;, &quot;-c&quot;</code> need the <code>&#47;bin&#47;sh -c</code> part? I had the same for the rest of the command but it didn&#39;t work until I added in the part you had."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 58, "user_id": 5518497, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6129e8124e3bd4b7523a33b39364fc22?s=128&d=identicon&r=PG&f=1", "display_name": "Hippity Hoopla", "link": "https://stackoverflow.com/users/5518497/hippity-hoopla"}, "edited": false, "score": 0, "creation_date": 1452753929, "post_id": 34715154, "comment_id": 57310538, "body": "It looks like <code>%s</code> started to support <code>[]byte</code> only in Go 1.5. I have updated the answer with explanation about <code>&#47;bin&#47;sh -c</code>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1452754266, "post_id": 34715154, "comment_id": 57310687, "body": "This is inefficient and depends upon the <code>ps</code> and <code>wc</code>  programs, which might not be available (e.g. wrong <code>PATH</code>) or not runnable (<code>fork</code> failing)"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452755012, "post_id": 34715154, "comment_id": 57311025, "body": "I think it will be fast enough and will work on 99% of Linux systems. If you should use it or not depends on the requirements of your application."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 1, "last_activity_date": 1452753927, "last_edit_date": 1452753927, "creation_date": 1452492429, "answer_id": 34715154, "question_id": 34714320, "link": "https://stackoverflow.com/questions/34714320/counting-the-processes-on-linux-in-golang/34715154#34715154", "title": "Counting the processes on linux in Golang", "body": "<p>The following program works for me:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc main() {\n    out, err := exec.Command(\"/bin/sh\", \"-c\", \"ps -A --no-headers | wc -l\").Output()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"Number of running processes: %s\\n\", out)\n}\n</code></pre>\n\n<p>Note that you have to use <code>/bin/sh -c</code>. <code>exec.Command</code> executes a <strong>single</strong> program (an executable file), such as <code>/bin/sh</code> or <code>ps</code> or <code>tail</code>. </p>\n\n<p>When you type <code>ps -A --no-headers | wc -l</code> in your command prompt this expression is interpreted by a shell program (such as <code>/bin/sh</code>) and the shell program launches two programs (<code>ps</code> and <code>wc</code>) and pipes (<code>|</code>) the output of the first program to the input of the second program.</p>\n\n<p><code>/bin/sh -c command</code> is equivalent to typing <code>command</code> in a terminal (with some minor differences, read <code>man sh</code> for more details).</p>\n"}, {"tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 4, "last_activity_date": 1452493157, "creation_date": 1452493157, "answer_id": 34715282, "question_id": 34714320, "link": "https://stackoverflow.com/questions/34714320/counting-the-processes-on-linux-in-golang/34715282#34715282", "title": "Counting the processes on linux in Golang", "body": "<p>You can find the code that the Linux <code>ps</code> uses to iterate through the list of processes here:</p>\n\n<p><a href=\"https://gitlab.com/procps-ng/procps/blob/master/proc/readproc.c#L1167\" rel=\"nofollow\">https://gitlab.com/procps-ng/procps/blob/master/proc/readproc.c#L1167</a></p>\n\n<p>In short, the algorithm is:</p>\n\n<ol>\n<li><code>opendir</code> on <code>/proc</code></li>\n<li>call <code>readdir</code> until an entry whose first character is a digit is returned.</li>\n</ol>\n\n<p>So to count the number of processes, you can read through the entire directory and count how many entries match.</p>\n\n<p>You can do this in Go using <a href=\"https://golang.org/pkg/os/#Open\" rel=\"nofollow\"><code>os.Open</code></a> to open <code>/proc</code>, and then call the <code>Readdirnames</code> method to list the processes.</p>\n"}], "owner": {"reputation": 58, "user_id": 5518497, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6129e8124e3bd4b7523a33b39364fc22?s=128&d=identicon&r=PG&f=1", "display_name": "Hippity Hoopla", "link": "https://stackoverflow.com/users/5518497/hippity-hoopla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 1, "accepted_answer_id": 34715282, "answer_count": 2, "score": 1, "last_activity_date": 1452753927, "creation_date": 1452487548, "question_id": 34714320, "link": "https://stackoverflow.com/questions/34714320/counting-the-processes-on-linux-in-golang", "title": "Counting the processes on linux in Golang", "body": "<p>I am working on a plugin that can count the processes running on a Linux system. I have searched around and it seems that I need to access /proc and gather information from there. I also tried using the os, os/exec, and syscall packages to run the external command <code>ps -A --no-headers | wc -l</code> but this isn't working either. I am coding this in golang as well. Any help or suggestions are welcome. </p>\n"}, {"tags": ["data-structures", "go", "iterator", "idioms"], "comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1452482899, "post_id": 34713699, "comment_id": 57173830, "body": "How many subtasks do you have? Are your subtasks&#39; names needed?"}, {"owner": {"reputation": 1339, "user_id": 5050271, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7d9872fccb84200dc7ef709c4449c4f2?s=128&d=identicon&r=PG&f=1", "display_name": "Meow", "link": "https://stackoverflow.com/users/5050271/meow"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1452483076, "post_id": 34713699, "comment_id": 57173869, "body": "Let&#39;s say a fixed but arbitrary amount, meaning the problem might later have 10 subtasks, but once I define it I don&#39;t expect the data structure to grow or shrink. The reason why I wanted my nested structures to be named is because I don&#39;t want collision among unique ID&#39;s."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1452483192, "post_id": 34713699, "comment_id": 57173895, "body": "But do you need the names? Like <code>task2</code> or <code>subtask1</code>? Will they be used anywhere?"}, {"owner": {"reputation": 1339, "user_id": 5050271, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7d9872fccb84200dc7ef709c4449c4f2?s=128&d=identicon&r=PG&f=1", "display_name": "Meow", "link": "https://stackoverflow.com/users/5050271/meow"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1452483404, "post_id": 34713699, "comment_id": 57173928, "body": "The only reason I wanted <code>task1</code> is because they are unique tasks and there shouldn&#39;t be collision. The reason I want <code>subtask1</code> is because I will be treating them differently (some API&#39;s want different headers), otherwise I would put them into an array."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1452483467, "post_id": 34713699, "comment_id": 57173942, "body": "How about adding this in the question? Because from your current &#39;code&#39;, no one can guess that you want to treat them differently"}], "answers": [{"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 1, "last_activity_date": 1452483836, "creation_date": 1452483836, "answer_id": 34713894, "question_id": 34713699, "link": "https://stackoverflow.com/questions/34713699/idiomatic-way-to-store-and-iterate-over-a-named-nested-data-structure-in-go/34713894#34713894", "title": "Idiomatic way to store and iterate over a named nested data structure in Go?", "body": "<p>Based on what I saw in your pseudocode and based on what I heard from the comments, I would go with slice of slices of struct:</p>\n\n<p>So I would define a struct:</p>\n\n<pre><code>type subtask struct {\n    name string\n    kind int\n}\n</code></pre>\n\n<p>where <code>name</code> would be your <code>api.example.com/stuff/</code> and <code>kind</code> would be a type of your subtask:</p>\n\n<blockquote>\n  <p>I will be treating them differently (some API's want different\n  headers)</p>\n</blockquote>\n\n<p>Then your list would look like this:</p>\n\n<pre><code>list := [][]subtask{\n    []subtask{subtask{\"example1\", 1}, subtask{\"example2\", 1}},\n    []subtask{subtask{\"example3\", 1}, subtask{\"example4\", 2}},\n}\n</code></pre>\n\n<p>And fully working example is here <kbd><a href=\"https://play.golang.org/p/zJCTXjHUlM\" rel=\"nofollow\">Playground</a></kbd></p>\n"}], "owner": {"reputation": 1339, "user_id": 5050271, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7d9872fccb84200dc7ef709c4449c4f2?s=128&d=identicon&r=PG&f=1", "display_name": "Meow", "link": "https://stackoverflow.com/users/5050271/meow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452484076, "creation_date": 1452482341, "last_edit_date": 1452484076, "question_id": 34713699, "link": "https://stackoverflow.com/questions/34713699/idiomatic-way-to-store-and-iterate-over-a-named-nested-data-structure-in-go", "title": "Idiomatic way to store and iterate over a named nested data structure in Go?", "body": "<p>My question is split into two: (1) what's the best way to store the data for taskList below, and (2) what's the best way to iterate over such a structure?</p>\n\n<p>I want the <code>task1</code> named because they are unique tasks and there shouldn't be an ID collision. I want individually named <code>subtask0</code> because they are unique tasks with different requirements.</p>\n\n<p>Below is a pseudo-Go representation of my intention:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfn main() {\n    const taskList := {\n        \"task1\": {\n            \"subtask0\": \"api.example.com/stuff/\"\n            \"subtask1\": \"api.example.com/stuff/\"\n            \"subtask2\": \"api.example.com/stuff/\"\n        }\n        \"task2\": { \n            \"subtask0\": \"api.example.com/stuff/\"\n            \"subtask1\": \"api.example.com/stuff/\"\n            \"subtask2\": \"api.example.com/stuff/\"\n        }\n    }\n\n    for i := range taskList {\n        for j := range taskList[i] {\n            fmt.Printf(\"%s\\n\", taskList[i][j])\n        }\n    }\n}\n</code></pre>\n\n<p>I've tried struct, but I had difficulty iterating over the struct. I wanted to avoid <code>map</code> because Go wouldn't let me store it in a <code>const</code>.</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 2917, "user_id": 486167, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f043204ff888375a2657ec3bc149c53c?s=128&d=identicon&r=PG", "display_name": "Asad Iqbal", "link": "https://stackoverflow.com/users/486167/asad-iqbal"}, "edited": false, "score": 0, "creation_date": 1452479948, "post_id": 34713150, "comment_id": 57173178, "body": "I wonder the downvote."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452530509, "post_id": 34713150, "comment_id": 57199156, "body": "You can&#39;t declare <code>_</code>, though unnecessary, the second would have compiled with <code>case _ = &lt;-termSig</code>"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1452531534, "post_id": 34713150, "comment_id": 57199866, "body": "@AsadIqbal I downvoted because &quot;This question does not show any research effort.&quot; As I pointed out in my answer, the official tutorial shows exactly this use case in the first page that mentions <code>select</code>, so it&#39;s nearly impossible not to come across on your own."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 7, "last_activity_date": 1452478468, "creation_date": 1452478468, "answer_id": 34713231, "question_id": 34713150, "link": "https://stackoverflow.com/questions/34713150/how-to-get-and-ignore-a-value-from-go-channel/34713231#34713231", "title": "How to get (and ignore) a value from Go channel", "body": "<p>Just omit the variable and the <code>:=</code>:</p>\n\n<pre><code>case &lt;-termSig:\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 3, "last_activity_date": 1452478879, "creation_date": 1452478879, "answer_id": 34713293, "question_id": 34713150, "link": "https://stackoverflow.com/questions/34713150/how-to-get-and-ignore-a-value-from-go-channel/34713293#34713293", "title": "How to get (and ignore) a value from Go channel", "body": "<p>As is shown in the <a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow\">Go Tour</a> when <code>select</code> is introduced, you can have a case that doesn't initialize a new variable.</p>\n\n<pre><code>func fibonacci(c, quit chan int) {\n    x, y := 0, 1\n    for {\n        select {\n        case c &lt;- x:\n            x, y = y, x+y\n        case &lt;-quit:  // looks like exactly your use case\n            fmt.Println(\"quit\")\n            return\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2917, "user_id": 486167, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f043204ff888375a2657ec3bc149c53c?s=128&d=identicon&r=PG", "display_name": "Asad Iqbal", "link": "https://stackoverflow.com/users/486167/asad-iqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 34713231, "answer_count": 2, "score": -3, "last_activity_date": 1452479926, "creation_date": 1452477719, "last_edit_date": 1452479926, "question_id": 34713150, "link": "https://stackoverflow.com/questions/34713150/how-to-get-and-ignore-a-value-from-go-channel", "title": "How to get (and ignore) a value from Go channel", "body": "<p>I have the following code in a <code>select</code> statement. <code>finish</code> is of type <code>bool</code>. Actually, I don't even care of the value as long as I just receive anything. However, Go gives me an unused variable error. How can I get around it?</p>\n\n<pre><code>case finish := &lt;- termSig:\n</code></pre>\n\n<p>My current workaround is to <code>Println(finish)</code>. </p>\n\n<p>I had tried:-</p>\n\n<pre><code>case _ := &lt;- termSig:\n</code></pre>\n\n<p>but that doesn't work either. </p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1452470874, "post_id": 34712015, "comment_id": 57171100, "body": "What is the error returned from xml.Unmarshal?"}], "answers": [{"tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 6, "last_activity_date": 1452484676, "last_edit_date": 1452484676, "creation_date": 1452470951, "answer_id": 34712322, "question_id": 34712015, "link": "https://stackoverflow.com/questions/34712015/unmarshal-multiple-xml-items/34712322#34712322", "title": "Unmarshal multiple XML items", "body": "<p>You are ignoring the error return from <code>xml.Unmarshal</code>.  By <a href=\"http://play.golang.org/p/EwcBAGnEPJ\" rel=\"nofollow\">slightly modifying your program</a>, we can see what is going on:</p>\n\n<pre><code>xml: encoding \"ISO-8859-1\" declared but Decoder.CharsetReader is nil\n</code></pre>\n\n<p>And <a href=\"https://golang.org/pkg/encoding/xml/#Decoder\" rel=\"nofollow\">poking around in the documentation</a>, we find that by default the package only supports XML encoded in UTF-8:</p>\n\n<pre><code>    // CharsetReader, if non-nil, defines a function to generate\n    // charset-conversion readers, converting from the provided\n    // non-UTF-8 charset into UTF-8. If CharsetReader is nil or\n    // returns an error, parsing stops with an error. One of the\n    // the CharsetReader's result values must be non-nil.\n    CharsetReader func(charset string, input io.Reader) (io.Reader, error)\n</code></pre>\n\n<p>So it seems you need to provide your own character set conversion routine.  You can inject it by modifying your code something like this:</p>\n\n<pre><code>decoder := xml.NewDecoder(xmlFile)\ndecoder.CharsetReader = makeCharsetReader\nerr := decoder.Decode(&amp;tides)\n</code></pre>\n\n<p>(note that we're now decoding from an <code>io.Reader</code> rather than a byte array now, so the <code>ReadAll</code> logic can be removed).  The <a href=\"https://godoc.org/golang.org/x/text/encoding\" rel=\"nofollow\"><code>golang.org/x/text/encoding</code> family of packages</a> might help you in implementing your <code>makeCharsetReader</code> function.  Something like this might work:</p>\n\n<pre><code>import \"golang.org/x/text/encoding/charmap\"\n\nfunc makeCharsetReader(charset string, input io.Reader) (io.Reader, error) {\n    if charset == \"ISO-8859-1\" {\n        // Windows-1252 is a superset of ISO-8859-1, so should do here\n        return charmap.Windows1252.NewDecoder().Reader(input), nil\n    }\n    return nil, fmt.Errorf(\"Unknown charset: %s\", charset)\n}\n</code></pre>\n\n<p>You should then be able to decode the XML.</p>\n"}], "owner": {"reputation": 2597, "user_id": 2291517, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gGDf0.jpg?s=128&g=1", "display_name": "surfearth", "link": "https://stackoverflow.com/users/2291517/surfearth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 1, "accepted_answer_id": 34712322, "answer_count": 1, "score": 1, "last_activity_date": 1452484676, "creation_date": 1452468414, "last_edit_date": 1452469383, "question_id": 34712015, "link": "https://stackoverflow.com/questions/34712015/unmarshal-multiple-xml-items", "title": "Unmarshal multiple XML items", "body": "<p>I am trying to unmarshal multiple items contained in nodes with an identical structure for further processing, but don't seem to be able to access the data and I am not sure why. The XML data is structured in the following form (I am trying to access all of the <code>Item</code>'s:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?&gt; \n&lt;datainfo&gt;\n  &lt;origin&gt;NOAA/NOS/CO-OPS&lt;/origin&gt;\n  &lt;producttype&gt; Annual Tide Prediction &lt;/producttype&gt;\n  &lt;IntervalType&gt;High/Low Tide Predictions&lt;/IntervalType&gt;\n  &lt;data&gt;\n    &lt;item&gt;\n      &lt;date&gt;2015/12/31&lt;/date&gt;\n      &lt;day&gt;Thu&lt;/day&gt;\n      &lt;time&gt;03:21 AM&lt;/time&gt;\n      &lt;predictions_in_ft&gt;5.3&lt;/predictions_in_ft&gt;\n      &lt;predictions_in_cm&gt;162&lt;/predictions_in_cm&gt;\n      &lt;highlow&gt;H&lt;/highlow&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n      &lt;date&gt;2015/12/31&lt;/date&gt;\n      &lt;day&gt;Thu&lt;/day&gt;\n      &lt;time&gt;09:24 AM&lt;/time&gt;\n      &lt;predictions_in_ft&gt;2.4&lt;/predictions_in_ft&gt;\n      &lt;predictions_in_cm&gt;73&lt;/predictions_in_cm&gt;\n      &lt;highlow&gt;L&lt;/highlow&gt;\n    &lt;/item&gt;\n  &lt;/data&gt;\n&lt;/datainfo&gt;\n</code></pre>\n\n<p>My code is:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\n// TideData stores a series of tide predictions\ntype TideData struct {\n    Tides []Tide `xml:\"data&gt;item\"`\n}\n\n// Tide stores a single tide prediction\ntype Tide struct {\n    Date         string  `xml:\"date\"`\n    Day          string  `xml:\"day\"`\n    Time         string  `xml:\"time\"`\n    PredictionFt float64 `xml:\"predictions_in_ft\"`\n    PredictionCm float64 `xml:\"predictions_in_cm\"`\n    HighLow      string  `xml:\"highlow\"`\n}\n\nfunc (t Tide) String() string {\n    return t.Date + \" \" + t.Day + \" \" + t.Time + \" \" + t.HighLow\n}\n\nfunc main() {\n    xmlFile, err := os.Open(\"9414275 Annual.xml\")\n    if err != nil {\n        fmt.Println(\"Error opening file:\", err)\n        return\n    }\n    defer xmlFile.Close()\n\n    b, _ := ioutil.ReadAll(xmlFile)\n\n    var tides TideData\n    xml.Unmarshal(b, &amp;tides)\n\n    fmt.Println(tides)\n    for _, datum := range tides.Tides {\n        fmt.Printf(\"\\t%s\\n\", datum)\n    }\n}\n</code></pre>\n\n<p>When run the output is empty, which leads me to think that the data is not unmarshalled. Output is:</p>\n\n<pre><code>{[]}\n</code></pre>\n"}, {"tags": ["file", "go", "flock", "filelock", "panic"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452458020, "post_id": 34710460, "comment_id": 57167025, "body": "You&#39;re calling defer before checking for an error. If there is an error the file will be nil."}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452458127, "post_id": 34710460, "comment_id": 57167059, "body": "@JimB, please correct me if I am wrong, but defer is stacked, and will be executed only when the function is about to get finished, right? Can it create a problem?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452458366, "post_id": 34710460, "comment_id": 57167135, "body": "That doesn&#39;t matter. If your function ends and <code>lockProgram</code> is nil you will get a panic. You need to check the error and return early if you want to defer the close"}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452458554, "post_id": 34710460, "comment_id": 57167207, "body": "Thank you @JimB, this helps."}, {"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 0, "creation_date": 1452459245, "post_id": 34710460, "comment_id": 57167429, "body": "When your program panics you get the stack trace. Please tell where exactly panic occurs. Is it in your CheckForError function?"}], "answers": [{"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1452458397, "creation_date": 1452458397, "answer_id": 34710523, "question_id": 34710460, "link": "https://stackoverflow.com/questions/34710460/golang-flock-filelocking-throwing-panic-runtime-error-invalid-memory-address-o/34710523#34710523", "title": "Golang flock filelocking throwing panic: runtime error: invalid memory address or nil pointer dereference", "body": "<p>When an error occurs while creating the lock, <code>lockProgram</code> will be <code>nil</code>. This will cause the subsequent (deferred) call to <code>lockProgram.Close()</code> to fail.</p>\n\n<p>Note that when you're panicking (like in your <code>CheckForError</code> function), deferred method calls will still be executed. This is explained in detail in <a href=\"http://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow\">this blog article</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>Panic is a built-in function that stops the ordinary flow of control and begins panicking. When the function F calls panic, execution of F stops, <strong>any deferred functions in F are executed normally</strong>, and then F returns to its caller. To the caller, F then behaves like a call to panic. The process continues up the stack until all functions in the current goroutine have returned, at which point the program crashes.</p>\n</blockquote>\n\n<p>Solution: Check for errors first, and then defer the <code>Close()</code> call:</p>\n\n<pre><code>lockProgram, err := os.Create(\"/var/.daemon.lock\")\nCheckForError(err)\ndefer lockProgram.Close()\n</code></pre>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "accepted_answer_id": 34710523, "answer_count": 1, "score": 2, "last_activity_date": 1452458397, "creation_date": 1452457915, "question_id": 34710460, "link": "https://stackoverflow.com/questions/34710460/golang-flock-filelocking-throwing-panic-runtime-error-invalid-memory-address-o", "title": "Golang flock filelocking throwing panic: runtime error: invalid memory address or nil pointer dereference", "body": "<p>I have a go program that modifies my configuration file. I am trying to create a filelock from within the main() function, but it is throwing a <code>panic: runtime error: invalid memory address or nil pointer dereference</code> error. Without the lock, the program is working fine as expected. The piece of code that throws exception is</p>\n\n<pre><code>lockProgram, err := os.Create(\"/var/.daemon.lock\")\ndefer lockProgram.Close()\nCheckForError(err)\nGetLock(lockProgram, syscall.LOCK_EX)\ndefer UngetLock(lockProgram)\n</code></pre>\n\n<p>//This is in a separate package</p>\n\n<pre><code>func CheckForError(e error) {\n    if e != nil {\n        Error.Println(e)\n        panic(e)\n    }\n}\n\nfunc GetLock(file *os.File, locktype int )  {\n    fmt.Println(\"Acquiring lock on \", file.Name())\n    syscall.Flock(int(file.Fd()), locktype)\n    fmt.Println(\"Acquired filelock on \", file.Name())\n}\nfunc UngetLock(file *os.File)  {\n    syscall.Flock(int(file.Fd()), syscall.LOCK_UN);\n}\n</code></pre>\n\n<p>This same <code>flock</code> is working when I call it on my configuration file, but from a different package, not main package, but throws the same error when I try to put lock from within the main package. Please help me in finding out what am I doing wrong here.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452457906, "post_id": 34710357, "comment_id": 57166995, "body": "Does your data have no predefined structure? Yes, this is what you have to do if you don&#39;t know the data structures are (though there&#39;s better ways of structuring the code)"}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452458405, "post_id": 34710357, "comment_id": 57167144, "body": "Exactly, it doesn&#39;t have a structure. How can I make the above code more readable please?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1452458472, "post_id": 34710357, "comment_id": 57167174, "body": "Do you want to print everything unmarshaled from JSON recursively or just the &quot;top&quot; layer?"}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 0, "creation_date": 1452458776, "post_id": 34710357, "comment_id": 57167275, "body": "Yes loop over everything and print it without shortcuts :P It&#39;s my blueprint for when I need to play with the data later on, thanks. So I probably need to do something more recursive here."}, {"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 0, "creation_date": 1452459454, "post_id": 34710357, "comment_id": 57167500, "body": "You don&#39;t handle nested objects. Better make recursive calls as suggested above."}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 0, "creation_date": 1452460177, "post_id": 34710357, "comment_id": 57167741, "body": "added my failed attempt to do so."}, {"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "edited": false, "score": 2, "creation_date": 1452463657, "post_id": 34710357, "comment_id": 57168966, "body": "What&#39;s some of the sample JSON you&#39;re trying to decode? Is the initial structure an array of objects? Seems like you&#39;re type asserting into it fairly confident..."}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 0, "creation_date": 1452465040, "post_id": 34710357, "comment_id": 57169378, "body": "Correct, type asserting it to reduce complexity for now :)"}], "answers": [{"tags": [], "owner": {"reputation": 1759, "user_id": 1512962, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/EfW0L.png?s=128&g=1", "display_name": "Anonymous Penguin", "link": "https://stackoverflow.com/users/1512962/anonymous-penguin"}, "is_accepted": true, "score": 3, "last_activity_date": 1452470895, "creation_date": 1452470895, "answer_id": 34712317, "question_id": 34710357, "link": "https://stackoverflow.com/questions/34710357/json-unmarshal-generic-interface/34712317#34712317", "title": "json unmarshal generic interface{}", "body": "<p>It seems as the root part of the JSON code is a JSON array (the <code>[\"item\", \"item\", {\"key\": \"value\"}]</code> notation). Although some JSON libraries don't like it, the \"root\" of the JSON blob can be an array and not an object (the <code>{\"key\": \"value\"}</code> notation).</p>\n\n<p>In a production application, you should use the second value of type assertions to make sure it's the right type:</p>\n\n<pre><code>m, mOk := j.(map[string]interface{})\ns, sOk := j.([]interface{})\n\nif mOk {\n    // Use Map\n} else {\n    // Use Slice\n}\n</code></pre>\n\n<p>If you don't need to edit the data, <strong><a href=\"https://github.com/antonholmquist/jason\" rel=\"nofollow\">Jason</a></strong> is a great library for Go.</p>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1997, "favorite_count": 2, "accepted_answer_id": 34712317, "answer_count": 1, "score": 0, "last_activity_date": 1452470895, "creation_date": 1452457284, "last_edit_date": 1452463322, "question_id": 34710357, "link": "https://stackoverflow.com/questions/34710357/json-unmarshal-generic-interface", "title": "json unmarshal generic interface{}", "body": "<p><a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow\">http://blog.golang.org/json-and-go</a></p>\n\n<p><code>m := j.(map[string]interface{})</code> didn't work for me</p>\n\n<pre><code>panic: interface conversion: interface {} is []interface {}, not map[string]interface {}\n</code></pre>\n\n<p>So I end up with code like this to make it work? Don't think its the correct way of doing it :)</p>\n\n<pre><code>    var j interface{}\n    err = json.Unmarshal(b, &amp;j)\n    if err != nil {\n        log.Print(err.Error())\n    }\n\n    m := j.([]interface{}) //map[string]interface{}\n\n    for k, v := range m {\n        switch vv := v.(type) {\n        case string:\n            fmt.Println(k, \"is string\", vv)\n        case int:\n            fmt.Println(k, \"is int\", vv)\n        case []interface{}:\n            fmt.Println(k, \"is an array:\")\n            for i, u := range vv {\n                fmt.Println(i, u)\n            }\n        case map[string]interface{}:\n            for k2, v2 := range v.(map[string]interface{}) {\n                switch vv2 := v2.(type) {\n                case string:\n                    fmt.Println(k2, \"is string\", vv2)\n                case int:\n                    fmt.Println(k2, \"is int\", vv2)\n                case []interface{}:\n                    fmt.Println(k2, \"is an array:\")\n                    for i2, u2 := range vv2 {\n                        fmt.Println(i2, u2)\n                    }\n                default:\n                    fmt.Println(k2, \"is of a type I don't know how to handle\")\n                }\n            }\n        default:\n            fmt.Println(k, \"is of a type I don't know how to handle\")\n        }\n    }\n</code></pre>\n\n<p>EDIT: My failed attempt to make it readable</p>\n\n<pre><code>    var j interface{}\n    err = json.Unmarshal(b, &amp;j)\n    if err != nil {\n        log.Print(err.Error())\n    }\n    write(j.([]interface{}))\n\nfunc write(j []interface{}) {\n    for k, v := range j {\n        switch vv := v.(type) {\n        case string:\n            fmt.Println(k, \"is string\", vv)\n        case int:\n            fmt.Println(k, \"is int\", vv)\n        case []interface{}:\n            fmt.Println(k, \"is an array:\")\n            for i, u := range vv {\n                fmt.Println(i, u)\n            }\n        case map[string]interface{}:\n            write(v.([]interface{}))\n        default:\n            fmt.Println(k, \"is of a type I don't know how to handle\")\n        }\n    }\n}\n</code></pre>\n\n<p>EDIT2: Works but still ugly</p>\n\n<pre><code>    var j interface{}\n    err = json.Unmarshal(b, &amp;j)\n    if err != nil {\n        log.Print(err.Error())\n    }\n    write(j.([]interface{}))\n\nfunc write(j []interface{}) {\n    for k, v := range j {\n        switch vv := v.(type) {\n        case string:\n            fmt.Println(k, \"is string\", vv)\n        case int:\n            fmt.Println(k, \"is int\", vv)\n        case []interface{}:\n            fmt.Println(k, \"is an array:\")\n            for i, u := range vv {\n                fmt.Println(i, u)\n            }\n        case map[string]interface{}:\n            write2(v.(map[string]interface{}))\n        default:\n            fmt.Println(k, \"is of a type I don't know how to handle\")\n        }\n    }\n}\n\nfunc write2(j map[string]interface{}) {\n    for k, v := range j {\n        switch vv := v.(type) {\n        case string:\n            fmt.Println(k, \"is string\", vv)\n        case int:\n            fmt.Println(k, \"is int\", vv)\n        case []interface{}:\n            fmt.Println(k, \"is an array:\")\n            for i, u := range vv {\n                fmt.Println(i, u)\n            }\n        default:\n            fmt.Println(k, \"is of a type I don't know how to handle\")\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "pprof"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452456550, "post_id": 34710112, "comment_id": 57166554, "body": "pprof profiles the entire program. Please show exactly what you&#39;re doing."}, {"owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452458497, "post_id": 34710112, "comment_id": 57167186, "body": "@JimB You&#39;re correct! The problem was that I needed an immense server load to see what I wanted to see."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452458695, "post_id": 34710112, "comment_id": 57167255, "body": "Yes, you can&#39;t profile what the server isn&#39;t doing."}], "answers": [{"tags": [], "owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "is_accepted": true, "score": 0, "last_activity_date": 1452458576, "creation_date": 1452458576, "answer_id": 34710560, "question_id": 34710112, "link": "https://stackoverflow.com/questions/34710112/how-to-profile-multiple-goroutines/34710560#34710560", "title": "How to profile multiple goroutines", "body": "<p>I put my server under load with siege. With 1000 concurrent users I got the profiling data that I wanted.</p>\n"}], "owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 34710560, "answer_count": 1, "score": -2, "last_activity_date": 1452458576, "creation_date": 1452455729, "question_id": 34710112, "link": "https://stackoverflow.com/questions/34710112/how-to-profile-multiple-goroutines", "title": "How to profile multiple goroutines", "body": "<p>I want to profile a server written in Go. I am using \"net/http/pprof\", but the default behaviour is utterly useless, as it seems to only profile the goroutine running the server that serves the profiling data.</p>\n"}, {"tags": ["macos", "go", "zsh"], "comments": [{"owner": {"reputation": 68617, "user_id": 3776858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juunm.png?s=128&g=1", "display_name": "Cyrus", "link": "https://stackoverflow.com/users/3776858/cyrus"}, "edited": false, "score": 0, "creation_date": 1452445669, "post_id": 34708207, "comment_id": 57162607, "body": "Do you use bash or zsh?"}, {"owner": {"reputation": 1462, "user_id": 5062134, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/c2Ea0.jpg?s=128&g=1", "display_name": "medev21", "link": "https://stackoverflow.com/users/5062134/medev21"}, "reply_to_user": {"reputation": 68617, "user_id": 3776858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juunm.png?s=128&g=1", "display_name": "Cyrus", "link": "https://stackoverflow.com/users/3776858/cyrus"}, "edited": false, "score": 1, "creation_date": 1452446034, "post_id": 34708207, "comment_id": 57162760, "body": "I am using zsh in the command line."}, {"owner": {"reputation": 9084, "user_id": 1020958, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3449339f1e3c04da6e4d08ad13a3d593?s=128&d=identicon&r=PG", "display_name": "bjhaid", "link": "https://stackoverflow.com/users/1020958/bjhaid"}, "edited": false, "score": 4, "creation_date": 1452446038, "post_id": 34708207, "comment_id": 57162762, "body": "should be adding your <code>PATH</code> variable to <code>~&#47;.zshrc</code> and not bash profile, the error shows you are using <code>zsh</code> and not bash"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1452446373, "post_id": 34708207, "comment_id": 57162896, "body": "You should do <code>echo $PATH</code> to see whether your PATH include <code>&#47;usr&#47;local&#47;go&#47;bin</code>.  If not, you&#39;ve not edited the correct file, or not edited all the relevant files."}, {"owner": {"reputation": 1462, "user_id": 5062134, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/c2Ea0.jpg?s=128&g=1", "display_name": "medev21", "link": "https://stackoverflow.com/users/5062134/medev21"}, "reply_to_user": {"reputation": 9084, "user_id": 1020958, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3449339f1e3c04da6e4d08ad13a3d593?s=128&d=identicon&r=PG", "display_name": "bjhaid", "link": "https://stackoverflow.com/users/1020958/bjhaid"}, "edited": false, "score": 2, "creation_date": 1452446488, "post_id": 34708207, "comment_id": 57162941, "body": "@bjhaid, this worked, thank you so much.  I&#39;m assuming if i want to add a workspace path, I need to add this to zshrc file as well.  Is this correct?"}, {"owner": {"reputation": 9084, "user_id": 1020958, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3449339f1e3c04da6e4d08ad13a3d593?s=128&d=identicon&r=PG", "display_name": "bjhaid", "link": "https://stackoverflow.com/users/1020958/bjhaid"}, "edited": false, "score": 0, "creation_date": 1452446788, "post_id": 34708207, "comment_id": 57163059, "body": "@medev21 I don&#39;t know how go tooling works, so I can&#39;t answer that question"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1452470072, "post_id": 34708207, "comment_id": 57170904, "body": "@medev21 Go doesn&#39;t have the workspaces in the way Python might. Better is to use a tool like <a href=\"http://getgb.io/\" rel=\"nofollow noreferrer\">getgb.io</a> which helps tackle this problem better."}], "answers": [{"tags": [], "owner": {"reputation": 3081, "user_id": 3704230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nerUF.jpg?s=128&g=1", "display_name": "Caleb Adams", "link": "https://stackoverflow.com/users/3704230/caleb-adams"}, "is_accepted": true, "score": 106, "last_activity_date": 1456641133, "last_edit_date": 1495540032, "creation_date": 1454041182, "answer_id": 35076805, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go/35076805#35076805", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>Like <a href=\"https://stackoverflow.com/users/1020958/bjhaid\">bjhaid</a> mentioned in the comments above: </p>\n\n<p>This is happening because you must add your <code>PATH</code> to your <code>~/.zshrc</code> file.</p>\n\n<p>in the <code>~/.zshrc</code> you should add the line:</p>\n\n<pre><code>export PATH=$PATH:/usr/local/go/bin\n</code></pre>\n\n<p>you should then source you <code>.zshrc</code> file:</p>\n\n<pre><code>. ~/.zshrc\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1622, "user_id": 3407736, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b17228b71d87b56d2d31cb344c5a5278?s=128&d=identicon&r=PG&f=1", "display_name": "Always_Beginner", "link": "https://stackoverflow.com/users/3407736/always-beginner"}, "is_accepted": false, "score": 3, "last_activity_date": 1494140912, "creation_date": 1494140912, "answer_id": 43828767, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go/43828767#43828767", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>For bash, you should edit the <code>.bashrc</code> file and add the abobe mentioned line:</p>\n\n<pre><code>export PATH=$PATH:/usr/local/go/bin\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 3843857, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004062482953/picture?type=large", "display_name": "Mahesh Babu Gorantla", "link": "https://stackoverflow.com/users/3843857/mahesh-babu-gorantla"}, "is_accepted": false, "score": 4, "last_activity_date": 1542732385, "creation_date": 1542732385, "answer_id": 53397698, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go/53397698#53397698", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>Add the following line to <code>~/.bashrc</code> or <code>~/.bash_profile</code> file at the end on your Mac</p>\n\n<p><code>alias go=\"/usr/local/go/bin/go\"</code></p>\n\n<p>And in the <code>Terminal</code></p>\n\n<p><code>source ~/.bashrc</code> or <code>source ~/.bash_profile</code> in an existing terminal session. Or to see the new changes you can also re-open a new terminal session.</p>\n"}, {"tags": [], "owner": {"reputation": 1501, "user_id": 4557946, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/Qtd3P.jpg?s=128&g=1", "display_name": "Tushar Saha", "link": "https://stackoverflow.com/users/4557946/tushar-saha"}, "is_accepted": false, "score": 2, "last_activity_date": 1549389908, "creation_date": 1549389908, "answer_id": 54540502, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go/54540502#54540502", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>This is what i did on my mac: </p>\n\n<p>opened the file <code>~/.zshrc</code> using \n<code>sudo nano ~/.zshrc</code>\nthen pasted </p>\n\n<p><code>export PATH=$PATH:/usr/local/go/bin</code>\nsave and exit(ctrl + s, ctrl + x then press y)\nthen ran</p>\n\n<p><code>. ~/.zshrc</code>\ngo was up and running, \nverified by typing just go in command line.</p>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 9303080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ny0BX.jpg?s=128&g=1", "display_name": "mgrotheer", "link": "https://stackoverflow.com/users/9303080/mgrotheer"}, "is_accepted": false, "score": 13, "last_activity_date": 1560046271, "last_edit_date": 1560046271, "creation_date": 1552153592, "answer_id": 55080230, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go/55080230#55080230", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>I kept running into issues and followed the steps on here and finally got a working solution: <a href=\"http://totzyuta.github.io/blog/2015/06/21/installing-go-by-homebrew-on-mac-os-x/\" rel=\"noreferrer\">http://totzyuta.github.io/blog/2015/06/21/installing-go-by-homebrew-on-mac-os-x/</a></p>\n\n<p>Install w/brew: </p>\n\n<pre><code>brew install golang\n</code></pre>\n\n<p>Edit bash_profile and add following paths:</p>\n\n<pre><code>nano ~/.bash_profile\n\nexport GOROOT=/usr/local/opt/go/libexec\nexport GOPATH=$HOME/.go\nexport PATH=$PATH:$GOROOT/bin:$GOPATH/bin\n</code></pre>\n\n<p>Source it: </p>\n\n<p><code>source ~/.bash_profile</code></p>\n\n<p>Then restart terminal </p>\n\n<p><code>go version</code></p>\n\n<p>Output: go version go1.12 darwin/amd64</p>\n"}, {"tags": [], "owner": {"reputation": 304, "user_id": 12105019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uk4anXj55rY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhwsY-XPG_II8c67hiRUjr0bg2_Q/photo.jpg?sz=128", "display_name": "Tapan Hegde", "link": "https://stackoverflow.com/users/12105019/tapan-hegde"}, "is_accepted": false, "score": 0, "last_activity_date": 1569914328, "creation_date": 1569914328, "answer_id": 58179811, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go/58179811#58179811", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>In my case I was not having ~/.<code>zshrc</code> profile file. Followed below steps to make it work.</p>\n\n<p>Mac os version : Mojave (10.14.6)</p>\n\n<p>Go version : go1.13.1 <code>darwin</code>/<code>amd64</code></p>\n\n<p>Reference link : <a href=\"https://www.cyberciti.biz/faq/installing-go-programming-language-on-mac-os-x/\" rel=\"nofollow noreferrer\">https://www.cyberciti.biz/faq/installing-go-programming-language-on-mac-os-x/</a></p>\n\n<p>As mentioned in link, when i was executing \"go env\" command, it was throwing error \"go command not found\". Adding \"export PATH=$PATH:/usr/local/go/bin\" in \"~/.<code>bashrc</code>\" profile file didn't do any magic!!</p>\n\n<p>step 1 : Create .<code>zshrc</code> profile under home path.</p>\n\n<p>$ cd /User/xxxx\n(Eg : /User/<code>tapan</code>)</p>\n\n<p>$ touch .<code>zshrc</code></p>\n\n<p>step 2 : append 'PATH' with go in .<code>zshrc</code> file.</p>\n\n<p>$ vim .<code>zshrc</code></p>\n\n<p>$ export PATH=$PATH:/usr/local/go/bin</p>\n\n<p>step 3 : source your .<code>zshrc</code> file</p>\n\n<p>$ source ~/.<code>zshrc</code></p>\n\n<p>step 4 : execute \"go env\" command, you should be able to see local environment details.</p>\n\n<p>$ go env</p>\n"}, {"comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1599471469, "post_id": 63774324, "comment_id": 112775282, "body": "this is a duplicate answer"}], "tags": [], "owner": {"reputation": 1600, "user_id": 3307233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6696806313e6b7dcc35c364c4f613e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pankaj Gaikar", "link": "https://stackoverflow.com/users/3307233/pankaj-gaikar"}, "is_accepted": false, "score": 0, "last_activity_date": 1599468753, "creation_date": 1599468753, "answer_id": 63774324, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go/63774324#63774324", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>Add <em>Go</em> PATH to your ~/.zshrc file. Open file to edit as -</p>\n<pre><code>vim ~/.zshrc\n</code></pre>\n<p>in the <em>~/.zshrc</em> you should add the line:</p>\n<pre><code>export PATH=$PATH:/usr/local/go/bin\n</code></pre>\n<p>Once done, close and reopen terminal and you are good to go. For test, you can do -</p>\n<pre><code>go version\n</code></pre>\n<p>It will show output something like -</p>\n<pre><code>go version go1.15.1 darwin/amd64\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 10765954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a10085a2089f68179282808e642a4cc?s=128&d=identicon&r=PG&f=1", "display_name": "Rajiv Ranjan Singh", "link": "https://stackoverflow.com/users/10765954/rajiv-ranjan-singh"}, "is_accepted": false, "score": 2, "last_activity_date": 1616528815, "creation_date": 1616528815, "answer_id": 66770283, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go/66770283#66770283", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>The <code>GOPATH</code> environment variable specifies the location of your workspace. If no <code>GOPATH</code> is set, it is assumed to be <code>$HOME/go</code> on Unix systems and <code>%USERPROFILE%\\go</code> on Windows. If you want to use a custom location as your workspace, you can set the <code>GOPATH</code> environment variable.</p>\n<p>This answer explains how to set this variable on various Unix systems.</p>\n<p><code>GOPATH</code> can be any directory on your system. In Unix examples, we will set it to <code>$HOME/go</code> (the default since Go 1.8). Note that <code>GOPATH</code> must not be on the same path as your Go installation. Another common setup is to set <code>GOPATH=$HOME</code>.</p>\n<h2>Go 1.13+</h2>\n<pre class=\"lang-sh prettyprint-override\"><code>go env -w GOPATH=$HOME/go\n</code></pre>\n<h2>Bash</h2>\n<p>Edit your <code>~/.bash_profile</code> to add the following line:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>export GOPATH=$HOME/go\n</code></pre>\n<p>Save and exit your editor. Then, source your <code>~/.bash_profile</code>.</p>\n<pre class=\"lang-sh prettyprint-override\"><code>source ~/.bash_profile\n</code></pre>\n<h2>Zsh</h2>\n<p>Edit your <code>~/.zshrc</code> file to add the following line:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>export GOPATH=$HOME/go\n</code></pre>\n<p>Save and exit your editor. Then, source your <code>~/.zshrc</code>.</p>\n<pre class=\"lang-sh prettyprint-override\"><code>source ~/.zshrc\n</code></pre>\n<h2>fish</h2>\n<pre class=\"lang-sh prettyprint-override\"><code>set -x -U GOPATH $HOME/go\n</code></pre>\n<p>The <code>-x</code> is used to specify that this variable should be exported\nand the <code>-U</code> makes this a universal variable, available to all sessions and\npersistent.</p>\n"}], "owner": {"reputation": 1462, "user_id": 5062134, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/c2Ea0.jpg?s=128&g=1", "display_name": "medev21", "link": "https://stackoverflow.com/users/5062134/medev21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51106, "favorite_count": 6, "protected_date": 1560507020, "accepted_answer_id": 35076805, "answer_count": 8, "score": 43, "last_activity_date": 1616528815, "creation_date": 1452445098, "last_edit_date": 1610724328, "question_id": 34708207, "link": "https://stackoverflow.com/questions/34708207/command-not-found-go-on-mac-after-installing-go", "title": "Command not found go \u2014 on Mac after installing Go", "body": "<p>I want to use Go, but I'm having trouble running the go command. I installed go1.5.2 darwin/amd64, but when I run the command <code>go version</code>, I get an error in the terminal <code>zsh: command not found: go</code>.  I added the path <code>export PATH=$PATH:/usr/local/go/bin</code> to the bash profile, but I still get the error (I restarted the terminal btw).  I uninstalled and reinstalled, but no luck.  Can anybody help me troubleshoot this?  I'm not sure if there was an error in the installation, but it downloaded ok. I may have to download an older version of go if this doesn't workout.</p>\n"}, {"tags": ["go", "type-conversion", "integer-overflow"], "answers": [{"comments": [{"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "edited": false, "score": 0, "creation_date": 1452429722, "post_id": 34704898, "comment_id": 57156811, "body": "ok, yes I was under a false impression on how type conversion was working, thanks for clarifying things"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1452427611, "last_edit_date": 1452427611, "creation_date": 1452425760, "answer_id": 34704898, "question_id": 34704843, "link": "https://stackoverflow.com/questions/34704843/on-purpose-int-overflow/34704898#34704898", "title": "On-purpose int overflow", "body": "<p>You can simply use a type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">conversion</a>:</p>\n\n<pre><code>i := uint64(0xffffffffffffffff)\ni2 := int64(i)\nfmt.Println(i, i2)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>18446744073709551615 -1\n</code></pre>\n\n<p>Converting <code>uint64</code> to <code>int64</code> always succeeds: it doesn't change the memory representation just the type. What may confuse you is if you try to convert an untyped integer constant value to <code>int64</code>:</p>\n\n<pre><code>i3 := int64(0xffffffffffffffff) // Compile time error!\n</code></pre>\n\n<p>This is a compile time error as the constant value <code>0xffffffffffffffff</code> (which is represented with arbitrary precision) does not fit into <code>int64</code> because the max value that fits into <code>int64</code> is <code>0x7fffffffffffffff</code>:</p>\n\n<pre><code>constant 18446744073709551615 overflows int64\n</code></pre>\n"}], "owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1244, "favorite_count": 0, "accepted_answer_id": 34704898, "answer_count": 1, "score": 3, "last_activity_date": 1559111194, "creation_date": 1452425325, "last_edit_date": 1559111194, "question_id": 34704843, "link": "https://stackoverflow.com/questions/34704843/on-purpose-int-overflow", "title": "On-purpose int overflow", "body": "<p>I'm using the hash function <code>murmur2</code> which returns me an <code>uint64</code>.</p>\n\n<p>I want then to store it in PostgreSQL, which only support <code>BIGINT</code> (signed 64 bits).</p>\n\n<p>As I'm not interested in the number itself, but just the binary value (as I use it as an id for detecting uniqueness (my set of values being of ~1000 values, a 64bit hash is enough for me) I would like to convert it into <code>int64</code> by \"just\" changing the type.</p>\n\n<p>How does one do that in a way that pleases the compiler?</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 1414, "user_id": 822779, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/aJm0V.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/822779/sam"}, "edited": false, "score": 0, "creation_date": 1452414299, "post_id": 34703243, "comment_id": 57152746, "body": "A very nice solution. Thank you! I was unaware you could actually register your own functions like that."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 12, "last_activity_date": 1452412617, "last_edit_date": 1452412617, "creation_date": 1452412030, "answer_id": 34703243, "question_id": 34703133, "link": "https://stackoverflow.com/questions/34703133/field-detection-in-go-html-template/34703243#34703243", "title": "Field detection in Go HTML template", "body": "<p>There's not a built-in way to check for the presence of a field, but it is possible to write a template function to do the check:</p>\n\n<pre><code>func hasField(v interface{}, name string) bool {\n  rv := reflect.ValueOf(v)\n  if rv.Kind() == reflect.Ptr {\n    rv = rv.Elem()\n  }\n  if rv.Kind() != reflect.Struct {\n    return false\n  }\n  return rv.FieldByName(name).IsValid()\n}\n</code></pre>\n\n<p>Use the function in a template like this:</p>\n\n<pre><code>{{if hasField . \"FieldA\"}}&lt;a&gt;{{.FieldA}}&lt;/a&gt;{{end}}\n</code></pre>\n\n<p>Create the template with <code>hasField</code> in the func map:</p>\n\n<pre><code> t := template.New(\"\").Funcs(template.FuncMap{\"hasField\": hasField}).Parse(d)\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/N3dSa5SORn\" rel=\"noreferrer\">playground example</a></kbd></p>\n"}], "owner": {"reputation": 1414, "user_id": 822779, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/aJm0V.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/822779/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1732, "favorite_count": 1, "accepted_answer_id": 34703243, "answer_count": 1, "score": 3, "last_activity_date": 1569664342, "creation_date": 1452410971, "question_id": 34703133, "link": "https://stackoverflow.com/questions/34703133/field-detection-in-go-html-template", "title": "Field detection in Go HTML template", "body": "<p>Is it possible to check if a struct field exists from within a Go HTML template?</p>\n\n<p>For example, given the following template:  </p>\n\n<pre><code>{{if .FieldA}}\n    &lt;a&gt;{{.FieldA}}&lt;/a&gt;\n{{end}\n</code></pre>\n\n<p>and structs defined as:</p>\n\n<pre><code>type MyStruct struct{  \n    var FieldA string\n    var FieldB string\n}\n// In this struct FieldA is unavailable\ntype MyStruct2 struct{  \n    var FieldB string\n}\n</code></pre>\n\n<p>Passing <code>MyStruct</code> into the template will work fine. However, passing <code>MyStruct2</code> into the template will result in error. While the <code>if</code> statement can check for nil values, it throws an error (killing the template executor) when it encounters a field which doesn't exist in the current struct.  </p>\n\n<p>Sometimes a particular field is only going to be available in certain structs, so is there a way to check if the field exists prior to attempting to access it?</p>\n\n<p>I've had no luck with the <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow\">official documentation</a> and have come to the conclusion that perhaps there is no elegant solution.</p>\n"}, {"tags": ["go", "types", "slice"], "answers": [{"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 3, "last_activity_date": 1452391664, "creation_date": 1452391664, "answer_id": 34701240, "question_id": 34701187, "link": "https://stackoverflow.com/questions/34701187/go-byte-to-little-big-endian-signed-integer-or-float/34701240#34701240", "title": "Go []byte to Little/Big-Endian Signed Integer or Float?", "body": "<p>The <code>ByteOrder</code> type provides a low-level API for decoding binary values. To read float64 or other types, you can use <code>binary.Read</code>. There's an <a href=\"http://play.golang.org/p/lJ_NTZC4h2\" rel=\"nofollow\">example</a> on the <a href=\"https://godoc.org/encoding/binary#Read\" rel=\"nofollow\">godoc page for the binary package</a>, which I've copied here:</p>\n\n<pre><code>var pi float64\nb := []byte{0x18, 0x2d, 0x44, 0x54, 0xfb, 0x21, 0x09, 0x40}\nbuf := bytes.NewReader(b)\nerr := binary.Read(buf, binary.LittleEndian, &amp;pi)\nif err != nil {\n    fmt.Println(\"binary.Read failed:\", err)\n}\nfmt.Print(pi)\n</code></pre>\n\n<p>There's no functions for decoding float16, because that's not a type in Go.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1480515531, "last_edit_date": 1480515531, "creation_date": 1452393184, "answer_id": 34701402, "question_id": 34701187, "link": "https://stackoverflow.com/questions/34701187/go-byte-to-little-big-endian-signed-integer-or-float/34701402#34701402", "title": "Go []byte to Little/Big-Endian Signed Integer or Float?", "body": "<p>Converting numeric types into a series of bytes (<code>[]byte</code>) and vice versa is about the <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"noreferrer\">endianness</a>. How you interpret the result is entirely up to you.</p>\n\n<p>All you need is to assemble a 16-bit, 32-bit or 64-bit value, once it's done, you can interpret the result as you want.</p>\n\n<p>For example if you already have a <code>uint16</code> value, to use it as a signed value, all you need is a type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">conversion</a> because the memory layout of an <code>uint16</code> and <code>int16</code> is the same (converting from <code>uint16</code> to <code>int16</code> doesn't change the memory representation just the type):</p>\n\n<pre><code>a := binary.LittleEndian.Uint16(sampleA)\n// If you need int16:\na2 := int16(a)\n</code></pre>\n\n<p>Similarly:</p>\n\n<pre><code>a := binary.LittleEndian.Uint64(sampleA)\n// If you need int64:\na2 := int64(a)\n</code></pre>\n\n<p>The situation is a little more complicated with uint -> float conversion as using a simple type conversion would try to convert the numeric value and not just change the type (and thus would change the memory representation).</p>\n\n<p>For converting unsigned integers to float types, you can use functions of the <a href=\"https://golang.org/pkg/math/\" rel=\"noreferrer\"><code>math</code></a> package, namely <a href=\"https://golang.org/pkg/math/#Float32frombits\" rel=\"noreferrer\"><code>math.Float32frombits()</code></a> and <a href=\"https://golang.org/pkg/math/#Float64frombits\" rel=\"noreferrer\"><code>math.Float64frombits()</code></a>, and for the reverse direction (converting a float value to an unsigned integer) having the same memory layout: <a href=\"https://golang.org/pkg/math/#Float32bits\" rel=\"noreferrer\"><code>math.Float32bits()</code></a> and <a href=\"https://golang.org/pkg/math/#Float64bits\" rel=\"noreferrer\"><code>math.Float64bits()</code></a>.</p>\n\n<p>For example:</p>\n\n<pre><code>a := binary.LittleEndian.Uint64(sampleA)\n// If you need a float64:\na2 := math.Float64frombits(a)\n</code></pre>\n\n<p>If you would look into the implementation of these functions from the <code>math</code> package, you can see that the memory value/layout is not manipulated, it is just \"viewed\" as a different type, by using the <a href=\"https://golang.org/pkg/unsafe/\" rel=\"noreferrer\"><code>unsafe</code></a> package. For example:</p>\n\n<pre><code>func Float32frombits(b uint32) float32 { return *(*float32)(unsafe.Pointer(&amp;b)) }\n</code></pre>\n\n<p>As mentioned by Paul, the <code>binary</code> package provides <a href=\"https://golang.org/pkg/encoding/binary/#Read\" rel=\"noreferrer\"><code>Read()</code></a> and <a href=\"https://golang.org/pkg/encoding/binary/#Write\" rel=\"noreferrer\"><code>Write()</code></a> functions to do these conversions under the hood so you don't need to.</p>\n\n<p>Showcasing using the same \"pi\" example (from the doc of <code>binary.Read()</code>):</p>\n\n<pre><code>b := []byte{0x18, 0x2d, 0x44, 0x54, 0xfb, 0x21, 0x09, 0x40}\n\n// USING binary.Read()\nvar pi float64\nbuf := bytes.NewReader(b)\nerr := binary.Read(buf, binary.LittleEndian, &amp;pi)\nif err != nil {\n    fmt.Println(\"binary.Read failed:\", err)\n}\nfmt.Println(pi)\n\n// Using LittleEndian.Uint64() and math.Float64frombits()\na := binary.LittleEndian.Uint64(b)\na2 := math.Float64frombits(a)\nfmt.Println(a2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/IoWaE2tlZ6\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>3.141592653589793\n3.141592653589793\n</code></pre>\n"}], "owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7896, "favorite_count": 2, "accepted_answer_id": 34701402, "answer_count": 2, "score": 7, "last_activity_date": 1600843595, "creation_date": 1452391203, "last_edit_date": 1600843595, "question_id": 34701187, "link": "https://stackoverflow.com/questions/34701187/go-byte-to-little-big-endian-signed-integer-or-float", "title": "Go []byte to Little/Big-Endian Signed Integer or Float?", "body": "<p>I am able to convert <code>[]byte</code> into unsigned integers:</p>\n<pre><code>a := binary.LittleEndian.Uint16(sampleA)\nb := binary.BigEndian.Uint32(sampleB)\n</code></pre>\n<p>This leverages the BigEndian and LittleEndian types within the Go package  <a href=\"https://golang.org/src/encoding/binary/binary.go\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/binary/binary.go</a>.</p>\n<p>This provides <code>Uint16()</code> however there are no equivalent <code>Int16()</code> or <code>Float32()</code>.</p>\n<p>Any thoughts on why not? Also, how ought this be done?</p>\n"}, {"tags": ["go", "many-to-many", "go-gorm"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1452420984, "post_id": 34700479, "comment_id": 57154290, "body": "Write what you want to do, it is desirable so as to obtain a particular(concrete) result."}], "answers": [{"comments": [{"owner": {"reputation": 813, "user_id": 1333945, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5ba8a397763592097387117373dbb13a?s=128&d=identicon&r=PG", "display_name": "Nathan Ringo", "link": "https://stackoverflow.com/users/1333945/nathan-ringo"}, "edited": false, "score": 0, "creation_date": 1452455907, "post_id": 34709347, "comment_id": 57166358, "body": "Okay, thanks. The README.md (the only documentation I could find?) directly contradicts this, but this works and that doesn&#39;t."}], "tags": [], "owner": {"reputation": 36, "user_id": 5770592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/353dede534c99f20a869153dbb0ebb3d?s=128&d=identicon&r=PG&f=1", "display_name": "G&#252;nther Wutz", "link": "https://stackoverflow.com/users/5770592/g%c3%bcnther-wutz"}, "is_accepted": true, "score": 0, "last_activity_date": 1452451296, "creation_date": 1452451296, "answer_id": 34709347, "question_id": 34700479, "link": "https://stackoverflow.com/questions/34700479/many2many-in-gorm-really/34709347#34709347", "title": "many2many in Gorm, really", "body": "<p>I think you have to drop the <code>Related</code>-part. <code>CreateTable</code> doesnt need it as far as i can see.</p>\n\n<pre><code>if err := db.CreateTable(&amp;Machine{}).Error; err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Works for me</p>\n"}], "owner": {"reputation": 813, "user_id": 1333945, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5ba8a397763592097387117373dbb13a?s=128&d=identicon&r=PG", "display_name": "Nathan Ringo", "link": "https://stackoverflow.com/users/1333945/nathan-ringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 0, "accepted_answer_id": 34709347, "answer_count": 1, "score": 0, "last_activity_date": 1452451296, "creation_date": 1452384508, "question_id": 34700479, "link": "https://stackoverflow.com/questions/34700479/many2many-in-gorm-really", "title": "many2many in Gorm, really", "body": "<p>I'm trying to use the many-to-many relationship in gorm. However, the example is a partial snippet, and my attempt at creating a similar example snippet is failing.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\ntype Part struct {\n    gorm.Model\n\n    Name string\n}\n\ntype Machine struct {\n    gorm.Model\n\n    Name     string\n    Subtasks []Part `gorm:\"many2many:parts;\"`\n}\n\nfunc main() {\n    // Connect to the database\n    db, err := gorm.Open(\"sqlite3\", \"example.db\")\n    if err != nil {\n        panic(err)\n    }\n    defer db.Close()\n    db.LogMode(true)\n\n    // Set up associations\n    if err := db.CreateTable(&amp;Part{}).Error; err != nil {\n        panic(err)\n    }\n    if err := db.CreateTable(&amp;Machine{}).Related(&amp;[]Part{}).Error; err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>This panics on the last CreateTable call: <code>panic: invalid association []</code></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 39201, "user_id": 274, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a4040b3cd8ee723e93f1c95ddeb0b5bc?s=128&d=identicon&r=PG", "display_name": "Xetius", "link": "https://stackoverflow.com/users/274/xetius"}, "edited": false, "score": 0, "creation_date": 1452382622, "post_id": 34700175, "comment_id": 57146541, "body": "Was the dash char.  I thought I had typed it, but it appears not."}, {"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 39201, "user_id": 274, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a4040b3cd8ee723e93f1c95ddeb0b5bc?s=128&d=identicon&r=PG", "display_name": "Xetius", "link": "https://stackoverflow.com/users/274/xetius"}, "edited": false, "score": 1, "creation_date": 1452383912, "post_id": 34700175, "comment_id": 57146902, "body": "Glad that was it! It appears I had to use explicit int64 because I was using golang playground which uses 32bit pointers and ints"}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 1, "last_activity_date": 1452382128, "creation_date": 1452382128, "answer_id": 34700175, "question_id": 34700039, "link": "https://stackoverflow.com/questions/34700039/golang-converting-math-minint64-string-to-int-fails/34700175#34700175", "title": "golang Converting math.MinInt64 string to int fails", "body": "<p><a href=\"https://play.golang.org/p/FtytYJkHSc\" rel=\"nofollow\">https://play.golang.org/p/FtytYJkHSc</a></p>\n\n<p>Switching to strconv.ParseInt and explicitly using int64 as the type seemed to help. I also had an issue with the dash character in your MinInt64 string, that might just be on my end, but worth checking and making sure it is the basic ASCII character not some kind of Unicode dash.</p>\n"}], "owner": {"reputation": 39201, "user_id": 274, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a4040b3cd8ee723e93f1c95ddeb0b5bc?s=128&d=identicon&r=PG", "display_name": "Xetius", "link": "https://stackoverflow.com/users/274/xetius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 34700175, "answer_count": 1, "score": 0, "last_activity_date": 1452382128, "creation_date": 1452381221, "question_id": 34700039, "link": "https://stackoverflow.com/questions/34700039/golang-converting-math-minint64-string-to-int-fails", "title": "golang Converting math.MinInt64 string to int fails", "body": "<p>given the following function:</p>\n\n<pre><code>func convertValue(contents string) (int, error) {\n    return strconv.Atoi(contents)\n}\n</code></pre>\n\n<p>when I run the following test</p>\n\n<pre><code>var convertValues = []struct {\n    contents string\n    value int\n}{\n    {\"9223372036854775807\", math.MaxInt64},\n    {\"\u22129223372036854775808\", math.MinInt64},\n}\n\nfunc TestConvertValue(t *testing.T) {\n    for _, values := range convertValues {\n        value, err := convertValue(values.contents)\n        if err != nil {\n            t.Error(\"Expecting\", values.value, \"but got error\", err.Error())\n        }\n\n        if value != values.value {\n            t.Error(\"Expecting \", values.value, \", but got \", value)\n        }\n    }\n}\n</code></pre>\n\n<p>it works for MaxInt64, but not for MinInt64.  I'm running this on a MacBookPro, so it's running in 64bit.  I have double checked this with the following</p>\n\n<pre><code>func TestIntSize(t *testing.T) {\n    const PtrSize = 32 &lt;&lt; uintptr(^uintptr(0)&gt;&gt;63)\n    fmt.Println(runtime.GOOS, runtime.GOARCH)\n    fmt.Println(strconv.IntSize, PtrSize)\n}\n</code></pre>\n\n<p>and it returned</p>\n\n<pre><code>darwin amd64\n64 64\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["go", "micro-optimization"], "comments": [{"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 3, "creation_date": 1452380615, "post_id": 34699785, "comment_id": 57145989, "body": "methods receivers: pointers vs values: <a href=\"https://golang.org/doc/faq#methods_on_values_or_pointers\" rel=\"nofollow noreferrer\">golang.org/doc/faq#methods_on_values_or_pointers</a>"}, {"owner": {"reputation": 133, "user_id": 1148756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678ccf1e0b82dacea88e0384de595330?s=128&d=identicon&r=PG", "display_name": "Den&#237;", "link": "https://stackoverflow.com/users/1148756/den%c3%ad"}, "reply_to_user": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1490828849, "post_id": 34699785, "comment_id": 73292683, "body": "@EzequielMoreno That link doesn&#39;t clarify any optimizations I was asking about."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 1148756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678ccf1e0b82dacea88e0384de595330?s=128&d=identicon&r=PG", "display_name": "Den&#237;", "link": "https://stackoverflow.com/users/1148756/den%c3%ad"}, "edited": false, "score": 0, "creation_date": 1452393936, "post_id": 34699849, "comment_id": 57149039, "body": "Thanks for the answer and code. Interesting, <code>% go version go version go1.5.2 darwin&#47;amd64 % go test -bench . -benchmem              testing: warning: no tests to run PASS BenchmarkValue-8  \t200000000\t         8.53 ns&#47;op\t       0 B&#47;op\t       0 allocs&#47;op BenchmarkPointer-8\t2000000000\t         0.30 ns&#47;op\t       0 B&#47;op\t       0 allocs&#47;op ok  \tgithub.com&#47;test&#47;test\t3.246s</code> Sorry for such formatting."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1452404692, "post_id": 34699849, "comment_id": 57150964, "body": "Mine was with go 1.4"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1452380249, "last_edit_date": 1452380249, "creation_date": 1452379853, "answer_id": 34699849, "question_id": 34699785, "link": "https://stackoverflow.com/questions/34699785/pointer-vs-value-arguments-and-receivers-trade-offs/34699849#34699849", "title": "Pointer vs Value arguments and receivers trade-offs", "body": "<p>There's no optimization for this, and everything will get copied around. It comes down to the amount of distinct fields being copied (i.e. if you have a member that is a struct, the number of fields in it matter as well of course). </p>\n\n<p>So if you have very complex structs, and performance is so critical that this might become a bottleneck, then you should use pointers even for immutable stuff. </p>\n\n<p>I've written a little benchmark that calls a method that does nothing on a struct with 15 fields. One method is a pointer and the other is a value method. the result:</p>\n\n<pre><code>BenchmarkValue  100000000           12.1 ns/op\nBenchmarkPointer    2000000000           0.42 ns/op\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 1148756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678ccf1e0b82dacea88e0384de595330?s=128&d=identicon&r=PG", "display_name": "Den&#237;", "link": "https://stackoverflow.com/users/1148756/den%c3%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 34699849, "answer_count": 1, "score": 0, "last_activity_date": 1516500089, "creation_date": 1452379331, "last_edit_date": 1516500089, "question_id": 34699785, "link": "https://stackoverflow.com/questions/34699785/pointer-vs-value-arguments-and-receivers-trade-offs", "title": "Pointer vs Value arguments and receivers trade-offs", "body": "<p>I've come from C++ world with such things like the move semantic and RVO.\nSince that, I wonder are there any trade-offs when you pass arguments by value?</p>\n\n<p>In my case, I have pretty big structs that I need to pass to a bunch of functions. As I have understood, every time I pass a value to a function, a copy will be created. Would it be better to pass pointers instead of values?</p>\n\n<p>I see the only trade-offs that the original object could be changed accidentally or ignorantly, and it is unclear for a caller that a passed argument is not supposed to be modified.</p>\n\n<p>Is there an optimization if a passed value has not been modified?</p>\n"}, {"tags": ["logging", "go", "runtime-error"], "answers": [{"tags": [], "owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "is_accepted": false, "score": 2, "last_activity_date": 1452555089, "last_edit_date": 1452555089, "creation_date": 1452380184, "answer_id": 34699907, "question_id": 34699703, "link": "https://stackoverflow.com/questions/34699703/go-new-line-in-file-error-logging/34699907#34699907", "title": "Go: new line in file error logging", "body": "<p>It was a case of using Print with carriage return and line feed before the Fatal call:</p>\n\n<pre><code>log.Print(\"\\r\\n\")\n//or log.Print(err.Error() + \"\\r\\n\")\n</code></pre>\n"}], "owner": {"reputation": 639, "user_id": 1363484, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/f92K8.jpg?s=128&g=1", "display_name": "James Milner", "link": "https://stackoverflow.com/users/1363484/james-milner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2800, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452555089, "creation_date": 1452378673, "last_edit_date": 1452379125, "question_id": 34699703, "link": "https://stackoverflow.com/questions/34699703/go-new-line-in-file-error-logging", "title": "Go: new line in file error logging", "body": "<p>I am relatively new to go and looking to log out errors to a text file. At the moment I use:</p>\n\n<pre><code>// Logging\nf, err := os.OpenFile(\"pgdump_errorlog.txt\", os.O_RDWR | os.O_CREATE | os.O_APPEND, 0666)\nif err != nil {\n    log.Fatalf(\"error opening file: %v\", err)\n}\ndefer f.Close()\nlog.SetOutput(f)\n//... (later on)\nif err != nil {\n  log.Fatal(err)\n}\n</code></pre>\n\n<p>Which works OK, minus the fact that the errors do not produce a new line and just append to the end of the first line. Is there a way to make the error output create a new line before appending? I've tried:</p>\n\n<pre><code>if err != nil {\n     log.Fatalf(\"\\n Error: %v\", err)\n}\n</code></pre>\n\n<p>But this didn't log at all. Assuming there needs to be a \"\\n\" somewhere but I am struggling to figure it out. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["json", "go", "decoder"], "answers": [{"comments": [{"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "edited": false, "score": 0, "creation_date": 1452363380, "post_id": 34696916, "comment_id": 57140340, "body": "I have implemented your suggested changes, but I still have empty structs: {[{ } { }]}"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "edited": false, "score": 0, "creation_date": 1452363759, "post_id": 34696916, "comment_id": 57140511, "body": "@BrianVanover, your json is an object that contains a &quot;response&quot; field, not the SynonymResponse itself."}, {"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452364496, "post_id": 34696916, "comment_id": 57140788, "body": "@JimB Thanks for the hint! I had to create one more layer of structs. I will add it in my question for future reference."}], "tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": true, "score": 6, "last_activity_date": 1452362114, "creation_date": 1452362114, "answer_id": 34696916, "question_id": 34696852, "link": "https://stackoverflow.com/questions/34696852/go-json-decoder-not-initializing-my-struct/34696916#34696916", "title": "Go - JSON Decoder not initializing my struct", "body": "<p>In order for your JSON to be picked up by the decoder, the fields in your struct must be exported.</p>\n\n<p>This means you need you capitalize the field names. If you have custom naming on your fields -> json conversion, you can add json tags to your structs. </p>\n\n<p>This will fix your issue:</p>\n\n<pre><code>type SynonymResponse struct {\n    Lists []SynonymList `json:\"response\"`\n}\n\ntype SynonymList struct {\n    Category string `json:\"category\"`\n    Synonyms string `json:\"synonyms\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 34696916, "answer_count": 1, "score": 1, "last_activity_date": 1452365921, "creation_date": 1452361719, "last_edit_date": 1452365921, "question_id": 34696852, "link": "https://stackoverflow.com/questions/34696852/go-json-decoder-not-initializing-my-struct", "title": "Go - JSON Decoder not initializing my struct", "body": "<p>I am trying to decode some JSON retrieved via <code>http.Get</code>. However, when I check the structs I initialize with <code>fmt.Println</code>, they are always empty.</p>\n\n<p>I suspect it is because my struct's structure does not agree with the returned JSON, but I am not sure how to fix it. In general, I am not exactly quite sure how the <a href=\"https://golang.org/pkg/encoding/json/#Decoder\" rel=\"nofollow\">decoder</a> works.</p>\n\n<p>This is the JSON:</p>\n\n<pre><code>{\n  \"response\":[\n    {\n      \"list\": {\n        \"category\":\"(noun)\",\n        \"synonyms\":\"histrion|player|thespian|role player|performer|performing artist\"\n      }\n    },\n    {\n      \"list\": {\n        \"category\":\"(noun)\",\n        \"synonyms\":\"doer|worker|person|individual|someone|somebody|mortal|soul\"\n      }\n    }\n  ]\n}\n</code></pre>\n\n<p>Here is what i have tried so far:</p>\n\n<pre><code>type SynonymResponse struct {\n    lists []SynonymList\n}\n\ntype SynonymList struct {\n    category string\n    synonyms string\n}\n\nvar synonyms SynonymResponse;\ndec := json.NewDecoder(response.Body)\nerr := dec.Decode(&amp;synonyms)\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Println(synonyms)\n</code></pre>\n\n<p><strong>EDIT: Per @Leo's answer and @JimB's hint, there are two issues with my attempt. Below is the proper set of structs, though as Leo pointed out, this will be empty:</strong> </p>\n\n<pre><code>type SynonymResponses struct {\n    resp []SynonymResponse\n}\n\ntype SynonymResponse struct {\n    listo SynonymList\n}\n\ntype SynonymList struct {\n    cat string\n    syns string\n} \n</code></pre>\n"}, {"tags": ["struct", "go", "compilation"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 3, "creation_date": 1452357827, "post_id": 34695689, "comment_id": 57138241, "body": "If you were a Go linker, how would you decide were to find Car definition in your \\src structure? Be more friendly to machine and structure your packages as suggested in manuals and import explicitly what you need"}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 1676947, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c526434c61ac753fba74368ec34a119e?s=128&d=identicon&r=PG", "display_name": "FR STAR", "link": "https://stackoverflow.com/users/1676947/fr-star"}, "edited": false, "score": 0, "creation_date": 1452362107, "post_id": 34696352, "comment_id": 57139883, "body": "Wow, you really cracked the code, however I would like to clarify few things,  1). go run *.go (this line of code didn&#39;t work for me) 2) and 3) did worked, after this line of codes don&#39;t I need to execute the following <b>go run main.go</b>? as @arainone explained below."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 686, "user_id": 1676947, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c526434c61ac753fba74368ec34a119e?s=128&d=identicon&r=PG", "display_name": "FR STAR", "link": "https://stackoverflow.com/users/1676947/fr-star"}, "edited": false, "score": 0, "creation_date": 1452362527, "post_id": 34696352, "comment_id": 57140033, "body": "@FRSTAR: Wildcard globs, for example, <code>*.go</code>,  are a Linux shortcut. On Windows, list each file, for example, <code>go run main.go car.go</code>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 686, "user_id": 1676947, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c526434c61ac753fba74368ec34a119e?s=128&d=identicon&r=PG", "display_name": "FR STAR", "link": "https://stackoverflow.com/users/1676947/fr-star"}, "edited": false, "score": 1, "creation_date": 1452362879, "post_id": 34696352, "comment_id": 57140156, "body": "@FRSTAR: <code>go run</code> compiles and runs the main package comprising the named Go source files. <code>go build</code> compiles the packages named by the import paths, along with their dependencies, but it does not install the results. <code>go install</code> compiles and installs the packages named by the import paths, along with their dependencies. See <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">Command go</a>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1452362185, "last_edit_date": 1452362185, "creation_date": 1452359013, "answer_id": 34696352, "question_id": 34695689, "link": "https://stackoverflow.com/questions/34695689/unable-to-include-multi-file-in-the-golang/34696352#34696352", "title": "Unable to include multi file in the golang", "body": "<p>Set up your workspace for programs and libraries by following the instructions: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How to Write Go Code</a>.</p>\n\n<p>For your example, a two file <code>main</code> package,</p>\n\n<pre><code>src/car\n\u251c\u2500\u2500 car.go\n\u2514\u2500\u2500 main.go\n\n$ cd src/car\n$ go run main.go car.go\n{4 6}\n$ go build car &amp;&amp; ./car\n{4 6}\n$ go install car &amp;&amp; car\n{4 6}\n$ \n</code></pre>\n\n<p><code>main.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    c := Car{4, 6}\n    fmt.Println(c)\n}\n</code></pre>\n\n<p><code>car.go</code>:</p>\n\n<pre><code>package main\n\ntype Car struct {\n    numberOfDoors int\n    cylinders     int\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 686, "user_id": 1676947, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c526434c61ac753fba74368ec34a119e?s=128&d=identicon&r=PG", "display_name": "FR STAR", "link": "https://stackoverflow.com/users/1676947/fr-star"}, "edited": false, "score": 0, "creation_date": 1452361685, "post_id": 34696718, "comment_id": 57139723, "body": "I tried your code and I&#39;m getting following error, <b>main.go:4:5: import &quot;car&quot; is a program, not an importable package</b>  @peterSO code did worked, but I&#39;m curious with your answer, so could u pls let me know whats the issue?"}, {"owner": {"reputation": 1781, "user_id": 4515566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bOOZ7.jpg?s=128&g=1", "display_name": "arainone", "link": "https://stackoverflow.com/users/4515566/arainone"}, "reply_to_user": {"reputation": 686, "user_id": 1676947, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c526434c61ac753fba74368ec34a119e?s=128&d=identicon&r=PG", "display_name": "FR STAR", "link": "https://stackoverflow.com/users/1676947/fr-star"}, "edited": false, "score": 0, "creation_date": 1452372556, "post_id": 34696718, "comment_id": 57143570, "body": "@FRSTAR i don&#39;t have this error, the code is working for me. Are you sure  you replaced <code>package main with </code>package car` in <code>car.go</code> file? I forgot to indicate this point in the explanations of my code, i&#39;m adding it now"}], "tags": [], "owner": {"reputation": 1781, "user_id": 4515566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bOOZ7.jpg?s=128&g=1", "display_name": "arainone", "link": "https://stackoverflow.com/users/4515566/arainone"}, "is_accepted": false, "score": 1, "last_activity_date": 1452372756, "last_edit_date": 1452372756, "creation_date": 1452361033, "answer_id": 34696718, "question_id": 34695689, "link": "https://stackoverflow.com/questions/34695689/unable-to-include-multi-file-in-the-golang/34696718#34696718", "title": "Unable to include multi file in the golang", "body": "<p>You should not have 2 files, that are declared in the same package but are not residing in the same directory. One solution could be to have this directory structure instead:</p>\n\n<pre><code>src\\\n  car\\\n    car.go\n  main.go\n</code></pre>\n\n<p><strong>car.go</strong></p>\n\n<pre><code>package car\n\ntype Car struct {\n    NumberOfDoors int\n    Cylinders     int\n}\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"car\"\n    \"fmt\"\n)\n\nfunc main() {\n    c := car.Car{4, 6}\n    fmt.Println(c)\n}\n</code></pre>\n\n<p>Of course, <code>Car</code> structure not being in <code>main</code> package, I had to:</p>\n\n<ul>\n<li>change to uppercase the first letter of <code>NumberOfDoors</code> and <code>Cylinders</code> fields from <code>car.Car</code> struct, so that they can be accessed from <code>main</code> package</li>\n<li>replace the call to <code>Car{4,6}</code> with <code>car.Car{4,6}</code></li>\n<li>code in <code>car.go</code> is not part of package <code>main</code> anymore, you can view it as a <code>car</code> library now. That's why the <code>Car</code> struct is now declared being part of <code>package car</code></li>\n</ul>\n\n<p>Like that, you can build and run in one step with:</p>\n\n<pre><code>go run main.go\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 1676947, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c526434c61ac753fba74368ec34a119e?s=128&d=identicon&r=PG", "display_name": "FR STAR", "link": "https://stackoverflow.com/users/1676947/fr-star"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1738, "favorite_count": 1, "accepted_answer_id": 34696352, "answer_count": 2, "score": -2, "last_activity_date": 1452372756, "creation_date": 1452355433, "last_edit_date": 1495540031, "question_id": 34695689, "link": "https://stackoverflow.com/questions/34695689/unable-to-include-multi-file-in-the-golang", "title": "Unable to include multi file in the golang", "body": "<p>I know this <a href=\"https://stackoverflow.com/questions/15049903/how-to-use-custom-packages-in-golang\">question</a> has been asked before and I've tried all possible answers, but nothing still didn't help me.</p>\n\n<p>However to refresh the question again and to elaborate my problem. I'm actually trying to include a simple file to the main.go file. My folder structure and the rest of the information as follows:</p>\n\n<pre><code>\\src\\\n   Multi-file\\\n     lib\\Car.go\n   main.go\n</code></pre>\n\n<p><strong>Car.go</strong></p>\n\n<pre><code> package main\n\n    type Car struct {\n        numberOfDoors int\n        cylinders int\n    }\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main \n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    c := Car{4,6}\n    fmt.Println(c)\n}\n</code></pre>\n\n<p>When I complie the main.go I'm getting the following error</p>\n\n<pre><code># command-line-arguments\n.\\main.go:8: undefined: Car\n</code></pre>\n\n<p>Here is my <strong>go env</strong> details:</p>\n\n<pre><code>set GOARCH=amd64\nset GOBIN=\nset GOEXE=.exe\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=C:\\xampp\\htdocs\\golang\nset GORACE=\nset GOROOT=C:\\Go\nset GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_amd64\nset GO15VENDOREXPERIMENT=\nset CC=gcc\nset GOGCCFLAGS=-m64 -mthreads -fmessage-length=0\nset CXX=g++\nset CGO_ENABLED=1\n</code></pre>\n\n<p>FYI: I tried including as package also that didn't even help me out.</p>\n\n<p>Any help would be extremely appreciated. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 0, "creation_date": 1453054081, "post_id": 34695285, "comment_id": 57424251, "body": "I have the same - any progress? I have tried to set NTP to sync the server time."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5767105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a99725a55a5c8a7fef775e021724b?s=128&d=identicon&r=PG&f=1", "display_name": "Tri Luu", "link": "https://stackoverflow.com/users/5767105/tri-luu"}, "edited": false, "score": 0, "creation_date": 1453126681, "post_id": 34841956, "comment_id": 57453046, "body": "I tried to install ntp, start ntp service, but it still error: 2016/01/18 21:17:11 Post <a href=\"https://www.googleapis.com/datastore/v1beta2/datasets/xxx/lookup\" rel=\"nofollow noreferrer\">googleapis.com/datastore/v1beta2/datasets/xxx/lookup</a>: oauth2: cannot fetch token: 400 Bad Request Response: {   &quot;error&quot; : &quot;invalid_grant&quot; }"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 11, "user_id": 5767105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a99725a55a5c8a7fef775e021724b?s=128&d=identicon&r=PG&f=1", "display_name": "Tri Luu", "link": "https://stackoverflow.com/users/5767105/tri-luu"}, "edited": false, "score": 0, "creation_date": 1453127346, "post_id": 34841956, "comment_id": 57453455, "body": "Damn, I was hoping it was the solution. My go server is still working after I did just that. This means that the error probably comes back. I will let you know if I find something."}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 11, "user_id": 5767105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a99725a55a5c8a7fef775e021724b?s=128&d=identicon&r=PG&f=1", "display_name": "Tri Luu", "link": "https://stackoverflow.com/users/5767105/tri-luu"}, "edited": false, "score": 0, "creation_date": 1453127567, "post_id": 34841956, "comment_id": 57453605, "body": "The url I see in my error is different from yours. Have a look: <a href=\"http://stackoverflow.com/questions/34832424/suddenly-400-bad-request\" title=\"suddenly 400 bad request\">stackoverflow.com/questions/34832424/suddenly-400-bad-reques&zwnj;&#8203;t</a>"}], "tags": [], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1453055062, "creation_date": 1453055062, "answer_id": 34841956, "question_id": 34695285, "link": "https://stackoverflow.com/questions/34695285/error-400-oauth2-google-cloud-storage-go-lang/34841956#34841956", "title": "Error 400 oauth2 google cloud storage - go lang", "body": "<p>This appears to have worked for me.<br></p>\n\n<p>If you are on linux try the following:<br>\n1. apt-get update<br>\n2. apt-get install ntp<br>\n3. /etc/init.d/ntp restart<br></p>\n"}], "owner": {"reputation": 11, "user_id": 5767105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a99725a55a5c8a7fef775e021724b?s=128&d=identicon&r=PG&f=1", "display_name": "Tri Luu", "link": "https://stackoverflow.com/users/5767105/tri-luu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453055062, "creation_date": 1452352995, "question_id": 34695285, "link": "https://stackoverflow.com/questions/34695285/error-400-oauth2-google-cloud-storage-go-lang", "title": "Error 400 oauth2 google cloud storage - go lang", "body": "<pre><code>// datastore1\npackage main\n\nimport (\n  \"fmt\"\n  \"io/ioutil\"\n  \"log\"\n  \"time\"\n\n\"golang.org/x/net/context\"\n\"golang.org/x/oauth2/google\"\n\"google.golang.org/cloud\"\n\"google.golang.org/cloud/datastore\"\n)\n\nconst (\n// ScopeDatastore grants permissions to view and/or manage datastore    entities\ncopeDatastore = \"https://www.googleapis.com/auth/datastore\"\n\n// ScopeUserEmail grants permission to view the user's email address.\n// It is required to access the datastore.\nScopeUserEmail = \"https://www.googleapis.com/auth/userinfo.email\"\n)\n\ntype ehrEntity struct {\nemail       *datastore.Key\nfirstname   string\nlastname    string\naddress     string\nage         int8\ndateofbirth time.Time\nsex         bool\n}\n\n func getCtx() *datastore.Client {\n// Initialize an authorized transport with Google Developers Console\n// JSON key. Read the google package examples to learn more about\n// different authorization flows you can use.\n// http://godoc.org/golang.org/x/oauth2/google\njsonKey, err := ioutil.ReadFile(\"filename.json\")\nopts, err := google.JWTConfigFromJSON(\n    jsonKey,\n    datastore.ScopeDatastore,\n    datastore.ScopeUserEmail,\n)\nif err != nil {\n    log.Fatal(err)\n}\n\nctx := context.Background()\nclient, err := datastore.NewClient(ctx, \"xxxx\",     cloud.WithTokenSource(opts.TokenSource(ctx)))\nif err != nil {\n    log.Fatal(err)\n}\n// Use the context (see other examples)\nreturn client\n}\n\n func ExampleGet() {\nctx := context.Background()\nclient, err := datastore.NewClient(ctx, \"xxxx\")\nif err != nil {\n    log.Fatal(err)\n}\nkey := datastore.NewKey(ctx, \"User\", \"tluu@abc.com\", 0, nil)\nehr := ehrEntity{\n    nil,\n    \"tri\",\n    \"luu\",\n    \"addr1\",\n    20,\n    time.Date(2009, time.January, 10, 23, 0, 0, 0, time.UTC),\n    false}\nif err := client.Get(ctx, key, ehr); err != nil {\n    log.Fatal(err)\n }\n }\n\nfunc main() {\ngetCtx()\nfmt.Println(\"Pass authentication\")\nExampleGet()\n}\n</code></pre>\n\n<p>When I run go file, It return error follow:</p>\n\n<p>Pass authentication (Pass getCtx() function).</p>\n\n<p>Error in ExampleGet()\nMay be at </p>\n\n<pre><code>ctx := context.Background()\nclient, err := datastore.NewClient(ctx, \"xxxx\")\nif err != nil {\n    log.Fatal(err)\n  }\n</code></pre>\n\n<p>Error:\n2016/01/09 22:08:43 Post <a href=\"https://www.googleapis.com/datastore/v1beta2/datasets/xxxx/lookup\" rel=\"nofollow\">https://www.googleapis.com/datastore/v1beta2/datasets/xxxx/lookup</a>: oauth2: cannot fetch token: 400 Bad Request\nResponse: {\n  \"error\" : \"invalid_grant\"\n}</p>\n\n<p>How to resolve this error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1452348769, "post_id": 34694295, "comment_id": 57134914, "body": "Seems you should do check in Pre condition to stop recursive calls and return. Post condition would be evaluated after first return when recursive stack rewind."}, {"owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1452349757, "post_id": 34694295, "comment_id": 57135259, "body": "@Uvelichitel I think I tried that, and it did not work :("}], "answers": [{"tags": [], "owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "is_accepted": false, "score": 1, "last_activity_date": 1452358125, "last_edit_date": 1452358125, "creation_date": 1452352011, "answer_id": 34695083, "question_id": 34694295, "link": "https://stackoverflow.com/questions/34694295/stop-recursive-function-when-element-is-found/34695083#34695083", "title": "Stop recursive function when element is found", "body": "<p>You can create a <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures\" rel=\"nofollow\">closure</a> and \"close\" <code>found</code> node. Example below.</p>\n\n<blockquote>\n  <p>Modify forEachNode so that the pre and post functions return a boolean result indicating whether to continue the traversal.:</p>\n</blockquote>\n\n<pre><code>func forEachNode(n *html.Node, pre, post func(n *html.Node) bool) {\n    if pre != nil &amp;&amp; !pre(n) {\n        return\n    }\n\n    for c := n.FirstChild; c != nil; c = c.NextSibling {\n        forEachNode(c, pre, post)\n    }\n\n    if post != nil &amp;&amp; !post(n) {\n        return\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>Use it to write a function ElementByID with the following signature that finds the first HTML element with the specified id attribute. The function should stop the traversal as soon as a match is found.:</p>\n</blockquote>\n\n<pre><code>func ElementByID(doc *html.Node, id string) *html.Node {\n\n    var found *html.Node\n\n    pre := func(n *html.Node) bool {\n        for _, a := range n.Attr {\n            if a.Key == \"id\" &amp;&amp; a.Val == id {\n                found = n // memorize matching node\n                return false // stop traversing\n            }\n        }\n        return true\n    }\n\n    forEachNode(doc, pre, nil)\n    return found\n}\n</code></pre>\n"}], "owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452358125, "creation_date": 1452347592, "question_id": 34694295, "link": "https://stackoverflow.com/questions/34694295/stop-recursive-function-when-element-is-found", "title": "Stop recursive function when element is found", "body": "<p>I am trying to solve an exercise from The go programming language book:\nThe starting code can be found here: <a href=\"https://github.com/adonovan/gopl.io/blob/master/ch5/outline2/outline.go\" rel=\"nofollow\">exercise</a>.</p>\n\n<p>What I need to do:</p>\n\n<p>Modify forEachNode so that the pre and post functions return a boolean result indicating whether to continue the traversal. Use it to write a function ElementByID with the following signature that finds the first HTML element with the specified id attribute. The function should stop the traversal as soon as a match is found.</p>\n\n<p>Signature: <code>func ElementByID(doc *html.Node, id string) *html.Node</code></p>\n\n<p>What I did:</p>\n\n<pre><code>func ElementByID(doc *html.Node, id string) *html.Node {                                                         \n  if doc.Data == id {                                                                                            \n    fmt.Printf(\" %s: %s\\n\", \"found\", doc.Data)                                                                   \n    return doc                                                                                                   \n  }                                                                                                              \n  return nil                                                                                                     \n}\n\nfunc startElement(n *html.Node) bool {\n  if n.Type == html.ElementNode {\n    if ElementById(n, \"a\") != nil {\n      return true\n    }\n    fmt.Printf(\"%*s&lt;%s&gt;\\n\", depth*2, \"\", n.Data)\n    depth++\n  }\n  return false\n}\nfunc endElement(n *html.Node) bool {\n  if n.Type == html.ElementNode {\n    if ElementById(n, \"a\") != nil {\n      return true\n    }\n    depth--\n    fmt.Printf(\"%*s&lt;/%s&gt;\\n\", depth*2, \"\", n.Data)\n  }\n  return false\n}\n</code></pre>\n\n<p>Is the above right?, or I've missed something? How can I stop the traversal where element is found?</p>\n\n<p>The forEachNode is the same, only the pre and post signature was changed to return a bool.</p>\n"}, {"tags": ["go", "openssl"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1452356757, "post_id": 34693477, "comment_id": 57137859, "body": "What format is the key in after <b><i><code>privateKey := openssl.GenerateRSAKey(2048)</code></i></b>? It may be in PEM already. If not, then its ASN.1/DER. In this case, you can use the command line to convert it if that&#39;s an option to you."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "is_accepted": false, "score": 0, "last_activity_date": 1538993441, "last_edit_date": 1538993441, "creation_date": 1452432790, "answer_id": 34705979, "question_id": 34693477, "link": "https://stackoverflow.com/questions/34693477/writing-rsa-privatekey-pem-to-file-in-golang/34705979#34705979", "title": "Writing RSA PrivateKey PEM to file in golang", "body": "<p>Basically you can achieve this with x509.EncryptPEMBlock. </p>\n\n<p>If your key is surrounded by <code>-----BEGIN RSA PRIVATE KEY-----</code> and <code>-----END RSA PRIVATE KEY-----</code> post- and prefixes you might have to remove them before encryption.</p>\n"}], "owner": {"reputation": 5339, "user_id": 201130, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f196eedfa0d23f02e6d92159e84e63d?s=128&d=identicon&r=PG", "display_name": "JP.", "link": "https://stackoverflow.com/users/201130/jp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1654, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538993441, "creation_date": 1452342679, "question_id": 34693477, "link": "https://stackoverflow.com/questions/34693477/writing-rsa-privatekey-pem-to-file-in-golang", "title": "Writing RSA PrivateKey PEM to file in golang", "body": "<p>I'm using <a href=\"https://godoc.org/github.com/spacemonkeygo/openssl\" rel=\"nofollow\">spacemonkeygo's openssl library</a> to generate an RSA PrivateKey - the library also offers ways to load a private key from a PEM, but I can't figure out how to turn the private key into an encrypted PEM block - anyone got any ideas?</p>\n\n<pre><code>import \"github.com/spacemonkeygo/openssl\"\n\n// Generate a private key\nprivateKey, _ := openssl.GenerateRSAKey(2048)\n\npassword := \"an encryption password\"\n// Create an encrypted PEM block from the private key?\npem := ???\n\n// Load the PEM file\nloadedPrivateKey, _ := openssl.LoadPrivateKeyFromPEMWidthPassword(pem, password)\n\nprivateKey == loadedPrivateKey\n</code></pre>\n"}, {"tags": ["struct", "go", "overloading"], "comments": [{"owner": {"reputation": 5994, "user_id": 5710637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TAM5l.jpg?s=128&g=1", "display_name": "fafl", "link": "https://stackoverflow.com/users/5710637/fafl"}, "edited": false, "score": 3, "creation_date": 1452329082, "post_id": 34691442, "comment_id": 57129066, "body": "No overloading in Go, well explained here: <a href=\"http://stackoverflow.com/questions/6986944\">stackoverflow.com/questions/6986944</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1452331499, "post_id": 34691442, "comment_id": 57129686, "body": "No there is not. You need two functions, but then you don&#39;t need type checking. Stop thinking Java."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 2, "creation_date": 1452339746, "post_id": 34691442, "comment_id": 57132030, "body": "Well, <i>strictly</i> speaking, there isn&#39;t. To reduce redundant code however, you can accept an interface and do a <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow noreferrer\">type switch</a>."}], "owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "closed_date": 1452354005, "answer_count": 0, "score": 0, "last_activity_date": 1452328900, "creation_date": 1452328900, "question_id": 34691442, "link": "https://stackoverflow.com/questions/34691442/function-overloading-in-golang", "closed_reason": "Duplicate", "title": "Function Overloading in golang", "body": "<p>I am not sure if this is the right term for this scenario.</p>\n\n<p>I have a struct defined in a package, with a variable defined as type string, and I have a setter method to set the value of that variable. However, I cannot be sure of the type of value that could be passed to that method. It could be an int or a string. Is there a concept that is similar to java, where I can write the same function twice, but with different parameters, so that I don't have to do a type checking before populating the struct?</p>\n"}, {"tags": ["amazon-web-services", "go"], "answers": [{"comments": [{"owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "edited": false, "score": 0, "creation_date": 1452331191, "post_id": 34691520, "comment_id": 57129602, "body": "OMG... I&#39;m so dumb... Thanks!"}], "tags": [], "owner": {"reputation": 111, "user_id": 3615021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ed977aefbb2b5a0e17bc1f7f0bdc41?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Xu", "link": "https://stackoverflow.com/users/3615021/michael-xu"}, "is_accepted": true, "score": 1, "last_activity_date": 1452329529, "creation_date": 1452329529, "answer_id": 34691520, "question_id": 34691387, "link": "https://stackoverflow.com/questions/34691387/cannot-generate-amazon-product-api-signature-using-golang/34691520#34691520", "title": "Cannot generate Amazon product API signature using Golang", "body": "<p>Looks fine to me, try running:</p>\n\n<p><a href=\"https://play.golang.org/p/w0mQAYx2GQ\" rel=\"nofollow\">https://play.golang.org/p/w0mQAYx2GQ</a></p>\n\n<p>I added necessary imports and a main function</p>\n"}], "owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 34691520, "answer_count": 1, "score": 0, "last_activity_date": 1452329529, "creation_date": 1452328374, "last_edit_date": 1452328683, "question_id": 34691387, "link": "https://stackoverflow.com/questions/34691387/cannot-generate-amazon-product-api-signature-using-golang", "title": "Cannot generate Amazon product API signature using Golang", "body": "<p>Help.  I can't get the right signature using the test parameters provided by Amazon and Go.</p>\n\n<p>My signature hash function is as follows.  I use SHA-256 and base64 encoding as per Amazon documentation.</p>\n\n<pre><code>func HashSignature(str string, secret string) string {\n  mac := hmac.New(sha256.New, []byte(secret))\n  _, err := mac.Write([]byte(str))\n  if err != nil {   return \"\" }\n\n  hash := base64.StdEncoding.EncodeToString(mac.Sum(nil))\n  hash = url.QueryEscape(hash)\n  return hash\n}\n</code></pre>\n\n<p>My signature test function is as follows.  I use the canonical string below in Ruby code and it generates the correct expected signature.  So the problem seems to be with the output of my HashSignature() function, but I don't see what I'm doing wrong there.</p>\n\n<pre><code>func TestAmazonSignature(t *testing.T) {\n/* here is the canonical string from Amazon documentation which should yield the expected signature below\nGET\nwebservices.amazon.com\n/onca/xml\nAWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&amp;AssociateTag=mytag-20&amp;ItemId=0679722769&amp;Operation=ItemLookup&amp;ResponseGroup=Images%2CItemAttributes%2COffers%2CReviews&amp;Service=AWSECommerceService&amp;Timestamp=2014-08-18T12%3A00%3A00Z&amp;Version=2013-08-01\n*/\n  SECRET_KEY := \"1234567890\"\n  CANONICAL_STR := \"GET\\nwebservices.amazon.com\\n/onca/xml\\nAWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&amp;AssociateTag=mytag-20&amp;ItemId=0679722769&amp;Operation=ItemLookup&amp;ResponseGroup=Images%2CItemAttributes%2COffers%2CReviews&amp;Service=AWSECommerceService&amp;Timestamp=2014-08-18T12%3A00%3A00Z&amp;Version=2013-08-01\"\n\n  EXPECTED := \"j7bZM0LXZ9eXeZruTqWm2DIvDYVUU3wxPPpp%2BiXxzQc%3D\"\n\n  if RESULT := HashSignature(CANONICAL_STR, SECRET_KEY); RESULT != EXPECTED {\n    t.Errorf(\"\\nEXPECTED:\\n%v\\nRESULT:\\n%v\", EXPECTED, RESULT)\n  } else { fmt.Println(\"TestAmazonSignature: Signature: OK\") }\n}\n</code></pre>\n\n<p>Here's a playground <a href=\"https://play.golang.org/p/g70Xeuf2Og\" rel=\"nofollow\">link</a> with all this code.</p>\n"}, {"tags": ["go", "containers", "runc"], "answers": [{"comments": [{"owner": {"reputation": 981, "user_id": 2432158, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3ed649b0eb13125049451100ee5e9e9f?s=128&d=identicon&r=PG", "display_name": "Walid Hanafy", "link": "https://stackoverflow.com/users/2432158/walid-hanafy"}, "edited": false, "score": 0, "creation_date": 1452882121, "post_id": 34691416, "comment_id": 57376833, "body": "sudo make BUILDTAGS=&quot;&quot; GOPATH=$GOPATH  go build -tags &quot;&quot; -o runc . # github.com/opencontainers/runc ./spec.go:447: cannot use r.Memory.Limit (type *uint64) as type int64 in assignment ./spec.go:456: too many errors make: *** [all] Error 2"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1452328650, "creation_date": 1452328650, "answer_id": 34691416, "question_id": 34691076, "link": "https://stackoverflow.com/questions/34691076/error-building-runc-from-source/34691416#34691416", "title": "Error building runc from source", "body": "<p>That looks like <a href=\"https://github.com/opencontainers/runc/issues/226\" rel=\"nofollow\">issue 226</a>:</p>\n\n<blockquote>\n  <p>this is not an issue.<br>\n  You need <code>libseccomp-dev</code> libraries in order to build runc with <code>seccomp</code> support. You can still disable this through go build flags.</p>\n</blockquote>\n\n<p><a href=\"https://github.com/opencontainers/runc/pull/220/files\" rel=\"nofollow\">PR 220</a> mentions:</p>\n\n<blockquote>\n  <p>In order to enable <code>seccomp</code> support you will need to install libseccomp on your platform.<br>\n  If you do not with to build <code>runc</code> with seccomp support you can add <code>BUILDTAGS=\"\"</code> when running <code>make</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 981, "user_id": 2432158, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3ed649b0eb13125049451100ee5e9e9f?s=128&d=identicon&r=PG", "display_name": "Walid Hanafy", "link": "https://stackoverflow.com/users/2432158/walid-hanafy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1452328650, "creation_date": 1452325954, "question_id": 34691076, "link": "https://stackoverflow.com/questions/34691076/error-building-runc-from-source", "title": "Error building runc from source", "body": "<p>I have problem installing runc from source:</p>\n\n<pre><code>root@ubuntu:/usr/local/go/bin/src/github.com/opencontainers/runc# make\ngo build -tags \"seccomp\" -o runc .\n# github.com/seccomp/libseccomp-golang\nGodeps/_workspace/src/github.com/seccomp/libseccomp-golang/seccomp.go:25:22: fatal error: seccomp.h: No such file or directory\n // #include &lt;seccomp.h&gt;\n                      ^\ncompilation terminated.\nmake: *** [all] Error 2\n</code></pre>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1452331676, "post_id": 34691045, "comment_id": 57129733, "body": "Other languages treat any non-whitespace as comment and all keywords are made of spaces, tabs and newlines. &quot;Other languages&quot; is <i>never</i> a good argument, not for programming languages and not for natural languages."}], "answers": [{"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 17, "creation_date": 1452327900, "post_id": 34691123, "comment_id": 57128749, "body": "You can also use <code>`blah`</code> back ticks for a raw string."}], "tags": [], "owner": {"reputation": 6953, "user_id": 4541045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfffa01cff641ad93fa459b26d3cdb4?s=128&d=identicon&r=PG&f=1", "display_name": "ti7", "link": "https://stackoverflow.com/users/4541045/ti7"}, "is_accepted": true, "score": 82, "last_activity_date": 1452326745, "last_edit_date": 1452326745, "creation_date": 1452326351, "answer_id": 34691123, "question_id": 34691045, "link": "https://stackoverflow.com/questions/34691045/cannot-assign-string-with-single-quote-in-golang/34691123#34691123", "title": "Cannot assign string with single quote in golang", "body": "<p>In Go, <code>'\u2318'</code> represents a single character (called a Rune), whereas <code>\"\u2318\"</code> represents a string containing the character <code>\u2318</code>. </p>\n\n<p>This is true in many programming languages where the difference between strings and characters is notable, such as C++.</p>\n\n<p>Check out the \"Code points, characters, and runes\" section in the <a href=\"https://blog.golang.org/strings\" rel=\"noreferrer\">Go Blog on Strings</a></p>\n"}, {"tags": [], "owner": {"reputation": 154, "user_id": 4059152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1841dbbaa74807afd3616b29edce4c4a?s=128&d=identicon&r=PG", "display_name": "Jawadh Salih Rifath", "link": "https://stackoverflow.com/users/4059152/jawadh-salih-rifath"}, "is_accepted": false, "score": 3, "last_activity_date": 1540970571, "last_edit_date": 1540970571, "creation_date": 1540969062, "answer_id": 53077886, "question_id": 34691045, "link": "https://stackoverflow.com/questions/34691045/cannot-assign-string-with-single-quote-in-golang/53077886#53077886", "title": "Cannot assign string with single quote in golang", "body": "<p>Go is a statically typed language. Also <code>GO</code> is not a scripting language. Though we see <code>GO</code> is running like a scripting language, it is compiling the source we write and then execute the main function. So, we should treat <code>GO</code> as <code>C, JAVA, C++</code> where single quote <code>''</code> is used to declare characters (<code>rune, char</code>) unlike scripting languages like Python or JavaScript. </p>\n\n<p>I think as this is a new language, and current trend is lying with scripting languages,  this confusion has been occurred. </p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1617112430, "creation_date": 1617112430, "answer_id": 66872304, "question_id": 34691045, "link": "https://stackoverflow.com/questions/34691045/cannot-assign-string-with-single-quote-in-golang/66872304#66872304", "title": "Cannot assign string with single quote in golang", "body": "<p>Another option, if you are wanting to embed double quotes:</p>\n<pre><code>package main\n\nfunc main() {\n   s := `west &quot;north&quot; east`\n   println(s)\n}\n</code></pre>\n<p><a href=\"https://golang.org/ref/spec#raw_string_lit\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#raw_string_lit</a></p>\n"}], "owner": {"reputation": 2269, "user_id": 3016716, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wCaTR.jpg?s=128&g=1", "display_name": "shivams", "link": "https://stackoverflow.com/users/3016716/shivams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25808, "favorite_count": 6, "accepted_answer_id": 34691123, "answer_count": 3, "score": 45, "last_activity_date": 1617112430, "creation_date": 1452325690, "last_edit_date": 1539452648, "question_id": 34691045, "link": "https://stackoverflow.com/questions/34691045/cannot-assign-string-with-single-quote-in-golang", "title": "Cannot assign string with single quote in golang", "body": "<p>I am learning go and when playing with string I noticed that if a string is in single quotes then golang is giving me an error but double quotes are working fine. </p>\n\n<pre><code>func main() {\n    var a string\n    a = 'hello' //will give error\n    a = \"hello\" //will not give error\n}\n</code></pre>\n\n<p>This is the error I get on my system:</p>\n\n<pre><code>illegal rune literal\n</code></pre>\n\n<p>While when I try to do the same on playground I am getting this error:</p>\n\n<pre><code>prog.go:9: missing '\nprog.go:9: syntax error: unexpected name, expecting semicolon or newline or }\nprog.go:9: newline in string\nprog.go:9: empty character literal or unescaped ' in character literal\nprog.go:9: missing '\n</code></pre>\n\n<p>I am not able to understand the exact reason behind this as in for example Python, Perl one can declare a string with both single and double quote. </p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "goamz"], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 0, "last_activity_date": 1452656200, "creation_date": 1452656200, "answer_id": 34757983, "question_id": 34690518, "link": "https://stackoverflow.com/questions/34690518/how-do-i-track-progress-in-a-multipart-upload-to-s3-using-go/34757983#34757983", "title": "How do I track progress in a multipart upload to s3 using Go?", "body": "<p>It's possible the issue here is caused by not reading the file fully. <code>Read</code> can be a little subtle:</p>\n\n<blockquote>\n  <p>Read reads up to len(p) bytes into p. It returns the number of bytes read (0 &lt;= n &lt;= len(p)) and any error encountered. Even if Read returns n &lt; len(p), it may use all of p as scratch space during the call. If some data is available but not len(p) bytes, Read conventionally returns what is available instead of waiting for more.</p>\n</blockquote>\n\n<p>So you should probably be using <code>ioReadFull</code> or (better) <code>io.CopyN</code>.</p>\n\n<p>That said I think you should try switching to the official AWS Go package. They have a handy <a href=\"http://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/Uploader.html\" rel=\"nofollow\">Uploader</a> which will handle all of this for you:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n)\n\nfunc main() {\n    bucketName := \"test-bucket\"\n    keyName := \"test-key\"\n    file, err := os.Open(\"example\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n    defer file.Close()\n\n    sess := session.New()\n    uploader := s3manager.NewUploader(sess)\n\n    // Perform an upload.\n    result, err := uploader.Upload(&amp;s3manager.UploadInput{\n        Bucket: &amp;bucketName,\n        Key:    &amp;keyName,\n        Body:   file,\n    })\n    if err != nil {\n        log.Fatalln(err)\n    }\n    log.Println(result)\n}\n</code></pre>\n\n<p>You can find more documentation on <a href=\"https://godoc.org/github.com/aws/aws-sdk-go/service/s3/s3manager#NewUploader\" rel=\"nofollow\">godoc.org</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1452657155, "last_edit_date": 1452657155, "creation_date": 1452656747, "answer_id": 34758049, "question_id": 34690518, "link": "https://stackoverflow.com/questions/34690518/how-do-i-track-progress-in-a-multipart-upload-to-s3-using-go/34758049#34758049", "title": "How do I track progress in a multipart upload to s3 using Go?", "body": "<p>The data you read into <code>partBuffer</code> isn't used at all. You pass <code>file</code> into <code>multi.PutPart</code> and it reads the <em>entire contents</em> of <code>file</code>, seeking it back to the beginning as necessary and blowing away all of the work that you've done.</p>\n\n<p>The minimal change to your code would be to pass <code>bytes.NewReader(partBuffer)</code> into <code>PutPart</code>, instead of <code>file</code>. <code>bytes.Reader</code> implements the <code>io.ReadSeeker</code> interface that <code>PutPart</code> needs, and will also report its size as being that of <code>partBuffer</code>.</p>\n\n<p>An alternative would be to use the <a href=\"https://golang.org/pkg/io/#SectionReader\" rel=\"nofollow\">io.SectionReader</a> type \u2014 instead of reading the data into a buffer yourself, you just create a series of <code>SectionReader</code>s based on <code>file</code> with the sizes and offsets that you want and pass them into <code>PutPart</code>, and they will pass the reads on to the underlying file reader. That should work just as well and cut down the code that you have to write (and error-check) considerably. It also avoids buffering a whole chunk of data in RAM unnecessarily.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7581153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mC9JE.png?s=128&g=1", "display_name": "Jefferson Otoni Lima", "link": "https://stackoverflow.com/users/7581153/jefferson-otoni-lima"}, "is_accepted": false, "score": 0, "last_activity_date": 1497188677, "last_edit_date": 1497188677, "creation_date": 1497161860, "answer_id": 44480939, "question_id": 34690518, "link": "https://stackoverflow.com/questions/34690518/how-do-i-track-progress-in-a-multipart-upload-to-s3-using-go/44480939#44480939", "title": "How do I track progress in a multipart upload to s3 using Go?", "body": "<p>When you pass the file part to the <strong>multi.PutPart</strong> method (n, <strong>strings.NewReader</strong> (\"\")) then your code would have to change some points for this to work correctly, the code below will work.</p>\n\n<p>Remembering that PutPart sends part of the multipart upload, reading all the contents from r, each part, except for the last one, must be at <em>least 5MB in size.</em>\nIt is described in goamz docs.</p>\n\n<p>Points I've changed to work correctly:</p>\n\n<p>Here I am creating our headerPart with all the bytes of the file</p>\n\n<p><strong>HeaderPart: = strings.NewReader (string (bytes)</strong>)</p>\n\n<p>Here <strong>io.ReadFull (HeaderPart, partBuffer)</strong> I'm reading the entire buffer part of the <em>make ([] byte, partSize)</em> command, each time it is positioned in a certain part of the file.</p>\n\n<p>And when we run <strong>multi.PutPart (int (i) +1, strings.NewReader (string (partBuffer)))</strong>, we have to +1 because it does not calculate part 0 and instead of passing the object file, we will pass part of the Content using the <em>strings.NewReader</em> function for this.</p>\n\n<p><strong>Check out your code below, it now works correctly.</strong></p>\n\n<pre><code>package main\n\nimport(\n\"bufio\"\n\"fmt\"\n\"math\"\n\"net/http\"\n\"os\"\n\"launchpad.net/goamz/aws\"\n\"launchpad.net/goamz/s3\"\n)\n\nfunc check(err error) {\n    if err != nil {\n     panic(err)\n    } \n}\n\nfunc main() {\n\nfmt.Println(\"Test\")\n\nauth := aws.Auth{\n    AccessKey: \"xxxxxxxxxxx\", // change this to yours\n    SecretKey: \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\",\n}\n\nclient := s3.New(auth, aws.USWest2)\n\nb := s3.Bucket{\n    S3:   client,\n    Name: \"some-bucket\",\n}\n\nfileToBeUploaded := \"testfile\"\nfile, err := os.Open(fileToBeUploaded)\ncheck(err)\ndefer file.Close()\n\nfileInfo, _ := file.Stat()\nfileSize := fileInfo.Size()\nbytes := make([]byte, fileSize)\n\n// read into buffer\nbuffer := bufio.NewReader(file)\n_, err = buffer.Read(bytes)\ncheck(err)\nfiletype := http.DetectContentType(bytes)\n\n// set up for multipart upload\nmulti, err := b.InitMulti(\"/\"+fileToBeUploaded, filetype, s3.ACL(\"bucket-owner-read\"))\ncheck(err)\n\nconst fileChunk = 5242880 // 5MB\ntotalPartsNum := uint64(math.Ceil(float64(fileSize) / float64(fileChunk)))\nparts := []s3.Part{}\n\nfmt.Println(\"Uploading...\")\n\nHeaderPart := strings.NewReader(string(bytes))\n\nfor i := uint64(0); i &lt; totalPartsNum; i++ {\n\n    partSize := int(math.Min(fileChunk, float64(fileSize-int64(i*fileChunk))))\n\n    partBuffer := make([]byte, partSize)\n\n    n , errx := io.ReadFull(HeaderPart, partBuffer)\n\n    check(errx)\n\n    part, err := multi.PutPart(int(i)+1, strings.NewReader(string(partBuffer))) // write to S3 bucket part by part\n\n    check(err)\n\n    fmt.Printf(\"Processing %d part of %d and uploaded %d bytes.\\n \", int(i), int(totalPartsNum), int(n))\n    parts = append(parts, part)\n}\n\nerr = multi.Complete(parts)\ncheck(err)\n\nfmt.Println(\"\\n\\nPutPart upload completed\")\n}\n</code></pre>\n"}], "owner": {"reputation": 762, "user_id": 1729964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/GQkGw.jpg?s=128&g=1", "display_name": "frodopwns", "link": "https://stackoverflow.com/users/1729964/frodopwns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1927, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1497188677, "creation_date": 1452321350, "question_id": 34690518, "link": "https://stackoverflow.com/questions/34690518/how-do-i-track-progress-in-a-multipart-upload-to-s3-using-go", "title": "How do I track progress in a multipart upload to s3 using Go?", "body": "<p>I am attempting to use the PutPart method provided by the goamz fork by Mitchell Hashimoto.  Sadly every time I get a part back and check the size it seems to think it is the size of the whole file and not just a chunk.</p>\n\n<p>For instance</p>\n\n<p>When uploading a 15m file I expect to see</p>\n\n<pre><code>Uploading...\nProcessing 1 part of 3 and uploaded 5242880.0 bytes.\n Processing 2 part of 3 and uploaded 5242880.0 bytes.\n Processing 3 part of 3 and uploaded 5242880.0 bytes.\n</code></pre>\n\n<p>Instead I see:</p>\n\n<pre><code>Uploading...\nProcessing 1 part of 3 and uploaded 15728640 bytes.\n Processing 2 part of 3 and uploaded 15728640 bytes.\n Processing 3 part of 3 and uploaded 15728640 bytes.\n</code></pre>\n\n<p>Is this due to an issue with the file.Read(partBuffer)? Any help would be much appreciated. </p>\n\n<p>I am using go 1.5.1 on a mac.</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"math\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/mitchellh/goamz/aws\"\n    \"github.com/mitchellh/goamz/s3\"\n)\n\nfunc check(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc main() {\n    fmt.Println(\"Test\")\n\n    auth, err := aws.GetAuth(\"XXXXX\", \"XXXXXXXXXX\")\n    check(err)\n\n    client := s3.New(auth, aws.USWest2)\n\n    b := s3.Bucket{\n        S3:   client,\n        Name: \"some-bucket\",\n    }\n\n    fileToBeUploaded := \"testfile\"\n    file, err := os.Open(fileToBeUploaded)\n    check(err)\n    defer file.Close()\n\n    fileInfo, _ := file.Stat()\n    fileSize := fileInfo.Size()\n    bytes := make([]byte, fileSize)\n\n    // read into buffer\n    buffer := bufio.NewReader(file)\n    _, err = buffer.Read(bytes)\n    check(err)\n    filetype := http.DetectContentType(bytes)\n\n    // set up for multipart upload\n    multi, err := b.InitMulti(\"/\"+fileToBeUploaded, filetype, s3.ACL(\"bucket-owner-read\"))\n    check(err)\n\n    const fileChunk = 5242880 // 5MB\n    totalPartsNum := uint64(math.Ceil(float64(fileSize) / float64(fileChunk)))\n    parts := []s3.Part{}\n\n    fmt.Println(\"Uploading...\")\n    for i := uint64(1); i &lt; totalPartsNum; i++ {\n\n        partSize := int(math.Min(fileChunk, float64(fileSize-int64(i*fileChunk))))\n        partBuffer := make([]byte, partSize)\n\n        _, err := file.Read(partBuffer)\n        check(err)\n\n        part, err := multi.PutPart(int(i), file) // write to S3 bucket part by part\n        check(err)\n\n        fmt.Printf(\"Processing %d part of %d and uploaded %d bytes.\\n \", int(i), int(totalPartsNum), int(part.Size))\n        parts = append(parts, part)\n    }\n\n    err = multi.Complete(parts)\n    check(err)\n\n    fmt.Println(\"\\n\\nPutPart upload completed\")\n\n}\n</code></pre>\n"}, {"tags": ["go", "docker", "couchbase"], "answers": [{"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1452466646, "last_edit_date": 1495542682, "creation_date": 1452466646, "answer_id": 34711758, "question_id": 34690359, "link": "https://stackoverflow.com/questions/34690359/access-ip-address-of-couchbase-container-on-docker-swarm-cluster/34711758#34711758", "title": "Access IP address of Couchbase container on Docker Swarm cluster", "body": "<p>The property <code>.NetworkSettings.Ports</code> is a map, not a struct. You can use the <a href=\"https://stackoverflow.com/questions/26152088/access-a-map-value-using-a-variable-key-in-a-go-template\"><code>index</code> template function</a> to access the map (and also slice) values:</p>\n\n<pre><code>$ docker inspect --format '{{ index .NetworkSettings.Ports \"8091/tcp\" 0 \"HostIp\" }}'\n</code></pre>\n\n<p>Note however, that this may not always return what you expect. If the container is configured to listen on <em>all</em> host interfaces, this will simply return <code>0.0.0.0</code>. You could have a look at the <a href=\"https://docs.docker.com/engine/userguide/networking/dockernetworks/\" rel=\"nofollow noreferrer\">networking feature</a> that was introduced with Docker 1.9 for this without relying on looking up host IP addresses.</p>\n"}], "owner": {"reputation": 3555, "user_id": 672246, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/268f57c236bb50c0f6e12ac38adc9d81?s=128&d=identicon&r=PG", "display_name": "Arun Gupta", "link": "https://stackoverflow.com/users/672246/arun-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 34711758, "answer_count": 1, "score": 1, "last_activity_date": 1452466646, "creation_date": 1452320036, "last_edit_date": 1452439726, "question_id": 34690359, "link": "https://stackoverflow.com/questions/34690359/access-ip-address-of-couchbase-container-on-docker-swarm-cluster", "title": "Access IP address of Couchbase container on Docker Swarm cluster", "body": "<p>Trying to run a Couchbase cluster on Docker Swarm cluster. After the cluster is started, I'd like to obtain the IP address of each Couchbase instance dynamically. <code>docker inspect</code> shows:</p>\n\n<pre><code>\"NetworkSettings\": {\n        \"Bridge\": \"\",\n        \"SandboxID\": \"325807d55b552be3fe5b44b4d975c2486b3a56b320aa56fa0367e42348b82d64\",\n        \"HairpinMode\": false,\n        \"LinkLocalIPv6Address\": \"\",\n        \"LinkLocalIPv6PrefixLen\": 0,\n        \"Ports\": {\n            \"11207/tcp\": null,\n            \"11210/tcp\": [\n                {\n                    \"HostIp\": \"192.168.99.101\",\n                    \"HostPort\": \"11210\"\n                }\n            ],\n</code></pre>\n\n<p>Trying to access the IP address gives the error:</p>\n\n<pre><code>docker inspect --format '{{ .NetworkSettings.Ports.8091/tcp[0].HostIp }}' 922755302fef\nTemplate parsing error: template: :1: unexpected \".8091\" in operand; missing space?\n</code></pre>\n\n<p>What is the right format to access the IP address?</p>\n"}, {"tags": ["go", "template-engine", "type-inference", "anonymous-types"], "comments": [{"owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 0, "creation_date": 1452312767, "post_id": 34689509, "comment_id": 57125603, "body": "It uses reflection. On line 78 in template.go it is calling Execute method on t.text which is file exec.go. If you see that code it is using reflection to access fields/properties from struct passed."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 1717563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035d52c9677872d9ea29328f0f84ace0?s=128&d=identicon&r=PG&f=1", "display_name": "jumeno", "link": "https://stackoverflow.com/users/1717563/jumeno"}, "edited": false, "score": 0, "creation_date": 1452313490, "post_id": 34689620, "comment_id": 57125718, "body": "I read wrongly type of text is html.template.Template. Thanks. That is  what I needed."}], "tags": [], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "is_accepted": true, "score": 1, "last_activity_date": 1452313538, "last_edit_date": 1452313538, "creation_date": 1452313183, "answer_id": 34689620, "question_id": 34689509, "link": "https://stackoverflow.com/questions/34689509/how-does-the-go-template-execute-read-its-prameters-fields-of-anonymous-strcu/34689620#34689620", "title": "How does the go &#39;Template.Execute&#39; read its prameter&#39;s fields of anonymous strcuture?", "body": "<p>If you look at the <code>return</code> of <code>Execute</code> it calls <code>t.text.Execute</code> which is calling this function from the <code>text/template</code> package:</p>\n\n<pre><code>   132  func (t *Template) Execute(wr io.Writer, data interface{}) (err error) {\n   133      defer errRecover(&amp;err)\n   134      value := reflect.ValueOf(data)\n   135      state := &amp;state{\n   136          tmpl: t,\n   137          wr:   wr,\n   138          vars: []variable{{\"$\", value}},\n   139      }\n   140      if t.Tree == nil || t.Root == nil {\n   141          state.errorf(\"%q is an incomplete or empty template%s\", t.Name(), t.DefinedTemplates())\n   142      }\n   143      state.walk(value, t.Root)\n   144      return\n   145  }\n</code></pre>\n\n<p>So it will use the <code>reflect</code> package to parse the variables into the template.</p>\n\n<p>Here's a little example of whats happening: <a href=\"http://play.golang.org/p/ih1Ei33NsO\" rel=\"nofollow\">http://play.golang.org/p/ih1Ei33NsO</a></p>\n"}], "owner": {"reputation": 27, "user_id": 1717563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035d52c9677872d9ea29328f0f84ace0?s=128&d=identicon&r=PG&f=1", "display_name": "jumeno", "link": "https://stackoverflow.com/users/1717563/jumeno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 34689620, "answer_count": 1, "score": 0, "last_activity_date": 1452313538, "creation_date": 1452311738, "last_edit_date": 1452312073, "question_id": 34689509, "link": "https://stackoverflow.com/questions/34689509/how-does-the-go-template-execute-read-its-prameters-fields-of-anonymous-strcu", "title": "How does the go &#39;Template.Execute&#39; read its prameter&#39;s fields of anonymous strcuture?", "body": "<p>In coding with Go, with html.template package, template.Execute is called.<br>\nI have a question, how could it read the field of anonymous structure of its parameter.<br>\nI read the source code, but it doesn't make sense. I don't have an idea.</p>\n\n<blockquote>\n  <p>/usr/local/go/src/html/template/tempalte.go L.78</p>\n</blockquote>\n\n<pre><code>type Template struct {\n    ...\n    text *template.Template\n    ...\n}\n\n// escape escapes all associated templates.\nfunc (t *Template) escape() error {\n    t.nameSpace.mu.Lock()\n    defer t.nameSpace.mu.Unlock()\n    if t.escapeErr == nil {\n        if t.Tree == nil {\n            return fmt.Errorf(\"template: %q is an incomplete or empty template%s\", t.Name(), t.text.DefinedTemplates())\n        }\n        if err := escapeTemplate(t, t.text.Root, t.Name()); err != nil {\n            return err \n        }\n    } else if t.escapeErr != escapeOK {\n        return t.escapeErr\n    }   \n    return nil \n}\n\n// Execute applies a parsed template to the specified data object,\n// writing the output to wr.\n// If an error occurs executing the template or writing its output,\n// execution stops, but partial results may already have been written to\n// the output writer.\n// A template may be executed safely in parallel.\nfunc (t *Template) Execute(wr io.Writer, data interface{}) error {\n    if err := t.escape(); err != nil {\n        return err \n    }   \n    return t.text.Execute(wr, data)\n}\n</code></pre>\n\n<p>GoDoc demonstrates its usage, calling Execute with its interface{} paramter like this;</p>\n\n<pre><code>data := struct {\n    Title string\n    Items []string\n}{\n    Title: \"My another page\",\n    Items: []string{},\n}\n\n\nerr = t.Execute(os.Stdout, data)\n</code></pre>\n"}, {"tags": ["go", "https"], "comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452314185, "post_id": 34689277, "comment_id": 57125844, "body": "Do you have a certificate that is signed by a certificate authority or are you just making your own certs?"}, {"owner": {"reputation": 173, "user_id": 5349449, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0d00541e5d1496e0bdbaafdea752e068?s=128&d=identicon&r=PG&f=1", "display_name": "Emma He", "link": "https://stackoverflow.com/users/5349449/emma-he"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452314382, "post_id": 34689277, "comment_id": 57125877, "body": "I use openssl to generate a CA cert, with which i signed a server cert/key and client cert/key"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452314438, "post_id": 34689277, "comment_id": 57125884, "body": "So do you have a <code>cert.pem</code> and <code>key.pem</code>?"}, {"owner": {"reputation": 173, "user_id": 5349449, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0d00541e5d1496e0bdbaafdea752e068?s=128&d=identicon&r=PG&f=1", "display_name": "Emma He", "link": "https://stackoverflow.com/users/5349449/emma-he"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452314526, "post_id": 34689277, "comment_id": 57125898, "body": "yes, of course. I&#39;ve got all the materials needed"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 1, "creation_date": 1452316683, "post_id": 34689277, "comment_id": 57126312, "body": "So what exactly is your problem, to answer your question about concatenation, yes just join all those things into one file and then pass that file as the <code>certFile</code> argument. Have you already tried to run the server and see if it works, can nobody connect, are you getting a privacy error or what"}, {"owner": {"reputation": 173, "user_id": 5349449, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0d00541e5d1496e0bdbaafdea752e068?s=128&d=identicon&r=PG&f=1", "display_name": "Emma He", "link": "https://stackoverflow.com/users/5349449/emma-he"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452391064, "post_id": 34689277, "comment_id": 57148465, "body": "I&#39;ve run the server successfully, and could get what i want when skipping the verification."}, {"owner": {"reputation": 173, "user_id": 5349449, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0d00541e5d1496e0bdbaafdea752e068?s=128&d=identicon&r=PG&f=1", "display_name": "Emma He", "link": "https://stackoverflow.com/users/5349449/emma-he"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452391222, "post_id": 34689277, "comment_id": 57148490, "body": "Yet when i tried to connect the server with a client, it failed with <code>x509: certificate signed by unknown authority</code> when i passed the concatenated file as the flag :-/ Am i missing anything -- this is my problem."}], "answers": [{"tags": [], "owner": {"reputation": 1759, "user_id": 1512962, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/EfW0L.png?s=128&g=1", "display_name": "Anonymous Penguin", "link": "https://stackoverflow.com/users/1512962/anonymous-penguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1452470526, "creation_date": 1452470526, "answer_id": 34712273, "question_id": 34689277, "link": "https://stackoverflow.com/questions/34689277/how-to-provide-ca-certs-for-listenandservetls-function/34712273#34712273", "title": "How to provide CA certs for ListenAndServeTLS function", "body": "<p><strong>That's a minor detail, just ignore it and add your <code>cert.pem</code> and <code>key.pem</code> file like the docs say.</strong> It's talking about how you can \"chain\" (concatenate) certificates together to transfer trust from the root certificate to intermediate certificates. All of this is details of how PKI works, and you don't have to worry as long as you aren't messing with the cert and key files.</p>\n\n<p>You see, the way your browser knows PayPal is actually <em>PayPal</em> is by verifying that PayPal's certificate was signed by a root certificate trusted by your computer. In this case, Symantec signed the certificate.</p>\n\n<p>Intermediate certificate authorities can be made. For example, the most secure CAs don't actually hook the server with the root certificate to the internet; everything is signed with intermediate certificate authorities that have themselves signed by the root certificate. If an intermediate CA got hacked, Symantec could then revoke all the certificates signed by that CA a lot easier than getting a new public key setup.</p>\n\n<p>Your browser can trust PayPal because it was signed by an intermediate CA of Symantec. The intermediate CA's certificate was signed by the root CA of Symantec.</p>\n"}, {"tags": [], "owner": {"reputation": 312, "user_id": 3043018, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GJ4VU.jpg?s=128&g=1", "display_name": "Inkeliz", "link": "https://stackoverflow.com/users/3043018/inkeliz"}, "is_accepted": false, "score": 2, "last_activity_date": 1521417580, "creation_date": 1521417580, "answer_id": 49354072, "question_id": 34689277, "link": "https://stackoverflow.com/questions/34689277/how-to-provide-ca-certs-for-listenandservetls-function/49354072#49354072", "title": "How to provide CA certs for ListenAndServeTLS function", "body": "<p>The previous answer didn't resolve any problem. The easiest way is uploading your cert (your certificate, not your private key, for obvious reason!) to <a href=\"https://certificatechain.io\" rel=\"nofollow noreferrer\">certificatechain.io</a>.</p>\n\n<p>Another alternative is simple request the <em>ca-bundle</em> to your CA, then you will concatenate as follows:</p>\n\n<pre><code>-----BEGIN CERTIFICATE-----\nYOUR CERT\nYOUR CERT\nYOUR CERT\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nSOME INTERMEDIATE CERT\nSOME INTERMEDIATE CERT\nSOME INTERMEDIATE CERT\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nANOTHER INTERMEDIATE CERT\nANOTHER INTERMEDIATE CERT\nANOTHER INTERMEDIATE CERT\nANOTHER INTERMEDIATE CERT\n-----END CERTIFICATE-----\n</code></pre>\n\n<p>Note that the order matters. Once you have this file in hands you can use the \"new certificate\" in the <code>ServeAndListenTLS()</code>.</p>\n"}], "owner": {"reputation": 173, "user_id": 5349449, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0d00541e5d1496e0bdbaafdea752e068?s=128&d=identicon&r=PG&f=1", "display_name": "Emma He", "link": "https://stackoverflow.com/users/5349449/emma-he"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1132, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1521417580, "creation_date": 1452308569, "question_id": 34689277, "link": "https://stackoverflow.com/questions/34689277/how-to-provide-ca-certs-for-listenandservetls-function", "title": "How to provide CA certs for ListenAndServeTLS function", "body": "<p>It says that in the docs</p>\n\n<p>\"ListenAndServeTLS acts identically to ListenAndServe, except that it expects HTTPS connections. Additionally, files containing a certificate and matching private key for the server must be provided. If the certificate is signed by a certificate authority, the certFile should be the concatenation of the server's certificate, any intermediates, and the CA's certificate.\"</p>\n\n<p>Yet i can barely understand what <code>concatenation</code> and <code>intermediates</code> actually mean.\nCould anyone please kindly give me an example? Thanks in advance.</p>\n\n<p>Btw, i don't wanna load CA cert in the tls.Config, which works well definitely;)</p>\n"}, {"tags": ["go", "enums"], "comments": [{"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1452308941, "post_id": 34689248, "comment_id": 57125035, "body": "By &quot;enum&quot; I take it you mean not just a set of constants with distinct values, but more specifically, a set of constants with distinct <i>power-of-two</i> values that can be used with bitwise-or and so on?"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1452308958, "post_id": 34689248, "comment_id": 57125038, "body": "Can you include a minimal amount of background and code in your question? At the moment it&#39;s a guess what you&#39;re actually trying to do (and so hard to give helpful answers)."}, {"owner": {"reputation": 31, "user_id": 5765562, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-It5wR0jrIBY/AAAAAAAAAAI/AAAAAAAAAKQ/QkfvNykP9J4/photo.jpg?sz=128", "display_name": "Herp Derpson", "link": "https://stackoverflow.com/users/5765562/herp-derpson"}, "edited": false, "score": 0, "creation_date": 1452309582, "post_id": 34689248, "comment_id": 57125139, "body": "The code is pretty much exactly what you see in the link that&#39;s included, except that my const list is 64 items long (and is about to grow) and I&#39;ve added a few bells &#39;n whistles (ContainsSomeFlagOf, etc)."}, {"owner": {"reputation": 31, "user_id": 5765562, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-It5wR0jrIBY/AAAAAAAAAAI/AAAAAAAAAKQ/QkfvNykP9J4/photo.jpg?sz=128", "display_name": "Herp Derpson", "link": "https://stackoverflow.com/users/5765562/herp-derpson"}, "edited": false, "score": 0, "creation_date": 1452310669, "post_id": 34689248, "comment_id": 57125305, "body": "Background wise, I&#39;m using these enums to control flow in little game thingy I&#39;m building. Every action in the game has these enums to control flow through the program. Basically I&#39;m building a tiny &quot;action compiler&quot;. Don&#39;t really wanna go the command string route, all that string manipulation gives me the willies. I&#39;m more than open for suggestions on different solutions though."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452311723, "post_id": 34689248, "comment_id": 57125451, "body": "<a href=\"https://godoc.org/?q=bitset\" rel=\"nofollow noreferrer\">godoc.org/?q=bitset</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1452331819, "post_id": 34689248, "comment_id": 57129774, "body": "If you need more than 64 bits a uint64 won&#39;t do, but two uint64 might like in <code>type testyEnum struct { a, b uint64 }</code>.  Setting up the const requires more typing."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1452340228, "post_id": 34689248, "comment_id": 57132191, "body": "@HerpDerpson math/big.(*int) actually has convenient <a href=\"https://golang.org/pkg/math/big/#Int.Bit\" rel=\"nofollow noreferrer\">Bit</a> and <a href=\"https://golang.org/pkg/math/big/#Int.SetBit\" rel=\"nofollow noreferrer\">SetBit</a> methods. Or divide your actions into multiple types, each with N&lt;64."}, {"owner": {"reputation": 314, "user_id": 5716193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9QW0.jpg?s=128&g=1", "display_name": "Amnon", "link": "https://stackoverflow.com/users/5716193/amnon"}, "edited": false, "score": 0, "creation_date": 1452383955, "post_id": 34689248, "comment_id": 57146909, "body": "Why not give the enums sequential integers rather than powers of 2?"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 314, "user_id": 5716193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9QW0.jpg?s=128&g=1", "display_name": "Amnon", "link": "https://stackoverflow.com/users/5716193/amnon"}, "edited": false, "score": 0, "creation_date": 1452401743, "post_id": 34689248, "comment_id": 57150437, "body": "@Amnon if the enum represents a bit mask with multiple values OR-ed together, they need to be powers of 2"}, {"owner": {"reputation": 31, "user_id": 5765562, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-It5wR0jrIBY/AAAAAAAAAAI/AAAAAAAAAKQ/QkfvNykP9J4/photo.jpg?sz=128", "display_name": "Herp Derpson", "link": "https://stackoverflow.com/users/5765562/herp-derpson"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1452440815, "post_id": 34689248, "comment_id": 57160720, "body": "Amnon what @andlabs said. I&#39;m using a <i>FLAGGED</i> enum, not just enum. I need to be able to construct things like PERFORMER|REQUIRED|GUID, PERFORMER|STATUS and PERFORMER|SKILL|LEVEL|REQUIRED etc. I&#39;ve been looking into doing this as string compiler, but that requires ALOT of design upfront (as in, designing a whole action language with lexical and syntactic parsing) - I think it might be Herp-Derpsons-School-Of-OverDesign worthy endeavor. Before I do that I&#39;m gonna give kostya&#39;s and Volker&#39;s solution a little twirl."}, {"owner": {"reputation": 31, "user_id": 5765562, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-It5wR0jrIBY/AAAAAAAAAAI/AAAAAAAAAKQ/QkfvNykP9J4/photo.jpg?sz=128", "display_name": "Herp Derpson", "link": "https://stackoverflow.com/users/5765562/herp-derpson"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1452441521, "post_id": 34689248, "comment_id": 57161024, "body": "@Volker I wouldnt be able to do TE1|TE65 then... mind you, could make a function that does pretty much the same TE1.AddFlag(flag unit64)... hmm. Food for thought."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1452443729, "post_id": 34689248, "comment_id": 57161790, "body": "Yeah, I think you&#39;re either going to have to either use multiple bitfields, a structure of <code>bool</code>s, or math/big.Int. Good luck."}, {"owner": {"reputation": 31, "user_id": 5765562, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-It5wR0jrIBY/AAAAAAAAAAI/AAAAAAAAAKQ/QkfvNykP9J4/photo.jpg?sz=128", "display_name": "Herp Derpson", "link": "https://stackoverflow.com/users/5765562/herp-derpson"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1453042028, "post_id": 34689248, "comment_id": 57419928, "body": "Sit. rep: I ended up using the bitset @kostya recommended. It&#39;s not ideal, but works. Con: heavy in use  (you can&#39;t go TE1|TE2,  it uses functions; VarName := TE1.Union(TE2), or MakeTEnum(TE1...). Ended up writing a little package that compiles list of enum names into a .go file. Pro: enum takes maximum 7bits more than it needs.I recommend that <a href=\"https://godoc.org/?q=bitset\" rel=\"nofollow noreferrer\">bitset</a> package for all your bitset needs. I&#39;m sure that using big.Int will have all the same problems so I&#39;m going with this for now. Thanks ya&#39;ll for all your valuable input!"}], "owner": {"reputation": 31, "user_id": 5765562, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-It5wR0jrIBY/AAAAAAAAAAI/AAAAAAAAAKQ/QkfvNykP9J4/photo.jpg?sz=128", "display_name": "Herp Derpson", "link": "https://stackoverflow.com/users/5765562/herp-derpson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 474, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1452310158, "creation_date": 1452308330, "last_edit_date": 1495542776, "question_id": 34689248, "link": "https://stackoverflow.com/questions/34689248/go-lang-flagged-enum-larger-than-64b", "title": "Go Lang (flagged) enum - larger than 64b?", "body": "<p>I've been using the \"const iota\" solution for enum like structures (see <a href=\"https://stackoverflow.com/questions/14426366/what-is-an-idiomatic-way-of-representing-enums-in-golang\">here</a>). But recently I've hit a little SNAFU - one of my enums has reached it's limit of 64b (I'm using int64 consts). Any ideas, short of pouring myself into and over the hellish underbelly of math/big?</p>\n\n<p>[Edit: Added example code]</p>\n\n<pre><code>package testy\n\nimport (\n    \"fmt\"\n    \"strings\"\n     \"strconv\"\n)\n\ntype testyEnum int64\n\nconst (\n    TE1 testyEnum = 1 &lt;&lt; iota\n    TE2\n    TE3\n    TE4\n    TE5\n    TE6\n    TE7\n    TE8\n    TE9\n    TE10\n    TE11\n    TE12\n    TE13\n    TE14\n    TE15\n    TE16\n    TE17\n    ... (list shortened)\n    TE107\n    TE108\n    TE109\n)\n\n//HasFlag returns true if the caller has all of the flags from the parameter\nfunc (obj testyEnum) HasFlag(right testyEnum) bool {\n    return obj &amp; right == right\n}\n\n//ContainsSomeFlagOf returns true if the caller and the parameter share some flags.\nfunc (obj testyEnum) ContainsSomeFlagOf(right testyEnum) bool {\n    return obj&amp;right != 0\n}\n\n//SharedFlags returns the shared flags of enum and parameter\nfunc (obj testyEnum) SharedFlags(right testyEnum) testyEnum {\n    return obj &amp; right\n}\n\n//AddFlag(obj testyEnum) adds flag right to the enum\nfunc (obj *testyEnum) AddFlag(right testyEnum) {\n    *obj = *obj|right\n}\n\n//RemoveFlag(obj testyEnum) removes flag right to the enum. If any of the flags from right where not set in obj.\nfunc (obj *testyEnum) RemoveFlag(right testyEnum) {\n    shared := obj.SharedFlags(right)\n    *obj = *obj^shared\n}\n\n//ToInt(obj testyEnum) returns the value of the enum as int\nfunc (obj *testyEnum) ToInt() int {\n    return int(*obj)\n}\n\n//ToStringSlice returns a slice of strings with all the flags that are set\nfunc (obj *testyEnum) ToStringSlice() []string {\n    var flags []string\n\n    if obj.HasFlag(TE1) {\n        flags = append(flags, \"TE1\")\n    }\n\n    if obj.HasFlag(TE2) {\n        flags = append(flags, \"TE2\")\n    }\n\n    if obj.HasFlag(TE3) {\n        flags = append(flags, \"TE3\")\n    }\n\n    if obj.HasFlag(TE4) {\n        flags = append(flags, \"TE4\")\n    }\n\n    if obj.HasFlag(TE5) {\n        flags = append(flags, \"TE5\")\n    }\n\n    if obj.HasFlag(TE6) {\n        flags = append(flags, \"TE6\")\n    }\n\n    if obj.HasFlag(TE7) {\n        flags = append(flags, \"TE7\")\n    }\n\n    if obj.HasFlag(TE8) {\n        flags = append(flags, \"TE8\")\n    }\n\n    if obj.HasFlag(TE9) {\n        flags = append(flags, \"TE9\")\n    }\n\n    if obj.HasFlag(TE10) {\n        flags = append(flags, \"TE10\")\n    }\n\n    if obj.HasFlag(TE11) {\n        flags = append(flags, \"TE11\")\n    }\n\n    if obj.HasFlag(TE12) {\n        flags = append(flags, \"TE12\")\n    }\n\n    if obj.HasFlag(TE13) {\n        flags = append(flags, \"TE13\")\n    }\n\n    if obj.HasFlag(TE14) {\n        flags = append(flags, \"TE14\")\n    }\n\n    if obj.HasFlag(TE15) {\n        flags = append(flags, \"TE15\")\n    }\n\n    if obj.HasFlag(TE16) {\n        flags = append(flags, \"TE16\")\n    }\n\n    ... (ditto)\n\n    if obj.HasFlag(TE107) {\n        flags = append(flags, \"TE107\")\n    }\n\n    if obj.HasFlag(TE108) {\n        flags = append(flags, \"TE108\")\n    }\n\n    if obj.HasFlag(TE109) {\n        flags = append(flags, \"TE109\")\n    }\n\n    return flags\n}\n\n//String returns a string representation of the enum\nfunc (obj testyEnum) String() string {\n    flags := obj.ToStringSlice()\n    if len(flags) &gt; 0 {\n        return fmt.Sprintf(\"testyEnum{%d(%s)}\", int(obj), strings.Join(flags, \"|\"))\n    }\n\n    return \"testyEnum{0()}\"\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452303032, "post_id": 34688616, "comment_id": 57124031, "body": "Thanks for the reply, I&#39;m aware of how append works, I&#39;m strictly talking about <code>[]string(nil)</code> its self, I&#39;m curious how <code>(nil)</code> operates and what it can operate on, the append was just an example, I&#39;m wondering if there&#39;s any benefit over using <code>[]string{}</code> or <code>[]string(nil)</code>"}], "tags": [], "owner": {"reputation": 328, "user_id": 1217475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9abee31a2f4aafa5101bb4e1b895d3?s=128&d=identicon&r=PG", "display_name": "nerdy900", "link": "https://stackoverflow.com/users/1217475/nerdy900"}, "is_accepted": false, "score": 0, "last_activity_date": 1452301893, "creation_date": 1452301893, "answer_id": 34688616, "question_id": 34688497, "link": "https://stackoverflow.com/questions/34688497/what-exactly-is-nil-doing-in-this-context-stringnil/34688616#34688616", "title": "What exactly is (nil) doing in this context []string(nil)", "body": "<pre><code>list := []string(nil) // list is an empty slice of strings \n</code></pre>\n\n<p><code>func append(slice []Type, elems ...Type) []Type</code> </p>\n\n<p>function takes a slice of strings and a variable length list of strings, and returns a slice where the list of strings is appended to the end.</p>\n\n<p>so:</p>\n\n<pre><code>cop := append([]string(nil), str...) \n</code></pre>\n\n<p>will create an empty slice of strings and append the strings in \"str\" and return the result. </p>\n\n<p>This the result slice is a copy, because it has all of the same values in the same order.</p>\n"}, {"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452303750, "post_id": 34688775, "comment_id": 57124156, "body": "So is this at all similar to doing <code>interfaceType.(string)</code>? Also would it operate the same as <code>[]string{}</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 1, "creation_date": 1452303937, "post_id": 34688775, "comment_id": 57124207, "body": "No. The <code>.(type)</code> is a &quot;type assertion&quot;. The <code>[]string{}</code> syntax allocates a slice, and isn&#39;t <code>nil</code>."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452304093, "post_id": 34688775, "comment_id": 57124238, "body": "So what would the benefit of using <code>[]string(nil)</code> over <code>[]string{}</code> in the append example be?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 1, "creation_date": 1452304465, "post_id": 34688775, "comment_id": 57124330, "body": "the latter requires an allocation."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452305991, "post_id": 34688775, "comment_id": 57124618, "body": "Ohhhhhh I see it now in a different light, it would be the same as <code>uint64(2)</code> for some reason I just couldn&#39;t see it with it being wrapped around a <code>nil</code> and being <code>[]string()</code>. Thanks"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1452303549, "creation_date": 1452303549, "answer_id": 34688775, "question_id": 34688497, "link": "https://stackoverflow.com/questions/34688497/what-exactly-is-nil-doing-in-this-context-stringnil/34688775#34688775", "title": "What exactly is (nil) doing in this context []string(nil)", "body": "<p>This is a type conversion, converting a <code>nil</code> to a slice. </p>\n\n<p>These are equivalent </p>\n\n<pre><code>var t []string\nt := []string(nil)\n</code></pre>\n\n<p>In both cases, <code>t</code> is of type <code>[]string</code>, and <code>t == nil</code></p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 3, "accepted_answer_id": 34688775, "answer_count": 2, "score": 3, "last_activity_date": 1452303549, "creation_date": 1452300820, "last_edit_date": 1452303104, "question_id": 34688497, "link": "https://stackoverflow.com/questions/34688497/what-exactly-is-nil-doing-in-this-context-stringnil", "title": "What exactly is (nil) doing in this context []string(nil)", "body": "<p>I was looking at the Slice Tricks: <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow\">https://github.com/golang/go/wiki/SliceTricks</a></p>\n\n<p>and I noticed in their copy example they have <code>[]T(nil)</code></p>\n\n<p>I haven't seen <code>(nil)</code> like this before and I can't find any documentation on using it or what exactly it accomplishes (I know it's self explanatory but I want to know how it acts the same as <code>make</code> or <code>[]string{}</code> </p>\n\n<p>the only reference I can find by googling \"golang (nil) slice\" is</p>\n\n<blockquote>\n  <p>Since the zero value of a slice (nil) acts like a zero-length slice, you can declare a slice variable and then append to it in a loop:</p>\n</blockquote>\n\n<p>But it doesn't say where it can be used or exactly what it accomplishes, like can I use this with structs or whatever I want?</p>\n\n<p>e.g.:</p>\n\n<p>package main</p>\n\n<p>import \"log\"</p>\n\n<pre><code>func main() {\n    str := []string{\"Hello\", \"Bye\", \"Good Day\", \"????????\"}\n    cop := append([]string(nil), str...)    \n\n    log.Println(str)\n    log.Println(cop)\n}\n</code></pre>\n\n<p>I'm strictly only curious about how <code>(nil)</code> operates, and what it can operate on.</p>\n\n<p>Like does </p>\n\n<pre><code>[]string(nil)\n</code></pre>\n\n<p>Operate the same as</p>\n\n<pre><code>[]string{}\n</code></pre>\n\n<p>or what is the difference here</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1452947427, "post_id": 34686154, "comment_id": 57395660, "body": "Then please close this question, since it is not very likely that it will help anybody else."}, {"owner": {"reputation": 3641, "user_id": 3139595, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/r1GRx.png?s=128&g=1", "display_name": "Edwin O.", "link": "https://stackoverflow.com/users/3139595/edwin-o"}, "edited": false, "score": 0, "creation_date": 1526031953, "post_id": 34686154, "comment_id": 87595018, "body": "i found this question helpful"}], "tags": [], "owner": {"reputation": 323, "user_id": 2224470, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3bbc8e9362f42b083b07ebd6b36699d9?s=128&d=identicon&r=PG", "display_name": "sb89", "link": "https://stackoverflow.com/users/2224470/sb89"}, "is_accepted": true, "score": 0, "last_activity_date": 1452287607, "creation_date": 1452287607, "answer_id": 34686154, "question_id": 34685745, "link": "https://stackoverflow.com/questions/34685745/mgo-ordered-sort-aggregation/34686154#34686154", "title": "mgo Ordered Sort Aggregation", "body": "<p>I figured out this was an issue with godep. The import statements had not been rewritten.</p>\n"}], "owner": {"reputation": 323, "user_id": 2224470, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3bbc8e9362f42b083b07ebd6b36699d9?s=128&d=identicon&r=PG", "display_name": "sb89", "link": "https://stackoverflow.com/users/2224470/sb89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 34686154, "answer_count": 1, "score": 2, "last_activity_date": 1452287607, "creation_date": 1452285853, "question_id": 34685745, "link": "https://stackoverflow.com/questions/34685745/mgo-ordered-sort-aggregation", "title": "mgo Ordered Sort Aggregation", "body": "<p>I have the following code:</p>\n\n<pre><code>competitionMatch := bson.M{ \"$match\": bson.M{\"competition\" : bson.M{\"$in\" : []string{\"PREMIERSHIP\", \"CHAMPIONSHIP\", \"LEAGUE1\", \"LEAGUE2\"}}}}\n\ngroup := bson.M{\"$group\" : bson.M{\"_id\" : \"$homeTeam\", \"competitionOrder\": bson.M{\"$max\": \"$competitionOrder\"}, \"competition\": bson.M{\"$max\" : \"$competition\"}}}\n//sort := bson.M{\"$sort\" : bson.M{\"competitionOrder\": 1,\"_id\": 1}}\nsort := bson.M{\"$sort\" : bson.D{{\"competitionOrder\", 1}, {\"_id\",1}}}\nproject := bson.M{\"$project\" : bson.M{\"_id\":1, \"competitionOrder\":1, \"competition\": 1}}\n\npipe := sessionCopy.DB(\"footballrecord\").C(season).Pipe([]bson.M{competitionMatch, group, sort, project})\n</code></pre>\n\n<p>I'm trying to perform a sort. The commented <code>sort</code> works but as it is <code>bson.M</code> it is unordered, sometimes the query is not returning what I expect.</p>\n\n<p>I'm trying to use <code>bson.D</code> (the uncommented line) but I get the following error when the query is run:\n<code>the $sort key specification must be an object</code></p>\n\n<p>Any idea where I'm going wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 1, "creation_date": 1452282023, "post_id": 34684751, "comment_id": 57115898, "body": "Sidenote - add <code>strconv</code> for second example."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1452282273, "post_id": 34684751, "comment_id": 57116033, "body": "Neither of your code blocks work."}, {"owner": {"reputation": 3348, "user_id": 964634, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ecb23bff591cd2ebc53507a963e5b72c?s=128&d=identicon&r=PG", "display_name": "Hard worker", "link": "https://stackoverflow.com/users/964634/hard-worker"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1452285947, "post_id": 34684751, "comment_id": 57118003, "body": "@AdamSmith It&#39;s untested code. I wasn&#39;t expecting people to run it, just threw it together to illustrate my point."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1452286291, "post_id": 34684751, "comment_id": 57118188, "body": "@Hardworker But your question asks &quot;Why use a buffer when I can just use a variable,&quot; and for illustration you use a variable that <i>doesn&#39;t work</i>. The answer to that question is &quot;Using a variable doesn&#39;t work, as your own example shows.&quot;"}, {"owner": {"reputation": 3348, "user_id": 964634, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ecb23bff591cd2ebc53507a963e5b72c?s=128&d=identicon&r=PG", "display_name": "Hard worker", "link": "https://stackoverflow.com/users/964634/hard-worker"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1452286770, "post_id": 34684751, "comment_id": 57118415, "body": "@AdamSmith You&#39;ve never seen someone post pseudo code before to make a point? Isn&#39;t it immediately obvious the code is incomplete and just trying to illustrate something?"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1452452149, "post_id": 34684751, "comment_id": 57165079, "body": "@Hardworker I have seem many uses of pseudo code.  In most cases, the pseudo-ness of the code is worse than posting real code that actually works.  There are a few exceptions, but the above is not one of them.  (Examples include situations where the underlying language makes the operation in question extremely awkward, or where you are casually chatting next to a whiteboard and the cost of ensuring code is valid is high, and when you are doing a polished presentation where you have written valid code, then intentionally removed unimportant bits.)"}, {"owner": {"reputation": 10414, "user_id": 2357411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8g4EC.jpg?s=128&g=1", "display_name": "Carlos Robles", "link": "https://stackoverflow.com/users/2357411/carlos-robles"}, "edited": false, "score": 0, "creation_date": 1452504342, "post_id": 34684751, "comment_id": 57181605, "body": "I edited the post to make clear that the code is not actual complete code, it&#39;s totally true that was not clear if it was or not real code. I think that like this the post can stay since the question is valid, could be recurring to other users, and has already good answers."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1452654954, "last_edit_date": 1452654954, "creation_date": 1452282270, "answer_id": 34684862, "question_id": 34684751, "link": "https://stackoverflow.com/questions/34684751/what-is-the-purpose-of-the-buffer-when-we-can-store-in-a-string-variable/34684862#34684862", "title": "What is the purpose of the buffer when we can store in a string variable?", "body": "<p>A buffer grows in chunks to amortize memory allocations.</p>\n\n<p>Because strings are immutable, every iteration through the loop must allocate a new string.</p>\n"}, {"tags": [], "owner": {"reputation": 314, "user_id": 5716193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9QW0.jpg?s=128&g=1", "display_name": "Amnon", "link": "https://stackoverflow.com/users/5716193/amnon"}, "is_accepted": false, "score": 2, "last_activity_date": 1452384228, "creation_date": 1452384228, "answer_id": 34700443, "question_id": 34684751, "link": "https://stackoverflow.com/questions/34684751/what-is-the-purpose-of-the-buffer-when-we-can-store-in-a-string-variable/34700443#34700443", "title": "What is the purpose of the buffer when we can store in a string variable?", "body": "<p>Strings are immutable in Go. So the second example will allocate a new string on each iteration, so will have O(n^2) runtime.</p>\n"}, {"tags": [], "owner": {"reputation": 24042, "user_id": 1356107, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/qXxvn.png?s=128&g=1", "display_name": "Tschallacka", "link": "https://stackoverflow.com/users/1356107/tschallacka"}, "is_accepted": false, "score": 3, "last_activity_date": 1452504486, "last_edit_date": 1452504486, "creation_date": 1452502561, "answer_id": 34717404, "question_id": 34684751, "link": "https://stackoverflow.com/questions/34684751/what-is-the-purpose-of-the-buffer-when-we-can-store-in-a-string-variable/34717404#34717404", "title": "What is the purpose of the buffer when we can store in a string variable?", "body": "<p>You can see a buffer as a queue where you place things in line. Everyone just shoves in line one behind the other, it's very efficient and doesn't take up extra space to add new items. You just insert them and you are done.</p>\n\n<p>So when you add A, B, C, D,E to a buffer the operation will look kinda like this memory wise:</p>\n\n<pre><code>buffer=A\nbuffer=A|B\nbuffer=A|B|C\nbuffer=A|B|C|D\nbuffer=A|B|C|D|E\n</code></pre>\n\n<p>Now, if you concatenate strings, a lot of memory will have to be allocated and reallocated</p>\n\n<pre><code> str=''\n str=Allocate(A),allocate(str+A),deallocate(str='')\n str=Allocate(B),allocate(str(''|A)+B),deallocate(str=''|A)\n str=Allocate(C),allocate(str(''|A|B)+C),deallocate(str=''|A|B)\n str=Allocate(D),allocate(str(''|A|B|C)+D),deallocate(str=''|A|B|C)\n str=Allocate(E),allocate(str(''|A|B|C|D)+E),deallocate(str=''|A|B|C|D)\n</code></pre>\n\n<p>As you can see, by constantly adding to the string a new string as to be created, composed of the old string, then the new string is made and the old string gets deallocated.<br>\nThis causes a lot of junk memory. When you add in a buffer you just neatly line up everything without taking up to much extra memory.</p>\n\n<p>Whilst if you concatenate the strings, you are constantly assigning newer and bigger variables.\nOldstring + append string + new concat string. and this grows and grows and grows.<br>\nIf you have a big file you read line by line this might give some out of memory errors after a while.</p>\n"}], "owner": {"reputation": 3348, "user_id": 964634, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ecb23bff591cd2ebc53507a963e5b72c?s=128&d=identicon&r=PG", "display_name": "Hard worker", "link": "https://stackoverflow.com/users/964634/hard-worker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 34684862, "answer_count": 3, "score": 0, "last_activity_date": 1452654954, "creation_date": 1452281805, "last_edit_date": 1452510710, "question_id": 34684751, "link": "https://stackoverflow.com/questions/34684751/what-is-the-purpose-of-the-buffer-when-we-can-store-in-a-string-variable", "title": "What is the purpose of the buffer when we can store in a string variable?", "body": "<p>Why would I want to use a buffer when I can just concatenate strings? </p>\n\n<p><strong>PSEUDO CODE BELOW</strong></p>\n\n<pre><code>var buffer bytes.Buffer \nfor i := 0; i &lt; 200; i++ {\n    buffer.WriteString(strconv.Itoa(i))\n}\nfmt.Println(buffer.String())\n</code></pre>\n\n<p>Vs</p>\n\n<pre><code>buffer := \"\"\nfor i := 0; i &lt; 200; i++ {\n    buffer += strconv.Itoa(i)\n}\nfmt.Println(buffer)\n</code></pre>\n"}, {"tags": ["go", "signals", "sigkill"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452281401, "post_id": 34684337, "comment_id": 57115544, "body": "The package &quot;github.com/eaburns/Watch&quot; isn&#39;t compatible with windows."}, {"owner": {"reputation": 2783, "user_id": 1027936, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7c00c38a2a2840ee056e39b4a900d274?s=128&d=identicon&r=PG", "display_name": "nicowernli", "link": "https://stackoverflow.com/users/1027936/nicowernli"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452284352, "post_id": 34684337, "comment_id": 57117114, "body": "Do you know any go package to do the same thing for windows?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452284660, "post_id": 34684337, "comment_id": 57117281, "body": "No. How about combing something like <a href=\"https://godoc.org/gopkg.in/fsnotify.v1\" rel=\"nofollow noreferrer\">gopkg.in/fsnotify.v1</a>, and just run the commands yourself?"}], "owner": {"reputation": 2783, "user_id": 1027936, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7c00c38a2a2840ee056e39b4a900d274?s=128&d=identicon&r=PG", "display_name": "nicowernli", "link": "https://stackoverflow.com/users/1027936/nicowernli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2274, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1611070047, "creation_date": 1452280230, "last_edit_date": 1611070047, "question_id": 34684337, "link": "https://stackoverflow.com/questions/34684337/undefined-syscall-kill-on-windows", "title": "Undefined: syscall.Kill on Windows", "body": "<p>I'm using <a href=\"https://github.com/eaburns/Watch\" rel=\"nofollow noreferrer\">eaburns/Watch</a> library on a windows machine, but when trying to get the package with <em>go get github.com/eaburns/Watch</em> I get the following errors:</p>\n<pre><code>main.go:159: undefined: syscall.Kill\nmain.go:169: undefined: syscall.Wait4\nmain.go:169: undefined: syscall.WNOHANG\n</code></pre>\n<p>Any reason why this happens only on windows computers? How to fix this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5167, "user_id": 1392658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f883869af02b3cc622773c00e5a83a?s=128&d=identicon&r=PG", "display_name": "Pascal Le Merrer", "link": "https://stackoverflow.com/users/1392658/pascal-le-merrer"}, "is_accepted": false, "score": 0, "last_activity_date": 1452280533, "last_edit_date": 1452280533, "creation_date": 1452280086, "answer_id": 34684299, "question_id": 34684265, "link": "https://stackoverflow.com/questions/34684265/is-this-a-block-argument/34684299#34684299", "title": "Is this a block argument?", "body": "<p>The Group function  of IRouter is a <a href=\"https://en.wikipedia.org/wiki/Variadic_function\" rel=\"nofollow\">variadic function</a>. It means it can be called with any number of trailing arguments, of type HandlerFunc. </p>\n\n<p>Another example of this type of function in go is <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow\">fmt.Println</a>:</p>\n\n<p>Its signature is:</p>\n\n<p><code>\nfunc Println(a ...interface{}) (n int, err error)\n</code></p>\n\n<p>so you can invoke it with a variable number of arguments:</p>\n\n<p><code>\nfmt.Println(1, 2)\nfmt.Println(\"a\" , \"b\" , \"C\")\n</code></p>\n"}, {"comments": [{"owner": {"reputation": 543, "user_id": 738469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30214ef3de01f84a911188cdd5fa0be3?s=128&d=identicon&r=PG", "display_name": "csoria", "link": "https://stackoverflow.com/users/738469/csoria"}, "edited": false, "score": 0, "creation_date": 1452282479, "post_id": 34684432, "comment_id": 57116139, "body": "Thanks! Now I understand"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1452281157, "last_edit_date": 1452281157, "creation_date": 1452280580, "answer_id": 34684432, "question_id": 34684265, "link": "https://stackoverflow.com/questions/34684265/is-this-a-block-argument/34684432#34684432", "title": "Is this a block argument?", "body": "<p>The block you see in <code>{ ... }</code> is just that, a code block, not an argument to anything. The <a href=\"https://godoc.org/github.com/gin-gonic/gin#RouterGroup.Group\" rel=\"nofollow\"><code>Group</code></a> method is variadic, and could accept any number of <code>HandlerFunc</code> arguments, but nothing is passed in here. </p>\n\n<p>Since Go is block scoped, you can use blocks to create a limited variable scope. Since there are no declarations within the blocks, I see no use for this pattern here other than to cause the <code>HandlerFunc</code> assignments to be indented as a group for style reasons. </p>\n\n<p>An example showing the scope of a code block:</p>\n\n<p><a href=\"http://play.golang.org/p/Kgpw1zCC7X\" rel=\"nofollow\">http://play.golang.org/p/Kgpw1zCC7X</a></p>\n\n<pre><code>x := 42\n\n{\n    x := 3\n    y := 4\n    fmt.Println(\"x inside block:\", x) // prints 3\n}\n\nfmt.Println(\"x outside block:\", x) // prints 42\n// fmt.Println(y) // undefined: y\n</code></pre>\n"}], "owner": {"reputation": 543, "user_id": 738469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30214ef3de01f84a911188cdd5fa0be3?s=128&d=identicon&r=PG", "display_name": "csoria", "link": "https://stackoverflow.com/users/738469/csoria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 2, "accepted_answer_id": 34684432, "answer_count": 2, "score": 1, "last_activity_date": 1452281157, "creation_date": 1452279920, "question_id": 34684265, "link": "https://stackoverflow.com/questions/34684265/is-this-a-block-argument", "title": "Is this a block argument?", "body": "<p>I started learning <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">Gin</a> recently and in the <a href=\"https://github.com/gin-gonic/gin/blob/master/README.md\" rel=\"nofollow\">README</a> file comes the following code:</p>\n\n<pre><code>v1 := router.Group(\"/v1\")\n{\n    v1.POST(\"/login\", loginEndpoint)\n    v1.POST(\"/submit\", submitEndpoint)\n    v1.POST(\"/read\", readEndpoint)\n}\n</code></pre>\n\n<p>I readed the <a href=\"https://github.com/gin-gonic/gin/blob/52fcc5dbf6e94df33ad313858fb94b713e9d1b4a/routergroup.go\" rel=\"nofollow\">source code</a> for the method <strong>Group</strong> and is like this:</p>\n\n<pre><code>IRouter interface {\n    IRoutes\n    Group(string, ...HandlerFunc) *RouterGroup\n}\n</code></pre>\n\n<p>Maybe I'm misunderstanding the syntaxis or missing something in the code (Im pretty new in Go) but it looks like it is passing a block as the second argument, is this possible in Go?</p>\n"}, {"tags": ["arrays", "go", "io", "deferred", "docker-machine"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1452276646, "creation_date": 1452276646, "answer_id": 34683438, "question_id": 34683261, "link": "https://stackoverflow.com/questions/34683261/go-how-to-read-the-contents-of-two-files-and-concatenate-to-a-string/34683438#34683438", "title": "Go : How to read the contents of two files and concatenate to a string", "body": "<p>In the example code, they first use <code>os.Open</code> to return an <code>io.Reader</code> for the file, they then defer the close (defered methods are invoked just before you leave the defering scope) in order to ensure their resources are cleaned up. In the next line they call <code>ioutil.ReadAll</code> which takes an <code>io.Reader</code> and returns a <code>[]byte, error</code>. If the error is non nil they just return it and an empty string. To get a string out of a []byte you can just do <code>s := string(myBytes)</code>.</p>\n\n<p>So to read your target file, you could just copy the form of the code above exactly. Better yet you could move it into a method and pass the filepath down to it so you can reuse it. One thing worth noting, there is an easier method to use in the <code>ioutil</code> package. I'm not sure if there is a good reason it wasn't used in the code above but rather than opening the file and passing an <code>io.Reader</code> to <code>ReadAll</code> you can just call <code>ioutil.ReadFile</code> passing it the path and it also returns a <code>[]byte, error</code>, after checking for an error you can just append one byte slice to the other, convert to a string and return it. It would look a little like this;</p>\n\n<pre><code>vmnetcontent, err := ioutil.ReadFile(\"/path/to/file.txt\")\n\nif err != nil {\n    return \"\", err\n}\n\nreturn string(append(vmxcontent, vmnetcontent)), nil\n</code></pre>\n"}], "owner": {"reputation": 584, "user_id": 2646250, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/K11K2.jpg?s=128&g=1", "display_name": "bryan hunt", "link": "https://stackoverflow.com/users/2646250/bryan-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1452504914, "creation_date": 1452276044, "last_edit_date": 1452504914, "question_id": 34683261, "link": "https://stackoverflow.com/questions/34683261/go-how-to-read-the-contents-of-two-files-and-concatenate-to-a-string", "title": "Go : How to read the contents of two files and concatenate to a string", "body": "<p>I'm trying to fix a bug in <a href=\"https://github.com/docker/machine/issues/2787\" rel=\"nofollow\">docker-machine</a>. The problem seems to be in it's vmware-fusion driver. When trying to resolve a machine by it's MAC address it consults the vmware dhcp leases file. Unfortunately, when you use a custom network (for example the private network vmnet2) the most recent dhcp lease will be in the file 'vmnet-dhcpd-vmnet2.leases' instead.</p>\n\n<p>Anyhow, my knowledge of go is non-existent.</p>\n\n<p>I'd like to implement something like (pseudocode):</p>\n\n<pre><code>var allText = \"\"\nfor i in \"/var/db/vmware/*.leases\"\n  do read i; allText = allText ++ i\ndone\n</code></pre>\n\n<p>The existing code <a href=\"https://github.com/docker/machine/blob/master/drivers/vmwarefusion/fusion_darwin.go#L464\" rel=\"nofollow\">(fusion_darwin.go)</a> looks like this:</p>\n\n<pre><code>// DHCP lease table for NAT vmnet interface\nvar dhcpfile = \"/var/db/vmware/vmnet-dhcpd-vmnet8.leases\"\n\nif vmxfh, err = os.Open(d.vmxPath()); err != nil {\n    return \"\", err\n}\ndefer vmxfh.Close()\n\nif vmxcontent, err = ioutil.ReadAll(vmxfh); err != nil {\n    return \"\", err\n}\n</code></pre>\n\n<p>I've created an issue etc, but if possible I'd like to learn a little more about Go along the way and contribute back whatever I can fix. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["linux", "go", "ssh", "cisco"], "comments": [{"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 1, "creation_date": 1452265965, "post_id": 34678633, "comment_id": 57105768, "body": "Naive question: can you successfully call <code>ssh admin@10.0.0.1:22 show environment all</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452265991, "post_id": 34678633, "comment_id": 57105794, "body": "Have you tried reading stderr too (or <code>s.CombinedOutput</code>)? Can you exec a command in this manner with openssh? (it&#39;s been a long time since I used IOS, and I can&#39;t remember if there&#39;s a way to enforce interactive only sessions)?"}, {"owner": {"reputation": 3099, "user_id": 1595320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7394f8a600a66b2dfaf6613fd32f8fc?s=128&d=identicon&r=PG", "display_name": "Riscie", "link": "https://stackoverflow.com/users/1595320/riscie"}, "reply_to_user": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 0, "creation_date": 1452266357, "post_id": 34678633, "comment_id": 57106088, "body": "Hey @kopiczko. Not sure if I understand correctly. I can ssh into the switch and run the command, but that&#39;s not what you mean, right?"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1452266385, "post_id": 34678633, "comment_id": 57106110, "body": "@Riscie yes that is what he means"}, {"owner": {"reputation": 3099, "user_id": 1595320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7394f8a600a66b2dfaf6613fd32f8fc?s=128&d=identicon&r=PG", "display_name": "Riscie", "link": "https://stackoverflow.com/users/1595320/riscie"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452266404, "post_id": 34678633, "comment_id": 57106125, "body": "@JimB I tried to read from stderr too, but there is also nothing which arrives. I will try openssh now..."}, {"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 0, "creation_date": 1452266435, "post_id": 34678633, "comment_id": 57106153, "body": "@Riscie simply copy&amp;paste grey text and hit enter in your shell and tell what happened. (also enter &#39;mypassword&#39; for password prompt)"}, {"owner": {"reputation": 3099, "user_id": 1595320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7394f8a600a66b2dfaf6613fd32f8fc?s=128&d=identicon&r=PG", "display_name": "Riscie", "link": "https://stackoverflow.com/users/1595320/riscie"}, "reply_to_user": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 0, "creation_date": 1452266596, "post_id": 34678633, "comment_id": 57106278, "body": "Thank you @kopiczko I think you are right here. It does not return, just like in my code... so this seems to be related to the cisco device. Any ideas why this is the case?"}, {"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 1, "creation_date": 1452266691, "post_id": 34678633, "comment_id": 57106361, "body": "So this is the answer: the code doesn&#39;t work because you have sth broken with your ssh config. Try to search for authentication methods order or something like that."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1452266955, "post_id": 34678633, "comment_id": 57106533, "body": "run the ssh command with <code>-vvv</code> and see what it&#39;s doing when it hangs."}, {"owner": {"reputation": 3099, "user_id": 1595320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7394f8a600a66b2dfaf6613fd32f8fc?s=128&d=identicon&r=PG", "display_name": "Riscie", "link": "https://stackoverflow.com/users/1595320/riscie"}, "edited": false, "score": 0, "creation_date": 1452267481, "post_id": 34678633, "comment_id": 57106885, "body": "ok, had the -vvv at the wrong place, i have something to debug now... See the edit"}, {"owner": {"reputation": 3099, "user_id": 1595320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7394f8a600a66b2dfaf6613fd32f8fc?s=128&d=identicon&r=PG", "display_name": "Riscie", "link": "https://stackoverflow.com/users/1595320/riscie"}, "edited": false, "score": 0, "creation_date": 1452268658, "post_id": 34678633, "comment_id": 57107714, "body": "So this command works and returns: echo &quot;show environment all&quot; | ssh admin@10.0.0.1 -tt which means this has to do with the tty?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452275712, "post_id": 34678633, "comment_id": 57112441, "body": "Maybe look up how to enable <code>scp</code> in IOS? It&#39;s also sent as an command to exec without a shell."}], "owner": {"reputation": 3099, "user_id": 1595320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7394f8a600a66b2dfaf6613fd32f8fc?s=128&d=identicon&r=PG", "display_name": "Riscie", "link": "https://stackoverflow.com/users/1595320/riscie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 737, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1459830364, "creation_date": 1452260975, "last_edit_date": 1459830364, "question_id": 34678633, "link": "https://stackoverflow.com/questions/34678633/using-gos-crypto-ssh-to-run-commands-on-a-cisco-switch", "title": "Using Go&#39;s crypto/ssh to run commands on a cisco switch", "body": "<p>I'm trying to run commands over ssh on a cisco switch and print the result to the console. <strong>I have successfully done this with a debian linux server</strong>. On the cisco switch however the execution of the command blocks the main function and it never finishes.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"golang.org/x/crypto/ssh\"\n)\n\nfunc main(){\n    // Client configuration\n    config := &amp;ssh.ClientConfig{\n        User: \"admin\",\n        Auth: []ssh.AuthMethod{\n            ssh.Password(\"mypassword\"),\n        },\n    }\n    //Connection\n    fmt.Println(\"Connecting...\")\n    client, err := ssh.Dial(\"tcp\", \"10.0.0.1:22\", config)\n    if err != nil {\n        panic(\"Failed to dial: \" + err.Error())\n    }\n    fmt.Println(\"Connected...\")\n\n    //Session\n    fmt.Println(\"Creating Session...\")\n    session, err := client.NewSession()\n    if err != nil {\n        panic(\"Failed to create session: \" + err.Error())\n    }\n    fmt.Println(\"Session created...\")\n    defer session.Close()\n\n    // Execute a single command \n    var b bytes.Buffer\n    session.Stdout = &amp;b\n    fmt.Println(\"Running command...\")\n    if err := session.Run(\"show environment all\"); err != nil {\n        panic(\"Failed to run: \" + err.Error())\n    }\n\n    fmt.Println(\"Command run: Output:\", b.String())\n}\n</code></pre>\n\n<p>Return (hangs at session.Run() ) :</p>\n\n<pre><code>Connecting...\nConnected...\nCreating Session...\nSession created...\nRunning command...\n</code></pre>\n\n<p>I am fishing in the dark at the moment. Any help is appreciated!\nThank you!</p>\n\n<p><strong>Edit:</strong>\nI know that my program hangs exactly here:</p>\n\n<pre><code>if err := &lt;-s.errors; err != nil &amp;&amp; copyError == nil {\n        copyError = err\n}\n</code></pre>\n\n<p>within the Wait() function of Go's x/crypto/ssh package (session.go). I am however not sure why. Seems like at this point we are waiting to get an error from the sessions errors-channel. But at this point my go skills leave me hanging...</p>\n\n<p><strong>Edit 2:</strong>\nWhen I run my code, my CISCO switch tells me the following in the log.</p>\n\n<pre><code>SWU-ACS-02#26-May-2015 19:07:50 %AAA-I-CONNECT: User CLI session for user admin over ssh , source 10.0.0.2 destination  10.0.0.1 ACCEPTED, aggregated (1)\n26-May-2015 19:08:09 %AAA-I-CONNECT: User CLI session for user admin over ssh , source 10.0.0.2 destination  10.0.0.1 ACCEPTED\n</code></pre>\n\n<p><strong>Edit 3:</strong>\nThis is the output of ssh with the most verbose option (-vvv)</p>\n\n<pre><code>admin@10.0.0.1's password:\ndebug3: packet_send2: adding 48 (len 61 padlen 19 extra_pad 64)\ndebug2: we sent a password packet, wait for reply\ndebug1: Authentication succeeded (password).\nAuthenticated to 10.0.0.1 ([10.0.0.1]:22).\ndebug1: channel 0: new [client-session]\ndebug3: ssh_session2_open: channel_new: 0\ndebug2: channel 0: send open\ndebug1: Requesting no-more-sessions@openssh.com\ndebug1: Entering interactive session.\ndebug2: callback start\ndebug2: client_session2_setup: id 0\ndebug2: fd 3 setting TCP_NODELAY\ndebug3: packet_set_tos: set IP_TOS 0x08\ndebug1: Sending environment.\ndebug3: Ignored env TERM\ndebug3: Ignored env SHELL\ndebug3: Ignored env XDG_SESSION_COOKIE\ndebug3: Ignored env SSH_CLIENT\ndebug3: Ignored env SSH_TTY\ndebug3: Ignored env USER\ndebug3: Ignored env LS_COLORS\ndebug3: Ignored env MAIL\ndebug3: Ignored env PATH\ndebug3: Ignored env PWD\ndebug1: Sending env LANG = en_US.UTF-8\ndebug2: channel 0: request env confirm 0\ndebug3: Ignored env SHLVL\ndebug3: Ignored env HOME\ndebug3: Ignored env LANGUAGE\ndebug3: Ignored env LS_OPTIONS\ndebug3: Ignored env LOGNAME\ndebug3: Ignored env SSH_CONNECTION\ndebug3: Ignored env _\ndebug1: Sending command: show environment all\ndebug2: channel 0: request exec confirm 1\ndebug2: callback done\ndebug2: channel 0: open confirm rwindow 256 rmax 128\ndebug2: channel_input_status_confirm: type 99 id 0\ndebug2: exec request accepted on channel 0\n</code></pre>\n"}, {"tags": ["networking", "go", "https", "get", "network-programming"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1452267013, "post_id": 34678564, "comment_id": 57106580, "body": "if you can use telnet, it&#39;s not HTTPS."}], "answers": [{"tags": [], "owner": {"reputation": 1222, "user_id": 220175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ctrdn.jpg?s=128&g=1", "display_name": "Bera", "link": "https://stackoverflow.com/users/220175/bera"}, "is_accepted": true, "score": 1, "last_activity_date": 1452794989, "creation_date": 1452794989, "answer_id": 34796742, "question_id": 34678564, "link": "https://stackoverflow.com/questions/34678564/net-http-get-request-error-tls-oversized-record-received-with-length-20527/34796742#34796742", "title": "net/http GET request error tls oversized record received with length 20527", "body": "<p>I'm glad to share with you that I reach the needed implementation.</p>\n\n<p>The code bellow works! </p>\n\n<p>Thanks for your comments that guide me to the right approach for this task:</p>\n\n<pre><code>package main\n\n\nimport (\n \"bufio\"\n \"crypto/tls\"\n \"fmt\"\n \"io/ioutil\"\n \"net\"\n \"net/http\"\n \"os\"\n)\n\n\nfunc main() {\n\n\n cmdSecSMS := \"GET https://10.xxx.xx.x:xx43/httpgw.conf?\" +\n \"Type=SMS&amp;Address=5511111&amp;MsgID=123&amp;Notify=N&amp;Validity=24:00&amp;OAdC=15555&amp;\" +\n \"Message=blablah \" +\n \"HTTP/1.1\"\n\n\n fmt.Println(cmdSecSMS)\n cmdSecUrlSMS := cmdSecSMS\n hostName := \"10.xxx.xx.x\"\n portNum := \"xx43\"\n\n doDial(cmdSecUrlSMS, hostName, portNum)\n\n //doClientTrans(cmdSecUrlSMS)\n\n //doGetClient(cmdSecUrlSMS)\n\n //doGet(cmdSecUrlSMS)\n\n}\n\n\nfunc doDial(cmd, host, port string) {\n // connect to this socket\n conn, err := net.Dial(\"tcp\", host+\":\"+port)\n\n\n if err != nil {\n fmt.Printf(\"Some error %v\", err)\n return\n } else {\n defer conn.Close()\n fmt.Printf(\"Connection established between %s and localhost.\\n\", host)\n fmt.Printf(\"Local Address : %s \\n\", conn.LocalAddr().String())\n fmt.Printf(\"Remote Address : %s \\n\", conn.RemoteAddr().String())\n\n\n // send to socket\n fmt.Fprintf(conn, cmd+\"\\n\")\n // listen for reply\n message, _ := bufio.NewReader(conn).ReadString('\\n')\n fmt.Print(\"Message from server: \" + message)\n }\n</code></pre>\n\n<p>}</p>\n\n<p>Thank you guys for your support!</p>\n"}], "owner": {"reputation": 1222, "user_id": 220175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ctrdn.jpg?s=128&g=1", "display_name": "Bera", "link": "https://stackoverflow.com/users/220175/bera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1448, "favorite_count": 0, "accepted_answer_id": 34796742, "answer_count": 1, "score": 0, "last_activity_date": 1452794989, "creation_date": 1452260744, "last_edit_date": 1452268936, "question_id": 34678564, "link": "https://stackoverflow.com/questions/34678564/net-http-get-request-error-tls-oversized-record-received-with-length-20527", "title": "net/http GET request error tls oversized record received with length 20527", "body": "<p>I'm stucking  to perform a get request using Golang and I also have tried three distinct implementations without success. For all them I'm receiving this error message:</p>\n\n<p><strong>Get <a href=\"https://11.11.11.1:0000/httpgw.conf?Type=SMS&amp;Address=12345678&amp;MsgID=12\" rel=\"nofollow noreferrer\">https://11.11.11.1:0000/httpgw.conf?Type=SMS&amp;Address=12345678&amp;MsgID=12</a>\n3&amp;Notify=N&amp;Validity=24:00&amp;OAdC=15555&amp;Message=HelloBrother: tls: oversized recor\nd received with length 20527</strong></p>\n\n<p>Bellow is the entire source code that I'm working on:</p>\n\n<pre><code>    package main\n\nimport (\n    \"crypto/tls\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n)\n\nfunc main() {\n\n    cmdSecSMS := \"https://11.11.11.1:0000/httpgw.conf?Type=SMS&amp;Address=12345678&amp;MsgID=123&amp;Notify=N&amp;Validity=24:00&amp;OAdC=15555&amp;Message=\"\n    msg := \"HelloBrother\"\n    cmdSecUrlSMS := cmdSecSMS + msg\n\n    doClientTrans(cmdSecUrlSMS)\n\n    doGetClient(cmdSecUrlSMS)\n\n    doGet(cmdSecUrlSMS)\n}\n\nfunc doClientTrans(address string) {\n    tr := &amp;http.Transport{\n        TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n    }\n\n    client := &amp;http.Client{Transport: tr}\n\n    response, err := client.Get(address)\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    } else {\n        defer response.Body.Close()\n        contents, err := ioutil.ReadAll(response.Body)\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(1)\n        }\n        fmt.Printf(\"%s\\n\", string(contents))\n        fmt.Println(\" Size: \", len(string(contents)), \" url: \", address)\n        fmt.Println(\" Status Code:  \", response.StatusCode)\n        hdr := response.Header\n        for key, value := range hdr {\n            fmt.Println(\" \", key, \":\", value)\n        }\n    }\n}\n\nfunc doGet(url string) {\n    response, err := http.Get(url)\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    } else {\n        defer response.Body.Close()\n        contents, err := ioutil.ReadAll(response.Body)\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(1)\n        }\n        fmt.Println(\" Size: \", len(string(contents)), \" url: \", url)\n        fmt.Println(\" Status Code:  \", response.StatusCode)\n        hdr := response.Header\n        for key, value := range hdr {\n            fmt.Println(\" \", key, \":\", value)\n        }\n    }\n}\n\nfunc doGetClient(url string) {\n    client := &amp;http.Client{}\n\n    response, err := client.Get(url)\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    } else {\n        defer response.Body.Close()\n        contents, err := ioutil.ReadAll(response.Body)\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(1)\n        }\n        fmt.Println(\" Size: \", len(string(contents)), \" url: \", url)\n        fmt.Println(\" Status Code: \", response.StatusCode)\n        hdr := response.Header\n        for key, value := range hdr {\n            fmt.Println(\" \", key, \":\", value)\n        }\n    }\n}\n</code></pre>\n\n<p>When using telnet, this GET request works normally:</p>\n\n<p>telnet 11.11.11.1 0000</p>\n\n<p>Get <a href=\"https://11.11.11.1:0000/httpgw.conf?Type=SMS&amp;Address=12345678&amp;MsgID=12\" rel=\"nofollow noreferrer\">https://11.11.11.1:0000/httpgw.conf?Type=SMS&amp;Address=12345678&amp;MsgID=12</a>\n3&amp;Notify=N&amp;Validity=24:00&amp;OAdC=15555&amp;Message=HelloBrother HTTP/1.1</p>\n\n<p>^:\nexit </p>\n\n<p><a href=\"https://i.stack.imgur.com/IghmM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IghmM.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm running the golang app in the windows server 2012 and I don't know nothing about the server tech stack.</p>\n\n<p>It's possible to fix this issue? There is a configuration workaround or something else that I can try?</p>\n\n<p>thanks for your help</p>\n"}, {"tags": ["go", "server", "client", "client-server"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1452253375, "post_id": 34674052, "comment_id": 57097334, "body": "This isn&#39;t a go issue, you can&#39;t bind multiple sockets to the same address. Why does the client need a listener, and what exactly are you trying to do?"}, {"owner": {"reputation": 4341, "user_id": 4572536, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/91d825b498c552b821ccc3314ddd8929?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndArtist", "link": "https://stackoverflow.com/users/4572536/devandartist"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452253780, "post_id": 34674052, "comment_id": 57097594, "body": "I need to build a network were clients will represent some graph (like a p2p network but not every client knows every other client). First all clients will connect to the server, the server will create the graph and then send the clients the id and network address of their neighbor clients. This is why I want my clients to be able to listen. I could use two ports for the clients (one for the connection to the client and the second for listening), but I thoughts it would be better to use a single address/port."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452257598, "post_id": 34674052, "comment_id": 57100101, "body": "That&#39;s fine, but you still can&#39;t dial from the same address you&#39;ve bound to the listener. There&#39;s no problem using 2 ports."}, {"owner": {"reputation": 4341, "user_id": 4572536, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/91d825b498c552b821ccc3314ddd8929?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndArtist", "link": "https://stackoverflow.com/users/4572536/devandartist"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452257777, "post_id": 34674052, "comment_id": 57100220, "body": "Im still confused why does the opposite work? I can tell the listener to listen on an address I used the dialer."}, {"owner": {"reputation": 4341, "user_id": 4572536, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/91d825b498c552b821ccc3314ddd8929?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndArtist", "link": "https://stackoverflow.com/users/4572536/devandartist"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452261273, "post_id": 34674052, "comment_id": 57102548, "body": "Ok I think I&#39;ll go with the two ports solution and transmit the addresses for the listeners which the server will forward to the clients."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1452267872, "creation_date": 1452267872, "answer_id": 34680813, "question_id": 34674052, "link": "https://stackoverflow.com/questions/34674052/go-why-does-dialing-from-the-address-on-which-the-client-is-listening-not-work/34680813#34680813", "title": "GO: Why does dialing from the address on which the client is listening not work, but the opposite does?", "body": "<p>\"Version B\" works as a side effect of the Go's POSIX default of setting <code>SO_REUSEADDR</code>, which will allow binding to an <code>addr:port</code> pair even if it's in use by an existing connection. The 2 sockets can be differentiated, because the established connection is identified by the 4-tuple of <code>(LocalAddr, LocalPort, RemoteAddr, RemotePort)</code>. </p>\n\n<p>\"Version A\" doesn't work, because when setting up the connection it needs to call <code>bind</code> to set the requested local address, and there is already a listening socket bound to that port.</p>\n\n<p>There's no need to try and exploit this loophole, and you should use 2 ports for your client and server connections. </p>\n"}], "owner": {"reputation": 4341, "user_id": 4572536, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/91d825b498c552b821ccc3314ddd8929?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndArtist", "link": "https://stackoverflow.com/users/4572536/devandartist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "accepted_answer_id": 34680813, "answer_count": 1, "score": 1, "last_activity_date": 1452267872, "creation_date": 1452246823, "last_edit_date": 1452247142, "question_id": 34674052, "link": "https://stackoverflow.com/questions/34674052/go-why-does-dialing-from-the-address-on-which-the-client-is-listening-not-work", "title": "GO: Why does dialing from the address on which the client is listening not work, but the opposite does?", "body": "<p>I wonder why dialing from the address on which the client is also listening does not work (<strong><code>Version A</code></strong>) but listening on the connection address the client is dialing to the server does actually work (<strong><code>Version B</code></strong>)?!</p>\n\n<p>Can someone explain this to me. <code>Go</code> is new to me and I still learning a lot of things.</p>\n\n<p>Here is an example:</p>\n\n<p>Server Programm:</p>\n\n<pre><code>package main\n\nimport . \"fmt\"\nimport \"net\"\nimport \"os\"\n\nfunc main() {\n    Println(\"server\")\n\n    var listener, listenerError = net.Listen(\"tcp\", \"localhost:8080\")\n\n    if listenerError != nil {\n\n        Println(listenerError)\n        os.Exit(1)\n    }\n\n    for {\n        con, _ := listener.Accept() // I don't care about the error in this example\n        Printf(\"LocalAddr: %v\\n\", con.LocalAddr())\n        Printf(\"RemoteAddr: %v\\n\", con.RemoteAddr())\n    }\n}\n</code></pre>\n\n<p>Client version A (not working):</p>\n\n<pre><code>package main\n\nimport \"net\"\nimport . \"fmt\"\nimport \"os\"\n\nfunc main() {\n\n    var listener, listenerError = net.Listen(\"tcp\", \"localhost:0\")\n\n    if listenerError != nil {\n\n        Println(listenerError)\n        os.Exit(1)\n    }\n\n    var dialer = new(net.Dialer)\n    dialer.LocalAddr = listener.Addr()\n\n    con, err := dialer.Dial(\"tcp\", \"localhost:8080\")\n    if err != nil {\n\n        // dial tcp 127.0.0.1:60229-&gt;127.0.0.1:8080: bind: address already in use\n        Println(err)\n        os.Exit(2)\n    }\n\n    Printf(\"LocalAddr: %v\\n\", con.LocalAddr())\n    Printf(\"RemoteAddr: %v\\n\", con.RemoteAddr())\n}\n</code></pre>\n\n<p>Client version B (working):</p>\n\n<pre><code>package main\n\nimport \"net\"\nimport . \"fmt\"\nimport \"os\"\n\nfunc main() {\n    Println(\"client\")\n\n    con, err := net.Dial(\"tcp\", \"localhost:8080\")\n    if err != nil {\n\n        Println(err)\n        os.Exit(2)\n    }\n\n    // magic happens here\n    var listener, listenerError = net.Listen(\"tcp\", con.LocalAddr().String())\n\n    if listenerError != nil {\n\n        Println(listenerError)\n        os.Exit(1)\n    }\n\n    Println(\"LISTENING\")\n    conn, _ := listener.Accept() // will accept on con.LocalAddr()\n    Printf(\"LocalAddr: %v\\n\", conn.LocalAddr())\n    Printf(\"RemoteAddr: %v\\n\", conn.RemoteAddr())\n}\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1452244231, "post_id": 34673039, "comment_id": 57091517, "body": "Did you read the text immediately above the example code?"}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1452244266, "post_id": 34673039, "comment_id": 57091530, "body": "Yes, I read. But I still don&#39;t understand how the expansion works."}], "answers": [{"comments": [{"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1452245596, "post_id": 34673395, "comment_id": 57092317, "body": "Thanks. Can you explain the second result a bit more?"}, {"owner": {"reputation": 2688, "user_id": 3510933, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc3f40b949ebd1152ba582d5f284fa33?s=128&d=identicon&r=PG", "display_name": "trquoccuong", "link": "https://stackoverflow.com/users/3510933/trquoccuong"}, "reply_to_user": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1452245784, "post_id": 34673395, "comment_id": 57092431, "body": "Ok,$name all character after $ is name, so there are no replace key =&gt; replace key = null, if not find group name it will use default regex a(x*)b and replace with null key"}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1452247850, "post_id": 34673395, "comment_id": 57093773, "body": "Thank you for getting me educated about the named group."}], "tags": [], "owner": {"reputation": 2688, "user_id": 3510933, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc3f40b949ebd1152ba582d5f284fa33?s=128&d=identicon&r=PG", "display_name": "trquoccuong", "link": "https://stackoverflow.com/users/3510933/trquoccuong"}, "is_accepted": false, "score": 1, "last_activity_date": 1452244951, "creation_date": 1452244951, "answer_id": 34673395, "question_id": 34673039, "link": "https://stackoverflow.com/questions/34673039/go-replaceallstring/34673395#34673395", "title": "Go ReplaceAllString", "body": "<p>$number or $name is  index of subgroup in regex or subgroup name</p>\n\n<pre><code>fmt.Println(re.ReplaceAllString(\"-ab-axxb-\", \"$1\"))\n</code></pre>\n\n<p>$1 is subgroup 1 in regex = <code>x*</code></p>\n\n<pre><code>fmt.Println(re.ReplaceAllString(\"-ab-axxb-\", \"$1W\"))\n</code></pre>\n\n<p>$1W no subgroup name 1W => Replace all with null  </p>\n\n<pre><code>fmt.Println(re.ReplaceAllString(\"-ab-axxb-\", \"${1}W\"))\n</code></pre>\n\n<p>$1 and ${1} is the same. replace all subgroup 1  with W</p>\n\n<p>for more information : <a href=\"https://golang.org/pkg/regexp/\" rel=\"nofollow\">https://golang.org/pkg/regexp/</a></p>\n"}, {"comments": [{"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1452246614, "post_id": 34673433, "comment_id": 57092962, "body": "So can I understand as that the replacement is dynamic for each match?"}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1452247822, "post_id": 34673433, "comment_id": 57093756, "body": "Thank you. You answer helped me to understand the second output."}, {"owner": {"reputation": 2437, "user_id": 4102515, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31b3a2bfa392f631bc24a7c1dce899b9?s=128&d=identicon&r=PG", "display_name": "snorberhuis", "link": "https://stackoverflow.com/users/4102515/snorberhuis"}, "edited": false, "score": 0, "creation_date": 1498313815, "post_id": 34673433, "comment_id": 76456127, "body": "We are not writing a math book here with leaving stuff as an exercise."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1452245102, "creation_date": 1452245102, "answer_id": 34673433, "question_id": 34673039, "link": "https://stackoverflow.com/questions/34673039/go-replaceallstring/34673433#34673433", "title": "Go ReplaceAllString", "body": "<p><code>$1</code> is a shorthand for <code>${1}</code></p>\n\n<p><code>${1}</code> is the value of the first (1) group, e.g. the content of the first pair of (). This group is <code>(x*)</code> i.e. any number of <code>x</code>.</p>\n\n<p><code>ReplaceAllString</code> replaces every match. There are two matches. The first is <code>ab</code>, the second is <code>axxb</code>.</p>\n\n<p>No 2. replaces any match with the content of the group: This is \"\" in the first match and \"xx\" in the second.</p>\n\n<p>No 4. adds a \"W\" after the content of the group.</p>\n\n<p>No 3. Is left as an exercise. Hint: The twelfth capturing group would be $12.</p>\n"}, {"comments": [{"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1452246163, "post_id": 34673443, "comment_id": 57092653, "body": "What did you mean by <code>this group is not initialized</code>? How to initialize a group? I&#39;m sorry my question might be na&#239;ve."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1452246364, "post_id": 34673443, "comment_id": 57092785, "body": "The group is not specified in the regex pattern, thus, it was not <i>populated</i> during the match operation. Replacing means getting all matches and then they are replaced with the replacement pattern. <i>Backreferences</i> (<code>$xx</code> constructs) are populated during the <i>matching</i> phase. The <code>$1W</code> group is missing in the pattern, thus, it was not populated during matching, and only an empty string is used when replacing phase occurs."}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1452246466, "post_id": 34673443, "comment_id": 57092856, "body": "What should be done to make $1W present if I want? I&#39;m trying to get educated about the named group."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 1, "creation_date": 1452246666, "post_id": 34673443, "comment_id": 57092996, "body": "Use <code>re := regexp.MustCompile(&quot;a(?P&lt;1W&gt;x*)b&quot;)</code>, then, you will have the same result with lines 2 and 3. I updated the answer with it."}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1452246770, "last_edit_date": 1592644375, "creation_date": 1452245121, "answer_id": 34673443, "question_id": 34673039, "link": "https://stackoverflow.com/questions/34673039/go-replaceallstring/34673443#34673443", "title": "Go ReplaceAllString", "body": "<p>The most intriguing is the <code>fmt.Println(re.ReplaceAllString(&quot;-ab-axxb-&quot;, &quot;$1W&quot;))</code> line. The <a href=\"https://golang.org/pkg/regexp/#example_Regexp_ReplaceAllString\" rel=\"nofollow noreferrer\">docs say</a>:</p>\n<blockquote>\n<p>Inside repl, <code>$</code> signs are interpreted as in <code>Expand</code></p>\n</blockquote>\n<p>And <a href=\"https://golang.org/pkg/regexp/#Regexp.Expand\" rel=\"nofollow noreferrer\">Expand</a> says:</p>\n<blockquote>\n<p>In the template, a variable is denoted by a substring of the form <code>$name</code> or <code>${name}</code>, where name is a non-empty sequence of letters, digits, and underscores.\n<strong>A reference to an out of range or unmatched index or a name that is not present in the regular expression is replaced with an empty slice.</strong></p>\n<p><strong>In the <code>$name</code> form, name is taken to be as long as possible: <code>$1x</code> is equivalent to <code>${1x}</code>, not <code>${1}x</code>, and, <code>$10</code> is equivalent to <code>${10}</code>, not <code>${1}0</code>.</strong></p>\n</blockquote>\n<p>So, in the 3rd replacement, <code>$1W</code> is treated as <code>${1W}</code> and since this group is not initialized, an empty string is used for replacement.</p>\n<p>When I say &quot;the group is not initialized&quot;, I mean to say that the group is not defined in the regex pattern, thus, it was not populated during the <em>match</em> operation. <em>Replacing</em> means getting all matches and then they are replaced with the replacement pattern. <em>Backreferences</em> (<code>$xx</code> constructs) are populated during the <em>matching</em> phase. The <code>$1W</code> group is missing in the pattern, thus, it was not populated during <em>matching</em>, and only an empty string is used when <em>replacing</em> phase occurs.</p>\n<p>The 2nd and 4th replacements are easy to understand and have been described in the above answers. Just <code>$1</code> backreferences the characters <em>captured</em> with the first capturing group (the subpattern enclosed with a pair of unescaped parentheses), same is with Example 4.</p>\n<p><strong>You can think of <code>{}</code> as a means to <em>disambiguate</em> the replacement pattern.</strong></p>\n<p>Now, if you need to make the results consistent, use a <strong>named capture</strong> <code>(?P&lt;1W&gt;....)</code>:</p>\n<pre><code>re := regexp.MustCompile(&quot;a(?P&lt;1W&gt;x*)b&quot;)  // &lt;= See here, pattern updated\nfmt.Println(re.ReplaceAllString(&quot;-ab-axxb-&quot;, &quot;T&quot;))\nfmt.Println(re.ReplaceAllString(&quot;-ab-axxb-&quot;, &quot;$1&quot;))\nfmt.Println(re.ReplaceAllString(&quot;-ab-axxb-&quot;, &quot;$1W&quot;))\nfmt.Println(re.ReplaceAllString(&quot;-ab-axxb-&quot;, &quot;${1}W&quot;))\n</code></pre>\n<p>Results:</p>\n<pre><code>-T-T-\n--xx-\n--xx-\n-W-xxW-\n</code></pre>\n<p>The 2nd and 3rd lines now produce consistent output since the named group <code>1W</code> is also <em>the first</em> group, and <code>$1</code> numbered backreference points to the same text captured with a named capture <code>$1W</code>.</p>\n"}], "owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4254, "favorite_count": 2, "accepted_answer_id": 34673443, "answer_count": 3, "score": 4, "last_activity_date": 1459894901, "creation_date": 1452243723, "last_edit_date": 1459894901, "question_id": 34673039, "link": "https://stackoverflow.com/questions/34673039/go-replaceallstring", "title": "Go ReplaceAllString", "body": "<p>I read the example code from <a href=\"https://golang.org/pkg/regexp/#example_Regexp_ReplaceAllString\" rel=\"nofollow\">golang.org website</a>. Essentially the code looks like this:</p>\n\n<pre><code>re := regexp.MustCompile(\"a(x*)b\")\nfmt.Println(re.ReplaceAllString(\"-ab-axxb-\", \"T\"))\nfmt.Println(re.ReplaceAllString(\"-ab-axxb-\", \"$1\"))\nfmt.Println(re.ReplaceAllString(\"-ab-axxb-\", \"$1W\"))\nfmt.Println(re.ReplaceAllString(\"-ab-axxb-\", \"${1}W\"))\n</code></pre>\n\n<p>The output is like this:</p>\n\n<pre><code>-T-T-\n--xx-\n---\n-W-xxW-\n</code></pre>\n\n<p>I understand the first output, but I don't understand the the rest three. Can someone explain to me the results 2,3 and 4. Thanks.</p>\n"}, {"tags": ["go", "network-programming", "ip", "subnet", "netmask"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 1, "creation_date": 1452245658, "post_id": 34672725, "comment_id": 57092354, "body": "I think you are looking for <a href=\"https://golang.org/pkg/net/#IPMask.Size\" rel=\"nofollow noreferrer\">golang.org/pkg/net/#IPMask.Size</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "is_accepted": true, "score": 2, "last_activity_date": 1452247115, "creation_date": 1452247115, "answer_id": 34674157, "question_id": 34672725, "link": "https://stackoverflow.com/questions/34672725/converting-netmask-number-to-32-bit-in-golang/34674157#34674157", "title": "Converting netmask number to 32 bit in golang", "body": "<p>Borrowed from some stackoverflow post itself, using logical operators.</p>\n\n<pre><code>mask = (0xFFFFFFFF &lt;&lt; (32 - 24)) &amp; 0xFFFFFFFF; //24 is the netmask\nvar dmask uint64\ndmask = 32\nlocalmask := make([]uint64, 0, 4)\nfor i := 1; i &lt;= 4; i++{\n    tmp := mask &gt;&gt; (dmask - 8) &amp; 0xFF\n    localmask = append(localmask, tmp)\n    dmask -= 8\n}\n\nfmt.Println(localmask)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "edited": false, "score": 0, "creation_date": 1452248662, "post_id": 34674422, "comment_id": 57094294, "body": "Could you kindly explain this as an inline comment?"}, {"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "reply_to_user": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "edited": false, "score": 0, "creation_date": 1452250265, "post_id": 34674422, "comment_id": 57095322, "body": "I just extracted two functions to make the code cleaner. Notice that <code>net.Mask</code> is defined as <code>type IPMask []byte</code> so it may be more useful in this form."}], "tags": [], "owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "is_accepted": false, "score": 4, "last_activity_date": 1452250458, "last_edit_date": 1452250458, "creation_date": 1452247929, "answer_id": 34674422, "question_id": 34672725, "link": "https://stackoverflow.com/questions/34672725/converting-netmask-number-to-32-bit-in-golang/34674422#34674422", "title": "Converting netmask number to 32 bit in golang", "body": "<pre><code>func main() {\n    ifaces, err := net.Interfaces()\n    if err != nil {\n        panic(err)\n    }\n    for _, iface := range ifaces {\n        addrs, _ := iface.Addrs()\n        for _, addr := range addrs {\n            cidr := addr.String()\n            mask, err := mask(cidr)\n            if err != nil {\n                fmt.Println(\"extracting mask failed:\", err)\n            }\n            i, err := mtoi(mask)\n            if err != nil {\n                fmt.Println(\"creating uint16 from mask failed:\", err)\n            }\n            fmt.Printf(\"CIDR: %s\\tMask: %d\\n\", cidr, i)\n        }\n    }\n}\n\n// Extracts IP mask from CIDR address.\nfunc mask(cidr string) (net.IPMask, error) {\n    _, ip, err := net.ParseCIDR(cidr)\n    return ip.Mask, err\n}\n\n// Converts IP mask to 16 bit unsigned integer.\nfunc mtoi(mask net.IPMask) (uint16, error) {\n    var i uint16\n    buf := bytes.NewReader(mask)\n    err := binary.Read(buf, binary.BigEndian, &amp;i)\n    return i, err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "is_accepted": false, "score": 1, "last_activity_date": 1452249271, "creation_date": 1452249271, "answer_id": 34674869, "question_id": 34672725, "link": "https://stackoverflow.com/questions/34672725/converting-netmask-number-to-32-bit-in-golang/34674869#34674869", "title": "Converting netmask number to 32 bit in golang", "body": "<p>You could implement a function like:</p>\n\n<pre><code>func parseMask(ipaddr string) (mask string, err error) {\n    removeExtra := regexp.MustCompile(\"^(.*[\\\\/])\")\n    asd := ipaddr[len(ipaddr)-3:]\n    findSubnet := removeExtra.ReplaceAll([]byte(asd), []byte(\"\"))\n    subnet, err := strconv.ParseInt(string(findSubnet), 10, 64)\n    if err != nil {\n        return \"\", errors.New(\"Parse Mask: Error parsing mask\")\n    }\n    var buff bytes.Buffer\n    for i := 0; i &lt; int(subnet); i++ {\n        buff.WriteString(\"1\")\n    }\n    for i := subnet; i &lt; 32; i++ {\n        buff.WriteString(\"0\")\n    }\n    masker := buff.String()\n    a, _ := strconv.ParseUint(masker[:8], 2, 64)\n    b, _ := strconv.ParseUint(masker[8:16], 2, 64)\n    c, _ := strconv.ParseUint(masker[16:24], 2, 64)\n    d, _ := strconv.ParseUint(masker[24:32], 2, 64)\n    resultMask := fmt.Sprintf(\"%v.%v.%v.%v\", a, b, c, d)\n    return resultMask, nil\n}\n</code></pre>\n\n<p>and then call it:</p>\n\n<pre><code>func main() {\n    ifaces, _ := net.Interfaces()\n    for _, iface := range ifaces {\n        localip, _ := iface.Addrs()\n        for _, ip := range localip {\n            done, _ := parseMask(ip.String())\n            log.Println(done) // 255.255.255.0\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8935593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c7938327b99413c3723bce9459c3c7?s=128&d=identicon&r=PG&f=1", "display_name": "Kosdex", "link": "https://stackoverflow.com/users/8935593/kosdex"}, "is_accepted": false, "score": 2, "last_activity_date": 1510614600, "creation_date": 1510614600, "answer_id": 47275062, "question_id": 34672725, "link": "https://stackoverflow.com/questions/34672725/converting-netmask-number-to-32-bit-in-golang/47275062#47275062", "title": "Converting netmask number to 32 bit in golang", "body": "<p>Converting netmask to type \"IP\" before printing does the trick:</p>\n\n<pre><code>func mask_print(ipnet *net.IPNet){\n  fmt.Println(\"%v\", net.IP(ipnet.Mask))      \n}\n</code></pre>\n"}], "owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3806, "favorite_count": 2, "accepted_answer_id": 34674157, "answer_count": 4, "score": 3, "last_activity_date": 1510614600, "creation_date": 1452242539, "question_id": 34672725, "link": "https://stackoverflow.com/questions/34672725/converting-netmask-number-to-32-bit-in-golang", "title": "Converting netmask number to 32 bit in golang", "body": "<p>I am trying to get the IP address and subnet mask by</p>\n\n<pre><code>ifaces, err := net.Interfaces()\nfor _, iface := range ifaces{\n        localip, _ = iface.Addrs()\n}\n</code></pre>\n\n<p>However, I am looking forward to get the subnet as something like <code>255.255.255.0</code> rather than <code>/24</code>. How can I get that? If there are no modules that can do this, what is the logic to do this as a program?</p>\n"}, {"tags": ["bash", "shell", "go"], "answers": [{"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 7, "last_activity_date": 1454570357, "last_edit_date": 1454570357, "creation_date": 1452229274, "answer_id": 34669821, "question_id": 34669561, "link": "https://stackoverflow.com/questions/34669561/exit-status-2-on-running-grep-command-using-golang/34669821#34669821", "title": "Exit Status 2 on running Grep command using Golang", "body": "<p>Pipes (<code>|</code>) are implemented by a shell program (like bash). If you want to use them you should execute shell passing a command containing piped program invocations:</p>\n\n<pre><code>exec.Command(\"/bin/sh\", \"-c\",\n    \"grep CRON var/log/sys | tail -5 | grep \\\"cd /home/raka/repo &amp;&amp; git status\\\"\")\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5594370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d33232e63845388aed1ad29d80362fe1?s=128&d=identicon&r=PG&f=1", "display_name": "jakarta b", "link": "https://stackoverflow.com/users/5594370/jakarta-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3160, "favorite_count": 0, "accepted_answer_id": 34669821, "answer_count": 1, "score": 2, "last_activity_date": 1454570357, "creation_date": 1452227649, "question_id": 34669561, "link": "https://stackoverflow.com/questions/34669561/exit-status-2-on-running-grep-command-using-golang", "title": "Exit Status 2 on running Grep command using Golang", "body": "<p>I write simple script using Golang to grep a log file with some parameters. Here's my shell command</p>\n\n<p><code>grep CRON var/log/sys | tail -5 | grep \"cd /home/raka/repo &amp;&amp; git status\"</code></p>\n\n<p>I want to run command above in Golang using <code>os/exec</code> package. Here's my code sniped.</p>\n\n<pre><code>var (\n  reader io.Reader\n  out    []byte\n  err    error\n  commandName string = \"grep\"\n)\n\nargs := []string{\"CRON\", \"/var/log/syslog\", \"| tail -6\", \"| grep \\\"git status\\\"\"}\n\ncmd := exec.Command(commandName, args...)\nr, err = cmd.StdoutPipe()\nerr = cmd.Start()\nout, err = ioutil.ReadAll(r)\nerr = cmd.Wait()\n\nreturn strings.Split(string(out), \"\\n\")```\n</code></pre>\n\n<p>Currently, the sniped above doesn't work, because of <code>exit status 2</code>.\nAny of you guys/ladies have solution for this problem? thank you so much.</p>\n"}, {"tags": ["performance", "dictionary", "go", "slice"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452220634, "post_id": 34668537, "comment_id": 57083025, "body": "is your list always sorted? If yes there there is much better algorithm without need to use a map. Also <code>i+1</code> and <code>i &lt; len(nums)</code> doesn&#39;t look right. You will get out of bounds access."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1452220762, "post_id": 34668537, "comment_id": 57083056, "body": "Please show the Julia translation that you are comparing to."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452220919, "post_id": 34668537, "comment_id": 57083089, "body": "Also how do you measure run time of both programs?"}, {"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452221131, "post_id": 34668537, "comment_id": 57083142, "body": "@kostya Thanks! No. the list is not sorted. I&#39;ll think again on the <code>i+1</code> part."}, {"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1452221168, "post_id": 34668537, "comment_id": 57083149, "body": "@CodingPickle Julia&#39;s translation added. (The nums is too long to paste here. I put it into the gist link.)"}, {"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452221229, "post_id": 34668537, "comment_id": 57083172, "body": "@kostya I measure the two programs in Windows PowerShell <code>Measure-Command { .&#47;twoSum.exe }</code> command for golang; Julia&#39;s @time macro for julia run time. (I don&#39;t know how to build an <code>.exe</code> file for julia)"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452221330, "post_id": 34668537, "comment_id": 57083204, "body": "What commands do you measure? Both for go and julia? What times do you get?"}, {"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452221655, "post_id": 34668537, "comment_id": 57083277, "body": "@kostya Julia: <code>@time</code> <code>9ms</code>.  Go:  <code>Measure-command</code>: <code>90ms</code> ."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452221810, "post_id": 34668537, "comment_id": 57083308, "body": "I wonder if this is some Windows problem (do you have anti-virus?). I get about 7ms on my linux box. And benchmark function just for twoSums without executable overhead says it is 3.5 ms: <a href=\"http://play.golang.org/p/oTvNlEN6py\" rel=\"nofollow noreferrer\">play.golang.org/p/oTvNlEN6py</a>"}, {"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452222571, "post_id": 34668537, "comment_id": 57083481, "body": "@kostya I agree with you, the computer I&#39;m using now is slow, both hardware and system. But I&#39;m surprised that the Julia running on the same platform/computer, is so fast. As you said, maybe the performance problem is caused by the windows executable overhead."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452223711, "post_id": 34668537, "comment_id": 57083726, "body": "It is not fair to say that julia is faster in this case because you are benchmarking different things. The equivalent measurement in Go would look like: <a href=\"http://play.golang.org/p/NzUbkK-S9v\" rel=\"nofollow noreferrer\">play.golang.org/p/NzUbkK-S9v</a>"}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1452229042, "last_edit_date": 1452229042, "creation_date": 1452222981, "answer_id": 34668946, "question_id": 34668537, "link": "https://stackoverflow.com/questions/34668537/golang-find-two-number-index-where-the-sum-of-these-two-numbers-equals-to-targe/34668946#34668946", "title": "Golang: Find two number index where the sum of these two numbers equals to target number", "body": "<p>If <code>nums</code> is always sorted, you can do a binary search to see if the complement to whichever number you're on is also in the slice.</p>\n\n<pre><code>func binary(haystack []int, needle, startsAt int) int {\n    pivot := len(haystack) / 2\n    switch {\n    case haystack[pivot] == needle:\n        return pivot + startsAt\n    case len(haystack) &lt;= 1:\n        return -1\n    case needle &gt; haystack[pivot]:\n        return binary(haystack[pivot+1:], needle, startsAt+pivot+1)\n    case needle &lt; haystack[pivot]:\n        return binary(haystack[:pivot], needle, startsAt)\n    }\n    return -1 // code can never fall off here, but the compiler complains\n              // if you don't have any returns out of conditionals.\n}\n\nfunc twoSum(nums []int, target int) (int, int) {\n    for i, num := range nums {\n        adjusted := target - num\n        if j := binary(nums, adjusted, 0); j != -1 {\n            return i, j\n        }\n    }\n    return 0, 0\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/BW9R4vL6bB\" rel=\"nofollow\">playground example</a></kbd></p>\n\n<p>Or you can use <code>sort.SearchInts</code> which implements binary searching.</p>\n\n<pre><code>func twoSum(nums []int, target int) (int, int) {\n    for i, num := range nums {\n        adjusted := target - num\n        if j := sort.SearchInts(nums, adjusted); nums[j] == adjusted {\n            // sort.SearchInts returns the index where the searched number\n            // would be if it was there. If it's not, then nums[j] != adjusted.\n            return i, j\n        }\n    }\n    return 0, 0\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 84157, "user_id": 238978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a633afaf19e6d4bb53ee50b62e3b5397?s=128&d=identicon&r=PG", "display_name": "Emil Vikstr&#246;m", "link": "https://stackoverflow.com/users/238978/emil-vikstr%c3%b6m"}, "edited": false, "score": 1, "creation_date": 1452245027, "post_id": 34672624, "comment_id": 57091971, "body": "@EmilVikstr&#246;m The functions return <b>indices</b>. <code>-1</code> is a valid integer but it is an invalid <b>index</b>."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452245314, "post_id": 34672624, "comment_id": 57092132, "body": "Wow, impressive answer! ;) I suspect using <code>2 * len(nums)</code> as initial map capacity might make TwoSum2 slightly faster."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452245438, "post_id": 34672624, "comment_id": 57092209, "body": "@kostya Nope, tested it and it made it worse (was 20% slower compared to using <code>len(nums)</code> initial capacity)."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452245543, "post_id": 34672624, "comment_id": 57092273, "body": "@icza, thanks for checking. This just confirms that reasoning about performance is very hard ;)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452245670, "post_id": 34672624, "comment_id": 57092362, "body": "@kostya Not necessarily. <code>len(nums)</code> will avoid rehashing. But using bigger initial capacity will result in more memory usage, and it might be harder to maintain (bigger areas to allocate, might be harder to find sufficient contiguous space). The gain that you would observe with bigger capacity is not experienced as the map is not &quot;fully&quot; populated even with <code>len(nums)</code> (only in worst case)."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1452249490, "post_id": 34672624, "comment_id": 57094823, "body": "@icza, yes, I&#39;ve just realized that len(nums) could be enough to avoid rehashing, depending on the input."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1584030453, "last_edit_date": 1584030453, "creation_date": 1452242092, "answer_id": 34672624, "question_id": 34668537, "link": "https://stackoverflow.com/questions/34668537/golang-find-two-number-index-where-the-sum-of-these-two-numbers-equals-to-targe/34672624#34672624", "title": "Golang: Find two number index where the sum of these two numbers equals to target number", "body": "<p>In my opinion if no elements found adding up to <code>target</code>, best would be to return values which are invalid indices, e.g. <code>-1</code>. Although returning <code>0, 0</code> would be enough as a valid index pair can't be 2 equal indices, this is more convenient (because if you forget to check the return values and you attempt to use the invalid indices, you will immediately get a run-time panic, alerting you not to forget checking the validity of the return values). As so, in my solutions I will get rid of that <code>i + 1</code> shifts as it makes no sense.</p>\n\n<p>Benchmarking of different solutions can be found at the end of the answer.</p>\n\n<h3>If sorting allowed:</h3>\n\n<p>If the slice is big and not changing, and you have to call this <code>twoSum()</code> function many times, the most efficient solution would be to sort the numbers simply using <a href=\"https://golang.org/pkg/sort/#Ints\" rel=\"nofollow noreferrer\"><code>sort.Ints()</code></a> in advance:</p>\n\n<pre><code>sort.Ints(nums)\n</code></pre>\n\n<p>And then you don't have to build a map, you can use binary search implemented in <a href=\"https://golang.org/pkg/sort/#SearchInts\" rel=\"nofollow noreferrer\"><code>sort.SearchInts()</code></a>:</p>\n\n<pre><code>func twoSumSorted(nums []int, target int) (int, int) {\n    for i, v := range nums {\n        v2 := target - v\n        if j := sort.SearchInts(nums, v2); v2 == nums[j] {\n            return i, j\n        }\n    }\n    return -1, -1\n}\n</code></pre>\n\n<p><strong>Note:</strong> Note that after sorting, the indices returned will be indices of values in the sorted slice. This may differ from indices in the original (unsorted) slice (which may or may not be a problem). If you do need indices from the original order (original, unsorted slice), you may store sorted and unsorted index mapping so you can get what the original index is. For details see this question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31141202/get-the-indices-of-the-array-after-sorting-in-golang\">Get the indices of the array after sorting in golang</a></p>\n\n<h3>If sorting is not allowed:</h3>\n\n<p>Here is your solution getting rid of that <code>i + 1</code> shifts as it makes no sense. Slice and array indices are zero based in all languages. Also utilizing <code>for ... range</code>:</p>\n\n<pre><code>func twoSum(nums []int, target int) (int, int) {\n    if len(nums) &lt;= 1 {\n        return -1, -1\n    }\n    m := make(map[int]int)\n    for i, v := range nums {\n        if j, ok := m[v]; ok {\n            return j, i\n        } \n        m[target-v] = i\n    }\n    return -1, -1\n}\n</code></pre>\n\n<p>If the <code>nums</code> slice is big and the solution is not found fast (meaning the <code>i</code> index grows big) that means a lot of elements will be added to the map. Maps start with small capacity, and they are internally grown if additional space is required to host many elements (key-value pairs). An internal growing requires rehashing and rebuilding with the already added elements. This is \"very\" expensive.</p>\n\n<p>It does not seem significant but it really is. Since you know the max elements that will end up in the map (worst case is <code>len(nums)</code>), you can create a map with a big-enough capacity to hold all elements for the worst case. The gain will be that no internal growing and rehashing will be required. You can provide the initial capacity as the second argument to <code>make()</code> when creating the <code>map</code>. This speeds up <code>twoSum2()</code> big time if <code>nums</code> is big:</p>\n\n<pre><code>func twoSum2(nums []int, target int) (int, int) {\n    if len(nums) &lt;= 1 {\n        return -1, -1\n    }\n    m := make(map[int]int, len(nums))\n    for i, v := range nums {\n        if j, ok := m[v]; ok {\n            return j, i\n        }\n        m[target-v] = i\n    }\n    return -1, -1\n}\n</code></pre>\n\n<h3>Benchmarking</h3>\n\n<p>Here's a little benchmarking code to test execution speed of the 3 solutions with the input <code>nums</code> and <code>target</code> you provided. Note that in order to test <code>twoSumSorted()</code>, you first have to sort the <code>nums</code> slice.</p>\n\n<p>Save this into a file named <code>xx_test.go</code> and run it with <code>go test -bench .</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"sort\"\n    \"testing\"\n)\n\nfunc BenchmarkTwoSum(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        twoSum(nums, target)\n    }\n}\n\nfunc BenchmarkTwoSum2(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        twoSum2(nums, target)\n    }\n}\n\nfunc BenchmarkTwoSumSorted(b *testing.B) {\n    sort.Ints(nums)\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        twoSumSorted(nums, target)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>BenchmarkTwoSum-4              1000       1405542 ns/op\nBenchmarkTwoSum2-4             2000        722661 ns/op\nBenchmarkTwoSumSorted-4    10000000           133 ns/op\n</code></pre>\n\n<p>As you can see, making a map with big enough capacity speeds up: it runs <strong>twice</strong> as fast.</p>\n\n<p>And as mentioned, if <code>nums</code> can be sorted in advance, that is <strong>~10,000</strong> times faster!</p>\n"}], "owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1584030453, "creation_date": 1452220164, "last_edit_date": 1452245900, "question_id": 34668537, "link": "https://stackoverflow.com/questions/34668537/golang-find-two-number-index-where-the-sum-of-these-two-numbers-equals-to-targe", "title": "Golang: Find two number index where the sum of these two numbers equals to target number", "body": "<p>The problem is: find the index of two numbers that <code>nums[index1] + nums[index2] == target</code>. Here is my attempt in <code>golang</code> (index starts from 1):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar nums = []int{0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 25182, 25184, 25186, 25188, 25190, 25192, 25194, 25196} // The number list is too long, I put the whole numbers in a gist: https://gist.github.com/nickleeh/8eedb39e008da8b47864\nvar target int = 16021\n\nfunc twoSum(nums []int, target int) (int, int) {\n    if len(nums) &lt;= 1 {\n        return 0, 0\n    }\n    hdict := make(map[int]int)\n    for i := 1; i &lt; len(nums); i++ {\n        if val, ok := hdict[nums[i+1]]; ok {\n            return val, i + 1\n        } else {\n            hdict[target-nums[i+1]] = i + 1\n        }\n    }\n    return 0, 0\n}\n\nfunc main() {\n    fmt.Println(twoSum(nums, target))\n}\n</code></pre>\n\n<p>The nums list is too long, I put it into a gist:\n<a href=\"https://gist.github.com/nickleeh/8eedb39e008da8b47864\" rel=\"nofollow\">https://gist.github.com/nickleeh/8eedb39e008da8b47864</a></p>\n\n<p>This code works fine, but I find the <code>return 0,0</code> part is ugly, and it runs ten times slower than the <code>Julia</code> translation. I would like to know is there any part that is written terrible and affect the performance?</p>\n\n<p><strong>Edit:</strong>\nJulia's translation:</p>\n\n<pre><code>function two_sum(nums, target)\n    if length(nums) &lt;= 1\n        return false\n    end\n    hdict = Dict()\n    for i in 1:length(nums)\n        if haskey(hdict, nums[i])\n            return [hdict[nums[i]], i]\n        else\n            hdict[target - nums[i]] = i\n        end\n    end\nend\n</code></pre>\n"}, {"tags": ["url", "go", "path"], "answers": [{"comments": [{"owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "edited": false, "score": 0, "creation_date": 1531162361, "post_id": 34668130, "comment_id": 89483431, "body": "This answer correctly explains the nuances between <code>u.String()</code> and <code>ResolveReference</code>"}, {"owner": {"reputation": 5117, "user_id": 337735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5a4803c2f31a4f0e53705287430a6e3d?s=128&d=identicon&r=PG", "display_name": "Cody A. Ray", "link": "https://stackoverflow.com/users/337735/cody-a-ray"}, "edited": false, "score": 0, "creation_date": 1554571570, "post_id": 34668130, "comment_id": 97804589, "body": "I believe this will be incorrect on Windows, where it&#39;ll join with &quot;\\&quot; instead of &quot;/&quot;"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 5117, "user_id": 337735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5a4803c2f31a4f0e53705287430a6e3d?s=128&d=identicon&r=PG", "display_name": "Cody A. Ray", "link": "https://stackoverflow.com/users/337735/cody-a-ray"}, "edited": false, "score": 3, "creation_date": 1554572008, "post_id": 34668130, "comment_id": 97804705, "body": "@CodyA.Ray  The code works correctly on Windows.  The <a href=\"https://godoc.org/path\" rel=\"nofollow noreferrer\">path package</a> works with forward slash separated paths as stated in the first paragraphs of the package documentation.  The <a href=\"https://godoc.org/path/filepath\" rel=\"nofollow noreferrer\">path/filepath</a> package uses backslash on Windows, but that&#39;s not the package used in this answer."}, {"owner": {"reputation": 5117, "user_id": 337735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5a4803c2f31a4f0e53705287430a6e3d?s=128&d=identicon&r=PG", "display_name": "Cody A. Ray", "link": "https://stackoverflow.com/users/337735/cody-a-ray"}, "edited": false, "score": 0, "creation_date": 1554747058, "post_id": 34668130, "comment_id": 97857249, "body": "@CeriseLim&#243;n but won&#39;t this mean the resulting URL looks like &quot;<a href=\"http://foo\" rel=\"nofollow noreferrer\">foo</a>\\bar.html&quot; when run on windows, instead of the expected &quot;<a href=\"http://foo/bar.html\" rel=\"nofollow noreferrer\">foo/bar.html</a>&quot;?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 5117, "user_id": 337735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5a4803c2f31a4f0e53705287430a6e3d?s=128&d=identicon&r=PG", "display_name": "Cody A. Ray", "link": "https://stackoverflow.com/users/337735/cody-a-ray"}, "edited": false, "score": 3, "creation_date": 1554874711, "post_id": 34668130, "comment_id": 97905769, "body": "@CodyA.Ray The path package works with forward slash separated paths on all platforms. The path generated by <code>path.Join(u.Path, &quot;bar.html&quot;)</code> is <code>&quot;&#47;foo&#47;bar.html&quot;</code> on all platforms, including Windows. The path package <a href=\"https://github.com/golang/go/blob/9a0a150c9f50f920f35cc4d50ac3005503f44f2d/src/path/path.go#L158\" rel=\"nofollow noreferrer\">literally uses forward slash</a> in the Join implementation."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 95, "last_activity_date": 1531162293, "last_edit_date": 1531162293, "creation_date": 1452216789, "answer_id": 34668130, "question_id": 34668012, "link": "https://stackoverflow.com/questions/34668012/combine-url-paths-with-path-join/34668130#34668130", "title": "Combine URL paths with path.Join()", "body": "<p>The function path.Join expects a path, not a URL. Parse the URL to get a path and join with that path:</p>\n\n<pre><code>u, err := url.Parse(\"http://foo\")\nu.Path = path.Join(u.Path, \"bar.html\")\ns := u.String() // prints http://foo/bar.html\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/GacxGKAhcR\" rel=\"noreferrer\">playground example</a></kbd></p>\n\n<p>If you are combining more than the path (scheme or host for example) or the string is more than the path (it includes a query string for example),  then use <a href=\"https://golang.org/pkg/net/url/#URL.ResolveReference\" rel=\"noreferrer\">ResolveReference</a>.  </p>\n"}, {"tags": [], "owner": {"reputation": 566, "user_id": 5266626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f39b7f449f147ed47cea80d3687610e1?s=128&d=identicon&r=PG&f=1", "display_name": "mmmkay", "link": "https://stackoverflow.com/users/5266626/mmmkay"}, "is_accepted": false, "score": 32, "last_activity_date": 1492190054, "last_edit_date": 1492190054, "creation_date": 1492189534, "answer_id": 43415988, "question_id": 34668012, "link": "https://stackoverflow.com/questions/34668012/combine-url-paths-with-path-join/43415988#43415988", "title": "Combine URL paths with path.Join()", "body": "<p><a href=\"https://golang.org/pkg/net/url/#ResolveReference\" rel=\"noreferrer\">ResolveReference() in net/url package</a></p>\n\n<p>The accepted answer will not work for relative url paths containing file endings like .html or .img. The ResolveReference() function is the correct way to join url paths in go.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/url\"\n)\n\nfunc main() {\n    u, err := url.Parse(\"../../..//search?q=dotnet\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    base, err := url.Parse(\"http://example.com/directory/\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(base.ResolveReference(u))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "is_accepted": false, "score": 0, "last_activity_date": 1543613282, "creation_date": 1543613282, "answer_id": 53565158, "question_id": 34668012, "link": "https://stackoverflow.com/questions/34668012/combine-url-paths-with-path-join/53565158#53565158", "title": "Combine URL paths with path.Join()", "body": "<p>I wrote this utility function that works for my purposes:</p>\n\n<pre><code>func Join(basePath string, paths ...string) (*url.URL, error) {\n\n    u, err := url.Parse(basePath)\n\n    if err != nil {\n        return nil, fmt.Errorf(\"invalid url\")\n    }\n\n    p2 := append([]string{u.Path}, paths...)\n\n    result := path.Join(p2...)\n\n    u.Path = result\n\n    return u, nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/-QNVvyzacMM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-QNVvyzacMM</a></p>\n"}, {"tags": [], "owner": {"reputation": 4738, "user_id": 4723237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNJVW.png?s=128&g=1", "display_name": "vbranden", "link": "https://stackoverflow.com/users/4723237/vbranden"}, "is_accepted": false, "score": 7, "last_activity_date": 1564145280, "creation_date": 1564145280, "answer_id": 57220413, "question_id": 34668012, "link": "https://stackoverflow.com/questions/34668012/combine-url-paths-with-path-join/57220413#57220413", "title": "Combine URL paths with path.Join()", "body": "<p>A simple approach to this would be to trim the /'s you don't want and join. Here is an example func</p>\n\n<pre><code>func JoinURL(base string, paths ...string) string {\n    p := path.Join(paths...)\n    return fmt.Sprintf(\"%s/%s\", strings.TrimRight(base, \"/\"), strings.TrimLeft(p, \"/\"))\n}\n</code></pre>\n\n<p>Usage would be</p>\n\n<pre><code>b := \"http://my.domain.com/api/\"\nu := JoinURL(b, \"/foo\", \"bar/\", \"baz\")\nfmt.Println(u)\n</code></pre>\n\n<p>This removes the need for checking/returning errors</p>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 0, "last_activity_date": 1604869515, "creation_date": 1604869515, "answer_id": 64743028, "question_id": 34668012, "link": "https://stackoverflow.com/questions/34668012/combine-url-paths-with-path-join/64743028#64743028", "title": "Combine URL paths with path.Join()", "body": "<p>To join a <code>URL</code> with another <code>URL</code> or a path, there is <a href=\"https://golang.org/pkg/net/url/#URL.Parse\" rel=\"nofollow noreferrer\"><code>URL.Parse()</code></a>:</p>\n<blockquote>\n<pre><code>func (u *URL) Parse(ref string) (*URL, error)\n</code></pre>\n<p>Parse parses a URL in the context of the receiver. The provided URL\nmay be <strong>relative</strong> or <strong>absolute</strong>. Parse returns <code>nil</code>, <code>err</code> on parse failure,\notherwise its return value is the same as <code>ResolveReference</code>.</p>\n</blockquote>\n<pre><code>func TestURLParse(t *testing.T) {\n    baseURL, _ := url.Parse(&quot;http://foo/a/b/c&quot;)\n\n    url1, _ := baseURL.Parse(&quot;d/e&quot;)\n    require.Equal(t, &quot;http://foo/a/b/d/e&quot;, url1.String())\n\n    url2, _ := baseURL.Parse(&quot;../d/e&quot;)\n    require.Equal(t, &quot;http://foo/a/d/e&quot;, url2.String())\n\n    url3, _ := baseURL.Parse(&quot;/d/e&quot;)\n    require.Equal(t, &quot;http://foo/d/e&quot;, url3.String())\n}\n</code></pre>\n"}], "owner": {"reputation": 8350, "user_id": 772000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0e951e108fe3c1243260497ca9cb4dc?s=128&d=identicon&r=PG", "display_name": "Ale\u0161", "link": "https://stackoverflow.com/users/772000/ale%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49234, "favorite_count": 9, "accepted_answer_id": 34668130, "answer_count": 5, "score": 60, "last_activity_date": 1604869515, "creation_date": 1452215780, "last_edit_date": 1495541873, "question_id": 34668012, "link": "https://stackoverflow.com/questions/34668012/combine-url-paths-with-path-join", "title": "Combine URL paths with path.Join()", "body": "<p>Is there a way in Go to combine URL paths similarly as we can do with filepaths using <code>path.Join()</code>?</p>\n\n<p>For example see e.g. <a href=\"https://stackoverflow.com/q/13078314/772000\">Combine absolute path and relative path to get a new absolute path</a>. </p>\n\n<p>When I use <code>path.Join(\"http://foo\", \"bar\")</code>, I get <code>http:/foo/bar</code>. </p>\n\n<p>See in <a href=\"https://play.golang.org/p/VPaiToD_XO\" rel=\"noreferrer\">Golang Playground</a>.</p>\n"}, {"tags": ["go", "concurrency", "scheduling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1452214987, "post_id": 34667838, "comment_id": 57081564, "body": "Yes. Though sleep is special in a sense, all function calls are yield points."}, {"owner": {"reputation": 1100, "user_id": 1617530, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74699b384171a61e74a91c4edbe7f0c4?s=128&d=identicon&r=PG", "display_name": "bk0", "link": "https://stackoverflow.com/users/1617530/bk0"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452216869, "post_id": 34667838, "comment_id": 57082038, "body": "While I know syscalls yield, do you have a reference for &quot;all function calls are yield points&quot;? I haven&#39;t been able to find substantiation for it."}], "answers": [{"tags": [], "owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "is_accepted": true, "score": 6, "last_activity_date": 1452217022, "creation_date": 1452217022, "answer_id": 34668153, "question_id": 34667838, "link": "https://stackoverflow.com/questions/34667838/does-time-sleep-yield-to-other-goroutines/34668153#34668153", "title": "Does time.Sleep() yield to other goroutines?", "body": "<p>Yes. See <a href=\"https://tip.golang.org/doc/go1.2#preemption\" rel=\"noreferrer\">Pre-emption in the scheduler</a>.</p>\n\n<blockquote>\n  <p>In prior releases, a goroutine that was looping forever could starve out other goroutines on the same thread, a serious problem when GOMAXPROCS provided only one user thread. In Go 1.2, this is partially addressed: The scheduler is invoked occasionally upon entry to a function. This means that any loop that includes a (non-inlined) function call can be pre-empted, allowing other goroutines to run on the same thread.</p>\n</blockquote>\n\n<p>Following design docs are also good reads to learn more about scheduler:</p>\n\n<ul>\n<li><a href=\"https://docs.google.com/document/d/1TTj4T2JO42uD5ID9e89oa0sLKhJYD0Y_kqxDv3I3XMw/edit\" rel=\"noreferrer\">Scalable Go Scheduler Design Doc</a></li>\n<li><a href=\"https://docs.google.com/document/d/1ETuA2IOmnaQ4j81AtTGT40Y4_Jr6_IDASEKg0t0dBR8/edit\" rel=\"noreferrer\">Go Preemptive Scheduler Design Doc</a></li>\n</ul>\n"}], "owner": {"reputation": 1100, "user_id": 1617530, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74699b384171a61e74a91c4edbe7f0c4?s=128&d=identicon&r=PG", "display_name": "bk0", "link": "https://stackoverflow.com/users/1617530/bk0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 2, "accepted_answer_id": 34668153, "answer_count": 1, "score": 4, "last_activity_date": 1452217030, "creation_date": 1452214412, "last_edit_date": 1495542208, "question_id": 34667838, "link": "https://stackoverflow.com/questions/34667838/does-time-sleep-yield-to-other-goroutines", "title": "Does time.Sleep() yield to other goroutines?", "body": "<p>In Go, does a call to time.Sleep() yield to other goroutines? I have a feeling it does, but in other answers (eg: <a href=\"https://stackoverflow.com/questions/10095751/understanding-goroutines\">Understanding goroutines</a>) time.Sleep is not explicitly listed as a scheduling point.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 5737452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17e1cbf59bde9523ef8a433fbe774cad?s=128&d=identicon&r=PG&f=1", "display_name": "desi Joe", "link": "https://stackoverflow.com/users/5737452/desi-joe"}, "edited": false, "score": 0, "creation_date": 1452212490, "post_id": 34667503, "comment_id": 57080899, "body": "What I am trying to do is iterate over a list of objects and create a map.  Lets say I have a list of car objects and the car objects has both make and model.  I want to iterate of the list and create a map where key is the make and model are in the map value as list of car objects. What would be the best way to do this?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 313, "user_id": 5737452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17e1cbf59bde9523ef8a433fbe774cad?s=128&d=identicon&r=PG&f=1", "display_name": "desi Joe", "link": "https://stackoverflow.com/users/5737452/desi-joe"}, "edited": false, "score": 0, "creation_date": 1452215112, "post_id": 34667503, "comment_id": 57081603, "body": "@desiJoe edited with an example that might get you moving in the right direction. If you need further guidance, and can update with more information, I can provide a more specific example."}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 2, "creation_date": 1452249663, "post_id": 34667503, "comment_id": 57094941, "body": "You don&#39;t need the if statement. <code>append</code> treats a nil slice as an empty slice (as do most functions)."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1452273558, "post_id": 34667503, "comment_id": 57111113, "body": "@MadameElyse thanks for pointing that out, much simpler code that way."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 4, "last_activity_date": 1452273534, "last_edit_date": 1452273534, "creation_date": 1452212054, "answer_id": 34667503, "question_id": 34667468, "link": "https://stackoverflow.com/questions/34667468/how-to-create-a-mapstring-listsomeclass-in-go/34667503#34667503", "title": "How to create a Map&lt;String, List&lt;SomeClass&gt;&gt; in Go?", "body": "<p>You're looking for; <code>map[string][]SomeClass</code></p>\n\n<p>However, the way you're using make won't cut it. I would personally recommend using composite literal syntax for initialization, it would look like this;</p>\n\n<pre><code>m := map[string][]SomeClass {\n      \"a\": []SomeClass{SomeClass{SomeProperty: SomeValue}}\n}\n</code></pre>\n\n<p>If you want to use make, you'll have to iterate over the map and call make for every key or the <code>[]SomeClass</code> array for that key is gonna be nil. My syntax initializes as follows; outer most braces is for the map, inside it I declare a single key \"a\" and initialize a slice of SomeClass, inside the slice I initialize an instance of SomceClass setting SomeProperty to SomeValue.</p>\n\n<p>If you highly prefer using make for whatever reason I can add another example which initializes the collection that way, I just find it to be more complicated personally.</p>\n\n<p>EDIT:</p>\n\n<p>Here's some sample closer to what you might be looking for</p>\n\n<pre><code>var m map[string][]Model\nm = make(map[string][]Model)\n\nfor i, _ := range Cars {\n      m[Cars[i].Make] = append(m[Cars[i].Make], Cars[i].Model)\n}\n</code></pre>\n\n<p>In this example I'm initialize the map, then I start iterating over the \"cars\" array. For each car I check to see if there is a key for it's <code>Make</code> if there is, then I append the <code>Model</code> to the slice with that key, otherwise, I instantiate a new slice with the model. Of course, that isn't actual working code but it should give you some idea. If you provide a more complete example (like a sample of the Cars data you want to put in the map) then I could tailor this more to your needs but I'm hoping that will give you the general idea.</p>\n"}], "owner": {"reputation": 313, "user_id": 5737452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17e1cbf59bde9523ef8a433fbe774cad?s=128&d=identicon&r=PG&f=1", "display_name": "desi Joe", "link": "https://stackoverflow.com/users/5737452/desi-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452273534, "creation_date": 1452211828, "last_edit_date": 1452249560, "question_id": 34667468, "link": "https://stackoverflow.com/questions/34667468/how-to-create-a-mapstring-listsomeclass-in-go", "title": "How to create a Map&lt;String, List&lt;SomeClass&gt;&gt; in Go?", "body": "<p>How do I create a <code>Map&lt;String, List&lt;SomeClass&gt;&gt;</code> in Go? Something like:</p>\n\n<pre><code>var m map[string]list\nm = make(map[string]list)\n</code></pre>\n"}, {"tags": ["go", "many-to-many", "go-gorm"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1452210634, "post_id": 34667199, "comment_id": 57080345, "body": "Doesn&#39;t <code>db.Model(&amp;user).Related(&amp;languages) </code> need to be <code>db.Model(&amp;user).Related(user.languages)</code> ? I mean, even if that statement succeeded, the user object you returned would have have an empty languages array since you never assign to it, only to the local variable."}], "answers": [{"comments": [{"owner": {"reputation": 869, "user_id": 3057566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trHL4.jpg?s=128&g=1", "display_name": "mantale", "link": "https://stackoverflow.com/users/3057566/mantale"}, "edited": false, "score": 0, "creation_date": 1464185970, "post_id": 34687459, "comment_id": 62382336, "body": "Can you explain you use <code>Association</code> instead of <code>Relation</code> ?"}, {"owner": {"reputation": 4085, "user_id": 1510063, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/uXGc7.jpg?s=128&g=1", "display_name": "Charlie Egan", "link": "https://stackoverflow.com/users/1510063/charlie-egan"}, "reply_to_user": {"reputation": 869, "user_id": 3057566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trHL4.jpg?s=128&g=1", "display_name": "mantale", "link": "https://stackoverflow.com/users/3057566/mantale"}, "edited": false, "score": 1, "creation_date": 1464208570, "post_id": 34687459, "comment_id": 62396257, "body": "As far as I know <code>Association</code> is just the name for relationships in Gorm. The docs page is pretty good at getting the idea across: <a href=\"http://jinzhu.me/gorm/associations.html\" rel=\"nofollow noreferrer\">jinzhu.me/gorm/associations.html</a>"}], "tags": [], "owner": {"reputation": 4085, "user_id": 1510063, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/uXGc7.jpg?s=128&g=1", "display_name": "Charlie Egan", "link": "https://stackoverflow.com/users/1510063/charlie-egan"}, "is_accepted": false, "score": 1, "last_activity_date": 1452293715, "creation_date": 1452293715, "answer_id": 34687459, "question_id": 34667199, "link": "https://stackoverflow.com/questions/34667199/gorm-many-to-many-select-gives-invalid-association-error/34687459#34687459", "title": "gorm Many To Many Select gives invalid association [] error", "body": "<p>I think you need to use <code>Association</code>. You can also get the matching user more succinctly using <code>db.First(&amp;user, id)</code>.</p>\n\n<pre><code>func GetUser(id string) User {\n    var user User\n\n    db.First(&amp;user, id)\n\n    db.Model(&amp;user).Association(\"Languages\").Find(&amp;user.Languages) \n\n    return user\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1236, "user_id": 1221253, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c05edd2a49079a60ee18c6609dc44e10?s=128&d=identicon&r=PG&f=1", "display_name": "Dina", "link": "https://stackoverflow.com/users/1221253/dina"}, "edited": false, "score": 2, "creation_date": 1499951987, "post_id": 37982571, "comment_id": 77136344, "body": "So this worked for me too, but the documentation on the gorm website doesn&#39;t say that you have to specify the foreign key. In fact I specified the ForeignKey and AssociationForeignKey tags in my struct definition and it still didn&#39;t work without explicitly adding the column name in the <code>Related</code> API..."}], "tags": [], "owner": {"reputation": 471, "user_id": 1633004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4362c618a90c5601d79bf6c7e5502?s=128&d=identicon&r=PG", "display_name": "Eagle", "link": "https://stackoverflow.com/users/1633004/eagle"}, "is_accepted": false, "score": 10, "last_activity_date": 1466657419, "creation_date": 1466657419, "answer_id": 37982571, "question_id": 34667199, "link": "https://stackoverflow.com/questions/34667199/gorm-many-to-many-select-gives-invalid-association-error/37982571#37982571", "title": "gorm Many To Many Select gives invalid association [] error", "body": "<p>You may try:</p>\n\n<pre><code>db.Model(&amp;user).Related(&amp;languages, \"Languages\") \n</code></pre>\n\n<p>More examples can be find in the <a href=\"https://github.com/jinzhu/gorm/blob/021d7b33143de37b743d1cf660974e9c8d3f80ea/multi_primary_keys_test.go\" rel=\"noreferrer\">test</a></p>\n"}], "owner": {"reputation": 117, "user_id": 5467814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/522f564d07b0b386f7c867a7df919a72?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5467814/nitin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6899, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1466657419, "creation_date": 1452210156, "last_edit_date": 1464188041, "question_id": 34667199, "link": "https://stackoverflow.com/questions/34667199/gorm-many-to-many-select-gives-invalid-association-error", "title": "gorm Many To Many Select gives invalid association [] error", "body": "<p>This is my db schema:</p>\n\n<p>users :</p>\n\n<pre><code>id uuid PRIMARY KEY ,   title character\n\"1234\"                  \"ABCD\"\n</code></pre>\n\n<p>languages :</p>\n\n<pre><code>id uuid PRIMARY KEY ,   name character\n\"1122\"                  \"eng\"\n\"1133\"                  \"man\"\n</code></pre>\n\n<p>user_languages : </p>\n\n<pre><code>user_id uuid,   language_id uuid\n\"1234\"          \"1122\"\n\"1234\"          \"1133\"\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>type User struct {\n   Id           uuid.UUID  `json:\"id\" gorm:\"primary_key\"`\n   Title        string     `json:\"title\"`\n   Languages    []Language `json:\"languages\" gorm:\"many2many:user_languages;\"`\n}\n\ntype Language struct {\n   ID   uuid.UUID `json:\"id\" gorm:\"primary_key\"`\n   Name string    `json:\"name\"`\n}\n\nfunc GetUser(id string) User {\n   user := User{}\n   languages := Language{}\n\n   db.Where(\"id = ?\", id).Find(&amp;user) \n   // SELECT * FROM users WHERE 'id' = id;\n\n   db.Model(&amp;user).Related(&amp;languages) \n   // SELECT * FROM \"languages\" INNER JOIN \"user_languages\" ON \"user_languages\".\"language_id\" = \"languages\".\"id\" WHERE \"user_languages\".\"user_id\" = 111\n\n   return user\n}\n</code></pre>\n\n<p>I am expecting this result:</p>\n\n<pre><code>{\n   \"id\": \"1234\",\n   \"title\": \"ABCD\",\n   \"languages\" : [{ \n               \"id\" : \"1122\",\n               \"name\" : \"eng\"\n           },{ \n               \"id\" : \"1122\",\n               \"name\" : \"eng\"\n           }]\n}\n</code></pre>\n\n<p>But I am getting <code>invalid association []</code> on console, adding a gorm logger did not provide more information.</p>\n\n<p>Even if I can only get a \"languages\" object like an array of languages names, this is also fine:</p>\n\n<pre><code>\"languages\" : [\"eng\", \"man\"]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "reply_to_user": {"reputation": 313, "user_id": 5737452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17e1cbf59bde9523ef8a433fbe774cad?s=128&d=identicon&r=PG&f=1", "display_name": "desi Joe", "link": "https://stackoverflow.com/users/5737452/desi-joe"}, "edited": false, "score": 4, "creation_date": 1452198106, "post_id": 34664229, "comment_id": 57074325, "body": "I see you are quite new, you don&#39;t have to thank, just accept the answer if you find it useful <a href=\"http://stackoverflow.com/help/accepted-answer\">stackoverflow.com/help/accepted-answer</a>"}], "tags": [], "owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "is_accepted": false, "score": 6, "last_activity_date": 1452197399, "last_edit_date": 1452197399, "creation_date": 1452197357, "answer_id": 34664229, "question_id": 34663992, "link": "https://stackoverflow.com/questions/34663992/how-to-pass-a-map-to-a-callback-function-in-go/34664229#34664229", "title": "How to pass a Map to a callback function in Go", "body": "<p>Pass the Map to the function which returns a <code>filepath.WalkFunc</code> and then pass it to <code>filepath.Walk</code>. It is a constructor like thing.</p>\n\n<pre><code>func visit(map Map) filepath.WalkFunc {\n    return func(path string, f os.FileInfo, err error) error {\n\n        // do something with map\n\n        fileName := f.Name()\n        if !f.IsDir() &amp;&amp; strings.Contains(strings.ToLower(fileName), \"myfile\") {\n            df := parseFile(path)\n            fmt.Printf(\"Visited: %s [%x], %s, %s\\n\", df.FilePath)\n        }\n\n        return nil\n    }\n}\n\nfunc WalkDir(path string) {\n    err := filepath.Walk(path, visit(map))\n    fmt.Printf(\"filepath.Walk() returned %v\\n\", err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1452204061, "creation_date": 1452204061, "answer_id": 34665984, "question_id": 34663992, "link": "https://stackoverflow.com/questions/34663992/how-to-pass-a-map-to-a-callback-function-in-go/34665984#34665984", "title": "How to pass a Map to a callback function in Go", "body": "<p>You can write</p>\n\n<pre><code>func (map Map) visit(path string, f os.FileInfo, err error) error {\n...//Do something with map \n}\nvar mymap Map\n\nerr := filepath.Walk(path, mymap.visit) //mymap.visit express 'func(path string, f os.FileInfo, err error) error' same as visit just with mymap evaluated\n</code></pre>\n\n<p>it's called <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow\">method value</a></p>\n"}], "owner": {"reputation": 313, "user_id": 5737452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17e1cbf59bde9523ef8a433fbe774cad?s=128&d=identicon&r=PG&f=1", "display_name": "desi Joe", "link": "https://stackoverflow.com/users/5737452/desi-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1452204061, "creation_date": 1452196488, "question_id": 34663992, "link": "https://stackoverflow.com/questions/34663992/how-to-pass-a-map-to-a-callback-function-in-go", "title": "How to pass a Map to a callback function in Go", "body": "<p>I am trying to write a Go program to walk down a directory and find certain file and store that information in a Map.  Here is what I have so far.\nI am not sure how to pass the Map to the visit function since it's a callback function.   </p>\n\n<pre><code>..\ntype MyFile struct {\n    Name       string\n    FilePath    string\n    FileMD5Hash [16]byte\n}\n\nfunc visit(path string, f os.FileInfo, err error) error {\n\n    fileName := f.Name()\n    if !f.IsDir() &amp;&amp; strings.Contains(strings.ToLower(fileName), \"myfile\") {\n        df := parseFile(path)\n        fmt.Printf(\"Visited: %s [%x], %s, %s\\n\", df.FilePath)\n    }\n\n    return nil\n}\n\nfunc parseFile(path string)...\n\nfunc check(e error) ...\n\nfunc WalkDir(path string) {\n    err := filepath.Walk(path, visit)\n    fmt.Printf(\"filepath.Walk() returned %v\\n\", err)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5759057, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DPtapTd74OU/AAAAAAAAAAI/AAAAAAAAAVU/YlYaAS7_2ug/photo.jpg?sz=128", "display_name": "Maxime Roy", "link": "https://stackoverflow.com/users/5759057/maxime-roy"}, "edited": false, "score": 0, "creation_date": 1452285297, "post_id": 34663351, "comment_id": 57117633, "body": "Ok that was what I suspected ! I tried your idea with Powershell $(Get-Date .. command but the Build tool does not like it ! I dont know how to get a trace of the Build command to see more detail on the error. For the moment the build tool just list all the availables options instead of giving me error info !"}, {"owner": {"reputation": 11, "user_id": 5759057, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DPtapTd74OU/AAAAAAAAAAI/AAAAAAAAAVU/YlYaAS7_2ug/photo.jpg?sz=128", "display_name": "Maxime Roy", "link": "https://stackoverflow.com/users/5759057/maxime-roy"}, "edited": false, "score": 1, "creation_date": 1452528170, "post_id": 34663351, "comment_id": 57197538, "body": "OK I figured out my problem ! Your answer was exactly on target ! I had problem because I was introducing spaces in the BUILD_Date assignement ! I was trying to use a full DateTime format that produces a string like &quot;11 january 2016 11:00:02&quot; and the assignement to BUILD_DATE would crash the Build command... THANK YOU !!!"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1452194634, "last_edit_date": 1452194634, "creation_date": 1452194220, "answer_id": 34663351, "question_id": 34662420, "link": "https://stackoverflow.com/questions/34662420/go-build-tag-getting-timestamp-on-windows/34663351#34663351", "title": "Go Build tag - getting timestamp on Windows", "body": "<p>The command on *nix systems is using backtick command substitution. <code>date</code> is a built-in on POSIX, and anything inside <code>`</code>s is interpreted as a shell command and is replaced by its value.</p>\n\n<p><code>cmd.exe</code> doesn't do command substitution inside backticks at all, There's some ways to accomplish the same thing using <code>for /F delims=\"\"</code>, aka the most powerful command in Windows shell, but it's pretty hacky. Maybe use powershell instead, which supports the <code>$(command)</code> syntax?</p>\n\n<pre><code>PS C:\\users\\adsmith&gt; go build -i -ldflags \"-X main.SERVER_NAME=MFFP -X main.VERSION=1.0.0 -X main.BUILD_DATE=$(Get-Date -uformat .%Y%m%d%.H%M%S)\"\n</code></pre>\n\n<p>You might have to play with the format -- I'm not sure what that's supposed to look like on POSIX. This outputs:</p>\n\n<pre><code>.20160107.111641\n// Jan 7th 2016, 11:16:41\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5759057, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DPtapTd74OU/AAAAAAAAAAI/AAAAAAAAAVU/YlYaAS7_2ug/photo.jpg?sz=128", "display_name": "Maxime Roy", "link": "https://stackoverflow.com/users/5759057/maxime-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1452195084, "creation_date": 1452190991, "last_edit_date": 1452195084, "question_id": 34662420, "link": "https://stackoverflow.com/questions/34662420/go-build-tag-getting-timestamp-on-windows", "title": "Go Build tag - getting timestamp on Windows", "body": "<p>I have seen the following command to set build version</p>\n\n<pre><code>go build -ldflags \"-X main.minversion `date -u +.%Y%m%d%.H%M%S`\" service.go\n</code></pre>\n\n<p>but I cant get the timestamp part to work on Windows !</p>\n\n<p>I am using go 1.5 with the following arguments...</p>\n\n<pre><code>build -i -ldflags \"-X main.SERVER_NAME=MFFP -X main.VERSION=1.0.0 -X main.BUILD_DATE=`date -u +.%Y%m%d%.H%M%S`\"\n</code></pre>\n\n<p>The error is with the date part</p>\n\n<p>Is this error system related?\nAnyone tried this on Windows?</p>\n\n<p>Thanks!</p>\n"}]