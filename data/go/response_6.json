[{"tags": ["go"], "comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 4, "creation_date": 1424304032, "post_id": 28595664, "comment_id": 45499127, "body": "The two forms are equivalent JSON: the escapes should be interpreted by whatever parser you send the JSON to, so this difference should be transparent."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 0, "creation_date": 1424307940, "post_id": 28595664, "comment_id": 45500420, "body": "Related question with same answer: <a href=\"http://stackoverflow.com/questions/24656624/golang-display-character-not-ascii-like-not-0026/24657016#24657016\" title=\"golang display character not ascii like not 0026\">stackoverflow.com/questions/24656624/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1212, "user_id": 860788, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/20af2492a79054768ebd40960d853e24?s=128&d=identicon&r=PG", "display_name": "Codefor", "link": "https://stackoverflow.com/users/860788/codefor"}, "edited": false, "score": 0, "creation_date": 1492678421, "post_id": 28596225, "comment_id": 74082740, "body": "<a href=\"https://github.com/golang/go/issues/8592\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/8592</a>  Doing string replacement in a second pass is an inefficient and cumbersome workaround."}, {"owner": {"reputation": 6974, "user_id": 199475, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f655f91b22aa5f97fc50936c8b6c0cd7?s=128&d=identicon&r=PG", "display_name": "carbocation", "link": "https://stackoverflow.com/users/199475/carbocation"}, "edited": false, "score": 1, "creation_date": 1494097912, "post_id": 28596225, "comment_id": 74686883, "body": "Thank you for detailing this. This is very surprising. I ran into this when getting surprising errors while marshalling values into JSONB for Postgres."}, {"owner": {"reputation": 6974, "user_id": 199475, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f655f91b22aa5f97fc50936c8b6c0cd7?s=128&d=identicon&r=PG", "display_name": "carbocation", "link": "https://stackoverflow.com/users/199475/carbocation"}, "edited": false, "score": 7, "creation_date": 1494103193, "post_id": 28596225, "comment_id": 74688363, "body": "The final surprise (though it&#39;s well documented) is that Encode() adds a newline (\\n) to the end. So, to complete this normalization approach, you might consider strings.TrimRight(t, &quot;\\n&quot;)."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 39, "last_activity_date": 1513016935, "last_edit_date": 1513016935, "creation_date": 1424303484, "answer_id": 28596225, "question_id": 28595664, "link": "https://stackoverflow.com/questions/28595664/how-to-stop-json-marshal-from-escaping-and/28596225#28596225", "title": "How to stop json.Marshal from escaping &lt; and &gt;?", "body": "<p>As of Go 1.7, you still <strong>cannot do this with json.Marshal()</strong>.  The <a href=\"https://golang.org/src/encoding/json/encode.go?s=6551:6569#L161\" rel=\"noreferrer\">source code for json.Marshal</a> shows:</p>\n\n<pre><code>&gt; err := e.marshal(v, encOpts{escapeHTML: true})\n</code></pre>\n\n<p>The reason json.Marshal always does this is:</p>\n\n<blockquote>\n  <p>String values encode as JSON strings coerced to valid UTF-8,\n      replacing invalid bytes with the Unicode replacement rune.\n      The angle brackets \"&lt;\" and \">\" are escaped to \"\\u003c\" and \"\\u003e\"\n      to keep some browsers from misinterpreting JSON output as HTML.\n      Ampersand \"&amp;\" is also escaped to \"\\u0026\" for the same reason.</p>\n</blockquote>\n\n<p>This means you cannot even do it by writing a custom <code>func (t *Track) MarshalJSON()</code>, you have to use something that does not satisfy the <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"noreferrer\">json.Marshaler</a> interface.</p>\n\n<p>So, the workaround, is to write your own function:</p>\n\n<pre><code>func (t *Track) JSON() ([]byte, error) {\n    buffer := &amp;bytes.Buffer{}\n    encoder := json.NewEncoder(buffer)\n    encoder.SetEscapeHTML(false)\n    err := encoder.Encode(t)\n    return buffer.Bytes(), err\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/FAH-XS-QMC\" rel=\"noreferrer\">https://play.golang.org/p/FAH-XS-QMC</a></p>\n\n<p>If you want a generic solution for any struct, you could do:</p>\n\n<pre><code>func JSONMarshal(t interface{}) ([]byte, error) {\n    buffer := &amp;bytes.Buffer{}\n    encoder := json.NewEncoder(buffer)\n    encoder.SetEscapeHTML(false)\n    err := encoder.Encode(t)\n    return buffer.Bytes(), err\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/bdqv3TUGr3\" rel=\"noreferrer\">https://play.golang.org/p/bdqv3TUGr3</a></p>\n"}, {"tags": [], "owner": {"reputation": 1454, "user_id": 1407722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a6dde592c8e5f207759779786160c6b?s=128&d=identicon&r=PG", "display_name": "adrianlzt", "link": "https://stackoverflow.com/users/1407722/adrianlzt"}, "is_accepted": false, "score": 25, "last_activity_date": 1471867892, "creation_date": 1471867892, "answer_id": 39079218, "question_id": 28595664, "link": "https://stackoverflow.com/questions/28595664/how-to-stop-json-marshal-from-escaping-and/39079218#39079218", "title": "How to stop json.Marshal from escaping &lt; and &gt;?", "body": "<p>In Go1.7 the <a href=\"https://github.com/golang/go/commit/ab52ad894f453a02153fb2bc106d08c47ba643b6\" rel=\"noreferrer\">have added</a> a new option to fix this: </p>\n\n<blockquote>\n  <p>encoding/json:\n  add Encoder.DisableHTMLEscaping This provides a way to disable the escaping of &lt;, >, and &amp; in JSON strings.</p>\n</blockquote>\n\n<p>The relevant function is </p>\n\n<pre><code>func (*Encoder) SetEscapeHTML\n</code></pre>\n\n<p>That should be applied to a <em>Encoder</em>.</p>\n\n<pre><code>enc := json.NewEncoder(os.Stdout)\nenc.SetEscapeHTML(false)\n</code></pre>\n\n<p>Simple example: <a href=\"https://play.golang.org/p/SJM3KLkYW-\" rel=\"noreferrer\">https://play.golang.org/p/SJM3KLkYW-</a></p>\n"}, {"tags": [], "owner": {"reputation": 1212, "user_id": 860788, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/20af2492a79054768ebd40960d853e24?s=128&d=identicon&r=PG", "display_name": "Codefor", "link": "https://stackoverflow.com/users/860788/codefor"}, "is_accepted": false, "score": 0, "last_activity_date": 1492678529, "creation_date": 1492678529, "answer_id": 43514747, "question_id": 28595664, "link": "https://stackoverflow.com/questions/28595664/how-to-stop-json-marshal-from-escaping-and/43514747#43514747", "title": "How to stop json.Marshal from escaping &lt; and &gt;?", "body": "<p>No, you can't.</p>\n\n<p>A third-party json package might be the choice rather than the std json lib.</p>\n\n<p>More detail\uff1a<a href=\"https://github.com/golang/go/issues/8592\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/8592</a></p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3561452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jSjPZ.png?s=128&g=1", "display_name": "rupert.kim", "link": "https://stackoverflow.com/users/3561452/rupert-kim"}, "is_accepted": false, "score": -1, "last_activity_date": 1529668544, "creation_date": 1529668544, "answer_id": 50987398, "question_id": 28595664, "link": "https://stackoverflow.com/questions/28595664/how-to-stop-json-marshal-from-escaping-and/50987398#50987398", "title": "How to stop json.Marshal from escaping &lt; and &gt;?", "body": "<p>Custom function is not kind of the best solution.</p>\n\n<p>How about another library to solve this.\nI use <code>gabs</code></p>\n\n<p><strong>import</strong></p>\n\n<p><code>go get \"github.com/Jeffail/gabs\"</code></p>\n\n<p><strong>use</strong></p>\n\n<pre><code>message := new(Track)\nresultJson,_:=gabs.Consume(message)\n\nfmt.Println(string(resultJson.EncodeJSON()))\n</code></pre>\n\n<p>I solve that problem like this.</p>\n"}, {"comments": [{"owner": {"reputation": 9199, "user_id": 1215344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nuA7S.jpg?s=128&g=1", "display_name": "jamescampbell", "link": "https://stackoverflow.com/users/1215344/jamescampbell"}, "edited": false, "score": 0, "creation_date": 1616186679, "post_id": 51578927, "comment_id": 117933834, "body": "This helped me, thanks!"}], "tags": [], "owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "is_accepted": false, "score": 4, "last_activity_date": 1611860276, "last_edit_date": 1611860276, "creation_date": 1532856275, "answer_id": 51578927, "question_id": 28595664, "link": "https://stackoverflow.com/questions/28595664/how-to-stop-json-marshal-from-escaping-and/51578927#51578927", "title": "How to stop json.Marshal from escaping &lt; and &gt;?", "body": "<p>This doesn't answer the question directly but it could be an answer if you're looking for a way how to deal with <code>json.Marshal</code> escaping <code>&lt;</code> and <code>&gt;</code>...</p>\n<p>Another way to solve the problem is to replace those escaped characters in <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\"><code>json.RawMessage</code></a> into just valid UTF-8 characters, after the <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\"><code>json.Marshal()</code></a> call.</p>\n<p>It will work as well for any letters other than <code>&lt;</code> and <code>&gt;</code>. (I used to do this to make non-English letters to be human readable in JSON :D)</p>\n<pre><code>func _UnescapeUnicodeCharactersInJSON(_jsonRaw json.RawMessage) (json.RawMessage, error) {\n    str, err := strconv.Unquote(strings.Replace(strconv.Quote(string(_jsonRaw)), `\\\\u`, `\\u`, -1))\n    if err != nil {\n        return nil, err\n    }\n    return []byte(str), nil\n}\n\nfunc main() {\n    // Both are valid JSON.\n    var jsonRawEscaped json.RawMessage   // json raw with escaped unicode chars\n    var jsonRawUnescaped json.RawMessage // json raw with unescaped unicode chars\n\n    // '\\u263a' == '\u263a'\n    jsonRawEscaped = []byte(`{&quot;HelloWorld&quot;: &quot;\\uC548\\uB155, \\uC138\\uC0C1(\\u4E16\\u4E0A). \\u263a&quot;}`) // &quot;\\\\u263a&quot;\n    jsonRawUnescaped, _ = _UnescapeUnicodeCharactersInJSON(jsonRawEscaped)                        // &quot;\u263a&quot;\n\n    fmt.Println(string(jsonRawEscaped))   // {&quot;HelloWorld&quot;: &quot;\\uC548\\uB155, \\uC138\\uC0C1(\\u4E16\\u4E0A). \\u263a&quot;}\n    fmt.Println(string(jsonRawUnescaped)) // {&quot;HelloWorld&quot;: &quot;\uc548\ub155, \uc138\uc0c1(\u4e16\u4e0a). \u263a&quot;}\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/pUsrzrrcDG-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pUsrzrrcDG-</a></p>\n<p>I hope this helps someone.</p>\n"}], "owner": {"reputation": 1153, "user_id": 1371064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NnrmE.jpg?s=128&g=1", "display_name": "Carlos Andr&#233;s Garc&#237;a", "link": "https://stackoverflow.com/users/1371064/carlos-andr%c3%a9s-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21757, "favorite_count": 9, "accepted_answer_id": 28596225, "answer_count": 5, "score": 33, "last_activity_date": 1611860276, "creation_date": 1424300645, "last_edit_date": 1424300975, "question_id": 28595664, "link": "https://stackoverflow.com/questions/28595664/how-to-stop-json-marshal-from-escaping-and", "title": "How to stop json.Marshal from escaping &lt; and &gt;?", "body": "<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/json\"\n\ntype Track struct {\n    XmlRequest string `json:\"xmlRequest\"`\n}\n\nfunc main() {\n    message := new(Track)\n    message.XmlRequest = \"&lt;car&gt;&lt;mirror&gt;XML&lt;/mirror&gt;&lt;/car&gt;\"\n    fmt.Println(\"Before Marshal\", message)\n    messageJSON, _ := json.Marshal(message)\n    fmt.Println(\"After marshal\", string(messageJSON))\n}\n</code></pre>\n\n<p>Is it possible to make <code>json.Marshal</code> not escape <code>&lt;</code> and <code>&gt;</code>? I currently get:</p>\n\n<pre><code>{\"xmlRequest\":\"\\u003ccar\\u003e\\u003cmirror\\u003eXML\\u003c/mirror\\u003e\\u003c/car\\u003e\"}\n</code></pre>\n\n<p>but I am looking for something like this:</p>\n\n<pre><code>{\"xmlRequest\":\"&lt;car&gt;&lt;mirror&gt;XML&lt;/mirror&gt;&lt;/car&gt;\"}\n</code></pre>\n"}, {"tags": ["linux", "bash", "ssh", "go"], "comments": [{"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 3, "creation_date": 1424297362, "post_id": 28594880, "comment_id": 45496429, "body": "Where are you setting your go environment variables? <code>.bashrc</code>? <code>.bash_login</code>? <code>.profile</code>? Desktop environment startup?"}, {"owner": {"reputation": 25, "user_id": 4581492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f013dd6ad38eebd77acdd9bf3907449?s=128&d=identicon&r=PG&f=1", "display_name": "kris", "link": "https://stackoverflow.com/users/4581492/kris"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 1, "creation_date": 1424367190, "post_id": 28594880, "comment_id": 45529529, "body": "Fixed: I usually use .bashrc for environment variables, but for some reason I had modified .bash_profile to change the path for go."}], "answers": [{"tags": [], "owner": {"reputation": 10428, "user_id": 3135317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e914266956f4052eef356be7850ea49?s=128&d=identicon&r=PG&f=1", "display_name": "FoggyDay", "link": "https://stackoverflow.com/users/3135317/foggyday"}, "is_accepted": true, "score": 2, "last_activity_date": 1424297644, "last_edit_date": 1492086984, "creation_date": 1424297644, "answer_id": 28594977, "question_id": 28594880, "link": "https://stackoverflow.com/questions/28594880/why-would-go-build-file-go-work-fine-at-my-local-terminal-but-give-me-an-erro/28594977#28594977", "title": "Why would &#39;go build file.go&#39; work fine at my local terminal, but give me an error over SSH?", "body": "<p>Clearly your environment is different between your local (presumably GUI desktop) Ubuntu logon and your ssh logon.</p>\n\n<p>This isn't unexpected.</p>\n\n<p>SUGGESTION:</p>\n\n<p>1) Type \"env\" from your local Konsole GUI terminal.  Make note of the environment variables that are particularly important to you: PATH, GOPATH, GOROOT, etc.</p>\n\n<p>2) Edit your <code>$HOME/.profile</code> file (aka <code>~/.profile</code>).</p>\n\n<p>Explicitly set those variables.</p>\n\n<p>3) Try ssh again - see if there's any difference.</p>\n\n<p>See also:</p>\n\n<p><a href=\"https://unix.stackexchange.com/questions/101168/set-environment-variable-automatically-upon-ssh-login-no-root-access\">https://unix.stackexchange.com/questions/101168/set-environment-variable-automatically-upon-ssh-login-no-root-access</a></p>\n\n<p>You might also consider enabling remote VNC:</p>\n\n<p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-setup-vnc-for-ubuntu-12\" rel=\"nofollow noreferrer\">https://www.digitalocean.com/community/tutorials/how-to-setup-vnc-for-ubuntu-12</a></p>\n\n<p><a href=\"https://askubuntu.com/questions/304017/how-to-set-up-remote-desktop-sharing-through-ssh\">https://askubuntu.com/questions/304017/how-to-set-up-remote-desktop-sharing-through-ssh</a></p>\n"}], "owner": {"reputation": 25, "user_id": 4581492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f013dd6ad38eebd77acdd9bf3907449?s=128&d=identicon&r=PG&f=1", "display_name": "kris", "link": "https://stackoverflow.com/users/4581492/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 28594977, "answer_count": 1, "score": 0, "last_activity_date": 1424297644, "creation_date": 1424297290, "question_id": 28594880, "link": "https://stackoverflow.com/questions/28594880/why-would-go-build-file-go-work-fine-at-my-local-terminal-but-give-me-an-erro", "title": "Why would &#39;go build file.go&#39; work fine at my local terminal, but give me an error over SSH?", "body": "<p>When I run 'go build file.go' (or 'go install') at my local terminal (Konsole on ubuntu), my code builds correctly without any warnings. However, when I SSH (from another linux box or using PuTTY from Windows) into the exact same machine, I get the warning messages:</p>\n\n<blockquote>\n  <p>warning: GOPATH set to GOROOT (/home/[username]/go) has no effect go\n  build runtime: linux/amd64 must be bootstrapped using make.bash</p>\n</blockquote>\n\n<p>In terminal:<br>\n'go version' reports go1.3.3 linux/amd64<br>\n'which go' reports /usr/local/go/bin/go<br>\nOver SSH:<br>\n'go version' reports go1.2.1 linux/amd64<br>\n'which go' reports /home/[username]/go/bin/go</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": false, "score": 8, "last_activity_date": 1424297372, "creation_date": 1424297372, "answer_id": 28594906, "question_id": 28594876, "link": "https://stackoverflow.com/questions/28594876/why-is-it-possible-for-me-to-redeclare-a-const-in-go/28594906#28594906", "title": "Why is it possible for me to redeclare a const in go?", "body": "<p>It's a new constant in the scope of <code>main</code>. It doesn't change the one in the outer scope. Look up shadowing.</p>\n\n<p>This program demonstrates it well:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    const a = 0\n    fmt.Println(a)\n    {\n        const a = 1\n        fmt.Println(a)\n    }\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>The output is as follows:</p>\n\n<pre><code>0\n1\n0\n</code></pre>\n"}], "owner": {"reputation": 2144, "user_id": 1143357, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8aebc0e3ebfeb4bebe9d20140d373a27?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1143357/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1424297372, "creation_date": 1424297258, "question_id": 28594876, "link": "https://stackoverflow.com/questions/28594876/why-is-it-possible-for-me-to-redeclare-a-const-in-go", "title": "Why is it possible for me to redeclare a const in go?", "body": "<p>For exmaple </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nconst s string = \"constant\"\n\nfunc main() {\n    const s = 0\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>actually prints</p>\n\n<pre><code>0 \n</code></pre>\n\n<p>Yet I declared it as \"constant\" before main.</p>\n\n<p>I thought you were unable to change a constant. If this is not the case, why not use other types?</p>\n"}, {"tags": ["go", "linker", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1424299482, "post_id": 28595095, "comment_id": 45497458, "body": "Or more simply: <a href=\"https://github.com/golang/go/wiki/cgo#global-functions\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/cgo#global-functions</a>. The slides you referenced are very old and no longer applicable."}, {"owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1424321144, "post_id": 28595095, "comment_id": 45503733, "body": "thaks @JimB, it&#39;s very helpful link."}, {"owner": {"reputation": 1037, "user_id": 1070486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a5ce3caa2e39211059ca4ee29ca1fdfe?s=128&d=identicon&r=PG", "display_name": "zgcharley", "link": "https://stackoverflow.com/users/1070486/zgcharley"}, "edited": false, "score": 0, "creation_date": 1505847570, "post_id": 28595095, "comment_id": 79577721, "body": "Get another issue with this sample: <b>Undefined symbols for architecture x86_64:   &quot;_myprint&quot;, referenced from:...</b>.   Don&#39;t understand why I get this error, seems everything is included normally."}, {"owner": {"reputation": 1387, "user_id": 3959385, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/100000205094443/picture?type=large", "display_name": "Ertu\u011frul Alt\u0131nbo\u011fa", "link": "https://stackoverflow.com/users/3959385/ertu%c4%9frul-alt%c4%b1nbo%c4%9fa"}, "reply_to_user": {"reputation": 1037, "user_id": 1070486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a5ce3caa2e39211059ca4ee29ca1fdfe?s=128&d=identicon&r=PG", "display_name": "zgcharley", "link": "https://stackoverflow.com/users/1070486/zgcharley"}, "edited": false, "score": 0, "creation_date": 1586848624, "post_id": 28595095, "comment_id": 108271212, "body": "@zgcharley You can run <code>go clean -cache</code> and then try again."}], "tags": [], "owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "is_accepted": true, "score": 4, "last_activity_date": 1598077615, "last_edit_date": 1598077615, "creation_date": 1424298116, "answer_id": 28595095, "question_id": 28593574, "link": "https://stackoverflow.com/questions/28593574/cgo-undefined-symbols-for-architecture-x86-64/28595095#28595095", "title": "cgo : Undefined symbols for architecture x86_64", "body": "<p>Duplicate symbols are generated because I have included the <code>test.c</code> directly to the go file. So the symbols are included twice.</p>\n<p>I think, the correct way of writing this code is (please comment if I am wrong) to:</p>\n<ol>\n<li><p>Define the header file (test.h):</p>\n<pre><code> #ifndef TEST_H_\n #define TEST_H_\n\n char* myprint(char *msg);\n\n #endif\n</code></pre>\n</li>\n<li><p>Define the implementation file (test.c):</p>\n<pre><code>  #include &lt;stdio.h&gt;\n  #include &quot;test.h&quot;\n\n  extern void receiveC(char *msg);\n\n  char* myprint(char *msg) {\n      receiveC(msg);\n      return msg;\n   }\n</code></pre>\n</li>\n<li><p>Include the <code>.h</code> file to the <code>go</code> file (example.go) :</p>\n<pre><code>  package main\n  /*\n  #include &quot;test.h&quot;\n  */\n  import &quot;C&quot;\n  import &quot;fmt&quot;\n\n  func Example() {\n       fmt.Println(&quot;this is go&quot;)\n       fmt.Println(C.GoString(C.myprint(C.CString(&quot;go!!&quot;))))\n   }\n\n   // make sure that there should be no space between the `//` and `export`\n   //export receiveC\n   func receiveC(msg *C.char) {\n         fmt.Println(C.GoString(msg))\n   }\n\n   func main() {\n        Example()\n   }\n</code></pre>\n</li>\n<li><p>Build the program :</p>\n<pre><code>  go build\n</code></pre>\n</li>\n<li><p>run the generated executable (the executable file generate with the <code>cgo</code> name, need some investigation to find the reason).</p>\n<pre><code>  $./cgo\n</code></pre>\n</li>\n</ol>\n"}], "owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5954, "favorite_count": 0, "accepted_answer_id": 28595095, "answer_count": 1, "score": 4, "last_activity_date": 1598077615, "creation_date": 1424292346, "last_edit_date": 1424295097, "question_id": 28593574, "link": "https://stackoverflow.com/questions/28593574/cgo-undefined-symbols-for-architecture-x86-64", "title": "cgo : Undefined symbols for architecture x86_64", "body": "<p>I would like to call the go func from the C function space, but the program throws the build error.</p>\n\n<p>example.go</p>\n\n<pre><code>package main\n\n/*\n#include \"test.c\"\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc Example() {\n    fmt.Println(\"this is go\")\n    fmt.Println(C.GoString(C.myprint(C.CString(\"go!!\"))))\n}\n\n// export receiveC              (remove the extra space between // and export)\nfunc receiveC(msg *C.char) {\n    fmt.Println(C.GoString(msg))\n}\n\nfunc main() {\n    Example()\n}\n</code></pre>\n\n<p>test.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nextern void receiveC(char *msg);\n\nchar* myprint(char *msg) {\n    receiveC(msg);  // calling the exported go function\n    return msg;     \n    }\n</code></pre>\n\n<p>When I execute the command to run/build (<code>go build</code> or <code>go run example.go</code> or <code>go build example.go</code>) the program, it throws the error:</p>\n\n<pre><code># github.com/subh007/goodl/cgo\nUndefined symbols for architecture x86_64:\n  \"_receiveC\", referenced from:\n      _myprint in example.cgo2.o\n      __cgo_6037ec60b2ba_Cfunc_myprint in example.cgo2.o\n      _myprint in test.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>I am following the <a href=\"http://akrennmair.github.io/golang-cgo-slides/#5\" rel=\"nofollow\">cgo slides</a> to writing the program. Please let me know for any mistakes here.</p>\n\n<p>Edit1: I am using OS-X 10.9 OS.</p>\n\n<p>Edit2:\nI have one extra space between <code>// export</code>, there should be no space between <code>//</code> and <code>export</code>. But now I am getting the following error while building :</p>\n\n<pre><code># github.com/subh007/goodl/cgo\nduplicate symbol _myprint in:\n    $WORK/github.com/subh007/goodl/cgo/_obj/_cgo_export.o\n    $WORK/github.com/subh007/goodl/cgo/_obj/example.cgo2.o\nduplicate symbol _receiver_go in:\n    $WORK/github.com/subh007/goodl/cgo/_obj/_cgo_export.o\n    $WORK/github.com/subh007/goodl/cgo/_obj/example.cgo2.o\nduplicate symbol _myprint in:\n    $WORK/github.com/subh007/goodl/cgo/_obj/_cgo_export.o\n    $WORK/github.com/subh007/goodl/cgo/_obj/test.o\nduplicate symbol _receiver_go in:\n    $WORK/github.com/subh007/goodl/cgo/_obj/_cgo_export.o\n    $WORK/github.com/subh007/goodl/cgo/_obj/test.o\nld: 4 duplicate symbols for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 1, "creation_date": 1424290406, "post_id": 28592661, "comment_id": 45492546, "body": "What would you reflect on? The above code compiles fine. What problem do you have?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1424300485, "post_id": 28592661, "comment_id": 45497884, "body": "One normally uses a <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> for this. What are you trying to do with reflection?"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 2062175, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fc0e114424d432b14dd6d13a29919359?s=128&d=identicon&r=PG", "display_name": "Ary Purnomoz", "link": "https://stackoverflow.com/users/2062175/ary-purnomoz"}, "edited": false, "score": 0, "creation_date": 1424370832, "post_id": 28613656, "comment_id": 45531640, "body": "so there is no way to set a field with interface as the type?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 131, "user_id": 2062175, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fc0e114424d432b14dd6d13a29919359?s=128&d=identicon&r=PG", "display_name": "Ary Purnomoz", "link": "https://stackoverflow.com/users/2062175/ary-purnomoz"}, "edited": false, "score": 0, "creation_date": 1424371900, "post_id": 28613656, "comment_id": 45532219, "body": "Sure you can. It doesn&#39;t matter what the type of the field is as long as it&#39;s a valid assignment. Your original question doesn&#39;t make sense, and may be the source of your confusion, because there&#39;s no such thing as an &quot;interface field&quot;. Interfaces only define a method set. You need the value contained in the interface, which you can get via <code>Elem()</code> (or <code>reflect.Indirect()</code>)."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1424373745, "last_edit_date": 1424373745, "creation_date": 1424369019, "answer_id": 28613656, "question_id": 28592661, "link": "https://stackoverflow.com/questions/28592661/set-a-struct-field-with-field-type-of-a-interface/28613656#28613656", "title": "Set a struct field with field type of a interface", "body": "<p>Interfaces don't have fields, they only define a method set of the value they contain. When reflecting on an interface, you can extract the value with <a href=\"http://golang.org/pkg/reflect/#Value.Elem\" rel=\"nofollow\"><code>Value.Elem()</code></a>.</p>\n\n<p>You also can't <code>Set</code> unexported fields. You need to capitalize the field names in your <code>B</code> type. When iterating over the fields, use <a href=\"http://golang.org/pkg/reflect/#Value.CanSet\" rel=\"nofollow\"><code>Value.CanSet()</code></a> to test if they are settable. <code>CanSet()</code> will also return false is the value isn't addressable, or the value is still in an interface.</p>\n\n<p>A working example of your code:\n<a href=\"http://play.golang.org/p/Mf1HENRSny\" rel=\"nofollow\">http://play.golang.org/p/Mf1HENRSny</a></p>\n"}], "owner": {"reputation": 131, "user_id": 2062175, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fc0e114424d432b14dd6d13a29919359?s=128&d=identicon&r=PG", "display_name": "Ary Purnomoz", "link": "https://stackoverflow.com/users/2062175/ary-purnomoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6871, "favorite_count": 1, "accepted_answer_id": 28613656, "answer_count": 1, "score": 2, "last_activity_date": 1499871507, "creation_date": 1424289203, "last_edit_date": 1499871507, "question_id": 28592661, "link": "https://stackoverflow.com/questions/28592661/set-a-struct-field-with-field-type-of-a-interface", "title": "Set a struct field with field type of a interface", "body": "<p>Is there any way to set an interface field using reflect? When i tried to set it, it paniced saying that the value is non addressable.</p>\n\n<pre><code>type A interface{...}\n\nfunc CreateA(name string) A {...}\n\ntype B struct {\n   field A\n   should A\n   mirror A\n}\n\n// normal way of initializing\nvar b = B{\n  field: CreateA(\"field\"),\n  should: CreateA(\"should\"),\n  mirror: CreateA(\"mirror\"),\n}\n\nfunc MirrorField(b *B) {\n   t := reflect.TypeOf(b)\n   v := reflect.ValueOf(b)\n   for i := 0; i &lt; t.NumField(); i++ {\n      setTo = CreateA(t.Field(1).Name)\n      fieldVal := v.Field(i)\n      fieldVal.Set(reflect.ValueOf(setTo))\n   }\n}\n\n// what i want is something like\nvar b = &amp;B{}\nMirrorField(b)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1115652"}, "edited": false, "score": 3, "creation_date": 1424285890, "post_id": 28591664, "comment_id": 45489761, "body": "You probably will need a library, for that, in which case the question would be off topic..."}, {"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1424295960, "post_id": 28591664, "comment_id": 45495707, "body": "perhaps there&#39;s a go library for SDL..."}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 5, "creation_date": 1424315319, "post_id": 28591664, "comment_id": 45502296, "body": "There are go Binding for portaudio (<a href=\"https://code.google.com/p/portaudio-go/\" rel=\"nofollow noreferrer\">code.google.com/p/portaudio-go</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "edited": false, "score": 5, "creation_date": 1486646677, "post_id": 29962554, "comment_id": 71441961, "body": "Is there any library for playing audio files that fully written in Go?"}], "tags": [], "owner": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "is_accepted": true, "score": 14, "last_activity_date": 1474960548, "last_edit_date": 1474960548, "creation_date": 1430381974, "answer_id": 29962554, "question_id": 28591664, "link": "https://stackoverflow.com/questions/28591664/playing-audio-file-with-golang/29962554#29962554", "title": "Playing audio file with golang", "body": "<p>You could use the PortAudio Go bindings (<code>go get github.com/gordonklaus/portaudio</code>) for this.</p>\n\n<p>You will have to build or install PortAudio on your system. Consult <a href=\"http://portaudio.com/docs/v19-doxydocs/tutorial_start.html\" rel=\"noreferrer\">http://portaudio.com/docs/v19-doxydocs/tutorial_start.html</a> for this.</p>\n\n<p>A complete example for playing back a sound file is located at <a href=\"https://github.com/gordonklaus/portaudio/blob/master/examples/play.go\" rel=\"noreferrer\">https://github.com/gordonklaus/portaudio/blob/master/examples/play.go</a></p>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 5186824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ahpzl.jpg?s=128&g=1", "display_name": "Mehmetcan Burak Karaoglan", "link": "https://stackoverflow.com/users/5186824/mehmetcan-burak-karaoglan"}, "edited": false, "score": 2, "creation_date": 1550959488, "post_id": 51525653, "comment_id": 96466049, "body": "how can i use go-mp3 library to run mp3? any snippet?"}], "tags": [], "owner": {"reputation": 12214, "user_id": 6785908, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4d260895797435b1e59b3c2154a469f7?s=128&d=identicon&r=PG&f=1", "display_name": "so-random-dude", "link": "https://stackoverflow.com/users/6785908/so-random-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1532543875, "creation_date": 1532543875, "answer_id": 51525653, "question_id": 28591664, "link": "https://stackoverflow.com/questions/28591664/playing-audio-file-with-golang/51525653#51525653", "title": "Playing audio file with golang", "body": "<p>If it's an MP3 file, you can use <a href=\"https://github.com/hajimehoshi/go-mp3\" rel=\"nofollow noreferrer\">go-mp3</a> Library. go-mp3 is popular library to play MP3; MP3 decoder is in pure Go.</p>\n\n<p>Or this one, <a href=\"https://github.com/faiface/beep\" rel=\"nofollow noreferrer\">https://github.com/faiface/beep</a>. Beep uses go-mp3 under the hood</p>\n"}], "owner": {"reputation": 177, "user_id": 4008560, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/811dd4122ff74da5be1935031a8910eb?s=128&d=identicon&r=PG&f=1", "display_name": "Ramirex", "link": "https://stackoverflow.com/users/4008560/ramirex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19258, "favorite_count": 2, "accepted_answer_id": 29962554, "answer_count": 2, "score": 15, "last_activity_date": 1537812565, "creation_date": 1424285826, "last_edit_date": 1474835549, "question_id": 28591664, "link": "https://stackoverflow.com/questions/28591664/playing-audio-file-with-golang", "title": "Playing audio file with golang", "body": "<p>How one would play audio file in go language?</p>\n\n<p>I have function and want sound to be played as notification when event happens.</p>\n\n<p>I could not find anything about playing sound file in go lang just some web browser based music players but it wasnt helpful too much.</p>\n"}, {"tags": ["rest", "go"], "answers": [{"comments": [{"owner": {"reputation": 23431, "user_id": 719363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76ca4397a6ec4aa8fcf85dc53e1cbab6?s=128&d=identicon&r=PG", "display_name": "Alex Gitelman", "link": "https://stackoverflow.com/users/719363/alex-gitelman"}, "edited": false, "score": 0, "creation_date": 1424293070, "post_id": 28592098, "comment_id": 45494073, "body": "yes, you are right. In my answer I missed that <code>:=</code> with api assignment. And global var surely needs to be a pointer as you pointed out."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 12, "last_activity_date": 1424287337, "creation_date": 1424287337, "answer_id": 28592098, "question_id": 28591530, "link": "https://stackoverflow.com/questions/28591530/using-a-global-variable-in-golang/28592098#28592098", "title": "Using a global variable in golang", "body": "<p>Your problem is two fold...</p>\n\n<p>For one, you declare </p>\n\n<pre><code>var api rest.Api\n</code></pre>\n\n<p>but the rest.New() returns a *rest.Api</p>\n\n<pre><code>func NewApi() *Api {\n</code></pre>\n\n<p>Secondly, in your <code>foo()</code> function, you are creating a local variable called <code>api</code> instead of using your package variable.</p>\n\n<p>Instead of </p>\n\n<pre><code>api := rest.NewApi()\n</code></pre>\n\n<p>It should be </p>\n\n<pre><code>api = rest.NewApi()\n</code></pre>\n\n<p>So, the fix is to add a <code>*</code> before <code>rest.Api</code> as in <code>var api *rest.Api</code> and remove a colon from the setting of api as in <code>api = rest.NewApi()</code></p>\n"}], "owner": {"reputation": 1579, "user_id": 1354514, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e83e6f559891e7489995dfa43e010fa3?s=128&d=identicon&r=PG", "display_name": "steve landiss", "link": "https://stackoverflow.com/users/1354514/steve-landiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5038, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1490684945, "creation_date": 1424285391, "last_edit_date": 1490684945, "question_id": 28591530, "link": "https://stackoverflow.com/questions/28591530/using-a-global-variable-in-golang", "title": "Using a global variable in golang", "body": "<p>I have a global variable that I am trying to use across two different functions, and unable to figure out why the following code is not working...</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/ant0ine/go-json-rest/rest\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n)\n\ntype Message struct {\n    Body string\n}\n\nvar api rest.Api\n\nfunc hostLookup(w rest.ResponseWriter, req *rest.Request) {\n    ip, err := net.LookupIP(req.PathParam(\"host\"))\n    if err != nil {\n        rest.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    w.WriteJson(&amp;ip)\n}\n\nfunc foo() {\n    api := rest.NewApi()\n    api.Use(rest.DefaultDevStack...)\n    router, err := rest.MakeRouter(\n        &amp;rest.Route{\"GET\", \"/lookup/#host\", hostLookup},\n    )\n    if err != nil {\n        log.Fatal(err)\n    }\n    api.SetApp(router)\n}\n\nfunc bar() {\n    log.Fatal(http.ListenAndServe(\":8080\", api.MakeHandler()))\n}\n\nfunc main() {\n    foo()\n\n    bar()\n\n}\n</code></pre>\n\n<p>The above code does not work... the HTTP server does not route the request to the hostLookup function.</p>\n\n<p>However - if I move the following line from bar()</p>\n\n<pre><code>log.Fatal(http.ListenAndServe(\":8080\", api.MakeHandler()))\n</code></pre>\n\n<p>to the end of function foo(), then it works correctly</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["json", "encoding", "go"], "comments": [{"owner": {"reputation": 3090, "user_id": 2058368, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/H5ykG.jpg?s=128&g=1", "display_name": "Sandeep Chatterjee", "link": "https://stackoverflow.com/users/2058368/sandeep-chatterjee"}, "edited": false, "score": 0, "creation_date": 1424282512, "post_id": 28590538, "comment_id": 45487768, "body": "Isn&#39;t this a better fit for <a href=\"http://codereview.stackexchange.com/\">CodeReview</a>?"}, {"owner": {"reputation": 16811, "user_id": 1305253, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/455f776955f148ffad8174a9b69aa4ba?s=128&d=identicon&r=PG", "display_name": "rolfl", "link": "https://stackoverflow.com/users/1305253/rolfl"}, "edited": false, "score": 2, "creation_date": 1424282982, "post_id": 28590538, "comment_id": 45488059, "body": "This appears to be a specific programming question, and not a request for a code review: <i>But I&#39;m wondering if behind the scenes I&#39;m incurring a performance penalty (reflecting) when I decode the object from JSON and again when I later marshal it to JSON</i>"}, {"owner": {"reputation": 3090, "user_id": 2058368, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/H5ykG.jpg?s=128&g=1", "display_name": "Sandeep Chatterjee", "link": "https://stackoverflow.com/users/2058368/sandeep-chatterjee"}, "edited": false, "score": 0, "creation_date": 1424283608, "post_id": 28590538, "comment_id": 45488411, "body": "Yes, but the OP also mentions <code>Functionally, this works fine.</code> :)"}, {"owner": {"reputation": 3183, "user_id": 1214743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9CsNP.png?s=128&g=1", "display_name": "Malachi", "link": "https://stackoverflow.com/users/1214743/malachi"}, "reply_to_user": {"reputation": 16811, "user_id": 1305253, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/455f776955f148ffad8174a9b69aa4ba?s=128&d=identicon&r=PG", "display_name": "rolfl", "link": "https://stackoverflow.com/users/1305253/rolfl"}, "edited": false, "score": 0, "creation_date": 1424284810, "post_id": 28590538, "comment_id": 45489109, "body": "I am with @rolfl on this one. it is about a specific programming issue not a review of the code."}], "answers": [{"comments": [{"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1424289147, "post_id": 28591240, "comment_id": 45491782, "body": "That makes sense -- I&#39;m also in the latter case, just outputting the data. But is there a performance difference in doing it one way vs another?"}, {"owner": {"reputation": 4635, "user_id": 1411589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2a6b1a1c31198db776d76af7f04c1bbd?s=128&d=identicon&r=PG", "display_name": "deepakssn", "link": "https://stackoverflow.com/users/1411589/deepakssn"}, "edited": false, "score": 1, "creation_date": 1545709511, "post_id": 28591240, "comment_id": 94680897, "body": "Interesting, I expected struct to be faster as the program knows what to expect. @sberry, do you know why interface is faster than struct?"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 3, "last_activity_date": 1424292099, "last_edit_date": 1424292099, "creation_date": 1424284438, "answer_id": 28591240, "question_id": 28590538, "link": "https://stackoverflow.com/questions/28590538/is-it-bad-practice-in-go-to-json-decode-a-json-object-to-an-empty-interface/28591240#28591240", "title": "Is it bad practice in Go to json.Decode a json object to an empty interface?", "body": "<p>It depends entirely on what you intend on doing with the Unmarshalled data.  </p>\n\n<p>If you have nested objects / arrays in your json data, then you will end up with nested interfaces.  That means you need to explicitly convert your interfaces to the correct type to access their data.  In that case you are far better off using the struct in the second example as you will have your data more easily accessible as in <code>myData.Items[0].CustomizationState.Areas[0].Height</code>.  Doing that with nested interface conversion is going to be a pain.</p>\n\n<p>On the other hand, if you are just outputting this data, for example as a response to a webservice call, then you don't need to know the structure and can just spit it back out.</p>\n\n<p>Personally, I always use the latter.</p>\n\n<p>I assume you are using the awesome service at <a href=\"http://mervine.net/json2struct\" rel=\"nofollow\">http://mervine.net/json2struct</a> to convert your json into usable Go structs.</p>\n\n<p>Here is a link showing the difference in ease of access between the two methods.\n<a href=\"http://play.golang.org/p/OlJJPZcxT7\" rel=\"nofollow\">http://play.golang.org/p/OlJJPZcxT7</a></p>\n\n<p>And for those who want to stay in-page:</p>\n\n<pre><code>var dataz = `{\"foo\": [\"bar\", \"baz\"], \"boff\": {\"foo\": \"bar\", \"baz\": \"boff\"}}`\n\ntype Dataz struct {\n    Foo  []string `json:\"foo\"`\n    Boff struct {\n        Foo string `json:\"foo\"`\n        Baz string `json:\"baz\"`\n    } `json:\"boff\"`\n}\n\nfunc main() {\n    // Method 1\n    var d interface{}\n    json.Unmarshal([]byte(dataz), &amp;d)\n    fmt.Println(d.(map[string]interface{})[\"foo\"].([]interface{})[0])\n\n    // Method 2\n    var D Dataz\n    json.Unmarshal([]byte(dataz), &amp;D)\n    fmt.Println(D.Foo[0])\n}\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nEdit based on comment about performance</p>\n\n<p>Thankfully we can test it with built-in Go tools</p>\n\n<pre><code>&gt; go test -bench .\ntesting: warning: no tests to run\nPASS\nBenchmarkInterface    300000          6208 ns/op\nBenchmarkStruct       500000          3622 ns/op\nok      parse   3.773s\n</code></pre>\n\n<p>It's the difference between handling unmarshalling of 276,000/sec or 161,000/sec.  So this will almost certainly not be your bottleneck.  :)</p>\n"}], "owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1897, "favorite_count": 0, "accepted_answer_id": 28591240, "answer_count": 1, "score": 3, "last_activity_date": 1424292371, "creation_date": 1424282233, "last_edit_date": 1424292371, "question_id": 28590538, "link": "https://stackoverflow.com/questions/28590538/is-it-bad-practice-in-go-to-json-decode-a-json-object-to-an-empty-interface", "title": "Is it bad practice in Go to json.Decode a json object to an empty interface?", "body": "<p>I have a fairly large nested JSON object I want to decode. I could decode this to a well defined nested struct, but an alternate solution I've seen is to just decode it to an empty interface.</p>\n\n<p>Functionally, this works fine. But I'm wondering if behind the scenes I'm incurring a performance penalty (reflecting) when I decode the object from JSON and again when I later marshal it to JSON.</p>\n\n<p>Thoughts? Thanks in advance.</p>\n\n<p>Code:</p>\n\n<pre><code>CustomizationData    interface{} `json:\"customizationData\" datastore:\"-\"`\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>CustomizationData    struct {\n    Items []struct {\n        ID     string `json:\"id\"`\n        Images []struct {\n            CustomizationState struct {\n                Areas []struct {\n                    Height float64 `json:\"height\"`\n                    ID     string  `json:\"id\"`\n                    Left   float64 `json:\"left\"`\n                    Parent struct {\n                        Height float64 `json:\"height\"`\n                        Left   float64 `json:\"left\"`\n                        Top    float64 `json:\"top\"`\n                        Width  float64 `json:\"width\"`\n                    } `json:\"parent\"`\n                    Rotation float64 `json:\"rotation\"`\n                    Text     string  `json:\"text\"`\n                    Top      float64 `json:\"top\"`\n                    URL      string  `json:\"url\"`\n                    Width    float64 `json:\"width\"`\n                } `json:\"areas\"`\n                BackgroundColor string  `json:\"backgroundColor\"`\n                IsUserSet       bool    `json:\"isUserSet\"`\n                Orientation     float64 `json:\"orientation\"`\n            } `json:\"customizationState\"`\n            SpaceId string `json:\"spaceId\"`\n        } `json:\"images\"`\n        ProductId    float64 `json:\"productId\"`\n        Quantity     float64 `json:\"quantity\"`\n        Sku          string  `json:\"sku\"`\n        TemplateName string  `json:\"templateName\"`\n    } `json:\"items\"`\n    ShippingAddress struct {\n        City        string `json:\"city\"`\n        CountryCode string `json:\"countryCode\"`\n        Email       string `json:\"email\"`\n        FirstName   string `json:\"firstName\"`\n        LastName    string `json:\"lastName\"`\n        Line1       string `json:\"line1\"`\n        Phone       string `json:\"phone\"`\n        PostalCode  string `json:\"postalCode\"`\n        State       string `json:\"state\"`\n    } `json:\"shippingAddress\"`\n    TimeStamp string `json:\"timeStamp\"`\n} `json:\"customizationData\" datastore:\"-\"\n</code></pre>\n\n<p>And potentially more.</p>\n"}, {"tags": ["unit-testing", "google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "edited": false, "score": 1, "creation_date": 1433348266, "post_id": 28595759, "comment_id": 49316960, "body": "In general sleeping is a poor way of handling it, as it slows down the tests, and sometimes 100ms is enough, but sometimes it&#39;s not.  Then you end up with tests that intermittently pass."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "edited": false, "score": 0, "creation_date": 1433349241, "post_id": 28595759, "comment_id": 49317532, "body": "@JohnGB I agree, but as far as I know, the SDK simulates a fixed delay so the behaviour is deterministic. But nevertheless, sleep is not the most elegant way."}, {"owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "edited": false, "score": 0, "creation_date": 1433355757, "post_id": 28595759, "comment_id": 49321442, "body": "it may have changed, but when I was trying to solve this problem, the SDK implemented a statistical delay to simulate the delay in the live datastore.  Sometimes I would sleep (I used this before I found a solution) for 4 seconds and still run into consistency issues.  I can&#39;t comment on how current this is though."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1461354537, "last_edit_date": 1461354537, "creation_date": 1424301058, "answer_id": 28595759, "question_id": 28590519, "link": "https://stackoverflow.com/questions/28590519/google-app-engine-datastore-testing-queries-fails/28595759#28595759", "title": "Google App Engine Datastore - Testing Queries fails", "body": "<p>There is nothing wrong with your test code. The issue lies in the Datastore itself. Most queries in the HR Datastore are not \"immediately consistent\" but <a href=\"http://en.wikipedia.org/wiki/Eventual_consistency\" rel=\"nofollow\">eventually consistent</a>. You can read more about this in the <a href=\"https://cloud.google.com/appengine/docs/go/datastore/\" rel=\"nofollow\">Datastore</a> documentation.</p>\n\n<p>So basically what happens is that you put an entity into the Datastore, and the SDK's Datastore \"simulates\" the latency that you can observe in production, so if you run a query right after that (which is not an ancestor query), the query result will not include the new entity you just saved.</p>\n\n<p>If you put a few seconds sleep between the <code>datastore.Put()</code> and <code>q.GetAll()</code>, you will see the test passes. Try it. In my test it was enough to sleep just 100ms, and the test always passed. But when writing tests for such cases, use the <code>StronglyConsistentDatastore: true</code> option as can be seen in JonhGB's answer.</p>\n\n<p>You would also see the test pass without sleep if you'd use <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Query.Ancestor\" rel=\"nofollow\">Ancestor queries</a> because they are <a href=\"https://en.wikipedia.org/wiki/Strong_consistency\" rel=\"nofollow\">strongly consistent</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "edited": false, "score": 0, "creation_date": 1433346416, "post_id": 30624845, "comment_id": 49315750, "body": "Very neat! I&#39;ll give this a try"}, {"owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "reply_to_user": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "edited": false, "score": 0, "creation_date": 1452197619, "post_id": 30624845, "comment_id": 57074010, "body": "Please note, that with the new aetest package, this no longer works."}], "tags": [], "owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "is_accepted": false, "score": 5, "last_activity_date": 1452762971, "last_edit_date": 1452762971, "creation_date": 1433346357, "answer_id": 30624845, "question_id": 28590519, "link": "https://stackoverflow.com/questions/28590519/google-app-engine-datastore-testing-queries-fails/30624845#30624845", "title": "Google App Engine Datastore - Testing Queries fails", "body": "<p>The way to do this is to force the datastore to be strongly consistent by setting up the context like this:</p>\n\n<pre><code>c, err := aetest.NewContext(&amp;aetest.Options{StronglyConsistentDatastore: true})\n    if err != nil {\n        t.Fatal(err)\n    }\n</code></pre>\n\n<p>Now the datastore won't need any sleep to work, which is faster, and better practice in general.</p>\n\n<hr>\n\n<p><strong>Update:</strong> This only works with the old aetest package which was imported via <code>appengine/aetest</code>.  It does not work with the newer aetest package which is imported with <code>google.golang.org/appengine/aetest</code>.  App Engine has changed from using an <code>appengine.Context</code> to using a <code>context.Context</code>, and consequently the way that the test package now works is quite different.</p>\n"}, {"tags": [], "owner": {"reputation": 485, "user_id": 193827, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5XtvU.jpg?s=128&g=1", "display_name": "MrWizard54", "link": "https://stackoverflow.com/users/193827/mrwizard54"}, "is_accepted": false, "score": 3, "last_activity_date": 1473618707, "creation_date": 1473618707, "answer_id": 39439349, "question_id": 28590519, "link": "https://stackoverflow.com/questions/28590519/google-app-engine-datastore-testing-queries-fails/39439349#39439349", "title": "Google App Engine Datastore - Testing Queries fails", "body": "<p>To compliment @JohnGB's answer in the latest version of aetest, there are more steps to get a context with strong consistency.  First create an instance, then create a request from that instance, which you can use to produce a context.    </p>\n\n<pre><code>inst, err := aetest.NewInstance(\n&amp;aetest.Options{StronglyConsistentDatastore: true})\n\nif err != nil {\n    t.Fatal(err)\n}\ndefer inst.Close()\n\nreq, err := inst.NewRequest(\"GET\", \"/\", nil)\nif err != nil {\n    t.Fatal(err)\n}\n\nctx := appengine.NewContext(req)\n</code></pre>\n"}], "owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 1, "accepted_answer_id": 28595759, "answer_count": 3, "score": 4, "last_activity_date": 1474845219, "creation_date": 1424282184, "last_edit_date": 1474845219, "question_id": 28590519, "link": "https://stackoverflow.com/questions/28590519/google-app-engine-datastore-testing-queries-fails", "title": "Google App Engine Datastore - Testing Queries fails", "body": "<p>I am currently trying to test a piece of my code that runs a query on the datastore before putting in a new entity to ensure that duplicates are not created. The code I wrote works fine in the context of the app, but the tests I wrote for that methods are failing. It seems that I cannot access data put into the datastore through queries in the context of the testing package.</p>\n\n<p>One possibility might lie in the output from <code>goapp test</code> which reads: <code>Applying all pending transactions and saving the datastore</code>. This line prints out after both the get and put methods are called (I verified this with log statements).</p>\n\n<p>I tried closing the context and creating a new one for the different operations, but unfortunately that didn't help either. Below is a simple test case that Puts in an object and then runs a query on it. Any help would be appreciated.</p>\n\n<pre><code>type Entity struct {\n    Value string\n}\n\nfunc TestEntityQuery(t *testing.T) {\n    c, err := aetest.NewContext(nil)\n    if err != nil {\n        t.Fatal(err)\n    }\n    defer c.Close()\n\n    key := datastore.NewIncompleteKey(c, \"Entity\", nil)\n    key, err = datastore.Put(c, key, &amp;Entity{Value: \"test\"})\n    if err != nil {\n        t.Fatal(err)\n    }\n\n    q := datastore.NewQuery(\"Entity\").Filter(\"Value =\", \"test\")\n    var entities []Entity\n    keys, err := q.GetAll(c, &amp;entities)\n    if err != nil {\n        t.Fatal(err)\n    }\n    if len(keys) == 0 {\n        t.Error(\"No keys found in query\")\n    }\n    if len(entities) == 0 {\n        t.Error(\"No entities found in query\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1424267597, "post_id": 28585329, "comment_id": 45477866, "body": "how would you do it?"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 2, "last_activity_date": 1424267560, "creation_date": 1424267560, "answer_id": 28585329, "question_id": 28585230, "link": "https://stackoverflow.com/questions/28585230/share-code-in-severel-lines/28585329#28585329", "title": "Share code in severel lines", "body": "<p>This is kind of ugly, but the only way I know of:</p>\n\n<pre><code>for _, e := range methods {\n    switch e {\n    case \"GET\":\n        if len(name) &gt; 0 {\n            router.Handle(path, httpAjaxFunc(handler)).\n                  Methods(e).\n                  Headers(\"X-Requested-With\", \"XMLHttpRequest\", \"Payload\", \"\").\n                  Name(name[0])\n        } else {\n            router.Handle(path, httpAjaxFunc(handler)).\n                  Methods(e).\n                  Headers(\"X-Requested-With\", \"XMLHttpRequest\", \"Payload\", \"\")\n        }\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1424270977, "accepted_answer_id": 28585329, "answer_count": 1, "score": 0, "last_activity_date": 1424267560, "creation_date": 1424267301, "question_id": 28585230, "link": "https://stackoverflow.com/questions/28585230/share-code-in-severel-lines", "closed_reason": "Duplicate", "title": "Share code in severel lines", "body": "<p>For readability, I split method chaining into multi lines:</p>\n\n<pre><code>for _, e := range methods {\n    switch e {\n    case \"GET\":\n        if len(name) &gt; 0 {\n            router.Handle(path, httpAjaxFunc(handler))\n                  .Methods(e)\n                  .Headers(\"X-Requested-With\", \"XMLHttpRequest\", \"Payload\", \"\")\n                  .Name(name[0]);\n        } else {\n            router.Handle(path, httpAjaxFunc(handler))\n                  .Methods(e)\n                  .Headers(\"X-Requested-With\", \"XMLHttpRequest\", \"Payload\", \"\");\n        }\n</code></pre>\n\n<p>\n\n<blockquote>\n  <p>at line 29, file controllers\\routes\\funcs.gosyntax error: unexpected .</p>\n</blockquote>\n\n<p>How can I split it in multi lines?</p>\n"}, {"tags": ["c++", "go", "swig"], "answers": [{"tags": [], "owner": {"reputation": 4577, "user_id": 217965, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2f56f147c441727ffd27a57d747f131c?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/217965/drew"}, "is_accepted": false, "score": 0, "last_activity_date": 1437624231, "creation_date": 1437624231, "answer_id": 31577946, "question_id": 28579454, "link": "https://stackoverflow.com/questions/28579454/using-c-classes-from-go-using-swig/31577946#31577946", "title": "Using C++ classes from Go using Swig", "body": "<p>If you are feeling bold, the pe error on windows is fixed in Go 1.5beta1. Give it a spin! Download <a href=\"https://golang.org/dl/#go1.5beta2\" rel=\"nofollow\">1.5 beta2</a></p>\n"}, {"comments": [{"owner": {"reputation": 4877, "user_id": 1140237, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/rA4Ww.jpg?s=128&g=1", "display_name": "user1140237", "link": "https://stackoverflow.com/users/1140237/user1140237"}, "edited": false, "score": 0, "creation_date": 1452145902, "post_id": 34647982, "comment_id": 57041853, "body": "whats the reason? any explanation please ? if you dont have anything to explain than please give this type of answer in comment :)"}], "tags": [], "owner": {"reputation": 49, "user_id": 2622516, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560109979/picture?type=large", "display_name": "Pradeep Raja", "link": "https://stackoverflow.com/users/2622516/pradeep-raja"}, "is_accepted": true, "score": 0, "last_activity_date": 1452165353, "last_edit_date": 1452165353, "creation_date": 1452144756, "answer_id": 34647982, "question_id": 28579454, "link": "https://stackoverflow.com/questions/28579454/using-c-classes-from-go-using-swig/34647982#34647982", "title": "Using C++ classes from Go using Swig", "body": "<p>Please upgrade to Go 1.5. This problem is solved in Go 1.5.\nIt was known problem in Windows OS in prior Go versions. Go team has fixed in 1.5.\nPlease take a look at following thread which will give more information.</p>\n\n<p><a href=\"https://groups.google.com/forum/#!topic/golang-nuts/hLc8fHv3ppc\" rel=\"nofollow\">Go with SWIG error in Windows</a></p>\n"}], "owner": {"reputation": 49, "user_id": 2622516, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560109979/picture?type=large", "display_name": "Pradeep Raja", "link": "https://stackoverflow.com/users/2622516/pradeep-raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 34647982, "answer_count": 2, "score": 4, "last_activity_date": 1452165353, "creation_date": 1424249716, "question_id": 28579454, "link": "https://stackoverflow.com/questions/28579454/using-c-classes-from-go-using-swig", "title": "Using C++ classes from Go using Swig", "body": "<p>I want to use C++ class from Go using swig in Windows7</p>\n\n<p>When I build the project \"go build main.go\" I am getting following error:</p>\n\n<blockquote>\n  <p>c:\\..\\Temp\\go-build591352403/swtest.a(swtest_wrap.o): malformed pe file: __cgo_topofstack: invalid symbol binding 105</p>\n</blockquote>\n\n<p>I am using go 1.3 32bit, gcc 4.8.1 32bit and swig 3.0 in Windows7.\nI see same error when I use 64bit Go and GCC in Windows7. </p>\n\n<p>I am able build and run successfully on Ubuntu with 64-bit go and gcc.</p>\n\n<p>Am I missing something in windows?</p>\n\n<p>Here is the file structure and content. </p>\n\n<p>main (folder)</p>\n\n<ul>\n<li><p>main.go </p>\n\n<pre><code>package main\n\nimport (\n  \"swtest\"\n)\n\nfunc main() {\n  swtest.NewSwt().Print(\"Swig test!\")\n}\n</code></pre></li>\n</ul>\n\n<p>swtest (folder)</p>\n\n<ul>\n<li><p>swtest.cpp  </p>\n\n<pre><code>#include \"swtest.h\"\n\nvoid Swt::Print(const std::string&amp; s)\n{\n    std::cout &lt;&lt; s;\n    std::cout &lt;&lt; std::endl;\n}\n</code></pre></li>\n<li><p>swtest.h</p>\n\n<pre><code> #ifndef SWTEST_H\n #define SWTEST_H\n\n #include &lt;string&gt;\n #include &lt;iostream&gt;\n\n class Swt\n {\n public:\n    void Print(const std::string&amp; s);\n };\n\n #endif  \n</code></pre></li>\n<li><p>swtest.go</p>\n\n<pre><code> package swtest\n</code></pre></li>\n<li><p>swtest.swigcxx</p>\n\n<pre><code>%module swtest\n%include \"std_string.i\"\n\n%{\n#include \"swtest.h\"\n%}\n\n%include \"swtest.h\"\n</code></pre></li>\n</ul>\n"}, {"tags": ["pointers", "go", "struct", "slice"], "answers": [{"comments": [{"owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "edited": false, "score": 0, "creation_date": 1424248074, "post_id": 28578938, "comment_id": 45466382, "body": "I fully understand. Thank you very much"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1424247603, "creation_date": 1424247603, "answer_id": 28578938, "question_id": 28578526, "link": "https://stackoverflow.com/questions/28578526/how-can-i-get-a-struct-pointer-from-a-slice-in-golang/28578938#28578938", "title": "How can I get a struct pointer from a slice in golang", "body": "<p>You're not referring to the elements of the slice but the local <code>value</code> variable:</p>\n\n<pre><code>fmt.Printf(\"\\n%v==++++++++++++++%p\\n\", value, &amp;value)\n</code></pre>\n\n<p>Hence all the pointer values will be the same (the address of local variable <code>value</code>). If you want pointers to the elements of the slice, then take the address of the appropriate element:</p>\n\n<pre><code>fmt.Printf(\"\\n%v==++++++++++++++%p\\n\", demo_slice[index], &amp;demo_slice[index])\n</code></pre>\n\n<p>This will produce the following output, all pointers are different:</p>\n\n<pre><code>{str1}==++++++++++++++0x104342e0\n\n{str2}==++++++++++++++0x104342e8\n\n{str3}==++++++++++++++0x104342f0\n</code></pre>\n"}], "owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 28578938, "answer_count": 1, "score": 1, "last_activity_date": 1475439537, "creation_date": 1424245716, "last_edit_date": 1475439537, "question_id": 28578526, "link": "https://stackoverflow.com/questions/28578526/how-can-i-get-a-struct-pointer-from-a-slice-in-golang", "title": "How can I get a struct pointer from a slice in golang", "body": "<p>Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype demo struct {\n     name string\n}\n\nfunc main() {\n     demo_slice := make([]demo, 3)\n     demo_slice[0] = demo{\"str1\"}\n     demo_slice[1] = demo{\"str2\"}\n     demo_slice[2] = demo{\"str3\"}\n\n     point_demo_slice := make([]*demo, 3)\n     for index, value := range demo_slice {\n          fmt.Printf(\"\\n%v==++++++++++++++%p\\n\", value, &amp;value)\n          point_demo_slice[index] = &amp;value\n     }\n}\n</code></pre>\n\n<p>The result:</p>\n\n<pre><code>{str1}==++++++++++++++0x20818a220\n\n{str2}==++++++++++++++0x20818a220\n\n{str3}==++++++++++++++0x20818a220\n</code></pre>\n\n<p><code>0x20818a220</code> is the last element's pointer value.</p>\n\n<p>Why are all the pointer values \u200b\u200bthe same?</p>\n\n<p>How can I get those right pointer values?</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1424243282, "post_id": 28577489, "comment_id": 45464337, "body": "You cannot do this. Such crazy stuff would allow you to change any (exported) method to arbitrary, even harmful stuff. You <b>must</b> seek an other way to solve your problem."}], "answers": [{"comments": [{"owner": {"reputation": 460, "user_id": 3431423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iioqf.jpg?s=128&g=1", "display_name": "Interloper", "link": "https://stackoverflow.com/users/3431423/interloper"}, "edited": false, "score": 0, "creation_date": 1424242380, "post_id": 28577598, "comment_id": 45463972, "body": "I cannot change this line:      fmt.Println(a.getName())  I need other solution"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 460, "user_id": 3431423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iioqf.jpg?s=128&g=1", "display_name": "Interloper", "link": "https://stackoverflow.com/users/3431423/interloper"}, "edited": false, "score": 0, "creation_date": 1424242609, "post_id": 28577598, "comment_id": 45464048, "body": "Exactly! You cannot change it. Neither did I. Which is why I wrapped your object in an interface."}, {"owner": {"reputation": 460, "user_id": 3431423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iioqf.jpg?s=128&g=1", "display_name": "Interloper", "link": "https://stackoverflow.com/users/3431423/interloper"}, "edited": false, "score": 0, "creation_date": 1424242825, "post_id": 28577598, "comment_id": 45464152, "body": "You use &quot;ta&quot; instead of &quot;a&quot; for call new method. I can not do this replacement."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 460, "user_id": 3431423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iioqf.jpg?s=128&g=1", "display_name": "Interloper", "link": "https://stackoverflow.com/users/3431423/interloper"}, "edited": false, "score": 0, "creation_date": 1424243432, "post_id": 28577598, "comment_id": 45464405, "body": "@Interloper your method is not exported anyway, which means I doubt you could call it by reflection."}, {"owner": {"reputation": 460, "user_id": 3431423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iioqf.jpg?s=128&g=1", "display_name": "Interloper", "link": "https://stackoverflow.com/users/3431423/interloper"}, "edited": false, "score": 0, "creation_date": 1424243943, "post_id": 28577598, "comment_id": 45464627, "body": "Can I change the pointer to the implementation of the method?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 460, "user_id": 3431423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iioqf.jpg?s=128&g=1", "display_name": "Interloper", "link": "https://stackoverflow.com/users/3431423/interloper"}, "edited": false, "score": 0, "creation_date": 1424244048, "post_id": 28577598, "comment_id": 45464678, "body": "Not that I know, no, for the same reason mentioned by Volker"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424272312, "post_id": 28577598, "comment_id": 45480900, "body": "It looks like there are some tricks to be done with <code>unsafe</code> and <code>reflct.MakeFunc()</code> that just might work, but apart from the challenge in it, this really is not anything anyone should do in real life."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 6, "last_activity_date": 1424241988, "creation_date": 1424241988, "answer_id": 28577598, "question_id": 28577489, "link": "https://stackoverflow.com/questions/28577489/how-to-change-method-implementation-in-run-time-using-reflection/28577598#28577598", "title": "How to change method implementation in run-time using reflection?", "body": "<p>Note the idiomatic Go is to <em>not</em> do that and use interface instead:</p>\n\n<p>See <a href=\"http://play.golang.org/p/TMkmsaWM0q\" rel=\"noreferrer\">this example</a>:</p>\n\n<p>package main</p>\n\n<pre><code>import \"fmt\"\n\ntype Aer interface {\n    getName() string\n}\n\ntype A struct {\n    name string\n}\n\nfunc (a A) getName() string {\n    return \"My name is \" + a.name\n}\n\ntype testA struct {\n    a A\n}\n\nfunc (ta testA) getName() string {\n    return \"NEW: My name is \" + ta.a.name\n}\nfunc main() {\n    a := A{name: \"nameA\"}\n    fmt.Println(a.getName())\n    ta := testA{a: a}\n    fmt.Println(ta.getName())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>My name is nameA\nNEW: My name is nameA\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1424260761, "post_id": 28582195, "comment_id": 45473697, "body": "That seems closer to what the OP was after than in my answer. +1"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 8, "last_activity_date": 1424258047, "creation_date": 1424258047, "answer_id": 28582195, "question_id": 28577489, "link": "https://stackoverflow.com/questions/28577489/how-to-change-method-implementation-in-run-time-using-reflection/28582195#28582195", "title": "How to change method implementation in run-time using reflection?", "body": "<p>Go is a compiled language. As such, it's not possible to modify the implementation of things at runtime. What you can do is changing the place function pointers point to:</p>\n\n<pre><code>var getName func(string) = func(name string) {\n    return \"my name is \" + name\n}\n</code></pre>\n\n<p>In order to make this work with a structure, you have to resort to a few tricks. First add <code>getName</code> as a member to <code>A</code>:</p>\n\n<pre><code>type A struct {\n    name string\n    getName func() string\n}\n</code></pre>\n\n<p>Then we enclose a pointer to the structure as an implicit (i.e. closed over) parameter:</p>\n\n<pre><code>foo := &amp;A{name: \"Hans\"}\nfoo.getName = func() string {\n    return \"my name is \" + name\n}\n</code></pre>\n\n<p>Now you can call <code>A.getName()</code> and the result is <code>\"my name is hans\"</code>. You can use method expressions and many other features just fine, but <code>getName</code> is a <em>structure member</em> and not a <em>method</em> of <code>A</code>, so keep this in mind. When you want to give a new meaning to <code>getName</code>, assign something different to it:</p>\n\n<pre><code>foo.getName = func() string {\n    return \"test reflection\"\n}\n</code></pre>\n\n<p>Another idea that is especially applicable if you know in advance what implementations <code>getName</code> could have is to add a new member to <code>A</code> that says what implementation <code>getName</code> currently has and then switch over this variable.</p>\n"}], "owner": {"reputation": 460, "user_id": 3431423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iioqf.jpg?s=128&g=1", "display_name": "Interloper", "link": "https://stackoverflow.com/users/3431423/interloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3300, "favorite_count": 2, "accepted_answer_id": 28582195, "answer_count": 2, "score": 7, "last_activity_date": 1519804502, "creation_date": 1424241542, "last_edit_date": 1519804502, "question_id": 28577489, "link": "https://stackoverflow.com/questions/28577489/how-to-change-method-implementation-in-run-time-using-reflection", "title": "How to change method implementation in run-time using reflection?", "body": "<p>I have this type implementation:</p>\n\n<pre><code>type A struct{\n  name string\n}\n\nfunc (a A) getName() string {\n  return \"My name is \" + a.name \n}\n</code></pre>\n\n<p>How I can change implementation of method getName() for this type using reflection?\nFor example, I want use next implementation instead of current:</p>\n\n<pre><code>func newGetName() string {\n  return \"test reflection\"\n} \n</code></pre>\n"}, {"tags": ["go", "executable"], "comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 23, "creation_date": 1424337538, "post_id": 28576173, "comment_id": 45510222, "body": "Huge? I guess you don&#39;t do much Java then!"}, {"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "reply_to_user": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 22, "creation_date": 1424337639, "post_id": 28576173, "comment_id": 45510276, "body": "Well , im from C/C++ background !"}, {"owner": {"reputation": 5679, "user_id": 1878788, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fc54887ecbaba35e17251129e5b78c9a?s=128&d=identicon&r=PG", "display_name": "bli", "link": "https://stackoverflow.com/users/1878788/bli"}, "edited": false, "score": 0, "creation_date": 1510926338, "post_id": 28576173, "comment_id": 81656089, "body": "I just tried this scala-native hello world: <a href=\"http://www.scala-native.org/en/latest/user/sbt.html#minimal-sbt-project\" rel=\"nofollow noreferrer\">scala-native.org/en/latest/user/sbt.html#minimal-sbt-project</a> It took quite some time to compile, downloading a lot of stuff, and the binary is 3.9MB."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1554189185, "post_id": 28576173, "comment_id": 97648944, "body": "I have updated <a href=\"https://stackoverflow.com/a/28577424/6309\">my answer below</a> with 2019 findings."}, {"owner": {"reputation": 6027, "user_id": 375958, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jVReq.jpg?s=128&g=1", "display_name": "Jalal", "link": "https://stackoverflow.com/users/375958/jalal"}, "edited": false, "score": 1, "creation_date": 1589570941, "post_id": 28576173, "comment_id": 109357195, "body": "Simple Hello World app in C# .NET Core 3.1 with <code>dotnet publish -r win-x64 -p:publishsinglefile=true -p:publishreadytorun=true -p:publishtrimmed=true</code> generates a binary file about ~26MB!"}, {"owner": {"reputation": 894, "user_id": 4421213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/48zdO.jpg?s=128&g=1", "display_name": "Zack ISSOIR", "link": "https://stackoverflow.com/users/4421213/zack-issoir"}, "reply_to_user": {"reputation": 6027, "user_id": 375958, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jVReq.jpg?s=128&g=1", "display_name": "Jalal", "link": "https://stackoverflow.com/users/375958/jalal"}, "edited": false, "score": 0, "creation_date": 1590086046, "post_id": 28576173, "comment_id": 109554393, "body": "@Jalal Why ? This is a huge difference. Do you know why .NET Core executable are that huge."}, {"owner": {"reputation": 207, "user_id": 3683934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c49f8573072651a6ce3843b38424b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Jr_", "link": "https://stackoverflow.com/users/3683934/jr"}, "reply_to_user": {"reputation": 894, "user_id": 4421213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/48zdO.jpg?s=128&g=1", "display_name": "Zack ISSOIR", "link": "https://stackoverflow.com/users/4421213/zack-issoir"}, "edited": false, "score": 0, "creation_date": 1599835519, "post_id": 28576173, "comment_id": 112907032, "body": "@ZackISSOIR This is because &quot;dotnet publish -r win-x64&quot; is a self contained deployment, meaning is going to deploy the entire runtime with your code. If you add &quot;self-contained false&quot; then it wil be framework dependent and will deploy only your code. A console hello world in this case will be only 124k."}], "answers": [{"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1492957990, "post_id": 28577424, "comment_id": 74194508, "body": "I don&#39;t see what he implementation language has to do with it. They need to use shared libraries. Somewhat incredible that they don&#39;t already in this day and age."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 3, "creation_date": 1492959912, "post_id": 28577424, "comment_id": 74195196, "body": "@EJP: Why do they need to use shared libraries?"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 10, "creation_date": 1492960389, "post_id": 28577424, "comment_id": 74195361, "body": "@EJP, part of Go&#39;s simplicity is in not using shared libraries. In fact, Go doesn&#39;t have any dependencies at all, it uses plain syscalls. Just deploy a single binary and it just works. It would significantly hurt the language and it&#39;s ecosystem if it would be otherwise."}, {"owner": {"reputation": 1189, "user_id": 2634332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2eaac490041b2f3ccad6dec6eeacdd43?s=128&d=identicon&r=PG", "display_name": "Joppe", "link": "https://stackoverflow.com/users/2634332/joppe"}, "edited": false, "score": 11, "creation_date": 1505146341, "post_id": 28577424, "comment_id": 79282085, "body": "An often forgotten aspect of having statically linked binaries is that it makes it possible to run them in a completely empty Docker-container.   From a security standpoint, this is ideal. When the container is empty, you might be able to break in (if the statically linked binary has flaws), but since there is nothing to be found in the container, the attack stops there."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 9, "last_activity_date": 1554189141, "last_edit_date": 1592644375, "creation_date": 1424241278, "answer_id": 28577424, "question_id": 28576173, "link": "https://stackoverflow.com/questions/28576173/reason-for-huge-size-of-compiled-executable-of-go/28577424#28577424", "title": "Reason for huge size of compiled executable of Go", "body": "<p>Note that the binary size issue is tracked by <a href=\"https://github.com/golang/go/issues/6853\" rel=\"noreferrer\">issue 6853</a> in the <a href=\"https://github.com/golang/go/\" rel=\"noreferrer\">golang/go project</a>.</p>\n<p>For instance, <a href=\"https://github.com/golang/go/commit/a26c01ad446d2853f0c6a7ddaacadb02efa00b7b\" rel=\"noreferrer\">commit a26c01a</a> (for Go 1.4) <strong>cut hello world by 70kB</strong>:</p>\n<blockquote>\n<p>because we don't write those names into the symbol table.</p>\n</blockquote>\n<p>Considering the compiler, assembler, linker, and runtime for 1.5 will be\nentirely in Go, you can expect further optimization.</p>\n<hr />\n<p>Update 2016 Go 1.7: this has been optimized: see &quot;<a href=\"https://blog.golang.org/go1.7-binary-size\" rel=\"noreferrer\">Smaller Go 1.7 binaries</a>&quot;.</p>\n<p>But these day (April 2019), what takes the most place is <a href=\"https://github.com/golang/go/blob/56517216c052649daab6c439f386f9dc02e90c3a/src/debug/gosym/pclntab.go#L17-L26\" rel=\"noreferrer\"><strong><code>runtime.pclntab</code></strong></a>.<br />\nSee  &quot;<a href=\"https://science.raphael.poss.name/go-executable-size-visualization-with-d3.html\" rel=\"noreferrer\">Why are my Go executable files so large? Size visualization of Go executables using D3</a>&quot; from <strong><a href=\"https://twitter.com/kena42\" rel=\"noreferrer\">Raphael \u2018kena\u2019 Poss</a></strong>.</p>\n<blockquote>\n<p>It is not too well documented however this comment from the Go source code suggests its purpose:</p>\n<pre><code>// A LineTable is a data structure mapping program counters to line numbers.\n</code></pre>\n<p>The purpose of this data structure is to enable the Go runtime system to produce descriptive stack traces upon a crash or upon internal requests via the <code>runtime.GetStack</code> API.</p>\n<p>So it seems useful. But why is it so large?</p>\n<p>The URL <a href=\"https://golang.org/s/go12symtab\" rel=\"noreferrer\">https://golang.org/s/go12symtab</a> hidden in the aforelinked source file redirects to a document that explains what happened between Go 1.0 and 1.2. To paraphrase:</p>\n<p>prior to 1.2, the Go linker was emitting a compressed line table, and the program would decompress it upon initialization at run-time.</p>\n<p>in Go 1.2, a decision was made to pre-expand the line table in the executable file into its final format suitable for direct use at run-time, without an additional decompression step.</p>\n<p>In other words, the Go team decided to make executable files larger to save up on initialization time.</p>\n<p>Also, looking at the data structure, it appears that its overall size in compiled binaries is super-linear in the number of functions in the program, in addition to how large each function is.</p>\n</blockquote>\n<p><a href=\"https://i.stack.imgur.com/vZUp3.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/vZUp3.png\" alt=\"https://science.raphael.poss.name/go-executable-size-visualization-with-d3/size-demo-ss.png\" /></a></p>\n"}, {"comments": [{"owner": {"reputation": 166, "user_id": 1471119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ee0d0b65c09c7b3f66542d71bd292b?s=128&d=identicon&r=PG&f=1", "display_name": "Craig Barnes", "link": "https://stackoverflow.com/users/1471119/craig-barnes"}, "edited": false, "score": 15, "creation_date": 1553207659, "post_id": 28579099, "comment_id": 97309692, "body": "A C &quot;hello world&quot; program, statically linked with glibc is 750K because glibc is expressly not designed for static linking and is even impossible to properly static link in some cases. A &quot;hello world&quot; program statically linked with musl libc is 14K."}, {"owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "edited": false, "score": 0, "creation_date": 1596374963, "post_id": 28579099, "comment_id": 111785692, "body": "I&#39;m still looking, however, it would be nice to know what is linked in so that just maybe an attacker is not linking in evil code."}, {"owner": {"reputation": 932, "user_id": 2184308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1131e2dfca319f7b0418c042571be5?s=128&d=identicon&r=PG", "display_name": "David Spector", "link": "https://stackoverflow.com/users/2184308/david-spector"}, "edited": false, "score": 0, "creation_date": 1598222040, "post_id": 28579099, "comment_id": 112379761, "body": "So why isn&#39;t the Go runtime library in a DLL file, so that it can be shared among all Go exe files? Then a &quot;hello world&quot; program could be a few KB, as expected, instead of 2 MB. Having the entire runtime library in every program is a fatal flaw for the otherwise wonderful alternative to MSVC on Windows."}, {"owner": {"reputation": 932, "user_id": 2184308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1131e2dfca319f7b0418c042571be5?s=128&d=identicon&r=PG", "display_name": "David Spector", "link": "https://stackoverflow.com/users/2184308/david-spector"}, "edited": false, "score": 0, "creation_date": 1598222148, "post_id": 28579099, "comment_id": 112379782, "body": "I&#39;d better anticipate an objection to my comment: that Go is &quot;statically linked&quot;. Okay, no DLLs then. But static linking doesn&#39;t mean you need to link in (bind) an entire library, only the functions that are actually used in the library!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 94, "last_activity_date": 1424267089, "last_edit_date": 1592644375, "creation_date": 1424248373, "answer_id": 28579099, "question_id": 28576173, "link": "https://stackoverflow.com/questions/28576173/reason-for-huge-size-of-compiled-executable-of-go/28579099#28579099", "title": "Reason for huge size of compiled executable of Go", "body": "<p>This exact question appears in the official FAQ: <a href=\"http://golang.org/doc/faq#Why_is_my_trivial_program_such_a_large_binary\" rel=\"noreferrer\"><strong>Why is my trivial program such a large binary?</strong></a></p>\n<p>Quoting the answer:</p>\n<blockquote>\n<p>The linkers in the gc tool chain (<code>5l</code>, <code>6l</code>, and <code>8l</code>) do static linking. All Go binaries therefore include the Go run-time, along with the run-time type information necessary to support dynamic type checks, reflection, and even panic-time stack traces.</p>\n<p>A simple C &quot;hello, world&quot; program compiled and linked statically using gcc on Linux is around 750 kB, including an implementation of <code>printf</code>. An equivalent Go program using <code>fmt.Printf</code> is around 1.9 MB, but that includes more powerful run-time support and type information.</p>\n</blockquote>\n<p>So the native executable of your Hello World is 1.9 MB because it contains a runtime which provides garbage collection, reflection and many other features (which your program might not really use, but it's there). And the implementation of the <code>fmt</code> package which you used to print the <code>&quot;Hello World&quot;</code> text (plus its dependencies).</p>\n<p>Now try the following: add another <code>fmt.Println(&quot;Hello World! Again&quot;)</code> line to your program and compile it again. The result will not be 2x 1.9MB, but still just 1.9 MB! Yes, because all the used libraries (<code>fmt</code> and its dependencies) and the runtime are already added to the executable (and so just a few more bytes will be added to print the 2nd text which you just added).</p>\n"}, {"comments": [{"owner": {"reputation": 809, "user_id": 7659430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWGmO.png?s=128&g=1", "display_name": "simlev", "link": "https://stackoverflow.com/users/7659430/simlev"}, "edited": false, "score": 4, "creation_date": 1574763606, "post_id": 46159048, "comment_id": 104337886, "body": "UPX compresses binaries and decompresses them on-the-fly when they are executed. I wouldn&#39;t dismiss it a trick without explaining what it does, since it can be useful in some scenarios. Binary size is reduced somewhat at the expense of startup time and RAM usage; moreover, performance can be slightly affected as well. Just as an example, an executable could be shrinked to 30% of its (stripped) size and take 35ms longer to run."}], "tags": [], "owner": {"reputation": 1189, "user_id": 2634332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2eaac490041b2f3ccad6dec6eeacdd43?s=128&d=identicon&r=PG", "display_name": "Joppe", "link": "https://stackoverflow.com/users/2634332/joppe"}, "is_accepted": false, "score": 47, "last_activity_date": 1505167730, "last_edit_date": 1505167730, "creation_date": 1505143001, "answer_id": 46159048, "question_id": 28576173, "link": "https://stackoverflow.com/questions/28576173/reason-for-huge-size-of-compiled-executable-of-go/46159048#46159048", "title": "Reason for huge size of compiled executable of Go", "body": "<p>Consider the following program:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello World!\")\n}\n</code></pre>\n\n<p>If I build this on my Linux AMD64 machine (Go 1.9), like this:</p>\n\n<pre><code>$ go build\n$ ls -la helloworld\n-rwxr-xr-x 1 janf group 2029206 Sep 11 16:58 helloworld\n</code></pre>\n\n<p>I get a a binary that is about 2 Mb in size.</p>\n\n<p>The reason for this (which has been explained in other answers) is that we are using the \"fmt\" package which is quite large, but the binary has also not been stripped and this means that the symbol table is still there. If we instead instruct the compiler to strip the binary, it will become much smaller:</p>\n\n<pre><code>$ go build -ldflags \"-s -w\"\n$ ls -la helloworld\n-rwxr-xr-x 1 janf group 1323616 Sep 11 17:01 helloworld\n</code></pre>\n\n<p>However, if we rewrite the program to use the builtin function print, instead of fmt.Println, like this:</p>\n\n<pre><code>package main\n\nfunc main() {\n    print(\"Hello World!\\n\")\n}\n</code></pre>\n\n<p>And then compile it:</p>\n\n<pre><code>$ go build -ldflags \"-s -w\"\n$ ls -la helloworld\n-rwxr-xr-x 1 janf group 714176 Sep 11 17:06 helloworld\n</code></pre>\n\n<p>We end up with an even smaller binary. This is as small as we can get it without resorting to tricks like UPX-packing, so the overhead of the Go-runtime is roughly 700 Kb.</p>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29038, "favorite_count": 18, "accepted_answer_id": 28579099, "answer_count": 3, "score": 94, "last_activity_date": 1554189141, "creation_date": 1424234830, "last_edit_date": 1470154351, "question_id": 28576173, "link": "https://stackoverflow.com/questions/28576173/reason-for-huge-size-of-compiled-executable-of-go", "title": "Reason for huge size of compiled executable of Go", "body": "<p>I complied a hello world Go program which generated native executable on my linux machine. But I was surprised to see the size of the simple Hello world Go program, it was 1.9MB !</p>\n\n<p>Why is it that the executable of such a simple program in Go is so huge? </p>\n"}, {"tags": ["sockets", "go", "thread-safety"], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 25, "last_activity_date": 1424273073, "last_edit_date": 1424273073, "creation_date": 1424258073, "answer_id": 28582206, "question_id": 28575758, "link": "https://stackoverflow.com/questions/28575758/are-golang-net-udpconn-and-net-tcpconn-thread-safe-can-i-read-or-write-of-sing/28582206#28582206", "title": "Are golang net.UDPConn and net.TCPConn thread safe?? Can i read or write of single UDPConn object in multi thread?", "body": "<p>The documentation for <a href=\"http://golang.org/pkg/net/#Conn\" rel=\"noreferrer\"><code>net.Conn</code></a> says:</p>\n\n<blockquote>\n  <p>Multiple goroutines may invoke methods on a Conn simultaneously.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 4323, "user_id": 370364, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/58cb3fbbdbcc34cda410ff6f366ae83a?s=128&d=identicon&r=PG", "display_name": "PiersyP", "link": "https://stackoverflow.com/users/370364/piersyp"}, "is_accepted": false, "score": 3, "last_activity_date": 1520961668, "last_edit_date": 1520961668, "creation_date": 1520866296, "answer_id": 49238165, "question_id": 28575758, "link": "https://stackoverflow.com/questions/28575758/are-golang-net-udpconn-and-net-tcpconn-thread-safe-can-i-read-or-write-of-sing/49238165#49238165", "title": "Are golang net.UDPConn and net.TCPConn thread safe?? Can i read or write of single UDPConn object in multi thread?", "body": "<blockquote>\n  <p>Multiple goroutines may invoke methods on a Conn simultaneously.</p>\n</blockquote>\n\n<p>My interpretation of the doc above, is that nothing catastrophic will happen if you invoke <code>Read</code> and <code>Write</code> on a <code>net.Conn</code> from multiple go routines, and that calls to <code>Write</code> on a <code>net.Conn</code> from multiple go routines will be serialised so that the bytes from 2 separate calls to <code>Write</code> will not be interleaved as they are written to the network.</p>\n\n<p>The problem with the code you have presented is that there is no guarantee that <code>Write</code> will write the whole byte slice provided to it in one go. You are ignoring the indication of how many bytes have been written.</p>\n\n<pre><code>_, err = socket.WriteToUDP(senddata, remoteAddr)\n</code></pre>\n\n<p>So to make sure you write everything you would need to loop and call <code>Write</code> till all the <code>senddata</code> is sent. But <code>net.Conn</code> only ensures that data from a <em>single</em> call to Write is not interleaved. Given that you could be sending a single block of data with multiple calls to write there is no guarantee that the single block of data would reach its destination intact.</p>\n\n<p>So for example 3 \"hello client!\" messages could arrive in the following form.</p>\n\n<p>\"hellohellohello client! client! client!\"</p>\n\n<p>So if you want reliable message writing on a <code>net.Conn</code> from multiple go routines you will need to synchronise those routines to ensure that single messages are written intact.</p>\n\n<p>If I wanted to do this, as a first attempt I would have a single go routine reading from one or many message channels and writing to a <code>net.Conn</code> and then multiple go routines can write to those message channels.</p>\n"}], "owner": {"reputation": 341, "user_id": 4407799, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c741afb406509f1b64422fd5fa3879b3?s=128&d=identicon&r=PG&f=1", "display_name": "\u4e60\u660e\u660a", "link": "https://stackoverflow.com/users/4407799/%e4%b9%a0%e6%98%8e%e6%98%8a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7643, "favorite_count": 1, "accepted_answer_id": 28582206, "answer_count": 2, "score": 5, "last_activity_date": 1520961668, "creation_date": 1424232204, "question_id": 28575758, "link": "https://stackoverflow.com/questions/28575758/are-golang-net-udpconn-and-net-tcpconn-thread-safe-can-i-read-or-write-of-sing", "title": "Are golang net.UDPConn and net.TCPConn thread safe?? Can i read or write of single UDPConn object in multi thread?", "body": "<p>1.Can we call send from one thread and recv from another on the same net.UDPConn or net.TCPConn objects?</p>\n\n<p>2.Can we call multiple sends parallely from different threads on the same net.UDPConn or net.TCPConn objects?</p>\n\n<p>I am unable to find a good documentation also for the same.\nIs golang socket api thread safe?</p>\n\n<p>I find that it is hard to test if it is thread safe.\nAny pointers in the direction will be helpful.</p>\n\n<p>My test code is below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"sync\"\n)\n\nfunc udp_server() {\n    // create listen\n    conn, err := net.ListenUDP(\"udp\", &amp;net.UDPAddr{\n        IP:   net.IPv4(0, 0, 0, 0),\n        Port: 8080,\n    })\n    if err != nil {\n        fmt.Println(\"listen fail\", err)\n        return\n    }\n    defer conn.Close()\n\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 10; i = i + 1 {\n        wg.Add(1)\n        go func(socket *net.UDPConn) {\n            defer wg.Done()\n            for {\n                // read data\n                data := make([]byte, 4096)\n                read, remoteAddr, err := socket.ReadFromUDP(data)\n                if err != nil {\n                    fmt.Println(\"read data fail!\", err)\n                    continue\n                }\n                fmt.Println(read, remoteAddr)\n                fmt.Printf(\"%s\\n\\n\", data)\n\n                // send data\n                senddata := []byte(\"hello client!\")\n                _, err = socket.WriteToUDP(senddata, remoteAddr)\n                if err != nil {\n                    return\n                    fmt.Println(\"send data fail!\", err)\n                }\n            }\n        }(conn)\n    }\n    wg.Wait()\n}\n\nfunc main() {\n    udp_server()\n}\n</code></pre>\n\n<p>Is it OK for this test code?</p>\n"}, {"tags": ["rest", "http", "go", "gorilla"], "comments": [{"owner": {"reputation": 2736, "user_id": 370662, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/10f19a9e600c4ed64f53a986fba57e21?s=128&d=identicon&r=PG", "display_name": "korylprince", "link": "https://stackoverflow.com/users/370662/korylprince"}, "edited": false, "score": 0, "creation_date": 1424226747, "post_id": 28574875, "comment_id": 45459285, "body": "gorilla/mux and net/http handle routes differently: <a href=\"http://stackoverflow.com/questions/21234639/golang-gorilla-mux-with-http-fileserver-returning-404\" title=\"golang gorilla mux with http fileserver returning 404\">stackoverflow.com/questions/21234639/&hellip;</a>"}, {"owner": {"reputation": 139, "user_id": 4548148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34277a80dcf52eaf574e892e747b101c?s=128&d=identicon&r=PG&f=1", "display_name": "tugayac", "link": "https://stackoverflow.com/users/4548148/tugayac"}, "reply_to_user": {"reputation": 2736, "user_id": 370662, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/10f19a9e600c4ed64f53a986fba57e21?s=128&d=identicon&r=PG", "display_name": "korylprince", "link": "https://stackoverflow.com/users/370662/korylprince"}, "edited": false, "score": 0, "creation_date": 1424311584, "post_id": 28574875, "comment_id": 45501397, "body": "Thanks, but I don&#39;t think this addresses my issue (unless I&#39;m missing something from that post that I should be applying in mine). I don&#39;t have a problem serving static files. My problem lies with other HTTP calls, such as a PUT request to <a href=\"http://localhost:8000/user/new\" rel=\"nofollow noreferrer\">localhost:8000/user/new</a> to create a new user."}, {"owner": {"reputation": 2736, "user_id": 370662, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/10f19a9e600c4ed64f53a986fba57e21?s=128&d=identicon&r=PG", "display_name": "korylprince", "link": "https://stackoverflow.com/users/370662/korylprince"}, "edited": false, "score": 0, "creation_date": 1424324145, "post_id": 28574875, "comment_id": 45504694, "body": "Sorry. I misread what you said. I thought you were getting the 404 on static files."}, {"owner": {"reputation": 139, "user_id": 4548148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34277a80dcf52eaf574e892e747b101c?s=128&d=identicon&r=PG&f=1", "display_name": "tugayac", "link": "https://stackoverflow.com/users/4548148/tugayac"}, "reply_to_user": {"reputation": 2736, "user_id": 370662, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/10f19a9e600c4ed64f53a986fba57e21?s=128&d=identicon&r=PG", "display_name": "korylprince", "link": "https://stackoverflow.com/users/370662/korylprince"}, "edited": false, "score": 0, "creation_date": 1424359357, "post_id": 28574875, "comment_id": 45523848, "body": "No worries! I solved the problem anyways. Posted my answer below if you&#39;re interested."}], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 4548148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34277a80dcf52eaf574e892e747b101c?s=128&d=identicon&r=PG&f=1", "display_name": "tugayac", "link": "https://stackoverflow.com/users/4548148/tugayac"}, "is_accepted": true, "score": 0, "last_activity_date": 1424313868, "creation_date": 1424313868, "answer_id": 28597834, "question_id": 28574875, "link": "https://stackoverflow.com/questions/28574875/go-gorilla-mux-not-routing-as-expected/28597834#28597834", "title": "Go Gorilla Mux not routing as expected", "body": "<p>Turns out the solution was simple (like it usually is). This line in routes.go</p>\n\n<pre><code>r.PathPrefix(\"/\").Handler(http.FileServer(staticDir))\n</code></pre>\n\n<p>was causing the unintended routing. When PathPrefix is used, it seems to route all URLs to the first matching prefix (in this case this prefix). This explains why static files were being served, but nothing else works. </p>\n\n<p><strong>The fix is to use the <a href=\"http://www.gorillatoolkit.org/pkg/mux#Route.Path\" rel=\"nofollow\">Path</a> function instead</strong>. There's a subtle difference as explained in the docs; PathPrefix \"matches if the given template is a prefix of the full URL path\", whereas Path does not. Hence the line above now looks like this to solve the issue I was having:</p>\n\n<pre><code>r.Path(\"/\").Handler(http.FileServer(staticDir))\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 4548148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34277a80dcf52eaf574e892e747b101c?s=128&d=identicon&r=PG&f=1", "display_name": "tugayac", "link": "https://stackoverflow.com/users/4548148/tugayac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1616, "favorite_count": 0, "accepted_answer_id": 28597834, "answer_count": 1, "score": 0, "last_activity_date": 1424313868, "creation_date": 1424225869, "question_id": 28574875, "link": "https://stackoverflow.com/questions/28574875/go-gorilla-mux-not-routing-as-expected", "title": "Go Gorilla Mux not routing as expected", "body": "<p>I am having issues getting the Gorilla Mux library for Go to work. From the documentation I have read and all the debugging I've done, I cannot seem to figure out what the problem is. Here's what I've got for routing:</p>\n\n<p>Folder structure:</p>\n\n<pre><code>project_root\n  |-- main.go\n  |-- routes\n         |-- routes.go\n         |-- user.go\n</code></pre>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"./routes\"\n)\n\nfunc main() {\n    r := routes.CreateRoutes(http.Dir(\"./content\"))\n\n    http.Handle(\"/\", r)\n    err := http.ListenAndServe(fmt.Sprintf(\"%s:%d\", \"localhost\", 8000), nil)\n    if err != nil {\n        fmt.Println(\"Error: \", err)\n    }\n}\n</code></pre>\n\n<p>routes/routes.go</p>\n\n<pre><code>package routes\n\nimport (\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc CreateRoutes(staticDir http.FileSystem) *mux.Router {\n    r := mux.NewRouter()\n\n    // Serve static pages (i.e. web app)\n    r.PathPrefix(\"/\").Handler(http.FileServer(staticDir))\n\n    // Serve User Pages\n    createUserRoutes(r)\n\n    return r\n}\n</code></pre>\n\n<p>routes/user.go</p>\n\n<pre><code>package routes\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc createUserRoutes(r *mux.Router) {\n    user := r.PathPrefix(\"/user/\").Subrouter()\n\n    // Create a new user\n    user.Path(\"/new\").Methods(\"PUT\").HandlerFunc(newUserHandler)\n\n    // Remove a user\n    user.Path(\"/remove/{username:[a-z][a-z0-9]+}\").Methods(\"DELETE\").HandlerFunc(removeUserHandler)\n\n    // Update a user\n    user.Path(\"update/{username:[a-z][a-z0-9]+\").Methods(\"POST\").HandlerFunc(updateUserHandler)\n\n    // Get a user (Get user information)\n    user.Path(\"/{username:[a-z][a-z0-9]+\").Methods(\"GET\").HandlerFunc(getUserHandler)\n}\n\nfunc newUserHandler(resp http.ResponseWriter, req *http.Request) {\n    // Do something that might cause an error        \n\n    if err != nil {\n        fmt.Println(err)\n        resp.WriteHeader(409)\n        resp.Write([]byte(err.Error()))\n    } else {\n        fmt.Println(\"Created new user\")\n        resp.WriteHeader(201)\n        resp.Write([]byte(\"Created new user\"))\n    }\n}\n\nfunc removeUserHandler(resp http.ResponseWriter, req *http.Request) {\n}\n\nfunc updateUserHandler(resp http.ResponseWriter, req *http.Request) {\n}\n\nfunc getUserHandler(resp http.ResponseWriter, req *http.Request) {\n}\n</code></pre>\n\n<p>Whenever I make a request to root path of the server (i.e. the path that serves the static content), the server responds as intended, with the main page. However, any other calls result in a 404 response (I test requests using cURL). For example, a malformed request to <a href=\"http://localhost:8000/user/new\" rel=\"nofollow\">http://localhost:8000/user/new</a> should return a 409, but instead returns a 404. Same if I expect a 201 response.</p>\n\n<p>Everything looks right and I've triple checked it, but I cannot figure out what the issue here is.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 65435, "user_id": 2206004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCB1e.png?s=128&g=1", "display_name": "hwnd", "link": "https://stackoverflow.com/users/2206004/hwnd"}, "edited": false, "score": 2, "creation_date": 1424227481, "post_id": 28574609, "comment_id": 45459428, "body": "Why are you trying to compile what you&#39;re reading from the file? Does the file contain a regular expression?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 6, "last_activity_date": 1424230022, "last_edit_date": 1424230022, "creation_date": 1424225899, "answer_id": 28574880, "question_id": 28574609, "link": "https://stackoverflow.com/questions/28574609/how-to-apply-regexp-to-content-in-file-go/28574880#28574880", "title": "How to apply regexp to content in file (Go)?", "body": "<p>The regexp replace method returns the source argument with the regexp matches replaced by replacement argument. Because application is replacing \"oldtext\" with \"newtext\", \"oldtext\" is the regexp:</p>\n\n<pre><code>r, err := regexp.Compile(\"oldtext\")\n</code></pre>\n\n<p>Because the application has the contents of the file as a []byte, ReplaceAll can be used insead of ReplaceAllString. This does require converting the replacment string to a []byte, but this is probably less expensive than converting the file to a string for ReplaceAllString.</p>\n\n<pre><code>r.ReplaceAll(b, []byte(\"newtext\"))\n</code></pre>\n\n<p>The result of ReplaceAll is a []byte that can be written directly to stdout. There's no need to fmt.Println the output.</p>\n\n<p>Here's the complete code:</p>\n\n<pre><code>b, err := ioutil.ReadFile(file)\nif err != nil {\n  panic(err)\n}\n\nr, err := regexp.Compile(\"oldtext\")\nif err != nil {\n  // handle error\n}\nos.Stdout.Write(r.ReplaceAll(b, []byte(\"newtext\")))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65435, "user_id": 2206004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCB1e.png?s=128&g=1", "display_name": "hwnd", "link": "https://stackoverflow.com/users/2206004/hwnd"}, "is_accepted": false, "score": 6, "last_activity_date": 1424311405, "last_edit_date": 1424311405, "creation_date": 1424229521, "answer_id": 28575365, "question_id": 28574609, "link": "https://stackoverflow.com/questions/28574609/how-to-apply-regexp-to-content-in-file-go/28575365#28575365", "title": "How to apply regexp to content in file (Go)?", "body": "<p>It seems you're trying to compile what your reading from the file into a regular expression. </p>\n\n<p>The following syntax should correct your problem.</p>\n\n<pre><code>x := string(b)\nr, err := regexp.Compile(\"oldtext\")\nif err != nil {\n    return // problem with the regular expression.\n}\nfmt.Println(r.ReplaceAllString(x, \"newtext\"))\n</code></pre>\n\n<p>However, it's better to not convert binary data to strings and work directly with it.</p>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3867, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1424311405, "creation_date": 1424224121, "question_id": 28574609, "link": "https://stackoverflow.com/questions/28574609/how-to-apply-regexp-to-content-in-file-go", "title": "How to apply regexp to content in file (Go)?", "body": "<p>I'm using the <code>io/ioutil</code> package to read a file:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/codegangsta/cli\"\n    \"io/ioutil\"\n    \"os\"\n    \"regexp\"\n)\n\nfunc main() {\n    app := cli.NewApp()\n    app.Name = \"m2k\"\n    app.Usage = \"convert markdown to kindle\"\n\n    app.Action = func(c *cli.Context) {\n        file := \"no file\"\n\n        if len(c.Args().First()) &gt; 0 {\n            file = c.Args().First()\n\n            fmt.Println(\"worked:\", file)\n\n            b, err := ioutil.ReadFile(file)\n            if err != nil {\n                panic(err)\n            }\n\n            r, _ := regexp.Compile(b)\n            fmt.Println(r.ReplaceAllString(\"oldtext\", \"newtext\"))\n        }\n\n    }\n\n    app.Run(os.Args)\n}\n\n// $ go run io2.go input.txt\n\n// input.txt\n\n// text text oldtext oldtext\n</code></pre>\n\n<p>And I want to apply regex to the content of the file:</p>\n\n<pre><code>r, _ := regexp.Compile(b)\nmt.Println(r.ReplaceAllString(\"oldtext\", \"newtext\"))\n</code></pre>\n\n<p>The problem is that it seems like <code>regexp.Compile</code> doesn't work with the <code>byte</code> type:</p>\n\n<blockquote>\n  <p>./io2.go:29: cannot use b (type []byte) as type string in function\n  argument</p>\n</blockquote>\n\n<p>How can I solve this problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1424221555, "post_id": 28573979, "comment_id": 45457805, "body": "Looking at the <a href=\"https://github.com/golang/go/blob/master/src/cmd/go/generate.go\" rel=\"nofollow noreferrer\"><code>go generate</code> source code</a>, you can see that it simply checks if the line starts with <code>&#47;&#47;go:generate </code> or <code>&#47;&#47;go:generate\\t</code>."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1424227406, "post_id": 28573979, "comment_id": 45459414, "body": "Looks quite primitive to me. Now I guess I have to copy/paste a bunch of code from go generate source   b/c the functions are all private."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 2, "creation_date": 1426911647, "post_id": 28585028, "comment_id": 46575361, "body": "A more direct option is to call the <a href=\"http://godoc.org/go/scanner\" rel=\"nofollow noreferrer\">go/scanner</a> package with the <a href=\"http://godoc.org/go/scanner#ScanComments\" rel=\"nofollow noreferrer\">ScanComments</a> flag set to true. There&#39;s no need to build an AST to find the comments."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 0, "last_activity_date": 1426935758, "last_edit_date": 1495541577, "creation_date": 1424266736, "answer_id": 28585028, "question_id": 28573979, "link": "https://stackoverflow.com/questions/28573979/is-there-any-parser-for-gogenerate-directives/28585028#28585028", "title": "Is there any parser for go:generate directives?", "body": "<p>Package <a href=\"https://golang.org/pkg/go/parser/\" rel=\"nofollow noreferrer\"><code>go/parser</code></a> in the standard library gets you an <code>ast.Package</code> value, representing an abstract syntax tree of a single package. This tree includes <code>ast.Comment</code> nodes, whose textual content you can easily access through their <code>Text</code> field.</p>\n\n<p>Edit:</p>\n\n<p><a href=\"https://stackoverflow.com/users/4122236/dubroto\">Dewy Broto</a> contributed: A more direct option is to call the go/scanner package with the ScanComments flag set to true. There's no need to build an AST to find the comments</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 28585028, "answer_count": 1, "score": 0, "last_activity_date": 1426935758, "creation_date": 1424220227, "question_id": 28573979, "link": "https://stackoverflow.com/questions/28573979/is-there-any-parser-for-gogenerate-directives", "title": "Is there any parser for go:generate directives?", "body": "<p>It seems the standard <a href=\"https://golang.org/src/go/doc/doc.go#L14\" rel=\"nofollow\">doc</a> package is not parsing go:generate comments. Any idea how can I get those comments?</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"tags": [], "owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "is_accepted": true, "score": 2, "last_activity_date": 1424216509, "creation_date": 1424216509, "answer_id": 28573365, "question_id": 28573167, "link": "https://stackoverflow.com/questions/28573167/access-mysql-field-from-golang-struct-with-underscore/28573365#28573365", "title": "Access mysql field from golang struct with underscore", "body": "<p>According to <a href=\"https://github.com/jinzhu/gorm#existing-schema\" rel=\"nofollow\">https://github.com/jinzhu/gorm#existing-schema</a>, you want to use <code>column:</code> in the struct type tag.</p>\n\n<pre><code>type Specialties struct {\n    // ...\n    SpeName    string `gorm:\"column:spe_Name\"`\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 721, "user_id": 2108258, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7b01fe08a510994b22f4c9d976d66bda?s=128&d=identicon&r=PG", "display_name": "user2108258", "link": "https://stackoverflow.com/users/2108258/user2108258"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "accepted_answer_id": 28573365, "answer_count": 1, "score": 2, "last_activity_date": 1424216509, "creation_date": 1424215450, "question_id": 28573167, "link": "https://stackoverflow.com/questions/28573167/access-mysql-field-from-golang-struct-with-underscore", "title": "Access mysql field from golang struct with underscore", "body": "<p>I'm working with the <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow\">https://github.com/jinzhu/gorm</a> library. For some reason I can't access some fields that I expect to be there. Those particular fields have underscores in them. For instance when I try to Access SpeName it doesn't fail but it also does not give me a string</p>\n\n<pre><code>type Specialties struct {\n    SpeId      int64  \n    SpeName    string \n    Conditions sql.NullString\n    ParentId   sql.NullInt64 \n    Hidden     sql.NullInt64\n}\n\n\nfunc IsFolderNameASpecialty(folderName string) models.Specialties {\n    var sSpecialty models.Specialties\n    for _, specialty := range Specialties {\n        fmt.Println(strings.ToLower(folderName), specialty.SpeName)\n        if strings.ToLower(folderName) == strings.ToLower(specialty.SpeName) {\n            sSpecialty = specialty\n        }\n    }\n    return sSpecialty\n}\n</code></pre>\n\n<p>For Some reason the println is empty. The mysql field is really  <code>spe_Name</code> instead of <code>SpeName</code>. What tag do I use to allow me to access the field properly?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 3, "creation_date": 1424213417, "post_id": 28572349, "comment_id": 45455021, "body": "Go is not Javascript. Javascript looks at your code and says &quot;that looks ok, I don&#39;t know what <code>f</code> is yet, but I probably will by the time this block is called&quot;, and then assigns the function to the variable <code>f</code>, and everything is good. Go wants to know what <code>f</code> is first before it encounters code that calls it."}, {"owner": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "reply_to_user": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1424214020, "post_id": 28572349, "comment_id": 45455272, "body": "That is what is happening but doesn&#39;t really say why. Go doesn&#39;t want to know what <code>f</code> is if <code>f</code> is declared as a function but Go does want to know if <code>f</code> is declared as a function type variable. That&#39;s what is weird."}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "edited": false, "score": 0, "creation_date": 1424214085, "post_id": 28572612, "comment_id": 45455302, "body": "Thanks that&#39;s a much better working solution. I am hoping for some documentation that points this out. It does seem to be very strange that functions and variables of function types are treated so differently."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "edited": false, "score": 5, "creation_date": 1424221125, "post_id": 28572612, "comment_id": 45457673, "body": "@DanielWilliams: From the <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">spec</a>: <i>The scope of a constant or variable identifier declared inside a function begins at the end of the ConstSpec or VarSpec (ShortVarDecl for short variable declarations) and ends at the end of the innermost containing block.</i> That means that the <code>f</code>identifier is not valid until the value is fully defined. This is why you cannot do in Go what you do in JavaScript."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 43, "last_activity_date": 1424213148, "creation_date": 1424213148, "answer_id": 28572612, "question_id": 28572349, "link": "https://stackoverflow.com/questions/28572349/golang-function-and-function-variable-semantics/28572612#28572612", "title": "Golang function and function variable semantics", "body": "<p>The below code would be the preferred way of doing what you describe. Note that you do not have to create an additional variable, nor do you have a <em>pointer</em> to a function:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var f func(int) int\n    f = func(i int) int {\n        if i == 0 {\n            return 1\n        }\n        return i * f(i-1)\n    }\n    fmt.Println(f(2))\n}\n</code></pre>\n"}], "owner": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35259, "favorite_count": 0, "accepted_answer_id": 28572612, "answer_count": 1, "score": 21, "last_activity_date": 1424213148, "creation_date": 1424212050, "question_id": 28572349, "link": "https://stackoverflow.com/questions/28572349/golang-function-and-function-variable-semantics", "title": "Golang function and function variable semantics", "body": "<p>Why can't I define a recursive function as a variable? I seem to be able to define arbitrary functions except when they recurse.</p>\n\n<p>This is legal:</p>\n\n<pre><code>func f(i int) int {\n    if i == 0 {\n        return 1\n    }\n    return i * f(i-1)\n}\n\nfunc main() {\n    fmt.Println(f(2))\n}\n</code></pre>\n\n<p>This is illegal:</p>\n\n<pre><code>var f func(int) int = func(i int) int {\n    if i == 0 {\n        return 1\n    }\n    return i * f(i-1)\n}\n\nfunc main() {\n    fmt.Println(f(2))\n}\n</code></pre>\n\n<p>This is legal and I'm guessing it is just because you can figure out f after initialization:</p>\n\n<pre><code>func main() {\n    var f *func(int) int;\n    t := func(i int) int {\n        if i == 0 {\n            return 1\n        }\n        return i * (*f)(i-1)\n    }\n    f = &amp;t\n    fmt.Println((*f)(2))\n}\n</code></pre>\n\n<p>So it looks like it comes down to function and variable declarations of a function type are treated differently though from the reading the documentation I wouldn't expect that to be the case. Did I miss the part of the documentation detailing this? </p>\n\n<p>I would expect the illegal case to work just because it works in other languages. Like in JavaScript:</p>\n\n<pre><code>(function () {\n  var f = function (i) {\n    if (i == 0) {\n      return 1;\n    }\n    return i * f(i - 1);\n  };\n\n  console.log(f(2));\n})();\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 3, "last_activity_date": 1424210809, "creation_date": 1424210809, "answer_id": 28572032, "question_id": 28571984, "link": "https://stackoverflow.com/questions/28571984/one-liner-for-creating-struct-with-blank-fields/28572032#28572032", "title": "One-liner for creating struct with blank fields?", "body": "<p>You could specify the fields</p>\n\n<pre><code>f := Foo{a: 1, b: 2, c: 3}\nfmt.Println(f) //{1 2 3 0}\n</code></pre>\n"}], "owner": {"reputation": 9325, "user_id": 4931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f4182656449e54bde861a02d6ef44ecd?s=128&d=identicon&r=PG", "display_name": "Michael Deardeuff", "link": "https://stackoverflow.com/users/4931/michael-deardeuff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 28572032, "answer_count": 1, "score": 3, "last_activity_date": 1424210809, "creation_date": 1424210619, "question_id": 28571984, "link": "https://stackoverflow.com/questions/28571984/one-liner-for-creating-struct-with-blank-fields", "title": "One-liner for creating struct with blank fields?", "body": "<p>I have a struct with blank fields:</p>\n\n<pre><code>type Foo struct {\n    a uint32\n    b uint32\n    c uint32\n    _ uint32 //padding\n}\n</code></pre>\n\n<p>For structs without blank fields I enjoy using one-liner initialization. But, I cannot seem to do this for types <em>with</em> blank fields:</p>\n\n<pre><code>Foo{1,2,3}   // too few values in struct initializer\nFoo{1,2,3,0} // cannot refer to blank field or method\nFoo{1,2,3,_} // cannot use _ as value\n</code></pre>\n\n<p>To keep the nice syntax, must I name the unused field?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 1, "creation_date": 1424208955, "post_id": 28571477, "comment_id": 45452875, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/20916376/avoid-typing-out-all-go-files-in-the-main-package-when-go-run-ng\">Avoid typing out all go files in the main package when &quot;Go run&quot;-ng</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429204724, "post_id": 28571546, "comment_id": 47500540, "body": "Although <code>go build &amp;&amp; .&#47;progname</code> is <i>far</i> preferable, if there are test files and/or files with build constraints and you <i>really really</i> want to use <code>go run</code> you could do (or make an alias for): <code>go run `go list -f &#39;{{join .GoFiles &quot; &quot;}}&#39;` </code> (assuming no spaces or &quot;strange&quot; characters in the filenames)."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 4, "last_activity_date": 1424209001, "creation_date": 1424209001, "answer_id": 28571546, "question_id": 28571477, "link": "https://stackoverflow.com/questions/28571477/why-the-functions-defined-in-other-main-packages-are-not-recognised/28571546#28571546", "title": "Why the functions defined in other &quot;main&quot; packages are not recognised?", "body": "<p>You must include all the files as argument of the <code>go run</code>.</p>\n\n<pre><code>go run main1.go main.go\n</code></pre>\n\n<p>or</p>\n\n<pre><code>go *.go\n</code></pre>\n\n<p>Unless there are test files in the same folder.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 28571546, "answer_count": 1, "score": 1, "last_activity_date": 1424209001, "creation_date": 1424208768, "question_id": 28571477, "link": "https://stackoverflow.com/questions/28571477/why-the-functions-defined-in-other-main-packages-are-not-recognised", "title": "Why the functions defined in other &quot;main&quot; packages are not recognised?", "body": "<p>I have to files main.go and main2.go . In main.go I have the main() function defined along with a call somefunc() which is in main2.go. The issue is that when I run go run main.go it says that somefunc() is undefined. Basically it doesn't scan the other main functions from package. However if I declare this somefunc() in main.go it works but when I run go test it says the function is redeclared. </p>\n\n<p>Question: Is there any way that I can tell to <code>go run</code> to behave like go test and compile/run all the files from the package(in this case both main.go and main1.go)  not just main.go?</p>\n"}, {"tags": ["go", "gis", "dijkstra", "path-finding", "a-star"], "comments": [{"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1424207036, "post_id": 28570075, "comment_id": 45452008, "body": "Dijkstra&#39;s (well, UCS if you&#39;re hair splitting) is literally just A* with the heuristic always set to the Null Heuristic, so no, you won&#39;t have any better luck there."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1424207081, "post_id": 28570075, "comment_id": 45452040, "body": "Is there a reason you can&#39;t map coordinates-&gt;ID so you can use the other one? That&#39;s what most graph packages will have you do (for instance, github.com/gonum/graph does it too)"}, {"owner": {"reputation": 707, "user_id": 1110183, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7562e0b316265cf003dd22c7f30f0e12?s=128&d=identicon&r=PG", "display_name": "Alex van den Hoogen", "link": "https://stackoverflow.com/users/1110183/alex-van-den-hoogen"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1424207989, "post_id": 28570075, "comment_id": 45452464, "body": "@Jsor, thanks for the info regarding Dijkstra / A*. I currently use the coordinates as ID, as you can see here: <a href=\"https://gist.github.com/alex3305/a76daf1c74f25d3a0a12#file-models-go-L15\" rel=\"nofollow noreferrer\">gist.github.com/alex3305/&hellip;</a> . The package you refer to seems quite decent, but I don&#39;t see any documentation or examples which is really a problem for me since I&#39;m quite new to golang."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1424210216, "post_id": 28570075, "comment_id": 45453503, "body": "@AlexvandenHoogen <a href=\"http://godoc.org/github.com/gonum/graph\" rel=\"nofollow noreferrer\">documentation</a>, also see <a href=\"http://godoc.org/?q=dijkstra\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 707, "user_id": 1110183, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7562e0b316265cf003dd22c7f30f0e12?s=128&d=identicon&r=PG", "display_name": "Alex van den Hoogen", "link": "https://stackoverflow.com/users/1110183/alex-van-den-hoogen"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1424211376, "post_id": 28570075, "comment_id": 45454069, "body": "@thwd Sure I saw all of those, but couldn&#39;t really find a good implementation that suits my needs. Or at least I don&#39;t see one. The only that I can tryout probably is <a href=\"http://godoc.org/github.com/soniakeys/graph2/search\" rel=\"nofollow noreferrer\">godoc.org/github.com/soniakeys/graph2/search</a> ."}, {"owner": {"reputation": 840, "user_id": 1028939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61801c8fb992a44d5506b6a557831003?s=128&d=identicon&r=PG", "display_name": "MattyB", "link": "https://stackoverflow.com/users/1028939/mattyb"}, "edited": false, "score": 0, "creation_date": 1426190878, "post_id": 28570075, "comment_id": 46282332, "body": "You ought to include your code for <code>calculateDistance</code>, since that&#39;s where most of the magic is. If <code>calculateDistance</code> is fixed, there&#39;s probably no reason to be setting visited on all the vertices."}], "owner": {"reputation": 707, "user_id": 1110183, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7562e0b316265cf003dd22c7f30f0e12?s=128&d=identicon&r=PG", "display_name": "Alex van den Hoogen", "link": "https://stackoverflow.com/users/1110183/alex-van-den-hoogen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424203215, "creation_date": 1424203215, "last_edit_date": 1495539804, "question_id": 28570075, "link": "https://stackoverflow.com/questions/28570075/lost-with-dijkstra-in-go", "title": "Lost with Dijkstra in Go", "body": "<p>I'm currently <a href=\"https://gist.github.com/alex3305/a76daf1c74f25d3a0a12\" rel=\"nofollow noreferrer\">trying to implement</a> a path finding algorithm in Go. I'm currently committed to get Dijkstra working since that's supposed to be one of the simpler algorithms regarding path findinig. However I have a hard time getting it right. Most of my tests results in infinite loops.</p>\n\n<p>For my tests I'm currently using a ESRI Shapefile as a source and build a graph with it that consists of Vertexes and Edge's (or Node's and Arcs, whatever suits you). This seems to work great, but it's a little memory hungry at the moment. </p>\n\n<p>I started building on <a href=\"https://stackoverflow.com/questions/19900903/go-dijkstra-print-out-the-path-not-just-calculate-the-shortest-distance\">this question</a> which seems to work according to the example. But once I adjusted it for my needs, which are real-world coordinates and no id's in the vertex, something seems wrong...</p>\n\n<p>Relevant code that I'm suffering with (part of a <a href=\"https://gist.github.com/alex3305/a76daf1c74f25d3a0a12\" rel=\"nofollow noreferrer\">gist</a>):</p>\n\n<pre><code>const MAX_LENGTH = 1000000\ntype MinDistanceFromSource map[*Vertex]float64\n\nfunc (G *Graph) Dijkstra(source, destination *Vertex) MinDistanceFromSource {\n    D := make(MinDistanceFromSource)\n    for _, vertex := range G.Vertexes {\n        D[vertex] = MAX_LENGTH\n    }\n\n    D[source] = 0\n\n    for edge := range source.GetAdjacentEdges() {\n        D[edge.Destination] = edge.Length\n    }\n\n    // calculateDistance(source, destination, D) // Fix me...?\n\n    for _, vertex := range G.Vertexes {\n        vertex.visited = false // fixme\n    }\n\n    return D\n}\n</code></pre>\n\n<p>The main thing I'm asking myself is if I'm doing this right or am I just off by miles? And how can I make this work? Or am I better of trying to implement something like A*?</p>\n\n<p>Also; the relevant Shapefile that I'm trying this with: <a href=\"http://www.jigsaw.nl/nwb/downloads/NWB_01-01-2015.zip\" rel=\"nofollow noreferrer\">NWB_01-01-2015</a> <strong>(100MB zip)</strong></p>\n"}, {"tags": ["types", "go", "polymorphism"], "comments": [{"owner": {"reputation": 11, "user_id": 4576579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bbfde462c4a2289b39b021bf2b5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sigrid Haughty", "link": "https://stackoverflow.com/users/4576579/sigrid-haughty"}, "edited": false, "score": 0, "creation_date": 1424198434, "post_id": 28568275, "comment_id": 45447454, "body": "found that encoding an interface requires to Encode a pointer, but still not getting decoded properly! ref <a href=\"https://play.golang.org/p/lbt4_Q5vB0\" rel=\"nofollow noreferrer\">play.golang.org/p/lbt4_Q5vB0</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4576579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bbfde462c4a2289b39b021bf2b5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sigrid Haughty", "link": "https://stackoverflow.com/users/4576579/sigrid-haughty"}, "edited": false, "score": 0, "creation_date": 1424267224, "post_id": 28569895, "comment_id": 45477607, "body": "Hi jcbwlkr - thanks for the feedback, I&#39;ve looked into type embedding, but it doesn&#39;t do the thing that I am trying to do, as you can see in this example (that I&#39;ve modified from your code): <a href=\"https://play.golang.org/p/P6AwVQqQcM\" rel=\"nofollow noreferrer\">play.golang.org/p/P6AwVQqQcM</a>"}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "reply_to_user": {"reputation": 11, "user_id": 4576579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bbfde462c4a2289b39b021bf2b5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sigrid Haughty", "link": "https://stackoverflow.com/users/4576579/sigrid-haughty"}, "edited": false, "score": 0, "creation_date": 1424268862, "post_id": 28569895, "comment_id": 45478663, "body": "@SigridHaughty I see what you mean. I feel like there&#39;s a solution here but I&#39;m not seeing it just yet. Best of luck!"}], "tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 0, "last_activity_date": 1424202488, "creation_date": 1424202488, "answer_id": 28569895, "question_id": 28568275, "link": "https://stackoverflow.com/questions/28568275/go-equivalent-of-type-inheritace-gob-encode-decode-via-interfaces/28569895#28569895", "title": "Go equivalent of type inheritace (gob encode/decode via interfaces)", "body": "<p>Instead of using marker interfaces I would take an approach using <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">Type Embedding</a> and put the encode/decode methods on the <code>Msg</code> type.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/gob\"\n    \"fmt\"\n    \"log\"\n)\n\ntype Msg struct {\n    Id string\n}\n\ntype ClientMsg struct {\n    Msg\n}\ntype ServerMsg struct {\n    Msg\n}\n\nfunc (m *Msg) encode() (bb bytes.Buffer) {\n    enc := gob.NewEncoder(&amp;bb)\n    err := enc.Encode(m)\n    if err != nil {\n        log.Fatal(\"Cannot encode! err=\", err)\n    }\n    return\n}\n\nfunc (m *Msg) decode(bb *bytes.Buffer) {\n    dec := gob.NewDecoder(bb)\n    err := dec.Decode(m)\n    if err != nil {\n        log.Fatal(\"Cannot decode Msg! err=\", err)\n    }\n    return\n}\n\nfunc main() {\n    // Make a message and encode it to a bytes.Buffer\n    m1 := &amp;ClientMsg{Msg{\"id_1\"}}\n    b1 := m1.encode()\n    p_bb := bytes.NewBuffer(b1.Bytes())\n\n    // Make a new message and decode the bytes.Buffer from the first\n    m2 := &amp;ClientMsg{Msg{}}\n    m2.decode(p_bb)\n\n    fmt.Printf(\"m2 Decoded = '%v'\\n\", m2.Msg.Id)\n}\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/ljIZjw8gHm\" rel=\"nofollow\">View it on the Playground</a></kbd></p>\n\n<p>You could make this code nicer with some <code>New</code> methods to make <code>ClientMsg</code> or <code>ServerMsg</code> structs. Also do you need to be passing the return from <code>encode</code> to <code>bytes.NewBuffer</code> or could you use it as is?</p>\n"}], "owner": {"reputation": 11, "user_id": 4576579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bbfde462c4a2289b39b021bf2b5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sigrid Haughty", "link": "https://stackoverflow.com/users/4576579/sigrid-haughty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 827, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424268635, "creation_date": 1424196957, "last_edit_date": 1424268635, "question_id": 28568275, "link": "https://stackoverflow.com/questions/28568275/go-equivalent-of-type-inheritace-gob-encode-decode-via-interfaces", "title": "Go equivalent of type inheritace (gob encode/decode via interfaces)", "body": "<p>I'm trying to write one function that encodes/decodes various types of Messages.</p>\n\n<p>In OO languages, I would use type inheritance, but Go doesn't have this concept, ref: <a href=\"http://golang.org/doc/faq#inheritance\" rel=\"nofollow\">http://golang.org/doc/faq#inheritance</a>, so instead, here I'm trying to use the \"marker interface\" style to leverage interface inheritance for this purpose instead.</p>\n\n<p>The error is from golang org src/encoding/gob/decode.go:</p>\n\n<pre><code>   line 1019// Common confusing case: local interface type, remote concrete type.\n</code></pre>\n\n<p>.. and yes I find this confusing!!</p>\n\n<p>Run this at <a href=\"https://play.golang.org/p/ldEvQXIgEa\" rel=\"nofollow\">https://play.golang.org/p/ldEvQXIgEa</a></p>\n\n<p>I cannot get this to work, what am I doing wrong? Help please!</p>\n\n<p>updates:</p>\n\n<p>(I also tried to gob.Register(m1) with no effect).</p>\n\n<p>I've looked into type embedding, but it doesn't do the thing that I am trying to do, as you can see in this example (that I've modified from jcbwlkr's code): https //play .golang .org/p/ P6AwVQqQcM  (also be aware that I might have dozens/hundreds of message types!)</p>\n\n<p>It is quite possible that I'm barking up the wrong tree, and that I need to ditch the whole idea of <em>how</em> I'm <em>thinking</em> about the problem (but this is what I'm trying to do at the moment: learn how to <strong>\"Think in Go\"</strong> vs OO thinking). Using type embedding would work, but I would then have to create a master type that embedded (composed) all of the possible types within it: gob makes the decoding possible, and a type switch lets me see what I got, but this all <em>feels</em> quite scary and uncomfortable to <em>think about</em> .</p>\n\n<p>(I am used to static and dynamic languages, so I'm happy with duck typing, but <strong>this feels like a half-way house without the comforts of either end of the spectrum</strong>!).</p>\n\n<p>So there are 2 things that I'm asking here:</p>\n\n<ol>\n<li>How to fix this particular problem (ie understand what's possible\nwith interfaces), and</li>\n<li>design alternatives (and type embedding is\none of those, so thanks for highlighting that) :) .</li>\n</ol>\n\n<p>Here;s the broken code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"bytes\"\n    \"log\"\n    \"encoding/gob\"\n)\n\ntype Msger interface {\n    IsMsg()\n}\n\ntype ClientMsg struct {\n    Id      string\n}\ntype ServerMsg struct {\n    Id      string\n}\n\nfunc (m ClientMsg) IsMsg() { }\nfunc (m ServerMsg) IsMsg() { }\n\nfunc encode(m Msger) (bb bytes.Buffer) {\n    enc := gob.NewEncoder(&amp;bb)\n    err := enc.Encode(m)\n    if err != nil {\n        log.Fatal(\"Cannot encode! err=\", err)\n    }\n    return\n}\n\nfunc decode(m Msger, bb bytes.Buffer) {     // for A\n//func decode(m *Msger, bb bytes.Buffer) {  // for B, C\n    dec := gob.NewDecoder(&amp;bb)\n    err := dec.Decode(&amp;m)\n    if err != nil {\n        log.Fatal(\"Cannot decode Msg! err=\", err)\n    }\n    return\n}\n\nfunc main() {\n    m1 := ClientMsg{\"id_1\"}\n    b1 := encode(m1)\n    p_bb := bytes.NewBuffer(b1.Bytes())\n\n    var mDecoded ClientMsg // for A, B, C\n    //var mDecoded interface{} // D: : cannot use mDecoded (type interface {}) as type Msger in argument to decode: interface {} does not implement Msger (missing IsMsg method)\n    decode(mDecoded, *p_bb)     // A: gives: Cannot decode Msg! err=gob: local interface type *main.Msger can only be decoded from remote interface type; received concrete type ClientMsg = struct { Id string; }\n\n    //decode(mDecoded, *p_bb)  // B: gives: cannot use mDecoded (type ClientMsg) as type *Msger in argument to decode: *Msger is pointer to interface, not interface\n    //decode(&amp;mDecoded, *p_bb) // C: gives: cannot use &amp;mDecoded (type *ClientMsg) as type *Msger in argument to decode: *Msger is pointer to interface, not interface\n\n    fmt.Printf(\"m1 Decoded='%v'\\n\", mDecoded)\n}\n</code></pre>\n"}, {"tags": ["csv", "go", "google-drive-api", "google-api-go-client"], "comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424196300, "post_id": 28567941, "comment_id": 45446239, "body": "What library are you using, the one I found was recently updated (possibly a cause for the changes you saw)?"}, {"owner": {"reputation": 113, "user_id": 1959101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1294d100c1f5fcd24f7ba4dc0349cfac?s=128&d=identicon&r=PG", "display_name": "user1959101", "link": "https://stackoverflow.com/users/1959101/user1959101"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424200055, "post_id": 28567941, "comment_id": 45448297, "body": "I&#39;m using code.google.com/p/google-api-go-client/drive/v2 which doesn&#39;t seem to have been updated recently. Which one did you find? Thanks."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424201186, "post_id": 28567941, "comment_id": 45448904, "body": "I was looking at <a href=\"https://github.com/google/google-api-go-client\" rel=\"nofollow noreferrer\">https://github.com/google/google-api-go-client</a>."}, {"owner": {"reputation": 113, "user_id": 1959101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1294d100c1f5fcd24f7ba4dc0349cfac?s=128&d=identicon&r=PG", "display_name": "user1959101", "link": "https://stackoverflow.com/users/1959101/user1959101"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424202990, "post_id": 28567941, "comment_id": 45449828, "body": "Hmmm. I had ended up on the older code. Unfortunately, updating to the the newer code on github didn&#39;t fix things. Thanks for catching that though."}, {"owner": {"reputation": 18863, "user_id": 1000753, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/23634e7a38e353cca12bb72a4205615b?s=128&d=identicon&r=PG", "display_name": "pinoyyid", "link": "https://stackoverflow.com/users/1000753/pinoyyid"}, "edited": false, "score": 0, "creation_date": 1424259465, "post_id": 28567941, "comment_id": 45472979, "body": "try to trace the http. Likely cause is either (a) you&#39;re sending the wrong mime type (which could be an SDK bug), or (b) Drive is incorrectly interpreting the mime type (there was a similar bug last week affecting Javascript mime types)"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1462874857, "post_id": 28567941, "comment_id": 61809593, "body": "Did you ever find a solution to this?"}], "owner": {"reputation": 113, "user_id": 1959101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1294d100c1f5fcd24f7ba4dc0349cfac?s=128&d=identicon&r=PG", "display_name": "user1959101", "link": "https://stackoverflow.com/users/1959101/user1959101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 368, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575360887, "creation_date": 1424195819, "last_edit_date": 1575360887, "question_id": 28567941, "link": "https://stackoverflow.com/questions/28567941/uploading-csv-to-sheets-using-the-golang-sdk-now-produces-a-docs-file", "title": "Uploading csv to sheets using the golang sdk now produces a docs file", "body": "<p>I have some code that has been happily creating sheets files in google drive by uploading csv files. Over the weekend, it stopped doing that and started resulting in docs files instead. Am I doing something wrong? Or is this a glitch in drive? </p>\n\n<pre><code>insert := service.Files.Insert(&amp;drive.File{\n    Title:    filename + \".csv\",\n    MimeType: \"text/csv\",\n    Parents:  parentIds,\n}).Convert(true).Media(inBuf)\ndriveFile, err := insert.Do()\nif err != nil {\n    return err\n}\n</code></pre>\n\n<p>Thanks for any ideas.</p>\n\n<p>This is using v2 of the google sdk (githubb.com/google/google-api-go-client/drive/v2).</p>\n"}, {"tags": ["c++", "arrays", "go", "wrapper", "cgo"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424190879, "post_id": 28566242, "comment_id": 45442843, "body": "You can&#39;t return a pointer to an item allocated on the stack. This is completely invalid. <code>CreateArray</code> needs to specifically allocate that array using <code>new</code>."}, {"owner": {"reputation": 13, "user_id": 2235441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Lh3.png?s=128&g=1", "display_name": "Energetics", "link": "https://stackoverflow.com/users/2235441/energetics"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424191387, "post_id": 28566242, "comment_id": 45443167, "body": "Hi tadman, thanks for the comment. Yes thats true... thanks for pointing that out. But even using new the core issue of the question remains, because also the errors are still there."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424191635, "post_id": 28566242, "comment_id": 45443327, "body": "Does casting with <code>(*int)(C.CCreateArray())</code> work better? Not as familiar with Go. I think you&#39;re inadvertently casting to <code>int</code> and then trying to de-reference that somehow. I&#39;d also try skipping the explicit cast and seeing if Go can infer that."}, {"owner": {"reputation": 13, "user_id": 2235441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Lh3.png?s=128&g=1", "display_name": "Energetics", "link": "https://stackoverflow.com/users/2235441/energetics"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424191763, "post_id": 28566242, "comment_id": 45443410, "body": "Unfortunately not. I still receive: <code>cannot convert _Cfunc_CCreateArray() (type *C.int) to type *int</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424192088, "post_id": 28566242, "comment_id": 45443608, "body": "Keep in mind you&#39;re creating a memory leak here, Go can&#39;t possibly work with the C++ allocated structure, so you may have serious problems with this approach unless you have another wrapper for <code>CDestroyArray</code>. As for why the casting isn&#39;t working, not sure. Someone more familiar with Go can surely answer that part."}, {"owner": {"reputation": 13, "user_id": 2235441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Lh3.png?s=128&g=1", "display_name": "Energetics", "link": "https://stackoverflow.com/users/2235441/energetics"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424193101, "post_id": 28566242, "comment_id": 45444276, "body": "There is a special function for freeing memory allocated in C: <code>C.free(&amp;ptr)</code> or you are writing your own memory free functions. So memory handling is due to the developer, but it is not necessarily there if one takes care of memory allocation."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424198613, "post_id": 28566242, "comment_id": 45447545, "body": "That&#39;s going to call a C <code>free</code> on the pointer, which is going to be bad. You need to call a C++ <code>delete</code> on it."}, {"owner": {"reputation": 13, "user_id": 2235441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Lh3.png?s=128&g=1", "display_name": "Energetics", "link": "https://stackoverflow.com/users/2235441/energetics"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1424206057, "post_id": 28566242, "comment_id": 45451463, "body": "Thanks for pointing this out tadman. In this case the best option would be to create an own free method that releases the memory using <code>delete []</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2235441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Lh3.png?s=128&g=1", "display_name": "Energetics", "link": "https://stackoverflow.com/users/2235441/energetics"}, "edited": false, "score": 0, "creation_date": 1424206225, "post_id": 28567689, "comment_id": 45451557, "body": "Hi thwd, thanks for the answer. I could make it work exactly as suggested in your post as well as in the source you were linking. The only question that remains is: When using the method above, one receives an array of C.int values. Would it be advisable to convert them to the respective go uint?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 13, "user_id": 2235441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Lh3.png?s=128&g=1", "display_name": "Energetics", "link": "https://stackoverflow.com/users/2235441/energetics"}, "edited": false, "score": 1, "creation_date": 1424207732, "post_id": 28567689, "comment_id": 45452365, "body": "Yes, make them Go types, regardless if signed or unsigned. If you don&#39;t then you&#39;ll have to <code>import &quot;C&quot;</code> all over your Go code."}, {"owner": {"reputation": 13, "user_id": 2235441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Lh3.png?s=128&g=1", "display_name": "Energetics", "link": "https://stackoverflow.com/users/2235441/energetics"}, "edited": false, "score": 1, "creation_date": 1424247823, "post_id": 28567689, "comment_id": 45466275, "body": "Just two minor corrections: The second line should look like -- <code>h := *(*reflect.SliceHeader)((unsafe.Pointer)(&amp;s))</code> -- and the forth line should be -- <code>s = *(*[]int32)(unsafe.Pointer(&amp;h))</code>"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 1, "last_activity_date": 1424195086, "creation_date": 1424195086, "answer_id": 28567689, "question_id": 28566242, "link": "https://stackoverflow.com/questions/28566242/exchange-data-structures-arrays-between-go-golang-and-c/28567689#28567689", "title": "Exchange data structures (arrays) between Go (golang) and C++", "body": "<p>This here:</p>\n\n<pre><code>return *int(C.CCreateArray())\n</code></pre>\n\n<p>can be written as</p>\n\n<pre><code>return *((int)(C.CCreateArray()))\n</code></pre>\n\n<p>You're derreferencing an <code>int</code>, which results in:</p>\n\n<pre><code>invalid indirect of int(_Cfunc_CCreateArray()) (type int)\n</code></pre>\n\n<p>And inside that statement, observing only this part:</p>\n\n<pre><code>(int)(C.CCreateArray())\n</code></pre>\n\n<p>You're trying to convert an <code>*C.int</code> to an <code>int</code>, which won't work cause the first is a pointer and the second not.</p>\n\n<p>Beyond that and the memory-management trouble that @tadman mentions in the comments of your question, Go does not represent arrays as pointers to their first element as C does.</p>\n\n<p>If you want to share <code>int</code>s you'll have to be specific about their width: an <code>int</code> in Go has an arch-dependent width, as well as a C <code>int</code>.</p>\n\n<p>Read more about CGO: <a href=\"http://golang.org/cmd/cgo/\" rel=\"nofollow\">http://golang.org/cmd/cgo/</a></p>\n\n<p>Once you have fixed all these problems, you'll have to proceed something like this:</p>\n\n<pre><code>s := make([]int32, 0, 0)\n\nh := (*reflect.SliceHeader)((unsafe.Pointer)(&amp;s))\n\nh.Data, h.Len, h.Cap = P, L, L // see below\n\ns = *(*[]int32)(h)\n</code></pre>\n\n<p>where <code>P</code> is a Go <code>uintptr</code> to your array, which you created in C++ and <code>L</code> is the length of the array as a Go <code>int</code></p>\n"}], "owner": {"reputation": 13, "user_id": 2235441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Lh3.png?s=128&g=1", "display_name": "Energetics", "link": "https://stackoverflow.com/users/2235441/energetics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1336, "favorite_count": 0, "accepted_answer_id": 28567689, "answer_count": 1, "score": 1, "last_activity_date": 1424195086, "creation_date": 1424190703, "last_edit_date": 1424191643, "question_id": 28566242, "link": "https://stackoverflow.com/questions/28566242/exchange-data-structures-arrays-between-go-golang-and-c", "title": "Exchange data structures (arrays) between Go (golang) and C++", "body": "<p>I'm trying to connect a C++ library to an appserver written in Go. The goal is that both the C++ library and the appserver are working on a common data structure, which means that:</p>\n\n<ol>\n<li>The Go appserver can access an array created by the C++ library.</li>\n<li>The C++ library can work on an array created by the Go appserver.</li>\n</ol>\n\n<p>I was playing a little bit around with cgo and connecting C++ and everything worked so far... However, when it comes to exchanging pointers to data structures I'm lost. What I tried so far:</p>\n\n<pre><code>//c++ library header: xyz.h\n\n#include &lt;stdlib.h&gt;\n\nclass CppLib {\n public:\n  CppLib(unsigned int input);\n\n  int * CreateArray();\n};\n\n//C++ library implementation: xyz.cpp\n#include \"xyz.h\"\n\nCppLib::CppLib(unsigned int input) {\n    _input = input;\n  }\n\nint * CppLib::CreateArray() {\n    int values = 5;\n    int * myPointer = new int [values];\n    for (unsigned i = 0; i &lt; values; ++i) {\n        myPointer[i] = i;\n    }\n    return myPointer;\n}\n</code></pre>\n\n<p>The interface implementation looks like:</p>\n\n<pre><code>//interface.h\n\nint * CCreateArray();\n\n//interface.cc\n#include \"../lib/xyz.h\"\n\nextern \"C\" {\n\n  int * CCreateArray() {\n    CppLib lib(1);\n    return lib.CreateArray();\n  }\n}\n</code></pre>\n\n<p>Finally the go implementation looks like:</p>\n\n<pre><code>package cgo_lib\n\n// #cgo CFLAGS: -I../lib\n// #cgo LDFLAGS: -L../lib -linterfacelib\n// #include \"interface.h\"\nimport \"C\"\n\nfunc GoCreateArray() *int {\n    return *int(C.CCreateArray())\n}\n</code></pre>\n\n<p>When compiling I receive the following error:</p>\n\n<pre><code># cgo_lib\n../cgo_lib/cgo_lib.go:13: cannot convert _Cfunc_CCreateArray() (type *C.int) to type int\n../cgo_lib/cgo_lib.go:13: invalid indirect of int(_Cfunc_CCreateArray()) (type int)\n</code></pre>\n\n<p>So my question is: How to exchange pointers to data structures between C++ and Go. Above I just described the way from C++ to GO, but I'm also interested in the other way round.</p>\n\n<p>Thanks a lot for your help in advance.</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 1886, "user_id": 4076298, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e3153752818310fdadf9b6d7ac67989d?s=128&d=identicon&r=PG", "display_name": "scosman", "link": "https://stackoverflow.com/users/4076298/scosman"}, "edited": false, "score": 0, "creation_date": 1424195376, "post_id": 28565609, "comment_id": 45445731, "body": "Current point of investigation: looking at the &quot;mobile&quot; library&#39;s iOS support. Looks like it&#39;s possible somehow but very early."}], "answers": [{"comments": [{"owner": {"reputation": 1886, "user_id": 4076298, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e3153752818310fdadf9b6d7ac67989d?s=128&d=identicon&r=PG", "display_name": "scosman", "link": "https://stackoverflow.com/users/4076298/scosman"}, "edited": false, "score": 0, "creation_date": 1424196381, "post_id": 28565993, "comment_id": 45446278, "body": "For those of you looking for non-library answer, see this one, also by jimt <a href=\"http://stackoverflow.com/questions/6125683/call-go-functions-from-c/6147097#6147097\" title=\"call go functions from c\">stackoverflow.com/questions/6125683/call-go-functions-from-c&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 1886, "user_id": 4076298, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e3153752818310fdadf9b6d7ac67989d?s=128&d=identicon&r=PG", "display_name": "scosman", "link": "https://stackoverflow.com/users/4076298/scosman"}, "edited": false, "score": 2, "creation_date": 1432666608, "post_id": 28565993, "comment_id": 49013862, "body": "Per @jimt&#39;s second paragraph - it&#39;s now possible. Go&#39;s tip branch now supports <code>go build -buildmode=c-archive yourpkg</code> which will build a library that does not need to be the entry point. The document he pointed to has more details, but I&#39;ve tested this and it&#39;s working."}], "tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": true, "score": 1, "last_activity_date": 1424189941, "creation_date": 1424189941, "answer_id": 28565993, "question_id": 28565609, "link": "https://stackoverflow.com/questions/28565609/calling-go-library-from-c-code/28565993#28565993", "title": "Calling Go library from C Code", "body": "<p>This can not be done currently. Go has to be the entry point and without the use of gccgo, you can't compile Go into a shared library.</p>\n\n<p>There is a proposal to change this, so it may or may not be an option at some point. Refer to <a href=\"https://docs.google.com/document/d/1nr-TQHw_er6GOQRsF6T43GGhFDelrAP0NqSS_00RgZQ/\" rel=\"nofollow\">this document</a> for details.</p>\n"}], "owner": {"reputation": 1886, "user_id": 4076298, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e3153752818310fdadf9b6d7ac67989d?s=128&d=identicon&r=PG", "display_name": "scosman", "link": "https://stackoverflow.com/users/4076298/scosman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 800, "favorite_count": 1, "accepted_answer_id": 28565993, "answer_count": 1, "score": 1, "last_activity_date": 1424189941, "creation_date": 1424188771, "question_id": 28565609, "link": "https://stackoverflow.com/questions/28565609/calling-go-library-from-c-code", "title": "Calling Go library from C Code", "body": "<p>I've found a ton of information about how to use cgo to call C libraries from Go, but I'm interested in the opposite: writing a library in Go, and linking/using it in various C programs.</p>\n\n<p>Is this possible? Any good resources for this? Thanks.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "reply_to_user": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1424192015, "post_id": 28565672, "comment_id": 45443575, "body": "I&#39;ve added an example for you using c.Args.Get(n)"}], "tags": [], "owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "is_accepted": true, "score": 2, "last_activity_date": 1424191857, "last_edit_date": 1424191857, "creation_date": 1424188966, "answer_id": 28565672, "question_id": 28565388, "link": "https://stackoverflow.com/questions/28565388/reading-an-external-file-with-cli-go-package/28565672#28565672", "title": "Reading an external file with cli Go package", "body": "<p>cli.Context.Args returns args form the current context. Meaning, not the global arguments supplied. If you print the length of c.Args you'll see it is zero.</p>\n\n<p>You can either use c.String(\"file\") or remove the app.Flags, supply a command in the format of go run io.go path/to/file.txt and use c.Args.First()</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/codegangsta/cli\"\n\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    app := cli.NewApp()\n    app.Name = \"m2k\"\n    app.Usage = \"convert markdown to kindle\"\n    app.Action = mainAction\n    app.Run(os.Args)\n}\n\nfunc mainAction(c *cli.Context) {\n    var err error\n\n    // use stdin/stdout by default\n    in := os.Stdin\n    out := os.Stdout\n    defer out.Close()\n    defer in.Close()\n\n    // replace stdin if given\n    if c.Args().First() != \"\" {\n        in, err = os.Open(c.Args().First())\n        if err != nil {\n            log.Fatalln(err)\n        }\n        log.Printf(\"Using '%s' as source\\n\", c.Args().First())\n    }\n\n    // replace stdout if given\n    if c.Args().Get(1) != \"\" {\n        out = os.NewFile(0666, c.Args().Get(1))\n        log.Printf(\"Writing output to '%s'\\n\", c.Args().Get(1))\n    }\n\n    b, err := ioutil.ReadAll(in)\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    out.Write([]byte(strings.Replace(string(b), \"in\", \"out\", 1)))\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>echo \"in file content\" &gt; in.txt\ngo run foo.go in.txt\n// 2015/02/17 11:49:49 Using 'in.txt' as source\n// out file content\n</code></pre>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 28565672, "answer_count": 1, "score": 1, "last_activity_date": 1424191857, "creation_date": 1424188123, "last_edit_date": 1424189054, "question_id": 28565388, "link": "https://stackoverflow.com/questions/28565388/reading-an-external-file-with-cli-go-package", "title": "Reading an external file with cli Go package", "body": "<p>I'm using the cli Go package: <a href=\"https://github.com/codegangsta/cli\" rel=\"nofollow\">https://github.com/codegangsta/cli</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/codegangsta/cli\"\n    \"io/ioutil\"\n    \"os\"\n)\n\nfunc main() {\n    app := cli.NewApp()\n    app.Name = \"m2k\"\n    app.Usage = \"convert markdown to kindle\"\n    app.Flags = []cli.Flag{\n        cli.StringFlag{\n            Name:  \"file\",\n            Value: \"english\",\n            Usage: \"language for the greeting\",\n        },\n    }\n\n    app.Action = func(c *cli.Context) {\n        file := \"default\"\n\n        if len(c.Args()) &gt; 0 {\n            file = c.Args()[0]\n        }\n\n        //fmt.Println(\"file %s\", file)\n        fmt.Println(\"file %s\", file)\n\n        b, err := ioutil.ReadFile(file)\n        if err != nil {\n            panic(err)\n        }\n\n        err = ioutil.WriteFile(\"output.txt\", b, 0644)\n        if err != nil {\n            panic(err)\n        }\n    }\n\n    app.Run(os.Args)\n}\n</code></pre>\n\n<p>I'm a Go beginner. So I probably did something very wrong.</p>\n\n<p>I do this in the command line (I have a file called <code>markdown.txt</code> in the directory):</p>\n\n<blockquote>\n  <p>~/go/io$ go run io.go -file markdown.txt</p>\n</blockquote>\n\n<p>But I get this error:</p>\n\n<blockquote>\n  <p>created by runtime.main   /usr/lib/go/src/pkg/runtime/proc.c:221 exit\n  status 2</p>\n</blockquote>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I wrote <code>fmt.Println(\"file %s\", file)</code> to <code>app.Action</code> but nothing is printed. Does this tell something about the problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1424175730, "post_id": 28560477, "comment_id": 45433674, "body": "The cover tool can do this. See <code>$ go tool cover -h</code>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424176334, "post_id": 28560477, "comment_id": 45433981, "body": "It&#39;s a bit tedious though. you have to generate an annotated coverage source code, and then create a testing coverage report manually. It&#39;s simpler to just run the program with a special test that runs main()"}], "owner": {"reputation": 1142, "user_id": 98605, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/63a3bf6cd81eb70fcbda3512fc73a309?s=128&d=identicon&r=PG", "display_name": "Glyn Normington", "link": "https://stackoverflow.com/users/98605/glyn-normington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424170983, "creation_date": 1424170983, "question_id": 28560477, "link": "https://stackoverflow.com/questions/28560477/go-executable-coverage", "title": "Go executable coverage", "body": "<p>It is possible to obtain coverage information when running a test in Go by using <code>go test -cover ...</code>, but this coverage doesn't extend to main programs which are invoked by the test. Is there some way of building a Go executable so that it is instrumented for coverage?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 4, "last_activity_date": 1424170030, "creation_date": 1424170030, "answer_id": 28560175, "question_id": 28560094, "link": "https://stackoverflow.com/questions/28560094/whats-the-use-of-the-following-c-args-0/28560175#28560175", "title": "What&#39;s the use of the following c.Args() &gt; 0", "body": "<p>The function <code>Args</code> returns an object <code>Args</code> which is a slice of strings (see <a href=\"https://github.com/codegangsta/cli/blob/master/context.go\" rel=\"nofollow\"><code>context.go</code></a>):</p>\n\n<blockquote>\n<pre><code>type Args []string\n</code></pre>\n</blockquote>\n\n<p>To get the first element of that slice (<code>[0]</code>) one has to check beforehand if it's not empty, thus the <code>len</code> test. If you don't do this and the slice happens to be empty, you get an <code>index out of range</code> runtime error and your program panics.</p>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 28560175, "answer_count": 1, "score": -1, "last_activity_date": 1424170030, "creation_date": 1424169778, "question_id": 28560094, "link": "https://stackoverflow.com/questions/28560094/whats-the-use-of-the-following-c-args-0", "title": "What&#39;s the use of the following c.Args() &gt; 0", "body": "<p>This code is from the <code>cli</code> Go package: <a href=\"https://github.com/codegangsta/cli\" rel=\"nofollow\">https://github.com/codegangsta/cli</a></p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/codegangsta/cli\"\n    \"os\"\n)\n\nfunc main() {\n    app := cli.NewApp()\n    app.Name = \"greet\"\n    app.Usage = \"fight the loneliness!\"\n    app.Flags = []cli.Flag{\n        cli.StringFlag{\n            Name:  \"lang, l\",\n            Value: \"english\",\n            Usage: \"language for the greeting\",\n        },\n    }\n\n    app.Action = func(c *cli.Context) {\n        name := \"someone\"\n        if len(c.Args()) &gt; 0 {\n            name = c.Args()[0]\n        }\n        if c.String(\"lang\") == \"spanish\" {\n            println(\"Hola\", name)\n        } else {\n            println(\"Hello\", name)\n        }\n    }\n\n    app.Run(os.Args)\n}\n</code></pre>\n\n<p>I'm a Go beginner and I understand everything, except this part:</p>\n\n<pre><code>if len(c.Args()) &gt; 0 {\n    name = c.Args()[0]\n}\n</code></pre>\n\n<p>What does that block says? Why is it necessary?</p>\n"}, {"tags": ["ssl", "go", "ldap"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1425095757, "post_id": 28559806, "comment_id": 45833692, "body": "I&#39;m having the exact same problem. Next week I will try using the <a href=\"https://github.com/go-ldap/ldap\" rel=\"nofollow noreferrer\">go-ldap</a> library, which is a more updated fork of mavericknz&#39;s, and has a fairly recent <a href=\"https://github.com/go-ldap/ldap/pull/5\" rel=\"nofollow noreferrer\">Fix StartTLS patch</a> which I&#39;m hopeful will help. I&#39;ll be sure to submit an answer if this, or something else, proves fruitful. I hope you&#39;ll answer your own question, too, if you find the solution."}], "answers": [{"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1425098421, "post_id": 28778136, "comment_id": 45834044, "body": "Does your LDAP server support STARTTLS on port 389? Evidently not."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1425143160, "post_id": 28778136, "comment_id": 45845079, "body": "This is a work-around, not a proper solution. It seems there is a bug in <code>NewLDAPTLSConnection()</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1425143220, "post_id": 28778136, "comment_id": 45845093, "body": "@EJP: I don&#39;t know about the OP&#39;s LDAP server, but I&#39;ve had the same problem on a large number of LDAP servers which do support TLS, and work when making a connection from Perl, but not with the Go library. I think it&#39;s a bug in the Go lib."}], "tags": [], "owner": {"reputation": 43, "user_id": 4574985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3c9f18b22f0567a84265111054e2b7?s=128&d=identicon&r=PG&f=1", "display_name": "nattawitc", "link": "https://stackoverflow.com/users/4574985/nattawitc"}, "is_accepted": true, "score": 0, "last_activity_date": 1425143167, "last_edit_date": 1425143167, "creation_date": 1425098159, "answer_id": 28778136, "question_id": 28559806, "link": "https://stackoverflow.com/questions/28559806/error-when-trying-to-connect-to-ldap-with-tls-ldap-result-code-201-errornetwor/28778136#28778136", "title": "Error when trying to connect to LDAP with TLS &#39;LDAP Result Code 201 &quot;ErrorNetwork&quot;: Invalid packet format&#39;", "body": "<p>Ok, I've found my solution. I need to change the port from ldap's 389 to ldaps' 636 because we use TLS protocol. And I also has to use method <code>NewLDAPSSLConnection</code> instead to establish an implicit TLS connection.</p>\n\n<p>I'm not sure why <code>NewLDAPTSLConnection</code> does not work. It use explicit TLS which require us to establish a normal connection first (which use port 389) and then attempt to start TLS over that connection.</p>\n"}], "owner": {"reputation": 43, "user_id": 4574985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3c9f18b22f0567a84265111054e2b7?s=128&d=identicon&r=PG&f=1", "display_name": "nattawitc", "link": "https://stackoverflow.com/users/4574985/nattawitc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "accepted_answer_id": 28778136, "answer_count": 1, "score": 1, "last_activity_date": 1425143167, "creation_date": 1424168844, "question_id": 28559806, "link": "https://stackoverflow.com/questions/28559806/error-when-trying-to-connect-to-ldap-with-tls-ldap-result-code-201-errornetwor", "title": "Error when trying to connect to LDAP with TLS &#39;LDAP Result Code 201 &quot;ErrorNetwork&quot;: Invalid packet format&#39;", "body": "<p>I'm trying make an authentication service with LDAP and TLS using <a href=\"http://www.github.com/mavricknz/ldap\" rel=\"nofollow\">http://www.github.com/mavricknz/ldap</a>\nWhen I use only basic authentication using the following code, everything works just fine.</p>\n\n<pre><code>conn := ldap.NewLDAPConnection(ldapHost, ldapPort)\n\nconn.NetworkConnectTimeout = time.Duration(ldapConnTimeout) * time.Millisecond\nconn.ReadTimeout = time.Duration(ldapReadTimeout) * time.Millisecond\n\nif err := conn.Connect(); err != nil {\n    log.Println(err)\n    resp.WriteHeader(http.StatusInternalServerError)\n    return\n}\n\ndefer conn.Close()\n\n// bind to ldap\nif err := conn.Bind(username, password); err != nil {\n    ldaperr := err.(*ldap.LDAPError)\n    if ldaperr.ResultCode == ldap.LDAPResultInvalidCredentials {\n        resp.Header().Set(\"WWW-Authenticate\", `Basic realm=\"Item Codes Database\"`)\n        resp.WriteHeader(http.StatusUnauthorized)\n    } else {\n        log.Println(err)\n        resp.WriteHeader(http.StatusInternalServerError)\n    }\n    return\n}\n</code></pre>\n\n<p>but when I try to applying TLS to my code by changing</p>\n\n<pre><code>conn := ldap.NewLDAPConnection(ldapHost, ldapPort)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>ldap.NewLDAPTLSConnection(ldapHost, ldapPort, &amp;tls.Config{})\n</code></pre>\n\n<p>It gives me an error <code>LDAP Result Code 201 \"ErrorNetwork\": Invalid packet format</code>. That error comes from method <code>conn.Connect()</code> which when I dig into it, it didn't even reach the point where the TLS config or TLS flag has been used.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1424168025, "post_id": 28558711, "comment_id": 45430548, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/26071813/scanning-spaces-from-stdin-in-go\">scanning spaces from stdin in Go</a>"}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424181219, "post_id": 28558711, "comment_id": 45436507, "body": "Very similar to the referenced link, but probably not as &quot;googleable&quot;. OP - you should take a look at the <a href=\"http://golang.org/pkg/bufio/\" rel=\"nofollow noreferrer\">bufio</a> package (as also pointed to in that link)."}], "answers": [{"tags": [], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "is_accepted": true, "score": 0, "last_activity_date": 1450341681, "last_edit_date": 1495535408, "creation_date": 1450341681, "answer_id": 34330068, "question_id": 28558711, "link": "https://stackoverflow.com/questions/28558711/read-multi-word-string-from-console/34330068#34330068", "title": "Read multi word string from console", "body": "<p>Your question refers to scanning space separated input. The definition of <code>fmt.Scan</code> <a href=\"https://golang.org/pkg/fmt/#Scan\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/#Scan</a> states:</p>\n\n<pre><code>Scan scans text read from standard input, storing successive space-\nseparated values into successive arguments. Newlines count as space.\nIt returns the number of items successfully scanned. If that is less\nthan the number of arguments, err will report why.\n</code></pre>\n\n<p>So, by definition, input is scanned up until the first space is found. To scan, let's say until you hit a <code>\\n</code> on the command line you can use the code from the comment <a href=\"https://stackoverflow.com/questions/26071813/scanning-spaces-from-stdin-in-go\">scanning spaces from stdin in Go</a>:</p>\n\n<pre><code>scanner := bufio.NewScanner(os.Stdin)\nfor scanner.Scan() {\n    return scanner.Text()\n}\nif err := scanner.Err(); err != nil {\n    fmt.Fprintln(os.Stderr, \"reading standard input:\", err)\n}\n</code></pre>\n\n<p>Also this thread might be useful: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/r6Jl4D9Juw0\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/r6Jl4D9Juw0</a></p>\n"}, {"tags": [], "owner": {"reputation": 2372, "user_id": 7245145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/njfat.png?s=128&g=1", "display_name": "Steffi Keran Rani J", "link": "https://stackoverflow.com/users/7245145/steffi-keran-rani-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1531253436, "last_edit_date": 1531253436, "creation_date": 1528526796, "answer_id": 50771675, "question_id": 28558711, "link": "https://stackoverflow.com/questions/28558711/read-multi-word-string-from-console/50771675#50771675", "title": "Read multi word string from console", "body": "<p>One can use the <code>InputReader</code> also to scan and print multiple words from the console.</p>\n\n<p>The <strong>solution code</strong> is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    inputReader := bufio.NewReader(os.Stdin)\n    input, _ := inputReader.ReadString('\\n')\n    fmt.Println(input)\n}\n</code></pre>\n\n<p><strong>Console Input:</strong></p>\n\n<p>Let's Go!!!</p>\n\n<p><strong>Console Output:</strong></p>\n\n<p>Let's Go!!!</p>\n\n<p>Note:</p>\n\n<p>To run a GOLANG program, open the command prompt or powershell, navigate to the directory where the program file is present and type in the following command:</p>\n\n<pre><code>go run file_name.go\n</code></pre>\n"}], "owner": {"reputation": 10232, "user_id": 2104976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1a5168ce005df0148523b929ea9983c0?s=128&d=identicon&r=PG", "display_name": "callmekatootie", "link": "https://stackoverflow.com/users/2104976/callmekatootie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3024, "favorite_count": 1, "accepted_answer_id": 34330068, "answer_count": 2, "score": 2, "last_activity_date": 1531253436, "creation_date": 1424165662, "question_id": 28558711, "link": "https://stackoverflow.com/questions/28558711/read-multi-word-string-from-console", "title": "Read multi word string from console", "body": "<p>I realized that the following only reads a single word string -  </p>\n\n<pre><code>fmt.Scan(&amp;sentence)\n</code></pre>\n\n<p>How do I read multi word string - as in, the string <code>sentence</code> should store a string that contains multiple words.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1424211909, "post_id": 28558975, "comment_id": 45454320, "body": "It seems to be the case though I find it awkward that you can&#39;t use single quotes. Now my directive will have several backslash characters to escape the double quotes. Do you think this has any chance as a feature/improvement request or there are good reasons why it doesn&#39;t accept single quotes ?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 1, "creation_date": 1424238321, "post_id": 28558975, "comment_id": 45462566, "body": "I doubt that such a feature request would find lots of supporters: Go generate a simple mechanism and after introducing single quotes someone will ask for backquotes and the next one for python-like triple quotes (double and single) just because it make one use of go generate a bit simpler. Go generate is neither for the end user nor for the user of your package: Investing 5 or maybe 15 minutes to properly quote some doublequotes seems okay for a programmer."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 4, "last_activity_date": 1424166436, "creation_date": 1424166436, "answer_id": 28558975, "question_id": 28558110, "link": "https://stackoverflow.com/questions/28558110/go-generate-escape-characters/28558975#28558975", "title": "Go generate escape characters", "body": "<p>From the design document of go generate <a href=\"https://docs.google.com/document/d/1V03LUfjSADDooDMhe-_K59EgpTEm3V8uvQRuNMAEnjg/edit\" rel=\"nofollow\">https://docs.google.com/document/d/1V03LUfjSADDooDMhe-_K59EgpTEm3V8uvQRuNMAEnjg/edit</a>:</p>\n\n<blockquote>\n  <p>The arguments are space-separated tokens (or double-quoted strings) passed to the generator as individual arguments when it is run.</p>\n</blockquote>\n\n<p>So if you want to pass an argument containing space you will have to double quote them. You used single quotes which works in your shell but not with <code>go generate</code></p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1424166436, "creation_date": 1424163702, "last_edit_date": 1424165037, "question_id": 28558110, "link": "https://stackoverflow.com/questions/28558110/go-generate-escape-characters", "title": "Go generate escape characters", "body": "<p>I have a go generate directive which looks like this:</p>\n\n<pre><code>//go:generate myprog -someName thisname -data 'Request: Typ \".\" callMe, Rsp:  MyTyp \".\" close'\n</code></pre>\n\n<p>The issue is that the program receives only value of <code>-someName</code> flag (\"thisname\"). I assume the <code>-data</code> flag is discarded for some reasons. Any idea why? It's working if I execute the program directly from command line so I guess it's a go specific issue.  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1424158684, "post_id": 28556775, "comment_id": 45425713, "body": "You need to extract the methods from iterating the types, not the funcs."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424159173, "post_id": 28556775, "comment_id": 45425941, "body": "Yeah...I&#39;ve just started working on this..."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424162119, "post_id": 28556775, "comment_id": 45427305, "body": "maybe post the way to do it as an answer when you figure it out"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424163752, "post_id": 28556775, "comment_id": 45428094, "body": "The methods are available in the Types field (which doesn&#39;t seems right to me) so I&#39;m not sure if it&#39;s worth an answer."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424165625, "post_id": 28556775, "comment_id": 45429051, "body": "It seems perfectly right to me - the methods belong to types, not to the package itself. but if it confused you it might confuse others, so an answer would be good."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424181520, "post_id": 28556775, "comment_id": 45436678, "body": "@Not_a_Golfer, I entirely agree. OP - a package only exports constants, variables, functions and types. The first three are exactly what they sound like, types is where it gets fun. Struct types, which is what you&#39;re looking for, are the ones who know about what functions return them (i.e. &quot;constructors&quot;) and what methods they receive (methods called on them)."}], "answers": [{"tags": [], "owner": {"reputation": 9371, "user_id": 196964, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/df6zG.jpg?s=128&g=1", "display_name": "Doug Richardson", "link": "https://stackoverflow.com/users/196964/doug-richardson"}, "is_accepted": false, "score": 0, "last_activity_date": 1431037889, "creation_date": 1431037889, "answer_id": 30112761, "question_id": 28556775, "link": "https://stackoverflow.com/questions/28556775/why-go-doc-doesnt-provide-the-methods/30112761#30112761", "title": "Why go/doc doesn&#39;t provide the methods?", "body": "<p>Iterate through <code>pkg.Types</code> and on each item you can get its <a href=\"http://localhost:6060/pkg/go/doc/#Type\" rel=\"nofollow\">Methods</a>.</p>\n\n<pre><code>type Type struct {\n  Doc  string\n  Name string\n  Decl *ast.GenDecl\n\n  // associated declarations\n  Consts  []*Value // sorted list of constants of (mostly) this type\n  Vars    []*Value // sorted list of variables of (mostly) this type\n  Funcs   []*Func  // sorted list of functions returning this type\n  Methods []*Func  // sorted list of methods (including embedded ones) of this type\n}\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1431037889, "creation_date": 1424158153, "question_id": 28556775, "link": "https://stackoverflow.com/questions/28556775/why-go-doc-doesnt-provide-the-methods", "title": "Why go/doc doesn&#39;t provide the methods?", "body": "<p>I'm trying to extract the documentation for various functions an methods using the <a href=\"http://golang.org/src/go/doc\" rel=\"nofollow\">go/doc</a> package. The code looks pretty much as below. The issue is that it prints/provides only the functions from the package(exported and unexported) but no method regardless if they're exported or unexported. I also tried <code>AllMethods</code> mode with no success. Is this a bug or I'm missing something?</p>\n\n<pre><code>pkg := doc.New(mainPkg, \"./\", doc.AllDecls)\n\nfor _, vv := range pkg.Funcs {\n    log.Infof(\"vv.Name %v, vv.Recv %v\", vv.Name,  vv.Recv,  )\n\n}\n</code></pre>\n"}, {"tags": ["go", "yacc"], "answers": [{"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 1, "last_activity_date": 1424165075, "creation_date": 1424165075, "answer_id": 28558527, "question_id": 28555766, "link": "https://stackoverflow.com/questions/28555766/why-does-go-yacc-parser-panic-while-defining-more-types/28558527#28558527", "title": "why does go yacc parser panic while defining more types?", "body": "<p>Interesting - I've used <code>go tool yacc</code> quite a bit and not noticed this limitation.</p>\n\n<p>The reason it is like that is that <code>yacc.go</code> was ported from a C program and what you see is the obvious straight forward port.</p>\n\n<p>Looking at the code of <code>yacc.go</code> it would be very straightforward to remove that limitation and turn the <code>typeset</code> array into a slice.</p>\n\n<p>What I would do is <a href=\"https://github.com/golang/go/issues\" rel=\"nofollow\">open an issue</a> (check a that there isn't an existing one - I didn't see one but I didn't look very carefully). Next if you are feeling brave submit a patch using the <a href=\"http://golang.org/doc/contribute.html\" rel=\"nofollow\">go contribution guidelines</a>.  It is a good way to get into contributing to go itself.</p>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 4581767, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5df6eb368c763f81e6c79520c0392932?s=128&d=identicon&r=PG&f=1", "display_name": "benG", "link": "https://stackoverflow.com/users/4581767/beng"}, "is_accepted": true, "score": 1, "last_activity_date": 1424368300, "creation_date": 1424368300, "answer_id": 28613402, "question_id": 28555766, "link": "https://stackoverflow.com/questions/28555766/why-does-go-yacc-parser-panic-while-defining-more-types/28613402#28613402", "title": "why does go yacc parser panic while defining more types?", "body": "<p>\"It panics,\"Index out of range in yacc.go:891\" \"</p>\n\n<p>I got into the same problem because I needed more types (non-term and term types) and what I did to remedy my situation was to change several values.</p>\n\n<p>Please see my <a href=\"https://github.com/MagnusTiberius/go/commit/d4eeb860229867c76d99e67d69bdbd7cc729ce2c\" rel=\"nofollow\">GitHub page documenting my change</a>.</p>\n\n<p>Or simply click on the URL below.</p>\n\n<p><a href=\"https://github.com/MagnusTiberius/go/commit/d4eeb860229867c76d99e67d69bdbd7cc729ce2c\" rel=\"nofollow\">https://github.com/MagnusTiberius/go/commit/d4eeb860229867c76d99e67d69bdbd7cc729ce2c</a></p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 28613402, "answer_count": 2, "score": 2, "last_activity_date": 1424368300, "creation_date": 1424153455, "last_edit_date": 1424155432, "question_id": 28555766, "link": "https://stackoverflow.com/questions/28555766/why-does-go-yacc-parser-panic-while-defining-more-types", "title": "why does go yacc parser panic while defining more types?", "body": "<p>I wrote a test.y file with more types. After certain limit, when I compiled the file with command,\ngo tool yacc test</p>\n\n<p>It panics,\"Index out of range in yacc.go:891\"\nWhen I looked at the file <a href=\"https://golang.org/src/cmd/yacc/yacc.go\" rel=\"nofollow\">https://golang.org/src/cmd/yacc/yacc.go</a>, I saw this comment in defining the constants\n\"the following are adjustable according to memory size\"\nIs there a reason why they have limited the number of type definition to 63(NTYPES = 63) in line 74(in the file mentioned in the link above)</p>\n"}, {"tags": ["c", "performance", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1424155896, "post_id": 28554789, "comment_id": 45424580, "body": "Did you try wrapping your file io with package bufio? Additionally: Why not use the counting functionality provided by package bytes?"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1424157372, "post_id": 28554789, "comment_id": 45425176, "body": "@Volker: this should actually be the answer.  Using the <code>bytes.Count</code> alone speeds up execution by 2x.  @eric_lagergren, you can look at the implementation of Count in bytes package."}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1424159970, "post_id": 28554789, "comment_id": 45426278, "body": "@Volker the reading isn&#39;t the problem. It&#39;s the <code>count()</code> function. See next reply..."}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1424160024, "post_id": 28554789, "comment_id": 45426313, "body": "@sberry, <code>bytes.Count()</code> actually ran slower for me. I tried it with my <code>count()</code> and <code>bytes.Count()</code> and even Go&#39;s assembly didn&#39;t speed it up."}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "edited": false, "score": 0, "creation_date": 1424160191, "post_id": 28554789, "comment_id": 45426382, "body": "Well, actually now it&#39;s running still slower but closer. Perhaps I goofed up my tests earlier. Who knows. Thanks."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424200583, "post_id": 28554789, "comment_id": 45448579, "body": "Not sure what the motivation is other than a drag race, but  <a href=\"https://www.youtube.com/watch?v=BkKP3naKLi8\" rel=\"nofollow noreferrer\">youtube.com/watch?v=BkKP3naKLi8</a> describes someone getting speed on a related counting problem by avoiding branching, using a table. You could look for wacky ways to use SSE 4.2 instructions via a .s file (not sure if 6a supports them, though). You really don&#39;t need to."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424200656, "post_id": 28554789, "comment_id": 45448627, "body": "Maybe the most important observation is that a 4x difference here does not mean a 4x diff everywhere. To see how, say, a Web app would perform, build a little of it out and compare those."}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424201207, "post_id": 28554789, "comment_id": 45448915, "body": "@twotwotwo The motivation is a drag race. I just need to count bytes as quickly as possible. This will be (and is) the bottleneck of the program -- it&#39;s internal use."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424202401, "post_id": 28554789, "comment_id": 45449554, "body": "@eric_lagergren I&#39;m not on Intel etc. so can&#39;t compare, but here&#39;s <a href=\"http://play.golang.org/p/4urJlhL-ZF\" rel=\"nofollow noreferrer\">play.golang.org/p/4urJlhL-ZF</a>"}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424203092, "post_id": 28554789, "comment_id": 45449871, "body": "@twotwotwo Mmap is faster than the original, but slower than <code>bytes.IndexByte()</code> (roughly 3 seconds)... it took ~10 seconds on the first run, which presumably was loading the file into memory."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424203349, "post_id": 28554789, "comment_id": 45449995, "body": "@eric_lagergren Right, now using IndexByte, which is a small gain on my file/machine: <a href=\"http://play.golang.org/p/5l0ppjveVS\" rel=\"nofollow noreferrer\">play.golang.org/p/5l0ppjveVS</a> -- most obvious step from here would be to divide the file into n pieces and go get a count from each, but that&#39;s a lot of fuss. (I didn&#39;t see any gain from counting <i>all</i> byte occurrences in a table to avoid the branch, maybe because the branch is predictable, i.e., most bytes aren&#39;t newlines. YMMV.)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424204813, "post_id": 28554789, "comment_id": 45450823, "body": "@eric_lagergren Yeah, tiny gain on my (ARM!) machine (on a different file!) by parallelizing: <a href=\"http://play.golang.org/p/j8b-f3qWMu\" rel=\"nofollow noreferrer\">play.golang.org/p/j8b-f3qWMu</a> . But, again, though I don&#39;t know your domain, life often holds bigger concerns than whether newline counting only runs at 800 MB/s when the file is cached in RAM. If the file isn&#39;t cached in real life, CPU time could be swamped by time to read, for instance."}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424233639, "post_id": 28554789, "comment_id": 45461183, "body": "@twotwotwo True. My only concern is that Go gets as close of speed as C, primarily because I&#39;m looking to swap out the C program with Go. And while two seconds on a 2.5GB file isn&#39;t very much, I&#39;ve been rather bored the last couple nights and this has piqued my interest."}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424233657, "post_id": 28554789, "comment_id": 45461186, "body": "@twotwotwo Thanks for your help though. Really insightful and that video is interesting."}], "answers": [{"comments": [{"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "edited": false, "score": 0, "creation_date": 1424233376, "post_id": 28568669, "comment_id": 45461117, "body": "I like it. Unfortunately, on my Linux box (debian 3.16, i3 w/ 8gb ram) it take ~2.5 sec, which is about the same (actually, almost identical) as if it simply used <code>*os.File.Read()</code> in a loop. Thanks, though!"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "edited": false, "score": 0, "creation_date": 1424241241, "post_id": 28568669, "comment_id": 45463546, "body": "I&#39;m glad it was useful. Again I must assert I&#39;m a *nix noob, but if you are running Mint, I could say I felt Vista all over again! On the other hand Ubuntu was doing great and Zorin is doing even better. I do not know how is that possible, but it should have something to do with optimizing the swap drive and things like that. Zorin installed with default settings (next,next,next,...)."}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 1, "last_activity_date": 1424198581, "last_edit_date": 1424198581, "creation_date": 1424198168, "answer_id": 28568669, "question_id": 28554789, "link": "https://stackoverflow.com/questions/28554789/counting-occurrence-of-character-in-slice-in-go/28568669#28568669", "title": "Counting occurrence of character in slice in Go", "body": "<p>As far as this is about counting <code>'\\n'</code> in a file, this code runs in ~1.26 sec (and mostly faster), on a Zorin VM (VMWare Player), 6 GB RAM, 4 Cores (&amp; power is plugged in; because power managers sometimes prevent CPU from consuming battery too fast), Host OS is Windows 8. I am using Go in some real world projects for less than 6 months and I'm a Linux noob too. But I think the problem is calling C from Go and that's much slower than pure Go - I've experienced this in calling some C code, both as <code>dll</code> and got compiled with <code>cgo</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"runtime\"\n    \"time\"\n)\n\nfunc main() {\n    tstart := time.Now()\n\n    file, err := os.Open(filePath)\n    if err != nil {\n        panic(err)\n    }\n    defer file.Close()\n\n    done := make(chan bool)\n    var cnt int64 = 0\n    go func() {\n        var Buffer = make([]byte, BufferSize)\n        for {\n            n, err := file.Read(Buffer)\n            if err != nil &amp;&amp; err != io.EOF {\n                panic(err)\n            }\n\n            cnt += count(Buffer[:n])\n\n            if err == io.EOF {\n                done &lt;- true\n                return\n            }\n        }\n    }()\n    &lt;-done\n    // should be 5860298 in this case (zorin iso image) &amp; it is.\n    fmt.Println(cnt)\n    fmt.Printf(\"%s took %s\\n\", \"counting\", time.Since(tstart))\n}\n\nfunc count(s []byte) int64 {\n    count := int64(0)\n    for i := 0; i &lt; len(s); i++ {\n        if s[i] == NewLineByte {\n            count++\n        }\n    }\n    return count\n}\n\nconst (\n    NewLineByte = '\\n' // or 10\n    BufferSize  = 32 * 1024\n)\n\nvar (\n    filePath = \"/.../zorin-os-9.1-core-64++.iso\"\n    maxt     int\n)\n\nfunc init() {\n    maxt = runtime.NumCPU()\n    runtime.GOMAXPROCS(maxt)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 1, "last_activity_date": 1424331173, "last_edit_date": 1424331173, "creation_date": 1424288084, "answer_id": 28592330, "question_id": 28554789, "link": "https://stackoverflow.com/questions/28554789/counting-occurrence-of-character-in-slice-in-go/28592330#28592330", "title": "Counting occurrence of character in slice in Go", "body": "<p><a href=\"http://play.golang.org/p/5l0ppjveVS\" rel=\"nofollow\">Here's</a> a not too hard and not too slow way, using <code>bytes.IndexByte</code> (since you found Go's asm implementation of it helped) and <code>syscall.Mmap</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"syscall\"\n)\n\nfunc main() {\n    if len(os.Args) &lt; 2 {\n        log.Fatal(\"pass filename on command line\")\n    }\n    f, err := os.Open(os.Args[1])\n    if err != nil {\n        log.Fatal(\"open: \", err)\n    }\n    stat, err := f.Stat()\n    if err != nil {\n        log.Fatal(\"stat: \", err)\n\n    }\n    data, err := syscall.Mmap(int(f.Fd()), 0, int(stat.Size()), syscall.PROT_READ, syscall.MAP_SHARED)\n    if err != nil {\n        log.Fatal(\"mmap: \", err)\n    }\n    newlines := 0\n    for {\n        i := bytes.IndexByte(data, 10)\n        if i == -1 {\n            break\n        }\n        newlines++\n        data = data[i+1:]\n    }\n    fmt.Println(newlines)\n}\n</code></pre>\n\n<p><code>Mmap</code> looks weird, but here it's much as if you'd read the file into a slice, except less resource-intensive thanks to the OS's help.</p>\n\n<p><a href=\"http://play.golang.org/p/j8b-f3qWMu\" rel=\"nofollow\">You can parallelize the counting</a> without too much more work, but I'm not sure that's worth it. (It would not shock me if the gain on <code>amd64</code> were zero or negative if, for example, single-core counting were limited by memory bandwidth, but that's not quick for me to test.)</p>\n"}], "owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1974, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1424331173, "creation_date": 1424148343, "last_edit_date": 1424163818, "question_id": 28554789, "link": "https://stackoverflow.com/questions/28554789/counting-occurrence-of-character-in-slice-in-go", "title": "Counting occurrence of character in slice in Go", "body": "<p>Okay, so I've hit a brick wall. </p>\n\n<p><strong>Edit:</strong>\nUsing <code>bytes.IndexByte()</code> in my <code>count()</code> function makes it run almost twice as fast. <code>bytes.IndexByte()</code> is written in assembly instead of Go. Still not C speed, but closer.</p>\n\n<p>I have two programs, one in C and one in Go that both count newlines in a file. Super simple. The C program runs in ~1.5 seconds, the Go in ~4.25 seconds on a 2.4GB file.</p>\n\n<p>Am I hitting Go's speed limit? If so, <em>what</em>, exactly, is causing this? I can read C, but I can't read Assembly so comparing the C's asm and the Go's asm doesn't do much to me except show that the Go has ~400 more lines (ignoring the .ascii section).</p>\n\n<p>While I know Go can't match C step-for-step, I wouldn't assume a 4x slowdown.</p>\n\n<p>Ideas?</p>\n\n<p>Here's the cpuprofile of the Go:\n<img src=\"https://i.stack.imgur.com/DDiwV.png\" alt=\"enter image description here\"></p>\n\n<p>Here's the C (compiled w/ <code>gcc -Wall -pedantic -O9</code>)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n\n#define BUFFER_SIZE (16 * 1024)\n\nint\nmain()\n{\n\n    const char *file = \"big.txt\";\n    int fd = open (file, O_RDONLY);\n    char buf[BUFFER_SIZE + 1];\n    uintmax_t bytes;\n    size_t bytes_read;\n    size_t lines;\n\n    posix_fadvise (fd, 0, 0, POSIX_FADV_SEQUENTIAL);\n    while ((bytes_read = safe_read (fd, buf, BUFFER_SIZE)) &gt; 0)\n    {\n        char *p = buf;\n\n        // error checking\n\n        while ((p = memchr (p, '\\n', (buf + bytes_read) - p)))\n          {\n            ++p;\n            ++lines;\n          }\n        bytes += bytes_read;\n    }\n    printf(\"%zu\\n\", bytes);\n    printf(\"%zu\\n\", lines);\n    return 0;\n}\n</code></pre>\n\n<p>And the Go:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"runtime/pprof\"\n    \"syscall\"\n)\n\nconst (\n    POSIX_FADV_SEQUENTIAL = 2\n\n    NewLineByte = '\\n' // or 10\n    BufferSize  = (16 * 1024) + 1\n)\n\nvar Buffer = make([]byte, BufferSize)\n\nfunc fadvise(file *os.File, off, length int, advice uint32) error {\n    _, _, errno := syscall.Syscall6(syscall.SYS_FADVISE64, file.Fd(), uintptr(off), uintptr(length), uintptr(advice), 0, 0)\n    if errno != 0 {\n        return errno\n    }\n    return nil\n}\n\nfunc count(s []byte) int64 {\n    count := int64(0)\n    for i := 0; i &lt; len(s); i++ {\n        if s[i] == NewLineByte {\n            count++\n        }\n    }\n    return count\n}\n\nfunc main() {\n\n    file, err := os.Open(\"big.txt\")\n    if err != nil {\n        panic(err)\n    }\n\n    var lines int64\n    var bytes int64\n\n    fadvise(file, 0, 0, POSIX_FADV_SEQUENTIAL)\n    for {\n\n        n, err := file.Read(Buffer)\n        if err != nil &amp;&amp; err != io.EOF {\n            panic(err)\n        }\n\n        lines += count(Buffer[:n])\n        bytes += int64(n)\n\n        if err == io.EOF {\n            break\n        }\n    }\n\n    fmt.Printf(\"%d\\n\", bytes)\n    fmt.Printf(\"%d\\n\", lines)\n}\n</code></pre>\n"}, {"tags": ["templates", "go", "go-templates"], "comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424134472, "post_id": 28552612, "comment_id": 45418754, "body": "It&#39;s a little unclear what you&#39;re asking, do you mean to ask how you can check if something was nil? Or rather how to loop through the map, by (key, value) pair?"}, {"owner": {"reputation": 2414, "user_id": 1405208, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/3d7057ec4f36e18100f92b15ca310a5a?s=128&d=identicon&r=PG", "display_name": "Julien Fouilh&#233;", "link": "https://stackoverflow.com/users/1405208/julien-fouilh%c3%a9"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424143058, "post_id": 28552612, "comment_id": 45420920, "body": "@user114241 No, I&#39;m asking if there&#39;s a way to get the list of variables used in a go template, before execution."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424180713, "post_id": 28552612, "comment_id": 45436260, "body": "I mean the only variables accessible in a text/template are those that you pass in when you <code>Execute()</code>... Sorry, maybe I just haven&#39;t had enough coffee yet this afternoon."}, {"owner": {"reputation": 2414, "user_id": 1405208, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/3d7057ec4f36e18100f92b15ca310a5a?s=128&d=identicon&r=PG", "display_name": "Julien Fouilh&#233;", "link": "https://stackoverflow.com/users/1405208/julien-fouilh%c3%a9"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424182885, "post_id": 28552612, "comment_id": 45437465, "body": "@user114241 no That&#39;s me who&#39;s not able to explain what I want. I want to get the <b>names</b> of the variables used in the template without having to change anything in the template. But that&#39;s alright I did that another way that I&#39;ll explain in an answer later. Thanks anyways"}, {"owner": {"reputation": 2414, "user_id": 1405208, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/3d7057ec4f36e18100f92b15ca310a5a?s=128&d=identicon&r=PG", "display_name": "Julien Fouilh&#233;", "link": "https://stackoverflow.com/users/1405208/julien-fouilh%c3%a9"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424183122, "post_id": 28552612, "comment_id": 45437623, "body": "@user114241 I explained a little bit more in the question, I hope it&#39;s a bit more understandable."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424183583, "post_id": 28552612, "comment_id": 45437937, "body": "Ah kk, honestly I would keep a []string that contains the names of the variables that are set in your map. Then in the template, you can range over the []string and use the value to index into your map. If you want the template to not compile at all though if variables are not set you may want to look at <a href=\"https://developers.google.com/closure/templates/\" rel=\"nofollow noreferrer\">soy</a> and the go implementation of it <a href=\"https://github.com/robfig/soy\" rel=\"nofollow noreferrer\">robfig/soy</a> (you can have templates fail to compile if @params in soy docs are not provided/set)."}], "answers": [{"comments": [{"owner": {"reputation": 2414, "user_id": 1405208, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/3d7057ec4f36e18100f92b15ca310a5a?s=128&d=identicon&r=PG", "display_name": "Julien Fouilh&#233;", "link": "https://stackoverflow.com/users/1405208/julien-fouilh%c3%a9"}, "edited": false, "score": 1, "creation_date": 1424587420, "post_id": 28655268, "comment_id": 45607159, "body": "Yes I forgot to answer my own question but that&#39;s actually what I did as what I wanted to do seems to be impossible! Thanks!"}], "tags": [], "owner": {"reputation": 17526, "user_id": 711902, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/36a9e6931ec4828c293156c50ac339ec?s=128&d=identicon&r=PG", "display_name": "Trevor Dixon", "link": "https://stackoverflow.com/users/711902/trevor-dixon"}, "is_accepted": true, "score": 5, "last_activity_date": 1424587243, "creation_date": 1424587243, "answer_id": 28655268, "question_id": 28552612, "link": "https://stackoverflow.com/questions/28552612/is-there-a-way-to-list-used-variables/28655268#28655268", "title": "is there a way to list used variables?", "body": "<p>Use a template func that returns an error if a value isn't set. Something like this:</p>\n\n<pre><code>template.FuncMap(map[string]interface{}{\n    \"require\": func(val interface{}) (interface{}, error) {\n        if val == nil {\n            return nil, errors.New(\"Required value not set.\")\n        }\n        return val, nil\n    },\n}))\n</code></pre>\n\n<p>Then in your template:</p>\n\n<pre><code>{{require .Value}}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/qZMBID7Y8L\" rel=\"noreferrer\">http://play.golang.org/p/qZMBID7Y8L</a></p>\n"}], "owner": {"reputation": 2414, "user_id": 1405208, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/3d7057ec4f36e18100f92b15ca310a5a?s=128&d=identicon&r=PG", "display_name": "Julien Fouilh&#233;", "link": "https://stackoverflow.com/users/1405208/julien-fouilh%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 1, "accepted_answer_id": 28655268, "answer_count": 1, "score": 5, "last_activity_date": 1500203855, "creation_date": 1424132097, "last_edit_date": 1500203855, "question_id": 28552612, "link": "https://stackoverflow.com/questions/28552612/is-there-a-way-to-list-used-variables", "title": "is there a way to list used variables?", "body": "<p>Let's say I have a basic go text/template:</p>\n\n<pre><code>{{.var}} is another {{.var2}}\n</code></pre>\n\n<p>I want to get an array of the variables names used in the template, to be able to skip the execution if they are not available in the data I pass to execute, is it possible to do that somehow?</p>\n\n<p>As my data is not a struct but a map, doing .var will always return something: if it doesn't exist, it will return an empty string when I would have hoped to get an error when executing the template.</p>\n\n<p>So for the example from above, I would have liked to get:</p>\n\n<pre><code>[var var2]\n</code></pre>\n"}, {"tags": ["c", "go"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1424124177, "post_id": 28551043, "comment_id": 45415338, "body": "Can you post the code you want to translate so we have a rough idea of what your problem is?"}], "answers": [{"tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": true, "score": 9, "last_activity_date": 1424131137, "creation_date": 1424131137, "answer_id": 28552459, "question_id": 28551043, "link": "https://stackoverflow.com/questions/28551043/golang-cast-memory-to-struct/28552459#28552459", "title": "golang cast memory to struct", "body": "<p>If you want to cast an array of bytes to a struct, the <a href=\"http://godoc.org/unsafe\" rel=\"noreferrer\">unsafe</a> package can do it for you. <a href=\"http://play.golang.org/p/nopskB1Emd\" rel=\"noreferrer\">Here is a working example</a>:</p>\n\n<p>There are limitations to the struct field types you can use in this way.\nSlices and strings are out, unless your C code yields exactly the right memory layout for the respective slice/string headers, which is unlikely.\nIf it's just fixed size arrays and types like (u)int(8/16/32/64), the code below may be good enough. Otherwise you'll have to manually copy and assign each struct field by hand.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"unsafe\"\n\ntype T struct {\n    A uint32\n    B int16\n}\n\nvar sizeOfT = unsafe.Sizeof(T{})\n\nfunc main() {\n    t1 := T{123, -321}\n    fmt.Printf(\"%#v\\n\", t1)\n\n    data := (*(*[1&lt;&lt;31 - 1]byte)(unsafe.Pointer(&amp;t1)))[:sizeOfT]\n    fmt.Printf(\"%#v\\n\", data)\n\n    t2 := (*(*T)(unsafe.Pointer(&amp;data[0])))\n    fmt.Printf(\"%#v\\n\", t2)\n}\n</code></pre>\n\n<p>Note that <code>(*[1&lt;&lt;31 - 1]byte)</code> does not actually allocate a byte array of this size. It's a trick used to ensure a slice of the correct size can be created through the <code>...[:sizeOfT]</code> part. The size <code>1&lt;&lt;31 - 1</code> is the largest possible size any slice in Go can have. At least this used to be true in the past. I am unsure of this still applies. Either way, you'll have to use this approach to get a correctly sized slice of bytes.</p>\n"}], "owner": {"reputation": 130, "user_id": 1247066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5145d4f3d7f1d2ed96b127f9557da390?s=128&d=identicon&r=PG", "display_name": "user1247066", "link": "https://stackoverflow.com/users/1247066/user1247066"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3381, "favorite_count": 1, "accepted_answer_id": 28552459, "answer_count": 1, "score": 3, "last_activity_date": 1424131137, "creation_date": 1424123810, "question_id": 28551043, "link": "https://stackoverflow.com/questions/28551043/golang-cast-memory-to-struct", "title": "golang cast memory to struct", "body": "<p>I'm working on porting legacy code to golang, the code is high performance and I'm having trouble translating a part of the program that reads of a shared memory for later parsing.\nIn c I would just cast the memory into a struct and access it normally.\nWhat is the most efficient and idiomatic to achieve the same result in go?  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424119642, "post_id": 28550020, "comment_id": 45413127, "body": "Typically if you use http.Redirect, you would want to return immediately so the browser can follow the redirect. May I ask what code would come after the redirect? Also, unless you&#39;re using some framework where you have access to the underlying instance of whatever is implementing http.ResponseWriter, you won&#39;t be able to know what its state is."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424119957, "post_id": 28550020, "comment_id": 45413285, "body": "Because I have a wrapper struct, that is going to render html file or not, if the redirect was set, then is should not going to render html file."}], "answers": [{"tags": [], "owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1424180500, "last_edit_date": 1424180500, "creation_date": 1424120634, "answer_id": 28550300, "question_id": 28550020, "link": "https://stackoverflow.com/questions/28550020/how-to-detect-if-redirect-was-invoked/28550300#28550300", "title": "How to detect if redirect was invoked", "body": "<p>If I understand you correctly, you want something more along these lines:</p>\n\n<pre><code>func fooHandler(w http.ResponseWriter, r *http.Request) {\n    // Here an if condition, if should redirect or not\n    if needToRedirect {\n        http.Redirect(w, r, \"http://www.google.com\", 301)\n        return\n    }\n    // Do something....\n    // Call function if redirect was invoked\n    // render template\n}\n</code></pre>\n\n<p>Normally in go we follow the <em>exit</em> <em>early</em> mantra. In your example, once you've identified that the user needs to be redirected (ignoring any other logging you may want to do) it would be best to return immediately.</p>\n"}, {"comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424180330, "post_id": 28556848, "comment_id": 45436097, "body": "Actually he can&#39;t do this - in this example <code>resp</code> is an <code>*http.Response</code>, which you can access fields in. In the OPs example, his response is an <code>http.ResponseWriter</code> (an interface) which he can&#39;t access fields in (unless he knows the underlying implementation)."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424180472, "post_id": 28556848, "comment_id": 45436149, "body": "@user114241 agreed. Maybe a type assertion might work (if the OP knows about the underlying type). Let&#39;s wait for the OP&#39;s feedback."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424180850, "post_id": 28556848, "comment_id": 45436324, "body": "Totally, I&#39;m more suspecting the OP might be using/writing a framework that renders a template tied to the method receiver/method when the method finishes execution. In such a case, the framework would mostly likely have a bool field (or something similar) that is set as soon as any call to <code>Write()</code> is made (to signify if there was stuff written, in turn it should check the status code before it renders the template)."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1424158461, "creation_date": 1424158461, "answer_id": 28556848, "question_id": 28550020, "link": "https://stackoverflow.com/questions/28550020/how-to-detect-if-redirect-was-invoked/28556848#28556848", "title": "How to detect if redirect was invoked", "body": "<p>You could check out the status of the response (for <a href=\"http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#3xx_Redirection\" rel=\"nofollow\">3xx redirection status code</a>), as in this <a href=\"https://github.com/MSOpenTech/packer-azure/blob/35def56ff079cb3d46d0fc66017ad0de64b57973/packer/builder/azure/driver_restapi/driver/DriverREST_tls.go#L124-L133\" rel=\"nofollow\">http REST driver</a>:</p>\n\n<pre><code>    req, err = http.NewRequest(verb, url, body)\n\n    if err != nil {\n        return nil, err\n    }\n\n    for k, v := range headers {\n        req.Header.Add(k, v)\n    }\n\n    resp, err = d.httpClient.Do(req)\n\n    if err != nil {\n        return nil, err\n    }\n\n    log.Printf(\"Exec responce: %v\\n\", resp)\n\n    statusCode := resp.StatusCode\n\n\n    if statusCode == 307 { // Temporary Redirect\n\n        // For instance (put your own code here)\n\n        redirectUrl, ok := resp.Header[\"Location\"]\n        if !ok {\n            return nil, fmt.Errorf(\"%s %s\", \"Failed to redirect:\", \"header key 'Location' wasn't found\")\n        }\n        log.Printf(\"Redirecting: '%s' --&gt; '%s'\", url, redirectUrl[0])\n        url = redirectUrl[0]\n        continue\n\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 1, "creation_date": 1424183919, "post_id": 28563728, "comment_id": 45438179, "body": "Please try to avoid something like this though, <code>defers</code> are still relatively <a href=\"http://fr.slideshare.net/derekcollison/gophercon-2014\" rel=\"nofollow noreferrer\">slow in Go</a> and webservers should be as fast as possible. This also makes the code much less intuitive to read. This would also be more functional if the defer was the first thing in this function, and referenced a variable that could be set as a flag inside the <code>if needToRedirect { ... }</code>."}, {"owner": {"reputation": 1728, "user_id": 1187678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/17eaea8b195588d8c6bab476c340a2d7?s=128&d=identicon&r=PG", "display_name": "burfl", "link": "https://stackoverflow.com/users/1187678/burfl"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424185025, "post_id": 28563728, "comment_id": 45439004, "body": "I didn&#39;t know defers were slow.  TIL, thanks for the lesson.  Also, if one were to use them, I do agree with your readability recommendation."}], "tags": [], "owner": {"reputation": 1728, "user_id": 1187678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/17eaea8b195588d8c6bab476c340a2d7?s=128&d=identicon&r=PG", "display_name": "burfl", "link": "https://stackoverflow.com/users/1187678/burfl"}, "is_accepted": false, "score": 0, "last_activity_date": 1424183788, "last_edit_date": 1424183788, "creation_date": 1424183448, "answer_id": 28563728, "question_id": 28550020, "link": "https://stackoverflow.com/questions/28550020/how-to-detect-if-redirect-was-invoked/28563728#28563728", "title": "How to detect if redirect was invoked", "body": "<p>Firstly, I must agree with responses here that say it's probably best to return immediately after redirecting.  If, however, you are determined to do some other stuff afterward (whether or not you redirected), followed by a function that is called only if the redirect was used, then you could do something along the lines of this:</p>\n\n<pre><code>func fooHandler(w http.ResponseWriter, r *http.Request) {\n    if needToRedirect {\n        http.Redirect(w, r, \"http://www.google.com\", 301)\n        defer func() {\n            // stuff that only happens if redirected, but happens last\n        }()\n    }\n    // stuff that happens whether redirected or not\n    // note that this will happen before the deferred func is called\n}\n</code></pre>\n\n<p>Here's the documentation for defer: <a href=\"http://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow\">http://blog.golang.org/defer-panic-and-recover</a></p>\n\n<p>It's pretty simple.  The deferred call will execute after the surrounding function (fooHandler) returns, but it will still have access to anything in fooHandler's scope, including named return values.  It's also important to note that the deferred function will be called even during a panic, although nothing will happen unless it calls <code>recover()</code>.</p>\n\n<p>EDIT: Here's a silly example of how it works: <a href=\"http://play.golang.org/p/5TgCv4O_rA\" rel=\"nofollow\">http://play.golang.org/p/5TgCv4O_rA</a></p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1424183788, "creation_date": 1424119537, "question_id": 28550020, "link": "https://stackoverflow.com/questions/28550020/how-to-detect-if-redirect-was-invoked", "title": "How to detect if redirect was invoked", "body": "<p>I have the following code</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc fooHandler(w http.ResponseWriter, r *http.Request) {\n    // Here an if condition, if should redirect or not\n    http.Redirect(w, r, \"http://www.google.com\", 301)\n    // Do something....\n    // Call function if redirect was invoked\n\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", fooHandler)\n    err := http.ListenAndServe(\":9090\", nil)\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>How can I detect, if redirect was written in the response object?</p>\n"}, {"tags": ["encoding", "go"], "comments": [{"owner": {"reputation": 2736, "user_id": 370662, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/10f19a9e600c4ed64f53a986fba57e21?s=128&d=identicon&r=PG", "display_name": "korylprince", "link": "https://stackoverflow.com/users/370662/korylprince"}, "edited": false, "score": 0, "creation_date": 1424135209, "post_id": 28549950, "comment_id": 45418943, "body": "I&#39;m guessing you&#39;re looking for <code>%T</code> instead of <code>%s</code> in your <code>fmt.Printf</code>s. That&#39;s why you&#39;re getting the <code>%!s(...)</code> instead of <code>int64</code> like you&#39;d get with <code>%T</code>."}, {"owner": {"reputation": 907, "user_id": 1279730, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c143e62707810f29f4fb207c1cf797ad?s=128&d=identicon&r=PG", "display_name": "machete", "link": "https://stackoverflow.com/users/1279730/machete"}, "reply_to_user": {"reputation": 2736, "user_id": 370662, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/10f19a9e600c4ed64f53a986fba57e21?s=128&d=identicon&r=PG", "display_name": "korylprince", "link": "https://stackoverflow.com/users/370662/korylprince"}, "edited": false, "score": 0, "creation_date": 1424194957, "post_id": 28549950, "comment_id": 45445511, "body": "It&#39;s not about the string formatting but about the fact, that they have different return values: 12 and 4614256656552045848"}, {"owner": {"reputation": 2736, "user_id": 370662, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/10f19a9e600c4ed64f53a986fba57e21?s=128&d=identicon&r=PG", "display_name": "korylprince", "link": "https://stackoverflow.com/users/370662/korylprince"}, "edited": false, "score": 0, "creation_date": 1424226234, "post_id": 28549950, "comment_id": 45459152, "body": "Yes, true. I was just pointed that out for yours and others benefit (I saw the error and did the research to find the right formatting string and figured I would share) :)"}], "answers": [{"tags": [], "owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "is_accepted": true, "score": 3, "last_activity_date": 1424119380, "creation_date": 1424119380, "answer_id": 28549982, "question_id": 28549950, "link": "https://stackoverflow.com/questions/28549950/go-varint-returns-different-values-than-read/28549982#28549982", "title": "Go: Varint returns different values than read", "body": "<p><a href=\"https://developers.google.com/protocol-buffers/docs/encoding?csw=1#varints\" rel=\"nofollow\">Varint</a> is a specific encoding, that means that the byte value it reads off the wire/from the file is not an actually integer value, but an encoding. Read on the other hand, just reads bytes in whichever byte order you passed to it.</p>\n"}], "owner": {"reputation": 907, "user_id": 1279730, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c143e62707810f29f4fb207c1cf797ad?s=128&d=identicon&r=PG", "display_name": "machete", "link": "https://stackoverflow.com/users/1279730/machete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 28549982, "answer_count": 1, "score": 0, "last_activity_date": 1424119380, "creation_date": 1424119276, "question_id": 28549950, "link": "https://stackoverflow.com/questions/28549950/go-varint-returns-different-values-than-read", "title": "Go: Varint returns different values than read", "body": "<p>Why does binary.Varint return different results than binary.Read?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/binary\"\nimport \"bytes\"\n\nfunc main() {\n    b := []byte{0x18, 0x2d, 0x44, 0x54, 0xfb, 0x21, 0x09, 0x40}\n    var i1 int64\n\n    buf := bytes.NewBuffer(b)\n    binary.Read(buf, binary.LittleEndian, &amp;i1)\n    fmt.Printf(\"%s, %d\\n\", i1, i1)\n\n    i2, _ := binary.Varint(b)\n    fmt.Printf(\"%s, %d\\n\", i2, i2)\n}\n</code></pre>\n\n<p>Returns:</p>\n\n<blockquote>\n  <p>%!s(int64=4614256656552045848), 4614256656552045848<br>\n  %!s(int64=12), 12</p>\n</blockquote>\n\n<p>Here's a link to the playground: <a href=\"https://play.golang.org/p/vlrl_CHq0v\" rel=\"nofollow\">https://play.golang.org/p/vlrl_CHq0v</a></p>\n"}, {"tags": ["c++", "go"], "comments": [{"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 1, "creation_date": 1424115256, "post_id": 28548970, "comment_id": 45410986, "body": "drop the <code>m_</code> prefix, it&#39;s silly (I did it once, stopped and never looked back). What do the variables represent? Are they bytes or are they string-like?"}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "reply_to_user": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 0, "creation_date": 1424115413, "post_id": 28548970, "comment_id": 45411066, "body": "@rubenvb hehe. :) They are bytes. I&#39;ll add part of the function to show how its used."}], "answers": [{"comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1436550959, "post_id": 31331761, "comment_id": 50677999, "body": "@majidarif It came up as an unanswered question so I gave it a go. Hope it helped :)"}], "tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 2, "last_activity_date": 1436497334, "creation_date": 1436497334, "answer_id": 31331761, "question_id": 28548970, "link": "https://stackoverflow.com/questions/28548970/go-equivalents-of-c-types/31331761#31331761", "title": "go equivalents of c types", "body": "<p>Hopefully this can clear a few things up for you.</p>\n\n<ul>\n<li>For storing raw sequences of bytes, use a slice <code>[]byte</code>. If you know exactly how long the sequence will be, you can specify that, e.g. <code>[256]byte</code> but you cannot resize it later.</li>\n<li>While Go has pointers, it does not have pointer arithmetic. So you will need to use integers to index into your slices of bytes.</li>\n<li>For storing single bytes, <code>byte</code> is sufficient; you don't want a slice of bytes. Where there are pointers in the C++ code used to point to specific locations in the array, you'll simply have an integer index value that selects one element of a slice.</li>\n<li>Go strings are <em>not</em> simply sequences of bytes, they are sequences of UTF-8 characters stored internally as runes, which may have different lengths. So don't try to use strings for this algorithm.</li>\n</ul>\n\n<p>To reimplement the algorithm shown, you do not need either pointers or pointer arithmetic at all. Instead of keeping pointers into the byte arrays as you would in C++, you'll use <code>int</code> indexes into the slices.</p>\n\n<p>This is kind of hard to follow since it's virtually <em>all</em> pointer arithmetic. I would want to have a description of the algorithm handy while converting this (and since this is probably a well-known algorithm, that should not be hard to find). I'm not going to do the <em>entire</em> conversion for you, but I'll demonstrate with hopefully a simpler example. This prints each character of a string on a separate line.</p>\n\n<p>C++:</p>\n\n<pre><code>unsigned char *data = \"Hello World\";\nunsigned char *ptr = 0;\n\nfor (int i = 0; i &lt; std::strlen(data); i++) {\n    ptr = i + data;\n    std::cout &lt;&lt; *ptr &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Go:</p>\n\n<pre><code>data := []byte(\"Hello World\")\n\nfor i := 0; i &lt; len(data); i++ {\n    // The pointer is redundant already\n    fmt.Println(data[i:i+1])\n}\n</code></pre>\n\n<p>So, <a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"nofollow\">learn about Go slices</a>, and when you do reimplement this algorithm you will likely find the code to be somewhat simpler, or at least easier to understand, than its C++ counterpart.</p>\n"}], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1436497334, "creation_date": 1424115071, "last_edit_date": 1424118349, "question_id": 28548970, "link": "https://stackoverflow.com/questions/28548970/go-equivalents-of-c-types", "title": "go equivalents of c types", "body": "<p>What are the right equivalent of <code>unsigned char</code> or <code>unsigned char*</code> in go? Or am I even doing this right?</p>\n\n<hr>\n\n<p>I have this C++ class:</p>\n\n<pre><code>class ArcfourPRNG\n{\npublic:\n    ArcfourPRNG();\n    void SetKey(unsigned char *pucKeyData, int iKeyLen);\n    void Reset();\n    unsigned char Rand();\n\nprivate:\n    bool m_bInit;\n    unsigned char m_aucState0[256];\n    unsigned char m_aucState[256];\n    unsigned char m_ucI;\n    unsigned char m_ucJ;\n    unsigned char* m_pucState1;\n    unsigned char* m_pucState2;\n    unsigned char m_ucTemp;\n};\n</code></pre>\n\n<p>I am trying to rewrite it to go:</p>\n\n<pre><code>type ArcfourPRNG struct {\n    m_bInit bool\n    m_aucState0 [256]byte\n    m_aucState [256]byte\n    m_ucI, m_ucJ []byte\n    *m_pucState1 []byte\n    *m_pucState2 []byte\n    m_ucTemp []byte\n}\n\nfunc (arc4 *ArcfourPRNG) SetKey(pucKeyData []byte, iKeyLen int) {\nfunc (arc4 *ArcfourPRNG) Reset() {\nfunc (arc4 *ArcfourPRNG) Rand() uint {\n</code></pre>\n\n<p>Well, I just started with go a few hours ago. So this is still confusing me. </p>\n\n<hr>\n\n<p>A function</p>\n\n<pre><code>for(i=0; i&lt;256; i++)\n{\n    m_pucState1 = m_aucState0 + i;\n    m_ucJ += *m_pucState1 + *(pucKeyData+m_ucI);\n    m_pucState2 = m_aucState0 + m_ucJ;\n    //Swaping\n    m_ucTemp = *m_pucState1;\n    *m_pucState1 = *m_pucState2;\n    *m_pucState2 = m_ucTemp;\n    m_ucI = (m_ucI + 1) % iKeyLen;\n}\nmemcpy(m_aucState, m_aucState0, 256); // copy(aucState[:], aucState0) ?\n</code></pre>\n"}, {"tags": ["mysql", "go", "driver"], "comments": [{"owner": {"reputation": 1020, "user_id": 854830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YJ6bc.jpg?s=128&g=1", "display_name": "Julien Schmidt", "link": "https://stackoverflow.com/users/854830/julien-schmidt"}, "edited": false, "score": 1, "creation_date": 1454407016, "post_id": 28548559, "comment_id": 58018978, "body": "Go MySQL Driver now has multi statement support: <a href=\"https://github.com/go-sql-driver/mysql/pull/411\" rel=\"nofollow noreferrer\">github.com/go-sql-driver/mysql/pull/411</a>"}], "answers": [{"comments": [{"owner": {"reputation": 45768, "user_id": 13227, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9aa8ec2ad36bb9385a4a0f3840f65ae8?s=128&d=identicon&r=PG", "display_name": "Gary Willoughby", "link": "https://stackoverflow.com/users/13227/gary-willoughby"}, "edited": false, "score": 3, "creation_date": 1424167971, "post_id": 28550117, "comment_id": 45430514, "body": "It is not a security issues and you obviously have not read the question. I&#39;m not dealing with parametrized queries, i&#39;m trying to apply internally crafted DDLs to existing schema. SQL Injection is not even a concern here."}, {"owner": {"reputation": 1315, "user_id": 246621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a052cc7a43ee490418591ea10a0f7a7?s=128&d=identicon&r=PG", "display_name": "mkm", "link": "https://stackoverflow.com/users/246621/mkm"}, "edited": false, "score": 0, "creation_date": 1466600585, "post_id": 28550117, "comment_id": 63383431, "body": "it might appear that the answer is unrelated but considering that the drivers will support multiple statement if multiStatements=true is added to the connection parameters and the docs says <code>Allow multiple statements in one query. While this allows batch queries, it also greatly increases the risk of SQL injections. Only the result of the first query is returned, all other results are silently discarded.</code> it&#39;s a relevant comment although perhaps not correctly worded."}], "tags": [], "owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "is_accepted": false, "score": -4, "last_activity_date": 1424119901, "creation_date": 1424119901, "answer_id": 28550117, "question_id": 28548559, "link": "https://stackoverflow.com/questions/28548559/does-a-go-mysql-driver-exist-that-supports-multiple-statements-within-a-single-s/28550117#28550117", "title": "Does a Go Mysql driver exist that supports multiple statements within a single string?", "body": "<p>Bluntly put, do <em>not</em> issue multiple statements in a single call.  It is a security issue.  If a hacker can get in a little bit, he can take over your machine.  (Read about \"SQL Injection\".)</p>\n\n<p>Stored Routines give you a safe way to combine statements (with some restrictions).</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 4409049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2571ddaf635a513701d9257d742d720e?s=128&d=identicon&r=PG&f=1", "display_name": "Chrhlnd", "link": "https://stackoverflow.com/users/4409049/chrhlnd"}, "is_accepted": true, "score": 1, "last_activity_date": 1424243030, "creation_date": 1424243030, "answer_id": 28577876, "question_id": 28548559, "link": "https://stackoverflow.com/questions/28548559/does-a-go-mysql-driver-exist-that-supports-multiple-statements-within-a-single-s/28577876#28577876", "title": "Does a Go Mysql driver exist that supports multiple statements within a single string?", "body": "<p><a href=\"https://github.com/ziutek/mymysql\" rel=\"nofollow\">https://github.com/ziutek/mymysql</a></p>\n\n<p>Can do it. Although you have to use its interface vs the go defined one. The go official interface doesn't handle it, or multiple return values.</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n\n    \"github.com/ziutek/mymysql/autorc\"\n    \"github.com/ziutek/mymysql/mysql\"\n    _ \"github.com/ziutek/mymysql/thrsafe\"\n)\n\ntype ScanFun func(int, []mysql.Row, mysql.Result) error\n\nfunc RunSQL(hostport, user, pass, db, cmd string, scan ScanFun) error {\n    conn := autorc.New(\"tcp\", \"\", hostport, user, pass, db)\n\n    err := conn.Reconnect()\n    if err != nil {\n        return err\n    }\n\n    res, err := conn.Raw.Start(cmd)\n    if err != nil {\n        return err\n    }\n\n    rows, err := res.GetRows()\n    if err != nil {\n        return err\n    }\n\n    RScount := 0\n    scanErr := error(nil)\n\n    for {\n        if scanErr == nil {\n            func() {\n                defer func() {\n                    if x := recover(); x != nil {\n                        scanErr = fmt.Errorf(\"%v\", x)\n                    }\n                }()\n                scanErr = scan(RScount, rows, res)\n            }()\n        }\n\n        if res.MoreResults() {\n            res, err = res.NextResult()\n            if err != nil {\n                return err\n            }\n            rows, err = res.GetRows()\n            if err != nil {\n                return err\n            }\n        } else {\n            break\n        }\n\n        RScount++\n    }\n    return scanErr\n}\n\nfunc main() {\n    host := flag.String(\"host\", \"localhost:3306\", \"define the host where the db is\")\n    user := flag.String(\"user\", \"root\", \"define the user to connect as\")\n    pass := flag.String(\"pass\", \"\", \"define the pass to use\")\n    db := flag.String(\"db\", \"information_schema\", \"what db to default to\")\n\n    sql := flag.String(\"sql\", \"select count(*) from columns; select * from columns limit 1;\", \"Query to run\")\n\n    flag.Parse()\n\n    scan := func(rcount int, rows []mysql.Row, res mysql.Result) error {\n        if res.StatusOnly() {\n            return nil\n        }\n\n        for idx, row := range rows {\n            fmt.Print(rcount, \"-\", idx, \") \")\n            for i, _ := range row {\n                fmt.Print(row.Str(i))\n                fmt.Print(\" \")\n            }\n            fmt.Println(\"\")\n        }\n        return nil\n    }\n\n    fmt.Println(\"Host - \", *host)\n    fmt.Println(\"Db   - \", *db)\n    fmt.Println(\"User - \", *user)\n\n    if err := RunSQL(*host, *user, *pass, *db, *sql, scan); err != nil {\n        fmt.Println(err)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45768, "user_id": 13227, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9aa8ec2ad36bb9385a4a0f3840f65ae8?s=128&d=identicon&r=PG", "display_name": "Gary Willoughby", "link": "https://stackoverflow.com/users/13227/gary-willoughby"}, "edited": false, "score": 1, "creation_date": 1424248782, "post_id": 28578032, "comment_id": 45466685, "body": "Making multiple calls is not a realistic option because i would need to parse the SQL dump to break up the statements. Using the shell would be possible but then the program is not cross-platform."}], "tags": [], "owner": {"reputation": 641, "user_id": 966860, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/58626b48e605863cf9e3580e7ffc09c3?s=128&d=identicon&r=PG", "display_name": "nathj07", "link": "https://stackoverflow.com/users/966860/nathj07"}, "is_accepted": false, "score": 1, "last_activity_date": 1424243675, "creation_date": 1424243675, "answer_id": 28578032, "question_id": 28548559, "link": "https://stackoverflow.com/questions/28548559/does-a-go-mysql-driver-exist-that-supports-multiple-statements-within-a-single-s/28578032#28578032", "title": "Does a Go Mysql driver exist that supports multiple statements within a single string?", "body": "<p>I would recommend simply making 2 calls. Why not? It makes the code easier to grok and improves the error handling. </p>\n\n<p>The other option, if you have a large SQL file from the dump is to shell out and execute the whole thing in one go. </p>\n"}, {"comments": [{"owner": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "edited": false, "score": 1, "creation_date": 1509430020, "post_id": 37968955, "comment_id": 81004487, "body": "Do you know any example code for the syntax of using multi statements?"}, {"owner": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "edited": false, "score": 0, "creation_date": 1540326494, "post_id": 37968955, "comment_id": 92822222, "body": "great! so helpfullllllll"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1573340153, "post_id": 37968955, "comment_id": 103851856, "body": "Actually the docs do not clarify multistatement usage at all! This is the entire text: <code>Allow multiple statements in one query. While this allows batch queries, it also greatly increases the risk of SQL injections. Only the result of the first query is returned, all other results are silently discarded.</code> There&#39;s no indication on how one should perform multiple inserts etc."}], "tags": [], "owner": {"reputation": 1315, "user_id": 246621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a052cc7a43ee490418591ea10a0f7a7?s=128&d=identicon&r=PG", "display_name": "mkm", "link": "https://stackoverflow.com/users/246621/mkm"}, "is_accepted": false, "score": 28, "last_activity_date": 1478007578, "last_edit_date": 1478007578, "creation_date": 1466600756, "answer_id": 37968955, "question_id": 28548559, "link": "https://stackoverflow.com/questions/28548559/does-a-go-mysql-driver-exist-that-supports-multiple-statements-within-a-single-s/37968955#37968955", "title": "Does a Go Mysql driver exist that supports multiple statements within a single string?", "body": "<p>the <code>github.com/go-sql-driver/mysql</code> can be configured to accept multiple statements with the <code>multiStatements=true</code> connection parameter.</p>\n\n<p>The documentation clearly states why you should be careful doing it.\nSee <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"noreferrer\">https://github.com/go-sql-driver/mysql</a></p>\n"}, {"tags": [], "owner": {"reputation": 700, "user_id": 6940117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/us57e.png?s=128&g=1", "display_name": "Slotheroo", "link": "https://stackoverflow.com/users/6940117/slotheroo"}, "is_accepted": false, "score": 8, "last_activity_date": 1520236707, "creation_date": 1520236707, "answer_id": 49105795, "question_id": 28548559, "link": "https://stackoverflow.com/questions/28548559/does-a-go-mysql-driver-exist-that-supports-multiple-statements-within-a-single-s/49105795#49105795", "title": "Does a Go Mysql driver exist that supports multiple statements within a single string?", "body": "<p>Adding an example for the answer from @ithkuil regarding multiStatements for the go-sql-driver package for reference. (I didn't have enough rep to add as a comment).</p>\n\n<p>The parameter for multiStatements is added onto the dataSourceName string for your sql.Open call. e.g.</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"user:pass@tcp(localhost:3306)/dbname?multiStatements=true\")\n</code></pre>\n\n<p>It's recommended that you not use such a db handler for processing user input, but it works great for processing known sql files.</p>\n"}], "owner": {"reputation": 45768, "user_id": 13227, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9aa8ec2ad36bb9385a4a0f3840f65ae8?s=128&d=identicon&r=PG", "display_name": "Gary Willoughby", "link": "https://stackoverflow.com/users/13227/gary-willoughby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11790, "favorite_count": 2, "accepted_answer_id": 28577876, "answer_count": 5, "score": 10, "last_activity_date": 1520236707, "creation_date": 1424113507, "question_id": 28548559, "link": "https://stackoverflow.com/questions/28548559/does-a-go-mysql-driver-exist-that-supports-multiple-statements-within-a-single-s", "title": "Does a Go Mysql driver exist that supports multiple statements within a single string?", "body": "<p>I'm trying to find a MySql driver that i can use with <a href=\"https://golang.org/\" rel=\"noreferrer\">Go</a> which supports issuing multiple SQL statements in one call. For example i might wish to create a database using the following SQL:</p>\n\n<pre><code>DROP SCHEMA IF EXISTS foo;\nCREATE SCHEMA IF NOT EXISTS foo;\n</code></pre>\n\n<p>In languages such as PHP you can just place both SQL statements in one string and execute it in one go, like this:</p>\n\n<pre><code>$db = new PDO(...);\n$db-&gt;query(\"DROP SCHEMA IF EXISTS foo; CREATE SCHEMA IF NOT EXISTS foo;\");\n</code></pre>\n\n<p>The reason i need this is because i have SQL dumps (from <code>mysqldump</code>) i'd like to apply programmatically to various databases.</p>\n\n<p>I'm looking for the same functionality in Go but it seems all the different drivers don't support it, which, frankly, is shocking to me.</p>\n\n<p><strong>Go-MySQL-Driver</strong><br>\n<a href=\"https://github.com/go-sql-driver/mysql\" rel=\"noreferrer\">https://github.com/go-sql-driver/mysql</a><br>\nThis seems to be the most used driver for Go.</p>\n\n<pre><code>package main\n\nimport \"database/sql\"\nimport \"log\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\nfunc main() {\n\n    db, err := sql.Open(\"mysql\", \"user:password@(127.0.0.1:3306)/\")\n    if err != nil {\n        log.Println(err)\n    }\n\n    sql := \"DROP SCHEMA IF EXISTS foo; CREATE SCHEMA IF NOT EXISTS foo;\"\n    _, err = db.Exec(sql)\n    if err != nil {\n        log.Println(err)\n    }\n\n    db.Close()\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>2015/02/16 18:58:08 Error 1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE SCHEMA IF NOT EXISTS foo' at line 1\n</code></pre>\n\n<p><strong>MyMySQL</strong><br>\n<a href=\"https://github.com/ziutek/mymysql\" rel=\"noreferrer\">https://github.com/ziutek/mymysql</a><br>\nThis is another popular driver.</p>\n\n<pre><code>package main\n\nimport \"database/sql\"\nimport \"log\"\nimport _ \"github.com/ziutek/mymysql/godrv\"\n\nfunc main() {\n\n    db, err := sql.Open(\"mymysql\", \"database/user/password\")\n    if err != nil {\n        log.Println(err)\n    }\n\n    sql := \"DROP SCHEMA IF EXISTS foo; CREATE SCHEMA IF NOT EXISTS foo;\"\n    _, err = db.Exec(sql)\n    if err != nil {\n        log.Println(err)\n    }\n\n    sql = \"USE DATABASE foo;\"\n    _, err = db.Exec(sql) // &lt;-- error\n    if err != nil {\n        log.Println(err)\n    }\n\n    db.Close()\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>2015/02/16 18:58:08 packet sequence error\n</code></pre>\n\n<p>Does anyone know of any MySql driver compatible with Go that can handle multiple statements in one string like these?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1424096112, "post_id": 28542464, "comment_id": 45400121, "body": "In case he really meant array and not slice, then he&#39;ll have to wait for <a href=\"https://go-review.googlesource.com/#/c/4111\" rel=\"nofollow noreferrer\">CL4111</a>."}], "tags": [], "owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "is_accepted": true, "score": 3, "last_activity_date": 1424093120, "creation_date": 1424093120, "answer_id": 28542464, "question_id": 28542330, "link": "https://stackoverflow.com/questions/28542330/instance-an-array-from-a-type-in-go/28542464#28542464", "title": "Instance an array from a type in go", "body": "<p>Use <a href=\"http://golang.org/pkg/reflect/#MakeSlice\" rel=\"nofollow\">reflect.MakeSlice</a> for that:</p>\n\n<pre><code>type := reflect.ValueOf(obj)\nreflectSlice := reflect.MakeSlice(type, sliceLength, sliceCapacity)\n</code></pre>\n"}], "owner": {"reputation": 4633, "user_id": 506712, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QxcR9.jpg?s=128&g=1", "display_name": "Javier Manzano", "link": "https://stackoverflow.com/users/506712/javier-manzano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 28542464, "answer_count": 1, "score": 1, "last_activity_date": 1424093120, "creation_date": 1424092710, "question_id": 28542330, "link": "https://stackoverflow.com/questions/28542330/instance-an-array-from-a-type-in-go", "title": "Instance an array from a type in go", "body": "<p>How can I instance an array with a given type?</p>\n\n<p>I get the type this way:</p>\n\n<pre><code>type := reflect.ValueOf(obj)\n</code></pre>\n\n<p>But I don't know how to get an instance of an array with this type</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4633, "user_id": 506712, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QxcR9.jpg?s=128&g=1", "display_name": "Javier Manzano", "link": "https://stackoverflow.com/users/506712/javier-manzano"}, "edited": false, "score": 0, "creation_date": 1427910424, "post_id": 28542490, "comment_id": 46970862, "body": "No, that&#39;s not what i&#39;m trying"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": -1, "last_activity_date": 1424093192, "creation_date": 1424093192, "answer_id": 28542490, "question_id": 28542072, "link": "https://stackoverflow.com/questions/28542072/working-with-interface-and-types-on-golang/28542490#28542490", "title": "Working with interface and types on golang", "body": "<p>Is your issue not knowing how to create a slice?</p>\n\n<p>You can do:</p>\n\n<pre><code>var data []interface{}{} // make an empty slice of type interface{}\n</code></pre>\n\n<p>if you are trying to create a Custor struct, you can also do:</p>\n\n<pre><code>c := Cursor{Data: []interface{}{}}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/xnZBD2AazT\" rel=\"nofollow\">Playground</a></p>\n"}], "owner": {"reputation": 4633, "user_id": 506712, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QxcR9.jpg?s=128&g=1", "display_name": "Javier Manzano", "link": "https://stackoverflow.com/users/506712/javier-manzano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424093192, "creation_date": 1424091921, "question_id": 28542072, "link": "https://stackoverflow.com/questions/28542072/working-with-interface-and-types-on-golang", "title": "Working with interface and types on golang", "body": "<p>I'm working on a generic implementation of a paginator for DB queries with GORM</p>\n\n<pre><code>type Cursor struct {\n    Data []interface{}\n    Next int\n}\n\ntype Paginator struct {\n    PageSize int\n    Model    interface{}\n}\n</code></pre>\n\n<p>The problem is, I don't know how to instantiate a new array to retrieve results from DB depending on the <code>Paginator.Model</code> type with this line</p>\n\n<pre><code>db.Model(paginator.Model).Limit(paginator.PageSize).Offset(page - 1).Find(&amp;data)\n</code></pre>\n\n<p>How can I instantiate <code>data</code> to work with <code>Find</code>?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 3, "creation_date": 1424093593, "post_id": 28542135, "comment_id": 45398571, "body": "That or pass your stats function the len(ch) and cap(ch) values"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 1, "last_activity_date": 1424092107, "creation_date": 1424092107, "answer_id": 28542135, "question_id": 28541658, "link": "https://stackoverflow.com/questions/28541658/go-how-to-pass-directional-channels-to-a-function-accepting-bidirectional-chann/28542135#28542135", "title": "go: how to pass directional channels to a function accepting bidirectional channel?", "body": "<p>Rephrased a bit:</p>\n\n<p>\"Is there a way to cast a directed channel to an undirected?\" No there isn't.</p>\n\n<p>\"Is there a notion of 'arbitrary channel' (without element type) in Go?\" No there isn't. Go has no generics.</p>\n\n<p>You'll have to write several functions.</p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 1, "last_activity_date": 1424114708, "creation_date": 1424114708, "answer_id": 28548863, "question_id": 28541658, "link": "https://stackoverflow.com/questions/28541658/go-how-to-pass-directional-channels-to-a-function-accepting-bidirectional-chann/28548863#28548863", "title": "go: how to pass directional channels to a function accepting bidirectional channel?", "body": "<blockquote>\n  <p>Is there any way to cast fooChannel to chan []byte?</p>\n</blockquote>\n\n<p>No, sorry. This is probably just in case someone thinks they would like to send on the receiving channel anyway. But, just a little tiny thing, but... No.</p>\n\n<blockquote>\n  <p>The function does not send or receives anything, only looks at number of elements in the channel for stats related purposes. [...] I am only using <code>len</code> and <code>cap</code> with channels received as arguments.</p>\n</blockquote>\n\n<p>If it doesn't use the channel in any channel-ish way, you could simply pass <code>len(ch)</code> and <code>cap(ch)</code> directly as the arguments. If you don't like it for any reason, you can play with <a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow\"><code>reflect</code></a> package, which will allow you to call <code>len</code> and <code>cap</code> on any type supporting it (array, channel, slice).</p>\n\n<p>This might be a good start:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc stats(i interface{}) {\n    v := reflect.ValueOf(i)\n    fmt.Printf(\"%s size: %d/%d\\n\", v.Kind(), v.Len(), v.Cap())\n}\n\nfunc main() {\n    ch := make(chan int, 10)\n    ch &lt;- 1\n    stats(ch)\n}\n\n// Output: chan size: 1/10\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/2ehYvEmDkS\" rel=\"nofollow\">http://play.golang.org/p/2ehYvEmDkS</a></p>\n"}], "owner": {"reputation": 8514, "user_id": 2381823, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4050299819ad1d313f0221e57ac94a53?s=128&d=identicon&r=PG", "display_name": "juanleon", "link": "https://stackoverflow.com/users/2381823/juanleon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 2, "accepted_answer_id": 28542135, "answer_count": 2, "score": 3, "last_activity_date": 1424114708, "creation_date": 1424090485, "question_id": 28541658, "link": "https://stackoverflow.com/questions/28541658/go-how-to-pass-directional-channels-to-a-function-accepting-bidirectional-chann", "title": "go: how to pass directional channels to a function accepting bidirectional channel?", "body": "<p>Hi have a function accepting <code>chan []byte</code> (that, since no direction is specified I understand it is bidirectional).  The function does not send or receives anything, only looks at number of elements in the channel for stats related purposes.</p>\n\n<p>I want to call this function within a function with following signature:</p>\n\n<pre><code>func foo(fooChannel chan&lt;- []byte)\n</code></pre>\n\n<p>But when I try to use argument to call the other function I got the error <code>cannot use fooChannel (type &lt;-chan []byte) as type chan []byte in function argument</code>.</p>\n\n<p>Is there any way to cast fooChannel to <code>chan []byte</code>?</p>\n\n<p>Since I am only interested in getting some stats, how should I prototype the function to accept any type of channel (so I can get rid even of the \"byte\" part)? I am only using <code>len</code> and <code>cap</code> with channels received as arguments.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 2, "creation_date": 1424090699, "post_id": 28541609, "comment_id": 45396781, "body": "Better in what aspect?"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1424091149, "post_id": 28541609, "comment_id": 45397045, "body": "@Michael Foukarakis Better in meaning - not such ugly, more readable, and avoiding reference on slice, which is reference type itself."}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1424315644, "post_id": 28541609, "comment_id": 45502371, "body": "<a href=\"https://github.com/karalabe/cookiejar\" rel=\"nofollow noreferrer\">github.com/karalabe/cookiejar</a> has a quite performant implementation."}, {"owner": {"reputation": 6027, "user_id": 1187471, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/AtK2G.jpg?s=128&g=1", "display_name": "Fernando &#193;.", "link": "https://stackoverflow.com/users/1187471/fernando-%c3%81"}, "edited": false, "score": 0, "creation_date": 1482333461, "post_id": 28541609, "comment_id": 69732930, "body": "<a href=\"https://github.com/fern4lvarez/piladb\" rel=\"nofollow noreferrer\">github.com/fern4lvarez/piladb</a> provides a complete stack implementation using linked lists"}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 2, "creation_date": 1424269677, "post_id": 28542256, "comment_id": 45479228, "body": "nitpick, you don&#39;t actually need to pass a new <code>sync.Mutex</code>, <code>&amp;stack {s: []int{}}</code> is enough."}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434374421, "post_id": 28542256, "comment_id": 49736026, "body": "You may want to try my generic implementation. It&#39;s pretty fast also. <a href=\"https://github.com/alediaferia/stackgo\" rel=\"nofollow noreferrer\">github.com/alediaferia/stackgo</a>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434378031, "post_id": 28542256, "comment_id": 49738682, "body": "@alediaferia looks nice. two comments: a. maybe make it thread safe? b. perhaps <code>Pop()</code> should return an error or boolean false if the stack is empty? could be that we put <code>nil</code> there in purpose."}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434378509, "post_id": 28542256, "comment_id": 49739049, "body": "Great feedback! Thanks! I&#39;ll change that for sure"}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434378558, "post_id": 28542256, "comment_id": 49739089, "body": "For the thread safety I started simple. I&#39;m still not sure I want to make it thread safe by default. Will think about it. Thank you very much for your valuable insights btw!"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 1, "creation_date": 1434379897, "post_id": 28542256, "comment_id": 49740118, "body": "@alediaferia you can add a <code>sync.Locker</code> member to the stack, and lock/unlock it. By default put a dummy lock there, and add a constructor that creates the pool with a real mutex or rwmutex."}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434380019, "post_id": 28542256, "comment_id": 49740219, "body": "Will definitely do as you suggest then :) Also I was thinking about adding the chance to make the stack single-type rather than <code>interface{}</code>-based at user will. This may improve performance if you are sure you&#39;ll always push and pop the same data type."}, {"owner": {"reputation": 6247, "user_id": 1307186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/387ed5b468ef3d8d0d668ea772a4d043?s=128&d=identicon&r=PG", "display_name": "darethas", "link": "https://stackoverflow.com/users/1307186/darethas"}, "edited": false, "score": 0, "creation_date": 1474891956, "post_id": 28542256, "comment_id": 66703138, "body": "could you make this handle more than just an array of ints if you used []interface{} ?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 6247, "user_id": 1307186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/387ed5b468ef3d8d0d668ea772a4d043?s=128&d=identicon&r=PG", "display_name": "darethas", "link": "https://stackoverflow.com/users/1307186/darethas"}, "edited": false, "score": 0, "creation_date": 1474901407, "post_id": 28542256, "comment_id": 66709954, "body": "@treehau5 of course, but then you&#39;d have to do the interface conversion each time you pop, which might be annoying"}, {"owner": {"reputation": 1714, "user_id": 94669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23d90b4fe24bce8221897b6af0e28616?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/94669/david"}, "edited": false, "score": 0, "creation_date": 1530812447, "post_id": 28542256, "comment_id": 89375992, "body": "The way this is implemented, if I&#39;m not mistaken, there&#39;s a new memory assignment every time a push or a pop is done. Can this be implemented, instead, with a pointer to the head, and a pre-allocated capacity?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 1714, "user_id": 94669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23d90b4fe24bce8221897b6af0e28616?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/94669/david"}, "edited": false, "score": 1, "creation_date": 1530823228, "post_id": 28542256, "comment_id": 89380774, "body": "@david no, the underlying array grows exponentially so you&#39;ll get very few allocations in practice. You can optimize the initial capacity but that&#39;s rarely an issue."}, {"owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "edited": false, "score": 0, "creation_date": 1542154228, "post_id": 28542256, "comment_id": 93464222, "body": "Wouldn&#39;t pushing be O(n) for n elements existing in stack, because append for slices resizes every time right?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "edited": false, "score": 1, "creation_date": 1542200864, "post_id": 28542256, "comment_id": 93482379, "body": "@user3125693 no, append is smarter than that. It grows the array capacity exponentially, so most of the appends do not resize anything, thus it&#39;s amortized O(1)"}, {"owner": {"reputation": 178, "user_id": 5483301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/RmIZk.jpg?s=128&g=1", "display_name": "Isan Rivkin", "link": "https://stackoverflow.com/users/5483301/isan-rivkin"}, "edited": false, "score": 0, "creation_date": 1591853645, "post_id": 28542256, "comment_id": 110214598, "body": "Need to add return value for the function signature func (s stack) Pop() (stack, int) {"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 69, "last_activity_date": 1424092480, "creation_date": 1424092480, "answer_id": 28542256, "question_id": 28541609, "link": "https://stackoverflow.com/questions/28541609/looking-for-reasonable-stack-implementation-in-golang/28542256#28542256", "title": "Looking for reasonable stack implementation in golang?", "body": "<p>It's a matter of style and personal taste, <strong>your code is fine</strong> (apart from not being thread safe and panicking if you pop from an empty stack). To simplify it a bit you can work with value methods and return the stack itself, it's slightly more elegant <em>to some tastes</em>. i.e.</p>\n\n<pre><code>type stack []int\n\nfunc (s stack) Push(v int) stack {\n    return append(s, v)\n}\n\nfunc (s stack) Pop() (stack, int) {\n    // FIXME: What do we do if the stack is empty, though?\n\n    l := len(s)\n    return  s[:l-1], s[l-1]\n}\n\n\nfunc main(){\n    s := make(stack,0)\n    s = s.Push(1)\n    s = s.Push(2)\n    s = s.Push(3)\n\n    s, p := s.Pop()\n    fmt.Println(p)\n\n}\n</code></pre>\n\n<p>Another approach is to wrap it in a struct, so you can also easily add a mutex to avoid race conditions, etc. something like:</p>\n\n<pre><code>type stack struct {\n     lock sync.Mutex // you don't have to do this if you don't want thread safety\n     s []int\n}\n\nfunc NewStack() *stack {\n    return &amp;stack {sync.Mutex{}, make([]int,0), }\n}\n\nfunc (s *stack) Push(v int) {\n    s.lock.Lock()\n    defer s.lock.Unlock()\n\n    s.s = append(s.s, v)\n}\n\nfunc (s *stack) Pop() (int, error) {\n    s.lock.Lock()\n    defer s.lock.Unlock()\n\n\n    l := len(s.s)\n    if l == 0 {\n        return 0, errors.New(\"Empty Stack\")\n    }\n\n    res := s.s[l-1]\n    s.s = s.s[:l-1]\n    return res, nil\n}\n\n\nfunc main(){\n    s := NewStack()\n    s.Push(1)\n    s.Push(2)\n    s.Push(3)\n    fmt.Println(s.Pop())\n    fmt.Println(s.Pop())\n    fmt.Println(s.Pop())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 845, "user_id": 1936957, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/amxXB.jpg?s=128&g=1", "display_name": "guy_fawkes", "link": "https://stackoverflow.com/users/1936957/guy-fawkes"}, "is_accepted": false, "score": 16, "last_activity_date": 1478370413, "last_edit_date": 1478370413, "creation_date": 1478369317, "answer_id": 40441569, "question_id": 28541609, "link": "https://stackoverflow.com/questions/28541609/looking-for-reasonable-stack-implementation-in-golang/40441569#40441569", "title": "Looking for reasonable stack implementation in golang?", "body": "<p>Here is a LIFO implementation using linked data structure</p>\n\n<pre><code>package stack\n\nimport \"sync\"\n\ntype element struct {\n    data interface{}\n    next *element\n}\n\ntype stack struct {\n    lock *sync.Mutex\n    head *element\n    Size int\n}\n\nfunc (stk *stack) Push(data interface{}) {\n    stk.lock.Lock()\n\n    element := new(element)\n    element.data = data\n    temp := stk.head\n    element.next = temp\n    stk.head = element\n    stk.Size++\n\n    stk.lock.Unlock()\n}\n\nfunc (stk *stack) Pop() interface{} {\n    if stk.head == nil {\n        return nil\n    }\n    stk.lock.Lock()\n    r := stk.head.data\n    stk.head = stk.head.next\n    stk.Size--\n\n    stk.lock.Unlock()\n\n    return r\n}\n\nfunc New() *stack {\n    stk := new(stack)\n    stk.lock = &amp;sync.Mutex{}\n\n    return stk\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 3970355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wZzxG.jpg?s=128&g=1", "display_name": "ZhenhangTung", "link": "https://stackoverflow.com/users/3970355/zhenhangtung"}, "is_accepted": false, "score": 2, "last_activity_date": 1604301831, "creation_date": 1604301831, "answer_id": 64641330, "question_id": 28541609, "link": "https://stackoverflow.com/questions/28541609/looking-for-reasonable-stack-implementation-in-golang/64641330#64641330", "title": "Looking for reasonable stack implementation in golang?", "body": "<p>I believe it would be nice if we could take advantage of Go's standard libs instead of creating self-defined data structure like @guy_fawkes did. Although he did a great job, it's not a standard way to use singly linked list.</p>\n<p>To get list's tail in O(1) time complexity, I would use doubly linked list. I trade space for time.</p>\n<p>I also take @Not_a_Golfer's advice to add a lock to the stack.</p>\n<pre><code>import (\n    &quot;container/list&quot;\n    &quot;sync&quot;\n)\n\ntype Stack struct {\n    dll   *list.List\n    mutex sync.Mutex\n}\n\nfunc NewStack() *Stack {\n    return &amp;Stack{dll: list.New()}\n}\n\nfunc (s *Stack) Push(x interface{}) {\n    s.mutex.Lock()\n    defer s.mutex.Unlock()\n\n    s.dll.PushBack(x)\n}\n\nfunc (s *Stack) Pop() interface{} {\n    s.mutex.Lock()\n    defer s.mutex.Unlock()\n\n    if s.dll.Len() == 0 {\n        return nil\n    }\n    tail := s.dll.Back()\n    val := tail.Value\n    s.dll.Remove(tail)\n    return val\n}\n</code></pre>\n<p>Click <a href=\"https://goplay.space/#WS1cJD02daQ\" rel=\"nofollow noreferrer\">this playground</a> to preview the result.</p>\n"}, {"tags": [], "owner": {"reputation": 163, "user_id": 6150230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J3s4g.jpg?s=128&g=1", "display_name": "Sanjay Prajapat", "link": "https://stackoverflow.com/users/6150230/sanjay-prajapat"}, "is_accepted": false, "score": 0, "last_activity_date": 1617022516, "creation_date": 1617022516, "answer_id": 66854593, "question_id": 28541609, "link": "https://stackoverflow.com/questions/28541609/looking-for-reasonable-stack-implementation-in-golang/66854593#66854593", "title": "Looking for reasonable stack implementation in golang?", "body": "<p>Use <a href=\"https://github.com/emirpasic/gods\" rel=\"nofollow noreferrer\">https://github.com/emirpasic/gods</a></p>\n<pre><code>package main\n\nimport lls &quot;github.com/emirpasic/gods/stacks/linkedliststack&quot;\n\nfunc main() {\n    stack := lls.New()  // empty\n    stack.Push(1)       // 1\n    stack.Push(2)       // 1, 2\n    stack.Values()      // 2, 1 (LIFO order)\n    _, _ = stack.Peek() // 2,true\n    _, _ = stack.Pop()  // 2, true\n    _, _ = stack.Pop()  // 1, true\n    _, _ = stack.Pop()  // nil, false (nothing to pop)\n    stack.Push(1)       // 1\n    stack.Clear()       // empty\n    stack.Empty()       // true\n    stack.Size()        // 0\n}\n</code></pre>\n"}], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29764, "favorite_count": 12, "accepted_answer_id": 28542256, "answer_count": 4, "score": 37, "last_activity_date": 1617022516, "creation_date": 1424090277, "question_id": 28541609, "link": "https://stackoverflow.com/questions/28541609/looking-for-reasonable-stack-implementation-in-golang", "title": "Looking for reasonable stack implementation in golang?", "body": "<p>So far my naive approach is </p>\n\n<pre><code>type stack []int\n\nfunc (s *stack) Push(v int) {\n    *s = append(*s, v)\n}\n\nfunc (s *stack) Pop() int {\n    res:=(*s)[len(*s)-1]\n    *s=(*s)[:len(*s)-1]\n    return res\n}\n</code></pre>\n\n<p>it works - <a href=\"https://play.golang.org/p/0-auehHDzY\" rel=\"noreferrer\">playground</a>, but looks ugly and has too much dereferencing. Can I do better? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4257736, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006283538288/picture?type=large", "display_name": "Priyadarshini Ravi", "link": "https://stackoverflow.com/users/4257736/priyadarshini-ravi"}, "edited": false, "score": 0, "creation_date": 1424091123, "post_id": 28541335, "comment_id": 45397029, "body": "<a href=\"http://someaddress.com/gremlin?script=g.addVertex([,&#39;date_of_birth&#39;:&#39;1968-01-16\" rel=\"nofollow noreferrer\">someaddress.com/&hellip;</a> 00:00:00 +0000 UTC&#39;,&#39;full_birth_time&#39;:&#39;1968-01-16 03:33:00 +0000 UTC&#39;])  to <a href=\"http://someaddress.com/gremlin?script=g.addVertex%28[%27date_of_birth%27:%271968-01-16%2000:00:00%20+0000%20UTC%27,%27full_birth_time%27:%271968-01-16%2003:33:00%20+0000%20UTC%27]%29\" rel=\"nofollow noreferrer\">someaddress.com/&hellip;</a>"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 47, "user_id": 4257736, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006283538288/picture?type=large", "display_name": "Priyadarshini Ravi", "link": "https://stackoverflow.com/users/4257736/priyadarshini-ravi"}, "edited": false, "score": 0, "creation_date": 1424092980, "post_id": 28541335, "comment_id": 45398184, "body": "@PriyadarshiniRavi I&#39;ve updated the answer with an example of parsing. But as I&#39;ve mentioned: this can cause trouble as characters like &amp; and # serves other functions."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": false, "score": 5, "last_activity_date": 1424092781, "last_edit_date": 1424092781, "creation_date": 1424089269, "answer_id": 28541335, "question_id": 28541183, "link": "https://stackoverflow.com/questions/28541183/how-do-i-encode-urls-containing-spaces-or-special-characters-in-go/28541335#28541335", "title": "How do I encode URLs containing spaces or special characters in Go?", "body": "<p>Url encoding is provided in the <a href=\"https://golang.org/pkg/net/url/\" rel=\"nofollow\"><code>net/url</code></a> package. You have functions such as:</p>\n\n<pre><code>url.QueryEscape(\"g.addVertex(['id':'0af69422 5be','date':'1968-01-16 00:00:00 +0000 UTC'])\")\n</code></pre>\n\n<p>Which gives you:</p>\n\n<blockquote>\n  <p>g.addVertex%28%5B%27id%27%3A%270af69422+5be%27%2C%27date%27%3A%271968-01-16+00%3A00%3A00+%2B0000+UTC%27%5D%29</p>\n</blockquote>\n\n<p>Also check out <a href=\"https://golang.org/pkg/net/url/#URL\" rel=\"nofollow\">url.URL</a> and <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow\">url.Values</a>. Depending on your needs, these will solve it for you.</p>\n\n<p>If you only have the entire URL you can try to parse it and then re-encode the broken query part like this:</p>\n\n<pre><code>u, err := url.Parse(\"http://localhost:8182/graphs/graph/tp/gremlin?script=g.addVertex(['id':'0af69422 5be','date':'1968-01-16 00:00:00 +0000 UTC'])\")\nif err != nil {\n    panic(err)\n}   \nu.RawQuery = u.Query().Encode()\nfmt.Println(u)\n</code></pre>\n\n<p>However, be careful. If the string contains and ampersands (&amp;) or hashmarks (#), it will not give the result you are expecting.</p>\n"}], "owner": {"reputation": 47, "user_id": 4257736, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006283538288/picture?type=large", "display_name": "Priyadarshini Ravi", "link": "https://stackoverflow.com/users/4257736/priyadarshini-ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1989, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424147064, "creation_date": 1424088754, "last_edit_date": 1424147064, "question_id": 28541183, "link": "https://stackoverflow.com/questions/28541183/how-do-i-encode-urls-containing-spaces-or-special-characters-in-go", "title": "How do I encode URLs containing spaces or special characters in Go?", "body": "<p>I have a URL containing spaces and special characters, like the following example:</p>\n\n<pre><code>http://localhost:8182/graphs/graph/tp/gremlin?script=g.addVertex(['id':'0af69422 5be','date':'1968-01-16 00:00:00 +0000 UTC'])\n</code></pre>\n\n<p>How can I encode URLs like this in Go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1424083783, "post_id": 28539552, "comment_id": 45393237, "body": "You need to write the token to the <code>http.ResponseWriter</code>. Something like <code>w.Write(token)</code>. <code>fmt.Println</code> will just output to <code>stdout</code>."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1424085969, "post_id": 28539552, "comment_id": 45394352, "body": "There isn&#39;t really enough information here to say what is going wrong.  What service are you trying to authenticate to?  Are you sure you&#39;re using a valid client ID?"}], "answers": [{"tags": [], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1424087329, "last_edit_date": 1424087329, "creation_date": 1424087005, "answer_id": 28540672, "question_id": 28539552, "link": "https://stackoverflow.com/questions/28539552/i-am-not-able-to-retrieve-the-access-token-using-the-following-go-code/28540672#28540672", "title": "I am not able to retrieve the access token using the following go code", "body": "<p>Do you use <a href=\"https://code.google.com/p/goauth2/\" rel=\"nofollow\">goauth2</a> package, which is deprecated? If so you can try <a href=\"http://golang.org/x/oauth2\" rel=\"nofollow\">golang.org/x/oauth2</a> instead</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n\n    \"code.google.com/p/google-api-go-client/youtube/v3\"\n\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/google\"\n)\n\n// variables used during oauth protocol flow of authentication\nvar (\n    code  = \"\"\n    token = \"\"\n)\n\nvar oauthCfg = &amp;oauth2.Config{\n    ClientID:     \"...\",\n    ClientSecret: \"...\",\n    RedirectURL:  \"http://localhost:8888/oauth2callback\",\n    Scopes: []string{\n        youtube.YoutubeScope, //e.g.\n    },\n    Endpoint: google.Endpoint,\n}\n\nfunc main() {\n\n    http.HandleFunc(\"/\", mainHander)\n\n    http.HandleFunc(\"/oauth2callback\", callbackHandler)\n\n    http.ListenAndServe(\":8888\", nil)\n}\n\nfunc mainHander(w http.ResponseWriter, r *http.Request) {\n    url := oauthCfg.AuthCodeURL(\"\")\n\n    http.Redirect(w, r, url, http.StatusFound)\n}\n\nfunc callbackHandler(w http.ResponseWriter, r *http.Request) {\n    code := r.FormValue(\"code\")\n\n    tok, err := oauthCfg.Exchange(oauth2.NoContext, code)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    log.Println(tok)\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4563410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3901385ef613380c66e439c020a1733b?s=128&d=identicon&r=PG&f=1", "display_name": "Kiruthika Hindraj", "link": "https://stackoverflow.com/users/4563410/kiruthika-hindraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1424087329, "creation_date": 1424083277, "last_edit_date": 1424083646, "question_id": 28539552, "link": "https://stackoverflow.com/questions/28539552/i-am-not-able-to-retrieve-the-access-token-using-the-following-go-code", "title": "I am not able to retrieve the access token using the following go code", "body": "<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    t := &amp;oauth.Transport{Config: config}\n    c := r.FormValue(\"code\")\n    token, err := t.Exchange(c)\n    fmt.Println(\"token: \", token, \"\\nerr: \", err)\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>token:  &lt;nil&gt; \nerr:  OAuthError: updateToken: Unexpected HTTP status 400 Bad Request\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1424031323, "post_id": 28530437, "comment_id": 45376234, "body": "Related: <a href=\"https://stackoverflow.com/questions/21282741/golang-calling-methods-on-interface-pointer\" title=\"golang calling methods on interface pointer\">stackoverflow.com/questions/21282741/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 2981904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08200a764edc239f888b61e027aca04e?s=128&d=identicon&r=PG", "display_name": "makhov", "link": "https://stackoverflow.com/users/2981904/makhov"}, "is_accepted": false, "score": 2, "last_activity_date": 1424032292, "creation_date": 1424032292, "answer_id": 28530817, "question_id": 28530437, "link": "https://stackoverflow.com/questions/28530437/error-when-calling-interface-function/28530817#28530817", "title": "Error when calling interface function?", "body": "<p>Use <code>writer  io.Writer</code> without <code>*</code></p>\n"}, {"tags": [], "owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "is_accepted": false, "score": 5, "last_activity_date": 1424036170, "creation_date": 1424036170, "answer_id": 28531463, "question_id": 28530437, "link": "https://stackoverflow.com/questions/28530437/error-when-calling-interface-function/28531463#28531463", "title": "Error when calling interface function?", "body": "<p>As makhov said, it is because <code>writer</code> in your struct definition of <code>MyClass</code> is a pointer to something which implements the Writer interface, not something which implements the writer interface itself. As such, your code should either be:</p>\n\n<pre><code>package main\n\nimport \"io\"\n\ntype MyClass struct{\n    writer  io.Writer\n}\n\nfunc (this *MyClass) WriteIt() {\n    this.writer.Write([]byte(\"Hello World!\"))\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>package main\n\nimport \"io\"\n\ntype MyClass struct{\n    writer  *io.Writer\n}\n\nfunc (this *MyClass) WriteIt() {\n    (*(this.writer)).Write([]byte(\"Hello World!\"))\n}\n</code></pre>\n\n<p>Typically it would make sense (and be more idiomatic) to do the first option.</p>\n"}], "owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1424036170, "creation_date": 1424030095, "question_id": 28530437, "link": "https://stackoverflow.com/questions/28530437/error-when-calling-interface-function", "title": "Error when calling interface function?", "body": "<pre><code>package main\n\nimport \"io\"\n\ntype MyClass struct{\n    writer  *io.Writer\n}\n\nfunc (this *MyClass) WriteIt() {\n    this.writer.Write([]byte(\"Hello World!\"))\n}\n</code></pre>\n\n<p>Why is it that when <code>writer</code>, which is an implementation of <code>io.Writer</code>, tries to call the <code>Write()</code> function, displays me this error</p>\n\n<blockquote>\n  <p>this.writer.Write undefined (type *io.Writer has no field or method\n  Write)</p>\n</blockquote>\n"}, {"tags": ["http", "tcp", "go", "timeout", "ubuntu-14.04"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1424018013, "post_id": 28528060, "comment_id": 45371919, "body": "any chance you&#39;ve forgotten to close the response body? whatever it is, some configuration chagne between the ubuntu versions caused this problem to surface, but obviously it&#39;s not a problem in itself."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1424061546, "post_id": 28528060, "comment_id": 45383758, "body": "The application will leak connections if a transport is created once per request without cleanup.  I suggest initializing the transport once and storing a pointer to the transport in a package-level variable for use by the function shown above."}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 837, "user_id": 1758678, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/6dccc7ccb6581066fac14bfe87a886a2?s=128&d=identicon&r=PG", "display_name": "enzoyang", "link": "https://stackoverflow.com/users/1758678/enzoyang"}, "edited": false, "score": 0, "creation_date": 1424044822, "post_id": 28528330, "comment_id": 45380285, "body": "@enzoyang give user114241&#39;s code a try, I think that could be the problem."}, {"owner": {"reputation": 837, "user_id": 1758678, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/6dccc7ccb6581066fac14bfe87a886a2?s=128&d=identicon&r=PG", "display_name": "enzoyang", "link": "https://stackoverflow.com/users/1758678/enzoyang"}, "edited": false, "score": 0, "creation_date": 1424045582, "post_id": 28528330, "comment_id": 45380452, "body": "actualy my logic is same as user114241, I call <code>ParseResp</code> immediately after getting response and response will call <code>defer resp.Body.Close()</code>"}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1424045986, "post_id": 28528330, "comment_id": 45380536, "body": "You call resp.Body.Close(), but from your code it isn&#39;t clear that this is the same response instance that we&#39;re talking about. Could you provide us with more code showing the context in which Sender.ParseResp is called? Since it&#39;s unclear what happen to the response you retrieve from c.Do()/t.Roundrip()?"}, {"owner": {"reputation": 837, "user_id": 1758678, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/6dccc7ccb6581066fac14bfe87a886a2?s=128&d=identicon&r=PG", "display_name": "enzoyang", "link": "https://stackoverflow.com/users/1758678/enzoyang"}, "edited": false, "score": 0, "creation_date": 1424046219, "post_id": 28528330, "comment_id": 45380582, "body": "Sorry for incomplete info, I&#39;ve completed the exact code the program current running"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1424018054, "creation_date": 1424018054, "answer_id": 28528330, "question_id": 28528060, "link": "https://stackoverflow.com/questions/28528060/golang-get-massive-read-tcp-ipport-i-o-timeout-in-ubuntu-14-04-lts/28528330#28528330", "title": "golang get massive read tcp ip:port i/o timeout in ubuntu 14.04 LTS", "body": "<p>Without seeing the code to <code>timeoutDial</code>, my wild guess is that you don't close the connection when you're done with it.</p>\n"}, {"comments": [{"owner": {"reputation": 837, "user_id": 1758678, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/6dccc7ccb6581066fac14bfe87a886a2?s=128&d=identicon&r=PG", "display_name": "enzoyang", "link": "https://stackoverflow.com/users/1758678/enzoyang"}, "edited": false, "score": 0, "creation_date": 1424044722, "post_id": 28531524, "comment_id": 45380263, "body": "I&#39;ve added codes that we are dealing with response and timeoutDial in the problem, please have a look."}], "tags": [], "owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1424036555, "creation_date": 1424036555, "answer_id": 28531524, "question_id": 28528060, "link": "https://stackoverflow.com/questions/28528060/golang-get-massive-read-tcp-ipport-i-o-timeout-in-ubuntu-14-04-lts/28531524#28531524", "title": "golang get massive read tcp ip:port i/o timeout in ubuntu 14.04 LTS", "body": "<p>To more explicitly state what Not_a_Golfer and OneOfOne have said, when you're done with the response, you need to close the connection which has been left open (through the Body field which is an io.ReadCloser). So basically, one simple though would be to change the code pertaining to making an http request to:</p>\n\n<pre><code>var resp *http.Response\nif data.Redirect {\n    c := &amp;http.Client{\n        Transport: t,\n    }\n    resp, err = c.Do(req)\n} else {\n    resp, err = t.RoundTrip(req)\n}\nif err == nil {\n    defer resp.Body.Close() // we need to close the connection\n}\n</code></pre>\n"}], "owner": {"reputation": 837, "user_id": 1758678, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/6dccc7ccb6581066fac14bfe87a886a2?s=128&d=identicon&r=PG", "display_name": "enzoyang", "link": "https://stackoverflow.com/users/1758678/enzoyang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10358, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1424046858, "creation_date": 1424016474, "last_edit_date": 1424046858, "question_id": 28528060, "link": "https://stackoverflow.com/questions/28528060/golang-get-massive-read-tcp-ipport-i-o-timeout-in-ubuntu-14-04-lts", "title": "golang get massive read tcp ip:port i/o timeout in ubuntu 14.04 LTS", "body": "<p>I wrote a golang program which run well in the past several months in ubuntu 12.04 LTS until I upgraded it to 14.04 LTS</p>\n\n<p>My program is focused on sending HTTP requests which send about 2-10 HTTP requests per second. The HTTP request address vary.</p>\n\n<p>When the problem occurs, first, some of the requests shows <code>read tcp [ip]:[port]: i/o timeout</code>, then after several minutes all requests show <code>read tcp [ip]:[port]: i/o timeout</code>, not any request can be sent.</p>\n\n<p><strong>I restart the program, everything become right again.</strong></p>\n\n<p><strong>All of our servers(2 server) have such problem after upgraded from 12.04 to 14.04</strong></p>\n\n<p><strong>I create new goroutine for every request</strong></p>\n\n<p><strong>the problem does not occur in the same interval, sometimes it won't occur one or two day, sometimes It occur twice in an hour</strong></p>\n\n<p>Bellow is my code requesting HTTP Address:</p>\n\n<pre><code>t := &amp;http.Transport{\n    Dial:            timeoutDial(data.Timeout),\n    TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n}\n//req := s.ParseReq(data)\nreq := data.convert2Request()\nif req == nil {\n    return\n}\n\nvar resp *http.Response\nif data.Redirect {\n    c := &amp;http.Client{\n        Transport: t,\n    }\n    resp, err = c.Do(req)\n} else {\n    resp, err = t.RoundTrip(req)\n}\n\ndata.updateTry()\n\nr := s.ParseResp(data, resp, err)\n</code></pre>\n\n<p>updateTry:</p>\n\n<pre><code>func (d *SendData) updateTry() {\n    d.Try++\n    d.LastSend = time.Now()\n}\n</code></pre>\n\n<p>timeoutDial:</p>\n\n<pre><code>func timeoutDial(timeout int) func(netw, addr string) (net.Conn, error) {\n    if timeout &lt;= 0 {\n        timeout = 10\n    }\n    return func(netw, addr string) (net.Conn, error) {\n        deadline := time.Now().Add(time.Duration(timeout) * time.Second)\n        c, err := net.DialTimeout(netw, addr, time.Second*time.Duration(timeout+5))\n        if err != nil {\n            return nil, err\n        }\n        c.SetDeadline(deadline)\n        return c, nil\n    }\n}\n</code></pre>\n\n<p>and My dealing with response is:</p>\n\n<pre><code>func (s *Sender) ParseResp(data SendData, resp *http.Response, err error) (r Resp) {\n    r = Resp{URL: data.URL}\n    if err != nil {\n        r.Err = err.Error()\n    } else {\n        r.HttpCode = resp.StatusCode\n        r.Header = resp.Header\n        r.URL = resp.Request.URL.String()\n        defer resp.Body.Close()\n        // we just read part of response and log it.\n        reader := bufio.NewReader(resp.Body)\n        buf := make([]byte, bytes.MinRead) // 512 byte\n        for len(r.Body) &lt; 1024 {           // max 1k\n            var n int\n            if n, _ = reader.Read(buf); n == 0 {\n                break\n            }\n            r.Body += string(buf[:n])\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>I also found setting in /etc/sysctl.conf which can make the problem happen less frequently:</p>\n\n<pre><code>net.core.somaxconn = 65535\nnet.netfilter.nf_conntrack_max = 655350\nnet.netfilter.nf_conntrack_tcp_timeout_established = 1200\n</code></pre>\n\n<p>I need help for solving this problem.</p>\n\n<p>It seems like this but I don't see any solution <a href=\"https://bugs.launchpad.net/juju-core/+bug/1307434\" rel=\"nofollow\">https://bugs.launchpad.net/juju-core/+bug/1307434</a></p>\n"}, {"tags": ["gcc", "go", "gccgo"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1424016226, "creation_date": 1424016226, "answer_id": 28528019, "question_id": 28527673, "link": "https://stackoverflow.com/questions/28527673/gccgo-4-9-2-dynamic-linker-error-undefined-reference-to-sync-import/28528019#28528019", "title": "gccgo 4.9.2 dynamic linker error: undefined reference to `sync..import&#39;", "body": "<p>Dynamic linking is iffy at best and not all that supported, so take it with a grain of salt.</p>\n\n<p>That being said, it works for me, so something might be wrong with your gcc and/or libgo setup.</p>\n\n<pre><code>\u279c gccgo -c hello.go \n\u279c gccgo -o hello hello.o \n\u279c ./hello \nhello world\n\u279c ldd hello\n        linux-vdso.so.1 (0x00007fffb831f000)\n        libgo.so.5 =&gt; /usr/lib/libgo.so.5 (0x00007f214aaba000)\n        libm.so.6 =&gt; /usr/lib/libm.so.6 (0x00007f214a7b5000)\n        libgcc_s.so.1 =&gt; /usr/lib/libgcc_s.so.1 (0x00007f214a59f000)\n        libc.so.6 =&gt; /usr/lib/libc.so.6 (0x00007f214a1fc000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f214b919000)\n        libpthread.so.0 =&gt; /usr/lib/libpthread.so.0 (0x00007f2149fdf000)\n\u279c gccgo -v\nUsing built-in specs.\nCOLLECT_GCC=gccgo\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-unknown-linux-gnu/4.9.2/lto-wrapper\nTarget: x86_64-unknown-linux-gnu\nConfigured with: /build/gcc-multilib/src/gcc-4.9-20150204/configure --prefix=/usr --libdir=/usr/lib --libexecdir=/usr/lib --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=https://bugs.archlinux.org/ --enable-languages=c,c++,ada,fortran,go,lto,objc,obj-c++ --enable-shared --enable-threads=posix --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-clocale=gnu --disable-libstdcxx-pch --disable-libssp --enable-gnu-unique-object --enable-linker-build-id --enable-cloog-backend=isl --enable-lto --enable-plugin --enable-install-libiberty --with-linker-hash-style=gnu --enable-multilib --disable-werror --enable-checking=release\nThread model: posix\ngcc version 4.9.2 20150204 (prerelease) (GCC)\n</code></pre>\n\n<p>If you're trying to get a small executable size, look into using upx as a workaround or try to compile gccgo by hand.</p>\n"}], "owner": {"reputation": 2120, "user_id": 897889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9e7cdf593132404f23da6936f69339a?s=128&d=identicon&r=PG", "display_name": "wukong", "link": "https://stackoverflow.com/users/897889/wukong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 854, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424016226, "creation_date": 1424014023, "last_edit_date": 1424014618, "question_id": 28527673, "link": "https://stackoverflow.com/questions/28527673/gccgo-4-9-2-dynamic-linker-error-undefined-reference-to-sync-import", "title": "gccgo 4.9.2 dynamic linker error: undefined reference to `sync..import&#39;", "body": "<p>The source code is</p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main() {\n    fmt.Println(\"hello world\")\n}\n</code></pre>\n\n<p>The Object file is built without error</p>\n\n<pre><code>root@OpenWrt:/mnt/sda3# gccgo -v -c hello.go\nUsing built-in specs.\nCOLLECT_GCC=gccgo\nTarget: mipsel-openwrt-linux-gnu\nConfigured with: /home/michal/Data/openwrt/mt7621/mtk-openwrt-master-eglibc/build_dir/target-mipsel_1004kc+dsp_eglibc-2.19/gcc-4.9.2/configure --target=mipsel-openwrt-linux --host=mipsel-openwrt-linux --build=x86_64-linux-gnu --program-prefix= --program-suffix= --prefix=/usr --exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin --libexecdir=/usr/lib --sysconfdir=/etc --datadir=/usr/share --localstatedir=/var --mandir=/usr/man --infodir=/usr/info --disable-nls --build=x86_64-linux-gnu --host=mipsel-openwrt-linux-gnu --target=mipsel-openwrt-linux-gnu --enable-languages=c,c++,go --with-bugurl=https://dev.openwrt.org/ --with-pkgversion='OpenWrt GCC 4.9.2' --enable-shared --disable-__cxa_atexit --enable-target-optspace --with-gnu-ld --disable-nls --disable-libmudflap --disable-multilib --disable-libgomp --disable-libquadmath --disable-libssp --disable-decimal-float --disable-libstdcxx-pch --with-host-libstdcxx=-lstdc++ --prefix=/usr --libexecdir=/usr/lib --with-float=soft\nThread model: posix\ngcc version 4.9.2 (OpenWrt GCC 4.9.2) \nCOLLECT_GCC_OPTIONS='-v' '-c' '-o' 'hello.o' '-shared-libgcc' '-msoft-float' '-mllsc' '-mno-shared'\n /usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/go1 hello.go -quiet -dumpbase hello.go -msoft-float -mllsc -mno-shared -auxbase-strip hello.o -version -L/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2 -L/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/../../.. -o /tmp/ccWiioSJ.s\nGNU Go (OpenWrt GCC 4.9.2) version 4.9.2 (mipsel-openwrt-linux-gnu)\n        compiled by GNU C version 4.8.3, GMP version 4.3.2, MPFR version 2.4.2, MPC version 0.8.1\nGGC heuristics: --param ggc-min-expand=47 --param ggc-min-heapsize=31962\nGNU Go (OpenWrt GCC 4.9.2) version 4.9.2 (mipsel-openwrt-linux-gnu)\n        compiled by GNU C version 4.8.3, GMP version 4.3.2, MPFR version 2.4.2, MPC version 0.8.1\nGGC heuristics: --param ggc-min-expand=47 --param ggc-min-heapsize=31962\nCOLLECT_GCC_OPTIONS='-v' '-c' '-o' 'hello.o' '-shared-libgcc' '-msoft-float' '-mllsc' '-mno-shared'\n as -v -EL -O1 -no-mdebug -mabi=32 -mno-shared -KPIC -o hello.o /tmp/ccWiioSJ.s\nGNU assembler version 2.24 (mipsel-openwrt-linux-gnu) using BFD version (GNU Binutils) 2.24\nCOMPILER_PATH=/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/\nLIBRARY_PATH=/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/../../../:/lib/:/usr/lib/\nCOLLECT_GCC_OPTIONS='-v' '-c' '-o' 'hello.o' '-shared-libgcc' '-msoft-float' '-mllsc' '-mno-shared'\n</code></pre>\n\n<p>But the linker reports an error <code>undefined reference to `sync..import'</code>.</p>\n\n<pre><code>root@OpenWrt:/mnt/sda2# gccgo -v -o hello hello.o\nUsing built-in specs.\nCOLLECT_GCC=gccgo\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/lto-wrapper\nTarget: mipsel-openwrt-linux-gnu\nConfigured with: /home/michal/Data/openwrt/mt7621/mtk-openwrt-master-eglibc/build_dir/target-mipsel_1004kc+dsp_eglibc-2.19/gcc-4.9.2/configure --target=mipsel-openwrt-linux --host=mipsel-openwrt-linux --build=x86_64-linux-gnu --program-prefix= --program-suffix= --prefix=/usr --exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin --libexecdir=/usr/lib --sysconfdir=/etc --datadir=/usr/share --localstatedir=/var --mandir=/usr/man --infodir=/usr/info --disable-nls --build=x86_64-linux-gnu --host=mipsel-openwrt-linux-gnu --target=mipsel-openwrt-linux-gnu --enable-languages=c,c++,go --with-bugurl=https://dev.openwrt.org/ --with-pkgversion='OpenWrt GCC 4.9.2' --enable-shared --disable-__cxa_atexit --enable-target-optspace --with-gnu-ld --disable-nls --disable-libmudflap --disable-multilib --disable-libgomp --disable-libquadmath --disable-libssp --disable-decimal-float --disable-libstdcxx-pch --with-host-libstdcxx=-lstdc++ --prefix=/usr --libexecdir=/usr/lib --with-float=soft\nThread model: posix\ngcc version 4.9.2 (OpenWrt GCC 4.9.2) \nCOMPILER_PATH=/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/\nLIBRARY_PATH=/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/:/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/../../../:/lib/:/usr/lib/\nCOLLECT_GCC_OPTIONS='-v' '-o' 'hello' '-shared-libgcc' '-msoft-float' '-mllsc' '-mno-shared'\n /usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/collect2 --eh-frame-hdr -EL -dynamic-linker /lib/ld.so.1 -o hello /usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/crt1.o /usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/crti.o /usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/crtbegin.o -L/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2 -L/usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/../../.. hello.o -lgobegin -lgo -lm -lgcc_s -lgcc -lc -lgcc_s -lgcc /usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/crtend.o /usr/lib/gcc/mipsel-openwrt-linux-gnu/4.9.2/crtn.o\nhello.o: In function `__go_init_main':\nhello.go:(.text+0x16c): undefined reference to `sync..import'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>What i missed? Thanks for help</p>\n\n<p>I've tried static link the program, add a flag <code>-static-libgo</code>, it works.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 0, "creation_date": 1424010350, "post_id": 28527038, "comment_id": 45369679, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/15715605/multiple-goroutines-listening-on-one-channel\">multiple goroutines listening on one channel</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 2, "creation_date": 1424088582, "post_id": 28528041, "comment_id": 45395699, "body": "Strictly speaking, closing a channel is a multicast signal rather than a broadcast. Only those goroutines that are attempting to use the channel are notified."}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 4, "last_activity_date": 1424016377, "creation_date": 1424016377, "answer_id": 28528041, "question_id": 28527038, "link": "https://stackoverflow.com/questions/28527038/go-one-channel-with-multiple-listeners/28528041#28528041", "title": "Go: one channel with multiple listeners", "body": "<p>Channels are a point to point communication method, not a broadcast communication method, so no, you can't get both functions to get the event without doing something special.</p>\n\n<p>You could have separate channels for both goroutines and send the message into each.  This is probably the simplest solution.</p>\n\n<p>Or alternatively you could get one goroutine to signal the next one.</p>\n\n<p>Go has two mechanisms for doing broadcast signalling as far as I know.  One is closing a channel.  This only works a single time though.</p>\n\n<p>The other is to use a <a href=\"http://golang.org/pkg/sync/#Cond\" rel=\"nofollow\">sync.Cond</a> lock. These are moderately tricky to use, but will allow you to have multiple goroutines woken up by a single event.</p>\n\n<p>If I was you, I'd go for the first option, send the event to two different channels.  That seems to map the problem quite well.</p>\n"}, {"comments": [{"owner": {"reputation": 6305, "user_id": 72987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9d1484425e9a125402f85497c7f86a00?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/72987/mike"}, "edited": false, "score": 0, "creation_date": 1424101239, "post_id": 28529866, "comment_id": 45403202, "body": "thanks.. i went with this solution and it should do what I need it to do."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 6305, "user_id": 72987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9d1484425e9a125402f85497c7f86a00?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/72987/mike"}, "edited": false, "score": 0, "creation_date": 1424101601, "post_id": 28529866, "comment_id": 45403456, "body": "I&#39;m glad it was helpful!"}, {"owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "edited": false, "score": 0, "creation_date": 1525950316, "post_id": 28529866, "comment_id": 87559958, "body": "What happens when a consumer gets stuck. Doesn&#39;t that also get the dispather stuck as it won&#39;t get the third done? Isn&#39;t that behaviour equivalent to above code without the done channel?"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1525954140, "post_id": 28529866, "comment_id": 87562053, "body": "True and a <code>sync.WaitGroup</code> would have the same problem. Now there is a need for introducing timeouts to identify unresponsive consumers and ... I would say at that point a more robust solution like NATS might be a more proper choice! :)"}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": true, "score": 14, "last_activity_date": 1424103844, "last_edit_date": 1424103844, "creation_date": 1424026628, "answer_id": 28529866, "question_id": 28527038, "link": "https://stackoverflow.com/questions/28527038/go-one-channel-with-multiple-listeners/28529866#28529866", "title": "Go: one channel with multiple listeners", "body": "<p>You can use <em>fan in</em> and <em>fan out</em> (from Rob Pike's speech):</p>\n\n<pre><code>package main\n\nfunc main() {\n    // feeders - feeder1, feeder2 and feeder3 are used to fan in\n    // data into one channel\n    go func() {\n        for {\n            select {\n            case v1 := &lt;-feeder1:\n                mainChannel &lt;- v1\n            case v2 := &lt;-feeder2:\n                mainChannel &lt;- v2\n            case v3 := &lt;-feeder3:\n                mainChannel &lt;- v3\n            }\n        }\n    }()\n\n    // dispatchers - not actually fan out rather dispatching data\n    go func() {\n        for {\n            v := &lt;-mainChannel\n\n            // use this to prevent leaking goroutines\n            // (i.e. when one consumer got stuck)\n            done := make(chan bool)\n\n            go func() {\n                consumer1 &lt;- v\n                done &lt;- true\n            }()\n            go func() {\n                consumer2 &lt;- v\n                done &lt;- true\n            }()\n            go func() {\n                consumer3 &lt;- v\n                done &lt;- true\n            }()\n\n            &lt;-done\n            &lt;-done\n            &lt;-done\n        }\n    }()\n\n    // or fan out (when processing the data by just one consumer is enough)\n    go func() {\n        for {\n            v := &lt;-mainChannel\n            select {\n            case consumer1 &lt;- v:\n            case consumer2 &lt;- v:\n            case consumer3 &lt;- v:\n            }\n        }\n    }()\n\n    // consumers(your logic)\n    go func() { &lt;-consumer1 /* using the value */ }()\n    go func() { &lt;-consumer2 /* using the value */ }()\n    go func() { &lt;-consumer3 /* using the value */ }()\n}\n\ntype payload int\n\nvar (\n    feeder1 = make(chan payload)\n    feeder2 = make(chan payload)\n    feeder3 = make(chan payload)\n\n    mainChannel = make(chan payload)\n\n    consumer1 = make(chan payload)\n    consumer2 = make(chan payload)\n    consumer3 = make(chan payload)\n)\n</code></pre>\n"}], "owner": {"reputation": 6305, "user_id": 72987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9d1484425e9a125402f85497c7f86a00?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/72987/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7957, "favorite_count": 0, "accepted_answer_id": 28529866, "answer_count": 2, "score": 11, "last_activity_date": 1424103844, "creation_date": 1424010207, "question_id": 28527038, "link": "https://stackoverflow.com/questions/28527038/go-one-channel-with-multiple-listeners", "title": "Go: one channel with multiple listeners", "body": "<p>I'm pretty new to Go so sorry if the topic is wrong but I hope you understand my question. I want to process events to different go routines via a channel. Here is some sample code</p>\n\n<pre><code>type Event struct {\n    Host string\n    Command string\n    Output string\n}\n\n\nvar (\n    incoming        = make(chan Event)\n)\n\nfunc processEmail(ticker* time.Ticker) {\n    for {\n        select {\n        case t := &lt;-ticker.C:\n            fmt.Println(\"Email Tick at\", t)\n        case e := &lt;-incoming:\n            fmt.Println(\"EMAIL GOT AN EVENT!\")\n            fmt.Println(e)\n        }\n    }\n}\n\nfunc processPagerDuty(ticker* time.Ticker) {\n    for {\n        select {\n        case t := &lt;-ticker.C:\n            fmt.Println(\"Pagerduty Tick at\", t)\n        case e := &lt;-incoming:\n            fmt.Println(\"PAGERDUTY GOT AN EVENT!\")\n            fmt.Println(e)\n        }\n    }\n}\n\nfunc main() {\n\n    err := gcfg.ReadFileInto(&amp;cfg, \"dispatch-api.cfg\")\n    if err != nil {\n        fmt.Printf(\"Error loading the config\")\n    }\n\n    ticker := time.NewTicker(time.Second * 10)\n    go processEmail(ticker)\n\n    ticker := time.NewTicker(time.Second * 1)\n    go processPagerDuty(ticker)\n}\n\n\nfunc eventAdd(r render.Render, params martini.Params, req *http.Request) {\n\n    // create an event now\n    e := Event{Host: \"web01-east.domain.com\", Command: \"foo\", Output: \"bar\"}\n    incoming &lt;- e\n}\n</code></pre>\n\n<p>So the ticker events work just create. When I issue an API call to create an event I just get output from the processEmail function. Its whatever go routine is called first will get the event over the channel. </p>\n\n<p>Is there a way for both functions to get that event?</p>\n"}, {"tags": ["variables", "go", "conditional"], "comments": [{"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 4, "creation_date": 1424007936, "post_id": 28526138, "comment_id": 45369013, "body": "The socalled &#39;init&#39; functions exist to do this kind of initialization of package-level state: <a href=\"https://golang.org/doc/effective_go.html#init\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#init</a>"}], "answers": [{"tags": [], "owner": {"reputation": 345, "user_id": 481817, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/93422cf638f3e809321518d0ebb656df?s=128&d=identicon&r=PG", "display_name": "WheresWardy", "link": "https://stackoverflow.com/users/481817/whereswardy"}, "is_accepted": false, "score": 0, "last_activity_date": 1424005004, "creation_date": 1424005004, "answer_id": 28526267, "question_id": 28526138, "link": "https://stackoverflow.com/questions/28526138/settings-global-conditional-variables-in-go/28526267#28526267", "title": "Settings global conditional variables in Go", "body": "<p>After actually thinking about this for a couple of minutes, I've realised I can just create a wrapper function to do the work, and call that instead (again, largely pseudo-code without extra checks):</p>\n\n<pre><code>var myenvbool bool = myenv(\"MYVAR\")\n\nfunc myenv(envvar string) bool {\n    myenvvalue := os.Getenv(envvar)\n    myenvbool, _ := strconv.ParseBool(myenvvalue)\n    return myenvbool\n}\n\nfunc checkenv() {\n    if myenvbool {\n        fmt.Print(\"myenvbool is true\")\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 345, "user_id": 481817, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/93422cf638f3e809321518d0ebb656df?s=128&d=identicon&r=PG", "display_name": "WheresWardy", "link": "https://stackoverflow.com/users/481817/whereswardy"}, "edited": false, "score": 0, "creation_date": 1424083546, "post_id": 28526459, "comment_id": 45393089, "body": "To be honest, I have no idea what the problem was; I&#39;ve re-tried this as a simple test case, and it works perfectly. Before Go was chucking an error about assignment, but I can&#39;t recreate it."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 4, "last_activity_date": 1424006237, "creation_date": 1424006237, "answer_id": 28526459, "question_id": 28526138, "link": "https://stackoverflow.com/questions/28526138/settings-global-conditional-variables-in-go/28526459#28526459", "title": "Settings global conditional variables in Go", "body": "<p>I'm not sure what problem you had, your code from the OP is valid, also you can have it in one line like:</p>\n\n<pre><code>var myvarbool, _ = strconv.ParseBool(os.Getenv(\"MYVAR\"))\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/Fi_i1s_X8U\" rel=\"nofollow\">playground</a></kbd></p>\n"}, {"comments": [{"owner": {"reputation": 5333, "user_id": 600110, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/631482257a15feb38bc7a5b010de5afc?s=128&d=identicon&r=PG", "display_name": "Sam Mussmann", "link": "https://stackoverflow.com/users/600110/sam-mussmann"}, "edited": false, "score": 0, "creation_date": 1424049371, "post_id": 28531568, "comment_id": 45381234, "body": "Ignoring <code>err</code> is not going to end well.  Maybe panic if <code>err != nil</code>?"}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "reply_to_user": {"reputation": 5333, "user_id": 600110, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/631482257a15feb38bc7a5b010de5afc?s=128&d=identicon&r=PG", "display_name": "Sam Mussmann", "link": "https://stackoverflow.com/users/600110/sam-mussmann"}, "edited": false, "score": 0, "creation_date": 1424094067, "post_id": 28531568, "comment_id": 45398873, "body": "My apologies, I should have stated that this is not code I would willingly commit to my own repos - it was simply a slightly more idiomatic manner to solve this problem (offloading <i>initialization</i> code to all run in <code>func init() { ...} </code> so that we are setup to go before we hit main)."}, {"owner": {"reputation": 5333, "user_id": 600110, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/631482257a15feb38bc7a5b010de5afc?s=128&d=identicon&r=PG", "display_name": "Sam Mussmann", "link": "https://stackoverflow.com/users/600110/sam-mussmann"}, "edited": false, "score": 0, "creation_date": 1424097158, "post_id": 28531568, "comment_id": 45400754, "body": "Fair enough.  I guess I would tend to only have <code>myvarbool</code> in the global namespace, and to call <code>os.Getenv(&quot;whatever&quot;)</code> directly in init."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 5333, "user_id": 600110, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/631482257a15feb38bc7a5b010de5afc?s=128&d=identicon&r=PG", "display_name": "Sam Mussmann", "link": "https://stackoverflow.com/users/600110/sam-mussmann"}, "edited": false, "score": 0, "creation_date": 1424269253, "post_id": 28531568, "comment_id": 45478928, "body": "@SamMussmann while ignoring errors is generally bad, for that specific instance it&#39;s not important at all, it&#39;s a bool value."}], "tags": [], "owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "is_accepted": false, "score": 6, "last_activity_date": 1424036910, "creation_date": 1424036910, "answer_id": 28531568, "question_id": 28526138, "link": "https://stackoverflow.com/questions/28526138/settings-global-conditional-variables-in-go/28531568#28531568", "title": "Settings global conditional variables in Go", "body": "<p>One way to accomplish what you're looking to do would be to process the environment variable in an init() function, so something like the following would work:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n)\n\nvar (\n    myvar string = os.Getenv(\"MYVAR\")\n    myvarbool bool\n)\n\nfunc init() {\n    myvarbool, _ = strconv.ParseBool(myvar)\n}\n\n// Utility function to check for value\nfunc mycheck() {\n    if myvarbool {\n        fmt.Print(\"MYVAR is true\")\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/2NA1_vR2OM\">Playground</a></p>\n"}], "owner": {"reputation": 345, "user_id": 481817, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/93422cf638f3e809321518d0ebb656df?s=128&d=identicon&r=PG", "display_name": "WheresWardy", "link": "https://stackoverflow.com/users/481817/whereswardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 28526459, "answer_count": 3, "score": 0, "last_activity_date": 1424036910, "creation_date": 1424004149, "question_id": 28526138, "link": "https://stackoverflow.com/questions/28526138/settings-global-conditional-variables-in-go", "title": "Settings global conditional variables in Go", "body": "<p>I want to parse and set a variable conditionally in Go at the global package level based on the value of of an ENV var, so that I don't have to check for it every time in a utility function (as the variable would be declared once at run time). For example, what I want to accomplish is (Go pseudo-code):</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n)\n\n// This works to read the value of MYVAR (=true/false)\nvar myvar string = os.Getenv(\"MYVAR\")\n\n// Apparently this is too much for Go\nvar myvarbool, _ = strconv.ParseBool(myvar)\n\n// Utility function to check for value\nfunc mycheck() {\n    if myvarbool {\n        fmt.Print(\"MYVAR is true\")\n    }\n}\n</code></pre>\n\n<p>This is a library package, so doesn't have a main() function to do this kind of setup, but I want to be able to use mycheck() in other functions in the library, and don't want to have to read and parse MYVAR every time mycheck() is called.</p>\n"}, {"tags": ["c++", "opencv", "go", "swig"], "comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1424065833, "post_id": 28523496, "comment_id": 45384810, "body": "What did you name your swig file?"}, {"owner": {"reputation": 9565, "user_id": 1371471, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/faf259d8e263234505409be153763398?s=128&d=identicon&r=PG", "display_name": "lazywei", "link": "https://stackoverflow.com/users/1371471/lazywei"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1424068983, "post_id": 28523496, "comment_id": 45385838, "body": "I name my swig file by example.swigcxx"}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 3671914, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/40d876b70aae3be06567d5db7f7a77da?s=128&d=identicon&r=PG", "display_name": "bobsacameno", "link": "https://stackoverflow.com/users/3671914/bobsacameno"}, "edited": false, "score": 1, "creation_date": 1471858603, "post_id": 28535832, "comment_id": 65499793, "body": "I&#39;m having the same problem. I wrote all the includes needed, but it still gives me this error. Do you know what should I do?"}], "tags": [], "owner": {"reputation": 9565, "user_id": 1371471, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/faf259d8e263234505409be153763398?s=128&d=identicon&r=PG", "display_name": "lazywei", "link": "https://stackoverflow.com/users/1371471/lazywei"}, "is_accepted": true, "score": 2, "last_activity_date": 1424068953, "creation_date": 1424068953, "answer_id": 28535832, "question_id": 28523496, "link": "https://stackoverflow.com/questions/28523496/syntax-error-when-include-opencv-core-hpp-in-swig/28535832#28535832", "title": "Syntax error when include OpenCV core.hpp in SWIG", "body": "<p>OK, I found the problem might be caused by the nested header including.</p>\n\n<p>In <code>opencv2/core/core.hpp</code>, there is</p>\n\n<pre><code>#include \"opencv2/core/types_c.h\"\n#include \"opencv2/core/version.hpp\"\n</code></pre>\n\n<p>and hence if I add these two headers to my swig file:</p>\n\n<pre><code>%include \"opencv2/core/types_c.h\"\n%include \"opencv2/core/version.hpp\"\n%include \"opencv2/core/core.hpp\"\n</code></pre>\n\n<p>It will not raise the missing semicolon error.</p>\n"}], "owner": {"reputation": 9565, "user_id": 1371471, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/faf259d8e263234505409be153763398?s=128&d=identicon&r=PG", "display_name": "lazywei", "link": "https://stackoverflow.com/users/1371471/lazywei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1800, "favorite_count": 0, "accepted_answer_id": 28535832, "answer_count": 1, "score": 3, "last_activity_date": 1424068953, "creation_date": 1423980421, "question_id": 28523496, "link": "https://stackoverflow.com/questions/28523496/syntax-error-when-include-opencv-core-hpp-in-swig", "title": "Syntax error when include OpenCV core.hpp in SWIG", "body": "<p>I'm trying to use SWIG to wrap OpenCV's C++ API. However, when I compile, I got this error:</p>\n\n<pre><code>/usr/local/Cellar/opencv/2.4.10.1/include/opencv2/core/core.hpp:123:\nError: Syntax error - possibly a missing semicolon.\n</code></pre>\n\n<p>and here is my SWIG file</p>\n\n<pre><code>%module example\n\n%{\n#include \"opencv2/core/core.hpp\"\n%}\n\n%include \"opencv2/core/core.hpp\"\n</code></pre>\n\n<p>I'm not sure if this is an error from SWIG or from OpenCV. Is it OK to only include <code>core.hpp</code> like this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["linux", "go", "terminal", "console", "console-application"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1423975473, "post_id": 28522509, "comment_id": 45362767, "body": "Huh wow. I know nothing but what I learned from my Google search, but <a href=\"https://code.google.com/p/goncurses/\" rel=\"nofollow noreferrer\">code.google.com/p/goncurses</a> might help."}], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 1, "last_activity_date": 1423977962, "creation_date": 1423977962, "answer_id": 28523285, "question_id": 28522509, "link": "https://stackoverflow.com/questions/28522509/termbox-go-reading-data-from-the-console/28523285#28523285", "title": "termbox-go - Reading data from the console", "body": "<p>As for how users could enter text you could check out this example <a href=\"https://github.com/nsf/termbox-go/blob/master/_demos/editbox.go\" rel=\"nofollow\">https://github.com/nsf/termbox-go/blob/master/_demos/editbox.go</a></p>\n\n<p>In the example nothing happens when you press Enter but that's just because it's not handled in the main loop. Also you could expand this example with multiple edit boxes and map the up/down arrows to change which box has focus.</p>\n"}], "owner": {"reputation": 31, "user_id": 4567908, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bwqBggc97f0/AAAAAAAAAAI/AAAAAAAAA8Q/ESnx7ysuCjA/photo.jpg?sz=128", "display_name": "Shibu Raj", "link": "https://stackoverflow.com/users/4567908/shibu-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1813, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1423977962, "creation_date": 1423968033, "last_edit_date": 1423968098, "question_id": 28522509, "link": "https://stackoverflow.com/questions/28522509/termbox-go-reading-data-from-the-console", "title": "termbox-go - Reading data from the console", "body": "<p>I am very new to Go and went through some of the basic examples and literature around Go Lang. Currently I am working on a project where I need to create a terminal application. After reading around termbox-go we have decided to use the termbox-go as the base library for the development. </p>\n\n<p>The application is very simple where the user will be provided with a set of menus as follows</p>\n\n<pre><code>Main Menu\n---------\n01) Menu 1\n02) Menu 2\n03) Menu 3\n99) Quit\n\nPlease enter your selection : __\n</code></pre>\n\n<p>I am able to get the layout and all everything done after looking through the examples. But it no where I am not seeing any examples of where the selection is read from the terminal. The user will hit \"Enter\" key after the selection is done.</p>\n\n<p>Can anyone can share an example which shows how to achieve the above.</p>\n\n<p>Also is there any examples where the user screen has multiple input areas where user can move using up and down key and enter the values - as below</p>\n\n<pre><code>Enter Name : _____________\nEnter DOB : ______________\nEnter City: ______________\n</code></pre>\n\n<p>Any examples or pointers are highly appreciated. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["url", "encoding", "go", "urlencode"], "comments": [{"owner": {"reputation": 4111, "user_id": 23033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b6c69cae4d2061cafe851676f8d262?s=128&d=identicon&r=PG", "display_name": "Dre", "link": "https://stackoverflow.com/users/23033/dre"}, "edited": false, "score": 1, "creation_date": 1423965912, "post_id": 28521723, "comment_id": 45361421, "body": "Why are you trying to have those remain as %2F -- what is your final use case?"}, {"owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "reply_to_user": {"reputation": 4111, "user_id": 23033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b6c69cae4d2061cafe851676f8d262?s=128&d=identicon&r=PG", "display_name": "Dre", "link": "https://stackoverflow.com/users/23033/dre"}, "edited": false, "score": 0, "creation_date": 1423966985, "post_id": 28521723, "comment_id": 45361639, "body": "@Dre My goal is to be able to use /&#39;s in http.NewRequest. I just tried it to see if it would work with url.Parse(). It&#39;s supposed to serve as an ID for elasticsearch. ES unescapes it itself, just the golang side of things isn&#39;t working out for me."}, {"owner": {"reputation": 4111, "user_id": 23033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b6c69cae4d2061cafe851676f8d262?s=128&d=identicon&r=PG", "display_name": "Dre", "link": "https://stackoverflow.com/users/23033/dre"}, "edited": false, "score": 0, "creation_date": 1423972203, "post_id": 28521723, "comment_id": 45362347, "body": "It seems that as long as the data is inside an argument, it stays escaped: <a href=\"http://play.golang.org/p/m49q50JfGf\" rel=\"nofollow noreferrer\">play.golang.org/p/m49q50JfGf</a>   -- I believe Go is actually doing the correct thing here."}, {"owner": {"reputation": 4111, "user_id": 23033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b6c69cae4d2061cafe851676f8d262?s=128&d=identicon&r=PG", "display_name": "Dre", "link": "https://stackoverflow.com/users/23033/dre"}, "edited": false, "score": 0, "creation_date": 1423972611, "post_id": 28521723, "comment_id": 45362401, "body": "( Is that what you are trying to do? Or do you actually need to use it bare? )"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1423978121, "post_id": 28521723, "comment_id": 45363159, "body": "See <a href=\"http://stackoverflow.com/questions/28433779/linkedin-api-call-with-url-encoded/28438546#28438546\" title=\"linkedin api call with url encoded\">stackoverflow.com/questions/28433779/&hellip;</a>.  Summary: create a request by calling NewRequest and then set req.URL.Opaque with the path containing %2f. This is the approach that I use with ES."}, {"owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1424019374, "post_id": 28521723, "comment_id": 45372323, "body": "@ThunderCat I would&#39;ve preferred not having to do that as the request is created in another library (elastigo). I only pass in the url. As a solution, I just wound up hashing the path as needed."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1424023284, "post_id": 28521723, "comment_id": 45373619, "body": "I didn&#39;t know that there&#39;s a package. I use the REST interface directly."}], "answers": [{"tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": true, "score": 5, "last_activity_date": 1450723706, "last_edit_date": 1450723706, "creation_date": 1423981003, "answer_id": 28523549, "question_id": 28521723, "link": "https://stackoverflow.com/questions/28521723/include-2f-in-golang-http-newrequest/28523549#28523549", "title": "Include %2F in golang http.NewRequest", "body": "<p>This is a flaw in the design of the Go standard library. It has been acknowledged (<a href=\"https://code.google.com/p/go/issues/detail?id=3659\" rel=\"nofollow\">issue 3659</a>), but they have decided not to fix it for backwards compatibility reasons.</p>\n\n<p>Although it isn't fun, the best way is to build a URL using opaque. You can find documentation <a href=\"http://golang.org/pkg/net/url/#example_URL_opaque\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "accepted_answer_id": 28523549, "answer_count": 1, "score": 2, "last_activity_date": 1450723706, "creation_date": 1423959076, "question_id": 28521723, "link": "https://stackoverflow.com/questions/28521723/include-2f-in-golang-http-newrequest", "title": "Include %2F in golang http.NewRequest", "body": "<p>When I try and include a \"/\" by using %2F in http.NewRequest, it converts it back into \"/\" when it calls url.Parse(). Is there any way to prevent this? I tried converting the percent to %25, but it still doesn't work.</p>\n\n<p>You can see it here:\n<a href=\"http://play.golang.org/p/YOnktREbbf\" rel=\"nofollow\">http://play.golang.org/p/YOnktREbbf</a></p>\n"}, {"tags": ["go", "programming-languages"], "answers": [{"tags": [], "owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "is_accepted": true, "score": 0, "last_activity_date": 1424116215, "creation_date": 1424116215, "answer_id": 28549254, "question_id": 28519659, "link": "https://stackoverflow.com/questions/28519659/go-lang-mysql-html-comments/28549254#28549254", "title": "Go Lang mysql html comments", "body": "<p>If I understand your question correctly, you are looking for a way to create dynamic webpages that have user input.  You are going to need to learn some HTML/CSS to make it look nice (Even if you do use templates you can find online).</p>\n\n<p>In terms of generating the dynamic content, Golang provides a builtin templating library [<a href=\"http://golang.org/pkg/text/template/]\" rel=\"nofollow\">http://golang.org/pkg/text/template/]</a>.  Or if you like, you can look into other templating languages like Mustache or Handlebars, which have libraries in Go if you want to go that route.</p>\n\n<p>For collecting user input, you're going to want to create a form that POSTs the data to a particular endpoint of your server.  In making your server, I would look into both Golang's net/http package, which is fully featured, or you could look into Gorilla, another Go library that has a lot of nice features for making more powerful webapps and such.</p>\n\n<p>A couple resources for you to check out:</p>\n\n<p><a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow\">https://golang.org/doc/articles/wiki/</a>\n<a href=\"http://www.gorillatoolkit.org/\" rel=\"nofollow\">http://www.gorillatoolkit.org/</a></p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "is_accepted": false, "score": 0, "last_activity_date": 1424116579, "creation_date": 1424116579, "answer_id": 28549338, "question_id": 28519659, "link": "https://stackoverflow.com/questions/28519659/go-lang-mysql-html-comments/28549338#28549338", "title": "Go Lang mysql html comments", "body": "<p>Thanks I have understanding to do this with php and html I'm just trying to translate over too go Lang for the submitting and rendering out from mysql. I will look at creating a simple go form using the template engine. </p>\n"}], "owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 28549254, "answer_count": 2, "score": -2, "last_activity_date": 1424116579, "creation_date": 1423943731, "question_id": 28519659, "link": "https://stackoverflow.com/questions/28519659/go-lang-mysql-html-comments", "title": "Go Lang mysql html comments", "body": "<p>I would like to create a mysql form for comments and display them as well in html. \nI am able to use the MySQL package to read out data in the terminal but am struggling to output on the html/template engine any pointers welcome. </p>\n"}, {"tags": ["linux", "go"], "answers": [{"comments": [{"owner": {"reputation": 5021, "user_id": 48736, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0a8e69733ea25111666ecf580096338a?s=128&d=identicon&r=PG", "display_name": "Unknown", "link": "https://stackoverflow.com/users/48736/unknown"}, "edited": false, "score": 0, "creation_date": 1423988310, "post_id": 28521274, "comment_id": 45364548, "body": "I actually thought this would work, but it seems <code>err</code> can&#39;t be converted to <code>syscall.Errno</code> :(  See my updated question."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 5021, "user_id": 48736, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0a8e69733ea25111666ecf580096338a?s=128&d=identicon&r=PG", "display_name": "Unknown", "link": "https://stackoverflow.com/users/48736/unknown"}, "edited": false, "score": 0, "creation_date": 1423995908, "post_id": 28521274, "comment_id": 45366109, "body": "@Unknown That&#39;s strange. Can you tell me what <code>fmt.Printf(&quot;%T&quot;, err)</code>  says? What platform are you on?"}, {"owner": {"reputation": 5021, "user_id": 48736, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0a8e69733ea25111666ecf580096338a?s=128&d=identicon&r=PG", "display_name": "Unknown", "link": "https://stackoverflow.com/users/48736/unknown"}, "edited": false, "score": 0, "creation_date": 1423996090, "post_id": 28521274, "comment_id": 45366144, "body": "You can see it in the output above, <code>err</code> is an <code>*os.PathError</code>. I&#39;m on Linux amd64."}, {"owner": {"reputation": 5021, "user_id": 48736, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0a8e69733ea25111666ecf580096338a?s=128&d=identicon&r=PG", "display_name": "Unknown", "link": "https://stackoverflow.com/users/48736/unknown"}, "edited": false, "score": 0, "creation_date": 1423999005, "post_id": 28521274, "comment_id": 45366832, "body": "It works, but please fully update your example before I accept your answer (i.e. convert err to <code>os.PathError</code> and use <code>errno.Err</code>) so that it&#39;s correct if anyone else needs this."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 4, "last_activity_date": 1424000506, "last_edit_date": 1424000506, "creation_date": 1423954915, "answer_id": 28521274, "question_id": 28519245, "link": "https://stackoverflow.com/questions/28519245/getting-errno-after-a-write-operation/28521274#28521274", "title": "Getting errno after a write operation", "body": "<p>File operations generally return an <a href=\"http://golang.org/pkg/os/#PathError\" rel=\"nofollow\"><code>*os.PathError</code></a>; cast <code>err</code> to <code>os.PathError</code> and use the <code>Err</code> field to examine the underlying cause, like this:</p>\n\n<pre><code>patherr, ok := err.(*os.PathError)\nif ok &amp;&amp; patherr.Err == syscall.ENOSPC {\n    log.Println(\"Out of disk space!\")\n}\n</code></pre>\n"}], "owner": {"reputation": 5021, "user_id": 48736, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0a8e69733ea25111666ecf580096338a?s=128&d=identicon&r=PG", "display_name": "Unknown", "link": "https://stackoverflow.com/users/48736/unknown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 28521274, "answer_count": 1, "score": 6, "last_activity_date": 1424000506, "creation_date": 1423941304, "last_edit_date": 1423988257, "question_id": 28519245, "link": "https://stackoverflow.com/questions/28519245/getting-errno-after-a-write-operation", "title": "Getting errno after a write operation", "body": "<p>I have the following Go code which will eventually fill the disk and fail with <code>ENOSPC</code> (just a proof of concept). How can I determine from the <code>err</code> returned by <code>os.Write</code> that it indeed failed because of <code>ENOSPC</code> (so I need a way to grab <code>errno</code> after the write operation) ?</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    fd, _ := os.Create(\"dump.txt\")\n\n    defer fd.Close()\n\n    for {\n        buf := make([]byte, 1024)\n\n        _, err := fd.Write(buf)\n        if err != nil {\n            log.Fatalf(\"%T %v\", err, err)\n        }\n    }\n}\n</code></pre>\n\n<p><strong>EDIT</strong>: Updated the program as @FUZxxl suggested:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"syscall\"\n)\n\nfunc main() {\n    fd, _ := os.Create(\"dump.txt\")\n\n    defer fd.Close()\n\n    for {\n        buf := make([]byte, 1024)\n\n        _, err := fd.Write(buf)\n        if err != nil {\n\n            log.Printf(\"%T %v\\n\", err, err)\n            errno, ok := err.(syscall.Errno)\n\n            if ok {\n                log.Println(\"type assert ok\")\n                if errno == syscall.ENOSPC {\n                    log.Println(\"got ENOSPC\")\n                }\n            } else {\n                log.Println(\"type assert not ok\")\n            }\n            break\n        }\n    }\n}\n</code></pre>\n\n<p>However, I'm not getting the expected result. Here is the output:</p>\n\n<pre><code>2015/02/15 10:13:27 *os.PathError write dump.txt: no space left on device\n2015/02/15 10:13:27 type assert not ok\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 2, "creation_date": 1423935073, "post_id": 28517915, "comment_id": 45353508, "body": "Are you doing anything else between those two <code>ls</code> invocations? Like editing a Go source file in some editor?  If so then, do you have the <a href=\"https://github.com/nsf/gocode\" rel=\"nofollow noreferrer\">gocode</a> daemon running with the <code>-autobuild</code> flag? It may be launched by whatever Go editor you are using."}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1423961289, "post_id": 28517915, "comment_id": 45360553, "body": "Sublime (when I used to use it) did this to me all the time.  Are you using Sublime by chance?  If so, you have to close the editor before deleting the file."}, {"owner": {"reputation": 570, "user_id": 1093299, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cc1e335ed1e6094cb45f745d978cfb91?s=128&d=identicon&r=PG", "display_name": "Haibin Liu", "link": "https://stackoverflow.com/users/1093299/haibin-liu"}, "edited": false, "score": 0, "creation_date": 1424008355, "post_id": 28517915, "comment_id": 45369157, "body": "Oh yes. I&#39;m using sublime. Sublime was the culprit. Why would it do it?"}], "answers": [{"tags": [], "owner": {"reputation": 1972, "user_id": 2981535, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/qegDI.jpg?s=128&g=1", "display_name": "amahfouz", "link": "https://stackoverflow.com/users/2981535/amahfouz"}, "is_accepted": false, "score": 0, "last_activity_date": 1424045385, "creation_date": 1424045385, "answer_id": 28532804, "question_id": 28517915, "link": "https://stackoverflow.com/questions/28517915/successfully-delete-stringutil-a-but-it-comes-back-on-its-own/28532804#28532804", "title": "Successfully delete stringutil.a but it comes back on its own", "body": "<p>You need to delete the stringutil.go source file that is under the src tree. The *.a file is a binary file which results from the compilation (and possibly linking) of source files.</p>\n"}], "owner": {"reputation": 570, "user_id": 1093299, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cc1e335ed1e6094cb45f745d978cfb91?s=128&d=identicon&r=PG", "display_name": "Haibin Liu", "link": "https://stackoverflow.com/users/1093299/haibin-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424045385, "creation_date": 1423933042, "question_id": 28517915, "link": "https://stackoverflow.com/questions/28517915/successfully-delete-stringutil-a-but-it-comes-back-on-its-own", "title": "Successfully delete stringutil.a but it comes back on its own", "body": "<p>I'm following \"How to Write Go Code\" and tries to delete stringutil.a under $GOPATH/pkg/darwin_amd64/github.com/user. The delete is successful but the file comes back on its own. I'm confused. What is happening?</p>\n\n<pre><code>zps-MacBook-Air:haibin haibin$ rm stringutil.a\nzps-MacBook-Air:haibin haibin$ ls -lah\ntotal 0\ndrwxr-xr-x   2 haibin  staff    68B Feb 15 00:57 .\ndrwxr-xr-x  17 haibin  staff   578B Feb 15 00:39 ..\nzps-MacBook-Air:haibin haibin$ ls -lah\ntotal 8\ndrwxr-xr-x   3 haibin  staff   102B Feb 15 00:57 .\ndrwxr-xr-x  17 haibin  staff   578B Feb 15 00:39 ..\n-rw-r--r--   1 haibin  wheel   2.4K Feb 15 00:57 stringutil.a\n</code></pre>\n"}, {"tags": ["regex", "perl", "go"], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1423933656, "post_id": 28517871, "comment_id": 45353105, "body": "Good! Big thanks you! Answer was very close)) could you tell me why everywhere there is Perl word. How Perl is related to regexp?"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 1, "creation_date": 1423980143, "post_id": 28517871, "comment_id": 45363437, "body": "@TimurFayzrakhmanov &quot;Perl Compatible Regular Expressions (PCRE) is a regular expression C library inspired by the regular expression capabilities in the Perl programming language, written by Philip Hazel, starting in summer 1997.[1] PCRE&#39;s syntax is much more powerful and flexible than either of the POSIX regular expression flavors and many classic regular expression libraries. The name is misleading, because PCRE and Perl each have capabilities not shared by the other.&quot; From <a href=\"http://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions</a>"}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1423988216, "post_id": 28517871, "comment_id": 45364531, "body": "Great!) Very good answer, thank you)"}, {"owner": {"reputation": 1518, "user_id": 3523627, "user_type": "registered", "profile_image": "https://graph.facebook.com/22415571/picture?type=large", "display_name": "Palu Macil", "link": "https://stackoverflow.com/users/3523627/palu-macil"}, "edited": false, "score": 0, "creation_date": 1478003740, "post_id": 28517871, "comment_id": 67973490, "body": "Of note, Go does NOT use PCRE. They prefer to promise better performance in exchange for no backtracking. You can use PCRE packages, but not from the standard library."}], "tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": true, "score": 2, "last_activity_date": 1423934069, "last_edit_date": 1423934069, "creation_date": 1423932759, "answer_id": 28517871, "question_id": 28517788, "link": "https://stackoverflow.com/questions/28517788/where-can-i-find-all-golang-regexp-specifications/28517871#28517871", "title": "Where can I find all Golang regexp specifications?", "body": "<p>The official documentation is <a href=\"http://golang.org/pkg/regexp/syntax/\" rel=\"nofollow\">http://golang.org/pkg/regexp/syntax/</a></p>\n\n<p>Perl in particular is a programming language. From the Wikipedia entry on Perl: </p>\n\n<blockquote>\n  <p>Perl 5 gained widespread popularity in the late 1990s as a\u00a0CGI scripting\u00a0language, in part due to its unsurpassed\u00a0regular expression\u00a0and\u00a0string\u00a0parsing\u00a0abilities.</p>\n</blockquote>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "closed_date": 1423932692, "accepted_answer_id": 28517871, "answer_count": 1, "score": 0, "last_activity_date": 1423934069, "creation_date": 1423932224, "question_id": 28517788, "link": "https://stackoverflow.com/questions/28517788/where-can-i-find-all-golang-regexp-specifications", "closed_reason": "Duplicate", "title": "Where can I find all Golang regexp specifications?", "body": "<p>I try to find all in one golang regexp rules/specification/accepted syntax. However as it turned out - it's not simple task. There is some resource I've found:</p>\n\n<ul>\n<li><a href=\"https://code.google.com/p/re2/wiki/Syntax\" rel=\"nofollow\">https://code.google.com/p/re2/wiki/Syntax</a> (link from regexp package)</li>\n<li><a href=\"https://regex-golang.appspot.com/assets/html/index.html\" rel=\"nofollow\">https://regex-golang.appspot.com/assets/html/index.html</a></li>\n<li><a href=\"https://github.com/StefanSchroeder/Golang-Regex-Tutorial/blob/master/01-chapter1.markdown\" rel=\"nofollow\">https://github.com/StefanSchroeder/Golang-Regex-Tutorial/blob/master/01-chapter1.markdown</a></li>\n</ul>\n\n<p>There first one it is almost what I need, but there is so many complicated moments where I just doesn't understand what's going on (no legenda and no explanations - only for those who already know something). See some examples below:</p>\n\n<pre><code>\\d  Perl character class #what does it have with Perl?\n[[:name:]]  named ASCII class inside character class (\u2261 [:name:])\n</code></pre>\n\n<p>Could anybody help me?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2695, "user_id": 268668, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MzzMm.jpg?s=128&g=1", "display_name": "Darek", "link": "https://stackoverflow.com/users/268668/darek"}, "edited": false, "score": 0, "creation_date": 1423928209, "post_id": 28516864, "comment_id": 45351537, "body": "have you seen <a href=\"http://golang.org/pkg/archive/tar/#Header\" rel=\"nofollow noreferrer\">golang.org/pkg/archive/tar/#Header</a>. There is user and group field in the header. Maybe you should fill  them with the current user."}], "answers": [{"tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": true, "score": 3, "last_activity_date": 1423931905, "last_edit_date": 1423931905, "creation_date": 1423931550, "answer_id": 28517678, "question_id": 28516864, "link": "https://stackoverflow.com/questions/28516864/golang-file-extracted-from-tar-throws-permissions-error/28517678#28517678", "title": "Golang: file extracted from tar throws permissions error", "body": "<p>You're not preserving the original permissions of the file. You're manually creating a header, and specifying only the name and size.  Instead, use <a href=\"http://golang.org/pkg/archive/tar/#FileInfoHeader\" rel=\"nofollow\"><code>tar.FileInfoHeader</code></a> to build the header.</p>\n\n<pre><code>package main\n\nimport (\n    \"archive/tar\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    c, err := os.Create(\"/path/to/tar/file/test.tar\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    tw := tar.NewWriter(c)\n\n    f, err := os.Open(\"sample.txt\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    fi, err := f.Stat()\n    if err != nil {\n        log.Fatalln(err)\n    }\n    // create header from FileInfo\n    hdr, err := tar.FileInfoHeader(fi, \"\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n    if err := tw.WriteHeader(hdr); err != nil {\n        log.Fatalln(err)\n    }\n    // instead of reading the whole file into memory, prefer io.Copy\n    r, err := io.Copy(tw, f)\n    if err != nil {\n        log.Fatalln(err)\n    }\n    log.Printf(\"Wrote %d bytes\\n\", r)\n}\n</code></pre>\n\n<p>Also note that I used <code>io.Copy</code> to copy data from the file (an <code>io.Reader</code>) to the tar writer (an <code>io.Writer</code>).  This will work much better for larger files.</p>\n\n<p>Also - pay special attention to this note from the docs:</p>\n\n<blockquote>\n  <p>Because os.FileInfo's Name method returns only the base name of the file it describes, it may be necessary to modify the Name field of the returned header to provide the full path name of the file.</p>\n</blockquote>\n\n<p>In this simple example, you're just using <em>sample.txt</em> so you shouldn't run into trouble.  If you wanted to preserve a directory structure in your tar, you may have to modify the <code>Name</code> field in the header.</p>\n"}], "owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 28517678, "answer_count": 1, "score": 1, "last_activity_date": 1423931905, "creation_date": 1423926046, "question_id": 28516864, "link": "https://stackoverflow.com/questions/28516864/golang-file-extracted-from-tar-throws-permissions-error", "title": "Golang: file extracted from tar throws permissions error", "body": "<p>I've written the following code to tar a file, code works but strangely if I untar the archive the file permissions are gone so I can't read it unless I then chmod the file:</p>\n\n<pre><code>package main\n\nimport (\n    \"archive/tar\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n\n    c, err := os.Create(\"/path/to/tar/file/test.tar\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    tw := tar.NewWriter(c)\n\n    f, err := os.Open(\"sample.txt\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    fi, err := f.Stat()\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    hdr := &amp;tar.Header{Name: f.Name(),\n        Size: fi.Size(),\n    }\n    if err := tw.WriteHeader(hdr); err != nil {\n        log.Fatalln(err)\n    }\n\n    r, err := ioutil.ReadFile(\"sample.txt\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    if _, err := tw.Write(r); err != nil {\n        log.Fatalln(err)\n    }\n    if err := tw.Close(); err != nil {\n        log.Fatalln(err)\n    }\n\n}\n</code></pre>\n\n<p>Any idea what I'm doing wrong?</p>\n"}, {"tags": ["python", "c", "arrays", "variables", "go"], "comments": [{"owner": {"reputation": 1562, "user_id": 4098326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a222a6f6508bea1c3b2f97cb0234be0?s=128&d=identicon&r=PG", "display_name": "user4098326", "link": "https://stackoverflow.com/users/4098326/user4098326"}, "edited": false, "score": 0, "creation_date": 1423916816, "post_id": 28515604, "comment_id": 45348557, "body": "You can use hash tables."}, {"owner": {"reputation": 2071, "user_id": 4487530, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fe96d2385b9429a5789611d6cf143ca8?s=128&d=identicon&r=PG&f=1", "display_name": "Christo S. Christov", "link": "https://stackoverflow.com/users/4487530/christo-s-christov"}, "edited": false, "score": 0, "creation_date": 1423916835, "post_id": 28515604, "comment_id": 45348561, "body": "in the case of integers you can do array indexing"}, {"owner": {"reputation": 829, "user_id": 3810411, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49b1176f69fe5b10313cd0f45b68495b?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/3810411/francis"}, "reply_to_user": {"reputation": 1562, "user_id": 4098326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a222a6f6508bea1c3b2f97cb0234be0?s=128&d=identicon&r=PG", "display_name": "user4098326", "link": "https://stackoverflow.com/users/4098326/user4098326"}, "edited": false, "score": 0, "creation_date": 1423916836, "post_id": 28515604, "comment_id": 45348563, "body": "@user4098326 Are hash tables complicated to implement?"}, {"owner": {"reputation": 49793, "user_id": 4014959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GdqQJ.jpg?s=128&g=1", "display_name": "PM 2Ring", "link": "https://stackoverflow.com/users/4014959/pm-2ring"}, "edited": false, "score": 1, "creation_date": 1423917056, "post_id": 28515604, "comment_id": 45348620, "body": "Hash tables aren&#39;t that hard to implement in C, but it&#39;s not something I&#39;d inflict on a raw beginner. Read the <a href=\"http://en.wikipedia.org/wiki/Hash_table\" rel=\"nofollow noreferrer\">Wikipedia article</a> to get familiar with the concept. But unless you&#39;re really keen to make your own I recommend using an existing Open Source implementation."}, {"owner": {"reputation": 403, "user_id": 1002226, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/bb479f56ffc59643498464b5f277e79d?s=128&d=identicon&r=PG", "display_name": "Skaperen", "link": "https://stackoverflow.com/users/1002226/skaperen"}, "edited": false, "score": 1, "creation_date": 1423917149, "post_id": 28515604, "comment_id": 45348637, "body": "in a lot of my code i use a smaller hash table in front of a full AVL tree.  fast when a subset of lookups are more frequent or i want to use a limited size hash table (not worry about the need to grow it)."}], "answers": [{"comments": [{"owner": {"reputation": 829, "user_id": 3810411, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49b1176f69fe5b10313cd0f45b68495b?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/3810411/francis"}, "edited": false, "score": 0, "creation_date": 1423917593, "post_id": 28515626, "comment_id": 45348723, "body": "Would it be a good idea to resize the array in chunks? For example, if my array can hold 10 elements and I need an 11th element should I make the array large enough for 20 elements or 11 elements?"}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 829, "user_id": 3810411, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49b1176f69fe5b10313cd0f45b68495b?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/3810411/francis"}, "edited": false, "score": 1, "creation_date": 1423917693, "post_id": 28515626, "comment_id": 45348744, "body": "@Francis 20. Whatever method you choose, reallocate by doubling the size. It means that at most 50% of the space is wasted at any given time and it saves you from paying a price proportional to the number of existing variables each time a new variable appears."}], "tags": [], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "is_accepted": true, "score": 4, "last_activity_date": 1423917412, "last_edit_date": 1423917412, "creation_date": 1423916866, "answer_id": 28515626, "question_id": 28515604, "link": "https://stackoverflow.com/questions/28515604/efficient-array-lookup-in-c/28515626#28515626", "title": "Efficient array lookup in C", "body": "<blockquote>\n  <p>How does Python or Ruby or Go store and retrieve variables efficiently?</p>\n</blockquote>\n\n<p>Python and Ruby use <a href=\"http://en.wikipedia.org/wiki/Hash_table\" rel=\"nofollow\">hash-tables</a>: the name of the variable is translated into an integer, and that integer is used as index into an array. It can always happen that several names collide (translate to the same integer), so that needs to be taken into account by allowing several bindings from name to value at the same slot, but there will only be a few to check for each name.</p>\n\n<p>Go is compiled, so the variable is translated to an address (either static or an offset with respect to the stack\u2014or frame\u2014pointer) at compile-time.</p>\n\n<blockquote>\n  <p>what is an efficient way of creating a variable sized array?</p>\n</blockquote>\n\n<p>If you decided to do that, you would use <code>malloc</code> and <code>realloc</code>.</p>\n\n<p>In the case of resizing the array of buckets of a hash-table, <code>realloc</code> is unfortunately not useful because all the keys in the old array of buckets need to be re-hashed one by one to find where they go in the new array. If you know the maximum size of programs that will be interpreted by your interpreter, you can allocate the hash-table directly at the size that works for the largest programs, and avoid writing the hash-table resizing function.</p>\n"}, {"tags": [], "owner": {"reputation": 4916, "user_id": 3991400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5049bb61601c16ae408f5a56b5ed2518?s=128&d=identicon&r=PG&f=1", "display_name": "midor", "link": "https://stackoverflow.com/users/3991400/midor"}, "is_accepted": false, "score": 3, "last_activity_date": 1423917716, "creation_date": 1423917716, "answer_id": 28515736, "question_id": 28515604, "link": "https://stackoverflow.com/questions/28515604/efficient-array-lookup-in-c/28515736#28515736", "title": "Efficient array lookup in C", "body": "<p>I think you can get really carried away when trying to implement a variable-storage yourself. I would recommend you use an existing hashmap like <a href=\"http://troydhanson.github.io/uthash/\" rel=\"nofollow\">uthash</a> just to see how it works out for you conceptually and encapsulate it as good as possible. If it turns out to be a bottleneck, you can come back and optimize later. </p>\n\n<p>I am somewhat confident to say, that at that time, you will not pick a dynamically expanding array. You have to consider that you need to implement a string-based search to find a variable by name, so you will have a hard time doing better than a hashmap with a dynamically expanding array. Search on it would be O(n) if unsorted and O(log n) if sorted, whereas the hashmap has O(1) search complexity.</p>\n"}], "owner": {"reputation": 829, "user_id": 3810411, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49b1176f69fe5b10313cd0f45b68495b?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/3810411/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 28515626, "answer_count": 2, "score": 3, "last_activity_date": 1423917716, "creation_date": 1423916706, "question_id": 28515604, "link": "https://stackoverflow.com/questions/28515604/efficient-array-lookup-in-c", "title": "Efficient array lookup in C", "body": "<p>I'm trying to write a simple language interpreter for a custom language in C. I want to use C over C++ due to C's simplicity.</p>\n\n<p>The things I'm not sure how to do in C is, storing variables and variable lookups.</p>\n\n<p>I was planning to store variables in an array, but I think I'd need a variable sized array.</p>\n\n<p>I also don't know an efficient way to lookup variables from an array besides just looping through it.</p>\n\n<p>So I'd like to know, what is an efficient way of creating a variable sized array? How does Python or Ruby or Go store and retrieve variables efficiently?</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423924901, "post_id": 28514046, "comment_id": 45350624, "body": "Don&#39;t try to write this kind of functions in Go. They are complicated to write, slow in execution and usually not nearly as useful as you think."}, {"owner": {"reputation": 11711, "user_id": 1018582, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18789a2f20eee6dfe637fef8bd7ebf5?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1018582/alasdair"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1423929751, "post_id": 28514046, "comment_id": 45351943, "body": "@FUZxxl, what do you mean, don&#39;t do it? I have to perform this action - it is for a real-world application, written in Go and it needs to do exactly this. I could do it without <code>interface{}</code> like above every time, but it would mean copy and pasting and modifying that code hundreds of times. What do you suggest?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1423932859, "post_id": 28514046, "comment_id": 45352891, "body": "@Alasdair you could make a generic function that only stores <code>interface{}</code>, and when you read from this list convert it to whatever it is you&#39;ve stored into it. that&#39;s for example how Go&#39;s standard library&#39;s linked list package works."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1423933152, "post_id": 28514046, "comment_id": 45352969, "body": "@Alasdair Is the type in the slice different each time? Inserting a value into the middle of a slice is an O(<i>n</i>) operation; you might want to consider a different data structure when this is a very common operation."}], "answers": [{"comments": [{"owner": {"reputation": 11711, "user_id": 1018582, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18789a2f20eee6dfe637fef8bd7ebf5?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1018582/alasdair"}, "edited": false, "score": 0, "creation_date": 1423993857, "post_id": 28518946, "comment_id": 45365662, "body": "The reason I didn&#39;t use append is because I am assuming that it would slow down the growth seeing as I need to copy it in two parts: everything before the insert index and eveything after. Append would copy all of it, which I would then copy again. I was attempting to avoid two copies of the entire slice. Though I&#39;m not certain this is more efficient as append may be faster if it is not compiled from Go source - but in theory what I am doing is faster than using append."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1423939428, "creation_date": 1423939428, "answer_id": 28518946, "question_id": 28514046, "link": "https://stackoverflow.com/questions/28514046/golang-how-to-use-interface-type-to-insert-a-value-into-the-middle-of-a-slice/28518946#28518946", "title": "Golang: how to use interface{} type to insert a value into the middle of a slice?", "body": "<p>The whole \"grow if at capactiy\" code is unnecessary; use the built-in <code>append</code> &ndash; it does exactly that for you.</p>\n\n<p>Change the signature to:</p>\n\n<pre><code>func insert(ar interface{}, val interface{}, i int) interface{}\n</code></pre>\n\n<p>Then check that <code>ar</code> is a slice and that the element type of <code>ar</code> is the same type as <code>val</code>:</p>\n\n<pre><code>at, vt := reflect.TypeOf(ar), reflect.Typeof(val)\n\nif at.Kind() != reflect.Slice {\n    panic(fmt.Sprintf(\"expected slice, got %T\", at))\n}\n\nif at.Elem() != vt {\n    panic(\"first argument must be a slice of the second argument's type\")\n}\n</code></pre>\n\n<p>After type validation, get a hold of some <code>reflect.Value</code>s:</p>\n\n<pre><code>av, vv := reflect.ValueOf(ar), reflect.ValueOf(val)\n</code></pre>\n\n<p>And get moving stuff around using e.g:</p>\n\n<ul>\n<li><code>(reflect.Value).Index(int)</code> to access element of the slice.</li>\n<li><code>reflect.Copy</code> to copy to and from slices \u00e0 la built-in <code>copy</code></li>\n<li><code>reflect.Append</code> to append to a slice <code>Value</code></li>\n<li><code>(reflect.Value).Set(reflect.Value)</code> to set the value of a settable element (something you got out of a slice, for instance).</li>\n<li><code>reflect.Append</code> or <code>reflect.AppendSlice</code> to append to a slice \u00e0 la built-in <code>append</code>.</li>\n</ul>\n\n<p>Once you have your final <code>reflect.Value</code> representing the result slice; return it as an <code>interface{}</code> like this:</p>\n\n<pre><code>return result.Interface()\n</code></pre>\n"}], "owner": {"reputation": 11711, "user_id": 1018582, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18789a2f20eee6dfe637fef8bd7ebf5?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1018582/alasdair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1750, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1423939428, "creation_date": 1423904380, "question_id": 28514046, "link": "https://stackoverflow.com/questions/28514046/golang-how-to-use-interface-type-to-insert-a-value-into-the-middle-of-a-slice", "title": "Golang: how to use interface{} type to insert a value into the middle of a slice?", "body": "<p>I'm having difficulty getting my head around the usage of <code>interface{}</code> types with Go.</p>\n\n<p>In this instance I have a function which inserts a value into the middle of a slice somewhere. It looks like this:</p>\n\n<pre><code>type mystruct {\n    a, b, c int\n}\n\nfunc insert(ar []mystruct, val mystruct, i int) []mystruct {\n    l := len(ar)\n    if l == cap(ar) {\n        tmp := make([]mystruct, l + 1, (l * 2) + 1)\n        copy(tmp, ar[0:i])\n        copy(tmp[i+1:], ar[i:])\n        ar = tmp\n    } else {\n        ar = ar[0:l+1]\n        copy(ar[i+1:], ar[i:])\n    }\n    ar[i] = val\n\n    return ar\n}\n</code></pre>\n\n<p>I'd like for that function to be able to accept <code>interface{}</code> for both <code>ar</code> and <code>val</code> so that I could pass it a slice and value of any type and it would perform the insert without complaint.</p>\n\n<p>From what I have read so far I believe this should be done with the <code>reflect</code> package. I have read the Rules of Reflection and various tutorials on reflection and <code>interface{}</code>, but I'm not sure how to approach this. I'd like to minimize overhead as much as possible, I understand reflection is going to slow the code down a bit but what is the most efficient way of doing this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "zip"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423925001, "post_id": 28513486, "comment_id": 45350652, "body": "It looks like this isn&#39;t supported. You might want to file a feature-request for this feature to be supported."}, {"owner": {"reputation": 194, "user_id": 4176793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd73e9bbda949cdcc460ef4ea257a18?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind at Vembu", "link": "https://stackoverflow.com/users/4176793/aravind-at-vembu"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1424065172, "post_id": 28513486, "comment_id": 45384631, "body": "Any recommendations for working with zip files in GoLang other than the native archive/zip package on my requirement?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1424065732, "post_id": 28513486, "comment_id": 45384772, "body": "Invoke the <code>zip</code> command line utility."}, {"owner": {"reputation": 194, "user_id": 4176793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd73e9bbda949cdcc460ef4ea257a18?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind at Vembu", "link": "https://stackoverflow.com/users/4176793/aravind-at-vembu"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1424073594, "post_id": 28513486, "comment_id": 45387746, "body": "Invoking zip command line util is not preferred. Because, I am trying to do all the stuff within the application and want to avoid any dependency of 3rd party tools.  Also, my app is running on multiple OSes and I am reluctant to keep the different tools for this requirement. Is there better alternative to built in archive/zip package?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1424077789, "post_id": 28513486, "comment_id": 45389741, "body": "Not that I know of. You might want to write your own bindings to an existing zip library."}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 4176793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd73e9bbda949cdcc460ef4ea257a18?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind at Vembu", "link": "https://stackoverflow.com/users/4176793/aravind-at-vembu"}, "is_accepted": true, "score": 4, "last_activity_date": 1424257069, "last_edit_date": 1495541841, "creation_date": 1424257069, "answer_id": 28581886, "question_id": 28513486, "link": "https://stackoverflow.com/questions/28513486/how-add-a-file-to-an-existing-zip-file-using-golang/28581886#28581886", "title": "How add a file to an existing zip file using Golang", "body": "<p>After more analysis, i found that, it is not possible to add any files with the existing zip file.</p>\n\n<p>But, I was able to add files with tar file by following the hack given in <a href=\"https://stackoverflow.com/questions/18323995/golang-append-file-to-an-existing-tar-archive\">this</a> URL.</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 9362398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "brun", "link": "https://stackoverflow.com/users/9362398/brun"}, "is_accepted": false, "score": 1, "last_activity_date": 1537305382, "creation_date": 1537305382, "answer_id": 52394699, "question_id": 28513486, "link": "https://stackoverflow.com/questions/28513486/how-add-a-file-to-an-existing-zip-file-using-golang/52394699#52394699", "title": "How add a file to an existing zip file using Golang", "body": "<p>Although I have not attempted this yet with a zip file that already exists and then writing to it, I believe you should be able to add files to it.</p>\n\n<p>This is code I have written to create a conglomerate zip file containing multiple files in order to expedite uploading the data to another location.  I hope it helps!</p>\n\n<pre><code>type fileData struct {\n    Filename string\n    Body     []byte\n}\n\nfunc main() {\n    outputFilename := \"path/to/file.zip\"\n\n    // whatever you want as filenames and bodies\n    fileDatas := createFileDatas()\n\n    // create zip file\n    conglomerateZip, err := os.Create(outputFilename)\n    if err != nil {\n        return err\n    }\n    defer conglomerateZip.Close()\n\n    zipWriter := zip.NewWriter(conglomerateZip)\n    defer zipWriter.Close()\n\n    // populate zip file with multiple files\n    err = populateZipfile(zipWriter, fileDatas)\n    if err != nil {\n        return err\n    }\n\n}\n\nfunc populateZipfile(w *zip.Writer, fileDatas []*fileData) error {\n    for _, fd := range fileDatas {\n        f, err := w.Create(fd.Filename)\n        if err != nil {\n            return err\n        }\n\n        _, err = f.Write([]byte(fd.Body))\n        if err != nil {\n            return err\n        }\n\n        err = w.Flush()\n        if err != nil {\n            return err\n        }\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 4986798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625e6675083855baac5405d6c88af52d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4986798/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1574691664, "creation_date": 1574691664, "answer_id": 59033919, "question_id": 28513486, "link": "https://stackoverflow.com/questions/28513486/how-add-a-file-to-an-existing-zip-file-using-golang/59033919#59033919", "title": "How add a file to an existing zip file using Golang", "body": "<p>This is a bit old and already has an answer, but if performance isn't a key concern for you (making the zip file isn't on a hot path for example) you <em>can</em> do this with the archive/zip library by creating a new writer and copying the existing files into it then adding your new content. Something like this:</p>\n\n<pre><code>zw := // new zip writer from buffer or temp file\nnewFileName := // file name to add\nreader, _ := zip.NewReader(bytes.NewReader(existingFile), int64(len(existingFile)))\nfor _, file := range reader.File {\n    if file.Name == newFileName {\n        continue // don't copy the old file over to avoid duplicates\n    }\n    fw, _ := zw.Create(file.Name)\n    fr, _ := file.Open()\n    io.Copy(fw, fr)\n    fr.Close()\n}\n</code></pre>\n\n<p>Then you would return the new writer and append files as needed. If you aren't sure which files might overlap you can turn that if check into a function with a list of file names you will eventually add. You can also use this logic to remove a file from an existing archive.</p>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 12073333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb32cbda4eac42cad251cfb11e2837e0?s=128&d=identicon&r=PG&f=1", "display_name": "wongoo", "link": "https://stackoverflow.com/users/12073333/wongoo"}, "is_accepted": false, "score": 1, "last_activity_date": 1586745988, "creation_date": 1586745988, "answer_id": 61180845, "question_id": 28513486, "link": "https://stackoverflow.com/questions/28513486/how-add-a-file-to-an-existing-zip-file-using-golang/61180845#61180845", "title": "How add a file to an existing zip file using Golang", "body": "<p>you can:</p>\n\n<ol>\n<li>copy old zip items into a new zip file;</li>\n<li>add new files into the new zip file;</li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>zipReader, err := zip.OpenReader(zipPath)\ntargetFile, err := os.Create(targetFilePath)\ntargetZipWriter := zip.NewWriter(targetFile)\n\nfor _, zipItem := range zipReader.File {\n    zipItemReader, err := zipItem.Open()\n    header, err := zip.FileInfoHeader(zipItem.FileInfo())\n    header.Name = zipItem.Name\n    targetItem, err := targetZipWriter.CreateHeader(header)\n    _, err = io.Copy(targetItem, zipItemReader)\n}\n\naddNewFiles(targetZipWriter) // IMPLEMENT YOUR LOGIC\n</code></pre>\n"}], "owner": {"reputation": 194, "user_id": 4176793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd73e9bbda949cdcc460ef4ea257a18?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind at Vembu", "link": "https://stackoverflow.com/users/4176793/aravind-at-vembu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3474, "favorite_count": 0, "accepted_answer_id": 28581886, "answer_count": 4, "score": 7, "last_activity_date": 1586745988, "creation_date": 1423898818, "question_id": 28513486, "link": "https://stackoverflow.com/questions/28513486/how-add-a-file-to-an-existing-zip-file-using-golang", "title": "How add a file to an existing zip file using Golang", "body": "<p>We can create a zip new file and add files using Go Language.</p>\n\n<p>But, how to add a new file with existing zip file using GoLang?</p>\n\n<p>If we can use Create function, how to get the zip.writer reference?</p>\n\n<p>Bit confused.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2782, "user_id": 1822711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be72f7002ddb309d9b01bb6aea680b0d?s=128&d=identicon&r=PG", "display_name": "Joe Bergevin", "link": "https://stackoverflow.com/users/1822711/joe-bergevin"}, "edited": false, "score": 2, "creation_date": 1423952206, "post_id": 28512532, "comment_id": 45358523, "body": "And here&#39;s a great post about slices that could prove helpful: <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 17, "last_activity_date": 1599812597, "last_edit_date": 1599812597, "creation_date": 1423889269, "answer_id": 28512532, "question_id": 28512432, "link": "https://stackoverflow.com/questions/28512432/what-is-the-meaning-of-type-in-go/28512532#28512532", "title": "What is the meaning of &quot;...Type&quot; in Go?", "body": "<p>The code in builtin.go serves as documentation. The code is not compiled.</p>\n<p>The <code>...</code> specifies that the final parameter of the function is variadic.  Variadic functions are <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"noreferrer\">documented in the Go Language specification</a>. In short, variadic functions can be called with any number of arguments for the final parameter.</p>\n<p>The <a href=\"http://godoc.org/builtin#Type\" rel=\"noreferrer\">Type</a> part is a stand-in for any Go type.</p>\n"}], "owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11243, "favorite_count": 1, "accepted_answer_id": 28512532, "answer_count": 1, "score": 13, "last_activity_date": 1599812597, "creation_date": 1423888142, "last_edit_date": 1553276977, "question_id": 28512432, "link": "https://stackoverflow.com/questions/28512432/what-is-the-meaning-of-type-in-go", "title": "What is the meaning of &quot;...Type&quot; in Go?", "body": "<p>This code is in <code>builti.go</code>:</p>\n\n<pre><code>// The append built-in function appends elements to the end of a slice. If\n// it has sufficient capacity, the destination is resliced to accommodate the\n// new elements. If it does not, a new underlying array will be allocated.\n// Append returns the updated slice. It is therefore necessary to store the\n// result of append, often in the variable holding the slice itself:\n//  slice = append(slice, elem1, elem2)\n//  slice = append(slice, anotherSlice...)\n// As a special case, it is legal to append a string to a byte slice, like this:\n//  slice = append([]byte(\"hello \"), \"world\"...)\nfunc append(slice []Type, elems ...Type) []Type\n</code></pre>\n\n<p>The last line made me feel very confused. I do not know the meaning of <code>...Type</code> .</p>\n\n<p>These are other codes:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n   s := []int{1,2,3,4,5}\n   s1 := s[:2]\n   s2 := s[2:]\n   s3 := append(s1, s2...)\n   fmt.Println(s1, s2, s3)\n}\n</code></pre>\n\n<p>The result is</p>\n\n<pre><code>[1 2] [3 4 5] [1 2 3 4 5]\n</code></pre>\n\n<p>I guess the function of <code>...</code> is to pick all elements from <code>elems</code>, but I haven't found an official explanation. What is it?</p>\n"}, {"tags": ["git", "go", "pathing"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1423874065, "post_id": 28510180, "comment_id": 45340946, "body": "Bummer. Then maybe check out <code>&#47;myname&#47;appname</code> into <code>$GOPATH&#47;src&#47;orgname&#47;appname</code> (or whatever path corresponds to the master URL), and do your work there. If you need to work with multiple forks, switch GOPATHs or swap them out via mv, etc."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1423874132, "post_id": 28510180, "comment_id": 45340965, "body": "The flow sucks a little then (at a minimum, you can&#39;t just use &quot;go get&quot; anymore) but if your team mandates you work on forks I don&#39;t see anything better. Maybe someone&#39;ll answer with something better, though."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423874860, "post_id": 28510180, "comment_id": 45341123, "body": "See <a href=\"https://splice.com/blog/contributing-open-source-git-repositories-go/\" rel=\"nofollow noreferrer\">splice.com/blog/contributing-open-source-git-repositories-go</a>"}, {"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "edited": false, "score": 0, "creation_date": 1424378897, "post_id": 28510180, "comment_id": 45536225, "body": "Yeah checking out my fork into the file path relating to the main fork fixed it. Good idea."}], "answers": [{"comments": [{"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "edited": false, "score": 0, "creation_date": 1424373090, "post_id": 28511084, "comment_id": 45532858, "body": "Yes! This is it. Even though my forked version has a different path, I can ignore that by simply building the file structure that complies with the import paths. Good answer (your first suggestion worked smoothly)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "is_accepted": true, "score": 2, "last_activity_date": 1423874231, "creation_date": 1423874231, "answer_id": 28511084, "question_id": 28510180, "link": "https://stackoverflow.com/questions/28510180/is-there-a-way-to-have-reusable-pathing-for-imports-on-go-projects/28511084#28511084", "title": "Is there a way to have reusable pathing for imports on Go projects?", "body": "<p>Assuming that GOPATH contains a single element, do this:</p>\n\n<pre><code>$ mkdir -p $GOPATH/github.teamName.com/teamMemberA\n$ cd $GOPATH/github.teamName.com/teamMemberA\n$ git clone github.teamName.com/myName/HeartThrob\n$ cd HeartThrob/c\n$ go install\n</code></pre>\n\n<p>An alternative approach is:</p>\n\n<pre><code>$ go get github.teamName.com/teamMemberA/HeartThrob/c\n$ cd $GOPATH/github.teamName.com/teamMemberA/HeartThrob\n$ git remote add fork git@github.myName/HeartThrob.git\n</code></pre>\n\n<p>Hack a way and push to fork.</p>\n"}], "owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 28511084, "answer_count": 1, "score": 2, "last_activity_date": 1423874231, "creation_date": 1423868244, "last_edit_date": 1423869374, "question_id": 28510180, "link": "https://stackoverflow.com/questions/28510180/is-there-a-way-to-have-reusable-pathing-for-imports-on-go-projects", "title": "Is there a way to have reusable pathing for imports on Go projects?", "body": "<p>I am very new at Go, and need a bit of help with a way to make import pathing more distributable between my team.</p>\n\n<p>Currently at the top of one of my Go files, I have an import, say \"github.teamName.com/teamMemberA/HeartThrob/c\"</p>\n\n<p>I forked his project to my own name and downloaded it and got some pretty obvious import errors. </p>\n\n<p>MY path to the file it is trying to import is the following: \"github.teamName.com/myName/HeartThrob/c\"</p>\n\n<p>This pathing change is because I am pulling the project from my own forked repo. </p>\n\n<p>What is a way I can go about fixing this? Is relative pathing possible? I can't put all the Go files into the same directory due to the size of the project and some obvious places for separation. </p>\n\n<p>Disclaimer: New to Go AND Git (My forked approach is team-mandated though)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 7, "creation_date": 1423860293, "post_id": 28508128, "comment_id": 45335857, "body": "Don&#39;t use pointers to slices in structures! Slices are already a reference."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1423860395, "post_id": 28508128, "comment_id": 45335908, "body": "%v can&#39;t magically guess what kind of output you want. If you want <code>fmt</code> output for something formatted in a specific way implement one of <code>fmt.Stringer</code> or <code>fmt.Formatter</code>."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1423861053, "post_id": 28508128, "comment_id": 45336277, "body": "Also, you may want an <code>[]X</code> instead of a <code>[]*X</code>. I wrote some about when you&#39;d use each at the bottom of <a href=\"http://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values/23551970#23551970\">this answer</a> (which, higher up, discusses what other types (besides slices) are also already references to data)."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1423867329, "post_id": 28508128, "comment_id": 45339031, "body": "You cannot do that with package fmt."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1423874985, "post_id": 28508128, "comment_id": 45341156, "body": "I recommend <a href=\"https://github.com/davecgh/go-spew\" rel=\"nofollow noreferrer\">go-spew</a> for dumping deeply nested values."}], "answers": [{"tags": [], "owner": {"reputation": 1359, "user_id": 211437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7641efe621520118d37f479da2cd8900?s=128&d=identicon&r=PG", "display_name": "jatin", "link": "https://stackoverflow.com/users/211437/jatin"}, "is_accepted": false, "score": 13, "last_activity_date": 1465865882, "last_edit_date": 1465865882, "creation_date": 1423901100, "answer_id": 28513710, "question_id": 28508128, "link": "https://stackoverflow.com/questions/28508128/what-flag-to-fmt-printf-to-follow-pointers-recursively/28513710#28513710", "title": "What flag to fmt.Printf to follow pointers recursively?", "body": "<p>I don't think fmt.Printf has the functionality you are looking for.</p>\n\n<p>You can use the <a href=\"https://github.com/davecgh/go-spew\" rel=\"noreferrer\">https://github.com/davecgh/go-spew</a> library. </p>\n\n<p><code>spew.Dump(test1)</code></p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7077, "favorite_count": 1, "answer_count": 1, "score": 12, "last_activity_date": 1465865882, "creation_date": 1423858911, "last_edit_date": 1423859797, "question_id": 28508128, "link": "https://stackoverflow.com/questions/28508128/what-flag-to-fmt-printf-to-follow-pointers-recursively", "title": "What flag to fmt.Printf to follow pointers recursively?", "body": "<p>I'm having trouble printing a struct when failing test cases. It's a pointer to a slice of pointers to structs, or <code>*[]*X</code>. The problem is that I need to know the contents of the <code>X</code>-structs inside the slice, but I cannot get it to print the whole chain. It only prints their addresses, since it's a pointer. I need it to follow the pointers.</p>\n\n<p>This is however useless since the function I want to test modifies their contents, and modifying the test code to not use pointers just means I'm not testing the code with pointers (so that wouldn't work).</p>\n\n<p>Also, just looping through the slice won't work, since the real function uses reflect and might handle more than one layer of pointers. </p>\n\n<p>Simplified example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    type X struct {\n        desc string\n    }\n\n    type test struct {\n        in   *[]*X\n        want *[]*X\n    }\n\n    test1 := test{\n        in: &amp;[]*X{\n            &amp;X{desc: \"first\"},\n            &amp;X{desc: \"second\"},\n            &amp;X{desc: \"third\"},\n        },\n    }\n\n    fmt.Printf(\"%#v\", test1)\n}\n</code></pre>\n\n<p>example output:</p>\n\n<pre><code>main.test{in:(*[]*main.X)(0x10436180), want:(*[]*main.X)(nil)}\n</code></pre>\n\n<p>(code is at <a href=\"http://play.golang.org/p/q8Its5l_lL\" rel=\"noreferrer\">http://play.golang.org/p/q8Its5l_lL</a> )</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 3, "creation_date": 1423857465, "post_id": 28507568, "comment_id": 45334447, "body": "The <code>GOPATH</code> variable is the location of all of your projects. It is impossible to tell you what to set this to. For example, I have my <code>GOPATH</code> set to <code>~&#47;.go</code>, while others may have it set to <code>~&#47;work&#47;go</code>, or anything else really. Though, I really suggest you look into something like <code>homebrew</code> to install the majority of things on OSX."}], "answers": [{"comments": [{"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 1, "creation_date": 1428196596, "post_id": 29453124, "comment_id": 47071733, "body": "I think suggesting that the GOPATH to be /usr/local/go is misleading."}, {"owner": {"reputation": 324, "user_id": 1398809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ea3c74ebd6f49a199961b7145f84a3?s=128&d=identicon&r=PG", "display_name": "Root Fool", "link": "https://stackoverflow.com/users/1398809/root-fool"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1428197044, "post_id": 29453124, "comment_id": 47071812, "body": "Yeah totally, I don&#39;t know why I used that in the examples. I changed it."}], "tags": [], "owner": {"reputation": 324, "user_id": 1398809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ea3c74ebd6f49a199961b7145f84a3?s=128&d=identicon&r=PG", "display_name": "Root Fool", "link": "https://stackoverflow.com/users/1398809/root-fool"}, "is_accepted": false, "score": 2, "last_activity_date": 1428198711, "last_edit_date": 1428198711, "creation_date": 1428196365, "answer_id": 29453124, "question_id": 28507568, "link": "https://stackoverflow.com/questions/28507568/how-to-set-gopath-on-mac-after-installing-go1-4-1-darwin-amd64-osx10-8-pkg/29453124#29453124", "title": "How to set GOPATH on MAC after installing go1.4.1.darwin-amd64-osx10.8.pkg", "body": "<p>GOPATH is an environmental variable used to define the location of your workplace directory. It's used by the Go tools for various reasons.</p>\n\n<p>For example:</p>\n\n<p><code>go get -u github.com/nsf/gocode</code></p>\n\n<ul>\n<li>will download the source code and place it at\n<code>$GOPATH/src/github.com/nsfs/gocode</code></li>\n<li>Compile that source code and\nplace the binary at <code>$GOPATH/bin</code> </li>\n<li>Place symbol and package information at <code>$GOPATH/pkg/architecture/github.com/nsfs</code></li>\n</ul>\n\n<p>The path is also used in other tools:</p>\n\n<ul>\n<li><code>go build github.com/nsf/gocode</code> </li>\n<li><code>go install github.com/nsfs/gocode</code></li>\n</ul>\n\n<p><code>github.com/nsfs/gocode</code> in the above commands is resolved automatically to <code>$GOPATH/src/github.com/nsfs/gocode</code> and thus you can run these commands without actually being in your workplace (the point of $GOPATH)</p>\n\n<p>The $GOPATH location for your workplace directory can be put anywhere on your machine, but it must minimally have 3 folders (because go get and other tools need these folders).</p>\n\n<ol>\n<li>bin  </li>\n<li>pkg  </li>\n<li>src</li>\n</ol>\n\n<p>This environmental variable can be set like any other environmental variable. If you're using go from the Terminal.app, you can set it by opening the file:</p>\n\n<p><code>vi ~/.bashrc</code></p>\n\n<p>and then setting it </p>\n\n<p><code>export GOPATH=~/goworkplace</code></p>\n\n<p><code>~/goworkplace</code> is a location to the workplace directory with those 3 folders. It can be anywhere on your system, such as, ~/Development/goworkplace, ~/Desktop/goworkplace, as long as it has those 3 folders</p>\n\n<p>For information, take a look at this: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">https://golang.org/doc/code.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1559795155, "creation_date": 1559795155, "answer_id": 56470883, "question_id": 28507568, "link": "https://stackoverflow.com/questions/28507568/how-to-set-gopath-on-mac-after-installing-go1-4-1-darwin-amd64-osx10-8-pkg/56470883#56470883", "title": "How to set GOPATH on MAC after installing go1.4.1.darwin-amd64-osx10.8.pkg", "body": "<p><strong>Try this</strong> </p>\n\n<p>First you can check the golang is install or not. Run <strong>go env</strong></p>\n\n<p>After that you can show the list of go env variables..</p>\n\n<p>then you check where you can install the <strong>go</strong></p>\n\n<p>after that set <strong>$GOPATH</strong> </p>\n\n<p>like:- <strong>export GOPATH=/var/projects/go</strong></p>\n\n<p>and also set <strong>$GOBIN</strong> </p>\n\n<p>like:-  <strong>export =$GOPATH/bin</strong></p>\n"}], "owner": {"reputation": 17471, "user_id": 125440, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/39fa4254c0f6a51304072805361d6991?s=128&d=identicon&r=PG", "display_name": "n179911", "link": "https://stackoverflow.com/users/125440/n179911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2603, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559795155, "creation_date": 1423856796, "question_id": 28507568, "link": "https://stackoverflow.com/questions/28507568/how-to-set-gopath-on-mac-after-installing-go1-4-1-darwin-amd64-osx10-8-pkg", "title": "How to set GOPATH on MAC after installing go1.4.1.darwin-amd64-osx10.8.pkg", "body": "<p>I have run go1.4.1.darwin-amd64-osx10.8.pkg to install go on my MAC. It install go in /usr/local/go/bin/go.</p>\n\n<p>Can you tell me what should my GOPATH set to? I tried '/usr/local/go' and '/usr/local/go/bin/go'. But both does not seem to be the right path.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27330, "user_id": 104040, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/60f28d36c1439f965e2fb55419621968?s=128&d=identicon&r=PG", "display_name": "Aiden Bell", "link": "https://stackoverflow.com/users/104040/aiden-bell"}, "edited": false, "score": 0, "creation_date": 1423935989, "post_id": 28506013, "comment_id": 45353775, "body": "So far, two opposing answers with equal votes. This might be a case-by-case thing unless Rob Pike or somebody answers :P"}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 0, "creation_date": 1423955702, "post_id": 28506013, "comment_id": 45359370, "body": "They aren&#39;t necessarily opposing answers.  I think both answers say it&#39;s fine under some circumstances.  I just tried to give more general advice beyond your example."}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 0, "creation_date": 1426004698, "post_id": 28506013, "comment_id": 46189459, "body": "You may be interested in a related video from GopherConIndia this year: <a href=\"https://www.youtube.com/watch?v=Y6KnnRh6wVo&amp;list=PLxFC1MYuNgJTY3uQ5Ja4F5Sz305nnrBOq&amp;index=14\" rel=\"nofollow noreferrer\">youtube.com/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27330, "user_id": 104040, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/60f28d36c1439f965e2fb55419621968?s=128&d=identicon&r=PG", "display_name": "Aiden Bell", "link": "https://stackoverflow.com/users/104040/aiden-bell"}, "edited": false, "score": 0, "creation_date": 1423854522, "post_id": 28506760, "comment_id": 45332932, "body": "Thanks for the reply and using examples in the Go standard library, I will go and rustle them out"}], "tags": [], "owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "is_accepted": false, "score": 10, "last_activity_date": 1423853977, "creation_date": 1423853977, "answer_id": 28506760, "question_id": 28506013, "link": "https://stackoverflow.com/questions/28506013/idiomatic-golang-goroutines/28506760#28506760", "title": "Idiomatic Golang goroutines", "body": "<p>I had your opinion on this until I started writing an adapter for a web service that I want to make concurrent. I have a go routine that must be started to parse results that are returned to the channel from the web calls. There is absolutely no case in which this API would work without using it as a go routine.</p>\n\n<p>I then began to look at packages like net/http. There is mandatory concurrency within that package. It is documented at the interface level that it should be able to be used concurrently, however the default implementations automatically use go routines.</p>\n\n<p>Because Go's standard library commonly fires of go routines within its own packages, I think that if your package or API warrants it, you can handle them on your own.</p>\n"}, {"comments": [{"owner": {"reputation": 27330, "user_id": 104040, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/60f28d36c1439f965e2fb55419621968?s=128&d=identicon&r=PG", "display_name": "Aiden Bell", "link": "https://stackoverflow.com/users/104040/aiden-bell"}, "edited": false, "score": 0, "creation_date": 1423935723, "post_id": 28510173, "comment_id": 45353703, "body": "Thank you for your reply. Slide 25 is very helpful. I also struggle with the edge-case design being in the &#39;http&#39; package whose server/client/handler purpose is fairly standard. Hmm, this might be a tricky one."}, {"owner": {"reputation": 27330, "user_id": 104040, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/60f28d36c1439f965e2fb55419621968?s=128&d=identicon&r=PG", "display_name": "Aiden Bell", "link": "https://stackoverflow.com/users/104040/aiden-bell"}, "edited": false, "score": 0, "creation_date": 1423936409, "post_id": 28510173, "comment_id": 45353903, "body": "In my case, slide 28 (<a href=\"http://talks.golang.org/2013/bestpractices.slide#28\" rel=\"nofollow noreferrer\">talks.golang.org/2013/bestpractices.slide#28</a>) is  much like my code in that my &quot;constructor&quot; is for a server-like API and has a kill chan much like slide 29. However in slide 28, the constructor starts the goroutine which takes the choice away from the user."}, {"owner": {"reputation": 27330, "user_id": 104040, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/60f28d36c1439f965e2fb55419621968?s=128&d=identicon&r=PG", "display_name": "Aiden Bell", "link": "https://stackoverflow.com/users/104040/aiden-bell"}, "edited": false, "score": 0, "creation_date": 1423936671, "post_id": 28510173, "comment_id": 45353978, "body": "... it could be that server APIs are the exception to slide 25"}], "tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": false, "score": 9, "last_activity_date": 1423868637, "last_edit_date": 1423868637, "creation_date": 1423868217, "answer_id": 28510173, "question_id": 28506013, "link": "https://stackoverflow.com/questions/28506013/idiomatic-golang-goroutines/28510173#28510173", "title": "Idiomatic Golang goroutines", "body": "<blockquote>\n  <p>My current view is that we should document and give the caller a choice.</p>\n</blockquote>\n\n<p>I tend to agree with you.</p>\n\n<p>Since Go makes it so easy to run code concurrently, you should try to avoid concurrency in your API (which forces clients to use it concurrently).  Instead, create a synchronous API, and then clients have the option to run it synchronously or concurrently.</p>\n\n<p>This was discussed in a talk a couple years ago: <a href=\"http://talks.golang.org/2013/bestpractices.slide#25\" rel=\"noreferrer\">Twelve Go Best Practices</a></p>\n\n<p>Slide 26, in particular, shows code more like your first example.</p>\n\n<p>I would view the <code>net/http</code> package as an exception because in this case, the concurrency is almost mandatory.  If the package didn't use concurrency internally, the client code would almost certainly have to.  For example, <code>http.Client</code> doesn't (to my knowledge) start any goroutines.  It is only the server that does so.</p>\n\n<p>In most cases, it's going to be one line of the code for the caller either way:</p>\n\n<p><code>go Run()</code> or <code>StartGoroutine()</code></p>\n\n<p>The synchronous API is no harder to use concurrently and gives the caller more options.</p>\n"}, {"comments": [{"owner": {"reputation": 27330, "user_id": 104040, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/60f28d36c1439f965e2fb55419621968?s=128&d=identicon&r=PG", "display_name": "Aiden Bell", "link": "https://stackoverflow.com/users/104040/aiden-bell"}, "edited": false, "score": 0, "creation_date": 1424115854, "post_id": 28539948, "comment_id": 45411286, "body": "I do agree, of course we can do what we want. I wasn&#39;t looking for the right answer, but any expectations others might have when calling an API."}], "tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 1, "last_activity_date": 1424084617, "creation_date": 1424084617, "answer_id": 28539948, "question_id": 28506013, "link": "https://stackoverflow.com/questions/28506013/idiomatic-golang-goroutines/28539948#28539948", "title": "Idiomatic Golang goroutines", "body": "<p>There is no 'right' answer because circumstances differ. </p>\n\n<p>Obviously there are cases where an API might contain utilities, simple algorithms, data collections etc that would look odd if packaged up as goroutines.</p>\n\n<p>Conversely, there are cases where it is natural to expect 'under-the-hood' concurrency, such as a rich IO library (http server being the obvious example).</p>\n\n<p>For a more extreme case, consider you were to produce a library of plug-n-play concurrent services. Such an API consists of modules each having a well-described interface via channels. Clearly, in this case it would inevitably involve goroutines starting as part of the API.</p>\n\n<p>One clue might well be the presence or absence of channels in the function parameters. But I would expect clear documentation of what to expect either way.</p>\n"}], "owner": {"reputation": 27330, "user_id": 104040, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/60f28d36c1439f965e2fb55419621968?s=128&d=identicon&r=PG", "display_name": "Aiden Bell", "link": "https://stackoverflow.com/users/104040/aiden-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1351, "favorite_count": 2, "answer_count": 3, "score": 16, "last_activity_date": 1424084617, "creation_date": 1423851174, "question_id": 28506013, "link": "https://stackoverflow.com/questions/28506013/idiomatic-golang-goroutines", "title": "Idiomatic Golang goroutines", "body": "<p>In Go, if we have a type with a method that starts some looped mechanism (polling A and doing B forever) is it best to express this as:</p>\n\n<pre><code>// Run does stuff, you probably want to run this as a goroutine\nfunc (t Type) Run() {\n    // Do long-running stuff\n}\n</code></pre>\n\n<p>and document that this probably wants to be launched as a goroutine (and let the caller deal with that)</p>\n\n<p>Or to hide this from the caller:</p>\n\n<pre><code>// Run does stuff concurrently\nfunc (t Type) Run() {\n   go DoRunStuff()\n}\n</code></pre>\n\n<p>I'm new to Go and unsure if convention says let the caller prefix with 'go' or do it for them when the code is designed to run async.</p>\n\n<p>My current view is that we should document and give the caller a choice. My thinking is that in Go the concurrency isn't actually part of the exposed interface, but a property of using it. Is this right?</p>\n"}, {"tags": ["html", "sql", "sql-server", "templates", "go"], "comments": [{"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "edited": false, "score": 0, "creation_date": 1423847491, "post_id": 28504880, "comment_id": 45329043, "body": "<code>rows</code> is none of array, channel, pipeline, or map. So you should build a structure during the process of getting the row data that you already do. Then use that structure."}, {"owner": {"reputation": 125, "user_id": 4504743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a788ca4208f56fc870d13d3852c55e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Denson", "link": "https://stackoverflow.com/users/4504743/lee-denson"}, "reply_to_user": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "edited": false, "score": 0, "creation_date": 1424094976, "post_id": 28504880, "comment_id": 45399435, "body": "I added a map type to hold the number of rows but now I can&#39;t embed the loops in html.  Now my problem is I cannot reference a map type inside a loop with a range on another map type in the html."}], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 4504743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a788ca4208f56fc870d13d3852c55e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Denson", "link": "https://stackoverflow.com/users/4504743/lee-denson"}, "is_accepted": true, "score": 0, "last_activity_date": 1424198441, "creation_date": 1424198441, "answer_id": 28568750, "question_id": 28504880, "link": "https://stackoverflow.com/questions/28504880/how-to-embed-sqlx-results-in-html-using-go-golang/28568750#28568750", "title": "How to embed SQLX results in HTML using GO (golang)", "body": "<p>At the start of a new row, insert a \"NewRow\" string to serve as a flag in the html.  Then in the {{range $rowidx, $rowdat := .RowData}} loop add an if statement that ends and starts a new row if $rowdat == \"NewRow\"</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 12794340, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QBt4kwC22D4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdo4KzB3f-UPRw8hVrAskMFiYlsqQ/photo.jpg?sz=128", "display_name": "Serg", "link": "https://stackoverflow.com/users/12794340/serg"}, "is_accepted": false, "score": 0, "last_activity_date": 1604555518, "creation_date": 1604555518, "answer_id": 64691877, "question_id": 28504880, "link": "https://stackoverflow.com/questions/28504880/how-to-embed-sqlx-results-in-html-using-go-golang/64691877#64691877", "title": "How to embed SQLX results in HTML using GO (golang)", "body": "<p>I use this variant:</p>\n<p>Go</p>\n<pre><code>func MainPageHandler(w http.ResponseWriter, r *http.Request) { \n    type User struct {\n        Name1  string\n        Name2  string\n    }\n\n    rows, err := database.Query(&quot;select  .......;&quot;)\n    if err != nil {\n        log.Println(err)\n    }\n    defer rows.Close()\n    user_current := []User{}\n    for rows.Next() {\n        p := User{}\n        err := rows.Scan(&amp;p.Name1, &amp;p.Name2 )\n        if err != nil {\n            fmt.Println(err)\n            continue\n        }\n        user_current = append(user_current, p)\n    }\n    tmpl, _ := template.ParseFiles(&quot;main_page.html&quot;)\n    tmpl.Execute(w, user_current)\n}\n</code></pre>\n<p>html</p>\n<pre><code>&lt;table&gt;\n     &lt;thead&gt;&lt;th&gt;name1/th&gt;&lt;th&gt;name2&lt;/th&gt;&lt;/thead&gt;\n            {{range . }}\n            &lt;tr&gt;\n                &lt;td&gt;{{.Name1}}&lt;/td&gt;\n                &lt;td&gt;{{.Name2}}&lt;/td&gt;\n            &lt;/tr&gt;\n            {{end}}\n        &lt;/table&gt;\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 4504743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a788ca4208f56fc870d13d3852c55e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Denson", "link": "https://stackoverflow.com/users/4504743/lee-denson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1907, "favorite_count": 0, "accepted_answer_id": 28568750, "answer_count": 2, "score": 1, "last_activity_date": 1604555518, "creation_date": 1423847162, "question_id": 28504880, "link": "https://stackoverflow.com/questions/28504880/how-to-embed-sqlx-results-in-html-using-go-golang", "title": "How to embed SQLX results in HTML using GO (golang)", "body": "<p>I am trying to embed results from a Sql Query into an html table using GO as the back end. To iterate row results in Go, the Rows.Next() function is used.  This works for printing to the console window, but not for a html table.\nHere is my Go Code:</p>\n\n<pre><code>package main\n// Database connection Code for http://play.golang.org/p/njPBsg0JjD\n\nimport (\n    \"net/http\"\n    \"html/template\"\n    \"fmt\"\n    \"github.com/LukeMauldin/lodbc\"\n    \"github.com/jmoiron/sqlx\"\n    \"database/sql\"\n)\n\n//declare database class\nvar db *sqlx.DB\n\ntype webdata struct {\n    Title string\n    Heading string\n    GridTitle string\n    ColumnHeading [9]string\n    RowData [9]string\n    NumOfRows *sql.Rows\n}\n\n//this is the function handler to handle '/mbconsole'\nfunc ConsoleHandler(w http.ResponseWriter, r *http.Request) {\n\n    //declare an instance of webdata\n    var wdata webdata\n\n    //connect to database\n    //Set ODBC driver level\n    lodbc.SetODBCVersion(lodbc.ODBCVersion_3)\n\n    var err error\n    //connect to a Microsoft SQL Server\n    db, err = sqlx.Open(\"lodbc\", \"[connectionstring]\")\n    if err == nil {\n        fmt.Println(\"Connection successful\")\n    }else{\n        fmt.Println(\"SQL Connection error\", err)\n    }\n\n    // Execute the queries\n    rows, err := db.Query(\"[Select ...]\")\n    if err != nil {\n        panic(err.Error())\n    }\n\n\n    // Get column names\n    columns, err := rows.Columns()\n    if err != nil {\n        panic(err.Error())\n    }\n\n\n    // Make a slice for the values\n    values := make([]interface{}, len(columns))\n\n    // rows.Scan wants '[]interface{}' as an argument, so we must copy the\n    // references into such a slice\n    // See http://code.google.com/p/go-wiki/wiki/InterfaceSlice for details\n    scanArgs := make([]interface{}, len(values))\n\n    for i := range values {\n        scanArgs[i] = &amp;values[i]\n    }\n    //fill table headings, the table returns 9 columns so I just hard coded it\n    for i:=0;i&lt;9;i++ {\n        wdata.ColumnHeading[i] = columns[i]\n    }\n\n    wdata.NumOfRows = rows\n\n    // Fetch rows\n    for rows.Next() {\n        err = rows.Scan(scanArgs...)\n        if err != nil {\n            panic(err.Error())\n        }\n        // Print data\n        for i, value := range values {\n            switch value.(type) {\n            case nil:\n                wdata.RowData[i] = \"NULL\"\n            case []byte:\n                wdata.RowData[i] = string(value.([]byte))\n            default:\n                wdata.RowData[i] = fmt.Sprint(value)\n            }\n        }\n    }\n\n    wdata.Title = \"Page Title\"\n    wdata.Heading = \"My View\"\n    wdata.GridTitle = \"My Grid Title\"\n\n    //get the template the data will be loaded into\n    t1, err := template.ParseFiles(\"template.html\")\n    if t1 == nil {\n        fmt.Println(\"File Not Found: \", err)\n    }\n    //load the template with data and display\n    terr := t1.Execute(w, &amp;wdata)\n    if terr != nil {\n        fmt.Println(\"terr: \", terr)\n    }\n\n    db = db.Unsafe()\n    defer db.Close()\n\n}\n\n\nfunc main() {\n    http.HandleFunc(\"/\",ConsoleHandler)\n}\n</code></pre>\n\n<p>Here is my template.html</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;&lt;title&gt;{{.Title}}&lt;/title&gt;&lt;/head&gt;&lt;body&gt;\n...\n&lt;h1&gt;{{.Heading}}&lt;/h1&gt;\n    &lt;div id=\"gridviewcontainer\"&gt;\n    &lt;br /&gt;\n    &lt;div id=\"gridtitle\"&gt;\n        &lt;a href=\"{{.GridTitleLink}}\" style=\"font-size:25px;\"&gt;{{.GridTitle}}&lt;/a&gt;\n    &lt;/div&gt;\n    &lt;table id=\"gridtable\"&gt;\n    &lt;tr&gt;{{range $ColumnIdx, $colheading := .ColumnHeading}}\n    &lt;th&gt;{{$colheading}}&lt;/th&gt;{{end}}&lt;/tr&gt;\n&lt;&lt;!---This is what is causing the issue, .NumOfRows is not a valid field, must be array, channel, pipeline, or map --&gt; \n    {{range $index, $rowval := .NumOfRows}}\n        &lt;tr&gt;\n        {{range $rowidx, $rowdat := .RowData}}&lt;td&gt;{{$rowdat}}&lt;/td&gt;{{end}}\n        &lt;/tr&gt;\n        {{endfor}}\n    &lt;/table&gt;\n\n...\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I connect to the database correctly and using the \"fmt\" package I can print correctly. But I can't figure out how to loop through for number of rows retured in the html page.  Is there a way to cast sql.Rows to a correct type or loop for a set integer number of times in html.  </p>\n\n<p>ps. \nI tried using {{ $index := 3}}...{end}} in the html, but that didn't work</p>\n\n<p>Any input would be greatly appreciated</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1423841994, "post_id": 28503001, "comment_id": 45325406, "body": "Export the <code>point</code> field by making it upper case."}], "answers": [{"tags": [], "owner": {"reputation": 4176, "user_id": 26849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-tO7nkYt2C3Q/AAAAAAAAAAI/AAAAAAAAAr4/UstVddaB4E4/photo.jpg?sz=128", "display_name": "chris", "link": "https://stackoverflow.com/users/26849/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1529821049, "creation_date": 1529821049, "answer_id": 51007440, "question_id": 28503001, "link": "https://stackoverflow.com/questions/28503001/how-to-store-embedded-struct-with-gorm/51007440#51007440", "title": "How to store embedded struct with GORM?", "body": "<p>I am not familiar with Gorm, but with <strong>sqlx</strong> you will need to implement the sql.Scanner and sql.Valuer interfaces to allow the data to be converted to the postgres <code>point</code> type. The code below isn't checking for errors so it will need some tweaks.</p>\n\n<p><a href=\"https://play.golang.org/p/2-Y-wSeAWnj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2-Y-wSeAWnj</a></p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql/driver\"\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype GeoPoint struct {\n    Lat float64\n    Lon float64\n}\n\nfunc (gp GeoPoint) Value() (driver.Value, error) {\n    return fmt.Sprintf(\"(%d,%d)\", gp.Lat, gp.Lon), nil\n}\n\nfunc (gp GeoPoint) Scan(src interface{}) error {\n    raw := src.(string)\n    coords := raw[1 : len(raw)-1]\n    vals := strings.Split(coords, \",\")\n    gp.Lat, _ = strconv.ParseFloat(vals[0], 64)\n    gp.Lon, _ = strconv.ParseFloat(vals[1], 64)\n    return nil\n}\n\nfunc main() {\n    gp := GeoPoint{Lat: 112, Lon: 53}\n    d, _ := gp.Value()\n    fmt.Printf(\"%+v\\n\", d)\n\n    gp.Scan(\"(53, -110)\")\n    fmt.Printf(\"%+v\\n\", gp)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "is_accepted": false, "score": 0, "last_activity_date": 1562232005, "last_edit_date": 1562232005, "creation_date": 1548749420, "answer_id": 54416448, "question_id": 28503001, "link": "https://stackoverflow.com/questions/28503001/how-to-store-embedded-struct-with-gorm/54416448#54416448", "title": "How to store embedded struct with GORM?", "body": "<p>First, using gorm you never define fields with the first letter in lower case.</p>\n\n<p>If you make sure GeoPoint is linked as Aid , you can use ForeingKey tag like,\nMAKE SURE Id is table A 's primary key.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type A struct {\n    Id int `gorm:\"column:\"id\"\"`\n    Point GeoPoint `gorm:\"column:geo_point;ForeignKey:OrderId\"`\n}\n\ntype GeoPoint struct {\n    Aid int\n    Lat float64\n    Lon float64\n}\n\nfunc main(){\n    ...\n    ...\n    var as []A\n    if e:=db.Model(&amp;A{}).Find(&amp;as).Error;e!=nil{\n        handle(e)\n    }\n    fmt.Println(as)\n}\n</code></pre>\n\n<p>If not linked by primary key. You can use middleware like</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type A struct {\n    Id int `gorm:\"column:\"id\"\"`\n    Point GeoPoint `gorm:\"column:geo_point\"`\n}\n\nfunc (a *A) AfterFind()error{\n   return db.Model(&amp;GeoPoint{}).First(&amp;(a.Point)).Error\n}\n\ntype GeoPoint struct {\n    Aid int\n    Lat float64\n    Lon float64\n}\n\nfunc main(){\n    ...\n    ...\n    var as []A\n    if e:=db.Model(&amp;A{}).Find(&amp;as).Error;e!=nil{\n        handle(e)\n    }\n    fmt.Println(as)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 7783266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7f15a665594e08b9275ae69380d0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Blunt Wang", "link": "https://stackoverflow.com/users/7783266/blunt-wang"}, "is_accepted": false, "score": 4, "last_activity_date": 1550548827, "creation_date": 1550548827, "answer_id": 54758672, "question_id": 28503001, "link": "https://stackoverflow.com/questions/28503001/how-to-store-embedded-struct-with-gorm/54758672#54758672", "title": "How to store embedded struct with GORM?", "body": "<p>You can try: </p>\n\n<pre><code>   type A struct {\n    point GeoPoint `gorm:\"embedded\"`\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2406, "user_id": 604515, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5a59cce890ffc226eddf1ad65602fe8f?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/604515/willem"}, "edited": false, "score": 0, "creation_date": 1594395933, "post_id": 59260426, "comment_id": 111121174, "body": "For <code>Scan</code> I had to use <code>return json.Unmarshal([]byte(src.(string)), &amp;sla)</code>, otherwise it worked! Genius"}], "tags": [], "owner": {"reputation": 31, "user_id": 12509188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f0cce8cc16ef5d93bc5c4825a30c03?s=128&d=identicon&r=PG&f=1", "display_name": "Muerwre", "link": "https://stackoverflow.com/users/12509188/muerwre"}, "is_accepted": false, "score": 3, "last_activity_date": 1577196294, "last_edit_date": 1577196294, "creation_date": 1575953342, "answer_id": 59260426, "question_id": 28503001, "link": "https://stackoverflow.com/questions/28503001/how-to-store-embedded-struct-with-gorm/59260426#59260426", "title": "How to store embedded struct with GORM?", "body": "<p>For anyone, who's searching the way to put struct inside GORM model and make it marshalling and unmarshalling automatically. </p>\n\n<p>This solution is based on <strong>chris</strong>'s answer. And it works!</p>\n\n<p>For example, I want to put array of Childrens inside Parent as marshalled JSON:</p>\n\n<pre><code>type Child struct {\n    Lat float64\n    Lng float64\n}\n\ntype ChildArray []Children\n\nfunc (sla *ChildArray) Scan(src interface{}) error {\n    return json.Unmarshal(src.([]byte), &amp;sla)\n}\n\nfunc (sla ChildArray) Value() (driver.Value, error) {\n    val, err := json.Marshal(sla)\n    return string(val), err\n}\n\ntype Parent struct {\n    *gorm.Model    \n    Childrens ChildArray `gorm:\"column:childrens;type:longtext\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 4633, "user_id": 506712, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QxcR9.jpg?s=128&g=1", "display_name": "Javier Manzano", "link": "https://stackoverflow.com/users/506712/javier-manzano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4660, "favorite_count": 0, "answer_count": 4, "score": 9, "last_activity_date": 1577196294, "creation_date": 1423841392, "last_edit_date": 1529821328, "question_id": 28503001, "link": "https://stackoverflow.com/questions/28503001/how-to-store-embedded-struct-with-gorm", "title": "How to store embedded struct with GORM?", "body": "<p>How can I store an embedded struct with GORM if I have a type like this</p>\n\n<pre><code>type A struct {\n    point GeoPoint\n}\n\ntype GeoPoint struct {\n    Lat float64\n    Lon float64\n}\n</code></pre>\n\n<p>GORM tries to add it in a new table, but I want to add it  as another field.</p>\n\n<p>How can this be done?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 5, "creation_date": 1476647925, "post_id": 28501976, "comment_id": 67422778, "body": "Probably a good idea to cite your sources: <a href=\"http://www.hydrogen18.com/blog/golang-embedding.html\" rel=\"nofollow noreferrer\">hydrogen18.com/blog/golang-embedding.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 11, "last_activity_date": 1423840471, "creation_date": 1423840471, "answer_id": 28502669, "question_id": 28501976, "link": "https://stackoverflow.com/questions/28501976/embedding-in-go-with-pointer-or-with-value/28502669#28502669", "title": "Embedding in Go with pointer or with value", "body": "<p>By embedding a type you usually want to benefit from call-forwarding. <code>*Bitmap</code>'s <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"noreferrer\">method set</a> is a super set of <code>Bitmap</code>'s <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"noreferrer\">method set</a>. So in most cases you'll want to embed <code>*Bitmap</code>, unless all its methods have a receiver of type <code>Bitmap</code> or the method set it empty, in which cases you can avoid the indirection.</p>\n"}, {"tags": [], "owner": {"reputation": 5194, "user_id": 41344, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e0dedec2ffb08c81d5eb0d3d8fb966d7?s=128&d=identicon&r=PG", "display_name": "rog", "link": "https://stackoverflow.com/users/41344/rog"}, "is_accepted": true, "score": 36, "last_activity_date": 1423849004, "creation_date": 1423849004, "answer_id": 28505394, "question_id": 28501976, "link": "https://stackoverflow.com/questions/28501976/embedding-in-go-with-pointer-or-with-value/28505394#28505394", "title": "Embedding in Go with pointer or with value", "body": "<p>It depends. There are several possibilities here.</p>\n\n<ul>\n<li>If Renderer is passed around by value and the methods you need on Bitmap are defined on *Bitmap, then you'll need to embed *Bitmap.</li>\n<li>If Renderer is passed around as a pointer, then you can embed Bitmap as a value without any problem (pointer methods will still be accessible in this case).</li>\n<li>If Bitmap has a constructor function that returns a pointer, and the zero value of Bitmap isn't usable, you'll want to embed *Bitmap, as you don't want to encourage by-value copying of the Bitmap value.</li>\n<li>If all the Bitmap methods are value methods, then you definitely want to embed by value.</li>\n</ul>\n\n<p>In the specific case you have here, I'd probably embed by value, as the type is small - it gives you locality of access and less memory allocations.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 5741628, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IoSAyKEQXrU/AAAAAAAAAAI/AAAAAAAAACE/oh65oJYjuo4/photo.jpg?sz=128", "display_name": "Ben Weedon", "link": "https://stackoverflow.com/users/5741628/ben-weedon"}, "is_accepted": false, "score": 1, "last_activity_date": 1487791904, "creation_date": 1487791904, "answer_id": 42400619, "question_id": 28501976, "link": "https://stackoverflow.com/questions/28501976/embedding-in-go-with-pointer-or-with-value/42400619#42400619", "title": "Embedding in Go with pointer or with value", "body": "<p>I've also found it useful when you have multiple structs all with the same embedded base type, and you want to use a helper function which modifies the values of the base struct. For example, given the following structs:</p>\n\n<pre><code>type Base struct {\n    F1 int\n}\n\ntype A struct {\n    *Base\n    Fa int\n}\n\ntype B struct {\n    *Base\n    Fb int\n}\n</code></pre>\n\n<p>and the following helper function:</p>\n\n<pre><code>func modstruct(base *Base) {\n    base.F1 = 2\n}\n</code></pre>\n\n<p>all of the following function calls will compile, and modify values of the struct:</p>\n\n<pre><code>base := &amp;Base{}\na := &amp;A{Base: &amp;Base{}}\nb := &amp;B{Base: &amp;Base{}}\nmodstruct(base)\nmodstruct(a.Base)\nmodstruct(b.Base)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 3075863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8a26fb7cd01b19e344ed44a0d1eb802?s=128&d=identicon&r=PG&f=1", "display_name": "ChiefQuimby", "link": "https://stackoverflow.com/users/3075863/chiefquimby"}, "is_accepted": false, "score": 5, "last_activity_date": 1488481055, "creation_date": 1488481055, "answer_id": 42563706, "question_id": 28501976, "link": "https://stackoverflow.com/questions/28501976/embedding-in-go-with-pointer-or-with-value/42563706#42563706", "title": "Embedding in Go with pointer or with value", "body": "<p>There seems so be a misunderstanding of receivers, as expressed in rog's answer. Methods (receivers) are not \"defined on\" a pointer or a type, the same methods can be called on the value-of-type as the pointer, the receiver's signature only determines whether it receives value-of-type or a pointer to value-of-type. That is to say <code>func(t *YourType)</code> can be called on <code>YourType</code> or <code>&amp;YourType</code> and vice-versa with a value receiver. I think this should clarify: <a href=\"https://play.golang.org/p/AT1J2oGkum\" rel=\"noreferrer\">https://play.golang.org/p/AT1J2oGkum</a>\nSo as to the question as to whether to embed a value or pointer...the referentiality is really determined by how you deal with the outer object, if you are passing a pointer to the outer struct you will have access to the same embedded struct value, if you are passing the value of the outer struct, do you want it to point to the \"original\" underlying value of the embedded struct or a copy? I think in most cases you will either want to embed a pointer and pass pointers to your outer struct, or embed a value and pass value of your outer struct.</p>\n"}, {"comments": [{"owner": {"reputation": 2456, "user_id": 851185, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a384e77c92174c0f92f69fea654c3069?s=128&d=identicon&r=PG", "display_name": "jean", "link": "https://stackoverflow.com/users/851185/jean"}, "edited": false, "score": 0, "creation_date": 1569383790, "post_id": 50581935, "comment_id": 102574622, "body": "The main point of your code is if you define a value receiver setter function, that can not change the value passed in. Change or no change is few related with pointer or value embedding"}], "tags": [], "owner": {"reputation": 975, "user_id": 4268594, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/flo3d.jpg?s=128&g=1", "display_name": "jamlee", "link": "https://stackoverflow.com/users/4268594/jamlee"}, "is_accepted": false, "score": 5, "last_activity_date": 1527589245, "creation_date": 1527589245, "answer_id": 50581935, "question_id": 28501976, "link": "https://stackoverflow.com/questions/28501976/embedding-in-go-with-pointer-or-with-value/50581935#50581935", "title": "Embedding in Go with pointer or with value", "body": "<p>i tried: <a href=\"https://play.golang.org/p/IVM5OoDU9ZN\" rel=\"noreferrer\">https://play.golang.org/p/IVM5OoDU9ZN</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Base struct {\n    Name string\n}\n\nfunc (b Base) PrintName() {\n    fmt.Println(b.Name)\n}\n\nfunc (b *Base) PrintNameP() {\n    fmt.Println(b.Name)\n}\n\nfunc (b Base) ChangeName(name string) {\n    b.Name = name\n}\n\nfunc (b *Base) ChangeNameP(name string) {\n    b.Name = name\n}\n\ntype EmbedsBase struct {\n    Base\n}\n\ntype EmbedsPointerToBase struct {\n    *Base\n}\n\nfunc main() {\n\n    fmt.Println(\"\")\n    fmt.Println(\"# embed by value and refrenced by value, not change origianl value\")\n    b := Base{\"Jeff Hardy\"}\n    eb := EmbedsBase{b}\n    eb.PrintName()\n    eb.ChangeName(\"John Cena\")\n    eb.PrintName()\n\n    fmt.Println(\"\")\n    fmt.Println(\"# embed by value, but refrenced by pointer, changed origianl value\")\n    b = Base{\"Jeff Hardy\"}\n    ebp := &amp;EmbedsBase{b}\n    ebp.PrintNameP()\n    ebp.ChangeNameP(\"John Cena\")\n    ebp.PrintNameP()\n\n    fmt.Println(\"\")\n    fmt.Println(\"# embed by pointer, but refrenced by value, not chage origianl value\")\n    b = Base{\"Jeff Hardy\"}\n    epb := EmbedsPointerToBase{&amp;b}\n    epb.PrintName()\n    epb.ChangeName(\"John Cena\")\n    epb.PrintName()\n\n    fmt.Println(\"\")\n    fmt.Println(\"# embed by pointer, and refrenced by pointer, changed origianl value\")\n    b = Base{\"Jeff Hardy\"}\n    epbp := &amp;EmbedsPointerToBase{&amp;b}\n    epbp.PrintNameP()\n    epbp.ChangeNameP(\"John Cena\")\n    epbp.PrintNameP()\n}\n</code></pre>\n\n<p>the result of above is:</p>\n\n<pre><code># embed by value and refrenced by value, not change origianl value\nJeff Hardy\nJeff Hardy\n\n# embed by value, but refrenced by pointer, changed origianl value\nJeff Hardy\nJohn Cena\n\n# embed by pointer, but refrenced by value, not chage origianl value\nJeff Hardy\nJeff Hardy\n\n# embed by pointer, and refrenced by pointer, changed origianl value\nJeff Hardy\nJohn Cena\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10037, "favorite_count": 15, "accepted_answer_id": 28505394, "answer_count": 5, "score": 35, "last_activity_date": 1527589245, "creation_date": 1423838362, "question_id": 28501976, "link": "https://stackoverflow.com/questions/28501976/embedding-in-go-with-pointer-or-with-value", "title": "Embedding in Go with pointer or with value", "body": "<p>I can embed in golang with pointer and value.\nBy pointer</p>\n\n<pre><code>type Bitmap struct{\n    data [4][4]bool\n}\n\ntype Renderer struct{\n    *Bitmap\n    on uint8\n    off uint8\n}\n</code></pre>\n\n<p>By value</p>\n\n<pre><code>type Bitmap struct{\n    data [4][4]bool\n}\n\ntype Renderer struct{\n    Bitmap \n    on uint8\n    off uint8\n}\n</code></pre>\n\n<p>What is more prefer by pointer or value?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1423832918, "post_id": 28499863, "comment_id": 45319924, "body": "Dear god, please format this and actually ask a question."}], "answers": [{"tags": [], "owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1423839222, "last_edit_date": 1423839222, "creation_date": 1423838185, "answer_id": 28501925, "question_id": 28499863, "link": "https://stackoverflow.com/questions/28499863/not-able-to-get-access-token-for-box-api-using-golang/28501925#28501925", "title": "Not able to get access token for box api using golang", "body": "<p>First off, you might want to remove your ClientID and ClientSecret from the code you posted.</p>\n\n<p>Second, you'd probably be better off using an OAuth2 implementation that already exists <a href=\"https://code.google.com/p/goauth2/oauth\" rel=\"nofollow\">code.google.com/p/goauth2/oauth</a> is pretty good).</p>\n\n<p>As to why your code doesn't work, the code you pasted isn't complete go code (it's missing a couple closing curly braces - <code>data := url.Values{</code> is unclosed). Also, you should define a main function - without it your go code isn't going to run (unless there is other code using this code, that wasn't pasted above). If you want an example of go code that works to get a Box API token (shameless plug here), I wrote a bunch of stuff for a preliminary Box Client in go (I just never got around to finishing it). This little main will help you get a token: <a href=\"https://github.com/ttacon/box/blob/master/boxtoken/boxtoken.go\" rel=\"nofollow\">https://github.com/ttacon/box/blob/master/boxtoken/boxtoken.go</a>.</p>\n\n<p>To run it just cd into the directory it is in and run it with:</p>\n\n<pre><code>go run boxtoken.go -cid=YOUR_CLIENT_ID -csec=YOUR_CLIENT_SECRET\n</code></pre>\n\n<p>Then just go to <a href=\"http://localhost:8080/\" rel=\"nofollow\">http://localhost:8080/</a> and follow the page.</p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 41, "user_id": 4563486, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2148aec13054b46756960216cc7e4021?s=128&d=identicon&r=PG&f=1", "display_name": "Ragavi", "link": "https://stackoverflow.com/users/4563486/ragavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1423839222, "creation_date": 1423831317, "last_edit_date": 1423833306, "question_id": 28499863, "link": "https://stackoverflow.com/questions/28499863/not-able-to-get-access-token-for-box-api-using-golang", "title": "Not able to get access token for box api using golang", "body": "<p>I am not able to get access token for box api using golang.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>// box project main.go\n\npackage main\n\nimport (\"bytes\" \"encoding/json\" \"fmt\" \"io\" \"io/ioutil\" \"log\" \"net/http\" \"net/url\"\n)\n\ntype accessinfo struct {access_token  string expires_in   int64 token_type    string refresh_token string}\n\nvar accessobj accessinfo\n\nfunc try(w http.ResponseWriter, r *http.Request) {io.WriteString(w, \"hello,world!\\n\")if r.Method == \"GET\" {w.Header().Set(\"Content-Type\", \"text/plain\")w.Write([]byte(\"This is an example.\\n\"))code := r.FormValue(\"code\")fmt.Println(\"gvshnbc\")fmt.Println(code)authToken(code)dat, err := ioutil.ReadAll(r.Body)if dat == nil {log.Print(\"no data\")} log.Print(string(dat))if err != nil {log.Print(\"no error\")}}}func authToken(code string) {apiUrl := \"https://app.box.com/api\"///resource := \"/oauth2/token\"    data := url.Values{    data.Set(\"grant_type\", \"authorization_code\")data.Add(\"code\", code)fmt.Println(code) data.Add(\"client_id\", \"rnk5pqyahzrkf6bxwtc79rcief8u76p6\")//data.Add(\"redirect_uri\", \"http://localhost:8089\")data.Add(\"client_secret\", \"7xbeJvi76oc0IcHmfcUzZZPP9b0jVbDs\")//data.Add(\"state\", \"authenticated\") //fmt.Println(data)    u, _ := url.ParseRequestURI(apiUrl)//    u.Path = resource\nfmt.Println(u)    urlStr := fmt.Sprintf(\"%v\", u)    fmt.Println(urlStr)    client := &amp;http.Client{}    //fmt.Println(client)    r, err := http.NewRequest(\"POST\", urlStr, bytes.NewBufferString(data.Encode()))    if err != nil {        panic(err)\n//break    }    //r.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")    //r.Header.Add(\"Content-Length\", \"9\")fmt.Println(r)    if err != nil {        fmt.Println(err)    }\n    //fmt.Println(bytes.NewBufferString(data.Encode()))//fmt.Println(data.Encode())//fmt.Println(r)resp, err := client.Do(r)    if err != nil {        fmt.Println(err)    }    //fmt.Println(resp)    re, err := ioutil.ReadAll(resp.Body)    if err != nil {        fmt.Println(\"error\")        fmt.Println(string(re))    }a := json.Unmarshal(re, &amp;accessobj)fmt.Println(a)}\n</code></pre>\n"}, {"tags": ["go", "google-drive-api"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4563249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a36b90c8e1faef71d3fd28a5043a408?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4563249/andrew"}, "edited": false, "score": 0, "creation_date": 1423848124, "post_id": 28500770, "comment_id": 45329472, "body": "*drive.FilesService has a Do method which returns (*drive.File, error), so why can&#39;t I swap it with MyFilesService the following?  <code>type MyFilesGetCall interface {   Do() (*drive.File, error) }  type MyFilesService interface {   Get(string) *MyFilesGetCall }</code>"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 0, "last_activity_date": 1423834233, "creation_date": 1423834233, "answer_id": 28500770, "question_id": 28498527, "link": "https://stackoverflow.com/questions/28498527/how-to-use-go-interfaces-to-test-with-the-google-api-golang-lib/28500770#28500770", "title": "How to use Go interfaces to test with the Google API Golang lib?", "body": "<blockquote>\n  <p>It seems that interfaces only work 1 level deep.</p>\n</blockquote>\n\n<p>Go has no notion of co/ntravariance. The signature for <code>Get</code> is incompatible with the <code>MyFilesService</code> interface. As your error message told you:</p>\n\n<pre><code>*drive.FilesService does not implement MyFilesService (wrong type for Get method)\n    have Get(string) *drive.FilesGetCall\n    want Get(string) *MyFilesGetCall\n</code></pre>\n\n<blockquote>\n  <p>Can anyone recommend an alternative approach for mocking this dependency?</p>\n</blockquote>\n\n<p>Change <code>MyFilesService</code> to something that <code>*drive.FilesService</code> actually implements. </p>\n"}], "owner": {"reputation": 1, "user_id": 4563249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a36b90c8e1faef71d3fd28a5043a408?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4563249/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423834233, "creation_date": 1423826697, "question_id": 28498527, "link": "https://stackoverflow.com/questions/28498527/how-to-use-go-interfaces-to-test-with-the-google-api-golang-lib", "title": "How to use Go interfaces to test with the Google API Golang lib?", "body": "<p>I'm trying to use interfaces to test code that uses <a href=\"https://github.com/google/google-api-go-client/blob/master/drive/v2/drive-gen.go\" rel=\"nofollow\">google's drive api lib</a>.</p>\n\n<pre><code>type MyFile struct {\n  DownloadUrl string `json:\"downloadUrl,omitempty\"`\n}\n\ntype MyFilesGetCall interface {\n  Do() (*MyFile, error)\n  // Do() (*drive.File, error) // this DOES work\n}\n\ntype MyFilesService interface {\n  Get(string) *MyFilesGetCall\n  // Get(string) *drive.FilesGetCall // this DOES work\n}\n\nfunc GetInfo(id string, myService MyFilesService) {\n  myService.Get(id).Do()\n}\n\nfunc main() {\n  drive, _ := drive.New(new(http.Client))\n  GetInfo(\"id\", drive.Files)\n}\n</code></pre>\n\n<p>When I try to run this I get the following error:</p>\n\n<pre><code>$ go run so.go\n./so.go:24: cannot use drive.Files (type *drive.FilesService) as type MyFilesService in argument to GetInfo:\n        *drive.FilesService does not implement MyFilesService (wrong type for Get method)\n                have Get(string) *drive.FilesGetCall\n                want Get(string) *MyFilesGetCall\n./so.go:28: fService.Get(id).Do undefined (type *MyFilesGetCall has no field or method Do)\n</code></pre>\n\n<p>It seems that interfaces only work 1 level deep.</p>\n\n<p>Can anyone recommend an alternative approach for mocking this dependency?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-endpoints"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1423833252, "creation_date": 1423833252, "answer_id": 28500447, "question_id": 28497275, "link": "https://stackoverflow.com/questions/28497275/set-the-access-control-allow-credentials-header-in-response/28500447#28500447", "title": "set the Access-Control-Allow-Credentials Header in Response", "body": "<p>If I understand you correctly then all you have to do is something like:</p>\n\n<pre><code>func yourHandler(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Access-Control-Allow-Credentials\", \"true\")\n    // ...other code\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 1393813, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bb25fba7d94af8f3aa3e9c3bba846856?s=128&d=identicon&r=PG", "display_name": "sinmetal", "link": "https://stackoverflow.com/users/1393813/sinmetal"}, "is_accepted": false, "score": 0, "last_activity_date": 1423984204, "creation_date": 1423984204, "answer_id": 28523841, "question_id": 28497275, "link": "https://stackoverflow.com/questions/28497275/set-the-access-control-allow-credentials-header-in-response/28523841#28523841", "title": "set the Access-Control-Allow-Credentials Header in Response", "body": "<p>By patching the go-endpoints, and reached the goal .</p>\n\n<pre><code>dst.Auth = &amp;struct {\n        AllowCookie bool `json:\"allowCookieAuth\"`\n    }{true}\n</code></pre>\n\n<p><a href=\"https://github.com/sinmetal/go-endpoints/commit/25c0e85b06c13511291cb8b54f2878c5ac4587ad\" rel=\"nofollow\">https://github.com/sinmetal/go-endpoints/commit/25c0e85b06c13511291cb8b54f2878c5ac4587ad</a></p>\n\n<p>However , I do not think that's very good way .\nIf possible , I want to reach the goal without patching .</p>\n"}], "owner": {"reputation": 183, "user_id": 1393813, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bb25fba7d94af8f3aa3e9c3bba846856?s=128&d=identicon&r=PG", "display_name": "sinmetal", "link": "https://stackoverflow.com/users/1393813/sinmetal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423984204, "creation_date": 1423822722, "last_edit_date": 1423977860, "question_id": 28497275, "link": "https://stackoverflow.com/questions/28497275/set-the-access-control-allow-credentials-header-in-response", "title": "set the Access-Control-Allow-Credentials Header in Response", "body": "<p>I want to use Cookie along with the go-endpoints.</p>\n\n<p>For this purpose , it is necessary to set the Access-Control-Allow-Credentials to Header.</p>\n\n<p>However , do not know how to set the Allow-Credentials to Header in go-endpoints.</p>\n\n<p>allowCookieAuth is , How do I to true doing ?</p>\n\n<p><a href=\"https://github.com/GoogleCloudPlatform/go-endpoints/search?utf8=%E2%9C%93&amp;q=allowCookieAuth\" rel=\"nofollow\">https://github.com/GoogleCloudPlatform/go-endpoints/search?utf8=%E2%9C%93&amp;q=allowCookieAuth</a></p>\n\n<p>because there is no http.ResponseWriter the go-endpoints handler , it is not possible to set the Http Header.</p>\n\n<pre><code>func (gs *GreetingService) List(c endpoints.Context, r *GreetingsListReq) (*GreetingsList, error) {\n    if r.Limit &lt;= 0 {\n        r.Limit = 10\n    }\n\n    q := datastore.NewQuery(\"Greeting\").Limit(r.Limit)\n    greets := make([]*Greeting, 0, r.Limit)\n    keys, err := q.GetAll(c, &amp;greets)\n    if err != nil {\n        return nil, err\n    }\n\n    for i, k := range keys {\n        greets[i].Key = k\n    }\n    return &amp;GreetingsList{greets}, nil\n}\n</code></pre>\n\n<p>help me!</p>\n"}, {"tags": ["interface", "go"], "answers": [{"comments": [{"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "reply_to_user": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 1, "creation_date": 1423825108, "post_id": 28497368, "comment_id": 45315400, "body": "Happy I could help. Here is a little further reading: <a href=\"http://golang.org/doc/faq#Pointers\" rel=\"nofollow noreferrer\">golang.org/doc/faq#Pointers</a> and for this specific question <a href=\"http://golang.org/doc/faq#methods_on_values_or_pointers\" rel=\"nofollow noreferrer\">golang.org/doc/faq#methods_on_values_or_pointers</a>"}], "tags": [], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "is_accepted": true, "score": 5, "last_activity_date": 1423823319, "last_edit_date": 1423823319, "creation_date": 1423823018, "answer_id": 28497368, "question_id": 28497254, "link": "https://stackoverflow.com/questions/28497254/struct-field-not-updated-when-implementing-interface-function/28497368#28497368", "title": "Struct field not updated when implementing interface function", "body": "<p>The receiver of <code>func (this Route) AddChildren (child globals.IRoute)</code> is a value, so you are changing a copy of your <code>Route</code> struct.</p>\n\n<p>Change it to <code>func (this *Route) AddChildren (child globals.IRoute)</code></p>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 28497368, "answer_count": 1, "score": 1, "last_activity_date": 1423823319, "creation_date": 1423822675, "question_id": 28497254, "link": "https://stackoverflow.com/questions/28497254/struct-field-not-updated-when-implementing-interface-function", "title": "Struct field not updated when implementing interface function", "body": "<p>If for example we have the following interface:</p>\n\n<pre><code>type IRoute interface {\n    AddChildren(child IRoute)\n}\n</code></pre>\n\n<p>The following struct:</p>\n\n<pre><code>type Route struct {\n    Alias string `json:\"alias\"`\n    Children []Route `json:\"children,omitempty\"`\n    Url string `json:\"url,omitempty\"`\n}\n</code></pre>\n\n<p>And implemented the interface:</p>\n\n<pre><code>func (this Route) AddChildren (child globals.IRoute){\n    this.Children = append(this.Children, child.(Route))\n}\n</code></pre>\n\n<p>Then in our main func, if we wanted to test this it would not work:</p>\n\n<pre><code>rSettings := Route{\"settings\", nil, \"/admin/settings\"}\nrSettingsContentTypesNew := models.Route{\"new\", nil, \"/new?type&amp;parent\"}\nrSettingsContentTypesEdit := models.Route{\"edit\", nil, \"/edit/:nodeId\"}\n\n// Does NOT work - no children is added\nrSettingsContentTypes.AddChildren(rSettingsContentTypesNew)\nrSettingsContentTypes.AddChildren(rSettingsContentTypesEdit)\nrSettings.AddChildren(rSettingsContentTypes)\n</code></pre>\n\n<p>And this does work as expected:</p>\n\n<pre><code>rSettings := Route{\"settings\", nil, \"/admin/settings\"}\nrSettingsContentTypesNew := models.Route{\"new\", nil, \"/new?type&amp;parent\"}\nrSettingsContentTypesEdit := models.Route{\"edit\", nil, \"/edit/:nodeId\"}\n\n// However this does indeed work\nrSettingsContentTypes.Children = append(rSettingsContentTypes.Children,rSettingsContentTypesNew)\nrSettingsContentTypes.Children = append(rSettingsContentTypes.Children,rSettingsContentTypesEdit)\nrSettings.Children = append(rSettings.Children,rSettingsContentTypes)\n</code></pre>\n\n<p>What am I missing? :-)</p>\n"}, {"tags": ["javascript", "php", "arrays", "node.js", "go"], "comments": [{"owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "edited": false, "score": 0, "creation_date": 1423819067, "post_id": 28495993, "comment_id": 45311794, "body": "To my downvoter - would you care to comment?  Do you find the question unclear, do you find that I have not researched the issue enough, do you think the question does not fit this forum... ?  What purpose does it serve to downvote without explanation?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 2, "creation_date": 1423836091, "post_id": 28495993, "comment_id": 45321715, "body": "I didn&#39;t downvote, but your question is confusing and doesn&#39;t make much sense."}, {"owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1424061213, "post_id": 28495993, "comment_id": 45383677, "body": "@OneOfOne - as you can see the question made perfect sense to the right reader.  I don&#39;t want to be mean but people who downvote (to your credit you did not) without leaving a word by way of explanation don&#39;t make it to my Christmas card list."}], "answers": [{"comments": [{"owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "edited": false, "score": 0, "creation_date": 1423884421, "post_id": 28509612, "comment_id": 45342766, "body": "thank you for a very useful answer.  I am keeping this question open for a while longer to see if I get any other useful feedback.  Thanks again."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 1, "last_activity_date": 1423865410, "creation_date": 1423865410, "answer_id": 28509612, "question_id": 28495993, "link": "https://stackoverflow.com/questions/28495993/finding-the-difference-between-two-arrays-in-php-node-and-golang/28509612#28509612", "title": "Finding the difference between two arrays in PHP, Node and Golang", "body": "<p>Here's the equivalent of the array_diff solution: (assuming I didn't make a mistake)</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc FindLeastDifferent(needle []float64, haystack [][]float64) int {\n    if len(haystack) == 0 {\n        return -1\n    }\n    var currentIndex, currentDiff int\n    for i, arr := range haystack {\n        diff := 0\n        for j := range needle {\n            if arr[j] != needle[j] {\n                diff++\n            }\n        }\n        if i == 0 || diff &lt; currentDiff {\n            currentDiff = diff\n            currentIndex = i\n        }\n    }\n\n    return currentIndex\n}\n\nfunc main() {\n    idx := FindLeastDifferent(\n        []float64{2.05080E6, 29400, 420},\n        [][]float64{\n            {2.05080E6, 29400, 0},\n            {2.05080E6, 9800, 420},\n            {1.715E6, 24500, 280},\n            {2.05080E6, 29400, 140},\n            {2.05080E6, 4900, 7},\n            {2.05080E6, 29400, 420},\n        },\n    )\n    fmt.Println(idx)\n}\n</code></pre>\n\n<p>Like you said its <code>O(n * m)</code> where <code>n</code> is the number of elements in the needle array, and <code>m</code> is the number of arrays in the haystack.</p>\n\n<p>If you don't know the haystack ahead of time, then there's probably not much you can do to improve this. But if, instead, you're storing this list in a database, I think your intuition about string search has some potential. PostgreSQL for example supports string similarity indexes. (And here's an explanation of a similar idea for regular expressions: <a href=\"http://swtch.com/~rsc/regexp/regexp4.html\" rel=\"nofollow\">http://swtch.com/~rsc/regexp/regexp4.html</a>)</p>\n\n<p>One other idea: if your arrays are really big you can calculate fuzzy hashes (<a href=\"http://ssdeep.sourceforge.net/\" rel=\"nofollow\">http://ssdeep.sourceforge.net/</a>) which would make your <code>n</code> smaller.</p>\n"}], "owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 28509612, "answer_count": 1, "score": -1, "last_activity_date": 1423865410, "creation_date": 1423818664, "question_id": 28495993, "link": "https://stackoverflow.com/questions/28495993/finding-the-difference-between-two-arrays-in-php-node-and-golang", "title": "Finding the difference between two arrays in PHP, Node and Golang", "body": "<p>Here is a typical example of what I need to do</p>\n\n<pre><code>$testArr = array(2.05080E6,29400,420);\n\n$stockArrays =  array(\n                      array(2.05080E6,29400,0),\n                      array(2.05080E6,9800,420),\n                      array(1.715E6,24500,280),\n                      array(2.05080E6,29400,140),\n                      array(2.05080E6,4900,7));\n</code></pre>\n\n<p>I need to identify the stockArray that is the least different.  A few clarifications</p>\n\n<ul>\n<li>The numeric values of array elements at each position are guaranteed not to overlap. (i.e. arr[0] will always have the biggest values, arr<a href=\"http://php.net/manual/en/function.array-diff.php\" rel=\"nofollow\">1</a> will be at least an order of 10 magnitude smaller etc).</li>\n<li>The absolute values of the differences do not count when determining <em>least different</em>.  Only, the number of differing array indices matter.</li>\n<li>Positional differences do have a weighting.  Thus in my example stockArr<a href=\"http://php.net/manual/en/function.array-diff.php\" rel=\"nofollow\">1</a> is <em>\"more different\"</em> thought it too - like its stockArr[0] &amp; stockArr[3] counterparts - differs in only one index position because that index position is bigger.</li>\n<li>The number of stockArrays elements will typically be less than 10 but could potentially be much more (though never into 3 figures)</li>\n<li><p>The stock arrays will always have the same number of elements. The test array will have the same or fewer elements. However, when fewer testArr would be padded out so that potentially matching elements are always in the same place as the stockArray.  e.g. </p>\n\n<p>$testArray(29400,140)</p></li>\n</ul>\n\n<p>would be transformed to </p>\n\n<pre><code>$testArray(0,29400,140);\n</code></pre>\n\n<p>prior to being subjected to difference testing.</p>\n\n<ul>\n<li>Finally, a tie is possible.  For instance my example above the matches would be stockArrays[0] and stockArrays[3].</li>\n</ul>\n\n<p>In my example the result would be</p>\n\n<pre><code>$result = array(0=&gt;array(0,0,1),3=&gt;array(0,0,1));\n</code></pre>\n\n<p>indicating that the least different stock arrays are at indices 0 &amp; 3 with the differences being at position 2.</p>\n\n<p>In PHP I would handle all of this with <a href=\"http://php.net/manual/en/function.array-diff.php\" rel=\"nofollow\">array_diff</a> as my starting point. For Node/JavaScript I would probably be tempted to the <a href=\"http://phpjs.org/functions/array_diff/\" rel=\"nofollow\">php.js array_diff</a> port though I would be inclined to explore a bit given that in the worst cast scenario it is an O(n2) affair.</p>\n\n<p>I am a newbie when it comes to Golang so I am not sure how I would implement this problem there. I have noted that Node does have an array_diff npm module.</p>\n\n<p>One off-beat idea I have had is converting the array to a padded string (smaller array elements are 0 padded) and effectively do an XOR on the ordinal value of each character but have dismissed that as probably a rather nutty thing to do.</p>\n\n<p>I am concerned with speed but not at all costs.  In an ideal world the same solution (algorithm) would be used in each target language though in reality the differences between them might mean that is not possible/not a good idea.</p>\n\n<p>Perhaps someone here might be able to point me to less pedestrian ways of accomplishing this - i.e. not just array_diff ports.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10443, "user_id": 2438460, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sUAeA.jpg?s=128&g=1", "display_name": "Ye Lin Aung", "link": "https://stackoverflow.com/users/2438460/ye-lin-aung"}, "edited": false, "score": 0, "creation_date": 1423817678, "post_id": 28495679, "comment_id": 45311122, "body": "Oh I think I have found something similar <a href=\"http://stackoverflow.com/questions/12108215/golang-map-prints-out-of-order\">golang map prints out of order</a>"}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 3, "last_activity_date": 1423819192, "creation_date": 1423819192, "answer_id": 28496132, "question_id": 28495679, "link": "https://stackoverflow.com/questions/28495679/iterate-struct-map-key-value-in-golang/28496132#28496132", "title": "Iterate Struct (map key) value in golang", "body": "<p>Short version? You can't do it that way.</p>\n\n<p>Long version you, you can use a custom sorter:</p>\n\n<pre><code>func main() {\n    req := make(map[mapKey]string)\n\n    req[mapKey{1, \"r\"}] = \"robpike\"\n    req[mapKey{2, \"gri\"}] = \"robert griesemer\"\n    req[mapKey{3, \"adg\"}] = \"andrew gerrand\"\n    req[mapKey{4, \"rsc\"}] = \"russ cox\"\n\n    var keys mapKeys\n    for k := range req {\n        keys = append(keys, k)\n    }\n    sort.Sort(keys)\n    for _, k := range keys {\n        fmt.Printf(\"short name : %s , long name : %s\\n\", k.Option, req[k])\n    }\n}\n\ntype mapKey struct {\n    Key    int\n    Option string\n}\n\ntype mapKeys []mapKey\n\nfunc (mk mapKeys) Len() int           { return len(mk) }\nfunc (mk mapKeys) Swap(i, j int)      { mk[i], mk[j] = mk[j], mk[i] }\nfunc (mk mapKeys) Less(i, j int) bool { return mk[i].Key &lt; mk[j].Key }\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/fygmN7hg-4\" rel=\"nofollow\">play</a></kbd></p>\n\n<p>Keep in mind that if your <code>mapKey</code> struct have a field that doesn't support equality (aka a struct or a slice) using <code>req[k]</code> won't work.</p>\n\n<p>In that case you can switch to <code>type mapKeys []*mapKey</code> and <code>map[*mapKey]string</code>.</p>\n"}], "owner": {"reputation": 10443, "user_id": 2438460, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sUAeA.jpg?s=128&g=1", "display_name": "Ye Lin Aung", "link": "https://stackoverflow.com/users/2438460/ye-lin-aung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7709, "favorite_count": 0, "accepted_answer_id": 28496132, "answer_count": 1, "score": 0, "last_activity_date": 1423847857, "creation_date": 1423817548, "last_edit_date": 1495535651, "question_id": 28495679, "link": "https://stackoverflow.com/questions/28495679/iterate-struct-map-key-value-in-golang", "title": "Iterate Struct (map key) value in golang", "body": "<p>I've looked up <a href=\"https://stackoverflow.com/questions/21064244/structs-as-keys-in-golang-maps\">Structs as keys in Golang maps</a></p>\n\n<p>I understand iteration over the maps in golang has no guaranteed order. I've followed the <a href=\"https://blog.golang.org/go-maps-in-action#TOC_7.\" rel=\"nofollow noreferrer\">example in golang blog</a>, and tried using a <code>struct</code> as a map key.</p>\n\n<p>Here's my code</p>\n\n<pre><code>package main\n\nfunc main() {\n    req := make(map[mapKey]string)\n\n    req[mapKey{1, \"r\"}] = \"robpike\"\n    req[mapKey{2, \"gri\"}] = \"robert griesemer\"\n    req[mapKey{3, \"adg\"}] = \"andrew gerrand\"\n    req[mapKey{4, \"rsc\"}] = \"russ cox\"\n\n    var keys []int\n    for k := range req {\n        keys = append(keys, k.Key)\n    }\n\n    for _, k := range keys {\n        fmt.Printf(\"short name : %s , long name : %s\\n\",req[k], req[k]) // How do I iterate here\n    }\n\n    sort.Ints(keys)\n}\n\ntype mapKey struct {\n    Key    int\n    Option string\n}\n</code></pre>\n\n<p>What I want the results to be is </p>\n\n<pre><code>short name : r , long name : rob pike\nshort name : gri , long name : robert griesemer\nshort name : adg , long name : andrew gerrand\nshort name : rsc , long name : russ cox\n</code></pre>\n\n<p>And I don't know how I can get the struct value and key iterated by separated data structure.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 1, "creation_date": 1423808927, "post_id": 28493045, "comment_id": 45307703, "body": "You&#39;re probably receiving html if it&#39;s finding a &#39;&lt;&#39; instead of a json value. Have you tried printing the response out and looking at it?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1423811150, "creation_date": 1423811150, "answer_id": 28494228, "question_id": 28493045, "link": "https://stackoverflow.com/questions/28493045/i-am-having-an-issue-in-acquiring-the-access-token-for-box-api/28494228#28494228", "title": "I am having an issue in acquiring the access token for BOX API", "body": "<p>The error</p>\n\n<blockquote>\n  <p>error: invalid character '&lt;' looking for beginning of value</p>\n</blockquote>\n\n<p>Means that <code>json.Unmarshal()</code> tried to parse the content you passed to it <em>assuming</em> json format but it found a <code>'&lt;'</code> character where it shouldn't have. As suggested, your input is <em>not</em> in json format, most likely an HTML document.</p>\n\n<p>Take a look at this code:</p>\n\n<pre><code>re := []byte(\"&lt;html&gt;&lt;/html&gt;\")\nvar accessobj struct{ X string }\na := json.Unmarshal(re, &amp;accessobj)\n</code></pre>\n\n<p>In this example the content <em>is</em> HTML. Try to run it (on <a href=\"http://play.golang.org/p/x9-XKCgzJa\" rel=\"nofollow\">Go Playground</a>) and you get identical error message:</p>\n\n<blockquote>\n  <p>invalid character '&lt;' looking for beginning of value</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 4562042, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O9K2ny-kXdg/AAAAAAAAAAI/AAAAAAAAAE4/mbnHREdPKhc/photo.jpg?sz=128", "display_name": "Kiruthika Hindraj", "link": "https://stackoverflow.com/users/4562042/kiruthika-hindraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423811150, "creation_date": 1423805105, "last_edit_date": 1423807748, "question_id": 28493045, "link": "https://stackoverflow.com/questions/28493045/i-am-having-an-issue-in-acquiring-the-access-token-for-box-api", "title": "I am having an issue in acquiring the access token for BOX API", "body": "<pre><code> {re, err := ioutil.ReadAll(resp.Body)\n    a := json.Unmarshal(re, &amp;accessobj)}\n</code></pre>\n\n<p>Getting error like</p>\n\n<blockquote>\n  <p>error: invalid character '&lt;' looking for beginning of value</p>\n</blockquote>\n"}, {"tags": ["go", "xargs"], "answers": [{"comments": [{"owner": {"reputation": 3861, "user_id": 1505451, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Kk60E.jpg?s=128&g=1", "display_name": "jacobsa", "link": "https://stackoverflow.com/users/1505451/jacobsa"}, "edited": false, "score": 0, "creation_date": 1424052913, "post_id": 28493076, "comment_id": 45381973, "body": "Thank you! I would prefer a canned <code>xargs</code> formula for running in parallel and getting good failure output, but this gets me most of the way there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12861522"}, "edited": false, "score": 0, "creation_date": 1581125349, "post_id": 28493076, "comment_id": 106337459, "body": "how does this answer the question? the question was how to run the test without re-compiling!"}], "tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": true, "score": 7, "last_activity_date": 1423805320, "creation_date": 1423805320, "answer_id": 28493076, "question_id": 28492694, "link": "https://stackoverflow.com/questions/28492694/golang-how-to-run-go-test-repeatedly-without-recompiling/28493076#28493076", "title": "Golang: How to run &quot;go test&quot; repeatedly without recompiling?", "body": "<p>You can pass the <code>-c</code> flag to <code>go test</code> which will, per the help:</p>\n\n<blockquote>\n  <p>Compile the test binary to pkg.test but do not run it. (Where pkg is the last element of the package's import path.)</p>\n</blockquote>\n\n<p>So you can at least avoid recompiling every single time.</p>\n"}, {"tags": [], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "is_accepted": false, "score": 11, "last_activity_date": 1473524271, "last_edit_date": 1473524271, "creation_date": 1473523899, "answer_id": 39428023, "question_id": 28492694, "link": "https://stackoverflow.com/questions/28492694/golang-how-to-run-go-test-repeatedly-without-recompiling/39428023#39428023", "title": "Golang: How to run &quot;go test&quot; repeatedly without recompiling?", "body": "<p>It is probably new feature - but you can use <code>-count N</code> to specify how many times to repeat each test. Probably worth mentioning it will run them with a single compilation.</p>\n\n<p>I have to thank Florin P\u0103\u021ban for noticing that in a Github discussion we recently had. </p>\n"}], "owner": {"reputation": 3861, "user_id": 1505451, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Kk60E.jpg?s=128&g=1", "display_name": "jacobsa", "link": "https://stackoverflow.com/users/1505451/jacobsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4136, "favorite_count": 1, "accepted_answer_id": 28493076, "answer_count": 2, "score": 9, "last_activity_date": 1473524271, "creation_date": 1423802891, "question_id": 28492694, "link": "https://stackoverflow.com/questions/28492694/golang-how-to-run-go-test-repeatedly-without-recompiling", "title": "Golang: How to run &quot;go test&quot; repeatedly without recompiling?", "body": "<p>Is there any way for me to easily run a Go test many times, halting the first\ntime it fails? I can of course do something like this:</p>\n\n<pre><code>for i in {1..1000}; do go test ./mypkg &amp;&amp; done\n</code></pre>\n\n<p>but that causes a recompile every time, which is very slow compared to the test\nitself. I imagine I could do this with some clever application of the <code>-exec</code>\nflag and <code>xargs</code>, but I am not good at one-liners.</p>\n\n<p>Bonus points for running it many times in parallel with some semblance of sane\nverbose output if it fails one or two out of a thousand times.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1423795798, "post_id": 28491257, "comment_id": 45304223, "body": "Short of reflecting on your stack frame, finding the code and parsing it, I doubt it is possible. Even then I&#39;m not sure you could get their values via reflection. Just their names."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1423811681, "post_id": 28491257, "comment_id": 45308688, "body": "I don&#39;t think you can do it."}, {"owner": {"reputation": 385, "user_id": 2324712, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dce2c5b49d4806776c8135b7be5f4646?s=128&d=identicon&r=PG", "display_name": "user2324712", "link": "https://stackoverflow.com/users/2324712/user2324712"}, "edited": false, "score": 0, "creation_date": 1432760688, "post_id": 28491257, "comment_id": 49063926, "body": "update: delve, a debugger for golang. is now in pre 1.0 and has osx support. its still not fully functional but its coming along. You should check it out."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1423812825, "creation_date": 1423812825, "answer_id": 28494594, "question_id": 28491257, "link": "https://stackoverflow.com/questions/28491257/print-all-local-variables-in-golang/28494594#28494594", "title": "Print all local variables in Golang", "body": "<p>There is no easy solution:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/tools/tree/master/cmd/gotype\" rel=\"nofollow\"><code>gotype</code></a> can do static analysis of the code and print all variables (but not their value)</li>\n<li><a href=\"https://github.com/davecgh/go-spew\" rel=\"nofollow\"><code>go-spew</code></a> can print a variable value (deep pretty printer for Go data structures to aid in debugging), but that is like an enhanced <code>printf</code>, not a 'gdb' like debug session.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 385, "user_id": 2324712, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dce2c5b49d4806776c8135b7be5f4646?s=128&d=identicon&r=PG", "display_name": "user2324712", "link": "https://stackoverflow.com/users/2324712/user2324712"}, "edited": false, "score": 0, "creation_date": 1423879081, "post_id": 28500504, "comment_id": 45341923, "body": "thanks. I know about dlv but it doesn&#39;t have osx support yet."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1423833397, "creation_date": 1423833397, "answer_id": 28500504, "question_id": 28491257, "link": "https://stackoverflow.com/questions/28491257/print-all-local-variables-in-golang/28500504#28500504", "title": "Print all local variables in Golang", "body": "<p>There is <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow\">dlv</a>, you can experiment with the <code>print</code> command, it's the closest thing to a live debugger you can get atm.</p>\n\n<p>Otherwise gotype/go-spew like @VonC mentioned are the way to go.</p>\n"}], "owner": {"reputation": 385, "user_id": 2324712, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dce2c5b49d4806776c8135b7be5f4646?s=128&d=identicon&r=PG", "display_name": "user2324712", "link": "https://stackoverflow.com/users/2324712/user2324712"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 5, "accepted_answer_id": 28494594, "answer_count": 2, "score": 4, "last_activity_date": 1423833397, "creation_date": 1423792226, "last_edit_date": 1495541679, "question_id": 28491257, "link": "https://stackoverflow.com/questions/28491257/print-all-local-variables-in-golang", "title": "Print all local variables in Golang", "body": "<p>I wanted to know how one can enumerate the names and values of all local variables in golang. This is done with the purpose of effectively debugging go code.</p>\n\n<p>Yes, <a href=\"https://golang.org/doc/gdb\" rel=\"nofollow noreferrer\">I am well aware golang has limited gdb support right now.</a></p>\n\n<p>This <a href=\"https://stackoverflow.com/questions/430811/enumerate-or-list-all-variables-in-a-program-of-your-favorite-language-here\">commonly used thread on stackoverflow</a>  has no mention of golang.</p>\n\n<p>I am genuinely looking for a solution (I think others are curious as well).</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["audio", "go"], "comments": [{"owner": {"reputation": 18829, "user_id": 24998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c14a4f2931fa9336fdccdfe11318fef?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/24998/jack"}, "edited": false, "score": 0, "creation_date": 1423785270, "post_id": 28489786, "comment_id": 45301535, "body": "Did you see this play example in the examples directory of portaudio? <a href=\"https://code.google.com/p/portaudio-go/source/browse/portaudio/examples/play.go\" rel=\"nofollow noreferrer\">code.google.com/p/portaudio-go/source/browse/portaudio/examp&zwnj;&#8203;les/&hellip;</a>"}, {"owner": {"reputation": 364, "user_id": 490223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72be98c51bb269a0228d2872c7f05607?s=128&d=identicon&r=PG", "display_name": "Jimmy Bernljung", "link": "https://stackoverflow.com/users/490223/jimmy-bernljung"}, "reply_to_user": {"reputation": 18829, "user_id": 24998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c14a4f2931fa9336fdccdfe11318fef?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/24998/jack"}, "edited": false, "score": 0, "creation_date": 1423785527, "post_id": 28489786, "comment_id": 45301612, "body": "Yes I saw that, I was not able to reproduce it with my .wav however."}], "answers": [{"tags": [], "owner": {"reputation": 1081, "user_id": 1976730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f2d3471083d1569b698ff42ca5f303?s=128&d=identicon&r=PG", "display_name": "sqweek", "link": "https://stackoverflow.com/users/1976730/sqweek"}, "is_accepted": false, "score": 7, "last_activity_date": 1433092942, "creation_date": 1433092942, "answer_id": 30560320, "question_id": 28489786, "link": "https://stackoverflow.com/questions/28489786/how-can-i-play-a-wav-file-in-go-with-portaudio-and-sndfile/30560320#30560320", "title": "How can I play a wav file in Go with portaudio and sndfile", "body": "<p>Aha, audio programming! Welcome to the world of soft-realtime computing :)</p>\n\n<p>Think about the flow of data: a bunch of bits in a .wav file on disk are read by your program and sent to the operating system which hands them off to a sound card where they are converted to an analog signal that drives speakers generating the sound waves that finally reach your ears.</p>\n\n<p>This flow is very sensitive to time fluctuations. If it is held up at any point you will perceive noticeable and sometimes jarring artifacts in the final sound.</p>\n\n<p>Generally the OS/sound card are solid and well tested - most audio artifacts are caused by us developers writing shoddy application code ;)</p>\n\n<p>Libraries such as PortAudio help us out by taking care of some of the thread proirity black magic and making the scheduling approachable. Essentially it says \"ok I'm going to start this audio stream, and every X milliseconds when I need the next bit of sample data I'll callback whatever function you provide.\"</p>\n\n<p>In this case you've provided a function that fills the output buffer with random data. To playback the wave file instead, you need to change this callback function.</p>\n\n<p>But! You don't want to be doing I/O in the callback. Reading some bytes off disk could take <em>tens</em> of milliseconds, and portaudio needs that sample data <em>now</em> so that it gets to the sound card in time. Similarly, you want to avoid acquiring locks or any other operation that could potentially block in the audio callback.</p>\n\n<p>For this example it's probably simplest to load the samples before starting the stream, and use something like this for the callback:</p>\n\n<p><code>\n    isample := 0\n    callback := func(out []int32) {\n        for i := 0; i &lt; len(out); i++ {\n            out[i] = framesOut[(isample + i) % len(framesOut)]\n        }\n        isample += len(out)\n    }\n</code></p>\n\n<p>Note that <code>% len(framesOut)</code> will cause the loaded 32000 samples to loop over and over - PortAudio will keep the stream running until you tell it to stop.</p>\n\n<p>Actually, you need to tell it to start too! After opening it call <code>stream.Start()</code> and add a sleep after that or your program is likely to exit before it gets a chance to play anything.</p>\n\n<p>Finally, this also assumes that the sample format in the wave file is the same as the sample format you requested from PortAudio. If the formats don't match you will still hear something, but it probably won't sound pretty! Anyway sample formats are a whole 'nother question.</p>\n\n<p>Of course loading all your sample data up front so you can refer to it within the audio callback isn't a fantastic approach except once you get past hello world stuff. Generally you use a ring-buffer or something similar to pass sample data to the audio callback.</p>\n\n<p>PortAudio provides another API (the \"blocking\" API) that does this for you. For portaudio-go, this is invoked by passing a slice into <code>OpenStream</code> instead of a function. When using the blocking API you pump sample data into the stream by (a) filling the slice you passed into <code>OpenStream</code> and (b) calling <code>stream.Write()</code>.</p>\n\n<p>This is much longer than I intended so I better leave it there. HTH.</p>\n"}], "owner": {"reputation": 364, "user_id": 490223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72be98c51bb269a0228d2872c7f05607?s=128&d=identicon&r=PG", "display_name": "Jimmy Bernljung", "link": "https://stackoverflow.com/users/490223/jimmy-bernljung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1500, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1433092942, "creation_date": 1423783308, "question_id": 28489786, "link": "https://stackoverflow.com/questions/28489786/how-can-i-play-a-wav-file-in-go-with-portaudio-and-sndfile", "title": "How can I play a wav file in Go with portaudio and sndfile", "body": "<p>First off, I'm new to the world of Go and lower level programming, so bear with me... :)</p>\n\n<p>So what I'm trying to do is this; read a .wav-file with the <a href=\"http://www.mega-nerd.com/libsndfile/\" rel=\"nofollow\">libsndfile</a> <a href=\"https://github.com/mkb218/gosndfile\" rel=\"nofollow\">binding</a> for Go and play it with <a href=\"https://code.google.com/p/portaudio-go/\" rel=\"nofollow\">portaudio</a>. </p>\n\n<p>I cannot find any examples for this, and clearly I lack basic knowledge about pointers, streams and buffers to make this happen. Here is my take on it so far, I've tried to read the docs and the few examples I've been able to find and put the pieces together. I think I'm able to open the file and the stream but I don't get how to connect the two.</p>\n\n<pre><code>package main\n\nimport (\n    \"code.google.com/p/portaudio-go/portaudio\"\n    \"fmt\"\n    \"github.com/mkb218/gosndfile/sndfile\"\n    \"math/rand\"\n)\n\nfunc main() {\n    portaudio.Initialize()\n    defer portaudio.Terminate()\n\n    // Open file with sndfile\n    var i sndfile.Info\n    file, fileErr := sndfile.Open(\"hello.wav\", sndfile.Read, &amp;i)\n    fmt.Println(\"File: \", file, fileErr)\n\n    // Open portaudio stream\n    h, err := portaudio.DefaultHostApi()\n    stream, err := portaudio.OpenStream(portaudio.HighLatencyParameters(nil, h.DefaultOutputDevice), func(out []int32) {\n        for i := range out {\n            out[i] = int32(rand.Uint32())\n        }\n    })\n    defer stream.Close()\n    fmt.Println(\"Stream: \", stream, err)\n\n    // Play portaudio stream\n    // ....\n    framesOut := make([]int32, 32000)\n    data, err := file.ReadFrames(framesOut)\n    fmt.Println(\"Data: \", data, err)\n}\n</code></pre>\n\n<p>I would be ever so grateful for a working example and some tips/links for beginners. If you have a solution that involves other libraries than the two mentioned above, that's ok too.</p>\n"}, {"tags": ["go", "shared-directory"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1423775989, "last_edit_date": 1495535398, "creation_date": 1423775989, "answer_id": 28487976, "question_id": 28487304, "link": "https://stackoverflow.com/questions/28487304/discover-shared-folders-for-a-given-computer/28487976#28487976", "title": "Discover shared folders for a given computer?", "body": "<p>That doesn't seem directly supported by Go libraries like <code>ioutil</code> or <code>net</code> or other packages.</p>\n\n<p>Instead that would depend on the file system used, and would best use a system command (<a href=\"https://stackoverflow.com/q/20437336/6309\"><code>exec.Command().Output()</code></a> ).<br>\nFor instance, for Windows, <code>net share</code> (for local shares) or <a href=\"https://superuser.com/a/769694/141\"><code>net view</code> (for remote shares)</a>.</p>\n"}], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 28487976, "answer_count": 1, "score": 2, "last_activity_date": 1423775989, "creation_date": 1423773493, "question_id": 28487304, "link": "https://stackoverflow.com/questions/28487304/discover-shared-folders-for-a-given-computer", "title": "Discover shared folders for a given computer?", "body": "<p>I'm trying to discover and walk the shared folders and files of a computer on my network, let's call it ComputerA. If I know ComputerA is sharing a folder called Source, I can use</p>\n\n<pre><code>files, err := ioutil.ReadDir(\"\\\\\\\\ComputerA\\\\Source\")\n</code></pre>\n\n<p>to get a list of all the files in Source. However, I can't do this to find Source (or any other shared folders)</p>\n\n<pre><code>files, err := ioutil.ReadDir(\"\\\\\\\\ComputerA\")\n</code></pre>\n\n<p>It seems that <code>ioutil</code> can't list the root shared folders using a UNC path like this. I've looked over the stock packages rather quickly and nothing else jumps out at me as a way to do this.</p>\n\n<p>It's not a permissions issue as far as I can tell. I can open up explorer and go straight to <code>\\\\ComputerA</code> and it'll work just fine.</p>\n\n<p>How else can I discover the shared folders for a specific computer on my network?</p>\n"}, {"tags": ["go", "return-value", "multiple-return-values"], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 704936, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f1b17e044c65c423a29f7af17ceea3ea?s=128&d=identicon&r=PG", "display_name": "Michael Wasser", "link": "https://stackoverflow.com/users/704936/michael-wasser"}, "edited": false, "score": 3, "creation_date": 1423774398, "post_id": 28487270, "comment_id": 45296802, "body": "I had suspected as much, but wasn&#39;t sure as I had trouble googling for the docs / a definitive answer. Thanks for the reference to the docs as well!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 32, "last_activity_date": 1441286287, "last_edit_date": 1441286287, "creation_date": 1423773331, "answer_id": 28487270, "question_id": 28487036, "link": "https://stackoverflow.com/questions/28487036/return-map-like-ok-in-golang-on-normal-functions/28487270#28487270", "title": "Return map like &#39;ok&#39; in Golang on normal functions", "body": "<p><code>map</code> is different because it is a built-in <em>type</em> and not a function. The 2 forms of accessing an element of a <code>map</code> is specified by the <a href=\"http://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">Go Language Specification: Index Expressions</a>.</p>\n\n<p>With functions you can't do this. If a function has 2 return values, you have to \"expect\" both of them or none at all.</p>\n\n<p>However you are allowed to assign any of the return values to the <a href=\"http://golang.org/ref/spec#Blank_identifier\" rel=\"noreferrer\">Blank identifier</a>:</p>\n\n<pre><code>s, b := Hello()    // Storing both of the return values\n\ns2, _ := Hello()   // Storing only the first\n\n_, b3 := Hello()   // Storing only the second\n</code></pre>\n\n<p>You can also choose not to store any of the return values:</p>\n\n<pre><code>Hello()            // Just executing it, but storing none of the return values\n</code></pre>\n\n<p>Note: you could also assign both of the return values to the blank identifier, although it has no use (other than validating that it has exactly 2 return values):</p>\n\n<pre><code>_, _ = Hello()     // Storing none of the return values; note the = instead of :=\n</code></pre>\n\n<p>You can also try these on the <a href=\"http://play.golang.org/p/W1st5rEi0Z\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Helper function</strong></p>\n\n<p>If you use it many times and you don't want to use the blank identifier, create a helper function which discards the 2nd return value:</p>\n\n<pre><code>func Hello2() string {\n    s, _ := Hello()\n    return s\n}\n</code></pre>\n\n<p>And now you can do:</p>\n\n<pre><code>value := Hello2()\nfmt.Println(value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1550915282, "creation_date": 1550915282, "answer_id": 54840318, "question_id": 28487036, "link": "https://stackoverflow.com/questions/28487036/return-map-like-ok-in-golang-on-normal-functions/54840318#54840318", "title": "Return map like &#39;ok&#39; in Golang on normal functions", "body": "<p>In addition to the explanation of @icza:</p>\n\n<ul>\n<li>I don't recommend using a helper function there. Especially if the <code>Hello</code> function is your own function.</li>\n<li>However, if you can't control it, then it's fine to use a helper.</li>\n<li>If it's your own function, it's better to change the signature of your function. Probably, you made a design mistake somewhere.</li>\n</ul>\n\n<p><strong>You can also do this:</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc Hello() (string, bool) {\n    return \"hello\", true\n}\n\nfunc main() {\n    // Just move it one line above: don't use a short-if\n    value, ok := Hello()\n    if ok {\n        fmt.Println(value)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 704936, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f1b17e044c65c423a29f7af17ceea3ea?s=128&d=identicon&r=PG", "display_name": "Michael Wasser", "link": "https://stackoverflow.com/users/704936/michael-wasser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9340, "favorite_count": 5, "accepted_answer_id": 28487270, "answer_count": 2, "score": 22, "last_activity_date": 1550915282, "creation_date": 1423772506, "last_edit_date": 1471358897, "question_id": 28487036, "link": "https://stackoverflow.com/questions/28487036/return-map-like-ok-in-golang-on-normal-functions", "title": "Return map like &#39;ok&#39; in Golang on normal functions", "body": "<p>In Go, the following works (note one use of the map has one return, the other has two returns)</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar someMap = map[string]string { \"some key\": \"hello\" }\n\nfunc main() {\n    if value, ok := someMap[\"some key\"]; ok {\n        fmt.Println(value)\n    }\n\n    value := someMap[\"some key\"]\n    fmt.Println(value)\n}\n</code></pre>\n\n<p>However, I have no idea how to do this same thing with my own function. Is it possible to have similar behavior with an optional return like <code>map</code>?</p>\n\n<p>For example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc Hello() (string, bool) {\n    return \"hello\", true\n}\n\nfunc main() {\n    if value, ok := Hello(); ok {\n        fmt.Println(value)\n    }\n\n    value := Hello()\n    fmt.Println(value)\n}\n</code></pre>\n\n<p>Wont compile (due to the error <code>multiple-value Hello() in single-value context</code>) ... is there a way to make this syntax work for the function <code>Hello()</code>?</p>\n"}, {"tags": ["http", "go", "request"], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 1, "creation_date": 1424205836, "post_id": 28506418, "comment_id": 45451350, "body": "Thank you for the explanations! It is ok to pass the entire request? Please, could you tell in which cases (real world example) do we need to use deadlines, cancelation signals?"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 15, "last_activity_date": 1424215271, "last_edit_date": 1592644375, "creation_date": 1423852701, "answer_id": 28506418, "question_id": 28486324, "link": "https://stackoverflow.com/questions/28486324/context-of-incoming-request/28506418#28506418", "title": "Context of incoming request", "body": "<p>One of the most common needs for context passing is correlating outgoing requests to incoming requests. I have used this for a variety of purposes, for example:</p>\n<ul>\n<li>I want error logs for my database component to include the full url from the http request it is a result of.</li>\n<li>Incoming http requests contain a set of headers that I need to preserve and pass on to other http services I call downstream (maybe for tracking reasons).</li>\n<li>I want to examine the incoming http request in some other component to do access control or user authentication or whatever. This could be at the http handler layer, or some other part of my application.</li>\n</ul>\n<p>Many languages and platforms have convenient/magical ways to get the current Http request. C# has <code>HttpRequest.Current</code> which is globally available (via thread local storage) to anyone who wants to know the context of the current http request. You can set arbitrary data on it to communicate various context data. Other platforms have similar facilities.</p>\n<p>Since go has no facilities for goroutine local storage, there is no way to store a global variable in the context of the current http request. Instead, it is idiomatic to initialize the context at the boundary of your system (an incoming request), and pass it as an argument to any downstream components that need access to that information.</p>\n<p>One super simple way to do this would be to make a context object with the current http request and pass that around:</p>\n<pre><code>func someHandler(w http.ResponseWriter, r * http.Request){\n   ctx := context.WithValue(context.Background(),&quot;request&quot;,r)\n   myDatabase.doSomething(ctx,....)\n}\n</code></pre>\n<p>You can of course limit it to a more targeted set of data you need to pass around rather than the entire request.</p>\n<p>The other thing that the context package helps with (and I think that blog does an ok job of pointing out), is a common framework for timeouts or deadlines.</p>\n<p>Note that the context package does not enforce timeouts for you. It is up to the components receiving a context object to watch the Done channel and self-cancel their own http request or database call or calculation or whatever.</p>\n<h2>edit - on timeouts</h2>\n<p>It is extremely useful to be able to manage timeouts from the outside of a component. If I have a database module, I don't need to hardcode timeout values, just be able to handle a timeout triggered from the outside.</p>\n<p>One way I have done this is in a service that makes multiple db / service calls per incoming request. If the total time exceeds 1 second, I want to abort all outbound operations and return a partial or error result. Initializing the context with a timeout at the top level and passing it to all dependencies is a really easy way to manage this.</p>\n<p>It is not always pretty for the dependency to listen to the Done channel and abort it's work, but as the blog shows, it is not terribly painful either.</p>\n"}, {"comments": [{"owner": {"reputation": 659, "user_id": 1155514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjZMX.jpg?s=128&g=1", "display_name": "Muhammad Tariq", "link": "https://stackoverflow.com/users/1155514/muhammad-tariq"}, "edited": false, "score": 0, "creation_date": 1612331851, "post_id": 52233079, "comment_id": 116730029, "body": "I think your post is not helpful and not answering the Question. Timur wants to  <code>understand how to use context for every incoming request and even why it is useful. How should I organize my code to create context (and what should it contain, generally) for every incoming request using the golang.org&#47;x&#47;net&#47;context package? </code>. Your answer is just a code sample without in depth explanation of <code>Golang Request Context</code>"}], "tags": [], "owner": {"reputation": 5450, "user_id": 942317, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/SY5ID.jpg?s=128&g=1", "display_name": "STEEL", "link": "https://stackoverflow.com/users/942317/steel"}, "is_accepted": false, "score": 0, "last_activity_date": 1536392040, "creation_date": 1536392040, "answer_id": 52233079, "question_id": 28486324, "link": "https://stackoverflow.com/questions/28486324/context-of-incoming-request/52233079#52233079", "title": "Context of incoming request", "body": "<p>I agree with @captncraig Answer here. But I just wanted to update the code related to passing context with ease.</p>\n\n<p>Let say you have a route <code>/foo</code>\n<code>http.Handle(\"/foo\", SimpleContextHandler(passContextHandler))</code></p>\n\n<p>In this case <code>SimpleContextHandler</code> is like a constructor and you initiate it like below.</p>\n\n<pre><code>type SimpleContextHandler func(w http.ResponseWriter, r *http.Request)\n\nfunc (fn SimpleContextHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    ctx := context.WithValue(context.Background(), \"Foo\", \"bar\")\n    fn(w, r.WithContext(ctx))\n}\n\nfunc passContextHandler(w http.ResponseWriter, r *http.Request) {\n    bar := r.Context().Value(\"Foo\").(string)\n    w.Write([]byte(bar))\n}\n</code></pre>\n\n<p>Have fun, please edit my answer if you still feel it can be improved since I have also started with GoLang few weeks back :) </p>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3565, "favorite_count": 6, "accepted_answer_id": 28506418, "answer_count": 2, "score": 11, "last_activity_date": 1536392040, "creation_date": 1423769948, "last_edit_date": 1439332965, "question_id": 28486324, "link": "https://stackoverflow.com/questions/28486324/context-of-incoming-request", "title": "Context of incoming request", "body": "<p>From time to time I am faced with the <strong>\"Context\"</strong> concept which, as a rule is created for all incoming requests. Recently I've read the <a href=\"https://blog.golang.org/context\">Go blog article</a> that describes using the <code>golang.org/x/net/context</code> package. However, after playing with the code and trying to reproduce the logic of the article, I still hardly understand how to use it for every incoming request and even why it is useful for this.</p>\n\n<p>How should I organize my code to create context (and what should it contain, generally) for every incoming request using the <code>golang.org/x/net/context</code> package? Could anybody give a little example and explain what is so useful and why so frequently used?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1423766488, "creation_date": 1423766488, "answer_id": 28485271, "question_id": 28485007, "link": "https://stackoverflow.com/questions/28485007/empty-struct-to-use-with-reflect-typeof/28485271#28485271", "title": "Empty struct to use with reflect.TypeOf", "body": "<p><code>&amp;Duck{}</code> points to a \"Zero\" struct instance, but it is most certainly not nil! You can assign values to it. You can't do all that to a nil pointer, regardless of the fact that they have the same type.</p>\n\n<p>If you're just interested in checking types, I suppose a nil pointer is more efficient as there are no allocations of objects involved. </p>\n\n<p>So it comes down to what exactly it is you want to do.</p>\n"}], "owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28485271, "answer_count": 1, "score": 1, "last_activity_date": 1423766492, "creation_date": 1423765626, "last_edit_date": 1423766492, "question_id": 28485007, "link": "https://stackoverflow.com/questions/28485007/empty-struct-to-use-with-reflect-typeof", "title": "Empty struct to use with reflect.TypeOf", "body": "<p>Whats the difference between <code>&amp;Duck{}</code> and <code>(*Duck)(nil)</code>?\nIs there any reason to prefer one over the other?</p>\n\n<p>ex:</p>\n\n<pre><code>    fmt.Println(reflect.TypeOf(&amp;Duck{}) == reflect.TypeOf((*Duck)(nil)))//true\n    fmt.Println(nil == (*Duck)(nil))//true\n    fmt.Println(nil == &amp;Duck{})//false\n</code></pre>\n"}, {"tags": ["pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 2268205, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e5df509d0a9555bc7130944b0f94540d?s=128&d=identicon&r=PG", "display_name": "Andrew Price", "link": "https://stackoverflow.com/users/2268205/andrew-price"}, "edited": false, "score": 0, "creation_date": 1423766414, "post_id": 28485021, "comment_id": 45292298, "body": "Thanks! I tried it out and noticed whenever I reference a local variable, it moves it to the heap. That clears a lot of stuff up."}], "tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": false, "score": 6, "last_activity_date": 1423766325, "last_edit_date": 1423766325, "creation_date": 1423765674, "answer_id": 28485021, "question_id": 28484976, "link": "https://stackoverflow.com/questions/28484976/storing-a-pointer-to-a-stack-value-golang/28485021#28485021", "title": "Storing a pointer to a stack value (Golang)", "body": "<p>Go doesn't distinguish between stack and heap as a language. Its implementations use escape analysis to prove that certain variables, even though they are referenced, can be placed on the stack safely. A naive implementation could just place all variables which are referenced in the heap.</p>\n\n<p>You can use the -m flag on 6g to print out performance optimizations such as when it places something on the stack or heap.</p>\n\n<p>Given your example:</p>\n\n<pre><code>$ go build -gcflags \"-m\" tmp.go \n# command-line-arguments\n./tmp.go:12: leaking param: vx\n./tmp.go:14: another_thread ... argument does not escape\n./tmp.go:16: another_thread ... argument does not escape\n./tmp.go:20: leaking param: vx\n./tmp.go:20: leaking param: vx\n./tmp.go:20: leaking param: vx\n./tmp.go:23: update_v ... argument does not escape\n./tmp.go:30: moved to heap: v1\n./tmp.go:33: &amp;v1 escapes to heap\n./tmp.go:36: &amp;v1 escapes to heap\n./tmp.go:33: alloc_on_stack ... argument does not escape\n./tmp.go:39: alloc_on_stack ... argument does not escape\n./tmp.go:45: make(chan bool, 0) escapes to heap\n./tmp.go:47: main ... argument does not escape\n./tmp.go:49: main ... argument does not escape\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": false, "score": 10, "last_activity_date": 1423765726, "creation_date": 1423765726, "answer_id": 28485041, "question_id": 28484976, "link": "https://stackoverflow.com/questions/28484976/storing-a-pointer-to-a-stack-value-golang/28485041#28485041", "title": "Storing a pointer to a stack value (Golang)", "body": "<p>Nope. The Go compiler detects that you are taking the address of a local variable, and keeps it around until all references to it are gone. From then on, the variable can be garbage collected.</p>\n\n<p>This is why stuff like this isn't just allowed, it's even idiomatic:</p>\n\n<pre><code>func foo() *Bar {\n  return &amp;Bar{42, \"frob\"}\n}\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 2268205, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e5df509d0a9555bc7130944b0f94540d?s=128&d=identicon&r=PG", "display_name": "Andrew Price", "link": "https://stackoverflow.com/users/2268205/andrew-price"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1749, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1423766325, "creation_date": 1423765484, "question_id": 28484976, "link": "https://stackoverflow.com/questions/28484976/storing-a-pointer-to-a-stack-value-golang", "title": "Storing a pointer to a stack value (Golang)", "body": "<p>I'm trying an experiment in Go, to see what happens if I store a pointer to a variable on the stack, and then access that variable after the original variable has left scope.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar p chan bool;\n\n// a temp struct\ntype v struct {\n    a int\n}\n\nfunc another_thread(vx *v) {\n    // this code should be executed after a() returns so vx should be a pointer to a value that's no longer on the stack\n    fmt.Printf(\"another_thread(): %p\\n\", vx);\n    vx.a = 4 // am I updating a dangling pointer that may have unintentional side effects??\n    fmt.Println(\" - \", vx.a);\n    p&lt;-true;\n}\n\nfunc update_v(vx *v) {\n    vx.a = 3;\n\n    fmt.Printf(\"update_v(): %p\\n\", vx);\n\n    go another_thread(vx)\n}\n\nfunc alloc_on_stack() {\n    // allocate v1 on the stack\n    var v1 v\n    v1.a = 1\n\n    fmt.Printf(\"alloc_on_stack(): %p\\n\", &amp;v1);\n\n    // pass a pointer to v1 on the stack\n    update_v(&amp;v1)\n\n    // print '3' to prove byref actually took it by reference\n    fmt.Println(\" - \", v1.a);\n\n    // when the function returns, v1 should be popped off the stack\n}\n\nfunc main() {\n    p = make(chan bool)\n    alloc_on_stack();\n    fmt.Println(\"outside of alloc_on_stack, waiting\");\n    &lt;-p;\n    fmt.Println(\"done\");\n}\n</code></pre>\n\n<p>In alloc_on_stack, v1 is stored as a local variable on the stack. I pass a pointer to v1 to update_v, which passes it to another_thread. By another_thread doesn't execute until after alloc_on_stack finishes.</p>\n\n<p>Yet, when I run that code, I don't get any errors, instead I see this:</p>\n\n<pre><code>alloc_on_stack(): 0x1043617c\nupdate_v(): 0x1043617c\n -  3\noutside of alloc_on_stack, waiting\nanother_thread(): 0x1043617c\n -  4\ndone\n</code></pre>\n\n<p>Shouldn't vx inside another_thread be a dangling pointer?</p>\n"}, {"tags": ["unicode", "go"], "answers": [{"comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1423762918, "post_id": 28482676, "comment_id": 45290322, "body": "Any idea why this distinction exists?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 1, "creation_date": 1423765903, "post_id": 28482676, "comment_id": 45292048, "body": "@synful Don&#39;t know for sure, but guessing that it&#39;s for <a href=\"https://en.wikipedia.org/wiki/Escape_sequences_in_C#Universal_character_names\" rel=\"nofollow noreferrer\">compatibility with C</a>. And C (I guess) might have this because Unicode was <a href=\"https://en.wikipedia.org/wiki/Unicode#History\" rel=\"nofollow noreferrer\">planned as a 16-bit charset</a>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 6, "last_activity_date": 1423758506, "creation_date": 1423758506, "answer_id": 28482676, "question_id": 28482562, "link": "https://stackoverflow.com/questions/28482562/go-unicode-code-points/28482676#28482676", "title": "Go unicode code points", "body": "<p>Lowercase <code>\\u</code> is for Unicode code points from <code>\\u0000</code> to <code>\\uFFFF</code>. Use <code>\\U</code> if you want to have code points above 0xFFFF:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"\ud83c\udca1 = \\U0001F0A1\")\n}\n</code></pre>\n\n<p>See also: <a href=\"https://play.golang.org/p/W1wPHEL0ym\" rel=\"noreferrer\">playground</a> and <a href=\"http://golang.org/ref/spec#String_literals\" rel=\"noreferrer\">the string literals section</a> of the specification.</p>\n"}], "owner": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 28482676, "answer_count": 1, "score": 4, "last_activity_date": 1423758506, "creation_date": 1423758271, "question_id": 28482562, "link": "https://stackoverflow.com/questions/28482562/go-unicode-code-points", "title": "Go unicode code points", "body": "<p>How do you encode unicode code points in Go? In the example below I'm storing the hex representation of the unicode for <a href=\"http://en.wikipedia.org/wiki/Playing_cards_in_Unicode\" rel=\"nofollow\">ace of spades</a> as <code>\\u1F0A1</code> but when I print it comes out as <code>\u1f0a1</code>. Why is that? If I copy and paste the ace of spades glyph it prints fine.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"\ud83c\udca1 \\u1F0A1\")\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>\ud83c\udca1 \u1f0a1\n</code></pre>\n\n<p>Example above in the Go playground <a href=\"https://play.golang.org/p/ukK57CnVuE\" rel=\"nofollow\">https://play.golang.org/p/ukK57CnVuE</a></p>\n"}, {"tags": ["reflection", "methods", "go", "runtime"], "answers": [{"comments": [{"owner": {"reputation": 1037, "user_id": 2730407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ea8cbda44bec55c4db6250eff89bbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ronna", "link": "https://stackoverflow.com/users/2730407/ronna"}, "edited": false, "score": 0, "creation_date": 1423757282, "post_id": 28481733, "comment_id": 45286477, "body": "Interesting... What about swapping method pointers on an object? (maybe I should ask that in another thread) - and yes, I&#39;m well aware I&#39;m not &quot;supposed&quot; to be doing any of this ;)"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 2, "last_activity_date": 1423758545, "last_edit_date": 1423758545, "creation_date": 1423755970, "answer_id": 28481733, "question_id": 28481354, "link": "https://stackoverflow.com/questions/28481354/is-it-possible-to-dynamically-create-a-function-with-a-receiver-method-in-go/28481733#28481733", "title": "Is it possible to dynamically create a function with a receiver (method) in go?", "body": "<p>No, this is not possible because the receiver's type <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow\">method set</a> would change on runtime if you did this. As you may know, Go in its current implementations is type checked at compile time. You would require runtime interface-implementation checks on every function-call that takes an interface argument if a type could  suddenly acquire (or lose) methods at runtime.</p>\n\n<blockquote>\n  <p>a way to create a Method (a function with a receiver) at runtime</p>\n</blockquote>\n\n<p>Technically, though, you <em>could</em> build a value representing a method attached to an arbitrary type by forking the reflect package. This would not, however, change said type's method set because it'd be essentially a hack around Go's type system.</p>\n\n<hr>\n\n<blockquote>\n  <p>What about swapping method pointers on an object?</p>\n</blockquote>\n\n<p>Go, unlike e.g. Java does not embed a virtual method dispatch table in concrete values, <a href=\"http://research.swtch.com/interfaces\" rel=\"nofollow\">only in interface values</a>. If you're willing to get your hands dirty you could get a hold of a <a href=\"https://github.com/golang/go/blob/release-branch.go1.4/src/reflect/value.go#L174\" rel=\"nofollow\"><code>reflect.nonEmptyInterface</code></a> and modify its <em>itable</em> (itab field).</p>\n"}], "owner": {"reputation": 1037, "user_id": 2730407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ea8cbda44bec55c4db6250eff89bbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ronna", "link": "https://stackoverflow.com/users/2730407/ronna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 1, "accepted_answer_id": 28481733, "answer_count": 1, "score": 1, "last_activity_date": 1423758545, "creation_date": 1423754933, "question_id": 28481354, "link": "https://stackoverflow.com/questions/28481354/is-it-possible-to-dynamically-create-a-function-with-a-receiver-method-in-go", "title": "Is it possible to dynamically create a function with a receiver (method) in go?", "body": "<p>I was reading about <a href=\"http://golang.org/pkg/reflect/#MakeFunc\" rel=\"nofollow\">reflect.MakeFunc</a> and was wondering if there's also a way to create a <a href=\"http://golang.org/pkg/reflect/#Method\" rel=\"nofollow\">Method</a> (a function with a receiver) at runtime.</p>\n"}, {"tags": ["arrays", "json", "go"], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 2422033, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jAnBl.jpg?s=128&g=1", "display_name": "mquemazz", "link": "https://stackoverflow.com/users/2422033/mquemazz"}, "edited": false, "score": 0, "creation_date": 1423747952, "post_id": 28478348, "comment_id": 45280060, "body": "Perfect, I guess until the moment I am not used enough to the embedding thing and nested structs in Go, after all years dealing with java, this is completely new to me, but thanks a lot :D"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 32, "last_activity_date": 1423747010, "last_edit_date": 1423747010, "creation_date": 1423746688, "answer_id": 28478348, "question_id": 28478221, "link": "https://stackoverflow.com/questions/28478221/initialize-an-array-of-structs-inside-a-nested-struct-in-golang/28478348#28478348", "title": "Initialize an array of structs inside a nested struct in golang", "body": "<p>In your case the shorthand literal syntax would be:</p>\n\n<pre><code>state := State {\n    id: \"CA\",\n    Cities:  Cities{\n        []City {\n            {\"SF\"},\n        },\n    },\n}\n</code></pre>\n\n<p>Or shorter if you don't want the key:value syntax for literals:</p>\n\n<pre><code>state := State {\n    \"CA\", Cities{\n        []City {\n            {\"SF\"},\n        },\n    },\n}    \n</code></pre>\n\n<p>BTW if Cities doesn't contain anything other than the []City, just use a slice of City. This will lead to a somewhat shorter syntax, and remove an unnecessary (possibly) layer:</p>\n\n<pre><code>type State struct {\n    id string `json:\"id\" bson:\"id\"`\n    Cities []City\n}\n\ntype City struct {\n    id string `json:\"id\" bson:\"id\"`\n}\n\n\nfunc main(){\n    state := State {\n        id: \"CA\",\n        Cities:  []City{\n             {\"SF\"},\n        },\n    }\n\n    fmt.Println(state)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 6, "last_activity_date": 1423746716, "creation_date": 1423746716, "answer_id": 28478357, "question_id": 28478221, "link": "https://stackoverflow.com/questions/28478221/initialize-an-array-of-structs-inside-a-nested-struct-in-golang/28478357#28478357", "title": "Initialize an array of structs inside a nested struct in golang", "body": "<p>Full example with everything written out explicitly:</p>\n\n<pre><code>state := State{\n    id: \"Independent Republic of Stackoverflow\",\n    Cities: Cities{\n        cities: []City{\n            City{\n                id: \"Postington O.P.\",\n            },\n        },\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 2422033, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jAnBl.jpg?s=128&g=1", "display_name": "mquemazz", "link": "https://stackoverflow.com/users/2422033/mquemazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36207, "favorite_count": 5, "accepted_answer_id": 28478348, "answer_count": 2, "score": 27, "last_activity_date": 1423747010, "creation_date": 1423746295, "question_id": 28478221, "link": "https://stackoverflow.com/questions/28478221/initialize-an-array-of-structs-inside-a-nested-struct-in-golang", "title": "Initialize an array of structs inside a nested struct in golang", "body": "<p>I am wondering how can I define and initialize and array of structs inside a nested struct, for example:</p>\n\n<pre><code>type State struct {\n    id string `json:\"id\" bson:\"id\"`\n    Cities \n}\n\ntype City struct {\n    id string `json:\"id\" bson:\"id\"`\n}\n\ntype Cities struct {\n    cities []City\n}\n</code></pre>\n\n<p>Now how can I Initialize such a structure and if someone has a different idea about how to create the structure itself.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1423742057, "post_id": 28476307, "comment_id": 45276524, "body": "I wouldn&#39;t consider a test authoritative if the tested code needs to know if it is being tested (and hence run differently). The test will not test code paths that would get executed if it were told that it is not being tested. All the code that needs to know if a test is being executed should be in the <code>XX_test.go</code> files."}, {"owner": {"reputation": 1641, "user_id": 3828156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scFYI.jpg?s=128&g=1", "display_name": "chendesheng", "link": "https://stackoverflow.com/users/3828156/chendesheng"}, "edited": false, "score": 0, "creation_date": 1423770306, "post_id": 28476307, "comment_id": 45294596, "body": "If you want different configs in tests why not just setup at the beginning of the test function?"}], "answers": [{"comments": [{"owner": {"reputation": 3881, "user_id": 799550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/070aab749e66879e8ad53d186cc064b5?s=128&d=identicon&r=PG", "display_name": "songyy", "link": "https://stackoverflow.com/users/799550/songyy"}, "edited": false, "score": 0, "creation_date": 1513663543, "post_id": 28476697, "comment_id": 82727617, "body": "But does it means that one needs to include this code in all the test code?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 3881, "user_id": 799550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/070aab749e66879e8ad53d186cc064b5?s=128&d=identicon&r=PG", "display_name": "songyy", "link": "https://stackoverflow.com/users/799550/songyy"}, "edited": false, "score": 0, "creation_date": 1513672020, "post_id": 28476697, "comment_id": 82731135, "body": "@songyy I don&#39;t understand what you mean. This is only done once per package."}, {"owner": {"reputation": 3881, "user_id": 799550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/070aab749e66879e8ad53d186cc064b5?s=128&d=identicon&r=PG", "display_name": "songyy", "link": "https://stackoverflow.com/users/799550/songyy"}, "edited": false, "score": 0, "creation_date": 1513758955, "post_id": 28476697, "comment_id": 82770199, "body": "suppose we have 2 files needs to check the <code>isTesting</code> property. Then in each of the 2 files, we&#39;ll need to define the <code>isTesting</code> variable is it..?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 3881, "user_id": 799550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/070aab749e66879e8ad53d186cc064b5?s=128&d=identicon&r=PG", "display_name": "songyy", "link": "https://stackoverflow.com/users/799550/songyy"}, "edited": false, "score": 0, "creation_date": 1513759616, "post_id": 28476697, "comment_id": 82770558, "body": "@songyy Again, if those files are in the same package, then no. This is done once per package."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1423741745, "creation_date": 1423741745, "answer_id": 28476697, "question_id": 28476307, "link": "https://stackoverflow.com/questions/28476307/how-to-get-test-environment-at-run-time/28476697#28476697", "title": "How to get test environment at run time", "body": "<p>Just specify that you run a test in test's <code>init</code>. For example, in pkg.go:</p>\n\n<pre><code>package pkg\n\nvar isTesting = false\n\n// ...\n</code></pre>\n\n<p>And in pkg_test.go:</p>\n\n<pre><code>package pkg\n\nfunc init() {\n    isTesting = true\n}\n\n// ...\n</code></pre>\n\n<p>This technique can be used not just with <code>bool</code>s but with any data or function. If you have some variable in your package (in your case, a configuration variable), you can just override it in <code>init</code>.</p>\n"}], "owner": {"reputation": 1047, "user_id": 2822466, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/jXerW.jpg?s=128&g=1", "display_name": "ggaaooppeenngg", "link": "https://stackoverflow.com/users/2822466/ggaaooppeenngg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3511, "favorite_count": 0, "accepted_answer_id": 28476697, "answer_count": 1, "score": 0, "last_activity_date": 1612519512, "creation_date": 1423740524, "last_edit_date": 1612519512, "question_id": 28476307, "link": "https://stackoverflow.com/questions/28476307/how-to-get-test-environment-at-run-time", "title": "How to get test environment at run time", "body": "<p>I want to check if codes are running for the <code>go test</code>,so that I could make some configurations.</p>\n\n<p>Is there any function to do that?\nLike:</p>\n\n<p>runtime.IsBeingTested()</p>\n"}, {"tags": ["go", "exit"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 11, "creation_date": 1423732326, "post_id": 28472922, "comment_id": 45270591, "body": "Just a comment that will hopefully help in future Go code reading: In a lot of example code, <code>panic</code> is used to exit on error, purely due to the fact that it&#39;s easy to understand, and eliminates importing any other packages. This <i>doesn&#39;t mean it&#39;s good, or idiomatic practice!</i>. It&#39;s just a space saving device for example code. IRL reserve <code>panic</code> for <i>very</i> special situations."}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 2, "creation_date": 1423732561, "post_id": 28472922, "comment_id": 45270732, "body": "Hm..good) especially &quot;IRL&quot; abbreviation - it&#39;s new for me :) Could you explain how panic eliminates package importing?"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 6, "creation_date": 1423732862, "post_id": 28472922, "comment_id": 45270916, "body": "<code>panic</code> is a builtin. It&#39;s recommended (depending on circumstance) to use something like <code>os.Exit</code>, <code>log.Fatal</code> etc., which will return an error code to the OS (always recommended if possible). These all involve importing a package, and thus &quot;clutter up&quot; example code. Example code should always only be taken to demonstrate a solution to a specific problem. There may be other problems with the code, which make the code more complex if properly demonstrated, and therefore detract from the explanation of the answer given. YMMV."}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1423734028, "post_id": 28472922, "comment_id": 45271648, "body": "Ok, got it!) Big thanks) I see there is yet another abbreviation for my vocabulary :)"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 2, "creation_date": 1423734244, "post_id": 28472922, "comment_id": 45271777, "body": "NP, happy to help, and to increase your acronymic lexicon :-)"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1552421626, "post_id": 28472922, "comment_id": 97001527, "body": "can&#39;t upvote @Intermernet &#39;s comment enough! There is no production code case where a panic (or even os.Exit would ever be needed). A memory allocation failure is the only scenario for a panic. And os.Exit is just lazy - wait for your go-routines to complete!"}], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1423732617, "post_id": 28473273, "comment_id": 45270765, "body": "Thanks very helpful!)"}, {"owner": {"reputation": 6555, "user_id": 433650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tB6Ej.png?s=128&g=1", "display_name": "psousa", "link": "https://stackoverflow.com/users/433650/psousa"}, "edited": false, "score": 16, "creation_date": 1505669073, "post_id": 28473273, "comment_id": 79496189, "body": "&quot;So basically panic is for you, a bad exit code is for your user.&quot; &lt;- Awesome tip"}, {"owner": {"reputation": 8212, "user_id": 83331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b6ce7a43b172768e46dcbe233f772931?s=128&d=identicon&r=PG", "display_name": "yves Baumes", "link": "https://stackoverflow.com/users/83331/yves-baumes"}, "edited": false, "score": 1, "creation_date": 1522077636, "post_id": 28473273, "comment_id": 85993785, "body": "Could we say that panic() is somehow related to the usual assert() call in plain C? Well.. I know I always remove asserting call before pushing to production, I only enable them when testing a new feature. What I am saying is that most of time I use assert() to verify invariants that I guess must hold true in my code. Do you see the same usage for panic() ? :-)"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 90, "last_activity_date": 1423731905, "creation_date": 1423731905, "answer_id": 28473273, "question_id": 28472922, "link": "https://stackoverflow.com/questions/28472922/when-to-use-os-exit-and-panic/28473273#28473273", "title": "When to use os.Exit() and panic()?", "body": "<p>First of all, <code>os.Exit()</code> can be used to exit the program normally without an error, and panic not, so that's one key distinction. Another is that panic somewhere can be caught and ignored or logged using <code>recover</code>.</p>\n\n<p>But if we're talking about an erroneous exit code, let's say:</p>\n\n<p>Use <code>panic</code> when something goes horribly wrong, probably a programmer error that should have been caught before going to production. This is why it prints the stack. </p>\n\n<p>Use <code>os.Exit(errorCode)</code> or something like that if you want to:</p>\n\n<ol>\n<li><p>control the exit code of the program for scripting purposes.</p></li>\n<li><p>want an orderly exit on an error that is expected (e.g user input error).</p></li>\n</ol>\n\n<p>So basically panic is for you, a bad exit code is for your user. </p>\n"}, {"comments": [{"owner": {"reputation": 34067, "user_id": 38140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9699fa348a28c4accd81ebce0a91?s=128&d=identicon&r=PG", "display_name": "gotgenes", "link": "https://stackoverflow.com/users/38140/gotgenes"}, "edited": false, "score": 10, "creation_date": 1477853517, "post_id": 28473339, "comment_id": 67919778, "body": "&quot;This is useful in tests, when you already know that after this one test fails, the other will fail as well\u2026&quot; This smells of a testing anti-pattern of dependent tests. In a well-written test suite, each test is independent; the outcome of any given test should never determine the outcome of any other test."}, {"owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "reply_to_user": {"reputation": 34067, "user_id": 38140, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9699fa348a28c4accd81ebce0a91?s=128&d=identicon&r=PG", "display_name": "gotgenes", "link": "https://stackoverflow.com/users/38140/gotgenes"}, "edited": false, "score": 1, "creation_date": 1546469982, "post_id": 28473339, "comment_id": 94865677, "body": "@gotgenes Not necessarily. If I have a test that a certain function returns a non-nil struct, and that test fails, then I can expect that all the tests that examine the values of the struct are going to fail, too. It&#39;s the code that&#39;s dependent, not the tests. (That said, I wouldn&#39;t use <code>exit</code> in that case, I&#39;d just expect a big stack of failed assertions.)"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 88, "last_activity_date": 1423732081, "creation_date": 1423732081, "answer_id": 28473339, "question_id": 28472922, "link": "https://stackoverflow.com/questions/28472922/when-to-use-os-exit-and-panic/28473339#28473339", "title": "When to use os.Exit() and panic()?", "body": "<p>First of all, whenever you have a \"how it is used in practice\" question, a good way to start is to <a href=\"http://golang.org/search?q=os.Exit\">search</a> the Go source code (or any big enough Go code base, really), and the <a href=\"http://golang.org/pkg/os/#Exit\">package docs</a> for answers.</p>\n\n<p>Now, <code>os.Exit</code> and <code>panic</code> are quite different. <a href=\"http://golang.org/doc/effective_go.html#panic\"><code>panic</code></a> is used when the program, or its part, has reached an unrecoverable state.</p>\n\n<blockquote>\n  <p>When <code>panic</code> is called, including implicitly for run-time errors such as indexing a slice out of bounds or failing a type assertion, it immediately stops execution of the current function and begins unwinding the stack of the goroutine, running any deferred functions along the way. If that unwinding reaches the top of the goroutine's stack, the program dies.</p>\n</blockquote>\n\n<p><code>os.Exit</code> is used when you need to abort the program <em>immediately,</em> with no possibility of recovery or running a deferred clean-up statement, and also return an error code (that other programs can use to report what happened). This is useful in tests, when you already know that after this one test fails, the other will fail as well, so you might as well just exit now. This can also be used when your program has done everything it needed to do, and now just needs to exit, i.e. after printing a help message.</p>\n\n<p>Most of the time you won't use <code>panic</code> (you should return an <code>error</code> instead), and you almost never need <code>os.Exit</code> outside of some cases in tests and for quick program termination.</p>\n"}, {"tags": [], "owner": {"reputation": 23476, "user_id": 222893, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/255b0472c4482c3ea433ab84b4e742e8?s=128&d=identicon&r=PG", "display_name": "weakish", "link": "https://stackoverflow.com/users/222893/weakish"}, "is_accepted": false, "score": 7, "last_activity_date": 1552412748, "creation_date": 1552412748, "answer_id": 55127714, "question_id": 28472922, "link": "https://stackoverflow.com/questions/28472922/when-to-use-os-exit-and-panic/55127714#55127714", "title": "When to use os.Exit() and panic()?", "body": "<p>The key differences are:</p>\n\n<ol>\n<li><code>os.Exit</code> skips the execution of deferred function.</li>\n<li>With <code>os.Exit</code>, you can specify the exit code.</li>\n<li><code>panic</code> is terminating while <code>os.Exit</code> is not. (Seems other answers do not mention this.)</li>\n</ol>\n\n<p>If you need to execute the deferred function, you have no choice but <code>panic</code>. (On the other hand, if you want to skip execution of deferred function, use <code>os.Exit</code>.)</p>\n\n<p>If a non-void function is defined in such a way:</p>\n\n<ol>\n<li>the function contains a lot of branches</li>\n<li>all branches are terminated with <code>return</code> or <code>panic</code></li>\n</ol>\n\n<p>Then you cannot replace <code>panic</code> with <code>os.Exit</code> otherwise the compiler will refuse to compile the program, saying \"missing return at end of function\". (Go is very dumb here, even <code>log.Panic</code> does not terminate a function.)</p>\n\n<p>Under other conditions:</p>\n\n<ol>\n<li>Use <code>panic</code> when something really wired happens, e.g. programming logic error.</li>\n<li>Use <code>os.Exit</code> when you want an immediate exit, with specified exit code. </li>\n</ol>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60318, "favorite_count": 21, "accepted_answer_id": 28473339, "answer_count": 3, "score": 101, "last_activity_date": 1552412748, "creation_date": 1423730735, "last_edit_date": 1531518681, "question_id": 28472922, "link": "https://stackoverflow.com/questions/28472922/when-to-use-os-exit-and-panic", "title": "When to use os.Exit() and panic()?", "body": "<p>Could someone explain the key differences between <code>os.Exit()</code> and <code>panic()</code> and how they are used in practice in Go?</p>\n"}, {"tags": ["go", "sqlite"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1423709233, "post_id": 28468372, "comment_id": 45262139, "body": "Dear lord - perhaps you could give us a smaller - nicer variable name - reproduction of your issue?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1423722036, "post_id": 28468372, "comment_id": 45265770, "body": "<code>rows.Scan</code> returns an error. Please inspect it, it may give you some pointers to the solution."}, {"owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1423750458, "post_id": 28468372, "comment_id": 45281712, "body": "@Ainar-G I used Rows.Err() at the end of each loop iteration and that returned nil for each row but I will look at if rows.Scan returns an error when I get the chance later today"}], "answers": [{"tags": [], "owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "is_accepted": true, "score": 0, "last_activity_date": 1423800134, "creation_date": 1423800134, "answer_id": 28492287, "question_id": 28468372, "link": "https://stackoverflow.com/questions/28468372/querying-sqlite-db-with-go-but-none-of-the-rows-are-being-scanned-into-variables/28492287#28492287", "title": "Querying sqlite db with Go but none of the rows are being scanned into variables", "body": "<p>Rows.Scan will not scan value  to types int and string without throwing an error. The correct type to use was sql.NullInt64 and sql.NullString, these types will hold the value properly and have a bool val that is used to check whether it is nil or not.</p>\n"}], "owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 28492287, "answer_count": 1, "score": 2, "last_activity_date": 1423800134, "creation_date": 1423708936, "last_edit_date": 1423799685, "question_id": 28468372, "link": "https://stackoverflow.com/questions/28468372/querying-sqlite-db-with-go-but-none-of-the-rows-are-being-scanned-into-variables", "title": "Querying sqlite db with Go but none of the rows are being scanned into variables", "body": "<p>I am running a query through Go using </p>\n\n<pre><code>stmt, err := db.Prepare(sqlstring)\nif err != nil{\n    log.Fatal(err)\n}\ndefer stmt.Close()\n</code></pre>\n\n<p>this is the sql string with ? being '\u5b89'</p>\n\n<pre><code>select\n  k_ele.value as kanji,  id as k_ele_id,\n  NULL as r_ele_id, NULL as r_ele_val,\n  NULL as gloss_id, NULL as gloss_val\nfrom k_ele where value like ?\nUNION ALL\nselect\n  k_ele.value as kanji,  NULL as k_ele_id,\n  r_ele.id as r_ele_id, r_ele.value as r_ele_val,\n  NULL as gloss_id, NULL as gloss_val\nfrom\n  r_ele, k_ele where k_ele.value like ? and k_ele.fk = r_ele.fk\nUNION ALL\nselect\n  k_ele.value as kanji,  NULL as k_ele_id,\n  NULL as r_ele_id, NULL as r_ele_val,\n  gloss.id as gloss_id, gloss.value as gloss_val\nfrom\n  sense, gloss, k_ele\nwhere\n  k_ele.value like ? and\n  k_ele.fk = sense.fk and\n  gloss.fk = sense.id;\n</code></pre>\n\n<p>This query can be used fine through sqlite3 on console and DB Browser for SQLite and returns 8 rows and even the for loop in the go code loops 8 times.</p>\n\n<p>The problem is that during </p>\n\n<pre><code>rows.Scan()\n</code></pre>\n\n<p>none of the column values are being stored in the variables except kanji which appears in every row (since it is in every row) but nothing but kanji is printed out in log.Println().</p>\n\n<pre><code>    rows, err := stmt.Query(parameter,parameter,parameter)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer rows.Close()\n    for rows.Next() {\n        var kanji, r_ele_val, gloss_val string\n        var k_ele_id, r_ele_id, gloss_id int\n\n        rows.Scan(&amp;kanji,&amp;k_ele_id,&amp;r_ele_id,&amp;r_ele_val,&amp;gloss_id,&amp;gloss_val)\n        log.Println(kanji,k_ele_id, r_ele_id,r_ele_val,gloss_id,gloss_val)\n    }\n</code></pre>\n\n<p>Here is the output (It is ? because my cmd can't print the japanese characters (if the ? is sent to my browser, it will properly show the character)</p>\n\n<pre><code>2015/02/11 22:18:42 ? 105921 0  0\n2015/02/11 22:18:42 ? 0 0  0\n2015/02/11 22:18:43 ? 0 0  0\n2015/02/11 22:18:43 ? 0 0  0\n2015/02/11 22:18:43 ? 0 0  0\n2015/02/11 22:18:43 ? 0 0  0\n2015/02/11 22:18:43 ? 0 0  0\n2015/02/11 22:18:43 ? 0 0  0\n</code></pre>\n\n<p>The strange thing is if I change the order of the columns for example putting gloss_id, gloss_val first in the select statement. <strong>Every variable</strong> gets 0 stored, even kanji before a gloss_id has a value. (These are the same sets of data)</p>\n\n<pre><code>2015/02/11 22:23:12  0 0  0\n2015/02/11 22:23:12  0 0  0\n2015/02/11 22:23:13 ? 0 0  197326 cheap\n2015/02/11 22:23:13 ? 0 0  197327 rash\n2015/02/11 22:23:13 ? 0 0  197328 thoughtless\n2015/02/11 22:23:13 ? 0 0  197329 careless\n2015/02/11 22:23:13 ? 0 0  197330 indiscreet\n2015/02/11 22:23:13 ? 0 0  197331 frivolous\n</code></pre>\n\n<p>The sql works perfectly fine in sqlite3, the Golang for loop runs the correct number of times as well. Here is what the data should look like.</p>\n\n<p><img src=\"https://i.stack.imgur.com/yFuvv.png\" alt=\"Query from DB Browser for SQLite\"></p>\n\n<p>I'm not sure if this is a bug or is there something wrong with what I'm doing? I suspect it is a problem with UNION ALL but I'm not sure how to get this working.</p>\n\n<p><strong>EDIT:</strong> I made rows.Scan return err this time as well as printout the columns</p>\n\n<pre><code>        err := rows.Scan(&amp;kanji,&amp;k_ele_id,&amp;r_ele_id,&amp;r_ele_val,&amp;gloss_id,&amp;gloss_val)\n        if err != nil {\n            log.Print(\"rows.Column(): \")\n            log.Println(rows.Columns())\n            log.Println(kanji,k_ele_id, r_ele_id,r_ele_val,gloss_id,gloss_val)\n            log.Fatal(err)\n        }\n\n2015/02/12 22:38:56 rows.Column():\n2015/02/12 22:38:56 [kanji k_ele_id r_ele_id r_ele_val gloss_id gloss_val] &lt;nil&gt;\n\n2015/02/12 22:38:56 ? 105921 0  0\n2015/02/12 22:38:56 sql: Scan error on column index 2: converting string \"&lt;nil&gt;\"\n to a int: strconv.ParseInt: parsing \"&lt;nil&gt;\": invalid syntax\n</code></pre>\n\n<p>The error message says that there is an attempt to convert string  to int in column index 2 (r_ele_id) but isn't r_ele_id an int already (as can be seen in the picture of my schema)? Because of the need to use UNION ALL for this query there are going to be NULLs in every row, I believe I need to use type NullInt64 instead of int for the *id types. Will try this now and report back</p>\n"}, {"tags": ["go", "ansi-colors"], "answers": [{"comments": [{"owner": {"reputation": 1074, "user_id": 1786516, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4feb9a577f98b387ebde4f5699bc1a3d?s=128&d=identicon&r=PG", "display_name": "That Marc", "link": "https://stackoverflow.com/users/1786516/that-marc"}, "edited": false, "score": 1, "creation_date": 1459530403, "post_id": 28468331, "comment_id": 60343409, "body": "Meanwhile, the &quot;m&quot; is the ANSI Code terminator."}], "tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": true, "score": 5, "last_activity_date": 1423708691, "creation_date": 1423708691, "answer_id": 28468331, "question_id": 28468270, "link": "https://stackoverflow.com/questions/28468270/ansi-what-does-this-sequence-mean/28468331#28468331", "title": "ANSI what does this sequence mean?", "body": "<p>Ah I see, <a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code\">wikipedia</a> has more complete reference</p>\n\n<p><code>38</code> is <code>Reserved for extended set foreground color</code></p>\n\n<p><code>05</code> is <code>next is the color index</code></p>\n\n<p><code>4</code> is <code>color blue</code></p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 28468331, "answer_count": 1, "score": 2, "last_activity_date": 1424598859, "creation_date": 1423708238, "last_edit_date": 1424598859, "question_id": 28468270, "link": "https://stackoverflow.com/questions/28468270/ansi-what-does-this-sequence-mean", "title": "ANSI what does this sequence mean?", "body": "<p>I know that this is <a href=\"http://www.bluesock.org/~willg/dev/ansi.html\" rel=\"nofollow\">ANSI color sequence</a>, but what does this mean?</p>\n\n<pre><code>BLUE = \"\\x1b[38;05;4m\"\n</code></pre>\n\n<p><code>\\x1b</code> is escape (ASCII 27)</p>\n\n<p>What is <code>38</code>?\nWhat is <code>05</code>?\nand What is <code>4m</code>?</p>\n\n<p>It seems there are no such thing on the list?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 4, "creation_date": 1423704257, "post_id": 28467683, "comment_id": 45260851, "body": "<code>sayHello</code> does not return anything, and yet you capture its output to <code>output</code>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1423704931, "post_id": 28467683, "comment_id": 45261042, "body": "You need to capture sdout and compare the captured output to &quot;Hello, World!&quot;. See the <a href=\"https://golang.org/src/testing/example.go#L44\" rel=\"nofollow noreferrer\">example runner</a> for an example of how to capture stdout."}], "answers": [{"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423754213, "post_id": 28472259, "comment_id": 45284464, "body": "You know, that <code>os.Stdout</code> and <code>os.Stderr</code> are <i>variables</i> that you can overwrite with your own readers and writers?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423755419, "post_id": 28472259, "comment_id": 45285244, "body": "@FUZxxl I prefered initially not modifying them, but I will certainly simplify the current design."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423755817, "post_id": 28472259, "comment_id": 45285500, "body": "I mean, if what you want to do is to observe what goes through <code>Stdout</code> and what actually goes out there doesn&#39;t matter, this sounds like a pretty good approach."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": -1, "last_activity_date": 1423750190, "last_edit_date": 1423750190, "creation_date": 1423728278, "answer_id": 28472259, "question_id": 28467683, "link": "https://stackoverflow.com/questions/28467683/failure-to-make-test-suite-pass-golang-sayhello-used-as-value/28472259#28472259", "title": "Failure to make test suite pass golang &quot;sayHello() used as value&quot;", "body": "<p>I have developed (for this kind of unit test) <a href=\"https://github.com/VonC/godbg/blob/aaf5d23b02f438b6d01009bd600f704856da93a2/godbg.go#L29-L57\" rel=\"nofollow\"><code>godbg.Out()</code> and <code>godbg.Err()</code></a>, two <code>io.Writer</code> which, by default, are <code>os.Stdout</code> and <code>os.Stderr</code>.</p>\n\n<p>That means I no longer use <code>fmt.Println(\"Hello, World!\")</code>.</p>\n\n<p>Instead I do:</p>\n\n<pre><code>fmt.Fprintln(Out(), \"Hello, World!\")\n</code></pre>\n\n<p>That allows me, when I want to unit test that output (and not having the unit test own output filled with <code>fmt.Println</code> results), to <strong>change the default <code>io.Writer</code></strong> with ones dedicated for that test, using the <a href=\"https://github.com/VonC/godbg/blob/aaf5d23b02f438b6d01009bd600f704856da93a2/godbg.go#L66-L77\" rel=\"nofollow\"><code>pdbg.SetBuffer()</code></a> function.</p>\n\n<p>That way, <a href=\"https://github.com/VonC/godbg/blob/aaf5d23b02f438b6d01009bd600f704856da93a2/godbg_test.go#L54-L65\" rel=\"nofollow\">my test becomes</a>:</p>\n\n<pre><code>    Convey(\"Test custom buffer reset on global pdbg\", func() {\n        SetBuffers(nil)\n        fmt.Fprint(Out(), \"test content\")\n        So(OutString(), ShouldEqual, `test content`)\n        fmt.Fprint(Err(), \"err1 cerr\")\n        So(ErrString(), ShouldEqual, `err1 cerr`)\n        ResetIOs()\n        fmt.Fprint(Out(), \"test2 content2\")\n        So(OutString(), ShouldEqual, `test2 content2`)\n        fmt.Fprint(Err(), \"err2 cerr2\")\n        So(ErrString(), ShouldEqual, `err2 cerr2`)\n    })\n</code></pre>\n\n<p>I can now test outputs done on stdout or stderr by replacing (during the unit test only) those writers with my own.</p>\n\n<p>Notes:</p>\n\n<ul>\n<li>I use the <strong><a href=\"https://github.com/smartystreets/goconvey\" rel=\"nofollow\">goconvey</a></strong> unit test framework here.</li>\n<li>the design is still in progress. I might move those writer functions in their own package later on.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 4557215, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3A70jiWLh-s/AAAAAAAAAAI/AAAAAAAAAUQ/W5UH-NXjDEY/photo.jpg?sz=128", "display_name": "Troy Gamboa", "link": "https://stackoverflow.com/users/4557215/troy-gamboa"}, "is_accepted": false, "score": -2, "last_activity_date": 1423765314, "creation_date": 1423765314, "answer_id": 28484930, "question_id": 28467683, "link": "https://stackoverflow.com/questions/28467683/failure-to-make-test-suite-pass-golang-sayhello-used-as-value/28484930#28484930", "title": "Failure to make test suite pass golang &quot;sayHello() used as value&quot;", "body": "<p>Apparently all i had to do to get the original test suite to pass was define the <code>sayHello()</code> function as a string, and return its value <code>\"Hello, World!</code>. Also, i made lines 3 and 6 comments, as they do not affect the code directly:</p>\n\n<pre><code>package helloworld\n\n//import \"fmt\" \n\nfunc sayHello() string {\n    //fmt.Println(\"Hello, World!\") \n    return \"Hello, World!\"\n}\n</code></pre>\n\n<p>do the comments make the style of the code \"tacky\"?</p>\n"}], "owner": {"reputation": 3, "user_id": 4557215, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3A70jiWLh-s/AAAAAAAAAAI/AAAAAAAAAUQ/W5UH-NXjDEY/photo.jpg?sz=128", "display_name": "Troy Gamboa", "link": "https://stackoverflow.com/users/4557215/troy-gamboa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1423765314, "creation_date": 1423704094, "last_edit_date": 1423704268, "question_id": 28467683, "link": "https://stackoverflow.com/questions/28467683/failure-to-make-test-suite-pass-golang-sayhello-used-as-value", "title": "Failure to make test suite pass golang &quot;sayHello() used as value&quot;", "body": "<p>I'm trying to make this test suite pass through the command prompt (hello-world_test.go):</p>\n\n<pre><code>package helloworld\n\nimport \"testing\"\n\nfunc TestHelloWorld(t *testing.T) {\n    output := sayHello()\n    if \"Hello, World!\" != output {\n        t.Fatalf(\"output: %s\\nexpected: Hello,World!\", output)\n    }\n}\n</code></pre>\n\n<p>my code is as follows (helloworld.go):</p>\n\n<pre><code>package helloworld\n\nimport \"fmt\"\n\nfunc sayHello() {\n    fmt.Println(\"Hello, World!\")\n\n}\n</code></pre>\n\n<p>and the error code through the command prompt is: </p>\n\n<pre><code>C:\\Users\\Troy\\exercism\\go\\hello-world\\go test -v\n# _/C_/Users/Troy/exercism/go/hello-world\n.\\hello-world_test.go:6: sayHello() used as value\nFAIL    _/C_/Users/Troy/exercism/go/hello-world [build failed]\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 5383, "user_id": 1080356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX5rM.jpg?s=128&g=1", "display_name": "ceiroa", "link": "https://stackoverflow.com/users/1080356/ceiroa"}, "edited": false, "score": 1, "creation_date": 1423706306, "post_id": 28467657, "comment_id": 45261403, "body": "Thanks a lot. It drove me crazy the whole afternoon."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1423703957, "creation_date": 1423703957, "answer_id": 28467657, "question_id": 28467302, "link": "https://stackoverflow.com/questions/28467302/parsing-json-in-golang-doesnt-populate-object/28467657#28467657", "title": "Parsing JSON in Golang doesn&#39;t Populate Object", "body": "<p>The <a href=\"http://godoc.org/encoding/json\" rel=\"nofollow\">JSON encoding package</a> works with <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">exported fields</a> only. Capitalize the field names to export them:</p>\n\n<pre><code>type RefreshTokenData struct {\n  Id            string `json:\"id\"`\n  Issued_at     string `json:\"issued_at\"`\n  Scope         string `json:\"scope\"`\n  Instance_url  string `json:\"instance_url\"`\n  Token_type    string `json:\"token_type\"`\n  Refresh_token string `json:\"refresh_token\"`\n  Signature     string `json:\"signature\"`\n  Access_token  string `json:\"access_token\"`\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/yx9ZIYFFOM\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 5383, "user_id": 1080356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX5rM.jpg?s=128&g=1", "display_name": "ceiroa", "link": "https://stackoverflow.com/users/1080356/ceiroa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 28467657, "answer_count": 1, "score": 0, "last_activity_date": 1423703957, "creation_date": 1423701519, "last_edit_date": 1423701925, "question_id": 28467302, "link": "https://stackoverflow.com/questions/28467302/parsing-json-in-golang-doesnt-populate-object", "title": "Parsing JSON in Golang doesn&#39;t Populate Object", "body": "<p>As part of an Oauth application, I need to decode some JSON. But I cannot get the object populated. There is no failure, but the data just isn't there. I've tried a bunch of different ways...</p>\n\n<p>I have recreated the problem at <a href=\"http://play.golang.org/p/QGkcl61cmv\" rel=\"nofollow\">http://play.golang.org/p/QGkcl61cmv</a></p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n    \"strings\"\n   )\n\ntype RefreshTokenData struct {\n    id            string `json:\"id\"`\n    issued_at     string `json:\"issued_at\"`\n    scope         string `json:\"scope\"`\n    instance_url  string `json:\"instance_url\"`\n    token_type    string `json:\"token_type\"`\n    refresh_token string `json:\"refresh_token\"`\n    signature     string `json:\"signature\"`\n    access_token  string `json:\"access_token\"`\n}\n\nfunc main() {\n    var tokenResp = `\n    {\"id\":\"https://google.com\",\"issued_at\":\"1423698767063\",\n    \"scope\":\"full refresh_token\",\n    \"instance_url\":\"https://na15.salesforce.com\",\n    \"token_type\":\"Bearer\",\n    \"refresh_token\":\"2os53__CCU5JX_yZXE\",\n    \"id_token\":\"5jSH0Oqm7Q4fc0xkE9NOvW8cA13U\",\n    \"signature\":\"/599EkGVIBsKPFRNkg+58wZ3Q7AFyclvIGvCrxVeyTo=\",\n    \"access_token\":\"sadfasdfasdfasdfdsa\"}`\n\n    var tokenData RefreshTokenData\n    decoder := json.NewDecoder(strings.NewReader(tokenResp))\n    if jsonerr := decoder.Decode(&amp;tokenData); jsonerr != nil {\n        fmt.Println(\"****Failed to decode json\")\n    } else {\n        fmt.Println(\"****Refresh token: \" + tokenData.refresh_token)\n    }\n}\n</code></pre>\n"}]