[{"tags": ["go", "design-patterns", "go-http"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1575560039, "post_id": 59185929, "comment_id": 104614872, "body": "Context is a great way to manage cancellation and a terrible way to pass data. You&#39;d be better off just making <code>RequestContext</code> a regular struct (not trying to make it <code>context.Context</code>-compatible) and making your handlers methods on that struct. That way you can fill in whatever fields you want, type-safe, and then call the handler method, which can access those fields on its receiver."}, {"owner": {"reputation": 2160, "user_id": 5779083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a03a01266fce3dad37d602fb834d344?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5779083/tom"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575567416, "post_id": 59185929, "comment_id": 104618782, "body": "Very well put. Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 4, "last_activity_date": 1575502096, "creation_date": 1575502096, "answer_id": 59186067, "question_id": 59185929, "link": "https://stackoverflow.com/questions/59185929/incoming-requests-context-with-custom-typed-fields/59186067#59186067", "title": "Incoming requests: context with custom typed fields", "body": "<p>To use what you built, you have to use type assertions:</p>\n\n<pre><code>rctx:=request.Context().(RequestContext)\n</code></pre>\n\n<p>This will break if you have a middleware that wraps the context the same way you did.</p>\n\n<p>An alternative is using the base context, and adding helpers with a private key to access values:</p>\n\n<pre><code>type reqKey int\n\nconst key reqKey=iota\n\ntype RequestData struct {\n   UserID uuid.UUID\n   Now time.Time\n}\n\nfunc ContextWithRequest(ctx context.Context,req requestData) context.Context {\n  return context.WithValue(ctx,key,req)\n}\n\nfunc GetRequest(ctx context) RequestData {\n  x:=ctx.Value(key)\n  if x!=nil {\n     return x.(RequestData)\n  }\n  return RequestData{}\n}\n</code></pre>\n\n<p>Of course, if you want to change the <code>RequestData</code>, you need to add a pointer to the context. </p>\n"}, {"tags": [], "owner": {"reputation": 2160, "user_id": 5779083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a03a01266fce3dad37d602fb834d344?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5779083/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1576619541, "creation_date": 1576619541, "answer_id": 59382639, "question_id": 59185929, "link": "https://stackoverflow.com/questions/59185929/incoming-requests-context-with-custom-typed-fields/59382639#59382639", "title": "Incoming requests: context with custom typed fields", "body": "<p>This is what I'm using in my application now. I use simple settters and getters to retrieve values from the context.</p>\n\n<pre><code>import (\n    \"context\"\n    \"github.com/google/uuid\"\n)\n\nconst userIdContextKey = \"user_id\" // type is uuid\n\nfunc addUserIdToContext(ctx context.Context, user uuid.UUID) context.Context {\n    return context.WithValue(ctx, UserIdContextKey, user)\n}\n\nfunc userIDFromContext(ctx context.Context) uuid.UUID {\n    return ctx.Value(UserIdContextKey).(uuid.UUID)\n}\n</code></pre>\n\n<p>Then in a middleware, where I've retrieved the userId, I add the value to the context, by passing the context and user id to the <code>addUserIdToContext()</code> function.</p>\n\n<pre><code>ctx := addUserIdToContext(r.Context(), userId)\n</code></pre>\n\n<p>When I want to retrieve the user from the context, I just have to call <code>userIDFromContext(ctx)</code> and pass it the requests context.</p>\n\n<pre><code>func CreateResource(w http.ResponseWriter, r *http.Request) {\n    createdBy := userIDFromContext(r.Context())\n    // do something with createdBy\n}\n</code></pre>\n\n<p>I'm aware that this isn't the most elegant or even type safe solution, but hey, for what I'm trying to build it works just fine.</p>\n"}], "owner": {"reputation": 2160, "user_id": 5779083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a03a01266fce3dad37d602fb834d344?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5779083/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1576619541, "creation_date": 1575501212, "question_id": 59185929, "link": "https://stackoverflow.com/questions/59185929/incoming-requests-context-with-custom-typed-fields", "title": "Incoming requests: context with custom typed fields", "body": "<p>I'm writing a more or less simple web application using go that provides a rest api. When a request comes in, I want to store the id of the user, which is part of the api token, temporarily inside the requests context. After <a href=\"https://www.calhoun.io/pitfalls-of-context-values-and-how-to-avoid-or-mitigate-them/\" rel=\"nofollow noreferrer\">reading</a> <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">some</a> <a href=\"https://medium.com/@lestrrat/alternative-to-using-context-value-f2efe6bd2788\" rel=\"nofollow noreferrer\">articles</a> and the <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">docs</a> I'm still confused how to make sure that the values, that one attaches to the context using <code>context.WithValue()</code>, can be used without type assertion, but a struct of sorts instead. </p>\n\n<p>This is what I've come up with so far:</p>\n\n<pre><code>// RequestContext contains the application-specific information that are carried around in a request.\ntype RequestContext interface {\n    context.Context\n    // UserID returns the ID of the user for the current request\n    UserID() uuid.UUID\n    // SetUserID sets the ID of the currently authenticated user\n    SetUserID(id uuid.UUID)\n}\n\ntype requestContext struct {\n    context.Context           // the golang context\n    now             time.Time // the time when the request is being processed\n    userID          uuid.UUID // an ID identifying the current user\n}\n\nfunc (ctx *requestContext) UserID() uuid.UUID {\n    return ctx.userID\n}\n\nfunc (ctx *requestContext) SetUserID(id uuid.UUID) {\n    ctx.userID = id\n}\n\nfunc (ctx *requestContext) Now() time.Time {\n    return ctx.now\n}\n\n// NewRequestContext creates a new RequestContext with the current request information.\nfunc NewRequestContext(now time.Time, r *http.Request) RequestContext {\n    return &amp;requestContext{\n        Context: r.Context(),\n        now:     now,\n    }\n}\n\n// RequestContextHandler is a middleware that sets up a new RequestContext and attaches it to the current request.\nfunc RequestContextHandler(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        now := time.Now()\n        next.ServeHTTP(w, r.WithContext(NewRequestContext(now, r)))\n    })\n}\n</code></pre>\n\n<p>I would like to know how I can access the <code>SetUserID()</code> and <code>UserID()</code> functions of the request context inside a handler or if there is an alternative, similar approach.</p>\n"}, {"tags": ["c#", "pointers", "go", "callback"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575495893, "post_id": 59184927, "comment_id": 104590474, "body": "How did you build the DLL?"}, {"owner": {"reputation": 11, "user_id": 10136285, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pk0nXbFeuvM/AAAAAAAAAAI/AAAAAAAAAUg/C0gJh2Wfb7s/photo.jpg?sz=128", "display_name": "Victor Sanchez", "link": "https://stackoverflow.com/users/10136285/victor-sanchez"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575496320, "post_id": 59184927, "comment_id": 104590610, "body": "go build -buildmode=c-shared -o library.dll main.go"}], "owner": {"reputation": 11, "user_id": 10136285, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pk0nXbFeuvM/AAAAAAAAAAI/AAAAAAAAAUg/C0gJh2Wfb7s/photo.jpg?sz=128", "display_name": "Victor Sanchez", "link": "https://stackoverflow.com/users/10136285/victor-sanchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1575575121, "creation_date": 1575495054, "last_edit_date": 1575575121, "question_id": 59184927, "link": "https://stackoverflow.com/questions/59184927/golang-c-shared-library-callback-from-another-language", "title": "golang c-shared library callback from another language", "body": "<p>I building a dll with golang, and need the dll receive a callback to trigger function directly from the dll</p>\n\n<p>I tried execute callback on golang library but dont work</p>\n\n<p>This is my code on golang</p>\n\n<pre><code>package main\n\n\nimport \"C\"\nimport \"fmt\"\n\ntype externFunc func(int)\n\n//export Connect\nfunc Connect(fn externFunc) {\n    fmt.Println(\"fn \",fn)\n\n    for i:= 0; i&lt;3;i++{\n\n       // this is the func/method received from c#, and tried execute from golang\n       fn(i)\n    }\n\n}\n\n</code></pre>\n\n<p>and so i build the library</p>\n\n<p><code>go build -buildmode=c-shared -o library.dll main.go</code></p>\n\n<p>this is my code on c#</p>\n\n<pre><code>  class Program\n  {\n        static void Main(string[] args)\n        {\n           Connect()  \n        }\n\n        private static unsafe void Connect()\n        {\n            Dll.CallbackDelegate cb = Callback;\n            // here sent the method to dll, to wait the multiple calls\n            Dll.Connect(cb);\n        }\n\n        private static unsafe void Callback(int num)\n        {\n            Console.WriteLine(\"call #: \"+num);\n        }\n\n  }\n\nclass Dll {\n private const string DllPath = \"library.dll\";\n\n        private IntPtr _dllHandle = IntPtr.Zero; \n\n        private static DllHelper _instance;\n        public static DllHelper Instance\n        {\n            get { return _instance ?? (_instance = new DllHelper()); }\n        }\n\n        [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\n        private static extern IntPtr LoadLibrary(string libname);\n\n        [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto)]\n        private static extern bool FreeLibrary(IntPtr hModule);\n\n        [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto)]\n        private static extern void FreeLibraryAndExitThread(IntPtr hModule, UInt32 dwExitCode);\n\n        [DllImport(\"kernel32.dll\", CharSet = CharSet.Ansi)]\n        private static extern IntPtr GetProcAddress(IntPtr hModule, string lpProcName);\n\n        internal Dll()\n        {\n            _dllHandle = IntPtr.Zero;\n            LoadDLL();\n        }\n\n        internal void LoadDLL()\n        {\n            bool? freeResult = null;\n            if (_dllHandle != IntPtr.Zero)\n            {\n                freeResult = FreeLibrary(_dllHandle);\n            }\n\n            // Load dll .. \n            _dllHandle = LoadLibrary(DllPath);\n            if (_dllHandle == IntPtr.Zero)\n            {\n                int errorCode = Marshal.GetLastWin32Error();\n                // Marshal.\n                throw new Exception(string.Format(\"Failed to load library (ErrorCode: {0})\", errorCode));\n            }\n        }\n</code></pre>\n\n<p>and this part load the function from library</p>\n\n<pre><code>\n        public unsafe delegate void CallbackDelegate(int num);\n\n        private unsafe delegate void ConnectDelegate(CallbackDelegate pFunc);\n        internal unsafe void Connect(CallbackDelegate pFunc)\n        {\n            var funcaddr = GetProcAddress(_dllHandle, \"Connect\");\n            var function = Marshal.GetDelegateForFunctionPointer(funcaddr, typeof(ConnectDelegate)) as \n             ConnectDelegate;\n            function.Invoke(pFunc);\n        }\n\n}\n</code></pre>\n\n<p>this is the result when tried execute my console program created on C# with the go library</p>\n\n<pre><code>unexpected fault address 0xffffffffffffffff\nfatal error: fault\n[signal 0xc0000005 code=0x0 addr=0xffffffffffffffff pc=0x627ca9ab]\n</code></pre>\n\n<p>I think need receive an uinptr or something like that in the Connect and convert \nthe pointer on a type func but reading on other post says the <code>type externFunc func</code> is an func signature, and this is already a pointer.</p>\n\n<p>Any idea what I need to make callbacks?</p>\n"}, {"tags": ["go", "load-balancing"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1575491098, "post_id": 59184065, "comment_id": 104588756, "body": "Add it to <code>loadBalance</code>. It&#39;s doing all the work and it knows what endpoint it&#39;s sending the request to. Before <code>proxy.ServeHTTP</code>, increment the account for whatever you&#39;re sending the request to, and after <code>proxy.ServeHTTP</code>, decrement it."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1575491193, "post_id": 59184065, "comment_id": 104588805, "body": "This also fixes the issue with your current code where any keepalive connection that idles out will give a net -1 (+1 when it goes active, -1 when it goes idle, then -1 again when it gets closed) which will eventually add up and give you negative total active connection counts."}, {"owner": {"reputation": 261, "user_id": 9121836, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-c-E1yyFkclA/AAAAAAAAAAI/AAAAAAAAAF0/z5cgBZiS83A/photo.jpg?sz=128", "display_name": "\u041c\u0430\u0440\u043a \u0427\u043e\u043b\u0430\u043a", "link": "https://stackoverflow.com/users/9121836/%d0%9c%d0%b0%d1%80%d0%ba-%d0%a7%d0%be%d0%bb%d0%b0%d0%ba"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575499023, "post_id": 59184065, "comment_id": 104591405, "body": "@Adrian thanks, it works exactly like I wanted. Also, is there any drawbacks? If I&#39;ll want to run balancer on the prod at the end \u2013 is it ok to keep your approach?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1575555326, "post_id": 59184065, "comment_id": 104612178, "body": "It would have an issue that your current code also has - it&#39;s racy. To avoid race conditions you&#39;d want to use either <code>sync</code> or <code>sync&#47;atomic</code>. Or you could take a look at <code>expvar</code>, which would both take care of the race condition and make it easier to expose your metrics."}, {"owner": {"reputation": 261, "user_id": 9121836, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-c-E1yyFkclA/AAAAAAAAAAI/AAAAAAAAAF0/z5cgBZiS83A/photo.jpg?sz=128", "display_name": "\u041c\u0430\u0440\u043a \u0427\u043e\u043b\u0430\u043a", "link": "https://stackoverflow.com/users/9121836/%d0%9c%d0%b0%d1%80%d0%ba-%d0%a7%d0%be%d0%bb%d0%b0%d0%ba"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575569239, "post_id": 59184065, "comment_id": 104619595, "body": "@Adrian <code>expvar</code> is awesome, thanks for suggestion."}], "owner": {"reputation": 261, "user_id": 9121836, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-c-E1yyFkclA/AAAAAAAAAAI/AAAAAAAAAF0/z5cgBZiS83A/photo.jpg?sz=128", "display_name": "\u041c\u0430\u0440\u043a \u0427\u043e\u043b\u0430\u043a", "link": "https://stackoverflow.com/users/9121836/%d0%9c%d0%b0%d1%80%d0%ba-%d0%a7%d0%be%d0%bb%d0%b0%d0%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575492520, "creation_date": 1575490640, "last_edit_date": 1575492520, "question_id": 59184065, "link": "https://stackoverflow.com/questions/59184065/how-to-track-number-of-connections-with-reverseproxy-balancing", "title": "How to track number of connections with ReverseProxy balancing", "body": "<p>I'm trying to write some simple load balancer on Go. I'm using simple <code>http.Server</code> and <code>httputil.NewSingleHostReverseProxy</code> like so:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n  ...\n  server := http.Server{\n    Addr: \":8080\",\n    ConnState: connStateHook,\n    Handler: http.HandlerFunc(loadBalance),\n  }\n}\n</code></pre>\n\n<p>HandlerFunc is as follows:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func loadBalance(w http.ResponseWriter, r *http.Request) {\n  // let's imagine I have a hardcoded proxy to simplify things\n  serverURL, _ := url.Parse(\"http://127.0.0.1:5000\")\n  proxy := httputil.NewSingleHostReverseProxy(serverURL)\n  proxy.ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>So whenever request will be sent to my <code>localhost:8080</code> it'll be proxied to <code>127.0.0.1:5000</code>. \nMy goal is to handle how many active request's are handled by that proxy endpoint. I know there is <code>http.Server.ConnState</code> hook which allows you to track state of http request and fire \"callbacks\". </p>\n\n<p>I've made a simple function to store the number of connections in global variable:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var connectionsAmount int\n\nfunc connStateHook(connection net.Conn, state http.ConnState) {\n  if state == http.StateActive {\n    connectionsAmount = connectionsAmount + 1\n  } else if state == http.StateIdle {\n    connectionsAmount = connectionsAmount - 1\n  } else if state == http.StateClosed {\n    connectionsAmount = connectionsAmount - 1\n  }\n}\n</code></pre>\n\n<p>It works pretty well until I add additional N endpoints, because now I can't pair a request with specific proxy server. \nAnd I want to track this number, let's say, in <code>Endpoint struct</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Endpoint struct {\n  URL *url.URL\n  Proxy *httputil.ReverseProxy\n  ActiveConnections int\n}\n</code></pre>\n\n<p>In what way I can implement such tracking?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1575490061, "post_id": 59183885, "comment_id": 104588300, "body": "Is the question about using the facilities of the <code>regexp</code> package? If yes, you probably need the <code>*Index</code> family of its <code>regexp.Regexp</code> type: they return not the matched substring but rather the start+end position of it in the source string. Hence the text immediately following a match would be at <code>end+1</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575535961, "post_id": 59183885, "comment_id": 104601738, "body": "It&#39;s not clear what you&#39;re talking about. There are many ways to do pattern matching, but to answer your question, we must know exactly what you&#39;re doing. Please include relevant code in your question."}], "answers": [{"tags": [], "owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "is_accepted": false, "score": 1, "last_activity_date": 1575494489, "last_edit_date": 1575494489, "creation_date": 1575490765, "answer_id": 59184090, "question_id": 59183885, "link": "https://stackoverflow.com/questions/59183885/how-to-find-text-after-pattern-match/59184090#59184090", "title": "How to find text after pattern match", "body": "<p>You can use <code>regexp.FindIndex</code> in the Go standard library.</p>\n\n<p>It returns a <code>[]int</code> containing the <strong>start</strong> and <strong>end+1</strong> index of a matched string, it returns <code>nil</code> if no match is found.</p>\n\n<p>If you search a string and find a match stored in a variable <code>loc</code>, then:</p>\n\n<ul>\n<li><code>str[loc[0]:loc[1]]</code> would return matched text.</li>\n<li><code>str[loc[1]:]</code> would return everyting <strong>after</strong> the matched text.</li>\n</ul>\n\n<p>Source: <a href=\"https://golang.org/pkg/regexp/#Regexp.FindIndex\" rel=\"nofollow noreferrer\">Go Documentation</a></p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 13, "user_id": 4681875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rQWSXTpz4xM/AAAAAAAAAAI/AAAAAAAAAAA/KTuuXYmqjmQ/photo.jpg?sz=128", "display_name": "Barry Kimelman", "link": "https://stackoverflow.com/users/4681875/barry-kimelman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1575663859, "creation_date": 1575489783, "last_edit_date": 1575663859, "question_id": 59183885, "link": "https://stackoverflow.com/questions/59183885/how-to-find-text-after-pattern-match", "title": "How to find text after pattern match", "body": "<p>I have been experimenting with pattern matching. There is one thing I can't seem to find an answer to : what is the string of text in your text buffer that comes after the matched text.</p>\n"}, {"tags": ["parsing", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1575489311, "post_id": 59183693, "comment_id": 104588015, "body": "Please include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, Reproducible Example</a> <i>in the body of your question</i>, not at an external link. External links should only be supplemental to the question itself."}, {"owner": {"reputation": 31, "user_id": 10290882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dad72790652ab5fd489224179df3d4d?s=128&d=identicon&r=PG&f=1", "display_name": "gamma_delta", "link": "https://stackoverflow.com/users/10290882/gamma-delta"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575489555, "post_id": 59183693, "comment_id": 104588115, "body": "I think I added that... I&#39;ve never really asked questions on StackOverflow before sorry"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1575489878, "post_id": 59183693, "comment_id": 104588239, "body": "Your struct tags all look wrong - they all have leading/trailing whitespace which they should not. That may be contributing to at least some of your issues."}, {"owner": {"reputation": 31, "user_id": 10290882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dad72790652ab5fd489224179df3d4d?s=128&d=identicon&r=PG&f=1", "display_name": "gamma_delta", "link": "https://stackoverflow.com/users/10290882/gamma-delta"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575491144, "post_id": 59183693, "comment_id": 104588787, "body": "According to the participle docs, that should be OK... ``` type Value struct {   String *string  `  @String`   Number *float64 <code>| @Float</code> } ``` note the leading space on String"}, {"owner": {"reputation": 31, "user_id": 10290882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dad72790652ab5fd489224179df3d4d?s=128&d=identicon&r=PG&f=1", "display_name": "gamma_delta", "link": "https://stackoverflow.com/users/10290882/gamma-delta"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575491254, "post_id": 59183693, "comment_id": 104588824, "body": "Yep, that didn&#39;t work."}], "owner": {"reputation": 31, "user_id": 10290882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dad72790652ab5fd489224179df3d4d?s=128&d=identicon&r=PG&f=1", "display_name": "gamma_delta", "link": "https://stackoverflow.com/users/10290882/gamma-delta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1575489522, "creation_date": 1575489000, "last_edit_date": 1575489522, "question_id": 59183693, "link": "https://stackoverflow.com/questions/59183693/why-isnt-my-participle-parser-detecting-anything", "title": "Why isn&#39;t my Participle parser detecting anything?", "body": "<p>I am writing a parser / lexer using Participle (a package for Golang) for use in a game. It's supposed to look like Bash commands, but be easier. (<a href=\"https://github.com/alecthomas/participle\" rel=\"nofollow noreferrer\">https://github.com/alecthomas/participle</a>)</p>\n\n<p>Here is the code that Participle uses to lex and parse the inputs. (They get processed additionally later.)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Parsed struct {\n    Pos lexer.Position\n\n    FirstBlock Block             ` @@ `\n    Blocks     []*BlockWithDelim ` @@* `\n}\n\ntype Block struct {\n    Command   string     ` @Command `\n    Flags     []*ArgFlag ` @@* `\n    Arguments []string   ` @Argument* `\n}\n\ntype BlockWithDelim struct {\n    Delimiter string ` @(\";\" | \"|\" | \"\\n\" ) `\n    Block     Block  ` @@ `\n}\n\ntype ArgFlag struct {\n    Flag  string  ` \"-\" \"-\"? @Flag `\n    Value *string ` (\"=\" @Argument)? `\n}\n\nvar omegaLexer = lexer.Must(ebnf.New(strings.ReplaceAll(`\n    Command = alpha {alpha} .\n    Flag = Ident .\n    Argument = Ident | String | RawString .\n    String = \"\\\"\" { \"\\u0000\"\u2026\"\\uffff\"-\"\\\"\"-\"\\\\\" | \"\\\\\" \"\\u0000\"\u2026\"\\uffff\" } \"\\\"\" .\n    RawString = \"\u00a7\" { \"\\u0000\"\u2026\"\\uffff\" - \"\u00a7\" } \"\u00a7\" . \n    Ident = (alpha | \"_\" ) { alpha | digit | \"_\" } .\n\n    Comment = \"#\" { \"\\u0000\"\u2026\"\\uffff\" - \"\\n\" } .\n    Whitespace = \" \" | \"\\t\" | \"\\r\" .\n\n    alpha = \"a\"\u2026\"z\" | \"A\"\u2026\"Z\" .\n    digit = \"0\"\u2026\"9\" .\n`, \"\u00a7\", \"`\"))) //replace \u00a7 with ` to make reading easier, due to no escapes allowed in raw strings\n\nvar omegaParser = participle.MustBuild(&amp;Parsed{},\n    participle.Lexer(omegaLexer),\n    participle.Unquote(\"String\", \"RawString\"),\n    participle.Elide(\"Whitespace\", \"Comment\"))\n</code></pre>\n\n<p>The problem is, it refuses to detect anything except commands with one argument which is a quoted string. </p>\n\n<pre><code># This works\necho \"quoted string\"\n\n# This doesn't\necho hello\n# Returns this error: \n# &lt;source&gt;:1:6: unexpected token \"hello\"\n</code></pre>\n\n<p>In addition, it doesn't recognize strings put directly in the struct tags. For example:</p>\n\n<pre><code>help -bool\n# &lt;source&gt;:1:6: no match found for -\n\nexecute once; then -do=\"thingy\"\n# &lt;source&gt;:1:13: no match found for ;\n</code></pre>\n\n<p>I cannot figure why my code wouldn't work. I've tried to copy the TOML example as much as possible.</p>\n\n<p>Here's the code (with imports and package snipped): <a href=\"https://pastebin.com/QDLiGmnu\" rel=\"nofollow noreferrer\">https://pastebin.com/QDLiGmnu</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1575468383, "post_id": 59177858, "comment_id": 104576913, "body": "Write your own output in a loop."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1575469077, "post_id": 59177858, "comment_id": 104577361, "body": "<code>fmt.Printf(&quot;len=%d cap=%d %v\\n&quot;, len(s), cap(s), strings.NewReplacer(&quot;[&quot;, &quot;&quot;, &quot;]&quot;, &quot;&quot;).Replace(fmt.Sprintf(&quot;%v&quot;, s))</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1575469082, "post_id": 59177858, "comment_id": 104577365, "body": "There needs to be a loop somewhere, whether a simple for loop is harder to read than  hiding with something like <code>strings.Join(strings.Split(strings.Trim(fmt.Sprintf(&quot;%v&quot;, s), &quot;[]&quot;), &quot; &quot;), &quot;\\n&quot;)</code> is up to you I guess"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1575474501, "post_id": 59177858, "comment_id": 104580611, "body": "It is literally impossible to do this without a loop. Even your solution has a loop, it&#39;s just hidden from your eyes."}], "answers": [{"tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": false, "score": 2, "last_activity_date": 1575469119, "last_edit_date": 1575469119, "creation_date": 1575468740, "answer_id": 59178018, "question_id": 59177858, "link": "https://stackoverflow.com/questions/59177858/how-to-print-elements-in-slice-without-bracket-in-go-line-by-line/59178018#59178018", "title": "How to print elements in slice without bracket in Go line by line?", "body": "<p>Create the string with the values and brackets. \nPrint the substring not including the brackets, and voil\u00e0.\nOr use <code>strings.Trim</code>\u00a0as suggested by JimB in the comment.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>temp := fmt.Sprintf(\"%v\", s)\nfmt.Printf(\"len=%d cap=%d \\n%v\\n\", len(s), cap(s), strings.Join(strings.Split(temp[1:len(temp)-1], \" \"), \"\\n\"))\n\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>len=3 cap=4 \n2\n3\n4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1575473035, "post_id": 59178316, "comment_id": 104579732, "body": "I think it&#39;s worth noting that this is a dramatically worse solution than just using a loop."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1575474488, "post_id": 59178316, "comment_id": 104580599, "body": "That <i>is</i> a loop. It&#39;s just hidden in a recursive function."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575474875, "post_id": 59178316, "comment_id": 104580873, "body": "I usually like your answers, but this one is abysmal :(  It implies it works without a loop, but it doesn&#39;t. And it should come with bold warnings that this is a bad approach."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1575510136, "post_id": 59178316, "comment_id": 104594127, "body": "I would say maybe not-so-good old <code>goto</code> might be more performant than this, but loop is still the best solution."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575915378, "post_id": 59178316, "comment_id": 104718602, "body": "@Flimzy: Really! In mathematics and computer science, both iteration and recursion are distinct and important. The accepted answer is a good solution to the OP&#39;s question."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1575472469, "last_edit_date": 1575472469, "creation_date": 1575469719, "answer_id": 59178316, "question_id": 59177858, "link": "https://stackoverflow.com/questions/59177858/how-to-print-elements-in-slice-without-bracket-in-go-line-by-line/59178316#59178316", "title": "How to print elements in slice without bracket in Go line by line?", "body": "<blockquote>\n  <p>print elements in slice without bracket in Go line by line.</p>\n  \n  <p>Comment: I want it without loop</p>\n</blockquote>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc printSlice(s []int) {\n    if len(s) == 0 {\n        return\n    }\n    fmt.Println(s[0])\n    printSlice(s[1:])\n}\n\nfunc main() {\n    var s []int\n    s = append(s, 2, 3, 4)\n    printSlice(s)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/ISXdbjTrfSt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ISXdbjTrfSt</a></p>\n\n<p>Output:</p>\n\n<pre><code>2\n3\n4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1575474777, "post_id": 59178655, "comment_id": 104580803, "body": "This should be the accepted answer. This is the only sane way to do it. peterSO&#39;s solution is not nice, it&#39;s far less efficient, harder to read, and hides the loop (which is still there)."}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575478982, "post_id": 59178655, "comment_id": 104583312, "body": "@Flimzy agreed, that answer gives a different approach and atleast on first look it looked nice to me though it is not if you look in depth."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1575598732, "post_id": 59178655, "comment_id": 104629667, "body": "@cslrnr: <code>fmt.Printf(&quot;%v\\n&quot;, value)</code> is equivalent to <code>fmt.Println(value)</code>. Use <code>fmt.Println(value)</code>, it is easier to optimize and it is more readable."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1575598782, "post_id": 59178655, "comment_id": 104629674, "body": "@cslrnr: Look at the question from a computer science perspective. The OP asked for an improved algorithm. Flimzy suggested using iteration (a loop). The OP then asked for a non-iterative (without a loop) or recursive algorithm. I provided a recursive algorithm, which the OP accepted. Flimzy claims that recursion is iteration (&quot;That is a loop. It&#39;s just hidden in a recursive function&quot;). In computer science, iteration and recursion are distinct mechanisms. You provided an iterative algorithm. The OP asked for a non-iterative algorithm."}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1575607141, "post_id": 59178655, "comment_id": 104631379, "body": "@peterSO, I don&#39;t have objection on your answer that&#39;s accepted by user or why it is accepted. Still I am with flimzy on the comments he made about recursion"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575915341, "post_id": 59178655, "comment_id": 104718576, "body": "@Flimzy: The OP asked for and accepted a solution &quot;without loop.&quot; If a professor, potential employer, or anyone else asks for a non-iterative (without loop, without while, for, or do) solution they want a recursive solution. An iterative solution will get an F, and does not get a job offer."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1575918223, "post_id": 59178655, "comment_id": 104719743, "body": "@peterSO: If the answer were accompanied by due comments explaining why it&#39;s a bad solution, I wouldn&#39;t have a problem with it."}], "tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 2, "last_activity_date": 1575471636, "last_edit_date": 1575471636, "creation_date": 1575470740, "answer_id": 59178655, "question_id": 59177858, "link": "https://stackoverflow.com/questions/59177858/how-to-print-elements-in-slice-without-bracket-in-go-line-by-line/59178655#59178655", "title": "How to print elements in slice without bracket in Go line by line?", "body": "<p>Something like this will work if you don't want to use fmt.Println and only use printf and range over the slice without calculating len.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var s []int\n    s = append(s, 2, 3, 4)\n    printSlice(s)\n}\n\nfunc printSlice(s []int) {\n       for _, value:= range s {\n         fmt.Printf(\"%v\\n\", value)\n       }\n}\n</code></pre>\n\n<p>update: I haven't read your comments section while posting this , without for loop answer from peterSO works great and nice answer too.</p>\n"}], "owner": {"reputation": 25, "user_id": 12480239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5MN_U5PfQ34/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfyTW6cJGP5jO6F6I_TSh5FYrYb0w/photo.jpg?sz=128", "display_name": "abishek ram", "link": "https://stackoverflow.com/users/12480239/abishek-ram"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1407, "favorite_count": 1, "closed_date": 1575476627, "accepted_answer_id": 59178316, "answer_count": 3, "score": -4, "last_activity_date": 1575472779, "creation_date": 1575468295, "last_edit_date": 1575472779, "question_id": 59177858, "link": "https://stackoverflow.com/questions/59177858/how-to-print-elements-in-slice-without-bracket-in-go-line-by-line", "closed_reason": "Needs details or clarity", "title": "How to print elements in slice without bracket in Go line by line?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var s []int\n    s = append(s, 2, 3, 4)\n    printSlice(s)\n}\n\nfunc printSlice(s []int) {\n    fmt.Printf(\"len=%d cap=%d %v\\n\", len(s), cap(s), s)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/tx8gmx5eR7B\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tx8gmx5eR7B</a></p>\n\n<p>Output:</p>\n\n<pre><code>len=3 cap=4 [2 3 4]\n</code></pre>\n\n<p>Output should be:</p>\n\n<pre><code>2\n3\n4\n</code></pre>\n\n<p>I want it without loop.</p>\n"}, {"tags": ["go", "proxy", "hugo"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575457883, "post_id": 59174482, "comment_id": 104571101, "body": "Where are you seeing that error? In your browser?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1575458291, "post_id": 59174482, "comment_id": 104571288, "body": "Assuming this error is in your browser, which seems most likely, no, there&#39;s no way to disable it. But you shouldn&#39;t need or want to anyway. The proper solution is to make sure you aren&#39;t modifying the data in transit. The fact that the integrity check fails means that something isn&#39;t being transferred properly."}, {"owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575462028, "post_id": 59174482, "comment_id": 104573272, "body": "There is absolutely nothing done to the response from the nginx where the data is being served. The entire code is what I have made above. If I visit the nginx url directly in my browser, there is no response but when it comes via the golang proxy, this happens."}, {"owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575465399, "post_id": 59174482, "comment_id": 104575149, "body": "<code>If I visit the nginx url directly in my browser, there is no &quot;error&quot; response</code> I meant above"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575466005, "post_id": 59174482, "comment_id": 104575492, "body": "You didn&#39;t really answer my question. But it sounds like my assumptions are correct: Your Go proxy is modifying the payload in some way."}], "answers": [{"tags": [], "owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "is_accepted": true, "score": 0, "last_activity_date": 1575724887, "creation_date": 1575724887, "answer_id": 59226407, "question_id": 59174482, "link": "https://stackoverflow.com/questions/59174482/how-to-bypass-integrity-checks-through-proxy/59226407#59226407", "title": "How to bypass integrity checks through proxy", "body": "<p>I have figured out the problem. The golang proxy was working fine. There was no issue in it. The hugo static pages had some references to the minified js and css, with absolute paths and that was causing the issue. When the request was coming from the golang proxy it was coming from a different url prefix and so the css and js were found to be corrupt, as the absolute path led to a different file than the one hugo static files expected (and hence the integrity failure error).</p>\n\n<p>The solution was to simply add the prefix as the <code>baseURL</code> in the hugo config. More information can be found at: <a href=\"https://gohugo.io/getting-started/configuration/\" rel=\"nofollow noreferrer\">https://gohugo.io/getting-started/configuration/</a> </p>\n"}], "owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 59226407, "answer_count": 1, "score": -2, "last_activity_date": 1575724887, "creation_date": 1575457325, "last_edit_date": 1575457864, "question_id": 59174482, "link": "https://stackoverflow.com/questions/59174482/how-to-bypass-integrity-checks-through-proxy", "title": "How to bypass integrity checks through proxy", "body": "<p>I have a Go proxy server which will proxy the incoming requests to a different nginx service, where a bunch of static files generated from hugo are deployed. The Go proxy server code is:</p>\n\n<pre><code>func (w http.ResponseWriter, r *http.Request) {\n    proxy := httputil.NewSingleHostReverseProxy(target)\n    proxy.Transport = debug.Transport{} // Set some Debug TCP options here\n    proxy.ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>The <code>debug.Transport</code> is created like below:</p>\n\n<pre><code>type Transport struct {\n    Transport http.RoundTripper\n}\n\nfunc (d Transport) RoundTrip(r *http.Request) (*http.Response, error) {\n    fmt.Println(r.Header)\n    d.Transport = &amp;http.Transport{\n        TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n    }\n    return d.Transport.RoundTrip(r)\n}\n</code></pre>\n\n<p>In the debug Transport, I am already ignoring the certificate checks for TLS configuration.</p>\n\n<p>If I directly access the nginx url where hugo static files are served, then the static files are perfectly loaded. The static files are served fine even if I access from an nginx-ingress in addition to the nginx. However, when the requests are served via the Go proxy, then I get an error:</p>\n\n<pre><code>Failed to find a valid digest in the 'integrity' attribute for resource 'https://&lt;blah&gt;/js/main.min.29b0315468c00226fa6f4556a9cebc0ac4fe1ce1457a01b22c0a06b329877383.js' with computed SHA-256 integrity 'Nk/s9htIgKJ5jeLFxUMWgIQGhxGZBKoEWtWEy2qYtJk='. The resource has been blocked.\n</code></pre>\n\n<p>Any idea how I can skip these <code>integerity</code> check in the Go http proxy ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575457451, "post_id": 59174176, "comment_id": 104570882, "body": "Why placing the field first is preferable is explained in the last sentence. Anything unclear about that?"}], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1575460648, "post_id": 59174561, "comment_id": 104572500, "body": "Can you expand on the last sentence? i.e..when is that not the case?"}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1575461104, "post_id": 59174561, "comment_id": 104572748, "body": "@colminator a compiler could decide to change the field order of a struct in memory to optimize storage space for instance. The go compiler doesn&#39;t do that as far as I know."}, {"owner": {"reputation": 195, "user_id": 12479273, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BTu5q-FJJjU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYS4AgerVUv8uSvWF8WYDYOjHHfg/photo.jpg?sz=128", "display_name": "Yalou Wang", "link": "https://stackoverflow.com/users/12479273/yalou-wang"}, "edited": false, "score": 1, "creation_date": 1575461321, "post_id": 59174561, "comment_id": 104572871, "body": "@chmike thx for your excellent answer. I&#39;d like to know does it means that I should put the frequently accessed field in the first place of a struct in my daily programing work?"}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 195, "user_id": 12479273, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BTu5q-FJJjU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYS4AgerVUv8uSvWF8WYDYOjHHfg/photo.jpg?sz=128", "display_name": "Yalou Wang", "link": "https://stackoverflow.com/users/12479273/yalou-wang"}, "edited": false, "score": 1, "creation_date": 1575461669, "post_id": 59174561, "comment_id": 104573078, "body": "@YalouWang It would be a small optimization. It&#39;s only worth the effort if performance is important."}], "tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": true, "score": 13, "last_activity_date": 1575457584, "creation_date": 1575457584, "answer_id": 59174561, "question_id": 59174176, "link": "https://stackoverflow.com/questions/59174176/what-does-hot-path-mean-in-the-context-of-sync-once/59174561#59174561", "title": "What does &quot;hot path&quot; mean in the context of sync.Once?", "body": "<p>A hot path is a sequence of instructions executed very frequently.</p>\n\n<p>When accessing the first field of a structure, we can directly dereference the pointer to the structure to access the first field. To access other fields, we need to provide an offset from the first value in addition to the struct pointer.</p>\n\n<p>In machine code, this offset is an additional value to pass with the instruction which makes it longer. The performance impact is that the CPU\u00a0must perform an addition of the offset to the struct pointer to get the address of the value to access. </p>\n\n<p>Thus machine code to access the first field of a struct is more compact and faster.</p>\n\n<p>Note that this assumes that the layout of the field values in memory is the same as in the struct definition. </p>\n"}], "owner": {"reputation": 195, "user_id": 12479273, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BTu5q-FJJjU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYS4AgerVUv8uSvWF8WYDYOjHHfg/photo.jpg?sz=128", "display_name": "Yalou Wang", "link": "https://stackoverflow.com/users/12479273/yalou-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1041, "favorite_count": 0, "accepted_answer_id": 59174561, "answer_count": 1, "score": 16, "last_activity_date": 1575460845, "creation_date": 1575456400, "last_edit_date": 1575460845, "question_id": 59174176, "link": "https://stackoverflow.com/questions/59174176/what-does-hot-path-mean-in-the-context-of-sync-once", "title": "What does &quot;hot path&quot; mean in the context of sync.Once?", "body": "<p>go version:1.13.4\nIn the source code <a href=\"https://github.com/golang/go/blob/go1.13.4/src/sync/once.go#L11\" rel=\"noreferrer\">sync/once.go</a>, the following comments mentioned \"hot path\":</p>\n\n<pre><code>type Once struct {\n    // done indicates whether the action has been performed.\n    // It is first in the struct because it is used in the hot path.\n    // The hot path is inlined at every call site.\n    // Placing done first allows more compact instructions on some architectures (amd64/x86),\n    // and fewer instructions (to calculate offset) on other architectures.\n    done uint32\n    m    Mutex\n}\n</code></pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>What does \"hot path\" mean here?</p></li>\n<li><p>Does \"It is first in the struct\" make a \"hot path\" access more efficient? Why?</p></li>\n</ol>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 1, "creation_date": 1575455607, "post_id": 59173770, "comment_id": 104569894, "body": "I don\u2019t think it is possible. You have to use a <code>switch</code> instruction where each case is for a possible operator."}, {"owner": {"reputation": 1674, "user_id": 4487542, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/f5Hr6.png?s=128&g=1", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/4487542/j%c3%a9r%c3%b4me"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575456212, "post_id": 59173770, "comment_id": 104570212, "body": "@chmike Yes this is my second option I thought"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1575458047, "post_id": 59173770, "comment_id": 104571193, "body": "A function is necessary for this."}, {"owner": {"reputation": 1674, "user_id": 4487542, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/f5Hr6.png?s=128&g=1", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/4487542/j%c3%a9r%c3%b4me"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575461610, "post_id": 59173770, "comment_id": 104573042, "body": "@Flimzy A function of what? A custom one?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575465954, "post_id": 59173770, "comment_id": 104575465, "body": "Yes, you need to write a function."}], "answers": [{"tags": [], "owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "is_accepted": true, "score": 4, "last_activity_date": 1575464036, "last_edit_date": 1575464036, "creation_date": 1575463620, "answer_id": 59176405, "question_id": 59173770, "link": "https://stackoverflow.com/questions/59173770/is-that-possible-to-create-a-comparison-operator-from-string/59176405#59176405", "title": "Is that possible to create a comparison operator from string?", "body": "<p>This is possible. I built a generic comparison library like this once before.</p>\n\n<p>A comparison, in simple terms, contains 3 parts:</p>\n\n<ol>\n<li>A <strong>value</strong> of some sort, on the left of the comparison.</li>\n<li>An <strong>operator</strong> (<code>=</code>, <code>&lt;</code>, <code>&gt;</code>, ...).</li>\n<li>A <strong>value</strong> of some sort, on the right of the comparison.</li>\n</ol>\n\n<p>Those 3 parts, contain only two different types - <strong>value</strong> and <strong>operator</strong>. I attempted to abstract those two types into their base forms.</p>\n\n<ul>\n<li><p><strong>value</strong> could be anything, so we use the empty interface - <code>interface{}</code>.</p></li>\n<li><p><strong>operator</strong> is part of a finite set, each with their own rules.</p></li>\n</ul>\n\n<pre><code>type Operator int\n\nconst (\n    Equals Operator = 1\n)\n</code></pre>\n\n<p>Evaluating a comparison with an <code>=</code> sign has only one rule to be valid - both values should be of the same type. You can't compare <code>1</code> and <code>hello</code>. After that, you just have to make sure the values are the same.</p>\n\n<p>We can implement a new meta-type that wraps the requirement for evaluating an <code>operator</code>.</p>\n\n<pre><code>// Function signature for a \"rule\" of an operator.\ntype validFn func(left, right interface{}) bool\n\n// Function signature for evaluating an operator comparison.\ntype evalFn func(left, right interface{}) bool\n\ntype operatorMeta struct {\n    valid []validFn\n    eval  evalFn\n}\n</code></pre>\n\n<p>Now that we've defined our types, we need to implement the rules and comparison functions for <code>Equals</code>.</p>\n\n<pre><code>func sameTypes(left, right interface{}) bool {\n    return reflect.TypeOf(left).Kind() == reflect.TypeOf(right).Kind()\n}\n\nfunc equals(left, right interface{}) bool {\n    return reflect.DeepEqual(left, right)\n}\n</code></pre>\n\n<p>Awesome! So we can now validate that our two <strong>values</strong> are of the same type, and we can compare them against each other if they are. The last piece of the puzzle, is mapping the <strong>operator</strong> to its appropriate rules and evaluation and having a function to execute all of this logic.</p>\n\n<pre><code>var args = map[Operator]operatorMeta{\n    Equals: {\n        valid: []validFn{sameTypes},\n        eval:  equals,\n    },\n}\n\nfunc compare(o Operator, left, right interface{}) (bool, error) {\n    opArgs, ok := args[o]\n    if !ok {\n        // You haven't implemented logic for this operator.\n    }\n\n    for _, validFn := range opArgs.valid {\n        if !validFn(left, right) {\n            // One of the rules were not satisfied.\n        }\n    }\n\n    return opArgs.eval(left, right), nil\n}\n</code></pre>\n\n<p>Let's summarize what we have so far:</p>\n\n<ul>\n<li>Abstracted a basic comparison into a <strong>value</strong> and <strong>operator</strong>.</li>\n<li>Created a way to validate whether a pair of <strong>values</strong> are valid for an operator.</li>\n<li>Created a way to evaluate an <strong>operator</strong>, given two <strong>values</strong>.</li>\n</ul>\n\n<p><a href=\"https://play.golang.org/p/mIXho3ykWOF\" rel=\"nofollow noreferrer\">(Go Playground)</a></p>\n\n<p>I hope that I gave some insight into how you can approach this. It's a simple idea, but can take some boilerplate to get working properly.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 1674, "user_id": 4487542, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/f5Hr6.png?s=128&g=1", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/4487542/j%c3%a9r%c3%b4me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 59176405, "answer_count": 1, "score": 1, "last_activity_date": 1575464036, "creation_date": 1575455008, "question_id": 59173770, "link": "https://stackoverflow.com/questions/59173770/is-that-possible-to-create-a-comparison-operator-from-string", "title": "Is that possible to create a comparison operator from string?", "body": "<p>I'm trying to create a function that will produce an if condition from a predefined array.</p>\n\n<p>for example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package errors\n\ntype errorCase struct {\n    // This is the field I need to get in another struct\n    Field        string\n    // The comparison operator\n    TestOperator string\n    // The value that the expected one should not with equal...\n    WrongValue   interface{}\n}\n\nvar ErrorCases = []*errorCase{ {\n    \"MinValue\",\n    \"&lt;\",\n    0,\n}, {\n    \"MaxValue\",\n    \"==\",\n    0,\n}}\n</code></pre>\n\n<p>Actually I made a new function with a for loop that iterate through all of these \"error cases\"</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func isDirty(questionInterface models.QuestionInterface) bool {\n    for _, errorCase := range errors.ErrorCases {\n        s := reflect.ValueOf(&amp;questionInterface).Elem()\n        value := s.Elem().FieldByName(errorCase.Field)\n\n        // At this point I need to create my if condition\n        // to compare the value of the value var and the wrong one\n        // With the given comparison operator\n    }\n\n    // Should return the comparison test value\n    return true\n}\n</code></pre>\n\n<p>Is that possible to create an if condition like that?\nWith the reflect package?</p>\n\n<p>I think this is possible but I don't find where I should start.</p>\n"}, {"tags": ["sockets", "go", "ipv4"], "comments": [{"owner": {"reputation": 130, "user_id": 5483860, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kYTbY-j1YSg/AAAAAAAAAAI/AAAAAAAAANg/9njmHgBp5x4/photo.jpg?sz=128", "display_name": "Gabriel Pereira", "link": "https://stackoverflow.com/users/5483860/gabriel-pereira"}, "edited": false, "score": 0, "creation_date": 1575469375, "post_id": 59173693, "comment_id": 104577562, "body": "You will need to Marshal the IP Header <a href=\"https://github.com/golang/net/blob/master/ipv4/header.go\" rel=\"nofollow noreferrer\">github.com/golang/net/blob/master/ipv4/header.go</a> to IP structure than configure the connection using it. But you will need to learn to setup a raw socket connection and than use the IP struct generated with the custom header"}, {"owner": {"reputation": 1, "user_id": 12479059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1edf9c1bc6382239c13b7f09ba1f4d3?s=128&d=identicon&r=PG&f=1", "display_name": "Keld", "link": "https://stackoverflow.com/users/12479059/keld"}, "reply_to_user": {"reputation": 130, "user_id": 5483860, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kYTbY-j1YSg/AAAAAAAAAAI/AAAAAAAAANg/9njmHgBp5x4/photo.jpg?sz=128", "display_name": "Gabriel Pereira", "link": "https://stackoverflow.com/users/5483860/gabriel-pereira"}, "edited": false, "score": 1, "creation_date": 1575558305, "post_id": 59173693, "comment_id": 104613918, "body": "Thank you for your comment. I was hoping to avoid using raw sockets and it seems like the ipv4 package is designed to that based on their description  &quot;The package provides IP-level socket options that allow manipulation of IPv4 facilities.&quot; (link: <a href=\"https://godoc.org/golang.org/x/net/ipv4\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/net/ipv4</a>)  I managed to circumvent the problem by dividing the connections into different applications and defining a QoS policy for each of the applications. It is not a perfect solution but it works for me in this case."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2097800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jKQUU.jpg?s=128&g=1", "display_name": "amurchick", "link": "https://stackoverflow.com/users/2097800/amurchick"}, "is_accepted": false, "score": 1, "last_activity_date": 1619175779, "creation_date": 1619175779, "answer_id": 67228827, "question_id": 59173693, "link": "https://stackoverflow.com/questions/59173693/how-to-set-tos-field-in-ip-header-for-a-tcp-connection-using-golang/67228827#67228827", "title": "How to set ToS field in IP header for a TCP connection using Golang", "body": "<p>I am try you ToS set method at Dial() with golang 1.15.5 and its worked:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>dialer := net.Dialer{\n    Timeout: this.TcpWaitConnectTimeout,\n}\ndialer.Control = func(network, address string, c syscall.RawConn) error {\n    var err error\n    c.Control(func(fd uintptr) {\n        err = syscall.SetsockoptInt(int(fd), syscall.IPPROTO_IP, syscall.IP_TOS, 0x80)\n    })\n    return err\n}\n\nc, err := dialer.Dial(&quot;tcp&quot;, this.serverAddr)\n\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/maSC5.png\" rel=\"nofollow noreferrer\">tcpdump show me right ToS</a></p>\n"}], "owner": {"reputation": 1, "user_id": 12479059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1edf9c1bc6382239c13b7f09ba1f4d3?s=128&d=identicon&r=PG&f=1", "display_name": "Keld", "link": "https://stackoverflow.com/users/12479059/keld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1619175779, "creation_date": 1575454768, "last_edit_date": 1575459135, "question_id": 59173693, "link": "https://stackoverflow.com/questions/59173693/how-to-set-tos-field-in-ip-header-for-a-tcp-connection-using-golang", "title": "How to set ToS field in IP header for a TCP connection using Golang", "body": "<p>I am trying to create a TCP server and client using Golang where I am able to set the Type of Service field in the IP header in order to prioritise different traffic flows.</p>\n\n<p>The client and servers are able to communicate but I can not figure out how to set the ToS field.</p>\n\n<p>I have tried using the ipv4 Golang package with the method described here: <a href=\"https://godoc.org/golang.org/x/net/ipv4#NewConn\" rel=\"nofollow noreferrer\">https://godoc.org/golang.org/x/net/ipv4#NewConn</a></p>\n\n<p>A simplified server example:</p>\n\n<pre><code>func main () {\nln, err := net.Listen(\"tcp4\", \"192.168.0.20:1024\")\nif err != nil {\n    // error handling\n}\ndefer ln.Close()\nfor {\n    c, err := ln.Accept()\n    if err != nil {\n        // error handling\n    }\n    go func(c net.Conn) {\n        defer c.Close()\n\n        if err := ipv4.NewConn(c).SetTOS(0x28); err != nil {\n            fmt.Println(\"Error: \", err.Error())\n        }\n    }(c)\n}\n</code></pre>\n\n<p>And the corresponding client (also simplified) </p>\n\n<pre><code>func main () {\n\n    conn, err := net.Dial(\"tcp4\", \"192.168.0.20:1024\")\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    for {\n\n            writer := bufio.NewWriter(conn)\n            // Create \"packet\"\n            Data := make([]byte, 1200)\n            endLine := \"\\r\\n\"\n\n\n\n            //Set packetLength\n            length := strconv.FormatInt(int64(1200), 10)\n            copy(Data[0:], length)\n\n            //Set ID\n            idString := strconv.FormatInt(int64(1), 10)\n            if strings.Contains(idString, \"\\r\") || strings.Contains(idString, \"\\n\") || strings.Contains(idString, \"\\r\\n\") {\n                fmt.Println(\"This is gonna result in an error in the id string.\")\n            }\n            idbuf := []byte(idString)\n            copy(Data[15:], idbuf)\n\n            //Set timestamp\n            timestamp0 := time.Now().UnixNano()\n            timestampString := strconv.FormatInt(timestamp0, 10)\n            if strings.Contains(timestampString, \"\\r\") || strings.Contains(timestampString, \"\\n\") || strings.Contains(timestampString, \"\\r\\n\") {\n                fmt.Println(\"This is gonna result in an error in the timestamp string.\")\n            }\n            buf := []byte(timestampString)\n            copy(Data[50:], buf)\n\n            copy(Data[int(1200)-2:], endLine)\n\n            if len(Data) != int(1200) {\n                fmt.Println(\"This is also gonna be an error. Length is: \", len(Data))\n            }\n            //Send the data and flush the writer\n            writer.Write(Data)\n            writer.Flush()\n        }\n        //time.Sleep(1*time.Nanosecond)\n    }\n\n</code></pre>\n\n<p>I have also tried creating my own dialer with a control function that passes a syscall in order to set the socket like this:</p>\n\n<pre><code>    dialer := &amp;net.Dialer{\n        Timeout:       5 * time.Second,\n        Deadline:      time.Time{},\n        LocalAddr:     tcpAddr,\n        DualStack:     false,\n        FallbackDelay: 0,\n        KeepAlive:     0,\n        Resolver:      nil,\n        Control:       highPrio,\n    }\n\n    func highPrio(network, address string, c syscall.RawConn) error {\n    return c.Control(func(fd uintptr) {\n        // set the socket options\n        err := syscall.SetsockoptInt(syscall.Handle(fd), syscall.IPPROTO_IP, syscall.IP_TOS, 128)\n        if err != nil {\n            log.Println(\"setsocketopt: \", err)\n        }\n    })\n</code></pre>\n\n<p>I am verifying that it does not work by inspecting the traffic with Wireshark and am using Windows 10 Pro as my OS.</p>\n"}, {"tags": ["go", "unicode"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1575455058, "post_id": 59173628, "comment_id": 104569591, "body": "<a href=\"https://godoc.org/golang.org/x/text/encoding\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/text/encoding</a>, <a href=\"https://godoc.org/golang.org/x/text/encoding/charmap#ISO8859_9\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/text/encoding/charmap#ISO8859_9</a>"}, {"owner": {"reputation": 111, "user_id": 7133719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bfaf34da0c8c293498e38ba2d862231?s=128&d=identicon&r=PG&f=1", "display_name": "Tugrul Bayrak", "link": "https://stackoverflow.com/users/7133719/tugrul-bayrak"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575462531, "post_id": 59173628, "comment_id": 104573539, "body": "@Peter I used &quot;bytes, err = charmap.ISO8859_9.NewEncoder().Bytes(bytes)&quot; but it returns &quot;rune not supported by encoding&quot; error. I searched for hours, still same."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1575467708, "post_id": 59173628, "comment_id": 104576505, "body": "Your text includes runes that have no equivalent in ISO-8859-9, i.e. you&#39;re trying to do something that&#39;s technically impossible. It&#39;s not for us to decide how to deal with that. The encoding package has things like <a href=\"https://godoc.org/golang.org/x/text/encoding#ReplaceUnsupported\" rel=\"nofollow noreferrer\">ReplaceUnsupported</a> and <a href=\"https://godoc.org/golang.org/x/text/encoding#HTMLEscapeUnsupported\" rel=\"nofollow noreferrer\">HTMLEscapeUnsupported</a> but their use is &quot;strongly discouraged&quot;."}, {"owner": {"reputation": 29795, "user_id": 720030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ed0a5a78d65824827fb112e8e716f8?s=128&d=identicon&r=PG", "display_name": "karmakaze", "link": "https://stackoverflow.com/users/720030/karmakaze"}, "edited": false, "score": 0, "creation_date": 1575491508, "post_id": 59173628, "comment_id": 104588915, "body": "@TugrulBayrak Perhaps what&#39;s needed is to <code>decode</code> the ISO8859_9 bytes into UTF-8 <a href=\"https://godoc.org/golang.org/x/text/encoding#Decoder\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/text/encoding#Decoder</a>"}, {"owner": {"reputation": 111, "user_id": 7133719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bfaf34da0c8c293498e38ba2d862231?s=128&d=identicon&r=PG&f=1", "display_name": "Tugrul Bayrak", "link": "https://stackoverflow.com/users/7133719/tugrul-bayrak"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575528459, "post_id": 59173628, "comment_id": 104598725, "body": "@Peter yes you are right. I was trying to encode Turkish letters to Turkish letters again. That&#39;s the problem. That&#39;s why it wasn&#39;t allow me to encode. Because encoding function wants an utf8 format. Thanks for help!"}, {"owner": {"reputation": 111, "user_id": 7133719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bfaf34da0c8c293498e38ba2d862231?s=128&d=identicon&r=PG&f=1", "display_name": "Tugrul Bayrak", "link": "https://stackoverflow.com/users/7133719/tugrul-bayrak"}, "reply_to_user": {"reputation": 29795, "user_id": 720030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ed0a5a78d65824827fb112e8e716f8?s=128&d=identicon&r=PG", "display_name": "karmakaze", "link": "https://stackoverflow.com/users/720030/karmakaze"}, "edited": false, "score": 1, "creation_date": 1575528569, "post_id": 59173628, "comment_id": 104598767, "body": "@karmakaze after you said, first I decode the incoming ISO8859_9 bytes to UTF-8, Then I did my process, at the end I encode this UTF-8 to ISO8859_9. Finally it works! Thanks for help. I will edit question."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1575532669, "post_id": 59173628, "comment_id": 104600319, "body": "Your question should remain strictly a question. Please roll back your recent edit and post the solution as an answer instead. You are allowed and even encouraged to mark your own answer as accepted."}, {"owner": {"reputation": 111, "user_id": 7133719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bfaf34da0c8c293498e38ba2d862231?s=128&d=identicon&r=PG&f=1", "display_name": "Tugrul Bayrak", "link": "https://stackoverflow.com/users/7133719/tugrul-bayrak"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1575533701, "post_id": 59173628, "comment_id": 104600766, "body": "@tripleee I changed it. Also I will accept my answer tomorrow. Thanks for your advice, I didn&#39;t know that."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 7133719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bfaf34da0c8c293498e38ba2d862231?s=128&d=identicon&r=PG&f=1", "display_name": "Tugrul Bayrak", "link": "https://stackoverflow.com/users/7133719/tugrul-bayrak"}, "is_accepted": true, "score": 2, "last_activity_date": 1575533755, "last_edit_date": 1575533755, "creation_date": 1575533451, "answer_id": 59190743, "question_id": 59173628, "link": "https://stackoverflow.com/questions/59173628/reading-bytes-over-tcp-and-encoding-to-iso-8859-9-in-go/59190743#59190743", "title": "Reading bytes over TCP and encoding to ISO-8859-9 in Go", "body": "<p>charmap.ISO8859_9.NewEncoder().Bytes() function wants UTF-8 format to encode. I was getting error when I try to encode my bytes. Because my incoming bytes are in 8859-9 format and I was trying to convert them directly. First I decode the bytes to UTF-8 format. I did my process, at the end I encoded this UTF-8 bytes to ISO8859-9 unicode using encoder. Here is the new code.</p>\n\n<pre><code>//main package\nbytes, err := textproc.R.ReadBytes(constant.EndTextDelimiter)\ncheckError(err)\nmsg := encoder.DecodeISO8859_9ToUTF8(bytes)\n//..........\n// Process that string, create struct Then convert struct to json bytes\n// Then encode that bytes\njson := encoder.EncodeUTF8ToISO8859_9(bytes)\n\n//encoder package\npackage encoder\nimport \"golang.org/x/text/encoding/charmap\"\n\nfunc DecodeISO8859_9ToUTF8(bytes []byte) string {\n    encoded, _ := charmap.ISO8859_9.NewDecoder().Bytes(bytes)\n    return string(encoded[:])\n}\n\nfunc EncodeUTF8ToISO8859_9(bytes []byte) string {\n    encoded, _ := charmap.ISO8859_9.NewEncoder().Bytes(bytes)\n    return string(encoded[:])\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7133719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bfaf34da0c8c293498e38ba2d862231?s=128&d=identicon&r=PG&f=1", "display_name": "Tugrul Bayrak", "link": "https://stackoverflow.com/users/7133719/tugrul-bayrak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 59190743, "answer_count": 1, "score": 3, "last_activity_date": 1586219542, "creation_date": 1575454528, "last_edit_date": 1586219542, "question_id": 59173628, "link": "https://stackoverflow.com/questions/59173628/reading-bytes-over-tcp-and-encoding-to-iso-8859-9-in-go", "title": "Reading bytes over TCP and encoding to ISO-8859-9 in Go", "body": "<p>I am new to Golang. I am developing a service which reads bytes from remote address over TCP. The problem is that I can not change encoding of bytes I read. I want to convert the bytes I read to ISO-8859-9 string. Here is part of reading code.</p>\n\n<pre><code> conn, err := net.Dial(\"tcp\", constant.ConnectHost+\":\"+constant.ConnectPort)\n checkError(err)\n defer conn.Close()\n\n reader := bufio.NewReader(conn)\n textproc := textproto.NewReader(reader)\n\n bytes, err := textproc.R.ReadBytes(constant.EndTextDelimiter)\n checkError(err)\n msg := string(bytes[:])\n</code></pre>\n\n<p>Code works fine. But the encoding is different than I want. It is a problem for receiving service. Any suggestion?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575452464, "post_id": 59172851, "comment_id": 104568019, "body": "Do you actually get various errors, or you just get the one error you pasted?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575452482, "post_id": 59172851, "comment_id": 104568038, "body": "And what is on line 19 of healtCheck.go?"}, {"owner": {"reputation": 29, "user_id": 7088832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7Q1qsSdtPg/AAAAAAAAAAI/AAAAAAAAG08/5Oh0Fi2Ciuo/photo.jpg?sz=128", "display_name": "KshiTij SiNgh", "link": "https://stackoverflow.com/users/7088832/kshitij-singh"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575452570, "post_id": 59172851, "comment_id": 104568095, "body": "@Filmzy I am getting this errror after fixing couple of them. And on line 19 i am just accessing response code from response of api request"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1575452647, "post_id": 59172851, "comment_id": 104568139, "body": "Well something on line 19 is trying to dereference a nil pointer. Since you&#39;ve only described it, and not shown the actual code in question, I can&#39;t be more specific."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1575452696, "post_id": 59172851, "comment_id": 104568165, "body": "The code you posted does not lead to that stack trace."}, {"owner": {"reputation": 29, "user_id": 7088832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7Q1qsSdtPg/AAAAAAAAAAI/AAAAAAAAG08/5Oh0Fi2Ciuo/photo.jpg?sz=128", "display_name": "KshiTij SiNgh", "link": "https://stackoverflow.com/users/7088832/kshitij-singh"}, "edited": false, "score": 0, "creation_date": 1575452861, "post_id": 59172851, "comment_id": 104568252, "body": "line 19 is : ch &lt;- resp.StatusCode"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1575453205, "post_id": 59172851, "comment_id": 104568466, "body": "You&#39;re not handling errors properly. In case of an error, you print it, but then proceed as if no error occurred, which leads to your panic."}], "answers": [{"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 29, "user_id": 7088832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7Q1qsSdtPg/AAAAAAAAAAI/AAAAAAAAG08/5Oh0Fi2Ciuo/photo.jpg?sz=128", "display_name": "KshiTij SiNgh", "link": "https://stackoverflow.com/users/7088832/kshitij-singh"}, "edited": false, "score": 0, "creation_date": 1575452825, "post_id": 59172946, "comment_id": 104568227, "body": "@KshiTijSiNgh I updated my answer to provide you with an explanation of the error and the corrected code."}], "tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": true, "score": 1, "last_activity_date": 1575452775, "last_edit_date": 1575452775, "creation_date": 1575452561, "answer_id": 59172946, "question_id": 59172851, "link": "https://stackoverflow.com/questions/59172851/hit-url-for-50000-parellel-request/59172946#59172946", "title": "Hit url for 50000 parellel request", "body": "<p>You must close <code>resp.Body</code> in <code>MakeRequests</code>.</p>\n\n<p>The other problem causing the error is that you try to access  <code>StatusCode</code> when <code>resp</code> is nil due to an error. </p>\n\n<p>Here is the code fixed.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func MakeRequests(url string, ch chan&lt;- int, wg *sync.WaitGroup) {\n    time.Sleep(time.Duration(rand.Intn(10)) * time.Millisecond)\n    resp, err := http.Get(url)\n    if resp != nil {\n        ch &lt;- resp.StatusCode\n        defer func() {\n            _, err = io.Copy(ioutil.Discard, resp.Body)\n            resp.Body.Close()\n        }()\n    } else {\n        ch &lt;- -1 // because main expect exactly totalHit values in ch\n    }\n    if err != nil {\n        fmt.Println(err)\n    }\n    wg.Done()\n}\n\n\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "is_accepted": false, "score": 0, "last_activity_date": 1575813932, "last_edit_date": 1575813932, "creation_date": 1575809356, "answer_id": 59235536, "question_id": 59172851, "link": "https://stackoverflow.com/questions/59172851/hit-url-for-50000-parellel-request/59235536#59235536", "title": "Hit url for 50000 parellel request", "body": "<p>You can use the following library:</p>\n\n<p><strong>Requests</strong>: <em>A Go library for reduce the headache when making HTTP requests (20k/s req)</em></p>\n\n<p><a href=\"https://github.com/alessiosavi/Requests\" rel=\"nofollow noreferrer\">https://github.com/alessiosavi/Requests</a></p>\n\n<p>The idea is to allocate a list of request, than send them with a configurable \"parallel\" factor that allow to run only \"N\" request at time. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// This array will contains the list of request\nvar reqs []requests.Request\n\n// N is the number of request to run in parallel, in order to avoid \"TO MANY OPEN FILES. N have to be lower than ulimit threshold\"\nvar N int = 12\n\n// Create the list of request\nfor i := 0; i &lt; 1000; i++ {\n    // In this case, we init 1000 request with same URL,METHOD,BODY,HEADERS \n    req, err := requests.InitRequest(\"https://127.0.0.1:5000\", \"GET\", nil, nil, true) \n    if err != nil {\n        // Request is not compliant, and will not be add to the list\n        log.Println(\"Skipping request [\", i, \"]. Error: \", err)\n    } else {\n        // If no error occurs, we can append the request created to the list of request that we need to send\n        reqs = append(reqs, *req)\n    }\n}\n</code></pre>\n\n<p>At this point, we have a list that contains the requests that have to be sent.\nLet's send them in parallel!</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// This array will contains the response from the givens request\nvar response []datastructure.Response\n\n// send the request using N request to send in parallel\nresponse = requests.ParallelRequest(reqs, N)\n\n// Print the response\nfor i := range response {\n    // Dump is a method that print every information related to the response\n    log.Println(\"Request [\", i, \"] -&gt; \", response[i].Dump())\n    // Or use the data present in the response\n    log.Println(\"Headers: \", response[i].Headers)\n    log.Println(\"Status code: \", response[i].StatusCode)\n    log.Println(\"Time elapsed: \", response[i].Time)\n    log.Println(\"Error: \", response[i].Error)\n    log.Println(\"Body: \", string(response[i].Body))\n}\n</code></pre>\n\n<p>You can find example usage into the example folder of the repository.</p>\n\n<p><strong><em>SPOILER</em></strong>:  </p>\n\n<blockquote class=\"spoiler\">\n  <p> <em>I'm the author of this little library</em>  </p>\n</blockquote>\n"}], "owner": {"reputation": 29, "user_id": 7088832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7Q1qsSdtPg/AAAAAAAAAAI/AAAAAAAAG08/5Oh0Fi2Ciuo/photo.jpg?sz=128", "display_name": "KshiTij SiNgh", "link": "https://stackoverflow.com/users/7088832/kshitij-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59172946, "answer_count": 2, "score": -3, "last_activity_date": 1575813932, "creation_date": 1575452210, "last_edit_date": 1575452449, "question_id": 59172851, "link": "https://stackoverflow.com/questions/59172851/hit-url-for-50000-parellel-request", "title": "Hit url for 50000 parellel request", "body": "<p>I am trying to hit any sample url for parallel 50000 requests. But I get various kinds of error. Can somebody let me know what am I doing wrong? Or what should be the strategy?</p>\n\n<pre><code>func MakeRequests(url string, ch chan&lt;- int, wg *sync.WaitGroup) {\n    time.Sleep(time.Duration(rand.Intn(10)) * time.Millisecond)\n    resp, err := http.Get(url)\n    if err != nil {\n        fmt.Println(err)\n    }\n    ch &lt;- resp.StatusCode\n    wg.Done()\n}\n\nfunc main() {\n\n    var waitGroup sync.WaitGroup \n    count := 0\n    ch := make(chan int)\n    url := \"http://some-dummy-url/ping\"\n    totalHits, _ := strconv.Atoi(\"50000\")\n    waitGroup.Add(totalHits)\n\n    for i := 0; i &lt; totalHits; i++ {\n        go MakeRequests(url, ch, &amp;waitGroup)\n    }\n\n    for i := 0; i &lt; totalHits; i++ {\n        if &lt;-ch == 200 {\n            count++\n        }\n    }\n    waitGroup.Wait()\n\n    fmt.Printf(\"Total number of successfull request :\" + strconv.Itoa(count))\n}\n</code></pre>\n\n<p>Error  </p>\n\n<pre><code>Get http://some-dummy-url/ping: dial tcp 10.120.0.45:80: connect: can't assign requested address\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x123da32]\n\ngoroutine 13425 [running]:\nmain.MakeRequests(0x7ffeefbff868, 0x22, 0xc0000880c0, 0xc0000ae290)\n        /Users/kshitij/go/src/github.com/pingService/healthCheck.go:19 +0xe2\ncreated by main.main\n        /Users/kshitij/go/src/github.com/pingService/healthCheck.go:33 +0x136\nexit status 2\n</code></pre>\n"}, {"tags": ["go", "cadence-workflow"], "answers": [{"comments": [{"owner": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "edited": false, "score": 0, "creation_date": 1575532655, "post_id": 59180672, "comment_id": 104600311, "body": "but you can run local activities that skips scheduling, so if I don&#39;t use any of the state-full aspect of the workflow would be nice to have a fail-over version."}, {"owner": {"reputation": 4458, "user_id": 1664318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1L0iT.jpg?s=128&g=1", "display_name": "Maxim Fateev", "link": "https://stackoverflow.com/users/1664318/maxim-fateev"}, "reply_to_user": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "edited": false, "score": 0, "creation_date": 1575660373, "post_id": 59180672, "comment_id": 104653942, "body": "Local activity results are still checkpointed to to Cadence. So I wouldn&#39;t rely on them for higher availability."}], "tags": [], "owner": {"reputation": 4458, "user_id": 1664318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1L0iT.jpg?s=128&g=1", "display_name": "Maxim Fateev", "link": "https://stackoverflow.com/users/1664318/maxim-fateev"}, "is_accepted": false, "score": 1, "last_activity_date": 1575477235, "creation_date": 1575477235, "answer_id": 59180672, "question_id": 59172077, "link": "https://stackoverflow.com/questions/59172077/cadence-workflow-in-case-of-cadence-outage/59180672#59180672", "title": "cadence workflow in case of cadence outage", "body": "<p>The service connection is required to make any progress in the workflow execution including scheduling activities.</p>\n\n<p>To run workflows locally you can use local version of the Cadence service. Such version can be easily installed through docker compose.</p>\n\n<p>If you need high availability setup you can use multi-cluster Cadence. So a single cluster outage is not going to cause workflow execution outager.</p>\n"}], "owner": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575477235, "creation_date": 1575449267, "last_edit_date": 1575463471, "question_id": 59172077, "link": "https://stackoverflow.com/questions/59172077/cadence-workflow-in-case-of-cadence-outage", "title": "cadence workflow in case of cadence outage", "body": "<p>It is possible to run local <em>activities</em> that don't require a connection to the <a href=\"https://cadenceworkflow.io/\" rel=\"nofollow noreferrer\">cadence</a> server. Is there a proper way to run <em>workflows</em> locally, too, in case of a cadence outage? \nI'm using the Go client.</p>\n"}, {"tags": ["go", "grpc", "grpc-go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575449081, "post_id": 59171428, "comment_id": 104566220, "body": "<a href=\"https://godoc.org/google.golang.org/genproto/googleapis/rpc/status#Status.Details\" rel=\"nofollow noreferrer\">Details has the Any type</a>, so what&#39;s stopping you from inventing your own Detail type? (Assuming you&#39;re using <a href=\"https://godoc.org/google.golang.org/grpc/status\" rel=\"nofollow noreferrer\">google.golang.org/grpc/status</a> to construct error values.)"}, {"owner": {"reputation": 131, "user_id": 4198541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f660379aebe14828db3922304a0a0e8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Lieskin", "link": "https://stackoverflow.com/users/4198541/nikita-lieskin"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575450352, "post_id": 59171428, "comment_id": 104566906, "body": "@Peter , thanks, but it can&#39;t be defined for clients as a message in proto file, correct? Is it like a convenience ?"}, {"owner": {"reputation": 131, "user_id": 4198541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f660379aebe14828db3922304a0a0e8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Lieskin", "link": "https://stackoverflow.com/users/4198541/nikita-lieskin"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575450598, "post_id": 59171428, "comment_id": 104567014, "body": "Oh, I see now, I can pass any proto message to WithDetails method. Thanks, it helps a lot."}, {"owner": {"reputation": 321, "user_id": 8801473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0525ed8ecc12d39921cc817995a71c?s=128&d=identicon&r=PG&f=1", "display_name": "ptrckdev", "link": "https://stackoverflow.com/users/8801473/ptrckdev"}, "edited": false, "score": 0, "creation_date": 1575463506, "post_id": 59171428, "comment_id": 104574055, "body": "My personal problem with that solution is that now the error messages are no longer strictly defined in the protobuf file. Clients who use your API now have to go and look for the possible ErrorCodes they can recieve and what they mean (if they need to know that information) instead of seeing directly which rpc call can produce which error"}], "owner": {"reputation": 131, "user_id": 4198541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f660379aebe14828db3922304a0a0e8?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Lieskin", "link": "https://stackoverflow.com/users/4198541/nikita-lieskin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575446645, "creation_date": 1575446645, "question_id": 59171428, "link": "https://stackoverflow.com/questions/59171428/proper-way-to-errors-response-in-grpc", "title": "Proper way to errors response in GRPC?", "body": "<p>I try to find out the way to report server errors via grpc. What I want to achieve is errors that are verbose and static defined enough to tell clients what actually happened.</p>\n\n<p>Imagine I have the next request:</p>\n\n<pre><code>message UpdateEmailRequest {\n  string email = 1;\n}\n\nmessage UpdateEmailResponse {\n}\n</code></pre>\n\n<p>Then I was trying to make errors more verbose because status codes don't tell clients about error details. You could use <code>FieldViolation</code>, but it only specifies the field, not the error in the static way. You could provide <code>Description</code> to these <code>FieldViolations</code> but clients need to either deal with string errors and somehow map them to internal client errors OR clients display these errors directly, which doesn't work in some cases because business logic can vary based on the error type.</p>\n\n<p>What I've invented is:</p>\n\n<pre><code>message UpdateEmailResponse {\n  enum ErrorCode {\n    UNKNOWN_ERROR = 0;\n    INVALID_EMAIL_LENGTH = 1;\n    INVALID_EMAIL_FORMAT = 2;\n    INVALID_EMAIL_TEMPORARY_MAIL_NOT_ALLOWED = 3; //temporary mail services\n    INVALID_EMAIL_ALIAS = 4; // email is alias or redirect, not the actual email\n    INVALID_EMAIL_FORBIDDEN_WORDS = 5; // for email with bad language\n    ...\n  }\n\n  message Body {}\n\n  oneof response {\n    ErrorCode error_code = 1;\n    Body body = 2;\n  }\n}\n</code></pre>\n\n<p>This way you could let the clients know about specific errors combined with status codes, but it doesn't use the out-of-box <code>FieldViolations</code> and it looks like non-grpc way to handle errors.</p>\n\n<p>Other solution is to embed json with error code (which I can still have defined inside the request entity) and error msg inside the <code>FieldViolations</code>'s <code>Description</code>, but again, it looks like non-grpc way.</p>\n\n<p>So, I'm stuck here with errors in grpc, could you tell me the proper way to do it?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1575445079, "post_id": 59170937, "comment_id": 104564489, "body": "You are essentially trying to use an inherently stateless protocol to stream data over and extended period of time. You will run into all sorts of problems with that approach. Instead, use <a href=\"https://en.wikipedia.org/wiki/WebSocket\" rel=\"nofollow noreferrer\">websockets</a> for arbitrary data, or <a href=\"https://www.grpc.io/docs/quickstart/go/\" rel=\"nofollow noreferrer\">grpc</a> for formalized messages."}, {"owner": {"reputation": 17, "user_id": 12429356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-99uTv7hcHGg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZsvkpcAb_aDltK6B4ru7iiG-_7w/photo.jpg?sz=128", "display_name": "Decard Cain", "link": "https://stackoverflow.com/users/12429356/decard-cain"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1575445224, "post_id": 59170937, "comment_id": 104564549, "body": "Thanks for your comment. Yes, I know this is a misuse of the HTTP protocol. I am still trying to solve this :)"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1575445449, "post_id": 59170937, "comment_id": 104564651, "body": "It has been solved. See above. Reinventing the wheel over and over again does little to further FOSS and for closed source/commercial applications it is simply a waste of precious, <i>expensive</i> developer time. Especially further down the road, as you have to maintain that stuff, too."}], "answers": [{"tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": true, "score": 1, "last_activity_date": 1575445512, "creation_date": 1575445512, "answer_id": 59171167, "question_id": 59170937, "link": "https://stackoverflow.com/questions/59170937/golang-parsing-chunked-http-responses-from-socket-read-chunk-by-chunk/59171167#59171167", "title": "golang parsing chunked HTTP responses from socket - read chunk by chunk", "body": "<p>Instead of using <code>io.Copy</code> use <code>resp.Body.Read(buf)</code> where <code>buf</code> is an allocated byte slice. Use a big enough buffer so that the chunk doesn\u2019t get truncated. The read should fill <code>buf</code> with a chunk. </p>\n"}], "owner": {"reputation": 17, "user_id": 12429356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-99uTv7hcHGg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZsvkpcAb_aDltK6B4ru7iiG-_7w/photo.jpg?sz=128", "display_name": "Decard Cain", "link": "https://stackoverflow.com/users/12429356/decard-cain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "accepted_answer_id": 59171167, "answer_count": 1, "score": 0, "last_activity_date": 1575445512, "creation_date": 1575444571, "question_id": 59170937, "link": "https://stackoverflow.com/questions/59170937/golang-parsing-chunked-http-responses-from-socket-read-chunk-by-chunk", "title": "golang parsing chunked HTTP responses from socket - read chunk by chunk", "body": "<p>My mail goal is to read data from a TCP socket connected to a HTTP server, and parse\nthe HTTP response chunk by chunk (Transfer-Encoding: chunked) - the server sends a chunk every 30 seconds on the same connection</p>\n\n<p>I attached my code. It seems like io.Copy reads the first chunk and then waits for the next one before returning, so it blocks me.</p>\n\n<p>How can I read the chunks when they arrive, without waiting for the next one?</p>\n\n<pre><code>func readHttpChunk(server net.conn) {\n    buf := bufio.NewReader(server)\n    for {\n        resp, err := http.ReadResponse(buf, nil)\n        b := new(bytes.Buffer)\n        io.Copy(b, resp.Body)\n        fmt.Printf(\"Got me a chunk!\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 4, "creation_date": 1575443482, "post_id": 59170619, "comment_id": 104563861, "body": "The default value of <code>node.Stat</code> is <code>nil</code> since it is a pointer. You need to initialize it before using it. eg: add <code>node.Stat = new(Stat)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 26911, "user_id": 225262, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/10f7602ff38f6486cb1580052746fc05?s=128&d=identicon&r=PG", "display_name": "satoru", "link": "https://stackoverflow.com/users/225262/satoru"}, "is_accepted": false, "score": 5, "last_activity_date": 1575446034, "last_edit_date": 1575446034, "creation_date": 1575443924, "answer_id": 59170777, "question_id": 59170619, "link": "https://stackoverflow.com/questions/59170619/how-to-assign-a-slice-to-a-slice-in-struct/59170777#59170777", "title": "How to assign a slice to a slice in struct?", "body": "<p>When you create a struct, it's fields default to <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">the zero value</a> of their corresponding type. It's <code>0</code> for <code>int</code>, <code>nil</code> for pointer fields, etc.</p>\n\n<p>In your case, the only field <code>Stat</code> is a pointer, after calling <code>new(Node)</code>, <code>node.Stat</code> is <code>nil</code>, so it would result in the runtime error you see.</p>\n\n<p>To avoid the error, make sure you initialize the fields before accessing them.</p>\n"}], "owner": {"reputation": 123, "user_id": 9201650, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fIQRE5tlfKk/AAAAAAAAAAI/AAAAAAAAAp0/O-mnXghzfGc/photo.jpg?sz=128", "display_name": "Inasa Xia", "link": "https://stackoverflow.com/users/9201650/inasa-xia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1575455711, "answer_count": 1, "score": 0, "last_activity_date": 1575446034, "creation_date": 1575443208, "question_id": 59170619, "link": "https://stackoverflow.com/questions/59170619/how-to-assign-a-slice-to-a-slice-in-struct", "closed_reason": "Not suitable for this site", "title": "How to assign a slice to a slice in struct?", "body": "<pre><code>type Node struct {\n    Stat *Stat\n}\n\n\ntype Stat struct {\n    StatInfo []string\n}\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>node := new(Node)\nnode.Stat.Statinfo=strings.Split(somestr,\" \")\n</code></pre>\n\n<p>The result is:</p>\n\n<p>panic: runtime error: invalid memory address or nil pointer dereference</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "edited": false, "score": 0, "creation_date": 1575441051, "post_id": 59170081, "comment_id": 104563020, "body": "Can you explain why this should be closed or what&#39;s the reason for a downvote. Ty."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1575441144, "post_id": 59170081, "comment_id": 104563057, "body": "In <code>for _, s := ...</code> the variable <code>s</code> is populated by a copy of each element of <code>l.shelves</code>. In other words: your code never even tries to modify a shelve in the library, only a copy is ever modified. This is unrelated to slices and append. Start by iterating like <code>for i := ...</code> and modifiy the actual sheve like <code>l.shelves[i]</code>."}, {"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1575441305, "post_id": 59170081, "comment_id": 104563110, "body": "ah ok, thanks for explaining. Didn&#39;t realize this is unrelated to slice."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1575441142, "creation_date": 1575441142, "answer_id": 59170140, "question_id": 59170081, "link": "https://stackoverflow.com/questions/59170081/update-a-slice-in-a-struct-passed-to-a-function/59170140#59170140", "title": "Update a slice in a struct passed to a function", "body": "<p>In this statement:</p>\n\n<pre><code>s := range (*l).shelves \n</code></pre>\n\n<p>the variable <code>s</code> is a copy of the slice element.  The later call to append modifies this copy, the not slice element.  Change the code to modify the slice element:</p>\n\n<pre><code>func addBookToShelfInLibrary(l *library, shelfid int, b book) {\n    for i := range l.shelves {\n        s := &amp;l.shelves[i]\n        if s.id == shelfid {\n            //found shelf, add book\n            s.books = append(s.books, b)\n        }\n    }\n}\n</code></pre>\n\n<p>Another approach is to use a pointer to a shelf:</p>\n\n<pre><code>type library struct {\n    shelves []*shelf\n}\n\nlib := library{\n    shelves: []*shelf{\n        {\n ...\n</code></pre>\n\n<p>All other code remains the same. <a href=\"https://play.golang.org/p/TbbA9v6N5n9\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 59170140, "answer_count": 1, "score": -2, "last_activity_date": 1575441142, "creation_date": 1575440838, "question_id": 59170081, "link": "https://stackoverflow.com/questions/59170081/update-a-slice-in-a-struct-passed-to-a-function", "title": "Update a slice in a struct passed to a function", "body": "<p>Need help in understanding how to update a slice that is contained in a struct and passed to a function. </p>\n\n<p>Function addBookToShelfInLibrary(l *library, shelfid int, b book) - takes as input a library, tries to add to book to the shelf with the id = shelfid (passed as param). The function appends to the books array and also assigns it to books array. What am I missing? </p>\n\n<p>At the end of code run, I expect the books to contain two books, \"harrypotter\", \"bible\" but I see only one, i.e. harrypotter. Also, I am passing a pointer to the library but I don't think that matters in this case. </p>\n\n<p>playground code:- <a href=\"https://play.golang.org/p/JrjtLSj-jHI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JrjtLSj-jHI</a></p>\n\n<pre><code>func main() {\n    lib := library{\n        shelves: []shelf{\n            {\n                id: 1,\n                books: []book{\n                    {name: \"harrypotter\"},\n                },\n            },\n        },\n    }\n    addBookToShelfInLibrary(&amp;lib, 1, book{name: \"bible\"})\n    fmt.Printf(\"%v\", lib)\n\n}\n\ntype library struct {\n    shelves []shelf\n}\ntype shelf struct {\n    id    int\n    books []book\n}\n\ntype book struct {\n    name string\n}\n\nfunc addBookToShelfInLibrary(l *library, shelfid int, b book) {\n    for _, s := range (*l).shelves {\n        if s.id == shelfid {\n            //found shelf, add book\n            s.books = append(s.books, b)\n        }\n    }\n}\n</code></pre>\n\n<p>Thanks for your answer / explanation in advance. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1575473502, "post_id": 59169649, "comment_id": 104579977, "body": "Please reduce your code so that you have a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7255394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MyrP.jpg?s=128&g=1", "display_name": "thaniri", "link": "https://stackoverflow.com/users/7255394/thaniri"}, "edited": false, "score": 0, "creation_date": 1575521196, "post_id": 59169736, "comment_id": 104596485, "body": "Thank you. It was a situation in which I was confusing arrays and slices."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1575438947, "creation_date": 1575438947, "answer_id": 59169736, "question_id": 59169649, "link": "https://stackoverflow.com/questions/59169649/go-compare-two-structs-for-greater-than/59169736#59169736", "title": "Go Compare Two Structs For Greater Than", "body": "<p><code>Suits</code> and <code>Ranks</code> are not slices. They are arrays. An array is a fixed-sized type, and it is different from a slice. You cannot send an array to a function expecting a slice. So, declare them without size, and they will become slices:</p>\n\n<pre><code>var Suits=[]string{...}\nvar Ranks=[]string{...}\n</code></pre>\n\n<p>Or, if you want to keep them as arrays, you have to pass a slice to the function that expects a slice:</p>\n\n<pre><code>indexOfSlice(str,Suits[:])\n</code></pre>\n\n<p>About the question for a better way of doing this: you can use a map:</p>\n\n<pre><code>var Suits=map[string]int{\"hearts\":0, \"spades\":1, \"diamonds\":2, \"clubs\":3}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>rankSuit=Suits[str]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7255394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MyrP.jpg?s=128&g=1", "display_name": "thaniri", "link": "https://stackoverflow.com/users/7255394/thaniri"}, "edited": false, "score": 0, "creation_date": 1575521287, "post_id": 59183971, "comment_id": 104596513, "body": "Thank you for your comment. In <a href=\"https://stackoverflow.com/a/59169736/7255394\">stackoverflow.com/a/59169736/7255394</a> a map was suggested. It is much quicker to compare the values of a map than to implement these interfaces.  I am curious though, why did you create a Suit called sentinel?"}, {"owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "reply_to_user": {"reputation": 3, "user_id": 7255394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MyrP.jpg?s=128&g=1", "display_name": "thaniri", "link": "https://stackoverflow.com/users/7255394/thaniri"}, "edited": false, "score": 0, "creation_date": 1575521451, "post_id": 59183971, "comment_id": 104596558, "body": "In Go, when I create enums like i have here, I always create a sentinel value rhat remains the last value in the list in order to check validation. See the Valid function. As long as sentinel is always last, I can easily check if an enum is valid. :)"}], "tags": [], "owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "is_accepted": false, "score": 0, "last_activity_date": 1575490264, "creation_date": 1575490264, "answer_id": 59183971, "question_id": 59169649, "link": "https://stackoverflow.com/questions/59169649/go-compare-two-structs-for-greater-than/59183971#59183971", "title": "Go Compare Two Structs For Greater Than", "body": "<p>I would abstract your types, and add some utility functions to them.</p>\n\n<p>Creating custom types for <code>Card</code>, <code>Suit</code>, and <code>Rank</code>, allows you to attach comparison and validity functions to each of them.</p>\n\n<p>If you're wanting a similar interface to <code>Comparable</code> in Java, it's a very small interface that you could create yourself, too. It would be simple enough to implement the necessary <code>CompareTo</code> functions for your types to satisfy the interface, although, I think that the solution I've provided encapsulates the types a little better and is easier to test.</p>\n\n<p>I've added the logic to compare the <code>Suit</code> of the <code>Card</code> in the scenario that the <code>Rank</code> of both cards is equal, but I'm not entirely sure of the reasoning behind this since usually playing cards with equal rank are considered as equal cards.</p>\n\n<p>Good luck!</p>\n\n<hr>\n\n<p><strong>cards/card.go</strong></p>\n\n<pre><code>func New(s Suit, r Rank) (*Card, error) {\n    if !s.Valid() {\n        return nil, errors.New(\"invalid suit\")\n    }\n\n    if !r.Valid() {\n        return nil, errors.New(\"invalid rank\")\n    }\n\n    return &amp;Card{suit: s, rank: r}, nil\n}\n\ntype Card struct {\n    suit Suit\n    rank Rank\n}\n\nfunc (c *Card) Cmp(c2 *Card) int {\n    rankCmp := c.rank.Cmp(c2.rank)\n    if rankCmp != 0 {\n        return rankCmp\n    }\n\n    if c.suit &lt; c2.suit {\n        return -1\n    }\n\n    if c.suit &gt; c2.suit {\n        return 1\n    }\n\n    return 0\n}\n</code></pre>\n\n<hr>\n\n<p><strong>cards/rank.go</strong></p>\n\n<pre><code>type Rank string\n\nvar ranks = []Rank{\"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"J\", \"Q\", \"K\", \"A\"}\n\nfunc (r Rank) Cmp(r2 Rank) int {\n    for _, rank := range ranks {\n        if rank == r {\n            return -1\n        }\n\n        if rank == r2 {\n            return 1\n        }\n    }\n\n    return 0\n}\n\nfunc (r Rank) Valid() bool {\n    for _, rank := range ranks {\n        if r == rank {\n            return true\n        }\n    }\n\n    return false\n}\n</code></pre>\n\n<hr>\n\n<p><strong>cards/suit.go</strong></p>\n\n<pre><code>type Suit int\n\nconst (\n    unknown  Suit = 1\n    Hearts   Suit = 2\n    Spades   Suit = 3\n    Diamonds Suit = 4\n    Clubs    Suit = 5\n    sentinel Suit = 6\n)\n\nfunc (s Suit) Valid() bool {\n    return s &gt; unknown &amp;&amp; s &lt; sentinel\n}\n</code></pre>\n\n<hr>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>func main() {\n    c1, err := cards.New(Hearts, \"2\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    c2, err := New(cards.Diamonds, \"A\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    c3, err := New(cards.Spades, \"A\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    fmt.Printf(\"c1 - c2: %d\\n\", c1.Cmp(c2))\n    fmt.Printf(\"c2 - c3: %d\\n\", c2.Cmp(c3))\n    fmt.Printf(\"c1 - c3: %d\\n\", c1.Cmp(c3))\n}\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://play.golang.com/p/DeiJeLGh1Y1\" rel=\"nofollow noreferrer\">(Go Playground)</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7255394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MyrP.jpg?s=128&g=1", "display_name": "thaniri", "link": "https://stackoverflow.com/users/7255394/thaniri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 59169736, "answer_count": 2, "score": -3, "last_activity_date": 1575490264, "creation_date": 1575438537, "last_edit_date": 1575473137, "question_id": 59169649, "link": "https://stackoverflow.com/questions/59169649/go-compare-two-structs-for-greater-than", "title": "Go Compare Two Structs For Greater Than", "body": "<p>I am trying to compare two playing card structs to see which playing card is better than the other one. Everything I can find online for comparing structs in Go is to compare for equality, but in this case I want to say that an Ace of Spades is more valuable than a 7 of Clubs.</p>\n\n<p>Given that Go does not provide something like Java's comparator interface out of the box, I wanted to create my own function to do card comparison using loops, but I am getting the error message:</p>\n\n<pre><code># cards/card\ncard/Card.go:12:19: cannot use Ranks (type [13]string) as type []string in argument to indexOfSlice\ncard/Card.go:14:26: cannot use Ranks (type [13]string) as type []string in argument to indexOfSlice\ncard/Card.go:15:20: cannot use Suits (type [4]string) as type []string in argument to indexOfSlice\n</code></pre>\n\n<p>This is my Card package:</p>\n\n<pre><code>package Card\n\nvar Suits = [4]string {\"hearts\", \"spades\", \"diamonds\", \"clubs\"}\nvar Ranks = [13]string {\"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"jack\", \"queen\", \"king\", \"ace\"}\n\ntype Card struct {\n        Value string\n        Suit string\n}\n\n// if the index in the slices is greater for a than for b, then a must be greater value\nfunc CardIsGreater(a Card, b Card) bool {\n        if indexOfSlice(a.Value, Ranks) &gt; indexOfSlice(b.Value, Ranks) {\n                return true;\n        } else if indexOfSlice(a.Value, Ranks) == indexOfSlice(b.Value, Ranks) {\n                if indexOfSlice(a.Suit, Suits) &gt; indexOfSlice(b.Suit, Suits) {\n                        return true;\n                }\n        } else {\n                return false;\n        }\n        // lets ignore for a second that invalid ranks or suits will break this comparator\n        return false;\n}\n\n// finds the index of a suit or value in a slice\nfunc indexOfSlice(element string, slice []string) int {\n        for i, _ := range slice {\n                if slice[i] == element {\n                        return i;\n                }\n        }\n        return -1;\n}\n</code></pre>\n\n<p>This is my main package:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"cards/card\"\n)\n\nfunc main () {\n    card := Card.Card{Suit: \"hearts\", Value: \"ace\"}\n    card2 := Card.Card{Suit: \"diamonds\", Value: \"queen\"}\n    fmt.Println(card)\n    fmt.Println(card2)\n    fmt.Println(Card.CardIsGreater(card, card2)\n}\n</code></pre>\n\n<p>How, in this case, would I get the indexOfSlice helper function to accept a slice of strings as one of its arguments? If I read a random tutorial from the front page of my google search, it looks like it should work: <a href=\"https://nanxiao.gitbooks.io/golang-101-hacks/content/posts/pass-slice-as-a-function-argument.html\" rel=\"nofollow noreferrer\">https://nanxiao.gitbooks.io/golang-101-hacks/content/posts/pass-slice-as-a-function-argument.html</a></p>\n\n<p>This stack overflow answer explains that Go is basically enforcing type safety as type []string can be satisfied by many things: <a href=\"https://stackoverflow.com/a/44606795/7255394\">https://stackoverflow.com/a/44606795/7255394</a>. If that is the case, then how do I get around this issue?</p>\n\n<p>Furthermore, is this even the correct way to approach comparing structs? In the case of Ace of Spaces being compared to Ace of Hearts it would take 4 loops over the Suits And Ranks slices (!!) in order to actually get a comparison.</p>\n"}, {"tags": ["php", "go"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1575434244, "post_id": 59168880, "comment_id": 104561211, "body": "I tried some online hex-to-float converter, and 0.28858796 is not the correct answer. the correct float number should be -4.05957e+08. and your go code is generating valid answer"}], "answers": [{"tags": [], "owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "is_accepted": false, "score": 0, "last_activity_date": 1575444960, "creation_date": 1575444960, "answer_id": 59171052, "question_id": 59168880, "link": "https://stackoverflow.com/questions/59168880/whats-golangs-equivalent-to-phps-unpack-f-str/59171052#59171052", "title": "What&#39;s golang&#39;s equivalent to PHP&#39;s unpack(\u201cf\u201d, $str)?", "body": "<p>The following will give you the result you are expecting (<a href=\"https://play.golang.org/p/bTkJAurhfsH\" rel=\"nofollow noreferrer\">playground</a>):</p>\n\n<pre><code>i := \"CDC1933E\"\nb, _ := hex.DecodeString(i)\nbuf := bytes.NewReader(b)\nvar ui uint32\nerr := binary.Read(buf, binary.LittleEndian, &amp;ui)\nif err != nil {\n    panic(err)\n}\nf := math.Float32frombits(ui)\nfmt.Println(f)\n</code></pre>\n\n<p>You will note that the data is little endian encoded (Python defaults to the byte order of your host system; assuming you are running intel x86/AMD64  that is little-endian).</p>\n"}], "owner": {"reputation": 1, "user_id": 12477531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85335c4bb340e2ad7c8e85aed25aa310?s=128&d=identicon&r=PG&f=1", "display_name": "match", "link": "https://stackoverflow.com/users/12477531/match"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "closed_date": 1575476595, "answer_count": 1, "score": -2, "last_activity_date": 1575444960, "creation_date": 1575433175, "last_edit_date": 1592644375, "question_id": 59168880, "link": "https://stackoverflow.com/questions/59168880/whats-golangs-equivalent-to-phps-unpack-f-str", "closed_reason": "Duplicate", "title": "What&#39;s golang&#39;s equivalent to PHP&#39;s unpack(\u201cf\u201d, $str)?", "body": "<p>I want to convert hexadecimal to float using golang,but i did not get the correct result.</p>\n<p>PHP have an unpack function which can get the correct result.</p>\n<h3>Golang code</h3>\n<pre><code>i := &quot;CDC1933E&quot;\nb, _ := hex.DecodeString(i)\nbuf := bytes.NewReader(b)\nvar f float32\nerr := binary.Read(buf, binary.BigEndian, &amp;f)\nfmt.Println(f)\n</code></pre>\n<h3>PHP code</h3>\n<pre><code>var_dump(unpack(&quot;f&quot;,hex2bin(&quot;CDC1933E&quot;)));\n</code></pre>\n<p>The correct result shoud be 0.28858796.</p>\n"}, {"tags": ["git", "go", "bitbucket"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1575444463, "post_id": 59168682, "comment_id": 104564258, "body": "a) <code>bitbucket.xxx.xx != bitbucket.org</code> b) Your bitbucket server uses a self-signed certificate. Get back to the old url and use <code>git config http.sslVerify false</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1575762818, "last_edit_date": 1592644375, "creation_date": 1575762818, "answer_id": 59231304, "question_id": 59168682, "link": "https://stackoverflow.com/questions/59168682/can-not-download-dependencies/59231304#59231304", "title": "Can not download dependencies", "body": "<p>Regarding using an HTTPS URL, note that HTTP transport had possible allocator/deallocator mismatch, which has been corrected, with Git 2.25 (Q1 2020).</p>\n<p>So if you were using Git 2.24, <code>http.extraheader</code> would not have worked anyway.</p>\n<p>See <a href=\"https://github.com/git/git/commit/4d17fd253fbba05c643593bcb86515683badb03f\" rel=\"nofollow noreferrer\">commit 4d17fd2</a> (06 Nov 2019) by <a href=\"https://github.com/dscho\" rel=\"nofollow noreferrer\">Johannes Schindelin (<code>dscho</code>)</a>.<br />\n<sup>(Merged by <a href=\"https://github.com/gitster\" rel=\"nofollow noreferrer\">Junio C Hamano -- <code>gitster</code> --</a> in <a href=\"https://github.com/git/git/commit/bad5ed39cdd84953f935f4442dd92fe3f7afafc2\" rel=\"nofollow noreferrer\">commit bad5ed3</a>, 01 Dec 2019)</sup></p>\n<blockquote>\n<h2><a href=\"https://github.com/git/git/commit/4d17fd253fbba05c643593bcb86515683badb03f\" rel=\"nofollow noreferrer\"><code>remote-curl</code></a>: unbreak http.extraHeader with custom allocators</h2>\n<p><sup>Signed-off-by: Johannes Schindelin</sup></p>\n<p>In <a href=\"https://github.com/git/git/commit/93b980e58f5624ee4e3b2dc0d0babaa97ef66d19\" rel=\"nofollow noreferrer\">93b980e58f5</a> (&quot;<code>http</code>: use xmalloc with cURL&quot;, 2019-08-15, Git v2.24.0-rc0 -- <a href=\"https://github.com/git/git/commit/a2e524ecf396722020e85b39d7b5e83d7c95ec24\" rel=\"nofollow noreferrer\">merge</a> listed in <a href=\"https://github.com/git/git/commit/4c86140027f4a0d2caaa3ab4bd8bfc5ce3c11c8a\" rel=\"nofollow noreferrer\">batch #3</a>), we started to ask cURL to use <code>xmalloc()</code>, and if compiled with nedmalloc, that means implicitly a different allocator than the system one.</p>\n<p>Which means that all of cURL's allocations and releases now <code>_need</code>_ to use that allocator.</p>\n<p>However, the <code>http_options()</code> function used <code>slist_append()</code> to add any configured extra HTTP header(s) <code>_before</code>_ asking cURL to use <code>xmalloc()</code>, and <code>http_cleanup()</code> would release them <code>_afterwards_,</code> i.e. in the presence of custom allocators, cURL would attempt to use the wrong allocator to release the memory.</p>\n<p>A na\u00efve attempt at fixing this would move the call to <code>curl_global_init()</code> <code>_before</code>_ the config is parsed (i.e. before that call to <code>slist_append()</code>).</p>\n<p>However, that does not work, as we <code>_also</code>_ parse the config setting <code>http.sslbackend</code> and if found, call <code>curl_global_sslset()</code> which <em>must</em> be called before <code>curl_global_init()</code>, for details see: <a href=\"https://curl.haxx.se/libcurl/c/curl_global_sslset.html\" rel=\"nofollow noreferrer\">https://curl.haxx.se/libcurl/c/curl_global_sslset.html</a></p>\n<p>So let's instead make the config parsing entirely independent from cURL's data structures. Incidentally, this deletes two more lines than it introduces, which is nice.</p>\n</blockquote>\n<hr />\n<p>For self-signed certificate, disabling SSL verification globally might be considered a security risk and should be implemented only for testing.</p>\n<p><a href=\"https://stackoverflow.com/a/26785963/6309\">Referencing the self-signed certificate by <code>GIT_SSL_CAINFO</code></a> is more secure.</p>\n"}], "owner": {"reputation": 23, "user_id": 12477503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab1cd16d02eee32c32683cd5ee729733?s=128&d=identicon&r=PG&f=1", "display_name": "CreatingDED", "link": "https://stackoverflow.com/users/12477503/creatingded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 1, "accepted_answer_id": 59231304, "answer_count": 1, "score": 2, "last_activity_date": 1575762818, "creation_date": 1575431508, "question_id": 59168682, "link": "https://stackoverflow.com/questions/59168682/can-not-download-dependencies", "title": "Can not download dependencies", "body": "<p>I have a project with several dependencies from private repositories on bitbucket when I type command go build . I get this error </p>\n\n<blockquote>\n  <p>unrecognized import path \"bitbucket.xxx.xx/xx/x\" x509: certificate signed by unknown authority</p>\n</blockquote>\n\n<p>I have tried several things such as adding token</p>\n\n<blockquote>\n  <p>git config --global http.extraheader token</p>\n</blockquote>\n\n<p>Configure to ssh</p>\n\n<blockquote>\n  <p>git config --global url.\"git@bitbucket.org:\".insteadOf \"<a href=\"https://bitbucket.org/\" rel=\"nofollow noreferrer\">https://bitbucket.org/</a>\"</p>\n</blockquote>\n\n<p>but it does not work. </p>\n"}, {"tags": ["for-loop", "go"], "comments": [{"owner": {"reputation": 96, "user_id": 3357399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6bd51524c9d71cb33d599154b72694?s=128&d=identicon&r=PG&f=1", "display_name": "wale", "link": "https://stackoverflow.com/users/3357399/wale"}, "edited": false, "score": 0, "creation_date": 1575427965, "post_id": 59168209, "comment_id": 104559928, "body": "The problem is not about Go per se, you are using an iterator with <code>.Next</code> which in any other languages will move the cursor to the next item. If you really want to skip a certain number of elements you will need to keep track of the count of elements you have seen so far using a variable and use a check in the loop"}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1575428953, "post_id": 59168209, "comment_id": 104560117, "body": "Or, alternatively, invoke <code>e.Next()</code> three times in the loop, taking care not to use <code>.Next()</code> on a nil <code>e</code>, perhaps by defining an <code>Advance</code> function (or see Howard&#39;s update with <code>NextByCount</code>, which is what I was thinking of here)."}], "answers": [{"comments": [{"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 1, "creation_date": 1575429088, "post_id": 59168336, "comment_id": 104560144, "body": "I&#39;d allow <code>NextByCount</code> (or <code>Advance</code>) to take a nil argument and return nil: <code>for ; el != nil &amp;&amp; count &gt; 0; count--) { el = el.Next() } return el</code>"}, {"owner": {"reputation": 3184, "user_id": 703264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/d1Se3.jpg?s=128&g=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/703264/howard"}, "reply_to_user": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1575429600, "post_id": 59168336, "comment_id": 104560256, "body": "Yeah, it looks better. \ud83d\udc4d"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1575429825, "post_id": 59168336, "comment_id": 104560317, "body": "just a note: I would say the second way is better than the first one, as it is cleaner, more robust, and more performant."}], "tags": [], "owner": {"reputation": 3184, "user_id": 703264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/d1Se3.jpg?s=128&g=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/703264/howard"}, "is_accepted": true, "score": 4, "last_activity_date": 1575429579, "last_edit_date": 1575429579, "creation_date": 1575428503, "answer_id": 59168336, "question_id": 59168209, "link": "https://stackoverflow.com/questions/59168209/how-to-traverse-loop-in-go-and-print-out-every-third-element/59168336#59168336", "title": "How to traverse loop in Go and print out every third element", "body": "<p>List is a doubly linked list which doesn't allow to seek or jump by a specific count. My workaround is this:</p>\n\n<pre><code>i := 0\nfor e := alist.Front(); e != nil; e = e.Next() {\n    if i % 3 == 0 {\n        fmt.Println(e.Value)\n    }\n\n    i++\n}\n</code></pre>\n\n<p>Or a new function for code reuse (with @torek's comment, it becomes simpler):</p>\n\n<pre><code>func NextByCount(el *list.Element, count int) *list.Element {\n    for ; el != nil &amp;&amp; count &gt; 0; count-- {\n        el = el.Next()\n    }\n\n    return el\n}\n</code></pre>\n\n<p>Then loop it like:</p>\n\n<pre><code>for e := alist.Front(); e != nil; e = NextByCount(e, 3) {\n    fmt.Println(e.Value)\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 10251182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a856ba6936fdde77bb0308d93aa18d62?s=128&d=identicon&r=PG&f=1", "display_name": "IrCa", "link": "https://stackoverflow.com/users/10251182/irca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 59168336, "answer_count": 1, "score": 0, "last_activity_date": 1575429579, "creation_date": 1575427429, "question_id": 59168209, "link": "https://stackoverflow.com/questions/59168209/how-to-traverse-loop-in-go-and-print-out-every-third-element", "title": "How to traverse loop in Go and print out every third element", "body": "<p>I know to traverse through a list, i would do the following:</p>\n\n<pre><code>for e := alist.Front(); e != nil; e = e.Next() {\n       fmt.Println(e.Value) \n   }\n</code></pre>\n\n<p>However, I would like to print out every third element. In other langauges, i would increment the index like e += 3. How do I do that with Go?</p>\n"}, {"tags": ["linux", "go", "digital-ocean", "beego"], "comments": [{"owner": {"reputation": 21, "user_id": 10642939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2e8c9f776128e05872015550f20024?s=128&d=identicon&r=PG&f=1", "display_name": "Zizheng Yang", "link": "https://stackoverflow.com/users/10642939/zizheng-yang"}, "edited": false, "score": 0, "creation_date": 1575418238, "post_id": 59167191, "comment_id": 104557866, "body": "Sorry I can&#39;t provide log information by now, the code is on a computer no power right-now."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10642939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2e8c9f776128e05872015550f20024?s=128&d=identicon&r=PG&f=1", "display_name": "Zizheng Yang", "link": "https://stackoverflow.com/users/10642939/zizheng-yang"}, "edited": false, "score": 0, "creation_date": 1575426772, "post_id": 59167419, "comment_id": 104559693, "body": "I did tried these methods. They are not the keys. Besides, before applying any of these methods, my server has beening working for a little while."}, {"owner": {"reputation": 1161, "user_id": 5597085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y2wtF.jpg?s=128&g=1", "display_name": "Kyle Burkett", "link": "https://stackoverflow.com/users/5597085/kyle-burkett"}, "reply_to_user": {"reputation": 21, "user_id": 10642939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2e8c9f776128e05872015550f20024?s=128&d=identicon&r=PG&f=1", "display_name": "Zizheng Yang", "link": "https://stackoverflow.com/users/10642939/zizheng-yang"}, "edited": false, "score": 0, "creation_date": 1575562006, "post_id": 59167419, "comment_id": 104616000, "body": "@ZizhengYang do you have apache installed, running, and have a config file for web routing? Are you trying to access your app from the same box or from your servers public IP from a different computer. If you&#39;re trying to access the app from a different computer (production deployment) then you need to ensure apache is serving it correctly."}], "tags": [], "owner": {"reputation": 1161, "user_id": 5597085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y2wtF.jpg?s=128&g=1", "display_name": "Kyle Burkett", "link": "https://stackoverflow.com/users/5597085/kyle-burkett"}, "is_accepted": true, "score": 1, "last_activity_date": 1575562414, "last_edit_date": 1575562414, "creation_date": 1575419892, "answer_id": 59167419, "question_id": 59167191, "link": "https://stackoverflow.com/questions/59167191/timeout-errors-with-beego-on-digital-ocean-server/59167419#59167419", "title": "Timeout errors with Beego on Digital Ocean server", "body": "<p>You're missing some critical steps. </p>\n\n<p>Check out the deployment guide on beego:</p>\n\n<p><a href=\"https://beego.me/docs/deploy/\" rel=\"nofollow noreferrer\">https://beego.me/docs/deploy/</a></p>\n\n<p>First, you have to change the mode to production. Second, copy the files over to the server. Next run the application. Finally, serve the running application with Apache or Nginx.</p>\n\n<p>The two steps you're missing appear to be:</p>\n\n<ol>\n<li>change app mode to production</li>\n<li>serve the app with apache</li>\n</ol>\n\n<p>Check the link for more details. <strong>Important:</strong> If you're trying to access the app from a different computer (production deployment) then you need to ensure apache is serving it correctly.</p>\n"}], "owner": {"reputation": 21, "user_id": 10642939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2e8c9f776128e05872015550f20024?s=128&d=identicon&r=PG&f=1", "display_name": "Zizheng Yang", "link": "https://stackoverflow.com/users/10642939/zizheng-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 59167419, "answer_count": 1, "score": -3, "last_activity_date": 1575562414, "creation_date": 1575418163, "last_edit_date": 1575449356, "question_id": 59167191, "link": "https://stackoverflow.com/questions/59167191/timeout-errors-with-beego-on-digital-ocean-server", "title": "Timeout errors with Beego on Digital Ocean server", "body": "<p>I want to set up Beego on an Ubuntu server (without Nginx), but I cannot visit the site and having connection out time errors.</p>\n\n<p>Can anyone check my steps if there is any mistake?</p>\n\n<p>Here are my steps:</p>\n\n<ol>\n<li><p>I have used <code>bee pack</code> to pack my code.</p></li>\n<li><p>Then, use FileZilla to upload the package.</p></li>\n<li><p>After that, run <code>tar -xvf beego_project.tar.gz</code> to unpack.</p></li>\n<li><p>Run the project with <code>nohup ./beego_project</code></p></li>\n</ol>\n\n<p>The code is running correctly on localhost but why can't on remote server?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 8, "creation_date": 1575410760, "post_id": 59165631, "comment_id": 104555944, "body": "You don&#39;t store pointers in your slice, but copies of the dereferenced values, aka the values themselves, the numbers. Compare with <a href=\"https://play.golang.org/p/MqQ2UjF1Zn1\" rel=\"nofollow noreferrer\">play.golang.org/p/MqQ2UjF1Zn1</a>"}], "answers": [{"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": false, "score": 4, "last_activity_date": 1575415089, "creation_date": 1575415089, "answer_id": 59166818, "question_id": 59165631, "link": "https://stackoverflow.com/questions/59165631/why-pointer-dereference-is-different-object-in-slices/59166818#59166818", "title": "Why pointer dereference is different object in slices", "body": "<p>This has nothing to do with the use of slice types per se, and everything to do with the fact that you're storing <code>int</code> values.</p>\n\n<p>It is true that <code>p1</code>, <code>p2</code>, and <code>p3</code> have type <code>*int</code> (pointer to int).  They point to <code>a1</code>, <code>a2</code>, and <code>a3</code> respectively (and those three have type <code>int</code>, due to the <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">default type rules</a>, which dictate that the untyped constants <code>5</code>, <code>6</code>, and <code>7</code> become <code>int</code> here).  But this means that <code>*p1</code>, <code>*p2</code>, and <code>*p3</code> have type <code>int</code>.  So:</p>\n\n<blockquote>\n<pre><code>s = append(s, *p1, *p2, *p3)\n</code></pre>\n</blockquote>\n\n<p>does the same thing as:</p>\n\n<pre><code>s = append(s, 5, 6, 7)\n</code></pre>\n\n<p>would do (given that <code>*p1</code> is 5, and so on, which we can see by just looking at the code\u2014none of the <code>a</code> variables have changed yet).</p>\n\n<p>You then change variable <code>a1</code> to 8.  So <code>*p1</code> is also now 8, but you've built your slice out of the three values 5, 6, and 7, and those values are not changed here.  If you print <code>*p1</code>, you will see that it is now 8.  If you assign to <code>*p2</code>, then print <code>a2</code>, you will see that <code>a2</code> is updated by assigning to <code>*p2</code>.</p>\n\n<p>As <a href=\"https://stackoverflow.com/questions/59165631/why-pointer-dereference-is-different-object-in-slices#comment104555944_59165631\">zerkms noted in a comment</a>, if you had built your slice out of type <code>*int</code> and made <code>s[0]</code> point to <code>a1</code>, <em>then</em> changing <code>a1</code> would also change <code>*s[0]</code>.  Similarly, changing <code>*s[1]</code> would change <code>a2</code>.  You didn't do that, though, so they don't.  Again, though, it's not a matter of whether you use a slice here, but rather whether the variables in question are pointers, and if so, what they point-to<sup>1</sup> at the time you use their values.</p>\n\n<hr>\n\n<p><sup>1</sup>I hyphenated this to avoid the urge to write \"to what they point\". :-)</p>\n"}], "owner": {"reputation": 19, "user_id": 6913686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb2d56e73409fc6a12221691edc05ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay Moskovkin", "link": "https://stackoverflow.com/users/6913686/nikolay-moskovkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1575430899, "creation_date": 1575408540, "last_edit_date": 1575410231, "question_id": 59165631, "link": "https://stackoverflow.com/questions/59165631/why-pointer-dereference-is-different-object-in-slices", "title": "Why pointer dereference is different object in slices", "body": "<pre><code>func Test(t *testing.T) {\n    a1 := 5\n    a2 := 6\n    a3 := 7\n    p1 := &amp;a1\n    p2 := &amp;a2\n    p3 := &amp;a3\n    s := make([]int, 0)\n    s = append(s, *p1, *p2, *p3)\n    a1 = 8\n    if s[0] != 8 {\n        t.Fail()\n    }\n}\n</code></pre>\n\n<p>Why does the test fail?\nI don't have much experience in Go, but I thought that two variables can have the same value that is stored in one memory address. But what I see from the test bellow it's not correct. \nDoesn't it mean that if I want to change some variable from different places in my program I have to store it in variable and then use only pointers everywhere in the code?</p>\n"}, {"tags": ["debugging", "go", "trace", "ebpf", "bcc-bpf"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11945034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630a42507ff3054aa5466f96fd855223?s=128&d=identicon&r=PG&f=1", "display_name": "vcinq", "link": "https://stackoverflow.com/users/11945034/vcinq"}, "is_accepted": false, "score": -1, "last_activity_date": 1578654308, "creation_date": 1578654308, "answer_id": 59680432, "question_id": 59165266, "link": "https://stackoverflow.com/questions/59165266/how-to-trace-a-go-function-with-bpf-bcc/59680432#59680432", "title": "How to trace a go function with BPF (BCC)", "body": "<p>trace is a python script, you can open it in vim and then search for a function named _parse_probe. In this function, line 96:</p>\n\n<pre><code>(spec, sig, rest) = re.match(r'([^ \\t\\(]+)(\\([^\\(]*\\))?(.*)', text).groups()                                    \n</code></pre>\n\n<p>A golang function symbol with '(' character is splitted into 3 parts, whereas a normal function will match the first regular substring. You can modify the regular expression--delete the '(' part, and then trace will work. Good luck.</p>\n"}], "owner": {"reputation": 1252, "user_id": 1681090, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/80f2e937e7abe32cd42425addd5e158c?s=128&d=identicon&r=PG", "display_name": "x4k3p", "link": "https://stackoverflow.com/users/1681090/x4k3p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 478, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1578654308, "creation_date": 1575406823, "last_edit_date": 1575414148, "question_id": 59165266, "link": "https://stackoverflow.com/questions/59165266/how-to-trace-a-go-function-with-bpf-bcc", "title": "How to trace a go function with BPF (BCC)", "body": "<p>I have some go-code (myclient). It looks somehow like this (here only the mypackage is relevant):</p>\n\n<pre><code>package mypackage\n\nimport (\n...\n\nfunc (o *Client) CreateUser(ctx context.Context, user *User, ...) (User, error) {\n    ...\n    if err != nil ...\n      return nil, err\n    ...\n    return &amp;user, nil\n}\n</code></pre>\n\n<p>I run <code>go build -o build/myclient cmd/myclient/main.go</code> to get the binary.</p>\n\n<pre><code>\u03bb bob [~]  \u2192 objdump -t ~/go/src/github.com/Corp/myclient/build/myclient | grep CreateUser\n....\n000000000087d490 l     F .text  0000000000000e55              github.com/Corp/myclient.(*Client).CreateUser\n</code></pre>\n\n<p>Now this binary is used by some other go programm and gets loaded.</p>\n\n<p>Somehow like this:</p>\n\n<pre><code>bob      745322  0.1  0.1 195556  33172 pts/1    Sl+  20:18   0:07 some-prog\nbob      750774  0.0  0.0 1229316 14188 pts/1    Sl+  20:22   0:00 /home/bob/go/src/github.com/Corp/myclient/build/myclient\n</code></pre>\n\n<p>Now I try to use BCC Tools for tracing/debug. The reason for this is that some strange errors happens in production and it is important to view the args and return values of the function above. I was inspired by this: <a href=\"http://www.brendangregg.com/blog/2017-01-31/golang-bcc-bpf-function-tracing.html\" rel=\"nofollow noreferrer\">http://www.brendangregg.com/blog/2017-01-31/golang-bcc-bpf-function-tracing.html</a></p>\n\n<p>When using <code>funccount</code> I see this here (after invoking the function by some call to the some-prog)</p>\n\n<pre><code>\u03bb bob [~]  \u2192 sudo funccount '/home/bob/go/src/github.com/Corp/myclient/build/myclient:*.CreateUser'\nTracing 5 functions for \"b'/home/bob/go/src/github.com/Corp/myclient/build/myclient:*.CreateUser'\"... Hit Ctrl-C to end.\n^C\nFUNC                                                    COUNT\n...\nb'github.com/Corp/myclient.(*Client).CreateUser'        1\nDetaching...\n</code></pre>\n\n<p>But when I try to use <code>trace</code> (or <code>gotrace</code>) it looks like this:</p>\n\n<pre><code>\u03bb bob [~]  \u2192 trace '/home/bob/go/src/github.com/Corp/myclient/build/myclient:mypackage.*'  \ncould not determine address of symbol b'mypackage.*'\n\n\u03bb bob [~]  \u2192 trace '/home/bob/go/src/github.com/Corp/myclient/build/myclient:github.com/Corp/myclient.CreateUser'                          \ncould not determine address of symbol b'github.com/Corp/myclient.CreateUser'\n\n\u03bb bob [~]  \u2192 trace '/home/bob/go/src/github.com/Corp/myclient/build/myclient:github.com/Corp/myclient.(*Client).CreateUser'\nerror in probe '/home/bob/go/src/github.com/Corp/myclient/build/myclient:github.com/Corp/myclient.(*Client).CreateUser': expected format string in \"s\n\n\u03bb bob [~]  \u2192 trace '/home/bob/go/src/github.com/Corp/myclient/build/myclient:*.CreateUser'                                                               \ncould not determine address of symbol b'*.CreateUser'\n</code></pre>\n\n<p>Is there any possibility to trace such a go-function (especially inspecting struct args and return value) with BCC tooling or eBPF/(bpftrace?) (without adding any code)</p>\n"}, {"tags": ["go", "idioms"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1575406550, "post_id": 59165179, "comment_id": 104554333, "body": "Both are fine. Use whichever works for you. If pointers don&#39;t make sense in your case, you shouldn&#39;t switch using to pointers just for the rare case when there&#39;s no useful value to return. <code>Collision{}</code> is completely fine."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575407063, "post_id": 59165179, "comment_id": 104554539, "body": "I wouldn&#39;t call it &quot;more idiomatic&quot; to use <code>nil</code> to indicate &quot;no collision&quot;, nor to use a pointer type just for that purpose. However, &quot;what is more idiomatic&quot; is a purely subjective, opinion-based question, making it off-topic for SO."}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1575407231, "post_id": 59165179, "comment_id": 104554608, "body": "A third option is to make <code>Collision{}</code>, i.e., the zero-valued <code>Collision</code>, represent &quot;no collision&quot;. That seems likely to be easy to do\u2014the stuff inside an initialized <code>Collision</code> is likely to have at least some nonzero member, even if it&#39;s just an index number into an external array (just don&#39;t use the zero&#39;th member of the array for anything and you&#39;re good). Then you don&#39;t need the separate <code>bool</code> return."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575406971, "post_id": 59165257, "comment_id": 104554507, "body": "The first is semantically clearer so I would reverse that. Unless it <i>is important</i> to return a <i>pointer</i>, it would be better to return a value and a <code>bool</code>."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575407072, "post_id": 59165257, "comment_id": 104554542, "body": "@Adrian Yes I think your wording makes more sense - edited."}, {"owner": {"reputation": 23, "user_id": 12476300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489ea182ce6a5999efceeb0a6f75452b?s=128&d=identicon&r=PG&f=1", "display_name": "josef", "link": "https://stackoverflow.com/users/12476300/josef"}, "edited": false, "score": 1, "creation_date": 1575407992, "post_id": 59165257, "comment_id": 104554907, "body": "Thank you for the quick input. I do very little programming, this is just a fun little math project, so I&#39;m never sure of the proper style and what is/isn&#39;t really okay, so this is very helpful."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1575410894, "post_id": 59165257, "comment_id": 104555981, "body": "If performance is an issue, as it usually is for graphical things like ray tracing, then switching to pointers may provide quite a bit of a performance boost when you think about how many times a struct is copied. Every time a struct is a parameter, a returned value, retrieved from an array or map, or you&#39;re ranging over a list, the entire struct is copied. If it&#39;s a pointer, only the address is copied and that&#39;s much smaller/faster."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "reply_to_user": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1575411302, "post_id": 59165257, "comment_id": 104556117, "body": "@CoreyOgburn Yes, it&#39;s definitely faster to pass around a pointer.  I think the potential problem with that though is the number of heap allocations.  I imagine, if this is for ray tracing, then the method will likely be called frequently.  That is a lot of heap allocations and a lot of GC workload to use pointers."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1575413959, "post_id": 59165257, "comment_id": 104556970, "body": "@LukeJoshuaPark <a href=\"http://www.agardner.me/golang/garbage/collection/gc/escape/analysis/2015/10/18/go-escape-analysis.html\" rel=\"nofollow noreferrer\">It&#39;s probably already a heap allocation.</a> From the article: &quot;The basic rule is that if a reference to a variable is returned from the function where it is declared, it \u201cescapes\u201d - it can be referenced after the function returns, so it must be heap-allocated.&quot;"}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "reply_to_user": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1575417830, "post_id": 59165257, "comment_id": 104557783, "body": "@CoreyOgburn Hmmm I don&#39;t think that is what that article is saying - try running <code>go run -gcflags &#39;-m -l&#39;</code> on <a href=\"https://play.golang.org/p/-08GLSZBQz_Q\" rel=\"nofollow noreferrer\">this code</a> versus on <a href=\"https://play.golang.org/p/-p1pl3JmF-6\" rel=\"nofollow noreferrer\">this code</a>.  The latter has no escapes.  The segment you quote is, I believe, discussing what we observe in the first code example only."}], "tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": true, "score": 3, "last_activity_date": 1575407114, "last_edit_date": 1575407114, "creation_date": 1575406791, "answer_id": 59165257, "question_id": 59165179, "link": "https://stackoverflow.com/questions/59165179/idiomatic-way-to-return-an-invalid-struct-in-go/59165257#59165257", "title": "Idiomatic Way to Return an Invalid Struct in Go", "body": "<p>In my humble opinion...</p>\n\n<ul>\n<li><p>Unless returning a pointer is important to your use case, continue to use the return type of <code>(Collision, bool)</code> and simply do <code>return Collision{}, false</code> when there is no collision.</p></li>\n<li><p>If returning the collision as a pointer <strong>is</strong> important to your use case, simply return a <code>*Collision</code>, where the <code>nil</code> return type signifies \"no collision\", as you have described.</p></li>\n</ul>\n\n<p>It is desirable, to my knowledge, for ray-tracing to be quite performant, so you may have a genuine reason to prefer the first option.</p>\n"}], "owner": {"reputation": 23, "user_id": 12476300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489ea182ce6a5999efceeb0a6f75452b?s=128&d=identicon&r=PG&f=1", "display_name": "josef", "link": "https://stackoverflow.com/users/12476300/josef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 59165257, "answer_count": 1, "score": 1, "last_activity_date": 1575407114, "creation_date": 1575406437, "question_id": 59165179, "link": "https://stackoverflow.com/questions/59165179/idiomatic-way-to-return-an-invalid-struct-in-go", "title": "Idiomatic Way to Return an Invalid Struct in Go", "body": "<p>I am writing a ray-surface collision function that needs to return small structs (<code>Collision</code> contains some information about the collision). Currently I am returning the struct by value because I do not need to adjust or share the contents of <code>collision</code>. However, sometimes the ray will not actually collide, so my function signature currently looks like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (scene *Scene) GetFirstCollision(ray *Ray) (Collision, bool)\n</code></pre>\n\n<p>Where the boolean is false when there is no collision. However, I do not know what value the <code>Collision</code> should take when there is no collision. If it were a pointer, I would just return <code>nil</code>, but it isn't, so should I return <code>Collision{}</code>? If the overall more idiomatic way is just to return a <code>*Collision</code> and return <code>nil</code> when it does not exist, I am open to that too, I just can't think of a case when I would ever need a pointer to the collision.</p>\n"}, {"tags": ["go", "swagger", "openapi", "go-swagger"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8450369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de363d3797efd56bda6d0b0cf5869107?s=128&d=identicon&r=PG&f=1", "display_name": "Bubuu", "link": "https://stackoverflow.com/users/8450369/bubuu"}, "edited": false, "score": 0, "creation_date": 1575406809, "post_id": 59165196, "comment_id": 104554420, "body": "And if now I want <code>default</code> only for <b>PUT</b> I have to create another model?"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 1, "user_id": 8450369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de363d3797efd56bda6d0b0cf5869107?s=128&d=identicon&r=PG&f=1", "display_name": "Bubuu", "link": "https://stackoverflow.com/users/8450369/bubuu"}, "edited": false, "score": 0, "creation_date": 1575406994, "post_id": 59165196, "comment_id": 104554514, "body": "If you want <i>that</i> level of precision in your model, then yes. Or, use the model for GET, and define the body inline for PUT/POST without a separate model struct."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 0, "last_activity_date": 1575406524, "creation_date": 1575406524, "answer_id": 59165196, "question_id": 59165057, "link": "https://stackoverflow.com/questions/59165057/one-model-for-post-and-get-with-different-required-field/59165196#59165196", "title": "One model for POST and GET with different &quot;required&quot; field", "body": "<p>If you're generating spec from code, then having a PetGET and PetPOST is not a stupid idea. Usually the program model doesn't match the API model, and you have to repeat definitions just to generate the spec right. So you have a couple of options here:</p>\n\n<p>You can simply mark the field <code>required: false</code>, and deal with it in the GET handler.</p>\n\n<p>If you're generating spec from code, you can create swagger-only models separate from your program models, and for cases like this, create two models with different annotations.</p>\n"}], "owner": {"reputation": 1, "user_id": 8450369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de363d3797efd56bda6d0b0cf5869107?s=128&d=identicon&r=PG&f=1", "display_name": "Bubuu", "link": "https://stackoverflow.com/users/8450369/bubuu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575406524, "creation_date": 1575405856, "last_edit_date": 1575406389, "question_id": 59165057, "link": "https://stackoverflow.com/questions/59165057/one-model-for-post-and-get-with-different-required-field", "title": "One model for POST and GET with different &quot;required&quot; field", "body": "<p>I use <code>go-swagger</code>. I have model like:</p>\n\n<pre><code>// Pet pet\n// swagger:model\ntype Pet struct {\n    // id\n    ID int64 `json:\"id,omitempty\"`\n    // name\n    // Required: true\n    Name *string `json:\"name\"`\n}\n</code></pre>\n\n<p>and for example in my <strong>POST</strong> field <code>Name</code> have to be <strong>required</strong> but for <strong>GET</strong> not. So how should I add it if I don't want create similar model without required? Because for now my only thought is to create <code>type PetGET struct</code> and <code>type PetPOST struct</code> which, I guess is stupid idea.</p>\n"}, {"tags": ["go", "slack", "google-cloud-build"], "comments": [{"owner": {"reputation": 649, "user_id": 9054282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34fa84b9c668d632da5c4c3937325bd?s=128&d=identicon&r=PG", "display_name": "Harif Velarde", "link": "https://stackoverflow.com/users/9054282/harif-velarde"}, "edited": false, "score": 0, "creation_date": 1575579544, "post_id": 59164567, "comment_id": 104624234, "body": "I suggest you take a look at the official documentation of Cloud Build, as per is mentioned [1]:   $REPO_NAME: build.Source.RepoSource.RepoName (only available for triggered builds)  As you mentioned the option could be use the trigger () function.  [1] <a href=\"https://cloud.google.com/cloud-build/docs/configuring-builds/substitute-variable-values\" rel=\"nofollow noreferrer\">cloud.google.com/cloud-build/docs/configuring-builds/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 336291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690cfd3744f6e242f1285d23682c9b33?s=128&d=identicon&r=PG&f=1", "display_name": "Lance Sandino", "link": "https://stackoverflow.com/users/336291/lance-sandino"}, "is_accepted": true, "score": 1, "last_activity_date": 1579195355, "creation_date": 1579195355, "answer_id": 59774870, "question_id": 59164567, "link": "https://stackoverflow.com/questions/59164567/pass-repository-name-to-slack-bot-during-cloud-build/59774870#59774870", "title": "Pass Repository Name to Slack bot during Cloud Build", "body": "<p>I use github app triggered builds and use <code>build.substitutions.REPO_NAME</code></p>\n"}], "owner": {"reputation": 3894, "user_id": 719539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dc730be355e4d6c2410c121987cf2e77?s=128&d=identicon&r=PG", "display_name": "jdhurst", "link": "https://stackoverflow.com/users/719539/jdhurst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 59774870, "answer_count": 1, "score": 1, "last_activity_date": 1579195355, "creation_date": 1575403636, "question_id": 59164567, "link": "https://stackoverflow.com/questions/59164567/pass-repository-name-to-slack-bot-during-cloud-build", "title": "Pass Repository Name to Slack bot during Cloud Build", "body": "<p>I am following <a href=\"https://github.com/GoogleCloudPlatform/cloud-builders-community/tree/master/slackbot\" rel=\"nofollow noreferrer\">the documentation</a> to get a Slack bot to report on Cloud Build progress for a Project in Google Cloud Platform, using the Slack image found in <a href=\"https://github.com/GoogleCloudPlatform/cloud-builders-community\" rel=\"nofollow noreferrer\">Google Cloud Builder Community</a>. I've been able to get the out-of-the-box messages to post successfully.</p>\n\n<p>Since I have multiple repositories that will get built, I want to post the name of the Repository that is being built:</p>\n\n<p>e.g. </p>\n\n<pre><code>Build bot: Repo Fizz-buzz built successfully...\nBuild bot: Repo Wizz-bang failed to build...\n</code></pre>\n\n<p>In the <code>Notify()</code> function, the <code>cloudbuild.Build</code> struct has a few properties that might do what I am wanting. The <code>Source.RepoSource.RepoName</code> looks ideal, but it's nil.</p>\n\n<p>Another option would be to have the <a href=\"https://github.com/GoogleCloudPlatform/cloud-builders-community/blob/271173e4539787c5c8a7a0c16a5e767598b932c8/slackbot/slackbot/trigger.go#L18\" rel=\"nofollow noreferrer\">trigger()</a> function add the repository name as an argument:</p>\n\n<pre><code>Args: []string{\n                    fmt.Sprintf(\"--build=%s\", build),\n                    fmt.Sprintf(\"--webhook=%s\", webhook),\n                    fmt.Sprintf(\"--repoName=%s\", repoName),\n                    \"--mode=monitor\",\n                },\n</code></pre>\n\n<p>I'd prefer to have the Notify() function handle this, but I haven't found the appropriate struct property.</p>\n\n<p>Is there a property that I can use during the <a href=\"https://github.com/GoogleCloudPlatform/cloud-builders-community/blob/07ff8507dd8bfac6ebd7ea291ba3d9f7515123d8/slackbot/slackbot/notify.go#L14\" rel=\"nofollow noreferrer\">notify()</a> function to pass along the repository name?</p>\n"}, {"tags": ["go", "serialization", "protocol-buffers", "gob"], "comments": [{"owner": {"reputation": 131214, "user_id": 1249581, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/yANBN.jpg?s=128&g=1", "display_name": "VisioN", "link": "https://stackoverflow.com/users/1249581/vision"}, "edited": false, "score": 0, "creation_date": 1575401283, "post_id": 59163455, "comment_id": 104552167, "body": "Gob is a no-brainer, why not to stick to it?"}, {"owner": {"reputation": 1041, "user_id": 365557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/be74c8f8958cafb02ea319768e98daa4?s=128&d=identicon&r=PG", "display_name": "abonec", "link": "https://stackoverflow.com/users/365557/abonec"}, "reply_to_user": {"reputation": 131214, "user_id": 1249581, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/yANBN.jpg?s=128&g=1", "display_name": "VisioN", "link": "https://stackoverflow.com/users/1249581/vision"}, "edited": false, "score": 0, "creation_date": 1575402472, "post_id": 59163455, "comment_id": 104552686, "body": "Gob has low performance compare to gogoproto and too many allocations."}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1575407054, "post_id": 59164609, "comment_id": 104554535, "body": "Writing data to an open file is done by <code>File.Write()</code>. <code>ioutil.WriteFile()</code> takes the file name not an open file, and it opens it and truncates it (it doesn&#39;t append to it)."}, {"owner": {"reputation": 1041, "user_id": 365557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/be74c8f8958cafb02ea319768e98daa4?s=128&d=identicon&r=PG", "display_name": "abonec", "link": "https://stackoverflow.com/users/365557/abonec"}, "edited": false, "score": 0, "creation_date": 1575433127, "post_id": 59164609, "comment_id": 104560979, "body": "As I understard this technique just append bytes to file and it can&#39;t be readed back as separate messages."}, {"owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "edited": false, "score": 1, "creation_date": 1575445605, "post_id": 59164609, "comment_id": 104564727, "body": "Write the length before each piece of encoded data  (i.e. 4 bytes for the length followed by the protobuf encoded message). This is the approach recommended in <a href=\"https://developers.google.com/protocol-buffers/docs/techniques\" rel=\"nofollow noreferrer\">developers.google.com/protocol-buffers/docs/techniques</a>"}, {"owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "edited": false, "score": 0, "creation_date": 1575451859, "post_id": 59164609, "comment_id": 104567679, "body": "Ah, Sorry, I mis-read the question. I&#39;ll update my answer. :)"}], "tags": [], "owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "is_accepted": false, "score": 2, "last_activity_date": 1575454699, "last_edit_date": 1575454699, "creation_date": 1575403803, "answer_id": 59164609, "question_id": 59163455, "link": "https://stackoverflow.com/questions/59163455/sequentially-write-protobuf-messages-to-a-file-in-go/59164609#59164609", "title": "Sequentially write protobuf messages to a file in go", "body": "<blockquote>\n  <p>If you want to write multiple messages to a single file or stream, it\n  is up to you to keep track of where one message ends and the next\n  begins. The Protocol Buffer wire format is not self-delimiting, so\n  protocol buffer parsers cannot determine where a message ends on their\n  own. The easiest way to solve this problem is to write the size of\n  each message before you write the message itself. When you read the\n  messages back in, you read the size, then read the bytes into a\n  separate buffer, then parse from that buffer.</p>\n</blockquote>\n\n<p><a href=\"https://developers.google.com/protocol-buffers/docs/techniques\" rel=\"nofollow noreferrer\">Source</a></p>\n\n<p><strong>1. Write the Protobuf</strong></p>\n\n<p>Marshal your protobuf into a <code>[]byte</code> and call <code>Write</code> along with the file you're wanting to write to as the <code>io.Writer</code>. This writes the length of <code>msg</code> to the <code>io.Writer</code> before writing <code>msg</code> itself.</p>\n\n<pre><code>func Write(w io.Writer, msg []byte) error {\n    buf := make([]byte, 4)\n    binary.LittleEndian.PutInt32(buf, Uint32(len(msg)))\n\n    if _, err := w.Write(buf); err != nil {\n        return err\n    }\n\n    if _, err := w.Write(msg); err != nil {\n        return err\n    }\n}\n</code></pre>\n\n<p><strong>2. Read the Protobuf</strong></p>\n\n<p>When you want to read out the protobufs on the other side, open the file and pass it in as the <code>io.Reader</code>. This extracts the size from the file, then reads that amount of bytes into the <code>msg</code> buffer and returns it.</p>\n\n<pre><code>func Read(r io.Reader) ([]byte, error) {\n    buf := make([]byte, 4)\n    if _, err := io.ReadFull(r, buf); err != nil {\n        return nil, err\n    }\n\n    size := binary.LittleEndian.Uint32(buf)\n\n    msg := make([]byte, size)\n    if _, err := io.ReadFull(r, msg); err != nil {\n        return nil, err\n    }\n\n    return msg, err\n}\n</code></pre>\n\n<hr>\n\n<p>The <code>*os.File</code> type in Go satisfies both the <code>io.Reader</code> and <code>io.Writer</code> interfaces, so you shouldn't run into any issues.</p>\n\n<p>Credits to @Brits for pointing this out.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 1041, "user_id": 365557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/be74c8f8958cafb02ea319768e98daa4?s=128&d=identicon&r=PG", "display_name": "abonec", "link": "https://stackoverflow.com/users/365557/abonec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1214, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1575454699, "creation_date": 1575398625, "question_id": 59163455, "link": "https://stackoverflow.com/questions/59163455/sequentially-write-protobuf-messages-to-a-file-in-go", "title": "Sequentially write protobuf messages to a file in go", "body": "<p>I have a huge number of similar object (about hundreds of gigabytes) and I need to serialize it and write to a file sequentially and after that read it in the same order. How to do it in protobuf (gogo proto) in golang? Gob has a encoder which can write to io.Writer but protobuf don't have something similar. May be protobuf is not best choice for this purposes? I need good performance and low memory allocations.</p>\n"}, {"tags": ["json", "go", "hierarchy"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1575406015, "post_id": 59162961, "comment_id": 104554136, "body": "By iterating over them and organizing them however you need them. Have you made any attempt at this at all? Can you show what you&#39;ve tried?"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575433482, "post_id": 59162961, "comment_id": 104561044, "body": "@Adrian everything I&#39;ve tried has been unsuccessful, so I&#39;m trying to understand the sequence of actions. Do you have any ideas?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575471957, "post_id": 59162961, "comment_id": 104579155, "body": "If you&#39;ve tried something that didn&#39;t work, you should show that code and describe what specific problem(s) you ran into."}], "answers": [{"comments": [{"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575432997, "post_id": 59165177, "comment_id": 104560952, "body": "Thank you for your answer. Could you please describe in more detail the part where we need to fill the struct one by one? It is not quite clear to me."}, {"owner": {"reputation": 66, "user_id": 10516911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/636f2a0caf6c8bd044d90daa532f4da7?s=128&d=identicon&r=PG&f=1", "display_name": "Harloveleen Kaur", "link": "https://stackoverflow.com/users/10516911/harloveleen-kaur"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575473481, "post_id": 59165177, "comment_id": 104579967, "body": "Can you see the edited post. Also we would still need the struct that you are using just to read the table first , this way would be faster than directly reading into the DataEntry Struct"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575479732, "post_id": 59165177, "comment_id": 104583722, "body": "Thank you for your reply. I tried to test your code right now. Instead of <code>while</code> loop I used <code>for</code> loop. Unfortunately, it raises an error: <code>http: panic serving [::1]:12997: runtime error: index out of range</code>. This condition causes an error: <code>ageRange == entries[i].AgeRange &amp;&amp; gender == entries[i].Gender</code>. Check my post again please for more details. Also as you have noticed I need array of <code>DataEntry</code> struct as a final result cause there can be different ID. For that&#39;s why I need one more loop, right?"}, {"owner": {"reputation": 66, "user_id": 10516911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/636f2a0caf6c8bd044d90daa532f4da7?s=128&d=identicon&r=PG&f=1", "display_name": "Harloveleen Kaur", "link": "https://stackoverflow.com/users/10516911/harloveleen-kaur"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575491584, "post_id": 59165177, "comment_id": 104588951, "body": "Okay so as i is getting incremented we need to check for the length at every condition and i did fix the data entry struct condition too . Please have a look at the edited function"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575532050, "post_id": 59165177, "comment_id": 104600089, "body": "Thank you for your reply. I tried to test your last edited code right now but unfortunately the problem in the same part as in the last comment. Also what exactly makes this part of code <code>e := DataEntry{entries[i-1].ID, entryDetails}</code>?"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575533113, "post_id": 59165177, "comment_id": 104600485, "body": "Also why you use <code>while</code> although golang don&#39;t have such statement?"}, {"owner": {"reputation": 66, "user_id": 10516911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/636f2a0caf6c8bd044d90daa532f4da7?s=128&d=identicon&r=PG&f=1", "display_name": "Harloveleen Kaur", "link": "https://stackoverflow.com/users/10516911/harloveleen-kaur"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575595317, "post_id": 59165177, "comment_id": 104628971, "body": "you are correct i was just working on the logic ! let me have a look again ."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575605930, "post_id": 59165177, "comment_id": 104631127, "body": "Please let me know if you have any ideas."}, {"owner": {"reputation": 66, "user_id": 10516911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/636f2a0caf6c8bd044d90daa532f4da7?s=128&d=identicon&r=PG&f=1", "display_name": "Harloveleen Kaur", "link": "https://stackoverflow.com/users/10516911/harloveleen-kaur"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1575651939, "post_id": 59165177, "comment_id": 104650691, "body": "I have added the link to the golang playground, which is totally working, so enjoy !"}], "tags": [], "owner": {"reputation": 66, "user_id": 10516911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/636f2a0caf6c8bd044d90daa532f4da7?s=128&d=identicon&r=PG&f=1", "display_name": "Harloveleen Kaur", "link": "https://stackoverflow.com/users/10516911/harloveleen-kaur"}, "is_accepted": true, "score": 1, "last_activity_date": 1575651908, "last_edit_date": 1575651908, "creation_date": 1575406430, "answer_id": 59165177, "question_id": 59162961, "link": "https://stackoverflow.com/questions/59162961/how-to-group-data-correctly-to-get-a-tree-structure/59165177#59165177", "title": "How to group data correctly to get a tree structure?", "body": "<p>Usually, I would be updating the Structure according to the response i want. For example in your case it would be : </p>\n\n<pre><code>type DataEntry struct {\n    ID int `json:\"id\"`\n    Details []EntryDetails `json:\"details\"`\n}\n\ntype EntryDetails struct { \n    AggYear int `json:\"agg_year\"`\n    AggMonth int `json:\"agg_month\"`\n    Details []GenderDetails `json:\"details\"`\n}\n\ntype GenderDetails struct {\n    Gender string `json:\"gender\"`\n    Details []AgeDetails `json:\"details\"`\n} \n\ntype AgeDetails struct {\n    AgeRange string `json:\"age_range\"`\n    Details []IncomeDetails `json:\"details\"`\n}\n\ntype IncomeDetails struct { \n    IncomeRange string `json:\"income_range\"`\n    Total int `json:\"total\"`\n}\n</code></pre>\n\n<p>Dividing your code into smaller parts is always easier to read and maintain. </p>\n\n<p>Next part to add the details to the struct : you should Query your code according to the requirements to fill the struct one by one. For example: getID-'Entry struct' first, then getAggYear &amp; getAggMonth for the ID-'EntryDetails struct' and so one.</p>\n\n<p>You can find the full working program here : <a href=\"https://play.golang.org/p/_pdb5y9Wd-O\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_pdb5y9Wd-O</a></p>\n\n<p>Enjoy ! </p>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 59165177, "answer_count": 1, "score": 0, "last_activity_date": 1575651908, "creation_date": 1575396313, "last_edit_date": 1575481018, "question_id": 59162961, "link": "https://stackoverflow.com/questions/59162961/how-to-group-data-correctly-to-get-a-tree-structure", "title": "How to group data correctly to get a tree structure?", "body": "<p>In golang application I make query to such table:</p>\n\n<pre><code>| ID        | AGG_YEAR | AGG_MONTH | GENDER | AGE_RANGE | INCOME_RANGE | TOTAL |\n|-----------|----------|-----------|--------|-----------|--------------|-------|\n| 107502389 | 2019     | 7         | F      | 18_29     | 1000_2000    | 15    |\n| 107502389 | 2019     | 7         | F      | 18_29     | 2000_4000    | 42    |\n| 107502389 | 2019     | 7         | F      | 30_44     | 1000_2000    | 25    |\n| 107502389 | 2019     | 7         | F      | 30_44     | 2000_4000    | 63    |\n| 107502389 | 2019     | 7         | M      | 18_29     | 1000_2000    | 30    |\n| 107502389 | 2019     | 7         | M      | 18_29     | 2000_4000    | 18    |\n| 107502389 | 2019     | 7         | M      | 30_44     | 1000_2000    | 36    |\n| 107502389 | 2019     | 7         | M      | 30_44     | 2000_4000    | 19    |\n</code></pre>\n\n<p>This table stores information about the total number of males and females with a certain wage level in a certain month. Usually, after a query to the database, each record is parsed separately one by one:</p>\n\n<pre><code>type Entry struct {\n    ID int `json:\"id\"`\n    AggYear int `json:\"agg_year\"`\n    AggMonth int `json:\"agg_month\"`\n    Gender string `json:\"gender\"`\n    AgeRange string `json:\"age_range\"`\n    IncomeRange string `json:\"income_range\"`\n    Total int `json:\"total\"`\n}\n\nvar entries []Entry\n\nrows, err := database.Query(\"***\"); if err != nil {\n    fmt.Println(err)\n    return\n}\n\ndefer rows.Close()\n\nfor rows.Next() {\n    var entry Entry\n\n    if err = rows.Scan(&amp;entry.ID, &amp;entry.AggMethod, &amp;entry.AggYear, &amp;entry.AggMonth, &amp;entry.Gender, &amp;entry.AgeRange, &amp;entry.IncomeRange, &amp;entry.Total); err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    entries = append(entries, entry)\n}\n\ntype IncomeDetails struct {\n    IncomeRange string `json:\"income_range\"`\n    Total int `json:\"total\"`\n}\n\ntype AgeDetails struct {\n    AgeRange string `json:\"age_range\"`\n    Details []IncomeDetails `json:\"details\"`\n}\n\ntype GenderDetails struct {\n    Gender string `json:\"gender\"`\n    Details []AgeDetails `json:\"details\"`\n}\n\ntype EntryDetails struct {\n    AggYear int `json:\"agg_year\"`\n    AggMonth int `json:\"agg_month\"`\n    Details []GenderDetails `json:\"details\"`\n}\n\ntype DataEntry struct {\n    ID int `json:\"id\"`\n    Details []EntryDetails `json:\"details\"`\n}\n\nvar entryDetails []EntryDetails\n\ni:= 0\nfor i &lt; len(entries) {\n    var genderDetails []GenderDetails\n    aggYear := entries[i].AggYear\n    aggMonth := entries[i].AggMonth\n\n    for aggYear == entries[i].AggYear &amp;&amp; aggMonth == entries[i].AggMonth {\n        gender := entries[i].Gender\n        var ageDetails []AgeDetails\n        for gender == entries[i].Gender {\n            ageRange := entries[i].AgeRange\n            var incomeDetails []IncomeDetails\n\n            for ageRange == entries[i].AgeRange &amp;&amp; gender == entries[i].Gender { // &lt;- runtime error: index out of range\n                incomeDetail := IncomeDetails{entries[i].IncomeRange, entries[i].Total}\n                incomeDetails = append(incomeDetails, incomeDetail)\n                i++\n            }\n            ageDetail := AgeDetails{entries[i-1].AgeRange, incomeDetails}\n            ageDetails = append(ageDetails, ageDetail)\n            i++\n        }\n        genderDetail := GenderDetails{entries[i-1].Gender, ageDetails}\n        genderDetails = append(genderDetails, genderDetail)\n        i++\n    }\n    entryDetail := EntryDetails{entries[i-1].AggYear, entries[i-1].AggMonth, genderDetails}\n    entryDetails = append(entryDetails, entryDetail)\n    i++\n}\n</code></pre>\n\n<p>I want to know the best way to group the following values as in the example below? I want to understand the sequence of actions. I will be grateful for any help.</p>\n\n<pre><code>[\n    {\n        \"id\": 107502389,\n        \"details\": [\n            {\n                \"agg_year\": 2019,\n                \"agg_month\": 7,\n                \"details\": [\n                    {\n                        \"gender\": \"F\",\n                        \"details\": [\n                            {\n                                \"age_range\": \"18_29\",\n                                \"details\": [\n                                    {\n                                        \"income_range\": \"1000_2000\",\n                                        \"total\": \"15\"\n                                    },\n                                    {\n                                        \"income_range\": \"2000_4000\",\n                                        \"total\": \"42\"\n                                    },\n                                ]\n                            },\n                            {\n                                \"age_range\": \"30_44\",\n                                \"details\": [\n                                    {\n                                        \"income_range\": \"1000_2000\",\n                                        \"total\": \"25\"\n                                    },\n                                    {\n                                        \"income_range\": \"2000_4000\",\n                                        \"total\": \"63\"\n                                    },\n                                ]\n                            }\n                        ]\n                    },\n                    {\n                        \"gender\": \"M\",\n                        \"details\": [\n                            {\n                                \"age_range\": \"18_29\",\n                                \"details\": [\n                                    {\n                                        \"income_range\": \"1000_2000\",\n                                        \"total\": \"30\"\n                                    },\n                                    {\n                                        \"income_range\": \"2000_4000\",\n                                        \"total\": \"18\"\n                                    },\n                                ]\n                            },\n                            {\n                                \"age_range\": \"30_44\",\n                                \"details\": [\n                                    {\n                                        \"income_range\": \"1000_2000\",\n                                        \"total\": \"36\"\n                                    },\n                                    {\n                                        \"income_range\": \"2000_4000\",\n                                        \"total\": \"19\"\n                                    },\n                                ]\n                            }\n                        ]\n                    }\n                ]\n            }\n        ]\n    }\n]\n</code></pre>\n"}, {"tags": ["date", "go", "timezone", "php-carbon"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575449487, "post_id": 59162301, "comment_id": 104566434, "body": "What have you tried? Include your code. Are you actually having a problem? This should be the default behavior, if you specify a timezone in your schedule. What actual problem are you facing?"}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575477934, "post_id": 59162301, "comment_id": 104582674, "body": "I was looking for a built-in function to make that time transformation without make this manually, as it seems to be a common problem in many projects"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575478196, "post_id": 59162301, "comment_id": 104582832, "body": "I don&#39;t know what exactly you want a built-in function to do. I don&#39;t think you need a function, at all. You just need to parse the time in the proper time zone."}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575577908, "post_id": 59162301, "comment_id": 104623526, "body": "@Flimzybecause is easier, and is always the same, would be something like: hey give the local hour when in LA are 8pm"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575579991, "post_id": 59162301, "comment_id": 104624427, "body": "Because what is easier?"}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575449553, "post_id": 59162350, "comment_id": 104566482, "body": "This displays <code>timeInUTC</code> in LA. But the OP needs essentially the opposite: A time specified in LA time needs to trigger an event in UTC (or server time)."}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575469797, "post_id": 59162350, "comment_id": 104577847, "body": "Edited the answer to include both."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1575474607, "last_edit_date": 1575474607, "creation_date": 1575393767, "answer_id": 59162350, "question_id": 59162301, "link": "https://stackoverflow.com/questions/59162301/server-hour-considering-another-tz-as-reference/59162350#59162350", "title": "Server Hour considering another TZ as reference", "body": "<p><code>time.LoadLocation</code> and <code>time.In</code> are the two functions you need. The below code is copied and modified from <code>time.LoadLocation</code> example:</p>\n\n<pre><code>func main() {\n    location, err := time.LoadLocation(\"America/Los_Angeles\")\n    if err != nil {\n        panic(err)\n    }\n\n    timeInUTC := time.Date(2018, 8, 30, 12, 0, 0, 0, time.UTC)\n    fmt.Println(timeInUTC.In(location))\n\n    now := time.Now()\n    timeThere := time.Date(now.Year(), now.Month(), now.Day(), 8, 0, 0, 0, location)\n    timeHere := timeThere.In(time.Now().Location())\n    fmt.Println(timeHere)\n}\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 59162350, "answer_count": 1, "score": -2, "last_activity_date": 1575474607, "creation_date": 1575393539, "last_edit_date": 1575449455, "question_id": 59162301, "link": "https://stackoverflow.com/questions/59162301/server-hour-considering-another-tz-as-reference", "title": "Server Hour considering another TZ as reference", "body": "<p>I am trying to trigger a worker at certain hour. The thing is that I need to know what is the relative hour of the server for that hour. Clients want to trigger the worker at 8pm everyday in Los Angeles Time, so I have to make it the enough dynamic that it takes the server hour, calculate what is the equivalent for that hour in Los Angeles. I am also using carbon, but is there any built-in function for that? Or is there any know routine to deal with it?</p>\n"}, {"tags": ["go", "syntax-highlighting", "goland"], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 4, "last_activity_date": 1575389911, "creation_date": 1575389911, "answer_id": 59161258, "question_id": 59161000, "link": "https://stackoverflow.com/questions/59161000/syntax-highlighting-in-fmt-and-goland/59161258#59161258", "title": "Syntax highlighting in fmt and GoLand", "body": "<p>This is not currently, as of 2019.3 release, supported by the IDE.</p>\n\n<p>Vote/watch <a href=\"https://youtrack.jetbrains.com/issue/GO-5841\" rel=\"nofollow noreferrer\">this issue</a> to receive updates when it will be implemented.</p>\n"}], "owner": {"reputation": 21, "user_id": 12474995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9864d0a153ae55391c54a547472743cc?s=128&d=identicon&r=PG&f=1", "display_name": "GoHumble", "link": "https://stackoverflow.com/users/12474995/gohumble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 59161258, "answer_count": 1, "score": 0, "last_activity_date": 1575389911, "creation_date": 1575389004, "last_edit_date": 1575389328, "question_id": 59161000, "link": "https://stackoverflow.com/questions/59161000/syntax-highlighting-in-fmt-and-goland", "title": "Syntax highlighting in fmt and GoLand", "body": "<p>How does the GoLand IDE (JetBrains) highlight the formatting verbs in the <code>fmt</code> package from the Go standard library? </p>\n\n<p>An image to clarify my question:</p>\n\n<p><img src=\"https://i.stack.imgur.com/4ZDol.png\" alt=\"Highlight example\"></p>\n\n<p>If I write a function that takes a format string and multiple arguments, the format string is not highlighted:</p>\n\n<p><img src=\"https://i.stack.imgur.com/uLzMH.png\" alt=\"No Highlight example\"> </p>\n\n<p>Where does this highlighting come from? I was not able to figure that out. </p>\n"}, {"tags": ["go", "arm", "cross-compiling"], "comments": [{"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1575386228, "post_id": 59160109, "comment_id": 104544759, "body": "Check if you have go.mod file in proper directory"}, {"owner": {"reputation": 63, "user_id": 10986180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Lff_VSb4xUk/AAAAAAAAAAI/AAAAAAAAAOE/4czV1FHjOLE/photo.jpg?sz=128", "display_name": "jayen marco", "link": "https://stackoverflow.com/users/10986180/jayen-marco"}, "reply_to_user": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1575386848, "post_id": 59160109, "comment_id": 104545110, "body": "@cslrnr i check it, there are a go.mod in /lorawan,  the compiler go find this repository so ..."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 10986180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Lff_VSb4xUk/AAAAAAAAAAI/AAAAAAAAAOE/4czV1FHjOLE/photo.jpg?sz=128", "display_name": "jayen marco", "link": "https://stackoverflow.com/users/10986180/jayen-marco"}, "is_accepted": false, "score": 0, "last_activity_date": 1575448877, "creation_date": 1575448877, "answer_id": 59171965, "question_id": 59160109, "link": "https://stackoverflow.com/questions/59160109/cant-cross-compile-go-project-with-xgo-using-cgo-amd-arm/59171965#59171965", "title": "Can&#39;t Cross-Compile Go project with Xgo using CGO AMD=&gt; ARM", "body": "<p>I finally find the solution ! </p>\n\n<p>firste i install on ubuntu arm-linux-gnueabi-gcc, then i juste i add to my cross-compile-compile command CC like : </p>\n\n<pre><code>env GOOS=linux GOARCH=arm GOARM=7 CGO_ENABLED=1 CC=arm-linux-gnueabi-gcc  go build \n</code></pre>\n\n<p>It's work fine ! </p>\n"}], "owner": {"reputation": 63, "user_id": 10986180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Lff_VSb4xUk/AAAAAAAAAAI/AAAAAAAAAOE/4czV1FHjOLE/photo.jpg?sz=128", "display_name": "jayen marco", "link": "https://stackoverflow.com/users/10986180/jayen-marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 609, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575448877, "creation_date": 1575385961, "question_id": 59160109, "link": "https://stackoverflow.com/questions/59160109/cant-cross-compile-go-project-with-xgo-using-cgo-amd-arm", "title": "Can&#39;t Cross-Compile Go project with Xgo using CGO AMD=&gt; ARM", "body": "<p>I'm working on go project that implmenting C code ! </p>\n\n<p>I can build the project on linux/amd64, and we now that go don't cross compile if we use \"IMPORT C\".\nSo i work with XGO that maybe help me to cross compiling for ARM.</p>\n\n<p>i check XGO by cross compiling version of my go project without C code and it's work like cross compil of go.</p>\n\n<p><strong>my environement :</strong>  </p>\n\n<pre><code>go version go1.13.3 linux/amd64\n</code></pre>\n\n<p><strong>Go env :</strong></p>\n\n<pre><code>GO111MODULE=\"on\"\nGOARCH=\"amd64\"\nGOBIN=\"/opt/go/bin\"\nGOCACHE=\"/home/jj/.cache/go-build\"\nGOENV=\"/home/jj/.config/go/env\"\nGOEXE=\"\"\nGOFLAGS=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGONOPROXY=\"\"\nGONOSUMDB=\"\"\nGOOS=\"linux\"\nGOPATH=\"/opt/go\"\nGOPRIVATE=\"\"\nGOPROXY=\"https://proxy.golang.org,direct\"\nGOROOT=\"/usr/local/go\"\nGOSUMDB=\"sum.golang.org\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nAR=\"ar\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nGOMOD=\"/opt/go/src/github.com/brocaar/lora-app-server/go.mod\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\n</code></pre>\n\n<p><strong>My project is on</strong> =></p>\n\n<pre><code>/opt/go/src/github.com/brocaar\n</code></pre>\n\n<p>My package that include c code is on =></p>\n\n<pre><code>/opt/go/src/github.com/lorawan\n</code></pre>\n\n<p><strong>the go.mode of my project</strong> : </p>\n\n<pre><code>  module github.com/brocaar/lora-app-server\n\n  go 1.12\n\n  replace github.com/brocaar/lorawan =&gt; /opt/go/src/github.com/brocaar/lorawan\n\n  require (\n           cloud.google.com/go v0.44.3\n           github.com/Azure/azure-service-bus-go v0.9.1\n           github.com/NickBall/go-aes-key-wrap v0.0.0-20170929221519-1c3aa3e4dfc5\n           github.com/aws/aws-sdk-go v1.19.19\n           github.com/brocaar/loraserver v0.0.0-20190917115647-c4da45f52f2b\n           github.com/brocaar/lorawan v0.0.0-20190814113539-8eb2a8d6da09\n           github.com/dgrijalva/jwt-go v3.2.0+incompatible\n           github.com/eclipse/paho.mqtt.golang v1.2.0\n           github.com/elazarl/go-bindata-assetfs v1.0.0\n           github.com/gofrs/uuid v3.2.0+incompatible\n           github.com/golang/protobuf v1.3.2\n           github.com/gomodule/redigo v2.0.0+incompatible\n           github.com/goreleaser/goreleaser v0.106.0\n\n         )\n</code></pre>\n\n<p><strong>My command to cross-compil is</strong>: </p>\n\n<pre><code>xgo -go 1.13.3  --targets=linux/arm-7 /opt/go/src/github.com/brocaar/lora-app-server/cmd/lora-app-server\n</code></pre>\n\n<p><strong>The result error are</strong> : </p>\n\n<pre><code>src/github.com/brocaar/lora-app-server/cmd/lora-app-server\n</code></pre>\n\n<p>Checking docker installation...\n    Client:\n      Version:           18.09.7\n      API version:       1.39\n      Go version:        go1.10.4\n      Git commit:        2d0083d\n      Built:             Fri Aug 16 14:19:38 2019\n      OS/Arch:           linux/amd64\n      Experimental:      false</p>\n\n<pre><code>Server:\n  Engine:\n  Version:          18.09.7\n  API version:      1.39 (minimum version 1.12)\n  Go version:       go1.10.4\n  Git commit:       2d0083d\n  Built:            Thu Aug 15 15:12:41 2019\n  OS/Arch:          linux/amd64\n  Experimental:     false\n\n  Checking for required docker image karalabe/xgo-1.13.3... found.\n  Cross compiling github.com/brocaar/lora-app-server/cmd/lora-app-server...\nBuilding locally github.com/brocaar/lora-app-server/cmd/lora-app-server...\nBootstrapping linux/arm-7...\ngo: github.com/brocaar/lorawan@v0.0.0-20190814113539-8eb2a8d6da09: parsing \n/opt/go/src/github.com/brocaar/lorawan/go.mod: open /opt/go/src/github.com/brocaar/lorawan/go.mod: no \nsuch file or directory\n2019/12/03 16:02:37 Failed to cross compile package: exit status 1.\n</code></pre>\n\n<p>I really don't now why he say \"no such file or directory\", because there are go.mod in folder lorawan ! can some one help me ? thanks</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda", "aws-api-gateway"], "comments": [{"owner": {"reputation": 629, "user_id": 1621713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BltSU.jpg?s=128&g=1", "display_name": "Arun Poudel", "link": "https://stackoverflow.com/users/1621713/arun-poudel"}, "edited": false, "score": 0, "creation_date": 1575397391, "post_id": 59160055, "comment_id": 104550555, "body": "I think your function signature for <code>Handler</code> is wrong, It should be two params, <code>Context</code> and <code>APIGatewayProxyRequest</code>. Try that, and it should help. Also, your return should be <code>(APIGatewayProxyResponse, error)</code>"}, {"owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "reply_to_user": {"reputation": 629, "user_id": 1621713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BltSU.jpg?s=128&g=1", "display_name": "Arun Poudel", "link": "https://stackoverflow.com/users/1621713/arun-poudel"}, "edited": false, "score": 0, "creation_date": 1575440807, "post_id": 59160055, "comment_id": 104562953, "body": "@ArunPoudel Thanks for the comment. I have also tried with &#39;Context&#39; param as below. Still, I didn&#39;t get the required parameters.                                         func Handler(ctx context.Context, request events.APIGatewayProxyRequest) (string, error) {"}, {"owner": {"reputation": 629, "user_id": 1621713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BltSU.jpg?s=128&g=1", "display_name": "Arun Poudel", "link": "https://stackoverflow.com/users/1621713/arun-poudel"}, "edited": false, "score": 0, "creation_date": 1575447389, "post_id": 59160055, "comment_id": 104565465, "body": "Can you also share your cloudformation template or how the API gateway is setup?"}, {"owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "reply_to_user": {"reputation": 629, "user_id": 1621713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BltSU.jpg?s=128&g=1", "display_name": "Arun Poudel", "link": "https://stackoverflow.com/users/1621713/arun-poudel"}, "edited": false, "score": 0, "creation_date": 1575451456, "post_id": 59160055, "comment_id": 104567467, "body": "@ArunPoudel I have used this document as the reference to set up the API Gateway - <a href=\"https://www.twilio.com/docs/sms/tutorials/how-to-receive-and-reply-python-amazon-lambda\" rel=\"nofollow noreferrer\">twilio.com/docs/sms/tutorials/&hellip;</a>. The set up also worked fine for the python Lambda function as stated in the document."}, {"owner": {"reputation": 359, "user_id": 5121690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFLwM.jpg?s=128&g=1", "display_name": "Sky.Li", "link": "https://stackoverflow.com/users/5121690/sky-li"}, "edited": false, "score": 0, "creation_date": 1575456551, "post_id": 59160055, "comment_id": 104570403, "body": "I noticed the request Body shows &quot;Good Day&quot;. Where did this word born from? I guess it may inspire us?"}, {"owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "reply_to_user": {"reputation": 359, "user_id": 5121690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFLwM.jpg?s=128&g=1", "display_name": "Sky.Li", "link": "https://stackoverflow.com/users/5121690/sky-li"}, "edited": false, "score": 0, "creation_date": 1575456967, "post_id": 59160055, "comment_id": 104570634, "body": "@Sky.Li Yup, you caught me. I have updated the body section while asking the question. Originally It was &#39;Testing again&#39; which really sounds boring :)"}, {"owner": {"reputation": 359, "user_id": 5121690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFLwM.jpg?s=128&g=1", "display_name": "Sky.Li", "link": "https://stackoverflow.com/users/5121690/sky-li"}, "edited": false, "score": 0, "creation_date": 1575473920, "post_id": 59160055, "comment_id": 104580238, "body": "@RahulSatal Aha...It&#39;s a really important clue. I think we don&#39;t need a &quot;Good Day&quot;, but to &quot;Testing Again&quot;~"}], "answers": [{"comments": [{"owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "edited": false, "score": 0, "creation_date": 1575548409, "post_id": 59179538, "comment_id": 104608286, "body": "Thanks @Sky.Li, for pointing out the cause of the issue and for the great explanation. I didn&#39;t find the matching template for <code>APIGatewayProxyRequest</code>. So, I have passed the entire request body to the Lambda using <code>Lambda proxy integration</code> and handled it in the lambda itself."}, {"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1599958854, "post_id": 59179538, "comment_id": 112936674, "body": "Not sure why one the AWS {developers,SAM libraries} couldn&#39;t abstract this insanity away and just leave us with the standard (w http.ResponseWriter, r *http.Request) interface!"}], "tags": [], "owner": {"reputation": 359, "user_id": 5121690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFLwM.jpg?s=128&g=1", "display_name": "Sky.Li", "link": "https://stackoverflow.com/users/5121690/sky-li"}, "is_accepted": true, "score": 2, "last_activity_date": 1575549208, "last_edit_date": 1575549208, "creation_date": 1575473684, "answer_id": 59179538, "question_id": 59160055, "link": "https://stackoverflow.com/questions/59160055/unable-to-pass-a-params-from-post-to-aws-lambda-from-amazon-api-gateway-for-gola/59179538#59179538", "title": "Unable to pass a params from POST to AWS Lambda from Amazon API Gateway for Golang", "body": "<h1>Conclusion :</h1>\n\n<p>This problem is caused by the different param struct of lambda handler in golang and python.</p>\n\n<h1>Details:</h1>\n\n<ul>\n<li>The JSON made by API Gateway mapping template:</li>\n</ul>\n\n<pre><code>    {\n        \"ToCountry\": \"US\",\n        \"ToState\": \"UT\",\n        \"SmsMessageSid\": \"SMed65aaxxxxxx5c7938df\",\n        \"NumMedia\": \"0\",\n        \"ToCity\": \"\",\n        \"FromZip\": \"\",\n        \"SmsSid\": \"SMed65aaxxxxxx938df\",\n        \"FromState\": \"\",\n        \"SmsStatus\": \"received\",\n        \"FromCity\": \"\",\n        \"Body\": \"Testing+again\",\n        \"FromCountry\": \"IN\",\n        \"To\": \"%2B1xxxxxx848\",\n        \"ToZip\": \"\",\n        \"NumSegments\": \"1\",\n        \"MessageSid\": \"SMed65aa5dxxxx7938df\",\n        \"AccountSid\": \"AC23xxxd98\",\n        \"From\": \"%2B9xxxxxx90\",\n        \"ApiVersion\": \"2010-04-01\"\n    }\n</code></pre>\n\n<ul>\n<li>The <code>event</code> parameter in python:</li>\n</ul>\n\n<pre><code>    def lambda_handler(event, context):\n        print(\"Received event: \" + str(event))\n        return '&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;'\\\n           '&lt;Response&gt;&lt;Message&gt;Hello world! -Lambda&lt;/Message&gt;&lt;/Response&gt;'\n</code></pre>\n\n<p>Reference to <a href=\"https://docs.aws.amazon.com/zh_cn/lambda/latest/dg/python-programming-model.html\" rel=\"nofollow noreferrer\">AWS Python Doc</a>:</p>\n\n<blockquote>\n  <p>event \u2013 AWS Lambda uses this parameter to pass in event data to the handler. This parameter is usually of the Python dict type. It can also be a list, str, int, float, or NoneType type.</p>\n</blockquote>\n\n<ul>\n<li><strong>[IMPORTANT PART]</strong> The <code>events.APIGatewayProxyRequest</code> parameter in golang:</li>\n</ul>\n\n<pre><code>// APIGatewayProxyRequest contains data coming from the API Gateway proxy\ntype APIGatewayProxyRequest struct {\n    Resource                        string                        `json:\"resource\"` // The resource path defined in API Gateway\n    Path                            string                        `json:\"path\"`     // The url path for the caller\n    HTTPMethod                      string                        `json:\"httpMethod\"`\n    Headers                         map[string]string             `json:\"headers\"`\n    MultiValueHeaders               map[string][]string           `json:\"multiValueHeaders\"`\n    QueryStringParameters           map[string]string             `json:\"queryStringParameters\"`\n    MultiValueQueryStringParameters map[string][]string           `json:\"multiValueQueryStringParameters\"`\n    PathParameters                  map[string]string             `json:\"pathParameters\"`\n    StageVariables                  map[string]string             `json:\"stageVariables\"`\n    RequestContext                  APIGatewayProxyRequestContext `json:\"requestContext\"`\n    Body                            string                        `json:\"body\"`\n    IsBase64Encoded                 bool                          `json:\"isBase64Encoded,omitempty\"`\n}\n</code></pre>\n\n<p>So you can see, the json map you provide to Golang AWS lambda handler only match one key <code>Body</code>. That's the reason why the printf only prints the <code>Testing Again</code>.</p>\n\n<h1>Solution:</h1>\n\n<p>To get the correct result with lambda write by golang, I think you can refer to <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-mapping-template-reference.html#input-examples-mapping-templates\" rel=\"nofollow noreferrer\">this part of AWS DOC</a>. \uff08It's really helpful for us to understand how the AWS API Gateway mapping template work.\uff09</p>\n\n<p>Rewrite the mapping template to match the <code>APIGatewayProxyRequest</code> JSON tag.</p>\n"}], "owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1136, "favorite_count": 1, "accepted_answer_id": 59179538, "answer_count": 1, "score": 3, "last_activity_date": 1575549208, "creation_date": 1575385744, "last_edit_date": 1575457117, "question_id": 59160055, "link": "https://stackoverflow.com/questions/59160055/unable-to-pass-a-params-from-post-to-aws-lambda-from-amazon-api-gateway-for-gola", "title": "Unable to pass a params from POST to AWS Lambda from Amazon API Gateway for Golang", "body": "<p>It's different from - <a href=\"https://stackoverflow.com/questions/32057053/how-to-pass-a-params-from-post-to-aws-lambda-from-amazon-api-gateway\">How to pass a params from POST to AWS Lambda from Amazon API Gateway</a>. Because I am able to convert the params in the API Gateway, but not able to pass it or print it with Golang. However, the same API Gateway is working fine for Python.</p>\n\n<p>Below are the logs of my API Gateway and AWS Lambda(Golang). I can see the POST params are converted to JSON successfully. Still, I cannot see it in the Lambda function logs.</p>\n\n<p><strong>API Gateway Logs</strong></p>\n\n<pre><code>(442f74ed-39e5-4372-bf85-42bf814f802f) Extended Request Id: EIaYxxMF3lQ=\n(442f74ed-39e5-4372-bf85-42bf814f802f) Method request path: {}\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Method request query string:    {}\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Method request headers: {Accept=*/*, Cache-Control=max-age=259200, X-Twilio-Signature=ZWg2v7xxxfnBlPyxE=, User-Agent=TwilioProxy/1.1, X-Forwarded-Proto=https, I-Twilio-Idempotency-Token=e5d1xxx221bc4, X-Forwarded-For=54.xxxx.227, Host=xxxxxxx.execute-api.us-east-1.amazonaws.com, X-Forwarded-Port=443, X-Amzn-Trace-Id=Root=1-5de67103-7994dbxxx0dbd872, Content-Type=application/x-www-form-urlencoded}}  \n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Method request body before transformations: ToCountry=US&amp;ToState=UT&amp;SmsMessageSid=SMed65axxx595c7938df&amp;NumMedia=0&amp;ToCity=&amp;FromZip=&amp;SmsSid=SMed65aa5xxccdd595c7938df&amp;FromState=&amp;SmsStatus=received&amp;FromCity=&amp;Body=Testing+again&amp;FromCountry=IN&amp;To=%2Bxxxx848&amp;ToZip=&amp;NumSegments=1&amp;MessageSid=SMed65axxxd595c7938df&amp;AccountSid=AC23a2cbxxx65a66d98&amp;From=%2B9xxxx5590&amp;ApiVersion=2010-04-01\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Endpoint request URI: https://lambda.us-east-1.amazonaws.com/2015-03-31/functions/arn:aws:lambda:us-east-1:6xxxxxxxx6:function:Twillio_connector_test/invocations\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Endpoint request headers: {x-amzn-lambda-integration-tag=442f74ed-39e5-4372-bf85-42bf814f802f, Authorization=*****27aa7a, X-Amz-Date=20191203T142819Z, x-amzn-apigateway-api-id=xxxxx, X-Amz-Source-Arn=arn:aws:execute-api:us-east-1:69xxxx886:xxxxxxx/v1/POST/message, Accept=application/x-www-form-urlencoded, User-Agent=AmazonAPIGateway_f7504e7yc6, X-Amz-Security-Token=IQoJbxxxhQH [TRUNCATED]\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Endpoint request body after transformations: \n    {\n        \"ToCountry\": \"US\",\n        \"ToState\": \"UT\",\n        \"SmsMessageSid\": \"SMed65aaxxxxxx5c7938df\",\n        \"NumMedia\": \"0\",\n        \"ToCity\": \"\",\n        \"FromZip\": \"\",\n        \"SmsSid\": \"SMed65aaxxxxxx938df\",\n        \"FromState\": \"\",\n        \"SmsStatus\": \"received\",\n        \"FromCity\": \"\",\n        \"Body\": \"Testing+again\",\n        \"FromCountry\": \"IN\",\n        \"To\": \"%2B1xxxxxx848\",\n        \"ToZip\": \"\",\n        \"NumSegments\": \"1\",\n        \"MessageSid\": \"SMed65aa5dxxxx7938df\",\n        \"AccountSid\": \"AC23xxxd98\",\n        \"From\": \"%2B9xxxxxx90\",\n        \"ApiVersion\": \"2010-04-01\"\n    }\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Endpoint response headers: {Date=Tue, 03 Dec 2019 14:28:20 GMT, Content-Type=application/json, Content-Length=43, Connection=keep-alive, x-amzn-RequestId=168394b7-c152-4434-af02-03a03b6f3090, x-amzn-Remapped-Content-Length=0, X-Amz-Executed-Version=$LATEST, X-Amzn-Trace-Id=root=1-5de67103-7994dbxxxxbe30dbd872;sampled=0}\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Endpoint response body before transformations: \"Lambda function is completed successfully\"\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Method response body after transformations: Lambda function is completed successfully\n\n(442f74ed-39e5-4372-bf85-42bf814f802f) Method response headers: {X-Amzn-Trace-Id=Root=1-5de67103-7994dbxxxxxxd872;Sampled=0, Content-Type=application/xml}\n</code></pre>\n\n<p><strong>Lambda function Code</strong></p>\n\n<pre><code>func Handler(request events.APIGatewayProxyRequest) (string, error) {\n\n    fmt.Println(\"request:\", events.APIGatewayProxyRequestContext)\n    fmt.Println(\"request:\", events.APIGatewayProxyResponse)\n    fmt.Println(\"request:\", events.APIGatewayRequestIdentity)\n\n    fmt.Printf(\"%+v\\n\", request)\n    fmt.Println(\"request Body:\", request.Body)\n    fmt.Println(\"request HTTPMethod:\", request.HTTPMethod)\n    fmt.Println(\"request Headers:\", request.Headers)\n    fmt.Println(\"request:\", request.RequestContext.RequestID)\n\n    fmt.Println(\"PrettyPrint\")\n    prettyPrint(request)\n</code></pre>\n\n<p><strong>Lambda function logs</strong></p>\n\n<pre><code>request: {   map[] map[] map[] map[] map[] map[] {    {           }  map[]  } Good Day false}\n{Resource: Path: HTTPMethod: Headers:map[] MultiValueHeaders:map[] QueryStringParameters:map[] MultiValueQueryStringParameters:map[] PathParameters:map[] StageVariables:map[] RequestContext:{AccountID: ResourceID: Stage: RequestID: Identity:{CognitoIdentityPoolID: AccountID: CognitoIdentityID: Caller: APIKey: AccessKey: SourceIP: CognitoAuthenticationType: CognitoAuthenticationProvider: UserArn: UserAgent: User:} ResourcePath: Authorizer:map[] HTTPMethod: APIID:} Body:Good Day IsBase64Encoded:false}\nrequest Body: Good Day\nrequest HTTPMethod: \nrequest Headers: map[]\nrequest: \n</code></pre>\n\n<p>I have tried many ways. But I can't get the required parameters in the Golang code. Please correct me if I am doing anything wrong. Any help will be appreciated.</p>\n\n<p>PS: I have used this document as the reference to set up the API Gateway - <a href=\"https://www.twilio.com/docs/sms/tutorials/how-to-receive-and-reply-python-amazon-lambda\" rel=\"nofollow noreferrer\">https://www.twilio.com/docs/sms/tutorials/how-to-receive-and-reply-python-amazon-lambda</a>. The setup worked fine for Python Lambda function.</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 28612, "user_id": 7954504, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/6POkt.jpg?s=128&g=1", "display_name": "Brad Solomon", "link": "https://stackoverflow.com/users/7954504/brad-solomon"}, "edited": false, "score": 1, "creation_date": 1575384006, "post_id": 59159425, "comment_id": 104543300, "body": "What specifically are you asking?  How to <a href=\"https://gobyexample.com/structs\" rel=\"nofollow noreferrer\">initialize a struct</a>? How to <a href=\"https://gobyexample.com/arrays\" rel=\"nofollow noreferrer\">index an array</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 6659081, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e382882d8aa699902cc33ba6d1543dba?s=128&d=identicon&r=PG&f=1", "display_name": "Daniela", "link": "https://stackoverflow.com/users/6659081/daniela"}, "edited": false, "score": 0, "creation_date": 1575384248, "post_id": 59159541, "comment_id": 104543462, "body": "The issue is that the real struct has more than 30 fields."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 331, "user_id": 6659081, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e382882d8aa699902cc33ba6d1543dba?s=128&d=identicon&r=PG&f=1", "display_name": "Daniela", "link": "https://stackoverflow.com/users/6659081/daniela"}, "edited": false, "score": 1, "creation_date": 1575384515, "post_id": 59159541, "comment_id": 104543646, "body": "@Daniela you may implement a loop for the conversion by filling an array of <code>float64</code> values. For the struct, you\u2019ll have to write it in full, unless you use refection but that would make the code complex."}], "tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": false, "score": 0, "last_activity_date": 1575384351, "last_edit_date": 1575384351, "creation_date": 1575384019, "answer_id": 59159541, "question_id": 59159425, "link": "https://stackoverflow.com/questions/59159425/how-to-create-a-golang-struct-instance-from-an-array/59159541#59159541", "title": "How to create a Golang struct instance from an array?", "body": "<p>Of course it it possible to do that in Go.</p>\n\n<p>The following code example will assign to <code>s</code> the record filled with the fields of data. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\ntype Record struct {\n    name string\n    x    float64\n    y    float64\n    mag  float64\n}\n\nfunc main() {\n    data := [4]string{\"a\", \"3.0\", \"2.5\", \"10.7\"}\n    x, err :=  strconv.ParseFloat(data[1], 64)\n    if err != nil {\n        panic(err)\n    }\n    y, err :=  strconv.ParseFloat(data[2], 64)\n    if err != nil {\n        panic(err)\n    }\n    mag, err :=  strconv.ParseFloat(data[3], 64)\n    if err != nil {\n        panic(err)\n    }\n    s := Record{ name: data[0], x: x, y: y, mag: mag}\n\n    fmt.Println(s)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 1, "last_activity_date": 1575385086, "last_edit_date": 1575385086, "creation_date": 1575384126, "answer_id": 59159566, "question_id": 59159425, "link": "https://stackoverflow.com/questions/59159425/how-to-create-a-golang-struct-instance-from-an-array/59159566#59159566", "title": "How to create a Golang struct instance from an array?", "body": "<p>There is no simple way to do this. You have to assign struct members one by one.</p>\n\n<pre><code>for _, x := range data {\n    x, err := strconv.ParseFloat(x[1])\n    y, err := strconv.ParseFloat(x[2])\n    max, err := strconv.ParseFloat(x[3])\n    strData = append(strData, Record{name: x[0], x: x, y: y, mag: mag})\n}\n</code></pre>\n\n<p>You also have to deal with parse errors.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1575391144, "last_edit_date": 1575391144, "creation_date": 1575384995, "answer_id": 59159836, "question_id": 59159425, "link": "https://stackoverflow.com/questions/59159425/how-to-create-a-golang-struct-instance-from-an-array/59159836#59159836", "title": "How to create a Golang struct instance from an array?", "body": "<p>An easy way is to use reflection to iterate over the fields of the struct, obtain their address (pointer), and use <a href=\"https://golang.org/pkg/fmt/#Sscan\" rel=\"nofollow noreferrer\"><code>fmt.Sscan()</code></a> to scan the string value into the field. <code>fmt.Sscan()</code> will handle the different types of fields for you. This is in no way an efficient solution, it is just a short, easy and flexible solution. If you need an efficient solution, you have to handle all fields explicitly, manually.</p>\n\n<p>This only works if the fields of the struct are exported, e.g.:</p>\n\n<pre><code>type Record struct {\n    Name string\n    X    float64\n    Y    float64\n    Mag  float64\n    Age  int\n}\n</code></pre>\n\n<p>The function that loads a string slice into a struct value:</p>\n\n<pre><code>func assign(recordPtr interface{}, data []string) error {\n    v := reflect.ValueOf(recordPtr).Elem()\n    max := v.NumField()\n    if max &gt; len(data) {\n        max = len(data)\n    }\n\n    for i := 0; i &lt; max; i++ {\n        if _, err := fmt.Sscan(data[i], v.Field(i).Addr().Interface()); err != nil {\n            return err\n        }\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>Note that this implementation tries to fill as many fields as possible (e.g. it does not return an error if the struct has more or less fields than input data provided). Also note that this <code>assign()</code> function can fill any other structs, not just <code>Record</code>, that's why it's flexible.</p>\n\n<p>Example testing it:</p>\n\n<pre><code>data := []string{\"a\", \"3.0\", \"2.5\", \"10.7\", \"23\"}\n\nvar r Record\nif err := assign(&amp;r, data); err != nil {\n    fmt.Println(\"error:\", err)\n}\nfmt.Printf(\"%+v\", r)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/EapY5MDh871\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{Name:a X:3 Y:2.5 Mag:10.7 Age:23}\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 6659081, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e382882d8aa699902cc33ba6d1543dba?s=128&d=identicon&r=PG&f=1", "display_name": "Daniela", "link": "https://stackoverflow.com/users/6659081/daniela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 2, "accepted_answer_id": 59159836, "answer_count": 3, "score": -2, "last_activity_date": 1575391144, "creation_date": 1575383668, "question_id": 59159425, "link": "https://stackoverflow.com/questions/59159425/how-to-create-a-golang-struct-instance-from-an-array", "title": "How to create a Golang struct instance from an array?", "body": "<p>Let's say I have a bunch of array of strings, for example:</p>\n\n<pre><code>data := [4]string{\"a\", \"3.0\", \"2.5\",  \"10.7\"}\n</code></pre>\n\n<p>And a struct definition:</p>\n\n<pre><code>type Record struct {\n  name string\n  x  float64\n  y  float64\n  mag  float64\n}\n</code></pre>\n\n<p>I'd like to create an instance of this struct from each array. </p>\n\n<p>I need to match the first item of the array to the first field of the struct and so on. Is it possible to do this?\nEach array corresponds to one line of a file, so I can actually decide how to read these values in case a different approach is better.</p>\n"}, {"tags": ["go", "goland"], "answers": [{"comments": [{"owner": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "edited": false, "score": 0, "creation_date": 1597504660, "post_id": 59158452, "comment_id": 112157326, "body": "Thanks, after a few hours of searching this helped me!"}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 3, "last_activity_date": 1575380524, "creation_date": 1575380524, "answer_id": 59158452, "question_id": 59158089, "link": "https://stackoverflow.com/questions/59158089/goland-could-not-find-reference-unresolved-reference-newrgba/59158452#59158452", "title": "GoLand could not find reference: &quot; Unresolved reference &#39;NewRGBA&#39; &quot;", "body": "<p>It seems that you accidentally marked the <code>image.go</code> file as plain text, which is why the IDE does not recognize anything defined in it correctly.</p>\n\n<p>To fix this, go to <code>Settings/Preferences | Editor | File Types</code> and search in the file types list for <code>Text</code>. There you should see the list of all files/extensions marked as plain text. Remove <code>image.go</code> from the list and see if this works correctly. Additionally, make sure that file file is not listed in the <code>Ignore files and folders</code> input, in the same section.</p>\n"}], "owner": {"reputation": 196, "user_id": 6941949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-zW0aAhk494k/AAAAAAAAAAI/AAAAAAAAA9s/WfL3Aqx1CQw/photo.jpg?sz=128", "display_name": "Mukhtar Bimurat", "link": "https://stackoverflow.com/users/6941949/mukhtar-bimurat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 59158452, "answer_count": 1, "score": 0, "last_activity_date": 1575380524, "creation_date": 1575379225, "last_edit_date": 1575380026, "question_id": 59158089, "link": "https://stackoverflow.com/questions/59158089/goland-could-not-find-reference-unresolved-reference-newrgba", "title": "GoLand could not find reference: &quot; Unresolved reference &#39;NewRGBA&#39; &quot;", "body": "<p>I am trying to do <a href=\"https://tour.golang.org/methods/24\" rel=\"nofollow noreferrer\">this sample</a>, but GoLand could not find reference of NewRGBA function which is annoying, although it executes it correctly. I already tried <a href=\"https://stackoverflow.com/questions/44921623/valid-methods-in-being-highlighted-in-red-unresolved-reference\">this solution</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sq6gG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sq6gG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["mysql", "database", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1575374695, "post_id": 59156665, "comment_id": 104537548, "body": "1) Yes. 2) Yes, of course."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1575374913, "post_id": 59156665, "comment_id": 104537674, "body": "Doc of <a href=\"https://golang.org/pkg/database/sql/#DB.Close\" rel=\"nofollow noreferrer\"><code>DB.Close()</code></a>: <i>&quot;Close closes the database and <b>prevents new queries from starting. Close then waits for all queries that have started processing on the server to finish.</b>  It is rare to Close a DB, as the DB handle is meant to be long-lived and shared between many goroutines.&quot;</i>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1575376384, "post_id": 59156665, "comment_id": 104538527, "body": "@AmanPatel also note the last paragraph of documentation on <a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"nofollow noreferrer\">Open</a> <i>&quot;The returned DB is safe for concurrent use by multiple goroutines and maintains its own pool of idle connections. Thus, the Open function should be called just once. <b>It is rarely necessary to close a DB</b>.&quot;</i>"}, {"owner": {"reputation": 21, "user_id": 11994228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCBIYfBEWBYAetsKfGJYuofpZ4g1-fCaZYPCCxrew=k-s128", "display_name": "Aman Patel", "link": "https://stackoverflow.com/users/11994228/aman-patel"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1575508307, "post_id": 59156665, "comment_id": 104593748, "body": "Thank you all , and @mkopriva , i read exactly the same thing in docs , but my observation was a bit different so i got confused."}, {"owner": {"reputation": 21, "user_id": 11994228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCBIYfBEWBYAetsKfGJYuofpZ4g1-fCaZYPCCxrew=k-s128", "display_name": "Aman Patel", "link": "https://stackoverflow.com/users/11994228/aman-patel"}, "edited": false, "score": 0, "creation_date": 1575508802, "post_id": 59156665, "comment_id": 104593843, "body": "Basically the problem is when I open a db conn using db , err := db.Open(...) , and pass it to goroutines (around 20) performing different queries , ideally they should use connection from the db connection pool pointed by the db object , but my sql db was showing hell lot of open connections. Though i was also calling defer db.Close() , but i dont believe that it had to do anything with it"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1575523241, "post_id": 59156665, "comment_id": 104597022, "body": "@AmanPatel pretty much any other object from that package that <i>can</i> be closed, should be closed as soon as one is done with it. For example, one very common mistake, that causes a Go program to run out of available connections and crash, is to not close the <code>*sql.Rows</code> object returned from the <code>Query</code> / <code>QueryContext</code> methods."}], "owner": {"reputation": 21, "user_id": 11994228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCBIYfBEWBYAetsKfGJYuofpZ4g1-fCaZYPCCxrew=k-s128", "display_name": "Aman Patel", "link": "https://stackoverflow.com/users/11994228/aman-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575377196, "creation_date": 1575374490, "last_edit_date": 1575377196, "question_id": 59156665, "link": "https://stackoverflow.com/questions/59156665/what-is-the-proper-way-to-close-a-sql-db-connection", "title": "What is the proper way to close a sql db connection?", "body": "<p>I am using sql with Go, using the <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">mysql driver</a> and <code>database/sql</code>.</p>\n\n<p>While reading about it I found that this driver handles the things related to connection pooling itself and db, <code>err := db.Open(\"conn string\")</code> returns the connection pool instead of a single connection and when we use <code>db.Query(\"some query\")</code>, it actually picks a free connection from connection pool (if no connection in pool is free it opens a new one) and uses it.</p>\n\n<p>Please correct me, if I am wrong in my above understanding.</p>\n\n<p>Now my question is, what happens when I call <code>db.Close()</code>: </p>\n\n<ol>\n<li>Will it close all connections in the connection pool?</li>\n<li>Will it close then even if they they are passed to different goroutines and are being used there?</li>\n</ol>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 2329, "user_id": 1363486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d556e3afbb20ad2623b46413d1cb345?s=128&d=identicon&r=PG", "display_name": "Marco Pantaleoni", "link": "https://stackoverflow.com/users/1363486/marco-pantaleoni"}, "is_accepted": true, "score": 1, "last_activity_date": 1575373719, "last_edit_date": 1575373719, "creation_date": 1575373062, "answer_id": 59156236, "question_id": 59155735, "link": "https://stackoverflow.com/questions/59155735/gorm-where-clause-not-working-on-preload-data/59156236#59156236", "title": "Gorm WHERE clause not working on Preload data", "body": "<p>Can you use a JOIN?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    resourceUsages := []ResourceUsage{}\n    if err := db.Joins(\"JOIN resource_metadata ON resource_metadata.id=details_id\").\n        Where(\"resource_metadata.resource_type = ? AND timestamp BETWEEN ? AND ?\", resourceType, start, end).\n        Preload(\"ResourceMetadata\").Limit(10).\n        Find(&amp;resourceUsages).Error; err != nil {\n        // ... handle error ...\n    }\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 1887912, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cb3aa8025d2e06f2adac3f3a8a6388de?s=128&d=identicon&r=PG", "display_name": "JonB", "link": "https://stackoverflow.com/users/1887912/jonb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 59156236, "answer_count": 1, "score": 0, "last_activity_date": 1575373719, "creation_date": 1575371287, "question_id": 59155735, "link": "https://stackoverflow.com/questions/59155735/gorm-where-clause-not-working-on-preload-data", "title": "Gorm WHERE clause not working on Preload data", "body": "<p>This query here below works, where the <code>where</code> clause works becuase it's using values from <code>ResourceUsage</code> struct, but I would love to be able to do something like this, where the <code>where</code> clause is using value from the <code>ResourceMetadata</code> struct.</p>\n\n<blockquote>\n  <p>db.Preload(\"ResourceMetadata\").Where(\"resource_type = ?\", resourceType).Where(\"timestamp BETWEEN ? AND ?\", start, end).Limit(10).Find(&amp;resourceUsage)</p>\n</blockquote>\n\n<p>But it throws exception:</p>\n\n<blockquote>\n  <p>2019-12-03 11:06:12]  Error 1054: Unknown column 'resource_type' in 'where clause'</p>\n</blockquote>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>// ResourceUsage describes the storage model for resource-usage\ntype ResourceUsage struct {\n    ID               int64             `json:\"-\"`\n    DetailsID        int64             `json:\"details_id\"`\n    ResourceMetadata *ResourceMetadata `gorm:\"foreignkey:DetailsID;association_foreignkey:ID\"`\n    MeasuredType     string            `json:\"measured_type\"`\n    Quantity         float64           `json:\"quantity\"`\n    Timestamp        int64             `json:\"timestamp\"`\n}\n\n// ResourceMetadata describes the storage model for resource-usage\ntype ResourceMetadata struct {\n    ID                  int64  `json:\"-\"`\n    ResourceUUID        string `json:\"resource_uuid\"`\n    ResourceName        string `json:\"resource_name\"`\n    ResourceDisplayName string `json:\"resource_display_name\"`\n    ResourceType        string `json:\"resource_type\"`\n}\n\ndb.Preload(\"ResourceMetadata\").Where(\"timestamp BETWEEN ? AND ?\", start, end).Limit(10).Find(&amp;resourceUsage)\n</code></pre>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 2, "creation_date": 1575370557, "post_id": 59155387, "comment_id": 104535287, "body": "There is a library for creating windows service at <code>golang.org&#47;x&#47;sys&#47;windows&#47;svc</code>. An example can be found at <a href=\"https://github.com/golang/sys/tree/master/windows/svc/example\" rel=\"nofollow noreferrer\">github.com/golang/sys/tree/master/windows/svc/example</a>"}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1575372425, "post_id": 59155387, "comment_id": 104536328, "body": "What error do you see? Please edit the question accordingly."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1575374186, "post_id": 59155387, "comment_id": 104537273, "body": "When one says &quot;\u2026throws an error&quot;, the only fact which can be drawn from such a definition is that &quot;there is a problem&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "is_accepted": false, "score": 0, "last_activity_date": 1575453153, "creation_date": 1575453153, "answer_id": 59173162, "question_id": 59155387, "link": "https://stackoverflow.com/questions/59155387/how-can-i-create-a-windows-service-from-an-exe-created-using-go/59173162#59173162", "title": "How can I create a windows service from an exe created using Go?", "body": "<p>To get arbitrary EXEs to run as a Windows Service, I've had good results using <a href=\"https://nssm.cc/\" rel=\"nofollow noreferrer\">nssm</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7208261, "user_type": "registered", "profile_image": "https://graph.facebook.com/1175969602497815/picture?type=large", "display_name": "Sonal Sharma", "link": "https://stackoverflow.com/users/7208261/sonal-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575453153, "creation_date": 1575370224, "last_edit_date": 1575370728, "question_id": 59155387, "link": "https://stackoverflow.com/questions/59155387/how-can-i-create-a-windows-service-from-an-exe-created-using-go", "title": "How can I create a windows service from an exe created using Go?", "body": "<p>I have a Go program where I am executing a command to run wmi exporter.\nI have created an exe from this script using \"go build\".\nexe works fine. \nNow, I want to create a windows service for this exe. </p>\n\n<p>I have tried sc.exe, I can see the service name in the service.misc but it throws an error if I try to start it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 2, "creation_date": 1575370346, "post_id": 59155157, "comment_id": 104535162, "body": "You get an error with <code>ioutil.ReadAll</code>, but you did not handle the error. What is the error?"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 2, "creation_date": 1575370368, "post_id": 59155157, "comment_id": 104535174, "body": "And whichline do you get <code>runtime error: invalid memory address or nil pointer dereference</code>?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1575371974, "post_id": 59155157, "comment_id": 104536087, "body": "Naming a <i>request</i> as <code>resp</code> is very confusing."}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 2487677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bYuWK.jpg?s=128&g=1", "display_name": "KyleHodgetts", "link": "https://stackoverflow.com/users/2487677/kylehodgetts"}, "is_accepted": false, "score": 3, "last_activity_date": 1575372024, "last_edit_date": 1575372024, "creation_date": 1575371193, "answer_id": 59155711, "question_id": 59155157, "link": "https://stackoverflow.com/questions/59155157/how-to-return-a-body-from-another-request/59155711#59155711", "title": "How to return a body from another request", "body": "<p>You're creating a new GET request with a nil body. See the function signature for http.NewRequest </p>\n\n<pre><code>func NewRequest(method, url string, body io.Reader) (*Request, error)\n</code></pre>\n\n<p>so when you access resp.Body, of course it's going to be nil.</p>\n\n<p>Also, http.NewRequest just returns a request, it doesn't actually perform it.</p>\n\n<p>To actually make the GET request with your request, you need to pass it to a http client's <code>Do</code> method. Like so:</p>\n\n<pre><code>response, err := http.DefaultClient.Do(resp)\n</code></pre>\n\n<p>EDIT: I would also add that naming your request as <code>resp</code> is confusing. I would recommend renaming the variable to <code>req</code> or <code>request</code></p>\n"}, {"tags": [], "owner": {"reputation": 348, "user_id": 3717598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1aRvc.jpg?s=128&g=1", "display_name": "Dulquer", "link": "https://stackoverflow.com/users/3717598/dulquer"}, "is_accepted": true, "score": 0, "last_activity_date": 1575375699, "last_edit_date": 1575375699, "creation_date": 1575374776, "answer_id": 59156764, "question_id": 59155157, "link": "https://stackoverflow.com/questions/59155157/how-to-return-a-body-from-another-request/59156764#59156764", "title": "How to return a body from another request", "body": "<p>this code will solve your issues.</p>\n\n<pre><code>client := &amp;http.Client{}\napiURL := \"https://api.github.com/repos/octocat/Hello-World/pulls/1347\"\nreq, err := http.NewRequest(\"GET\", apiURL, nil)\nif err != nil {\n    check(err)\n}\nreq.Header.Add(\"Accept\", \"application/vnd.github.v3.patch\")\nresponse, err := client.Do(req)\nif err != nil {\n    check(err)\n}\ndefer response.Body.Close()\ncontents, err := ioutil.ReadAll(response.Body)\nif err != nil {\n    check(err)\n}\nctxt.JSON(http.StatusOK, string(contents))\n</code></pre>\n"}], "owner": {"reputation": 711, "user_id": 3128553, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/dOroK.jpg?s=128&g=1", "display_name": "Nivin", "link": "https://stackoverflow.com/users/3128553/nivin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 59156764, "answer_count": 2, "score": -3, "last_activity_date": 1575375699, "creation_date": 1575369472, "last_edit_date": 1575374557, "question_id": 59155157, "link": "https://stackoverflow.com/questions/59155157/how-to-return-a-body-from-another-request", "title": "How to return a body from another request", "body": "<pre><code>req, err := http.NewRequest(\"GET\", \"https://api.github.com/repos/octocat/Hello-World/pulls/1347\", nil)\nreq.Header.Set(\"Accept\", \"application/vnd.github.v3.patch\")\nif err != nil {\n    check(err)\n}\nbody, err := ioutil.ReadAll(req.Body)\nctxt.JSON(http.StatusOK, body)\n</code></pre>\n\n<p>Here I need to send api response from body of github api. But here I'm getting the following error:</p>\n\n<blockquote>\n  <p>\"runtime error: invalid memory address or nil pointer dereference\"</p>\n</blockquote>\n"}, {"tags": ["go", "go-modules"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1575369923, "last_edit_date": 1575369923, "creation_date": 1575369178, "answer_id": 59155056, "question_id": 59154942, "link": "https://stackoverflow.com/questions/59154942/versioned-import-in-go-using-modules-fails/59155056#59155056", "title": "Versioned import in go using modules fails", "body": "<p>Change your import to </p>\n\n<pre><code>import \"k8s.io/client-go/tools/clientcmd\"\n</code></pre>\n\n<p>And execute the command:</p>\n\n<pre><code>go get k8s.io/client-go@kubernetes-1.12.10\n</code></pre>\n\n<p>The used versions are recorded in the <code>go.mod</code> file. The above <code>go get</code> will change <code>go.mod</code> to depend on the given version. Note that you could also edit <code>go.mod</code> manually (but it's better to leave it to the go tool). You only need to modify the import path if you're using versions starting or above <code>v2</code>, in which case the major version must be a suffix, e.g.</p>\n\n<pre><code>import \"k8s.io/client-go/tools/clientcmd/v2\"\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>After the above <code>go get</code> command, the the <code>go.mod</code> file will be modified to contain a <code>require</code> directive like this:</p>\n\n<pre><code>k8s.io/client-go v0.0.0-20190708094436-77c08c6b86df // indirect\n</code></pre>\n\n<p>The reason for this is because go modules require semantic versioning, while  <code>kubernetes-1.12.10</code> is not a semver2 compatible version number. Still, the go tool will resove that this version tags the <a href=\"https://github.com/kubernetes/client-go/commit/77c08c6b86df0af19f718d9a57620c4e9b811d48\" rel=\"nofollow noreferrer\"><code>77c08c6b86df0af19f718d9a57620c4e9b811d48</code> commit</a>, and use it in the <code>go.mod</code> file.</p>\n\n<p>Read more about it here: <a href=\"https://github.com/golang/go/wiki/Modules#how-to-upgrade-and-downgrade-dependencies\" rel=\"nofollow noreferrer\">Go Wiki: Modules: How to Upgrade and Downgrade Dependencies</a></p>\n\n<p>Also see: <a href=\"https://blog.golang.org/v2-go-modules\" rel=\"nofollow noreferrer\">The Go Blog: Go Modules: v2 and Beyond</a></p>\n"}], "owner": {"reputation": 9276, "user_id": 2409793, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/QDLY9.png?s=128&g=1", "display_name": "pkaramol", "link": "https://stackoverflow.com/users/2409793/pkaramol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 59155056, "answer_count": 1, "score": 1, "last_activity_date": 1575369923, "creation_date": 1575368829, "question_id": 59154942, "link": "https://stackoverflow.com/questions/59154942/versioned-import-in-go-using-modules-fails", "title": "Versioned import in go using modules fails", "body": "<p>I want my program to use a specific version of <a href=\"https://github.com/kubernetes/client-go#versioning\" rel=\"nofollow noreferrer\">client-go</a>, so that it is compatible with the target cluster.</p>\n\n<p>However the following syntax:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"log\"\n    \"os\"\n    \"path/filepath\"\n\n    clientcmd \"k8s.io/client-go@kubernetes-1.12.10/tools/clientcmd\"\n)\n</code></pre>\n\n<p>which I use to achieve to build my client configuration as follows:</p>\n\n<pre><code>    config, err := clientcmd.BuildConfigFromFlags(\"\", kubeconfig)\n\n</code></pre>\n\n<p>fails with this error message:</p>\n\n<blockquote>\n  <p>\u25b6 go run main.go<br>\n  package main\n          imports k8s.io/client-go@kubernetes-1.12.10/tools/clientcmd: can only use path@version syntax with 'go get'</p>\n</blockquote>\n\n<p>How should I state the particular versioned input?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575367382, "post_id": 59154233, "comment_id": 104533347, "body": "<code>var x YuccaDataStream; json.Unmarshal(params[0].([]byte), &amp;x)</code>"}, {"owner": {"reputation": 153, "user_id": 540370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0RDe.jpg?s=128&g=1", "display_name": "gianpaolo", "link": "https://stackoverflow.com/users/540370/gianpaolo"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575368029, "post_id": 59154233, "comment_id": 104533730, "body": "@Peter thank you, can you answer so I can vote it?"}, {"owner": {"reputation": 153, "user_id": 540370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0RDe.jpg?s=128&g=1", "display_name": "gianpaolo", "link": "https://stackoverflow.com/users/540370/gianpaolo"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575368086, "post_id": 59154233, "comment_id": 104533765, "body": "Why downvoting this question without a comment? It&#39;s clear and indeed a user has answered immediately."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575368410, "post_id": 59154233, "comment_id": 104533956, "body": "&quot;How do I decide JSON in Go&quot; has been asked and answered countless times on SO and elsewhere."}, {"owner": {"reputation": 153, "user_id": 540370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0RDe.jpg?s=128&g=1", "display_name": "gianpaolo", "link": "https://stackoverflow.com/users/540370/gianpaolo"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575369354, "post_id": 59154233, "comment_id": 104534523, "body": "for the audience, if you find this question useful, upvote it. cheers."}, {"owner": {"reputation": 153, "user_id": 540370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0RDe.jpg?s=128&g=1", "display_name": "gianpaolo", "link": "https://stackoverflow.com/users/540370/gianpaolo"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575371392, "post_id": 59154233, "comment_id": 104535782, "body": "As shown in the answer, the problem was not just calling json.Unmarshal() but it was to retrieve the correct data from params[0].([]byte)   This could not be stated in the question, since it would have required a non-sense title. I provided all the details I thought were needed to understand the problem and re-read my question 3 times. I do not accept this downvote. just saying."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 540370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0RDe.jpg?s=128&g=1", "display_name": "gianpaolo", "link": "https://stackoverflow.com/users/540370/gianpaolo"}, "edited": false, "score": 0, "creation_date": 1575367505, "post_id": 59154466, "comment_id": 104533415, "body": "The problem is that  in printAWSDataToConsole  I have (params ...interface{}) and i don&#39;t know how to retrieve dataAsBytes from params"}], "tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": false, "score": 1, "last_activity_date": 1575367270, "creation_date": 1575367270, "answer_id": 59154466, "question_id": 59154233, "link": "https://stackoverflow.com/questions/59154233/how-do-i-unmarshal-this-json/59154466#59154466", "title": "How do I unmarshal this JSON", "body": "<p>To unmarshal use the following code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var dataOut YuccaDataStream\nerr = json.Unmarshal(dataAsBytes, &amp;dataOut)\n</code></pre>\n\n<p>That\u2019s it. As simple as that.</p>\n"}, {"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575375939, "post_id": 59155332, "comment_id": 104538260, "body": "So the question (title) was wrong or misleading. Sorry for not directly responding to your question. Good to see you managed to solve it by yourself."}], "tags": [], "owner": {"reputation": 153, "user_id": 540370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0RDe.jpg?s=128&g=1", "display_name": "gianpaolo", "link": "https://stackoverflow.com/users/540370/gianpaolo"}, "is_accepted": false, "score": 0, "last_activity_date": 1575370008, "creation_date": 1575370008, "answer_id": 59155332, "question_id": 59154233, "link": "https://stackoverflow.com/questions/59154233/how-do-i-unmarshal-this-json/59155332#59155332", "title": "How do I unmarshal this JSON", "body": "<p>The problem was to understand how to get the data from params ... interface.\nThe answer is:</p>\n\n<pre><code>var dataStream YuccaDataStream;\njson.Unmarshal(params[0].([]byte), &amp;dataStream )\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 540370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0RDe.jpg?s=128&g=1", "display_name": "gianpaolo", "link": "https://stackoverflow.com/users/540370/gianpaolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1575370787, "creation_date": 1575366512, "last_edit_date": 1575370787, "question_id": 59154233, "link": "https://stackoverflow.com/questions/59154233/how-do-i-unmarshal-this-json", "title": "How do I unmarshal this JSON", "body": "<p>I have two func with the following signature:</p>\n\n<pre><code> 1)  func printAWSDataToConsole(edgexcontext *appcontext.Context, params ...interface{}) (bool, interface{}) {\n</code></pre>\n\n<p>and </p>\n\n<pre><code>  2)   func (f Conversion) TransformToAWS()\n</code></pre>\n\n<p>where</p>\n\n<pre><code>func NewConversion() Conversion {\n    return Conversion{}\n}\n</code></pre>\n\n<p>at first TransformToAWS was returning </p>\n\n<pre><code>      true, string(msg)\n</code></pre>\n\n<p>and I was able to print the value of msg in printAWSDataToConsole by doing a simple </p>\n\n<pre><code>     fmt.Println(params[0].(string))\n</code></pre>\n\n<p>Now I changed TransformToAWS to return a json:</p>\n\n<pre><code>    data := YuccaDataStream {\n                 Stream : \"temperatura2\",\n                 Sensor : \"ec6c613a-66b4-4584-fb37-5f7cac130f7d\",\n                 Values : []Value {\n                           Value {\n                           Time:formattedTime,\n                           Components: Components{Alfanum :\"15.55\"},\n       }, }, }\n\n     dataAsBytes, err := json.Marshal(data)\n\n     return true, dataAsBytes\n</code></pre>\n\n<p>where </p>\n\n<pre><code>type YuccaDataStream struct {\n    Stream string `json:\"stream\"`\n    Sensor string `json:\"sensor\"`\n    Values []Value `json:\"values\"`\n    }\n\ntype Value struct {\n    Time string `json:\"time\"`\n    Components `json:\"components\"`\n}\n\ntype Components struct {\n    Alfanum string `json:\"alfanum\"`\n}\n</code></pre>\n\n<p>I don't know how to unmarshal the json in printAWSDataToConsole.</p>\n"}, {"tags": ["c++", "go", "vector"], "answers": [{"tags": [], "owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "is_accepted": false, "score": 1, "last_activity_date": 1575372605, "last_edit_date": 1575372605, "creation_date": 1575365191, "answer_id": 59153862, "question_id": 59153703, "link": "https://stackoverflow.com/questions/59153703/alternate-of-vector-int-adj10/59153862#59153862", "title": "Alternate of &quot;vector &lt;int&gt; adj[10]&quot;", "body": "<p>Try this:</p>\n\n<pre><code>var adj [10][]int\n// elements are nil by default; initialize them\n// (not strictly necessary for append() to work)\nfor i := range adj {\n  adj[i] = make([]int)\n}\n\n// code translated from C++\nadj[x] = append(adj[x], y)\nsort.Ints(adj[x])\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9106111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd738d66a94bab3e75847de116dd1a7?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep gaur", "link": "https://stackoverflow.com/users/9106111/sandeep-gaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "closed_date": 1575432430, "answer_count": 1, "score": -4, "last_activity_date": 1575372605, "creation_date": 1575364650, "last_edit_date": 1575364986, "question_id": 59153703, "link": "https://stackoverflow.com/questions/59153703/alternate-of-vector-int-adj10", "closed_reason": "Needs details or clarity", "title": "Alternate of &quot;vector &lt;int&gt; adj[10]&quot;", "body": "<p>I am searching for an equivalent to a <em>C++</em> <code>vector&lt;int&gt; adj[10]</code> in Go, where we can do the following actions:</p>\n\n<pre><code>adj[x].push_back(y);\n\nsort(adj[x].begin(),adj[x].end());\n</code></pre>\n"}, {"tags": ["json", "go", "struct", "numbers"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1575361581, "post_id": 59152703, "comment_id": 104530264, "body": "&quot;To unmarshal JSON into an interface value, Unmarshal stores [...] float64, for JSON numbers.&quot; <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Unmarshal</a> Don&#39;t use empty interfaces if you care about types. You already have a User type, so why decode a (slice of) map?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1575361834, "last_edit_date": 1592644375, "creation_date": 1575361526, "answer_id": 59152841, "question_id": 59152703, "link": "https://stackoverflow.com/questions/59152703/the-type-of-property-not-the-same-when-reading-from-input-stream/59152841#59152841", "title": "The type of property not the same when reading from input stream", "body": "<p><code>User.RoleID</code> is an integer, and it will be encoded into a JSON Number. And\nbecause you unmarshal into a value of type <code>map[string]interface{}</code> (the value type is interface), <code>float64</code> type is chosen when unmarshaling into an interface value.</p>\n<p>Quoting from <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a>:</p>\n<blockquote>\n<p>To unmarshal JSON into an interface value, Unmarshal stores one of these in the interface value:</p>\n<pre><code>bool, for JSON booleans\nfloat64, for JSON numbers\nstring, for JSON strings\n[]interface{}, for JSON arrays\nmap[string]interface{}, for JSON objects\nnil for JSON null\n</code></pre>\n</blockquote>\n<p>If you know the response holds a <code>User</code> object, unmarshal into a value of type <code>User</code>.</p>\n"}], "owner": {"reputation": 2314, "user_id": 9768260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604c85a549d2603e8119880c100b5aae?s=128&d=identicon&r=PG", "display_name": "ccd", "link": "https://stackoverflow.com/users/9768260/ccd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 59152841, "answer_count": 1, "score": 0, "last_activity_date": 1575361834, "creation_date": 1575360931, "last_edit_date": 1575361675, "question_id": 59152703, "link": "https://stackoverflow.com/questions/59152703/the-type-of-property-not-the-same-when-reading-from-input-stream", "title": "The type of property not the same when reading from input stream", "body": "<p>The code used for testing for listing users.</p>\n\n<pre><code>    req := httptest.NewRequest(\"GET\", \"/v1/users\", nil)\n    resp := httptest.NewRecorder()\n\n    u.app.ServeHTTP(resp, req)\n\n    if resp.Code != http.StatusOK {\n        t.Fatalf(\"getting users: expected status code %v, got %v\", http.StatusOK, resp.Code)\n    }\n\n    var list []map[string]interface{}\n    if err := json.NewDecoder(resp.Body).Decode(&amp;list); err != nil {\n        t.Fatalf(\"decoding users: %s\", err)\n    }\n\n    want := []map[string]interface{}{\n        {\n            \"id\":           \"a2b0639f-2cc6-44b8-b97b-15d69dbb511e\",\n            \"name\":         \"dcc\",\n            \"role_id\":      float64(101),\n            \"date_created\": \"2019-01-01T00:00:01Z\",\n            \"date_updated\": \"2019-01-01T00:00:01Z\",\n        },\n    }\n</code></pre>\n\n<p>The role_id is a int type in model.</p>\n\n<pre><code>type User struct {\n    ID          string    `db:\"user_id\" json:\"id\"`\n    UserName    string    `db:\"user_name\" json:\"user_name\"`\n    RoleID      int       `db:\"role_id\" json:\"role_id\"`\n    DateCreated time.Time `db:\"date_created\" json:\"date_created\"`\n    DateUpdated time.Time `db:\"date_updated\" json:\"date_updated\"`\n}\n</code></pre>\n\n<p>Why it is changed to float64 when inputing to the stream?</p>\n"}, {"tags": ["git", "go", "github", "google-slides-api", "google-api-go-client"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1575361837, "post_id": 59152588, "comment_id": 104530380, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14323872/using-forked-package-import-in-go\">Using forked package import in Go</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 0, "creation_date": 1575363247, "post_id": 59153238, "comment_id": 104531057, "body": "I was able to fork the repo, the issue was using Go &quot;internal&quot; packages. I resolved the internal package issue using the symbolic link approach above, but still ran into issues. It seems like 2 separate structs may be necessary but this may not be that straight-forward here given the different requirements per request property value."}], "tags": [], "owner": {"reputation": 1909, "user_id": 11758896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a02c66bfc9e9d899156c73891518e6?s=128&d=identicon&r=PG&f=1", "display_name": "Raserhin", "link": "https://stackoverflow.com/users/11758896/raserhin"}, "is_accepted": false, "score": 0, "last_activity_date": 1575363059, "creation_date": 1575363059, "answer_id": 59153238, "question_id": 59152588, "link": "https://stackoverflow.com/questions/59152588/how-to-fork-and-modify-the-google-api-go-client-sdk-to-resolve-slides-api-range/59153238#59153238", "title": "How to fork and modify the Google API Go Client SDK to resolve Slides API Range issue?", "body": "<p>If you wish to fork the repository you can do it straight from github UI. Go the <a href=\"https://github.com/googleapis/google-api-go-client\" rel=\"nofollow noreferrer\">github repository</a> and in the top right of the repository there is a <code>Fork</code> button: </p>\n\n<p><a href=\"https://i.stack.imgur.com/bCyVa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bCyVa.png\" alt=\"Fork example\"></a></p>\n\n<p>If you think your change is significant for the Google API maybe you could modify and do a pull request, look <a href=\"https://github.com/googleapis/google-api-go-client/blob/master/CONTRIBUTING.md\" rel=\"nofollow noreferrer\">the project guidelines</a>.</p>\n\n<p>You can also take a look at the github <a href=\"https://help.github.com/en/github/getting-started-with-github/fork-a-repo\" rel=\"nofollow noreferrer\">Fork a Repo</a> page for more information.</p>\n"}], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575364489, "creation_date": 1575360396, "last_edit_date": 1575364489, "question_id": 59152588, "link": "https://stackoverflow.com/questions/59152588/how-to-fork-and-modify-the-google-api-go-client-sdk-to-resolve-slides-api-range", "title": "How to fork and modify the Google API Go Client SDK to resolve Slides API Range issue?", "body": "<p>I'm using the \"Google APIs Client Library for Go\" ( <a href=\"https://github.com/googleapis/google-api-go-client\" rel=\"nofollow noreferrer\">https://github.com/googleapis/google-api-go-client</a> ) and it has an issue supporting the Slides API where a zero-based index request property is required but the struct definition indicates <code>omitempty</code> so zero values are omitted. I want to fork and modify this code to remove the <code>omitempty</code> values.</p>\n\n<p>The specific code is here:</p>\n\n<p><a href=\"https://github.com/googleapis/google-api-go-client/blob/master/slides/v1/slides-gen.go#L4060-L4069\" rel=\"nofollow noreferrer\">https://github.com/googleapis/google-api-go-client/blob/master/slides/v1/slides-gen.go#L4060-L4069</a></p>\n\n<pre><code>type Range struct {\n    // EndIndex: The optional zero-based index of the end of the\n    // collection.\n    // Required for `FIXED_RANGE` ranges.\n    EndIndex int64 `json:\"endIndex,omitempty\"`\n\n    // StartIndex: The optional zero-based index of the beginning of the\n    // collection.\n    // Required for `FIXED_RANGE` and `FROM_START_INDEX` ranges.\n    StartIndex int64 `json:\"startIndex,omitempty\"`\n</code></pre>\n\n<p>I've posted this topic here <a href=\"https://github.com/googleapis/google-api-go-client/issues/433\" rel=\"nofollow noreferrer\">issue 433</a>, but I'd also like to fork and modify the code to overcome this.</p>\n\n<p>I run into the following issues when attempting to fork and modify this code.</p>\n\n<p>First, it expects to only be imported using its original package name using the following package definition comment.</p>\n\n<p><code>package slides // import \"google.golang.org/api/slides/v1\"</code></p>\n\n<p>This comment results in the following error when attempting to use a fork:</p>\n\n<p><code>code in directory /path/to/fork/google-api-go-client/slides/v1 expects import \"google.golang.org/api/slides/v1\"</code></p>\n\n<p>Removing the comment from the package definition line allows the package to be loaded but then the following error is encountered which indicates an internal library is needed.</p>\n\n<p><code>use of internal package google.golang.org/api/internal/gensupport not allowed</code></p>\n\n<p>Is there any way to fork and modify this code?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I was able to overcome the <code>internal</code> package issue with the following from Clive Makamara <a href=\"https://stackoverflow.com/questions/46860546/go-use-of-internal-package-not-allowed-when-running-a-go-project-forked-fro\">here</a>.</p>\n\n<p><code>$ ln -s /path/to/fork/google-api-go-client $GOPATH/google.golang.org/api</code></p>\n\n<p>Unfortunately, this doesn't fully resolve the issue as other range types require the fields to be omitted, resulting in the following error:</p>\n\n<p><code>googleapi: Error 400: Invalid requests[5].createParagraphBullets: The textRange startIndex must not be specified for range type ALL, badRequest</code></p>\n\n<p>Since some range types require <code>StartIndex</code> and others require it to not be present, it seems like having separate range structs may be necessary.</p>\n\n<p>My current workaround is to use the client as-is but add a small font size newline prefix so that I never have to update a text range starting at index 0.</p>\n"}, {"tags": ["go", "bazel"], "answers": [{"comments": [{"owner": {"reputation": 917, "user_id": 914689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d27560a2bbbf4c65b79f91fe9beaf88?s=128&d=identicon&r=PG", "display_name": "Koffiman", "link": "https://stackoverflow.com/users/914689/koffiman"}, "edited": false, "score": 0, "creation_date": 1575443047, "post_id": 59161079, "comment_id": 104563693, "body": "Thanks for your extensive answer! This looks great. However, when compiling the C part, the header is still not found, although it gets generated in the Bazel bin directory."}, {"owner": {"reputation": 917, "user_id": 914689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d27560a2bbbf4c65b79f91fe9beaf88?s=128&d=identicon&r=PG", "display_name": "Koffiman", "link": "https://stackoverflow.com/users/914689/koffiman"}, "edited": false, "score": 1, "creation_date": 1575523817, "post_id": 59161079, "comment_id": 104597195, "body": "OK, the solution works, very nice! However, the last piece of the puzzle is to define the proper path to the include, this will follow your worskpace structure. I.e., if main.c is in &quot;foo/bar/&quot; then you need to include &quot;foo/bar/go_cpp_bridge.h&quot;"}], "tags": [], "owner": {"reputation": 26173, "user_id": 1891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c40d475927f7a86639ec54aa32517572?s=128&d=identicon&r=PG", "display_name": "Jay Conrod", "link": "https://stackoverflow.com/users/1891/jay-conrod"}, "is_accepted": true, "score": 2, "last_activity_date": 1575389285, "creation_date": 1575389285, "answer_id": 59161079, "question_id": 59152485, "link": "https://stackoverflow.com/questions/59152485/bazel-go-binary-c-shared-link-mode-where-is-the-header/59161079#59161079", "title": "Bazel go_binary c-shared link mode: Where is the header?", "body": "<p>When <code>linkmode = \"c-shared\"</code> and <code>linkmode = \"c-archive\"</code> are defined, there are a few additional targets that are defined by adding a suffix to the end of the <code>go_binary</code> name. So for example, you can build <code>go_cpp_bridge.c_hdrs</code> to get the header file. You can build <code>go_cpp_bridge.cc</code> for a <code>cc_library</code> that can be linked with other C/C++ targets. The header is named after the <code>go_binary</code> rule (so <code>go_cpp_bridge.h</code>).</p>\n\n<p>To extend your example, here's a working build file:</p>\n\n<pre><code>load(\"@io_bazel_rules_go//go:def.bzl\", \"go_binary\")\n\ngo_binary(\n    name = \"go_cpp_bridge\",\n    srcs = [\"cpp_bridge.go\"],\n    cgo = True,\n    linkmode = \"c-archive\",\n)\n\ncc_binary(\n    name = \"main\",\n    srcs = [\"main.c\"],\n    deps = [\":go_cpp_bridge.cc\"],\n)\n</code></pre>\n\n<p>And a C program that links against Go:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"go_cpp_bridge.h\"\n\nint main() {\n  printf(\"%lld\\n\", Add(21, 21));\n  return 0;\n}\n</code></pre>\n\n<p>This isn't documented because it's not a great interface. Since this was implemented, Bazel has added better ways to write C/C++ compatible rules, but rules_go doesn't support that yet. <a href=\"https://github.com/bazelbuild/rules_go/issues/2176\" rel=\"nofollow noreferrer\">#2176</a> is the tracking issue for that.</p>\n"}], "owner": {"reputation": 917, "user_id": 914689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d27560a2bbbf4c65b79f91fe9beaf88?s=128&d=identicon&r=PG", "display_name": "Koffiman", "link": "https://stackoverflow.com/users/914689/koffiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 59161079, "answer_count": 1, "score": 1, "last_activity_date": 1575389285, "creation_date": 1575359890, "question_id": 59152485, "link": "https://stackoverflow.com/questions/59152485/bazel-go-binary-c-shared-link-mode-where-is-the-header", "title": "Bazel go_binary c-shared link mode: Where is the header?", "body": "<p>I'm trying to use Bazel (v1.0.0) rules_go to build header + library as I would with go build <code>-buildmode=c-archive</code>. I have the following rule set up in my BUILD.bzl file:</p>\n\n<pre><code>go_binary(\n   name=\"go_cpp_bridge\",\n   srcs = [\"cpp_bridge.go\"],\n   cgo = True,\n   gc_linkopts=[\"-buildmode=c-shared\"],\n   linkmode = \"c-archive\",\n   visibility = [\"//visibility:public\"],\n )\n</code></pre>\n\n<p>The current code of <code>cpp_bridge.go</code> is just a hello world to see if it works:</p>\n\n<pre><code>package main\n\nimport \"C\"\n\n//export Add\nfunc Add(a, b int) int { return a + b }\n\nfunc main(){}\n</code></pre>\n\n<p>Bazel does generate a library file, but I'm missing the associated header file in the bazel-bin output. Testing with go build yields both header file and library. How do I get Bazel to give me the same. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1575360058, "post_id": 59152432, "comment_id": 104529746, "body": "Welcome to SO! You might want to read <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a>, which enhances the probability for getting a useful answer <i>drastically</i>. You might find <a href=\"https://en.m.wikipedia.org/wiki/Eric_S._Raymond\" rel=\"nofollow noreferrer\">ESR</a>&#39;s excellent essay <a href=\"http://catb.org/~esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">How To Ask Questions The Smart Way</a> helpful, too - despite its harsh title. Specifically, the errors show would be helpful. As a rule of thumb: Make it easy for others to help you, eliminate the guesswork."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575360231, "post_id": 59152432, "comment_id": 104529820, "body": "Surely the book explained what variadic parameters are and how they are used before giving this task. Take another look. Hint: your function signature is incorrect."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10524765, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jKLf3PtphdE/AAAAAAAAAAI/AAAAAAAAAHM/Lomne1KheNc/photo.jpg?sz=128", "display_name": "aman katotiya", "link": "https://stackoverflow.com/users/10524765/aman-katotiya"}, "edited": false, "score": 0, "creation_date": 1575382067, "post_id": 59152752, "comment_id": 104542069, "body": "Thank you so much for your help. I really appreciate that you had rewritten this correct code for me. Thank you."}], "tags": [], "owner": {"reputation": 3, "user_id": 8234358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64344e9709f1b8daa2774bc915949f9?s=128&d=identicon&r=PG&f=1", "display_name": "Svyatoslav Grigoryev", "link": "https://stackoverflow.com/users/8234358/svyatoslav-grigoryev"}, "is_accepted": false, "score": 0, "last_activity_date": 1575361171, "creation_date": 1575361171, "answer_id": 59152752, "question_id": 59152432, "link": "https://stackoverflow.com/questions/59152432/difficulty-with-variadic-functions/59152752#59152752", "title": "Difficulty with variadic functions", "body": "<p>If you run your code through <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">https://play.golang.org/</a> you will see a couple of syntax errors. Below is the correct version which finds max in a slice. \nAs you can note you had extra <code>...</code> in the slice argument call.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc findMaximum(args []int) int {\n    max := args[0]\n    for _, v := range args {\n        if v &gt; max{\n            max = v\n        }\n    }\n    return max\n}\n\nfunc main() {\n    x := []int{\n        48, 96, 86, 68,\n        57, 82, 63, 70,\n        37, 34, 83, 27,\n        19, 97, 9, 17,\n    }\n    fmt.Println(findMaximum(x))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "is_accepted": true, "score": 0, "last_activity_date": 1575361721, "last_edit_date": 1575361721, "creation_date": 1575361378, "answer_id": 59152812, "question_id": 59152432, "link": "https://stackoverflow.com/questions/59152432/difficulty-with-variadic-functions/59152812#59152812", "title": "Difficulty with variadic functions", "body": "<blockquote>\n  <p>In mathematics and in computer programming, a variadic function is a\n  function of indefinite arity, i.e., one which accepts a variable\n  number of arguments.</p>\n</blockquote>\n\n<p>Source: <a href=\"https://en.wikipedia.org/wiki/Variadic_function\" rel=\"nofollow noreferrer\">Wikipedia</a></p>\n\n<p>Your function signature is slightly incorrect.</p>\n\n<pre><code>func findMaximum(args ...[]int) []int\n</code></pre>\n\n<p>This indicates that <code>findMaximum</code> takes in a variable number of <code>int</code> slices as arguments and returns an <code>int</code> slice. The problem that you're trying to solve is asking to take in a variable number of <code>int</code> arguments and return a singular <code>int</code> which is the largest in the set provided.</p>\n\n<p>Calling your function would look something like this:</p>\n\n<pre><code>largest := findMaximum([]int{1, 2, 3}, []int{4, 5, 6}, []int{7, 8, 9})\n</code></pre>\n\n<p>In this case, <code>largest</code> would be of type <code>[]int</code> indicating that the function returned multiple <code>int</code> values in the form of a slice. This wouldn't make sense, since there should only be <strong>one</strong> largest value (assuming no duplicates).</p>\n\n<p>You're wanting a function signature that looks like this:</p>\n\n<pre><code>func findMaximum(args ...int) int\n</code></pre>\n\n<p>Calling this function would look like this:</p>\n\n<pre><code>largest := findMaximum(1, 2, 3, 4, 5, 6, 7, 8, 9)\n</code></pre>\n\n<p>...or if you had your numbers in a slice:</p>\n\n<pre><code>nums := []int{1, 2, 3, 4, 5, 6, 7, 8, 9}\nlargest := findMaximum(nums...)\n</code></pre>\n\n<p>In this case, <code>largest</code> would be of type <code>int</code>, which is the correct return value you're looking for in this problem.</p>\n\n<p><a href=\"https://play.golang.org/p/g1778ZJOSYz\" rel=\"nofollow noreferrer\">(Go Playground)</a></p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 13, "user_id": 10524765, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jKLf3PtphdE/AAAAAAAAAAI/AAAAAAAAAHM/Lomne1KheNc/photo.jpg?sz=128", "display_name": "aman katotiya", "link": "https://stackoverflow.com/users/10524765/aman-katotiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "closed_date": 1575364826, "accepted_answer_id": 59152812, "answer_count": 2, "score": -2, "last_activity_date": 1575363021, "creation_date": 1575359625, "last_edit_date": 1575363021, "question_id": 59152432, "link": "https://stackoverflow.com/questions/59152432/difficulty-with-variadic-functions", "closed_reason": "Not suitable for this site", "title": "Difficulty with variadic functions", "body": "<p>From <em>An Introduction to Programming in Go</em>, page 91, Exercise Question no 4, Topic: Functions:</p>\n\n<p><em>Write a function with one variadic parameter that finds the greatest number in a list of numbers?</em></p>\n\n<p>So far I had written this code but it is showing errors</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc findMaximum(args ...[]int) []int {\n    max := args[0]\n    for _, v := range args {\n        if v &gt; []args {\n            max = v\n        }\n    }\n    return args\n}\n\nfunc main() {\n    x := []int{\n        48, 96, 86, 68,\n        57, 82, 63, 70,\n        37, 34, 83, 27,\n        19, 97, 9, 17,\n    }\n    fmt.Println(findMaximum(x))\n}\n</code></pre>\n\n<p>I had taken reference from this Program</p>\n\n<p>(Page, 75, Question No. - 4, Topic: Arrays, Slices and Maps)</p>\n\n<p><em>Write a program that finds the smallest number\nin this list:</em></p>\n\n<pre><code>x := []int{\n 48,96,86,68,\n 57,82,63,70,\n 37,34,83,27,\n 19,97, 9,17,\n}\n</code></pre>\n\n<p>This is the program I had written to solve this Question</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    arr := []uint{\n        48, 96, 86, 68,\n        57, 82, 63, 70,\n        37, 34, 83, 27,\n        19, 97, 9, 17,\n    }\n\n    min := arr[0] // assume first value is smallest\n\n    for _, value := range arr {\n        if value &lt; min {\n            min = value // found another value, replace previous value of min\n        }\n    }\n    fmt.Println(\"The smallest value is : \", min)\n}\n</code></pre>\n\n<p>This Question Program is running but the First one is not I don't know why.</p>\n"}, {"tags": ["go", "continuous-integration", "automated-tests", "grpc", "grpc-go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1575359869, "post_id": 59151894, "comment_id": 104529665, "body": "Excuse me, but you have all bits and pieces of information you need, now it is time to think. Code coverage is a sufficient proof that tests are written, and writing tests for an API (be it the server or the client) does not work any different than any other server/client test, so does the coverage identification - you test the user provided functions, not the framework code."}, {"owner": {"reputation": 1450, "user_id": 1335594, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4073d4e6b02ce29906b7d2429d1283c6?s=128&d=identicon&r=PG", "display_name": "Abhijeet Vaikar", "link": "https://stackoverflow.com/users/1335594/abhijeet-vaikar"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1588929474, "post_id": 59151894, "comment_id": 109094667, "body": "@MarkusWMahlberg Do you have any idea about how we can instrument a running instance of gRPC service to give code coverage?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1588945734, "post_id": 59151894, "comment_id": 109103081, "body": "A running instance? No, I have no idea. And I would not even know why, much less how."}, {"owner": {"reputation": 1450, "user_id": 1335594, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4073d4e6b02ce29906b7d2429d1283c6?s=128&d=identicon&r=PG", "display_name": "Abhijeet Vaikar", "link": "https://stackoverflow.com/users/1335594/abhijeet-vaikar"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1591155015, "post_id": 59151894, "comment_id": 109944804, "body": "@MarkusWMahlberg Do you mean that it&#39;s not ideal to identify code coverage for such tests? If yes, why not? What&#39;s the philosophy behind not doing so? this is a discussion I&#39;m also having with my peers and there&#39;s no conclusion."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1591166587, "post_id": 59151894, "comment_id": 109948167, "body": "There is no way to instrument a running instance for coverage. You simply write your code so that it can be tested with <code>go test</code>. For integration tests etc, you could use build tags. But unit tests and code coverage does not ensure tests. A PR in and of itself does not identify anything. What you&#39;d usually do is a CI-build on PR and have it fail on coverage that is too small. See <a href=\"https://stackoverflow.com/a/50123125/1296707\">stackoverflow.com/a/50123125/1296707</a>"}], "owner": {"reputation": 1450, "user_id": 1335594, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4073d4e6b02ce29906b7d2429d1283c6?s=128&d=identicon&r=PG", "display_name": "Abhijeet Vaikar", "link": "https://stackoverflow.com/users/1335594/abhijeet-vaikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575357314, "creation_date": 1575357314, "question_id": 59151894, "link": "https://stackoverflow.com/questions/59151894/finding-code-coverage-of-a-grpc-api-based-on-api-tests", "title": "Finding code coverage of a gRPC API based on API tests", "body": "<p><strong>Assumption</strong></p>\n\n<ul>\n<li>API tests are written in the same API code repository using GoLang</li>\n<li>API tests are run as part of the Pull Request CI build.</li>\n<li>An API test is basically starting gRPC server, making request from a golang based gRPC client and verifying the response</li>\n</ul>\n\n<p><strong>Flow</strong></p>\n\n<ol>\n<li>Dev starts building a new endpoint for an API</li>\n<li>Dev does not write any API tests (please note that I mention specifically API tests and not unit tests)</li>\n<li>Dev creates a Pull Request for the changes</li>\n<li>The Pull Request should identify that there are no tests written for the new changes and block the PR</li>\n</ol>\n\n<p><strong>My question</strong></p>\n\n<p>How could we build a CI flow like this to achieve point 4?\nI'm aware that code coverage is one way to go but I'm not fully convinced if that would be the correct approach for API tests?</p>\n\n<p>Is it possible to find code coverage of gRPC service based on such API tests? If yes, then how?</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1575360425, "post_id": 59151771, "comment_id": 104529893, "body": "&quot;They all seem to import with github.com/...&quot; That&#39;s no coincidence: <a href=\"https://golang.org/doc/code.html#ImportPaths\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#ImportPaths</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1575362871, "post_id": 59151771, "comment_id": 104530851, "body": "You cannot import files in Go, only packages. Please read <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">A Tour of Go</a>, in particular the part about <a href=\"https://tour.golang.org/basics/2\" rel=\"nofollow noreferrer\">imports</a>, and <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go</a>."}], "answers": [{"tags": [], "owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "is_accepted": false, "score": 0, "last_activity_date": 1577287082, "creation_date": 1577287082, "answer_id": 59479656, "question_id": 59151771, "link": "https://stackoverflow.com/questions/59151771/importing-pb-go-file-in-a-project/59479656#59479656", "title": "Importing pb.go file in a project", "body": "<p>One could do a <code>go mod init project</code> and subsequently import go files that reside in some folder, e.g. folder as:</p>\n\n<pre><code>import \"project/folder\"\n</code></pre>\n\n<p>I created several <a href=\"https://github.com/030\" rel=\"nofollow noreferrer\">github projects</a> that contain this structure, e.g. n3dr, bcbsn, go-yq, go-multipart and dip.</p>\n"}], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1105, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1577287082, "creation_date": 1575356743, "last_edit_date": 1577286757, "question_id": 59151771, "link": "https://stackoverflow.com/questions/59151771/importing-pb-go-file-in-a-project", "title": "Importing pb.go file in a project", "body": "<p>How can I import my generated <code>pb.go</code> file so I can call the methods in them? I visited all the examples for go and they all seem to import with <code>github.com/...</code></p>\n\n<p><strong>Example.go</strong></p>\n\n<pre><code>import (\n    \"github.com/go-chi/chi\"\n    chiMiddleware \"github.com/go-chi/chi/middleware\"\n    \"google.golang.org/grpc\"\n    \"net/http\"\n    \"github.com/easyCZ/grpc-web-hacker-news/server/hackernews\"\n    hackernews_pb \"github.com/easyCZ/grpc-web-hacker-news/server/proto\" // Proto directory.\n    \"google.golang.org/grpc/grpclog\"\n    \"github.com/improbable-eng/grpc-web/go/grpcweb\"\n    \"github.com/go-chi/cors\"\n    \"github.com/easyCZ/grpc-web-hacker-news/server/proxy\"\n    \"github.com/easyCZ/grpc-web-hacker-news/server/middleware\"\n)\n\nfunc main() {\n    grpcServer := grpc.NewServer()\n    hackernewsService := hackernews.NewHackerNewsService(nil)\n    hackernews_pb.RegisterHackerNewsServiceServer(grpcServer, hackernewsService)\n    ...\n\n</code></pre>\n\n<p><strong>Directory Structure</strong></p>\n\n<pre><code>\ud83d\udce6athena-server\n \u2523 \ud83d\udcc2proto\n \u2503 \u2523 \ud83d\udcdcathena.pb.go\n \u2503 \u2517 \ud83d\udcdcathena.proto\n \u2523 \ud83d\udcc2server\n \u2503 \u2517 \ud83d\udcdcserver.go\n \u2523 \ud83d\udcdc.DS_Store\n \u2523 \ud83d\udcdcdocker-compose.yml\n \u2523 \ud83d\udcdcgenerated.go\n \u2523 \ud83d\udcdcgo.mod\n \u2523 \ud83d\udcdcgo.sum\n \u2523 \ud83d\udcdcgoogle_service.json\n \u2523 \ud83d\udcdcgqlgen.yml\n \u2523 \ud83d\udcdcmodels_gen.go\n \u2523 \ud83d\udcdcresolver.go\n \u2523 \ud83d\udcdcschema.graphql\n \u2517 \ud83d\udcdctodo.go\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>import (\n    \"bytes\"\n    \"flag\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n\n    \"google.golang.org/grpc\"\n    \"google.golang.org/grpc/grpclog\"\n\n    \"github.com/improbable-eng/grpc-web/go/grpcweb\"\n\n    auth \"../proto\" // Proto directory but doesn't work.\n)\n...\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<pre><code>cannot find module for path _/Users/xxx/go/src/athena-server/proto\n</code></pre>\n\n<p>I tried all sort both absolute and relative path as well as shifting files around but nothing seems to work.</p>\n"}, {"tags": ["go", "testing"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1575352245, "post_id": 59150861, "comment_id": 104526927, "body": "Do not run the test using file name. Either cd under the package and run go test, or run go test &lt;full packageName&gt;."}, {"owner": {"reputation": 53, "user_id": 12389279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3100c67eb7442b536eb25e356e98af58?s=128&d=identicon&r=PG&f=1", "display_name": "Totto", "link": "https://stackoverflow.com/users/12389279/totto"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575353665, "post_id": 59150861, "comment_id": 104527363, "body": "@BurakSerdar see my update"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1575354276, "post_id": 59150861, "comment_id": 104527565, "body": "If it is complaining about import cycle, you&#39;re importing the same package. Don&#39;t do that. If you&#39;re using go modules, use full package path: go test moduleName/webhook. If not, use relative package dir: go test ./webhook. go test webhook tries to test a package named <code>webhook</code>, and since it does not have a hostname as first component, it assumes it is a stdlib package."}, {"owner": {"reputation": 53, "user_id": 12389279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3100c67eb7442b536eb25e356e98af58?s=128&d=identicon&r=PG&f=1", "display_name": "Totto", "link": "https://stackoverflow.com/users/12389279/totto"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575354359, "post_id": 59150861, "comment_id": 104527591, "body": "@BurakSerdar running <code>go test</code> from the directory of the package causes <code>import cycle not allowed in test</code>. Otherwise, <b>without this test with the private method</b>, it works. That is, this works if I don&#39;t use the test with the private method --&gt; <code>go test webhook&#47;webhook_test.go</code>"}, {"owner": {"reputation": 53, "user_id": 12389279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3100c67eb7442b536eb25e356e98af58?s=128&d=identicon&r=PG&f=1", "display_name": "Totto", "link": "https://stackoverflow.com/users/12389279/totto"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575354403, "post_id": 59150861, "comment_id": 104527601, "body": "@BurakSerdar - no. Read my last comment."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1575354740, "post_id": 59150861, "comment_id": 104527721, "body": "The <code>go</code> tool works on packages (there are some modes to work with files, but they are best avoided in most cases). If you cannot run a simple <code>go test</code> (e.g. because of an import cycle or because you misspelled your package in test) then your package setup is <b>broken</b> and <b>must</b> be fixed. No arguing here. Go <b>forbidds</b> import cycles and <b>requires</b> one of two package names in _test.go files."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1575354892, "post_id": 59150861, "comment_id": 104527764, "body": "If you want to test the exported boundary of some <code>package p</code> and have a p_test.go file declaring itself as <code>package p_test</code> then you <b>cannot</b> access unexported stuff from p. This is <i>by</i> <i>design</i> and <b>cannot</b> be circumvented by ugly tricks. Just stop doing this."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1575356606, "post_id": 59150861, "comment_id": 104528416, "body": "... See <a href=\"https://golang.org/cmd/go/#hdr-Relative_import_paths\" rel=\"nofollow noreferrer\">relative import paths</a> ... <i>&quot;a relative path can be used as a shorthand on the command line. If you are working in the directory containing the code imported as &quot;unicode&quot; and want to run the tests for &quot;unicode/utf8&quot;, you can type <code>&quot;go test .&#47;utf8&quot;</code> instead of needing to specify the full path.&quot;</i> But keep in mind what Volker said, for a file to be able to access an unexported identifier it must declare the same package as the file declaring the identifier."}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 53, "user_id": 12389279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3100c67eb7442b536eb25e356e98af58?s=128&d=identicon&r=PG&f=1", "display_name": "Totto", "link": "https://stackoverflow.com/users/12389279/totto"}, "edited": false, "score": 0, "creation_date": 1575356502, "post_id": 59150916, "comment_id": 104528371, "body": "@Totto Can you try <code>go test .&#47;webhook</code>? Do you have a <code>go.mod</code> file in your project?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1575356479, "last_edit_date": 1575356479, "creation_date": 1575352293, "answer_id": 59150916, "question_id": 59150861, "link": "https://stackoverflow.com/questions/59150861/cant-access-a-private-method-in-the-same-package-for-testing/59150916#59150916", "title": "Can&#39;t access a private method in the same package for testing", "body": "<p>Try  <code>go test ./my_package1</code> to force the compilation of the all package.<br>\nOr at least a <code>go build</code> first.</p>\n\n<p>The idea is to make sure <code>myFunc1()</code> was compiled before executing the test file.</p>\n\n<hr>\n\n<p>The \"<code>malformed module path</code>\" \"<code>missing dot in first path element</code>\" suggests a <a href=\"https://stackoverflow.com/a/58563894/6309\"><code>go mod</code> file is missing</a>:</p>\n\n<pre><code>cd /path/to/project\ngo mod init project\ngo test ./webhook\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 12389279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3100c67eb7442b536eb25e356e98af58?s=128&d=identicon&r=PG&f=1", "display_name": "Totto", "link": "https://stackoverflow.com/users/12389279/totto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1575382033, "creation_date": 1575352020, "last_edit_date": 1575382033, "question_id": 59150861, "link": "https://stackoverflow.com/questions/59150861/cant-access-a-private-method-in-the-same-package-for-testing", "title": "Can&#39;t access a private method in the same package for testing", "body": "<p>I have 2 files in the same package.</p>\n\n<pre><code># my_package1/my_file1.go\n\nfunc myFunc1() {\n  //....\n} \n\n# my_package1/my_file1_test.go\n\ntype MyPackageSuite struct {\n  suite.Suite\n}\n\nfunc (s *MyPackageSuite) MyTest1() {\n  //...............\n\n  res1 := myFunc1()\n\n  //...............\n} \n</code></pre>\n\n<p>I run a test <code>go test my_package1/my_file1_test.go -v</code> and it returns <code>undefined: myFunc1</code></p>\n\n<p>But they're in the same package. Why the error? How to fix it? Making the method public isn't what I'm looking for.</p>\n\n<p><strong>Update1</strong>:</p>\n\n<pre><code>$ ls webhook\ndoc.go      webhook.go  webhook_test.go\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>$ go test webhook\ncan't load package: package webhook: malformed module path \"webhook\": missing dot in first path element\n\n\n$ go test webhook/webhook\ncan't load package: package webhook/webhook: malformed module path \"webhook/webhook\": missing dot in first path element\n\n$ go test webhook/webhook.go\n?     command-line-arguments  [no test files]\n\n\n$ go test webhook/webhook_test.go \n# command-line-arguments [command-line-arguments.test]\nwebhook/webhook_test.go: undefined: myFunc1\nFAIL  command-line-arguments [build failed]\nFAIL\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 2, "creation_date": 1575343582, "post_id": 59149463, "comment_id": 104524942, "body": "Counter-question: how would you scan a nullable-string value from your database into the <code>string</code> type?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 2, "creation_date": 1575355685, "post_id": 59149463, "comment_id": 104528052, "body": "@LukeJoshuaPark with <code>sql.NullString</code> in Go or with <code>COALESCE</code> in SQL."}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 2, "last_activity_date": 1575346737, "creation_date": 1575346737, "answer_id": 59150140, "question_id": 59149463, "link": "https://stackoverflow.com/questions/59149463/scan-into-struct-with-pointers/59150140#59150140", "title": "Scan into struct with pointers", "body": "<p>Using a struct with pointers when scanning an unmarshaling is necessary if you need to distinguish between zero-values and null values. A string/int/struct will fail (or initialized to zero-value when unmarshaling) when the corresponding value is null, whereas a pointer to string/int/struct will be set to nil.</p>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1575373810, "last_edit_date": 1575373810, "creation_date": 1575347120, "answer_id": 59150174, "question_id": 59149463, "link": "https://stackoverflow.com/questions/59149463/scan-into-struct-with-pointers/59150174#59150174", "title": "Scan into struct with pointers", "body": "<p>As @Luke hinted, if you try to scan a row with null DB values into non-pointer types, the row-scan operation will result in an error.</p>\n\n<p>Best practice is to examine the schema of the DB table. If columns cannot have null-values, use a non-pointer. If a null is possible (however remote a possibility you may think) use a pointer.</p>\n\n<p>If you find pointers tedious to work with (i.e. boilerplate nil checks) use, say a, <a href=\"https://golang.org/pkg/database/sql/#NullString\" rel=\"nofollow noreferrer\">sql.NullString</a> for a column field. If a NULL is encountered during a row-scan, a <code>NullString</code> value will default to an empty string.</p>\n\n<p>Go 1.13 also added <a href=\"https://golang.org/pkg/database/sql/#NullTime\" rel=\"nofollow noreferrer\"><code>NullTime</code></a>\netc. to handle other Nullable column types.</p>\n"}], "owner": {"reputation": 125, "user_id": 11486149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b635c6d3bfebc8cf83606317a30e9581?s=128&d=identicon&r=PG&f=1", "display_name": "civ15", "link": "https://stackoverflow.com/users/11486149/civ15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 59150174, "answer_count": 2, "score": 1, "last_activity_date": 1575373810, "creation_date": 1575340763, "question_id": 59149463, "link": "https://stackoverflow.com/questions/59149463/scan-into-struct-with-pointers", "title": "Scan into struct with pointers", "body": "<p>What would be the benefit of using a struct like below with pointers instead of a struct without pointers when scanning from database?</p>\n\n<pre><code>  type User struct {\n      ID           *UserID    `json:\"id,omitempty\"`\n      Email        *string    `json:\"email\"`\n      Username     *string    `json:\"username\"`\n      PasswordHash *[]byte    `json:\"password_hash\"`\n      CreatedAt    *time.Time `json:\"created_at\"`\n    }\n</code></pre>\n"}, {"tags": ["azure", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575362788, "post_id": 59148581, "comment_id": 104530808, "body": "Requests for libraries or other third-party resources are off-topic."}], "answers": [{"tags": [], "owner": {"reputation": 183792, "user_id": 1749403, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/g0aFU.png?s=128&g=1", "display_name": "Sajeetharan", "link": "https://stackoverflow.com/users/1749403/sajeetharan"}, "is_accepted": false, "score": 1, "last_activity_date": 1575337423, "creation_date": 1575337423, "answer_id": 59149072, "question_id": 59148581, "link": "https://stackoverflow.com/questions/59148581/how-do-i-read-values-from-azure-app-configuration/59149072#59149072", "title": "How do I read values from Azure app configuration", "body": "<p>As I see there is a method available to get the app <a href=\"https://github.com/Azure-Samples/azure-sdk-for-go-samples/blob/master/web/web.go\" rel=\"nofollow noreferrer\"><code>configuration</code></a></p>\n\n<pre><code>func GetAppConfiguration(ctx context.Context, name string) (createdConfig web.SiteConfigResource, err error) {\n    client, err := getWebAppsClient()\n    if err != nil {\n        return\n    }\n    createdConfig, err = client.GetConfiguration(ctx, config.GroupName(), name)\n    return\n}\n</code></pre>\n\n<p>Else, You need to define it as an environment variable, i.e in your <a href=\"https://azure.microsoft.com/de-de/blog/running-go-applications-on-azure-app-service/\" rel=\"nofollow noreferrer\"><code>webconfig</code></a> as</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n    &lt;system.webServer&gt;\n        &lt;handlers&gt;\n            &lt;add name=\"httpplatformhandler\" path=\"*\" verb=\"*\" modules=\"httpPlatformHandler\" resourceType=\"Unspecified\" /&gt;\n        &lt;/handlers&gt;\n        &lt;!-- For Go webapp, we always generate azureapp.exe in wwwroot --&gt;\n        &lt;httpPlatform processPath=\"D:\\home\\site\\wwwroot\\azureapp.exe\" startupTimeLimit=\"60\"&gt;\n        &lt;/httpPlatform&gt;\n    &lt;/system.webServer&gt;\n&lt;/configuration&gt;\n</code></pre>\n"}], "owner": {"reputation": 12912, "user_id": 1110437, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/YVwiD.jpg?s=128&g=1", "display_name": "developer747", "link": "https://stackoverflow.com/users/1110437/developer747"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575362773, "creation_date": 1575332857, "last_edit_date": 1575362773, "question_id": 59148581, "link": "https://stackoverflow.com/questions/59148581/how-do-i-read-values-from-azure-app-configuration", "title": "How do I read values from Azure app configuration", "body": "<p>I want my Go app to read values from <a href=\"https://docs.microsoft.com/en-us/azure/azure-app-configuration/overview\" rel=\"nofollow noreferrer\">Azure App Configuration</a>.</p>\n\n<p>For my spring boot application I use</p>\n\n<pre><code>&lt;groupId&gt;com.microsoft.azure&lt;/groupId&gt;\n&lt;artifactId&gt;spring-cloud-starter-azure-appconfiguration-config&lt;/artifactId&gt;\n</code></pre>\n\n<p>I was wondering if there is some similar, easy to use library for Go?</p>\n"}, {"tags": ["rest", "go", "routing", "web-frameworks"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1575328605, "post_id": 59147492, "comment_id": 104521784, "body": "I believe you cannot mix dynamic segments with static ones. You can use either <code>&#47;resources&#47;otherroute</code> or <code>&#47;resources&#47;:id</code> but not both."}], "answers": [{"comments": [{"owner": {"reputation": 8387, "user_id": 3756168, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/xqUim.jpg?s=128&g=1", "display_name": "Badis Merabet", "link": "https://stackoverflow.com/users/3756168/badis-merabet"}, "edited": false, "score": 0, "creation_date": 1617444847, "post_id": 66901337, "comment_id": 118308258, "body": "It would work perfectly in express.js, but I can see that Gin doesn&#39;t have it yet. it could check for <code>&#47;resources&#47;otherroute</code> . if it doesn&#39;t match it put anything found inside <code>:id</code>. as long as it doesn&#39;t have more parts like: <code>&#47;resources&#47;:id&#47;sub-resources</code>"}, {"owner": {"reputation": 3277, "user_id": 672009, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/610b54d5481a46c3d8717d110b831fd4?s=128&d=identicon&r=PG", "display_name": "user672009", "link": "https://stackoverflow.com/users/672009/user672009"}, "reply_to_user": {"reputation": 8387, "user_id": 3756168, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/xqUim.jpg?s=128&g=1", "display_name": "Badis Merabet", "link": "https://stackoverflow.com/users/3756168/badis-merabet"}, "edited": false, "score": 0, "creation_date": 1617446494, "post_id": 66901337, "comment_id": 118308659, "body": "Yes, prioritizing the routes would make sense. But there might be a reason why it&#39;s not done. Either way, perhaps accept the answer or close to question :-)"}], "tags": [], "owner": {"reputation": 3277, "user_id": 672009, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/610b54d5481a46c3d8717d110b831fd4?s=128&d=identicon&r=PG", "display_name": "user672009", "link": "https://stackoverflow.com/users/672009/user672009"}, "is_accepted": false, "score": 0, "last_activity_date": 1617267070, "creation_date": 1617267070, "answer_id": 66901337, "question_id": 59147492, "link": "https://stackoverflow.com/questions/59147492/gin-error-panic-wildcard-route-conflicts-with-existing-children/66901337#66901337", "title": "Gin Error panic: wildcard route conflicts with existing children", "body": "<p>Gin can't distinguish <code>/resources/otherroute</code> from <code>/resources/:id</code> because <code>otherroute</code> can be interpreted as <code>:id</code> and therefor you have a conflict.</p>\n"}], "owner": {"reputation": 8387, "user_id": 3756168, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/xqUim.jpg?s=128&g=1", "display_name": "Badis Merabet", "link": "https://stackoverflow.com/users/3756168/badis-merabet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 579, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1617267070, "creation_date": 1575325162, "last_edit_date": 1575327851, "question_id": 59147492, "link": "https://stackoverflow.com/questions/59147492/gin-error-panic-wildcard-route-conflicts-with-existing-children", "title": "Gin Error panic: wildcard route conflicts with existing children", "body": "<p>I using <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">https://github.com/gin-gonic/gin</a> and I am trying to implement nested routes like this:</p>\n\n<pre><code>// SetupRouter initialize routes and handlers\nfunc SetupRouter() *gin.Engine {\n    r := gin.Default()\n\n    r.GET(\"/\", controllers.Welcome)\n\n    r.GET(\"/resources\", controllers.GetResources)   \n    r.GET(\"/resources/otherroute\", controllers.GetOResources)   \n    r.GET(\"/resources/:id\", controllers.GetResourcesByID)   \n    r.GET(\"/resources/:id/sub-resources\", GetSubResources)\n    r.GET(\"/resources/:id/sub-resources/:srid\", GetSubResourcesByID)\n    r.GET(\"/resources/:id/sub-resources/:srid/ssub-resources\", GetSSubResources)\n    r.GET(\"/resources/:id/sub-resources/:srid/ssub-resources/:ssrid\", GetSSubResourcesByID)\n\n    // .... etc.\n\n    return r\n}\n</code></pre>\n\n<p>but I am getting weird errors:</p>\n\n<pre><code>[GIN-debug] GET    /                         --&gt; github.com/badis/so-\n\ngin-nested-routes/controllers.Welcome (3 handlers)\n[GIN-debug] GET    /resources                --&gt; github.com/badis/so-gin-nested-routes/controllers.GetResources (3 handlers)\n[GIN-debug] GET    /resources/otherroute     --&gt; github.com/badis/so-gin-nested-routes/controllers.GetOResources (3 handlers)\n[GIN-debug] GET    /resources/:id            --&gt; github.com/badis/so-gin-nested-routes/controllers.GetResourcesByID (3 handlers)\npanic: wildcard route ':id' conflicts with existing children in path '/resources/:id'\n\ngoroutine 1 [running]:\ngithub.com/gin-gonic/gin.(*node).insertChild(0xc0002516c0, 0xc0001edc01, 0xc0002325eb, 0x3, 0xc0002325e0, 0xe, 0xc000224300, 0x3, 0x3)\n    /home/badis/go/src/github.com/gin-gonic/gin/tree.go:294 +0x807\ngithub.com/gin-gonic/gin.(*node).addRoute(0xc0002516c0, 0xc0002325e0, 0xe, 0xc000224300, 0x3, 0x3)\n    /home/badis/go/src/github.com/gin-gonic/gin/tree.go:255 +0x4ea\n</code></pre>\n\n<p>and I am not able to find a satisfying solution in or outside SO.</p>\n\n<p>If you want to reproduce issue quickly, take a look here: <a href=\"https://github.com/badis/so-question-gin-routes\" rel=\"nofollow noreferrer\">https://github.com/badis/so-question-gin-routes</a></p>\n"}, {"tags": ["go", "amazon-s3", "aws-sdk"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1575313844, "post_id": 59144826, "comment_id": 104516530, "body": "I&#39;m not convinced this even compiles. <code>s3.PutObjectInput.Key</code> is supposed to be of type <code>*string</code>, but you are assigning a <code>string</code>. <code>i don&#39;t have error</code> - where? No compilation error? <code>s.client.DeleteObject...</code> doesn&#39;t return an error?"}, {"owner": {"reputation": 1034, "user_id": 3176972, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mlKGV.png?s=128&g=1", "display_name": "SaroVin", "link": "https://stackoverflow.com/users/3176972/sarovin"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1575362098, "post_id": 59144826, "comment_id": 104530484, "body": "Yes, It compiles. I don&#39;t have compilation error and the code works fine, but if I try to delete a file uploaded with this code, it doesn&#39;t return an error but the file is not deleted from S3."}, {"owner": {"reputation": 2083, "user_id": 886625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4a7824e9258d3e731678ac8e9839859?s=128&d=identicon&r=PG", "display_name": "Snarf", "link": "https://stackoverflow.com/users/886625/snarf"}, "edited": false, "score": 0, "creation_date": 1575386324, "post_id": 59144826, "comment_id": 104544804, "body": "Seems like S3 doesn&#39;t actually delete the object right away. Your <code>DeleteObject(...)</code> call is probably succeeding but the object is just being &quot;marked&quot; for deletion and might take some extra time to be removed. I would log out the response (first return variable you&#39;re ignoring) to see what you get back. Read more here <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/s3/#S3.DeleteObject\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdk-for-go/api/service/s3/#S3.DeleteObje&zwnj;&#8203;ct</a>"}, {"owner": {"reputation": 1034, "user_id": 3176972, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mlKGV.png?s=128&g=1", "display_name": "SaroVin", "link": "https://stackoverflow.com/users/3176972/sarovin"}, "reply_to_user": {"reputation": 2083, "user_id": 886625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4a7824e9258d3e731678ac8e9839859?s=128&d=identicon&r=PG", "display_name": "Snarf", "link": "https://stackoverflow.com/users/886625/snarf"}, "edited": false, "score": 0, "creation_date": 1575473224, "post_id": 59144826, "comment_id": 104579821, "body": "Thanks @Snarf, I run a test..."}], "owner": {"reputation": 1034, "user_id": 3176972, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mlKGV.png?s=128&g=1", "display_name": "SaroVin", "link": "https://stackoverflow.com/users/3176972/sarovin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575311606, "creation_date": 1575311606, "question_id": 59144826, "link": "https://stackoverflow.com/questions/59144826/delete-object-from-s3-after-upload-with-sdk", "title": "Delete Object from S3 after Upload with SDK", "body": "<p>if I upload an object from dashboard, I can delete it with aws-sdk-go but if I upload with aws-sdk-go, I cannot delete object from AWS S3 and i don't have error.</p>\n\n<p>This is my bucket policy:</p>\n\n<pre><code>{\n    \"Version\": \"2008-10-17\",\n    \"Id\": \"PolicyForCloudFrontPrivateContent\",\n    \"Statement\": [\n        {\n            \"Sid\": \"1\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity ...\"\n            },\n            \"Action\": \"s3:GetObject\",\n            \"Resource\": \"arn:aws:s3:::storage.test.com/*\"\n        },\n        {\n            \"Sid\": \"2\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::361908204985:user/caio\"\n            },\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:PutObject\",\n                \"s3:PutObjectAcl\",\n                \"s3:DeleteObject\",\n                \"s3:DeleteObjectVersion\"\n            ],\n            \"Resource\": \"arn:aws:s3:::storage.test.com/*\"\n        }\n    ]\n}\n</code></pre>\n\n<p>I upload the file with this code:</p>\n\n<pre><code>_, err := s.client.PutObject(&amp;s3.PutObjectInput{\n    Body:          file,\n    Bucket:        s.bucket,\n    Key:           \"test/foo/a.png\",\n    ACL:           aws.String(\"private\"),\n})\n</code></pre>\n\n<p>and I delete the file with this code:</p>\n\n<pre><code>_, err := s.client.DeleteObject(&amp;s3.DeleteObjectInput{\n    Bucket: s.bucket,\n    Key:    aws.String(\"test/foo/a.png\"),\n})\n</code></pre>\n\n<p>Why delete action fail?</p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"comments": [{"owner": {"reputation": 671, "user_id": 445891, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/w7rWI.jpg?s=128&g=1", "display_name": "Mazdak", "link": "https://stackoverflow.com/users/445891/mazdak"}, "edited": false, "score": 1, "creation_date": 1575318032, "post_id": 59144528, "comment_id": 104518193, "body": "Thank you, just to make this work, I had to cast this to unit32, primitive.Timestamp{T:uint32(time.Now().Unix())} }. Otherwise, the compiler was giving me an error."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 3, "last_activity_date": 1575318212, "last_edit_date": 1575318212, "creation_date": 1575310328, "answer_id": 59144528, "question_id": 59144405, "link": "https://stackoverflow.com/questions/59144405/update-timestamp-field-in-mongodb-and-golang-driver/59144528#59144528", "title": "Update timestamp field in MongoDB and Golang Driver", "body": "<p>Try passing a timestamp instead of int64:</p>\n\n<pre><code>\"lastUpdate\": primitive.Timestamp{T:uint32(time.Now().Unix())}\n</code></pre>\n\n<p>Note that mongodb timestamp is unix seconds, not nanoseconds.</p>\n"}], "owner": {"reputation": 671, "user_id": 445891, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/w7rWI.jpg?s=128&g=1", "display_name": "Mazdak", "link": "https://stackoverflow.com/users/445891/mazdak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3192, "favorite_count": 0, "accepted_answer_id": 59144528, "answer_count": 1, "score": 3, "last_activity_date": 1589669257, "creation_date": 1575309777, "question_id": 59144405, "link": "https://stackoverflow.com/questions/59144405/update-timestamp-field-in-mongodb-and-golang-driver", "title": "Update timestamp field in MongoDB and Golang Driver", "body": "<p>I am using official MongoDb Driver for Golang. I have a field with timestamp type which I want to update from my Golang code.</p>\n\n<p>This is my struct (lastUpdate field is the timestamp field):</p>\n\n<pre><code>import (\n    \"context\"\n    \"log\"\n    \"time\"\n\n    \"go.mongodb.org/mongo-driver/bson\"\n    \"go.mongodb.org/mongo-driver/mongo\"\n    \"go.mongodb.org/mongo-driver/mongo/options\"\n    \"go.mongodb.org/mongo-driver/mongo/readpref\"\n    \"go.mongodb.org/mongo-driver/bson/primitive\"\n)\n\n\ntype MyStruct struct {\n    Id primitive.ObjectID  `json:\"id\" bson:\"_id,omitempty\"`\n    Name   string `json:\"name\"`\n    Alias  string `json:\"alias\"`\n    Signed bool   `json:\"signed\"`\n    Age int   `json:\"age\"`\n    CreatedDate time.Time   `json:\"createdDaate\"`\n    LastUpdate primitive.Timestamp `json:\"lastUpdate\"`\n}\n</code></pre>\n\n<p>Then I pass this bson to update my data:</p>\n\n<pre><code>    // logic to update data\n    docID, _ := primitive.ObjectIDFromHex(\"5de30185e4fabe4778f0ffdf\")\n\n    UpdateMyData(c, bson.M{\"createdDate\": time.Now(), \"lastUpdate\": time.Now().UnixNano() }, bson.M{\"_id\": docID})\n\n //update method\nfunc UpdateMyData(client *mongo.Client, updatedData bson.M, filter bson.M) int64 {\n    collection := client.Database(\"*****\").Collection(\"*****\")\n    atualizacao := bson.D{ {Key: \"$set\", Value: updatedData} }\n    updatedResult, err := collection.UpdateOne(context.TODO(), filter, atualizacao)\n    if err != nil {\n        log.Fatal(\"Error on updating one Hero\", err)\n    }\n    return updatedResult.ModifiedCount\n}\n</code></pre>\n\n<p>The content of UpdateMyData method is fine cause it simply accepts bson and call UpdateOne method to update data into database and works for all different fields I have properly.</p>\n\n<p>The problem is <em>time.Now().UnixNane()</em> returning <em>int64</em> value, the above code does not throw an error, but it changes the \"type\" of <strong>lastUpdated</strong> to <em>Int64</em> inside my MongoDb database for that specific row! So what is the correct way of passing data into timestamp field, without changing its type?</p>\n"}, {"tags": ["go", "bitbucket", "amazon-elastic-beanstalk", "go-modules"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1575308814, "post_id": 59144120, "comment_id": 104514434, "body": "<code>$GOPATH&#47;go.mod</code> should not exist, in fact there should be no files in the top level of <code>GOPATH</code>. What are you trying to do exactly? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, not just some of the log output."}], "answers": [{"tags": [], "owner": {"reputation": 908, "user_id": 3649496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c95010d46812ccabe7eea947a090ab?s=128&d=identicon&r=PG&f=1", "display_name": "infiniteLearner", "link": "https://stackoverflow.com/users/3649496/infinitelearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1587120980, "last_edit_date": 1587120980, "creation_date": 1587120432, "answer_id": 61269761, "question_id": 59144120, "link": "https://stackoverflow.com/questions/59144120/gopath-go-mod-exists-but-should-not-in-aws-elastic-beanstalk/61269761#61269761", "title": "$GOPATH/go.mod exists but should not in AWS Elastic Beanstalk", "body": "<p>May be this can help you. </p>\n\n<p>It looks like you have GOPATH=. and you are copying the module into that same place. The go get has the effect of creating ./src/golang.org/x/vgo, and then the COPY creates ./go.mod, so that it looks like the GOPATH's downloaded source lives inside the module. That in turn makes it look like src/golang.org/x/vgo is part of the project you are working on, and vgo gets very confused by its own (unsupported) use of vendoring.</p>\n\n<p><strong><em>Original post reference:</em></strong> <a href=\"https://github.com/golang/go/issues/24106\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><strong><em>Additional source :</em></strong> <a href=\"https://intellij-support.jetbrains.com/hc/en-us/community/posts/360003369739-Can-t-run-golang-program\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 5455, "user_id": 703529, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh3.googleusercontent.com/-G-kFsAfpLpU/AAAAAAAAAAI/AAAAAAAAAJE/8uMPWwMFaD0/photo.jpg?sz=128", "display_name": "serkan", "link": "https://stackoverflow.com/users/703529/serkan"}, "is_accepted": false, "score": 19, "last_activity_date": 1599070046, "last_edit_date": 1599070046, "creation_date": 1590661889, "answer_id": 62062562, "question_id": 59144120, "link": "https://stackoverflow.com/questions/59144120/gopath-go-mod-exists-but-should-not-in-aws-elastic-beanstalk/62062562#62062562", "title": "$GOPATH/go.mod exists but should not in AWS Elastic Beanstalk", "body": "<p>When <code>GOPATH</code> is set <code>go get</code> installs the requested module to the path provided in <code>GOPATH</code> but if you use <code>.mod</code> file, it uses the working directory.</p>\n<p>Your case, you have both <code>GOPATH</code> set and have the <code>.mod</code> file.</p>\n<p>You can <code>unset</code> GOPATH like:</p>\n<pre><code>unset GOPATH\n</code></pre>\n<p>It should solve your problem. Or, you can delete <code>.mod</code> file too.</p>\n"}], "owner": {"reputation": 615, "user_id": 1320479, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/jv5KS.png?s=128&g=1", "display_name": "NiBE", "link": "https://stackoverflow.com/users/1320479/nibe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16574, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1599070046, "creation_date": 1575308542, "last_edit_date": 1575655975, "question_id": 59144120, "link": "https://stackoverflow.com/questions/59144120/gopath-go-mod-exists-but-should-not-in-aws-elastic-beanstalk", "title": "$GOPATH/go.mod exists but should not in AWS Elastic Beanstalk", "body": "<p>I'm trying to deploy a golang app based on gin framework using bitbucket pipeline and AWS Elastic Beanstalk. I create my package application.zip with all the files needed to deploy the app inside an EB, when I push it, both by pipeline or by manual menu in AWS console I got these:</p>\n\n<pre><code>17:21:49 make.1 | go: finding github.com/appleboy/gin-jwt v2.5.0+incompatible\n  17:21:49 make.1 | go: downloading github.com/appleboy/gin-jwt v2.5.0+incompatible\n  17:21:49 make.1 | go: extracting github.com/appleboy/gin-jwt v2.5.0+incompatible\n  17:21:50 make.1 | go: finding gopkg.in/dgrijalva/jwt-go.v3 v3.2.0\n  17:21:50 make.1 | go: downloading gopkg.in/dgrijalva/jwt-go.v3 v3.2.0\n  17:21:50 make.1 | go: extracting gopkg.in/dgrijalva/jwt-go.v3 v3.2.0\n  17:21:50 make.1 | + GOOS=linux\n  17:21:50 make.1 | + GOARCH=amd64\n  17:21:50 make.1 | + go build -o bin/application '-ldflags=-s -w'\n  17:21:50 make.1 | go: cannot find main module; see 'go help modules'\n  17:21:50 make.1 | exited with code 1\n  17:21:50 system | sending SIGTERM to all processes\n</code></pre>\n\n<p>I see I forgot the go.mod file, indeed adding it then I got these message and everything works great:</p>\n\n<pre><code>  17:27:59 make.1 | go: extracting github.com/appleboy/gin-jwt v2.5.0+incompatible\n  17:27:59 make.1 | go: downloading gopkg.in/dgrijalva/jwt-go.v3 v3.2.0\n  17:27:59 make.1 | go: extracting gopkg.in/dgrijalva/jwt-go.v3 v3.2.0\n  17:27:59 make.1 | go: finding gopkg.in/dgrijalva/jwt-go.v3 v3.2.0\n  17:27:59 make.1 | + GOOS=linux\n  17:27:59 make.1 | + GOARCH=amd64\n  17:27:59 make.1 | + go build -o bin/application '-ldflags=-s -w'\n  17:27:59 make.1 | go: downloading golang.org/x/crypto v0.0.0-20190325154230-a5d413f7728c\n  17:28:00 make.1 | go: extracting golang.org/x/crypto v0.0.0-20190325154230-a5d413f7728c\n  17:28:00 make.1 | go: finding golang.org/x/crypto v0.0.0-20190325154230-a5d413f7728c\n  17:28:01 make.1 | exited with code 0\n  17:28:01 system | sending SIGTERM to all processes\n</code></pre>\n\n<p>But then while working I made some changes in my code, and I commit again, thinking that now everything is fine but I got these logs line:</p>\n\n<pre><code>  Executing: HOME=/tmp /opt/elasticbeanstalk/lib/ruby/bin/ruby /opt/elasticbeanstalk/lib/ruby/bin/foreman start --procfile /tmp/d20191202-5748-15rj5l8/eb-buildtask-0 --root /var/app/staging --env /var/elasticbeanstalk/staging/elasticbeanstalk.env\n  17:32:00 make.1 | started with pid 5761\n  17:32:00 make.1 | + go get github.com/gin-gonic/gin\n  17:32:00 make.1 | $GOPATH/go.mod exists but should not\n  17:32:00 make.1 | exited with code 1\n  17:32:00 system | sending SIGTERM to all processes\n</code></pre>\n\n<p>And now I'm lost about <strong>$GOPATH/go.mod exists but should not</strong> I'm using last Go vesion 1.13.4, and AWS uses 1.13.2.</p>\n\n<p><strong>MORE INFO</strong></p>\n\n<p>I'll try to be more precise about the project, sorry if the logs is not enough.\nI have a simple application with gorm + gin, it's basically a REST API server.\nthe structure of my project is like this:</p>\n\n<p>/go/src/company.com/project</p>\n\n<p>Inside I have these files and folders:</p>\n\n<pre><code>application.go\ngo.mod\nController/dashboardController.go\nModel/user.go\nService/utility.go\nBuildFile\nProcfile\n</code></pre>\n\n<p>Last two files are used to let the EB build the project once is uploaded in the S3.\nOf course locally everything works just fine, as well as the first time I upload the complete project with go.mod included, see the second bunch of logs. But when I amend a file, and I pack the application again and send it to EB, both via bitbucket piple or aws console, it doesn't matter, I got the error.</p>\n\n<p><strong>SOLUTION</strong></p>\n\n<p>After a lot of headhache I decide to log into ElasticBeanstalk via ssh, and I found that if I add to my build.sh script the line below than all the problems go away:</p>\n\n<pre><code>sudo rm /var/app/current/go.*\n</code></pre>\n\n<p>My build.sh file at the end is like this:</p>\n\n<pre><code>#!/usr/bin/env bash\n# Stops the process if something fails\nset -xe\ntouch /var/app/current/go.bak\nsudo rm /var/app/current/go.*\n\n# get all of the dependencies needed\ngo get \"github.com/gin-gonic/gin\"\ngo get \"github.com/jinzhu/gorm\"\ngo get \"github.com/jinzhu/gorm/dialects/postgres\"\ngo get \"github.com/appleboy/gin-jwt\"\n\n# create the application binary that eb uses\nGOOS=linux GOARCH=amd64 go build -o bin/application -ldflags=\"-s -w\"\n</code></pre>\n"}, {"tags": ["debugging", "go", "command-line", "visual-studio-code", "arguments"], "comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575301362, "post_id": 59142164, "comment_id": 104510960, "body": "I tested your code and it works for me. I get the value true with vscode debugger."}, {"owner": {"reputation": 21, "user_id": 11859954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba09d38a9f40ea8ba635e1c8afb036a4?s=128&d=identicon&r=PG&f=1", "display_name": "Dave_J", "link": "https://stackoverflow.com/users/11859954/dave-j"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575301946, "post_id": 59142164, "comment_id": 104511280, "body": "Very strange.  I am using a Mac (osX).  I don&#39;t know why it is not working."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575302230, "post_id": 59142164, "comment_id": 104511421, "body": "I\u2019ve tested it on a linux computer. I don\u2019t have a mac around to test it."}, {"owner": {"reputation": 21, "user_id": 11859954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba09d38a9f40ea8ba635e1c8afb036a4?s=128&d=identicon&r=PG&f=1", "display_name": "Dave_J", "link": "https://stackoverflow.com/users/11859954/dave-j"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575303580, "post_id": 59142164, "comment_id": 104512131, "body": "I just added &quot;trace&quot;: &quot;log&quot; to the launch file and it does not output anything new.  I suspect my setup is not running the launch.json file"}, {"owner": {"reputation": 21, "user_id": 11859954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba09d38a9f40ea8ba635e1c8afb036a4?s=128&d=identicon&r=PG&f=1", "display_name": "Dave_J", "link": "https://stackoverflow.com/users/11859954/dave-j"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575305133, "post_id": 59142164, "comment_id": 104512899, "body": "I am not sure what happened (I did close down VSCode and reopened it) but it started working.  The trace:log file also started working."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575308929, "post_id": 59142164, "comment_id": 104514483, "body": "I experienced similar things too. It looks like restarting vscode when we see something unexpected is the first thing to do. Good to see you solved your problem."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 2155244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314152568dca24101562b91fd3efbf50?s=128&d=identicon&r=PG", "display_name": "nettm", "link": "https://stackoverflow.com/users/2155244/nettm"}, "is_accepted": false, "score": 3, "last_activity_date": 1597474666, "creation_date": 1597474666, "answer_id": 63423450, "question_id": 59142164, "link": "https://stackoverflow.com/questions/59142164/how-to-pass-command-line-arguments-in-debug-mode-in-vscode-with-golang/63423450#63423450", "title": "How to pass command-line arguments in debug mode in VSCode with golang", "body": "<p>list all params, for example,\ncommand is:</p>\n<pre><code>&quot;hello.exe -in InfoEntity.java -out aa.out&quot;\n</code></pre>\n<p>the debug config is:</p>\n<pre><code>{\n    &quot;version&quot;: &quot;0.2.0&quot;,\n    &quot;configurations&quot;: [\n        {\n            &quot;name&quot;: &quot;Launch&quot;,\n            &quot;type&quot;: &quot;go&quot;,\n            &quot;request&quot;: &quot;launch&quot;,\n            &quot;mode&quot;: &quot;auto&quot;,\n            &quot;program&quot;: &quot;${fileDirname}&quot;,\n            &quot;env&quot;: {},\n            &quot;args&quot;: [&quot;-in&quot;, &quot;InfoEntity.java&quot;, &quot;-out&quot;, &quot;aa.out&quot;]\n        }\n    ]\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11859954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba09d38a9f40ea8ba635e1c8afb036a4?s=128&d=identicon&r=PG&f=1", "display_name": "Dave_J", "link": "https://stackoverflow.com/users/11859954/dave-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3002, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1597474666, "creation_date": 1575300913, "last_edit_date": 1592644375, "question_id": 59142164, "link": "https://stackoverflow.com/questions/59142164/how-to-pass-command-line-arguments-in-debug-mode-in-vscode-with-golang", "title": "How to pass command-line arguments in debug mode in VSCode with golang", "body": "<p>I am having difficulty in passing command-line arguments in VSCode (debug mode) with golang.</p>\n<p>Below is the small code example and the launch.json:</p>\n<pre><code>package main\n\nimport (\n    &quot;flag&quot;\n    &quot;fmt&quot;\n)\n\nfunc main() {\n    flag1Ptr := flag.Bool(&quot;flag1&quot;, false, &quot;flag1 is a flag&quot;)\n    flag.Parse()\n    fmt.Println(*flag1Ptr)\n    fmt.Println(&quot;Hello, world&quot;)\n}\n</code></pre>\n<pre><code>{\n    &quot;version&quot;: &quot;0.2.0&quot;,\n    &quot;configurations&quot;: [\n        {\n            &quot;name&quot;: &quot;Launch&quot;,\n            &quot;type&quot;: &quot;go&quot;,\n            &quot;request&quot;: &quot;launch&quot;,\n            &quot;mode&quot;: &quot;auto&quot;,\n            &quot;program&quot;: &quot;${fileDirname}&quot;,\n            &quot;env&quot;: {},\n            &quot;args&quot;: [\n                &quot;-flag1&quot;\n            ]\n        }\n    ]\n}\n</code></pre>\n<blockquote>\n<p>The output is always &quot;false&quot; for *flag1Ptr but it should be &quot;true&quot;.</p>\n<p>Update: The issue disappeared after closing down VSCode and reopening it (I am on a Mac(osX))</p>\n</blockquote>\n"}, {"tags": ["go", "aws-lambda", "amazon-dynamodb", "aws-sdk-go"], "answers": [{"comments": [{"owner": {"reputation": 1159, "user_id": 666397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097ee41669d9e37f526dfcf396a632b0?s=128&d=identicon&r=PG", "display_name": "Atifm", "link": "https://stackoverflow.com/users/666397/atifm"}, "edited": false, "score": 0, "creation_date": 1585069660, "post_id": 59141221, "comment_id": 107634489, "body": "This should be the approved answer, the fields need to be exported, so start with a capitol letter."}], "tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 5, "last_activity_date": 1575297679, "creation_date": 1575297679, "answer_id": 59141221, "question_id": 59140779, "link": "https://stackoverflow.com/questions/59140779/dynamodbattribute-marshalmap-returns-empty-map/59141221#59141221", "title": "dynamodbattribute.MarshalMap returns empty map", "body": "<p>The fields in struct starts with Capital letter is only exported and can be used in outside of this package.</p>\n\n<p>Can you try with this struct and see if that works ?</p>\n\n<pre><code>type Item struct {\n    FruitID   int\n    FruitName string\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 12468773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZQ-iqVhS_aU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbb1wCUMc2AuHqLGTfvdmVY5eAgQ/photo.jpg?sz=128", "display_name": "Andrew Mills", "link": "https://stackoverflow.com/users/12468773/andrew-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1575297679, "creation_date": 1575296207, "last_edit_date": 1575297093, "question_id": 59140779, "link": "https://stackoverflow.com/questions/59140779/dynamodbattribute-marshalmap-returns-empty-map", "title": "dynamodbattribute.MarshalMap returns empty map", "body": "<p>I'm attempting to write a really simple Go function to insert an entry into a DynamoDB table. </p>\n\n<p>I'm following the tutorial provided on the AWS Documentation site, but for some reason, the function <em>dynamodbattribute.MarshalMap</em> is returning an empty map. </p>\n\n<p>The code compiles and runs, but breaks when attempting to insert the record as it can't find the required keys in the map. A little println action shows that the map is empty, even though the struct it's created from isn't.</p>\n\n<p>Any help is appreciated!</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n\n    \"github.com/aws/aws-lambda-go/lambda\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/dynamodb\"\n    \"github.com/aws/aws-sdk-go/service/dynamodb/dynamodbattribute\"\n)\n\n// Item Struct for Fruit Item\ntype Item struct {\n    fruitID   int\n    fruitName string\n}\n\n/*HandleRequest handles the lambda request.*/\nfunc HandleRequest(ctx context.Context) (string, error) {\n    // Initialize a session that the SDK will use to load\n    // credentials from the shared credentials file ~/.aws/credentials\n    // and region from the shared configuration file ~/.aws/config.\n    sess := session.Must(session.NewSessionWithOptions(session.Options{\n        SharedConfigState: session.SharedConfigEnable,\n    }))\n\n    // Create DynamoDB client\n    svc := dynamodb.New(sess)\n\n    item := Item{\n        fruitID:   2,\n        fruitName: \"Orange\",\n    }\n\n    fmt.Println(item)\n\n    av, err := dynamodbattribute.MarshalMap(item)\n    if err != nil {\n        fmt.Println(\"Got error marshalling new fruit item: \")\n        fmt.Println(err.Error())\n        return \"\", err\n    }\n\n    fmt.Println(\"av: \", av)\n    fmt.Println(\"ln: \", len(av))\n    fmt.Println(\"KEY VALUE PAIRS::\")\n    for key, value := range av {\n        fmt.Println(\"Key:\", key, \"Value:\", value)\n    }\n\n    tableName := \"fruits\"\n\n    input := &amp;dynamodb.PutItemInput{\n        Item:      av,\n        TableName: aws.String(tableName),\n    }\n\n    _, err = svc.PutItem(input)\n    if err != nil {\n        fmt.Println(\"Got error inserting new fruit item: \")\n        fmt.Println(err.Error())\n        return \"\", err\n    }\n\n    return \"SUCCESS!\", nil\n}\n\nfunc main() {\n    lambda.Start(HandleRequest)\n}\n</code></pre>\n\n<p><em>Log output from Lambda</em></p>\n\n<pre><code>START RequestId: 82f120d9-6bba-40d9-9204-136d491dbb88 Version: $LATEST\n{2 Orange}\nav:  map[]\nln:  0\nKEY VALUE PAIRS::\nGot error inserting new fruit item: \nValidationException: One or more parameter values were invalid: Missing the key fruitId in the item\n    status code: 400, request id: QUJG8R8EHPO65O1JFVI98PRQ1VVV4KQNSO5AEMVJF66Q9ASUAAJG\nValidationException: One or more parameter values were invalid: Missing the key fruitId in the item\n    status code: 400, request id: QUJG8R8EHPO65O1JFVI98PRQ1VVV4KQNSO5AEMVJF66Q9ASUAAJG: requestError\nnull\nEND RequestId: 82f120d9-6bba-40d9-9204-136d491dbb88\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 436, "user_id": 1638158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlmL8.jpg?s=128&g=1", "display_name": "John Dowling", "link": "https://stackoverflow.com/users/1638158/john-dowling"}, "edited": false, "score": 0, "creation_date": 1575296235, "post_id": 59140665, "comment_id": 104508188, "body": "Please forgive me if I have missunderstood the question but I think you just need to make them references to real objects, like this &quot;codes := []*Code{&amp;test}&quot;"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 5, "creation_date": 1575296277, "post_id": 59140665, "comment_id": 104508207, "body": "Please see Gotchas in <a href=\"https://github.com/golang/go/wiki/Range\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Range</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1575296519, "post_id": 59140665, "comment_id": 104508340, "body": "A variant of <a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow noreferrer\">golang.org/doc/faq#closures_and_goroutines</a>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1575298797, "post_id": 59140665, "comment_id": 104509570, "body": "That&#39;s easy: your slice contains values of type <code>Code</code> as its elements. On each iteration, the <code>code</code> variable gets assigned <i>a value</i> of the current element: that is, <code>code</code> receives a copy of the memory block of the value of the current element. You then modify that copy in <code>code</code>, do not copy that value back into the element and so when the value in <code>code</code> gets overwritten by the value of the next element on the next iteration, the changes are lost."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1575299001, "post_id": 59140665, "comment_id": 104509685, "body": "There are two approaches to dealing with the problem: 1) after modification, copy the value in <code>code</code> back into <code>codes[i]</code>. 2) store pointers to <code>Code</code> in the slice, and not <code>Code</code> values directly. This will make <code>code</code> receive a pointer to a <code>Code</code> variable (kept in memory somewhere off the slice), and so both the element and the <code>code</code> variable would refer to that same memory block, and all modification done through the pointer in <code>code</code> will naturally be &quot;seen&quot; via the (same) pointer kept in the element."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1575299043, "post_id": 59140665, "comment_id": 104509709, "body": "Note that this might create extra load on GC and perform a bit more poorly when you need to quickly scan the whole slice and process its elements (you won&#39;t notice this unless this code lies on a really hot path though)."}], "answers": [{"tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": false, "score": 1, "last_activity_date": 1575302065, "creation_date": 1575302065, "answer_id": 59142470, "question_id": 59140665, "link": "https://stackoverflow.com/questions/59140665/for-with-a-struct-variable-update/59142470#59142470", "title": "For with a struct (Variable update)", "body": "<p>The instruction <code>codes := []Code{test}</code> makes a <strong>copy</strong> of <code>test</code> in <code>codes</code>. This copy has the value 0 in <code>Number</code>.</p>\n\n<p>In the for loop, the range instruction makes another copy of the <code>codes[0]</code> struct into <code>code</code>. You increment <code>code.Number</code>, but <code>codes[0].Number</code> is left unmodified. Incrementing <code>test.Number</code> does not affect <code>codes</code> and <code>code</code>. </p>\n"}], "owner": {"reputation": 1, "user_id": 12033743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD5wcLvc9pXFYJhF4L0VNHjhbco77SierraS0c=k-s128", "display_name": "Akerces", "link": "https://stackoverflow.com/users/12033743/akerces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1575302065, "creation_date": 1575295867, "last_edit_date": 1575301244, "question_id": 59140665, "link": "https://stackoverflow.com/questions/59140665/for-with-a-struct-variable-update", "title": "For with a struct (Variable update)", "body": "<p>Here is an example of a piece of code that I'm trying to use in my program:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Code struct {\n    Name   string\n    Alias  string\n    Number int\n}\n\nfunc main() {\n\n    test := Code{\n        Name:   \"test\",\n        Alias:  \"test\",\n        Number: 0,\n    }\n    codes := []Code{test}\n\n    for {\n        //Other instructions\n        for _, code := range codes {\n            code.Number++ // code.Number is incremented but just inside this loop\n            test.Number++\n\n            fmt.Println(code.Number)\n            fmt.Println(test.Number) // test.Number is incremented\n        }\n        fmt.Println(test.Number) // test.Number is incremented\n        //Other instructions\n        time.Sleep(5 * time.Second)\n    }\n}\n</code></pre>\n\n<p>However, every time I come back in my instructions </p>\n\n<pre><code>for _, code := range codes\n</code></pre>\n\n<p>the value <code>code.Number</code> returns to 0 whereas <code>test.Number</code> is well incremented even outside this loop.</p>\n\n<p>I would like to update the value of my struct in the loop and get this new value at each loop turn.</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1575296176, "post_id": 59140618, "comment_id": 104508166, "body": "&quot;It&#39;s not very predictable to know whether the underlying original array is getting mutated or whether its the copy of the original array that is getting mutated when slices are passed around&quot; - what about it is unpredictable exactly? What specifically are you finding confusing?"}, {"owner": {"reputation": 2330, "user_id": 2708169, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/100002659380732/picture?type=large", "display_name": "Faiz Halde", "link": "https://stackoverflow.com/users/2708169/faiz-halde"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575296556, "post_id": 59140618, "comment_id": 104508352, "body": "maybe i can be totally wrong about the usage of slice, but given a slice, mutation happens on the original array until the array gets copied. Once its capacity is reached, the original array doesn&#39;t get mutated. wouldn&#39;t that be confusing? @Adrian"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1575297260, "post_id": 59140618, "comment_id": 104508726, "body": "The function&#39;s documentation should specify what it does with its arguments if it is of any relevance to the caller. What it does not specify is basically undefined behavior and the caller should not rely on behavior that is undefined."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575301296, "post_id": 59140618, "comment_id": 104510927, "body": "<code>append</code> returns a slice because it might append to the same slice or it might have to allocate a new slice if there is not sufficient capacity. That is how append works, and therefore how you should assume it will behave - that it might return the same slice or a new slice."}], "answers": [{"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": true, "score": 2, "last_activity_date": 1575332250, "last_edit_date": 1575332250, "creation_date": 1575318728, "answer_id": 59146257, "question_id": 59140618, "link": "https://stackoverflow.com/questions/59140618/go-slices-mutation-best-practices/59146257#59146257", "title": "Go slices mutation best practices", "body": "<p>If a function really does modify a slice's underlying array in place, and <em>promises</em> that it <em>always</em> modifies the underlying array in place, that function should in general take the slice argument by value and not return an updated slice:<sup>1</sup></p>\n\n<pre><code>// Mutate() modifies (the backing array of) s in place to achieve $result.\n// See below for why it returns an int.\nfunc Mutate(s []T) int {\n    // code\n}\n</code></pre>\n\n<p>If a function <em>may</em> modify the underlying array in place but <em>may</em> return a slice that uses a new array, the function should return a new slice value, or take a pointer to a slice:</p>\n\n<pre><code>// Replace() operates on a slice of T, but may return a totally new\n// slice of T.\nfunc Replace(s []T) []T {\n    // code\n}\n</code></pre>\n\n<p>When this function returns, you should assume that the underlying array, if you have hold of it, may or may not be in use:</p>\n\n<pre><code>func callsReplace() {\n    var arr [10]T\n    s := Replace(arr[:])\n    // From here on, do not use variable arr directly as\n    // we don't know if it is s's backing array, or not.\n\n    // more code\n}\n</code></pre>\n\n<p>But <code>Mutate()</code> promises to modify the array in place.  Note that <code>Mutate</code> will often need to return the number of array elements actually updated:</p>\n\n<pre><code>func callsMutate() {\n    var arr [10]T\n    n := Mutate(arr[:])\n    // now work with arr[0] through arr[n]\n\n    // more code\n}\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup>Of course, it could take a pointer to the array object, and modify the array in place, but that's less flexible since the array size is then baked in to the type.</p>\n"}], "owner": {"reputation": 2330, "user_id": 2708169, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/100002659380732/picture?type=large", "display_name": "Faiz Halde", "link": "https://stackoverflow.com/users/2708169/faiz-halde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 59146257, "answer_count": 1, "score": -3, "last_activity_date": 1575332250, "creation_date": 1575295726, "question_id": 59140618, "link": "https://stackoverflow.com/questions/59140618/go-slices-mutation-best-practices", "title": "Go slices mutation best practices", "body": "<p>It's not very predictable to know whether the underlying original array is getting mutated or whether its the copy of the original array that is getting mutated when slices are passed around</p>\n\n<pre><code>a = [3]int {0, 1, 2}\ns = a[:]\ns[0] = 10\na[0] == s[0] // true\n\n\ns = append(s, 3)\ns[0] = 20\na[0] == s[0] // false\n</code></pre>\n\n<p>Let' say today I had a processing of this kind</p>\n\n<pre><code>a = [3]int {0, 1, 2}\ns = some_func(a[:]) // returns slice\nprocess(s) // a is getting mutated because so far some_func hasn't caused the underlying array to be copied\n</code></pre>\n\n<p>and now tomorrow</p>\n\n<pre><code>a = [3]int {0, 1, 2}\ns = some_func(a[:]) // returns slice, does append operations\nprocess(s) // a is not getting mutated because some_func caused the underlying array to be copied\n</code></pre>\n\n<p>What are the best practices for slices then?</p>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575292594, "post_id": 59139403, "comment_id": 104506203, "body": "This code doesn&#39;t look portable. What are you doing with the <code>loghandle</code> and the <code>logdevid</code> ?"}, {"owner": {"reputation": 329, "user_id": 4587596, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1d7d8d6b5bad6cc00a0c7f3219cd478e?s=128&d=identicon&r=PG&f=1", "display_name": "Rednam Nagendra", "link": "https://stackoverflow.com/users/4587596/rednam-nagendra"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575293483, "post_id": 59139403, "comment_id": 104506691, "body": "updated above (in the question)"}], "owner": {"reputation": 329, "user_id": 4587596, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1d7d8d6b5bad6cc00a0c7f3219cd478e?s=128&d=identicon&r=PG&f=1", "display_name": "Rednam Nagendra", "link": "https://stackoverflow.com/users/4587596/rednam-nagendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575293455, "creation_date": 1575291494, "last_edit_date": 1575293455, "question_id": 59139403, "link": "https://stackoverflow.com/questions/59139403/what-are-equal-api-for-syscall-stringtoutf16-syscall-createfile-and-syscall-dev", "title": "What are equal API for syscall.StringToUTF16, syscall.CreateFile and syscall.DeviceIoControl in mac", "body": "<p>I have the following Go code in Windows, and I want to port it to Mac. \nWhat are equal API for  syscall.StringToUTF16, syscall.CreateFile in Mac?</p>\n\n<pre><code>import (\n        \"syscall\"\n        \"unsafe\"\n\n        \"github.com/golang/glog\" )\nimport \"C\"\nconst loggerDeviceName string = `\\\\.\\Global\\DGAPIMon`\n\nvar (\n        loghandle syscall.Handle\n        logdevid  uint32 )\n\n\nfunc InitLogger() (err error) {\n        // Setup the device id for the logger ioctl\n        deviceType := 0x00008307 \n        access := 0\n        function := 0x72 // LOG STRING\n        method := 0\n        logdevid = uint32(((deviceType) &lt;&lt; 16) | ((access) &lt;&lt; 14) | ((function) &lt;&lt; 2) | (method))\n\n        devPath := syscall.StringToUTF16(loggerDeviceName)\n        loghandle, err = syscall.CreateFile(&amp;devPath[0], syscall.GENERIC_READ|syscall.GENERIC_WRITE,\n                0, nil, syscall.OPEN_EXISTING, syscall.FILE_ATTRIBUTE_NORMAL, 0)\n        if err == nil {\n                glog.V(3).Infof(\"loghandle: %v logdevid: 0x%x\", loghandle, logdevid)\n        }\n\n        return err }\n</code></pre>\n\n<p>loghandle and logdevid are using as below to log the message to a file.</p>\n\n<pre><code>    typedef struct tagLOGSTRING\n    {\n        unsigned long           level;\n        wchar_t                 message[1024];\n    }LOGSTRING;\n\n    func LogMsg(b []byte) (err error) {\n         var logstring C.LOGSTRING\n\n         logstring.level = 0\n         tmp := syscall.StringToUTF16(string(b[:]))\n         for i := range tmp {\n                logstring.message[i] = C.uint16_t(tmp[i])\n         }\n         err = syscall.DeviceIoControl(loghandle, logdevid,\n                        (*byte)(unsafe.Pointer(&amp;logstring)),\n                        (uint32)(unsafe.Sizeof(logstring)),\n                        nil, 0, nil, nil)\n        return err\n\n   }\n</code></pre>\n"}, {"tags": ["go", "google-bigquery", "manual-testing", "localstack"], "comments": [{"owner": {"reputation": 712, "user_id": 10409068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ez96f.jpg?s=128&g=1", "display_name": "Enrique Zetina", "link": "https://stackoverflow.com/users/10409068/enrique-zetina"}, "edited": false, "score": 0, "creation_date": 1575314379, "post_id": 59138674, "comment_id": 104516736, "body": "I don&#39;t know any tool like that, in this <a href=\"https://medium.com/clocal/week-1-high-level-architecture-best-practices-56322a886315\" rel=\"nofollow noreferrer\">Medium Post</a> you can find a tool called <a href=\"https://medium.com/clocal/week-1-high-level-architecture-best-practices-56322a886315\" rel=\"nofollow noreferrer\">Emulation engine for GCP</a>, but the framework doesn&#39;t include BigQuery."}], "answers": [{"tags": [], "owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1575325929, "creation_date": 1575325929, "answer_id": 59147625, "question_id": 59138674, "link": "https://stackoverflow.com/questions/59138674/google-bigquery-local-emulation/59147625#59147625", "title": "Google BigQuery local emulation", "body": "<p>There is no (Google-provided) emulator of BigQuery.</p>\n"}], "owner": {"reputation": 459, "user_id": 7930003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLluj.jpg?s=128&g=1", "display_name": "Ambareesh B", "link": "https://stackoverflow.com/users/7930003/ambareesh-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1575325929, "creation_date": 1575288625, "question_id": 59138674, "link": "https://stackoverflow.com/questions/59138674/google-bigquery-local-emulation", "title": "Google BigQuery local emulation", "body": "<p>Is there any local server implementation for <code>google BigQuery</code> like <code>localstack</code> for <code>AWS</code>.</p>\n\n<p>There is a reference to local server implementation for app engine with <code>dev_appserver.py</code>. I could run this with a dummy app.yaml. </p>\n\n<ul>\n<li>I can not access interactive console using localhost:8000/console</li>\n<li>Can I run <code>bq</code> command line utility after starting server using <code>dev_appserver.py  --enable-console app.yaml</code></li>\n</ul>\n"}, {"tags": ["go", "proxy"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575291424, "post_id": 59138003, "comment_id": 104505599, "body": "With <code>GOSUMDB=sum.golang.org</code> checksum requests are sent to sum.golang.org, obviously. Which other values have you tried and which errors did you get, exactly?"}, {"owner": {"reputation": 627, "user_id": 1477268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n5CES.jpg?s=128&g=1", "display_name": "pedrobisp", "link": "https://stackoverflow.com/users/1477268/pedrobisp"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1575294901, "post_id": 59138003, "comment_id": 104507470, "body": "Thanks for your comment. The errors I got is irrelevant since you answered my question already: Having a proxy set in the client doesn&#39;t matter, the requests for the checksum db will not be sent to the proxy anyways (contrary to what I have seen <a href=\"https://go.googlesource.com/proposal/+/master/design/25530-sumdb.md#proxying-a-checksum-database\" rel=\"nofollow noreferrer\">go.googlesource.com/proposal/+/master/design/&hellip;</a> and <a href=\"https://docs.gomods.io/configuration/sumdb/\" rel=\"nofollow noreferrer\">docs.gomods.io/configuration/sumdb</a>)."}], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 1477268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n5CES.jpg?s=128&g=1", "display_name": "pedrobisp", "link": "https://stackoverflow.com/users/1477268/pedrobisp"}, "is_accepted": false, "score": 0, "last_activity_date": 1575295191, "creation_date": 1575295191, "answer_id": 59140458, "question_id": 59138003, "link": "https://stackoverflow.com/questions/59138003/how-to-proxy-a-checksum-db/59140458#59140458", "title": "How to proxy a checksum db", "body": "<p>As Peter mentioned, requests are sent to the verifier key set in <code>GOSUMDB</code>, independent wheter a proxy is set or not.</p>\n"}], "owner": {"reputation": 627, "user_id": 1477268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n5CES.jpg?s=128&g=1", "display_name": "pedrobisp", "link": "https://stackoverflow.com/users/1477268/pedrobisp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575295191, "creation_date": 1575286082, "last_edit_date": 1575294709, "question_id": 59138003, "link": "https://stackoverflow.com/questions/59138003/how-to-proxy-a-checksum-db", "title": "How to proxy a checksum db", "body": "<p>I have an internal go proxy running and I would like it to proxy a checksum database as well, as described <a href=\"https://go.googlesource.com/proposal/+/master/design/25530-sumdb.md#proxying-a-checksum-database\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>However, I do not know how to set up my client properly since the requests to the checksum database are not being forwarded to my internal proxy.\nThe environment variables in my client are like this</p>\n\n<pre><code>GONOPROXY=\nGONOSUMDB=\nGOPRIVATE=\nGOPROXY=http://proxy.site\nGOSUMDB=sum.golang.org\n</code></pre>\n\n<p>I dump all http requests on my proxy, and I cannot see any requests for the checksum db.\nThese requests would be something like <code>http://proxy.site/sumdb/&lt;endpoint&gt;</code>.\nHowever, my logs do not show anything.\nWhen I set my GOSUMDB to any url other than sum.golang.org, then I get errors.\nThis shows that my client is indeed making requests to the checksum db, but not using the proxy, desping it being set.</p>\n"}, {"tags": ["go", "command-line-interface", "go-cobra"], "answers": [{"tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": true, "score": 3, "last_activity_date": 1575288929, "creation_date": 1575288929, "answer_id": 59138753, "question_id": 59137751, "link": "https://stackoverflow.com/questions/59137751/cobra-cli-fails-to-initialise-new-tool/59138753#59138753", "title": "Cobra cli fails to initialise new tool", "body": "<p>With modules, a package name is required. See the <a href=\"https://github.com/spf13/cobra/blob/master/cobra/README.md#cobra-init\" rel=\"nofollow noreferrer\">cobra readme</a>.</p>\n"}], "owner": {"reputation": 9276, "user_id": 2409793, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/QDLY9.png?s=128&g=1", "display_name": "pkaramol", "link": "https://stackoverflow.com/users/2409793/pkaramol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 59138753, "answer_count": 1, "score": 1, "last_activity_date": 1575288929, "creation_date": 1575285203, "last_edit_date": 1575288157, "question_id": 59137751, "link": "https://stackoverflow.com/questions/59137751/cobra-cli-fails-to-initialise-new-tool", "title": "Cobra cli fails to initialise new tool", "body": "<p>I have an empty dir with a go project, with only <code>go.mod</code> being present (I have run the <code>go mod init</code> command)</p>\n\n<pre><code>\u25b6 cat go.mod\nmodule github.com/myorganization/mytool\n\ngo 1.13\n\n</code></pre>\n\n<p>I would expect that the following command:</p>\n\n<pre><code>\u25b6 ~/go/bin/cobra init mytool\n</code></pre>\n\n<p>would scaffold the area with boilerplate code so that I start creating my cli tool.</p>\n\n<p>Instead I am getting the following error message:</p>\n\n<pre><code>\u25b6 ~/go/bin/cobra init mytool\nError: required flag(s) \"pkg-name\" not set\nUsage:\n  cobra init [name] [flags]\n\nAliases:\n  init, initialize, initialise, create\n\nFlags:\n  -h, --help              help for init\n      --pkg-name string   fully qualified pkg name\n\nGlobal Flags:\n  -a, --author string    author name for copyright attribution (default \"YOUR NAME\")\n      --config string    config file (default is $HOME/.cobra.yaml)\n  -l, --license string   name of license for the project\n      --viper            use Viper for configuration (default true)\n\n</code></pre>\n\n<p>Why is the package name needed? </p>\n\n<p>Isn't this an issue in the responsibility of <code>go modules</code> ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1575286516, "post_id": 59137736, "comment_id": 104503081, "body": "Why so concerned with memory utilization?"}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 1, "creation_date": 1575286638, "post_id": 59137736, "comment_id": 104503155, "body": "Could you please define <i>a lot of data</i>? I&#39;d go for simplicity if the bandwidth is not critically high."}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "reply_to_user": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1575286936, "post_id": 59137736, "comment_id": 104503289, "body": "@AndrejsCainikovs For 1 meter, I have a measure each 10 minutes ( timestep may vary ). Right now, I have 30 meters, not that much, but it can scale quite quick with big clients"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1575296481, "post_id": 59137736, "comment_id": 104508322, "body": "&quot;I need to be careful optimizing memory&quot; - do you though? Where&#39;s your memory benchmarks? Your profiler data? Do you have evidence that you have a memory consumption problem or are you trying to solve a problem you may not actually have?"}], "answers": [{"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1575288180, "post_id": 59138380, "comment_id": 104503913, "body": "Using pointers is not handy because we have to test for nil. Why not keep the defaults if the field is undefined ? Omitempty will do the job to not output default values."}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1575288574, "post_id": 59138380, "comment_id": 104504105, "body": "@Andrejs Can you tell me why are you using pointers for optional fields ?"}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 2, "creation_date": 1575288746, "post_id": 59138380, "comment_id": 104504197, "body": "By using pointer you know if the field is created or not. By not using pointer you can face some corner cases which you need to think of - what should you do if <code>IndexValue</code> is set to 0, and this index value is valid, but it&#39;s not being served in JSON output due to <code>omitempty</code>? You will not face this problem by using pointers, since the default value of this field will be <code>nil</code>."}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1575289151, "post_id": 59138380, "comment_id": 104504397, "body": "I see! Thanks for the tip!"}], "tags": [], "owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "is_accepted": true, "score": 0, "last_activity_date": 1575287442, "creation_date": 1575287442, "answer_id": 59138380, "question_id": 59137736, "link": "https://stackoverflow.com/questions/59137736/how-to-organize-similar-struct-to-avoid-duplication-without-sacrificating-memory/59138380#59138380", "title": "How to organize similar struct to avoid duplication without sacrificating memory", "body": "<p>As per comments, 1 measure every 10 minutes is definitely not a lot.\nI'd go for simplicity:</p>\n\n<pre><code>type Measure struct {\n    IndexName     *string    `json:\"index_name,omitempty\"`\n    IndexValue    *int       `json:\"index_value,omitempty\"`\n    Timestamp      time.Time `json:\"timestamp\"`\n    Delta          float64   `json:\"delta\"`\n    Redistributed *float64   `json:\"redistributed,omitempty\"`\n}\n</code></pre>\n\n<p>Pros:</p>\n\n<ul>\n<li>Same struct, easy to work with</li>\n</ul>\n\n<p>Cons:</p>\n\n<ul>\n<li>Few bytes lost on every struct instance</li>\n</ul>\n"}], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 59138380, "answer_count": 1, "score": -1, "last_activity_date": 1575287442, "creation_date": 1575285143, "last_edit_date": 1575286506, "question_id": 59137736, "link": "https://stackoverflow.com/questions/59137736/how-to-organize-similar-struct-to-avoid-duplication-without-sacrificating-memory", "title": "How to organize similar struct to avoid duplication without sacrificating memory", "body": "<p>I have to refactor a code, and I don't know how to best define my structs.</p>\n\n<p>I have a list of meters <code>[]Meter</code></p>\n\n<p>With <code>Meter</code></p>\n\n<pre><code>type Meter struct {\n    ID          string    `json:\"meter_id\"`\n    ConsoProd   string    `json:\"conso_prod\"`\n    OperationID string    `json:\"op_id\"`\n    Measures    []Measure `json :\"measures\"`\n}\n</code></pre>\n\n<p>The 3 first field will always be here, but Measure has several variants, depending the step in the process.</p>\n\n<p>Here is the general <code>Measure</code> struct:</p>\n\n<pre><code>// Measure is a measure from a Meter\n    type Measure struct {\n        IndexName     string    `json:\"index_name\"`\n        IndexValue    int       `json:\"index_value\"`\n        Timestamp     time.Time `json:\"timestamp\"`\n        Delta         float64   `json:\"delta\"`\n        Redistributed float64   `json:\"redistributed,omitempty\"` // We don t need the redistributed field in Raw Measure\n    }\n</code></pre>\n\n<p>First, we get the 'raw value'</p>\n\n<pre><code>type RawMeasure struct {\n    IndexName     string    `json:\"index_name\"`\n    IndexValue    int       `json:\"index_value\"`\n    Timestamp     time.Time `json:\"timestamp\"`\n    Delta         float64   `json:\"delta\"`\n}\n</code></pre>\n\n<p>Then we will calculate the redistributed, and store it into the <code>redistributed</code> field </p>\n\n<p>The measure will never have a redistributed.</p>\n\n<p>Also, I have 2 data sources. If Data comes from source2, it will never have IndexName / IndexValue</p>\n\n<pre><code>type RawMeasureFromSource2 struct {\n    Timestamp     time.Time `json:\"timestamp\"`\n    Delta         float64   `json:\"delta\"`\n}\n</code></pre>\n\n<p>Here we can see I could create several structs: (RawMeasure, RawMeasureFromSource2, Measure) and then I should create other 3 Meters vars. </p>\n\n<p>As I will manage a lot of data, I need to be careful optimizing memory, but it seems it will complicate my code a lot.</p>\n\n<p>Is there a way to get both a simple code, and optimized memory usage?</p>\n"}, {"tags": ["go", "memory", "struct"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1575284108, "post_id": 59137383, "comment_id": 104501848, "body": "Yes. They are populated with their corresponding <a href=\"https://tour.golang.org/basics/12\" rel=\"nofollow noreferrer\">zero values</a>, which are the same as any other value."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1575286419, "post_id": 59137383, "comment_id": 104503028, "body": "A minor nitpick: these fields are not empty, they are not explicitly assigned (and so automatically initialized to the zero values appropriate for the respective types of the fields). The need to not call them empty arises from the fact, in Go, it&#39;s possible to have <i>really empty</i> value by using for it a type <code>struct{}</code> \u2014 an empty struct. Variables (and fields, and array/slice/map elements) of this type consume no storage space (except when padding issues for enclosing <code>struct</code>s come into play)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1575297057, "post_id": 59137383, "comment_id": 104508610, "body": "I don&#39;t think it&#39;s a minor nitpick at all, it&#39;s fundamental to the understanding of the question. <b>There is no such thing as an &quot;empty&quot; field or variable.</b>"}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1575285571, "post_id": 59137421, "comment_id": 104502625, "body": "To the OP, just to make things more clear, I hope: even when you assign the <code>MyArray</code> field a non-<code>nil</code> value (say, after calling <code>make([]myObject, 42)</code>), the struct value <i>itself</i> would still consume the same amount of memory as it did before assignment\u2014just that particular field, whose type (a slice) has <i>reference semantics</i> \u2014 would reference a block of allocated memory, as opposed to referring to nothing when the field was containing the zero value for its type, <code>nil</code>. (A nitpick: <code>[]T</code> is a slice, not array; it&#39;s better to not use confusing terminology.)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1575293269, "last_edit_date": 1575293269, "creation_date": 1575284086, "answer_id": 59137421, "question_id": 59137383, "link": "https://stackoverflow.com/questions/59137383/do-empty-fields-in-structs-consume-memory/59137421#59137421", "title": "Do empty fields in structs consume memory?", "body": "<p>Structs have fixed sizes. How you initialize them doesn't matter, it requires the same amount of memory.</p>\n\n<p>If memory would not be allocated for fields initialized with their zero values, assigning values later on would require memory allocation.</p>\n\n<p>Here's a simple benchmark code to verify it:</p>\n\n<pre><code>type T struct {\n    i int\n    s string\n    x []int\n    a [10]int64\n}\n\nvar x *T\n\nfunc BenchmarkZero(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        x = &amp;T{}\n    }\n}\n\nvar xval = make([]int, 10)\n\nfunc BenchmarkNonZero(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        x = &amp;T{\n            i: 10,\n            s: \"gopher\",\n            x: xval,\n            a: [10]int64{0, 1, 2, 3, 4, 5, 6, 7, 8, 9},\n        }\n    }\n}\n</code></pre>\n\n<p>Running it with <code>go test -bench. -benchmem</code>, output is:</p>\n\n<pre><code>BenchmarkZero-4      16268067      69.6 ns/op    128 B/op    allocs/op\nBenchmarkNonZero-4   13961296      75.8 ns/op    128 B/op    allocs/op\n</code></pre>\n\n<p>Both <code>BenchmarkZero()</code> and <code>BenchmarkNonZero()</code> performs a single allocation being 128 bytes, which is the size of <code>T</code> (<code>unsafe.Sizeof(T{})</code> returns 128). This size is on 64-bit architecture: 8 (<code>int</code>) + 16 (<code>string</code> header) + 24 (slice header) + 80 (<code>[10]int64</code> array size). No implicit padding is required in case of this struct, so this is its final size.</p>\n\n<p>I purposefully used <code>xval</code> package level variable when providing a value for <code>T.x</code> to avoid having to allocate value for it in the benchmark (and to not mess with what's benchmarked).</p>\n"}], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 59137421, "answer_count": 1, "score": -1, "last_activity_date": 1575293269, "creation_date": 1575283895, "last_edit_date": 1575284360, "question_id": 59137383, "link": "https://stackoverflow.com/questions/59137383/do-empty-fields-in-structs-consume-memory", "title": "Do empty fields in structs consume memory?", "body": "<p>I have a struct with fields: </p>\n\n<pre><code>type Measure struct {\n    ID            int\n    IndexName     string    \n    IndexValue    int   \n    Redistributed float64\n    MyArray       []myObject\n}\n</code></pre>\n\n<p>If I initialize my object with</p>\n\n<pre><code>measure := Measure{\n   ID: 10,\n   IndexName: \"\",\n   IndexName: 0,\n   Redistributed: 0\n   MyArray: nil         \n}\n</code></pre>\n\n<p>What should be my memory footprint? When I instantiate a struct with empty fields, do I use memory anyway?</p>\n\n<p>I am pretty sure I am, but I just need a confirmation.</p>\n"}, {"tags": ["go", ".net-core", "protocol-buffers", "grpc", "protobuf-net"], "comments": [{"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1575288740, "post_id": 59136387, "comment_id": 104504195, "body": "The most likely cause of this is incorrect treatment of binary payloads; do you have an example binary payload? Note that you can verify a payload using <a href=\"https://protogen.marcgravell.com/decode\" rel=\"nofollow noreferrer\">protogen.marcgravell.com/decode</a> - classic ways to break a binary payload include: 1) &quot;encoding&quot; (air quotes intentional) it to text by running it backwards through a text-encoding (you should use base-64 or hex etc if you need to pass it as text, not a text encoding in reverse), 2) using C-style string (nul-terminated) APIs (don&#39;t), or 3) truncating/over-padding the payload (protobuf is not self-terminating)"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1575288821, "post_id": 59136387, "comment_id": 104504243, "body": "from the question, it looks like you&#39;re passing protobuf inside JSON, so: my money is on the first option above: I&#39;d happily speculate that you&#39;ve encoded it it text (for the JSON) incorrectly. Until you can get back to the original bytes before calling <code>ParseFrom</code>, all other considerations are meangless"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1575289470, "post_id": 59136387, "comment_id": 104504585, "body": "oh! (light comes on) are you using the JSON version of protobuf? if so; yeah, you need to use the JSON parse API; there are two formats for protobuf - usually, people mean the binary one, and <code>ParseFrom(byte[])</code> is for the binary one. If you&#39;re using the JSON data format, you&#39;ll need to use the JSON parse API. Is there a <code>ParseFromJson</code> or similar? or one that takes a <code>string</code>? Edit: checking the docs, <code>ParseJson</code>: <a href=\"https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/message-parser\" rel=\"nofollow noreferrer\">developers.google.com/protocol-buffers/docs/reference/csharp&zwnj;&#8203;/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1575289650, "post_id": 59138173, "comment_id": 104504681, "body": "&quot;Protobuf is a binary protocol&quot; - we commonly think of it as such (my protobuf library only supports this mode), but there <i>is</i> a JSON variant, and it looks like the OP is using the JSON variant."}], "tags": [], "owner": {"reputation": 3148, "user_id": 420560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RG3B0.png?s=128&g=1", "display_name": "m-szalik", "link": "https://stackoverflow.com/users/420560/m-szalik"}, "is_accepted": false, "score": 0, "last_activity_date": 1575286709, "creation_date": 1575286709, "answer_id": 59138173, "question_id": 59136387, "link": "https://stackoverflow.com/questions/59136387/protocol-buffers-between-two-different-languages/59138173#59138173", "title": "Protocol Buffers between two different languages", "body": "<p>Basically there are two possible scenarios, or your protos files generated for .NET and GoLang are not in the same version or your data has been corrupted while transferring between GoLang and .NET application.</p>\n\n<p>Protobuf is a binary protocol, check if you have any http filter or anything else that can change incoming or outgoing stream of bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": false, "score": 4, "last_activity_date": 1575289594, "creation_date": 1575289594, "answer_id": 59138913, "question_id": 59136387, "link": "https://stackoverflow.com/questions/59136387/protocol-buffers-between-two-different-languages/59138913#59138913", "title": "Protocol Buffers between two different languages", "body": "<p>It looks like you're using the JSON format rather than the binary format. In that case, <a href=\"https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/message-parser\" rel=\"nofollow noreferrer\">you want <code>ParseJson(string json)</code>, not <code>ParseFrom(byte[] data)</code></a>.</p>\n\n<p>Note: the binary format is more efficient, if that matters to you. It also has better support across protobuf libraries / tools.</p>\n"}], "owner": {"reputation": 635, "user_id": 2329355, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/quUmq.jpg?s=128&g=1", "display_name": "Daniel Chernenkov", "link": "https://stackoverflow.com/users/2329355/daniel-chernenkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1575289594, "creation_date": 1575280585, "question_id": 59136387, "link": "https://stackoverflow.com/questions/59136387/protocol-buffers-between-two-different-languages", "title": "Protocol Buffers between two different languages", "body": "<p>We are using Golang and .NET Core for our inter-communication microservices infrastructure.\nAll the data across the services are coming based on Protobuffs Protocols that we have created.\nHere is an example of one of our Protobuffs:</p>\n\n<pre><code>syntax = \"proto3\";\npackage Protos;\noption csharp_namespace = \"Protos\";\noption go_package=\"Protos\";\nmessage EventMessage {\n    string actionType = 1;\n    string payload = 2;\n    bool auditIsActive = 3;\n}\n</code></pre>\n\n<p>Golang is working well and the service is generating the content as needed and sending it to the SQS queue, once that happens the .NET core service is getting the data and trying to serialize it.</p>\n\n<p>Here are the contents of the SQS message example:</p>\n\n<pre><code>{\"@type\":\"type.googleapis.com/Protos.EventMessage\",\"actionType\":\"PushPayload\",\"payload\":\"&lt;&lt;INTERNAL&gt;&gt;\"}\n</code></pre>\n\n<p>But we are getting an Exception that saying the wire-type is not defined as mentioned below:</p>\n\n<pre><code>Google.Protobuf.InvalidProtocolBufferException: Protocol message contained a tag with an invalid wire type.\n   at Google.Protobuf.UnknownFieldSet.MergeFieldFrom(CodedInputStream input)\n   at Google.Protobuf.UnknownFieldSet.MergeFieldFrom(CodedInputStream input)\n   at Google.Protobuf.UnknownFieldSet.MergeFieldFrom(UnknownFieldSet unknownFields, CodedInputStream input)\n   at Protos.EventMessage.MergeFrom(CodedInputStream input) in /Users/maordavidzon/projects/github_connector/GithubConnector/GithubConnector/obj/Debug/netcoreapp3.0/EventMessage.cs:line 232\n   at Google.Protobuf.MessageExtensions.MergeFrom(IMessage message, Byte[] data, Boolean discardUnknownFields, ExtensionRegistry registry)\n   at Google.Protobuf.MessageParser`1.ParseFrom(Byte[] data)\n</code></pre>\n\n<p>The Proto file is exactly the same in both of the services.</p>\n\n<p>Is there any potential missing options or property that we need to add?</p>\n"}, {"tags": ["xml", "go", "lang", "glide-golang"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1575280793, "post_id": 59136336, "comment_id": 104500096, "body": "Please take a look at package encoding/xml."}, {"owner": {"reputation": 15, "user_id": 9719917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab159127264aeb98b3bb7e5a09eaef81?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyBoy", "link": "https://stackoverflow.com/users/9719917/geekyboy"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1575281226, "post_id": 59136336, "comment_id": 104500325, "body": "Please share the link ."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1575282123, "post_id": 59136336, "comment_id": 104500820, "body": "What have you tried? Include your code. What problems did you encounter?"}, {"owner": {"reputation": 14633, "user_id": 5069957, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/597577c2765adaa190e4524d3a3860fe?s=128&d=identicon&r=PG&f=1", "display_name": "edkeveked", "link": "https://stackoverflow.com/users/5069957/edkeveked"}, "edited": false, "score": 1, "creation_date": 1575282226, "post_id": 59136336, "comment_id": 104500870, "body": "You have this link for converting map to xml: <a href=\"https://stackoverflow.com/questions/30928770/marshall-map-to-xml-in-go\" title=\"marshall map to xml in go\">stackoverflow.com/questions/30928770/marshall-map-to-xml-in-&zwnj;&#8203;go</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1575282446, "post_id": 59136336, "comment_id": 104500979, "body": "This is a package if the stdlib. You should not need link for that."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1575282640, "post_id": 59136336, "comment_id": 104501076, "body": "@volker the stdlib xml encoder does not support encoding maps. Please read the question linked by edkeveked."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9719917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab159127264aeb98b3bb7e5a09eaef81?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyBoy", "link": "https://stackoverflow.com/users/9719917/geekyboy"}, "edited": false, "score": 0, "creation_date": 1575304347, "post_id": 59138410, "comment_id": 104512513, "body": "If Map Data is given in file, then how should i fetch data from file &amp; generate the xml file."}], "tags": [], "owner": {"reputation": 3148, "user_id": 420560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RG3B0.png?s=128&g=1", "display_name": "m-szalik", "link": "https://stackoverflow.com/users/420560/m-szalik"}, "is_accepted": false, "score": 0, "last_activity_date": 1575287589, "creation_date": 1575287589, "answer_id": 59138410, "question_id": 59136336, "link": "https://stackoverflow.com/questions/59136336/how-to-convert-map-of-data-to-xml-file/59138410#59138410", "title": "How to Convert Map of Data to XML File", "body": "<p>Have a look on docs: <a href=\"https://golang.org/pkg/encoding/xml/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/xml/</a></p>\n\n<p>And here you have a little example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package tests\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"testing\"\n)\n\ntype Person struct {\n    FirstName string `xml:\"first_name\"`\n    LastName string `xml:\"last_name\"`\n    Age int `xml:\"age,attr\"`\n\n}\n\nfunc TestXmlToString(t *testing.T) {\n    person := Person{\n        FirstName: \"John\",\n        LastName:  \"Rambo\",\n        Age:       66,\n    }\n    data, err := xml.Marshal(person)\n    if err != nil {\n        t.Fatal(err)\n    }\n    fmt.Printf(\"Xml: %s\\n\", data)\n}\n\nfunc TestStringToXml(t *testing.T) {\n    input := `&lt;Person age=\"66\"&gt;&lt;first_name&gt;John&lt;/first_name&gt;&lt;last_name&gt;Rambo&lt;/last_name&gt;&lt;/Person&gt;`\n    person := Person{}\n    err := xml.Unmarshal([]byte(input), &amp;person)\n    if err != nil {\n        t.Fatal(err)\n    }\n    fmt.Printf(\"Data: %#v\\n\", person)\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9719917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab159127264aeb98b3bb7e5a09eaef81?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyBoy", "link": "https://stackoverflow.com/users/9719917/geekyboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1575287589, "creation_date": 1575280423, "last_edit_date": 1575282103, "question_id": 59136336, "link": "https://stackoverflow.com/questions/59136336/how-to-convert-map-of-data-to-xml-file", "title": "How to Convert Map of Data to XML File", "body": "<pre><code>InformationUser:[{\n\n\"informationUser.availabiltyStartDate:\"09/10/2019 23:56:19\",\n\"informationUSer.avaialblilityEndDate:\"28/11/2019 21:19:16\",\n\n}]\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1575278702, "post_id": 59135817, "comment_id": 104499034, "body": "There&#39;s no reason to use the pointer of a channel, unless you need a receiver to be able to modify it. Other than that, whether it&#39;s a good approach to send channels over channels is a matter of opinion and/or implementation."}, {"owner": {"reputation": 45, "user_id": 12041033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa05b2111005d4ad77a20946e8799e9?s=128&d=identicon&r=PG&f=1", "display_name": "yushizhao", "link": "https://stackoverflow.com/users/12041033/yushizhao"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575279236, "post_id": 59135817, "comment_id": 104499294, "body": "@Flimzy Thank you! Okay, I don&#39;t think I want a receiver to modify the callback channel. So, no pointer."}, {"owner": {"reputation": 45, "user_id": 12041033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa05b2111005d4ad77a20946e8799e9?s=128&d=identicon&r=PG&f=1", "display_name": "yushizhao", "link": "https://stackoverflow.com/users/12041033/yushizhao"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575279429, "post_id": 59135817, "comment_id": 104499397, "body": "@Flimzy As to whether it&#39;s a good approach, would you explain more on the opinions and/or implementations you mentioned?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1575281897, "post_id": 59135817, "comment_id": 104500692, "body": "No, that topic is far too broad to be covered in a comment, and off-topic for a question/answer. A better approach is to explain your actual goal, rather than speaking in broad abstractions."}], "answers": [{"tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": true, "score": 0, "last_activity_date": 1575283344, "creation_date": 1575283344, "answer_id": 59137234, "question_id": 59135817, "link": "https://stackoverflow.com/questions/59135817/for-callback-passing-channels-as-data-through-other-channels/59137234#59137234", "title": "for callback, passing channels as data through other channels", "body": "<p>It\u2019s not a bad practice. It\u2019s perfectly OK to pass a channel through another channel and use it to collect result.</p>\n\n<p>Note that what you describe is not exactly a callback since the go routine doesn\u2019t call anything. It simply write data in the channel transmitted through the channel. </p>\n\n<p>If you passed a function in the channel and the go routine would call it, then you would have a callback.</p>\n"}], "owner": {"reputation": 45, "user_id": 12041033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa05b2111005d4ad77a20946e8799e9?s=128&d=identicon&r=PG&f=1", "display_name": "yushizhao", "link": "https://stackoverflow.com/users/12041033/yushizhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1575303018, "accepted_answer_id": 59137234, "answer_count": 1, "score": -3, "last_activity_date": 1575283344, "creation_date": 1575278501, "last_edit_date": 1575282597, "question_id": 59135817, "link": "https://stackoverflow.com/questions/59135817/for-callback-passing-channels-as-data-through-other-channels", "closed_reason": "Opinion-based", "title": "for callback, passing channels as data through other channels", "body": "<p>I am trying to include a channel to a struct as a member. An instance of the struct will be processed step by step when being passed to different goroutines over channels by an initiator (there going to be multiple initiators concurrently). \nAnd the channel member will be used as callback which returns the outcome of each step to the initiator.</p>\n\n<p>So, is it a good practice passing channels as data through other channels?\nShall I use the pointer of the channel instead?\nAny other patterns recommend?</p>\n\n<p>=================Some additional thoughts==============</p>\n\n<p>Compare to have a global sync.Map mapping initiators to callback channels for each goroutines to lookup, shall I actually send the callback channel over channels? </p>\n"}, {"tags": ["python", "go", "code-coverage", "codecov"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575277442, "post_id": 59135274, "comment_id": 104498465, "body": "Just be aware there&#39;s probably no <i>perfect</i> way to do this, since different tools tend to measure coverage in different ways, and even when using the same method (i.e. branch coverage), branches across languages aren&#39;t always equivalent. But you can probably get close."}], "owner": {"reputation": 73, "user_id": 7749397, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6k-dnh5gSjE/AAAAAAAAAAI/AAAAAAAAAGo/ol62WG4meY8/photo.jpg?sz=128", "display_name": "Shubham Yelikar", "link": "https://stackoverflow.com/users/7749397/shubham-yelikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575276994, "creation_date": 1575276360, "last_edit_date": 1575276994, "question_id": 59135274, "link": "https://stackoverflow.com/questions/59135274/combine-coverage-reports-of-different-languages", "title": "Combine coverage reports of different languages", "body": "<p>I have 2 different test coverage files one is for Go (coverage.out) and other is for Python (.coverage).\nI want single combined report from these 2 coverage files.\nOne of the solution I know is to upload these files into <a href=\"https://codecov.io\" rel=\"nofollow noreferrer\">https://codecov.io</a> and codecov will automatically merge it for us.\nBut I want to combine these reports locally, is there any way to do this locally?</p>\n"}, {"tags": ["go", "concurrency", "execution", "goroutine"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1575272559, "post_id": 59134376, "comment_id": 104496511, "body": "Welcome to SO! You might want to read <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a>, which enhances the probability for getting a useful answer <i>drastically</i>. You might find <a href=\"https://en.m.wikipedia.org/wiki/Eric_S._Raymond\" rel=\"nofollow noreferrer\">ESR</a>&#39;s excellent essay <a href=\"http://catb.org/~esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">How To Ask Questions The Smart Way</a> helpful, too - despite its &quot;harsh&quot; title. I have a strong feeling that we have a <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY problem</a> here... ;)"}], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1575273043, "post_id": 59134568, "comment_id": 104496691, "body": "Maybe this bit of information calls for a bit more explanation... ;)"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1575272916, "creation_date": 1575272916, "answer_id": 59134568, "question_id": 59134376, "link": "https://stackoverflow.com/questions/59134376/how-to-track-the-execution-flow-the-functions-being-called/59134568#59134568", "title": "How to track the execution flow (the functions being called)", "body": "<blockquote>\n  <p>[I]f there is one API in which there are various goroutines and inside those goroutines, other goroutines are called, [...]</p>\n</blockquote>\n\n<p>There isn\u2018t.</p>\n"}, {"tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 1, "last_activity_date": 1575273369, "creation_date": 1575273369, "answer_id": 59134661, "question_id": 59134376, "link": "https://stackoverflow.com/questions/59134376/how-to-track-the-execution-flow-the-functions-being-called/59134661#59134661", "title": "How to track the execution flow (the functions being called)", "body": "<p>Go runtime trace tool will help you to trace , but you need to add trace option in go code start </p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"runtime/trace\"\n)\n\nfunc main() {\n    trace.Start(os.Stderr) //start the trace \n    defer trace.Stop() // defer to the end\n    .... //rest of the code\n}\n</code></pre>\n\n<p>Then use ,</p>\n\n<pre><code>go run main.go 2&gt; trace.out  \nthen use the trace tool\ngo tool trace trace.out.\n</code></pre>\n\n<p>This link has more info <a href=\"https://blog.gopheracademy.com/advent-2017/go-execution-tracer/\" rel=\"nofollow noreferrer\">https://blog.gopheracademy.com/advent-2017/go-execution-tracer/</a></p>\n"}], "owner": {"reputation": 33, "user_id": 12401930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acddd15d1749c2c62609394b973a1a2?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/12401930/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1575277485, "creation_date": 1575271816, "last_edit_date": 1575277485, "question_id": 59134376, "link": "https://stackoverflow.com/questions/59134376/how-to-track-the-execution-flow-the-functions-being-called", "title": "How to track the execution flow (the functions being called)", "body": "<p>I worked on languages like PHP and Python but recently I got a Go project to maintain which utilizes several workers and goroutines.</p>\n\n<p>In PHP or Python, we can know about the execution of code as its all synchronous calls. But I am finding it very difficult to understand how the code execution takes place in Go, especially in workers and goroutine. Can anyone suggest me any tools by using which I can get the execution flow(the name of the function being called)?</p>\n\n<p>For example, if there is one API in which there are various goroutines and inside those goroutines, other goroutines are called, so how to know in which sequence these functions are called.</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 1, "creation_date": 1575270715, "post_id": 59133923, "comment_id": 104495862, "body": "If you want to return something, use a function. Procedures aren&#39;t meant to return something."}, {"owner": {"reputation": 529, "user_id": 1540739, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c9e558372c8a4422060f277b3f73886?s=128&d=identicon&r=PG", "display_name": "arshpreet", "link": "https://stackoverflow.com/users/1540739/arshpreet"}, "edited": false, "score": 0, "creation_date": 1575293676, "post_id": 59133923, "comment_id": 104506795, "body": "this is mentioned in the Docs as well.  Not all drivers and databases support OUTPUT value parameters.<a href=\"https://golang.org/src/database/sql/sql.go?s=9545:9941#L362\" rel=\"nofollow noreferrer\">golang.org/src/database/sql/sql.go?s=9545:9941#L3&zwnj;&#8203;62</a>  Although you can use interface instead of string."}, {"owner": {"reputation": 1180, "user_id": 6302962, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/efdfc3bfc2651aebff7bcf20170edae6?s=128&d=identicon&r=PG&f=1", "display_name": "clo_jur", "link": "https://stackoverflow.com/users/6302962/clo-jur"}, "reply_to_user": {"reputation": 529, "user_id": 1540739, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c9e558372c8a4422060f277b3f73886?s=128&d=identicon&r=PG", "display_name": "arshpreet", "link": "https://stackoverflow.com/users/1540739/arshpreet"}, "edited": false, "score": 0, "creation_date": 1575338539, "post_id": 59133923, "comment_id": 104523884, "body": "Ah thanks @arshpreet"}], "owner": {"reputation": 1180, "user_id": 6302962, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/efdfc3bfc2651aebff7bcf20170edae6?s=128&d=identicon&r=PG&f=1", "display_name": "clo_jur", "link": "https://stackoverflow.com/users/6302962/clo-jur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575269531, "creation_date": 1575269531, "question_id": 59133923, "link": "https://stackoverflow.com/questions/59133923/golang-sql-package-return-inout-from-postgres-procedure", "title": "golang sql package: return INOUT from postgres procedure", "body": "<p>I am trying to get the value from an INOUT parameter into the invoking go code.</p>\n\n<p>I see some discussion <a href=\"https://github.com/mattn/go-oci8/issues/188\" rel=\"nofollow noreferrer\">here</a> about oracle drivers supporting this. However, I am using PostgreSQL, and I want to access my INOUT parameter.</p>\n\n<p>I have a postgres procedure that has an INOUT parameter like so:</p>\n\n<pre><code>CREATE OR REPLACE PROCEDURE foo(INOUT my_variable text) LANGUAGE plpgsql ...\n</code></pre>\n\n<p>I am trying to get the variable by following the docs <a href=\"https://golang.org/pkg/database/sql/#Out\" rel=\"nofollow noreferrer\">here</a>. I am writing something like this</p>\n\n<pre><code>import \"database/sql\"\ndb, _ := sql.Open(...some connection...)\n\ntx, err := db.Begin()\ndefer tx.Rollback()\n\nvar myVariable string\nif _, err := tx.Exec(`call foo(?);`, sql.Named(\"my_variable\", sql.Named(\"my_variable\", sql.Out{Dest: &amp;myVariable, In: true}))\n</code></pre>\n\n<p>This returns</p>\n\n<pre><code>sql: converting argument with name \"my_variable\" type: unsupported type sql.Out, a struct\n</code></pre>\n\n<p>Has anyone been able to make this work with PostgreSQL\nIt seems like this should work, given that it is documented with the package. So, do the postgresql drivers not yet support this, or am I just missing some package import?</p>\n"}, {"tags": ["go", "google-pay", "tink"], "comments": [{"owner": {"reputation": 529, "user_id": 1540739, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c9e558372c8a4422060f277b3f73886?s=128&d=identicon&r=PG", "display_name": "arshpreet", "link": "https://stackoverflow.com/users/1540739/arshpreet"}, "edited": false, "score": 0, "creation_date": 1575294035, "post_id": 59133681, "comment_id": 104506991, "body": "Did you try this? <a href=\"https://github.com/googleapis/google-api-go-client\" rel=\"nofollow noreferrer\">github.com/googleapis/google-api-go-client</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4778, "user_id": 12031739, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBL53wM9WHYa9QeNIq3MJ4scErCBV3t3egXL6NI5w=k-s128", "display_name": "Soc", "link": "https://stackoverflow.com/users/12031739/soc"}, "is_accepted": false, "score": 0, "last_activity_date": 1575313638, "creation_date": 1575313638, "answer_id": 59145222, "question_id": 59133681, "link": "https://stackoverflow.com/questions/59133681/google-pay-paymentmethodtokenrecipient-function-implementation-in-golang/59145222#59145222", "title": "Google Pay PaymentMethodTokenRecipient function implementation in Golang", "body": "<p>I'm not personally familiar with the library, but have a look at <a href=\"https://github.com/google/tink/tree/master/go\" rel=\"nofollow noreferrer\">Tink</a>.</p>\n\n<p>There's a <a href=\"https://github.com/google/tink/blob/6ad153edf2f5f954c5a4e99ac94f77fe345ae842/go/hybrid/hybrid_decrypt_factory.go#L59\" rel=\"nofollow noreferrer\">decrypt method</a> that may do what you are after, and a <a href=\"https://github.com/google/tink/blob/master/tools/testing/go/hybrid_decrypt_cli.go\" rel=\"nofollow noreferrer\">cli</a> that may help with how to use it: <a href=\"https://github.com/google/tink/blob/master/tools/testing/go/hybrid_decrypt_cli.go\" rel=\"nofollow noreferrer\">https://github.com/google/tink/blob/master/tools/testing/go/hybrid_decrypt_cli.go</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12466654, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC4dWIjHgwVkLF0JmVEukx-N6RXHjRz0VkTxFa_1A=k-s128", "display_name": "Aniket Srivastava", "link": "https://stackoverflow.com/users/12466654/aniket-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575325987, "creation_date": 1575268108, "last_edit_date": 1575325987, "question_id": 59133681, "link": "https://stackoverflow.com/questions/59133681/google-pay-paymentmethodtokenrecipient-function-implementation-in-golang", "title": "Google Pay PaymentMethodTokenRecipient function implementation in Golang", "body": "<p>I am trying to implement Google Pay decryption method as mentioned. </p>\n\n<p><a href=\"https://developers.google.com/pay/api/android/guides/resources/payment-data-cryptography#decrypt-token\" rel=\"nofollow noreferrer\">https://developers.google.com/pay/api/android/guides/resources/payment-data-cryptography#decrypt-token</a></p>\n\n<p>It mentions to use <code>tink</code> library with the example of Java (PaymentMethodTokenRecipient) but I'm unable to duplicate it for Golang.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1575280923, "post_id": 59132672, "comment_id": 104500155, "body": "The example given in question works and scheduling is also working for me with goroutines (I am using golang in windows). But the same code i tried in go playground is notworking . Any guess ?"}, {"owner": {"reputation": 764, "user_id": 799813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2eff6901bd6599cd9a6f808a2a960b46?s=128&d=identicon&r=PG", "display_name": "Tommie Jones", "link": "https://stackoverflow.com/users/799813/tommie-jones"}, "edited": false, "score": 0, "creation_date": 1575295227, "post_id": 59132672, "comment_id": 104507648, "body": "Im just learning go and this looks like a common idiom of the language. So If I replace the for loop with this it creates a channel that I never receive from and thus locking up the main thread? Am I interpreting this correctly?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1575297198, "post_id": 59132672, "comment_id": 104508697, "body": "@cslrnr because of exactly what&#39;s explained in this answer."}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 1, "creation_date": 1575297643, "post_id": 59132672, "comment_id": 104508951, "body": "@cslrnr if go runtime schedules the main goroutine and the new goroutine created by your scheduler in two different OS threads, then it will work. If go runtime schedules both goroutines to use the same OS thread, the busy-wait loop will not yield, and the second goroutine will never execute."}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 764, "user_id": 799813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2eff6901bd6599cd9a6f808a2a960b46?s=128&d=identicon&r=PG", "display_name": "Tommie Jones", "link": "https://stackoverflow.com/users/799813/tommie-jones"}, "edited": false, "score": 0, "creation_date": 1575297714, "post_id": 59132672, "comment_id": 104508993, "body": "@TommieJones the difference is: &lt;- ch puts the calling goroutine to sleep, letting other goroutines run. With <code>for {}</code> the calling goroutine executes the for loop and never yields (at least for the time being)."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 2, "last_activity_date": 1575260987, "creation_date": 1575260987, "answer_id": 59132672, "question_id": 59132435, "link": "https://stackoverflow.com/questions/59132435/scheduler-will-not-run-a-scheduled-job/59132672#59132672", "title": "Scheduler will not run a scheduled job", "body": "<p>Busy-wait tight loops like </p>\n\n<pre><code>for {\n}\n</code></pre>\n\n<p>will not allow other goroutines execute. It will not yield. If you need to wait, use one of the synchronization primitives, such as:</p>\n\n<pre><code>ch:=make(chan struct{})\n&lt;- ch\n</code></pre>\n"}], "owner": {"reputation": 764, "user_id": 799813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2eff6901bd6599cd9a6f808a2a960b46?s=128&d=identicon&r=PG", "display_name": "Tommie Jones", "link": "https://stackoverflow.com/users/799813/tommie-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575278116, "creation_date": 1575258662, "last_edit_date": 1575278116, "question_id": 59132435, "link": "https://stackoverflow.com/questions/59132435/scheduler-will-not-run-a-scheduled-job", "title": "Scheduler will not run a scheduled job", "body": "<p>I am unable to get prprpus scheduler library with Go to work. I was trying to recreate the functionality of JavaScript's <code>setinterval</code>.  The for loop should not block the scheduled job right?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/prprprus/scheduler\"\n)\nfunc keepAlive2() {\n    fmt.Println(\"Keep alive 2\")\n}\nfunc main() {\n    s, schedulerErr := scheduler.NewScheduler(1000)\n    if schedulerErr != nil  {\n        panic(schedulerErr)\n    }\n    s.Every().Second(1).Do(keepAlive2)\n    for {\n\n    }\n}\n</code></pre>\n"}, {"tags": ["javascript", "html", "go", "go-templates"], "comments": [{"owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "edited": false, "score": 1, "creation_date": 1575251705, "post_id": 59131163, "comment_id": 104491448, "body": "Your go code (modified so it runs) works OK for me (code in playground - <a href=\"https://play.golang.org/p/3t6J2Mi5VW9\" rel=\"nofollow noreferrer\">play.golang.org/p/3t6J2Mi5VW9</a> - note you cannot run it there). The login button does not work (I think thats an issue with your HTML) but navigating directly to <a href=\"http://127.0.0.1:3000/home\" rel=\"nofollow noreferrer\">127.0.0.1:3000/home</a> does."}, {"owner": {"reputation": 1, "user_id": 10204041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Za0S35vAiko/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o7elw3dV_CzjHhfho7MNGJzuJ9PQ/mo/photo.jpg?sz=128", "display_name": "Stevan Cunningham", "link": "https://stackoverflow.com/users/10204041/stevan-cunningham"}, "reply_to_user": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "edited": false, "score": 0, "creation_date": 1575263102, "post_id": 59131163, "comment_id": 104493629, "body": "It looks like after an IDE restart the code started working! Lol thank you for the help."}], "owner": {"reputation": 1, "user_id": 10204041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Za0S35vAiko/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o7elw3dV_CzjHhfho7MNGJzuJ9PQ/mo/photo.jpg?sz=128", "display_name": "Stevan Cunningham", "link": "https://stackoverflow.com/users/10204041/stevan-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575245151, "creation_date": 1575245151, "question_id": 59131163, "link": "https://stackoverflow.com/questions/59131163/second-html-template-wont-render-in-golang-application", "title": "Second HTML Template Won&#39;t Render in Golang Application", "body": "<p>In my application, the <code>login.html</code> template is rendering just fine, but for some reason <code>home.html</code> won't render. It just reloads <code>login.html</code>. I've tried accessing it by clicking the Login button (which has an action attached to send it to \"/home.html\"), and by just trying to access \"<a href=\"http://localhost:3000/home.html\" rel=\"nofollow noreferrer\">http://localhost:3000/home.html</a>\" but the result is the same. Could someone please point me in the right direction?</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"text/template\"\n\n    \"movieapp/db\"\n)\n\nvar loginTmpl, homeTmpl *template.Template\n\nfunc init() {\n    homeTmpl = template.Must(template.ParseFiles(\"templates/home.html\"))\n    fmt.Printf(\"Created template: %v\\n\", homeTmpl)\n\n    loginTmpl = template.Must(template.ParseFiles(\"templates/login.html\"))\n    fmt.Printf(\"Created template: %v\\n\", loginTmpl)\n}\n\nfunc main() {\n    db.Login()\n\n    fs := http.FileServer(http.Dir(\"static\"))\n    http.Handle(\"/static/\", http.StripPrefix(\"/static/\", fs))\n\n    http.HandleFunc(\"/\", loginHandler)\n    http.HandleFunc(\"/home\", homeHandler)\n\n    log.Println(\"listening...\")\n    http.ListenAndServe(\":3000\", nil)\n}\n\nfunc loginHandler(w http.ResponseWriter, r *http.Request) {\n    if err := loginTmpl.ExecuteTemplate(w, \"login\", nil); err != nil {\n        log.Printf(\"Failed to execute template: %+v\", err)\n    }\n    fmt.Printf(\"Request Method: \" + r.Method + \" Request URL: \" + r.URL.EscapedPath() + \"\\n\")\n}\n\nfunc homeHandler(w http.ResponseWriter, r *http.Request) {\n    if err := homeTmpl.ExecuteTemplate(w, \"home\", nil); err != nil {\n        log.Printf(\"Failed to execute template: %+v\", err)\n    }\n    fmt.Printf(\"Request Method: \" + r.Method + \" Request URL: \" + r.URL.EscapedPath() + \"\\n\")\n}\n</code></pre>\n\n<p>home.html</p>\n\n<pre><code>{{define \"home\"}}\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n        &lt;title&gt;Login Successful&lt;/title&gt;\n    &lt;/head&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>login.html</p>\n\n<pre><code>{{define \"login\"}}\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;title&gt;MovieList&lt;/title&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n&lt;!--===============================================================================================--&gt;  \n    &lt;link rel=\"icon\" type=\"image/png\" href=\"static/images/icons/favicon.ico\"/&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/vendor/bootstrap/css/bootstrap.min.css\"&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/fonts/font-awesome-4.7.0/css/font-awesome.min.css\"&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/fonts/Linearicons-Free-v1.0.0/icon-font.min.css\"&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/vendor/animate/animate.css\"&gt;\n&lt;!--===============================================================================================--&gt;  \n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/vendor/css-hamburgers/hamburgers.min.css\"&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/vendor/animsition/css/animsition.min.css\"&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/vendor/select2/select2.min.css\"&gt;\n&lt;!--===============================================================================================--&gt;  \n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/vendor/daterangepicker/daterangepicker.css\"&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/css/util.css\"&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"static/css/main.css\"&gt;\n&lt;!--===============================================================================================--&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n    &lt;div class=\"limiter\"&gt;\n        &lt;div class=\"container-login100\"&gt;\n            &lt;div class=\"wrap-login100 p-l-85 p-r-85 p-t-55 p-b-55\"&gt;\n                &lt;form class=\"login100-form validate-form flex-sb flex-w\" action=\"/home.html\"&gt;\n                    &lt;span class=\"login100-form-title p-b-32\"&gt;\n                        Account Login\n                    &lt;/span&gt;\n\n                    &lt;span class=\"txt1 p-b-11\"&gt;\n                        Username\n                    &lt;/span&gt;\n                    &lt;div class=\"wrap-input100 validate-input m-b-36\" data-validate = \"Username is required\"&gt;\n                        &lt;input class=\"input100\" type=\"text\" name=\"username\" &gt;\n                        &lt;span class=\"focus-input100\"&gt;&lt;/span&gt;\n                    &lt;/div&gt;\n\n                    &lt;span class=\"txt1 p-b-11\"&gt;\n                        Password\n                    &lt;/span&gt;\n                    &lt;div class=\"wrap-input100 validate-input m-b-12\" data-validate = \"Password is required\"&gt;\n                        &lt;span class=\"btn-show-pass\"&gt;\n                            &lt;i class=\"fa fa-eye\"&gt;&lt;/i&gt;\n                        &lt;/span&gt;\n                        &lt;input class=\"input100\" type=\"password\" name=\"pass\" &gt;\n                        &lt;span class=\"focus-input100\"&gt;&lt;/span&gt;\n                    &lt;/div&gt;\n\n                    &lt;div class=\"flex-sb-m w-full p-b-48\"&gt;\n                        &lt;div class=\"contact100-form-checkbox\"&gt;\n                            &lt;input class=\"input-checkbox100\" id=\"ckb1\" type=\"checkbox\" name=\"remember-me\"&gt;\n                            &lt;label class=\"label-checkbox100\" for=\"ckb1\"&gt;\n                                Remember me\n                            &lt;/label&gt;\n                        &lt;/div&gt;\n\n                        &lt;div&gt;\n                            &lt;a href=\"#\" class=\"txt3\"&gt;\n                                Forgot Password?\n                            &lt;/a&gt;\n                        &lt;/div&gt;\n                    &lt;/div&gt;\n\n                    &lt;div class=\"container-login100-form-btn\"&gt;\n                        &lt;button class=\"login100-form-btn\" action=\"/home.html\"&gt;\n                            Login\n                        &lt;/button&gt;\n                    &lt;/div&gt;\n\n                &lt;/form&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n\n    &lt;div id=\"dropDownSelect1\"&gt;&lt;/div&gt;\n\n&lt;!--===============================================================================================--&gt;\n    &lt;script src=\"static/vendor/jquery/jquery-3.2.1.min.js\"&gt;&lt;/script&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;script src=\"static/vendor/animsition/js/animsition.min.js\"&gt;&lt;/script&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;script src=\"static/vendor/bootstrap/js/popper.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"static/vendor/bootstrap/js/bootstrap.min.js\"&gt;&lt;/script&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;script src=\"static/vendor/select2/select2.min.js\"&gt;&lt;/script&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;script src=\"static/vendor/daterangepicker/moment.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"static/vendor/daterangepicker/daterangepicker.js\"&gt;&lt;/script&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;script src=\"static/vendor/countdowntime/countdowntime.js\"&gt;&lt;/script&gt;\n&lt;!--===============================================================================================--&gt;\n    &lt;script src=\"static/js/main.js\"&gt;&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n"}, {"tags": ["apache", "go"], "comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 1, "creation_date": 1575249551, "post_id": 59130851, "comment_id": 104491088, "body": "Is there a reason Apache is relevant here?  Are you aware that you can reach the Go application directly without needing Apache?"}], "answers": [{"comments": [{"owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "edited": false, "score": 0, "creation_date": 1575273428, "post_id": 59130983, "comment_id": 104496846, "body": "This will fix your problem. Than you can reach the GO services sending a request at @your_domain/test. The port is now 80 cause will be Apache that, acting as a proxy layer, will forward the request to the backend application"}], "tags": [], "owner": {"reputation": 271, "user_id": 5555623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef9afadd1a189b6bc05c227778cff190?s=128&d=identicon&r=PG&f=1", "display_name": "George Myl", "link": "https://stackoverflow.com/users/5555623/george-myl"}, "is_accepted": false, "score": 2, "last_activity_date": 1575243159, "creation_date": 1575243159, "answer_id": 59130983, "question_id": 59130851, "link": "https://stackoverflow.com/questions/59130851/how-to-add-a-go-service-to-an-existing-apache-server-already-serving-php/59130983#59130983", "title": "How to Add a go service to an existing Apache server already serving PHP", "body": "<p>You need to configure apache to act as a proxy for the golang project.\nTry something like this</p>\n\n<pre><code>ProxyPass /test http://0.0.0.0:8084/\nProxyPassReverse /test http://0.0.0.0:8084/\n</code></pre>\n\n<p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-apache-http-server-as-reverse-proxy-using-mod_proxy-extension\" rel=\"nofollow noreferrer\">https://www.digitalocean.com/community/tutorials/how-to-use-apache-http-server-as-reverse-proxy-using-mod_proxy-extension</a></p>\n"}], "owner": {"reputation": 37, "user_id": 1784409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/126bd66a1c64a1c31830012786058664?s=128&d=identicon&r=PG", "display_name": "user1784409", "link": "https://stackoverflow.com/users/1784409/user1784409"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1575243875, "creation_date": 1575241763, "last_edit_date": 1575243875, "question_id": 59130851, "link": "https://stackoverflow.com/questions/59130851/how-to-add-a-go-service-to-an-existing-apache-server-already-serving-php", "title": "How to Add a go service to an existing Apache server already serving PHP", "body": "<p>For an existing Apache server (Windows) that serves PHP, I want to add a go service that just contains REST endpoints, but need the existing PHP server to remain operational.</p>\n\n<p>1) I cross compiled a go test application with a \"/test\" route and have it listening on port 8084</p>\n\n<p>2) I am able to run the go application on the server, but when I accessed it directly with the IP address and port XX.XX.XX.XX:8084/test, nothing came back.</p>\n\n<p>3) The Apache server is attached to port 80, with a domain name (fake) of aaa.bbb.com</p>\n\n<p>Questions:\n1) Does it matter which port I use?  (I chose 8084 for testing locally as I have a bunch of other services running)\n2) Do I need to add anything to the httpd.conf file for the apache server so that the routes in the go app are automatically associated with the aaa.bbb.com domain?\n3) Does it matter what folder I place the go exe file in?  (I realize it will need to be a service so that it executes on startup of the server, but just testing for now)</p>\n\n<p>I have little experience on server setup, so apologize if my terminology is off a bit.</p>\n"}, {"tags": ["linux", "go", "memory"], "answers": [{"tags": [], "owner": {"reputation": 884, "user_id": 380247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ba8cab2eb1a3727d54aaf5f3f40d144?s=128&d=identicon&r=PG", "display_name": "Igor Mikushkin", "link": "https://stackoverflow.com/users/380247/igor-mikushkin"}, "is_accepted": true, "score": -1, "last_activity_date": 1575579015, "last_edit_date": 1575579015, "creation_date": 1575238838, "answer_id": 59130520, "question_id": 59130519, "link": "https://stackoverflow.com/questions/59130519/how-to-get-resident-set-size-rss/59130520#59130520", "title": "How to get Resident Set Size (RSS)", "body": "<p>You can parse /proc/self/statm file. It contains only integers so it is easy to parse. Second field is RSS measured in pages.</p>\n\n<pre><code>func getRss() (int64, error) {\n    buf, err := ioutil.ReadFile(\"/proc/self/statm\")\n    if err != nil {\n        return 0, err\n    }\n\n    fields := strings.Split(string(buf), \" \")\n    if len(fields) &lt; 2 {\n        return 0, errors.New(\"Cannot parse statm\")\n    }\n\n    rss, err := strconv.ParseInt(fields[1], 10, 64)\n    if err != nil {\n        return 0, err\n    }\n\n    return rss * int64(os.Getpagesize()), err\n}\n</code></pre>\n"}], "owner": {"reputation": 884, "user_id": 380247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ba8cab2eb1a3727d54aaf5f3f40d144?s=128&d=identicon&r=PG", "display_name": "Igor Mikushkin", "link": "https://stackoverflow.com/users/380247/igor-mikushkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 59130520, "answer_count": 1, "score": -2, "last_activity_date": 1575579015, "creation_date": 1575238838, "last_edit_date": 1575578512, "question_id": 59130519, "link": "https://stackoverflow.com/questions/59130519/how-to-get-resident-set-size-rss", "title": "How to get Resident Set Size (RSS)", "body": "<p>I need to know physical memory consumption of my Go process in Linux.\nWhat I need is <em>Resident Set Size (RSS)</em>.</p>\n\n<p><code>runtime.ReadMemStats</code> is not suitable because there is no way to get the size of the portion of virtual memory that is resident.</p>\n\n<p><code>syscall.Getrusage</code> is not suitable because it returns only <code>Maxrss</code> that is maximal RSS during process life.</p>\n\n<p>How can I query RSS in Go?</p>\n"}, {"tags": ["sql", "postgresql", "go", "orm", "go-gorm"], "comments": [{"owner": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1575235241, "post_id": 59130085, "comment_id": 104488052, "body": "have you tried <code>not exists</code>?"}, {"owner": {"reputation": 1, "user_id": 8779300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c378a9288bfab33d22bbe961112b44a6?s=128&d=identicon&r=PG", "display_name": "Kacper Kleczewski", "link": "https://stackoverflow.com/users/8779300/kacper-kleczewski"}, "reply_to_user": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1575240664, "post_id": 59130085, "comment_id": 104489485, "body": "Yes, I used that: <code>queryString := &quot;SELECT * FROM gpus WHERE NOT EXISTS (SELECT *</code> <code>FROM computers WHERE computers.current_gpu_id = gpus.id)&quot;</code> \t<code>db.Raw(queryString).Scan(&amp;gpus)</code> It behaves exactly the same as previous queries. I added 4 four gpus to database and it is returning all gpus except the first one."}], "owner": {"reputation": 1, "user_id": 8779300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c378a9288bfab33d22bbe961112b44a6?s=128&d=identicon&r=PG", "display_name": "Kacper Kleczewski", "link": "https://stackoverflow.com/users/8779300/kacper-kleczewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1575235195, "creation_date": 1575235101, "last_edit_date": 1575235195, "question_id": 59130085, "link": "https://stackoverflow.com/questions/59130085/selecting-all-records-from-one-table-that-doesnt-have-corresponding-records-in", "title": "Selecting all records from one table that doesn&#39;t have corresponding records in related table doesn&#39;t work", "body": "<p>I am using GORM and PostgreSQL as my storage solution.\nI can't find any way to query all records from one table that doesn't have corresponding records in related table. Let's take a look at these tables for example:</p>\n\n<pre><code>Computers\n  id               int\n  current_gpu_id   int (foreign_key to Gpus table)\n\nGpus\n  id               int\n  gpu_name         string\n</code></pre>\n\n<p>I am trying to select all gpus that are not present in any computer. I know that there are few options for that:</p>\n\n<pre><code>SELECT * FROM gpus WHERE gpus.id NOT IN (SELECT current_gpu_id FROM computers)\nor\nSELECT * FROM gpus left join computers on computers.current_gpu_id = gpus.id where computers.current_gpu_id is null\n</code></pre>\n\n<p>These queries works perfectly in query pgAdmin Query Tool but doesn't work in GO GORM code.</p>\n\n<pre><code>    gpus := make([]Gpu, limit)\n\n    // Option 1\n    db.Joins(\"left join computers on computers.current_gpu_id = gpus.id\").Where(\"computers.current_gpu_id is null\").Find(&amp;gpus)\n\n    // Option 2\n    queryString := \"SELECT * FROM gpus WHERE gpus.id NOT IN (SELECT current_gpu_id FROM computers)\"\n    db.Raw(queryString).Scan(&amp;gpus)\n\n    // Option 3\n    db.Table(\"gpus\").Select(\"gpus.id, gpus.sn, gpus.name\").Joins(\"left join computers on computers.current_gpu_id = gpus.id\").Where(\"computers.current_gpu_id is null\").Scan(&amp;gpus)\n</code></pre>\n\n<p>Is it a GORM bug or am I doing something wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1575233732, "post_id": 59129855, "comment_id": 104487612, "body": "<code>c</code> and <code>ok</code> are never printed, because nothing else is ever sent over the <code>boom</code> channel. It&#39;s pretty straight forward. Did you expect otherwise? If you want to reuse it, you must <a href=\"https://golang.org/pkg/time/#Timer.Reset\" rel=\"nofollow noreferrer\">Reset</a> it."}, {"owner": {"reputation": 272, "user_id": 6305227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0e364d65784684adeaca3aa01e5c7575?s=128&d=identicon&r=PG&f=1", "display_name": "shmth", "link": "https://stackoverflow.com/users/6305227/shmth"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575238271, "post_id": 59129855, "comment_id": 104488891, "body": "@Flimzy but in that case wouldn&#39;t receive block forever? How does the program terminate?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575276512, "post_id": 59129855, "comment_id": 104498044, "body": "I don&#39;t understand your question. As it is, your receive blocks forever, because nothing is ever sent."}], "answers": [{"comments": [{"owner": {"reputation": 272, "user_id": 6305227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0e364d65784684adeaca3aa01e5c7575?s=128&d=identicon&r=PG&f=1", "display_name": "shmth", "link": "https://stackoverflow.com/users/6305227/shmth"}, "edited": false, "score": 0, "creation_date": 1575256809, "post_id": 59130602, "comment_id": 104492398, "body": "The thing that is confusing me is that the program <i>does</i> terminate. Or at least it does when I run it in the go playground (you can copy/paste my code and try it for yourself?). As far as I understand it shouldn&#39;t terminate, which is why I&#39;m confused"}, {"owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "reply_to_user": {"reputation": 272, "user_id": 6305227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0e364d65784684adeaca3aa01e5c7575?s=128&d=identicon&r=PG&f=1", "display_name": "shmth", "link": "https://stackoverflow.com/users/6305227/shmth"}, "edited": false, "score": 1, "creation_date": 1575257177, "post_id": 59130602, "comment_id": 104492471, "body": "In the go playground it exits with &quot;Program exited: process took too long.&quot;. This is because the go playground runs applications within a sandbox which limits execution time (amoungst other things). Without this someone would be using it to mine bitcoin :-). Try running it on your computer and it will not exit."}, {"owner": {"reputation": 272, "user_id": 6305227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0e364d65784684adeaca3aa01e5c7575?s=128&d=identicon&r=PG&f=1", "display_name": "shmth", "link": "https://stackoverflow.com/users/6305227/shmth"}, "edited": false, "score": 0, "creation_date": 1575258552, "post_id": 59130602, "comment_id": 104492728, "body": "Really? For me it exits without any error in the go playground :/"}, {"owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "reply_to_user": {"reputation": 272, "user_id": 6305227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0e364d65784684adeaca3aa01e5c7575?s=128&d=identicon&r=PG&f=1", "display_name": "shmth", "link": "https://stackoverflow.com/users/6305227/shmth"}, "edited": false, "score": 1, "creation_date": 1575260849, "post_id": 59130602, "comment_id": 104493176, "body": "I copied/pasted your code into the playground at <a href=\"https://play.golang.org/p/dJE9LE1eMNP\" rel=\"nofollow noreferrer\">play.golang.org/p/dJE9LE1eMNP</a> running that gives me &quot;Program exited: process took too long.&quot;"}], "tags": [], "owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "is_accepted": true, "score": 1, "last_activity_date": 1575239666, "creation_date": 1575239666, "answer_id": 59130602, "question_id": 59129855, "link": "https://stackoverflow.com/questions/59129855/what-happens-if-you-try-to-receive-from-a-timer-channel-again-after-it-has-expir/59130602#59130602", "title": "What happens if you try to receive from a Timer channel again after it has expired", "body": "<p>Consider what time.After does (quote from <a href=\"https://golang.org/pkg/time/#After\" rel=\"nofollow noreferrer\">go docs</a>):</p>\n\n<blockquote>\n  <p>After waits for the duration to elapse and then sends the current time\n  on the returned channel.</p>\n</blockquote>\n\n<p>So <code>boom := time.After(500 * time.Millisecond)</code> will return a channel and send a single message to that channel after 500ms. Now lets consider your code:</p>\n\n<pre><code>case &lt;-boom:\n   fmt.Println(\"BOOM!\")\n   c, ok := &lt;-boom\n   fmt.Println(c)\n   fmt.Println(ok)\n</code></pre>\n\n<p>When something is received on the boom channel your code prints \"boom\" and then waits for something else on the boom channel. However only one thing is ever sent to the boom channel so the statement <code>c, ok := &lt;-boom</code> will never complete (and your application will never terminate). If you changed boom from a <code>time.After</code> to a <code>time.Tick</code> then you might see something more like what you were expecting (the application will still run for ever).</p>\n\n<p>The original code is a bit different:</p>\n\n<pre><code>case &lt;-boom:\n            fmt.Println(\"BOOM!\")\n            return\n</code></pre>\n\n<p>It receives the message, prints boom and then returns (ending the program). If you want your code to get to the bit where it outputs 'finnished' then you need something like the code below. Note that the label <code>loop</code> is needed <a href=\"https://golang.org/ref/spec#Break_statements\" rel=\"nofollow noreferrer\">because break</a>:</p>\n\n<blockquote>\n  <p>terminates execution of the innermost \"for\", \"switch\", or \"select\"</p>\n</blockquote>\n\n<p>so without the label break would exit the select but the for loop would continue.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    tick := time.Tick(100 * time.Millisecond)\n    boom := time.After(500 * time.Millisecond)\nloop:\n    for {\n        select {\n        case &lt;-tick:\n            fmt.Println(\"tick.\")\n        case &lt;-boom:\n            fmt.Println(\"BOOM!\")\n            break loop\n        default:\n            fmt.Println(\"    .\")\n            time.Sleep(50 * time.Millisecond)\n        }\n    }\n    fmt.Println(\"Finished\")\n}\n</code></pre>\n"}], "owner": {"reputation": 272, "user_id": 6305227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0e364d65784684adeaca3aa01e5c7575?s=128&d=identicon&r=PG&f=1", "display_name": "shmth", "link": "https://stackoverflow.com/users/6305227/shmth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 59130602, "answer_count": 1, "score": -1, "last_activity_date": 1575239666, "creation_date": 1575233484, "last_edit_date": 1575233499, "question_id": 59129855, "link": "https://stackoverflow.com/questions/59129855/what-happens-if-you-try-to-receive-from-a-timer-channel-again-after-it-has-expir", "title": "What happens if you try to receive from a Timer channel again after it has expired", "body": "<p>I'm playing around with one of the <a href=\"https://tour.golang.org/concurrency/6\" rel=\"nofollow noreferrer\">examples</a> from the Tour of Go tutorial. I've edited the code as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    tick := time.Tick(100 * time.Millisecond)\n    boom := time.After(500 * time.Millisecond)\n    for {\n        select {\n        case &lt;-tick:\n            fmt.Println(\"tick.\")\n        case &lt;-boom:\n            fmt.Println(\"BOOM!\")\n            c, ok := &lt;-boom\n            fmt.Println(c)\n            fmt.Println(ok)\n        default:\n            fmt.Println(\"    .\")\n            time.Sleep(50 * time.Millisecond)\n        }\n    }\n    fmt.Println(\"Finished\")\n}\n</code></pre>\n\n<p>However, the output of the code is as follows:</p>\n\n<pre><code>    .\n    .\ntick.\n    .\n    .\ntick.\n    .\n    .\ntick.\n    .\n    .\ntick.\n    .\n    .\ntick.\nBOOM!\n</code></pre>\n\n<p><code>c</code> and <code>ok</code> are never printed, and the very last \"Finished\" is never printed either. Can someone help me understand what exactly happens when I try to receive from the <code>boom</code> channel the second time?</p>\n"}, {"tags": ["go", "matrix-multiplication", "channel", "goroutine"], "comments": [{"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 3, "creation_date": 1575228194, "post_id": 59128141, "comment_id": 104486158, "body": "Compilation time is not affected by how many goroutine you spawn. You probably meant execution time, right?"}], "answers": [{"tags": [], "owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "is_accepted": false, "score": 1, "last_activity_date": 1575230793, "creation_date": 1575230793, "answer_id": 59129492, "question_id": 59128141, "link": "https://stackoverflow.com/questions/59128141/matrix-multiplication-using-goroutines-and-channels/59129492#59129492", "title": "&quot;Matrix multiplication&quot; using goroutines and channels", "body": "<p>Your code is quite difficult to follow (calling variables dummy1/dummy2 is confusing particularly when they get different names in <code>Calc</code>) and adding some comments would make it more easily understood. </p>\n\n<p>Firstly a bug. After sending data to be calculated you <code>dummy1 &lt;- -1</code> and I believe you expect this to wait for all calculations to be complete. However that is not necessarily the case when you have multiple goroutines. The channel will be drained by ONE of the goroutines and the timing info printed out; other goroutines will still be running (and may not have finnished their calculations).</p>\n\n<p>In terms of timing I suspect that the way you are sending data to the go routines will slow things down; you send the row and then the column; because the channels are not buffered the goroutine will block while waiting for the column (switching back to the main goroutine to send the column). This back and forth will slow the rate at which your goroutines get data and may well explain why adding extra goroutines has a limited impact (it also becomes dangerous if you use buffered channels).</p>\n\n<p>I have refactored your code (note there may be bugs and its far from perfect!) into something that does show a difference (on my computer 1 goroutine = 10s; 5 = 7s):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\nconst length = 1000\n\nvar start time.Time\nvar rez [length][length]int\n\n// toMultiply will hold details of what the goroutine will be multiplying (one row and one column)\ntype toMultiply struct {\n    rowNo    int\n    columnNo int\n    row      []int\n    column   []int\n}\n\nfunc main() {\n    const noOfGoRoutines = 5\n\n    // Build up a matrix of dimensions (length) x (length)\n    var a [length][length]int\n    var b [length][length]int\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            a[i][j] = rand.Intn(10)\n            b[i][j] = rand.Intn(10)\n        }\n    }\n\n    // Setup completed so start the clock...\n    start = time.Now()\n\n    // Start off threadlength go routines to multiply each row/column\n    toCalc := make(chan toMultiply)\n    var wg sync.WaitGroup\n    wg.Add(noOfGoRoutines)\n    for i := 0; i &lt; noOfGoRoutines; i++ {\n        go func() {\n            Calc(toCalc)\n            wg.Done()\n        }()\n    }\n\n    // Begin the multiplication.\n    start = time.Now()\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            tm := toMultiply{\n                rowNo:    i,\n                columnNo: j,\n                row:      make([]int, length),\n                column:   make([]int, length),\n            }\n\n            for k := 0; k &lt; length; k++ {\n                tm.row[k] = a[i][j]\n                tm.column[k] = b[i][k]\n            }\n            toCalc &lt;- tm\n        }\n    }\n\n    // All of the data has been sent to the chanel; now we need to wait for all of the\n    // goroutines to complete\n    close(toCalc)\n    wg.Wait()\n\n    fmt.Println(\"Binomial took \", time.Since(start))\n\n    // The full result should be in tz\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            //fmt.Print(rez[i][j])\n            //fmt.Print(\" \")\n        }\n        //fmt.Println(\" \")\n    }\n}\n\n// Calc - Multiply a row from one matrix with a column from another\nfunc Calc(toCalc &lt;-chan toMultiply) {\n    for tc := range toCalc {\n        var result int\n        for i := 0; i &lt; len(tc.row); i++ {\n            result += tc.row[i] * tc.column[i]\n        }\n        // warning - the below should work in this case but be careful writing to global variables from goroutines\n        rez[tc.rowNo][tc.columnNo] = result\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "edited": false, "score": 0, "creation_date": 1575234776, "post_id": 59129681, "comment_id": 104487925, "body": "&quot;When a go routine has finished processing the struct (n-1,m-1) it closes the done channel&quot;; this assumes that the goroutines will finnish in the same order as data was received but I don&#39;t believe is necessarily the case? (I don&#39;t believe your example code actually needs this; you could remove all references to done and your solution would still run OK because of the waitgroup). Other than that your solution will be quicker than mine."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "edited": false, "score": 0, "creation_date": 1575235401, "post_id": 59129681, "comment_id": 104488095, "body": "@Brits the only assumption is that data is read in the same order they were written to the channel. We do need a wait to notify go routines to terminate. They could close the pairs channel instead of the done channel. We could get rid of done channel this way."}, {"owner": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "edited": false, "score": 0, "creation_date": 1575236706, "post_id": 59129681, "comment_id": 104488462, "body": "As you say done will always be closed when the calculation for the last item on the channel has been calculated; however this does not mean that prior calculations have been completed (the waitgroup does that). Removing the done channel entirely would have no real impact on your code as you already close pairs (and there is no need to wait for everything to be read before doing so; values added to a buffered channel can still be read after its closed; e.g.  <a href=\"https://play.golang.org/p/G_eD__kYXMK\" rel=\"nofollow noreferrer\">play.golang.org/p/G_eD__kYXMK</a> )"}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 3611, "user_id": 11810946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf8bed7e8aa9c830f4aa4e889c58175?s=128&d=identicon&r=PG&f=1", "display_name": "Brits", "link": "https://stackoverflow.com/users/11810946/brits"}, "edited": false, "score": 0, "creation_date": 1575269596, "post_id": 59129681, "comment_id": 104495497, "body": "@Brits you are right. I removed the done channel in the code."}], "tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": true, "score": 2, "last_activity_date": 1575269478, "last_edit_date": 1575269478, "creation_date": 1575232230, "answer_id": 59129681, "question_id": 59128141, "link": "https://stackoverflow.com/questions/59128141/matrix-multiplication-using-goroutines-and-channels/59129681#59129681", "title": "&quot;Matrix multiplication&quot; using goroutines and channels", "body": "<p>You don't see a difference because preparing the data to pass to the go routines is your bottleneck. It's slower or as fast as performing the calc. </p>\n\n<p>Passing a copy of the rows and columns is not a good strategy. This is killing the performance. </p>\n\n<p>The go routines may read data directly from the input matrix that are read only. There is no possible race condition here.</p>\n\n<p>Same for output. If a go routine computes the multiplication of a row and a column, it will write the result in a distinct cell. There is also no possible race conditions here. </p>\n\n<p>What to do is the following. Define a struct with two fields, one for the row and one for the column to multiply. </p>\n\n<p>Fill a buffered channel with all possible combinations of row and columns to multiply from (0,0) to (n-1,m-1).</p>\n\n<p>The go routines, consume the structs from the channel, perform the computation and write the result directly into the output matrix. </p>\n\n<p>You then also have a done channel to signal to the main go routine that the computation is done. When a go routine has finished processing the struct (n-1,m-1) it closes the done channel. </p>\n\n<p>The main go routine waits on the done channel after it has written all structs. Once the done channel is closed, it prints the elapsed time. \nWe can use a waiting group to wait that all go routine terminated their computation.</p>\n\n<p>You can then start with one go routine and increase the number of go routines to see the impact of the processing time. </p>\n\n<p>See the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\ntype pair struct {\n    row, col int\n}\n\nconst length = 1000\n\nvar start time.Time\nvar rez [length][length]int\n\nfunc main() {\n    const threadlength = 1\n    pairs := make(chan pair, 1000)\n    var wg sync.WaitGroup\n    var a [length][length]int\n    var b [length][length]int\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            a[i][j] = rand.Intn(10)\n            b[i][j] = rand.Intn(10)\n        }\n    }\n    wg.Add(threadlength)\n    for i := 0; i &lt; threadlength; i++ {\n        go Calc(pairs, &amp;a, &amp;b, &amp;rez, &amp;wg)\n    }\n    start = time.Now()\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            pairs &lt;- pair{row: i, col: j}\n        }\n    }\n    close(pairs)\n    wg.Wait()\n    elapsed := time.Since(start)\n    fmt.Println(\"Binomial took \", elapsed)\n\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            fmt.Print(rez[i][j])\n            fmt.Print(\" \")\n        }\n        fmt.Println(\" \")\n    }\n}\n\nfunc Calc(pairs chan pair, a, b, rez *[length][length]int, wg *sync.WaitGroup) {\n    for {\n        pair, ok := &lt;-pairs\n        if !ok {\n            break\n        }\n        rez[pair.row][pair.col] = 0\n        for i := 0; i &lt; length; i++ {\n            rez[pair.row][pair.col] += a[pair.row][i] * b[i][pair.col]\n        }\n    }\n    wg.Done()\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7076099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23aead0779543cfa30d48dc17992da0?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas Barakauskas", "link": "https://stackoverflow.com/users/7076099/ignas-barakauskas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 59129681, "answer_count": 2, "score": -1, "last_activity_date": 1575269478, "creation_date": 1575221608, "last_edit_date": 1575225897, "question_id": 59128141, "link": "https://stackoverflow.com/questions/59128141/matrix-multiplication-using-goroutines-and-channels", "title": "&quot;Matrix multiplication&quot; using goroutines and channels", "body": "<p>I have a university project for testing time difference for matrix multiplication when I use 1 goroutine, 2 goroutines, 3 and so on. I must use channels. My problem is that doesn't matter how many go routines I add time of compilation is almost always the same. Maybe some one can tell where is the problem. Maybe that sending is very long and it gives all the time. Code is given below</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\nconst length = 1000\nvar start time.Time\nvar rez [length][length]int\nfunc main() {\n    const threadlength = 1\n    toCalcRow := make(chan []int)\n    toCalcColumn := make(chan []int)\n    dummy1 := make(chan int)\n    dummy2 := make(chan int)\n    var row [length + 1]int\n    var column [length + 1]int\n    var a [length][length]int\n    var b [length][length]int\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            a[i][j] = rand.Intn(10)\n            b[i][j] = rand.Intn(10)\n        }\n    }\n    for i := 0; i &lt; threadlength; i++ {\n        go Calc(toCalcRow, toCalcColumn, dummy1, dummy2)\n    }\n    start = time.Now()\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            row[0] = i\n            column[0] = j\n            for k := 0; k &lt; length; k++ {\n                row[k+1] = a[i][j]\n                column[k+1] = b[i][k]\n            }\n            rowSlices := make([]int, len(row))\n            columnSlices := make([]int, len(column))\n            copy(rowSlices, row[:])\n            copy(columnSlices, column[:])\n            toCalcRow &lt;- rowSlices\n            toCalcColumn &lt;- columnSlices\n        }\n    }\n    dummy1 &lt;- -1\n    for i := 0; i &lt; length; i++ {\n        for j := 0; j &lt; length; j++ {\n            fmt.Print(rez[i][j])\n            fmt.Print(\" \")\n        }\n        fmt.Println(\" \")\n    }\n    &lt;-dummy2\n    close(toCalcRow)\n    close(toCalcColumn)\n    close(dummy1)\n}\nfunc Calc(chin1 &lt;-chan []int, chin2 &lt;-chan []int, dummy &lt;-chan int, dummy1 chan&lt;- int) {\nloop:\n    for {\n        select {\n        case row := &lt;-chin1:\n            column := &lt;-chin2\n            var sum [3]int\n            sum[0] = row[0]\n            sum[1] = column[0]\n            for i := 1; i &lt; len(row); i++ {\n                sum[2] += row[i] * column[i]\n            }\n            rez[sum[0]][sum[1]] = sum[2]\n        case &lt;-dummy:\n            elapsed := time.Since(start)\n            fmt.Println(\"Binomial took \", elapsed)\n            dummy1 &lt;- 0\n            break loop\n        }\n    }\n    close(dummy1)\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 1577868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7SGs.jpg?s=128&g=1", "display_name": "jonhadfield", "link": "https://stackoverflow.com/users/1577868/jonhadfield"}, "edited": false, "score": 0, "creation_date": 1575207234, "post_id": 59125849, "comment_id": 104480400, "body": "I understand and agree with what you have put but my code example includes a request to <a href=\"https://golang.org\" rel=\"nofollow noreferrer\">golang.org</a> which is a platform that does return a gzipped response if the client provides <code>Accept-Encoding: gzip</code> in the request. My question refers to the issue that go <i>appears</i> to be sending the correct header yet I don&#39;t get the gzipped response and header."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 109, "user_id": 1577868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7SGs.jpg?s=128&g=1", "display_name": "jonhadfield", "link": "https://stackoverflow.com/users/1577868/jonhadfield"}, "edited": false, "score": 1, "creation_date": 1575208459, "post_id": 59125849, "comment_id": 104480710, "body": "@jonhadfield: That <code>https:&#47;&#47;golang.org</code> will usually return compressed content is a detail I did no see in your question. I&#39;ve updated the answer to add additional information, especially that go will automatically decompress the response and update the response header so you will not get the original <code>Content-Encoding</code> send by the server."}, {"owner": {"reputation": 109, "user_id": 1577868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7SGs.jpg?s=128&g=1", "display_name": "jonhadfield", "link": "https://stackoverflow.com/users/1577868/jonhadfield"}, "edited": false, "score": 0, "creation_date": 1575211149, "post_id": 59125849, "comment_id": 104481415, "body": "Thanks Steffen. I incorrectly assumed the response was returned uncompressed due to the absence of the Content-Encoding header."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 2, "last_activity_date": 1575208361, "last_edit_date": 1575208361, "creation_date": 1575206042, "answer_id": 59125849, "question_id": 59125657, "link": "https://stackoverflow.com/questions/59125657/go-net-http-transport-accept-encoding-gzip-not-prompting-encoded-response/59125849#59125849", "title": "Go net/http Transport Accept-Encoding: gzip not prompting encoded response", "body": "<p><code>Accept-Encoding: gzip</code> only means that the <strong>client is able</strong> and willing to handle gzip compressed content. <strong>It does not mean that the server must actually compress the content</strong>. In fact, for example with images it would not make any sense to compress the content with gzip because these are already compressed data (but not with gzip) and adding gzip on top might actually increase the size of the payload.</p>\n\n<p>If you want your server to return compressed content you actually have to configure your server to do this. See for example <a href=\"https://docs.nginx.com/nginx/admin-guide/web-server/compression/\" rel=\"nofollow noreferrer\">here</a> on how to do this with nginx.</p>\n\n<p>Note that <code>http.Response</code> will <strong>transparently decompress</strong> the response and <strong>update the header</strong> accordingly, i.e. remove <code>Content-Encoding</code>. This means <strong>you will not get the original response header</strong> when checking with <code>resp.Header.Get(\"Content-Encoding\")</code>. If the response was automatically decompressed can be seen in the <code>Uncompressed</code> field:</p>\n\n<pre><code>fmt.Println(\"was compressed \", resp.Uncompressed)\n</code></pre>\n\n<p>For more see <code>go doc http.Response</code>:</p>\n\n<pre><code>// Uncompressed reports whether the response was sent compressed but\n// was decompressed by the http package. When true, reading from\n// Body yields the uncompressed content instead of the compressed\n// content actually set from the server, ContentLength is set to -1,\n// and the \"Content-Length\" and \"Content-Encoding\" fields are deleted\n// from the responseHeader. To get the original response from\n// the server, set Transport.DisableCompression to true.\nUncompressed bool\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 1577868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7SGs.jpg?s=128&g=1", "display_name": "jonhadfield", "link": "https://stackoverflow.com/users/1577868/jonhadfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 59125849, "answer_count": 1, "score": 0, "last_activity_date": 1575208361, "creation_date": 1575204596, "question_id": 59125657, "link": "https://stackoverflow.com/questions/59125657/go-net-http-transport-accept-encoding-gzip-not-prompting-encoded-response", "title": "Go net/http Transport Accept-Encoding: gzip not prompting encoded response", "body": "<p>Possibly related to <a href=\"https://stackoverflow.com/questions/44064556/go-detect-gzip-encoding-to-manually-decompress-response-but-content-encoding\">Go: Detect gzip encoding to manually decompress response, but &#39;Content-Encoding&#39; header missing</a></p>\n\n<p>I understand that net/http Transport will add <code>Accept-Encoding: gzip</code> to a request unless <code>DisableCompression</code> is set to True, and that is required if I want it to automatically decompress a gzipped response. That being the case, the following code does not receive a <code>Content-Encoding: gzip</code> header:<br>\n<a href=\"https://play.golang.org/p/FWs5uG9pZEL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FWs5uG9pZEL</a> (note: will not run in the playground due to network constraints)</p>\n\n<p>If I run a local server and run the above code with it I can see the expected header being sent:</p>\n\n<pre><code>GET / HTTP/1.1\nHost: localhost:5555\nUser-Agent: Go-http-client/1.1\nAccept-Encoding: gzip\n</code></pre>\n\n<p>Is there something else about the connection go creates that is causing the server not to return a gzipped response?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1575209796, "post_id": 59125639, "comment_id": 104481040, "body": "1. <code>http.HandleFunc</code> is a type, not a function. 2. It doesn&#39;t accept a callback. Callbacks are very rare in Go."}, {"owner": {"reputation": 117, "user_id": 8101260, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMzAY-ueF-8/AAAAAAAAAAI/AAAAAAAAAB8/GzQH7Jpzq44/photo.jpg?sz=128", "display_name": "Alan Lal", "link": "https://stackoverflow.com/users/8101260/alan-lal"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575278621, "post_id": 59125639, "comment_id": 104498992, "body": "I thought it was actually callback pattern. Thanks for clearing that up. :)"}], "answers": [{"tags": [], "owner": {"reputation": 3083, "user_id": 4428159, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VkaFW.jpg?s=128&g=1", "display_name": "Umar Hussain", "link": "https://stackoverflow.com/users/4428159/umar-hussain"}, "is_accepted": false, "score": 0, "last_activity_date": 1575205190, "creation_date": 1575205190, "answer_id": 59125741, "question_id": 59125639, "link": "https://stackoverflow.com/questions/59125639/why-are-pointers-used-in-the-callback-of-http-handlefunc/59125741#59125741", "title": "Why are pointers used in the callback of http.HandleFunc", "body": "<p>Since pointer only contains reference, we can use it instead of making a new copy of the request. This way everyone who is working on request struct can see the changes. </p>\n\n<p>There is also good explanation explaining difference between struct and interface. \n<a href=\"https://stackoverflow.com/questions/13255907/in-go-http-handlers-why-is-the-responsewriter-a-value-but-the-request-a-pointer\">In Go HTTP handlers, why is the ResponseWriter a value but the Request a pointer?</a> </p>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 0, "last_activity_date": 1575208817, "creation_date": 1575208817, "answer_id": 59126206, "question_id": 59125639, "link": "https://stackoverflow.com/questions/59125639/why-are-pointers-used-in-the-callback-of-http-handlefunc/59126206#59126206", "title": "Why are pointers used in the callback of http.HandleFunc", "body": "<p>From the docs a <code>http.Request</code> is a quite large &amp; complex struct: <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Request</a></p>\n\n<p>So for efficiency, a pointer is better than copy-by-value non-pointer. </p>\n\n<p>Also passing a pointer allows any modifications to the struct to persist e.g. <a href=\"https://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\">ParseForm</a>.</p>\n"}], "owner": {"reputation": 117, "user_id": 8101260, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DMzAY-ueF-8/AAAAAAAAAAI/AAAAAAAAAB8/GzQH7Jpzq44/photo.jpg?sz=128", "display_name": "Alan Lal", "link": "https://stackoverflow.com/users/8101260/alan-lal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "closed_date": 1575213041, "answer_count": 2, "score": -1, "last_activity_date": 1575208817, "creation_date": 1575204465, "question_id": 59125639, "link": "https://stackoverflow.com/questions/59125639/why-are-pointers-used-in-the-callback-of-http-handlefunc", "closed_reason": "Duplicate", "title": "Why are pointers used in the callback of http.HandleFunc", "body": "<p>I'm trying to learn go for web programming. I came across the <code>http.HandleFunc</code> function , to which i could provide a callback to handle the web request configured to it. </p>\n\n<p>My small program looks like the following.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"sync\"\n)\n\nvar count int\nvar mu sync.Mutex\n\nfunc main() {\n    var p Point\n    http.HandleFunc(\"/\", handler)\n    log.Fatal(http.ListenAndServe(\"localhost:8080\", nil))\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"URL.Path =:%q\\n\", r.URL.Path)\n}\n</code></pre>\n\n<p>Why is the *http.Request in the <code>handler</code> method a pointer? . I understand that this is how the designed it. But I would like to know why they are mandating a pointer instead of a regular value.</p>\n"}, {"tags": ["go", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 1, "last_activity_date": 1575211006, "creation_date": 1575211006, "answer_id": 59126538, "question_id": 59125378, "link": "https://stackoverflow.com/questions/59125378/gcp-permission-issue-when-using-default-credentials-in-go-application/59126538#59126538", "title": "GCP permission issue when using default credentials in Go application", "body": "<p>From GCP , it is also required to enable servceAccountUser role I guess</p>\n\n<blockquote>\n  <p>roles/ compute.admin   Full control of all Compute Engine resources.</p>\n  \n  <p>If the user will be managing virtual machine instances that are\n  configured to run as a service account, you must also grant the\n  roles/iam.serviceAccountUser role.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 31223, "user_id": 11372593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=128", "display_name": "guillaume blaquiere", "link": "https://stackoverflow.com/users/11372593/guillaume-blaquiere"}, "is_accepted": false, "score": 1, "last_activity_date": 1575229070, "creation_date": 1575229070, "answer_id": 59129246, "question_id": 59125378, "link": "https://stackoverflow.com/questions/59125378/gcp-permission-issue-when-using-default-credentials-in-go-application/59129246#59129246", "title": "GCP permission issue when using default credentials in Go application", "body": "<p>When you test with gcloud command, there is a lot of chance that you don't test with your service account but with your personal account. This means that you don't have the same level of permission, and thus the deference of observed behavior. Perform a <code>gcloud config list</code> to view the current configuration and user.</p>\n\n<p>For the permission <code>compute.urlMaps.list</code>, 3 curated roles contain it </p>\n\n<pre><code>roles/compute.viewer\nroles/compute.networkViewer\nroles/compute.instanceAdmin.v1\n</code></pre>\n\n<p>And don't forget to grant, in addition, the role <code>roles/iam.serviceAccountUser</code></p>\n\n<p>Add one of them to your service account.</p>\n"}, {"tags": [], "owner": {"reputation": 1236, "user_id": 1289628, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4ce1c64def03a08f11757ead0ae2b43a?s=128&d=identicon&r=PG", "display_name": "Subhash Chandran", "link": "https://stackoverflow.com/users/1289628/subhash-chandran"}, "is_accepted": false, "score": 1, "last_activity_date": 1575275257, "creation_date": 1575275257, "answer_id": 59135044, "question_id": 59125378, "link": "https://stackoverflow.com/questions/59125378/gcp-permission-issue-when-using-default-credentials-in-go-application/59135044#59135044", "title": "GCP permission issue when using default credentials in Go application", "body": "<p>My colleague identified the issue: I had given the <em>project-name</em> <code>my-prj</code> wrong. A <code>404</code> may have helped me identify the problem faster.</p>\n\n<p>Thanks to the other answers, because adding the role <em>Service Account User</em> is needed.</p>\n"}], "owner": {"reputation": 1236, "user_id": 1289628, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4ce1c64def03a08f11757ead0ae2b43a?s=128&d=identicon&r=PG", "display_name": "Subhash Chandran", "link": "https://stackoverflow.com/users/1289628/subhash-chandran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1575275257, "creation_date": 1575202351, "last_edit_date": 1575202678, "question_id": 59125378, "link": "https://stackoverflow.com/questions/59125378/gcp-permission-issue-when-using-default-credentials-in-go-application", "title": "GCP permission issue when using default credentials in Go application", "body": "<p>My application is fairly small:</p>\n\n<pre><code>import (\n    \"context\"\n    \"fmt\"\n    \"log\"\n\n    \"google.golang.org/api/compute/v1\"\n)\n\nfunc main() {\n    ctx := context.Background()\n    computeService, err := compute.NewService(ctx)\n    urlMapCall := computeService.UrlMaps.List(\"my-prj\")\n    urlMaps, err := urlMapCall.Do()\n    if err != nil {\n        log.Println(err)\n        return\n    }\n    for _, mp := range urlMaps.Items {\n        fmt.Println(mp.Name)\n    }\n}\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>googleapi: Error 403: Required 'compute.urlMaps.list' permission for 'projects/my-prj', forbidden\n</code></pre>\n\n<p>I have the environment variable <code>GOOGLE_APPLICATION_CREDENTIALS=$HOME/.gcp/my-prj-aef233we.json</code> set. The service account this JSON represents has <em>Project Editor</em> and <em>Compute Admin</em> roles.</p>\n\n<p>When I do <code>gcloud compute url-maps list</code>, it works without a flaw.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-bigquery"], "comments": [{"owner": {"reputation": 890, "user_id": 2342292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nW5S1.jpg?s=128&g=1", "display_name": "EldadT", "link": "https://stackoverflow.com/users/2342292/eldadt"}, "reply_to_user": {"reputation": 2672, "user_id": 9208887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b42a62830357a073f912ce786822e1?s=128&d=identicon&r=PG&f=1", "display_name": "The Fool", "link": "https://stackoverflow.com/users/9208887/the-fool"}, "edited": false, "score": 0, "creation_date": 1575194339, "post_id": 59124389, "comment_id": 104477599, "body": "@TheFool the console is not the bq cli (comman line interface)..."}, {"owner": {"reputation": 890, "user_id": 2342292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nW5S1.jpg?s=128&g=1", "display_name": "EldadT", "link": "https://stackoverflow.com/users/2342292/eldadt"}, "reply_to_user": {"reputation": 2672, "user_id": 9208887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b42a62830357a073f912ce786822e1?s=128&d=identicon&r=PG&f=1", "display_name": "The Fool", "link": "https://stackoverflow.com/users/9208887/the-fool"}, "edited": false, "score": 0, "creation_date": 1575194826, "post_id": 59124389, "comment_id": 104477698, "body": "@TheFool console as &quot;<a href=\"https://console.cloud.google.com/\" rel=\"nofollow noreferrer\">console.cloud.google.com</a>&quot;"}, {"owner": {"reputation": 890, "user_id": 2342292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nW5S1.jpg?s=128&g=1", "display_name": "EldadT", "link": "https://stackoverflow.com/users/2342292/eldadt"}, "reply_to_user": {"reputation": 2672, "user_id": 9208887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b42a62830357a073f912ce786822e1?s=128&d=identicon&r=PG&f=1", "display_name": "The Fool", "link": "https://stackoverflow.com/users/9208887/the-fool"}, "edited": false, "score": 0, "creation_date": 1575195491, "post_id": 59124389, "comment_id": 104477842, "body": "all from program that already collects data on all of the tables @TheFool"}, {"owner": {"reputation": 2672, "user_id": 9208887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b42a62830357a073f912ce786822e1?s=128&d=identicon&r=PG&f=1", "display_name": "The Fool", "link": "https://stackoverflow.com/users/9208887/the-fool"}, "edited": false, "score": 0, "creation_date": 1575195715, "post_id": 59124389, "comment_id": 104477888, "body": "<a href=\"https://stackoverflow.com/questions/37679939/how-do-i-execute-a-command-on-a-remote-machine-in-a-golang-cli\" title=\"how do i execute a command on a remote machine in a golang cli\">stackoverflow.com/questions/37679939/&hellip;</a>"}, {"owner": {"reputation": 890, "user_id": 2342292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nW5S1.jpg?s=128&g=1", "display_name": "EldadT", "link": "https://stackoverflow.com/users/2342292/eldadt"}, "reply_to_user": {"reputation": 2672, "user_id": 9208887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b42a62830357a073f912ce786822e1?s=128&d=identicon&r=PG&f=1", "display_name": "The Fool", "link": "https://stackoverflow.com/users/9208887/the-fool"}, "edited": false, "score": 0, "creation_date": 1575195882, "post_id": 59124389, "comment_id": 104477933, "body": "@TheFool I know I can ssh to the gcp consul. but using the bq cli is simpler as with one command I get the info I need"}], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 2342292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nW5S1.jpg?s=128&g=1", "display_name": "EldadT", "link": "https://stackoverflow.com/users/2342292/eldadt"}, "is_accepted": true, "score": 1, "last_activity_date": 1575195436, "creation_date": 1575195436, "answer_id": 59124581, "question_id": 59124389, "link": "https://stackoverflow.com/questions/59124389/how-to-get-bigquery-table-expiration-date-via-query-cli-go/59124581#59124581", "title": "How to get BigQuery table expiration date via query / cli / go?", "body": "<p>this can be done via querying the INFORMATION_SCHEMA.TABLE_OPTIONS:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM `my_project.my_dataset.INFORMATION_SCHEMA.TABLE_OPTIONS`\nwhere option_name='expiration_timestamp'\n</code></pre>\n\n<p>the value will be in the <code>option_name</code> column.</p>\n"}, {"tags": [], "owner": {"reputation": 316, "user_id": 10009743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gonzalo P&#233;rez Fern&#225;ndez", "link": "https://stackoverflow.com/users/10009743/gonzalo-p%c3%a9rez-fern%c3%a1ndez"}, "is_accepted": false, "score": 0, "last_activity_date": 1575281400, "creation_date": 1575281400, "answer_id": 59136654, "question_id": 59124389, "link": "https://stackoverflow.com/questions/59124389/how-to-get-bigquery-table-expiration-date-via-query-cli-go/59136654#59136654", "title": "How to get BigQuery table expiration date via query / cli / go?", "body": "<p>If you want to extract the expiration time from a number of tables in a dataset, you can refer to this documentation [1] (the same query provided by @EldadT), which returns the catalog of tables in a dataset with the expiration time option.</p>\n\n<p>Therefore, if you want to create a script in Python to get the result of this query, you can also check a Client Bigquery Library [2] to run that query and get the expiration time for each table in a dataset.</p>\n\n<p>[1] <a href=\"https://cloud.google.com/bigquery/docs/tables#example_1_2\" rel=\"nofollow noreferrer\">https://cloud.google.com/bigquery/docs/tables#example_1_2</a></p>\n\n<p>[2] <a href=\"https://cloud.google.com/bigquery/docs/reference/libraries#client-libraries-usage-python\" rel=\"nofollow noreferrer\">https://cloud.google.com/bigquery/docs/reference/libraries#client-libraries-usage-python</a></p>\n"}, {"tags": [], "owner": {"reputation": 2734, "user_id": 14048579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17715cf5a52bf335c9b1bd038b9b4ef8?s=128&d=identicon&r=PG&f=1", "display_name": "Soumendra Mishra", "link": "https://stackoverflow.com/users/14048579/soumendra-mishra"}, "is_accepted": false, "score": 0, "last_activity_date": 1597575024, "creation_date": 1597575024, "answer_id": 63435956, "question_id": 59124389, "link": "https://stackoverflow.com/questions/59124389/how-to-get-bigquery-table-expiration-date-via-query-cli-go/63435956#63435956", "title": "How to get BigQuery table expiration date via query / cli / go?", "body": "<p>You can use BigQuery CLI:</p>\n<pre><code>bq show mydataset.mytable\n</code></pre>\n<p><strong>Output:</strong></p>\n<pre><code>Last modified         Schema         Total Rows   Total Bytes     Expiration      Time Partitioning   Clustered Fields   Labels\n----------------- ------------------- ------------ ------------- ----------------- ------------------- ------------------ --------\n 16 Aug 10:42:13   |- col_1: integer   7            106           21 Aug 10:42:13\n                   |- col_2: string\n</code></pre>\n"}], "owner": {"reputation": 890, "user_id": 2342292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nW5S1.jpg?s=128&g=1", "display_name": "EldadT", "link": "https://stackoverflow.com/users/2342292/eldadt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 59124581, "answer_count": 3, "score": 0, "last_activity_date": 1597587831, "creation_date": 1575193970, "last_edit_date": 1597587831, "question_id": 59124389, "link": "https://stackoverflow.com/questions/59124389/how-to-get-bigquery-table-expiration-date-via-query-cli-go", "title": "How to get BigQuery table expiration date via query / cli / go?", "body": "<p>I can't find a way to extract table expiration date that is not via the console (<a href=\"https://console.cloud.google.com/\" rel=\"nofollow noreferrer\">https://console.cloud.google.com/</a>).\nWe maintain thousands of tables in BQ and we want to enforce the use of table expiration date - so the only way is to collect the data automatically.\nis this possible via query/cli/go/python/perl/whatever?</p>\n"}, {"tags": ["go", "cookies", "session-cookies"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1575190871, "post_id": 59123969, "comment_id": 104476912, "body": "Zero and negative values expire the cookie immediately."}, {"owner": {"reputation": 1645, "user_id": 4854993, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/zlGYW.jpg?s=128&g=1", "display_name": "Kevin Bryan", "link": "https://stackoverflow.com/users/4854993/kevin-bryan"}, "edited": false, "score": 0, "creation_date": 1575190930, "post_id": 59123969, "comment_id": 104476924, "body": "I think setting it to -1 means delete and setting it to 0 is infinite amount of time. When I use -1 the cookie is not even created."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1645, "user_id": 4854993, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/zlGYW.jpg?s=128&g=1", "display_name": "Kevin Bryan", "link": "https://stackoverflow.com/users/4854993/kevin-bryan"}, "edited": false, "score": 2, "creation_date": 1575195771, "post_id": 59123969, "comment_id": 104477898, "body": "@StormAsdg: No, read <a href=\"https://golang.org/pkg/net/http/#Cookie\" rel=\"nofollow noreferrer\">the docs</a>. 0 and &lt; 0 have the same behavior. The same is true for alll implementations, according to <a href=\"https://tools.ietf.org/html/rfc6265#page-20\" rel=\"nofollow noreferrer\">RFC 6265</a>."}, {"owner": {"reputation": 1645, "user_id": 4854993, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/zlGYW.jpg?s=128&g=1", "display_name": "Kevin Bryan", "link": "https://stackoverflow.com/users/4854993/kevin-bryan"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575196201, "post_id": 59123969, "comment_id": 104478000, "body": "@Flimzy so you cannot set it to infinite?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1645, "user_id": 4854993, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/zlGYW.jpg?s=128&g=1", "display_name": "Kevin Bryan", "link": "https://stackoverflow.com/users/4854993/kevin-bryan"}, "edited": false, "score": 1, "creation_date": 1575196299, "post_id": 59123969, "comment_id": 104478030, "body": "@StormAsdg: No, <a href=\"https://stackoverflow.com/a/3290474/13860\">you cannot</a>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575214458, "post_id": 59123969, "comment_id": 104482329, "body": "@Flimzy, 0 and &lt; 0 have different behavior per the docs you point to.  When <code>Cookie.MaxAge == 0</code>, the Max-Age parameter is omitted from the response header.  Clients handle cookies with no expiration or max-age parameter as a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Session_cookies\" rel=\"nofollow noreferrer\">session cookie</a>.  When <code>Cookie.MaxAge &lt; 0</code>, the Max-Age parameter is written to the response header as 0.  Clients delete cookies that have an age greater than or equal to the the cookie&#39;s max-age."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1575214898, "post_id": 59123969, "comment_id": 104482476, "body": "The actual functionality is the opposite of what&#39;s described in this answer. Setting Cookie.MaxAge to -1 causes the client to delete the cookie.   Setting Cooke.MaxAge to 0 creates a cookie with the lifetime of the client&#39;s browser session."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1575214954, "post_id": 59123969, "comment_id": 104482497, "body": "@CeriseLim&#243;n: Oh, you&#39;re right. I misinterpreted <code>equivalently &#39;Max-Age: 0&#39;</code> as <code>equivalently &#39;MaxAge = 0&#39;</code>"}], "tags": [], "owner": {"reputation": 155, "user_id": 6063156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab30aedf8a2c54686971bacc692206a?s=128&d=identicon&r=PG&f=1", "display_name": "Yotamz", "link": "https://stackoverflow.com/users/6063156/yotamz"}, "is_accepted": false, "score": -3, "last_activity_date": 1575189997, "creation_date": 1575189997, "answer_id": 59123969, "question_id": 59123909, "link": "https://stackoverflow.com/questions/59123909/cookie-deleted-after-creation/59123969#59123969", "title": "Cookie deleted after creation?", "body": "<p>Setting MaxAge to 0 means delete the cookie immediately.</p>\n\n<p>Use -1 to store the cookie until browser exits.</p>\n"}, {"comments": [{"owner": {"reputation": 1645, "user_id": 4854993, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/zlGYW.jpg?s=128&g=1", "display_name": "Kevin Bryan", "link": "https://stackoverflow.com/users/4854993/kevin-bryan"}, "edited": false, "score": 0, "creation_date": 1575196497, "post_id": 59124625, "comment_id": 104478065, "body": "that&#39;s strange, when I tried it on edge it worked. The cookie is not removed immediately"}], "tags": [], "owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "is_accepted": false, "score": 1, "last_activity_date": 1575195891, "creation_date": 1575195891, "answer_id": 59124625, "question_id": 59123909, "link": "https://stackoverflow.com/questions/59123909/cookie-deleted-after-creation/59124625#59124625", "title": "Cookie deleted after creation?", "body": "<p>According to <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie\" rel=\"nofollow noreferrer\">MDN</a>:</p>\n\n<blockquote>\n  <p>Max-Age: number of seconds until the cookie expires. A zero or negative number will expire the cookie immediately</p>\n</blockquote>\n\n<p>When looking at the source code for the <code>SetCookie</code> func, which calls the cookies' <code>String()</code> method, we can <a href=\"https://golang.org/src/net/http/cookie.go#L208\" rel=\"nofollow noreferrer\">see in line 208</a> that your cookie age of 0 will not be written to the request - your cookie should be accepted.</p>\n\n<p>There might be other factors that might make this cookie invalid from the user-agent side; the server side seems to be fine. What happens when you try a different browser (e.g. Firefox)?</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1575215839, "creation_date": 1575215839, "answer_id": 59127247, "question_id": 59123909, "link": "https://stackoverflow.com/questions/59123909/cookie-deleted-after-creation/59127247#59127247", "title": "Cookie deleted after creation?", "body": "<blockquote>\n  <p>This is a problem because I can't detect the cookie when going to another path.</p>\n</blockquote>\n\n<p>If the path parameter is not set in the set cookie response header, then the client sets the cookie's path to the request path.  Clients only send a cookie to the server when the cookie's path is a path prefix of the request path.</p>\n\n<p>To make a cookie available to all paths, set the path to \"/\".</p>\n\n<pre><code>session = &amp;http.Cookie{\n                Name:   \"session-id\",\n                Value:  sessionID.String(), //uuid\n                Path: \"/\",\n            }\n</code></pre>\n\n<p>(Because the zero value for an integer is 0, there's no need to specify the MaxAge value).</p>\n"}], "owner": {"reputation": 1645, "user_id": 4854993, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/zlGYW.jpg?s=128&g=1", "display_name": "Kevin Bryan", "link": "https://stackoverflow.com/users/4854993/kevin-bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 59127247, "answer_count": 3, "score": -1, "last_activity_date": 1575215839, "creation_date": 1575189448, "last_edit_date": 1575195666, "question_id": 59123909, "link": "https://stackoverflow.com/questions/59123909/cookie-deleted-after-creation", "title": "Cookie deleted after creation?", "body": "<p>I'm creating a session, after the session/cookie is created it vanishes immediately</p>\n\n<pre><code>session, err := r.Cookie(\"session-id\")\n\nif err != nil {\nsession = &amp;http.Cookie{\n                    Name:   \"session-id\",\n                    Value:  sessionID.String(), //uuid\n                    MaxAge: 0,\n                }\nhttp.SetCookie(w, session)\n}\n</code></pre>\n\n<p>I'm not sure if it's being deleted, but the moment the cookie is created it vanishes immediately from google chrome(Application/cookies). This is a problem because I can't detect the cookie when going to another path.</p>\n"}, {"tags": ["arrays", "function", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575196120, "post_id": 59123822, "comment_id": 104477985, "body": "Please read <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">A Tour of Go</a>."}], "answers": [{"comments": [{"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 1, "creation_date": 1575189329, "post_id": 59123865, "comment_id": 104476667, "body": "Technically, these are <i>slices</i> rather than arrays (though non-nil slices have backing or <i>underlying</i> arrays)."}], "tags": [], "owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "is_accepted": true, "score": 0, "last_activity_date": 1575190524, "last_edit_date": 1575190524, "creation_date": 1575189081, "answer_id": 59123865, "question_id": 59123822, "link": "https://stackoverflow.com/questions/59123822/how-to-send-an-array-into-function/59123865#59123865", "title": "How to send an array into function", "body": "<p>You were almost there, here is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc myFunc(arr []int) {\n    fmt.Println(arr)\n}\n\nfunc main() {\n\n    var arr = []int{1, 2, 3, 54, 3}\n    myFunc(arr)\n\n}\n</code></pre>\n\n<p>Live on <a href=\"https://play.golang.org/p/UtlWyABfBzQ\" rel=\"nofollow noreferrer\">playground</a></p>\n\n<p>P.S. As @torek mentioned, to be precise, you are using a slice not an array. Arrays have constant length and cannot grow, and the function signature for array in my example would be <code>myFunc(arr [5]int)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "is_accepted": false, "score": 0, "last_activity_date": 1587839001, "last_edit_date": 1587839001, "creation_date": 1575189289, "answer_id": 59123891, "question_id": 59123822, "link": "https://stackoverflow.com/questions/59123822/how-to-send-an-array-into-function/59123891#59123891", "title": "How to send an array into function", "body": "<p>Sample code in the following (<a href=\"https://play.golang.org/p/BfI7X7uqREw\" rel=\"nofollow noreferrer\">test it online</a>):</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc UsingArray(a [6]int) {\n    fmt.Println(a)\n}\n\nfunc UsingArray2(a []int) {\n    fmt.Println(a)\n}\n\nfunc main() {\n    primes := [6]int{2, 3, 5, 7, 11, 13}\n    UsingArray(primes)\n\n    evens := []int{2, 4, 6, 8, 10, 12}\n    // will fail since [6]int isn't []int\n    // UsingArray(evens)\n    UsingArray2(evens)\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 1875625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f31cb5298b992bbf9fdd7b902e6ece4?s=128&d=identicon&r=PG", "display_name": "siasalar", "link": "https://stackoverflow.com/users/1875625/siasalar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 59123865, "answer_count": 2, "score": -1, "last_activity_date": 1587839001, "creation_date": 1575188743, "last_edit_date": 1575196104, "question_id": 59123822, "link": "https://stackoverflow.com/questions/59123822/how-to-send-an-array-into-function", "title": "How to send an array into function", "body": "<p>I'm looking to find syntax that how can I send an array to use in a function as input in Go.</p>\n\n<p>function <code>UsingArray(a int[])</code></p>\n"}, {"tags": ["pointers", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 479, "user_id": 2911436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7440d55bf27c1d2b26fae3af24ca2fff?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/2911436/john"}, "is_accepted": false, "score": 2, "last_activity_date": 1575171194, "creation_date": 1575171194, "answer_id": 59122296, "question_id": 59122177, "link": "https://stackoverflow.com/questions/59122177/why-i-cannot-append-a-value-to-a-structs-slice-using-a-reference/59122296#59122296", "title": "Why I cannot append a value to a structs&#39; slice using a reference?", "body": "<p>Append returns a new slice that <em>may</em> modify the original backing array of the initial slice. The original slice will still point to the original backing array, not the new one (which may or may not be in the same place in memory)</p>\n\n<p>For example (<a href=\"https://play.golang.org/p/SSpFysC4uZL\" rel=\"nofollow noreferrer\">playground</a>)</p>\n\n<pre><code>slice := []int{1,2,3}\nfmt.Println(len(slice))\n// Output: 3\nnewSlice := append(slice, 4)\nfmt.Println(len(newSlice))\n// Output: 4\nfmt.Println(len(slice))\n// Output: 3 \n</code></pre>\n\n<p>While a slice can be described as a \"fat pointer to an array\", it is not a pointer and therefore you can't dereference it, which is why you get an error.</p>\n\n<p>By creating a pointer to a slice, and using <code>append</code> as you did above, you are setting the slice the pointer points to to the \"new\" slice returned by <code>append</code>.</p>\n\n<p>For more information, check out <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slice Usage And Internals</a></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 2738793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e9131e574494b79796a20d60836ebb1?s=128&d=identicon&r=PG", "display_name": "ACzChef", "link": "https://stackoverflow.com/users/2738793/aczchef"}, "is_accepted": false, "score": 0, "last_activity_date": 1575171617, "creation_date": 1575171617, "answer_id": 59122318, "question_id": 59122177, "link": "https://stackoverflow.com/questions/59122177/why-i-cannot-append-a-value-to-a-structs-slice-using-a-reference/59122318#59122318", "title": "Why I cannot append a value to a structs&#39; slice using a reference?", "body": "<p>Your first attempt didn't work because slices are not pointers, they can be considered reference types. Append will modify the underlying array if it has enough capacity, otherwise it returns a new slice.</p>\n\n<p>You can achieve what you want with a combination of your two attempts. </p>\n\n<p><a href=\"https://play.golang.org/p/3MGvnwGs-3m\" rel=\"nofollow noreferrer\">playground</a></p>\n\n<pre><code>l := Line{\n    Points: []Point{\n        Point{3, 4},\n    },\n}\n\nslice := &amp;l.Points\n\nfor i := 0; i &lt; 100; i++ {\n    *slice = append(*slice, Point{99 + i, 100 + i})\n}\n\nfmt.Println(l.Points)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": false, "score": 6, "last_activity_date": 1575186229, "last_edit_date": 1575186229, "creation_date": 1575172805, "answer_id": 59122398, "question_id": 59122177, "link": "https://stackoverflow.com/questions/59122177/why-i-cannot-append-a-value-to-a-structs-slice-using-a-reference/59122398#59122398", "title": "Why I cannot append a value to a structs&#39; slice using a reference?", "body": "<p>Let's dispense first with a terminology issue.  The <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">Go language specification</a> does not use the word <em>reference</em> the way you are using it.  Go does however have pointers, and pointers are a form of reference.  In addition, slices and maps are kind of special as there's some underlying data\u2014the array underneath a slice, or the storage for a map\u2014that may or may not already exist or be created by declaring or defining a variable whose type is <code>slice of <em>T</em></code> or <code>map[<em>T1</em>]<em>T2</em></code> for some type <em>T</em> or type-pair <em>T1</em> and <em>T2</em>.<sup>1</sup></p>\n\n<p>We can take your usage of the word <em>reference</em> to mean <em>explicit pointer</em> when talking about, e.g.:</p>\n\n<pre><code>func f1(p *int) {\n    // code ...\n}\n</code></pre>\n\n<p>and the implied pointer when talking about:</p>\n\n<pre><code>func f2(m map[T1]T2) { ... }\nfunc f3(s []T) { ... }\n</code></pre>\n\n<p>In <code>f1</code>, <code>p</code> really is a pointer: it thus refers to some actual <code>int</code>, or is <code>nil</code>.  In <code>f2</code>, <code>m</code> refers to some underlying map, or is <code>nil</code>.  In <code>f3</code>, <code>s</code> refers to some underlying array, or is <code>nil</code>.</p>\n\n<p>But if you write:</p>\n\n<blockquote>\n<pre><code>l := Line{\n    Points: []Point{\n        Point{3, 4},\n    },\n}\n</code></pre>\n</blockquote>\n\n<p>then you must have written:</p>\n\n<pre><code>type Line struct {\n    // ... maybe some fields here ...\n    Points []Point\n    // ... maybe more fields here ...\n}\n</code></pre>\n\n<p>This <code>Line</code> is a struct type.  It is not a slice type; it is not a map type.  It <em>contains</em> a slice type but it is not itself one.</p>\n\n<p>You now talk about passing these slices.  If you pass <code>l</code>, you're passing the entire <code>struct</code> by value.  It's pretty important to distinguish between that, and passing the value of <code>l.Points</code>.  The function that receives one of these arguments must declare it with the right type.</p>\n\n<p>For the most part, then, talking about <em>references</em> is just a red herring\u2014a distraction from what's really going on.  What we need to know is: <em>What variables are you assigning what values, using what source code?</em></p>\n\n<p>With all of that out of the way, let's talk about your actual code samples:</p>\n\n<blockquote>\n<pre><code>l.Points = append(l.Points, Point{99, 100})\n</code></pre>\n</blockquote>\n\n<p>This does just what it says:</p>\n\n<ul>\n<li><p>Pass <code>l.Points</code> to <code>append</code>, which is a built-in as it is somewhat magically type-flexible (vs the rest of Go, where types are pretty rigid).  It takes any value of type <code>[]<em>T</em></code> (slice of <em>T</em>, for any valid type <em>T</em>) plus one or more values of type <em><code>T</code></em>, and produces a new value of the same type, <code>[]<em>T</em></code>.</p></li>\n<li><p>Assigns the result to <code>l.Points</code>.</p></li>\n</ul>\n\n<p>When <code>append</code> does its work, it may:</p>\n\n<ul>\n<li>receive <code>nil</code> (of the given type): in this case, it <em>creates</em> the underlying array, or</li>\n<li>receive a non-nil slice: in this case, it writes into the underlying array or discards that array in favor of a new larger-capacity array as needed.<sup>2</sup></li>\n</ul>\n\n<p>So in all cases, the underlying array may have, in effect, just been created or replaced.  It's therefore important that any <em>other</em> use of the <em>same</em> underlying array be updated appropriately.  Assigning the result back to <code>l.Points</code> updates the\u2014presumably one-and-only\u2014slice variable that refers to the underlying array.</p>\n\n<p>We can, however, break these assumptions:</p>\n\n<pre><code>s2 := l.Points\n</code></pre>\n\n<p>Now <code>l.Points</code> and <code>s2</code> both refer to the (single) underlying array.  Operations that modify that underlying array will, at least potentially, affect both <code>s2</code> <em>and</em> <code>l.Points</code>.</p>\n\n<p>Your second example is itself OK:</p>\n\n<blockquote>\n<pre><code>*slice = append(*slice, Point{99, 100})\n</code></pre>\n</blockquote>\n\n<p>but you haven't shown <em>how</em> <code>slice</code> itself was declared and/or assigned-to.</p>\n\n<p>Your third example is fine as well:</p>\n\n<blockquote>\n<pre><code>slice := &amp;l.Points\n*slice = append(l.Points, Point{99, 100})\n</code></pre>\n</blockquote>\n\n<p>The first of these lines declares-and-initializes <code>slice</code> to point to <code>l.Points</code>.  The variable <code>slice</code> therefore has type <code>*[]Point</code>.  Its value\u2014the value in <code>slice</code>, that is, rather than that in <code>*slice</code>\u2014is the address of <code>l.Points</code>, which has type <code>[]Point</code>.</p>\n\n<p>The value in <code>*slice</code> is the value in <code>l.Points</code>.  So you <em>could</em> write:</p>\n\n<pre><code>*slice = append(*slice, Point{99, 100})\n</code></pre>\n\n<p>here.  Since <code>*slice</code> is just another name for <code>l.Points</code>, you can also write:</p>\n\n<pre><code>l.Points = append(*slice, Point{99, 100})\n</code></pre>\n\n<p>You only <em>need</em> to use <code>*slice</code> if there's some reason that <code>l.Points</code> is not available,<sup>3</sup> but you <em>may</em> use <code>*slice</code> if that's more convenient.  Reading <code>*slice</code> reads <code>l.Points</code> and updating <code>*slice</code> updates <code>l.Points</code>.</p>\n\n<hr>\n\n<p><sup>1</sup>To see what I mean by <em>may or may not be created</em> here, consider:</p>\n\n<pre><code>var s []int\n</code></pre>\n\n<p>vs:</p>\n\n<pre><code>var s = []int{42}\n</code></pre>\n\n<p>The first leaves <code>s == nil</code> while the second creates an underlying array with the capacity to hold the one <code>int</code> value <code>42</code>, holding the one <code>int</code> value 42, so that <code>s != nil</code>.</p>\n\n<p><sup>2</sup>It's not clear to me whether there is a promise never to write on an existing slice-array whose capacity is greater than its current length, but not sufficient to hold the final result.  That is, can <code>append</code> first append 10 objects to the existing underlying array, then discover that it needs a bigger array and expand the underlying array?  The difference <em>is</em> observable if there are other slice values referring to the existing underlying array.</p>\n\n<p><sup>3</sup>Here, a classic example would occur if you have reason to pass <code>l.Points</code> or <code>&amp;l.Points</code> to some existing (pre-written) function:</p>\n\n<ul>\n<li><p>If you need pass <code>l.Points</code>\u2014the slice value\u2014to some existing function, that existing function cannot change the <em>slice</em> value, but could change the <em>underlying array</em>.  That's probably a bad plan, so if it <em>does</em> do this, make sure that this is OK!  If it only <em>reads</em> the slice and underlying array, that's a lot safer.</p></li>\n<li><p>If you need to pass <code>&amp;l.Points</code>\u2014a value that points to the slice value\u2014to some existing function, that existing function <em>can</em> change both the slice, and the underlying array.</p></li>\n</ul>\n\n<p>If you're writing a new function, it's up to you to write it in whatever manner is most appropriate.  If you're only going to <em>read</em> the slice and underlying array, you can take a value of type <code>[]Point</code>.  If you intend to update the slice in place, you should take a value of type <code>*[]Point</code>\u2014pointer to slice of <code>Point</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2401, "user_id": 1797161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/538748ff6e44c656974e3eda5602bc93?s=128&d=identicon&r=PG", "display_name": "Federico", "link": "https://stackoverflow.com/users/1797161/federico"}, "is_accepted": false, "score": 0, "last_activity_date": 1575401162, "last_edit_date": 1575401162, "creation_date": 1575399489, "answer_id": 59163664, "question_id": 59122177, "link": "https://stackoverflow.com/questions/59122177/why-i-cannot-append-a-value-to-a-structs-slice-using-a-reference/59163664#59163664", "title": "Why I cannot append a value to a structs&#39; slice using a reference?", "body": "<p>I know that this might be sacrilegious, but, for me, it is useful to think of slices\nas structs. </p>\n\n<pre><code>type Slice struct {\n    len int\n    cap int\n    Array *[n]T // Pointer to array of type T\n} \n</code></pre>\n\n<p>Since in languages like C, the <code>[]</code> operator is also a dereferencing operator, we can think that every time we are accessing a slice, we are actually dereferencing the underlying array and assigning some value to it. That is:</p>\n\n<pre><code>var s []int\ns[0] = 1\n</code></pre>\n\n<p>Might be thought of as equivalent to (in pseudo-code):</p>\n\n<pre><code>var s Slice\n*s.Array[0] = 1 \n</code></pre>\n\n<p>That is why we can say that slices are \"pointers\". For that reason, it can modify its underlying array like this:</p>\n\n<pre><code>myArray := [3]int{1,1,1}\nmySlice := myArray[0:1]\nmySlice = append(mySlice, 2, 3) // myArray == mySlice\n</code></pre>\n\n<p>Modifying <code>mySlice</code> also modifies <code>myArray</code>, since the slice stores a pointer to the array and, on appending, we are dereferencing that pointer. </p>\n\n<p>This behavior, nonetheless, is not always like this. If we exceed the capacity of the original array, a new array is created and the original array is left untouched.</p>\n\n<pre><code>myArray := [3]int{1,1,1}\nmySlice := myArray[0:1]\nmySlice = append(mySlice, 2, 3, 4, 5) // myArray != mySlice\n</code></pre>\n\n<p>The confusion arises when we try to treat the slice itself as an actual pointer. Since we can modify an underlying array by appending to it, we are led to believe that in this case:</p>\n\n<pre><code>sliceCopy := mySlice\nsliceCopy = append(sliceCopy, 6)\n</code></pre>\n\n<p>both slices, <code>slice</code> and <code>sliceCopy</code> are the same, but they are not. We have to explicitly pass a reference to the memory address of the slice (using the <code>&amp;</code> operator) in order to modify it. That is:</p>\n\n<pre><code>sliceAddress := &amp;mySlice\n*sliceAddress = append(mySlice, 6) // or append(*sliceAddress, 6)\n</code></pre>\n\n<h2>See also</h2>\n\n<ul>\n<li><a href=\"https://forum.golangbridge.org/t/slice-pass-as-value-or-pointer/2866/4\" rel=\"nofollow noreferrer\">https://forum.golangbridge.org/t/slice-pass-as-value-or-pointer/2866/4</a></li>\n<li><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-slices-usage-and-internals</a></li>\n<li><a href=\"https://appliedgo.net/slices/\" rel=\"nofollow noreferrer\">https://appliedgo.net/slices/</a></li>\n</ul>\n"}], "owner": {"reputation": 2401, "user_id": 1797161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/538748ff6e44c656974e3eda5602bc93?s=128&d=identicon&r=PG", "display_name": "Federico", "link": "https://stackoverflow.com/users/1797161/federico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1575401162, "creation_date": 1575169180, "question_id": 59122177, "link": "https://stackoverflow.com/questions/59122177/why-i-cannot-append-a-value-to-a-structs-slice-using-a-reference", "title": "Why I cannot append a value to a structs&#39; slice using a reference?", "body": "<p>I Go, I assumed slices were passed by reference, but this seems to work for values\nbut not for the array itself. For example, If I have this struct:</p>\n\n<pre><code>    l := Line{\n        Points: []Point{\n            Point{3, 4},\n        },\n    }\n</code></pre>\n\n<p>I can define a variable, which gets passed a reference to the struct's slice</p>\n\n<pre><code>slice := l.Points\n</code></pre>\n\n<p>And then if I modify it, the original struct referenced by the variable\nis going to reflect those modifications.</p>\n\n<pre><code>slice[0].X = 1000\nfmt.Printf(\n    \"This value %d is the same as this %d\", \n    slice[0].X, \n    l.Points[0].X,\n)\n</code></pre>\n\n<p>This differs from the behavior of arrays which, I assume, are passed by value.\nSo, for example, if I had defined the previous code using an array:</p>\n\n<pre><code>l := Line{\n    Points: [1]Point{\n        Point{3, 4},\n    },\n}\narr := l.Points\narr[0].X = 1000\nfmt.Println(arr.[0].X != s.Points[0].X) // equals true, original struct is untouched\n</code></pre>\n\n<p>Then, the <code>l</code> struct wouldn't have been modified. </p>\n\n<p>Now, if I want to modify the slice itself I obviously cannot do this:</p>\n\n<pre><code>slice = append(slice, Point{99, 100})\n</code></pre>\n\n<p>Since that would only redefine the slice variable, losing the original reference. \nI know I can simply do this:</p>\n\n<pre><code>l.Points = append(l.Points, Point{99, 100})\n</code></pre>\n\n<p>But, in some cases, it is more convenient to have another variable instead of having\nto type the whole thing. </p>\n\n<p>I tried this:</p>\n\n<pre><code>*slice = append(*slice, Point{99, 100})\n</code></pre>\n\n<p>But it doesn't work as I am trying to dereference something that apparently is not a pointer.</p>\n\n<p>I finally tried this:</p>\n\n<pre><code>slice := &amp;l.Points\n\n*slice = append(l.Points, Point{99, 100})\n</code></pre>\n\n<p>And it works, but I am not sure what is happening. Why is the value of slice not overwritten? How does <code>append</code> works here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1575159360, "post_id": 59121456, "comment_id": 104472476, "body": "The error message indicates that the map is not a map[string]string, but a map[string]rune."}, {"owner": {"reputation": 13, "user_id": 4681875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rQWSXTpz4xM/AAAAAAAAAAI/AAAAAAAAAAA/KTuuXYmqjmQ/photo.jpg?sz=128", "display_name": "Barry Kimelman", "link": "https://stackoverflow.com/users/4681875/barry-kimelman"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575169460, "post_id": 59121456, "comment_id": 104473835, "body": "my declaration said nothing about a &quot;rune&quot;. why would the GO compiler complain about a rune?"}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1575170166, "post_id": 59121456, "comment_id": 104473916, "body": "Try reducing the code as much as possible, then post the whole reduced code and/or a link to it on the <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">Go Playground</a>. If we can&#39;t see actual source, we all just have to guess."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1575175285, "post_id": 59121456, "comment_id": 104474545, "body": "Like so: <a href=\"https://play.golang.org/p/ZEMJ76Bq-SV\" rel=\"nofollow noreferrer\">play.golang.org/p/ZEMJ76Bq-SV</a>"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1575175809, "post_id": 59121456, "comment_id": 104474624, "body": "You only post a portion of the code. Based on that: either the declaration is not what you said it is; or f_code or fields_map is shadowing another variable; or the switch-case you pasted here is not the same as what you&#39;re compiling."}, {"owner": {"reputation": 13, "user_id": 4681875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rQWSXTpz4xM/AAAAAAAAAAI/AAAAAAAAAAA/KTuuXYmqjmQ/photo.jpg?sz=128", "display_name": "Barry Kimelman", "link": "https://stackoverflow.com/users/4681875/barry-kimelman"}, "edited": false, "score": 0, "creation_date": 1575217842, "post_id": 59121456, "comment_id": 104483336, "body": "Here is a reduced version of the code which has the same compile errors"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1575220208, "post_id": 59121456, "comment_id": 104483993, "body": "@BarryKimelman I have edited my answer accordingly: try and run <a href=\"https://play.golang.org/p/woB1gYR1KYC\" rel=\"nofollow noreferrer\">play.golang.org/p/woB1gYR1KYC</a>"}, {"owner": {"reputation": 13, "user_id": 4681875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rQWSXTpz4xM/AAAAAAAAAAI/AAAAAAAAAAA/KTuuXYmqjmQ/photo.jpg?sz=128", "display_name": "Barry Kimelman", "link": "https://stackoverflow.com/users/4681875/barry-kimelman"}, "edited": false, "score": 0, "creation_date": 1575224722, "post_id": 59121456, "comment_id": 104485239, "body": "thanks. my code now compiles. Not sure why it wasn&#39;t compiling earlier with double quotes!!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1575225063, "post_id": 59121456, "comment_id": 104485320, "body": "@BarryKimelman No problem. Don&#39;t forget to read <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4681875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rQWSXTpz4xM/AAAAAAAAAAI/AAAAAAAAAAA/KTuuXYmqjmQ/photo.jpg?sz=128", "display_name": "Barry Kimelman", "link": "https://stackoverflow.com/users/4681875/barry-kimelman"}, "edited": false, "score": 0, "creation_date": 1575162708, "post_id": 59121553, "comment_id": 104472971, "body": "replacing the double quotes with single quotes does not change anything. i still get the same error messages"}, {"owner": {"reputation": 479, "user_id": 2911436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7440d55bf27c1d2b26fae3af24ca2fff?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/2911436/john"}, "reply_to_user": {"reputation": 13, "user_id": 4681875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rQWSXTpz4xM/AAAAAAAAAAI/AAAAAAAAAAA/KTuuXYmqjmQ/photo.jpg?sz=128", "display_name": "Barry Kimelman", "link": "https://stackoverflow.com/users/4681875/barry-kimelman"}, "edited": false, "score": 0, "creation_date": 1575167982, "post_id": 59121553, "comment_id": 104473614, "body": "@BarryKimelman replace the single quotes with double quotes, rather than vice versa."}, {"owner": {"reputation": 13, "user_id": 4681875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rQWSXTpz4xM/AAAAAAAAAAI/AAAAAAAAAAA/KTuuXYmqjmQ/photo.jpg?sz=128", "display_name": "Barry Kimelman", "link": "https://stackoverflow.com/users/4681875/barry-kimelman"}, "edited": false, "score": 0, "creation_date": 1575169382, "post_id": 59121553, "comment_id": 104473819, "body": "I have tried using both single and double quotes. in both cases I get the same bunch of error messages."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 3, "last_activity_date": 1575220188, "last_edit_date": 1575220188, "creation_date": 1575160364, "answer_id": 59121553, "question_id": 59121456, "link": "https://stackoverflow.com/questions/59121456/strange-error-message-mismatched-types-rune-and-string/59121553#59121553", "title": "Strange error message: mismatched types rune and string", "body": "<p>This error (<code>invalid case '\\u0000'</code>) was <a href=\"https://stackoverflow.com/q/53480788/6309\">seen here</a>, and means you have not used actual double-quotes for your case values:</p>\n\n<pre><code>switch f_code {\n    case 'meta':\n    case 'users':\n    case 'history':\n    default:\n}\n</code></pre>\n\n<p>If you replace them by <code>\"</code>, it should work, considering your map (and <code>f_code</code>) are using string.</p>\n\n<p>The OP's example is in <a href=\"https://play.golang.org/p/5blDUr-4ETB\" rel=\"nofollow noreferrer\">this playground</a>, and does indeed generate the <code>illegal rune literal</code> error.</p>\n\n<p>Using double-quotes, as in <a href=\"https://play.golang.org/p/woB1gYR1KYC\" rel=\"nofollow noreferrer\">this playground</a>, would yield no error.</p>\n\n<pre><code>parse_fields()\nf_code, ok := fields_map[\"function\"] // test for existance of function code\nif ok {\n    switch f_code {\n    case \"meta\":\n        break\n    case \"users\":\n        break\n    case \"history\":\n        break\n    default:\n        break\n    } // switch\n} else {\n    fmt.Println(\"&lt;H3&gt;No function code detected&lt;/H3&gt;\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 0, "last_activity_date": 1575175738, "last_edit_date": 1575175738, "creation_date": 1575174156, "answer_id": 59122486, "question_id": 59121456, "link": "https://stackoverflow.com/questions/59121456/strange-error-message-mismatched-types-rune-and-string/59122486#59122486", "title": "Strange error message: mismatched types rune and string", "body": "<p>The reflect package is used to get the type of the value, you can switch over based on types as well.</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"reflect\"\n    )\n\nfunc main() {\n     myMap := map[string]string{ \"test1\":\"testing\", \"test2\":\"testing2\" }\n     value, ok := myMap[\"test1\"]\n     fmt.Println(reflect.TypeOf(value), value)\n     if (ok) {\n           switch value {\n               case \"debug1\":\n                  fmt.Println(\"not what i meant\")\n               case \"testing\":\n                  fmt.Println(\"This is what i am looking for\")\n               default:\n                  fmt.Println(\"default value \")\n           }\n      }\n}\n</code></pre>\n\n<p>output:</p>\n\n<p>string testing</p>\n\n<p>This is what i am looking for</p>\n"}], "owner": {"reputation": 13, "user_id": 4681875, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rQWSXTpz4xM/AAAAAAAAAAI/AAAAAAAAAAA/KTuuXYmqjmQ/photo.jpg?sz=128", "display_name": "Barry Kimelman", "link": "https://stackoverflow.com/users/4681875/barry-kimelman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1575224638, "creation_date": 1575159072, "last_edit_date": 1575224638, "question_id": 59121456, "link": "https://stackoverflow.com/questions/59121456/strange-error-message-mismatched-types-rune-and-string", "title": "Strange error message: mismatched types rune and string", "body": "<p>I am new to Go programming and I am having a problem with my program which uses a \"switch\" statement to process the value retrieved from a \"map\".</p>\n\n<p>The map is declared as follows:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var fields_map map[string]string\n</code></pre>\n\n<p>A value is later retrieved as follows:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>f_code, ok := fields_map[\"function\"]\n</code></pre>\n\n<p>If \"ok\" has a true value I then do a \"switch\" on the retrieved code as follows</p>\n\n<pre><code>    switch f_code {\n        case \"meta\":\n        case \"users\":\n        case \"history\":\n        default:\n    }\n</code></pre>\n\n<p>My problem is that for each of the \"case\" statements I get an error as follows :\ninvalid case '\\u0000' in switch on f_code (mismatched types rune and string)</p>\n\n<p>According to one webpage I found \"rune\" is defined as follows:\nThe Go language defines the word rune as an alias for the type int32</p>\n\n<p>Why am I getting this error ? And why the reference to \"rune\" ?\nBoth the key and value for my map are declared as \"string\" , so I am confused.</p>\n\n<p>Any ideas ?</p>\n\n<p>I have created a reduced version of my code which has the same compile errors</p>\n\n<pre><code>     1  package main\n     2  \n     3  import (\n     4      \"fmt\"\n     5  )\n     6  \n     7  var fields_count int\n     8  var fields_map map[string]string\n     9  \n    10  func parse_fields() {\n    11      fields_count = 0\n    12      fields_map = make(map[string]string)  // initialize the map\n    13  \n    14  } // parse_fields\n    15  \n    16  func main() {\n    17  \n    18      parse_fields()\n    19      f_code, ok := fields_map[\"function\"] // test for existance of function code\n    20      if ok {\n    21          switch f_code {\n    22              case 'meta':\n    23                  break;\n    24              case 'users':\n    25                  break;\n    26              case 'history':\n    27                  break;\n    28              default:\n    29                  break;\n    30          }// switch\n    31      } else {\n    32          fmt.Println(\"&lt;H3&gt;No function code detected&lt;/H3&gt;\")\n    33      }\n    34  \n    35  } // main\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 479, "user_id": 2911436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7440d55bf27c1d2b26fae3af24ca2fff?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/2911436/john"}, "edited": false, "score": 1, "creation_date": 1575168062, "post_id": 59121328, "comment_id": 104473620, "body": "Have you tried using <code>sql.NullInt64</code> rather than <code>sql.NullString</code>?"}, {"owner": {"reputation": 25, "user_id": 12145367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040c01b147377742bc4c0a072827668b?s=128&d=identicon&r=PG&f=1", "display_name": "zquee12", "link": "https://stackoverflow.com/users/12145367/zquee12"}, "reply_to_user": {"reputation": 479, "user_id": 2911436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7440d55bf27c1d2b26fae3af24ca2fff?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/2911436/john"}, "edited": false, "score": 0, "creation_date": 1575267025, "post_id": 59121328, "comment_id": 104494715, "body": "Sorry, I meant to type <code>sql.NullInt64</code>, how do you advise I use that in a  <code>reflect.ValueOf</code> ?"}, {"owner": {"reputation": 479, "user_id": 2911436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7440d55bf27c1d2b26fae3af24ca2fff?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/2911436/john"}, "edited": false, "score": 0, "creation_date": 1576347350, "post_id": 59121328, "comment_id": 104873466, "body": "You could try another statement for <code>reflect.Interface</code> and then call <code>record[I].Interface()</code> and perform a type assertion to get it to a <code>sql.NullInt64</code>. Just make sure to add a nil check."}], "owner": {"reputation": 25, "user_id": 12145367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040c01b147377742bc4c0a072827668b?s=128&d=identicon&r=PG&f=1", "display_name": "zquee12", "link": "https://stackoverflow.com/users/12145367/zquee12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575267110, "creation_date": 1575157769, "last_edit_date": 1575267110, "question_id": 59121328, "link": "https://stackoverflow.com/questions/59121328/dealing-with-nulls-when-inserting-ints", "title": "dealing with nulls when inserting ints", "body": "<p>I've written some code that is meant to create inserts from a .csv file.\nIm running into an issue when attempting to insert fields that are NULL values.\nIn most cases, the fields within my .csv are ints, but sometimes there need to be NULL in. I know that I cant pass \"NULL\" as an int, but how can I accommodate for these NULL records when creating my inserts?</p>\n\n<p>In the case of the .csv Im working with, a column: <code>CustomerID</code> which either be an int or it could be a NULL.</p>\n\n<p>Would something like a <code>sql.NullInt64</code> work?</p>\n\n<p>Here's the code I'm working on:</p>\n\n<pre><code>func Unmarshal(reader *csv.Reader, v interface{}) error {\n    record, err := reader.Read()\n    if err != nil {\n        return err\n    }\n    s := reflect.ValueOf(v).Elem()\n    if s.NumField() != len(record) {\n        return &amp;FieldMismatch{s.NumField(), len(record)}\n    }\n    for i := 0; i &lt; s.NumField(); i++ {\n        f := s.Field(i)\n        switch f.Type().Kind() {\n        case reflect.String:\n            f.SetString(record[i])\n\n        case reflect.Int:\n            ival, err := strconv.ParseInt(record[i], 10, f.Type().Bits())\n            if err != nil {\n                return err\n            }\n            f.SetInt(ival)\n        case reflect.Float64:\n            fval, err := strconv.ParseFloat(record[i], f.Type().Bits())\n            if err != nil {\n                return err\n            }\n            f.SetFloat(fval)\n        default:\n            return &amp;UnsupportedType{f.Type().String()}\n        }\n    }\n    return nil\n}\n\ntype FieldMismatch struct {\n    expected, found int\n}\n\nfunc (e *FieldMismatch) Error() string {\n    return \"CSV line fields mismatch. Expected \" + strconv.Itoa(e.expected) + \" found \" + strconv.Itoa(e.found)\n}\n\ntype UnsupportedType struct {\n    Type string\n}\n\nfunc (e *UnsupportedType) Error() string {\n    return \"Unsupported type: \" + e.Type\n}\n</code></pre>\n"}, {"tags": ["performance", "for-loop", "go", "int"], "comments": [{"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1575157294, "post_id": 59121187, "comment_id": 104472082, "body": "Does this happen consistently?"}, {"owner": {"reputation": 1103, "user_id": 5502866, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg=k-s128", "display_name": "Kingindanord", "link": "https://stackoverflow.com/users/5502866/kingindanord"}, "reply_to_user": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1575157330, "post_id": 59121187, "comment_id": 104472091, "body": "@GiulioMicheloni yes"}, {"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 5, "creation_date": 1575158463, "post_id": 59121187, "comment_id": 104472303, "body": "I would run a benchmark like this (<a href=\"https://play.golang.org/p/OgsrVVWJeuq\" rel=\"nofollow noreferrer\">play.golang.org/p/OgsrVVWJeuq</a>) and make sure that the for-loop&#39;s number of iterations is not in the equation. Can you let us know the results of above benchmarks? I ran those in my machine and got similar results for both integer sizes: Int32-16  0.44ns &#177; 0% Int64-16  0.45ns &#177; 1%"}, {"owner": {"reputation": 1103, "user_id": 5502866, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg=k-s128", "display_name": "Kingindanord", "link": "https://stackoverflow.com/users/5502866/kingindanord"}, "reply_to_user": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1575191310, "post_id": 59121187, "comment_id": 104476987, "body": "@GiulioMicheloni after your comment and peterSO&#39;s post I see what the problem was. Now, I can&#39;t help but to ask the annoying question; why is the go code twice slower than it&#39;s Java equivalent (rhetorical question)."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1575220001, "post_id": 59122178, "comment_id": 104483920, "body": "@Kingindanord, when doing microbenchmarks, please 1) do not rely on wall-clock timers, use the benchmarking abilities of the stock package <a href=\"https://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow noreferrer\"><code>testing</code></a>; 2) be sure to also use the <a href=\"https://golang.org/x/tools/cmd/benchcmp\" rel=\"nofollow noreferrer\"><code>benchcmp</code></a> package to compare the results of different benchmark runs; 3) make sure to not measure any setup and teardown code of your benchmark; 4) read up on benchmarking in Go, a lot."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1575217403, "last_edit_date": 1575217403, "creation_date": 1575169192, "answer_id": 59122178, "question_id": 59121187, "link": "https://stackoverflow.com/questions/59121187/for-loop-performance-much-slower-when-using-int64-instead-of-int32/59122178#59122178", "title": "For loop performance much slower when using int64 instead of int32", "body": "<p>Meaningless microbenchmarks produce meaningless results.</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"nofollow noreferrer\">Numeric types</a></p>\n\n<pre><code>int32   set of all signed 32-bit integers \n        (-2147483648 to 2147483647)\nint64   set of all signed 64-bit integers \n        (-9223372036854775808 to 9223372036854775807)\n</code></pre>\n  \n  <p><a href=\"https://golang.org/ref/spec#Arithmetic_operators\" rel=\"nofollow noreferrer\">Arithmetic operators</a></p>\n  \n  <p>Integer overflow</p>\n  \n  <p>For signed integers, the operations +, -, *, /, and &lt;&lt; may legally\n  overflow and the resulting value exists and is deterministically\n  defined by the signed integer representation, the operation, and its\n  operands. Overflow does not cause a run-time panic.</p>\n</blockquote>\n\n<hr>\n\n<p>Overflow!</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"runtime\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n    var x1 int32 // later change all int to int32 or int64\n\n    for i := int32(0); i &lt;= int32(1000000000); i++ {\n\n        if int64(x1)+int64(i) &gt; math.MaxInt32 {\n            fmt.Println(\"Overflow:\", x1, \"+\", i, \"=\", x1+i)\n            break\n        }\n\n        x1 = x1 + i\n    }\n    t := time.Now()\n    elapsed := t.Sub(start)\n\n    fmt.Println(x1)\n    fmt.Println(elapsed)\n    fmt.Println(runtime.Compiler, runtime.GOARCH, runtime.GOOS)\n    fmt.Println(strconv.IntSize)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/bdhB4ABf7jY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bdhB4ABf7jY</a></p>\n\n<p>Output:</p>\n\n<pre><code>Overflow: 2147450880 + 65536 = -2147450880\ngc amd64 linux\n64\n</code></pre>\n"}], "owner": {"reputation": 1103, "user_id": 5502866, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg=k-s128", "display_name": "Kingindanord", "link": "https://stackoverflow.com/users/5502866/kingindanord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 1, "accepted_answer_id": 59122178, "answer_count": 1, "score": 1, "last_activity_date": 1575217403, "creation_date": 1575156109, "last_edit_date": 1575198287, "question_id": 59121187, "link": "https://stackoverflow.com/questions/59121187/for-loop-performance-much-slower-when-using-int64-instead-of-int32", "title": "For loop performance much slower when using int64 instead of int32", "body": "<p>I am trying to figure out the best practices regarding performance.\nI have noticed that specifying integer types for a for-loop could effect the performance drastically (x2 times in my case).</p>\n\n<p>My question is, is it supposed to be that using the int64 would be much slower than using int32 or I am missing something in my code?</p>\n\n<p>The code I am using:</p>\n\n<p><strong>a.go</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"runtime\"\n    \"strconv\"\n)\n\nfunc main() {\n    start := time.Now()\n    var x1 int // later change all int to int32 or int64 \n\n    for i := int(0); i &lt;= int(1000000000); i++  {\n        x1 = x1 + i\n    }\n        t := time.Now()\n        elapsed := t.Sub(start)\n\n    fmt.Println(x1)\n    fmt.Println(elapsed)\n    fmt.Println(runtime.Compiler, runtime.GOARCH, runtime.GOOS)\n    fmt.Println(strconv.IntSize)\n}\n</code></pre>\n\n<p><strong>Output using int32 for x1</strong></p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>C:\\...&gt;go build a.go\nC:\\...&gt;a\n\n-243309312\n238.3333ms\ngc amd64 windows\n64\n</code></pre>\n\n<p><strong>Output using int64 for x1</strong></p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>C:\\...&gt;go build a.go\nC:\\...&gt;a\n\n500000000500000000\n467.7835ms\ngc amd64 windows\n64\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>I tried @Giulio Micheloni suggestion and got more accurate benchmark.</p>\n\n<pre><code>goos: windows\ngoarch: amd64\nBenchmarkInt64-12       1000000000           0.234 ns/op           0 B/op          0 allocs/op\nPASS\nok      _/c_/.../.../Desktop    0.402s\nSuccess: Benchmarks passed.\n\ngoos: windows\ngoarch: amd64\nBenchmarkInt32-12       1000000000           0.231 ns/op           0 B/op          0 allocs/op\nPASS\nok      _/c_/.../.../Desktop    0.403s\nSuccess: Benchmarks passed.\n</code></pre>\n"}, {"tags": ["http", "go", "stream"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575155815, "post_id": 59121113, "comment_id": 104471812, "body": "You should use client-side streaming grpc for large messages. That way you can read the http stream in chunks and send it via grpc without using store-and-forward."}, {"owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1575156058, "post_id": 59121113, "comment_id": 104471873, "body": "@Markus, the problem is this stores the entire file on the server, the exact problem I want to avoid"}, {"owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575156284, "post_id": 59121113, "comment_id": 104471927, "body": "@BurakSerdar, are you talking about grpc-web?"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575156451, "post_id": 59121113, "comment_id": 104471960, "body": "From your question, it looks like you receive a file via http, and you want to send it to another service via grpc. For that, you should use the above code as a starting point, but chunk the data as you read from the http request, and send it to the grpc server using those chunks as a client-side stream. That way, you don&#39;t need to store the file."}, {"owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575156718, "post_id": 59121113, "comment_id": 104471999, "body": "@BurakSerdar, golang stores the file automatically if the request body exceeds 10mb, that&#39;s what I&#39;m trying to intercept and avoid. Client side streaming to a grpc service is easy once I get that. Do you know how to receive each multiform part of the data individually and avoid the default aggregation handling?"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575157180, "post_id": 59121113, "comment_id": 104472058, "body": "You should edit your question to emphasize that. And for solution: don&#39;t call r.FormFile, instead use multipart.NewReader(request.Body), and parse the sections yourself. I can include some code that shows how if you need."}, {"owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1575157682, "post_id": 59121113, "comment_id": 104472161, "body": "@BurakSerdar, if don&#39;t mind, I&#39;ll mark it as the accepted answer. It will be multipart data content type"}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 5, "last_activity_date": 1575158344, "creation_date": 1575158344, "answer_id": 59121390, "question_id": 59121113, "link": "https://stackoverflow.com/questions/59121113/how-to-deal-with-large-file-upload-via-http-without-storing-the-request-in-tempo/59121390#59121390", "title": "How to deal with large file upload via HTTP without storing the request in temporary files", "body": "<p>If you're dealing with large multipart data, you should avoid parsing the whole request body. Instead, use the <code>multipart</code> package and read the request body as a stream (error handling is omitted below):</p>\n\n<pre><code>m, p, _:=mime.ParseMediaType(req.Header.Get(\"Content-Type\"))\nboundary:=p[\"boundary\"]\nreader:=multipart.NewReader(req.Body,boundary)\nfor  {\n  part, err:=reader.NextPart()\n  if err==io.EOF {\n    // Done reading body\n    break\n  }\n  contentType:=part.Header.Get(\"Content-Type\")\n  fname:=part.FileName()\n  // part is an io.Reader, deal with it\n}\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1627, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575158709, "creation_date": 1575155484, "last_edit_date": 1575158709, "question_id": 59121113, "link": "https://stackoverflow.com/questions/59121113/how-to-deal-with-large-file-upload-via-http-without-storing-the-request-in-tempo", "title": "How to deal with large file upload via HTTP without storing the request in temporary files", "body": "<p>I want to submit a get request with a large file payload (up to several gbs) to a golang server, but rather than having it store the multi-part body on the file system and then copy the file contents to a buffer and forward it on, I'd like to forward the body of the request to another service as it arrives (without storing anything). Here is a modified (from <a href=\"https://stackoverflow.com/questions/40684307/how-can-i-receive-an-uploaded-file-using-a-golang-net-http-server\">How can I receive an uploaded file using a Golang net/http server?</a>) non-working example for a post request:</p>\n\n<pre><code>func ReceiveFile(w http.ResponseWriter, r *http.Request) {\n    var Buf bytes.Buffer\n    file, header, err := r.FormFile(\"file\")\n    if err != nil {\n        panic(err)\n    }\n    defer file.Close()\n    io.Copy(&amp;Buf, file)\n    // stream Buf to grpc server\n    Buf.Reset()\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1575151035, "post_id": 59120484, "comment_id": 104470782, "body": "There is no reason to <a href=\"https://meta.stackexchange.com/questions/19190/should-questions-include-tags-in-their-titles\">add tags to your title</a>. It&#39;s just redundant clutter."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1575154814, "post_id": 59120484, "comment_id": 104471613, "body": "Also annotate/tag your pods with meaningful names. So don&#39;t use <code>grep</code> - instead search pods/deployments/services by tag."}], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1575155181, "post_id": 59120633, "comment_id": 104471680, "body": "Also use <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/\" rel=\"nofollow noreferrer\">RBAC</a> to grant your pods read-only <code>view</code> type access etc."}], "tags": [], "owner": {"reputation": 106, "user_id": 11594421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ST1B.jpg?s=128&g=1", "display_name": "rolaids_guy", "link": "https://stackoverflow.com/users/11594421/rolaids-guy"}, "is_accepted": false, "score": 1, "last_activity_date": 1575151156, "creation_date": 1575151156, "answer_id": 59120633, "question_id": 59120484, "link": "https://stackoverflow.com/questions/59120484/check-if-a-pod-is-running-on-a-k8s-cluster-in-a-go-program/59120633#59120633", "title": "Check if a pod is running on a k8s cluster in a go program", "body": "<p>The kubectl utility is just a convenience wrapper that talks to the Kubernetes API using bog standard HTTP. The Go standard library has a great <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">http package</a>. The perfect fit for what you're trying to accomplish.</p>\n\n<p>In fact, you could just use <a href=\"https://github.com/kubernetes/client-go\" rel=\"nofollow noreferrer\">this official client package</a> from the Kubernetes project itself.</p>\n"}, {"tags": [], "owner": {"reputation": 4854, "user_id": 11714114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qKzVA.jpg?s=128&g=1", "display_name": "mario", "link": "https://stackoverflow.com/users/11714114/mario"}, "is_accepted": false, "score": 1, "last_activity_date": 1575292947, "creation_date": 1575292947, "answer_id": 59139814, "question_id": 59120484, "link": "https://stackoverflow.com/questions/59120484/check-if-a-pod-is-running-on-a-k8s-cluster-in-a-go-program/59139814#59139814", "title": "Check if a pod is running on a k8s cluster in a go program", "body": "<blockquote>\n  <p>However, given that I am using the k8s native language (Go) I was\n  wondering whether there might be a more Go native/specific way of\n  making such an inquiry to the k8s api server, without resorting to\n  shell invocations from within my cli tool.</p>\n</blockquote>\n\n<p>If you want to talk with <strong>k8s cluster</strong> in your programs written in <strong>go</strong> without resorting to shell invocations, <a href=\"https://github.com/kubernetes/client-go\" rel=\"nofollow noreferrer\">client-go</a> library is the way to go. It contains everything you need to query your k8s api server in your go programs.</p>\n\n<blockquote>\n  <h3>What's included</h3>\n  \n  <ul>\n  <li>The <code>kubernetes</code> package contains the clientset to\n  access Kubernetes API. </li>\n  <li>The <code>discovery</code> package is used to discover APIs\n  supported by a Kubernetes API server.</li>\n  <li>The <code>dynamic</code> package contains a\n  dynamic client that can perform generic operations on arbitrary\n  Kubernetes API objects.</li>\n  <li>The <code>plugin/pkg/client/auth</code> packages contain\n  optional authentication plugins for obtaining credentials from\n  external sources. </li>\n  <li>The <code>transport</code> package is used to set up auth and\n  start a connection. </li>\n  <li>The <code>tools/cache</code> package is useful for writing\n  controllers.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 9276, "user_id": 2409793, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/QDLY9.png?s=128&g=1", "display_name": "pkaramol", "link": "https://stackoverflow.com/users/2409793/pkaramol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1575292947, "creation_date": 1575149847, "last_edit_date": 1575150655, "question_id": 59120484, "link": "https://stackoverflow.com/questions/59120484/check-if-a-pod-is-running-on-a-k8s-cluster-in-a-go-program", "title": "Check if a pod is running on a k8s cluster in a go program", "body": "<p>I am writing a command line tool in Go which will perform an action based on the existence of a particular pod on a <code>k8s</code> cluster, in a specific namespace.</p>\n\n<p>I could do via command line (shell) invocations within my <code>go</code> program something like </p>\n\n<pre><code>kubectl get pods -n mynapespace l app=myapp\n</code></pre>\n\n<p>or in case I am not certain about the labels, something even less elegant as:</p>\n\n<pre><code>kubectl get pods -n mynapespace | grep -i somepatternIamcertainabout\n</code></pre>\n\n<p>However, given that I am using the k8s native language (Go) I was wondering whether there might be a more Go native/specific way of making such an inquiry to the k8s api server, without resorting to shell invocations from within my cli tool.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-ec2", "aws-sdk"], "comments": [{"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1575157423, "post_id": 59120357, "comment_id": 104472108, "body": "Metrics may change depending on the type of AWS resource. Can you be more specific?"}, {"owner": {"reputation": 61, "user_id": 11739685, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2gwLFAZ5DRY/AAAAAAAAAAI/AAAAAAAADIw/xFKLTRwSkHA/photo.jpg?sz=128", "display_name": "ashish choudhary", "link": "https://stackoverflow.com/users/11739685/ashish-choudhary"}, "reply_to_user": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1575225715, "post_id": 59120357, "comment_id": 104485517, "body": "currently i am looking for ec2 . But in general is there a way i can get list of all the metrics available for this resource providing that i have a resource ARN of that resource ??."}, {"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1575226917, "post_id": 59120357, "comment_id": 104485807, "body": "I am afraid that EC2 service does not expose metrics <i>per se</i>. CloudWatch is what you are looking for probably: <a href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/working_with_metrics.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/&hellip;</a>."}, {"owner": {"reputation": 61, "user_id": 11739685, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2gwLFAZ5DRY/AAAAAAAAAAI/AAAAAAAADIw/xFKLTRwSkHA/photo.jpg?sz=128", "display_name": "ashish choudhary", "link": "https://stackoverflow.com/users/11739685/ashish-choudhary"}, "reply_to_user": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1575279237, "post_id": 59120357, "comment_id": 104499295, "body": "yes i know EC2 itself does not expose any metrics . i want to know if their is some api method which takes this resource ARN as input and gives list of metrics as output for that resource.???"}], "owner": {"reputation": 61, "user_id": 11739685, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2gwLFAZ5DRY/AAAAAAAAAAI/AAAAAAAADIw/xFKLTRwSkHA/photo.jpg?sz=128", "display_name": "ashish choudhary", "link": "https://stackoverflow.com/users/11739685/ashish-choudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575149498, "creation_date": 1575148898, "last_edit_date": 1575149498, "question_id": 59120357, "link": "https://stackoverflow.com/questions/59120357/how-to-get-the-metrics-for-a-resource-using-its-resource-arn-in-aws-using-aws-go", "title": "How to get the metrics for a resource using its resource ARN in AWS using aws-go-sdk", "body": "<p>I have a resource ARN of a resource in AWS (eg ec2 instance). I want to get the list of the metrics for this particular resource in Go. How do I get it?</p>\n"}, {"tags": ["go", "time", "duration"], "answers": [{"comments": [{"owner": {"reputation": 990, "user_id": 207425, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1dXtN.png?s=128&g=1", "display_name": "pigfox", "link": "https://stackoverflow.com/users/207425/pigfox"}, "edited": false, "score": 0, "creation_date": 1575146402, "post_id": 59120000, "comment_id": 104469763, "body": "The reason I divide by time.Second is that the &quot;s&quot; goes away. I do this because if the execution time goes into the minutes I get something like 1m5s. Then I get an &quot;m&quot; in the number too."}], "tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 0, "last_activity_date": 1575148037, "last_edit_date": 1575148037, "creation_date": 1575145858, "answer_id": 59120000, "question_id": 59119936, "link": "https://stackoverflow.com/questions/59119936/how-to-not-round-durations/59120000#59120000", "title": "How to not round durations", "body": "<p>Epoc time to to convert the time to seconds </p>\n\n<p>update :  Below code works ? </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    startTime := time.Now()\n    nanos := startTime.Unix()\n    // fmt.Println(startTime)\n    millis := nanos / 1000000\n    elapsedInsecondsT := float64(millis)/float64(1000)\n    fmt.Println( millis, elapsedInsecondsT )\n}\n</code></pre>\n\n<p>courtesy : <a href=\"https://gobyexample.com/epoch\" rel=\"nofollow noreferrer\">https://gobyexample.com/epoch</a></p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 5, "last_activity_date": 1575147169, "creation_date": 1575147169, "answer_id": 59120172, "question_id": 59119936, "link": "https://stackoverflow.com/questions/59119936/how-to-not-round-durations/59120172#59120172", "title": "How to not round durations", "body": "<p>Just use the <a href=\"https://golang.org/pkg/time/#Duration.Seconds\" rel=\"noreferrer\">Seconds()</a> method:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    elapsedTime := 1379 * time.Millisecond\n    fmt.Println(elapsedTime) //-&gt;1.379s\n\n    secs := elapsedTime.Seconds()\n    fmt.Println(secs)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/uK0-h4jEDhe\" rel=\"noreferrer\">playground</a>.</p>\n"}], "owner": {"reputation": 990, "user_id": 207425, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1dXtN.png?s=128&g=1", "display_name": "pigfox", "link": "https://stackoverflow.com/users/207425/pigfox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59120172, "answer_count": 2, "score": 0, "last_activity_date": 1575148037, "creation_date": 1575145424, "last_edit_date": 1575146966, "question_id": 59119936, "link": "https://stackoverflow.com/questions/59119936/how-to-not-round-durations", "title": "How to not round durations", "body": "<p>I am attempting to clock the execution of a process and I need the value in seconds.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    startTime := time.Now()\n    time.Sleep(1379 * time.Millisecond)\n\n    elapsedTime := time.Since(startTime)\n    fmt.Println(elapsedTime) //-&gt;1.379s\n\n    secs := float64(elapsedTime / time.Second)\n    fmt.Println(secs)//-&gt;1\n    //desired output is: 1.379\n}\n</code></pre>\n\n<p>I am looking for a way to have the time not NOT being rounded.\nHere's the playground: <a href=\"https://play.golang.org/p/VLgKTpmkHPS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/VLgKTpmkHPS</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1575144564, "post_id": 59118986, "comment_id": 104469327, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42581697/referring-to-an-open-database-connection-inside-a-function-golang\">Referring to an open database connection inside a function</a>,"}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 7055315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MLBi1.png?s=128&g=1", "display_name": "Illud", "link": "https://stackoverflow.com/users/7055315/illud"}, "is_accepted": false, "score": 0, "last_activity_date": 1575140805, "creation_date": 1575140805, "answer_id": 59119321, "question_id": 59118986, "link": "https://stackoverflow.com/questions/59118986/use-mongodb-connection-from-other-function/59119321#59119321", "title": "Use mongodb connection from other function", "body": "<p>i resolved like this</p>\n\n<pre><code>var CNX = Connection()\nfunc Connection() *mongo.Client {\n    // Set client options\n    clientOptions := options.Client().ApplyURI(\"mongodb://localhost:27017\")\n\n    // Connect to MongoDB\n    client, err := mongo.Connect(context.TODO(), clientOptions)\n\n    if err != nil {\n            log.Fatal(err)\n    }\n\n    // Check the connection\n    err = client.Ping(context.TODO(), nil)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(\"Connected to MongoDB!\")\n\n    return client\n}\n\n//calll connection\n func main() {\n      collection := db.CNX.Database(\"tasks\").Collection(\"task\")\n }\n\noutput \"Connected to MongoDB!\"\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 7055315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MLBi1.png?s=128&g=1", "display_name": "Illud", "link": "https://stackoverflow.com/users/7055315/illud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575140805, "creation_date": 1575137981, "last_edit_date": 1575140190, "question_id": 59118986, "link": "https://stackoverflow.com/questions/59118986/use-mongodb-connection-from-other-function", "title": "Use mongodb connection from other function", "body": "<p>I want to use mongodb connection from another function in Go example</p>\n\n<pre><code>func Conn() {\n    client, err :=\n        mongo.NewClient(options.Client().ApplyURI(\"mongodb://localhost:27017\"))\n}\n</code></pre>\n\n<p>call that function.</p>\n\n<pre><code>func main(){\n    Conn.client//something like this\n}\n</code></pre>\n"}, {"tags": ["sockets", "go", "udp", "protocol-buffers", "marshalling"], "answers": [{"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1575140052, "post_id": 59119082, "comment_id": 104468261, "body": "there is also some waste in mapping a socket to a type. All message types are not produced at same frequency. some sockets will be mostly unused and some others will be a lot more used."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1575141073, "post_id": 59119082, "comment_id": 104468516, "body": "@mh-cbon: compared to using a single UDP socket for all messages this should not be a problem. Compared to using multiple sockets for all types for better scaling this might be a problem though."}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1575141266, "post_id": 59119082, "comment_id": 104468555, "body": "@SteffenUllrich I noticed you say &quot;the OS kernel might handle these sockets in parallel&quot;. Could you elaborate on that so I can investigate how much of a limitation this could potentially be?   You raise a good point whether the optimization is worth it, I&#39;ll take it into consideration and share what I&#39;ve found after a benchmarking."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1575141729, "post_id": 59119082, "comment_id": 104468665, "body": "@FanusduToit: since these are independent sockets with independent send and receive buffers the kernel can read from these buffers or fill these buffers in parallel (assuming a multi-core CPU which is common today). This is also the case if you have different sockets for different clients (i.e. differ by client and not by type) or some other ways of using multiple sockets."}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1575142390, "post_id": 59119082, "comment_id": 104468814, "body": "@SteffenUllrich That makes complete sense, thanks. I&#39;ve also updated my question a bit to explain how the packet size might be a worthy optimization."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1575142614, "post_id": 59119082, "comment_id": 104468874, "body": "@FanusduToit: my idea was not to create a new message which includes the type and which has additional marshaling but just add a single byte for the type before each marshaled <code>data</code> without further marshaling."}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "edited": false, "score": 0, "creation_date": 1575143066, "post_id": 59119082, "comment_id": 104468975, "body": "@SteffenUllrich oh right, ye I get it. I don&#39;t think that is possible with protobuf though. I&#39;ll have to investigate and perhaps use a different library to do serialization."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 3, "last_activity_date": 1575139163, "last_edit_date": 1575139163, "creation_date": 1575138768, "answer_id": 59119082, "question_id": 59118900, "link": "https://stackoverflow.com/questions/59118900/avoiding-packet-type-check-by-using-listening-over-multiple-udp-sockets/59119082#59119082", "title": "Avoiding packet type check by using listening over multiple UDP sockets", "body": "<p>Each socket is independent from the others, i.e. has its own send and receiver buffer and the OS kernel might handle these sockets in parallel. This also means that the messages might not be processed in the same order as they were send or received, but this might not be a problem in your case (with UDP you already need to be aware that packet loss, duplicates and reordering might happen). Each of the sockets also needs to bind to a different <code>&lt;ip,port&gt;</code> tuple (usually only the port is different) which might make it more complex in case you need to deal with firewalls between sender and receiver.</p>\n\n<p>In general I'm not sure if this optimization is really worth it. With 18 types you need at most 1 byte to encode the type at the beginning of the payload which is marginal compared to the rest of the protocol overhead: The encapsulation into ethernet, IP, UDP already <a href=\"https://stackoverflow.com/a/4218766/3081018\">adds up to 54 bytes with IPv4</a> and then you also have the payload.</p>\n"}], "owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 59119082, "answer_count": 1, "score": 1, "last_activity_date": 1575142320, "creation_date": 1575137377, "last_edit_date": 1575142320, "question_id": 59118900, "link": "https://stackoverflow.com/questions/59118900/avoiding-packet-type-check-by-using-listening-over-multiple-udp-sockets", "title": "Avoiding packet type check by using listening over multiple UDP sockets", "body": "<h2>Intro</h2>\n\n<p>I have a basic server/client UDP setup. I want to be able to optimize marshalling each packet on both endpoints by avoid sending the packet's type within the payload (byte size optimization), and the extra check to determine which type of packet it is, so it knows which type to unmarshal for (compute optimization).</p>\n\n<p>The marshalling of these packets (or messages) are done using Protocol Buffers.</p>\n\n<h2>Known solutions</h2>\n\n<p>The accepted answer for this question proposes three solutions, one of which I'm using at the moment:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9121612/protocol-buffers-detect-type-from-raw-message\">Protocol buffers detect type from raw message</a></p>\n\n<p>However packets will be streaming the network at a high frequency and I feel the extra checks and payload will turn out costly.</p>\n\n<p>To elaborate on why the packet size optimization might be worth while, here is message defined in my .proto file.</p>\n\n<pre><code>message Packet {\n    OpCode opCode = 1;\n    google.protobuf.Any data = 2;\n}\n</code></pre>\n\n<p>So the <code>OpCode</code> is the variable that defines the packet type and the <code>Any</code> is a generic object that could be anything. So when I unmarshall such a packet, I'm essentially doing it twice. Once for the base message, and again for the <code>Any</code> based on the <code>OpCode</code>. This also means I need to always determine the buffer size of the entire packet. If I can avoid the nested generic object and just send straight as known types, it might reduce the packet size considerably (depending on what protobuf actually does behind the scenes).</p>\n\n<h2>Proposed solution</h2>\n\n<p>My initial thought strung from the following:</p>\n\n<blockquote>\n  <p>For UDP, the socket API allows one socket to receive from many endpoints, and to send to many endpoints - so many servers use just one socket since there isn't any need for more. > <a href=\"https://stackoverflow.com/questions/20165699/why-a-single-socket-in-udp-servers\">Why a single socket in UDP servers?</a></p>\n</blockquote>\n\n<p>This got me thinking that I can let the server open up multiple UDP sockets, one for each type of packet that will traverse the network, but still be able to communication to many clients.</p>\n\n<p>This allows each socket to always know which packet type to unmarshal for, and have a fixed buffer size to populate (avoid having to check for the length of the packet).</p>\n\n<h2>Known limitations / Assumptions</h2>\n\n<p>From what I understand, the OS does put a limit on how many sockets can be opened. However I doubt this will affect me because I will only need max 18 since that is how many packet types I'm aiming for.</p>\n\n<h2>Question</h2>\n\n<p>So on a lower network level, since multiple UDP sockets will be open, how will these open sockets be handled? Will each socket handle incoming/outgoing packets concurrently, giving me an additional optimization? Or is it just going to bottleneck when I send a packet to 18000 endpoints because it's all still this \"single UDP entity\", potentially making my attempt to optimize, not as optimal at all...</p>\n"}, {"tags": ["go", "telnet"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12460597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7414cb69034a8f95b441ca1efe98d689?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/12460597/alexander"}, "edited": false, "score": 0, "creation_date": 1575125976, "post_id": 59117157, "comment_id": 104464592, "body": "That&#39;s exactly what I did, however execution &quot;hangs&quot; at  conn.Read() as if expecting to receive something and never receiving. To tell the truth, I cannot even begin to imagine how to deal with it=("}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 29, "user_id": 12460597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7414cb69034a8f95b441ca1efe98d689?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/12460597/alexander"}, "edited": false, "score": 3, "creation_date": 1575126450, "post_id": 59117157, "comment_id": 104464723, "body": "@Alexander, \u2026so why have you decided to not include this piece of code into your question? You have basically asked about why something does not work without showing what that &quot;something&quot; really is. Please show a complete piece which does not work. Ideally, it would be cool to see what data the device sends (to correlate that with what you do.)"}, {"owner": {"reputation": 29, "user_id": 12460597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7414cb69034a8f95b441ca1efe98d689?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/12460597/alexander"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1575181197, "post_id": 59117157, "comment_id": 104475367, "body": "@kostix sorry about this, since I tried about ten different options and none of them worked, I was unsure of which one to post."}], "tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 0, "last_activity_date": 1575145040, "last_edit_date": 1575145040, "creation_date": 1575124815, "answer_id": 59117157, "question_id": 59117025, "link": "https://stackoverflow.com/questions/59117025/how-to-read-data-from-telnet-session/59117157#59117157", "title": "How to read data from Telnet session", "body": "<p>Where is your read operation from connection ? \nI think you need to call conn.read(buffer) to read from the connection and write it to buffer</p>\n\n<pre><code>https://godoc.org/github.com/reiver/go-telnet#Conn.Read\n</code></pre>\n\n<p>The examples are not helping much with hte package that you are using. May be the following example taken out of different telnet go package would be more helpful. </p>\n\n<pre><code>https://github.com/ziutek/telnet/blob/master/examples/unix-cisco/main.go\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1575203420, "post_id": 59123115, "comment_id": 104479543, "body": "I think I understand now. Well, Read on sockets returns after reading as many bytes as is available in the socket buffer maintained by the OS. So reading into a slice of length 1024 should have went OK \u2014 reading 1 to 1024 bytes. If the connection provided by that Telnet package works differently, it&#39;s a bug in it. Now, as far as I understand, your device implements textual protocol. Such protocols are best dealt with by using &quot;line-wise&quot; processing; in your case a line is any number of bytes terminated by CRLF sequence."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1575203590, "post_id": 59123115, "comment_id": 104479588, "body": "\u2026to deal with that, first wrap your Conn in a <code>bufio.Reader</code> and then use it&#39;s ReadLine or ReadBytes methods to read complete lines."}], "tags": [], "owner": {"reputation": 29, "user_id": 12460597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7414cb69034a8f95b441ca1efe98d689?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/12460597/alexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1575181765, "creation_date": 1575181765, "answer_id": 59123115, "question_id": 59117025, "link": "https://stackoverflow.com/questions/59117025/how-to-read-data-from-telnet-session/59123115#59123115", "title": "How to read data from Telnet session", "body": "<p>Thanks everyone, who spared their time to answer my question. I managed to identify the problem:</p>\n\n<ol>\n<li><p>Every time I created a read buffer it was too big (1024 bytes) so the program was waiting for it to fill up. Now I'm using a cycle reading to a 1 byte buffer. </p></li>\n<li><p>It seems, I also needed some criterion for the function to stop reading and proceed with sending commands. </p></li>\n</ol>\n\n<p>Here is the working piece of code:</p>\n\n<pre><code>// Thin function reads from Telnet session. \"expect\" is a string I use as signal to stop reading\nfunc ReaderTelnet(conn *telnet.Conn, expect string) (out string) {\n    var buffer [1]byte\n    recvData := buffer[:]\n    var n int\n    var err error\n\n    for {\n        n, err = conn.Read(recvData)\n        fmt.Println(\"Bytes: \", n, \"Data: \", recvData, string(recvData))\n        if n &lt;= 0 || err != nil || strings.Contains(out, expect) {\n            break\n        } else {\n            out += string(recvData)\n        }\n    }\n    return out\n}\n\n//convert a command to bytes, and send to Telnet connection followed by '\\r\\n' \nfunc SenderTelnet(conn *telnet.Conn, command string) {\n    var commandBuffer []byte\n    for _, char := range command {\n        commandBuffer = append(commandBuffer, byte(char))\n    }\n\n    var crlfBuffer [2]byte = [2]byte{'\\r', '\\n'}\n    crlf := crlfBuffer[:]\n\n    fmt.Println(commandBuffer)\n\n    conn.Write(commandBuffer)\n    conn.Write(crlf)\n}\n\nfunc main() {\n    conn, err := telnet.DialTo(\"10.10.10.2:23\")\n    if nil != err {\n        fmt.Println(err)\n    }\n\n    fmt.Print(ReaderTelnet(conn, \"Login\"))\n    SenderTelnet(conn, \"root\")\n    fmt.Print(ReaderTelnet(conn, \"Password\"))\n    SenderTelnet(conn, \"root\")\n    fmt.Print(ReaderTelnet(conn, \"&gt;\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12460597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7414cb69034a8f95b441ca1efe98d689?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/12460597/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1006, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1575181765, "creation_date": 1575123666, "last_edit_date": 1575134744, "question_id": 59117025, "link": "https://stackoverflow.com/questions/59117025/how-to-read-data-from-telnet-session", "title": "How to read data from Telnet session", "body": "<p>I'm trying to create a tool to connect to a network device by Telnet and send some commands (Expect-like with certain additional requirements) using <a href=\"https://godoc.org/github.com/reiver/go-telnet\" rel=\"nofollow noreferrer\">go-telnet</a>. </p>\n\n<p>To the moment I managed to create a connection and send commands with something like this:</p>\n\n<pre><code>func main() {\n    var loginBuffer = [6]byte{'r', 'o', 'o', 't', '\\r', '\\n'}\n    var login = loginBuffer[:]\n\n    conn, err := telnet.DialTo(\"10.10.10.2:23\")\n    if nil != err {\n        fmt.Println(err)\n    }\n    defer conn.Close()\n\n    conn.Write(login)\n}\n</code></pre>\n\n<p>Using Wireshark I can see the device responding, however I cannot read any response data. Guess I'm using Read() in a wrong way, not sure. </p>\n\n<p>Would appreciate a working example or an explanation of how to capture and process response data in this case.</p>\n"}, {"tags": ["docker", "ubuntu", "go"], "comments": [{"owner": {"reputation": 2292, "user_id": 6051596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CDh6.jpg?s=128&g=1", "display_name": "Atmanirbhar Bharat", "link": "https://stackoverflow.com/users/6051596/atmanirbhar-bharat"}, "edited": false, "score": 3, "creation_date": 1575097873, "post_id": 59114009, "comment_id": 104458676, "body": "Apke sure you update Ubuntu with all the latest packages... uninstall docker and then do a frsh install"}, {"owner": {"reputation": 669, "user_id": 3366437, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3d90a6c57b241d3501731eef0ef0d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Fatemeh Majd", "link": "https://stackoverflow.com/users/3366437/fatemeh-majd"}, "reply_to_user": {"reputation": 2292, "user_id": 6051596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CDh6.jpg?s=128&g=1", "display_name": "Atmanirbhar Bharat", "link": "https://stackoverflow.com/users/6051596/atmanirbhar-bharat"}, "edited": false, "score": 0, "creation_date": 1575097962, "post_id": 59114009, "comment_id": 104458692, "body": "@SoumenMukherjeeI did that too, and updated the apt, updated all the installed packages, remove docker completely, updated apt again and installed docker. still the same error"}], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 3366437, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3d90a6c57b241d3501731eef0ef0d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Fatemeh Majd", "link": "https://stackoverflow.com/users/3366437/fatemeh-majd"}, "edited": false, "score": 0, "creation_date": 1575104273, "post_id": 59114577, "comment_id": 104459786, "body": "1-3 or ok. for 4, I get  level=warning msg=&quot;Your kernel does not support cgroup rt runtime&quot;"}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "reply_to_user": {"reputation": 669, "user_id": 3366437, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3d90a6c57b241d3501731eef0ef0d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Fatemeh Majd", "link": "https://stackoverflow.com/users/3366437/fatemeh-majd"}, "edited": false, "score": 1, "creation_date": 1575114329, "post_id": 59114577, "comment_id": 104461865, "body": "ok , it must be something i got few days back with fedora 31, there was workaround for it i havent tried , the new linux kernal does not support cgroup feature i think , Posted something on answer to check"}, {"owner": {"reputation": 669, "user_id": 3366437, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3d90a6c57b241d3501731eef0ef0d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Fatemeh Majd", "link": "https://stackoverflow.com/users/3366437/fatemeh-majd"}, "edited": false, "score": 0, "creation_date": 1575115473, "post_id": 59114577, "comment_id": 104462078, "body": "thank you. although the command did not work, you gave me the idea to look after something. I&#39;ll post the answer"}], "tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 2, "last_activity_date": 1575114453, "last_edit_date": 1575114453, "creation_date": 1575103383, "answer_id": 59114577, "question_id": 59114009, "link": "https://stackoverflow.com/questions/59114009/any-docker-command-gives-error-bad-symbol-table/59114577#59114577", "title": "any docker command gives error: bad symbol table", "body": "<ol>\n<li>please check there is enough space in /var by df -h /var command </li>\n<li>Check and make sure you are installed and running docker in root or admin access</li>\n<li>Try delete the contents from /var/lib/docker and start the docker again</li>\n<li>Also try getting logs by running systemctl status docker or serivce docker status</li>\n<li>Check if any other service which blocks docker</li>\n<li>check by disabling firewall and selinux getforce to be permissive </li>\n<li>If you are using device mapper try clean that up and restart docker service</li>\n<li>Check if there is any release notes on unbutu where there is known bug which blocks the system to start it</li>\n</ol>\n\n<p>Get info on the system configuration and service/systemd stutus logs and post it to look for specific errors </p>\n\n<p>I cant post all these checks in your comment itself since i am posting it in answer section , and this is not a answer rather suggesting you to check something</p>\n\n<p>Update : \nPlease try this link <a href=\"https://github.com/docker/for-linux/issues/665\" rel=\"nofollow noreferrer\">https://github.com/docker/for-linux/issues/665</a> and \nthe command,no sure if the same command works for ubuntu, but give it a try </p>\n\n<pre><code>sudo grubby --update-kernel=ALL --args=\"systemd.unified_cgroup_hierarchy=0\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 669, "user_id": 3366437, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3d90a6c57b241d3501731eef0ef0d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Fatemeh Majd", "link": "https://stackoverflow.com/users/3366437/fatemeh-majd"}, "is_accepted": false, "score": 1, "last_activity_date": 1575115673, "creation_date": 1575115673, "answer_id": 59116015, "question_id": 59114009, "link": "https://stackoverflow.com/questions/59114009/any-docker-command-gives-error-bad-symbol-table/59116015#59116015", "title": "any docker command gives error: bad symbol table", "body": "<p>For anyone encountering the same problem:</p>\n\n<p>Thanks to @cslrns, I started searching about the error: <code>Your kernel does not support cgroup</code></p>\n\n<p>turns out in my ubuntu version, whose kernel is apparently not bionic, does not support something that the newer versions of docker-ce need. </p>\n\n<p>do NOT install the docker-ce-cli, it's the problem. just install the latest docker-ce version without \"bionic\" in its name</p>\n"}], "owner": {"reputation": 669, "user_id": 3366437, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3d90a6c57b241d3501731eef0ef0d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Fatemeh Majd", "link": "https://stackoverflow.com/users/3366437/fatemeh-majd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1575115673, "creation_date": 1575097639, "last_edit_date": 1575103851, "question_id": 59114009, "link": "https://stackoverflow.com/questions/59114009/any-docker-command-gives-error-bad-symbol-table", "title": "any docker command gives error: bad symbol table", "body": "<p>I installed the docker engine successfully and no error or warning is shown.\nBut after that, whenever I try any docker command, even docker ps, I get this error:</p>\n\n<pre><code>runtime: pcdata is -2 and 76 args stack map entries for net/http.(*Transport).dialConn (targetpc=0x55afd17107cb)\nfatal error: bad symbol table\n\nruntime stack:\nruntime.throw(0x55afd29a0fb2, 0x10)\n    /usr/local/go/src/runtime/panic.go:617 +0x74\nruntime.getStackMap(0x7f96177fdad0, 0x7f96177fdbd8, 0x55afd1710701, 0x55afd1407b91, 0x0, 0x55afd2a74601, 0x55af00000000, 0x0, 0x0, 0x0)\n    /usr/local/go/src/runtime/stack.go:1274 +0x522\nruntime.adjustframe(0x7f96177fdad0, 0x7f96177fdbc0, 0x55afd48c2a20)\n    /usr/local/go/src/runtime/stack.go:628 +0x86\nruntime.gentraceback(0xffffffffffffffff, 0xffffffffffffffff, 0x0, 0xc0000aa900, 0x0, 0x0, 0x7fffffff, 0x55afd36a4f50, 0x7f96177fdbc0, 0x0, ...)\n    /usr/local/go/src/runtime/traceback.go:341 +0x13a0\nruntime.copystack(0xc0000aa900, 0x1000, 0x101)\n    /usr/local/go/src/runtime/stack.go:881 +0x25d\nruntime.newstack()\n    /usr/local/go/src/runtime/stack.go:1050 +0x301\nruntime.morestack()\n    /usr/local/go/src/runtime/asm_amd64.s:429 +0x84\n\ngoroutine 25 [copystack]:\nnet/http.(*Transport).dialConn(0xc0004f1d40, 0x55afd3729ce0, 0xc0000d4020, 0x0, 0x55afd298d9af, 0x4, 0xc0001323e0, 0x17, 0x0, 0x0, ...)\n    /usr/local/go/src/net/http/transport.go:1150 +0x1fcc fp=0xc000083f00 sp=0xc000083ef8 pc=0x55afd17107cc\nnet/http.(*Transport).getConn.func4(0xc0004f1d40, 0x55afd3729ce0, 0xc0000d4020, 0xc0004cfec0, 0xc00005c180)\n    /usr/local/go/src/net/http/transport.go:1017 +0xa8 fp=0xc000083fb8 sp=0xc000083f00 pc=0x55afd171a7f8\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:1337 +0x1 fp=0xc000083fc0 sp=0xc000083fb8 pc=0x55afd1407b91\ncreated by net/http.(*Transport).getConn\n    /usr/local/go/src/net/http/transport.go:1016 +0x457\n\ngoroutine 1 [select]:\nnet/http.(*Transport).getConn(0xc0004f1d40, 0xc0004cfe90, 0x0, 0x55afd298d9af, 0x4, 0xc0001323e0, 0x17, 0x0, 0x0, 0x0, ...)\n    /usr/local/go/src/net/http/transport.go:1022 +0x63f\nnet/http.(*Transport).roundTrip(0xc0004f1d40, 0xc0004de700, 0x10, 0xc0003afad0, 0xc000279540)\n    /usr/local/go/src/net/http/transport.go:531 +0x6f1\nnet/http.(*Transport).RoundTrip(0xc0004f1d40, 0xc0004de700, 0xc0004f1d40, 0x0, 0x0)\n    /usr/local/go/src/net/http/roundtrip.go:17 +0x37\nnet/http.send(0xc0004de700, 0x55afd36d4520, 0xc0004f1d40, 0x0, 0x0, 0x0, 0xc0003d0570, 0x55afd15fe788, 0x1, 0x0)\n    /usr/local/go/src/net/http/client.go:250 +0x463\nnet/http.(*Client).send(0xc0004cfd70, 0xc0004de700, 0x0, 0x0, 0x0, 0xc0003d0570, 0x0, 0x1, 0x55afd33aa540)\n    /usr/local/go/src/net/http/client.go:174 +0xfd\nnet/http.(*Client).do(0xc0004cfd70, 0xc0004de700, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/http/client.go:641 +0x27b\nnet/http.(*Client).Do(...)\n    /usr/local/go/src/net/http/client.go:509\ngithub.com/docker/cli/vendor/github.com/docker/docker/client.(*Client).doRequest(0xc0000e8c00, 0x55afd3729ce0, 0xc0000d4020, 0xc0004de600, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n    /go/src/github.com/docker/cli/vendor/github.com/docker/docker/client/request.go:134 +0x13f\ngithub.com/docker/cli/vendor/github.com/docker/docker/client.(*Client).Ping(0xc0000e8c00, 0x55afd3729ce0, 0xc0000d4020, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n    /go/src/github.com/docker/cli/vendor/github.com/docker/docker/client/ping.go:26 +0x167\ngithub.com/docker/cli/cli/command.(*DockerCli).initializeFromClient(0xc0002620f0)\n    /go/src/github.com/docker/cli/cli/command/cli.go:346 +0x67\ngithub.com/docker/cli/cli/command.(*DockerCli).Initialize(0xc0002620f0, 0xc0002551e0, 0x0, 0x0, 0x0, 0x55afd3373740, 0xc0003baf00)\n    /go/src/github.com/docker/cli/cli/command/cli.go:255 +0x4a2\ngithub.com/docker/cli/cli.(*TopLevelCommand).Initialize(0xc0000dbe40, 0x0, 0x0, 0x0, 0x1, 0x0)\n    /go/src/github.com/docker/cli/cli/cobra.go:155 +0x7a\nmain.runDocker(0xc0002620f0, 0x55afd36d4820, 0xc0000d6010)\n    /go/src/github.com/docker/cli/cmd/docker/docker.go:257 +0xc1\nmain.main()\n    /go/src/github.com/docker/cli/cmd/docker/docker.go:292 +0xf3\n\ngoroutine 21 [syscall]:\nos/signal.signal_recv(0x55afd1407b96)\n    /usr/local/go/src/runtime/sigqueue.go:139 +0x9e\nos/signal.loop()\n    /usr/local/go/src/os/signal/signal_unix.go:23 +0x24\ncreated by os/signal.init.0\n    /usr/local/go/src/os/signal/signal_unix.go:29 +0x43\n\ngoroutine 23 [chan receive]:\ngithub.com/docker/cli/vendor/k8s.io/klog.(*loggingT).flushDaemon(0x55afd4928ca0)\n    /go/src/github.com/docker/cli/vendor/k8s.io/klog/klog.go:943 +0x8d\ncreated by github.com/docker/cli/vendor/k8s.io/klog.init.0\n    /go/src/github.com/docker/cli/vendor/k8s.io/klog/klog.go:403 +0x6e\n</code></pre>\n\n<p>I cound not find any answer through search and didn't find similar problem anywhere on the internet.</p>\n\n<p>I thought maybe there is a problem with Go, so I installed go and ran a program with it successfully, but still no success with docker.</p>\n"}, {"tags": ["mongodb", "go", "struct", "reflection", "append"], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 5, "user_id": 7556050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9df6263629c6f8bc501b101c1d29a4?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Alaniz", "link": "https://stackoverflow.com/users/7556050/omar-alaniz"}, "edited": false, "score": 0, "creation_date": 1575096915, "post_id": 59113754, "comment_id": 104458508, "body": "The call to <code>createQuery(&amp;docs.Projects, collection)</code> decodes documents to an <code>entities.Project</code> value and appends those values to the slice <code>docs.Projects</code>.  The application can iterate through the documents and access fields like so: <code>for _, doc := range docs.Projects {    fmt.Println(doc.Title) } </code>"}, {"owner": {"reputation": 5, "user_id": 7556050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9df6263629c6f8bc501b101c1d29a4?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Alaniz", "link": "https://stackoverflow.com/users/7556050/omar-alaniz"}, "edited": false, "score": 0, "creation_date": 1575097159, "post_id": 59113754, "comment_id": 104458556, "body": "it decodes the documents to an entities.Project value through Projects because []Project? sorry for lack of knowledge still kind of getting used to Go! Thanks for the massive amounts of help!!!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 5, "user_id": 7556050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9df6263629c6f8bc501b101c1d29a4?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Alaniz", "link": "https://stackoverflow.com/users/7556050/omar-alaniz"}, "edited": false, "score": 0, "creation_date": 1575097967, "post_id": 59113754, "comment_id": 104458693, "body": "The function is passed a pointer to a <code>[]entities.Project</code>. The function decodes to values values of that slice element type.  The fact that the slice is a field in <code>entities.Projects</code> has no relevance to the function."}, {"owner": {"reputation": 5, "user_id": 7556050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9df6263629c6f8bc501b101c1d29a4?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Alaniz", "link": "https://stackoverflow.com/users/7556050/omar-alaniz"}, "edited": false, "score": 0, "creation_date": 1575098444, "post_id": 59113754, "comment_id": 104458769, "body": "it throws this error <code>panic: reflect: Elem of invalid type</code> at <code>documentType := documentsVal.Type().Elem()</code> also when i do docsv.String() it points to entities.Projects"}, {"owner": {"reputation": 5, "user_id": 7556050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9df6263629c6f8bc501b101c1d29a4?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Alaniz", "link": "https://stackoverflow.com/users/7556050/omar-alaniz"}, "edited": false, "score": 0, "creation_date": 1575098903, "post_id": 59113754, "comment_id": 104458866, "body": "so it throws no error and it works if i do []entities.Project."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 5, "user_id": 7556050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9df6263629c6f8bc501b101c1d29a4?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Alaniz", "link": "https://stackoverflow.com/users/7556050/omar-alaniz"}, "edited": false, "score": 0, "creation_date": 1575099000, "post_id": 59113754, "comment_id": 104458879, "body": "It looks like you are passing the address of <code>entities.Projects</code>  to the function. Pass the address of the Project&#39;s Projects field as shown in the answer: <code>var docs entities.Projects; createQuery(&amp;docs.Projects, collection)</code>."}, {"owner": {"reputation": 5, "user_id": 7556050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9df6263629c6f8bc501b101c1d29a4?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Alaniz", "link": "https://stackoverflow.com/users/7556050/omar-alaniz"}, "edited": false, "score": 0, "creation_date": 1575140754, "post_id": 59113754, "comment_id": 104468444, "body": "Yup, that&#39;s the answer! I was stuck on this problem for so long that i had a case of tunnel vision thanks for the help!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1575097630, "last_edit_date": 1575097630, "creation_date": 1575094997, "answer_id": 59113754, "question_id": 59113543, "link": "https://stackoverflow.com/questions/59113543/appending-data-to-an-interface-pointing-to-a-defined-struct-using-reflect/59113754#59113754", "title": "Appending Data to an Interface Pointing to a Defined Struct using &#39;reflect&#39;", "body": "<p>The code in the question passes the struct <code>docs</code> to a function that expects a slice. Pass the address of the slice field in <code>docs</code> instead of <code>docs</code> itself.</p>\n\n<p>The <code>createQuery</code> function can determine the slice element type from the slice itself. There's no need to pass in an example value.</p>\n\n<pre><code>var docs entities.Projects\ncreateQuery(&amp;docs.Projects, collection)\nfor _, doc := range docs.Projects {\n   fmt.Println(doc.Title)\n}\n</code></pre>\n\n<p>The call to <code>cur.Decode</code> requires a pointer to an uninitialized value. Use reflect.New to create that value.</p>\n\n<pre><code>func createQuery(docs interface{}, c *mongo.Collection) {\n    docsv := reflect.ValueOf(docs).Elem()\n    doct := docsv.Type().Elem()\n\n    cur, err := c.Find(context.Background(), bson.D{{}})\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for cur.Next(context.Background()) {\n        docpv := reflect.New(doct)\n        err = cur.Decode(docpv.Interface())\n        if err != nil {\n            log.Fatal(err)\n        }\n        docsv.Set(reflect.Append(docsv, docpv.Elem()))\n    }\n    if err := cur.Err(); err != nil {\n        log.Fatal(err)\n    }\n    cur.Close(context.Background())\n}\n</code></pre>\n\n<p>As an aside, the <code>entities.Projects</code> struct type is not needed if that struct type will only ever have one field.  Use <code>[]Project</code> instead:</p>\n\n<pre><code>var docs []entities.Project\ncreateQuery(&amp;docs, collection)\nfor _, doc := range docs {\n   fmt.Println(doc.Title)\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7556050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9df6263629c6f8bc501b101c1d29a4?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Alaniz", "link": "https://stackoverflow.com/users/7556050/omar-alaniz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 59113754, "answer_count": 1, "score": 0, "last_activity_date": 1575097630, "creation_date": 1575092533, "last_edit_date": 1575097215, "question_id": 59113543, "link": "https://stackoverflow.com/questions/59113543/appending-data-to-an-interface-pointing-to-a-defined-struct-using-reflect", "title": "Appending Data to an Interface Pointing to a Defined Struct using &#39;reflect&#39;", "body": "<p>I am trying to create a function where it gets all the documents from a Mongo Collection and queries them to declared structs. To achieve this I set the parameters for the function of type interface so it can work with two structs. Here is my code:</p>\n\n<p>In package entities:</p>\n\n<pre><code>type Project struct {\n    Title string\n    Position string\n    ....\n}\n\ntype Projects struct {\n    Projects []Project\n}\n</code></pre>\n\n<p>In the current package: </p>\n\n<pre><code>var docs entities.Projects\nvar doc entities.Project\n\n//doc represents a document from Mongo Collection \n//docs represents an array of documents, each element is a document\n//collection has type *mongo.Collection and points to the desired collection on MongoDB.\ncreateQuery(&amp;doc, &amp;docs, collection)\n\nfunc createQuery(doc interface{}, docs interface{}, c *mongo.Collection) {\n    documents := reflect.ValueOf(docs).Elem()\n    document := reflect.ValueOf(doc)\n\n    cur, err := c.Find(context.Background(), bson.D{{}})\n\n    if err != nil {\n        log.Fatal(err)\n    }\n    for cur.Next(context.Background()) {\n        err = cur.Decode(document.Interface())\n        if err != nil {\n            log.Fatal(err)\n        }\n        //Error is thrown here\n        documents.Set(reflect.Append(documents, document))\n        fmt.Println(doc)\n    }\n    if err := cur.Err(); err != nil {\n        log.Fatal(err)\n    }\n\n    if err != nil {\n        fmt.Printf(\"oh shit this is the error %s \\n\", err)\n    }\n    cur.Close(context.Background())\n\n    fmt.Printf(\"documents: %+v\\n\", documents.Interface())\n    fmt.Printf(\"document: %+v\\n\", document.CanSet())\n}\n\n\n---ERROR OUTPUT---\npanic: reflect: call of reflect.Append on struct Value\n</code></pre>\n\n<p>I was able to set data to doc using the document variable, although when doing document.CanSet() is false (so it may not even work). Where the program breaks is when I try to append the document to the documents interface.</p>\n"}, {"tags": ["go", "phabricator"], "comments": [{"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1575120123, "post_id": 59113510, "comment_id": 104463172, "body": "can you post what is the error you are getting by running curl command?"}, {"owner": {"reputation": 11, "user_id": 6412106, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1UFGte7r4_Q/AAAAAAAAAAI/AAAAAAAAAMc/FYhE2tcAI9I/photo.jpg?sz=128", "display_name": "Udit Gupta", "link": "https://stackoverflow.com/users/6412106/udit-gupta"}, "reply_to_user": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1575148656, "post_id": 59113510, "comment_id": 104470303, "body": "This is the error: {&quot;result&quot;:null,&quot;error_code&quot;:&quot;ERR-CONDUIT-CORE&quot;,&quot;error_info&quot;:&zwnj;&#8203;&quot;Validation errors:\\n  - Projects must have a name.&quot;}"}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1575151279, "post_id": 59113510, "comment_id": 104470844, "body": "It looks like there is something missing on your curl request command , look carefully each input and find out what is missing and where the error is"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 3102011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363d4668cd624e338b3f50e2d76be7bd?s=128&d=identicon&r=PG", "display_name": "CasualSuperman", "link": "https://stackoverflow.com/users/3102011/casualsuperman"}, "is_accepted": false, "score": 0, "last_activity_date": 1606238014, "last_edit_date": 1606238014, "creation_date": 1575389549, "answer_id": 59161146, "question_id": 59113510, "link": "https://stackoverflow.com/questions/59113510/curl-command-for-conduit-api/59161146#59161146", "title": "Curl command for conduit API", "body": "<p>You have a few errors in your call. First one is that you're specifying two transactions to apply within the same index. Formatting your call a bit, we get:</p>\n<pre><code>curl https://test-caxzj6a226zp.phacility.com/api/project.edit \\\n    -d api.token=api-[token] \\\n    -d transactions[0][type]=parent \\\n    -d transactions[0][value]=[project-phid] \\\n    -d transactions[0][type]=members.add \\\n    -d transactions[0][value][]=[user-phid]\n</code></pre>\n<p>You have two definitions for <code>transactions[0]</code>, if you want to apply multiple transformations, you need to increment your index:</p>\n<pre><code>curl https://test-caxzj6a226zp.phacility.com/api/project.edit \\\n    -d api.token=api-[token] \\\n    -d transactions[0][type]=parent \\\n    -d transactions[0][value]=[project-phid] \\\n    -d transactions[1][type]=members.add \\\n    -d transactions[1][value][]=[user-phid]\n</code></pre>\n<p>Now, you didn't actually mention wanting to change the parent project, so I'm going to remove that transaction.</p>\n<pre><code>curl https://test-caxzj6a226zp.phacility.com/api/project.edit \\\n    -d api.token=api-[token] \\\n    -d transactions[0][type]=members.add \\\n    -d transactions[0][value][]=[user-phid]\n</code></pre>\n<p>The users to add is also an array, so you need to specify an index for that argument:</p>\n<pre><code>curl https://test-caxzj6a226zp.phacility.com/api/project.edit \\\n    -d api.token=api-[token] \\\n    -d transactions[0][type]=members.add \\\n    -d transactions[0][value][0]=[user-phid]\n</code></pre>\n<p>You could add additional users using <code>-d transactions[0][value][1]=[user-phid]</code>, <code>-d transactions[0][value][2]=[user-phid]</code> etc.</p>\n<p>Finally, you also need to specify which project you want to add the member to, since it's a required field. To do this, specify the project's numeric id (you can find this in its URL, <code>/project/view/1/</code>), its PHID, or its name/slug.</p>\n<pre><code>curl https://test-caxzj6a226zp.phacility.com/api/project.edit \\\n    -d api.token=api-[token] \\\n    -d transactions[0][type]=members.add \\\n    -d transactions[0][value][0]=[user-phid] \\\n    -d objectIdentifier=[project-phid]\n</code></pre>\n<p>You can actually submit a test call to conduit from within the conduit application, and after submitting it, one of the tabs in the example section will display the curl call required to perform that action via the API:</p>\n<p><a href=\"https://secure.phabricator.com/conduit/method/project.edit/\" rel=\"nofollow noreferrer\">https://secure.phabricator.com/conduit/method/project.edit/</a>\n<a href=\"https://i.stack.imgur.com/SuqVd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SuqVd.png\" alt=\"Example curl call\" /></a></p>\n"}], "owner": {"reputation": 11, "user_id": 6412106, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1UFGte7r4_Q/AAAAAAAAAAI/AAAAAAAAAMc/FYhE2tcAI9I/photo.jpg?sz=128", "display_name": "Udit Gupta", "link": "https://stackoverflow.com/users/6412106/udit-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1606238014, "creation_date": 1575092207, "last_edit_date": 1575150643, "question_id": 59113510, "link": "https://stackoverflow.com/questions/59113510/curl-command-for-conduit-api", "title": "Curl command for conduit API", "body": "<p>I've been trying to invoke conduit api using curl to add member to specific project and wrote following command: </p>\n\n<p>curl <a href=\"https://test-caxzj6a226zp.phacility.com/api/project.edit\" rel=\"nofollow noreferrer\">https://test-caxzj6a226zp.phacility.com/api/project.edit</a> -d api.token=api-[token] -d transactions[0][type]=parent -d transactions[0][value]=[project-phid] -d transactions[0][type]=members.add -d transactions[0][value][]=[user-phid]</p>\n\n<p>I've followed the instructions on <a href=\"https://secure.phabricator.com/conduit/method/project.edit/\" rel=\"nofollow noreferrer\">https://secure.phabricator.com/conduit/method/project.edit/</a> and was able to query project.search and user.search. But project.edit is giving me trouble. Any help will be appreciated.   </p>\n\n<p>PS: I get the following error: {\"result\":null,\"error_code\":\"ERR-CONDUIT-CORE\",\"error_info\":\"Validation errors:\\n - Projects must have a name.\"}</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5491189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336d829c915848f91b6b78bd54b1692b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Connors", "link": "https://stackoverflow.com/users/5491189/nick-connors"}, "edited": false, "score": 0, "creation_date": 1575092678, "post_id": 59113536, "comment_id": 104457877, "body": "Duh. You are awesome. I knew it was something stupid like that. I have been staring at code too much today and knew I was just overlooking something simple."}, {"owner": {"reputation": 166, "user_id": 9264788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-exhMuJLXtxA/AAAAAAAAAAI/AAAAAAAAAIE/AEAjeJQ6eTQ/photo.jpg?sz=128", "display_name": "Brian Williams", "link": "https://stackoverflow.com/users/9264788/brian-williams"}, "edited": false, "score": 0, "creation_date": 1575134324, "post_id": 59113536, "comment_id": 104466845, "body": "A tip on debugging this: Open your developer console in your browser and click &quot;Network&quot;, tick the &quot;Preserve Log&quot; checkbox, then submit your form. You should be able to see the HTTP request, and see if the parameters are there or not. This will help you determine if the problem is on the client (parameters missing) or on the server (parameters look as expected)."}], "tags": [], "owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "is_accepted": true, "score": 2, "last_activity_date": 1575092470, "creation_date": 1575092470, "answer_id": 59113536, "question_id": 59113498, "link": "https://stackoverflow.com/questions/59113498/form-data-is-always-empty-when-using-golang-and-bootstrap/59113536#59113536", "title": "Form data is always empty when using Golang and Bootstrap", "body": "<p>The  <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#htmlattrdefname\" rel=\"nofollow noreferrer\">name</a> attribute is missing from the <code>&lt;input&gt;</code> elements. If the name attribute is not set or empty, then the input value is not included in the submitted form.</p>\n\n<p>Fix like so:</p>\n\n<pre><code>    &lt;div class=\"form-group\"&gt;\n        &lt;label&gt;Name&lt;/label&gt;\n        &lt;input type=\"text\" name=\"name\" id=\"name\" class=\"form-control\" placeholder=\"Enter name\"&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>... and so on for the other input elements.</p>\n"}], "owner": {"reputation": 13, "user_id": 5491189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336d829c915848f91b6b78bd54b1692b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Connors", "link": "https://stackoverflow.com/users/5491189/nick-connors"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 59113536, "answer_count": 1, "score": 0, "last_activity_date": 1575092470, "creation_date": 1575092070, "question_id": 59113498, "link": "https://stackoverflow.com/questions/59113498/form-data-is-always-empty-when-using-golang-and-bootstrap", "title": "Form data is always empty when using Golang and Bootstrap", "body": "<p>So I am trying to use bootstrap to create a form and parse it in golang but the form data keeps coming back empty.</p>\n\n<p>Golang:</p>\n\n<pre><code>   // CreateEmployee - handler function for creating a new employee\nfunc CreateEmployee(w http.ResponseWriter, r *http.Request) {\n    err := r.ParseForm()\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    fmt.Println(r.Form)\n}\n</code></pre>\n\n<p>Bootstrap form:</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css\" integrity=\"sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M\" crossorigin=\"anonymous\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form action=\"/employee\" method=\"post\"&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Name&lt;/label&gt;\n            &lt;input type=\"text\" id=\"name\" class=\"form-control\" placeholder=\"Enter name\"&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Title&lt;/label&gt;\n            &lt;input type=\"text\" id=\"title\" class=\"form-control\" placeholder=\"Enter title\"&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Email&lt;/label&gt;\n            &lt;input type=\"email\" id=\"email\" class=\"form-control\" placeholder=\"Enter email\"&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Photo&lt;/label&gt;\n            &lt;input type=\"text\" id=\"photo\" class=\"form-control\" placeholder=\"Enter photo \n             location\"&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Phonetic&lt;/label&gt;\n            &lt;input type=\"text\" id=\"phonetic\" class=\"form-control\" placeholder=\"Enter \n              phonetic pronunciation\"&gt;\n        &lt;/div&gt;\n        &lt;button type=\"submit\" class=\"btn btn-primary\"&gt;Submit&lt;/button&gt;\n      &lt;/form&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p></p>\n\n<p>I am aware that you have to call ParseForm before r.Form is populated but as far as I can tell that is all that is required.</p>\n\n<p>The route is working fine because when I submit the form it is printing an empty map to the console. It seems that I am doing something stupid but can't figure it out.</p>\n"}]