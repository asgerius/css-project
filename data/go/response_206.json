[{"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1545258147, "post_id": 53859961, "comment_id": 94567903, "body": "<code>nil</code> is not a valid <code>string</code> type value, hence you cannot compare with it."}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 2, "last_activity_date": 1545258264, "creation_date": 1545258264, "answer_id": 53859998, "question_id": 53859961, "link": "https://stackoverflow.com/questions/53859961/cannot-convert-nil-to-type-string/53859998#53859998", "title": "Cannot convert nil to type string", "body": "<p>String is not a pointer type in Go therefore it cannot be <code>nil</code>. Zero value for string is empty string (\"\").</p>\n\n<p>The correct code should be:</p>\n\n<pre><code>params := r.URL.Query()\n\ntok := params[\"x-huru-api-token\"][0];\n\nif tok == \"\" {\n    tok := r.Header.Get(\"x-huru-api-token\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1545262938, "creation_date": 1545262938, "answer_id": 53860679, "question_id": 53859961, "link": "https://stackoverflow.com/questions/53859961/cannot-convert-nil-to-type-string/53860679#53860679", "title": "Cannot convert nil to type string", "body": "<p>The value <code>nil</code> is not a valid value for a <code>string</code>.  If you want to fallback to the header on both missing values and empty values, then using the following code:</p>\n\n<pre><code>params := r.URL.Query()\ntok := params.Get(\"x-huru-api-token\")\nif tok == \"\" {\n    tok = r.Header.Get(\"x-huru-api-token\")\n}\n</code></pre>\n\n<p>If you only want to fallback to the header when the query parameter is missing, then use the following:</p>\n\n<pre><code>params := r.URL.Query()\nvar tok string\nif values, ok := params[\"x-huru-api-token\"]; ok &amp;&amp; len(values) &gt; 0 {\n   tok = values[0]  // note that tok can be the empty string \"\"\n} else {\n   tok = r.Header.Get(\"x-huru-api-token\")\n}\n</code></pre>\n\n<p>Note one difference between the code in this answer and the question.  This answer uses assignment to set <code>tok</code> inside the if statement.  The code in the question uses a short variable declaration. The short variable declaration will not compile because the newly declared variable inside the if statement is not used.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4776, "favorite_count": 0, "accepted_answer_id": 53860679, "answer_count": 2, "score": 3, "last_activity_date": 1545262938, "creation_date": 1545258099, "question_id": 53859961, "link": "https://stackoverflow.com/questions/53859961/cannot-convert-nil-to-type-string", "title": "Cannot convert nil to type string", "body": "<p>I have this piece of code in a middleware func:</p>\n\n<pre><code>params := r.URL.Query()\n\ntok := params[\"x-huru-api-token\"][0];\n\nif tok == nil {\n    tok := r.Header.Get(\"x-huru-api-token\")\n}\n</code></pre>\n\n<p>but I get this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1nxdQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1nxdQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>anybody know what that's about? </p>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545251325, "post_id": 53858609, "comment_id": 94565164, "body": "Returning an audio file and a video file and an audio error and a video error very, very strongly indicates that this function is doing too much and should be two functions."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1545251398, "post_id": 53858609, "comment_id": 94565185, "body": "Particularly given the note that &quot;Audio file is sometimes not needed or required and it can be ignored&quot; I would say this just needs to be refactored into two functions which each do one thing rather than one function that does two things."}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 0, "creation_date": 1545251409, "post_id": 53858609, "comment_id": 94565190, "body": "I would try to go with typed errors, or just create <code>DownloadVideo</code> and <code>DownloadAudio</code>"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1545251580, "post_id": 53858609, "comment_id": 94565261, "body": "Which actually would mean that we download a file both times, check that we can open it both times and return an error both times. Sounds to me like it could be refactored to a single method."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545251900, "post_id": 53858609, "comment_id": 94565388, "body": "With the additional code this is definitely a case for some serious refactoring. Functions should do <i>one thing</i> and do it well. That&#39;s not just idiomatic in Go, that&#39;s universally good practice in any language."}, {"owner": {"reputation": 447, "user_id": 776896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f590ff1e6f4dab2937b0d27a59be828a?s=128&d=identicon&r=PG", "display_name": "the_real_one", "link": "https://stackoverflow.com/users/776896/the-real-one"}, "edited": false, "score": 0, "creation_date": 1545253328, "post_id": 53858609, "comment_id": 94565990, "body": "Thank you all for your feedback; I admittedly created this post without thinking of how I would refactor it but my objective here would be to basically hide all the details, give me a URL and a place you would like to store the video, and I will download the video, audio if it exists, and try to write out to the file you specified. I would like to keep all those details behind the scenes - these posts have inspired me to give this design a second glance more indepth than finding crafty or &quot;idiomatic&quot; ways to return multiple errors"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545255423, "post_id": 53858609, "comment_id": 94566844, "body": "Downloading a file which is then discarded by the caller seems incredibly wasteful. I&#39;m on the split-the-function train."}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1545259670, "post_id": 53858609, "comment_id": 94568424, "body": "we use errors.Wrap and errors.Wrapf a lot"}], "answers": [{"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1545254201, "last_edit_date": 1545254201, "creation_date": 1545253786, "answer_id": 53859174, "question_id": 53858609, "link": "https://stackoverflow.com/questions/53858609/idiomatic-way-to-return-multiple-errors-or-handle-them-accordingly/53859174#53859174", "title": "Idiomatic way to return multiple errors or handle them accordingly", "body": "<p>What you can see quite a bit in the standard library are specific functions which wrap more generic non-exported functions. See the commented code below.</p>\n\n<pre><code>// download is a rather generic function\n// and probably you can refactor downloadTemporaryFile\n// so that even this function is not needed any more.\nfunc (r *RedditVideo) download(prefix, url string) (filename string, error error) {\n    outputFile, err := downloadTemporaryFile(\n        r.VideoURL,\n        prefix,\n    )\n\n    if err == nil {\n        return \"\", fmt.Errorf(\"Error while download: %s\", err)\n    }\n\n    return outputFile.Name(), nil\n}\n\n// DownloadVideo wraps download, handing over the values specific\n// to the video download\nfunc (r *RedditVideo) DownloadVideo() (filename string, averror error) {\n    return r.download(TemporaryVideoFilePrefix, r.VideoURL)\n}\n\n// DownloadAudio wraps download, handing over the values specific\n// to the audio download\nfunc (r *RedditVideo) DownloadAudio() (filename string, averror error) {\n    return r.download(TemporaryAudioFilePrefix, r.AudioURL)\n}\n\nfunc main() {\n\n    r := RedditVideo{\n        VideoURL: os.Args[1],\n        AudioURL: os.Args[2],\n    }\n\n    var videoerror, audioerror error\n    var videofileName, audiofileName string\n\n    if videofileName, videoerror = r.DownloadVideo(); videoerror != nil {\n        fmt.Println(\"Got an error downloading the video\")\n    }\n\n    if audiofileName, audioerror = r.DownloadAudio(); audioerror != nil {\n        fmt.Println(\"Got an error downloading the audio\")\n    }\n\n    fmt.Printf(\"Video:\\t%s\\nAudio:\\t%s\", videofileName, audiofileName)\n}\n</code></pre>\n\n<p>This way, it is obvious from which download the returned error stems from.</p>\n"}, {"comments": [{"owner": {"reputation": 447, "user_id": 776896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f590ff1e6f4dab2937b0d27a59be828a?s=128&d=identicon&r=PG", "display_name": "the_real_one", "link": "https://stackoverflow.com/users/776896/the-real-one"}, "edited": false, "score": 0, "creation_date": 1545278081, "post_id": 53859669, "comment_id": 94572334, "body": "i have seen this a lot:  if err = doSomething(); err != nil {\\n return err\\n }"}], "tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": false, "score": 0, "last_activity_date": 1545256438, "creation_date": 1545256438, "answer_id": 53859669, "question_id": 53858609, "link": "https://stackoverflow.com/questions/53858609/idiomatic-way-to-return-multiple-errors-or-handle-them-accordingly/53859669#53859669", "title": "Idiomatic way to return multiple errors or handle them accordingly", "body": "<p>From <a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"nofollow noreferrer\">https://blog.golang.org/error-handling-and-go</a>:</p>\n\n<blockquote>\n  <p>Go code uses error values to indicate an abnormal state.</p>\n</blockquote>\n\n<p>In your situation, Audio is optional and Video is required. Therefore only Video download should return error:</p>\n\n<pre><code>// Download will download the audio and video files to a particular path\n// empty outputAudioFileName indicates inability to download Audio File\nfunc (r *RedditVideo) Download() (outputVideoFileName string, outputAudioFileName string, err error) {\n    outputVideoFile, err := downloadTemporaryFile(\n        r.VideoURL,\n        TemporaryVideoFilePrefix,\n    )\n    if err != nil {\n        return \"\", \"\", err \n    }\n    outputVideoFileName := outputVideoFile.Name()\n    outputAudioFile, errAudio := downloadTemporaryFile(\n        r.AudioURL,\n        TemporaryAudioFilePrefix,\n    )\n    outputAudioFileName := \"\"\n    if errAudio == nil {\n        outputAudioFileName = outputAudioFile.Name()\n    } else {\n        // Log error, it is still important to fix it\n    }\n\n    return outputVideoFileName, outputAudioFileName, nil\n} \n</code></pre>\n\n<p>Rule of thumb - any code that can generate abnormal state should have in next line:</p>\n\n<pre><code>    if err != nil {\n        return funcResult, err\n    }\n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 776896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f590ff1e6f4dab2937b0d27a59be828a?s=128&d=identicon&r=PG", "display_name": "the_real_one", "link": "https://stackoverflow.com/users/776896/the-real-one"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 607, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545256438, "creation_date": 1545250873, "last_edit_date": 1545251487, "question_id": 53858609, "link": "https://stackoverflow.com/questions/53858609/idiomatic-way-to-return-multiple-errors-or-handle-them-accordingly", "title": "Idiomatic way to return multiple errors or handle them accordingly", "body": "<p>I have this code and I don't like the way it feels not to mention <code>golint</code> doesn't like it with <code>error should be the last type when returning multiple items (golint)</code>. To explain this code:</p>\n\n<ul>\n<li>I want to leave it to the user to decide whether they care about any of the errors returned</li>\n<li>Particularly in this code the Audio file is sometimes not needed or required and it can be ignored</li>\n<li>Video and Outputfile are likely always going to be required for whatever the user is doing</li>\n</ul>\n\n<p>I am open to refactoring this in any way (be it breaking it apart, moving things around, etc.) Is there a more <em>idiomatic</em> way in Go to accomplish something like this?</p>\n\n<pre><code>// Download will download the audio and video files to a particular path\nfunc (r *RedditVideo) Download() (outputVideoFileName string, outputAudioFileName string, errVideo error, errAudio error) {\n    outputVideoFile, errVideo := downloadTemporaryFile(\n        r.VideoURL,\n        TemporaryVideoFilePrefix,\n    )\n    if errVideo == nil {\n        outputVideoFileName = outputVideoFile.Name()\n    }\n\n    outputAudioFile, errAudio := downloadTemporaryFile(\n        r.AudioURL,\n        TemporaryAudioFilePrefix,\n    )\n    if errAudio == nil {\n        outputAudioFileName = outputAudioFile.Name()\n    }\n\n    return outputVideoFileName, outputAudioFileName, errVideo, errAudio\n}\n</code></pre>\n\n<p>Similarly I found myself using this same pattern again later in code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>// SetFiles sets up all of the input files and the output file\r\nfunc (l *localVideo) SetFiles(inputVideoFilePath string, inputAudioFilePath string, outputVideoFilePath string) (errVideo error, errAudio error, errOutputVideo error) {\r\n\t// Set input video file\r\n\tl.inputVideoFile, errVideo = os.Open(inputVideoFilePath)\r\n\tif errVideo != nil {\r\n\t\treturn\r\n\t}\r\n\tif errVideo = l.inputVideoFile.Close(); errVideo != nil {\r\n\t\treturn\r\n\t}\r\n\r\n\t// Set output video file\r\n\tl.outputVideoFile, errOutputVideo = os.Create(outputVideoFilePath)\r\n\tif errOutputVideo != nil {\r\n\t\treturn\r\n\t}\r\n\tif errOutputVideo = l.outputVideoFile.Close(); errOutputVideo != nil {\r\n\t\treturn\r\n\t}\r\n\r\n\t// IMPORTANT! Set input audio file LAST incase it is nil\r\n\tl.inputAudioFile, errAudio = os.Open(inputAudioFilePath)\r\n\tif errAudio != nil {\r\n\t\treturn\r\n\t}\r\n\tif errAudio = l.inputAudioFile.Close(); errVideo != nil {\r\n\t\treturn\r\n\t}\r\n\r\n\treturn\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>This time in this code again some of the same is true like above:</p>\n\n<ul>\n<li>We care that the Video and Output are set and may or may not care about the Audio</li>\n<li>There are multiple errors are there to handle that are left up to the user</li>\n</ul>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "answers": [{"comments": [{"owner": {"reputation": 334, "user_id": 4734545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53bb2d9115bd7432d570df349d90c40f?s=128&d=identicon&r=PG&f=1", "display_name": "setiabb", "link": "https://stackoverflow.com/users/4734545/setiabb"}, "edited": false, "score": 0, "creation_date": 1545250758, "post_id": 53857994, "comment_id": 94564959, "body": "Do you mean something like this? &quot;clientset.CoreV1().Pods(namespace).Get(&quot;podname&quot;, metav1.GetOptions{}).Status&quot;"}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1545247767, "creation_date": 1545247767, "answer_id": 53857994, "question_id": 53857593, "link": "https://stackoverflow.com/questions/53857593/how-to-get-status-of-a-pod-in-kubernetes-using-go-client/53857994#53857994", "title": "how to get status of a pod in kubernetes using go-client", "body": "<p>The status info is a sub-struct of the pod as a whole so you use the normal getter (clientset.CoreV1() etc) and then look in the <code>.Status</code> struct.</p>\n"}, {"comments": [{"owner": {"reputation": 334, "user_id": 4734545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53bb2d9115bd7432d570df349d90c40f?s=128&d=identicon&r=PG&f=1", "display_name": "setiabb", "link": "https://stackoverflow.com/users/4734545/setiabb"}, "edited": false, "score": 0, "creation_date": 1546246648, "post_id": 53876275, "comment_id": 94808050, "body": "Yes, This solution is working perfectly. Thank you so much."}], "tags": [], "owner": {"reputation": 486, "user_id": 10811259, "user_type": "registered", "profile_image": "https://graph.facebook.com/2076469725748344/picture?type=large", "display_name": "Stepan Maksimchuk", "link": "https://stackoverflow.com/users/10811259/stepan-maksimchuk"}, "is_accepted": true, "score": 11, "last_activity_date": 1545341234, "creation_date": 1545341234, "answer_id": 53876275, "question_id": 53857593, "link": "https://stackoverflow.com/questions/53857593/how-to-get-status-of-a-pod-in-kubernetes-using-go-client/53876275#53876275", "title": "how to get status of a pod in kubernetes using go-client", "body": "<p>You can use Get function to get specific pod information (below examples are getting whole Status struct):</p>\n\n<pre><code>pod, _ := clientset.CoreV1().Pods(\"kubernetes\").Get(pod.Name, metav1.GetOptions{})\nfmt.Println(pod.Status)\n</code></pre>\n\n<p>Also, you can use List function to get all pods in the particular namespace and then range them:</p>\n\n<pre><code>pods, _ := clientset.CoreV1().Pods(\"kubernetes\").List(metav1.ListOptions{FieldSelector: \"metadata.name=kubernetes\"})\nfor _, pod := range pods.Items {\n    fmt.Println(pod.Name, pod.Status)\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 334, "user_id": 4734545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53bb2d9115bd7432d570df349d90c40f?s=128&d=identicon&r=PG&f=1", "display_name": "setiabb", "link": "https://stackoverflow.com/users/4734545/setiabb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4794, "favorite_count": 2, "accepted_answer_id": 53876275, "answer_count": 2, "score": 4, "last_activity_date": 1545341234, "creation_date": 1545245855, "question_id": 53857593, "link": "https://stackoverflow.com/questions/53857593/how-to-get-status-of-a-pod-in-kubernetes-using-go-client", "title": "how to get status of a pod in kubernetes using go-client", "body": "<p>I am trying to delete a pod in my kubernetes cluster, then check its status to see how long does it take for the pod to get down, and up again. I could not find any helpful example for the second part which is getting a specific pod status using go-client. Any help is appreciated. </p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "comments": [{"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545244898, "post_id": 53857357, "comment_id": 94562461, "body": "What runtime are you using?"}, {"owner": {"reputation": 665, "user_id": 10458445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuPfqcdNqr8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVqgdU_dKUq7xVCZPveZKuIpMbx_A/mo/photo.jpg?sz=128", "display_name": "Steve", "link": "https://stackoverflow.com/users/10458445/steve"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545252437, "post_id": 53857357, "comment_id": 94565634, "body": "Thanks for responding.  Do you mean which go runtime?  I&#39;m not using 1.11 yet, just the old 1.9x.  Or are you asking something specific about google app engine standard?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545252485, "post_id": 53857357, "comment_id": 94565658, "body": "Standard vs flex and go vs go111"}, {"owner": {"reputation": 665, "user_id": 10458445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuPfqcdNqr8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVqgdU_dKUq7xVCZPveZKuIpMbx_A/mo/photo.jpg?sz=128", "display_name": "Steve", "link": "https://stackoverflow.com/users/10458445/steve"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545257636, "post_id": 53857357, "comment_id": 94567719, "body": "Standard + go for these services."}, {"owner": {"reputation": 665, "user_id": 10458445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuPfqcdNqr8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVqgdU_dKUq7xVCZPveZKuIpMbx_A/mo/photo.jpg?sz=128", "display_name": "Steve", "link": "https://stackoverflow.com/users/10458445/steve"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545266908, "post_id": 53857357, "comment_id": 94570186, "body": "Ok, this might be my answer:  1. Create the two accounts from the tutorial and follow the steps. (There will be no service accounts since there is no compute or app engine instances).   2. Go to IAM for the kms storage project and add any other projects that you want to have access (by their service account emails) and add the role for viewing buckets. 3. Go to IAM for the kms management project and add project service account emails with roles for decrypting.  With those simple steps, it works for me.  Localhost dev works too: &quot;gcloud auth application-default login&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 749, "user_id": 3397281, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1wOeS.jpg?s=128&g=1", "display_name": "wooters", "link": "https://stackoverflow.com/users/3397281/wooters"}, "edited": false, "score": 0, "creation_date": 1572375229, "post_id": 53875444, "comment_id": 103537502, "body": "+1 For the &quot;gcloud auth application-default login&quot;. Looks way easier than setting up a service account for localhost dev."}], "tags": [], "owner": {"reputation": 665, "user_id": 10458445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuPfqcdNqr8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVqgdU_dKUq7xVCZPveZKuIpMbx_A/mo/photo.jpg?sz=128", "display_name": "Steve", "link": "https://stackoverflow.com/users/10458445/steve"}, "is_accepted": true, "score": 2, "last_activity_date": 1545336972, "creation_date": 1545336972, "answer_id": 53875444, "question_id": 53857357, "link": "https://stackoverflow.com/questions/53857357/how-should-i-create-service-accounts-for-accessing-secrets-between-gcp-projects/53875444#53875444", "title": "How should I create service accounts for accessing secrets between GCP projects with Google KMS?", "body": "<p>This is what I discovered works.  Until I hear that it's not correct or ideal, it's how I'm moving forward:</p>\n\n<ol>\n<li>Follow the \"storing secrets\" tutorial (<a href=\"https://cloud.google.com/kms/docs/store-secrets\" rel=\"nofollow noreferrer\">https://cloud.google.com/kms/docs/store-secrets</a>).</li>\n</ol>\n\n<p>Note that when creating the two accounts from the tutorial, there will be no service accounts automatically created since there is no compute or app engine instances by default.</p>\n\n<ol start=\"2\">\n<li><p>Go to IAM for the kms storage project and add any other projects with apps that you want to have access to download the encrypted secrets.  Add them by their service account emails, with the role for viewing buckets.</p></li>\n<li><p>Go to IAM for the kms management project and do the same for any projects with apps that you want to be decrypting the shared secrets, via their service account emails.</p></li>\n</ol>\n\n<p>For Localhost development, use \"gcloud auth application-default login\" before starting your services.</p>\n"}, {"tags": [], "owner": {"reputation": 733, "user_id": 11193025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zVJHj5gZLow/AAAAAAAAAAI/AAAAAAAAAOs/9wgAFNIrCUs/photo.jpg?sz=128", "display_name": "Andie Vanille", "link": "https://stackoverflow.com/users/11193025/andie-vanille"}, "is_accepted": false, "score": 3, "last_activity_date": 1592400095, "last_edit_date": 1592400095, "creation_date": 1552517299, "answer_id": 55152294, "question_id": 53857357, "link": "https://stackoverflow.com/questions/53857357/how-should-i-create-service-accounts-for-accessing-secrets-between-gcp-projects/55152294#55152294", "title": "How should I create service accounts for accessing secrets between GCP projects with Google KMS?", "body": "<p>For  your first question : \nThis could be happening due to the fact that those applications use the same services accounts that you created for the respective projects. In this case you would need to ensure that those applications do not use the aforementioned service accounts.   </p>\n\n<p>For your second question:\nYou might try to use one service account  at  organization  level . These service accounts would be inherited by all the projects in the organization. You can grant the service account those roles or permissions that meet your requirements </p>\n\n<p>For your  third question: \nThey are \u201cGlobal\u201d to all projects in case you  use  organization-level service accounts : you can take a look at this documentation where you  might find  valuable   information about <a href=\"https://cloud.google.com/iam/docs/service-accounts\" rel=\"nofollow noreferrer\">service accounts</a> and  <a href=\"https://cloud.google.com/resource-manager/docs/creating-managing-organization\" rel=\"nofollow noreferrer\">organization</a></p>\n\n<p>Please let me know your thoughts and how it goes.</p>\n"}], "owner": {"reputation": 665, "user_id": 10458445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuPfqcdNqr8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVqgdU_dKUq7xVCZPveZKuIpMbx_A/mo/photo.jpg?sz=128", "display_name": "Steve", "link": "https://stackoverflow.com/users/10458445/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 53875444, "answer_count": 2, "score": 2, "last_activity_date": 1592400095, "creation_date": 1545244744, "question_id": 53857357, "link": "https://stackoverflow.com/questions/53857357/how-should-i-create-service-accounts-for-accessing-secrets-between-gcp-projects", "title": "How should I create service accounts for accessing secrets between GCP projects with Google KMS?", "body": "<p>I've followed this tutorial: <a href=\"https://cloud.google.com/kms/docs/store-secrets\" rel=\"nofollow noreferrer\">https://cloud.google.com/kms/docs/store-secrets</a></p>\n\n<p>My next step was to have my apps read my secrets file from the storage bucket and decrypt safely at runtime.  These apps run within various projects (staging, dev, production etc). </p>\n\n<p>I've read the service account documentation over and over but can't quite understand the correct way forward.</p>\n\n<p>What I found that worked was to simply add service accounts to MY_KMS_PROJECT and MY_STORAGE_PROJECT from the tutorial.  I set them up to have access to read storage buckets and to decrypt KMS keys.  Just by creating those service accounts, suddenly apps in other projects could read and decrypt.  Is that how it's supposed to work? </p>\n\n<p>I thought that I would have had to create a service account for each project that I want to have accessing the KMS projects from the tutorial?  Or use IAM somehow to grant access?  For example, how would I grant access to some apps within some projects and not others?</p>\n\n<p>I'm attempting to now give access to apps when they are running in my local dev environment, which usually requires downloading a service account and pointing GOOGLE_APPLICATION_CREDENTIALS to the file.  But it seems strange to me to download the service accounts from the MY_KMS_PROJECT or MY_STORAGE_PROJECT, especially since I already have a service account for accessing firebase.  Are service accounts somehow global to all projects?  Can they be combined?  GOOGLE_APPLICATION_CREDENTIALS seems only good for pointing at a single service account.  </p>\n\n<p>Note: most of my apps are running on google app engine standard or flexible.</p>\n\n<p>Here is the code from the apps within my projects that \"just work\" as described above:</p>\n\n<pre><code>client, err := google.DefaultClient(ctx, cloudkms.CloudPlatformScope)\nif err != nil {\n    log.Fatal(err)\n}\n\n// Create the KMS client.\nkmsService, err := cloudkms.New(client)\nif err != nil {\n    log.Fatal(err)\n}\n....\n</code></pre>\n\n<p>And for accessing the bucket:</p>\n\n<pre><code>// Create the storage clientstorage\nClient, err := storage.NewClient(ctx)\nif err != nil {\n    log.Fatal(err)\n}\n....\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9967606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99271d3ef05c7c0e1814192beae0b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Brass P.", "link": "https://stackoverflow.com/users/9967606/brass-p"}, "edited": false, "score": 0, "creation_date": 1545242871, "post_id": 53856795, "comment_id": 94561621, "body": "Thanks for the help."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 2, "last_activity_date": 1545242176, "creation_date": 1545242176, "answer_id": 53856795, "question_id": 53856714, "link": "https://stackoverflow.com/questions/53856714/how-to-get-data-from-a-named-json-with-golangjason/53856795#53856795", "title": "How to get data from a named json with golang+jason?", "body": "<p><code>info =</code> is not valid JSON. Therefore, you have to start reading where the <code>{</code> begins and stop reading with the final closing <code>}</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9967606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99271d3ef05c7c0e1814192beae0b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Brass P.", "link": "https://stackoverflow.com/users/9967606/brass-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 53856795, "answer_count": 1, "score": -2, "last_activity_date": 1545242176, "creation_date": 1545241878, "question_id": 53856714, "link": "https://stackoverflow.com/questions/53856714/how-to-get-data-from-a-named-json-with-golangjason", "title": "How to get data from a named json with golang+jason?", "body": "<p>I've this json:</p>\n\n<pre><code>info = {\"key1\": 1 , \"key2\": 1 , \"key3\": 3}\n</code></pre>\n\n<p>I would like to get the value from <code>key1</code> with <a href=\"https://github.com/antonholmquist/jason\" rel=\"nofollow noreferrer\">jason</a> and <code>NewObjectFromReader</code>.</p>\n\n<p>I'm using this code:</p>\n\n<pre><code>statusBody, err := jason.NewObjectFromReader(res.Body)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p><code>res.Body</code> is a <code>io.Reader</code>, so that part is fine (I guess). <code>go run</code> shows this problem:</p>\n\n<pre><code>2018/12/19 18:02:40 invalid character 'i' looking for beginning of value\n</code></pre>\n\n<p>I think the problem is that the json starts with <code>info=</code> instead of <code>{</code>. Any idea how to parse this json?.</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-speech"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545254298, "post_id": 53856072, "comment_id": 94566401, "body": "Hello and welcome! You might want to read <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a>, which enhances the probability for getting a useful answer <i>drastically</i>. You might find <a href=\"https://en.m.wikipedia.org/wiki/Eric_S._Raymond\" rel=\"nofollow noreferrer\">ESR</a>&#39;s excellent essay <a href=\"http://catb.org/~esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">How To Ask Questions The Smart Way</a> helpful, too - despite it&#39;s harsh title."}], "answers": [{"tags": [], "owner": {"reputation": 552, "user_id": 10801700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0zDnZ.jpg?s=128&g=1", "display_name": "alp", "link": "https://stackoverflow.com/users/10801700/alp"}, "is_accepted": false, "score": 0, "last_activity_date": 1545396416, "creation_date": 1545396416, "answer_id": 53885053, "question_id": 53856072, "link": "https://stackoverflow.com/questions/53856072/is-there-a-way-to-add-business-specific-metadata-to-be-stored-along-with-audio-f/53885053#53885053", "title": "Is there a way to add business specific metadata to be stored along with audio file stored on google cloud via google cloud speech logging?", "body": "<p><a href=\"https://cloud.google.com/speech-to-text/docs/data-logging\" rel=\"nofollow noreferrer\">Data logging</a> is only a way to send your data anonymously to Google to help improve the Speech API, there is no metadata that can be used here. The accessible metadata associated with samples only comprises the samples audio properties, passed in to the API  through the <a href=\"https://cloud.google.com/speech-to-text/docs/reference/rest/v1beta1/RecognitionConfig\" rel=\"nofollow noreferrer\"><code>RecognitionConfig</code> object</a>. </p>\n\n<p>Provided that you store your samples in Cloud Storage, you can use <a href=\"https://cloud.google.com/speech-to-text/docs/basics#uri-audio\" rel=\"nofollow noreferrer\">the bucket URI\u2019s to process sample requests</a>, or the <a href=\"https://cloud.google.com/storage/docs/reference/libraries\" rel=\"nofollow noreferrer\">Cloud Storage client library</a> to retrieve the samples with their unique filename.</p>\n"}], "owner": {"reputation": 11, "user_id": 10812288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71a32b74e45a80848beabc09075fd417?s=128&d=identicon&r=PG&f=1", "display_name": "Ayesha Y.", "link": "https://stackoverflow.com/users/10812288/ayesha-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1546011379, "creation_date": 1545239251, "last_edit_date": 1546011379, "question_id": 53856072, "link": "https://stackoverflow.com/questions/53856072/is-there-a-way-to-add-business-specific-metadata-to-be-stored-along-with-audio-f", "title": "Is there a way to add business specific metadata to be stored along with audio file stored on google cloud via google cloud speech logging?", "body": "<p>We are working on integrating with google cloud speech for speech to text conversion with logging enabled. When the audio files are logged we also need to store an additional Identifier stored with the audio file so that later on when we retrieve the audio file from google cloud we can perform entity to audio file association. Is that possible? Can we store user provided metadata along with the audio file? We are going to stream audio data for conversion and we need to store the audio file + some metadata supplied by us. </p>\n"}, {"tags": ["opencv", "ubuntu", "go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545238829, "post_id": 53855892, "comment_id": 94559678, "body": "What is your output from the command <code>go env</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 1, "last_activity_date": 1545238819, "creation_date": 1545238819, "answer_id": 53855947, "question_id": 53855892, "link": "https://stackoverflow.com/questions/53855892/conputer-vision-with-go-get-me-an-error-when-i-try-to-download-it/53855947#53855947", "title": "conputer vision with go get me an error when i try to download it", "body": "<p>It looks like you have installed the go binary into where your default GOPATH is. Either set the GOPATH to be something different, or move your installation. </p>\n"}], "owner": {"reputation": 11, "user_id": 8340980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7819910a484d4c2d6c2115d5ece371?s=128&d=identicon&r=PG&f=1", "display_name": "Ariel Serafim", "link": "https://stackoverflow.com/users/8340980/ariel-serafim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1545238819, "creation_date": 1545238630, "question_id": 53855892, "link": "https://stackoverflow.com/questions/53855892/conputer-vision-with-go-get-me-an-error-when-i-try-to-download-it", "title": "conputer vision with go get me an error when i try to download it", "body": "<p>whem i use the comand:</p>\n\n<p>$ go get -u -d gocv.io/x/gocv</p>\n\n<p>i get the error:</p>\n\n<p>package gocv.io/x/gocv: cannot download, /home/ariel/go is a GOROOT, not a GOPATH. For more details see: 'go help gopath'</p>\n\n<p>i\u1e3f using ubuntu 18.04</p>\n"}, {"tags": ["go", "udp"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545240690, "post_id": 53855589, "comment_id": 94560659, "body": "0.0.0.0 may select the public network interface, which is subject to firewalling. What happens if you use 127.0.0.1 instead?"}, {"owner": {"reputation": 11, "user_id": 2779717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c7mHx.jpg?s=128&g=1", "display_name": "bvlucena", "link": "https://stackoverflow.com/users/2779717/bvlucena"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545301815, "post_id": 53855589, "comment_id": 94580891, "body": "kdig -d @127.0.0.1:8853 facebook.com ?   The same timeout happens"}], "owner": {"reputation": 11, "user_id": 2779717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c7mHx.jpg?s=128&g=1", "display_name": "bvlucena", "link": "https://stackoverflow.com/users/2779717/bvlucena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545237648, "creation_date": 1545237648, "question_id": 53855589, "link": "https://stackoverflow.com/questions/53855589/udp-proxy-in-golang", "title": "UDP Proxy in Golang", "body": "<p>I am trying to create an UDP Proxy in Go without success. </p>\n\n<p>My objective is to get the DNS response from a server and write it back to the client.</p>\n\n<pre><code>$ kdig -d @0.0.0.0:8853 facebook.com\n\nn, client, err := u.server.ReadFromUDP(buf) // read request\n\nn, err = u.server.WriteToUDP(buf, client)  // write it back\n</code></pre>\n\n<p>Should i be doing something different? Response:</p>\n\n<pre><code>WARNING: response timeout for 0.0.0.0@8853(UDP)\n</code></pre>\n\n<p>PS: My TCP Implementation works fine.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["arrays", "dictionary", "go", "slice"], "comments": [{"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 0, "creation_date": 1545232224, "post_id": 53853919, "comment_id": 94555504, "body": "Can you be more clear ? Do you want to create Array of Arrays ?"}, {"owner": {"reputation": 1, "user_id": 10259308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Bxb6c7QM5II/AAAAAAAAAAI/AAAAAAAABTE/fOVILLWb9l4/photo.jpg?sz=128", "display_name": "Dmytro Kravchenko", "link": "https://stackoverflow.com/users/10259308/dmytro-kravchenko"}, "reply_to_user": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 0, "creation_date": 1545232394, "post_id": 53853919, "comment_id": 94555599, "body": "I need create array with first element with username and second element with array of structures ( records with events for this username )  Aha and I need 1 more array where all of this arrays will be included So, yes, it will be array of arrays"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10259308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Bxb6c7QM5II/AAAAAAAAAAI/AAAAAAAABTE/fOVILLWb9l4/photo.jpg?sz=128", "display_name": "Dmytro Kravchenko", "link": "https://stackoverflow.com/users/10259308/dmytro-kravchenko"}, "edited": false, "score": 0, "creation_date": 1545232955, "post_id": 53854195, "comment_id": 94555984, "body": "After that can I create array of interface? Right?"}, {"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "reply_to_user": {"reputation": 1, "user_id": 10259308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Bxb6c7QM5II/AAAAAAAAAAI/AAAAAAAABTE/fOVILLWb9l4/photo.jpg?sz=128", "display_name": "Dmytro Kravchenko", "link": "https://stackoverflow.com/users/10259308/dmytro-kravchenko"}, "edited": false, "score": 0, "creation_date": 1545232989, "post_id": 53854195, "comment_id": 94556007, "body": "Check the updated answer and go through the code in the link"}, {"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "reply_to_user": {"reputation": 1, "user_id": 10259308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Bxb6c7QM5II/AAAAAAAAAAI/AAAAAAAABTE/fOVILLWb9l4/photo.jpg?sz=128", "display_name": "Dmytro Kravchenko", "link": "https://stackoverflow.com/users/10259308/dmytro-kravchenko"}, "edited": false, "score": 0, "creation_date": 1545233014, "post_id": 53854195, "comment_id": 94556025, "body": "@DmytroKravchenko yes you can"}, {"owner": {"reputation": 1, "user_id": 10259308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Bxb6c7QM5II/AAAAAAAAAAI/AAAAAAAABTE/fOVILLWb9l4/photo.jpg?sz=128", "display_name": "Dmytro Kravchenko", "link": "https://stackoverflow.com/users/10259308/dmytro-kravchenko"}, "edited": false, "score": 1, "creation_date": 1545233037, "post_id": 53854195, "comment_id": 94556037, "body": "That is great answer =) Tnx."}, {"owner": {"reputation": 393, "user_id": 2664120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e396f6a7678066cf12a38350f80a3e?s=128&d=identicon&r=PG", "display_name": "Nordiii", "link": "https://stackoverflow.com/users/2664120/nordiii"}, "edited": false, "score": 1, "creation_date": 1545233319, "post_id": 53854195, "comment_id": 94556240, "body": "When you know your fields i would opt for ThunderCats solution as interface{} could add a lot of hassle"}], "tags": [], "owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1545233048, "last_edit_date": 1545233048, "creation_date": 1545232738, "answer_id": 53854195, "question_id": 53853919, "link": "https://stackoverflow.com/questions/53853919/integer-index-of-slice-as-array-of-structures/53854195#53854195", "title": "(integer) index of slice as array of structures", "body": "<p>You can use map and map it from int => interface{}.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    m := make(map[int]interface{})\n    var x []interface{}\n    x = append(x, \"username\")\n    x = append(x, []int{3, 1, 3})\n    m[1] = x\n    fmt.Println(m)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/B_dsvARic8c\" rel=\"nofollow noreferrer\">https://play.golang.org/p/B_dsvARic8c</a></p>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 393, "user_id": 2664120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e396f6a7678066cf12a38350f80a3e?s=128&d=identicon&r=PG", "display_name": "Nordiii", "link": "https://stackoverflow.com/users/2664120/nordiii"}, "edited": false, "score": 0, "creation_date": 1545233532, "post_id": 53854331, "comment_id": 94556393, "body": "Why are you using var users  []*User instead of var users []User same with []*Event. Just for my personal interest as I&#39;m learning go!"}, {"owner": {"reputation": 1, "user_id": 10259308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Bxb6c7QM5II/AAAAAAAAAAI/AAAAAAAABTE/fOVILLWb9l4/photo.jpg?sz=128", "display_name": "Dmytro Kravchenko", "link": "https://stackoverflow.com/users/10259308/dmytro-kravchenko"}, "edited": false, "score": 0, "creation_date": 1545234240, "post_id": 53854331, "comment_id": 94556884, "body": "I think he is using because of safety issue. It is a pointers."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1545234409, "post_id": 53854331, "comment_id": 94557016, "body": "It could go either way. There&#39;s insufficient information in the question to know what&#39;s best.   Given that User has a slice member,  <code>[]*User</code> is probably a better choice than <code>[]User</code>.  Write the code both ways to see why.   We know nothing about the <code>Event</code> type."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1545233380, "last_edit_date": 1545233380, "creation_date": 1545233144, "answer_id": 53854331, "question_id": 53853919, "link": "https://stackoverflow.com/questions/53853919/integer-index-of-slice-as-array-of-structures/53854331#53854331", "title": "(integer) index of slice as array of structures", "body": "<p>Declare types that match the structure of the data.  This ensures type safety and avoids the need to type assert when accessing the data.</p>\n\n<p>In this case, it looks like you need a slice of structs where on of the fields is also a slice of event structs.</p>\n\n<pre><code>type Event struct {\n    // Even fields TBD\n}\n\ntype User struct {\n    Name string\n    Events []*Event\n}\n\nvar users []*User\n\nusers = append(users, &amp;User{\n    Name: \"name1\",\n    Events: []*Event{ object1, object2, object3 },\n})\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10259308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Bxb6c7QM5II/AAAAAAAAAAI/AAAAAAAABTE/fOVILLWb9l4/photo.jpg?sz=128", "display_name": "Dmytro Kravchenko", "link": "https://stackoverflow.com/users/10259308/dmytro-kravchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53854195, "answer_count": 2, "score": -2, "last_activity_date": 1545240661, "creation_date": 1545231779, "last_edit_date": 1545240661, "question_id": 53853919, "link": "https://stackoverflow.com/questions/53853919/integer-index-of-slice-as-array-of-structures", "title": "(integer) index of slice as array of structures", "body": "<p>Is it possible in Go create array with where each element of array will  be array of slices or structures.</p>\n\n<p>Something like in PHP</p>\n\n<pre><code>    $a = [1=&gt;\"test\", 2=&gt;\"\"]\n    // in this example 2 is integer will be for GoLang?\n    $a[2] = [ object, object, object ]\n</code></pre>\n\n<p>Can I do in Go something like ? I know about incorrect syntax.</p>\n\n<pre><code>   var a [int][]StructureName\n\n   b := make([]StructureName, 0)\n   b := append ( b, StructureName{a, b, c, d})\n   b := append ( b, StructureName{e, f, g, h})\n\n   a[0] = append (a[0][0], b)\n\n`/*\n[\n1 =&gt; [\n    \u2018username1\u2019, &lt;-- string element\n    \u2018events\u2019=&gt;[ &lt;-- array of structures\n        object1, &lt;-- structure\n        object2, &lt;-- structure\n        object3 &lt;-- structure\n        ]\n    ],\n2 =&gt; [ &lt;-- next record\n    \u2018username2\u2019,\n    \u2018events\u2019=&gt;[\n        object1,\n        object2,\n        object3\n        ]\n    ]\n]\n*/\n`\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1545229801, "post_id": 53853308, "comment_id": 94554010, "body": "Does the query <code>select id, song from music where id = 1</code> against the <code>golang</code> DB in your database actually produce results?"}, {"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1545229883, "post_id": 53853308, "comment_id": 94554058, "body": "Are you sure you&#39;re running the right version of the application ? With a code producing absolutely no output it&#39;s hard to know..."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545233024, "post_id": 53853308, "comment_id": 94556034, "body": "The go code, db connection params, and db data seem to be all ok. Try to recompile the binary and run it again. Additionally also check postgres&#39; logs to see if it&#39;s receiving the query or not (you may have to first enable the logs if they&#39;re not already and then restart the server)."}, {"owner": {"reputation": 59, "user_id": 7816046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c20f236d895f6c74f046a0f6bc5624?s=128&d=identicon&r=PG&f=1", "display_name": "Lesna Vevericka", "link": "https://stackoverflow.com/users/7816046/lesna-vevericka"}, "edited": false, "score": 0, "creation_date": 1545238488, "post_id": 53853308, "comment_id": 94559505, "body": "ok, I ve got it, the problem was sql.Open strings, fianl code works like this without problem: package main     import (         &quot;database/sql&quot;         &quot;fmt&quot;         _ &quot;github.com/lib/pq&quot;         &quot;log&quot;         )     func main() { \t\t//necessary to change sql.Open strings         db, err := sql.Open(&quot;postgres&quot;, &quot;user=postgres dbname=golang port=5432 sslmode=disable&quot;)         checkErr(err)         defer db.Close() \t\tvar ( \t\t\tid int \t\t\tname string \t\t)...and so on like upper..."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 7816046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c20f236d895f6c74f046a0f6bc5624?s=128&d=identicon&r=PG&f=1", "display_name": "Lesna Vevericka", "link": "https://stackoverflow.com/users/7816046/lesna-vevericka"}, "is_accepted": false, "score": 0, "last_activity_date": 1545238710, "creation_date": 1545238710, "answer_id": 53855912, "question_id": 53853308, "link": "https://stackoverflow.com/questions/53853308/why-is-my-golang-app-returning-no-postgres-records-if-compiled-without-error-and/53855912#53855912", "title": "Why is my golang app returning no Postgres records if compiled without error and returns no errors?", "body": "<p>Solution is sql.Open string, it was broken or something, now it works this way:</p>\n\n<pre><code>package main\n    import (\n        \"database/sql\"\n        \"fmt\"\n        _ \"github.com/lib/pq\"\n        \"log\"\n        )\n    func main() {\n        //necessary to change sql.Open strings\n        db, err := sql.Open(\"postgres\", \"user=postgres dbname=golang port=5432 sslmode=disable\")\n        checkErr(err)\n        defer db.Close()\n        var (\n            id int\n            name string\n        )\n        rows, err := db.Query(\"select id, song from music where id = 1\")\n        if err != nil {\n            log.Fatal(err)\n        }\n        defer rows.Close()\n        for rows.Next() {\n            err := rows.Scan(&amp;id, &amp;name)\n            if err != nil {\n                log.Fatal(err)\n            }\n            log.Println(id, name)\n        }\n        err = rows.Err()\n        if err != nil {\n            log.Fatal(err)\n        }\n    }\n    func checkErr(err error) {\n        if err != nil {\n            fmt.Println(err)\n            panic(err)\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7816046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c20f236d895f6c74f046a0f6bc5624?s=128&d=identicon&r=PG&f=1", "display_name": "Lesna Vevericka", "link": "https://stackoverflow.com/users/7816046/lesna-vevericka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 719, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545238710, "creation_date": 1545229720, "last_edit_date": 1545231388, "question_id": 53853308, "link": "https://stackoverflow.com/questions/53853308/why-is-my-golang-app-returning-no-postgres-records-if-compiled-without-error-and", "title": "Why is my golang app returning no Postgres records if compiled without error and returns no errors?", "body": "<p>The situation looks like on this picture: <a href=\"https://pasteboard.co/HSsFIgn.png\" rel=\"nofollow noreferrer\">https://pasteboard.co/HSsFIgn.png</a> </p>\n\n<p>I have PostgreSQL portable 10.1 and golang 1.10.2 portable. I wrote simple program to fetch data from database and I got no response The code is this: I have no compilation errors, I can run dbapp.exe and I get nothing as a result, please see upper pasted pic or code lower: Thanks for any hints.</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    _ \"github.com/lib/pq\"\n    \"log\"\n)\n\nconst (\n    DB_USER     = \"postgres\"\n    DB_PASSWORD = \"\"\n    DB_NAME     = \"golang\"\n)\n\nfunc main() {\n    dbinfo := fmt.Sprintf(\"user=%s password=%s dbname=%s sslmode=disable\",\n        DB_USER, DB_PASSWORD, DB_NAME)\n    db, err := sql.Open(\"postgres\", dbinfo)\n    checkErr(err)\n    defer db.Close()\n    var (\n        id int\n        name string\n    )\n    rows, err := db.Query(\"select id, song from music where id = 1\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer rows.Close()\n    for rows.Next() {\n        err := rows.Scan(&amp;id, &amp;name)\n        if err != nil {\n            log.Fatal(err)\n        }\n        log.Println(id, name)\n    }\n    err = rows.Err()\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        fmt.Println(err)\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 20666, "user_id": 449958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69172dc4e4cc3e4cdd234c40adf395fa?s=128&d=identicon&r=PG", "display_name": "Rawkode", "link": "https://stackoverflow.com/users/449958/rawkode"}, "edited": false, "score": 1, "creation_date": 1545230581, "post_id": 53852530, "comment_id": 94554495, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32983228/kubernetes-go-client-api-for-log-of-a-particular-pod\">Kubernetes go client api for log of a particular pod</a>"}, {"owner": {"reputation": 486, "user_id": 10811259, "user_type": "registered", "profile_image": "https://graph.facebook.com/2076469725748344/picture?type=large", "display_name": "Stepan Maksimchuk", "link": "https://stackoverflow.com/users/10811259/stepan-maksimchuk"}, "reply_to_user": {"reputation": 20666, "user_id": 449958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69172dc4e4cc3e4cdd234c40adf395fa?s=128&d=identicon&r=PG", "display_name": "Rawkode", "link": "https://stackoverflow.com/users/449958/rawkode"}, "edited": false, "score": 0, "creation_date": 1545314646, "post_id": 53852530, "comment_id": 94587387, "body": "Please see update to the description. Link you provided is out of date with the current libraries."}], "answers": [{"comments": [{"owner": {"reputation": 911, "user_id": 3528539, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76bcc5c6b40213c8bbee447308334cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Asalle", "link": "https://stackoverflow.com/users/3528539/asalle"}, "edited": false, "score": 0, "creation_date": 1590763947, "post_id": 53856482, "comment_id": 109813099, "body": "either you comment is not up-to-date or you didn&#39;t word it clearly, either way it doesn&#39;t add much value to the existing answer in my opinion"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 911, "user_id": 3528539, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76bcc5c6b40213c8bbee447308334cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Asalle", "link": "https://stackoverflow.com/users/3528539/asalle"}, "edited": false, "score": 0, "creation_date": 1590796395, "post_id": 53856482, "comment_id": 109826282, "body": "<code>&#47;logs</code> is a subresource of <code>&#47;pods</code>, and there is no support for that in the controller-runtime client library at this time."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 2, "last_activity_date": 1545240763, "creation_date": 1545240763, "answer_id": 53856482, "question_id": 53852530, "link": "https://stackoverflow.com/questions/53852530/how-to-get-logs-from-kubernetes-using-golang/53856482#53856482", "title": "How to get logs from kubernetes using golang?", "body": "<p>The controller-runtime client library does not yet support subresources other than /status, so you would have to use client-go as shown in the other question.</p>\n"}, {"comments": [{"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "edited": false, "score": 0, "creation_date": 1575059115, "post_id": 53870271, "comment_id": 104452430, "body": "How do you manage when you have replicas for the same pod? they have different IP but how can you know which one corresponds to which one? I want to get my name, how do I do?"}, {"owner": {"reputation": 15920, "user_id": 1464112, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/LSU58.png?s=128&g=1", "display_name": "scniro", "link": "https://stackoverflow.com/users/1464112/scniro"}, "edited": false, "score": 1, "creation_date": 1589381343, "post_id": 53870271, "comment_id": 109272337, "body": "Anyway to specify all containers via <code>PodLogOptions</code>? Seems to want a specified container name... would be interested to find a possible <code>--all-containers</code> equivalent"}, {"owner": {"reputation": 397, "user_id": 7094610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4a244b158ec22c69975de8cc879079?s=128&d=identicon&r=PG&f=1", "display_name": "shuiqiang", "link": "https://stackoverflow.com/users/7094610/shuiqiang"}, "edited": false, "score": 0, "creation_date": 1610353920, "post_id": 53870271, "comment_id": 116095890, "body": "what is the and/or relationship in  podLogOptions?"}], "tags": [], "owner": {"reputation": 486, "user_id": 10811259, "user_type": "registered", "profile_image": "https://graph.facebook.com/2076469725748344/picture?type=large", "display_name": "Stepan Maksimchuk", "link": "https://stackoverflow.com/users/10811259/stepan-maksimchuk"}, "is_accepted": true, "score": 28, "last_activity_date": 1545314905, "creation_date": 1545314905, "answer_id": 53870271, "question_id": 53852530, "link": "https://stackoverflow.com/questions/53852530/how-to-get-logs-from-kubernetes-using-golang/53870271#53870271", "title": "How to get logs from kubernetes using golang?", "body": "<p>Here is what we came up with eventually using client-go library:</p>\n\n<pre><code>func getPodLogs(pod corev1.Pod) string {\n    podLogOpts := corev1.PodLogOptions{}\n    config, err := rest.InClusterConfig()\n    if err != nil {\n        return \"error in getting config\"\n    }\n    // creates the clientset\n    clientset, err := kubernetes.NewForConfig(config)\n    if err != nil {\n        return \"error in getting access to K8S\"\n    }\n    req := clientset.CoreV1().Pods(pod.Namespace).GetLogs(pod.Name, &amp;podLogOpts)\n    podLogs, err := req.Stream()\n    if err != nil {\n        return \"error in opening stream\"\n    }\n    defer podLogs.Close()\n\n    buf := new(bytes.Buffer)\n    _, err = io.Copy(buf, podLogs)\n    if err != nil {\n        return \"error in copy information from podLogs to buf\"\n    }\n    str := buf.String()\n\n    return str\n}\n</code></pre>\n\n<p>I hope it will help someone. Please share your thoughts or solutions of how you get logs from pods in Kubernetes.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12475723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54b52d5e20b983aefd47a3b9afddffdc?s=128&d=identicon&r=PG&f=1", "display_name": "Pawan Pinjarkar", "link": "https://stackoverflow.com/users/12475723/pawan-pinjarkar"}, "is_accepted": false, "score": -2, "last_activity_date": 1591030681, "creation_date": 1591030681, "answer_id": 62137113, "question_id": 53852530, "link": "https://stackoverflow.com/questions/53852530/how-to-get-logs-from-kubernetes-using-golang/62137113#62137113", "title": "How to get logs from kubernetes using golang?", "body": "<p>@Emixam23</p>\n\n<p>I believe you will find this snippet useful.</p>\n\n<p>How to get the dynamic name of a pod?</p>\n\n<pre><code>import  metav1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n\n    labelSelector := metav1.LabelSelector{MatchLabels: map[string]string{&lt;LABEL_KEY&gt;: &lt;LABEL_VALUE&gt;}}\n    listOptions := metav1.ListOptions{\n        LabelSelector: labels.Set(labelSelector.MatchLabels).String(),\n    }\n    pod, err := k8sClient.CoreV1().Pods(&lt;NAMESPACE&gt;).List(listOptions)\n    podName := pod.Items[0].ObjectMeta.Name\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3055, "user_id": 528629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a92d480806089eaa3bf4d135969f9e1?s=128&d=identicon&r=PG", "display_name": "Jingshao Chen", "link": "https://stackoverflow.com/users/528629/jingshao-chen"}, "edited": false, "score": 0, "creation_date": 1614547239, "post_id": 65087061, "comment_id": 117412286, "body": "Works as of today 2020-02-28"}], "tags": [], "owner": {"reputation": 189, "user_id": 8360923, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--4okdXr-KXE/AAAAAAAAAAI/AAAAAAAAAA4/vQHlnMZt4gQ/photo.jpg?sz=128", "display_name": "HelloWood", "link": "https://stackoverflow.com/users/8360923/hellowood"}, "is_accepted": false, "score": 4, "last_activity_date": 1606811516, "creation_date": 1606811516, "answer_id": 65087061, "question_id": 53852530, "link": "https://stackoverflow.com/questions/53852530/how-to-get-logs-from-kubernetes-using-golang/65087061#65087061", "title": "How to get logs from kubernetes using golang?", "body": "<p>And if you want read stream in <code>client-go v11.0.0+</code>, the code is like this, feel free for create clientset by yourself:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>func GetPodLogs(namespace string, podName string, containerName string, follow bool) error {\n    count := int64(100)\n    podLogOptions := v1.PodLogOptions{\n        Container: containerName,\n        Follow:    follow,\n        TailLines: &amp;count,\n    }\n\n    podLogRequest := clientSet.CoreV1().\n        Pods(namespace).\n        GetLogs(podName, &amp;podLogOptions)\n    stream, err := podLogRequest.Stream(context.TODO())\n    if err != nil {\n        return err\n    }\n    defer stream.Close()\n\n    for {\n        buf := make([]byte, 2000)\n        numBytes, err := stream.Read(buf)\n        if numBytes == 0 {\n            continue\n        }\n        if err == io.EOF {\n            break\n        }\n        if err != nil {\n            return err\n        }\n        message := string(buf[:numBytes])\n        fmt.Print(message)\n    }\n    return nil\n}\n\n</code></pre>\n"}], "owner": {"reputation": 486, "user_id": 10811259, "user_type": "registered", "profile_image": "https://graph.facebook.com/2076469725748344/picture?type=large", "display_name": "Stepan Maksimchuk", "link": "https://stackoverflow.com/users/10811259/stepan-maksimchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7145, "favorite_count": 5, "accepted_answer_id": 53870271, "answer_count": 4, "score": 8, "last_activity_date": 1606811516, "creation_date": 1545226977, "last_edit_date": 1545314614, "question_id": 53852530, "link": "https://stackoverflow.com/questions/53852530/how-to-get-logs-from-kubernetes-using-golang", "title": "How to get logs from kubernetes using golang?", "body": "<p>I'm looking for the solution of how to get logs from a pod in Kubernetes cluster using golang. I've looked at \"<a href=\"https://github.com/kubernetes/client-go\" rel=\"noreferrer\">https://github.com/kubernetes/client-go</a>\" and \"<a href=\"https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client\" rel=\"noreferrer\">https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client</a>\", but couldn't understand how to use them for this purpose. I have no issues getting information of a pod or any other object in K8S except for logs.</p>\n\n<p>For example, I'm using Get() from \"<a href=\"https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client#example-Client--Get\" rel=\"noreferrer\">https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client#example-Client--Get</a>\" to get K8S job info:</p>\n\n<pre><code>found := &amp;batchv1.Job{}\nerr = r.client.Get(context.TODO(), types.NamespacedName{Name: job.Name, Namespace: job.Namespace}, found)\n</code></pre>\n\n<p>Please share of how you get pod's logs nowadays.\nAny suggestions would be appreciated!</p>\n\n<p>Update:\nThe solution provided in <a href=\"https://stackoverflow.com/questions/32983228/kubernetes-go-client-api-for-log-of-a-particular-pod\">Kubernetes go client api for log of a particular pod</a> is out of date. It have some tips, but it is not up to date with current libraries.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 4, "last_activity_date": 1545216099, "creation_date": 1545216099, "answer_id": 53849494, "question_id": 53849395, "link": "https://stackoverflow.com/questions/53849395/install-golang-org-x-tools-cmd-guru-error/53849494#53849494", "title": "install golang.org/x/tools/cmd/guru error", "body": "<p>You are going to have to upgrade go. The language added a concept called aliases. The reflection package therefore has to know about them and apparently guru. You should try and stay up to date, as the Go team only supports the last two versions.</p>\n\n<p>As of today, 1.11.4 is the latest: <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">https://golang.org/dl/</a></p>\n"}], "owner": {"reputation": 17, "user_id": 7598225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tApDR.jpg?s=128&g=1", "display_name": "littletwolee", "link": "https://stackoverflow.com/users/7598225/littletwolee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 53849494, "answer_count": 1, "score": 0, "last_activity_date": 1545217189, "creation_date": 1545215829, "last_edit_date": 1545217189, "question_id": 53849395, "link": "https://stackoverflow.com/questions/53849395/install-golang-org-x-tools-cmd-guru-error", "title": "install golang.org/x/tools/cmd/guru error", "body": "<p>I have a issue of go get golang.org/x/tools/cmd/guru</p>\n\n<p>When update my go tools in vscode IDE.But golang.org/x/tools/cmd/guru package always shows the following install error</p>\n\n<p>error:</p>\n\n<h1>golang.org/x/tools/go/internal/gcimporter</h1>\n\n<p>src/golang.org/x/tools/go/internal/gcimporter/bexport.go:212: obj.IsAlias undefined (type *types.TypeName has no field or method IsAlias)</p>\n\n<p>go version is 1.8.7</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545209576, "post_id": 53847364, "comment_id": 94542671, "body": "Use a <code>return</code> statement, of course."}], "answers": [{"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 2, "last_activity_date": 1545209904, "creation_date": 1545209904, "answer_id": 53847678, "question_id": 53847364, "link": "https://stackoverflow.com/questions/53847364/how-can-i-close-a-websockethandle-when-it-has-an-error/53847678#53847678", "title": "How can I close a websockethandle when it has an error", "body": "<p>Well, <code>ctx.Abort()</code> is a function call, nothing more, nothing less. It doesn't affect the flow/scope of the function in which it's called. If you don't want to execute anything after calling <code>ctx.Abort()</code>, then just <code>return</code> to exit the function:</p>\n\n<pre><code>if err != nil {\n    log.Printf(\"some error: %+v\", err)\n    ctx.Abort()\n    return // exit function\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10422555, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lFCikulrRVU/AAAAAAAAAAI/AAAAAAAAAAs/m7jcdE-x4us/photo.jpg?sz=128", "display_name": "flythief", "link": "https://stackoverflow.com/users/10422555/flythief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53847678, "answer_count": 1, "score": 0, "last_activity_date": 1597431497, "creation_date": 1545208616, "last_edit_date": 1597431497, "question_id": 53847364, "link": "https://stackoverflow.com/questions/53847364/how-can-i-close-a-websockethandle-when-it-has-an-error", "title": "How can I close a websockethandle when it has an error", "body": "<pre><code>func WsConnectionHandle(ctx *gin.Context){\n    ws, err := upgrader.Upgrade(ctx.Writer, ctx.Request, nil)\n    if err != nil{\n        config.Error.Println(\"connect err\", err.Error())\n        //config.Error.Fatalln(\"connect err\")\n        ctx.Abort() \n    }\n    ...\n</code></pre>\n\n<p>when I use <code>ctx.Abort()</code> it still ran the code below, and if I use Fatalln, my main process will stop~</p>\n\n<p>and this is my router</p>\n\n<pre><code>gin.SetMode(gin.ReleaseMode)\nroute := gin.Default()\nresource.User(route.Group(\"/api/user\"))\nresource.KingAngAngle(route.Group(\"/api/king-and-angle\", resource.JWTAuth()))\nresource.Blessing(route.Group(\"/api/blessing\", resource.JWTAuth()))\nroute.GET(\"/ws\", chat.WsConnectionHandle)\n</code></pre>\n"}, {"tags": ["json", "list", "dictionary", "go"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 3, "creation_date": 1545204183, "post_id": 53846350, "comment_id": 94540314, "body": "Have you looked at slices and maps?"}, {"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1545204625, "post_id": 53846350, "comment_id": 94540510, "body": "Yes, I did it. So does not exist list and dict in Golang? What is the equivalent in Go?"}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 1, "creation_date": 1545205000, "post_id": 53846350, "comment_id": 94540651, "body": "<i>This is my slice, and this is my map. This is for list, and this is for dict.</i> (sorry couldn&#39;t help it). Anyhow, &quot;a list of dicts&quot; translates to &quot;a slice of maps&quot; in Go (I&#39;d also consider struct)."}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 2, "creation_date": 1545205035, "post_id": 53846350, "comment_id": 94540667, "body": "Please walk through the <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">tour of Go</a> it <a href=\"https://tour.golang.org/moretypes/15\" rel=\"nofollow noreferrer\">covers</a> the <code>append</code> part, too."}, {"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1545205254, "post_id": 53846350, "comment_id": 94540757, "body": "@bereal Thanks for the guidance, I want to create a list of dictionaries which is not static, then write it on a file. Is this possible with the slice and map?"}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 1, "creation_date": 1545205370, "post_id": 53846350, "comment_id": 94540790, "body": "Yes, it is possible. With a help from <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>json</code></a> and <a href=\"https://golang.org/pkg/io/ioutil/\" rel=\"nofollow noreferrer\"><code>ioutil</code></a>."}, {"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1545205502, "post_id": 53846350, "comment_id": 94540849, "body": "@bereal I&#39;ll check it (I&#39;ve worked with <code>ioutil</code>), Thanks."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1545210005, "post_id": 53846350, "comment_id": 94542884, "body": "@BenyaminJafari: Just an FYI, just like python has <code>.append</code>, golang has a built-in function called <code>append(target []interface{}, elements ...interface{}) []interface{}</code>. Just read through the documentation and you&#39;ll find it"}], "answers": [{"comments": [{"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545207042, "post_id": 53846458, "comment_id": 94541473, "body": "Thanks for response +1, that makes sense."}, {"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545209462, "post_id": 53846458, "comment_id": 94542612, "body": "So finally, How can I store this slice of maps (list of dicts) on a file? I tried it using this: <code>ioutil.WriteFile(&quot;config.json&quot;, data, 0644)</code> but I got this error: &#39;cannot use data (type []Dictionary) as type []byte in argument to ioutil.WriteFile &#39; How can I write this as s json file?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 1, "creation_date": 1545209892, "post_id": 53846458, "comment_id": 94542813, "body": "@BenyaminJafari please take a look at updated answer"}, {"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545210329, "post_id": 53846458, "comment_id": 94543084, "body": "I&#39;m going to accept this, with an edit about some redundant <code>Dictionary</code>- I hope you don&#39;t mind."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545210512, "post_id": 53846458, "comment_id": 94543172, "body": "@BenyaminJafari np, glad it helps :-)"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 11, "last_activity_date": 1614445666, "last_edit_date": 1614445666, "creation_date": 1545204532, "answer_id": 53846458, "question_id": 53846350, "link": "https://stackoverflow.com/questions/53846350/how-to-create-a-list-of-the-dictionaries-in-golang/53846458#53846458", "title": "How to create a list of the dictionaries in Golang?", "body": "<p>If you need the data to be stored in a slice of dictionary/key-value-based format, then using the combination of slice and <code>map[string]interface{}</code> is enough.</p>\n<p>In this example below, I created a new type called <code>Dictionary</code>, to avoid writing too many <code>map[string]interface{}</code> syntax on composite literals.</p>\n<pre><code>type Dictionary map[string]interface{}\n\ndata := []Dictionary{\n    {\n        &quot;metrics&quot;: []Dictionary{\n            { &quot;tag_name&quot;: &quot;output_current&quot;, &quot;id&quot;: 3 },\n            { &quot;tag_name&quot;: &quot;input_voltage&quot;, &quot;id&quot;: 2 },\n        },\n        &quot;port&quot;:       161,\n        &quot;timeout&quot;:    1,\n        &quot;sleep_time&quot;: 5,\n    },\n    {\n        &quot;metrics&quot;: []Dictionary{\n            { &quot;tag_name&quot;: &quot;destructor&quot;, &quot;id&quot;: 10 },\n        },\n        &quot;port&quot;:       161,\n        &quot;timeout&quot;:    1,\n        &quot;sleep_time&quot;: 4,\n    },\n}\n</code></pre>\n<hr />\n<p>However if your data structure is fixed, then I suggest to use a struct instead <code>map</code>. Below is an another example as above, using same dataset but leveraging struct instead of <code>map</code>:</p>\n<pre><code>type Metric struct {\n    TagName string `json:&quot;tag_name&quot;`\n    ID      int    `json:&quot;id&quot;`\n}\n\ntype Data struct {\n    Port      int      `json:&quot;port&quot;`\n    Timeout   int      `json:&quot;timeout&quot;`\n    SleepTime int      `json:&quot;sleep_time&quot;`\n    Metrics   []Metric `json:&quot;metrics&quot;`\n}\n\ndata := []Data{\n    Data{\n        Port:      161,\n        Timeout:   1,\n        SleepTime: 5,\n        Metrics: []Metric{\n            Metric{TagName: &quot;output_current&quot;, ID: 3},\n            Metric{TagName: &quot;input_voltage&quot;, ID: 2},\n        },\n    },\n    Data{\n        Port:      161,\n        Timeout:   1,\n        SleepTime: 4,\n        Metrics: []Metric{\n            Metric{TagName: &quot;destructor&quot;, ID: 10},\n        },\n    },\n}\n</code></pre>\n<hr />\n<h3>Update 1</h3>\n<p>To be able to write the <code>data</code> in JSON file, the particular <code>data</code> needs to be converted into JSON string first. Use <code>json.Marshal()</code> to do the conversion from <code>map</code> data (or struct object data) into JSON string format (in <code>[]byte</code> type).</p>\n<pre><code>buf, err := json.Marshal(data)\nif err !=nil {\n    panic(err)\n}\n\nerr = ioutil.WriteFile(&quot;fileame.json&quot;, buf, 0644)\nif err !=nil {\n    panic(err)\n}\n</code></pre>\n<p>Then use <code>ioutil.WriteFile()</code> to write it into file.</p>\n<hr />\n<p>If you somehow need to print the JSON data as a string, then cast the <code>buf</code> into <code>string</code> type.</p>\n<pre><code>jsonString := string(buf)\nfmt.Println(jsonString)\n</code></pre>\n<p>Statements above will generate output below:</p>\n<pre><code>[{&quot;port&quot;:161,&quot;timeout&quot;:1,&quot;sleep_time&quot;:5,&quot;metrics&quot;:[{&quot;tag_name&quot;:&quot;output_current&quot;,&quot;id&quot;:&quot;3&quot;},{&quot;tag_name&quot;:&quot;input_voltage&quot;,&quot;id&quot;:&quot;2&quot;}]},{&quot;port&quot;:161,&quot;timeout&quot;:1,&quot;sleep_time&quot;:4,&quot;metrics&quot;:[{&quot;tag_name&quot;:&quot;destructor&quot;,&quot;id&quot;:&quot;10&quot;}]}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545206601, "post_id": 53846518, "comment_id": 94541307, "body": "Thanks for the response. But I got this error: <code>cannot use map[string]int literal (type map[string]int) as type map[string][]string in assignment </code> in your simple example of <code>map</code>."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545206673, "post_id": 53846518, "comment_id": 94541330, "body": "Change <code>map[string]int</code> to <code>map[string][]string</code>"}, {"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545206717, "post_id": 53846518, "comment_id": 94541344, "body": "What&#39;s mean of <code>interface</code>? Is it that means any type?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 2, "creation_date": 1545206766, "post_id": 53846518, "comment_id": 94541361, "body": "An empty interface does (e.g., <code>interface{}</code>). Take a look at <a href=\"https://tour.golang.org/methods/14\" rel=\"nofollow noreferrer\">tour.golang.org/methods/14</a>"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 5, "last_activity_date": 1545204814, "creation_date": 1545204814, "answer_id": 53846518, "question_id": 53846350, "link": "https://stackoverflow.com/questions/53846350/how-to-create-a-list-of-the-dictionaries-in-golang/53846518#53846518", "title": "How to create a list of the dictionaries in Golang?", "body": "<p>So the types you are looking for are:</p>\n\n<pre><code>dict =&gt; map\nlist =&gt; slice\n</code></pre>\n\n<p>A simple example of a map looks like:</p>\n\n<pre><code>m:=map[string]int{\n  \"a\": 1,\n  \"b\": 2,\n}\n</code></pre>\n\n<p>A simple example of a slice looks like:</p>\n\n<pre><code>var s []int\ns = append(s, 1)\ns = append(s, 2, 3)\n</code></pre>\n\n<p>So to put that together for your type:</p>\n\n<pre><code>[]map[string]interface{}{\n    {\n        \"port\":       161,\n        \"timeout\":    1,\n        \"sleep_time\": 5,\n        \"metrics\": []map[string]interface{}{\n            {\"tag_name\": \"output_current\", \"id\": \"3\"},\n            {\"tag_name\": \"input_voltage\", \"id\": \"2\"},\n        },\n    },\n    {\n        \"port\":       161,\n        \"timeout\":    1,\n        \"sleep_time\": 4,\n        \"metrics\": []map[string]interface{}{\n            {\"tag_name\": \"destructor\", \"id\": \"10\"},\n        },\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3875, "favorite_count": 1, "accepted_answer_id": 53846458, "answer_count": 2, "score": 4, "last_activity_date": 1614445666, "creation_date": 1545204030, "last_edit_date": 1582024632, "question_id": 53846350, "link": "https://stackoverflow.com/questions/53846350/how-to-create-a-list-of-the-dictionaries-in-golang", "title": "How to create a list of the dictionaries in Golang?", "body": "<p>I'm a newbie in Golang.</p>\n\n<p>I'm going to create a list of dictionaries which is resizable (this is not static) with append some <code>dict</code> to the <code>list</code> next write it on a file, but I was confused.</p>\n\n<p>I want something like this:</p>\n\n<pre><code>[\n {\"port\": 161, \"timeout\": 1, \"sleep_time\": 5, \"metrics\": [\n  {\"tag_name\": \"output_current\", \"id\": 3},\n  {\"tag_name\": \"input_voltage\", \"id\": 2}\n ]},\n {\"port\": 161, \"timeout\": 1, \"sleep_time\": 4, \"metrics\": [\n   {\"tag_name\": \"destructor\", \"id\": 10}\n ]}\n]\n</code></pre>\n\n<hr>\n\n<p>[UPDATE]:</p>\n\n<p>What is the <code>.append()</code> Python equivalent in Go language something like that?</p>\n\n<pre><code>list_ = []\ndict_ = {\"key\": val}\nlist_.append(dict_)\n</code></pre>\n\n<p>I've found the answer to this section ([UPDATE]) by borrowing <a href=\"https://stackoverflow.com/a/53846458/3702377\">this answer</a>:</p>\n\n<pre><code>type Dictionary map[string]interface{}\ndata := []Dictionary{}\ndict1 := Dictionary{\"key\": 1}\ndict2 := Dictionary{\"key\": 2}\ndata = append(data, dict1, dict2)\n</code></pre>\n"}, {"tags": ["go", "mux"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 6, "creation_date": 1545202758, "post_id": 53846042, "comment_id": 94539691, "body": "While you are waiting for an answer you could debug through it."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545204175, "post_id": 53846042, "comment_id": 94540309, "body": "Your main is missing the ListenAndServe part, you first need to hit the router with some requests to see those logs and without a server that isn&#39;t gonna happen. Middleware registered with the Use method is applied by the router when a request comes in and a matching handler is found (<a href=\"https://github.com/gorilla/mux/blob/6137e193cdcba2725f16de84eaf0db2b769d9668/mux.go#L144\" rel=\"nofollow noreferrer\">github.com/gorilla/mux/blob/&hellip;</a>)."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1545205391, "post_id": 53846042, "comment_id": 94540796, "body": "the server is listening, the routes/handlers respond to requests, but the middleware does appear to be invoked"}, {"owner": {"reputation": 3913, "user_id": 3710800, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b06275b7ae4d1d759875b312db2102f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Barr&#233;", "link": "https://stackoverflow.com/users/3710800/guillaume-barr%c3%a9"}, "edited": false, "score": 0, "creation_date": 1545208431, "post_id": 53846042, "comment_id": 94542114, "body": "I Just tested using your code as base (well except the routes and the ... ) and it works, middlewares are invoked."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 3913, "user_id": 3710800, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b06275b7ae4d1d759875b312db2102f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Barr&#233;", "link": "https://stackoverflow.com/users/3710800/guillaume-barr%c3%a9"}, "edited": false, "score": 0, "creation_date": 1545209487, "post_id": 53846042, "comment_id": 94542626, "body": "@Nirekin thanks, I just updated the OP to answer your question"}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 3913, "user_id": 3710800, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b06275b7ae4d1d759875b312db2102f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Barr&#233;", "link": "https://stackoverflow.com/users/3710800/guillaume-barr%c3%a9"}, "edited": false, "score": 0, "creation_date": 1545209843, "post_id": 53846042, "comment_id": 94542783, "body": "@Nirekin yeah I mean this is just bizarre, I have no idea what&#39;s going wrong here"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545210595, "post_id": 53846042, "comment_id": 94543222, "body": "@AlexanderMills i believe this has to do with the subrouters and it&#39;s an unresolved bug (at least i couldn&#39;t find anything suggesting a fix) referenced in multiple issues on the project&#39;s github repo."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545210984, "post_id": 53846042, "comment_id": 94543404, "body": "@AlexanderMills If you try something like this: <a href=\"https://play.golang.com/p/smPiyqFA1dh\" rel=\"nofollow noreferrer\">play.golang.com/p/smPiyqFA1dh</a> and as long as your <code>Mount</code> methods don&#39;t invoke new subrouters you should be fine."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545211750, "post_id": 53846042, "comment_id": 94543825, "body": "@mkopriva yeah I am not sure - even this part <code>routerParent := mux.NewRouter() \trouterParent.Use(loggingMiddleware) \trouterParent.Use(errorMiddleware) \trouterParent.Use(authMiddleware)</code> doesn&#39;t invoke the middleware? That doesn&#39;t seem to be a subRouter problem."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1545211820, "post_id": 53846042, "comment_id": 94543877, "body": "Is there an alternative way to register the middleware? I might have to give up on this methodology. Basically, I want the authMiddleware registered for all but a handful of routes. That&#39;s the goal."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 0, "creation_date": 1545212240, "post_id": 53846042, "comment_id": 94544158, "body": "I don&#39;t have experience with gorilla mux, however I have tried valyala/fasthttp and gin-gonic/gin . They both provide speedy and functional frameworks for HTTP"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545212524, "post_id": 53846042, "comment_id": 94544326, "body": "@AlexanderMills Well the middleware just wraps the passed in handler and returns a new handler, so depending on what you&#39;re doing in <code>Mount</code> you could be able to workaround this problem by applying the middleware to each handler during mount before passing it the router."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545213151, "post_id": 53846042, "comment_id": 94544713, "body": "@AlexanderMills if you haven&#39;t already try updating gorilla/mux as well, they&#39;ve made some changes to how subrouters are handled <a href=\"https://github.com/gorilla/mux/commit/758eb64354aa27cda6c1b026822c788cc755f06f\" rel=\"nofollow noreferrer\">recently</a> and from your <a href=\"https://github.com/gorilla/mux/issues/429\" rel=\"nofollow noreferrer\">issue</a> i can see that your version is one commit older. Although I still don&#39;t think that that bug has been fixed it might be worth giving it a try."}, {"owner": {"reputation": 597, "user_id": 1712332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/162801338a7b2e4066d6aa8e45e4c404?s=128&d=identicon&r=PG", "display_name": "Eksapsy", "link": "https://stackoverflow.com/users/1712332/eksapsy"}, "edited": false, "score": 0, "creation_date": 1596329664, "post_id": 53846042, "comment_id": 111777179, "body": "I dont think Stackoverflow is the right place to post such questions. Github issues is where you&#39;ll find annswers and the contributors, the programmers of the package itself who deal with bugs like these all the time, will always directly respond to you there. Avoid stackoverflow for package/module related too specific questions"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1167, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1545212083, "creation_date": 1545202578, "last_edit_date": 1545212083, "question_id": 53846042, "link": "https://stackoverflow.com/questions/53846042/gorilla-mux-middleware-not-being-hit", "title": "Gorilla/mux middleware not being hit", "body": "<p>I am on <code>go version go1.10.4 linux/amd64</code></p>\n\n<p>I am registering middleware, but they don't seem to be hit.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"github.com/dgrijalva/jwt-go\"\n    \"github.com/gorilla/context\"\n    \"github.com/mitchellh/mapstructure\"\n    \"huru/migrations\"\n    \"huru/models\"\n    \"huru/models/person\"\n    \"huru/routes\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/gorilla/mux\"\n    _ \"github.com/lib/pq\"\n    log \"github.com/sirupsen/logrus\"\n)\n\nfunc loggingMiddleware(next http.Handler) http.Handler {\n\n    log.Println(\"logging middleware registered\");\n\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // Do stuff here\n        log.Println(\"Here is the request URI:\",r.RequestURI)\n        // Call the next handler, which can be another middleware in the chain, or the final handler.\n        next.ServeHTTP(w, r)\n    })\n}\n\ntype Exception struct {\n    Message string `json:\"message\"`\n}\n\nfunc authMiddleware(next http.Handler) http.Handler {\n\n    log.Println(\"auth middleware registered\");\n\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n\n        params := r.URL.Query()\n        fmt.Println(\"the params are:\", params);\n\n        token, _ := jwt.Parse(params[\"token\"][0], func(token *jwt.Token) (interface{}, error) {\n            if _, ok := token.Method.(*jwt.SigningMethodHMAC); !ok {\n                return nil, fmt.Errorf(\"there was an error\")\n            }\n            return []byte(\"secret\"), nil\n        })\n        claims, ok := token.Claims.(jwt.MapClaims)\n\n        if ! (ok &amp;&amp; token.Valid) {\n            json.NewEncoder(w).Encode(Exception{Message: \"Invalid authorization token\"})\n            return;\n        }\n\n        var user person.Model\n        mapstructure.Decode(claims, &amp;user)\n        context.Set(r, \"logged_in_user\", user)\n        next.ServeHTTP(w, r)\n    })\n}\n\nfunc errorMiddleware(next http.Handler) http.Handler {\n\n    log.Println(\"error handling middleware registered\");\n\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        defer func() {\n            if err := recover(); err != nil {\n\n                log.Error(\"Caught error in defer/recover middleware: \", err)\n                originalError := err.(struct{ OriginalError error }).OriginalError\n\n                if originalError != nil {\n                    log.Error(\"Original error in defer/recover middleware: \", originalError)\n                }\n\n                statusCode := err.(struct{ StatusCode int }).StatusCode\n\n                if statusCode != 0 {\n                    w.WriteHeader(statusCode)\n                } else {\n                    w.WriteHeader(http.StatusInternalServerError)\n                }\n\n                message := err.(struct{ Message string }).Message\n\n                if message == \"\" {\n                    message = \"Unknown error message.\"\n                }\n\n                json.NewEncoder(w).Encode(struct {\n                    ID string\n                }{\n                    message,\n                })\n            }\n        }()\n        next.ServeHTTP(w, r)\n    })\n}\n\nfunc main() {\n\n    routerParent := mux.NewRouter()\n    routerParent.Use(loggingMiddleware)\n    routerParent.Use(errorMiddleware)\n    routerParent.Use(authMiddleware)\n\n    router := routerParent.PathPrefix(\"/api/v1\").Subrouter();\n    router.Use(loggingMiddleware)\n    router.Use(errorMiddleware)\n    router.Use(authMiddleware)\n\n\n    // register and login\n    {\n        handler := routes.LoginHandler{}\n        subRouter := router.PathPrefix(\"/\").Subrouter()\n        handler.Mount(subRouter, struct{}{});\n    }\n\n    {\n\n        handler := routes.RegisterHandler{}\n        subRouter := router.PathPrefix(\"/\").Subrouter()\n        handler.Mount(subRouter, struct{}{})\n    }\n\n    {\n        // people\n        handler := routes.PersonHandler{}\n        subRouter := router.PathPrefix(\"/\").Subrouter()\n        subRouter.Use(authMiddleware)\n        handler.Mount(subRouter, routes.PersonInjection{People: models.PersonInit()})\n    }\n\n     // ...\n}\n</code></pre>\n\n<p>none of these get logged:</p>\n\n<pre><code>log.Println(\"error handling middleware registered\");\nlog.Println(\"auth middleware registered\");\nlog.Println(\"logging middleware registered\");\n</code></pre>\n\n<p>and at runtime none of middleware routes seem to get hit, nothing is logged there. Anyone know why that may be? </p>\n\n<p>Note that I don't expect to need all these:</p>\n\n<pre><code>    routerParent := mux.NewRouter()\n    routerParent.Use(loggingMiddleware)\n    routerParent.Use(errorMiddleware)\n    routerParent.Use(authMiddleware)\n\n    router := routerParent.PathPrefix(\"/api/v1\").Subrouter();\n    router.Use(loggingMiddleware)\n    router.Use(errorMiddleware)\n    router.Use(authMiddleware)\n</code></pre>\n\n<p>in reality I probably just want:</p>\n\n<pre><code>    routerParent := mux.NewRouter()\n    router := routerParent.PathPrefix(\"/api/v1\").Subrouter();\n    router.Use(loggingMiddleware)\n    router.Use(errorMiddleware)\n    router.Use(authMiddleware)\n</code></pre>\n\n<p>but it's just there to prove that something is off.  At the end of the main func, I have this to start the server:</p>\n\n<pre><code>host := os.Getenv(\"huru_api_host\")\nport := os.Getenv(\"huru_api_port\")\n\nif host == \"\" {\n    host = \"localhost\"\n}\n\nif port == \"\" {\n    port = \"80\"\n}\n\nlog.Info(fmt.Sprintf(\"Huru API server listening on port %s\", port))\npath := fmt.Sprintf(\"%s:%s\", host, port)\nlog.Fatal(http.ListenAndServe(path, routerParent))\n</code></pre>\n"}, {"tags": ["pointers", "go", "interface"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 7, "creation_date": 1545202580, "post_id": 53845785, "comment_id": 94539595, "body": "You defined the grow method on a pointer type, ie <code>*plant1</code> not <code>plant1</code>. When <code>p</code> is the plant interface and you do a type switch on it the switch cases can contain only types that satisfy that interface, ie <code>*plant1</code> not <code>plant1</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1545202696, "post_id": 53845785, "comment_id": 94539657, "body": "<a href=\"https://play.golang.org/p/r8Bo92OhMCd\" rel=\"nofollow noreferrer\">play.golang.org/p/r8Bo92OhMCd</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1545202963, "post_id": 53845785, "comment_id": 94539777, "body": "Note that, when doing a type switch, if you store the type asserted value in a variable then inside the block scope of each case the variable will have the type of that case. And therefore you do not have to do type assertion again inside the cases. ie <a href=\"https://play.golang.org/p/gkSRe9n264w\" rel=\"nofollow noreferrer\">play.golang.org/p/gkSRe9n264w</a>"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1545206430, "post_id": 53845785, "comment_id": 94541235, "body": "Aside: you should generally not mix pointer and non-pointer receivers in methods for a particular type. Choose one and use that for all methods to avoid confusion. <a href=\"https://golang.org/doc/faq#methods_on_values_or_pointers\" rel=\"nofollow noreferrer\">golang.org/doc/faq#methods_on_values_or_pointers</a>. Here, <code>getHeight</code> should have a pointer receiver."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545229474, "post_id": 53845785, "comment_id": 94553825, "body": "Also note that it&#39;s considered bad practice in Go to name method receivers with generic names like &quot;self&quot; or &quot;this&quot;. Read any Go code in the standard library, the community, or the <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">Tour of Go</a> for examples on idiomatic Go code."}], "answers": [{"tags": [], "owner": {"reputation": 425, "user_id": 533411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3cb581d010930a77b3e26b30979849c6?s=128&d=identicon&r=PG", "display_name": "Sergej Zagursky", "link": "https://stackoverflow.com/users/533411/sergej-zagursky"}, "is_accepted": false, "score": 2, "last_activity_date": 1545206256, "creation_date": 1545206256, "answer_id": 53846817, "question_id": 53845785, "link": "https://stackoverflow.com/questions/53845785/pointers-interfaces-in-go/53846817#53846817", "title": "Pointers &amp; Interfaces in Go", "body": "<p>The value you wrap into interface isn't addressable. The value have to be addressable to call methods on pointer receivers. The <code>grow</code> methods are declared with pointer receiver. So the compiler sees that <code>plant</code> interface is being implemented neither by <code>plant1</code> type nor by <code>plant2</code> type. Thus you can't pass <code>plant1</code> or <code>plant2</code> as <code>plant</code> to <code>showHeight</code> func. And the switch is impossible because implementations of <code>plant</code> interface don't include <code>plant1</code> and <code>plant2</code> types.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/48790663/why-value-stored-in-an-interface-is-not-addressable-in-golang/48874650#48874650\">Why value stored in an interface is not addressable in Golang</a></p>\n"}, {"tags": [], "owner": {"reputation": 160, "user_id": 10562862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e008e66b85602b28959d0b91339f8b2a?s=128&d=identicon&r=PG&f=1", "display_name": "topenion", "link": "https://stackoverflow.com/users/10562862/topenion"}, "is_accepted": false, "score": 0, "last_activity_date": 1545217696, "last_edit_date": 1545217696, "creation_date": 1545216342, "answer_id": 53849551, "question_id": 53845785, "link": "https://stackoverflow.com/questions/53845785/pointers-interfaces-in-go/53849551#53849551", "title": "Pointers &amp; Interfaces in Go", "body": "<p>Your Function <code>func showHeight(p plant)</code> accepts an interface as parameter, and an interface only accepts the types you implement.</p>\n\n<p>Case commented <code>//grow()</code> </p>\n\n<p>Since you have commented <code>grow()</code> <code>plant</code> has only one method <code>getHeight()</code> which you have implemented for <code>plant 1</code> and <code>plant 2</code> and it all goes smooth.</p>\n\n<p>Case uncommented <code>grow()</code></p>\n\n<p>Now none of your types(plant1 or plant 2) implement <code>plant</code> interface because <code>grow()</code> has been defined on <code>*plant1</code> and <code>*plant2</code> not on <code>plant1</code> and <code>plant2</code>. Result; Your function <code>showHeight(p plant)</code> which accepts interface type plant, cant accept <code>pl</code>,<code>p2</code> because these are not of type <code>plant</code> anymore.</p>\n\n<p>Fix : </p>\n\n<p>Pass pointers to function as <code>showHeight(&amp;p1)</code> and <code>showHeight(&amp;p2)</code> and in function definition's cases and print statements, replace <code>plant1</code> and <code>plant2</code> with <code>*plant1</code> and <code>*plant2</code></p>\n\n<p>Confusion which can follow is , <code>getHeight</code> has not been implemented on <code>*plant1</code> and <code>*plant2</code>, why do <code>*plant1</code> and <code>*plant2</code> are of type <code>plant</code>?\nLogic: When you pass pointers, values can be derived from these so as to call <code>getHeight</code>, but when you pass values, no address can be derived to call <code>grow()</code></p>\n\n<p>SIDENOTE: <code>p.(*plant2).getHeight()</code> can be changed to <code>p.getHeight()</code> as p is interface and it can call its own methods.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 6572092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mcj0V.jpg?s=128&g=1", "display_name": "Kayslay", "link": "https://stackoverflow.com/users/6572092/kayslay"}, "is_accepted": false, "score": 0, "last_activity_date": 1545218911, "creation_date": 1545218911, "answer_id": 53850283, "question_id": 53845785, "link": "https://stackoverflow.com/questions/53845785/pointers-interfaces-in-go/53850283#53850283", "title": "Pointers &amp; Interfaces in Go", "body": "<p>This due to the way the Method Set in Go works. In Go, a Method on a concrete receiver type implements both the value type and pointer type, while a method on a pointer receiver type implements only the pointer value.</p>\n\n<p>In the case of the <code>grow</code> method, the pointer receiver type <code>*plant1/*plant2</code> are used, so only a pointer value of those types can implement the <code>grow</code> method on an interface and the concrete value type can't.</p>\n\n<p>Since the receiver type on <code>getHeight</code> method is a concrete receiver type, it implements both the pointer type value (<code>*plant1/*plant2</code>) and the type value of both <code>plant</code> &amp; <code>plant2</code>.</p>\n\n<p>If you change the parameter(p) passed to <code>showHeight</code> to a <code>*plant1/*plant2</code> type and change the type assertion to expect <code>*plant1/*plant2</code> this would solve the error.</p>\n\n<p>check this code example <a href=\"https://play.golang.org/p/r8Bo92OhMCd\" rel=\"nofollow noreferrer\">playground link</a></p>\n"}], "owner": {"reputation": 57, "user_id": 10085780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w12l0.jpg?s=128&g=1", "display_name": "jellycat", "link": "https://stackoverflow.com/users/10085780/jellycat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1545218911, "creation_date": 1545201355, "question_id": 53845785, "link": "https://stackoverflow.com/questions/53845785/pointers-interfaces-in-go", "title": "Pointers &amp; Interfaces in Go", "body": "<p>I'm trying to understand what I'm doing wrong here.. all responses appreciated  :)</p>\n\n<p>If uncomment \"// grow()\" works,</p>\n\n<p>else errors:</p>\n\n<blockquote>\n  <p>prog.go:38:2: impossible type switch case: p (type plant) cannot have\n  dynamic type plant1 (grow method has pointer receiver) prog.go:39:16:\n  impossible type assertion:    plant1 does not implement plant (grow\n  method has pointer receiver) prog.go:40:2: impossible type switch\n  case: p (type plant) cannot have dynamic type plant2 (grow method has\n  pointer receiver) prog.go:41:16: impossible type assertion:   plant2\n  does not implement plant (grow method has pointer receiver)\n  prog.go:60:12: cannot use p1 (type plant1) as type plant in argument\n  to showHeight:    plant1 does not implement plant (grow method has\n  pointer receiver) prog.go:61:12: cannot use p2 (type plant2) as type\n  plant in argument to showHeight:  plant2 does not implement plant\n  (grow method has pointer receiver)</p>\n</blockquote>\n\n<p><a href=\"https://play.golang.org/p/oMv7LdW85yK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/oMv7LdW85yK</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype plant1 struct {\n    name   string\n    height int\n}\n\ntype plant2 struct {\n    species string\n    height  int\n}\n\nfunc (self *plant1) grow() {\n    self.height++\n}\nfunc (self *plant2) grow() {\n    self.height++\n}\n\nfunc (self plant1) getHeight() int {\n    return self.height\n}\nfunc (self plant2) getHeight() int {\n    return self.height\n}\n\ntype plant interface {\n    getHeight() int\n    //grow()\n}\n\nfunc showHeight(p plant) {\n    switch p.(type) {\n    case plant1:\n        fmt.Println(p.(plant1).name, `Height = `, p.(plant1).getHeight())\n    case plant2:\n        fmt.Println(p.(plant2).species, `Height = `, p.(plant2).getHeight())\n    }\n\n}\n\nfunc main() {\n\n    p1 := plant1{\n        name:   `Plant 10`,\n        height: 1,\n    }\n    p2 := plant2{\n        species:   `Plant 20`,\n        height: 1,\n    }\n    p1.grow()\n    p1.grow()\n    p2.grow()   \n\n    showHeight(p1)\n    showHeight(p2)\n}\n</code></pre>\n"}, {"tags": ["go", "apache-kafka", "kafka-consumer-api"], "comments": [{"owner": {"reputation": 306, "user_id": 5038981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5ed6bd5a546b457d55dfb4dc5b4144?s=128&d=identicon&r=PG&f=1", "display_name": "Sammy", "link": "https://stackoverflow.com/users/5038981/sammy"}, "edited": false, "score": 0, "creation_date": 1545214864, "post_id": 53845570, "comment_id": 94545744, "body": "Are you able to consume with the console consumer?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 12019346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCQhihy2In1IYWhj0cwpC0SGVJaWW04Ca95KI86QQ=k-s128", "display_name": "Ilia Bunin", "link": "https://stackoverflow.com/users/12019346/ilia-bunin"}, "is_accepted": false, "score": 2, "last_activity_date": 1567594566, "creation_date": 1567594566, "answer_id": 57786941, "question_id": 53845570, "link": "https://stackoverflow.com/questions/53845570/golang-segmentio-kafka-go-consumer-not-working/57786941#57786941", "title": "Golang segmentio/kafka-go consumer not working", "body": "<p>Just a guess:\ntry adding an import to load compression codecs, in case your topics use compression.</p>\n\n<p>import _ \"github.com/segmentio/kafka-go/snappy\"</p>\n"}], "owner": {"reputation": 2338, "user_id": 1213885, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1e39a4c25252ea2ccc058a0c8a5176f4?s=128&d=identicon&r=PG", "display_name": "Shashwat", "link": "https://stackoverflow.com/users/1213885/shashwat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567594566, "creation_date": 1545200351, "last_edit_date": 1545225566, "question_id": 53845570, "link": "https://stackoverflow.com/questions/53845570/golang-segmentio-kafka-go-consumer-not-working", "title": "Golang segmentio/kafka-go consumer not working", "body": "<p>I am using <a href=\"https://github.com/segmentio/kafka-go\" rel=\"nofollow noreferrer\">segmentio/kafka-go</a> to connect to Kafka. </p>\n\n<pre><code>// to produce messages\ntopic := \"my-topic\"\npartition := 0\n\nconn, _ := kafka.DialLeader(context.Background(), \"tcp\", \"localhost:9092\", topic, partition)\n\nconn.SetWriteDeadline(time.Now().Add(10*time.Second))\nconn.WriteMessages(\n    kafka.Message{Value: []byte(\"one!\")},\n    kafka.Message{Value: []byte(\"two!\")},\n    kafka.Message{Value: []byte(\"three!\")},\n)\n\nconn.Close()\n</code></pre>\n\n<p>I am able to produce into my Kafka server using this code.</p>\n\n<pre><code>// to consume messages\ntopic := \"my-topic\"\npartition := 0\n\nconn, _ := kafka.DialLeader(context.Background(), \"tcp\", \"localhost:9092\", topic, partition)\n\nconn.SetReadDeadline(time.Now().Add(10*time.Second))\nbatch := conn.ReadBatch(10e3, 1e6) // fetch 10KB min, 1MB max\n\nb := make([]byte, 10e3) // 10KB max per message\nfor {\n    _, err := batch.Read(b)\n    if err != nil {\n        // err -&gt; \"invalid codec\"\n        break\n    }\n    fmt.Println(string(b))\n}\n\nbatch.Close()\nconn.Close()\n</code></pre>\n\n<p>But I am unable to consume using the above code. I am getting the error <code>invalid codec</code>. What can be the reason?</p>\n\n<p>In case relevant, I tweaked the minimum batch size to 1 so that it tries to consume something.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1114, "user_id": 8190553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6OTwb.png?s=128&g=1", "display_name": "will7200", "link": "https://stackoverflow.com/users/8190553/will7200"}, "edited": false, "score": 7, "creation_date": 1587660003, "post_id": 53844996, "comment_id": 108605134, "body": "Fixed in release 1.14.2"}, {"owner": {"reputation": 3600, "user_id": 4002, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/970e3daa6f32f6a6fd7c5ce2fec9618d?s=128&d=identicon&r=PG", "display_name": "Dave Arkell", "link": "https://stackoverflow.com/users/4002/dave-arkell"}, "edited": false, "score": 1, "creation_date": 1614244418, "post_id": 53844996, "comment_id": 117328212, "body": "I\u2019m voting to close this question because the issue was with a bug in Go, which has now been fixed (the comment says in Go 1.14.2, but it might have been before then)."}], "owner": {"reputation": 1466, "user_id": 1481095, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/808a320cf9544cf785ffa16195c1a101?s=128&d=identicon&r=PG", "display_name": "Rix", "link": "https://stackoverflow.com/users/1481095/rix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 2, "answer_count": 0, "score": 20, "last_activity_date": 1545208530, "creation_date": 1545196676, "last_edit_date": 1545208530, "question_id": 53844996, "link": "https://stackoverflow.com/questions/53844996/windows-native-callback-only-returns-32-bit-result-on-64-bit-platform", "title": "Windows native callback only returns 32 bit result on 64 bit platform", "body": "<p>I'm calling a DLL function, that takes a callback function, where the callback function returns a pointer to some data structure, and the DLL will perform some action on the data structure.</p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/sys/windows\"\n    \"unsafe\"\n)\n\ntype A struct {}\nvar a = &amp;A{}\n\nfunc Callback() uintptr {\n    ptr := uintptr(unsafe.Pointer(a))\n    fmt.Printf(\"Address: 0x%X\\n\", ptr)\n    return ptr\n}\n\nfunc main() {\n    dll := windows.MustLoadDLL(\"some.dll\")\n    init := dll.MustFindProc(\"init\")\n    init.Call(windows.NewCallback(Callback))\n    fmt.Printf(\"This never get prints\\n\")\n}\n</code></pre>\n\n<p>I'm running go on Windows 64-bit machine, the DLL is also 64-bit.</p>\n\n<pre><code>$ go version\ngo version go1.11.4 windows/amd64\n</code></pre>\n\n<p>The above code will print the address of the pointer, which is <code>0xC000080018</code>, but the call to the DLL will fail silently. I don't have the source code to the DLL so I can't make it print the value it gets. So I used IDA pro to dynamically debug the program, and I found that the Go callback function is actually returning 32-bit value instead of 64-bit value. This is the final code of the Go callback routine before it returns back to the DLL:</p>\n\n<pre><code>main.exe:00000000004537E7     mov     eax, [rcx+rdx-8]\nmain.exe:00000000004537EB     pop     qword ptr [rcx+rdx-8]\nmain.exe:00000000004537EF     retn\n</code></pre>\n\n<p>As you can see Go is writing the return value in <code>eax</code> instead of <code>rax</code>, which will discard the higher address, therefore the DLL will only get <code>0x80018</code> and caused errors.</p>\n\n<p>Although I know what's wrong with it, I can't figure out how to fix it.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I've done some digging into Go's implementation of the callback, and found the assembly code at <a href=\"https://github.com/golang/go/blob/master/src/runtime/sys_windows_amd64.s#L354\" rel=\"noreferrer\"><code>src/runtime/sys_windows_amd64.s</code></a>. I noticed that in <code>runtime\u00b7callbackasm1</code>, the return value is set using <code>MOVL</code> instead of <code>MOVQ</code>. So I changed it to <code>MOVQ</code> and everything worked.</p>\n\n<p>I'm not sure if it's a bug or actually intended, so I will <a href=\"https://github.com/golang/go/issues/29331\" rel=\"noreferrer\">open an issue on GitHub</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1083, "user_id": 5584140, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/B8T3h.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/5584140/martin"}, "edited": false, "score": 1, "creation_date": 1545193074, "post_id": 53844466, "comment_id": 94536771, "body": "Why would you add the encryption to the client?"}, {"owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "edited": false, "score": 1, "creation_date": 1545195046, "post_id": 53844466, "comment_id": 94537193, "body": "did not get your question. I guess you are asking for this: <a href=\"https://stackoverflow.com/questions/10701874/generating-the-sha-hash-of-a-string-using-golang\" title=\"generating the sha hash of a string using golang\">stackoverflow.com/questions/10701874/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 10473064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e958240a96a19ebc5cb08584832ef8e?s=128&d=identicon&r=PG&f=1", "display_name": "yutian", "link": "https://stackoverflow.com/users/10473064/yutian"}, "edited": false, "score": 1, "creation_date": 1545195133, "post_id": 53844466, "comment_id": 94537214, "body": "I need to communicate with server with AES ."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545204582, "post_id": 53844466, "comment_id": 94540487, "body": "<a href=\"https://golang.org/pkg/crypto/rand/#Read\" rel=\"nofollow noreferrer\">crypto/rand.Read</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12402862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b5a3dfc8207d5ff5fbbb818c0a4912e?s=128&d=identicon&r=PG&f=1", "display_name": "IceCreamHacker", "link": "https://stackoverflow.com/users/12402862/icecreamhacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1574241854, "creation_date": 1574241854, "answer_id": 58950804, "question_id": 53844466, "link": "https://stackoverflow.com/questions/53844466/how-to-generate-aes-key-with-sha1prng-algorithm-in-golang/58950804#58950804", "title": "How to generate aes key with SHA1PRNG algorithm in golang?", "body": "<p>you can try the code below</p>\n\n<pre><code>func SHA1(data []byte) []byte {\n    h := sha1.New()\n    h.Write(data)\n    return h.Sum(nil)\n}\n\nfunc aesKeySecureRandom(keyword string) (key []byte) {\n    data := []byte(keyword)\n\n    hashs := SHA1(SHA1(data))\n    key = hashs[0:16]\n\n    return key\n}\n\n</code></pre>\n\n<p>you can use java or golang to verify</p>\n\n<p>example:</p>\n\n<p>keyword:123456</p>\n\n<p>plainText:abc111abc</p>\n\n<p>key hex:6bb4837eb74329105ee4568dda7dc67e</p>\n\n<p>key base64:a7SDfrdDKRBe5FaN2n3Gfg==</p>\n\n<p>cipherText base64:7ke0HhU5KnkCaPBilYsMiw==</p>\n"}], "owner": {"reputation": 41, "user_id": 10473064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e958240a96a19ebc5cb08584832ef8e?s=128&d=identicon&r=PG&f=1", "display_name": "yutian", "link": "https://stackoverflow.com/users/10473064/yutian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574241854, "creation_date": 1545192645, "question_id": 53844466, "link": "https://stackoverflow.com/questions/53844466/how-to-generate-aes-key-with-sha1prng-algorithm-in-golang", "title": "How to generate aes key with SHA1PRNG algorithm in golang?", "body": "<p>Forgive my pool English.\nThe server program is code by java, i need to send it a password to generate aes key.The password is a random bytes array. The server program use the password as random seed to generate a 128 bits AES key with SHA1PRNG algorithm. The same password with gen the same key.\nNow i am coding the client program with golang. How to generate the AES key with a random bytes array in  golang? </p>\n"}, {"tags": ["api", "debugging", "go"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 1, "creation_date": 1545192800, "post_id": 53844366, "comment_id": 94536717, "body": "we need the code that generates the runtime error."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 2, "creation_date": 1545193479, "post_id": 53844366, "comment_id": 94536855, "body": "from the stack trace it&#39;s clear that the panic happen on <code>router.go:352</code>. we still need the code. not just the stack trace."}, {"owner": {"reputation": 825, "user_id": 3903608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c17def83d317a42d6a4db68d324bbef2?s=128&d=identicon&r=PG&f=1", "display_name": "touchstone", "link": "https://stackoverflow.com/users/3903608/touchstone"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 1, "creation_date": 1545195161, "post_id": 53844366, "comment_id": 94537220, "body": "i found that bug along with the stack tips~  thank your tips too!"}], "answers": [{"comments": [{"owner": {"reputation": 825, "user_id": 3903608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c17def83d317a42d6a4db68d324bbef2?s=128&d=identicon&r=PG&f=1", "display_name": "touchstone", "link": "https://stackoverflow.com/users/3903608/touchstone"}, "edited": false, "score": 1, "creation_date": 1545192636, "post_id": 53844447, "comment_id": 94536684, "body": "i used a error stack print,and i pick the one i understand attached. :-P i dont know why i curl the api with 200 returns and the online service is sometime 500 returns. i doubt that the online requests mess the goroutines up, but i have no proofs.."}, {"owner": {"reputation": 1083, "user_id": 5584140, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/B8T3h.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/5584140/martin"}, "reply_to_user": {"reputation": 825, "user_id": 3903608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c17def83d317a42d6a4db68d324bbef2?s=128&d=identicon&r=PG&f=1", "display_name": "touchstone", "link": "https://stackoverflow.com/users/3903608/touchstone"}, "edited": false, "score": 1, "creation_date": 1545193217, "post_id": 53844447, "comment_id": 94536798, "body": "Nice, now we need the file vplay.go in the line 652 and everything related to it."}, {"owner": {"reputation": 825, "user_id": 3903608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c17def83d317a42d6a4db68d324bbef2?s=128&d=identicon&r=PG&f=1", "display_name": "touchstone", "link": "https://stackoverflow.com/users/3903608/touchstone"}, "edited": false, "score": 2, "creation_date": 1545195057, "post_id": 53844447, "comment_id": 94537194, "body": "ah, i found the bug~ indeed a index out of a slice. thank you so much!"}], "tags": [], "owner": {"reputation": 1083, "user_id": 5584140, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/B8T3h.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/5584140/martin"}, "is_accepted": true, "score": 2, "last_activity_date": 1545192469, "creation_date": 1545192469, "answer_id": 53844447, "question_id": 53844366, "link": "https://stackoverflow.com/questions/53844366/how-to-debug-a-specific-api-in-golang/53844447#53844447", "title": "how to debug a specific api in golang?", "body": "<p>When you're handling errors you can use:</p>\n\n<blockquote>\n  <p>err.(*errors.Error).ErrorStack()</p>\n</blockquote>\n\n<p>to return the stacktrace. With that you can get the line in which your API in some cases gets an index out of range error.</p>\n"}], "owner": {"reputation": 825, "user_id": 3903608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c17def83d317a42d6a4db68d324bbef2?s=128&d=identicon&r=PG&f=1", "display_name": "touchstone", "link": "https://stackoverflow.com/users/3903608/touchstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 53844447, "answer_count": 1, "score": 2, "last_activity_date": 1545193078, "creation_date": 1545191776, "last_edit_date": 1545193078, "question_id": 53844366, "link": "https://stackoverflow.com/questions/53844366/how-to-debug-a-specific-api-in-golang", "title": "how to debug a specific api in golang?", "body": "<p>my wired situation is, the online service is working now, and everyday i can find a few <code>500</code> error reports like below:</p>\n\n<pre><code>2018-12-19 00:00:01     [ERROR] path[/vplay/getIdsInfo/?type=vlist&amp;ids=31105228] err[runtime error: index out of range] stack[\ngoweb.(*RouterTab).ServeHTTP.func3.1:/home/tanxiaolong/golib/src/goweb/router.go:352\nruntime.call64:/usr/local/go/src/runtime/asm_amd64.s:574\nruntime.gopanic:/usr/local/go/src/runtime/panic.go:505\nruntime.panicindex:/usr/local/go/src/runtime/panic.go:28\nmodels.(*VplayModel).AssembleData:/home/tanxiaolong/golib/src/vplay/models/vplay.go:757\ncontrollers.(*VplayController).GetIdsInfoAction:/home/tanxiaolong/golib/src/vplay/controllers/vplay.go:652\nruntime.call32:/usr/local/go/src/runtime/asm_amd64.s:573\nreflect.Value.call:/usr/local/go/src/reflect/value.go:447\nreflect.Value.Call:/usr/local/go/src/reflect/value.go:308\ngoweb.(*RouterTab).ServeHTTP.func3:/home/tanxiaolong/golib/src/goweb/router.go:370\nruntime.goexit:/usr/local/go/src/runtime/asm_amd64.s:2361]      (goweb/router.go:353)\n</code></pre>\n\n<p>i can find which api by log, but it returns <code>200</code> and correct response data if request it with the same query data as <code>500</code> requests by myself or wrk or ab.</p>\n\n<p>i don't know how to debug this bug..</p>\n\n<p>any suggestions on api debugging??</p>\n\n<p>many thanks!</p>\n"}, {"tags": ["go", "mux"], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1545191621, "answer_count": 0, "score": 1, "last_activity_date": 1545190346, "creation_date": 1545190346, "question_id": 53844203, "link": "https://stackoverflow.com/questions/53844203/passing-along-data-with-request", "closed_reason": "Duplicate", "title": "Passing along data with request", "body": "<p>Say we have some auth middleware:</p>\n\n<pre><code>router.Use(auth);\n</code></pre>\n\n<p>and that looks like:</p>\n\n<pre><code>func auth(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n\n    if claims, ok := token.Claims.(jwt.MapClaims); ok &amp;&amp; token.Valid {\n        var user User\n        mapstructure.Decode(claims, &amp;user)\n        return next.ServeHTTP(w, r)\n    } \n\n     json.NewEncoder(w).Encode(Exception{Message: \"Invalid authorization token\"})\n\n    })\n}\n</code></pre>\n\n<p>my question is - if we decode the JWT claims into user, how can I reference that user in other middleware functions. Using Node.js Express I can just pin the user to the request object. Is there some way to do this with Golang? </p>\n\n<p>The only way I would know how to do that would be to create a map, mapping the request to a user. But then to clean up the map I would have to have some hook that could delete the map entry once the response for that request was sent.</p>\n"}, {"tags": ["go", "mux"], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1545187436, "creation_date": 1545187436, "question_id": 53843865, "link": "https://stackoverflow.com/questions/53843865/golang-sub-router-alias", "title": "Golang sub-router alias", "body": "<p>I have this right now:</p>\n\n<pre><code>    // people\n    handler := routes.PersonHandler{}\n    subRouter := router.PathPrefix(\"/person\").Subrouter()\n    subRouter.Use(authMiddleware)\n    handler.Mount(subRouter, routes.PersonInjection{People: models.PersonInit()})\n</code></pre>\n\n<p>I am wonder if there is a way to send both \"/person\" and \"/people\" to the same subrouter? Just in need of an alias at the moment.</p>\n"}, {"tags": ["twitter-bootstrap", "go"], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 2, "last_activity_date": 1545183037, "last_edit_date": 1545183037, "creation_date": 1545182708, "answer_id": 53843362, "question_id": 53843166, "link": "https://stackoverflow.com/questions/53843166/using-bootstrap-inside-tmpl-file-to-display-nav-bar/53843362#53843362", "title": "Using bootstrap inside tmpl file to display nav bar", "body": "<p>I assume you haven't create any routes for the static assets. So create one.</p>\n\n<pre><code>http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"assets\"))))\n</code></pre>\n\n<p>By adding above handler, every request with <code>/static/</code> prefix will be served using static files inside <code>assets</code> folder.</p>\n\n<p>Next, just change the url of the static asset.</p>\n\n<pre><code>&lt;link href=\"/static/dist/bootstrap/dist/css/bootstrap.min.css\" rel=\"stylesheet\"&gt;\n&lt;link href=\"/static/dashboard.css\" rel=\"stylesheet\"&gt; &lt;!-- I'm not sure where do you put the `dashboard.css` file, so just adjust this one --&gt;\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 5248736, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b7f6b031e1bb0cba1f9f81ce6398358f?s=128&d=identicon&r=PG&f=1", "display_name": "HighonH", "link": "https://stackoverflow.com/users/5248736/highonh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 53843362, "answer_count": 1, "score": 2, "last_activity_date": 1545208496, "creation_date": 1545180750, "last_edit_date": 1545208496, "question_id": 53843166, "link": "https://stackoverflow.com/questions/53843166/using-bootstrap-inside-tmpl-file-to-display-nav-bar", "title": "Using bootstrap inside tmpl file to display nav bar", "body": "<p>I am trying to get a simple nav bar working with GO. </p>\n\n<p>Go Server:</p>\n\n<pre><code>func main() {\n    tmpl := template.Must(template.New(\"navigator.tmpl\").ParseFiles(\"./templates/navigator.tmpl\"))\n\nhttp.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    data := Names{\n        PageTitle: \"Holy Moly\",\n    }\n\n\n    tmpl.Execute(w, data)\n})\nif err := http.ListenAndServe(\":8080\", nil); err != nil {\n    panic(err)\n}\n}\n</code></pre>\n\n<p>This is my template file\nnavigator.tmpl</p>\n\n<pre><code>{{ define \"navigator\" }}&lt;!DOCTYPE html&gt; {{ end }}\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n    &lt;!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags --&gt;\n    &lt;meta name=\"description\" content=\"\"&gt;\n    &lt;meta name=\"author\" content=\"\"&gt;\n    &lt;title&gt;Dashboard Template for Bootstrap&lt;/title&gt;\n    &lt;!-- Bootstrap core CSS --&gt;\n    &lt;link href=\"/go/src/dashboard/assets/dist/bootstrap/dist/css/bootstrap.min.css\" rel=\"stylesheet\"&gt;\n    &lt;!-- Custom styles for this template --&gt;\n    &lt;link href=\"dashboard.css\" rel=\"stylesheet\"&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;nav class=\"navbar navbar-inverse navbar-fixed-top\"&gt;\n      &lt;div class=\"container-fluid\"&gt;\n        &lt;div class=\"navbar-header\"&gt;\n          &lt;button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#navbar\" aria-expanded=\"false\" aria-controls=\"navbar\"&gt;\n            &lt;span class=\"sr-only\"&gt;Toggle navigation&lt;/span&gt;           \n          &lt;/button&gt;\n          &lt;a class=\"navbar-brand\" href=\"#\"&gt;{{.PageTitle}}&lt;/a&gt;\n        &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>My Directory structure is as follows</p>\n\n<p>Go:</p>\n\n<p>=>src</p>\n\n<pre><code>  =&gt;dashboard\n\n    =&gt; main.go\n\n    =&gt; assets\n\n       =&gt;dist\n\n         =&gt;bootstrap\n\n            =&gt;dist\n\n               =&gt;css/bootstrap.min.css\n</code></pre>\n\n<p>I am not able to get any of the bootstrap graphics. I see the title name but dont see the rectangualr nav bar.</p>\n\n<p>When I open the file in my browser directly I can see the nav bar image with the title.</p>\n\n<p>I am not sure at this point why the bootstrap graphics are not rendered properly</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1545179248, "post_id": 53842969, "comment_id": 94534098, "body": "See also: <a href=\"https://stackoverflow.com/questions/53462837/fatal-error-all-goroutines-are-asleep-deadlock-when-channel-is-not-buffered\" title=\"fatal error all goroutines are asleep deadlock when channel is not buffered\">stackoverflow.com/questions/53462837/&hellip;</a>"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 2, "creation_date": 1545198274, "post_id": 53842969, "comment_id": 94538021, "body": "The reason it does not work in your first example is that when you get to <code>message &lt;- &quot;ping&quot;</code> line, the whole program is blocked because you never get to the next line that specifies the receiver. Remember, it is all one goroutine."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545229536, "post_id": 53842969, "comment_id": 94553867, "body": "This is covered in the Tour of Go: <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">tour.golang.org/concurrency/2</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2936, "user_id": 39791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/661c7cc5565e5bc21fb0fc22c0354fef?s=128&d=identicon&r=PG", "display_name": "Joe McMahon", "link": "https://stackoverflow.com/users/39791/joe-mcmahon"}, "is_accepted": true, "score": 5, "last_activity_date": 1545252851, "last_edit_date": 1545252851, "creation_date": 1545181593, "answer_id": 53843252, "question_id": 53842969, "link": "https://stackoverflow.com/questions/53842969/channel-send-and-receive-on-func-main/53843252#53843252", "title": "Channel send and receive on func main()", "body": "<p>Adding the ',1' <em>buffers</em> the channel. That means that one write to the channel is non-blocking, and the main program retains control. If the channel is not buffered, then the writing program blocks until another goroutine gets control and reads from the channel.</p>\n\n<p>The program has dropped the string into the buffered channel; it now keeps running,  reads the string out of the buffered channel, and prints it, never having blocked.</p>\n\n<p>If you use a goroutine and an unbuffered channel:</p>\n\n<ul>\n<li>The goroutine starts, reads from the channel, and blocks, waiting for something to be written to the channel.</li>\n<li>The main program writes to the channel and blocks, waiting for someone to read the string just written.</li>\n<li>The Go dispatcher looks for a routine eligible to run, finds the goroutine with a string ready to be read from the channel. It returns control to the goroutine, which receives the string and proceeds. </li>\n<li>When that goroutine exits or does something else that makes it lose control, the dispatcher looks for another program ready to run and sees the main program has successfully completed its write to the channel (the string has been read by the goroutine). The dispatcher gives control to the main program.</li>\n<li>The main program completes and exits.</li>\n</ul>\n"}], "owner": {"reputation": 407, "user_id": 1516389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/911397984d6f8c1deadf49ae7b9b10cf?s=128&d=identicon&r=PG", "display_name": "raka", "link": "https://stackoverflow.com/users/1516389/raka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53843252, "answer_count": 1, "score": 2, "last_activity_date": 1545252851, "creation_date": 1545178962, "last_edit_date": 1545248840, "question_id": 53842969, "link": "https://stackoverflow.com/questions/53842969/channel-send-and-receive-on-func-main", "title": "Channel send and receive on func main()", "body": "<p>I've been learning channels and the text book examples seem simple and easy to understand. However, i'm unable to understand the following behavior.</p>\n\n<pre><code>func main() {\n     message := make(chan string)\n\n     message &lt;- \"ping\"\n     fmt.Println(&lt;-message)\n}\n</code></pre>\n\n<p>Why does the above result in error? I understand i can make it work by introducing a go routine to have both sender and receiver ready. However, if that's the case, why does the following work.</p>\n\n<pre><code>func main() {\n    message := make(chan string,1)\n\n    message &lt;- \"ping\"\n    fmt.Println(&lt;-message)\n\n}\n</code></pre>\n\n<p>*********Thanks Joe McMahon for your answer*********<br/>\n*********Documenting below for my reference*********<br/>\nI assumed a buffer of 1(unlike 2) would also block the main routine until it finds a corresponding receiver. It seems like a buffer of 1 works like 0 &amp; 1 and doesn't block the code for the 0th write/read. To demonstrate a block using buffers,</p>\n\n<pre><code>func main() {\n    message := make(chan string, 1)\n\n    message &lt;- \"ping1\"\n    message &lt;- \"ping2\"\n    fmt.Println(&lt;-message) //Unreachable code.\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "edited": false, "score": 2, "creation_date": 1545179805, "post_id": 53843018, "comment_id": 94534201, "body": "Thank you so much! Guess i didn&#39;t pay attention to the pages, but, can you explain to me that %v thing?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "edited": false, "score": 2, "creation_date": 1545180410, "post_id": 53843018, "comment_id": 94534328, "body": "Sure. The <a href=\"https://golang.org/pkg/fmt/#hdr-Printing\" rel=\"nofollow noreferrer\">rules for how <code>Printf</code> converts values to strings</a> are a bit complicated, but in general if you say <code>%v</code> it&#39;ll try to make a human-readable representation, if you say <code>%#v</code> prints what you&#39;d need to write to get that value as a variable in Go, you can use various characters other than <code>v</code>, such as <code>%x</code>, to print in various specialized formats (I&#39;m not sure what this does for user-defined types), and <code>%%</code> will give you an actual percent sign."}], "tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": true, "score": 6, "last_activity_date": 1545179427, "creation_date": 1545179427, "answer_id": 53843018, "question_id": 53842941, "link": "https://stackoverflow.com/questions/53842941/function-executing-itself-without-being-called/53843018#53843018", "title": "Function executing itself without being called", "body": "<p>If you look at <a href=\"https://tour.golang.org/methods/17\" rel=\"noreferrer\">the previous page in the tutorial</a>, you see that <code>Stringer</code> is <a href=\"https://tour.golang.org/methods/9\" rel=\"noreferrer\">an interface</a> defined in the <code>fmt</code> package. Implementing the <code>String()</code> method <a href=\"https://tour.golang.org/methods/10\" rel=\"noreferrer\">automatically</a> makes <code>IPAddr</code> implement this interface.</p>\n\n<p>The <code>fmt.Printf</code> function checks if its argument implements the <code>Stringer</code> interface. Since it now does, it calls the <code>String</code> method when it needs to figure out how to show an <code>IPAddress</code> (you can change this behavior by using a format specifier other than <code>%v</code>, but that's beyond the scope of the question).</p>\n\n<p>The <code>fmt.Printf</code> call showed something; it showed the lines</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>loopback: 127.0.0.1\ngoogleDNS: 8.8.8.8\n</code></pre>\n\n<p>It didn't change their value or anything; it just called the <code>String</code> method to figure out how to write down an <code>IPAddr</code>, and wrote it down that way.</p>\n"}], "owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53843018, "answer_count": 1, "score": 1, "last_activity_date": 1545208528, "creation_date": 1545178801, "last_edit_date": 1545208528, "question_id": 53842941, "link": "https://stackoverflow.com/questions/53842941/function-executing-itself-without-being-called", "title": "Function executing itself without being called", "body": "<p>I started to learn Go yesterday on the Tour of Go website and I thought that I was understanding everything well;</p>\n\n<p>But then I was totally confused on the exercise Stringers: <a href=\"https://tour.golang.org/methods/18\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/18</a></p>\n\n<p>So I searched a solution to see what I was doing wrong and I found this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype IPAddr [4]byte\n\n// TODO: Add a \"String() string\" method to IPAddr.\n\nfunc (i IPAddr) String() string {\n    return fmt.Sprintf(\"%d.%d.%d.%d\", i[0], i[1], i[2], i[3])   \n\n }\n\nfunc main() {\n    hosts := map[string]IPAddr{\n        \"loopback\":  {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for name, ip := range hosts {\n        fmt.Printf(\"%v: %v\\n\", name, ip)\n    }\n}\n</code></pre>\n\n<p>and the output is this:</p>\n\n<pre><code>loopback: 127.0.0.1\ngoogleDNS: 8.8.8.8\n</code></pre>\n\n<p>it left me completely confused;</p>\n\n<p>Why did the function activate itself? Should'nt it be like: i.String() inside the main func?</p>\n\n<p>Why did the fmt.Printf show nothing on the screen at all?</p>\n\n<p>Or the fmt.Printf returned that because the String() changed the value?</p>\n\n<p>I'm sorry if the question is confusing, but can someone explain this to me?</p>\n"}, {"tags": ["go", "base64", "aes", "md5"], "comments": [{"owner": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "edited": false, "score": 2, "creation_date": 1545177431, "post_id": 53842725, "comment_id": 94533674, "body": "Add part of code which is relevant so that you can add the code."}, {"owner": {"reputation": 11, "user_id": 10808550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d4d8e5e455b3b3b5d6e440019efcb49?s=128&d=identicon&r=PG&f=1", "display_name": "continue2048", "link": "https://stackoverflow.com/users/10808550/continue2048"}, "reply_to_user": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "edited": false, "score": 1, "creation_date": 1545177590, "post_id": 53842725, "comment_id": 94533719, "body": "but, there all the code relates to this issue ..."}, {"owner": {"reputation": 11, "user_id": 10808550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d4d8e5e455b3b3b5d6e440019efcb49?s=128&d=identicon&r=PG&f=1", "display_name": "continue2048", "link": "https://stackoverflow.com/users/10808550/continue2048"}, "reply_to_user": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "edited": false, "score": 1, "creation_date": 1545178672, "post_id": 53842725, "comment_id": 94533982, "body": "@AJ, In post - link on golang code. (hyperlink)"}, {"owner": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "edited": false, "score": 1, "creation_date": 1545179710, "post_id": 53842725, "comment_id": 94534184, "body": "Redirecting to http://%20http//tpcg.io/VWlWMa"}, {"owner": {"reputation": 11, "user_id": 10808550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d4d8e5e455b3b3b5d6e440019efcb49?s=128&d=identicon&r=PG&f=1", "display_name": "continue2048", "link": "https://stackoverflow.com/users/10808550/continue2048"}, "reply_to_user": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "edited": false, "score": 1, "creation_date": 1545181082, "post_id": 53842725, "comment_id": 94534471, "body": "Oh, thk. Update post"}], "answers": [{"tags": [], "owner": {"reputation": 3839, "user_id": 275491, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Gd1Wr.jpg?s=128&g=1", "display_name": "majgis", "link": "https://stackoverflow.com/users/275491/majgis"}, "is_accepted": false, "score": 1, "last_activity_date": 1545194114, "last_edit_date": 1545194114, "creation_date": 1545191211, "answer_id": 53844310, "question_id": 53842725, "link": "https://stackoverflow.com/questions/53842725/how-to-decrypt-message-on-privnote/53844310#53844310", "title": "How to decrypt message on privnote?", "body": "<p>The key size of 32 that is mentioned in the error is set by <code>result[0 : 4*8]</code> in the return statement of the openSSLKey function.</p>\n\n<pre><code>func openSSLKey(password []byte, salt []byte) (string, string) {\n    fmt.Println(\"openSSLKey | password: \", password, \" | len(password): \", len(password), \" | salt: \", salt, \" | len(salt): \", len(salt))\n    pass_salt := string(password) + string(salt)\n    result := MD5(pass_salt)\n    cur_hash := MD5(pass_salt)\n    for i := 0; i &lt; 2; i++ {\n        cur_hash := MD5(cur_hash + pass_salt)\n        result += cur_hash\n    }\n    fmt.Println(\"openSSLKey | result: \", result, \" len(result): \", len(result))\n    return result[0 : 4*8], result[4*8 : 4*8+16]\n}\n</code></pre>\n\n<p>This key is being passed to the DesDecryption function:</p>\n\n<pre><code>dst, err_decrypt := DesDecryption([]byte(key), []byte(iv), []byte(crypt_bytes))\n</code></pre>\n\n<p>Which then is passed to crypto/des:</p>\n\n<pre><code>block, err := des.NewCipher(key)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n\n<p>The error is caused because the required size of the key is 8 but a key of size 32 is passed.  The required size of 8 was determined by looking at the source code for <a href=\"https://golang.org/src/crypto/des/cipher.go#L30\" rel=\"nofollow noreferrer\">crypto/des/cipher.go</a>:</p>\n\n<pre><code>// NewCipher creates and returns a new cipher.Block.\nfunc NewCipher(key []byte) (cipher.Block, error) {\n    if len(key) != 8 {\n        return nil, KeySizeError(len(key))\n    }\n\n    c := new(desCipher)\n    c.generateSubkeys(key)\n    return c, nil\n}\n</code></pre>\n\n<p>You should be using <a href=\"https://golang.org/pkg/crypto/aes/\" rel=\"nofollow noreferrer\">crypto/aes</a>, which allows for a key size of 32 <code>The key argument should be the AES key, either 16, 24, or 32 bytes to select AES-128, AES-192, or AES-256</code>, like is being used in the <a href=\"https://github.com/intelligentguy/pyPrivnote/blob/master/pyPrivnote/crypt.py#L48,L52\" rel=\"nofollow noreferrer\">python code you are referring to</a>:</p>\n\n<pre><code>pbe = openSSLkey(password, salt)\nkey = pbe[\"key\"]\niv = pbe[\"iv\"]\n\ncipher = AES.new(key, AES.MODE_CBC, iv, use_aesni=True)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10808550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d4d8e5e455b3b3b5d6e440019efcb49?s=128&d=identicon&r=PG&f=1", "display_name": "continue2048", "link": "https://stackoverflow.com/users/10808550/continue2048"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545194114, "creation_date": 1545176817, "last_edit_date": 1545180092, "question_id": 53842725, "link": "https://stackoverflow.com/questions/53842725/how-to-decrypt-message-on-privnote", "title": "How to decrypt message on privnote?", "body": "<p>I am looking for a solution to decrypt message (AJAX query) for privnote.com I tried to rewrite algorithm on <a href=\"https://github.com/intelligentguy/pyPrivnote\" rel=\"nofollow noreferrer\">Python</a> to <a href=\"http://tpcg.io/VWlWMa\" rel=\"nofollow noreferrer\">Golang</a>. \nI am facing a problem with the key size on Golang: panic: crypto/des: invalid key size 32. How can this problem be solved? </p>\n\n<p>P.S: I could not load code on SO (error: \u201cIt looks like your post is mostly code, please add some more details\u201d). I am sorry</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1545175678, "post_id": 53842539, "comment_id": 94533270, "body": "You need to type assert it first <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">tour.golang.org/methods/15</a>"}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 1869838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80197b326fd974c23a42e54696bc5fa7?s=128&d=identicon&r=PG", "display_name": "Utkarsh Naiknaware", "link": "https://stackoverflow.com/users/1869838/utkarsh-naiknaware"}, "is_accepted": true, "score": 1, "last_activity_date": 1545207598, "last_edit_date": 1545207598, "creation_date": 1545207154, "answer_id": 53847018, "question_id": 53842539, "link": "https://stackoverflow.com/questions/53842539/catch-nested-interface-value/53847018#53847018", "title": "Catch nested interface value", "body": "<p>Elaborating on @zerkms's comment, you need to type assert it to <code>map[string]interface{}</code>.\n<a href=\"https://play.golang.org/p/W0hezUg7gul\" rel=\"nofollow noreferrer\">Go playground link</a></p>\n\n<p> P.S: Performing a nil check before assigning is always a good idea.</p>\n\n<p><code>if exists := dat[\"result\"]; exists != nil {\n    foo1 := dat[\"result\"].(map[string]interface{})\n}</code></p>\n"}], "owner": {"reputation": 7736, "user_id": 2744242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71d3267f5993b6b79619213c789524b5?s=128&d=identicon&r=PG&f=1", "display_name": "rafaelcb21", "link": "https://stackoverflow.com/users/2744242/rafaelcb21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 53847018, "answer_count": 1, "score": 0, "last_activity_date": 1545207598, "creation_date": 1545175339, "last_edit_date": 1545175481, "question_id": 53842539, "link": "https://stackoverflow.com/questions/53842539/catch-nested-interface-value", "title": "Catch nested interface value", "body": "<p>I'm trying to get the values of a json that was obtained by means of a request.</p>\n\n<p>But I'm not getting the value <code>foo1</code>, I've tried everything but I can not get the value.</p>\n\n<p>The <code>invalid operation</code> error appears.</p>\n\n<p>Can you help me?</p>\n\n<pre><code>{\n    \"result\": {\n        \"foo1\": 1751,\n        \"foo2\": \"2018-12-17T00:00:00-02:00\",\n    }\n}\n\nurl := \"mysite\"\nreq, _ := http.NewRequest(\"GET\", url, nil)\nres, _ := http.DefaultClient.Do(req)\n\ndefer res.Body.Close()\nbody, _ := ioutil.ReadAll(res.Body)\n\nbyt := []byte(string(body))\n\nvar dat map[string]interface{}\n\nif err := json.Unmarshal(byt, &amp;dat); err != nil {\n    panic(err)\n}\n\nfmt.Println(dat) //map[result:map[foo1:1751 foo2:2018-12-17T00:00:00-02:00]]\nfmt.Println(dat[\"result\"]) //map[foo1:1751 foo2:2018-12-17T00:00:00-02:00]]\nfoo1  := dat[\"result\"][\"foo1\"] //invalid operation: dat[\"result\"][\"foo1\"] (type interface {} does not support indexing)\nfmt.Println(foo1)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 4641689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d41b3f3cc75d119e8b0b5cbd79da65?s=128&d=identicon&r=PG&f=1", "display_name": "Tranvu Xuannhat", "link": "https://stackoverflow.com/users/4641689/tranvu-xuannhat"}, "is_accepted": false, "score": 1, "last_activity_date": 1545194700, "creation_date": 1545194700, "answer_id": 53844721, "question_id": 53842344, "link": "https://stackoverflow.com/questions/53842344/starting-a-web-server-using-cmd-command-in-a-goroutine-process-doesnt-close-wh/53844721#53844721", "title": "Starting a web server using cmd.Command in a goroutine, process doesn&#39;t close when application is terminated", "body": "<p>I'm not sure about the problem with sudo. But your code has these issues:</p>\n\n<ul>\n<li><p>You are spawning 3 goroutines but only adds 1 to the wait group, so maybe you made a mistake or your code actually only runs 1 command, other 2 will not be run. If you want 3, add 3 to the wait group.</p></li>\n<li><p>I cannot find cmd.Process.Kill() in go docs but I see the os.Process.Kill. However, it's recommend to use context to cancel the processes. With the context, your commands will certainly be terminated.</p></li>\n</ul>\n\n<p>The code below demonstrates my idea:</p>\n\n<pre><code>package main\n\nimport (\n    \"os/exec\"\n    \"fmt\"\n    \"sync\"\n    \"context\"\n    \"time\"\n)\n\n\nfunc createCommand(ctx context.Context, command string) *exec.Cmd{\n    return exec.CommandContext(ctx, \"/bin/bash\", \"-c\", command)\n}\n\n\nfunc main() {\n    commands := []string{\n        \"sleep 1000000 &amp;&amp; echo complete\", \n        \"sleep 1000000 &amp;&amp; echo complete\",\n        \"sleep 10 &amp;&amp; echo complete\",\n    }\n    var wg sync.WaitGroup\n    wg.Add(3)\n    var cmds []*exec.Cmd\n\n    ctx, cancel := context.WithTimeout(context.Background(), 20 * time.Second)\n    defer func() {\n        fmt.Println(\"Process clean up\")\n        cancel()\n    }()\n\n    for _, command := range commands {\n    fmt.Printf(\"Create command %s\\n\", command)\n        cmd := createCommand(ctx, command)\n        cmds = append(cmds, cmd)\n        go func (c *exec.Cmd, name string) {\n        fmt.Printf(\"Process command %s\\n\", name)\n            defer wg.Done()\n            c.Start()\n            c.Wait()\n        fmt.Printf(\"Finish command %s\\n\", name)\n        }(cmd, command)\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code>Create command sleep 1000000 &amp;&amp; echo complete\nCreate command sleep 1000000 &amp;&amp; echo complete\nCreate command sleep 10 &amp;&amp; echo complete\nProcess command sleep 10 &amp;&amp; echo complete\nFinish command sleep 10 &amp;&amp; echo complete\nProcess command sleep 1000000 &amp;&amp; echo complete\nFinish command sleep 1000000 &amp;&amp; echo complete\nProcess command sleep 1000000 &amp;&amp; echo complete\nFinish command sleep 1000000 &amp;&amp; echo complete\nProcess clean up\n</code></pre>\n"}], "owner": {"reputation": 3895, "user_id": 4040931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/705151302/picture?type=large", "display_name": "David Alsh", "link": "https://stackoverflow.com/users/4040931/david-alsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545194700, "creation_date": 1545174022, "question_id": 53842344, "link": "https://stackoverflow.com/questions/53842344/starting-a-web-server-using-cmd-command-in-a-goroutine-process-doesnt-close-wh", "title": "Starting a web server using cmd.Command in a goroutine, process doesn&#39;t close when application is terminated", "body": "<p>I am trying to spawn multiple commands concurrently from go, then close them all when the first task completes.</p>\n\n<p>The problem is that sometimes when spawning a dotnet server and surnning my project with sudo, the spawned processes don't terminate when the application terminates.</p>\n\n<p>Why is this happening and how do I get the processes to terminate?</p>\n\n<p>Roughly this</p>\n\n<pre><code>func createCommand(command string) {\n    var cmd *exec.Cmd\n    cmd = exec.Command(\"/bin/bash\", \"-c\", command)\n    return cmd\n}\n\n\nfunc main() {\n    commands := []string{\n        \"cd server1 &amp;&amp; dotnet run\", \n        \"cd server2 &amp;&amp; dotnet run\",\n        \"sleep 10 &amp;&amp; echo complete\"\n    }\n    var wg sync.WaitGroup\n    wg.Add(1)\n    var cmds []*exec.Cmd\n\n    defer func() {\n        fmt.Println(\"Process clean up\")\n        for _, cmd := range cmds {\n            cmd.Process.Kill()\n        }\n    }()\n\n    for _, command := range commands {\n        cmd := createCommand(command)\n        cmds = append(cmds, cmd)\n        go func (c string) {\n            defer wg.Done()\n            c.Start()\n            c.Wait()\n        }(cmd)\n    }\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": ["unix", "go", "terminal"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1545170471, "post_id": 53841662, "comment_id": 94531683, "body": "You&#39;re putting the terminal in raw mode, doesn&#39;t that require a carriage return to put the cursor at the start of the line?"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1545171725, "creation_date": 1545171725, "answer_id": 53841970, "question_id": 53841662, "link": "https://stackoverflow.com/questions/53841662/does-go-fmt-indent-automatically/53841970#53841970", "title": "Does Go fmt indent automatically?", "body": "<blockquote>\n  <p>Comment: You're putting the terminal in raw mode, doesn't that require a\n  carriage return to put the cursor at the start of the line? \u2013 JimB</p>\n</blockquote>\n\n<hr>\n\n<p>For example,</p>\n\n<p><code>terminal.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"unicode\"\n\n    \"golang.org/x/crypto/ssh/terminal\"\n)\n\nfunc main() {\n    oldState, err := terminal.MakeRaw(0)\n    if err != nil {\n        panic(err)\n    }\n    defer terminal.Restore(0, oldState)\n\n    reader := bufio.NewReader(os.Stdin)\n\n    var c rune\n    for err == nil {\n        if c == 'q' {\n            break\n        }\n\n        c, _, err = reader.ReadRune()\n\n        if unicode.IsControl(c) {\n            fmt.Printf(\"%d\\r\\n\", c)\n        } else {\n            fmt.Printf(\"%d ('%c')\\r\\n\", c, c)\n        }\n    }\n\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run terminal.go\n13\n13\n13\n13\n13\n113 ('q')\n$ \n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6641159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bbe748bca76d65716620b4bf7fc6a09?s=128&d=identicon&r=PG&f=1", "display_name": "Qoutroy", "link": "https://stackoverflow.com/users/6641159/qoutroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 1, "accepted_answer_id": 53841970, "answer_count": 1, "score": 2, "last_activity_date": 1545172865, "creation_date": 1545170070, "last_edit_date": 1545172865, "question_id": 53841662, "link": "https://stackoverflow.com/questions/53841662/does-go-fmt-indent-automatically", "title": "Does Go fmt indent automatically?", "body": "<p>When I do <code>fmt.Printf(\"...\\n\")</code> it doesn't move the cursor to the 0th column and the next line is therefore indented:</p>\n\n<pre><code>13\n  13\n    13\n      13\n        13\n          13\n            113 ('q')\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"unicode\"\n\n    \"golang.org/x/crypto/ssh/terminal\"\n)\n\nfunc main() {\n    oldState, err := terminal.MakeRaw(0)\n    if err != nil {\n        panic(err)\n    }\n    defer terminal.Restore(0, oldState)\n\n    reader := bufio.NewReader(os.Stdin)\n\n    var c rune\n    for err == nil {\n        if c == 'q' {\n            break\n        }\n\n        c, _, err = reader.ReadRune()\n\n        if unicode.IsControl(c) {\n            fmt.Printf(\"%d\\n\", c)\n        } else {\n            fmt.Printf(\"%d ('%c')\\n\", c, c)\n        }\n    }\n\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "mux"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1545171078, "post_id": 53841547, "comment_id": 94531907, "body": "Either use pointers to strings with omitempty (it will omit the field only if the pointer is nil, not if its a pointer to an empty string), or implement a custom type like the sql.NullString but which implements the json.Marshaler interface."}, {"owner": {"reputation": 714, "user_id": 9548334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38d443db14d79a06637b26463b17736?s=128&d=identicon&r=PG&f=1", "display_name": "als9xd", "link": "https://stackoverflow.com/users/9548334/als9xd"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545171271, "post_id": 53841547, "comment_id": 94531967, "body": "When I use the pointer method I get the response <code>[{&quot;Id&quot;:12,&quot;UserName&quot;:null}]</code> instead of [{&quot;Id&quot;:12}]."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1545171321, "post_id": 53841547, "comment_id": 94531982, "body": "don&#39;t forget the omitempty json tag option."}, {"owner": {"reputation": 714, "user_id": 9548334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38d443db14d79a06637b26463b17736?s=128&d=identicon&r=PG&f=1", "display_name": "als9xd", "link": "https://stackoverflow.com/users/9548334/als9xd"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545171792, "post_id": 53841547, "comment_id": 94532117, "body": "Thanks that worked."}], "answers": [{"tags": [], "owner": {"reputation": 714, "user_id": 9548334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38d443db14d79a06637b26463b17736?s=128&d=identicon&r=PG&f=1", "display_name": "als9xd", "link": "https://stackoverflow.com/users/9548334/als9xd"}, "is_accepted": false, "score": 1, "last_activity_date": 1545172025, "creation_date": 1545172025, "answer_id": 53842017, "question_id": 53841547, "link": "https://stackoverflow.com/questions/53841547/go-optional-fields-with-sqlx/53842017#53842017", "title": "Go optional fields with SQLX", "body": "<p>Thanks to mkorpriva here is a solution</p>\n\n<pre><code>type User struct {\n    Id int `db:\"id\"`\n    UserName *string `db:\"user_name\" json:\",omitempty\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 714, "user_id": 9548334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38d443db14d79a06637b26463b17736?s=128&d=identicon&r=PG&f=1", "display_name": "als9xd", "link": "https://stackoverflow.com/users/9548334/als9xd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545172025, "creation_date": 1545169491, "last_edit_date": 1545170417, "question_id": 53841547, "link": "https://stackoverflow.com/questions/53841547/go-optional-fields-with-sqlx", "title": "Go optional fields with SQLX", "body": "<p>I'm learning Go and am trying to create an api endpoint that has an 'fields' parameter. When I try to scan the sqlx resulting rows it into a struct,however the fields omitted by the user are being returned as as an empty string. Is there a way that I can change the struct to reflect only the  fields that the user passed? I don't think I want to use <code>omitempty</code> in case for example user_name is an empty string.</p>\n\n<pre><code>type User struct {\n    Id int `db:\"id\"`\n    UserName string `db:\"user_name\"`\n}\n\n\nfunc GetUsers(w http.ResponseWriter,r *http.Request,db *sqlx.DB) {\n    acceptedFields := map[string]bool {\n        \"id\":true,\n        \"user_name\":true,\n    }\n    var requestedFields string = \"id\"\n    if r.URL.Query().Get(\"fields\") != \"\"{\n        requestedFields = r.URL.Query().Get(\"fields\");\n    }\n\n    for _, requestedField := range strings.Split(requestedFields,\",\") {\n        if !acceptedFields[requestedField] {\n            http.Error(w, fmt.Sprintf(\"Unknown Field '%s'\",requestedField), http.StatusBadRequest)\n        }\n    }\n\n    users := []User{}\n\n    err := db.Select(&amp;users,fmt.Sprintf(\"SELECT %s FROM users\",requestedFields)); \n    if err != nil {\n        log.Fatal(err)\n    }\n    response, _ := json.Marshal(users)\n    fmt.Fprintf(w,string(response))\n}\n</code></pre>\n\n<p><strong>Resulting Endpoint Output</strong></p>\n\n<p><code>/users?fields=id</code> => <code>[{\"Id\":12,\"UserName\":\"\"}]</code></p>\n\n<p><strong>Desired Endpoint Output</strong></p>\n\n<p><code>/users?fields=id</code> => <code>[{\"Id\":12}]</code></p>\n\n<p>Also using sql.NullString results in this:</p>\n\n<p><code>[{\"Id\":12,\"UserName\":{\"String\":\"\",\"Valid\":false}}]</code></p>\n"}, {"tags": ["api", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545162126, "post_id": 53839968, "comment_id": 94528238, "body": "You could profile your application using <code>pprof</code>. <a href=\"https://golang.org/pkg/runtime/pprof/\" rel=\"nofollow noreferrer\">golang.org/pkg/runtime/pprof</a>"}, {"owner": {"reputation": 2669, "user_id": 444583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/htumO.jpg?s=128&g=1", "display_name": "rexposadas", "link": "https://stackoverflow.com/users/444583/rexposadas"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545162362, "post_id": 53839968, "comment_id": 94528351, "body": "@Adrian unfortunately, that wouldn&#39;t help since my API calls other apis (external to my app). I&#39;ll update the question to reflect that. Thanks."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1545162367, "post_id": 53839968, "comment_id": 94528355, "body": "You could do this in middleware, call time.Now() before the call to next.ServeHTTP(w, r) and log after"}, {"owner": {"reputation": 2669, "user_id": 444583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/htumO.jpg?s=128&g=1", "display_name": "rexposadas", "link": "https://stackoverflow.com/users/444583/rexposadas"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1545162522, "post_id": 53839968, "comment_id": 94528412, "body": "@MadWombat I can certainly time the HTTP handler that way, but what about the other functions which the handler calls? They need to be individually timed."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1545162603, "post_id": 53839968, "comment_id": 94528447, "body": "As Adrian suggested, profiler could help with that. Profiler should tell you how long your functions take to execute no matter what is going on inside them."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1545163304, "post_id": 53839968, "comment_id": 94528756, "body": "pprof is a sampling profiler; it doesn&#39;t tell you how long things take, it estimates what percentage of the time you&#39;re within certain functions. Maybe look into <a href=\"https://blog.golang.org/http-tracing\" rel=\"nofollow noreferrer\">blog.golang.org/http-tracing</a>, but generally you&#39;ll need to add your own tracing within the app."}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 0, "creation_date": 1545163738, "post_id": 53839968, "comment_id": 94528944, "body": "You can do it with decorators. It\u2019s also a large piece of code, but maybe you could make a generator which will generate the file for you"}, {"owner": {"reputation": 138, "user_id": 2534830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed541ce8beafe9a52483b1e1a84e0fe?s=128&d=identicon&r=PG", "display_name": "user2534830", "link": "https://stackoverflow.com/users/2534830/user2534830"}, "edited": false, "score": 1, "creation_date": 1545173203, "post_id": 53839968, "comment_id": 94532541, "body": "You can take a look at <a href=\"https://aws.amazon.com/xray/\" rel=\"nofollow noreferrer\">X-Ray</a> also."}, {"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1545326797, "post_id": 53839968, "comment_id": 94593999, "body": "I agree with @JimB. Anyways, if you are interested in something open source for tracing I would suggest you <a href=\"https://github.com/jaegertracing/jaeger-client-go\" rel=\"nofollow noreferrer\">jaeger</a>."}], "owner": {"reputation": 2669, "user_id": 444583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/htumO.jpg?s=128&g=1", "display_name": "rexposadas", "link": "https://stackoverflow.com/users/444583/rexposadas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1545326432, "creation_date": 1545162027, "last_edit_date": 1545326432, "question_id": 53839968, "link": "https://stackoverflow.com/questions/53839968/how-to-determine-the-execution-time-of-all-functions-called-during-an-api-call", "title": "How to determine the execution time of all functions called during an API call?", "body": "<p>I built an API in golang.  I want to determine where, in the lifetime of serving a request, I have slow downs. My current solution is to log the duration times for every function in the request call. So, something like this:</p>\n\n<pre><code>start := time.Now()\ndefer func() {\n    log.Debugf(\"duration: %d\", time.Since(start).Seconds())\n}()\n</code></pre>\n\n<p>Putting the code above in the beginning of every function is cumbersome and clutters the codebase. Is there a better way to accomplish what I'm trying to do? Are there tools I can use for this?</p>\n\n<p>I looked at libraries in github but couldn't find a more elegant solution.  </p>\n\n<p>UPDATE: </p>\n\n<p>To add to the complication:</p>\n\n<ol>\n<li>My APIs calls other APIs and those calls needs to be timed.  </li>\n<li>The APIs are hosted in Heroku and AWS.</li>\n</ol>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "edited": false, "score": 1, "creation_date": 1545158306, "post_id": 53839095, "comment_id": 94526538, "body": "Thanks so much for your answer. I did not know I needed a waitGroup when channels were involved. One question, why does the <b>wg.wait and close(ch)</b> need to be in a goroutines themselves? I tried removing the goroutine and it got locked"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "edited": false, "score": 2, "creation_date": 1545158488, "post_id": 53839095, "comment_id": 94526632, "body": "you don&#39;t <i>need</i> a WaitGroup because you used channels, it&#39;s a useful tool for managing the lifecycle of goroutines. You could just count your results manually: <a href=\"https://play.golang.org/p/1H5fryMQ-Px\" rel=\"nofollow noreferrer\">play.golang.org/p/1H5fryMQ-Px</a>. <code>wg.Wait()</code> needs to be in a goroutine itself, because you can&#39;t block waiting for the goroutines to complete before you read from the channel which allows the goroutines to complete."}, {"owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "edited": false, "score": 0, "creation_date": 1545158580, "post_id": 53839095, "comment_id": 94526683, "body": "oh I got it now. Thanks so much!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1545157813, "creation_date": 1545157813, "answer_id": 53839095, "question_id": 53838998, "link": "https://stackoverflow.com/questions/53838998/proper-way-to-close-a-channel/53839095#53839095", "title": "Proper way to close a channel", "body": "<p>When there's a single sender on a channel, that sender would normally be responsible for closing the channel if necessary. Remember though that closing a channel isn't required for cleanup, it's only if you need to signal that the channel is closed.</p>\n\n<p>When there are multiple senders, you need to coordinate with all of them completing, which you can do with a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.waitGroup</code></a></p>\n\n<pre><code>ch := make(chan string)\nvar wg sync.WaitGroup\n\nfor i := 0; i &lt; 10; i++ {\n    wg.Add(1)\n    go func(c chan&lt;- string, t int) {\n        defer wg.Done()\n        time.Sleep(time.Duration(rand.Intn(3000)) * time.Millisecond)\n        c &lt;- strconv.Itoa(t) + \" : Done \" + strconv.Itoa(rand.Intn(3000))\n    }(ch, i)\n}\n\ngo func() {\n    wg.Wait()\n    close(ch)\n}()\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ViOtMHbi43C\" rel=\"noreferrer\">https://play.golang.org/p/ViOtMHbi43C</a></p>\n"}], "owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53839095, "answer_count": 1, "score": 0, "last_activity_date": 1545158054, "creation_date": 1545157443, "last_edit_date": 1545158054, "question_id": 53838998, "link": "https://stackoverflow.com/questions/53838998/proper-way-to-close-a-channel", "title": "Proper way to close a channel", "body": "<p>I want to have a bunch of goroutines that will fetch some information from a lot of servers. I'm simplifying the code below so its more readable. It seems to be working perfectly but it panics after all the tasks were completed as I never <strong>close</strong> the channel. The thing is I am not sure <strong>where</strong> I should close the same.</p>\n\n<p>I need your help in :</p>\n\n<ul>\n<li>Telling me where in the code I should be closing the channel.</li>\n<li>Telling me if the overall logic of this code seems idiomatically correct.</li>\n</ul>\n\n<h3>my code</h3>\n\n<pre><code>func main() {\n        ch := make(chan string)\n\n\n        for i:= 0; i &lt; 10 ; i++ {\n                go func(c chan &lt;- string,t int){\n                        time.Sleep( time.Duration(rand.Intn(3000)) * time.Millisecond )\n                        c &lt;- strconv.Itoa(t) + \" : Done \" + strconv.Itoa(rand.Intn(3000))\n                }(ch,i)\n        }\n        for val := range ch {\n                fmt.Println(val)\n\n        }\n}\n</code></pre>\n\n<h3>output</h3>\n\n<pre><code>$ go run test_channels.go\n0 : Done 1694\n6 : Done 511\n3 : Done 162\n2 : Done 89\n8 : Done 2728\n5 : Done 1274\n1 : Done 2211\n9 : Done 1445\n4 : Done 2237\n7 : Done 1106\nfatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan receive]:\nmain.main()\n        /home/matias/projects/src/github.com/matias/test/test_channels.go:22 +0x138\nexit status 2\n</code></pre>\n"}, {"tags": ["for-loop", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545154564, "post_id": 53838256, "comment_id": 94524769, "body": "I don&#39;t think you can combine the three-part <code>for</code> style with the one-part <code>for ... range</code>. You can have multiple variables in a three-part <code>for</code> however."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1545155016, "post_id": 53838256, "comment_id": 94525035, "body": "The latter. What would the former even mean?"}, {"owner": {"reputation": 904, "user_id": 2759462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de467ec1a458adebfcad737f12070b17?s=128&d=identicon&r=PG", "display_name": "Rafael Barros", "link": "https://stackoverflow.com/users/2759462/rafael-barros"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1545156256, "post_id": 53838256, "comment_id": 94525632, "body": "@Flimzy, i&#39;m using a third party lib to read a xlsx file, and the docs of the library suggest using the for...range, but i need to build a two dimension slice to return it to the api. I&#39;m using the <code>i</code> in the latter example to append to the slice in the right position. By the way, that&#39;s not the first time i stumble with this, but i don&#39;t remember the last one."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545157128, "post_id": 53838256, "comment_id": 94526060, "body": "If you&#39;re appending to a slice, you don&#39;t need an index."}, {"owner": {"reputation": 904, "user_id": 2759462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de467ec1a458adebfcad737f12070b17?s=128&d=identicon&r=PG", "display_name": "Rafael Barros", "link": "https://stackoverflow.com/users/2759462/rafael-barros"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545157574, "post_id": 53838256, "comment_id": 94526235, "body": "@Adrian, i think i do. I&#39;ll edit the question to be more specific."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545157912, "post_id": 53838256, "comment_id": 94526387, "body": "You definitely don&#39;t. <code>append</code> does not take an index parameter."}, {"owner": {"reputation": 904, "user_id": 2759462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de467ec1a458adebfcad737f12070b17?s=128&d=identicon&r=PG", "display_name": "Rafael Barros", "link": "https://stackoverflow.com/users/2759462/rafael-barros"}, "edited": false, "score": 0, "creation_date": 1545158022, "post_id": 53838256, "comment_id": 94526429, "body": "So, how the edited question code is compiling?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545158591, "post_id": 53838256, "comment_id": 94526691, "body": "You&#39;re not passing the index to <code>append</code>, you&#39;re indexing into the slice you just appended to, which means that the index will <i>always</i> be <code>len(parsed)-1</code> (the last item appended to <code>parsed</code>). Or you could eliminate the need altogether by looping over <code>row.Cells</code> <i>first</i> to build your <code>[]string</code> in a local var, then appending the completed row to <code>parsed</code>."}, {"owner": {"reputation": 904, "user_id": 2759462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de467ec1a458adebfcad737f12070b17?s=128&d=identicon&r=PG", "display_name": "Rafael Barros", "link": "https://stackoverflow.com/users/2759462/rafael-barros"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545159659, "post_id": 53838256, "comment_id": 94527178, "body": "@Adrian, i can&#39;t iterate over the cells first because the the row in <code>row.Cells</code> is generated iterating over the rows. The spreadsheet can have thousands of lines and tens of thousands of cells; so i don&#39;t think it&#39;s a good ideia to count the rows tens of thousands of times."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545161011, "post_id": 53838256, "comment_id": 94527746, "body": "You&#39;re already iterating over the cells. I&#39;m saying iterate over them before appending to <code>parsed</code>. Then you can get rid of <code>i</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1545161183, "post_id": 53838256, "comment_id": 94527820, "body": "<a href=\"https://play.golang.org/p/reT30V18VXC\" rel=\"nofollow noreferrer\">play.golang.org/p/reT30V18VXC</a> - no more iterating than you&#39;re doing now. Just simpler and eliminates your problem by using a more sensible order of operations."}, {"owner": {"reputation": 904, "user_id": 2759462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de467ec1a458adebfcad737f12070b17?s=128&d=identicon&r=PG", "display_name": "Rafael Barros", "link": "https://stackoverflow.com/users/2759462/rafael-barros"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545165606, "post_id": 53838256, "comment_id": 94529801, "body": "@Adrian, good one."}], "answers": [{"comments": [{"owner": {"reputation": 904, "user_id": 2759462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de467ec1a458adebfcad737f12070b17?s=128&d=identicon&r=PG", "display_name": "Rafael Barros", "link": "https://stackoverflow.com/users/2759462/rafael-barros"}, "edited": false, "score": 0, "creation_date": 1545247117, "post_id": 53853515, "comment_id": 94563465, "body": "That&#39;s a good one. I&#39;ll prefer that implementation until someone give a definitive answer. Voted up."}], "tags": [], "owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "is_accepted": false, "score": 1, "last_activity_date": 1545230376, "creation_date": 1545230376, "answer_id": 53853515, "question_id": 53838256, "link": "https://stackoverflow.com/questions/53838256/range-loop-with-more-variables/53853515#53853515", "title": "Range loop with more variables", "body": "<p>You just need to declare <code>var i</code> in right place</p>\n\n<pre><code>func parseData(xlFile *xlsx.File, parsed [][]string) [][]string {\n\n    for _, sheet := range xlFile.Sheets {\n        for i, row := range sheet.Rows {\n            parsed = append(parsed, []string{})\n\n            for _, cell := range row.Cells {\n                parsed[i] = append(parsed[i], cell.String())\n            }\n        }\n    }\n\n    return parsed\n}\n</code></pre>\n\n<p>You can play here <a href=\"https://play.golang.org/p/3XXTuwoUsFw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3XXTuwoUsFw</a></p>\n"}], "owner": {"reputation": 904, "user_id": 2759462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de467ec1a458adebfcad737f12070b17?s=128&d=identicon&r=PG", "display_name": "Rafael Barros", "link": "https://stackoverflow.com/users/2759462/rafael-barros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1545230376, "creation_date": 1545154250, "last_edit_date": 1545157955, "question_id": 53838256, "link": "https://stackoverflow.com/questions/53838256/range-loop-with-more-variables", "title": "Range loop with more variables", "body": "<p><strong>SHORT QUESTION:</strong></p>\n\n<p>Is there a way of doing something like this?</p>\n\n<pre><code>for i := 0; key, value := range something; i++ {\n    ...\n}\n</code></pre>\n\n<p>Or do I have to do it like this?</p>\n\n<pre><code>i := 0\n\nfor key, value := range something {\n    ...\n    i++\n}\n</code></pre>\n\n<hr>\n\n<p><strong>EDITED: QUESTION REAL WORLD REASON:</strong></p>\n\n<pre><code>func parseData(xlFile *xlsx.File, parsed [][]string) [][]string {\n    i := 0\n\n    for _, sheet := range xlFile.Sheets {\n        for _, row := range sheet.Rows {\n            parsed = append(parsed, []string{})\n\n            for _, cell := range row.Cells {\n                parsed[i] = append(parsed[i], cell.String())\n            }\n\n            i++\n        }\n    }\n\n    return parsed\n}\n</code></pre>\n\n<p>Could I inline the <code>i</code> declaration in the third <code>for</code>?</p>\n"}, {"tags": ["go", "time", "timestamp", "datetime-parsing"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 6, "last_activity_date": 1545156476, "last_edit_date": 1545156476, "creation_date": 1545153380, "answer_id": 53838054, "question_id": 53837975, "link": "https://stackoverflow.com/questions/53837975/time-parse-in-go-with-varying-fractional-second-length/53838054#53838054", "title": "time.Parse in Go with varying fractional second length", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">Package time</a></p>\n  \n  <p>A decimal point followed by one or more zeros represents a fractional\n  second, printed to the given number of decimal places. A decimal point\n  followed by one or more nines represents a fractional second, printed\n  to the given number of decimal places, with trailing zeros removed.</p>\n</blockquote>\n\n<hr>\n\n<p>Use nines, not zeros, for the layout fractional seconds.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    layout := \"2006-01-02 15:04:05.999999999 -0700 MST\"\n\n    input := \"2018-12-18 15:25:08.73728596 +0000 UTC\" // 8 digits\n    t, err := time.Parse(layout, input)\n    fmt.Println(t, err)\n\n    input = \"2018-12-18 15:25:08.7372 +0000 UTC\" // 4 digits\n    t, err = time.Parse(layout, input)\n    fmt.Println(t, err)\n\n    input = \"2018-12-18 15:25:08 +0000 UTC\" // 0 digits\n    t, err = time.Parse(layout, input)\n    fmt.Println(t, err)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/j4WBmz3ENke\" rel=\"nofollow noreferrer\">https://play.golang.org/p/j4WBmz3ENke</a></p>\n\n<p>Output:</p>\n\n<pre><code>2018-12-18 15:25:08.73728596 +0000 UTC &lt;nil&gt;\n2018-12-18 15:25:08.7372 +0000 UTC &lt;nil&gt;\n2018-12-18 15:25:08 +0000 UTC &lt;nil&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3876, "user_id": 281479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87498e6c222d26f48616c16ca4aead2?s=128&d=identicon&r=PG", "display_name": "jjlin", "link": "https://stackoverflow.com/users/281479/jjlin"}, "is_accepted": false, "score": 1, "last_activity_date": 1598264025, "last_edit_date": 1598264025, "creation_date": 1598263521, "answer_id": 63558883, "question_id": 53837975, "link": "https://stackoverflow.com/questions/53837975/time-parse-in-go-with-varying-fractional-second-length/63558883#63558883", "title": "time.Parse in Go with varying fractional second length", "body": "<p>From the <a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"nofollow noreferrer\"><code>time</code></a> docs:</p>\n<blockquote>\n<p>A decimal point followed by one or more zeros represents a fractional\nsecond, printed to the given number of decimal places. A decimal point\nfollowed by one or more nines represents a fractional second, printed\nto the given number of decimal places, with trailing zeros removed.\nWhen parsing (only), the input may contain a fractional second field\nimmediately after the seconds field, even if the layout does not\nsignify its presence. In that case a decimal point followed by a\nmaximal series of digits is parsed as a fractional second.</p>\n</blockquote>\n<p>For time parsing:</p>\n<ol>\n<li>If you don't specify fractional seconds in the layout, <code>time.Parse</code> will still accept it in the input, with full resolution (the &quot;maximal series of digits&quot;). (<a href=\"https://github.com/golang/go/blob/go1.15/src/time/format.go#L950-L955\" rel=\"nofollow noreferrer\">source</a>)</li>\n<li>If you specify fractional seconds with one or more zeros, <code>time.Parse</code> requires the input to have that exact number of fractional digits. (<a href=\"https://github.com/golang/go/blob/go1.15/src/time/format.go#L1062-L1068\" rel=\"nofollow noreferrer\">source</a>)</li>\n<li>If you specify fractional seconds with one or more nines, <code>time.Parse</code> actually accepts <strong>any number</strong> of fractional digits (up to 9). That is, the behavior is the same as if you didn't specify fractional seconds at all (case #1). I think the docs are not clear on this point at all, but for parsing (not formatting), <code>.9</code>, <code>.99</code>, <code>.999</code>, <code>.999999</code>, etc. are all exactly equivalent. (<a href=\"https://github.com/golang/go/blob/go1.15/src/time/format.go#L1077-L1082\" rel=\"nofollow noreferrer\">source</a>)</li>\n</ol>\n<p>Playground samples: <a href=\"https://play.golang.org/p/aXYiaMsCVuz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/aXYiaMsCVuz</a></p>\n"}], "owner": {"reputation": 84, "user_id": 1426867, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rQ0ZW.jpg?s=128&g=1", "display_name": "MarekT", "link": "https://stackoverflow.com/users/1426867/marekt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1598264025, "creation_date": 1545153023, "last_edit_date": 1545154214, "question_id": 53837975, "link": "https://stackoverflow.com/questions/53837975/time-parse-in-go-with-varying-fractional-second-length", "title": "time.Parse in Go with varying fractional second length", "body": "<p>I am parsing a timestamp from a DB.  My layout is the following:</p>\n\n<pre><code>layout = \"2006-01-02 15:04:05.000000000 -0700 MST\"\n\npipelineTS, err := time.Parse(layout, rawPipelineTS)\n</code></pre>\n\n<p>The issue is that sometimes the fractional seconds are not 9 digits, for example:</p>\n\n<pre><code>2018-12-18 15:25:08.73728596 +0000 UTC  \n</code></pre>\n\n<p>When it finds a value like this, it errors out.  Any ideas on how to fix this?  The timestamps come from a DB table.  I need it to take any number of fractional second digits.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 9878263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRGIX.png?s=128&g=1", "display_name": "Mathieu CAROFF", "link": "https://stackoverflow.com/users/9878263/mathieu-caroff"}, "edited": false, "score": 2, "creation_date": 1591887705, "post_id": 53852916, "comment_id": 110231822, "body": "&quot;See <a href=\"https://github.com/golang/go/wiki/Modules#should-i-commit-my-gosum-file-as-well-as-my-gomod-file\" rel=\"nofollow noreferrer\">FAQ below</a> for more details and rationale.&quot;"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 67, "last_activity_date": 1545228317, "creation_date": 1545228317, "answer_id": 53852916, "question_id": 53837919, "link": "https://stackoverflow.com/questions/53837919/should-go-sum-file-be-checked-in-to-the-git-repository/53852916#53852916", "title": "Should go.sum file be checked in to the git repository?", "body": "<p><a href=\"https://github.com/golang/go/wiki/Modules#releasing-modules-all-versions\" rel=\"noreferrer\">https://github.com/golang/go/wiki/Modules#releasing-modules-all-versions</a>:</p>\n\n<blockquote>\n  <p>Ensure your go.sum file is committed along with your go.mod file.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7055, "user_id": 2350083, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/ekgg9.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2350083/jon"}, "is_accepted": false, "score": 9, "last_activity_date": 1607456876, "creation_date": 1607456876, "answer_id": 65205889, "question_id": 53837919, "link": "https://stackoverflow.com/questions/53837919/should-go-sum-file-be-checked-in-to-the-git-repository/65205889#65205889", "title": "Should go.sum file be checked in to the git repository?", "body": "<p>(Building on a <a href=\"https://stackoverflow.com/a/53852916/2350083\">previous answer</a>.)</p>\n<p>Yes, commit <code>go.sum</code>.</p>\n<blockquote>\n<p>Ensure your <code>go.sum</code> file is committed along with your <code>go.mod</code> file. See FAQ below for more details and rationale.</p>\n</blockquote>\n<p>From the <a href=\"https://github.com/golang/go/wiki/Modules#should-i-commit-my-gosum-file-as-well-as-my-gomod-file\" rel=\"noreferrer\">FAQ</a>:</p>\n<blockquote>\n<h3>Should I commit my 'go.sum' file as well as my 'go.mod' file?</h3>\n<p>Typically your module's <code>go.sum</code> file should be committed along with\nyour <code>go.mod</code> file.</p>\n<ul>\n<li><code>go.sum</code> contains the expected cryptographic checksums of the content of specific module versions.</li>\n<li>If someone clones your repository and downloads your dependencies using the go command, they will receive an error if there is any\nmismatch between their downloaded copies of your dependencies and the\ncorresponding entries in your <code>go.sum</code>.</li>\n<li>In addition, <code>go mod verify</code> checks that the on-disk cached copies of module downloads still match the entries in <code>go.sum</code>.</li>\n<li>Note that <code>go.sum</code> is not a lock file as used in some alternative dependency management systems. (<code>go.mod</code> provides enough information\nfor reproducible builds).</li>\n<li>See very brief <a href=\"https://twitter.com/FiloSottile/status/1029404663358087173\" rel=\"noreferrer\">rationale here</a> from\nFilippo Valsorda on why you should check in your <code>go.sum</code>. See the\n<a href=\"https://tip.golang.org/cmd/go/#hdr-Module_downloading_and_verification\" rel=\"noreferrer\">&quot;Module downloading and\nverification&quot;</a>\nsection of the tip documentation for more details. See possible future\nextensions being discussed for example in\n<a href=\"https://github.com/golang/go/issues/24117\" rel=\"noreferrer\">#24117</a> and\n<a href=\"https://github.com/golang/go/issues/25530\" rel=\"noreferrer\">#25530</a>.</li>\n</ul>\n</blockquote>\n"}], "owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15838, "favorite_count": 7, "accepted_answer_id": 53852916, "answer_count": 2, "score": 45, "last_activity_date": 1607456876, "creation_date": 1545152777, "question_id": 53837919, "link": "https://stackoverflow.com/questions/53837919/should-go-sum-file-be-checked-in-to-the-git-repository", "title": "Should go.sum file be checked in to the git repository?", "body": "<p>I have a program with source code hosted on GitHub that uses Go Modules introduced in go 1.11.</p>\n\n<p><code>go.mod</code> file describes my dependencies, but <code>go.sum</code> file seems to be a lockfile. Should I be adding <code>go.sum</code> to my repository or should I gitignore it?</p>\n"}, {"tags": ["go", "dep"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1545149384, "post_id": 53836958, "comment_id": 94521938, "body": "What kinds of runtime faults for #2? This sounds like a bug in your code (or a library), and not the fault of the approach."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1545150278, "post_id": 53836958, "comment_id": 94522427, "body": "@Flimzy deps that depend on a different version of the same package might fail when using the GOPATH version, methinks"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1545153500, "post_id": 53836958, "comment_id": 94524269, "body": "@EliasVanOotegem: But that would usually manifest as a compilation failure. The OP mentions runtime failures."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1545153621, "post_id": 53836958, "comment_id": 94524333, "body": "@Flimzy Ah, missed that bit, fair point... probably time to read up on delve for the OP"}, {"owner": {"reputation": 83, "user_id": 1508460, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/addfffe453a45df6618cdaccb71be9da?s=128&d=identicon&r=PG", "display_name": "user1508460", "link": "https://stackoverflow.com/users/1508460/user1508460"}, "edited": false, "score": 0, "creation_date": 1545157840, "post_id": 53836958, "comment_id": 94526359, "body": "My bad, actually a compilation error -- updated the question with near-exact error message."}], "owner": {"reputation": 83, "user_id": 1508460, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/addfffe453a45df6618cdaccb71be9da?s=128&d=identicon&r=PG", "display_name": "user1508460", "link": "https://stackoverflow.com/users/1508460/user1508460"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 626, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1545159052, "creation_date": 1545149307, "last_edit_date": 1545159052, "question_id": 53836958, "link": "https://stackoverflow.com/questions/53836958/how-to-override-vendor-packages-with-local-src-in-dep-for-local-development", "title": "How to override vendor packages with local src in dep (for local development)", "body": "<p>Pseudo project setup:</p>\n\n<ul>\n<li>$GOPATH/src/github.com/foo/common-libs</li>\n<li>$GOPATH/src/github.com/foo/my-project (has a dependency on common-libs managed by dep, copy in /vendor directory</li>\n</ul>\n\n<p>Can't find a way to edit <em>common-libs</em> locally (i.e. in /src) and have those changes immediately reflected in <em>my-project</em>. The project /vendor file always has priority over that in $GOPATH.</p>\n\n<p>Instead every time I need to push the <em>common-libs</em> changes to Github then run <code>dep ensure -update</code> in <em>my-project</em> -- which is really slow and annoying.</p>\n\n<p>Tried (unsuccessfully):</p>\n\n<ol>\n<li>Ignoring local /vendor in Gopkg.toml using <code>ignored = [\"github.com/foo/common-libs*\"]</code>, but throws a compilation error: <code>cannot use &amp;amount (type *\"github.com/foo/my-project/vendor/github.com/shopspring/decimal\".Decimal) as type *\"github.com/foo/common-libs/vendor/github.com/shopspring/decimal\".Decimal in field value</code>)</li>\n<li>Manually deleting <em>common-libs</em> from the /vendor directory of <em>my-project</em> (temporarily) -- but this leads to the same compilation error as #1 (and is annoying because running <code>dep ensure</code> adds the deleted folder back to the vendor folder).</li>\n<li>Manually editing <em>common-libs</em> in /vendor (temporarily), which works -- but I lose static code analysis and I have to copy the changes to the actual <em>common-libs</em> projects afterwards.</li>\n</ol>\n\n<p>Any help appreciated! Thanks.</p>\n"}, {"tags": ["json", "go", "decoding"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 9, "creation_date": 1545145612, "post_id": 53835866, "comment_id": 94519714, "body": "Check the error returned by <code>Decoder.Decode()</code>. Any time you&#39;re encountering a problem, <i>check your error returns</i>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1545145616, "post_id": 53835866, "comment_id": 94519717, "body": "Your input JSON is a JSON array, so you have to unmarshal it into a Go slice, not into a single struct value. Try <code>var s []Service</code> or <code>var s []*Service</code>."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1545150376, "post_id": 53835866, "comment_id": 94522487, "body": "nit-pick, but <code>http.Response.Body</code> implements the <code>ReadCloser</code>interface, no need for the <code>defer resp.Body.Close()</code> call IIRC"}], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 4, "last_activity_date": 1545145769, "creation_date": 1545145769, "answer_id": 53835936, "question_id": 53835866, "link": "https://stackoverflow.com/questions/53835866/json-decoding-using-go-fails/53835936#53835936", "title": "JSON Decoding using Go fails", "body": "<p>Your json response is array of service</p>\n\n<pre><code>var s []Service\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 9725432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZkBEF.jpg?s=128&g=1", "display_name": "theMage", "link": "https://stackoverflow.com/users/9725432/themage"}, "is_accepted": false, "score": 3, "last_activity_date": 1545145878, "creation_date": 1545145878, "answer_id": 53835964, "question_id": 53835866, "link": "https://stackoverflow.com/questions/53835866/json-decoding-using-go-fails/53835964#53835964", "title": "JSON Decoding using Go fails", "body": "<p>The problem may be that your variable is a Service, while your json represent an array of \"Service\"s.</p>\n\n<p>Try declaring s as:</p>\n\n<pre><code>var s []Service;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10806738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-u-wNmUr33b4/AAAAAAAAAAI/AAAAAAAAABo/_KbQDeoRQ_s/photo.jpg?sz=128", "display_name": "Spark", "link": "https://stackoverflow.com/users/10806738/spark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1545145878, "creation_date": 1545145506, "question_id": 53835866, "link": "https://stackoverflow.com/questions/53835866/json-decoding-using-go-fails", "title": "JSON Decoding using Go fails", "body": "<p>i have some problems decoding the body of a http response. The response I get from using Insomnia looks like this:</p>\n\n<pre><code>[\n  {\n    \"name\": \"monitoring\",\n    \"instances\": [\n      {\n        \"host\": \"ite00716.local\",\n        \"id\": \"2058b934-720f-47c5-a1da-3d1535423b83\",\n        \"port\": 8080\n      }\n    ]\n  },\n  {\n    \"name\": \"app1\",\n    \"instances\": [\n      {\n        \"host\": \"172.20.10.2\",\n        \"id\": \"bc9a5859-8dda-418a-a323-11f67fbe1a71\",\n        \"port\": 8081\n      }\n    ]\n  }\n]\n</code></pre>\n\n<p>When I use the following go code, the struct I decode to is empty. I'm not sure why. Please help me!</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Service struct {\n    Name      string     `json:\"name\"`\n    Instances []Instance `json:\"instances\"`\n}\n\ntype Instance struct {\n    Host string `json:\"host\"`\n    Id   string `json:\"id\"`\n    Port int    `json:\"port\"`\n}\n\nfunc main() {\n    resp, err := http.Get(\"http://localhost:8080/services\")\n    if err != nil {\n        panic(err)\n    }\n    defer resp.Body.Close()\n\n    var s Service\n\n    json.NewDecoder(resp.Body).Decode(&amp;s)\n\n    fmt.Println(s)\n}\n</code></pre>\n"}, {"tags": ["go", "pipeline", "hugo", "go-templates"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545142808, "post_id": 53834929, "comment_id": 94518088, "body": "Hugo uses Go&#39;s standard template library, which is well-documented: <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">golang.org/pkg/html/template</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545142871, "post_id": 53834929, "comment_id": 94518124, "body": "The above is mentioned in the first sentence of the first section of Hugo&#39;s own template docs: <a href=\"https://gohugo.io/templates/introduction/\" rel=\"nofollow noreferrer\">gohugo.io/templates/introduction</a>"}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1545147209, "post_id": 53834929, "comment_id": 94520662, "body": "Actually, there is a similar feature in Django templates called filters."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1545146089, "last_edit_date": 1545146089, "creation_date": 1545142982, "answer_id": 53835104, "question_id": 53834929, "link": "https://stackoverflow.com/questions/53834929/how-is-this-invocation-called/53835104#53835104", "title": "How is this invocation called?", "body": "<p>That is a feature of the Go template engine, although it's not a new idea, if you used unix systems, you can do the same in shell commands (think of e.g. <code>ls |more</code>).</p>\n\n<p>It's called \"chaining\": you specify a sequence of commands, and the output of each is used as the input of the next in the chain.</p>\n\n<p>It's documented at <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text/template</code></a>:</p>\n\n<blockquote>\n  <p>A pipeline may be \"chained\" by separating a sequence of commands with pipeline characters '|'. In a chained pipeline, the result of each command is passed as the last argument of the following command. The output of the final command in the pipeline is the value of the pipeline.</p>\n</blockquote>\n\n<p>The Go template engine only allows you to register and call functions and methods with a single return value; or 2 return values of which the second must be of type <code>error</code> (which is checked to tell if the call is considered successful, and non-<code>nil</code> errors terminate the template execution with an error). So you can't chain commands that have multiple return values, and you can't specify tuples to pass multiple values to functions having multiple parameters.</p>\n\n<p>For more about pipelines, see <a href=\"https://stackoverflow.com/questions/42507958/golang-template-engine-pipelines/42508255#42508255\">golang template engine pipelines</a></p>\n"}], "owner": {"reputation": 1394, "user_id": 4214184, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b4c95b51ca86c3a27f1a6515b11557e?s=128&d=identicon&r=PG", "display_name": "anemaria20", "link": "https://stackoverflow.com/users/4214184/anemaria20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53835104, "answer_count": 1, "score": 0, "last_activity_date": 1545146089, "creation_date": 1545142385, "last_edit_date": 1545143065, "question_id": 53834929, "link": "https://stackoverflow.com/questions/53834929/how-is-this-invocation-called", "title": "How is this invocation called?", "body": "<p>Inside Hugo templates, I'm aware that you can call a function using <code>function param</code>:</p>\n\n<pre><code>{{ singularize \"cats\" }}\n</code></pre>\n\n<p>but in the documentation, I'm also seeing you can also do:</p>\n\n<pre><code>{{ \"cats\" | singularize }}\n</code></pre>\n\n<p>I've never encountered this way of calling functions (inside languages like Ruby/Python). Is this Go-specific, or just Hugo-specific? How is this way of calling a function called? Also, can you do it if you have more than 1 type of argument?</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1545142591, "post_id": 53834441, "comment_id": 94517955, "body": "So no change of the XML and no change of the binaries, but change of the behavior?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545142725, "post_id": 53834441, "comment_id": 94518043, "body": "The error is correct, it&#39;s invalid XML because there is an open tag with no closing tag. The incorrect behavior would be the behavior you say used to happen, which I&#39;ve never witnessed, and which is impossible to troubleshoot if it&#39;s not happening now."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1545142874, "post_id": 53834441, "comment_id": 94518129, "body": "But an empty string causes also an EOF error: <a href=\"https://play.golang.org/p/xJYLK5xVpr9\" rel=\"nofollow noreferrer\">play.golang.org/p/xJYLK5xVpr9</a> I would say this is ok, because if I call Unmarshal I would expect something I could unmarshal. But if I try to do this with an empty string that error is ok. Now it is your part to handle that error gracefully"}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1545144168, "post_id": 53834441, "comment_id": 94518853, "body": "Ok, with data the error is gone: <a href=\"https://goplay.space/#fnhN563zJLG\" rel=\"nofollow noreferrer\">goplay.space/#fnhN563zJLG</a>"}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1545145323, "post_id": 53834441, "comment_id": 94519538, "body": "..but the test does not make any sense now, since it also passes on arbitrary String like &quot;Lore Ipsum&quot;: <a href=\"https://goplay.space/#MQxLYMEqiJX\" rel=\"nofollow noreferrer\">goplay.space/#MQxLYMEqiJX</a>"}], "answers": [{"comments": [{"owner": {"reputation": 796, "user_id": 4802458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4gBP.jpg?s=128&g=1", "display_name": "Marcin Zawiejski", "link": "https://stackoverflow.com/users/4802458/marcin-zawiejski"}, "edited": false, "score": 1, "creation_date": 1545142284, "post_id": 53834619, "comment_id": 94517785, "body": "I think the XML declaration suggestion is not valid (e.g. because of a missing &quot;verison&quot; attribute) although I agree a closing tag is the correct fix here."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1545143003, "post_id": 53834619, "comment_id": 94518186, "body": "I think the error is ok. Because the umarshaler expects input, but if there is no input that is an error.  Closing a the Declaration is not a good idea. I would say that this could cause a lot of problems with other xml programs."}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1545143765, "post_id": 53834619, "comment_id": 94518616, "body": "actually i have tried your suggestions, also with &lt;?xml version=&quot;1.0&quot;?&gt; (which has been working for sure until now, but it also ends up with the same error, which confuses me. I don&#180;t need the xml to contain data, it just need to be valid."}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1545144133, "post_id": 53834619, "comment_id": 94518822, "body": "How ever as @apxp suggested, its up to me now obviously to handle the error because with some data the error is gone: <a href=\"https://goplay.space/#fnhN563zJLG\" rel=\"nofollow noreferrer\">goplay.space/#fnhN563zJLG</a>"}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1545144589, "post_id": 53834619, "comment_id": 94519123, "body": "Here is a solution with EOF handling: <a href=\"https://goplay.space/#2x1640wtT7_l\" rel=\"nofollow noreferrer\">goplay.space/#2x1640wtT7_l</a>"}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1545145188, "post_id": 53834619, "comment_id": 94519469, "body": "Sorry, I had to revert the optimism. I turned out that is also passing now on creap, which is not even xml like &quot;Lore Ipsum&quot;: <a href=\"https://goplay.space/#MQxLYMEqiJX\" rel=\"nofollow noreferrer\">goplay.space/#MQxLYMEqiJX</a>"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 1, "last_activity_date": 1545141371, "creation_date": 1545141371, "answer_id": 53834619, "question_id": 53834441, "link": "https://stackoverflow.com/questions/53834441/go-1-11-2-xml-unexpected-eof/53834619#53834619", "title": "go 1.11.2 xml unexpected EOF", "body": "<p>It means that it expected an end tag. I've not done much XML recently, however I think you either have to add a closing <code>&lt;/xml&gt;</code> or add question marks: <code>&lt;?xml xmlns=\"http://www.w3.org/1999/xhtml\"?&gt;</code></p>\n"}], "owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545144219, "creation_date": 1545140793, "last_edit_date": 1545144219, "question_id": 53834441, "link": "https://stackoverflow.com/questions/53834441/go-1-11-2-xml-unexpected-eof", "title": "go 1.11.2 xml unexpected EOF", "body": "<p>I want to check if an submitted xml file is a valid xml or not so I check if it can be parsed. I do it like that:</p>\n\n<pre><code>const EmptyXml = `&lt;?xml xmlns=\"http://www.w3.org/1999/xhtml\"?&gt;`\n\nfunc CanParse(xmlData string) (bool, error) {\n    if strings.TrimSpace(xmlData) == \"\" {\n        return false, nil\n    }\n    type Tag struct {\n        XMLName xml.Name\n        Content string `xml:\",innerxml\"`\n    }\n    type Object struct {\n        Items []Tag `xml:\",any\"`\n    }\n    var o *Object\n    err := xml.Unmarshal([]byte(xmlData), &amp;o)\n    if err != nil {\n        return false, err\n    } else {\n        return true, nil\n    }\n}\n</code></pre>\n\n<p>Sadly I end up with an error: unexpected EOF.\nWhy is this?</p>\n\n<p>Actually the method did work a month ago, and golang has not been updated since then so I\u00b4m still about to figure out what broke the method</p>\n\n<p><a href=\"https://goplay.space/#YxiyTbq8ww0\" rel=\"nofollow noreferrer\">https://goplay.space/#YxiyTbq8ww0</a></p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1545138531, "post_id": 53833464, "comment_id": 94515540, "body": "Can you come up with a <i>simple</i> example?"}], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 6108452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d9db9f64a8f90a25e770c7577ff78d?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6108452/leo"}, "edited": false, "score": 0, "creation_date": 1545139507, "post_id": 53833749, "comment_id": 94516067, "body": "Suppose that it works correctly when using index <code>srcList[i].id[:]</code> because of golang creates one more copy of <code>srcListItem</code>. Is it expected behavior or it&#39;a a bug in golang optimizer?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 28, "user_id": 6108452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d9db9f64a8f90a25e770c7577ff78d?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6108452/leo"}, "edited": false, "score": 0, "creation_date": 1545139773, "post_id": 53833749, "comment_id": 94516235, "body": "I don&#39;t think its a bug. I think you can&#39;t count on the value of the iterator pass that iteration."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 28, "user_id": 6108452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d9db9f64a8f90a25e770c7577ff78d?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6108452/leo"}, "edited": false, "score": 1, "creation_date": 1545140066, "post_id": 53833749, "comment_id": 94516429, "body": "@Leo It&#39;s not a bug. <code>srcList[i]</code> and <code>item</code> don&#39;t share the same place in memory. You could think of it this way: on each iteration <code>range</code> copies the value in <code>srcList[i]</code> to <code>item</code> resuing the memory it allocated for <code>item</code> at the loop&#39;s start. And doing <code>item[:]</code> returns a slice that references <code>item</code>&#39;s storage, ie its memory, ie the memory the range loop allocated for item and is reusing on each iteration."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 1, "last_activity_date": 1545138513, "creation_date": 1545138513, "answer_id": 53833749, "question_id": 53833464, "link": "https://stackoverflow.com/questions/53833464/copy-list-of-arrays-to-list-of-slices-works-wrong/53833749#53833749", "title": "Copy list of arrays to list of slices works wrong", "body": "<p>I believe this is a result of <code>item</code> going out of scope and the for loop reusing the memory. This means that when you append <code>item</code> to your slice, you hold on to it even after it \"goes out of scope\". When the for loop changes the memory's underlying value, you see those changes reflected in your slice.</p>\n"}], "owner": {"reputation": 28, "user_id": 6108452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d9db9f64a8f90a25e770c7577ff78d?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6108452/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53833749, "answer_count": 1, "score": 0, "last_activity_date": 1545138513, "creation_date": 1545137601, "last_edit_date": 1545137615, "question_id": 53833464, "link": "https://stackoverflow.com/questions/53833464/copy-list-of-arrays-to-list-of-slices-works-wrong", "title": "Copy list of arrays to list of slices works wrong", "body": "<p>There is an array type:</p>\n\n<pre><code>const Size = 16\ntype idType [Size]byte\n</code></pre>\n\n<p>and to structure types:</p>\n\n<pre><code>type srcListItem struct {\n    id idType\n}\ntype destListItem struct {\n    id []byte\n}\n</code></pre>\n\n<p>I initialize source list with two items like this:</p>\n\n<pre><code>srcList := make([]srcListItem, 2)\nfor i := 0; i &lt; Size; i++ {\n    srcList[0].id[i] = byte(i)\n    srcList[1].id[i] = byte(i + Size)\n}\n</code></pre>\n\n<p>Then I try to copy it to two slices of <code>destListItem</code> type. When copying one of them I use item, and to copy another index is used:</p>\n\n<pre><code>for i, item := range srcList {\n    fmt.Println(\"id slice: \", srcList[i].id)\n    item1 := destListItem {\n        id: item.id[:],\n    }\n    destList1 = append(destList1, item1)\n\n    item2 := destListItem {\n        id: srcList[i].id[:],\n    }\n    destList2 = append(destList2, item2)\n}\n</code></pre>\n\n<p>the output of print result slices is:</p>\n\n<pre><code>destList1 items array:  [{[16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31]} {[16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31]}]\ndestList2 items array:  [{[0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15]} {[16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31]}]\n</code></pre>\n\n<p>Tell me please why items in destList1 contains identical ids?\nHere is complete source code: <a href=\"https://play.golang.org/p/IJM5cllSb1B\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IJM5cllSb1B</a></p>\n\n<p>Thanks.</p>\n\n<p>P. S. I know some workarounds. For example the result will be correct in both cases if the source list will be of <code>[]*srcListItem</code> type. \nBut why it work so strange as is?</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1545137239, "post_id": 53833222, "comment_id": 94514808, "body": "The <code>{{if}}</code> action does not change the dot, but its enclosing <code>{{range}}</code> does. Which means <code>.first</code> in the <code>{{if}}</code> is not the same as the <code>.first</code> in the <code>{{range}}</code>. If dot above <code>{{range}}</code> is the passed param, you may use <code>$.first</code> and <code>$</code> inside <code>{{if}}</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545143149, "post_id": 53833222, "comment_id": 94518261, "body": "Are you checking the error return value from the template execute call?"}], "owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545153015, "creation_date": 1545136796, "last_edit_date": 1545153015, "question_id": 53833222, "link": "https://stackoverflow.com/questions/53833222/what-is-the-proper-way-to-put-a-dot-in-a-nested-if", "title": "what is the proper way to put a dot in a nested if", "body": "<p>I have the following code that fails to process in the template processor. I believe it is the dot in the if that is causing the parser to terminate early.</p>\n\n<pre><code>{{range Counter .first .last}}\n     {{if eq . $.first}}\n        first stuff here\n     {{else}}\n        some stuff here\n     {{end}}\n     and the remainder here\n{{end}}\n</code></pre>\n\n<p>When I look at the resulting string it stops where the inner 'if' began. I'm thinking there might be an alias of the dot but have not found it. Although the DOC specifically says that the if will not change dot.</p>\n\n<p>This sort of helps...</p>\n\n<pre><code>&lt;eq . $.firstpid&gt;: error calling eq: incompatible types for comparison\n</code></pre>\n\n<p>I was under the impression that the template system normalized the types. I'll have to look more closely into that.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9367156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914a2c0517bd41ad183b78e122bbfb67?s=128&d=identicon&r=PG&f=1", "display_name": "Hassan Yousaf", "link": "https://stackoverflow.com/users/9367156/hassan-yousaf"}, "edited": false, "score": 0, "creation_date": 1545138455, "post_id": 53833309, "comment_id": 94515492, "body": "actually the case is, I am working with aws-go-sdk and trying to know before hand that if any bucket exist with this name, there are many buckets with different owners so &#39;headBucket&#39; is not helpful"}, {"owner": {"reputation": 767, "user_id": 10798636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc48413f8aa2423bcff4167850a375b7?s=128&d=identicon&r=PG&f=1", "display_name": "DominikHelps", "link": "https://stackoverflow.com/users/10798636/dominikhelps"}, "reply_to_user": {"reputation": 1, "user_id": 9367156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914a2c0517bd41ad183b78e122bbfb67?s=128&d=identicon&r=PG&f=1", "display_name": "Hassan Yousaf", "link": "https://stackoverflow.com/users/9367156/hassan-yousaf"}, "edited": false, "score": 1, "creation_date": 1545145587, "post_id": 53833309, "comment_id": 94519702, "body": "Then you have the global use case. You cannot know beforehand if the3 bucket exists, but will get the BucketAlreadyExists error and can handle this accordingly"}], "tags": [], "owner": {"reputation": 767, "user_id": 10798636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc48413f8aa2423bcff4167850a375b7?s=128&d=identicon&r=PG&f=1", "display_name": "DominikHelps", "link": "https://stackoverflow.com/users/10798636/dominikhelps"}, "is_accepted": false, "score": 4, "last_activity_date": 1545137090, "creation_date": 1545137090, "answer_id": 53833309, "question_id": 53832691, "link": "https://stackoverflow.com/questions/53832691/how-could-i-check-that-whether-a-s3-bucket-already-exist-in-aws-s3-with-go/53833309#53833309", "title": "how could I check that whether a S3 bucket already exist in aws s3 with GO", "body": "<p>headBucket is the right method if it is your bucket. \nThis way you can check if the bucket exists.</p>\n\n<p>If you mean globally I would try to create the bucket with a uuid at the end.\nIf the bucket already exists you will get the error: </p>\n\n<pre><code>ErrCodeBucketAlreadyExists \"BucketAlreadyExists\".\n</code></pre>\n\n<p>Does this help?</p>\n\n<p>Greetings</p>\n\n<p>Dominik</p>\n"}], "owner": {"reputation": 1, "user_id": 9367156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914a2c0517bd41ad183b78e122bbfb67?s=128&d=identicon&r=PG&f=1", "display_name": "Hassan Yousaf", "link": "https://stackoverflow.com/users/9367156/hassan-yousaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545137090, "creation_date": 1545134887, "question_id": 53832691, "link": "https://stackoverflow.com/questions/53832691/how-could-i-check-that-whether-a-s3-bucket-already-exist-in-aws-s3-with-go", "title": "how could I check that whether a S3 bucket already exist in aws s3 with GO", "body": "<p>I am trying to find an efficient way to check whether a bucket exist in aws S3 service.\nI don't want to use the list bucket function of s3 go sdk 'listBuckets'\nI tried using 'headBucket' function but I think i am using it in the wrong way. any help would be appreciated!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1545135683, "post_id": 53832498, "comment_id": 94513940, "body": "Are you mounting the directory, or just the individual file, as a volume?"}, {"owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "reply_to_user": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1545136467, "post_id": 53832498, "comment_id": 94514377, "body": "i&#39;m mounting the directory. It is not only happening with docker container but also happening with the simple binary also. I can also help with strace if you want."}, {"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1545136552, "post_id": 53832498, "comment_id": 94514417, "body": "Sounds like you can eliminate docker and kubernetes from the question tags since the problem is unrelated to that."}, {"owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "reply_to_user": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1545136850, "post_id": 53832498, "comment_id": 94514589, "body": "Ok, thank you. I added with the thought that if others having same use case, they may find this kind of issues but i&#39;ve removed it as per your suggestion."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545143100, "post_id": 53832498, "comment_id": 94518236, "body": "You really need a distributed locking solution here - Consul, etcd, Zookeeper, Redis, looks like Kubernetes may have something built-in, and I see this embedded distributed locking option (though I haven&#39;t tried it) <a href=\"https://blog.minio.io/minio-dsync-a-distributed-locking-and-syncing-package-for-go-ca2c72dcc359\" rel=\"nofollow noreferrer\">blog.minio.io/&hellip;</a>"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545151534, "post_id": 53832498, "comment_id": 94523170, "body": "I think a distributed locking solution is quite some overkill here. A simple NFS share and a lock does it and is at hand more often than not. Even quite enterprisy software like Karaf uses this mechanism. What I find strange is that it works for me: <a href=\"https://gist.github.com/mwmahlberg/a84afb5e85c31932b3a6b4a4378d3ab5\" rel=\"nofollow noreferrer\">gist.github.com/mwmahlberg/a84afb5e85c31932b3a6b4a4378d3ab5</a>"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545152062, "post_id": 53832498, "comment_id": 94523482, "body": "Hmm, could it be that you are on Windows? Because I tested on Mac and Linux..."}, {"owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "edited": false, "score": 0, "creation_date": 1545195950, "post_id": 53832498, "comment_id": 94537404, "body": "thank you all for your responses. I&#39;m running it on Linux, my simple program works as expected but when i add the above code to my application code things start behaving mysteriously."}], "owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545136717, "creation_date": 1545134170, "last_edit_date": 1545136717, "question_id": 53832498, "link": "https://stackoverflow.com/questions/53832498/how-to-block-duplicate-process", "title": "How to block duplicate process?", "body": "<p>I have been working on a workaround so that if a container is started and meanwhile a duplicate container is started, so it should not proceed to run rather blocked until first container get exited successfully. To achieve this i used <a href=\"https://godoc.org/golang.org/x/sys/unix#Flock\" rel=\"nofollow noreferrer\">flock</a> but this certainly is not helping me, it works sometimes, i.e, One container aquire flock while another get blocked on it but sometimes both aquire flock and proceed to run. My use case is other container should wait until other container get exited successfully. Here is the code i'm using:</p>\n\n<pre><code>// Flock locks the jiva.lock file. If the file does not exist, it is                                                                                   \n// created. If a new process is trying to access the same file it will                                                                                 \n// return an error \"resource temporarily unavailable\".                                                                                                 \nfunc Flock(dir string) error {                                                                                                                         \n     logrus.Info(\"Take flock on jiva.lock file\")                                                                                                        \n     file, err := os.OpenFile(dir+\"/jiva.lock\", os.O_CREATE|os.O_RDWR, 0644)                                                                            \n     if err != nil {                                                                                                                                    \n        return err                                                                                                                                     \n     }\n     // golang.org/x/sys/unix                                                                                                                                                 \n     err = unix.Flock(int(file.Fd()), unix.LOCK_EX|unix.LOCK_NB)                                                                                        \n     if err != nil {                                                                                                                                    \n        file.Close()                                                                                                                                   \n        return fmt.Errorf(\"Failed to flock, error: %v\", err)                                                                                           \n     }                                                                                                                                                  \n     logrus.Infof(\"flock successful on file: %v\", file.Name())                                                                                          \n     return nil                                                                                                                                         \n}\n</code></pre>\n\n<p>I'm using bind mount so that the file <code>jiva.lock</code> is get shared bw two containers. This is not working even if i'm running the binaries directly on my system and in docker container most of the time in both cases.I also tried to debug it with strace but it also shows that both have acquired flock successfully. Any help will be appreciated.</p>\n"}, {"tags": ["go", "buffer", "stdout"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545135032, "post_id": 53831769, "comment_id": 94513588, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7876660/how-to-turn-off-buffering-of-stdout-in-c\">How to turn off buffering of stdout in C</a>"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545135095, "post_id": 53831769, "comment_id": 94513627, "body": "Your problem is on the C side, not in the Go program. Call <a href=\"https://linux.die.net/man/3/fflush\" rel=\"nofollow noreferrer\">fflush</a> after each print, for instance."}, {"owner": {"reputation": 165, "user_id": 1466033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f4fcec44a1b3937efa4faefacd5a4f69?s=128&d=identicon&r=PG", "display_name": "dtoch", "link": "https://stackoverflow.com/users/1466033/dtoch"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545135812, "post_id": 53831769, "comment_id": 94513997, "body": "Same binary when ran from shell normally writes to console every &#39;i&#39;."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545136060, "post_id": 53831769, "comment_id": 94514144, "body": "TTYs are different. Run <code>.&#47;infcount | cat</code> and you see the same behaviour as in Go. Assign <code>os.Stdout</code> to <code>cmd.Stdout</code> and you see the same behaviour as in the terminal (without <code>cat</code>)."}, {"owner": {"reputation": 165, "user_id": 1466033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f4fcec44a1b3937efa4faefacd5a4f69?s=128&d=identicon&r=PG", "display_name": "dtoch", "link": "https://stackoverflow.com/users/1466033/dtoch"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545137372, "post_id": 53831769, "comment_id": 94514870, "body": "Actually I don&#39;t need to write output of &#39;infcount&#39; to stdout of my util, I need to parse strings produced by &#39;infcount&#39;, so this assignment is not very useful. Is there way to change tty setting without secondary program modification?"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 1466033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f4fcec44a1b3937efa4faefacd5a4f69?s=128&d=identicon&r=PG", "display_name": "dtoch", "link": "https://stackoverflow.com/users/1466033/dtoch"}, "edited": false, "score": 0, "creation_date": 1545230322, "post_id": 53836544, "comment_id": 94554326, "body": "stdbuf is what I&#39;m looking for. Thanks! No another &#39;go-way&#39; resolve?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 165, "user_id": 1466033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f4fcec44a1b3937efa4faefacd5a4f69?s=128&d=identicon&r=PG", "display_name": "dtoch", "link": "https://stackoverflow.com/users/1466033/dtoch"}, "edited": false, "score": 0, "creation_date": 1545290655, "post_id": 53836544, "comment_id": 94575623, "body": "As the article linked above explains, the problem is with the flushing behaviour in the external program.  stdbuf modifies the libraries that the external program uses."}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 0, "last_activity_date": 1545147915, "creation_date": 1545147915, "answer_id": 53836544, "question_id": 53831769, "link": "https://stackoverflow.com/questions/53831769/catch-buffered-stdout-output-of-exec-command/53836544#53836544", "title": "Catch buffered stdout output of exec.Command", "body": "<p>version of your C program that will track the output as it happens </p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;stddef.h&gt;\n\n    int main() {\n\n        int i = 0;\n\n        while(i &lt; 10) {\n            printf(\"i = %i\\n\", i++);\n            usleep(2000000);\n            fflush(stdout);\n        }\n        return 0;\n    }\n</code></pre>\n\n<p>If it is an existing precompiled program then <code>stdbuf</code> may be able to fix it, see <a href=\"https://www.perkin.org.uk/posts/how-to-fix-stdio-buffering.html\" rel=\"nofollow noreferrer\">https://www.perkin.org.uk/posts/how-to-fix-stdio-buffering.html</a></p>\n"}], "owner": {"reputation": 165, "user_id": 1466033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f4fcec44a1b3937efa4faefacd5a4f69?s=128&d=identicon&r=PG", "display_name": "dtoch", "link": "https://stackoverflow.com/users/1466033/dtoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545147915, "creation_date": 1545131506, "last_edit_date": 1545135897, "question_id": 53831769, "link": "https://stackoverflow.com/questions/53831769/catch-buffered-stdout-output-of-exec-command", "title": "Catch buffered stdout output of exec.Command", "body": "<p>I'm trying to catch output of external program. Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stddef.h&gt;\n\nint main() {\n\n    int i = 0;\n\n    while(i &lt; 10) {\n        printf(\"i = %i\\n\", i++);\n        usleep(2000000);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>And here is my main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"io\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc reecho(closer io.ReadCloser)  {\n    reader := bufio.NewReader(closer)\n\n    for {\n        s, e := reader.ReadString('\\n')\n        if e != nil {\n            log.Println(e)\n            break\n        }\n        log.Println(s)\n    }\n}\n\nfunc main() {\n    cmd := exec.Command(\"./infcount\")\n    log.Println(\"starting \", cmd)\n    stdout, err := cmd.StdoutPipe()\n    stderr, _ := cmd.StderrPipe()\n\n    if err != nil {\n        log.Fatal(err)\n    }\n    if err := cmd.Start(); err != nil {\n        log.Fatal(err)\n    }\n\n    go reecho(stdout)\n    go reecho(stderr)\n\n    if err := cmd.Wait(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>The problem is buffering of stdout. \"reecho\" get data only when 4096 bytes in stdout buffer or program is exiting(for my short example). Is there way to decrease size of buffer to catch every line of output?</p>\n\n<p>Update: Same binary 'infcount' works fine when ran from shell. It writes every 'i' to the screen.</p>\n"}, {"tags": ["go", "interface", "casting"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1545128940, "post_id": 53830945, "comment_id": 94510337, "body": "<a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 4, "creation_date": 1545128945, "post_id": 53830945, "comment_id": 94510339, "body": "Check the <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability rules</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1545133425, "post_id": 53830945, "comment_id": 94512778, "body": "The setup in the question does not match the types in the maps.  The setup shows that  a <code>*Source</code> can be assigned to an <code>interface{}</code>. To match the types in the maps, the setup should should show that a <code>*Source</code> can be assigned to a <code>*interface{}</code>.  This is not allowed.  In any case, see FAQ entry linked in first comment."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 1, "creation_date": 1545136110, "post_id": 53830945, "comment_id": 94514174, "body": "note that <code>interface{}</code> is already a pointer type"}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1545151034, "post_id": 53830945, "comment_id": 94522886, "body": "@ThunderCat true, thanks for the tip"}, {"owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "edited": false, "score": 0, "creation_date": 1545168503, "post_id": 53830945, "comment_id": 94530881, "body": "I would really like to understand the down and close votes. The question is fairly answered by the golang FAQ but it is certainly not off-topic..."}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": false, "score": 0, "last_activity_date": 1545129519, "creation_date": 1545129519, "answer_id": 53831188, "question_id": 53830945, "link": "https://stackoverflow.com/questions/53830945/why-doesnt-mapinterface-take-mapspecificinterface/53831188#53831188", "title": "Why doesn&#39;t map[]interface{} take map[]SpecificInterface", "body": "<p>Because <code>map[]interface{}</code> and <code>map[]SpecificInterface</code> are 2 different types.\nIf you make your generic type as an empty interface it can work.</p>\n\n<pre><code>var generic interface{}\nspecific := make(map[string]*Source)\n\ngeneric = specific\n</code></pre>\n\n<p>But if you do so, you need to do some type switch or type assertion, when you want to work with your map.</p>\n"}, {"tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": false, "score": 0, "last_activity_date": 1545129967, "creation_date": 1545129967, "answer_id": 53831325, "question_id": 53830945, "link": "https://stackoverflow.com/questions/53830945/why-doesnt-mapinterface-take-mapspecificinterface/53831325#53831325", "title": "Why doesn&#39;t map[]interface{} take map[]SpecificInterface", "body": "<p>Because Go is a static type language , although interface{} and Source have the same underlying type , they can't be assigned to one another without a conversion.<br>\nThus you have to do a conversion in a loop :    </p>\n\n<pre><code>generic := make(map[string]interface{})\nspecific := make(map[string]*Source)\n\nfor k, v := range specific {\n    generic[k] = v\n}\n</code></pre>\n\n<p>Did you notice I changed *interface{} to interface{} ?\nThat's another problem of your code , in Go pointer to interface{} has not meaning.</p>\n"}, {"tags": [], "owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "is_accepted": false, "score": 0, "last_activity_date": 1550151409, "creation_date": 1550151409, "answer_id": 54691726, "question_id": 53830945, "link": "https://stackoverflow.com/questions/53830945/why-doesnt-mapinterface-take-mapspecificinterface/54691726#54691726", "title": "Why doesn&#39;t map[]interface{} take map[]SpecificInterface", "body": "<p>While not directly answering the question it seems that the go community is slowly starting changing its mind and started thinking about supporting generics for Go2: <a href=\"https://go.googlesource.com/proposal/+/master/design/go2draft-generics-overview.md\" rel=\"nofollow noreferrer\">https://go.googlesource.com/proposal/+/master/design/go2draft-generics-overview.md</a> </p>\n"}], "owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1550151409, "creation_date": 1545128696, "last_edit_date": 1545141080, "question_id": 53830945, "link": "https://stackoverflow.com/questions/53830945/why-doesnt-mapinterface-take-mapspecificinterface", "title": "Why doesn&#39;t map[]interface{} take map[]SpecificInterface", "body": "<p>The go spec states:</p>\n\n<blockquote>\n  <p>A variable of interface type can store a value of any type with a method set that is any superset of the interface.</p>\n</blockquote>\n\n<p>As such I can</p>\n\n<pre><code>type Source interface{}\ntype SourceImpl struct{}\n\nvar s Source\ng := new(interface{})\ns = new(SourceImpl)\n\n*g = s\n</code></pre>\n\n<p>However, I cannot to the same with maps:</p>\n\n<pre><code>generic := make(map[string]*interface{})\nspecific := make(map[string]*Source)\n\ngeneric = specific\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>cannot use specific (type map[string]*Source) as type map[string]*interface {} in assignment\n</code></pre>\n\n<p>Why is that? Can map of specific types be passed/assigned to map of generic types without using type assertion?</p>\n"}, {"tags": ["javascript", "go", "binary", "int", "modulo"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545128389, "post_id": 53830476, "comment_id": 94509961, "body": "<i>&quot;the ToNumber is applied to the value that is not a string.&quot;</i> You misunderstood, the linked answer states that ToNumber is applied to the <i>left</i> value. The left value is <code>&#39;13&#39;</code> a string."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545128507, "post_id": 53830476, "comment_id": 94510056, "body": "@mkopriva : Ok, thanks. But in that case, it is &quot;the same&quot; right ? The string is converted into a Number."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545128887, "post_id": 53830476, "comment_id": 94510304, "body": "You are interpreting the string in base 2 in Go, but in base 10 in JavaScript. Also, <a href=\"https://golang.org/pkg/math/big/#Int.Int64\" rel=\"nofollow noreferrer\">Int.Int64</a> says &quot;if x cannot be represented in an int64, the result is undefined&quot;. Your number is much bigger than 64 bit in base 2."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545129066, "post_id": 53830476, "comment_id": 94510411, "body": "@Peter : If I change <code>new(big.Int).SetString(value, 2)</code> from <code>2</code> to <code>10</code>, it is not working for the first example (that is working with base 2), any <code>0</code> is added whereas <code>4</code> should be added."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545130038, "post_id": 53830476, "comment_id": 94510973, "body": "You are dealing with numbers that are much bigger than 64 bit here. Who knows what JavaScript does with that (I seem to remember that you can only use 32 bits accurately, but these numbers are too big in any case). You are trying to replicate JavaScript&#39;s undefined behaviour in Go. That&#39;s just futile."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545130212, "post_id": 53830476, "comment_id": 94511076, "body": "@Peter : I am trying, the best I can, to translate a code of a very permissive langage into Go. I perfectly know that I am not on the right direction, this is why I need help here, I just discovered <code>math&#47;big</code> when trying to translate it."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545137922, "post_id": 53830476, "comment_id": 94515193, "body": "@Peter : I also took a look at this : <a href=\"https://stackoverflow.com/questions/307179/what-is-javascripts-highest-integer-value-that-a-number-can-go-to-without-losin\" title=\"what is javascripts highest integer value that a number can go to without losin\">stackoverflow.com/questions/307179/&hellip;</a> and even if I understand the limitation, I can&#39;t stop thinking that there should be a way to get the same result from one langage to another."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545140812, "post_id": 53830476, "comment_id": 94516916, "body": "There is no single solution that always works, because what JS does is implementation dependent. For instance, <a href=\"https://www.ecma-international.org/ecma-262/6.0/#sec-parseint-string-radix\" rel=\"nofollow noreferrer\">parseInt</a> says, &quot;if [the radix] is 10 and [your number string] contains more than 20 significant digits, every significant digit after the 20th may be replaced by a 0 digit, at the option of the implementation&quot;. So you really have to figure out what your JS engine does and replicate that in Go. You won&#39;t find matching functions in the standard library."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545141011, "post_id": 53830476, "comment_id": 94517044, "body": "@Peter : Thanks, I get it now. I will take a look at the global view of the script to see if I can implement this little function in another way. Maybe it works for him in JS but it is totally lucky"}], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545137014, "creation_date": 1545127046, "last_edit_date": 1545137014, "question_id": 53830476, "link": "https://stackoverflow.com/questions/53830476/string-modulo-int-from-javascript-to-go", "title": "String modulo Int from Javascript to Go", "body": "<p>I am trying to translate this code from Javascript to Go.</p>\n\n<pre><code>if(secret_binary % secret_alphabet_bitlength &gt; 0) {\n    secret_binary += zeropad(\"0\", secret_alphabet_bitlength - (secret_binary % secret_alphabet_bitlength));\n}\n</code></pre>\n\n<p>secret_binary is a <code>string</code> (representing a binary).<br>\nsecret_alphabet_bitlength is an <code>int</code> (<code>6</code> to be precise).</p>\n\n<p>Note : zeropad function is just adding the number of <code>0</code> needed. I replace it by the <code>for</code> loop that you can see below.</p>\n\n<p>From what I understood in this topic <a href=\"https://stackoverflow.com/questions/17140073/remainder-modulus-of-string-is-a-number\">Remainder/Modulus of string is a number</a>, the <code>ToNumber</code> is applied to the value that is not a string.</p>\n\n<p>Fine, that is what I tried.</p>\n\n<pre><code>bToBig, _ := new(big.Int).SetString(secretBinary, 2)\nnb := int64(secretAlphabetBitLength) - (bToBig.Int64() % int64(secretAlphabetBitLength))\nif bToBig.Int64()%int64(secretAlphabetBitLength) &gt; 0 {\n    for i := 0; int64(i) &lt; nb; i++ {\n        secretBinary += \"0\"\n    }\n}\n</code></pre>\n\n<p>This <code>000001001100010000000001000111000001000000</code> is becoming <code>0000010011000100000000010001110000010000000000</code> for both the Javascript code and the Golang one. So it is \"working\", if I can say so. </p>\n\n<p>But, this <code>001011001001000100001110000001010000010000000101000100000000000010011001000000010000001001010010000001010100000101010011000000</code> should become <code>0010110010010001000011100000010100000100000001010001000000000000100110010000000100000010010100100000010101000001010100110000000000</code> according to the Javascript code but here is what I get <code>00101100100100010000111000000101000001000000010100010000000000001001100100000001000000100101001000000101010000010101001100000000</code> (only two zeros are added instead of 4)</p>\n\n<p>I do not know what to do, I tried to parse the string into INT, HEXA, BINARY, OCTAL, etc.. nothing work.</p>\n"}, {"tags": ["pointers", "go", "error-handling"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1545127110, "post_id": 53830404, "comment_id": 94509163, "body": "That&#39;s because non-pointer types do not include methods of pointer types in their method set: <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Method_sets</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545143595, "post_id": 53833853, "comment_id": 94518534, "body": "It will automatically reference one for you, if it can, but only for a method call, not for the purpose of satisfying an interface."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1545138876, "creation_date": 1545138876, "answer_id": 53833853, "question_id": 53830404, "link": "https://stackoverflow.com/questions/53830404/why-my-custom-error-type-causes-error-with-specific-pattern/53833853#53833853", "title": "why my custom error type causes error with specific pattern?", "body": "<p>Go will automatically dereference a pointer for you (pattern 2), however it won't automatically reference one for you. See <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Method_values</a> for more information.</p>\n"}], "owner": {"reputation": 211, "user_id": 6574720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LFYPh5YsBno/AAAAAAAAAAI/AAAAAAABLKk/RRTCLVMjJGM/photo.jpg?sz=128", "display_name": "Shota Tamura", "link": "https://stackoverflow.com/users/6574720/shota-tamura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1545210786, "answer_count": 1, "score": -1, "last_activity_date": 1545140396, "creation_date": 1545126831, "last_edit_date": 1545140396, "question_id": 53830404, "link": "https://stackoverflow.com/questions/53830404/why-my-custom-error-type-causes-error-with-specific-pattern", "closed_reason": "Duplicate", "title": "why my custom error type causes error with specific pattern?", "body": "<p>I'm struggling with go's receivers and pointers.\nI found that 4th pattern causes error.\nWhy this pattern causes error and what's the difference?\nThanks in advance.</p>\n\n<pre><code>type MyError struct{}\n\n// OK pattern\nfunc (e MyError) Error() string {\n    return \"something bad happened\"\n}\n\nfunc run() error {\n    return MyError{}\n}\n\n// OK pattern\nfunc (e MyError) Error() string {\n    return \"something bad happened\"\n}\n\nfunc run() error {\n    return &amp;MyError{}\n}\n\n// OK pattern\nfunc (e *MyError) Error() string {\n    return \"something bad happened\"\n}\n\nfunc run() error {\n    return &amp;MyError{}\n}\n\n// BAD pattern\nfunc (e *MyError) Error() string {\n    return \"something bad happened\"\n}\n\nfunc run() error {\n    return MyError{}\n}\n</code></pre>\n"}, {"tags": ["java", "go", "base64", "slice", "bigint"], "comments": [{"owner": {"reputation": 15577, "user_id": 773616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8e25c0ca4bf25113bd9c0ccc5d118164?s=128&d=identicon&r=PG", "display_name": "Gunnar", "link": "https://stackoverflow.com/users/773616/gunnar"}, "edited": false, "score": 1, "creation_date": 1545166036, "post_id": 53829120, "comment_id": 94529996, "body": "If you are in control of the Debezium source connector, you also may set the &quot;decimal.handling.mode&quot; option to &quot;double&quot; or &quot;string&quot; (depending on the connector you&#39;re using) which might simplify consumption of the numeric values."}], "answers": [{"comments": [{"owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "edited": false, "score": 0, "creation_date": 1545144571, "post_id": 53830899, "comment_id": 94519112, "body": "thank you for answer it very helpful we did some fixes to improve speed and remove scale <a href=\"https://play.golang.org/p/BFZIKxOAp6-\" rel=\"nofollow noreferrer\">play.golang.org/p/BFZIKxOAp6-</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1545128528, "creation_date": 1545128528, "answer_id": 53830899, "question_id": 53829120, "link": "https://stackoverflow.com/questions/53829120/convert-negative-digit-in-byte-slice-to-int/53830899#53830899", "title": "Convert negative digit in byte slice to int", "body": "<p>Constructor of Java's <a href=\"https://docs.oracle.com/javase/8/docs/api/java/math/BigInteger.html\" rel=\"nofollow noreferrer\"><code>BigInteger</code></a> expects the number in <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">2's complement</a> binary representation, while Go's <a href=\"https://golang.org/pkg/math/big/#Int.SetBytes\" rel=\"nofollow noreferrer\"><code>big.Int.SetBytes()</code></a> expects an unsigned integer value (in big-endian byte order):</p>\n\n<blockquote>\n  <p>SetBytes interprets buf as the bytes of a big-endian <strong>unsigned integer</strong>, sets z to that value, and returns z.</p>\n</blockquote>\n\n<p>What we can do is proceed using <code>Int.SetBytes()</code>, but if the number is negative, we have to transform it to the number the binary data represented in 2's complement. We can tell if it's negative if its first bit is 1 (which is the highest bit of the first byte).</p>\n\n<p>This transformation is simple: if the input is represented using <code>n</code> bytes, construct a number using <code>n+1</code> bytes where the first is <code>1</code>, the rest is <code>0</code> (the max representable number using <code>n</code> bytes plus 1). Subtracting (<a href=\"https://golang.org/pkg/math/big/#Int.Sub\" rel=\"nofollow noreferrer\"><code>Int.Sub()</code></a>) the input from this number will give you the absolute value of the number in 2's complement, so we just have to apply a negative sign on this number: <a href=\"https://golang.org/pkg/math/big/#Int.Neg\" rel=\"nofollow noreferrer\"><code>Int.Neg()</code></a>.</p>\n\n<p>Scale can be applied by dividing (<a href=\"https://golang.org/pkg/math/big/#Int.Div\" rel=\"nofollow noreferrer\"><code>Int.Div()</code></a>) the result by a number being <code>10</code><sup><code>scale</code></sup>. We may construct such a number by appending <code>scale</code> zeros to a <code>1</code>.</p>\n\n<p>Here is a <code>decode()</code> function that does all this. It's not optimized for performance, but it does the job:</p>\n\n<pre><code>func decode(in string, scale int) (out *big.Int, err error) {\n    data, err := base64.StdEncoding.DecodeString(in)\n    if err != nil {\n        return\n    }\n\n    out = new(big.Int).SetBytes(data)\n\n    // Check if negative:\n    if len(data) &gt; 0 &amp;&amp; data[0]&amp;0x80 != 0 {\n        // It's negative.\n        // Convert 2's complement negative to abs big-endian:\n        data2 := make([]byte, len(data)+1)\n        data2[0] = 1\n        temp := new(big.Int).SetBytes(data2)\n        out.Sub(temp, out)\n\n        // Apply negative sign:\n        out.Neg(out)\n    }\n\n    // Apply scale:\n    if scale &gt; 0 {\n        temp, _ := new(big.Int).SetString(\"1\"+strings.Repeat(\"0\", scale), 10)\n        out.Div(out, temp)\n    }\n\n    return\n}\n</code></pre>\n\n<p>Example testing it:</p>\n\n<pre><code>n, err := decode(\"lTBA\", 4)\nfmt.Println(n, err)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/kLO0iuWdFl1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>-700 &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 53830899, "answer_count": 1, "score": 2, "last_activity_date": 1560334245, "creation_date": 1545122244, "last_edit_date": 1560334245, "question_id": 53829120, "link": "https://stackoverflow.com/questions/53829120/convert-negative-digit-in-byte-slice-to-int", "title": "Convert negative digit in byte slice to int", "body": "<p>I need help</p>\n\n<p>Debezium(<a href=\"https://debezium.io/\" rel=\"nofollow noreferrer\">https://debezium.io/</a>) convert decimal digits as integer in base64 string with precision as parameter in json In java it decoded like this example </p>\n\n<pre><code>import java.math.BigDecimal;\nimport java.math.BigInteger;\nimport java.util.Base64;\n\npublic class HelloWorld{\n\n     public static void main(String []args){\n        String encoded = \"lTBA\";\n        int scale = 4;\n        final BigDecimal decoded = new BigDecimal(new BigInteger(Base64.getDecoder().decode(encoded)), scale);\n        System.out.println(decoded);        \n     }\n}\n</code></pre>\n\n<p><code>\"lTBA\" = -700</code></p>\n\n<p>but in Golang I have some troubles in similar example </p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"encoding/base64\"\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    data, _ := base64.StdEncoding.DecodeString(\"lTBA\")\n\n    bigInt := new(big.Int).SetBytes(data).String()\n    fmt.Println(bigInt)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/3Xdq9x6B9V-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3Xdq9x6B9V-</a>\nIt returns <code>9777216</code></p>\n\n<p>Because when I use SetBytes in \"math/big/Int\" it set digit as positive always</p>\n\n<pre><code>// SetBytes interprets buf as the bytes of a big-endian unsigned\n// integer, sets z to that value, and returns z.\nfunc (z *Int) SetBytes(buf []byte) *Int {\n    z.abs = z.abs.setBytes(buf)\n    z.neg = false\n    return z\n}\n</code></pre>\n"}, {"tags": ["go", "testing", "assertion"], "comments": [{"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1545148540, "post_id": 53827272, "comment_id": 94521456, "body": "for those who downvote, can you give a reason why this is downvoted? I dont see this as a trivial question."}], "answers": [{"comments": [{"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1545148488, "post_id": 53827306, "comment_id": 94521417, "body": "I tried a small example. see above. Did not seem to work. Can you show me how to change it?"}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1545148497, "post_id": 53827306, "comment_id": 94521424, "body": "Additionally, what is conditional?"}, {"owner": {"reputation": 551, "user_id": 10554768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0874152f77551e2be38904d25e5822e?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/10554768/robert"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1545159361, "post_id": 53827306, "comment_id": 94527028, "body": "A conditional statement is an if statement. You could do something like this:  if assert.True(x) { //do stuff}"}, {"owner": {"reputation": 551, "user_id": 10554768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0874152f77551e2be38904d25e5822e?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/10554768/robert"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1545238749, "post_id": 53827306, "comment_id": 94559637, "body": "Why do you dismiss my answer without even testing it.  See my original post."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1545259069, "post_id": 53827306, "comment_id": 94568229, "body": "because i tested and it did not work? Can you show me a complete working example?"}, {"owner": {"reputation": 551, "user_id": 10554768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0874152f77551e2be38904d25e5822e?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/10554768/robert"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1545264321, "post_id": 53827306, "comment_id": 94569646, "body": "I added your initial example to my answer."}], "tags": [], "owner": {"reputation": 551, "user_id": 10554768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0874152f77551e2be38904d25e5822e?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/10554768/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1545264392, "last_edit_date": 1545264392, "creation_date": 1545113508, "answer_id": 53827306, "question_id": 53827272, "link": "https://stackoverflow.com/questions/53827272/assertion-failure-triggers-a-function/53827306#53827306", "title": "Assertion failure triggers a function", "body": "<p>According to godoc, assert.True returns a bool, so you could wrap that in a conditional.\n<a href=\"https://godoc.org/github.com/stretchr/testify/assert#True\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/stretchr/testify/assert#True</a></p>\n\n<pre><code>passed := assert.True(t, compute()) // X will be a boolean true or false if the test passed.  \n</code></pre>\n\n<p>You can use this to print maps /whatever like so:</p>\n\n<pre><code>if  passed {\n     pMap()\n} else {\n     // test failed\n}\n</code></pre>\n"}], "owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1545264392, "creation_date": 1545113296, "last_edit_date": 1545148436, "question_id": 53827272, "link": "https://stackoverflow.com/questions/53827272/assertion-failure-triggers-a-function", "title": "Assertion failure triggers a function", "body": "<p>Can I invoke a function when assertion fails?</p>\n\n<p>E.g,</p>\n\n<pre><code>assert.True(t, condition) // invoke a function such as printing a map\n</code></pre>\n\n<p>Update: based on the suggestion, i wrote a small example. But does not seem to work.</p>\n\n<p>assert.go</p>\n\n<pre><code>package main                                                                     \n\nimport _ \"fmt\"                                                                   \n\nfunc compute() bool {                                                            \n  return false                                                                   \n}                                                                                \n</code></pre>\n\n<p>assert_test.go</p>\n\n<pre><code>package main                                                                     \n\nimport (                                                                         \n  \"fmt\"                                                                          \n  \"github.com/stretchr/testify/assert\"                                           \n  \"testing\"                                                                      \n)                                                                                \n\nfunc pMap() {                                                                    \n  amap := map[int]string{                                                        \n    1: \"hello1\",                                                                 \n    2: \"hello2\",                                                                 \n  }                                                                              \n  for i, _ := range amap {                                                       \n    fmt.Println(\"map = \", i)                                                     \n  }                                                                              \n}                                                                                \n\nfunc TestCompute(t *testing.T) {                                                 \n  assert.True(t, compute(), pMap)                                                \n} \n</code></pre>\n\n<p>$go test</p>\n\n<pre><code>--- FAIL: TestCompute (0.00s)\n    assert_test.go:20: \n            Error Trace:    assert_test.go:20\n            Error:          Should be true\n            Test:           TestCompute\n            Messages:       0x631a30\nFAIL\nexit status 1\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 0, "creation_date": 1545116428, "post_id": 53827756, "comment_id": 94504115, "body": "If I use link, How to handle error returned as json from the <code>Verify</code> middleware?. If it return error, page will be redirected to blank page with only json response on it."}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": false, "score": 1, "last_activity_date": 1545116005, "creation_date": 1545116005, "answer_id": 53827756, "question_id": 53827245, "link": "https://stackoverflow.com/questions/53827245/direct-to-new-page-inside-middleware-in-golang/53827756#53827756", "title": "Direct to new page inside middleware in Golang", "body": "<p>If you will to change the page, then AJAX isn't what you want. Instead of sending an AJAX request to the API, you should redirect the browser to that API using one of the following methods for example:</p>\n\n<p>HTML :</p>\n\n<pre><code>&lt;a href=\"url/to/my/api\"&gt;Go To page&lt;/a&gt;\n</code></pre>\n\n<p>Javascript:</p>\n\n<pre><code>window.location = \"url/to/my/api\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 0, "creation_date": 1545120008, "post_id": 53828289, "comment_id": 94505588, "body": "What should I do with the handler I passed into the middleware <code>h http.HandlerFunc</code> ?, the handler do nothing inside middleware?"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 1, "creation_date": 1545121698, "post_id": 53828289, "comment_id": 94506327, "body": "It depends. If the new URL is dynamic, <code>newpageHandler</code> could render a json result with the new url. The javascript would have to evaluate that result and dynamically set the location to the received URL. If the URL is static, the javascript could already know about the URL. Then the <code>newpageHandler</code> func won&#39;t be needed any more."}, {"owner": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 0, "creation_date": 1545128768, "post_id": 53828289, "comment_id": 94510226, "body": "How to pass data from the <code>Verify</code> to the template handler?, I have many data that need to be passed from the <code>Verify</code> middleware to the new page, I should not pass the data through the url params in <code>windows.location</code> since the data should not be shown."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 1, "creation_date": 1545129293, "post_id": 53828289, "comment_id": 94510556, "body": "The ideal situation would be, that you do not need to pass data to the handler. The verification could be independent from the actual handler. A general verification (a middleware should be general) should only verify and not mutate any state. If you really have to pass data you can use the request&#39;s context. You can add data to the context and read it in the handler. In this way, you do not have to change the handler&#39;s signature. There is an official blog post: <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">blog.golang.org/context</a> A word of warning though. Use the context sparingly and only if it makes sense globally."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 0, "creation_date": 1545129414, "post_id": 53828289, "comment_id": 94510625, "body": "For what use cases do you want to pass data to the handler?"}, {"owner": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 0, "creation_date": 1545132444, "post_id": 53828289, "comment_id": 94512284, "body": "So, before opening that new page, I need to verify some. If verification return error or false, it will return json with error message to ajax call and opening the new page won&#39;t happen. If the verification pass, the result is data that need to be passed to the html templates and new page open with the data being passed inside the new page."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 0, "creation_date": 1545133031, "post_id": 53828289, "comment_id": 94512599, "body": "This is correct for the error case. For your success case: It depends. If you do client side rendering, then you are correct. You could pass the new URL as JSON and set window.location in JavaScript."}], "tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1545118492, "creation_date": 1545118492, "answer_id": 53828289, "question_id": 53827245, "link": "https://stackoverflow.com/questions/53827245/direct-to-new-page-inside-middleware-in-golang/53828289#53828289", "title": "Direct to new page inside middleware in Golang", "body": "<p>AJAX calls will follow redirects implicitly. Alas, there is no way to prevent that. So, using <code>http.Redirect</code> is not a good option.</p>\n\n<p>You could signal in your Verify func if the request was accepted or not. This can be easily done with http status codes. If everything was all right, you could return a 2xx code. In case of some error, you could return a 4xx code.</p>\n\n<pre><code>func Verify(h http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n\n        //verify everything here. verifcationFunc() returns a bool\n        if verifcationFunc() {\n          w.WriteHeader(http.StatusOK)\n        } else {\n          w.WriteHeader(http.StatusUnauthorized)\n        }\n    }\n}\n</code></pre>\n\n<p>You can now evaluate the returned status code in your JavaScript. On a 200 you can set the new location in JavaScript. This can be done with <code>window.location</code>. On a 401 code (in the example above) you can output an error message.</p>\n"}], "owner": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545118492, "creation_date": 1545113200, "last_edit_date": 1545116746, "question_id": 53827245, "link": "https://stackoverflow.com/questions/53827245/direct-to-new-page-inside-middleware-in-golang", "title": "Direct to new page inside middleware in Golang", "body": "<p>Let's say I have a button which will open a new page. This button's action is handled by an AJAX call to Golang API. This Golang API is wrapped by a middleware, <code>Verify</code>, which will verify everything before directing to that page. The page defined in the function passed into the middleware is using Golang HTML template.</p>\n\n<pre><code>router.GET(\"/newpage\", Verify(newpageHandler))\n\nfunc Verify(h http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n\n        //verify everything here\n        //if all verify, call newpageHandler to redirect to new page\n        h.ServeHTTP(w,r)\n    }\n}\n\nfunc newpageHandler(w http.ResponseWriter, r *http.Request) {\n    //this handler will process the html template\n}\n</code></pre>\n\n<p>When I click the button (AJAX call to the <code>/newpage</code>), it doesn't open the new page, but only returns the HTML content from <code>newpageHandler</code> handler. I can see the HTML returned from the browser's developer tools, but it doesn't get that new page defined in <code>newpageHandler</code>. </p>\n\n<p>Is it okay to use <code>http.Redirect</code>?</p>\n"}, {"tags": ["postgresql", "docker", "go", "docker-compose"], "comments": [{"owner": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "edited": false, "score": 0, "creation_date": 1545109576, "post_id": 53826324, "comment_id": 94501962, "body": "What&#39;s in the <code>.&#47;init</code> directory?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545120676, "post_id": 53826324, "comment_id": 94505896, "body": "That doesn&#39;t look like a valid postgres connection string. Gorm uses lib/pq to connect to postgres so take a look at its documentation to see how the connection string should be formatted (<a href=\"https://godoc.org/github.com/lib/pq\" rel=\"nofollow noreferrer\">godoc.org/github.com/lib/pq</a>). Its either space separated key-value pairs or a url, ie no ampersands."}], "answers": [{"comments": [{"owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "reply_to_user": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "edited": false, "score": 0, "creation_date": 1545162200, "post_id": 53829875, "comment_id": 94528279, "body": "First try to change postgres image"}], "tags": [], "owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "is_accepted": false, "score": 0, "last_activity_date": 1545125127, "creation_date": 1545125127, "answer_id": 53829875, "question_id": 53826324, "link": "https://stackoverflow.com/questions/53826324/could-not-detect-default-username-please-provide-one-explicitly/53829875#53829875", "title": "Could not detect default username. Please provide one explicitly", "body": "<p>Try this:</p>\n\n<pre><code>version: '3'\nservices:\n  postgres:\n    image: kartoza/postgis:9.6-2.4\n    ports:\n      - \"5432:5432\"\n    environment:\n      POSTGRES_USER: developer\n      POSTGRES_DBNAME: somedb\n      POSTGRES_PASS: somepass\n    volumes:\n      - $HOME/data/postgres:/var/lib/postgresql/data\n</code></pre>\n\n<p>config for database in yaml</p>\n\n<pre><code>sqlBind := fmt.Sprintf(\"user=%s password=%s dbname=%s sslmode=disable\",\n    \"developer\",\n    \"somepass\",\n    \"somedb\",\n)\n</code></pre>\n"}], "owner": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545144684, "creation_date": 1545106600, "last_edit_date": 1545144684, "question_id": 53826324, "link": "https://stackoverflow.com/questions/53826324/could-not-detect-default-username-please-provide-one-explicitly", "title": "Could not detect default username. Please provide one explicitly", "body": "<p>Getting this error when conneccting golang container to postgres.  </p>\n\n<blockquote>\n  <p>pq: Could not detect default username. Please provide one explicitly</p>\n</blockquote>\n\n<p>I have tried many usernames and password combinations with no luck.  What username combination should I be using?  </p>\n\n<p>docker-compose code is:</p>\n\n<pre><code>version: '3.6'\nservices:\n  postgres:\n    image: postgres:11.1-alpine\n    ports:\n      - '5432:5432'\n    #network_mode: bridge\n    container_name: postgres\n\n    environment:\n      POSTGRES_USER: 'user'\n      POSTGRES_PASSWORD: 'password'\n      POSTGRESS_DB: 'db_amex01'\n    volumes:\n      - ./init:/docker-entrypoint-initdb.d/\n\n\n  todo:\n    build: ./go_amex/\n    depends_on:\n      - \"postgres\"\n    restart: always\n\n    # ports:\n    #   - \"8000:8080\"\n</code></pre>\n\n<p>./go_amex/main.go</p>\n\n<pre><code>db, err := gorm.Open(\"postgres\", \"host='postgres'&amp;user=user@localhost&amp;port=5432&amp;dbname='todo'&amp;password='password'&amp;sslmode=disable\")\n\nif err != nil {\n    fmt.Println(\"============   exiting ==========\")\n    fmt.Println(err)\n    panic(\"failed to connect database cc\")\n}\n\ndefer db.Close()\n</code></pre>\n\n<p><a href=\"https://github.com/vinceyoumans/v05\" rel=\"nofollow noreferrer\">Github code for the challenge </a></p>\n"}, {"tags": ["ssl", "go"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 2, "creation_date": 1545102197, "post_id": 53825725, "comment_id": 94500459, "body": "I&#39;ve never heard of anybody trying this. Every implementation of STARTTLS I&#39;ve ever seen leaves TLS active for the remainder of the connection, with no way to &quot;turn it off&quot;."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1545103607, "post_id": 53825725, "comment_id": 94500706, "body": "So many questions...  Why not use TLS the whole time?  Why go back to it being off once you&#39;ve turned it on?  How could that ever be a good idea?"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1545116460, "post_id": 53825725, "comment_id": 94504125, "body": "@MichaelHampton: This is for example used in FTPS: It starts with <code>AUTH TLS</code> to upgrade to TLS and then after authentication might switch back to plain traffic with <code>CCC</code> so that any FTP helpers in firewalls can detect <code>PORT</code> commands or response to <code>PASV</code> in order to dynamically open necessary ports for data connection. See <a href=\"https://tools.ietf.org/html/rfc4217#page-19\" rel=\"nofollow noreferrer\">RFC 4217</a>."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1545141083, "post_id": 53825725, "comment_id": 94517099, "body": "@SteffenUllrich OK, now I&#39;ve seen it, and almost wish I hadn&#39;t!"}, {"owner": {"reputation": 1053, "user_id": 234139, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a0efc2a2935cf5a96fc6e4604ffbdd51?s=128&d=identicon&r=PG", "display_name": "jonr", "link": "https://stackoverflow.com/users/234139/jonr"}, "edited": false, "score": 0, "creation_date": 1545152131, "post_id": 53825725, "comment_id": 94523524, "body": "I am interfacing with a pre-existing application that I did not create. I agree the design is strange, but any critique about the design is moot."}], "owner": {"reputation": 1053, "user_id": 234139, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a0efc2a2935cf5a96fc6e4604ffbdd51?s=128&d=identicon&r=PG", "display_name": "jonr", "link": "https://stackoverflow.com/users/234139/jonr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545137860, "creation_date": 1545101068, "last_edit_date": 1545137860, "question_id": 53825725, "link": "https://stackoverflow.com/questions/53825725/how-to-safely-shutdown-ssl-connection", "title": "How to safely shutdown SSL connection", "body": "<p>Using Go, how can a tls.Conn be safely shutdown without entirely closing the underlying connection? I have a working solution, but I am not sure if there is a better way.</p>\n\n<p>In my application I have a non-SSL connection that is eventually 'upgraded' to an SSL connection. Then at some point the SSL connection should be closed cleanly, and the connection should return to the non-SSL version (where unencrypted traffic can be sent between the two parties).</p>\n\n<p>Something like this:</p>\n\n<pre><code>import \"tls\"\nfunc app(connection net.Conn){\n   // process some data on the connection, then eventually change it to SSL\n   ssl = tls.Client(connection, sslConfig) // sslConfig defined elsewhere\n   ssl.Handshake()\n   // process data using ssl for a while\n   // now shut down SSL but maintin the original connection\n   ssl.CloseWrite()\n   // at this point we have sent a closeNotify alert to the remote side and are expecting a closeNotify be sent back to us.\n   // the only way to read the closeNotify is to attempt to read 1 byte\n   b := make([]byte, 1)\n   ssl.Read(b)\n   // assuming the remote side shut down the connection properly, the SSL transport should be finished\n\n   connection.Read(...) // can go back to the unencrypted connection\n}\n</code></pre>\n\n<p>The part I dislike about this is having to make a 1 byte array and read from it just so that the SSL connection can read the notifyClose record.</p>\n\n<p>Is there a better way to cleanly shutdown the SSL connection?</p>\n"}, {"tags": ["go", "pagination", "google-cloud-platform", "google-cloud-bigtable"], "comments": [{"owner": {"reputation": 3152, "user_id": 9146820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d96a2da87bb66419c9bd5e71dbcc94ba?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/9146820/maxim"}, "edited": false, "score": 0, "creation_date": 1545132878, "post_id": 53825393, "comment_id": 94512511, "body": "This post may have what you&#39;re looking for, take a look and let me know it works for you: <a href=\"https://stackoverflow.com/questions/49691823/bigtable-node-client-how-to-set-read-offset-for-pagination\" title=\"bigtable node client how to set read offset for pagination\">stackoverflow.com/questions/49691823/&hellip;</a>"}, {"owner": {"reputation": 53, "user_id": 7196514, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xUZ0o9dDu0I/AAAAAAAAAAI/AAAAAAAAGpc/ShH5_jikgfY/photo.jpg?sz=128", "display_name": "kiran Pendyala", "link": "https://stackoverflow.com/users/7196514/kiran-pendyala"}, "reply_to_user": {"reputation": 3152, "user_id": 9146820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d96a2da87bb66419c9bd5e71dbcc94ba?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/9146820/maxim"}, "edited": false, "score": 0, "creation_date": 1545254197, "post_id": 53825393, "comment_id": 94566347, "body": "thank you maxim but bigtable Go client doesn&#39;t have the readStream interface like the Node client."}], "answers": [{"tags": [], "owner": {"reputation": 694, "user_id": 6621201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c5e363b6ddf26fc346307ec601720a?s=128&d=identicon&r=PG&f=1", "display_name": "Gary Elliott", "link": "https://stackoverflow.com/users/6621201/gary-elliott"}, "is_accepted": true, "score": 5, "last_activity_date": 1545154667, "last_edit_date": 1545154667, "creation_date": 1545153026, "answer_id": 53837977, "question_id": 53825393, "link": "https://stackoverflow.com/questions/53825393/how-does-one-support-pagination-using-bigtable-go-client/53837977#53837977", "title": "how does one support pagination using bigtable Go client?", "body": "<p>You can start a <a href=\"https://godoc.org/cloud.google.com/go/bigtable#Table.ReadRows\" rel=\"noreferrer\">ReadRows</a> operation from <code>userId#startTime</code> to <code>userId#endTime</code> with a <a href=\"https://godoc.org/cloud.google.com/go/bigtable#NewRange\" rel=\"noreferrer\">NewRange</a> and set a limit on the number of rows returned with a <a href=\"https://godoc.org/cloud.google.com/go/bigtable#LimitRows\" rel=\"noreferrer\">LimitRows</a> read option.</p>\n\n<pre><code>err = tbl.ReadRows(ctx, NewRange(\"&lt;userId&gt;#&lt;startTime&gt;\", \"&lt;userId&gt;#&lt;endTime&gt;\"), func(r Row) bool {\n    fmt.Println(\"Got a row\")\n    return true\n}, LimitRows(100))\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7196514, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xUZ0o9dDu0I/AAAAAAAAAAI/AAAAAAAAGpc/ShH5_jikgfY/photo.jpg?sz=128", "display_name": "kiran Pendyala", "link": "https://stackoverflow.com/users/7196514/kiran-pendyala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 53837977, "answer_count": 1, "score": 5, "last_activity_date": 1545154667, "creation_date": 1545098343, "last_edit_date": 1545137640, "question_id": 53825393, "link": "https://stackoverflow.com/questions/53825393/how-does-one-support-pagination-using-bigtable-go-client", "title": "how does one support pagination using bigtable Go client?", "body": "<p>I store time series data in bigtable with a rowKey of userId#timestamp. Given query parameters of (userId, startTime, endTime) how can I support pagination i.e return 'limit' records starting from 'offset' ? </p>\n\n<p>note that userId#startTime rowKey may not exist in bigtable but there will some datapoints before and after startTime/EndTime. Bigtable Go client seems to support ReadRows with a prefixRange argument. I could use a prefixRange of userId and 'seek' to the startTime as I iterate using ReadRows but this seems very inefficient if starTime/endTime is way in the past. is there a better way ??</p>\n"}, {"tags": ["go", "lua", "command-line-interface"], "comments": [{"owner": {"reputation": 121, "user_id": 1861418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cecea3acf86edaea625865079c60241e?s=128&d=identicon&r=PG", "display_name": "odin243", "link": "https://stackoverflow.com/users/1861418/odin243"}, "edited": false, "score": 0, "creation_date": 1545431142, "post_id": 53824727, "comment_id": 94629708, "body": "What are your success/failure conditions? Are you are handling your &quot;failure&quot; conditions within the expect script itself? If you can test for &quot;success&quot; by an observable side effect after the expect script has run, then you could simply test for that side effect after running expect."}], "owner": {"reputation": 1463, "user_id": 1892775, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/a05d3ed9866b27ffd474053d3884394e?s=128&d=identicon&r=PG", "display_name": "user1892775", "link": "https://stackoverflow.com/users/1892775/user1892775"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545092017, "creation_date": 1545092017, "question_id": 53824727, "link": "https://stackoverflow.com/questions/53824727/write-integration-tests-for-go-cli-asking-series-of-questions-answers-for-window", "title": "Write integration tests for Go CLI asking series of questions/answers for Windows", "body": "<p>I have a command line app for windows (that asks a series of questions via command line) developed in Golang and I would like to write integration tests for this app. I looked at <a href=\"https://github.com/zetamatta/expect\" rel=\"nofollow noreferrer\">https://github.com/zetamatta/expect</a>. It can simulate output for each question asked. Example:</p>\n\n<pre><code>expect(\"Enter installer name\")\nsend(\"xxx\\r\")\nexpect(\"Execute it?\")\nsend(\"y\\r\")\n..\n..\n..\n</code></pre>\n\n<p>The golang app does some processing based on the various questions asked and their answers. It does install some stuff. If I were to write integration tests using this package, how does it indicate if it was a pass or a fail?</p>\n\n<p>My lua script is like:</p>\n\n<pre><code>echo(true)\nif spawn([[C:\\test.exe]]) then\n    expect(\"Enter installer name?\")\n    echo(true)\n    send(\"xxx\\r\")\n    expect(\"Install it?\")\n    send(\"y\\r\")\n    expect(\"~]$\")\n    echo(true)\n    send(\"exit\\r\")\nend\n</code></pre>\n\n<p>I execute as:  </p>\n\n<pre><code>expect.exe sample.lua\n</code></pre>\n\n<p>It works fine and automatically takes the above inputs for the questions without having to manually enter any. However, at the end, how do I organize this as a test to show that everything passed successfully or failed. Eventually, I will need to write several tests like that for all possible and negative scenarios.</p>\n"}, {"tags": ["go", "build"], "answers": [{"tags": [], "owner": {"reputation": 508, "user_id": 456010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6945c2fc4180f5be2c54f0dd5bfd42cc?s=128&d=identicon&r=PG", "display_name": "Javier Segura", "link": "https://stackoverflow.com/users/456010/javier-segura"}, "is_accepted": false, "score": 2, "last_activity_date": 1545091297, "creation_date": 1545091297, "answer_id": 53824664, "question_id": 53824516, "link": "https://stackoverflow.com/questions/53824516/how-to-i-build-a-go-package-for-the-current-os-but-output-it-to-a-specified-fold/53824664#53824664", "title": "How to I build a go package for the current OS but output it to a specified folder?", "body": "<p>You can handle the logic of the <code>.exe</code> extension in a script. Something like:</p>\n\n<pre><code>#!/usr/bin/env bash\n\noutput=\"./bin/myproject\"\n\n\nif [ -n \"$GOOS\" ] &amp;&amp; [ \"$GOOS\" = \"windows\" ]; then\n    output+='.exe'\nfi\n\ngo build -o $output main.go\n</code></pre>\n\n<p>If you call it <code>build.sh</code>. You can invoke it:</p>\n\n<pre><code>bash build.sh # for using the `GOOS` defined in your environment\nGOOS=windows bash build.sh # for building windows binaries (with `.exe` extension)\n</code></pre>\n"}], "owner": {"reputation": 3895, "user_id": 4040931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/705151302/picture?type=large", "display_name": "David Alsh", "link": "https://stackoverflow.com/users/4040931/david-alsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1545136788, "creation_date": 1545090016, "last_edit_date": 1545136788, "question_id": 53824516, "link": "https://stackoverflow.com/questions/53824516/how-to-i-build-a-go-package-for-the-current-os-but-output-it-to-a-specified-fold", "title": "How to I build a go package for the current OS but output it to a specified folder?", "body": "<p>When I run <code>go build main.go</code>, the compiler will output a binary for the current OS in that same folder. In this case I would get a <code>main.exe</code> or a <code>main</code> for OSX or Linux.</p>\n\n<p>If I specify an output it will build omit the file extension on Windows machines.</p>\n\n<pre><code>go build -o ./bin/myproject main.go\n</code></pre>\n\n<p>Because of the lack of a file extension, you're unable to run  the outputted binary on Windows without renaming it.</p>\n\n<p>How do I build a go project, specifying the output folder and getting a binary named appropriately for the OS on the other side?</p>\n"}, {"tags": ["go", "mocking"], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 6, "last_activity_date": 1545086079, "creation_date": 1545086079, "answer_id": 53823961, "question_id": 53823871, "link": "https://stackoverflow.com/questions/53823871/how-do-you-mock-a-type-within-a-type-in-golang/53823961#53823961", "title": "How do you mock a type within a type in Golang?", "body": "<p>The problem is that your interface does not match the redis client. If you change the interface to:</p>\n\n<pre><code>type redisClient interface {\n    Eval(string, []string, []string) *redis.Cmd\n}\n</code></pre>\n\n<p>it will compile. That being said, it looks like you really want <code>rediscmd</code>, so you will need to make a wrapper around the redis client:</p>\n\n<pre><code>type wrapper struct{\n  c *redis.Client\n}\n\nfunc (w wrapper) Eval(x sting, y []string, z []string) redisCmd {\n  return w.c.Eval(x,y,z) // This assumes that *redis.Cmd implements rediscmd\n}\n</code></pre>\n"}], "owner": {"reputation": 178, "user_id": 7214923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cafc9020c2aaca8ec2144010e08f3cc0?s=128&d=identicon&r=PG&f=1", "display_name": "GDev", "link": "https://stackoverflow.com/users/7214923/gdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 53823961, "answer_count": 1, "score": 0, "last_activity_date": 1545086079, "creation_date": 1545085510, "last_edit_date": 1545085999, "question_id": 53823871, "link": "https://stackoverflow.com/questions/53823871/how-do-you-mock-a-type-within-a-type-in-golang", "title": "How do you mock a type within a type in Golang?", "body": "<p>The package 'gopkg.in/redis.v3' contains some code</p>\n\n<pre><code>type Client struct {\n}\n\nfunc (*client) Eval (string, []string, []string) *Cmd {\n}\n\ntype Cmd struct {\n}\n\nfunc (*Cmd) Result () (interface{}, error) {\n}\n</code></pre>\n\n<p>Which works successfully in the following way</p>\n\n<pre><code>func myFunc (cli *redis.Client) {\n    result, err := cli.Eval('my script').Result()\n}\n</code></pre>\n\n<p>The problem is that sometimes the Redis cluster gets hammered, has a moment, and the interface returned as a result is nil.</p>\n\n<p>This is reasonably easy to handle but I wish to put a test in place that will ensure that it is actually handled and no type assertion panic occurs.</p>\n\n<p>Traditionally I would insert a mock Redis client into myFunc that can ultimately return nil.</p>\n\n<pre><code>type redisClient interface {\n    Eval(string, []string, []string) redisCmd\n}\n\ntype redisCmd interface {\n    Result() (interface{}, error)\n}\n\nfunc myFunc (cli redisClient) {\n    result, err := cli.Eval('my script').Result()\n}\n</code></pre>\n\n<p>The problem I am facing is the compiler doesn't recognise that redis.Client satisfies the interface redisClient because it doesn't recognise that the redis.Cmd returned from Eval satisfies redisCmd.</p>\n\n<pre><code>&gt; cannot use client (type *redis.Client) as type redisClient in argument to myFunc:\n&gt;    *redis.Client does not implement redisClient (wrong type for Eval method)\n&gt;          have Eval(sting, []string, []string) *redis.Cmd\n&gt;          want Eval(sting, []string, []string) redisCmd\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 1, "creation_date": 1545085732, "post_id": 53823778, "comment_id": 94496649, "body": "Can you elaborate what you mean that it duplicated the command prompt?"}, {"owner": {"reputation": 9, "user_id": 10420968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2117135841871325/picture?type=large", "display_name": "Evan McClure", "link": "https://stackoverflow.com/users/10420968/evan-mcclure"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 1, "creation_date": 1545086069, "post_id": 53823778, "comment_id": 94496779, "body": "Instead of running the code, the command prompt restarts automatically."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 1, "creation_date": 1545086100, "post_id": 53823778, "comment_id": 94496795, "body": "Can you post the contents of main.go?"}, {"owner": {"reputation": 9, "user_id": 10420968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2117135841871325/picture?type=large", "display_name": "Evan McClure", "link": "https://stackoverflow.com/users/10420968/evan-mcclure"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 1, "creation_date": 1545086738, "post_id": 53823778, "comment_id": 94497005, "body": "package main  import ( \t&quot;fmt&quot; \t&quot;html/template&quot; \t&quot;net/http&quot; ) var tpl <i>template.Template  func init(){ \ttemplate.Must(template.ParseGlob(&quot;templates/</i>.html&quot;)) }  func main() { \thttp.HandleFunc(&quot;templates/index&quot;, idx) \thttp.ListenAndServe(&quot;8000&quot;, nil) \tfmt.Println(&quot;hello World&quot;)  }  func idx(w http.ResponseWriter, r *http.Request){ \ttpl.ExecuteTemplate(w, &quot;templates/index.html&quot;, nil) }"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 1, "creation_date": 1545086860, "post_id": 53823778, "comment_id": 94497047, "body": "I moved that to the playground: <a href=\"https://play.golang.org/p/zFDc5BxLduh\" rel=\"nofollow noreferrer\">play.golang.org/p/zFDc5BxLduh</a>"}, {"owner": {"reputation": 9, "user_id": 10420968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2117135841871325/picture?type=large", "display_name": "Evan McClure", "link": "https://stackoverflow.com/users/10420968/evan-mcclure"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545086908, "post_id": 53823778, "comment_id": 94497067, "body": "I created an Edit, Everything is all above!"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545086934, "post_id": 53823778, "comment_id": 94497073, "body": "I&#39;m noticing that its panicing. It seems likely you are not seeing stderr. To test this, can you place <code>fmt.Println(&quot;hello world&quot;)</code> before your <code>template.Must()</code>?"}, {"owner": {"reputation": 9, "user_id": 10420968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2117135841871325/picture?type=large", "display_name": "Evan McClure", "link": "https://stackoverflow.com/users/10420968/evan-mcclure"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545087218, "post_id": 53823778, "comment_id": 94497170, "body": "Perfect! now how do I execute the Html pages?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545087534, "post_id": 53823778, "comment_id": 94497294, "body": "Well what I was suggesting was the panic stack trace would probably show you what is wrong. I&#39;m wondering if you place a stdout println (fmt.Println()) would you see it. If so, then you can figure out why you aren&#39;t seeing the stacktrace."}, {"owner": {"reputation": 9, "user_id": 10420968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2117135841871325/picture?type=large", "display_name": "Evan McClure", "link": "https://stackoverflow.com/users/10420968/evan-mcclure"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545087876, "post_id": 53823778, "comment_id": 94497421, "body": "Alright! thanks a ton! I made a lot of progress thanks to your help!"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545088189, "post_id": 53823778, "comment_id": 94497536, "body": "Good deal. Good luck"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545119888, "post_id": 53823778, "comment_id": 94505525, "body": "Your listen address is invalid. Don&#39;t ignore the error returned by <code>http.ListenAndServe</code>."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1545125792, "post_id": 53829754, "comment_id": 94508432, "body": "&quot;<code>ListenAndServe</code> doesn&#39;t block the further code execution&quot; --- it certainly does, if successful."}], "tags": [], "owner": {"reputation": 487, "user_id": 3004786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mQ3jy.jpg?s=128&g=1", "display_name": "huehnerhose", "link": "https://stackoverflow.com/users/3004786/huehnerhose"}, "is_accepted": false, "score": 0, "last_activity_date": 1545126380, "last_edit_date": 1545126380, "creation_date": 1545124727, "answer_id": 53829754, "question_id": 53823778, "link": "https://stackoverflow.com/questions/53823778/can-anyone-help-me-with-this-goland-terminal-error/53829754#53829754", "title": "Can Anyone help me with this GoLand terminal Error", "body": "<p>Thanks to @zerkms for pointing out, that I was wrong. I simply ran into the exact mistake I tried to warn you later on:</p>\n\n<p>you really should use the err returned by called functions, since these really help you a lot! For startes simply:</p>\n\n<pre><code>err := http.ListenAndServe(\"8000\", nil)\nif err != nil {\n  log.Fatal(err)\n}\n</code></pre>\n\n<p>This panics with:</p>\n\n<pre><code>2018/12/18 10:43:16 listen tcp: address 8000: missing port in address\n</code></pre>\n\n<p>the correct line should be</p>\n\n<pre><code>err := http.ListenAndServe(\":8000\", nil)\n</code></pre>\n\n<p><strong>WRONG</strong> only for documentation </p>\n\n<p><code>ListenAndServe</code> doesn't block the further code execution....</p>\n"}], "owner": {"reputation": 9, "user_id": 10420968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2117135841871325/picture?type=large", "display_name": "Evan McClure", "link": "https://stackoverflow.com/users/10420968/evan-mcclure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593979125, "creation_date": 1545084980, "last_edit_date": 1593979125, "question_id": 53823778, "link": "https://stackoverflow.com/questions/53823778/can-anyone-help-me-with-this-goland-terminal-error", "title": "Can Anyone help me with this GoLand terminal Error", "body": "<p>I'm using GoLand IDE and I'm getting a problem when running my Go web app. The code isn't compiling when the Terminal is used.</p>\n<p>Here is the problem: The terminal duplicated the command prompt when I make an attempt at running the code.</p>\n<pre class=\"lang-none prettyprint-override\"><code>C:\\Users\\Evan\\go\\src\\awesomeProject9&gt;go run main.go\n\nC:\\Users\\Evan\\go\\src\\awesomeProject9&gt;\n</code></pre>\n<pre><code>package main\n\nimport (\n  &quot;fmt&quot;\n  &quot;html/template&quot;\n  &quot;net/http&quot;\n)\n\nvar tpl *template.Template\n\nfunc init(){\n  template.Must(template.ParseGlob(&quot;templates/*.html&quot;))\n}\n\nfunc main() {\n  http.HandleFunc(&quot;templates/index&quot;, idx)\n  http.ListenAndServe(&quot;8000&quot;, nil)\n  fmt.Println(&quot;hello World&quot;)\n}\n\nfunc idx(w http.ResponseWriter, r *http.Request){\n  tpl.ExecuteTemplate(w, &quot;templates/index.html&quot;, nil)\n}\n</code></pre>\n"}, {"tags": ["go", "google-cloud-dataflow", "apache-beam"], "comments": [{"owner": {"reputation": 2427, "user_id": 270797, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26bef0b1ae5672af7f225d6b9ff4ed33?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/270797/tim"}, "edited": false, "score": 0, "creation_date": 1545176851, "post_id": 53823677, "comment_id": 94533553, "body": "Some additional notes: The error has the path <code>&#47;var&#47;opt&#47;google&#47;staged&#47;worker</code> but when I SSH into the VM the only path I can see is <code>&#47;var&#47;opt&#47;google&#47;dataflow&#47;staged&#47;worker</code> - The binary seems to match the expected size but I&#39;m not sure why the paths are different?"}, {"owner": {"reputation": 1854, "user_id": 9457843, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "rsantiago", "link": "https://stackoverflow.com/users/9457843/rsantiago"}, "edited": false, "score": 0, "creation_date": 1569518892, "post_id": 53823677, "comment_id": 102632482, "body": "I installed the <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">version go1.12</a> and I executed the <a href=\"https://beam.apache.org/get-started/quickstart-go/\" rel=\"nofollow noreferrer\">Beam Go SDK Quickstart</a>; it worked. You error could be an issue with version Go 0.5.0 that now it&#39;s fixed, unless your program has a specific code that is causing it.  By the way, Beam SDK for Go is not in the list of programming languages supported by Dataflow, only <a href=\"https://cloud.google.com/dataflow/docs/apis\" rel=\"nofollow noreferrer\">Java, Python and REST are supported</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2427, "user_id": 270797, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26bef0b1ae5672af7f225d6b9ff4ed33?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/270797/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1545191462, "creation_date": 1545191462, "answer_id": 53844335, "question_id": 53823677, "link": "https://stackoverflow.com/questions/53823677/google-cloud-data-flow-jobs-failing-with-error-failed-to-retrieve-staged-files/53844335#53844335", "title": "Google Cloud Data flow jobs failing with error &#39;Failed to retrieve staged files: failed to retrieve worker in 3 attempts: bad MD5...&#39;", "body": "<p>The fix to this issue seems to have been to rebuild the worker_harness_container_image with the latest changes. I had tried this but I didn't have the latest release when I built it locally. After I pulled the latest from the Beam repo, and rebuilt the image (As per the notes here <a href=\"https://github.com/apache/beam/blob/master/sdks/CONTAINERS.md\" rel=\"nofollow noreferrer\">https://github.com/apache/beam/blob/master/sdks/CONTAINERS.md</a>) and reran it seemed to work again.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 4451156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-NN6xAfr-5-8/AAAAAAAAAAI/AAAAAAAAB6k/c3qgAW-HJ14/photo.jpg?sz=128", "display_name": "florianrosenberg", "link": "https://stackoverflow.com/users/4451156/florianrosenberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1547150162, "creation_date": 1547150162, "answer_id": 54136045, "question_id": 53823677, "link": "https://stackoverflow.com/questions/53823677/google-cloud-data-flow-jobs-failing-with-error-failed-to-retrieve-staged-files/54136045#54136045", "title": "Google Cloud Data flow jobs failing with error &#39;Failed to retrieve staged files: failed to retrieve worker in 3 attempts: bad MD5...&#39;", "body": "<p>I'm seeing the same thing. If I look into the Stackdriver logging I see this:</p>\n\n<pre><code>Handler for GET /v1.27/images/apache-docker-beam-snapshots-docker.bintray.io/beam/go:20180515/json returned error: No such image: apache-docker-beam-snapshots-docker.bintray.io/beam/go:20180515\n</code></pre>\n\n<p>However, I can pull the image just fine locally. Any ideas why Dataflow cannot pull. </p>\n"}], "owner": {"reputation": 2427, "user_id": 270797, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26bef0b1ae5672af7f225d6b9ff4ed33?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/270797/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1563911065, "creation_date": 1545084450, "question_id": 53823677, "link": "https://stackoverflow.com/questions/53823677/google-cloud-data-flow-jobs-failing-with-error-failed-to-retrieve-staged-files", "title": "Google Cloud Data flow jobs failing with error &#39;Failed to retrieve staged files: failed to retrieve worker in 3 attempts: bad MD5...&#39;", "body": "<p>SDK: Apache Beam SDK for Go 0.5.0</p>\n\n<p>We are running Apache Beam Go SDK jobs in Google Cloud Data Flow. They had been working fine until recently when they intermittently stopped working (no changes made to code or config). The error that occurs is:</p>\n\n<p><code>Failed to retrieve staged files: failed to retrieve worker in 3 attempts: bad MD5 for /var/opt/google/staged/worker: ..., want ; bad MD5 for /var/opt/google/staged/worker: ..., want ;</code></p>\n\n<p>(Note: It seems as if it's missing a second hash value in the error message message.)</p>\n\n<p>As best I can guess there's something wrong with the worker - It seems to be trying to compare md5 hashes of the worker and missing one of the values? I don't know exactly what it's comparing to though.</p>\n\n<p>Does anybody know what could be causing this issue?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 4, "last_activity_date": 1545079833, "creation_date": 1545079833, "answer_id": 53822804, "question_id": 53822760, "link": "https://stackoverflow.com/questions/53822760/net-http-renders-the-root-route-even-when-i-go-to-a-route-which-doesnt-exist/53822804#53822804", "title": "net/http renders the root route even when I go to a route which doesn&#39;t exist", "body": "<p>From the <a href=\"https://golang.org/pkg/net/http/#ServeMux\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>Note that since a pattern ending in a slash names a rooted subtree,\n  the pattern \"/\" matches all paths not matched by other registered\n  patterns, not just the URL with Path == \"/\".</p>\n</blockquote>\n\n<p>One way to prevent this is to build a handler that looks at the request:</p>\n\n<pre><code>http.HandleFunc(\"/\", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request){\n  if r.URL.Path != \"/\" {\n    w.WriteHeader(http.StatusNotFound)\n    return\n  }\n\n  renderAndExecuteTemplate(w, r, \"page/index.tmpl\", nil)\n})\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 10691978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e8becc69dd0d98b53e959c9489fd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Maddani", "link": "https://stackoverflow.com/users/10691978/maddani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545079833, "creation_date": 1545079594, "question_id": 53822760, "link": "https://stackoverflow.com/questions/53822760/net-http-renders-the-root-route-even-when-i-go-to-a-route-which-doesnt-exist", "title": "net/http renders the root route even when I go to a route which doesn&#39;t exist", "body": "<p>I have these routes:</p>\n\n<pre><code>  http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    renderAndExecuteTemplate(w, r, \"page/index.tmpl\", nil)\n  })\n\n  http.HandleFunc(\"/route1\", func(w http.ResponseWriter, r *http.Request) {\n    renderAndExecuteTemplate(w, r, \"page/route1.tmpl\", nil)\n  })\n\n\n  http.HandleFunc(\"/route2\", func(w http.ResponseWriter, r *http.Request) {\n    renderAndExecuteTemplate(w, r, \"page/route2.tmpl\", nil)\n  })\n</code></pre>\n\n<p>It works.</p>\n\n<p>However, when I go to a route which doesn't exist: \"localhost/fdsafdsafdsfds\", it still renders the \"index\" page. </p>\n\n<p>Why? How to prevent it from that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1545077215, "post_id": 53822012, "comment_id": 94493207, "body": "&quot;Strict&quot; is not an attribute defined in the language spec. So asking whether something is strict or not is not a well defined question. Read about method sets."}], "answers": [{"comments": [{"owner": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "edited": false, "score": 0, "creation_date": 1545077188, "post_id": 53822076, "comment_id": 94493198, "body": "well, if <code>*T</code> contains the method set of <code>T</code> (and vice versa), then why do we need to declare in function <code>*</code> (asterics)? In any case it will work, will it?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "edited": false, "score": 1, "creation_date": 1545077677, "post_id": 53822076, "comment_id": 94493398, "body": "Receiving a pointer instead of a value changes the behavior of the method (e.g. a setter could only work with a pointer receiver). Also, your assumption that it&#39;s &quot;and vice versa&quot; is false and does not come from the spec. In cases where the compiler is able to auto-address a value in order to invoke a method with a pointer receiver, the compiler will do so, but not all values are addressable (e.g. a value stored in a map)."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 4, "last_activity_date": 1545076174, "creation_date": 1545076174, "answer_id": 53822076, "question_id": 53822012, "link": "https://stackoverflow.com/questions/53822012/is-function-declaration-in-go-strict/53822076#53822076", "title": "Is function declaration in Go strict?", "body": "<p><a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">Per the specification</a>:</p>\n\n<blockquote>\n  <p>The method set of any other type T consists of all methods declared with receiver type T. The method set of the corresponding pointer type *T is the set of all methods declared with receiver *T or T (that is, it also contains the method set of T).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "edited": false, "score": 1, "creation_date": 1545077653, "post_id": 53822123, "comment_id": 94493387, "body": "then it doesn&#39;t mater is the object receiver in the function a pointer or not, - Go will pass our instance in anycase and it will work... so why then we need at all use an asterics in the function declaration?"}, {"owner": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "reply_to_user": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "edited": false, "score": 2, "creation_date": 1545077866, "post_id": 53822123, "comment_id": 94493482, "body": "@rozerro A pointer receiver does change the behavior of the <code>func</code>. Note that when you define a non-pointer receiver, Go passes the object <i>by value</i> to the <code>func</code>, i.e. if you make any changes to the receiver, the actual passed object won&#39;t take effect of the changes."}], "tags": [], "owner": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "is_accepted": false, "score": 4, "last_activity_date": 1545076392, "creation_date": 1545076392, "answer_id": 53822123, "question_id": 53822012, "link": "https://stackoverflow.com/questions/53822012/is-function-declaration-in-go-strict/53822123#53822123", "title": "Is function declaration in Go strict?", "body": "<p>Go <code>func</code>s that accept an object <em>receiver</em> (enclosed in parentheses) must not be confused with class methods which are common in OOP languages. Whether you define your instance as a pointer or not, when the <em>receiver</em> is a pointer, Go will pass your instance as a pointer to the <code>func</code>.</p>\n\n<p>P.S. You can even call that <code>func</code> with a <code>nil</code> receiver as:</p>\n\n<pre><code>var p *Persion  // p == nil\np.Introduce()   // Compiler: OK!\n</code></pre>\n"}], "owner": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1569235188, "creation_date": 1545075875, "last_edit_date": 1569235188, "question_id": 53822012, "link": "https://stackoverflow.com/questions/53822012/is-function-declaration-in-go-strict", "title": "Is function declaration in Go strict?", "body": "<p>Why does this code work? The function <code>Introduce()</code> accepts a pointer to <code>Person</code> but when we create <code>p</code>, it is an object (not a pointer).\nSo is function declaration not strict?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    Name string\n}\n\nfunc (p *Person) Introduce() {\n    fmt.Printf(\"Hi, I'm %s\\n\", p.Name)\n}\n\nfunc main() {\n    p := Person{Name: \"Fedya\"}\n    fmt.Println(p)\n    p.Introduce()\n\n    p1 := &amp;Person{Name: \"Fedya\"}\n    fmt.Println(p1)\n    p1.Introduce()\n}\n</code></pre>\n"}, {"tags": ["go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 7471182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b641fcfe096e3206125cd374ab7e481a?s=128&d=identicon&r=PG&f=1", "display_name": "marhaupe", "link": "https://stackoverflow.com/users/7471182/marhaupe"}, "is_accepted": true, "score": 2, "last_activity_date": 1545072945, "creation_date": 1545072945, "answer_id": 53821429, "question_id": 53821346, "link": "https://stackoverflow.com/questions/53821346/how-to-initialize-a-specific-structure-format/53821429#53821429", "title": "How to initialize a specific structure format", "body": "<p>That actually looks right. I'd prefer to remove the <code>proyectos</code> struct definition as it's unnecessary in my opinion - you can just use <code>[]proyecto</code> instead, which looks cleaner.</p>\n\n<p>I hate to be that guy, but your question has already been answered here: <a href=\"https://stackoverflow.com/a/24809404/7471182\">https://stackoverflow.com/a/24809404/7471182</a></p>\n"}], "owner": {"reputation": 804, "user_id": 6875688, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e46e6b2da3f3fc933ea112f88e4a3a1d?s=128&d=identicon&r=PG", "display_name": "Hugo L.M", "link": "https://stackoverflow.com/users/6875688/hugo-l-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1545081679, "accepted_answer_id": 53821429, "answer_count": 1, "score": 1, "last_activity_date": 1545072945, "creation_date": 1545072527, "question_id": 53821346, "link": "https://stackoverflow.com/questions/53821346/how-to-initialize-a-specific-structure-format", "closed_reason": "Duplicate", "title": "How to initialize a specific structure format", "body": "<p>Although I've been using language for more than a couple of months now, I hadn't seen myself with this need. <strong>What I want is to initialize the structure that I show below (basically initialize Project and then, inside, aaa, bbb and ccc structs)</strong>. My question is whether I can really initialize it without making an unmarshall.</p>\n\n<pre><code>type example struct {\n    Name    string `yaml:\"name\" json:\"name\"`\n    Key     string `yaml:\"key\" json:\"key\"`\n    Version string `yaml:\"version\" json:\"version\"`\n    Project []struct {\n        Name string `yaml:\"name\" json:\"name\"`\n        aaa  struct {\n            Name    string `yaml:\"name\" json:\"name\"`\n            Key     string `yaml:\"key\" json:\"key\"`\n            xxx struct {\n                Version string `yaml:\"version\" json:\"version\"`\n            } `yaml:\"xxx\" json:\"xxx\"`\n            zzz struct {\n                Version string `yaml:\"version\" json:\"version\"`\n            } `yaml:\"zzz\" json:\"zzz\"`\n        } `yaml:\"aaa\" json:\"aaa\"`\n        bbb struct {\n            Name    string `yaml:\"name\" json:\"name\"`\n            Key     string `yaml:\"key\" json:\"key\"`\n            xxx struct {\n                Version string `yaml:\"version\" json:\"version\"`\n            } `yaml:\"xxx\" json:\"xxx\"`\n            zzz struct {\n                Version string `yaml:\"version\" json:\"version\"`\n            } `yaml:\"zzz\" json:\"zzz\"`\n        } `yaml:\"bbb\" json:\"bbb\"`\n        ccc struct {\n            Name    string `yaml:\"name\" json:\"name\"`\n            Key     string `yaml:\"key\" json:\"key\"`\n            xxx struct {\n                Version string `yaml:\"version\" json:\"version\"`\n            } `yaml:\"xxx\" json:\"xxx\"`\n            zzz struct {\n                Version string `yaml:\"version\" json:\"version\"`\n            } `yaml:\"zzz\" json:\"zzz\"`\n        } `yaml:\"ccc\" json:\"ccc\"`\n    } `yaml:\"project\" json:\"project\"`\n}\n</code></pre>\n\n<p>I know I could do it in some way similar to the following. But I try to know the language better.</p>\n\n<pre><code>type example struct {\n    Name    string `yaml:\"name\" json:\"name\"`\n    Project proyectos }\n\ntype proyectos structs{\n    [] proyecto\n}\n\ntype proyecto struct{\n    Name string `yaml:\"name\" json:\"name\"`\n    aaa  struct {\n    .....\n} `yaml:\"project\" json:\"project\"`\n</code></pre>\n\n<p>I appreciate anyone who can give me a hint about this with an example. </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1545072146, "post_id": 53821212, "comment_id": 94490986, "body": "I guess the operator precedence in Go is different; try <code>(i==1) &amp;&amp; leap</code>"}, {"owner": {"reputation": 363, "user_id": 8231140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d4e908bd5f6bf08297e6b429cd6cb929?s=128&d=identicon&r=PG&f=1", "display_name": "moh", "link": "https://stackoverflow.com/users/8231140/moh"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1545072412, "post_id": 53821212, "comment_id": 94491088, "body": "i tried still have error"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1545072805, "post_id": 53821212, "comment_id": 94491254, "body": "Oh see also <a href=\"https://stackoverflow.com/questions/8393933/is-there-a-way-to-convert-integers-to-bools-in-go-or-vice-versa\" title=\"is there a way to convert integers to bools in go or vice versa\">stackoverflow.com/questions/8393933/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 8231140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d4e908bd5f6bf08297e6b429cd6cb929?s=128&d=identicon&r=PG&f=1", "display_name": "moh", "link": "https://stackoverflow.com/users/8231140/moh"}, "edited": false, "score": 1, "creation_date": 1545072425, "post_id": 53821270, "comment_id": 94491093, "body": "g_day_no &gt;= g_days_in_month[i] + (i == 1 &amp;&amp; leap != 0)  still give me the error  ``` Invalid operation: g_days_in_month[i] + (i == 1 &amp;&amp; leap != 0) (mismatched types int32 and bool) ```"}, {"owner": {"reputation": 363, "user_id": 8231140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d4e908bd5f6bf08297e6b429cd6cb929?s=128&d=identicon&r=PG&f=1", "display_name": "moh", "link": "https://stackoverflow.com/users/8231140/moh"}, "edited": false, "score": 1, "creation_date": 1545073937, "post_id": 53821270, "comment_id": 94491807, "body": "what about     g_day_no -= g_days_in_month[i] + (i == 1 &amp;&amp; leap)  in inside of loop i did same thing but that dont work there  i did this :   \t\tg_day_no -= g_days_in_month[i] || (i == 1 &amp;&amp; leap != 0)"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 363, "user_id": 8231140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d4e908bd5f6bf08297e6b429cd6cb929?s=128&d=identicon&r=PG&f=1", "display_name": "moh", "link": "https://stackoverflow.com/users/8231140/moh"}, "edited": false, "score": 1, "creation_date": 1545077457, "post_id": 53821270, "comment_id": 94493300, "body": "You will have to take the conditional and move that to an if statement. If the condition is true, subtract 1 from <code>g_day_no</code>."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 1, "last_activity_date": 1545073074, "last_edit_date": 1545073074, "creation_date": 1545072138, "answer_id": 53821270, "question_id": 53821212, "link": "https://stackoverflow.com/questions/53821212/convert-a-loop-with-inner-conditon-from-python-to-go-lang/53821270#53821270", "title": "convert a loop with inner conditon from python to go lang", "body": "<p>Go is more strict about conditions. It requires booleans. <code>leap</code> is an integer, so just check the value:</p>\n\n<p><code>g_day_no &gt;= (g_days_in_month[i] || (i == 1 &amp;&amp; leap!=0))</code></p>\n\n<p><strong>More detailed answer</strong></p>\n\n<p>Booleans (<code>True</code> and <code>False</code>) in Python correspond to the following integer values:</p>\n\n<p><code>True=&gt;1</code>\n<code>False=&gt;0</code></p>\n\n<p>This can be seen with the following:</p>\n\n<pre><code>&gt;&gt;&gt; True+0\n1\n&gt;&gt;&gt; False+0\n0\n</code></pre>\n\n<p>Therefore, when you have two booleans that are being added together, its the same as an <code>OR</code>:</p>\n\n<pre><code>True  + True  =&gt; 2 (True)\nFalse + True  =&gt; 1 (True)\nTrue  + False =&gt; 1 (True)\nFalse + False =&gt; 0 (False)\n</code></pre>\n\n<p>This is the same \"truth table\" as OR:</p>\n\n<p>True  OR True  => True\n   False OR TRUE  => True\n   True  OR False => True\n   FALSE OR FALSE => False</p>\n\n<p>Therefore, change your <code>+</code> to an <code>||</code> (<code>||</code> is <code>OR</code> in Go).</p>\n"}], "owner": {"reputation": 363, "user_id": 8231140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d4e908bd5f6bf08297e6b429cd6cb929?s=128&d=identicon&r=PG&f=1", "display_name": "moh", "link": "https://stackoverflow.com/users/8231140/moh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53821270, "answer_count": 1, "score": 0, "last_activity_date": 1545073074, "creation_date": 1545071859, "question_id": 53821212, "link": "https://stackoverflow.com/questions/53821212/convert-a-loop-with-inner-conditon-from-python-to-go-lang", "title": "convert a loop with inner conditon from python to go lang", "body": "<p>im converting some code from python to go </p>\n\n<p>here i want write equal code in go lang:</p>\n\n<p>python :</p>\n\n<pre><code>while g_day_no &gt;= g_days_in_month[i] + (i == 1 and leap):\n    g_day_no -= g_days_in_month[i] + (i == 1 and leap)\n    i+=1\n</code></pre>\n\n<p>my try:</p>\n\n<pre><code>leap := int32(1)\nvar i = int32(0)\nfor g_day_no &gt;= (g_days_in_month[i] + (i == 1 &amp;&amp; leap)){\n    g_day_no -= g_days_in_month[i] + (i == 1 &amp;&amp; leap)\n    i+=1\n}\n</code></pre>\n\n<p>but i have error in ide that say :</p>\n\n<blockquote>\n  <p>Invalid operation: i == 1 &amp;&amp; leap (mismatched types bool and int32)</p>\n</blockquote>\n\n<p>for this section <code>(i == 1 &amp;&amp; leap)</code></p>\n\n<p>how can i correct this part of my code? </p>\n"}, {"tags": ["excel", "go"], "owner": {"reputation": 131, "user_id": 6125195, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/914f76884c6de67a36fdb27b52dc0c4a?s=128&d=identicon&r=PG&f=1", "display_name": "sarvs", "link": "https://stackoverflow.com/users/6125195/sarvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545069661, "creation_date": 1545069661, "question_id": 53820749, "link": "https://stackoverflow.com/questions/53820749/retrieving-cellrange-from-xslx-golang", "title": "Retrieving CellRange from xslx golang", "body": "<p>trying to get some hands-on with golang. Currently I have an issue which I can fix using java but not with go. \nHere is the issue. I have to read an excel file, and just get a Area Reference for example cells (Sheet1!A1:F6) and not the entire sheet.\nThis can be easily achieved using Apache Poi, but all the api's that go has do not have a way to get a range of cells. The golang library I am using is <a href=\"https://godoc.org/github.com/tealeg/xlsx\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/tealeg/xlsx</a> . I would really appreciate if anyone has done this kind of work. Unfortunately I dont have a working code for go since I don't know the function I have to call. Other than go over all the columns and then ensure just get the ones I need. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 2, "creation_date": 1545065148, "post_id": 53819537, "comment_id": 94487567, "body": "These are called struct tags: <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Struct_types</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1545065073, "creation_date": 1545065073, "answer_id": 53819564, "question_id": 53819537, "link": "https://stackoverflow.com/questions/53819537/a-field-of-a-struct-which-consists-of-3-items-how-can-this-compile/53819564#53819564", "title": "A field of a struct which consists of 3 items. How can this compile?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">Struct types</a></p>\n  \n  <p>A field declaration may be followed by an optional string literal tag,\n  which becomes an attribute for all the fields in the corresponding\n  field declaration. An empty tag string is equivalent to an absent tag.\n  The tags are made visible through a reflection interface and take part\n  in type identity for structs but are otherwise ignored.</p>\n</blockquote>\n"}], "owner": {"reputation": 89, "user_id": 10691978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e8becc69dd0d98b53e959c9489fd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Maddani", "link": "https://stackoverflow.com/users/10691978/maddani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "closed_date": 1545065044, "answer_count": 1, "score": -2, "last_activity_date": 1545065192, "creation_date": 1545064957, "question_id": 53819537, "link": "https://stackoverflow.com/questions/53819537/a-field-of-a-struct-which-consists-of-3-items-how-can-this-compile", "closed_reason": "Duplicate", "title": "A field of a struct which consists of 3 items. How can this compile?", "body": "<p>I've seen code like this:</p>\n\n<pre><code>type Product struct {\n Name        string         `db:\"product_name\"`\n Id          int            `db:\"id\"`\n}\n\ntype  Stocks { \n Name        string         `db:\"stock_name\"`\n Price       float          `db:\"price\"`\n Type        string         `db:\"type\"`\n}\n</code></pre>\n\n<p>Although this code compiles, how can it be? A member of a struct must consist of a name and a following type. However, here there's also <code>db:\"product_name\"</code> which is the 3rd member</p>\n\n<p>How can this be valid? What's <code>db:\"product_name\"</code> from the perspective of Go?</p>\n"}, {"tags": ["datetime", "parsing", "go"], "answers": [{"comments": [{"owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "edited": false, "score": 3, "creation_date": 1545060314, "post_id": 53818097, "comment_id": 94484734, "body": "This example works correctly and helps for me It&#39;s enough I think"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1545070453, "last_edit_date": 1545070453, "creation_date": 1545059904, "answer_id": 53818097, "question_id": 53818026, "link": "https://stackoverflow.com/questions/53818026/parse-date-in-golang/53818097#53818097", "title": "parse date in golang", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">Package time</a></p>\n  \n  <p>import \"time\"</p>\n  \n  <p>the [layout] reference time can be thought of as</p>\n\n<pre><code>01/02 03:04:05PM '06 -0700\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>Use <code>-0700</code>, not <code>+0000</code>.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    layout := \"2006-01-02 15:04:05 -0700\"\n    dateString := \"2018-12-17 12:55:50 +0300\"\n    t, err := time.Parse(layout, dateString)\n    if err != nil {\n        fmt.Println(\"Error while parsing date :\", err)\n    }\n    fmt.Println(t.Format(\"2006-01-02 15:04:05\"))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Xr8zaTjODgC\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Xr8zaTjODgC</a></p>\n\n<p>Output:</p>\n\n<pre><code>2018-12-17 12:55:50\n</code></pre>\n"}], "owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 1, "accepted_answer_id": 53818097, "answer_count": 1, "score": 2, "last_activity_date": 1545070453, "creation_date": 1545059648, "question_id": 53818026, "link": "https://stackoverflow.com/questions/53818026/parse-date-in-golang", "title": "parse date in golang", "body": "<p>Please help me to parse date like <code>2018-12-17 12:55:50 +0300</code> in golang </p>\n\n<p>I'm trying with layout </p>\n\n<pre><code>layout := \"2006-01-02 15:04:05 +0000\"\ndateString := \"2018-12-17 12:55:50 +0300\"\nt, err := time.Parse(layout, dateString)\nif err != nil {\n    fmt.Println(\"Error while parsing date :\", err)\n}\nfmt.Println(t.Format(\"2006-01-02 15:04:05\"))\n</code></pre>\n\n<p>but compiler says <code>Error while parsing date : parsing time \"2018-12-17 12:55:50 +0300\" as \"2006-01-02 15:04:05 +0000\": cannot parse \"300\" as \" +0000\"</code> </p>\n"}, {"tags": ["go", "gorest"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 6, "creation_date": 1545055264, "post_id": 53816759, "comment_id": 94481768, "body": "There is no filename associated with an HTTP request body."}, {"owner": {"reputation": 745, "user_id": 5674391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKpCi.jpg?s=128&g=1", "display_name": "Dinesh Sonachalam", "link": "https://stackoverflow.com/users/5674391/dinesh-sonachalam"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1545055655, "post_id": 53816759, "comment_id": 94482015, "body": "@Flimzy I am attaching a csv file in my postman client. I am able to save the posted binary data to a csv file. How can I get the filename of the uploaded file?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1545055917, "post_id": 53816759, "comment_id": 94482168, "body": "The filename is not among the data that you&#39;re sending. You can&#39;t get data you don&#39;t receive from the client."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1545056184, "post_id": 53816759, "comment_id": 94482320, "body": "You can&#39;t because, as I already explained, there is no filename associated with an HTTP response body."}, {"owner": {"reputation": 745, "user_id": 5674391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKpCi.jpg?s=128&g=1", "display_name": "Dinesh Sonachalam", "link": "https://stackoverflow.com/users/5674391/dinesh-sonachalam"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545056322, "post_id": 53816759, "comment_id": 94482393, "body": "Thanks @Adrian, I am understanding it know."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1545057799, "post_id": 53817258, "comment_id": 94483262, "body": "There&#39;s no reason that form-data, per se, is better than any other encoding. You could just as well use JSON, XML, a zip file, or literally <i>any other</i> encoding that includes the filename"}, {"owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1545058139, "post_id": 53817258, "comment_id": 94483458, "body": "Total agree with you"}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 5, "last_activity_date": 1545058634, "last_edit_date": 1545058634, "creation_date": 1545056868, "answer_id": 53817258, "question_id": 53816759, "link": "https://stackoverflow.com/questions/53816759/how-to-get-the-file-name-of-a-posted-binary-data-using-golang/53817258#53817258", "title": "How to get the file name of a posted binary data using Golang?", "body": "<p>You could use an encoding, such as <code>form-data</code>, which includes the filename to upload file with postman. This will help you can send <code>multipart/form-data</code> request to server. After that you can extract file name from server side.</p>\n\n<p><a href=\"https://i.stack.imgur.com/G1NbU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G1NbU.png\" alt=\"enter image description here\"></a></p>\n\n<p>From server side</p>\n\n<pre><code>func uploadData(w http.ResponseWriter, req *http.Request) {\n    _, header, _ := req.FormFile(\"demo\")\n    fmt.Println(header.Filename)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "edited": false, "score": 1, "creation_date": 1545057674, "post_id": 53817371, "comment_id": 94483189, "body": "awesome solution =))"}], "tags": [], "owner": {"reputation": 745, "user_id": 5674391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKpCi.jpg?s=128&g=1", "display_name": "Dinesh Sonachalam", "link": "https://stackoverflow.com/users/5674391/dinesh-sonachalam"}, "is_accepted": true, "score": 2, "last_activity_date": 1545057349, "creation_date": 1545057349, "answer_id": 53817371, "question_id": 53816759, "link": "https://stackoverflow.com/questions/53816759/how-to-get-the-file-name-of-a-posted-binary-data-using-golang/53817371#53817371", "title": "How to get the file name of a posted binary data using Golang?", "body": "<p>Since, there is no filename associated with a HTTP request body. You have to send the filename in your URL if you want to get the filename.</p>\n\n<pre><code>package main\n\nimport (   \n           \"net/http\"\n           \"os\"\n           \"io\"\n           \"log\"\n           \"github.com/gorilla/mux\"\n\n       )\n\nfunc uploadData(w http.ResponseWriter, req *http.Request) {\n    params := mux.Vars(req)\n    file, err := os.Create(params[\"fileName\"])\n    _, err = io.Copy(file, req.Body)\n    if err!=nil{\n      log.Printf(\"Error while Posting data\")\n    }\n}\n\nfunc main(){\n  router := mux.NewRouter()\n  router.HandleFunc(\"/upload/{fileName}\", uploadData).Methods(\"POST\")\n  log.Fatal(http.ListenAndServe(\":8000\", router))\n}\n</code></pre>\n"}], "owner": {"reputation": 745, "user_id": 5674391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKpCi.jpg?s=128&g=1", "display_name": "Dinesh Sonachalam", "link": "https://stackoverflow.com/users/5674391/dinesh-sonachalam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2265, "favorite_count": 3, "accepted_answer_id": 53817371, "answer_count": 2, "score": -4, "last_activity_date": 1545058634, "creation_date": 1545055141, "last_edit_date": 1545055470, "question_id": 53816759, "link": "https://stackoverflow.com/questions/53816759/how-to-get-the-file-name-of-a-posted-binary-data-using-golang", "title": "How to get the file name of a posted binary data using Golang?", "body": "<p>I am posting a csv file as a binary file using Postman REST API client. I need to get the filename of the uploaded file.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0u606.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0u606.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is a simple example of posting a csv file as binary data and storing the binary data as a csv file.</p>\n\n<pre><code>package main\n\nimport (   //\"fmt\"\n           \"net/http\"\n           \"os\"\n           \"io\"\n           \"log\"\n           \"github.com/gorilla/mux\"\n       )\n\nfunc uploadData(w http.ResponseWriter, req *http.Request) {\n    file, err := os.Create(\"hello.csv\")\n    _, err = io.Copy(file, req.Body)\n    _ = err\n}\n\nfunc main(){\n  router := mux.NewRouter()\n  router.HandleFunc(\"/parse\", uploadData).Methods(\"POST\")\n  log.Fatal(http.ListenAndServe(\":8000\", router))\n}\n</code></pre>\n"}, {"tags": ["go", "mongo-go"], "comments": [{"owner": {"reputation": 8162, "user_id": 1333133, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/87a3017cfedcddb87f9255dfe42fa0fd?s=128&d=identicon&r=PG", "display_name": "Satya", "link": "https://stackoverflow.com/users/1333133/satya"}, "edited": false, "score": 2, "creation_date": 1545054855, "post_id": 53816611, "comment_id": 94481556, "body": "try wrapping id in bson.ObjectIdHex() e.g. bson.ObjectIdHex(&quot;5c1760b4bd421c09e0f3140c&quot;) and see if it works"}], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 5, "last_activity_date": 1545054877, "creation_date": 1545054877, "answer_id": 53816681, "question_id": 53816611, "link": "https://stackoverflow.com/questions/53816611/golang-mongo-go-driver-beta-1-using-greater-than-operator/53816681#53816681", "title": "Golang mongo-go-driver Beta 1 , using greater than operator", "body": "<p>You need to compare <code>ObjectID</code> to <code>ObjectID</code>. What you are doing is comparing an <code>ObjectID</code> to a <code>string</code>.</p>\n\n<pre><code>objectID, _ := primitive.ObjectIDFromHex(\"5c1760b4bd421c09e0f3140c\")\nfilter = bson.M{\"_id\": bson.M{\"$gt\": objectID}}\ncur, err := collection.Find(ctx, filter, &amp;options)\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8012667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19836a5e09100b6ec760c31f1367234f?s=128&d=identicon&r=PG&f=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/8012667/nobody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 53816681, "answer_count": 1, "score": 1, "last_activity_date": 1545054877, "creation_date": 1545054646, "question_id": 53816611, "link": "https://stackoverflow.com/questions/53816611/golang-mongo-go-driver-beta-1-using-greater-than-operator", "title": "Golang mongo-go-driver Beta 1 , using greater than operator", "body": "<p>I have been trying to get records greater than an <strong>_id</strong> provided\nThe code is below</p>\n\n<pre><code>filter = bson.M{\"_id\": bson.M{\"$gt\": \"5c1760b4bd421c09e0f3140c\"}}\ncur, err := collection.Find(ctx, filter, &amp;options)\n</code></pre>\n\n<p>But iam always getting null values.\nI think i need to convert that id to object id\nBut iam not sure how to do it in latest release\nThere is a bson.TypeObjectID shown in predictions . Can someone please provide some details to do this.? Thanks</p>\n"}, {"tags": ["mongodb", "go", "mongo-go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1545056651, "post_id": 53816592, "comment_id": 94482596, "body": "No, it means <i>string pointers</i> cannot be used at all. String pointers are pretty unusual anyway, since strings are immutable."}, {"owner": {"reputation": 135, "user_id": 8496766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1941938429402414/picture?type=large", "display_name": "Kasper Gyselinck", "link": "https://stackoverflow.com/users/8496766/kasper-gyselinck"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545131140, "post_id": 53816592, "comment_id": 94511572, "body": "It&#39;s not just strings. I see string pointers fairly often in Go code when nil values are wanted. In any case the same issue occurs when using other data types. I&#39;ve updated my question with the result of using a pointer to an integer value."}], "owner": {"reputation": 135, "user_id": 8496766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1941938429402414/picture?type=large", "display_name": "Kasper Gyselinck", "link": "https://stackoverflow.com/users/8496766/kasper-gyselinck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545130963, "creation_date": 1545054572, "last_edit_date": 1545130963, "question_id": 53816592, "link": "https://stackoverflow.com/questions/53816592/cannot-transform-struct-containing-pointer-type-to-a-bsonx-document", "title": "cannot transform (struct containing pointer) type to a *bsonx.Document", "body": "<p>I've recently started using the official mongo-go-driver (github.com/mongodb/mongo-go-driver) and it seems that I cannot use pointers in my structs -> ex.:</p>\n\n<pre><code>type example struct {\n  hello *string\n}\n</code></pre>\n\n<p>If you initialize this struct and try to insert it to the database, you get the error: </p>\n\n<pre><code>\"Failed to insert doc: cannot transform type example to a *bsonx.Document\"\n</code></pre>\n\n<p>Diving deeper into the library, I find this error:</p>\n\n<pre><code>\"StringEncodeValue can only process string, but got a *string\"\n</code></pre>\n\n<p>Does this mean that pointers can not be used at all? If so, does anyone know why pointers would not be supported?</p>\n\n<p>Using a different type produces the same result.\nExample error when using an integer type:</p>\n\n<pre><code>\"IntEncodeValue can only process int8, int16, int32, int64, int, but got a *int\"\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1545052896, "post_id": 53816028, "comment_id": 94480410, "body": "Use a map.  <code>map[string]Thing</code> for example."}], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 2, "last_activity_date": 1545053274, "creation_date": 1545053274, "answer_id": 53816221, "question_id": 53816028, "link": "https://stackoverflow.com/questions/53816028/initial-keys-in-yaml-file-are-arbitrary-how-do-i-read-them-in-go/53816221#53816221", "title": "Initial keys in yaml file are arbitrary, how do I read them in Go?", "body": "<p>In the normal cases, if you are parsing a certain file you would know how it looks ahead of parsing it. So if you know how the file looks, then consider <code>Unmarshal</code>ing to an instance of a struct that defines the shape of the file.</p>\n\n<p>If you don't know the schema and need to work dynamically, <code>Unmarshal</code> into <code>map[string]interface{}</code> </p>\n\n<pre><code>t := make(map[string]interface{})\nyaml.Unmarshal([]byte(data), &amp;t)\nfmt.Println(t[\"canBeAnything\"])\n</code></pre>\n"}], "owner": {"reputation": 3895, "user_id": 4040931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/705151302/picture?type=large", "display_name": "David Alsh", "link": "https://stackoverflow.com/users/4040931/david-alsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 53816221, "answer_count": 1, "score": 0, "last_activity_date": 1545053274, "creation_date": 1545052568, "question_id": 53816028, "link": "https://stackoverflow.com/questions/53816028/initial-keys-in-yaml-file-are-arbitrary-how-do-i-read-them-in-go", "title": "Initial keys in yaml file are arbitrary, how do I read them in Go?", "body": "<p>I have the following yaml file</p>\n\n<pre><code>arbitratyKey:\n    things:\n       - value 1\n       - value 2\n\ncanBeAnything:\n    things:\n       - value 1\n       - value 2\n\nasdasdasd:\n    things:\n       - value 1\n       - value 2\n</code></pre>\n\n<p>How do I select a key on this when I am unable to know what the root key will be?</p>\n\n<p>I am using the following library\n<a href=\"https://godoc.org/gopkg.in/yaml.v2#Unmarshal\" rel=\"nofollow noreferrer\">https://godoc.org/gopkg.in/yaml.v2#Unmarshal</a></p>\n\n<p>Obviously the following code doesn't work, but how do I access the <code>canBeAnything</code> key without specifying a type before?</p>\n\n<pre><code>type T struct{}\n\nt := T{}\nyaml.Unmarshal([]byte(data), &amp;t)\nfmt.Println(t.canBeAnything)\n</code></pre>\n"}, {"tags": ["go", "grafana"], "comments": [{"owner": {"reputation": 130, "user_id": 4198317, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rc0Ik1yNrzA/AAAAAAAAAAI/AAAAAAAACIE/eIlf5bdUeIQ/photo.jpg?sz=128", "display_name": "St&#233;phane Jeandeaux", "link": "https://stackoverflow.com/users/4198317/st%c3%a9phane-jeandeaux"}, "edited": false, "score": 3, "creation_date": 1545052008, "post_id": 53815474, "comment_id": 94479892, "body": "Hi, you should read <a href=\"http://docs.grafana.org/http_api/dashboard/\" rel=\"nofollow noreferrer\">docs.grafana.org/http_api/dashboard</a>."}], "owner": {"reputation": 157, "user_id": 7072729, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9be68688b8d69616340b5958278fd359?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek", "link": "https://stackoverflow.com/users/7072729/vivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545050629, "creation_date": 1545050453, "last_edit_date": 1545050629, "question_id": 53815474, "link": "https://stackoverflow.com/questions/53815474/how-to-resolve-400-error-after-put-to-grafana", "title": "How to resolve 400 error after PUT to grafana", "body": "<p>I am trying to automate to push a dashboard in grafana using Go and using this library \"github.com/adejoux/grafanaclient\". I am not using its session function rather than that I am making my own client for authentication using certificates.\nBelow is what I have tried. </p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"time\"\n    \"github.com/adejoux/grafanaclient\"\n    \"bytes\"\n    \"encoding/json\"\n    \"crypto/tls\"\n    \"crypto/x509\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"net/url\"\n    \"os\"\n)\n\nfunc CreateGraphanaClient()(client *http.Client){\n    test_telemetry_cert_file:=\"/vivek/certfile\"\n    test_telemetry_bridge_cert_file := \"/vivek/bridge_certfile\"\n    proxyUrl, err := url.Parse(\"http://www-proxy-obc.us.myurl.com:80\")\n    test_telemetry_keystore_path := \"/vivek/keystore\"\n\n    cert, err := tls.LoadX509KeyPair(test_telemetry_cert_file, test_telemetry_keystore_path)\n    if err != nil {\n        os.Exit(2)\n    }\n\n    clientCACert, err := ioutil.ReadFile(test_telemetry_bridge_cert_file)\n    if err != nil {\n        os.Exit(2)\n    }\n\n    clientCertPool := x509.NewCertPool()\n    clientCertPool.AppendCertsFromPEM(clientCACert)\n\n    tlsConfig := &amp;tls.Config{\n        Certificates: []tls.Certificate{cert},\n        RootCAs:      clientCertPool,\n    }\n\n    tlsConfig.BuildNameToCertificate()\n\n    client = &amp;http.Client{\n            Transport: &amp;http.Transport{TLSClientConfig: tlsConfig,  Proxy: http.ProxyURL(proxyUrl) ,}, \n            }\n    return\n}\n\nfunc main(){\n\n    grafana_url := \"http://192.168.56.101:3000\"\n    // init a new dashboard and allows edition\n    dashboard := grafanaclient.Dashboard{Editable: true}\n    // let's set the title\n    dashboard.Title = \"OPC-OCI-apicanary\"\n\n    // Creating a new row\n    textRow := grafanaclient.NewRow()\n    textRow.Title = \"this row will contains only a text panel\"\n    textRow.Collapse = true // it will be collapsed by default\n    // let's create a simple text panel supporting html format\n    textPanel := grafanaclient.Panel{Type: \"text\", Editable: true, Mode: \"html\"}\n\n    // Add some content\n    textPanel.Content = \"&lt;b&gt; Hello World&lt;/b&gt;\"\n\n    // and add the panel to the row\n    textRow.AddPanel(textPanel)\n\n    // add the row to the dashboard itself\n    dashboard.AddRow(textRow)\n\n    //create a new row with charts\n    graphRow := grafanaclient.NewRow()\n    graphRow.Title = \"charts\"\n\n    // NewPanel will create a graph panel by default\n    graphPanel := grafanaclient.NewPanel()\n\n    // set panel title\n    graphPanel.Title = \"chart1\"\n\n    // let's specify the datasource\n    graphPanel.DataSource = \"testdata\"\n\n    // change panel span from default 12 to 6\n    graphPanel.Span = 6\n\n    // stack lines with a filling of 1\n    graphPanel.Stack = true\n    graphPanel.Fill = 1\n\n    // define a target\n    target := grafanaclient.NewTarget()\n\n    //specify the measurement to use\n    target.Measurement = \"CPU_ALL\"\n\n    // group stats by name tag values\n    target.GroupByTag(\"name\")\n    target.GroupByTag(\"host\")\n\n    // filter by host tag\n    target.FilterByTag(\"host\", \"test\")\n\n    // Adding everything\n    graphPanel.AddTarget(target)\n    graphRow.AddPanel(graphPanel)\n    dash[oard.AddRow(graphRow)\n\n    // Setup time frame\n    dashboard.SetTimeFrame(time.Now().Add(-24*time.Hour), time.Now())\n\n    client := CreateGraphanaClient()\n    out, _ := json.Marshal(dashboard)\n    req, _ := http.NewRequest(\"PUT\", grafana_url, bytes.NewBuffer(out))\n    req.Header.Add(\"Content-Type\", \"application/json\")\n    resp,err := client.Do(req)\n    if err != nil{\n        fmt.Println(\"Err :\",err)\n    }\n    fmt.Println(\"resp :\",resp)\n}\n</code></pre>\n\n<p>But I am getting the below error :</p>\n\n<pre><code>resp : &amp;{400 Bad Request 400 HTTP/1.1 1 1 map[Okc-Request-Id:[b2m0252c-7jr9-4bnx-l937-34hk1x11q102] Content-Type:[application/json] Content-Length:[2457] Date:[Mon, 17 Dec 2018 12:37:31 GMT]] 0xc0002b20c0 2457 [] false false map[] 0xc000164100 0xc0000dc4d0}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1545049287, "post_id": 53814981, "comment_id": 94478396, "body": "I don&#39;t really understand your question. Your second example uses a goroutine, and this is why it doesn&#39;t block. So I&#39;m not sure why you&#39;re speculating about copies of channels (which is entirely not what happens)."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1545049440, "post_id": 53814981, "comment_id": 94478483, "body": "This has <b>nothing</b> to do with pointers or passing around a copy. What happens: You span a new goroutine and while this goroutine works on sendHello the main go routine continues and waits until something is sent on p and reads this from p. The sending happens in the second goroutine."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1545049731, "post_id": 53814981, "comment_id": 94478646, "body": "In your first code your program cannot advance once it reaches <code>p &lt;- &quot;Hello&quot;</code> as no other goroutine is there to read. In your secon example you do have two groroutines, while one is trying to send the other is trying to read and the value will pass the channel. Again: This has <i>nothing</i> to do with how values are passed to functions, &quot;references&quot; or pointers."}, {"owner": {"reputation": 160, "user_id": 10562862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e008e66b85602b28959d0b91339f8b2a?s=128&d=identicon&r=PG&f=1", "display_name": "topenion", "link": "https://stackoverflow.com/users/10562862/topenion"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1545049732, "post_id": 53814981, "comment_id": 94478647, "body": "@Volker The println receives via &lt;-p and does not exit without output. It shows output"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1545049763, "post_id": 53814981, "comment_id": 94478664, "body": "Sorry, I fixed the comment already."}], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 10562862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e008e66b85602b28959d0b91339f8b2a?s=128&d=identicon&r=PG&f=1", "display_name": "topenion", "link": "https://stackoverflow.com/users/10562862/topenion"}, "edited": false, "score": 1, "creation_date": 1545049943, "post_id": 53815247, "comment_id": 94478757, "body": "Thats short and exactly what I wanted to know .thanks. Have my upvote too."}], "tags": [], "owner": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "is_accepted": true, "score": 6, "last_activity_date": 1545049646, "creation_date": 1545049646, "answer_id": 53815247, "question_id": 53814981, "link": "https://stackoverflow.com/questions/53814981/how-channel-buffers-work-in-golang-when-used-without-goroutines-within-their-sc/53815247#53815247", "title": "How channel buffers work in golang when used without goroutines (within their scope) vs when they are passed to goroutines?", "body": "<p>Keep in mind that a channel has two ends, a <em>sender</em> and a <em>receiver</em>. Your problem is about the order of execution.</p>\n\n<p>In the first example, when you use an unbuffered channel, the channel expects a <em>receiver</em>, while there's none as of sending <code>Hello goroutine</code> message, and waits until there's one (this is not the case for a buffered channel as it doesn't require to wait), and the execution never reaches the next line (i.e. a deadlock).</p>\n\n<p>But in the second example, the receiver is bound to the channel and the groutine is executed after, and both <em>sender</em> and <em>receiver</em> don't remain in a wait state.</p>\n"}], "owner": {"reputation": 160, "user_id": 10562862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e008e66b85602b28959d0b91339f8b2a?s=128&d=identicon&r=PG&f=1", "display_name": "topenion", "link": "https://stackoverflow.com/users/10562862/topenion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 53815247, "answer_count": 1, "score": 0, "last_activity_date": 1545050038, "creation_date": 1545048644, "last_edit_date": 1545050038, "question_id": 53814981, "link": "https://stackoverflow.com/questions/53814981/how-channel-buffers-work-in-golang-when-used-without-goroutines-within-their-sc", "title": "How channel buffers work in golang when used without goroutines (within their scope) vs when they are passed to goroutines?", "body": "<p>I am absolute newbie in Golang. I am learning through Tour of Go and then implementing ideas with my own understanding. I am having problem with goroutines. I made a unbuffered channel , then sent a string to that channel.</p>\n\n<pre><code>func main() {\n    p := make(chan string)\n    p &lt;- \"Hello goroutine\"\n    fmt.Println(&lt;-p)\n}\n</code></pre>\n\n<p>throws error </p>\n\n<blockquote>\n  <p>fatal error: all goroutines are asleep - deadlock!</p>\n</blockquote>\n\n<p>I get it, channel is unbuffered. (<strong>That's the reason. Right?</strong>).</p>\n\n<p>But when I refactor <code>p &lt;- \"Hello goroutine</code> to a goroutine</p>\n\n<pre><code>func main() {\n    p := make(chan string)\n    go sendHello(p)\n    fmt.Println(&lt;-p)\n}\n\nfunc sendHello(p chan string) {\n    p &lt;- \"Hello goroutine\"\n}\n</code></pre>\n\n<p>It works without problem. I read that we do not need to use pointers with maps,slices and channels with most cases to modify the value. <strong>Was <code>channel p</code> passed to <code>func sendHello(p chan string)</code> via a copy which had a separate buffer</strong>. I still can not get my head around it.</p>\n"}, {"tags": ["angular", "api", "go", "http-post"], "comments": [{"owner": {"reputation": 70314, "user_id": 5043867, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/RX8Aw.jpg?s=128&g=1", "display_name": "Pardeep Jain", "link": "https://stackoverflow.com/users/5043867/pardeep-jain"}, "edited": false, "score": 0, "creation_date": 1545046347, "post_id": 53814304, "comment_id": 94476857, "body": "are you facing any error?"}, {"owner": {"reputation": 1, "user_id": 10800895, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dYa-tmutEDE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jgi-Ujfh2pa-NX0jtMraUDuhd13A/mo/photo.jpg?sz=128", "display_name": "Mon", "link": "https://stackoverflow.com/users/10800895/mon"}, "reply_to_user": {"reputation": 70314, "user_id": 5043867, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/RX8Aw.jpg?s=128&g=1", "display_name": "Pardeep Jain", "link": "https://stackoverflow.com/users/5043867/pardeep-jain"}, "edited": false, "score": 0, "creation_date": 1545046463, "post_id": 53814304, "comment_id": 94476909, "body": "not have error. @PardeepJain"}, {"owner": {"reputation": 16244, "user_id": 162070, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fda09c54de7bb03f0d77127cec09fd12?s=128&d=identicon&r=PG", "display_name": "Zlatko", "link": "https://stackoverflow.com/users/162070/zlatko"}, "edited": false, "score": 0, "creation_date": 1545046883, "post_id": 53814304, "comment_id": 94477136, "body": "Did you try setting the Content-Type headers explicitly? What <i>do</i> you get in that print statement?"}], "answers": [{"tags": [], "owner": {"reputation": 7081, "user_id": 71245, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f9ccd98c185d7407c6d27e2875335a31?s=128&d=identicon&r=PG", "display_name": "Leon Radley", "link": "https://stackoverflow.com/users/71245/leon-radley"}, "is_accepted": true, "score": 0, "last_activity_date": 1545047035, "creation_date": 1545047035, "answer_id": 53814568, "question_id": 53814304, "link": "https://stackoverflow.com/questions/53814304/why-i-cant-get-body-form-angular/53814568#53814568", "title": "Why I can&#39;t get body form Angular", "body": "<p>I think it could be that your go server is expecting a <code>content-type: application/x-www-form-urlencoded</code></p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Request.ParseForm</a></p>\n\n<p>But angular is submitting the form as a json object.</p>\n\n<p>To debug what is happening check the outgoing response from chrome to your backend\nDo this by enabling \"Log XmlHttpRequest from the settings menu in chrome devtools.</p>\n\n<p>You should then be able to se that the body is JSON.</p>\n\n<p>Try using this to parse the body instead</p>\n\n<pre><code>func test(rw http.ResponseWriter, req *http.Request) {\n    decoder := json.NewDecoder(req.Body)\n    var t test_struct\n    err := decoder.Decode(&amp;t)\n    if err != nil {\n        panic(err)\n    }\n    log.Println(t.Test)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10800895, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dYa-tmutEDE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jgi-Ujfh2pa-NX0jtMraUDuhd13A/mo/photo.jpg?sz=128", "display_name": "Mon", "link": "https://stackoverflow.com/users/10800895/mon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 53814568, "answer_count": 1, "score": -3, "last_activity_date": 1545047035, "creation_date": 1545046098, "last_edit_date": 1545046210, "question_id": 53814304, "link": "https://stackoverflow.com/questions/53814304/why-i-cant-get-body-form-angular", "title": "Why I can&#39;t get body form Angular", "body": "<p>I use angular to get information register html and I post to path api it work but print word \"work\" and I cant not get value In body and I test path post use\npostman it show firstname.......................................................................................................................................</p>\n\n<p>server.go</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>package main\r\n\r\nimport (\r\n\t\"github.com/gorilla/handlers\"\r\n\t\"github.com/gorilla/mux\"\r\n\t\"net/http\"\r\n)\r\n\r\nfunc main() {\r\n\r\n\trouter := mux.NewRouter()\r\n\trouter.HandleFunc(\"/register\", Createuser).Methods(\"POST\")\r\n\theaders := handlers.AllowedHeaders([]string{\"X-Requested-With\", \"Content-Type\", \"Authorization\"})\r\n\tmethods := handlers.AllowedMethods([]string{\"GET\", \"POST\", \"PUT\", \"DELETE\"})\r\n\torigins := handlers.AllowedOrigins([]string{\"*\"})\r\n\thttp.ListenAndServe(\":12345\", handlers.CORS(headers, methods, origins)(router))\r\n\r\n}\r\n\r\n\r\nfunc Createuser(writer http.ResponseWriter, request *http.Request) {\r\n\trequest.ParseForm()\r\n    print(request.FormValue(\"firstName\"))\r\n\tprint(\"work\")\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>register.component.ts</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { first } from 'rxjs/operators';\r\n\r\nimport { AlertService, UserService } from '../_services';\r\n\r\n@Component({templateUrl: 'register.component.html'})\r\nexport class RegisterComponent implements OnInit {\r\n    registerForm: FormGroup;\r\n    loading = false;\r\n    submitted = false;\r\n\r\n    constructor(\r\n        private formBuilder: FormBuilder,\r\n        private router: Router,\r\n        private userService: UserService,\r\n        private alertService: AlertService) { }\r\n\r\n    ngOnInit() {\r\n        this.registerForm = this.formBuilder.group({\r\n            firstName: ['', Validators.required],\r\n            lastName: ['', Validators.required],\r\n            username: ['', Validators.required],\r\n            password: ['', [Validators.required, Validators.minLength(6)]]\r\n        });\r\n    }\r\n\r\n    // convenience getter for easy access to form fields\r\n    get f() { return this.registerForm.controls; }\r\n\r\n    onSubmit() {\r\n        this.submitted = true;\r\n\r\n        // stop here if form is invalid\r\n        if (this.registerForm.invalid) {\r\n            return;\r\n        }\r\n\r\n        this.loading = true;\r\n        this.userService.register(this.registerForm.value)\r\n \r\n    }\r\n}</code></pre>\r\n</div>\r\n</div>\r\n\nuser.service.ts</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>import {Injectable} from '@angular/core';\r\nimport {HttpClient} from '@angular/common/http';\r\n\r\nimport {environment} from '../../environments/environment';\r\nimport {User} from '../_models';\r\n\r\n@Injectable()\r\nexport class UserService {\r\n  constructor(private http: HttpClient) {\r\n  }\r\n\r\n\r\n  register(user: User) {\r\n     return this.http.post(`${environment.apiUrl}/register`, {\r\n      firstName: user.firstName,\r\n      lastName : user.lastName,\r\n      username : user.username,\r\n      password : user.password\r\n    })\r\n  }\r\n\r\n  }\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["linux", "go", "raspberry-pi", "arm", "glide-golang"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545047933, "post_id": 53813470, "comment_id": 94477697, "body": "What version of go do you have installed on your raspberry?"}, {"owner": {"reputation": 301, "user_id": 5407842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjIWs.jpg?s=128&g=1", "display_name": "Kumar Vivek", "link": "https://stackoverflow.com/users/5407842/kumar-vivek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545048050, "post_id": 53813470, "comment_id": 94477761, "body": "@mkopriva Go Version: go 1.7.4 linux/arm and Rasbian OS: Rasbian 4.14.71-v7+"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545048134, "post_id": 53813470, "comment_id": 94477804, "body": "Some of those fields where added in 1.8 i believe, so the <code>autocert</code> package is out of sync with the std lib. Upgrade Go."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545048297, "post_id": 53813470, "comment_id": 94477877, "body": "<a href=\"https://golang.org/doc/go1.8#crypto_tls\" rel=\"nofollow noreferrer\">golang.org/doc/go1.8#crypto_tls</a>"}, {"owner": {"reputation": 301, "user_id": 5407842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjIWs.jpg?s=128&g=1", "display_name": "Kumar Vivek", "link": "https://stackoverflow.com/users/5407842/kumar-vivek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545050851, "post_id": 53813470, "comment_id": 94479268, "body": "@mkopriva I used the latest release only using this command, &quot;sudo snap install go --classic&quot;.  Not sure why its installing 1.7.4, maybe that&#39;s the latest release on ARM?"}, {"owner": {"reputation": 301, "user_id": 5407842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjIWs.jpg?s=128&g=1", "display_name": "Kumar Vivek", "link": "https://stackoverflow.com/users/5407842/kumar-vivek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545052356, "post_id": 53813470, "comment_id": 94480088, "body": "@mkopriva that was the issue update my GO to 1.11 and now everything works, thanks."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545052384, "post_id": 53813470, "comment_id": 94480104, "body": "I&#39;m not familiar with snapd so I&#39;m not sure how it determines the version but this gif suggests that the version be specified with the channel option <a href=\"https://snapcraft.io/go\" rel=\"nofollow noreferrer\">snapcraft.io/go</a>. I&#39;m glad you got it fixed."}], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 1, "last_activity_date": 1545053420, "creation_date": 1545053420, "answer_id": 53816266, "question_id": 53813470, "link": "https://stackoverflow.com/questions/53813470/missing-field-or-method-signature-scheme-in-autocert-on-arm/53816266#53816266", "title": "Missing Field or method Signature Scheme in autocert on arm", "body": "<p>Make sure to use the same Go version as the other platforms. Some features may have been added in a newer version.</p>\n"}], "owner": {"reputation": 301, "user_id": 5407842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjIWs.jpg?s=128&g=1", "display_name": "Kumar Vivek", "link": "https://stackoverflow.com/users/5407842/kumar-vivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53816266, "answer_count": 1, "score": -1, "last_activity_date": 1545053420, "creation_date": 1545043247, "last_edit_date": 1545043779, "question_id": 53813470, "link": "https://stackoverflow.com/questions/53813470/missing-field-or-method-signature-scheme-in-autocert-on-arm", "title": "Missing Field or method Signature Scheme in autocert on arm", "body": "<p>I am writing a program in go which makes an HTTP request to different server and reads the response. The program works absolutely fine on Windows/Mac but when I run the program on ARM based Rasp Pi 3 with Rasbian OS, it fails.</p>\n\n<p>Every-time I try to build the code it throws this error, could any suggest what I am doing wrong here?</p>\n\n<pre><code># golang.org/x/crypto/acme/autocert\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:301: hello.SupportedProtos undefined (type *tls.ClientHelloInfo has no field or method SupportedProtos)\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:311: hello.SignatureSchemes undefined (type *tls.ClientHelloInfo has no field or method SignatureSchemes)\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:314: hello.SignatureSchemes undefined (type *tls.ClientHelloInfo has no field or method SignatureSchemes)\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:315: undefined: tls.SignatureScheme\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:317: undefined: tls.ECDSAWithP256AndSHA256\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:318: undefined: tls.ECDSAWithP384AndSHA384\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:318: undefined: tls.ECDSAWithP521AndSHA512\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:344: undefined: tls.TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n../../go/src/golang.org/x/crypto/acme/autocert/autocert.go:347: undefined: tls.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305\n</code></pre>\n\n<p>Thanks in advance for your support, please do let me know if you need more information.</p>\n"}, {"tags": ["go", "imagemagick"], "answers": [{"comments": [{"owner": {"reputation": 292, "user_id": 3006344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5bd75574303cf338529d605191d6f6?s=128&d=identicon&r=PG", "display_name": "Cajus Pollmeier", "link": "https://stackoverflow.com/users/3006344/cajus-pollmeier"}, "edited": false, "score": 0, "creation_date": 1548937638, "post_id": 54458973, "comment_id": 95729089, "body": "Lol. I guess I did too much playing around that I forgot to add the Density. Thanks!"}], "tags": [], "owner": {"reputation": 18, "user_id": 10995320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6TrBn.png?s=128&g=1", "display_name": "Sebastian Kaupe", "link": "https://stackoverflow.com/users/10995320/sebastian-kaupe"}, "is_accepted": true, "score": 0, "last_activity_date": 1548932081, "creation_date": 1548932081, "answer_id": 54458973, "question_id": 53811182, "link": "https://stackoverflow.com/questions/53811182/how-to-smoothly-rasterize-pdf-using-the-api/54458973#54458973", "title": "How to smoothly rasterize PDF using the API?", "body": "<p>Your GO version of the <code>convert</code> command is missing the \"density\" argument. Replacing the call to <code>SetImageResolution</code> with one to <code>SetOption</code> and using a filter to smooth out the edges results in a smooth image:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"gopkg.in/gographics/imagick.v2/imagick\"\n\nfunc main() {\n    imagick.Initialize()\n    defer imagick.Terminate()\n    mw := imagick.NewMagickWand()\n    defer mw.Destroy()\n\n    mw.SetOption(\"density\", \"5000\")\n    mw.SetOption(\"psd:fit-page\", \"500x\")\n\n    mw.ReadImage(\"test.pdf\")\n\n    mw.ResizeImage(500, 500, imagick.FILTER_LAGRANGE, 1)\n    mw.SetIteratorIndex(0) // This being the page offset\n    mw.SetImageFormat(\"png\")\n    mw.WriteImage(\"test.png\")\n}\n</code></pre>\n"}], "owner": {"reputation": 292, "user_id": 3006344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5bd75574303cf338529d605191d6f6?s=128&d=identicon&r=PG", "display_name": "Cajus Pollmeier", "link": "https://stackoverflow.com/users/3006344/cajus-pollmeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 54458973, "answer_count": 1, "score": 0, "last_activity_date": 1548932081, "creation_date": 1545034532, "last_edit_date": 1545042216, "question_id": 53811182, "link": "https://stackoverflow.com/questions/53811182/how-to-smoothly-rasterize-pdf-using-the-api", "title": "How to smoothly rasterize PDF using the API?", "body": "<p>I'd like to rasterize a PDF source (in this case to PNG, 500x500 pixels) using <a href=\"https://github.com/gographics/imagick\" rel=\"nofollow noreferrer\">these golang bindings</a> for ImageMagick6. On the CLI, I can do this using</p>\n\n<pre><code>convert -density 5000 -define psd:fit-page=500x test.pdf -resize 500x test.png\n</code></pre>\n\n<p>which results in a smoothly rendered image.</p>\n\n<p>What I'm failing to do right now is to produce something similar using the API: either the resulting image has scaled pixels or is blurry and has a size 500x500 pixels, or it's in the \"original\" size.</p>\n\n<p>Here's a minimum snippet of my playground code:</p>\n\n<pre><code>package main\n\nimport \"gopkg.in/gographics/imagick.v2/imagick\"\n\nfunc main() {\n    imagick.Initialize()\n    defer imagick.Terminate()\n    mw := imagick.NewMagickWand()\n    defer mw.Destroy()\n\n    mw.SetImageResolution(5000,5000)\n    mw.SetOption(\"psd:fit-page\", \"500x\")\n\n    mw.ReadImage(\"test.pdf\")\n    mw.ResizeImage(500, 500, imagick.FILTER_POINT, 1)\n    mw.SetIteratorIndex(0) // This being the page offset\n    mw.SetImageFormat(\"png\")\n    mw.WriteImage(\"test.png\")\n}\n</code></pre>\n\n<p>I got confused by <em>density</em>, <em>image size</em>, <em>image resolution</em> and <em>canvas size</em> I guess. How is it meant to be used?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18471, "user_id": 4597501, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/AYPrE.jpg?s=128&g=1", "display_name": "All \u0406\u0455 V\u0430\u0438\u0456\u0442y", "link": "https://stackoverflow.com/users/4597501/all-%d0%86%d1%95-v%d0%b0%d0%b8%d1%96%d1%82y"}, "is_accepted": false, "score": 1, "last_activity_date": 1545024329, "creation_date": 1545024329, "answer_id": 53809390, "question_id": 53809343, "link": "https://stackoverflow.com/questions/53809343/recompiling-go-echo-project-when-source-changes-with-compiledaemon/53809390#53809390", "title": "Recompiling Go Echo project when source changes with compileDaemon", "body": "<p>Add the project directory to the command, for the current directory <code>.</code>,</p>\n\n<pre><code>CompileDaemon -directory=. -command=\"go run main.go\"\n</code></pre>\n\n<p>which will work.</p>\n"}], "owner": {"reputation": 18471, "user_id": 4597501, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/AYPrE.jpg?s=128&g=1", "display_name": "All \u0406\u0455 V\u0430\u0438\u0456\u0442y", "link": "https://stackoverflow.com/users/4597501/all-%d0%86%d1%95-v%d0%b0%d0%b8%d1%96%d1%82y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545024329, "creation_date": 1545023943, "question_id": 53809343, "link": "https://stackoverflow.com/questions/53809343/recompiling-go-echo-project-when-source-changes-with-compiledaemon", "title": "Recompiling Go Echo project when source changes with compileDaemon", "body": "<p>I'm trying to make compileDaemon to compile and serve my Go Echo application whenever I make changes to the source code. The commands that I tried are,</p>\n\n<pre><code>CompileDaemon -build=\"go run main.go\"\n</code></pre>\n\n<p>and </p>\n\n<pre><code>CompileDaemon -command=\"go run main.go\"\n</code></pre>\n\n<p>both of them starts <code>CompileDaemon</code> with the following output </p>\n\n<pre><code>2018/12/17 10:40:29 Running build command!\n2018/12/17 10:40:29 Build ok.\n</code></pre>\n\n<p>Whenever I update the source, the output repeats but my server is not starting . How do I make compileDaemon to run my echo server? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "composition", "reusability"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545021501, "post_id": 53808947, "comment_id": 94466439, "body": "1. Give interfaces meaningful names not <code>confPlayer1</code>, <code>confPlayer2</code>, etc 2. Split <code>confPlayer1</code> to an interface that has <code>Set + Move</code> methods and another one that has <code>Initialize</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545056109, "post_id": 53808947, "comment_id": 94482281, "body": "Composition doesn&#39;t really have anything to do with files. You can combine them into a single <code>player.go</code> file by doing exactly that. Go has no restrictions on what can be in the same file."}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1599640046, "post_id": 53808947, "comment_id": 112832233, "body": "Thought provoking question +1."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5100125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84d64d80376bf4ebc02f16a47eeddc6?s=128&d=identicon&r=PG&f=1", "display_name": "Cas1337", "link": "https://stackoverflow.com/users/5100125/cas1337"}, "edited": false, "score": 0, "creation_date": 1545114959, "post_id": 53809614, "comment_id": 94503564, "body": "That&#39;s something I could implement. Thanks for the answer.  I&#39;m curious about Object composition. Let&#39;s say func Move() for player2 is the same as player1&#39;s, but with additional logic.  Is this an scenario in which Object composition could come in play?"}, {"owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "reply_to_user": {"reputation": 81, "user_id": 5100125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84d64d80376bf4ebc02f16a47eeddc6?s=128&d=identicon&r=PG&f=1", "display_name": "Cas1337", "link": "https://stackoverflow.com/users/5100125/cas1337"}, "edited": false, "score": 0, "creation_date": 1545126677, "post_id": 53809614, "comment_id": 94508885, "body": "Yeah sort of, but object composition works differently then inheritance. In object composition each object is assigned a responsibility and they work under scope of their responsibility. For eg:"}, {"owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "reply_to_user": {"reputation": 81, "user_id": 5100125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84d64d80376bf4ebc02f16a47eeddc6?s=128&d=identicon&r=PG&f=1", "display_name": "Cas1337", "link": "https://stackoverflow.com/users/5100125/cas1337"}, "edited": false, "score": 0, "creation_date": 1545127092, "post_id": 53809614, "comment_id": 94509157, "body": "Yeah sort of, but object composition works differently then inheritance. In object composition each object is assigned a responsibility and they work under scope of their responsibility. For eg: In a game Player1 has responsibility of running and Player2 has responsibility firing bullets to whoever comes in way of Player1, so whenever Player1 finds someone in his way it stops and delegates responsibility to fire bullet and once bullet is firing is done it starts running again."}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 1, "creation_date": 1599641306, "post_id": 53809614, "comment_id": 112832853, "body": "I like your definition of composition where each object is assigned a responsibility +1. In Go composition can looks like inheritance but it is not inheritance."}], "tags": [], "owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "is_accepted": true, "score": 2, "last_activity_date": 1545027417, "last_edit_date": 1545027417, "creation_date": 1545025899, "answer_id": 53809614, "question_id": 53808947, "link": "https://stackoverflow.com/questions/53808947/how-to-correctly-use-composition-in-go/53809614#53809614", "title": "How to correctly use composition in Go", "body": "<blockquote>\n  <p>Golang uses composition.</p>\n  \n  <ol>\n  <li>Object composition: Object composition is used instead of inheritance (which is used in most of the traditional languages).\n  Object composition means that an object contains object of another\n  object (say Object X) and delegate responsibilities of object X to it.\n  Here instead of overriding functions (as in inheritance), function\n  calls delegated to internal objects.</li>\n  <li>Interface composition: In interface composition and interface can compose other interface and have all set of methods declared in\n  internal interface becomes part of that interface.</li>\n  </ol>\n</blockquote>\n\n<p>Now to specifically answer your question, you are talking about interface composition here. You can also see code snippet here: <a href=\"https://play.golang.org/p/fn_mXP6XxmS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/fn_mXP6XxmS</a></p>\n\n<p>Check below code:</p>\n\n<p><strong>player2.go</strong></p>\n\n<pre><code>package game\n\ntype confPlayer2 interface {\n    Set(string, int) bool\n    Move(string) bool\n    }\n\nfunc Play(conf confPlayer2) string {\n    // code for Player2, not the same as Player1.\n}\n</code></pre>\n\n<p><strong>player1.go</strong></p>\n\n<pre><code>package game\n\ntype confPlayer1 interface {\n    confPlayer2\n    Initialize() bool\n}\n\nfunc Play(conf confPlayer1) string {\n    // code for Player1\n}\n</code></pre>\n\n<p>In above code snippet confPlayer1 interface has composed interface confPlayer2 in it, except Initialize function which is only part of confPlayer1.</p>\n\n<p>Now you can use interface confPlayer2 for player 2 and confPlayer1 for player1. see code snippet below:</p>\n\n<p><strong>player.go</strong></p>\n\n<pre><code>package game\n\ntype Player struct{\n  Name string\n  ...........\n  ...........\n}\n\n\nfunc (p Player) Set(){\n  .......\n  .......\n}\n\nfunc (p Player) Move(){\n  ........\n  ........\n}\n\n\nfunc Play(confPlayer2 player){\n   player.Move()\n   player.Set()\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5100125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84d64d80376bf4ebc02f16a47eeddc6?s=128&d=identicon&r=PG&f=1", "display_name": "Cas1337", "link": "https://stackoverflow.com/users/5100125/cas1337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 53809614, "answer_count": 1, "score": 1, "last_activity_date": 1545027417, "creation_date": 1545020696, "last_edit_date": 1545021319, "question_id": 53808947, "link": "https://stackoverflow.com/questions/53808947/how-to-correctly-use-composition-in-go", "title": "How to correctly use composition in Go", "body": "<p>I'm new on go; have two files that share similar behavior and was told to use composition to avoid having duplicated code, but can't quite understand the concept of composition.</p>\n\n<p>Both files have common functionality but have their differences one of another.</p>\n\n<hr>\n\n<p><strong>player1.go</strong></p>\n\n<pre><code>package game\n\ntype confPlayer1 interface {\n    Set(string, int) bool\n    Move(string) bool\n    Initialize() bool\n}\n\nfunc Play(conf confPlayer1) string {\n    // code for Player1\n}\n\n// ... other funcs\n</code></pre>\n\n<hr>\n\n<p><strong>player2.go</strong></p>\n\n<pre><code>package game\n\ntype confPlayer2 interface {\n    Set(string, int) bool\n    Move(string) bool\n    // Initializer is only for Player1\n}\n\nfunc Play(conf confPlayer2) string {\n    // code for Player2, not the same as Player1.\n}\n\n// ... the same other funcs from player1.go file\n// ... they differ slighly from player1.go funcs\n</code></pre>\n\n<hr>\n\n<p>Is there a way to combine all into a single <strong>player.go</strong> file?</p>\n"}, {"tags": ["string", "go", "split"], "comments": [{"owner": {"reputation": 57, "user_id": 1491359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61dd95d3f78304fcc1ceb4e44754bdf?s=128&d=identicon&r=PG", "display_name": "Rishi Agrawal", "link": "https://stackoverflow.com/users/1491359/rishi-agrawal"}, "edited": false, "score": 0, "creation_date": 1545051445, "post_id": 53808785, "comment_id": 94479588, "body": "Downvoters please let me know what went wrong in writing the question so that it can be improved in further questions."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1545022250, "last_edit_date": 1545022250, "creation_date": 1545020370, "answer_id": 53808911, "question_id": 53808785, "link": "https://stackoverflow.com/questions/53808785/unable-to-properly-split-a-string-using-n-in-golang/53808911#53808911", "title": "Unable to properly split a string using &quot;\\n&quot; in golang", "body": "<p>Split is working as you expect. The issue is with how you print the lines.</p>\n\n<p>The second argument to Println below is a slice. </p>\n\n<pre><code> // This is not splitting the lines, it is converting the whole output to a single line.\nfmt.Println(\"\\nLines are \", strings.Split(str_out, \"\\n\"))\n</code></pre>\n\n<p>Per the <a href=\"https://godoc.org/fmt\" rel=\"nofollow noreferrer\">fmt</a> documentation, a slice is printed as:</p>\n\n<pre><code>[elem0 elem1 ...]\n</code></pre>\n\n<p>Notice that elements are separated by spaces.  Splitting by \\n and printing will in effect replace \\n with ' '.  Try this code to confirm that split is working as expected:</p>\n\n<pre><code>for i, line := range strings.Split(str_out, \"\\n\") {\n   fmt.Println(i, line)\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 1491359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61dd95d3f78304fcc1ceb4e44754bdf?s=128&d=identicon&r=PG", "display_name": "Rishi Agrawal", "link": "https://stackoverflow.com/users/1491359/rishi-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "accepted_answer_id": 53808911, "answer_count": 1, "score": -2, "last_activity_date": 1545022250, "creation_date": 1545019159, "question_id": 53808785, "link": "https://stackoverflow.com/questions/53808785/unable-to-properly-split-a-string-using-n-in-golang", "title": "Unable to properly split a string using &quot;\\n&quot; in golang", "body": "<p>I am trying to split the output of <code>free</code> command into 3 lines. A general output of free is</p>\n\n<p><code>total        used        free      shared  buff/cache   available\nMem:       16309236    11129884      860300      534300     4319052     4306208\nSwap:      20971516      234236    20737280\n</code></p>\n\n<p>But when I am using strings.Split() of <code>golang</code> the <code>Split</code> function is now behaving as expected. I tried debugging it but could not find anything.</p>\n\n<p>Kindly help. </p>\n\n<pre><code>package main\n\nimport \"os/exec\"\nimport \"github.com/golang/glog\"\nimport \"fmt\"\nimport \"strings\"\nimport \"errors\"\n\nfunc thisWorks() {\n    str_out := \"hello world \\n How are you \\nthis is good\"\n    lines := strings.Split(str_out, \"\\n\")\n    fmt.Printf(\"lines is  \\n%s\\n\", lines)\n}\n\nfunc GetFreeOutput() error {\n\n    var errMsg string\n    bytes_out, err := exec.Command(\"free\").Output()\n\n    // This shows that the output has 10 (newline) in it.\n    fmt.Println(bytes_out)\n\n    if err != nil {\n        errMsg = \"Error geting output of free command\"\n        glog.Fatal(errMsg)\n        return errors.New(errMsg)\n    }\n\n    str_out := string(bytes_out)\n    fmt.Printf(\"str_out is  \\n%s\", str_out)\n\n    // This is not splitting the lines, it is converting the whole output to a single line.\n    fmt.Println(\"\\nLines are \", strings.Split(str_out, \"\\n\"))\n\n    index_of_newline := strings.Index(str_out, \"\\n\")\n\n    // This gives the index of \"\\n\" as 79 on my machine, which is correct.\n    fmt.Printf(\"\\nIndex is %d\", index_of_newline)\n\n    fmt.Println(\"\\nLine using index are \", strings.Split(str_out, string(str_out[index_of_newline])))\n\n    return nil\n}\n\nfunc main() {\n    err := GetFreeOutput()\n    fmt.Printf(\"Error is %s\", err)\n}\n</code></pre>\n"}, {"tags": ["go", "allocation"], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545029317, "post_id": 53808813, "comment_id": 94468578, "body": "The built-in <code>append</code> function is optimized by the compiler."}], "tags": [], "owner": {"reputation": 17856, "user_id": 1439168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd72ad672b055a7d59cfb1c30d1c724f?s=128&d=identicon&r=PG", "display_name": "Miguel Mota", "link": "https://stackoverflow.com/users/1439168/miguel-mota"}, "is_accepted": true, "score": 3, "last_activity_date": 1545019478, "creation_date": 1545019478, "answer_id": 53808813, "question_id": 53808721, "link": "https://stackoverflow.com/questions/53808721/make-slices-size/53808813#53808813", "title": "Make slices size", "body": "<p>The difference is that the memory for the slice is allocated upfront and <code>len(mySlice)</code> returns the total slice length.</p>\n\n<p>Performance wise it is beneficial to allocate the size upfront because when you call <code>a = append(a, n)</code> the following occurs:</p>\n\n<ul>\n<li><p>It calls the builtin append function and for that it first copies the <code>a</code> slice (slice header, backing array is not part of the header), and it has to create a temporary slice for the variadic parameter which will contain the value <code>n</code>.</p></li>\n<li><p>Then it has to reslice <code>a</code> if it has enough capacity like <code>a = a[:len(a)+1]</code> - which involves assigning the new slice to <code>a</code> inside the append function. If a would not have big enough capacity to do the append \"in-place\" then a new array would have to be allocated, content from slice copied, and then the assign / append be executed.</p></li>\n<li><p>Then assigns <code>n</code> to a <code>[len(a)-1]</code>.</p></li>\n<li><p>Then returns the new slice from the append function, and this new slice is assigned to the local variable <code>a</code>.</p></li>\n</ul>\n\n<p>Compared to <code>a[i] = n</code> which is a simple assignment.</p>\n\n<ul>\n<li><a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Assignments</a></li>\n<li><a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">https://blog.golang.org/slices</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7157674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8816a6c2f5a4e2b01154f7b893e50be2?s=128&d=identicon&r=PG", "display_name": "arthur-lee", "link": "https://stackoverflow.com/users/7157674/arthur-lee"}, "is_accepted": false, "score": -1, "last_activity_date": 1545132708, "last_edit_date": 1545132708, "creation_date": 1545028006, "answer_id": 53809930, "question_id": 53808721, "link": "https://stackoverflow.com/questions/53808721/make-slices-size/53809930#53809930", "title": "Make slices size", "body": "<blockquote>\n  <p>My question is, what's the difference between giving that zero ( or 2 or 5 or whatever) when \"making\" the slice if later on we can keep adding items as long as we wan?</p>\n</blockquote>\n\n<p>A not appropriate allocation can cause re-allocation.</p>\n\n<blockquote>\n  <p>Is there a performance bonus by trying to guess the capacity that slice will end up having?</p>\n</blockquote>\n\n<p>yes, re-allocation will lead to additional copy on slice.</p>\n\n<blockquote>\n  <p>Slice: The size specifies the length. The capacity of the slice is\n  equal to its length. A second integer argument may be provided to\n  specify a different capacity; it must be no smaller than the length. </p>\n  \n  <p>For example, make([]int, 0, 10) allocates an underlying array of size\n  10 and returns a slice of length 0 and capacity 10 that is backed by\n  this underlying array.</p>\n</blockquote>\n\n<p>copy from go doc.</p>\n\n<p>In my view. Slice is <strong>like a pointer with length and capacity</strong> in c/c++. Append to a slice will append elements after the offset on that pointer. The capacity is the total sequential space size. Once the <code>capacity</code>- <code>allocated</code> space is not enough, append will cause a re-allocation and a copy on the slice. </p>\n\n<blockquote>\n  <p><code>make(s, 1)</code> </p>\n</blockquote>\n\n<p>go will do more than you think:</p>\n\n<ol>\n<li><p>Allocate a sequential space larger than the size you give (same in c++ vector) to avoid the re-allocation which can cause low performance.</p></li>\n<li><p>Initialize the size you give in make. (RAII)</p></li>\n<li><p>Once reallocation happened, go will allocate a twice size sequential space and copy the old slice to that place. This will also low down the performance.</p></li>\n</ol>\n\n<p>To avoid the reallocation happen, we can give the optional capacity arguments in <code>make</code> to tell the go we need a bigger space.</p>\n"}], "owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 53808813, "answer_count": 2, "score": 1, "last_activity_date": 1545132708, "creation_date": 1545018543, "question_id": 53808721, "link": "https://stackoverflow.com/questions/53808721/make-slices-size", "title": "Make slices size", "body": "<p>In Golang you can allocate memory for a slice with the below syntax :</p>\n\n<pre><code>my_slice := make( []int, 0 )\n</code></pre>\n\n<p>And then later on I can add elements with the built-in append function as :</p>\n\n<pre><code>my_slice := append(my_slice, 23)\n</code></pre>\n\n<p>My question is, what's the difference between giving that zero ( or 2 or 5 or whatever) when \"making\" the slice if later on we can keep adding items as long as we wan?</p>\n\n<p>Is there a performance bonus by trying to guess the capacity that slice will end up having?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17856, "user_id": 1439168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd72ad672b055a7d59cfb1c30d1c724f?s=128&d=identicon&r=PG", "display_name": "Miguel Mota", "link": "https://stackoverflow.com/users/1439168/miguel-mota"}, "edited": false, "score": 2, "creation_date": 1545017996, "post_id": 53808582, "comment_id": 94465778, "body": "afaik there&#39;s no linting option. proper tests covering use cases should help"}], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 1, "last_activity_date": 1545080682, "creation_date": 1545080682, "answer_id": 53822963, "question_id": 53808582, "link": "https://stackoverflow.com/questions/53808582/golang-lint-for-return-statement-after-render/53822963#53822963", "title": "Golang lint for return statement after render", "body": "<p>I think this is a decent case for unit tests. A mock would happily fail with something like you have described:</p>\n\n<pre><code>// foo.go\n\npackage foo\n\ntype Foo struct{\n  render Renderer\n}\n\nfunc New(r Renderer) *Foo {\n  return &amp;Foo{render: r}\n}\n\nfunc (f *Foo) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n  if passwordNotCorrect {\n    w.WriteHeader(http.StatusUnauthorized)\n    render.JSON(w, r, nil)\n    return // If this is missing, we will return both 401 and 200.\n  }\n\n  w.WriteHeader(http.StatusOK)\n  render.JSON(w, r, nil)\n  return\n}\n</code></pre>\n\n<p>Now for the test...</p>\n\n<pre><code>// foo_test.go\n\npackage foo_test\n\nimport (\n  \"github.com/something/whatever/foo\"\n  \"github.com/golang/mock/gomock\"\n)\n\n//go:generate mockgen --source=foo.go --destination=mock_test.go --package=foo_test\n\nfunc TestFoo(t *testing.T) {\n  ctrl := gomock.NewController(t)\n  defer ctrl.Finish()\n\n  mockRenderer := NewMockRenderer(ctrl)\n  mockRenderer.\n    EXPECT().\n    JSON(gomock.Any(), gomock.Any(), gomock.Any()) // This will fail JSON is invoked twice\n\n  f := foo.New(mockRenderer)\n  req := httptest.NewRequest(http.MethodGet, \"http://some.url\", nil)\n  f.ServeHTTP(httptest.NewRecorder(), req)\n}\n</code></pre>\n\n<p>This assumes that <code>render</code> is not a package. Then some adjustments will be necessary.</p>\n"}], "owner": {"reputation": 1023, "user_id": 1876120, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3046914c1846e632ce2a45b6537a3ae4?s=128&d=identicon&r=PG", "display_name": "Myone", "link": "https://stackoverflow.com/users/1876120/myone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1545080682, "creation_date": 1545016958, "question_id": 53808582, "link": "https://stackoverflow.com/questions/53808582/golang-lint-for-return-statement-after-render", "title": "Golang lint for return statement after render", "body": "<p>If you don't write a <code>return</code> after a render statement, you'll send multiple HTTP statuses back to the client. I'd really like to avoid this since it could both have security implications but also is just... weird behavior.</p>\n\n<p>Example:</p>\n\n<pre><code>if passwordNotCorrect {\n    w.WriteHeader(http.StatusUnauthorized)\n    render.JSON(w, r, nil)\n    return // If this is missing, we will return both 401 and 200.\n}\n\nw.WriteHeader(http.StatusOK)\nrender.JSON(w, r, nil)\nreturn\n</code></pre>\n\n<p>Is there any linter out there that could warn you about this, to avoid silly mistakes?</p>\n"}, {"tags": ["loops", "go"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1545016218, "post_id": 53808461, "comment_id": 94465498, "body": "instead of dividing your input into 10 buckets, just increment your counter by 10 instead of 1 then gulp that and repeat"}, {"owner": {"reputation": 3063, "user_id": 5075720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kNyMGvaELDs/AAAAAAAAAAI/AAAAAAAAVnw/P1Rt8TFE2gc/photo.jpg?sz=128", "display_name": "PaSTE", "link": "https://stackoverflow.com/users/5075720/paste"}, "edited": false, "score": 0, "creation_date": 1545016224, "post_id": 53808461, "comment_id": 94465499, "body": "Are you sure about the stopping condition of that first <code>for</code> loop?"}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "is_accepted": false, "score": -1, "last_activity_date": 1545017785, "creation_date": 1545017785, "answer_id": 53808655, "question_id": 53808461, "link": "https://stackoverflow.com/questions/53808461/batching-at-most-10-at-a-time-over-input/53808655#53808655", "title": "Batching at most 10 at a time over input", "body": "<p>Elegant solution from Tv on #go-nuts looks like:</p>\n\n<pre><code>for len(input) &gt; 0 {\n    n := 10\n    if n &gt; len(input) {\n        n = len(input)\n    }\n    chunk := input[:n]\n    input = input[n:]\n    fmt.Println(\"Batch\", chunk)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Y3U8dUD7Zrr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Y3U8dUD7Zrr</a></p>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545017785, "creation_date": 1545015375, "question_id": 53808461, "link": "https://stackoverflow.com/questions/53808461/batching-at-most-10-at-a-time-over-input", "title": "Batching at most 10 at a time over input", "body": "<p>I'm trying and failing to accomplish the simple task of batching over input, at most 10 at a time. The follow code almost works:</p>\n\n<pre><code>func batchMe(input []int) {\n    fmt.Println(\"Length\", len(input), len(input)/10)\n    for i := 0; i &lt;= len(input)/10; i++ {\n        from := i * 10\n        to := (i + 1) * 10\n        if len(input) &lt; to {\n            to = len(input)\n        }\n        fmt.Println(\"Batch\", i, input[from:to])\n    }\n</code></pre>\n\n<p>But you can see from <a href=\"https://play.golang.org/p/_UgFD1iDyse\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_UgFD1iDyse</a> that it prints:</p>\n\n<pre><code>Length 10 1\nBatch 0 [1 2 3 4 5 6 7 8 9 10]\nBatch 1 []\n</code></pre>\n\n<p>I don't want it to print Batch 1 in the case of 10 elements!</p>\n\n<p>Perhaps there is a code simplification here?</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1600492053, "post_id": 53808246, "comment_id": 113111549, "body": "It&#39;s good that you&#39;re putting readability first."}], "answers": [{"comments": [{"owner": {"reputation": 1040, "user_id": 3625404, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b579ac1f7b1cceca92f33f09a4c9a1f9?s=128&d=identicon&r=PG&f=1", "display_name": "qeatzy", "link": "https://stackoverflow.com/users/3625404/qeatzy"}, "edited": false, "score": 0, "creation_date": 1545013296, "post_id": 53808262, "comment_id": 94465022, "body": "thx for your answer. I am new to golang, and currently this is exactly who I do in my code. Is there one-liner? Or I have to write it this way?"}, {"owner": {"reputation": 1040, "user_id": 3625404, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b579ac1f7b1cceca92f33f09a4c9a1f9?s=128&d=identicon&r=PG&f=1", "display_name": "qeatzy", "link": "https://stackoverflow.com/users/3625404/qeatzy"}, "edited": false, "score": 0, "creation_date": 1545014200, "post_id": 53808262, "comment_id": 94465168, "body": "For benchmark code, there is a confusion, why two <code>make</code> in <code>BenchmarkHeap</code>? Also looks like looping through do assigning is the best I can get, since in most case, I won&#39;t bother to create a wrapper. Thanks for your answer."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1040, "user_id": 3625404, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b579ac1f7b1cceca92f33f09a4c9a1f9?s=128&d=identicon&r=PG&f=1", "display_name": "qeatzy", "link": "https://stackoverflow.com/users/3625404/qeatzy"}, "edited": false, "score": 0, "creation_date": 1545014560, "post_id": 53808262, "comment_id": 94465247, "body": "The first <code>make</code> is not essential so I replaced it with <code>var s []int</code>. I&#39;m forcing a heap allocation."}, {"owner": {"reputation": 1040, "user_id": 3625404, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b579ac1f7b1cceca92f33f09a4c9a1f9?s=128&d=identicon&r=PG&f=1", "display_name": "qeatzy", "link": "https://stackoverflow.com/users/3625404/qeatzy"}, "edited": false, "score": 0, "creation_date": 1545014974, "post_id": 53808262, "comment_id": 94465324, "body": "For array/slice type, is my below understanding correct? slice : <code>var s []int</code>, slice : <code>s := make(int, 5)</code>, array: <code>var s [5]int</code>. And array is of fixed length, where slice is dynamic has <code>ptr, length, capacity</code> attributes."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1545016666, "last_edit_date": 1545016666, "creation_date": 1545012991, "answer_id": 53808262, "question_id": 53808246, "link": "https://stackoverflow.com/questions/53808246/how-to-create-an-array-slice-of-5-value-all-of-same-value/53808262#53808262", "title": "How to create an array/slice of 5 value, all of same value", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    s := make([]int, 5)\n    for i := range s {\n        s[i] = 42\n    }\n    fmt.Println(len(s), s)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/GjTXruMsJ5h\" rel=\"nofollow noreferrer\">https://play.golang.org/p/GjTXruMsJ5h</a></p>\n\n<p>Output:</p>\n\n<pre><code>5 [42 42 42 42 42]\n</code></pre>\n\n<hr>\n\n<p>Some benchmarks:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"testing\"\n)\n\nfunc BenchmarkStack(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        s := make([]int, 5)\n        for i := range s {\n            s[i] = 42\n        }\n    }\n}\n\nfunc BenchmarkHeap(b *testing.B) {\n    var s []int\n    for N := 0; N &lt; b.N; N++ {\n        s = make([]int, 5)\n        for i := range s {\n            s[i] = 42\n        }\n    }\n}\n\nfunc BenchmarkHygull(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        var s []int\n        for i := 0; i &lt; 5; i++ {\n            s = append(s, 42)\n        }\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test slice42_test.go -bench=. -benchmem\nBenchmarkStack-8     1000000000      2.05 ns/op     0 B/op    0 allocs/op\nBenchmarkHeap-8       100000000     26.9 ns/op     48 B/op    1 allocs/op\nBenchmarkHygull-8      10000000    123 ns/op      120 B/op    4 allocs/op\n$ \n</code></pre>\n\n<p><code>BenchmarkHygull</code> demonstrates how inefficient @hygull's solution is.</p>\n\n<hr>\n\n<p>A \"one-liner\":</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc newInts(n, v int) []int {\n    s := make([]int, n)\n    for i := range s {\n        s[i] = v\n    }\n    return s\n}\n\nfunc main() {\n    s := newInts(5, 42)\n    fmt.Println(len(s), s)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/t8J-AjYQ72l\" rel=\"nofollow noreferrer\">https://play.golang.org/p/t8J-AjYQ72l</a></p>\n\n<p>Output:</p>\n\n<pre><code>5 [42 42 42 42 42]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1040, "user_id": 3625404, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b579ac1f7b1cceca92f33f09a4c9a1f9?s=128&d=identicon&r=PG&f=1", "display_name": "qeatzy", "link": "https://stackoverflow.com/users/3625404/qeatzy"}, "edited": false, "score": 0, "creation_date": 1545014285, "post_id": 53808334, "comment_id": 94465188, "body": "Agree in most case it&#39;s sufficient to dynamic add item, just like C++ <code>std::vector</code> &#39;s <code>.push_back</code>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1545015729, "post_id": 53808334, "comment_id": 94465427, "body": "For a slice of known size, your solution is inefficient."}], "tags": [], "owner": {"reputation": 7004, "user_id": 6615163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hSNqz.png?s=128&g=1", "display_name": "hygull", "link": "https://stackoverflow.com/users/6615163/hygull"}, "is_accepted": false, "score": 1, "last_activity_date": 1545013880, "creation_date": 1545013880, "answer_id": 53808334, "question_id": 53808246, "link": "https://stackoverflow.com/questions/53808246/how-to-create-an-array-slice-of-5-value-all-of-same-value/53808334#53808334", "title": "How to create an array/slice of 5 value, all of same value", "body": "<p>The best way to do will be to use slice for that as it can grow dynamically. </p>\n\n<p>Currently, you are looking only for <strong>5</strong> values so using arrays also is not a problem but what if you are looking for dynamic size (i.e. if you specify size of array in run time, there may be a chance of either going beyond the range or not using all the allocated spaces). </p>\n\n<p>So I think the following code is sufficient to understand that. </p>\n\n<pre><code>package main  \nimport \"fmt\" \n\nfunc main() { \n    var s []int\n    value := 42 // It can be changed to other values \n\n    for i := 0; i &lt; 5; i++ {\n        s = append(s, value)\n    }\n\n    fmt.Println(s); // [42 42 42 42 42]\n}\n</code></pre>\n"}], "owner": {"reputation": 1040, "user_id": 3625404, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b579ac1f7b1cceca92f33f09a4c9a1f9?s=128&d=identicon&r=PG&f=1", "display_name": "qeatzy", "link": "https://stackoverflow.com/users/3625404/qeatzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1900, "favorite_count": 2, "accepted_answer_id": 53808262, "answer_count": 2, "score": 0, "last_activity_date": 1545031070, "creation_date": 1545012788, "last_edit_date": 1545031070, "question_id": 53808246, "link": "https://stackoverflow.com/questions/53808246/how-to-create-an-array-slice-of-5-value-all-of-same-value", "title": "How to create an array/slice of 5 value, all of same value", "body": "<p><strong>Problem</strong></p>\n\n<p>In go programming language, how to create an array of length 5, with all elements has same value, eg, 42.</p>\n\n<p><strong>Preference order</strong></p>\n\n<p>readability, conciseness, performance.</p>\n"}, {"tags": ["go", "openssl", "command-line-interface"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1545009093, "post_id": 53807888, "comment_id": 94464296, "body": "Pipe <code>|</code> is a shell feature. Instead - use processes <code>stdin</code> and <code>stdout</code> and forward one to another."}, {"owner": {"reputation": 700, "user_id": 2470538, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/UF7Rp.jpg?s=128&g=1", "display_name": "Lord Zed", "link": "https://stackoverflow.com/users/2470538/lord-zed"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545009667, "post_id": 53807888, "comment_id": 94464385, "body": "@zerkms how would I do that (still learning golang)?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545009781, "post_id": 53807888, "comment_id": 94464406, "body": "hint: Create two commands:  treat <code>stdout</code> of one process as <code>io.Reader</code> and <code>stdin</code> of another as <code>io.Writer</code>"}, {"owner": {"reputation": 700, "user_id": 2470538, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/UF7Rp.jpg?s=128&g=1", "display_name": "Lord Zed", "link": "https://stackoverflow.com/users/2470538/lord-zed"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545010247, "post_id": 53807888, "comment_id": 94464492, "body": "How do I deal with <code>echo</code>?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545010921, "post_id": 53807888, "comment_id": 94464636, "body": "You don&#39;t: you have <code>fmt.Printf</code> to print in Go"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545048472, "post_id": 53807888, "comment_id": 94477955, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10781516/how-to-pipe-several-commands-in-go\">How to pipe several commands in Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 700, "user_id": 2470538, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/UF7Rp.jpg?s=128&g=1", "display_name": "Lord Zed", "link": "https://stackoverflow.com/users/2470538/lord-zed"}, "edited": false, "score": 0, "creation_date": 1545058972, "post_id": 53815169, "comment_id": 94483946, "body": "try this url <code>blogspot.es</code> it will exit with status 1. I want to be able to use go routines, if ssl not valid I still need to create some sort of output."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 700, "user_id": 2470538, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/UF7Rp.jpg?s=128&g=1", "display_name": "Lord Zed", "link": "https://stackoverflow.com/users/2470538/lord-zed"}, "edited": false, "score": 0, "creation_date": 1545061580, "post_id": 53815169, "comment_id": 94485504, "body": "Set the <code>ServerName</code> to one of the valid names (<code>&quot;accounts.blogdiario.com&quot;</code>, <code>&quot;www.accounts.blogdiario.com&quot;</code>), or, if you must, enable <a href=\"https://golang.org/pkg/crypto/tls/#Config\" rel=\"nofollow noreferrer\"><code>InsecureSkipVerify</code></a>."}, {"owner": {"reputation": 700, "user_id": 2470538, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/UF7Rp.jpg?s=128&g=1", "display_name": "Lord Zed", "link": "https://stackoverflow.com/users/2470538/lord-zed"}, "edited": false, "score": 0, "creation_date": 1545083169, "post_id": 53815169, "comment_id": 94495627, "body": "I actually tried <code>tls</code> before but I&#39;ve posted question and it was panicing if on this <code>blogspot.es</code> domain. The only part that differs is <code>client.Handshake()</code> I had something else. So now it does not panic but return string that I can check for at the end for <code>not blogspot.es</code> and will know its invalid (as it really is)."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1545049395, "creation_date": 1545049395, "answer_id": 53815169, "question_id": 53807888, "link": "https://stackoverflow.com/questions/53807888/execute-echo-and-openssl-command-in-golang/53815169#53815169", "title": "Execute echo and openssl command in golang", "body": "<p>Go's standard library contains a perfectly capable TLS implementation, so there is really no reason to launch two hefty openssl processes:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"time\"\n)\n\nfunc main() {\n    conn, err := net.Dial(\"tcp\", \"example.com:443\")\n    if err != nil {\n            log.Fatal(err)\n    }\n\n    client := tls.Client(conn, &amp;tls.Config{\n            ServerName: \"example.com\",\n    })\n    defer client.Close()\n\n    if err := client.Handshake(); err != nil {\n            log.Fatal(err)\n    }\n\n    cert := client.ConnectionState().PeerCertificates[0]\n    fmt.Println(cert.NotAfter.Format(time.RFC3339)) // Output: 2020-12-02T12:00:00Z\n}\n</code></pre>\n"}], "owner": {"reputation": 700, "user_id": 2470538, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/UF7Rp.jpg?s=128&g=1", "display_name": "Lord Zed", "link": "https://stackoverflow.com/users/2470538/lord-zed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545049395, "creation_date": 1545008988, "last_edit_date": 1545040008, "question_id": 53807888, "link": "https://stackoverflow.com/questions/53807888/execute-echo-and-openssl-command-in-golang", "title": "Execute echo and openssl command in golang", "body": "<p>I'm trying to read remote website ssl cert with this cli command <code>openssl s_client -connect www.yahoo.no:443 2&gt; /dev/null | openssl x509 -noout -enddate | cut -d = -f 2</code>.</p>\n\n<p>This works fine in cli, but when I execute it in golang:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"log\"\n    \"os/exec\"\n    \"time\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"echo\", \"| openssl s_client -connect www.yahoo.com:443 2&gt; /dev/null | openssl x509 -noout -enddate | cut -d = -f 2\")\n    var out bytes.Buffer\n    cmd.Stdout = &amp;out\n    err := cmd.Run()\n\n    log.Println(out.String())\n}\n</code></pre>\n\n<p>I get nothing in return. How can I run this command in go?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>this is what I've tried but no success</p>\n\n<pre><code>func command() {\n\n    cmd1 := exec.Command(\"openssl\", \"s_client\", \"-connect\", \"www.yahoo.no:443\", \"2&gt;\", \"/dev/null\")\n    cmd2 := exec.Command(\"openssl\", \"x509\", \"-noout\", \"-enddate\")\n\n    var out bytes.Buffer\n\n    reader, writer := io.Pipe()\n    cmd1.Stdout = writer\n    cmd2.Stdin = reader\n\n    cmd2.Stdout = &amp;out\n\n    cmd1.Start()\n    cmd2.Start()\n\n    cmd1.Wait()\n    writer.Close()\n\n    cmd2.Wait()\n    reader.Close()\n\n    io.Copy(&amp;out, reader)\n    log.Println(out.String())\n\n}\n</code></pre>\n\n<p>I get empty response.</p>\n"}, {"tags": ["image", "go", "jfif"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 2940553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19136a085229cbb0c25937437027f6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2940553/simon"}, "edited": false, "score": 0, "creation_date": 1550375890, "post_id": 54359317, "comment_id": 96243270, "body": "Thanks for your answer. I\u2019ll try your approach when I can spare some time, but the idea sounds very promising. BTW the library doesn\u2019t do what the name shows. It can only parse exif info when I checked a couple days ago. Will add more comment when I got more updates."}, {"owner": {"reputation": 93, "user_id": 2940553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19136a085229cbb0c25937437027f6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2940553/simon"}, "edited": false, "score": 0, "creation_date": 1557579066, "post_id": 54359317, "comment_id": 98817540, "body": "Sorry for late response. I didn&#39;t have time to verify until this week. For the record, go-exif isn&#39;t a feasible package to <b>add</b> exif information. <a href=\"https://www.media.mit.edu/pia/Research/deepview/exif.html\" rel=\"nofollow noreferrer\">media.mit.edu/pia/Research/deepview/exif.html</a> is a good article, outlined what bytes should be set to write a new exif into file."}], "tags": [], "owner": {"reputation": 2428, "user_id": 345350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50cb4981bbaa51b1713269a29f78d826?s=128&d=identicon&r=PG", "display_name": "donatJ", "link": "https://stackoverflow.com/users/345350/donatj"}, "is_accepted": true, "score": 1, "last_activity_date": 1548393462, "creation_date": 1548393462, "answer_id": 54359317, "question_id": 53806997, "link": "https://stackoverflow.com/questions/53806997/how-to-set-dpi-using-golang/54359317#54359317", "title": "how to set DPI using Golang?", "body": "<p>I believe you're looking for the exif values <code>XResolution</code> and <code>YResolution</code></p>\n\n<p>My understanding is the native jpeg encoder doesn't have any options for exif data.</p>\n\n<p><a href=\"https://github.com/dsoprea/go-exif\" rel=\"nofollow noreferrer\">https://github.com/dsoprea/go-exif</a> will let you modify the exif data. </p>\n\n<p>Additionally I believe if you first write the jpeg to a bytes.Buffer or similar and then append the exif you can do the entire thing in memory without flushing to disk first.</p>\n\n<p>I hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6558881, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0w6jSwvuLng/AAAAAAAAAAI/AAAAAAAAADY/N_6e0yPYmec/photo.jpg?sz=128", "display_name": "kyo", "link": "https://stackoverflow.com/users/6558881/kyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1588124748, "creation_date": 1588124748, "answer_id": 61492860, "question_id": 53806997, "link": "https://stackoverflow.com/questions/53806997/how-to-set-dpi-using-golang/61492860#61492860", "title": "how to set DPI using Golang?", "body": "<p>github.com/dsoprea/go-exif/v2 can reader and write exif data.\nwith other package github.com/dsoprea/go-jpeg-image-structure\nhere is code example . for write DPI(XResolution, YResolution) to Image.</p>\n\n<pre><code>import( \n    exif2 \"github.com/dsoprea/go-exif/v2\"\n    exifcommon \"github.com/dsoprea/go-exif/v2/common\"\n    jpegstructure \"github.com/dsoprea/go-jpeg-image-structure\"\n)\nfunc SetExifData(filepath string) error {\njmp := jpegstructure.NewJpegMediaParser()\n\nintfc, err := jmp.ParseFile(filepath)\nlog.PanicIf(err)\n\nsl := intfc.(*jpegstructure.SegmentList)\n\n// Make sure we don't start out with EXIF data.\nwasDropped, err := sl.DropExif()\nlog.PanicIf(err)\n\nif wasDropped != true {\n    fmt.Printf(\"Expected the EXIF segment to be dropped, but it wasn't.\")\n}\n\nim := exif2.NewIfdMapping()\n\nerr = exif2.LoadStandardIfds(im)\nlog.PanicIf(err)\n\nti := exif2.NewTagIndex()\nrootIb := exif2.NewIfdBuilder(im, ti, exifcommon.IfdPathStandard, exifcommon.EncodeDefaultByteOrder)\n\nerr = rootIb.AddStandardWithName(\"XResolution\", []exifcommon.Rational{{Numerator: uint32(96), Denominator: uint32(1)}})\nlog.PanicIf(err)\n\nerr = rootIb.AddStandardWithName(\"YResolution\", []exifcommon.Rational{{Numerator: uint32(96), Denominator: uint32(1)}})\nlog.PanicIf(err)\n\nerr = sl.SetExif(rootIb)\nlog.PanicIf(err)\n\nb := new(bytes.Buffer)\n\nerr = sl.Write(b)\nlog.PanicIf(err)\n\nif err := ioutil.WriteFile(filepath, b.Bytes(), 0644); err != nil {\n    fmt.Printf(\"write file err: %v\", err)\n}\nreturn nil\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 2940553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19136a085229cbb0c25937437027f6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2940553/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 1, "accepted_answer_id": 54359317, "answer_count": 2, "score": 3, "last_activity_date": 1588124748, "creation_date": 1544999088, "question_id": 53806997, "link": "https://stackoverflow.com/questions/53806997/how-to-set-dpi-using-golang", "title": "how to set DPI using Golang?", "body": "<p>Golang image package is very handy to some extent but lack the support to set DPI of an image. I checked the file header of generated file, <code>FF D8 FF DB</code> which looks like jpeg raw. AFAIK, raw doesn't come with DPI like what jfif has. So here's my question, how to set DPI of the generated image? Or how to convert a raw to jfif, from which I know I can edit a specific bit of the file to set DPI? Previously I embedded an AdvancedBatchConverter executable in my app and used <code>exec.Command(fmt.Sprintf(\"%s/AdvancedBatchConverter/abc.exe\", cwd), outputFile, \"/jfif\", fmt.Sprintf(\"/convert=%s\", jfifFileName))\n</code> to do the trick, but really, disgusted by it every time I looked at the code.</p>\n"}, {"tags": ["go", "websocket"], "comments": [{"owner": {"reputation": 796, "user_id": 4802458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4gBP.jpg?s=128&g=1", "display_name": "Marcin Zawiejski", "link": "https://stackoverflow.com/users/4802458/marcin-zawiejski"}, "edited": false, "score": 2, "creation_date": 1544998470, "post_id": 53806876, "comment_id": 94462553, "body": "Use <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Select_statements</a> with a response channel and a <a href=\"https://golang.org/pkg/time/#Ticker\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#Ticker</a> channel. See Example section in the Ticker docs."}], "answers": [{"tags": [], "owner": {"reputation": 612, "user_id": 5679246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979dd4cb6efdef48f055d51bc144ef3e?s=128&d=identicon&r=PG&f=1", "display_name": "ataboo", "link": "https://stackoverflow.com/users/5679246/ataboo"}, "is_accepted": true, "score": 2, "last_activity_date": 1545001570, "creation_date": 1545001570, "answer_id": 53807260, "question_id": 53806876, "link": "https://stackoverflow.com/questions/53806876/golang-timeout-or-return-early/53807260#53807260", "title": "Golang timeout or return early", "body": "<p>Checkout <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"nofollow noreferrer\">gorilla/websocket's chat example</a>.  It uses tickers and channels in <code>client.go</code> like mentioned above.  </p>\n\n<p>The server's prompt handling could be its own routine running parallel to the read/write pump routines.</p>\n\n<pre><code>go func() {\n    for {\n        for _, player := range players {\n            player.Answered = false\n            player.Send(\"prompt\")\n        }\n\n        time.Sleep(time.Second * 10)\n\n        for _, player := range players {\n            if player.Answered {\n               player.Send(\"You answered\")\n            } else {\n               player.Send(\"Too slow\")\n            }\n        }\n    }\n}()\n\n// the reading routine sets `Answered` true when message received\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17856, "user_id": 1439168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd72ad672b055a7d59cfb1c30d1c724f?s=128&d=identicon&r=PG", "display_name": "Miguel Mota", "link": "https://stackoverflow.com/users/1439168/miguel-mota"}, "is_accepted": false, "score": 2, "last_activity_date": 1545061672, "last_edit_date": 1545061672, "creation_date": 1545018704, "answer_id": 53808743, "question_id": 53806876, "link": "https://stackoverflow.com/questions/53806876/golang-timeout-or-return-early/53808743#53808743", "title": "Golang timeout or return early", "body": "<p>This example should give you a better understanding of how to implement a timeout. You need to use the <code>select</code> statement to wait on channels. The first channel that responds with a value is the case that gets executed. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    maxTimeout := 2 * time.Second\n    ready := make(chan bool, 1)\n    go collectUserResponses(ready)\n\n    select {\n    case &lt;-ready:\n        fmt.Println(\"do action A\")\n    case &lt;-time.After(maxTimeout):\n        fmt.Println(\"do action B\")\n    }\n}\n\nfunc collectUserResponses(ready chan bool) {\n    time.Sleep(1 * time.Second) // simulate waiting for users to respond\n    ready &lt;- true\n}\n</code></pre>\n\n<p><strong><a href=\"https://play.golang.org/p/94jIo5tW6eG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/94jIo5tW6eG</a></strong></p>\n"}], "owner": {"reputation": 357, "user_id": 4718598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f315602f1cdea3bfe185821da7da6b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Quontas", "link": "https://stackoverflow.com/users/4718598/quontas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 53807260, "answer_count": 2, "score": 1, "last_activity_date": 1545061672, "creation_date": 1544997916, "question_id": 53806876, "link": "https://stackoverflow.com/questions/53806876/golang-timeout-or-return-early", "title": "Golang timeout or return early", "body": "<p>I'm attempting to build a realtime multiplayer game server in Golang using websockets as a learning project, and I'm having difficulty understanding how exactly I'm supposed to implement this concept:</p>\n\n<p>All of the users in a game room are given a duration, <code>MAX_TIMEOUT</code> to respond to a prompt provided. Responses are submitted via websocket connections.  If all of the users respond before <code>MAX_TIMEOUT</code>, then <code>Action A</code> should happen, using the responses. If <code>MAX_TIMEOUT</code> elapses before all of the prompts are submitted, then <code>Action B</code> should happen, using the responses available.</p>\n\n<p>Coming from Node.JS, I could see myself implementing this with Promises, but in Golang, I'm rather lost.</p>\n\n<p>Any advice?</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 1, "creation_date": 1544994607, "post_id": 53806481, "comment_id": 94461641, "body": "It&#39;s your code formatter that removes the deprecated package alias"}, {"owner": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "reply_to_user": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1544994671, "post_id": 53806481, "comment_id": 94461653, "body": "@TheophileDano so using the aliases are deprecated?"}, {"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1544994705, "post_id": 53806481, "comment_id": 94461663, "body": "Not really, but it&#39;s not considered <i>good</i> practice. Why do you want to write <code>ut</code> in place of <code>util</code> ?"}, {"owner": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "reply_to_user": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1544994891, "post_id": 53806481, "comment_id": 94461709, "body": "@TheophileDano well it&#39;s just a sample and if the package would be long names then aliases are usefull"}, {"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1544995515, "post_id": 53806481, "comment_id": 94461842, "body": "No because you wouldn&#39;t create packages with long names"}, {"owner": {"reputation": 796, "user_id": 4802458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4gBP.jpg?s=128&g=1", "display_name": "Marcin Zawiejski", "link": "https://stackoverflow.com/users/4802458/marcin-zawiejski"}, "edited": false, "score": 2, "creation_date": 1544997974, "post_id": 53806481, "comment_id": 94462445, "body": "Have you tried to actually use the alias in the code? The Go plugin probably removes the alias because you don&#39;t use it."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1545027268, "post_id": 53806481, "comment_id": 94467876, "body": "&quot;ut&quot; is not an alias."}], "answers": [{"tags": [], "owner": {"reputation": 796, "user_id": 4802458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4gBP.jpg?s=128&g=1", "display_name": "Marcin Zawiejski", "link": "https://stackoverflow.com/users/4802458/marcin-zawiejski"}, "is_accepted": true, "score": 1, "last_activity_date": 1545003442, "creation_date": 1545003442, "answer_id": 53807446, "question_id": 53806481, "link": "https://stackoverflow.com/questions/53806481/how-to-set-up-alias-for-a-custom-package/53807446#53807446", "title": "How to set up alias for a custom package?", "body": "<p>The most probable reason why it removes your alias is that you use \"util\" in the .go file but you don't use the \"ut\" alias. Using \"ut\" alias in the file should prevent it from being removed.</p>\n"}], "owner": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53807446, "answer_count": 1, "score": 0, "last_activity_date": 1545003442, "creation_date": 1544994352, "question_id": 53806481, "link": "https://stackoverflow.com/questions/53806481/how-to-set-up-alias-for-a-custom-package", "title": "How to set up alias for a custom package?", "body": "<p>Can't set up an alias for a custom package. I'm using the Visual Studio Code.<br>\nMy imports looks like this</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"log\"\n    \"structute-test/util\"\n    \"time\"\n)\n</code></pre>\n\n<p>But when I try to insert the alias like</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"log\"\n    ut \"structute-test/util\"\n    \"time\"\n)\n</code></pre>\n\n<p>then the Visual Studio Code just hide the custom alias name so it looks like in the fist code snipet. What is wrong with a such definition?</p>\n"}, {"tags": ["go", "gofmt"], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 6948095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S11YG.jpg?s=128&g=1", "display_name": "westdabestdb", "link": "https://stackoverflow.com/users/6948095/westdabestdb"}, "is_accepted": false, "score": 1, "last_activity_date": 1545174597, "last_edit_date": 1545174597, "creation_date": 1544983777, "answer_id": 53805082, "question_id": 53805055, "link": "https://stackoverflow.com/questions/53805055/terminal-input-doesnt-match-expected-result/53805082#53805082", "title": "Terminal input doesn&#39;t match expected result", "body": "<p>modify your main function as following:</p>\n\n<pre><code>func main() {\n  reader := bufio.NewReader(os.Stdin)\n\n  fmt.Print(\"Enter name:\")\n  name, err := reader.ReadString('\\n')\n  if err != nil {\n    panic(err)\n  }\n  name = strings.TrimSuffix(name, \"\\n\")\n  fmt.Println(name == \"nixon\")\n}\n</code></pre>\n\n<p>The line I added to your code trims new line char from your input.</p>\n"}, {"comments": [{"owner": {"reputation": 319, "user_id": 6546322, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2Oz4IEtTGAo/AAAAAAAAAAI/AAAAAAAAKRk/O_wW1xFvGkc/photo.jpg?sz=128", "display_name": "Nixon Kosgei", "link": "https://stackoverflow.com/users/6546322/nixon-kosgei"}, "edited": false, "score": 0, "creation_date": 1545117207, "post_id": 53805100, "comment_id": 94504396, "body": "Just added this and it worked!  <code>name = strings.TrimRight(name, &quot;\\r\\n&quot;)</code> \\o"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1544985004, "last_edit_date": 1544985004, "creation_date": 1544983918, "answer_id": 53805100, "question_id": 53805055, "link": "https://stackoverflow.com/questions/53805055/terminal-input-doesnt-match-expected-result/53805100#53805100", "title": "Terminal input doesn&#39;t match expected result", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">func (*Reader) ReadString</a></p>\n\n<pre><code>func (b *Reader) ReadString(delim byte) (string, error)\n</code></pre>\n  \n  <p>ReadString reads until the first occurrence of delim in the input,\n  returning a string containing the data up to and including the\n  delimiter.</p>\n</blockquote>\n\n<hr>\n\n<p><code>name</code> terminal input includes trailing newlines. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n\n    fmt.Print(\"Enter name:\")\n    name, err := reader.ReadString('\\n')\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%q\\n\", name)\n\n    fmt.Println(name == \"nixon\")\n}\n</code></pre>\n\n<p>Output (Linux):</p>\n\n<pre><code>Enter name:nixon\n\"nixon\\n\"\nfalse\n</code></pre>\n\n<p>Output (Windows):</p>\n\n<pre><code>Enter name:nixon\n\"nixon\\r\\n\"\nfalse\n</code></pre>\n\n<hr>\n\n<p>Trim trailing newlines. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n\n    fmt.Print(\"Enter name:\")\n    name, err := reader.ReadString('\\n')\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%q\\n\", name)\n    name = strings.TrimRight(name, \"\\r\\n\")\n    fmt.Printf(\"%q\\n\", name)\n\n    fmt.Println(name == \"nixon\")\n</code></pre>\n\n<p>}</p>\n\n<p>Output (Linux):</p>\n\n<pre><code>Enter name:nixon\n\"nixon\\n\"\n\"nixon\"\ntrue\n</code></pre>\n\n<p>Output (Windows):</p>\n\n<pre><code>Enter name:nixon\n\"nixon\\r\\n\"\n\"nixon\"\ntrue\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 6546322, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2Oz4IEtTGAo/AAAAAAAAAAI/AAAAAAAAKRk/O_wW1xFvGkc/photo.jpg?sz=128", "display_name": "Nixon Kosgei", "link": "https://stackoverflow.com/users/6546322/nixon-kosgei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 53805100, "answer_count": 2, "score": 0, "last_activity_date": 1545174597, "creation_date": 1544983566, "last_edit_date": 1544984866, "question_id": 53805055, "link": "https://stackoverflow.com/questions/53805055/terminal-input-doesnt-match-expected-result", "title": "Terminal input doesn&#39;t match expected result", "body": "<p>I am new to Go.</p>\n\n<p>I wrote the program below to allow a user to enter the name. </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n\n    fmt.Print(\"Enter name:\")\n    name, err := reader.ReadString('\\n')\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(name == \"nixon\")\n}\n</code></pre>\n\n<p>I ran the program and entered my name <strong>nixon</strong></p>\n\n<p>Why is it that the output of <code>fmt.Println(name == \"nixon\")</code> is always <code>false</code>?</p>\n"}, {"tags": ["go", "model"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545056456, "post_id": 53804956, "comment_id": 94482474, "body": "The struct contains fields. Fields are state. It is stateful. Also note that if <code>model</code> is filled with a pointer, your local assignment copies the pointer and you can still encounter race conditions."}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545061007, "post_id": 53804956, "comment_id": 94485168, "body": "@Adrian so, as long as I don&#39;t pass in a pointer to the handler struct, as the model, I should be okay? This approach feels like an anti-pattern, but I can&#39;t put my finger on it."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545062551, "post_id": 53804956, "comment_id": 94486105, "body": "Yes. However in your example code, you are passing a pointer (<code>new</code> creates a pointer)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545062596, "post_id": 53804956, "comment_id": 94486126, "body": "Or I guess it looks like you&#39;re trying to but your order of fields is maybe backwards? Unless <code>repository</code> is your model and <code>models.Client</code> is your repository?"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544986850, "creation_date": 1544982932, "last_edit_date": 1544986659, "question_id": 53804956, "link": "https://stackoverflow.com/questions/53804956/configuring-struct-receivers-to-use-a-certain-type", "title": "Configuring struct receivers to use a certain type", "body": "<p>I noticed whilst writing some RESTful endpoints in Lambda, I had three models, and the handlers, were all identical. They take a request, fetch some data from a repository, and return the data as a response. The only thing which differed in each handler function, was the model instance. So I was thinking of ways of passing in the type and re-using the same functionality for marshalling the response into JSON etc. </p>\n\n<p>If I have a pattern such as this: </p>\n\n<pre><code>type Handler struct {\n  model interface{}\n  repository\n}\n\nfunc (h *Handler) Fetch(request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n  model := h.model\n  if err := h.repository.Fetch(id, &amp;model); err != nil {\n    return ErrResponse(err, http.StatusInternalServerError)\n  }\n  return Response(map[string]interface{}{\n    \"resource\": model,\n  }, http.StatusOK)\n}\n</code></pre>\n\n<p>Then calling this:</p>\n\n<pre><code>repository := NewRepository(tableName, connection)\nhandler := &amp;helpers.Handler{repository, new(models.Client)}\n</code></pre>\n\n<p>I'm re-assigning <code>model := h.model</code> so that the struct itself doesn't become 'stateful', otherwise I'd have to worry about locking to ensure its thread safe. So I figured I could just re-assign it in the scope of the handler to avoid that. </p>\n\n<p>This pattern seems to work okay, but I wondered if there were any potential downsides or pitfalls?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10566907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e34816b0fde65fb66faa55594a3887?s=128&d=identicon&r=PG&f=1", "display_name": "Cross", "link": "https://stackoverflow.com/users/10566907/cross"}, "edited": false, "score": 0, "creation_date": 1544978288, "post_id": 53804240, "comment_id": 94456945, "body": "I just needed to change it to this, and got it working:   func Change(user *person.User) { \tuser.NameChange() }"}], "tags": [], "owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "is_accepted": false, "score": 2, "last_activity_date": 1544978515, "last_edit_date": 1544978515, "creation_date": 1544978127, "answer_id": 53804240, "question_id": 53804182, "link": "https://stackoverflow.com/questions/53804182/change-struct-with-function-in-a-different-file/53804240#53804240", "title": "Change struct with function in a different file", "body": "<p>That's happening because the receiver is defined as a value (as opposed to a pointer). If you change <code>Change</code> to</p>\n\n<pre><code>func Change(user *person.User) {\n    user.NameChange()\n}\n</code></pre>\n\n<p>and call it using</p>\n\n<pre><code>Change(&amp;user)\n</code></pre>\n\n<p>then you should be good.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10566907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e34816b0fde65fb66faa55594a3887?s=128&d=identicon&r=PG&f=1", "display_name": "Cross", "link": "https://stackoverflow.com/users/10566907/cross"}, "edited": false, "score": 0, "creation_date": 1544978503, "post_id": 53804247, "comment_id": 94457002, "body": "Perfect - thank you so very much! Will go through both links as well. Really appreciate it"}], "tags": [], "owner": {"reputation": 4841, "user_id": 2556407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JRorJ.gif?s=128&g=1", "display_name": "nio", "link": "https://stackoverflow.com/users/2556407/nio"}, "is_accepted": true, "score": 1, "last_activity_date": 1544978151, "creation_date": 1544978151, "answer_id": 53804247, "question_id": 53804182, "link": "https://stackoverflow.com/questions/53804182/change-struct-with-function-in-a-different-file/53804247#53804247", "title": "Change struct with function in a different file", "body": "<p>Function parameters are passed by value, therefore, when you enter Change function, you get a copy of User struct in your user variable. And you call NameChange on a copy, not the original.\nTo change the original struct, you have to pass the struct as a pointer.</p>\n\n<p>File1:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"greetings/person\"\n)\n\n// pass User as a pointer instead of value\nfunc Change(user *person.User) {\n    user.NameChange()\n}\n\nfunc main() {\n    user := person.User{\"Peter\", 30}\n    fmt.Println(user) // returns \"Peter\"\n    Change(&amp;user)\n    fmt.Println(user) // returns \"Peter\" - Expected \"Alex\"\n}\n</code></pre>\n\n<p>More about this <a href=\"http://goinbigdata.com/golang-pass-by-pointer-vs-pass-by-value/\" rel=\"nofollow noreferrer\">here</a>. Pointers are described <a href=\"https://www.golang-book.com/books/intro/8\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 10566907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e34816b0fde65fb66faa55594a3887?s=128&d=identicon&r=PG&f=1", "display_name": "Cross", "link": "https://stackoverflow.com/users/10566907/cross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53804247, "answer_count": 2, "score": 0, "last_activity_date": 1545005451, "creation_date": 1544977770, "last_edit_date": 1545005451, "question_id": 53804182, "link": "https://stackoverflow.com/questions/53804182/change-struct-with-function-in-a-different-file", "title": "Change struct with function in a different file", "body": "<p>I'm a super beginner with Go and trying to teach myself through playing, so I apologies if I'm not being fantastically coherent. I'm trying to use two files. On file 1, I want to create an instance of Person (aged 30, named Peter). In this file, I want to be able to call Change, and have his name changed to Alex.</p>\n\n<p>This works if I just call user.NameChange - but not change(user). How do I go about getting this to work as intended?</p>\n\n<p>Greatly appreciated.</p>\n\n<p>FILE 1:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"greetings/person\"\n)\n\nfunc Change(user person.User) {\n    user.NameChange()\n}\n\nfunc main() {\n    user := person.User{\"Peter\", 30}\n    fmt.Println(user) // returns \"Peter\"\n    Change(user)\n    fmt.Println(user) // returns \"Peter\" - Expected \"Alex\"\n}\n</code></pre>\n\n<p>FILE 2:</p>\n\n<pre><code>package person\n\ntype User struct {\n    Name string\n    Age  int\n}\n\nfunc (u *User) NameChange() {\n    u.Name = \"Alex\"\n}\n</code></pre>\n"}, {"tags": ["go", "controller", "kubernetes"], "comments": [{"owner": {"reputation": 645, "user_id": 3891733, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7f6392b706d2eeff54c4b6656f9d4225?s=128&d=identicon&r=PG&f=1", "display_name": "Nimrodshn", "link": "https://stackoverflow.com/users/3891733/nimrodshn"}, "edited": false, "score": 0, "creation_date": 1544976528, "post_id": 53803992, "comment_id": 94456434, "body": "Possible idea I had in mind: Getting the most &quot;current&quot; <code>resourceVersion</code> in the <code>Store</code> and then comparing it to the most current <code>resourceVersion</code> synced (using the <code>informer.LastSyncedResourceVersion</code> field) to check if the cache is ahead of the sync which would indicate a &quot;real&quot; update has occurred but I am not sure what is the <code>resourceVersion</code> contract - And have been told not to trust it will incrument?"}], "answers": [{"tags": [], "owner": {"reputation": 645, "user_id": 3891733, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7f6392b706d2eeff54c4b6656f9d4225?s=128&d=identicon&r=PG&f=1", "display_name": "Nimrodshn", "link": "https://stackoverflow.com/users/3891733/nimrodshn"}, "is_accepted": true, "score": 1, "last_activity_date": 1544983935, "creation_date": 1544983935, "answer_id": 53805106, "question_id": 53803992, "link": "https://stackoverflow.com/questions/53803992/how-to-avoid-calling-updatefunc-on-sync/53805106#53805106", "title": "How to avoid calling `updateFunc` on sync?", "body": "<p>I found answer <a href=\"https://github.com/kubernetes/client-go/issues/529\" rel=\"nofollow noreferrer\">in this github issue</a>:</p>\n\n<blockquote>\n  <p>If resourceVersion differs between old and new, an actual update event was observed.</p>\n</blockquote>\n"}], "owner": {"reputation": 645, "user_id": 3891733, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7f6392b706d2eeff54c4b6656f9d4225?s=128&d=identicon&r=PG&f=1", "display_name": "Nimrodshn", "link": "https://stackoverflow.com/users/3891733/nimrodshn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 53805106, "answer_count": 1, "score": 0, "last_activity_date": 1545035811, "creation_date": 1544976502, "last_edit_date": 1545035811, "question_id": 53803992, "link": "https://stackoverflow.com/questions/53803992/how-to-avoid-calling-updatefunc-on-sync", "title": "How to avoid calling `updateFunc` on sync?", "body": "<p>From what I understand (and experience) - kubernetes informers calls <code>updateFunc</code> each \"sync\" event of its cache - From what I gather it is due to <a href=\"https://github.com/kubernetes/client-go/blob/117d288bbeebfecd84ac5dde6a31dc16ee2ae55d/tools/cache/controller.go#L305\" rel=\"nofollow noreferrer\">this</a> annoying peace of code.</p>\n\n<p>An example informer definition:</p>\n\n<pre><code>informer:= NewInformer(\n&amp;cache.ListWatch{\nListFunc: func(options api.ListOptions) (runtime.Object, error) {\n  return kubeClient.Batch().Jobs(api.NamespaceAll).List(options)\n},\nWatchFunc: func(options api.ListOptions) (watch.Interface, error) {\n  return kubeClient.Batch().Jobs(api.NamespaceAll).Watch(options)\n},....)\n\n...\n\ninformer.AddEventHandler(cache.ResourceEventHandlerFuncs{\n    AddFunc: func(obj interface{}){},\n    // Make this function be called *only* on update. \n    UpdateFunc: func(old, current interface{}){},\n    DeleteFunc: func(current interface{}){},\n})\n</code></pre>\n\n<p>But for my use case - calling <code>updateFunc</code> should really happen only when that resource is updated (e.g. I am doing some intense computation on each update or going to I/O).</p>\n\n<p>I was wandering is there a way to call <code>updateFunc</code> only on update?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1544979248, "post_id": 53802912, "comment_id": 94457202, "body": "I would say your questions are hard to answer because they are actually very basic. This indicates that you approached Go from a wrong end: you should attempt to gain the basic knowledge and only then attempt dealing with more complex stuff. Please start with <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">The Go Tour</a>. (Also note that the lanugage is called just &quot;Go&quot; and nothing else.)"}, {"owner": {"reputation": 95, "user_id": 10432703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HkLLr.png?s=128&g=1", "display_name": "phame", "link": "https://stackoverflow.com/users/10432703/phame"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1544983346, "post_id": 53802912, "comment_id": 94458387, "body": "@kostix I understand that they&#39;re simple and basic, actually, I&#39;ve figured out second and third questions, but I still want to know the answer of the first one, since I am not sure if I understand perfectly the use of <code>struct{}</code> here, does the data goes something like this: { 1 8 2 } { 4 3 6 } and so on here?"}], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 1, "last_activity_date": 1545081773, "creation_date": 1545081773, "answer_id": 53823177, "question_id": 53802912, "link": "https://stackoverflow.com/questions/53802912/mergesort-algorithm-with-goroutines-questions/53823177#53823177", "title": "MergeSort algorithm with goroutines questions", "body": "<blockquote>\n  <p>First question, why the channel is used as struct{} instead of int[]\n  or something else?</p>\n</blockquote>\n\n<p><code>struct{}</code> is often used as a type with channels when the actual type doesn't matter but instead the writing and reading from the channel do. So if you just need orchestration for some form of control, then <code>sturct{}</code> is a solid choice as the data being passed can't possibly be useful.</p>\n"}], "owner": {"reputation": 95, "user_id": 10432703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HkLLr.png?s=128&g=1", "display_name": "phame", "link": "https://stackoverflow.com/users/10432703/phame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53823177, "answer_count": 1, "score": 0, "last_activity_date": 1545081773, "creation_date": 1544969202, "last_edit_date": 1544979115, "question_id": 53802912, "link": "https://stackoverflow.com/questions/53802912/mergesort-algorithm-with-goroutines-questions", "title": "MergeSort algorithm with goroutines questions", "body": "<p>I am new to Go and I am trying to understand it a bit better, especially talking about goroutines.</p>\n\n<p>I've found a parallel MergeSort algorithm on GitHub and while I am investigating this code, I've got some questions, I want to understand why is it used and is there any way to convert it to other types.</p>\n\n<p>First question, why the channel is used as <code>struct{}</code> instead of <code>int[]</code> or something else? Is there any way to change that to <code>int[]</code> or any other type?</p>\n\n<p>Other question would be, why this algorithm uses <code>go func()</code> instead of creating new function for that? Is there a way to implement it with other function and simply writing <code>go</code> keyword before?</p>\n\n<p>And the last question, when <code>default</code> case is being used? </p>\n\n<pre><code>    func MultiMergeSortWithSem(data []int, sem chan struct{}) []int {\n    if len(data) &lt; 2 {\n        return data\n    }\n\n    middle := len(data) / 2\n\n    var waitGroup sync.WaitGroup\n    waitGroup.Add(2)\n\n    var leftData []int\n    var rightData []int\n\n    select {\n    case sem &lt;- struct{}{}:\n        go func() {\n            leftData = MultiMergeSortWithSem(data[:middle], sem)\n            &lt;-sem\n            waitGroup.Done()\n        }()\n    default:\n        leftData = SingleMergeSort(data[:middle])\n        waitGroup.Done()\n    }\n\n    select {\n    case sem &lt;- struct{}{}:\n        go func() {\n            rightData = MultiMergeSortWithSem(data[middle:], sem)\n            &lt;-sem\n            waitGroup.Done()\n        }()\n    default:\n        rightData = SingleMergeSort(data[middle:])\n        waitGroup.Done()\n    }\n\n    waitGroup.Wait()\n    return Merge(leftData, rightData)\n}\n</code></pre>\n\n<p><a href=\"https://github.com/hankliu5/go_practices/tree/master/concurrency/mergesort\" rel=\"nofollow noreferrer\">Source</a>.</p>\n"}, {"tags": ["go", "directory-structure"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9648200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb304a2e2335a14585928a190817318?s=128&d=identicon&r=PG&f=1", "display_name": "user280179", "link": "https://stackoverflow.com/users/9648200/user280179"}, "edited": false, "score": 0, "creation_date": 1544969268, "post_id": 53802817, "comment_id": 94454444, "body": "To check this project i need use goimports and golint too. As i understand commands should look like &#39;goimports (double wildcard)/(single wildcard).go&#39; and &#39;golint ./...&#39;. Goimports must looks like because it&#39;s doesnt works with ./... and any way it has output with formatted code. Golint occurs the same error like go vet."}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "reply_to_user": {"reputation": 53, "user_id": 9648200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb304a2e2335a14585928a190817318?s=128&d=identicon&r=PG&f=1", "display_name": "user280179", "link": "https://stackoverflow.com/users/9648200/user280179"}, "edited": false, "score": 0, "creation_date": 1544969676, "post_id": 53802817, "comment_id": 94454529, "body": "<code>goimports ...</code> and <code>golint ...</code> both works file for me"}], "tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": true, "score": 3, "last_activity_date": 1544968461, "creation_date": 1544968461, "answer_id": 53802817, "question_id": 53802745, "link": "https://stackoverflow.com/questions/53802745/after-go-vet-occurs-named-files-must-all-be-in-one-directory/53802817#53802817", "title": "After go vet occurs named files must all be in one directory;", "body": "<p><code>./...</code> is the way golang treat a tree recursively. try <code>go vet ./...</code> instead</p>\n"}], "owner": {"reputation": 53, "user_id": 9648200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb304a2e2335a14585928a190817318?s=128&d=identicon&r=PG&f=1", "display_name": "user280179", "link": "https://stackoverflow.com/users/9648200/user280179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2245, "favorite_count": 0, "accepted_answer_id": 53802817, "answer_count": 1, "score": 0, "last_activity_date": 1544968461, "creation_date": 1544967847, "question_id": 53802745, "link": "https://stackoverflow.com/questions/53802745/after-go-vet-occurs-named-files-must-all-be-in-one-directory", "title": "After go vet occurs named files must all be in one directory;", "body": "<p>After using go vet **/*.go occurs named files must all be in one directory;\nWhat i need to do to fix it?My project structure looks like.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sYnvU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sYnvU.png\" alt=\"\"></a></p>\n"}, {"tags": ["http", "go"], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": true, "score": 0, "last_activity_date": 1544967821, "creation_date": 1544967821, "answer_id": 53802743, "question_id": 53802703, "link": "https://stackoverflow.com/questions/53802703/request-formvalue-is-empty-in-the-net-http-in-go/53802743#53802743", "title": "request.FormValue is empty in the &#39;net/http&#39; in Go", "body": "<p>invalid at <code>request.FormValue(\"?uri\")</code></p>\n\n<pre><code>uri := request.FormValue(\"uri\")\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5848174, "user_type": "registered", "profile_image": "https://graph.facebook.com/899018916882055/picture?type=large", "display_name": "Anton  Sachko", "link": "https://stackoverflow.com/users/5848174/anton-sachko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 53802743, "answer_count": 1, "score": -2, "last_activity_date": 1544967821, "creation_date": 1544967545, "question_id": 53802703, "link": "https://stackoverflow.com/questions/53802703/request-formvalue-is-empty-in-the-net-http-in-go", "title": "request.FormValue is empty in the &#39;net/http&#39; in Go", "body": "<p>I'm trying to create a simple http service with the endpoint to download file to the local system in Go. The link comes in <code>?uri</code> tag, but when I want to get it I receive an empty string. I tried to parse the form of my request but it didn't help. Here is my code:</p>\n\n<pre><code>func main() {\nhttp.HandleFunc(\"/download\", DownloadHandler)\nlog.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n\nfunc DownloadHandler(writer http.ResponseWriter, request *http.Request) {\n    prsErr := request.ParseForm()\n    if prsErr != nil{\n        panic(prsErr)\n    }\n    uri := request.FormValue(\"?uri\")\n    _, _ = writer.Write([]byte(uri))\n    err := DownloadFile(\"img.png\", uri)\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc DownloadFile(filepath string, url string) error {\n\n    // Create the file\n    out, err := os.Create(filepath)\n    if err != nil {\n        return err\n    }\n    defer out.Close()\n\n    // Get the data\n    resp, err := http.Get(url)\n    if err != nil {\n        return err\n    }\n    defer resp.Body.Close()\n\n    // Write the body to file\n    _, err = io.Copy(out, resp.Body)\n    if err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>I will appreciate any help! Thank you!</p>\n"}, {"tags": ["unit-testing", "go", "dependency-injection"], "comments": [{"owner": {"reputation": 121, "user_id": 1443684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37888e0b7eefba8175fe00c52db35d2f?s=128&d=identicon&r=PG", "display_name": "thanhpham", "link": "https://stackoverflow.com/users/1443684/thanhpham"}, "edited": false, "score": 0, "creation_date": 1544966785, "post_id": 53801576, "comment_id": 94453847, "body": "First, the code failed to compile. Second, the test will be always failed because the given password is different with the expected password. Third, the code will be panic as index out of range because of this code <code>req.SetBasicAuth(cc[1], cc[2])</code>. For the unit test for the wrapper, the key thing is to mock the getServiceK to return the URL and user/password you want and then you can use the same method with the <code>Test_httpReq</code> to test it."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "reply_to_user": {"reputation": 121, "user_id": 1443684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37888e0b7eefba8175fe00c52db35d2f?s=128&d=identicon&r=PG", "display_name": "thanhpham", "link": "https://stackoverflow.com/users/1443684/thanhpham"}, "edited": false, "score": 0, "creation_date": 1544968015, "post_id": 53801576, "comment_id": 94454149, "body": "@thanhpham - thanks for the answer, 1. the password issue was fixed 2. assume that I mock the <code>getServiceK</code> to return URL how this will work in the tests? 3. which URL I should use in test (just for testing) ? example in highlevel of what you suggest will be very helpful to me :) thank you very much!"}, {"owner": {"reputation": 121, "user_id": 1443684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37888e0b7eefba8175fe00c52db35d2f?s=128&d=identicon&r=PG", "display_name": "thanhpham", "link": "https://stackoverflow.com/users/1443684/thanhpham"}, "edited": false, "score": 0, "creation_date": 1545022894, "post_id": 53801576, "comment_id": 94466760, "body": "Hi @shopia T, could u please post the full working code? Need to see how you implement Connection, getService and getServiceK. If u can give me a working code, I will able to help to give a working test :)"}], "answers": [{"tags": [], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "is_accepted": true, "score": 1, "last_activity_date": 1544987512, "last_edit_date": 1544987512, "creation_date": 1544987160, "answer_id": 53805535, "question_id": 53801576, "link": "https://stackoverflow.com/questions/53801576/unit-test-with-http-as-dependency-for-wrapper-function/53805535#53805535", "title": "Unit test with http as dependency for wrapper function", "body": "<p>Service object can have an interface like this</p>\n\n<pre><code>type Service struct {\n    serviceK typeK\n    serviceHttp serviceHttp // of type interface hence can be mocked\n}\n</code></pre>\n\n<p>Normal application code can init services with actual objects. Tests will have mocks objects</p>\n\n<pre><code>type Req struct {\n}\n\ntype Resp struct {\n}\n\ntype ServiceHttp interface{\n    HttpReq(params Req)(Resp, error)\n}\n\ntype Implementation struct {\n}\n\nfunc (i *Implementation)HttpReq(params Req)(Resp, error){\n   // buid http request\n}\n\nfunc (c *Service) invoke(Connection Connection, args []string) {\n\n    service, err := c.getService(Connection, args)\n\n    serviceC, err := c.getServiceK(service, []string{\"url\", \u201cuser\u201d, \u201cid\u201d})\n    c := strings.Fields(serviceC)\n\n    serviceImp := c.GetServiceImp()\n\n    // init params with the required fields\n    val, err := c.HttpReq(params)\n    if err != nil {\n      fmt.println(err)\n    }\n    fmt.Print(string(val))\n\n}\n</code></pre>\n\n<p>when you are running tests, you can initialise the service object with mock Implementation that returns a dummy response.</p>\n\n<pre><code>type MockImplementation struct {\n}\n\nfunc (i *MockImplementation)HttpReq(Resp, error){\n    // return mock response\n}\n\nfunc TestMain(){\n  services := {\n     serviceHttp:MockImplementation{},\n     serviceK: typeK{}, // initialise this\n  }\n}\n</code></pre>\n\n<p>This is one of way testing it. Other way could be I guess where httpReq return http.ResponseWriter and you can use httptest.ResponseRecorder to test it.</p>\n"}], "owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "accepted_answer_id": 53805535, "answer_count": 1, "score": 0, "last_activity_date": 1544987512, "creation_date": 1544958516, "last_edit_date": 1544986553, "question_id": 53801576, "link": "https://stackoverflow.com/questions/53801576/unit-test-with-http-as-dependency-for-wrapper-function", "title": "Unit test with http as dependency for wrapper function", "body": "<p>I\u2019ve the following function which after help of @poy I was able to create mock for it in order to unit test it.</p>\n\n<p>The issue now that I\u2019ve wrapper function which needs also to be tested</p>\n\n<p>This is the <strong>original</strong> function which have working test</p>\n\n<pre><code>func httpReq(cc []string, method string, url string) ([]byte, error) {\n    httpClient := http.Client{}\n    req, err := http.NewRequest(method, url, nil)\n    if err != nil {\n        return nil, errors.Wrap(err, \"failed to execute http request\")\n    }\n    //Here we are passing user and password\n    req.SetBasicAuth(cc[1], cc[2])\n    res, err := httpClient.Do(req)\n    if err != nil {\n        fmt.error(err)\n    }\n    val, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        fmt.error(err)\n    }\n    defer res.Body.Close()\n    return val, nil\n}\n</code></pre>\n\n<p>This is the test which works as expected, this test use \n<a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/httptest/</a> in order to mock http requests.</p>\n\n<pre><code>func Test_httpReq(t *testing.T){\n\n  expectedValue = \"some-value\"\n  server := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request){\n\n    u,p,ok := r.BasicAuth()\n    if !ok || u != \"fakeuser\" || p != \"fakepassword\" {\n      t.Fatal(\"wrong auth\")\n    }\n    w.Write([]byte(expectedValue))\n  })\n\n  val, err := httpReq(\n   []string{\"fakeuser\", \"fakepassword\"}, \n   http.MethodPost, \n   server.URL,\n  )\n\n  if err != nil{\n    t.Fatal(err)\n  }\n\n  if val != expectedValue {\n    t.Fatalf(\"expected %q to equal %q\", val, expectedValue)\n  }\n</code></pre>\n\n<p>Now the issue is that I\u2019ve another function <strong>which call to the above function</strong> which needs to be tested also.</p>\n\n<p><strong>This is the function which use httpReq and I need to create test also for it</strong> </p>\n\n<pre><code>func (c *Service) invoke(Connection Connection, args []string) {\n    service, err := c.getService(Connection, args)\n\n    serviceC, err := c.getServiceK(service, []string{\"url\", \u201cuser\u201d, \u201cid\u201d})\n    c := strings.Fields(serviceC)\n        //\u2014\u2014\u2014\u2014\u2014Here we are using the http function again \n    val, err := httpReq(c[1], c[1],\u201dpost\u201d, c[0])\n    if err != nil {\n        fmt.println(err)\n    }\n    fmt.Print(string(val))\n}\n</code></pre>\n\n<p>Now when I use the test for it I got error inside the <strong>http request method</strong> since here I cannot mock the http.</p>\n\n<p>Is there any <code>technique</code> In <code>Golang</code> Which can help which this kind of scenario?\n I've search about it, something like dependency injection and found that maybe <em>interface could help</em>, but since this is http I'm not sure how to do it.</p>\n\n<p>Any example with this context will be very helpful to me.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "answers": [{"comments": [{"owner": {"reputation": 728, "user_id": 3348617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1475953069/picture?type=large", "display_name": "zdebra", "link": "https://stackoverflow.com/users/3348617/zdebra"}, "edited": false, "score": 0, "creation_date": 1544995657, "post_id": 53803463, "comment_id": 94461871, "body": "Thank you for your answer and good catch, but it didn&#39;t solve my issue. I&#39;ve tried to use regular context as article advice but the error stays the same."}], "tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": false, "score": 1, "last_activity_date": 1544972915, "creation_date": 1544972915, "answer_id": 53803463, "question_id": 53801551, "link": "https://stackoverflow.com/questions/53801551/google-app-engine-modulehostname-not-an-app-engine-context/53803463#53803463", "title": "Google App Engine ModuleHostname: not an App Engine context", "body": "<p>The article you referenced was written with the 1st generation standard environment in mind, the 2nd generation (go111) wasn't <a href=\"https://cloud.google.com/appengine/docs/standard/go111/release-notes#october_10_2018\" rel=\"nofollow noreferrer\">released</a> at that time:</p>\n\n<blockquote>\n  <p>October 10, 2018</p>\n  \n  <p>Go runtime notes</p>\n  \n  <p>The <a href=\"https://cloud.google.com/appengine/docs/standard/go111\" rel=\"nofollow noreferrer\">Go 1.11 runtime</a> for the App Engine standard environment is\n  now in beta. A migration guide for <a href=\"https://cloud.google.com/appengine/docs/standard/go111/go-differences\" rel=\"nofollow noreferrer\">moving apps from Go 1.9 to Go\n  1.11</a> is available.</p>\n</blockquote>\n\n<p>The differences between the two generations are significant (for all languages, not only for go). In the <a href=\"https://cloud.google.com/appengine/docs/standard/go111/go-differences#migrating-appengine-sdk\" rel=\"nofollow noreferrer\">Migrating from the App Engine Go SDK (Optional)</a> section of the migration guide I noticed:</p>\n\n<blockquote>\n  <ul>\n  <li>Use <a href=\"https://golang.org/pkg/net/http/?#Request.Context\" rel=\"nofollow noreferrer\"><code>request.Context()</code></a> or your preferred context instead of using <a href=\"https://cloud.google.com/appengine/docs/standard/go/reference#NewContext\" rel=\"nofollow noreferrer\"><code>appengine.NewContext</code></a>.</li>\n  </ul>\n</blockquote>\n\n<p>Which <em>might</em> be related to your error. But I'm not actually a go user, this is just a theory :)</p>\n"}, {"tags": [], "owner": {"reputation": 728, "user_id": 3348617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1475953069/picture?type=large", "display_name": "zdebra", "link": "https://stackoverflow.com/users/3348617/zdebra"}, "is_accepted": true, "score": 5, "last_activity_date": 1545068760, "last_edit_date": 1545068760, "creation_date": 1545060924, "answer_id": 53818365, "question_id": 53801551, "link": "https://stackoverflow.com/questions/53801551/google-app-engine-modulehostname-not-an-app-engine-context/53818365#53818365", "title": "Google App Engine ModuleHostname: not an App Engine context", "body": "<p>I found the solution. You need to call <code>appengine.Main()</code> in your main file even though it shouldn't be necessary to do in the new <code>go111</code> runtime. </p>\n\n<p>So the code in question stays the same, you need to register your handlers same as in <code>go1.9</code> runtime.</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/serveurl\", handle)\n    appengine.Main()\n}\n</code></pre>\n\n<p>Source: <a href=\"https://groups.google.com/d/msg/google-appengine-go/ZcASFMWJKpE/7iwGirNiBgAJ\" rel=\"noreferrer\">https://groups.google.com/d/msg/google-appengine-go/ZcASFMWJKpE/7iwGirNiBgAJ</a></p>\n\n<p>It's alo mentioned in <a href=\"https://cloud.google.com/appengine/docs/standard/go111/go-differences#writing_a_main_package\" rel=\"noreferrer\">Writing a main package</a>:</p>\n\n<blockquote>\n  <ul>\n  <li>Or, if your service is using the <code>google.golang.org/appengine</code> package, include a call to <code>appengine.Main()</code>.</li>\n  </ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 50, "user_id": 4201816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yCA70.jpg?s=128&g=1", "display_name": "Schmorrison", "link": "https://stackoverflow.com/users/4201816/schmorrison"}, "is_accepted": false, "score": 1, "last_activity_date": 1573638555, "creation_date": 1573638555, "answer_id": 58834287, "question_id": 53801551, "link": "https://stackoverflow.com/questions/53801551/google-app-engine-modulehostname-not-an-app-engine-context/58834287#58834287", "title": "Google App Engine ModuleHostname: not an App Engine context", "body": "<p>From what I understand this error is returned when your AppEngine application has the runtime set to go111 and the application  imports any of the \"google.golang.org/appengine\" packages like log, urlfetch, memcache, etc. but the application doesn\u2019t call the \u201cappengine.Main\u201d method.</p>\n\n<p>Therefore you can choose either implementation below:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/http\"\n\n    \"google.golang.org/appengine\"\n)\n\nfunc init() {\n    // register handlers\n    http.HandleFunc(\u201c/\u201c, indexHandler)\n\n    appengine.Main()\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n    ctx := appengine.NewContext(r)\n.......handle the request.......\n}\n\nfunc ServiceHostname(serviceName string, r *http.Request) (string, error) {\n    ctx := appengine.NewContext(r)\n    hostname, err := appengine.ModuleHostname(ctx, serviceName, \"\", \"\")\n    if err != nil {\n        return \"\", fmt.Errorf(\"unable to find service %s: %v\", serviceName, err)\n    }\n    return hostname, nil\n}\n</code></pre>\n\n<p>Or abandon all appengine packages:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \u201clog\u201d\n    \"net/http\"\n    \u201cos\u201d\n)\n\nfunc main() {\n    port := os.Getenv(\u201cPORT\u201d)\n    if port == \u201c\u201d {\n        port = \u201c8080\u201d\n    }\n\n    http.HandleFunc(\u201c/\u201c, indexHandler)\n\n    log.Fatal(http.ListenAndServe(\u201c:\u201d+port, Nil)\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n    ctx := r.Context()\n.....handle request....\n}\n\n</code></pre>\n"}], "owner": {"reputation": 728, "user_id": 3348617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1475953069/picture?type=large", "display_name": "zdebra", "link": "https://stackoverflow.com/users/3348617/zdebra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 761, "favorite_count": 0, "accepted_answer_id": 53818365, "answer_count": 3, "score": 1, "last_activity_date": 1573638555, "creation_date": 1544958224, "last_edit_date": 1544995191, "question_id": 53801551, "link": "https://stackoverflow.com/questions/53801551/google-app-engine-modulehostname-not-an-app-engine-context", "title": "Google App Engine ModuleHostname: not an App Engine context", "body": "<p>I am trying to discover other deployed services on the App Engine. Something like <a href=\"https://billglover.me/2018/01/06/google-app-engine-service-discovery/\" rel=\"nofollow noreferrer\">this</a> article suggests. </p>\n\n<p>This is how my code looks like:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/http\"\n\n    \"google.golang.org/appengine\"\n)\n\nfunc ServiceHostname(serviceName string, r *http.Request) (string, error) {\n    ctx := appengine.NewContext(r)\n    hostname, err := appengine.ModuleHostname(ctx, serviceName, \"\", \"\")\n    if err != nil {\n        return \"\", fmt.Errorf(\"unable to find service %s: %v\", serviceName, err)\n    }\n    return hostname, nil\n}\n</code></pre>\n\n<p>I am calling this function in a regular http handler. The error I've got is: <code>not an App Engine context</code>.</p>\n\n<p>The only difference in between my code and the referenced article is in app engine go version. I am using the new <code>go111</code> where he's using <code>go1</code> runtime. </p>\n\n<p>Do you know how to overcome the issue?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 796, "user_id": 4802458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4gBP.jpg?s=128&g=1", "display_name": "Marcin Zawiejski", "link": "https://stackoverflow.com/users/4802458/marcin-zawiejski"}, "edited": false, "score": 1, "creation_date": 1545004078, "post_id": 53801256, "comment_id": 94463558, "body": "You can use both buffered or non-buffered channel with producer2 while producer1 always uses the latter."}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 796, "user_id": 4802458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4gBP.jpg?s=128&g=1", "display_name": "Marcin Zawiejski", "link": "https://stackoverflow.com/users/4802458/marcin-zawiejski"}, "edited": false, "score": 1, "creation_date": 1545041964, "post_id": 53801256, "comment_id": 94474471, "body": "@MarcinZawiejski: Hi, you may use buffered and non-buffered channel with both: see <a href=\"https://play.golang.org/p/-pk89TdNBwk\" rel=\"nofollow noreferrer\">buffered</a> and <a href=\"https://play.golang.org/p/Xm8h8_i4Z13\" rel=\"nofollow noreferrer\">non-buffered</a>."}, {"owner": {"reputation": 796, "user_id": 4802458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4gBP.jpg?s=128&g=1", "display_name": "Marcin Zawiejski", "link": "https://stackoverflow.com/users/4802458/marcin-zawiejski"}, "reply_to_user": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 0, "creation_date": 1545044164, "post_id": 53801256, "comment_id": 94475691, "body": "@A.R Of course you can if you modify the producer1 code (as you did in the &quot;buffered&quot; link) but the question is for the specific implementation where you can&#39;t use buffered channels with producer1"}], "answers": [{"tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 2, "last_activity_date": 1545044247, "last_edit_date": 1545044247, "creation_date": 1544960067, "answer_id": 53801717, "question_id": 53801256, "link": "https://stackoverflow.com/questions/53801256/golang-producer-channels-as-parameter-or-as-return-value/53801717#53801717", "title": "Golang producer channels as parameter or as return value", "body": "<p>Using <code>ch := producer1([]int{1, 2, 3, 4})</code> simplifies these two lines:</p>\n\n<pre><code>out := make(chan int)\nproducer2([]int{10, 20, 30, 40}, out)\n</code></pre>\n\n<p>into one line:</p>\n\n<pre><code>ch := producer1([]int{1, 2, 3, 4})\n</code></pre>\n\n<p>So first use case is code <strong>simplification</strong> (<a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\" rel=\"nofollow noreferrer\">DRY</a>), when you need it many times.</p>\n\n<blockquote>\n  <p>What is more idiomatic, <code>producer1</code> or <code>producer2</code>?  </p>\n</blockquote>\n\n<p>for your example use case <code>producer1</code></p>\n\n<blockquote>\n  <p>Did I oversee a disadvantage? </p>\n</blockquote>\n\n<p>Yes </p>\n\n<blockquote>\n  <p>Are there any specific use scenarios?</p>\n</blockquote>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\" rel=\"nofollow noreferrer\">DRY</a></p>\n\n<hr>\n\n<p>Note: in <code>producer2</code> you must use tx only channel like this <code>out chan&lt;- int</code> instead of <code>out &lt;-chan int</code> (rx only channel).\nlike this working code (Run <a href=\"https://play.golang.org/p/aCCE7__LSrJ\" rel=\"nofollow noreferrer\">buffered</a> and <a href=\"https://play.golang.org/p/Xm8h8_i4Z13\" rel=\"nofollow noreferrer\">non-buffered</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc producer1(numbers []int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        defer close(out)\n        for _, n := range numbers {\n            out &lt;- n\n        }\n    }()\n    return out\n}\n\nfunc main() {\n    ch := producer1([]int{1, 2, 3, 4})\n    for v := range ch {\n        fmt.Println(v)\n    }\n    out := make(chan int)\n    producer2([]int{10, 20, 30, 40}, out)\n    for v := range out {\n        fmt.Println(v)\n    }\n}\n\nfunc producer2(numbers []int, out chan&lt;- int) {\n    go func() {\n        defer close(out)\n        for _, n := range numbers {\n            out &lt;- n\n        }\n    }()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28098, "user_id": 86072, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/dd41ab60469c4ee32c957c97fc101b9d?s=128&d=identicon&r=PG", "display_name": "LeGEC", "link": "https://stackoverflow.com/users/86072/legec"}, "is_accepted": false, "score": 2, "last_activity_date": 1545056122, "last_edit_date": 1545056122, "creation_date": 1545042689, "answer_id": 53813314, "question_id": 53801256, "link": "https://stackoverflow.com/questions/53801256/golang-producer-channels-as-parameter-or-as-return-value/53813314#53813314", "title": "Golang producer channels as parameter or as return value", "body": "<p>IMHO : it depends.</p>\n\n<p><code>producer1</code> is very explicit about this channel's behavior and lifetime (which can be a good thing),<br>\n<code>producer2</code> allows you to plug the emission of these values in some greater context (which can also be a good thing).</p>\n\n<p>The notion of \"good thing\" actually depends on how you intend to use these channels outside of these functions.</p>\n\n<hr>\n\n<p>One extra remark : <code>producer2</code> does not handle the channel's creation, I would also remove the line which closes the channel from this function.</p>\n"}], "owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545056122, "creation_date": 1544955720, "question_id": 53801256, "link": "https://stackoverflow.com/questions/53801256/golang-producer-channels-as-parameter-or-as-return-value", "title": "Golang producer channels as parameter or as return value", "body": "<p>As far as I know there are two ways of handling producer channels within functions: (1) as parameter or (2) as return value. While for (1) the function is the owner of the channel, the owner in (2) is unknown (for the function.</p>\n\n<p>What is more idiomatic, <code>producer1</code> or <code>producer2</code>? Did I oversee a disadvantage? Are there any specific use scenarios?</p>\n\n<p>Here are the implementation of (1) and (2):</p>\n\n<pre><code>func producer1(numbers []int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        defer close(out)\n        for _, n := range numbers {\n            out &lt;- n\n        }\n    }()\n    return out\n}\n\nfunc producer2(numbers []int, out &lt;-chan int) {\n    go func() {\n        defer close(out)\n        for _, n := range numbers {\n            out &lt;- n\n        }\n    }()\n}\n</code></pre>\n"}, {"tags": ["sql", "postgresql", "algorithm", "go"], "comments": [{"owner": {"reputation": 404, "user_id": 8462259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2476bb86b12efeceac2ccbccc0581fd?s=128&d=identicon&r=PG&f=1", "display_name": "G.D", "link": "https://stackoverflow.com/users/8462259/g-d"}, "edited": false, "score": 0, "creation_date": 1545215167, "post_id": 53801052, "comment_id": 94545924, "body": "Why don&#180;t you make an API who send datas from your DB and retrieve it with a &quot;Front&quot; language (HTML/JS/PHP...) to print them ?"}, {"owner": {"reputation": 17, "user_id": 10796961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74a692a45cdb21c19dd917d9f2bcd88?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/10796961/dmitry"}, "reply_to_user": {"reputation": 404, "user_id": 8462259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2476bb86b12efeceac2ccbccc0581fd?s=128&d=identicon&r=PG&f=1", "display_name": "G.D", "link": "https://stackoverflow.com/users/8462259/g-d"}, "edited": false, "score": 0, "creation_date": 1545305530, "post_id": 53801052, "comment_id": 94582691, "body": "because Golang can do similar tasks without an API.  If there are no other options, then JS"}], "owner": {"reputation": 17, "user_id": 10796961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74a692a45cdb21c19dd917d9f2bcd88?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/10796961/dmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1544956466, "creation_date": 1544953505, "last_edit_date": 1544956466, "question_id": 53801052, "link": "https://stackoverflow.com/questions/53801052/how-i-can-build-and-print-to-browser-category-tree", "title": "How I can build and print to browser category tree?", "body": "<p>So I want to build a category script for products.</p>\n\n<p>How I can build the category tree?</p>\n\n<p>I have a DB like this...</p>\n\n<pre><code>CREATE TABLE categories (\n    cat_id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,\n    parent_id integer NOT NULL,\n    cat_name CHAR(24) NULL DEFAULT NULL,\n    cat_position tinyint NOT NULL,\n    icon TEXT NULL DEFAULT NULL,\n    keywords text NOT NULL, //for search\n    active boolean NULL DEFAULT true,\n    cat_description CHAR(128) NULL DEFAULT NULL\n);\n</code></pre>\n\n<p>But I can't understand how it works because 1 product may be found in many categories...</p>\n\n<p>I am coding on <strong>GoLang</strong> </p>\n\n<p>Now I do like this... </p>\n\n<pre><code>rows, err := db.Query(\"SELECT cat_id, parent_id, cat_name FROM categories WHERE active = true ORDER BY Parent_id ASC\")\nif err != nil {\n    http.Error(w, http.StatusText(500), 500)\n    return\n}\ndefer rows.Close()\n</code></pre>\n\n<p>Then I put rows into template... </p>\n\n<pre><code>{{range .}}\n&lt;p&gt;&lt;a href=\"/show?getinfo={{ .Cat_id}}\"&gt;{{ .Cat_id}}&lt;/a&gt; - {{ .Parent_id}} - {{ .Cat_name}} &lt;a href=\"/show?getinfo={{ .Cat_id}}\"&gt;\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c&lt;/a&gt;\n{{end}}\n</code></pre>\n\n<p>In the end I would like to get something <a href=\"https://i.stack.imgur.com/GHqoI.gif\" rel=\"nofollow noreferrer\">similar to this</a></p>\n"}, {"tags": ["go", "xlsx"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10767040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841dadd40b0b57723877d166cb922b0e?s=128&d=identicon&r=PG&f=1", "display_name": "gaccha", "link": "https://stackoverflow.com/users/10767040/gaccha"}, "edited": false, "score": 0, "creation_date": 1544953070, "post_id": 53800707, "comment_id": 94450689, "body": "Thank you for the quick response, Mostafa Solati. I saw the your source code shown. In the source code it appears to be creating a new Excel file.  I am sorry for my poor English. What I want to handle is not a new file. The main point is whether can write to an already open .xlsx file.  For example, we are considering collaboration between VBA and golang. \u2460 &quot;macro.xlsx&quot; \u2192 start golang. \u2461 golang \u2192 Write to a specific cell of &quot;macro.xlsx&quot; already open.  I wanted to confirm that this kind of thing is possible.  * Since it deals with macros, it was exactly &quot;xlsm&quot;."}, {"owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "reply_to_user": {"reputation": 3, "user_id": 10767040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841dadd40b0b57723877d166cb922b0e?s=128&d=identicon&r=PG&f=1", "display_name": "gaccha", "link": "https://stackoverflow.com/users/10767040/gaccha"}, "edited": false, "score": 0, "creation_date": 1544954613, "post_id": 53800707, "comment_id": 94451012, "body": "@gaccha I&#39;m affraid to say you can&#39;t do that , every process that opens a file should close it in order to avoid conflicts between writes."}, {"owner": {"reputation": 3, "user_id": 10767040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841dadd40b0b57723877d166cb922b0e?s=128&d=identicon&r=PG&f=1", "display_name": "gaccha", "link": "https://stackoverflow.com/users/10767040/gaccha"}, "edited": false, "score": 0, "creation_date": 1544955676, "post_id": 53800707, "comment_id": 94451251, "body": "It is a pity that I can not do that. But I think that what you say is true as well. I will try another method. Thank you for taking the precious time."}], "tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": true, "score": 0, "last_activity_date": 1544950049, "creation_date": 1544950049, "answer_id": 53800707, "question_id": 53800558, "link": "https://stackoverflow.com/questions/53800558/how-to-write-to-an-already-opened-xlsx-file-with-golang/53800707#53800707", "title": "How to write to an already opened .xlsx file with golang", "body": "<p>You can use <a href=\"https://github.com/tealeg/xlsx\" rel=\"nofollow noreferrer\">xlsx package</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/tealeg/xlsx\"\n)\n\nfunc main() {\n    var file *xlsx.File\n    var sheet *xlsx.Sheet\n    var row *xlsx.Row\n    var cell *xlsx.Cell\n    var err error\n\n    file = xlsx.NewFile()\n    sheet, err = file.AddSheet(\"Sheet1\")\n    if err != nil {\n        fmt.Printf(err.Error())\n    }\n    row = sheet.AddRow()\n    cell = row.AddCell()\n    cell.Value = \"I am a cell!\"\n    err = file.Save(\"MyXLSXFile.xlsx\")\n    if err != nil {\n        fmt.Printf(err.Error())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10767040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841dadd40b0b57723877d166cb922b0e?s=128&d=identicon&r=PG&f=1", "display_name": "gaccha", "link": "https://stackoverflow.com/users/10767040/gaccha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 0, "accepted_answer_id": 53800707, "answer_count": 1, "score": 0, "last_activity_date": 1544950049, "creation_date": 1544948443, "question_id": 53800558, "link": "https://stackoverflow.com/questions/53800558/how-to-write-to-an-already-opened-xlsx-file-with-golang", "title": "How to write to an already opened .xlsx file with golang", "body": "<p>The title is as follows.</p>\n\n<p>If it is easy to implement with additional packages, it is better than that.\nIt is even better if it is lightweight.</p>\n\n<p>Please teach an example if possible.</p>\n"}, {"tags": ["go", "pprof"], "answers": [{"tags": [], "owner": {"reputation": 273, "user_id": 10817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04517ba4c854fb53dbc14b4cae73717b?s=128&d=identicon&r=PG", "display_name": "prattmic", "link": "https://stackoverflow.com/users/10817/prattmic"}, "is_accepted": false, "score": 2, "last_activity_date": 1615396882, "creation_date": 1615396882, "answer_id": 66569799, "question_id": 53800407, "link": "https://stackoverflow.com/questions/53800407/how-to-interpret-go-pprof-mutex-showing-waiting-on-unlock/66569799#66569799", "title": "How to interpret go pprof/mutex showing waiting on Unlock?", "body": "<p>To answer your second question, mutex profiles always display results on the <code>Unlock</code> path, and never on <code>Lock</code> [1]. Your profile is indicating that most contention is occurring on <code>w.mu</code>.</p>\n<p><a href=\"https://github.com/DataDog/go-profiler-notes/blob/main/block.md#relationship-with-mutex-profiling\" rel=\"nofollow noreferrer\">This document</a> contains a bit more detail.</p>\n<p>[1] Implementation detail: the reason for this is that <code>Unlock</code> hands off the lock to the next waiting locker, and it is at this point that the contention is recorded in the profile. Thus the stack trace appears to be in the <code>Unlock</code> path.</p>\n"}], "owner": {"reputation": 933, "user_id": 439142, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/ad48f5f489d036f22f94a411a218c966?s=128&d=identicon&r=PG", "display_name": "Ray Wu", "link": "https://stackoverflow.com/users/439142/ray-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1615396882, "creation_date": 1544946747, "last_edit_date": 1544948287, "question_id": 53800407, "link": "https://stackoverflow.com/questions/53800407/how-to-interpret-go-pprof-mutex-showing-waiting-on-unlock", "title": "How to interpret go pprof/mutex showing waiting on Unlock?", "body": "<p>I'm optimizing Go program performance. While looking at mutex profiling, I got </p>\n\n<pre><code>&gt; go tool pprof -seconds 30 -ignore .*Shopify.*  http://HOST/debug/pprof/mutex\n(pprof) top 20\nActive filters:\nignore=.*Shopify.*\nShowing nodes accounting for 3.08mins, 91.03% of 3.39mins total\nDropped 82 nodes (cum &lt;= 0.02mins)\n    flat  flat%   sum%        cum   cum%\n3.08mins 91.03% 91.03%   3.08mins 91.03%  sync.(*Mutex).Unlock\n       0     0% 91.03%   0.06mins  1.75%  ....func2\n       0     0% 91.03%   0.06mins  1.75%  ....func3\n</code></pre>\n\n<p>Code snippet is</p>\n\n<pre><code>     .          .    502:    w.mu.Lock()\n\n     .          .    ... some calculation\n\n     .   5.02mins    510:    w.mu.Unlock()\n     .          .    511:\n     .          .    512:    return nil\n     .          .    513:}\n</code></pre>\n\n<p>What I don't understand are:</p>\n\n<ul>\n<li>Why mutex profiling shows only top 1 has <code>flat</code> time, all the rest are <code>0</code>?</li>\n<li>If it shows waiting on <code>Lock</code> then it probably means calculation takes too long, but what does it mean when it shows waiting on <code>Unlock</code>?  </li>\n</ul>\n"}, {"tags": ["dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 10398228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02a6741d5fb16914f1dcb233ad0ca60a?s=128&d=identicon&r=PG&f=1", "display_name": "Einiemand", "link": "https://stackoverflow.com/users/10398228/einiemand"}, "edited": false, "score": 0, "creation_date": 1544933458, "post_id": 53799243, "comment_id": 94448081, "body": "Does it mean we should never attempt to initialize a map using new()?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 162, "user_id": 10398228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02a6741d5fb16914f1dcb233ad0ca60a?s=128&d=identicon&r=PG&f=1", "display_name": "Einiemand", "link": "https://stackoverflow.com/users/10398228/einiemand"}, "edited": false, "score": 2, "creation_date": 1544935131, "post_id": 53799243, "comment_id": 94448261, "body": "@Einiemand If you want to <b>create</b> a map, then use the make function.  If you want to <b>allocate a map variable</b> set  to nil, then use the new function. The new function does not create a map."}, {"owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "reply_to_user": {"reputation": 162, "user_id": 10398228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02a6741d5fb16914f1dcb233ad0ca60a?s=128&d=identicon&r=PG&f=1", "display_name": "Einiemand", "link": "https://stackoverflow.com/users/10398228/einiemand"}, "edited": false, "score": 1, "creation_date": 1544935218, "post_id": 53799243, "comment_id": 94448274, "body": "@Einiemand I agree with the above comment. In this example, and probably most, you&#39;ll want to use the the make function."}], "tags": [], "owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "is_accepted": false, "score": 1, "last_activity_date": 1544931680, "creation_date": 1544931680, "answer_id": 53799243, "question_id": 53799199, "link": "https://stackoverflow.com/questions/53799199/why-cant-i-initialize-a-map-with-new-in-go/53799243#53799243", "title": "Why can&#39;t I initialize a map with new() in Go?", "body": "<p>Both <code>new</code> and <code>make</code> are used to allocate memory in a program, but they work differently. <code>new(T, args)</code> zeros memory and returns the memory address (a value of type <code>*T</code>) but does not initialize that memory. <code>make(T, args)</code> on the other hand initializes a value of type <code>T</code>. A map need to be initialized because, while a map can be empty, there is still the structure of the map itself, which is non-zero and therefore needs to be initialized before use.</p>\n\n<p>From <a href=\"https://golang.org/doc/effective_go.html#allocation_make\" rel=\"nofollow noreferrer\">Effective Go</a>:</p>\n\n<blockquote>\n  <p>The built-in function make(T, args) serves a purpose different from new(T). It creates slices, maps, and channels only, and it returns an initialized (not zeroed) value of type T (not *T). The reason for the distinction is that these three types represent, under the covers, references to data structures that must be initialized before use. A slice, for example, is a three-item descriptor containing a pointer to the data (inside an array), the length, and the capacity, and until those items are initialized, the slice is nil. For slices, maps, and channels, make initializes the internal data structure and prepares the value for use.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 1, "last_activity_date": 1544938657, "creation_date": 1544938657, "answer_id": 53799726, "question_id": 53799199, "link": "https://stackoverflow.com/questions/53799199/why-cant-i-initialize-a-map-with-new-in-go/53799726#53799726", "title": "Why can&#39;t I initialize a map with new() in Go?", "body": "<p>This is not directly an issue with <code>new</code> keyword. You would get the same behavior, if you did not initialize your map, when declaring it with <code>var</code> keyword, for example:</p>\n\n<pre><code>var a map[string]int\na[\"z\"] = 10\n</code></pre>\n\n<p>The way to fix this is to initialize the map:</p>\n\n<pre><code>var a map[string]int\na = map[string]int{}\na[\"z\"] = 10\n</code></pre>\n\n<p>And it works the same way, with <code>new</code> keyword:</p>\n\n<pre><code>p := new(map[string]int)\n*p = map[string]int{}\n(*p)[\"in p\"] = 1 \n</code></pre>\n\n<p>The reason <code>make(map[string]int)</code> does what you expect is that  the map is declared and initialized.</p>\n\n<p><a href=\"https://play.golang.org/p/dSm7OzQyQl3\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 162, "user_id": 10398228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02a6741d5fb16914f1dcb233ad0ca60a?s=128&d=identicon&r=PG&f=1", "display_name": "Einiemand", "link": "https://stackoverflow.com/users/10398228/einiemand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544938657, "creation_date": 1544930973, "question_id": 53799199, "link": "https://stackoverflow.com/questions/53799199/why-cant-i-initialize-a-map-with-new-in-go", "title": "Why can&#39;t I initialize a map with new() in Go?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    p := new(map[string]int)\n    m := make(map[string]int)\n    m[\"in m\"] = 2\n    (*p)[\"in p\"] = 1\n    fmt.Println(m)\n    fmt.Println(*p)\n}\n</code></pre>\n\n<p>The above code gives an error <code>panic: assignment to entry in nil map</code>. If I print <code>*p</code> before inserting pairs into it, the output is correct. It seems I just can't modify <code>*p</code>?</p>\n"}, {"tags": ["mongodb", "go", "bson", "objectid"], "comments": [{"owner": {"reputation": 308, "user_id": 10788397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HNfj9QFa5pU/AAAAAAAAAAI/AAAAAAAAKOA/q7PRzgV2OdM/photo.jpg?sz=128", "display_name": "dom", "link": "https://stackoverflow.com/users/10788397/dom"}, "edited": false, "score": 2, "creation_date": 1544923621, "post_id": 53798410, "comment_id": 94446976, "body": "This is like &amp;string(&quot;Hello&quot;). It&#39;s invalid.  But you can store the <code>bson.ObjectIdHex(id)</code> value to some <code>tmp</code> variable and then assign <code>&amp;tmp</code>  it to the <code>*bson.ObjectID</code> variable."}, {"owner": {"reputation": 308, "user_id": 10788397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HNfj9QFa5pU/AAAAAAAAAAI/AAAAAAAAKOA/q7PRzgV2OdM/photo.jpg?sz=128", "display_name": "dom", "link": "https://stackoverflow.com/users/10788397/dom"}, "edited": false, "score": 0, "creation_date": 1544923968, "post_id": 53798410, "comment_id": 94447037, "body": "Maybe there is a better way to implement it, but I would have to see the code snippet."}], "answers": [{"tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": false, "score": 2, "last_activity_date": 1544944960, "creation_date": 1544944960, "answer_id": 53800220, "question_id": 53798410, "link": "https://stackoverflow.com/questions/53798410/what-is-the-nil-zero-value-of-bson-objectid/53800220#53800220", "title": "What is the nil/zero value of bson.ObjectId", "body": "<p>bson.ObjectId is an alias for string , therefore the zero value is an empty string \"\" </p>\n"}, {"tags": [], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "is_accepted": true, "score": 1, "last_activity_date": 1545234106, "creation_date": 1545234106, "answer_id": 53854621, "question_id": 53798410, "link": "https://stackoverflow.com/questions/53798410/what-is-the-nil-zero-value-of-bson-objectid/53854621#53854621", "title": "What is the nil/zero value of bson.ObjectId", "body": "<p>Based on @dom answer (in the comments), there is the workaround I am now using:</p>\n\n<pre><code>package your_package\n\nimport \"github.com/globalsign/mgo/bson\"\n\nfunc GenerateNewGuidHelper() *bson.ObjectId {\n    id := bson.NewObjectId()\n    return &amp;id\n}\n\nfunc IsStringIdValid(id string) bool {\n    return id != \"\" &amp;&amp; bson.IsObjectIdHex(id)\n}\n\nfunc ConvertStringIdToObjectId(id string) *bson.ObjectId {\n    if id != \"\" &amp;&amp; bson.IsObjectIdHex(id){\n        bsonObjectId := bson.ObjectIdHex(id)\n        return &amp;bsonObjectId\n    }\n    return nil\n}\n\nfunc ConvertStringIdsToObjectIds(ids []string) []*bson.ObjectId {\n    var _ids []*bson.ObjectId\n    for _, id := range ids {\n        _ids = append(_ids, ConvertStringIdToObjectId(id))\n    }\n    return _ids\n}\n\nfunc IsObjectIdValid(id *bson.ObjectId) bool {\n    return id.Hex() != \"\" &amp;&amp; bson.IsObjectIdHex(id.Hex())\n}\n\nfunc ConvertObjectIdToStringId(id *bson.ObjectId) string  {\n    if id != nil {\n        return id.Hex()\n    }\n    return \"\"\n}\n\nfunc ConvertObjectIdsToStringIds(ids []*bson.ObjectId) []string {\n    var _ids []string\n    for _, id := range ids {\n        _ids = append(_ids, ConvertObjectIdToStringId(id))\n    }\n    return _ids\n}\n</code></pre>\n\n<p>Also, as said @dom, I am now saving my mongoDB ID as <code>*bson.ObjectId</code> instead of <code>bson.ObjectId</code>. Example:</p>\n\n<pre><code>package datamodels\n\nimport (\n    \"github.com/globalsign/mgo/bson\"\n)\n\ntype User struct {\n    ID *bson.ObjectId `protobuf:\"bytes,1,opt,name=id,proto3\" json:\"_id,omitempty\" bson:\"_id,omitempty\"`\n}\n</code></pre>\n\n<p>I hope it helps !</p>\n"}, {"tags": [], "owner": {"reputation": 881, "user_id": 1541012, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/658f517ed534a4bf7672797cc3cdad8a?s=128&d=identicon&r=PG", "display_name": "Bastien", "link": "https://stackoverflow.com/users/1541012/bastien"}, "is_accepted": false, "score": 3, "last_activity_date": 1574956665, "creation_date": 1574956665, "answer_id": 59092572, "question_id": 53798410, "link": "https://stackoverflow.com/questions/53798410/what-is-the-nil-zero-value-of-bson-objectid/59092572#59092572", "title": "What is the nil/zero value of bson.ObjectId", "body": "<p>Or you can use the <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/bson/primitive#ObjectID\" rel=\"nofollow noreferrer\">primitive.NilObjectID</a></p>\n\n<blockquote>\n  <p>NilObjectID is the zero value for ObjectID.</p>\n</blockquote>\n"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2879, "favorite_count": 0, "accepted_answer_id": 53854621, "answer_count": 3, "score": 1, "last_activity_date": 1574956665, "creation_date": 1544919889, "last_edit_date": 1545035830, "question_id": 53798410, "link": "https://stackoverflow.com/questions/53798410/what-is-the-nil-zero-value-of-bson-objectid", "title": "What is the nil/zero value of bson.ObjectId", "body": "<p>I was creating unary tests when I got stuck on the following situation:</p>\n\n<ul>\n<li>I have an object that has a foreign key. For some reason, I need to switch the ID and it works. However, sometimes, I need to remove this ID. If I have an ID, I realise a certain action and if I don't, then nothing happens.</li>\n</ul>\n\n<p>However, I can't find the way to set my <code>bson.ObjectId</code> as <code>nil</code> or zero.</p>\n\n<p>Does anyone knows how to do or a work around?</p>\n"}]