[{"tags": ["function", "pointers", "go", "parameters"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487199973, "post_id": 42261752, "comment_id": 71681187, "body": "if you run <code>go fmt</code> it will tell you the precise location of your syntax error, and in this case even what character is expected."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1487199894, "creation_date": 1487199894, "answer_id": 42261780, "question_id": 42261752, "link": "https://stackoverflow.com/questions/42261752/pointer-to-slice-of-interfaces-in-function-parameter/42261780#42261780", "title": "Pointer to slice of interfaces in function parameter", "body": "<p>Declare the function like this:</p>\n\n<pre><code>func read(filePath string, structure interface{}) error {\n  raw, err := ioutil.ReadFile(filePath)\n  if err != nil {\n    return err\n  }\n  return json.Unmarshal(raw, structure)\n}\n</code></pre>\n\n<p>The <code>structure</code> value is passed through to <code>json.Unmarshal</code> and can be any type supported by <code>json.Unmarshal</code>.</p>\n\n<p>Call it like this:</p>\n\n<pre><code>var indexes []Index\nerr := read(path + \"/\" + element + \".json\", &amp;indexes)\nif err != nil {\n    fmt.Println(err.Error())\n    os.Exit(1)\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6791424"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 42261780, "answer_count": 1, "score": -2, "last_activity_date": 1487199894, "creation_date": 1487199782, "question_id": 42261752, "link": "https://stackoverflow.com/questions/42261752/pointer-to-slice-of-interfaces-in-function-parameter", "title": "Pointer to slice of interfaces in function parameter", "body": "<p>I have the following function:</p>\n\n<pre><code>func read(filePath string, structure *[]interface) {\n    raw, err := ioutil.ReadFile(filePath)\n    if err != nil {\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n    json.Unmarshal(raw, structure)\n}\n</code></pre>\n\n<p>Which I call like this:</p>\n\n<pre><code>    indexes := []Index\n    read(path + \"/\" + element + \".json\", &amp;indexes)\n</code></pre>\n\n<p>However, I'm getting strange error that vanish when I take off <code>structure *[]interface</code> from the function declaration:</p>\n\n<pre><code>./index.verb.go:73: syntax error: unexpected ), expecting {\n</code></pre>\n\n<p>I think something wront when I try to pass a pointer to a slice of generic type. How should I do it then? I can't do <code>structure *[]Index</code> because there are other types I wanna return too</p>\n"}, {"tags": ["go", "http-post", "stdin"], "answers": [{"tags": [], "owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "is_accepted": false, "score": 1, "last_activity_date": 1487200771, "creation_date": 1487200771, "answer_id": 42261959, "question_id": 42261421, "link": "https://stackoverflow.com/questions/42261421/send-os-stdin-via-http-post-without-loading-file-into-memory/42261959#42261959", "title": "Send os.Stdin via http POST without loading file into memory", "body": "<p>Use <code>io.Pipe()</code> - <a href=\"https://golang.org/pkg/io/#Pipe\" rel=\"nofollow noreferrer\">https://golang.org/pkg/io/#Pipe</a></p>\n\n<p>You will need to use a goroutine but it isn't too hard to do. If you need a specific example leave a comment and I'll get one for you. </p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1487200787, "creation_date": 1487200787, "answer_id": 42261963, "question_id": 42261421, "link": "https://stackoverflow.com/questions/42261421/send-os-stdin-via-http-post-without-loading-file-into-memory/42261963#42261963", "title": "Send os.Stdin via http POST without loading file into memory", "body": "<p>You can avoid copying the data in memory by using an <a href=\"https://godoc.org/io#Pipe\" rel=\"nofollow noreferrer\">io.Pipe</a> and a goroutine that copies from the file to the pipe:</p>\n\n<pre><code>func newfileUploadRequest(uri string) (*http.Request, error) {\n  r, w := io.Pipe()\n  writer := multipart.NewWriter(w)\n  go func() {\n    part, err := writer.CreateFormFile(\"file\", \"file\")\n    if err != nil {\n        w.CloseWithError(err)\n        return\n    }\n    _, err = io.Copy(part, os.Stdin)\n    if err != nil {\n        w.CloseWithError(err)\n        return\n    }\n    err = writer.Close()\n    if err != nil {\n        w.CloseWithError(err)\n        return\n    }\n  }()\n\n  request, err := http.NewRequest(\"POST\", uri, r)\n  if err != nil {\n    return nil, err\n  }\n  request.Header.Set(\"Content-Type\", writer.FormDataContentType())\n  return request, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7571524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d28038c5662b2f77abe758e028dabc?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Doeboy", "link": "https://stackoverflow.com/users/7571524/jonny-doeboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "accepted_answer_id": 42261963, "answer_count": 2, "score": 1, "last_activity_date": 1487200787, "creation_date": 1487198259, "last_edit_date": 1487200538, "question_id": 42261421, "link": "https://stackoverflow.com/questions/42261421/send-os-stdin-via-http-post-without-loading-file-into-memory", "title": "Send os.Stdin via http POST without loading file into memory", "body": "<p>I am trying to send a file to a server via a POST request. To accomplish this, I use the following code:</p>\n\n<pre><code>func newfileUploadRequest(uri string) (*http.Request, error) {\n\n    body := new(bytes.Buffer)\n    writer := multipart.NewWriter(body)\n    part, err := writer.CreateFormFile(\"file\", \"file\")\n    if err != nil {\n        return nil, err\n    }\n    io.Copy(part, os.Stdin)\n\n    err = writer.Close()\n    if err != nil {\n        return nil, err\n    }\n\n    request, err := http.NewRequest(\"POST\", uri, body)\n    if err != nil {\n        return nil, err\n    }\n    request.Header.Set(\"Content-Type\", writer.FormDataContentType())\n    return request, nil\n}\n\n\nfunc main() {\n    r, err := newfileUploadRequest(\"http://localhost:8080/\")\n    if err != nil {\n        panic(err)\n    }\n\n    client := &amp;http.Client{}\n    resp, err := client.Do(r)\n    if err != nil {\n        panic(err)\n    }\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        panic(err)\n    }\n    print(string(body))\n}\n</code></pre>\n\n<p>While this works well, it is my understanding that io.Copy will copy the entire file into memory before the POST request is sent. Large files (multiple GB) will create issues. Is there a way to prevent this? I found <a href=\"https://gist.github.com/mattetti/5914158/f4d1393d83ebedc682a3c8e7bdc6b49670083b84#gistcomment-1985369\" rel=\"nofollow noreferrer\">this</a>, but that simply says to use io.Copy.</p>\n"}, {"tags": ["go", "https", "x509certificate", "tls1.2"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1487197293, "post_id": 42261147, "comment_id": 71680055, "body": "No, you can&#39;t have TLS without a certificate (and key)."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1487205908, "post_id": 42261147, "comment_id": 71683049, "body": "you can create free totally valid TLS certs for your domain at <a href=\"https://letsencrypt.org\" rel=\"nofollow noreferrer\">letsencrypt.org</a> ... reasonable priced domains can be created at <a href=\"https://domains.google.com/registrar\" rel=\"nofollow noreferrer\">domains.google.com/registrar</a>   ... this might save you time"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 2, "last_activity_date": 1487232105, "creation_date": 1487232105, "answer_id": 42268088, "question_id": 42261147, "link": "https://stackoverflow.com/questions/42261147/golangis-it-possible-to-write-tls-server-without-certificate/42268088#42268088", "title": "[golang]Is it possible to write TLS server without certificate?", "body": "<p>No, as @JimB told you, TLS can't work without certificates.</p>\n\n<p>The reasoning is simple: TLS is all about security, and certificates\nare <em>cryptographic keys</em> which provide that security (TLS uses a so-called\n\"asymmetric cryptography\" where each party has a key <em>pair</em> consisting of\na private and public parts; the public part is what get sent to another party\nwhen doing a TLS handshake).</p>\n\n<p>But on the other hand the security TLS provides is two-fold:</p>\n\n<ol>\n<li>It provides mutual authentication of the parties participating in the\nexchange.</li>\n<li>It provides encryption of the transmission channel.</li>\n</ol>\n\n<p>Certificates are used for both aspects: the fact they contain cryptographic keys is used for (2), and the fact they have <em>owner's identity</em> encoded\nin them (and verified by whoever was issued a particular cercificate(\nis used for (1).</p>\n\n<p>Let me not digress into discussing how (1) works in detail\n(though I truly urge you to read some theory on it) but (1) is what\nyou actually want to sidestep.</p>\n\n<p>The good (for you) thing is that it's cheaply doable:</p>\n\n<ul>\n<li>The TLS clients can be told to not verify the server's identity.</li>\n<li>The TLS servers can be told to do the same (and often it's the default\nmode they operate in&mdash;which is typical for regular websites\nfor instance).</li>\n<li>You can create a so-called <a href=\"https://en.wikipedia.org/wiki/Self-signed_certificate\" rel=\"nofollow noreferrer\">self-signed certificate</a> for your TLS\nserver.</li>\n</ul>\n\n<p>The latter requires nothing but something which is able to generate\nX.509 certificates; <code>OpenSSL</code> is typically used for this;\n<a href=\"https://www.google.com/search?q=self-signed+ssl+certificate\" rel=\"nofollow noreferrer\">just google for it</a>.</p>\n\n<p>If you're on Debian or Debian derivative (like Ubuntu, Mint etc)\nconsider installing the <code>ssl-cert</code> package and using\nthe <code>make-ssl-cert</code> program it provides.</p>\n"}], "owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 42268088, "answer_count": 1, "score": -2, "last_activity_date": 1487232105, "creation_date": 1487197058, "question_id": 42261147, "link": "https://stackoverflow.com/questions/42261147/golangis-it-possible-to-write-tls-server-without-certificate", "title": "[golang]Is it possible to write TLS server without certificate?", "body": "<p>From client I already have tls config which sets <code>InsecureSkipVerify</code> to true. How to write server for this client which take any cert.\nCan <code>tls.config</code> help in server too? like setting <code>InsecureSkipVerify</code> to true?</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "answers": [{"comments": [{"owner": {"reputation": 2271, "user_id": 760096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/npebi.jpg?s=128&g=1", "display_name": "Kevin Mansel", "link": "https://stackoverflow.com/users/760096/kevin-mansel"}, "edited": false, "score": 2, "creation_date": 1487223282, "post_id": 42262433, "comment_id": 71688175, "body": "Another neat trick is to follow the logs live, like tailing.    <code>kubectl logs -f &lt;podid&gt;</code>"}], "tags": [], "owner": {"reputation": 4136, "user_id": 340811, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/87d770f5a0843a130b55572651e9d7d0?s=128&d=identicon&r=PG", "display_name": "Samuel Lampa", "link": "https://stackoverflow.com/users/340811/samuel-lampa"}, "is_accepted": false, "score": 0, "last_activity_date": 1487203548, "creation_date": 1487203548, "answer_id": 42262433, "question_id": 42260503, "link": "https://stackoverflow.com/questions/42260503/how-to-create-and-use-a-volume-in-kubernetes-with-the-go-client-api/42262433#42262433", "title": "How to create and use a volume in kubernetes with the Go client API?", "body": "<p>Well, after I found out how to get error logs from the pods (1), I found the error (Calling <code>bash</code>, which didn't exist in the container image (only <code>sh</code> existed), and a typo in the mounted path). </p>\n\n<p>Updated working code example available <a href=\"https://github.com/samuell/k8s-experiments/blob/8e7bf4/k8sexp.go\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>(1) <code>kubectl get pods</code> to get pod id, and then <code>kubectl logs &lt;podid&gt;</code> to get the logs.</p>\n"}], "owner": {"reputation": 4136, "user_id": 340811, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/87d770f5a0843a130b55572651e9d7d0?s=128&d=identicon&r=PG", "display_name": "Samuel Lampa", "link": "https://stackoverflow.com/users/340811/samuel-lampa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1212, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487203548, "creation_date": 1487194467, "question_id": 42260503, "link": "https://stackoverflow.com/questions/42260503/how-to-create-and-use-a-volume-in-kubernetes-with-the-go-client-api", "title": "How to create and use a volume in kubernetes with the Go client API?", "body": "<p>What steps are needed to create and mount a local folder as a \"persistent volume\" in kubernetes, using the Go API?</p>\n\n<p>(I'm using minikube, and trying to do the above, just to have some semi-persistent storage to play around with).</p>\n\n<p>I have managed to define a <code>Volume</code> and <code>VolumeMount</code> in my <code>JobSpec</code>, for a Job that I can run successfully on minikube (see <a href=\"https://github.com/samuell/k8s-experiments/blob/85d06c/k8sexp.go#L99-L118\" rel=\"nofollow noreferrer\">this code</a>), but the volume does not seem to be properly created before referenced by the job in this way. </p>\n\n<p>I started fleshing out some code for a spec of the container, which is commented out in my experiment code, as can be seen in <a href=\"https://github.com/samuell/k8s-experiments/blob/85d06c/k8sexp.go#L46-L63\" rel=\"nofollow noreferrer\">this code</a>, but I can't find where to send this volume specification, so that kubernetes will create it. Any hints?</p>\n"}, {"tags": ["javascript", "html", "reactjs", "go", "directory"], "comments": [{"owner": {"reputation": 175, "user_id": 6001183, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81c966b47d419b803771fd25591b8704?s=128&d=identicon&r=PG&f=1", "display_name": "Emmett P", "link": "https://stackoverflow.com/users/6001183/emmett-p"}, "edited": false, "score": 0, "creation_date": 1487195249, "post_id": 42260479, "comment_id": 71679014, "body": "Also important to note: I use Gorilla (<a href=\"https://github.com/gorilla/mux\" rel=\"nofollow noreferrer\">github.com/gorilla/mux</a>) for routing."}, {"owner": {"reputation": 175, "user_id": 6001183, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81c966b47d419b803771fd25591b8704?s=128&d=identicon&r=PG&f=1", "display_name": "Emmett P", "link": "https://stackoverflow.com/users/6001183/emmett-p"}, "edited": false, "score": 0, "creation_date": 1487195281, "post_id": 42260479, "comment_id": 71679035, "body": "r comes from r := mux.NewRouter()"}, {"owner": {"reputation": 455, "user_id": 547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a74c2ce9b0229fd34551b0490a2622e?s=128&d=identicon&r=PG", "display_name": "Gonzalo Serrano", "link": "https://stackoverflow.com/users/547956/gonzalo-serrano"}, "edited": false, "score": 0, "creation_date": 1487195617, "post_id": 42260479, "comment_id": 71679201, "body": "please post a gist with the code so we can reproduce it"}, {"owner": {"reputation": 175, "user_id": 6001183, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81c966b47d419b803771fd25591b8704?s=128&d=identicon&r=PG&f=1", "display_name": "Emmett P", "link": "https://stackoverflow.com/users/6001183/emmett-p"}, "reply_to_user": {"reputation": 455, "user_id": 547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a74c2ce9b0229fd34551b0490a2622e?s=128&d=identicon&r=PG", "display_name": "Gonzalo Serrano", "link": "https://stackoverflow.com/users/547956/gonzalo-serrano"}, "edited": false, "score": 0, "creation_date": 1487268260, "post_id": 42260479, "comment_id": 71719521, "body": "Here it is: <a href=\"https://gist.github.com/epalaima/ecbbcf7494c898d4404aedb5fb769136\" rel=\"nofollow noreferrer\">gist.github.com/epalaima/ecbbcf7494c898d4404aedb5fb769136</a>"}, {"owner": {"reputation": 175, "user_id": 6001183, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81c966b47d419b803771fd25591b8704?s=128&d=identicon&r=PG&f=1", "display_name": "Emmett P", "link": "https://stackoverflow.com/users/6001183/emmett-p"}, "reply_to_user": {"reputation": 455, "user_id": 547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a74c2ce9b0229fd34551b0490a2622e?s=128&d=identicon&r=PG", "display_name": "Gonzalo Serrano", "link": "https://stackoverflow.com/users/547956/gonzalo-serrano"}, "edited": false, "score": 0, "creation_date": 1487268357, "post_id": 42260479, "comment_id": 71719572, "body": "I think I have narrowed down the issue. I need to be able to serve the react scripts along with the html. Trying to figure out how to correctly add the r.Handle to accomplish this."}], "answers": [{"comments": [{"owner": {"reputation": 15251, "user_id": 66708, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/834755eb1212009904ab822b64295ffb?s=128&d=identicon&r=PG", "display_name": "Junior Mayh&#233;", "link": "https://stackoverflow.com/users/66708/junior-mayh%c3%a9"}, "edited": false, "score": 0, "creation_date": 1613680278, "post_id": 42281926, "comment_id": 117157964, "body": "It is a little different from my case where my built react app is published to a /public folder within the go app folder. When the main.go was run, all the HTTP requests were interecepted and the react page was not being reached. This helped me make request being served by react again <a href=\"https://stackoverflow.com/questions/64650343/how-to-have-golang-redirect-to-frontend-routing\" title=\"how to have golang redirect to frontend routing\">stackoverflow.com/questions/64650343/&hellip;</a>"}], "tags": [], "owner": {"reputation": 175, "user_id": 6001183, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81c966b47d419b803771fd25591b8704?s=128&d=identicon&r=PG&f=1", "display_name": "Emmett P", "link": "https://stackoverflow.com/users/6001183/emmett-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1487269759, "creation_date": 1487269759, "answer_id": 42281926, "question_id": 42260479, "link": "https://stackoverflow.com/questions/42260479/react-scripts-not-found-when-using-golang-http-fileserver/42281926#42281926", "title": "React Scripts Not Found When Using GoLang http.FileServer", "body": "<p>I solved this issue by adding:</p>\n\n<pre><code>r.PathPrefix(\"/build/\").Handler(http.StripPrefix(\"/build/\", http.FileServer(http.Dir(\"./build/\"))))\n</code></pre>\n\n<p>in my main function in order to serve the react scripts. My file structure is:</p>\n\n<pre><code> main.go\n views\n -- index.html (views/index.html)\n build\n -- react.js (build/react.js)\n -- react-dom.js (build/react.js)\n -- other react scripts...\n</code></pre>\n\n<p>Hope this helps anyone else who might be dealing with this problem.</p>\n"}], "owner": {"reputation": 175, "user_id": 6001183, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81c966b47d419b803771fd25591b8704?s=128&d=identicon&r=PG&f=1", "display_name": "Emmett P", "link": "https://stackoverflow.com/users/6001183/emmett-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1487269759, "creation_date": 1487194366, "question_id": 42260479, "link": "https://stackoverflow.com/questions/42260479/react-scripts-not-found-when-using-golang-http-fileserver", "title": "React Scripts Not Found When Using GoLang http.FileServer", "body": "<p>I am working on a Golang database project, in which I would like to use React to create the front-end. I am using react scripts linked to my index.html.</p>\n\n<p>When I open my index.html directly, my react scripts work and the page is properly formatted. However, when I try to open the page through my server, the scripts are not found and I get a 404 error:</p>\n\n<pre><code>::1 - - [15/Feb/2017:16:16:24 -0500] \"GET /build/react.js HTTP/1.1\" 404 19\n</code></pre>\n\n<p>In order to access the index.html from my Golang server I use: </p>\n\n<pre><code>r.Handle(\"/\", http.FileServer(http.Dir(\"./views\")))\n</code></pre>\n\n<p>I am thinking the issue is with using the http.FileServer to access the html. I have tried locating my build folder in variety of locations, most recently within the views folder, always with the same result, that when opening the html directly the react scripts work, but they do not work when the html is accessed by my server.</p>\n\n<p>Is there another method I should be using to accomplish this, or is it a problem with how I am organizing my dependencies?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 455, "user_id": 547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a74c2ce9b0229fd34551b0490a2622e?s=128&d=identicon&r=PG", "display_name": "Gonzalo Serrano", "link": "https://stackoverflow.com/users/547956/gonzalo-serrano"}, "edited": false, "score": 0, "creation_date": 1487195549, "post_id": 42259364, "comment_id": 71679163, "body": "it worked for me: 1st i started the server code, then the client code, then i typed TRANSFER_FILE in the client stdin, then i entered a 64MB filename name and a destination name and it was copied as expected."}, {"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "reply_to_user": {"reputation": 455, "user_id": 547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a74c2ce9b0229fd34551b0490a2622e?s=128&d=identicon&r=PG", "display_name": "Gonzalo Serrano", "link": "https://stackoverflow.com/users/547956/gonzalo-serrano"}, "edited": false, "score": 0, "creation_date": 1487195646, "post_id": 42259364, "comment_id": 71679212, "body": "did you try to transfer same file continuously for several times?"}, {"owner": {"reputation": 455, "user_id": 547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a74c2ce9b0229fd34551b0490a2622e?s=128&d=identicon&r=PG", "display_name": "Gonzalo Serrano", "link": "https://stackoverflow.com/users/547956/gonzalo-serrano"}, "edited": false, "score": 0, "creation_date": 1487195893, "post_id": 42259364, "comment_id": 71679342, "body": "yep <a href=\"https://gist.github.com/gonzaloserrano/1c4bfda42bf8ddfb87cedc62c91b2878\" rel=\"nofollow noreferrer\">gist.github.com/gonzaloserrano/1c4bfda42bf8ddfb87cedc62c91b2&zwnj;&#8203;878</a>"}, {"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "reply_to_user": {"reputation": 455, "user_id": 547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a74c2ce9b0229fd34551b0490a2622e?s=128&d=identicon&r=PG", "display_name": "Gonzalo Serrano", "link": "https://stackoverflow.com/users/547956/gonzalo-serrano"}, "edited": false, "score": 0, "creation_date": 1487196030, "post_id": 42259364, "comment_id": 71679410, "body": "that is very strange behavior. for me it gets stuck sometime at the very first try and sometimes after several successful try. I don&#39;t know if it has anything to do with the file size."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487196237, "post_id": 42259364, "comment_id": 71679508, "body": "Where exactly in the code is it blocked for you?"}, {"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "edited": false, "score": 0, "creation_date": 1487196626, "post_id": 42259364, "comment_id": 71679713, "body": "In server.go receiveFile() function. Line - n, err := connection.Read(fileBuffer)"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1487200041, "last_edit_date": 1487200041, "creation_date": 1487199209, "answer_id": 42261630, "question_id": 42259364, "link": "https://stackoverflow.com/questions/42259364/golang-tcp-file-transfer-gets-stuck-in-the-middle/42261630#42261630", "title": "Golang TCP File Transfer Gets Stuck In the Middle", "body": "<p>You can't wrap the <code>net.Conn</code> in a <code>bufio.Reader</code>, then continue to use the <code>net.Conn</code>. The reason your function is blocked is because you left data buffered in the <code>reader</code>, so you won't ever reach the desired message size.</p>\n\n<p>You need to pass the <code>reader</code> to the <code>receiveFile</code> function in order to not lose the buffered data. </p>\n\n<p>You are also ignoring the <code>isPrefix</code> return value from <code>ReadLine</code>. I would follow the documentation and use <code>ReadBytes</code> instead if you're not going to handle all cases from that method. </p>\n"}], "owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 42261630, "answer_count": 1, "score": 0, "last_activity_date": 1487200041, "creation_date": 1487190421, "question_id": 42259364, "link": "https://stackoverflow.com/questions/42259364/golang-tcp-file-transfer-gets-stuck-in-the-middle", "title": "Golang TCP File Transfer Gets Stuck In the Middle", "body": "<p>I'm having some file transfer issue over <code>TCP</code> in <code>go</code>. The file transfer works sometimes and sometimes it gets stuck in the middle. When it gets stuck, it looks like it is expecting data in the communication channel but there is no data and no error as well. Hence it gets stuck indefinitely. To make thing confusing it shows this behavior for same file i.e for same file it works sometimes and sometimes it doesn't work.</p>\n\n<p>This is how my program works. It'll listen for incoming requests. The requests are in <code>JSON</code> format. Based on request type it'll do different operation. I'm posting the code segment related to file transfer.</p>\n\n<p><strong>server.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"encoding/json\"\n    \"fmt\"\n    _\"io\"\n    \"net\"\n    \"os\"\n)\n\nconst (\n    COMMAND_RECEIVE_FILE    = \"TRANSFER_FILE\"\n    COMMAND_EXIT            = \"EXIT\"\n\n    CONNECTION_TYPE = \"tcp\"\n    CONNECTION_PORT = \"3645\"\n    CONNECTION_HOST = \"\"\n    BUFFER_SIZE     = 1024\n)\n\ntype Command struct {\n    Identifier string `json:\"identifier\"`\n    Name       string `json:\"name\"`\n    Size       int64  `json:\"size\"`\n}\n\ntype Result struct {\n    Message     string        `json:\"message\"`\n}\n\nfunc receiveFile(connection net.Conn, fileName string, fileSize int64) Result {\n    fmt.Println(\"Receiving file\")\n    result := Result{Message: \"\"}\n\n    file, err := os.Create(fileName)\n    if err != nil {\n        fmt.Println(err)\n        result.Message = \"Error opening file: \" + fileName\n        return result\n    }\n\n    defer file.Close()\n\n    fileBuffer := make([]byte, BUFFER_SIZE)\n    bytesRead := int64(0)\n    count := 0\n    for {\n        if fileSize-bytesRead &lt; int64(BUFFER_SIZE) {\n            fileBuffer = make([]byte, fileSize-bytesRead)\n        }\n\n        fmt.Println(\"Reading \", BUFFER_SIZE, \" bytes of data\")\n        n, err := connection.Read(fileBuffer)\n        count++\n        fmt.Println(\"Completed reading\", n, \" bytes of data, count=\", count)\n        file.Write(fileBuffer[0:n])\n        bytesRead += int64(n)\n\n        if err != nil {\n            result.Message = \"File transfer incomplete\"\n            break\n        }\n\n        if bytesRead &gt;= fileSize {\n            result.Message = \"File transfer complete\"\n            break\n        }\n    }\n\n    file.Chmod(0777)\n\n    return result\n}\n\nfunc main() {\n    ln, err := net.Listen(CONNECTION_TYPE, CONNECTION_HOST + \":\"+CONNECTION_PORT)\n    if err != nil {\n        fmt.Println(\"error opening a tcp connection\")\n    }\n\n    for {\n        fmt.Println(\"waiting for new connection\")\n        conn, err := ln.Accept()\n        if err != nil {\n\n        } else {\n            var commandStr string\n            reader := bufio.NewReader(conn)\n\n            var exitStatus = 1\n            for exitStatus == 1 {\n                fmt.Println(\"Waiting for new command: \")\n                line,_,err := reader.ReadLine()\n                if err != nil {\n                    conn.Close()\n                    exitStatus = 0\n                    break\n                } else {\n                    fmt.Println(\"Size read :\", len(line))\n                }\n                commandStr = string(line)\n                fmt.Println(\"CommandStr: \", commandStr)\n\n\n                var msg Command\n                err = json.Unmarshal([]byte(commandStr), &amp;msg)\n                if err != nil {\n                    fmt.Println(\"Error\")\n                    conn.Close()\n                    break\n                }\n\n                result := Result{}\n                fmt.Println(\"Received new command: \", msg.Identifier)\n                switch msg.Identifier {\n\n                case COMMAND_RECEIVE_FILE:\n                    result = receiveFile(conn, msg.Name, msg.Size)\n\n                case COMMAND_EXIT:\n                    exitStatus = 0\n                    conn.Close()\n                default:\n                    result = Result{Message: \"Unrecognized command\"}\n                }\n\n                out, _ := json.Marshal(result)\n                fmt.Fprint(conn, string(out)+\"\\n\")\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><strong>test.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"net\"\n    \"os\"\n    \"strings\"\n    _\"time\"\n)\n\nconst (\n    COMMAND_TRANSFER_FILE   = \"TRANSFER_FILE\"\n    COMMAND_EXIT            = \"EXIT\"\n\n    CONNECTION_TYPE = \"tcp\"\n    CONNECTION_PORT = \"3645\"\n    CONNECTION_HOST = \"\"\n)\n\ntype Command struct {\n    Identifier string `json:\"identifier\"`\n    Name       string `json:\"name\"`\n    Size       int64  `json:\"size\"`\n}\n\ntype Result struct {\n    Message     string        `json:\"message\"`\n}\n\nfunc main() {\n    conn, _ := net.Dial(CONNECTION_TYPE, CONNECTION_HOST + \":\" + CONNECTION_PORT)\n    decoder := json.NewDecoder(conn)\n    com := Command{}\n\n    sourceFileName := \"\"\n    destinationFileName := \"\"\n    for {\n        com = Command{}\n        reader := bufio.NewReader(os.Stdin)\n        identifier, _ := reader.ReadString('\\n')\n        com.Identifier = strings.TrimSpace(identifier)\n\n        switch com.Identifier {\n        case COMMAND_TRANSFER_FILE:\n            fmt.Print(\"Source file name:\")\n            sourceFileName, _ = reader.ReadString('\\n')\n            sourceFileName = strings.TrimSpace(sourceFileName)\n\n            fmt.Print(\"Destination file name:\")\n            destinationFileName, _ = reader.ReadString('\\n')\n            com.Name = strings.TrimSpace(destinationFileName)\n\n            file, err := os.Open(sourceFileName)\n            if err != nil {\n                log.Fatal(err)\n            }\n            defer file.Close()\n\n            fileInfo, err := file.Stat()\n            fileSize := fileInfo.Size()\n            com.Size = fileSize\n\n        case COMMAND_EXIT:\n            conn.Close()\n            os.Exit(0)\n        }\n\n        out, _ := json.Marshal(com)\n        conn.Write([]byte(string(out) + \"\\n\"))\n\n        if strings.Compare(com.Identifier, COMMAND_TRANSFER_FILE) == 0 {\n            file, err := os.Open(sourceFileName)\n            if err != nil {\n                log.Fatal(err)\n            }\n            defer file.Close()\n\n            n, err := io.Copy(conn, file)\n            if err != nil {\n                log.Fatal(err)\n            }\n            fmt.Println(n, \"bytes sent\")\n        }\n\n        var msg Result\n        err := decoder.Decode(&amp;msg)\n        if err != nil {\n            fmt.Println(err)\n        }\n        fmt.Println(msg)\n    }\n}\n</code></pre>\n\n<p>I tested it on both Linux and Windows and it shows same behavior on both system. The only thing I can think of is that the sender is faster than the receiver even though I'm running it on the same machine. If that is the case, what will be a best practice to solve it other than the handshaking mechanism.</p>\n"}, {"tags": ["macos", "sockets", "go", "tcp"], "comments": [{"owner": {"reputation": 455, "user_id": 547956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a74c2ce9b0229fd34551b0490a2622e?s=128&d=identicon&r=PG", "display_name": "Gonzalo Serrano", "link": "https://stackoverflow.com/users/547956/gonzalo-serrano"}, "edited": false, "score": 0, "creation_date": 1487196384, "post_id": 42257588, "comment_id": 71679592, "body": "post a gist with the code so we can check"}, {"owner": {"reputation": 3265, "user_id": 2606938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7gIUB.jpg?s=128&g=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/2606938/prabhu"}, "edited": false, "score": 0, "creation_date": 1487224750, "post_id": 42257588, "comment_id": 71688730, "body": "What exactly is the kind of error you see after 140 connections?"}, {"owner": {"reputation": 3315, "user_id": 1664109, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JAlH9.jpg?s=128&g=1", "display_name": "RockOnGom", "link": "https://stackoverflow.com/users/1664109/rockongom"}, "edited": false, "score": 0, "creation_date": 1487224815, "post_id": 42257588, "comment_id": 71688753, "body": "I do not get any error . No one connection can not established after ~140th connection."}], "answers": [{"tags": [], "owner": {"reputation": 7372, "user_id": 412689, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/73160611f90c8c1e1cdc79f43702bda1?s=128&d=identicon&r=PG", "display_name": "Alex Nichol", "link": "https://stackoverflow.com/users/412689/alex-nichol"}, "is_accepted": false, "score": 0, "last_activity_date": 1487300026, "creation_date": 1487300026, "answer_id": 42288565, "question_id": 42257588, "link": "https://stackoverflow.com/questions/42257588/cant-connect-to-tcp-server-more-than-140-connections/42288565#42288565", "title": "Can&#39;t connect to tcp server more than 140 connections?", "body": "<p>I am on the same operating system as you, but I could not reproduce your issue. I am using Go version 1.7.4. I have not tested on Go 1.8, but it was released earlier today.</p>\n\n<p>I created two files, server.go and client.go (reproduced below). When I run them, I get way more than 140 connections. Before running, I switched to root and setup the ulimit like so:</p>\n\n<pre><code>$ sudo -s\n$ ulimit -n 10000\n</code></pre>\n\n<p>The client outputs:</p>\n\n<pre><code>Established 1 connections\n...\nEstablished 2971 connections\npanic: dial tcp 127.0.0.1:1337: socket: too many open files in system\n</code></pre>\n\n<p>The server outputs something very similar.</p>\n\n<p>Here is client.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    var numConns int\n    for {\n        _, err := net.Dial(\"tcp\", \"127.0.0.1:1337\")\n        if err != nil {\n            panic(err)\n        }\n        numConns++\n        fmt.Println(\"Established\", numConns, \"connections\")\n    }\n}\n</code></pre>\n\n<p>And server.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    listener, err := net.Listen(\"tcp\", \":1337\")\n    if err != nil {\n        panic(err)\n    }\n    var numConns int\n    for {\n        _, err := listener.Accept()\n        if err != nil {\n            panic(err)\n        }\n        numConns++\n        fmt.Println(\"Got\", numConns, \"connections\")\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1487312705, "creation_date": 1487312705, "answer_id": 42290819, "question_id": 42257588, "link": "https://stackoverflow.com/questions/42257588/cant-connect-to-tcp-server-more-than-140-connections/42290819#42290819", "title": "Can&#39;t connect to tcp server more than 140 connections?", "body": "<p>This is not a problem with the operating system, but the hardware. It is likely a problem with your router. Commercial routers do tend to fail when you get into that range. My guess is that Alex is testing at a large company or university where they have commercial grade routers, but you are testing at home.</p>\n"}], "owner": {"reputation": 3315, "user_id": 1664109, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JAlH9.jpg?s=128&g=1", "display_name": "RockOnGom", "link": "https://stackoverflow.com/users/1664109/rockongom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487312705, "creation_date": 1487184083, "last_edit_date": 1487224890, "question_id": 42257588, "link": "https://stackoverflow.com/questions/42257588/cant-connect-to-tcp-server-more-than-140-connections", "title": "Can&#39;t connect to tcp server more than 140 connections?", "body": "<p>I am building a tcp socket server in golang. It works well with less than ~140 client connection. But if i try to set max connection number to 500, after 140th clients do not connect to the server. </p>\n\n<p>I increased file descriptor count to 1048576 but it does not still work.</p>\n\n<pre><code>$ulimit -n\n1048576\n</code></pre>\n\n<p>I think the problem comes from operation system.(server and clients work on same machine) So OS information:</p>\n\n<blockquote>\n  <p>Mac OS 10.12 Sierra 64 bit.</p>\n</blockquote>\n\n<p>Does anyone have any idea why i can't increase tcp connection number?</p>\n\n<p><a href=\"https://github.com/kync/go-tcp-server/blob/master/tcp_server.go\" rel=\"nofollow noreferrer\">github</a></p>\n"}, {"tags": ["parsing", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1487183905, "post_id": 42256915, "comment_id": 71672773, "body": "An email address is neither a url nor is it a host+port. Why not just split on the <code>@</code> character?"}, {"owner": {"reputation": 5036, "user_id": 163186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1eb92e3eabe80013d83ad235b39266c5?s=128&d=identicon&r=PG", "display_name": "Mohamed Nuur", "link": "https://stackoverflow.com/users/163186/mohamed-nuur"}, "edited": false, "score": 1, "creation_date": 1487183998, "post_id": 42256915, "comment_id": 71672829, "body": "<a href=\"https://golang.org/pkg/net/mail/#example_ParseAddress\" rel=\"nofollow noreferrer\">golang.org/pkg/net/mail/#example_ParseAddress</a>"}, {"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "reply_to_user": {"reputation": 5036, "user_id": 163186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1eb92e3eabe80013d83ad235b39266c5?s=128&d=identicon&r=PG", "display_name": "Mohamed Nuur", "link": "https://stackoverflow.com/users/163186/mohamed-nuur"}, "edited": false, "score": 0, "creation_date": 1487184969, "post_id": 42256915, "comment_id": 71673452, "body": "@MohamedNuur I saw this but am hoping to split e.Address in this example"}, {"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487185071, "post_id": 42256915, "comment_id": 71673516, "body": "@JimB can I split on @ and just get the remaining string? My plan now was get len of @ and do email[length:full_length] which would be several lines and I didn&#39;t want to do if there&#39;s a better solution"}, {"owner": {"reputation": 5036, "user_id": 163186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1eb92e3eabe80013d83ad235b39266c5?s=128&d=identicon&r=PG", "display_name": "Mohamed Nuur", "link": "https://stackoverflow.com/users/163186/mohamed-nuur"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487185081, "post_id": 42256915, "comment_id": 71673522, "body": "@jj1111 like @JimB said, just make your own function that splits by <code>@</code> character. I don&#39;t think there&#39;s any library out there for this as people don&#39;t normally parse the email."}], "answers": [{"comments": [{"owner": {"reputation": 4579, "user_id": 1114274, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ebd3b90b30e78d29cc01c13ba6ebb090?s=128&d=identicon&r=PG", "display_name": "Mike Graf", "link": "https://stackoverflow.com/users/1114274/mike-graf"}, "edited": false, "score": 0, "creation_date": 1545847610, "post_id": 42258032, "comment_id": 94711106, "body": "Nurr can you add links to the documentation you used?"}, {"owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "edited": false, "score": 3, "creation_date": 1570492950, "post_id": 42258032, "comment_id": 102923218, "body": "I highly doubt you will run into this in real life, but as written this answer is incorrect. The spec for valid email addresses permits multiple &quot;@&quot; signs in an email address. You want to use the last one as the domain part, not the first one. <a href=\"https://stackoverflow.com/a/12355882/329700\">stackoverflow.com/a/12355882/329700</a>"}, {"owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "edited": false, "score": 0, "creation_date": 1596817957, "post_id": 42258032, "comment_id": 111942552, "body": "Take a look into <code>net&#47;mail</code> package it shows correct way to split email into parts"}], "tags": [], "owner": {"reputation": 5036, "user_id": 163186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1eb92e3eabe80013d83ad235b39266c5?s=128&d=identicon&r=PG", "display_name": "Mohamed Nuur", "link": "https://stackoverflow.com/users/163186/mohamed-nuur"}, "is_accepted": true, "score": 9, "last_activity_date": 1598987716, "last_edit_date": 1598987716, "creation_date": 1487185577, "answer_id": 42258032, "question_id": 42256915, "link": "https://stackoverflow.com/questions/42256915/golang-get-domain-from-email-using-parse-standard-library/42258032#42258032", "title": "golang get domain from email using parse standard library", "body": "<p>Here's an example I concocted from the <a href=\"https://godoc.org/strings#Split\" rel=\"nofollow noreferrer\">golang documentation</a>:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    email := &quot;foo@bar.com&quot;\n    components := strings.Split(email, &quot;@&quot;)\n    username, domain := components[0], components[1]\n    \n    fmt.Printf(&quot;Username: %s, Domain: %s\\n&quot;, username, domain)\n}\n</code></pre>\n<hr />\n<p>UPDATE: 2020-09-01 - updating to use last <code>@</code> sign per @Kevin's feedback in the comments.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    email := &quot;foo@bar.com&quot;\n    at := strings.LastIndex(email, &quot;@&quot;)\n    if at &gt;= 0 {\n        username, domain := email[:at], email[at+1:]\n\n        fmt.Printf(&quot;Username: %s, Domain: %s\\n&quot;, username, domain)\n    } else {\n        fmt.Printf(&quot;Error: %s is an invalid email address\\n&quot;, email)\n    }\n}\n</code></pre>\n<p>Here are some tests: <a href=\"https://play.golang.org/p/cg4RqZADLml\" rel=\"nofollow noreferrer\">https://play.golang.org/p/cg4RqZADLml</a></p>\n"}], "owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5835, "favorite_count": 0, "accepted_answer_id": 42258032, "answer_count": 1, "score": 3, "last_activity_date": 1598987716, "creation_date": 1487181854, "question_id": 42256915, "link": "https://stackoverflow.com/questions/42256915/golang-get-domain-from-email-using-parse-standard-library", "title": "golang get domain from email using parse standard library", "body": "<p>I'm having trouble pulling out the domain for emails. I've tried using variations of </p>\n\n<pre><code>u, _ := url.Parse(email) \n</code></pre>\n\n<p>and other parsing from the standard library, but nothing that seems to parse: user@gmail.com into separate parts.</p>\n\n<p>I've also tried net.SplitHostPort with no luck.</p>\n\n<p>I don't want to get create a function which gets the len and separate to get substring after @ symbol if possible.</p>\n\n<p>Does anyone have any ideas to do this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5741628, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IoSAyKEQXrU/AAAAAAAAAAI/AAAAAAAAACE/oh65oJYjuo4/photo.jpg?sz=128", "display_name": "Ben Weedon", "link": "https://stackoverflow.com/users/5741628/ben-weedon"}, "edited": false, "score": 0, "creation_date": 1487270985, "post_id": 42268603, "comment_id": 71721087, "body": "Oh, that makes a lot of sense! Thanks so much for the help!"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 3, "last_activity_date": 1487233857, "creation_date": 1487233857, "answer_id": 42268603, "question_id": 42256833, "link": "https://stackoverflow.com/questions/42256833/go-cant-call-c-function/42268603#42268603", "title": "Go can&#39;t call c++ function", "body": "<p>I may be wrong, but I think <code>cgo</code> supports C++ only in the sense it knows how to invoke a C++ compiler on the non-Go files which looks like containing C++ source code, and that's all.</p>\n\n<p>The problem is that C++ compilers use so-called <a href=\"https://en.wikipedia.org/wiki/Name_mangling#C.2B.2B\" rel=\"nofollow noreferrer\">\"mangling\"</a> for the symbols made exported from the compiled files.  Exporting symbols were originally\nintended only for C-like languages, where all which can be exported are plain\nfunctions and variables, but C++ adds classes and function overloading,\nand to export such symbols from compiled (\"object\") files, a C++ compiler\nneeds to \"mangle\" them using certain schema to encode names of classes\nand types of arguments in these names.  What's worse, each C++ compiler\nbrand uses its own mangling schemas.</p>\n\n<p>So I think while <code>cgo</code> is able to compile C++ code, it sort of assumes that\nall the symbols exported (to be used by Go) in your C++ files are\nwrapped in <code>extern \"C\" { ... }</code> (see <a href=\"http://en.cppreference.com/w/cpp/language/language_linkage\" rel=\"nofollow noreferrer\">this</a>).</p>\n\n<p>If you need calls to \"native\" C++ exported stuff, you'd need to use\n<a href=\"http://www.swig.org/Doc2.0/Go.html\" rel=\"nofollow noreferrer\">SWIG</a> I reckon.</p>\n"}], "owner": {"reputation": 53, "user_id": 5741628, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IoSAyKEQXrU/AAAAAAAAAAI/AAAAAAAAACE/oh65oJYjuo4/photo.jpg?sz=128", "display_name": "Ben Weedon", "link": "https://stackoverflow.com/users/5741628/ben-weedon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1831, "favorite_count": 0, "accepted_answer_id": 42268603, "answer_count": 1, "score": 1, "last_activity_date": 1487233857, "creation_date": 1487181585, "question_id": 42256833, "link": "https://stackoverflow.com/questions/42256833/go-cant-call-c-function", "title": "Go can&#39;t call c++ function", "body": "<p>I have been using cgo to interface between Go and C. However, when trying to do the same for Go and C++, I get a compile error every time I attempt to call a function. Using <code>go build .</code> from the code's directory, I get the following errors:</p>\n\n<pre><code>./main.go: In function 'void _cgo_3612c872201c_Cfunc_getint(void*)':\n./main.go:48:53: error: invalid conversion from 'void*' to '_cgo_3612c872201c_Cfunc_getint(void*)::&lt;anonymous struct&gt;*' [-fpermissive]\n./main.go:54:4: error: invalid conversion from 'void*' to '_cgo_3612c872201c_Cfunc_getint(void*)::&lt;anonymous struct&gt;*' [-fpermissive]\n</code></pre>\n\n<p>I've put a super simple example below which shows the problem.</p>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\n/*\n#cgo CFLAGS: -x c++\n\nint getint()\n{\n    return 1;\n}\n*/\nimport \"C\"\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(C.getint())\n}\n</code></pre>\n\n<p>Does anyone know if this is a bug in cgo, or something wrong with how I wrote the code? According to the <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">cgo documentation</a>, C++ is supported. I'm using Go version 1.7.5 for linux/amd64.</p>\n\n<p>Thanks so much!</p>\n"}, {"tags": ["go", "couchbase", "gocb"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1487177431, "post_id": 42255334, "comment_id": 71668496, "body": "Show working code that demonstrates the issue.  The posted code does not compile, but works as expected when the errors are corrected."}, {"owner": {"reputation": 47, "user_id": 4316453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2281b76849a53371197fb3226ce79584?s=128&d=identicon&r=PG&f=1", "display_name": "Sudesh Gutta", "link": "https://stackoverflow.com/users/4316453/sudesh-gutta"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1487178199, "post_id": 42255334, "comment_id": 71669091, "body": "Sure added the working code :)"}, {"owner": {"reputation": 2345, "user_id": 4580460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pq9gW.jpg?s=128&g=1", "display_name": "geraldss", "link": "https://stackoverflow.com/users/4580460/geraldss"}, "edited": false, "score": 2, "creation_date": 1487180418, "post_id": 42255334, "comment_id": 71670623, "body": "Perhaps the problem is your debugging. If you just print out or log the buffer, you will see the full string."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1487180813, "post_id": 42255334, "comment_id": 71670875, "body": "@SudeshGutta See <a href=\"https://play.golang.org/p/bnsGmejlyu\" rel=\"nofollow noreferrer\">play.golang.org/p/bnsGmejlyu</a>. What about that is not working as expected?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1487192426, "post_id": 42255334, "comment_id": 71677525, "body": "@CeriseLim&#243;n: For example, <code>DB.ITEM_NAME=appleOR</code> is almost certainly wrong."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1487194557, "post_id": 42255334, "comment_id": 71678661, "body": "@CeriseLim&#243;n: Since the size of a Go string is represented by an <code>int</code> --  Gigabytes for 32-bit systems, Exabytes for 64-bit systems -- the notion of a 64 byte limit is clearly absurd."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1487197002, "post_id": 42255334, "comment_id": 71679899, "body": "Yes, it&#39;s absurd. The goal of my comments is to show the OP that the string operations work as expected and that the problem lies elsewhere."}, {"owner": {"reputation": 47, "user_id": 4316453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2281b76849a53371197fb3226ce79584?s=128&d=identicon&r=PG&f=1", "display_name": "Sudesh Gutta", "link": "https://stackoverflow.com/users/4316453/sudesh-gutta"}, "edited": false, "score": 0, "creation_date": 1487349279, "post_id": 42255334, "comment_id": 71760768, "body": "It&#39;s the debugger that was truncating the characters... thank you all for your support :-)"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1487200624, "last_edit_date": 1487200624, "creation_date": 1487192105, "answer_id": 42259863, "question_id": 42255334, "link": "https://stackoverflow.com/questions/42255334/strange-behaviour-golang-limits-storing-of-string-into-a-variable-to-64-bytes-le/42259863#42259863", "title": "Strange behaviour GoLang limits storing of string into a variable to 64 bytes length", "body": "<p>The behaviour is as expected. The behaviour is not strange.</p>\n\n<p>Your code creates obviously wrong Couchbase N1QL:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    userInput := []string{\"apple\", \"boy\", \"cat\", \"dog\"}\n    var buffer string\n    buffer = \"SELECT * FROM DB WHERE DB.ITEM_NAME=\" + userInput[0] +\n        \"OR DB.ITEM_NAME=\" + userInput[1]\n    fmt.Println(buffer)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>SELECT * FROM DB WHERE DB.ITEM_NAME=appleOR DB.ITEM_NAME=boy\n</code></pre>\n\n<p>Here is a plausible solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    userInput := []string{\"apple\", \"boy\", \"cat\", \"dog\"}\n    query := fmt.Sprintf(\n        `SELECT * FROM DB WHERE DB.ITEM_NAME=%q OR DB.ITEM_NAME=%q;`,\n        userInput[0], userInput[1],\n    )\n    fmt.Println(query)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>SELECT * FROM DB WHERE DB.ITEM_NAME=\"apple\" OR DB.ITEM_NAME=\"boy\";\n</code></pre>\n\n<p>Note: Beware of SQL injection.</p>\n\n<p>References:</p>\n\n<p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n\n<p><a href=\"http://query.pub.couchbase.com/tutorial/#1\" rel=\"nofollow noreferrer\">Couchbase: Query Language Tutorial</a></p>\n\n<p><a href=\"https://developer.couchbase.com/documentation/server/current/sdk/n1ql-query.html\" rel=\"nofollow noreferrer\">Couchbase: Querying with N1QL</a></p>\n"}], "owner": {"reputation": 47, "user_id": 4316453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2281b76849a53371197fb3226ce79584?s=128&d=identicon&r=PG&f=1", "display_name": "Sudesh Gutta", "link": "https://stackoverflow.com/users/4316453/sudesh-gutta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 42259863, "answer_count": 1, "score": -4, "last_activity_date": 1487200624, "creation_date": 1487177226, "last_edit_date": 1487178982, "question_id": 42255334, "link": "https://stackoverflow.com/questions/42255334/strange-behaviour-golang-limits-storing-of-string-into-a-variable-to-64-bytes-le", "title": "Strange behaviour GoLang limits storing of string into a variable to 64 bytes length", "body": "<p>I have been trying to store a large string into a string variable in GoLang , but for some unknown reason GoLang is limiting the string to 64 Bytes in length </p>\n\n<p>The main purpose of this string concatenation is to generate a couchbase's N1QL query at runtime based on user input </p>\n\n<pre><code>userInput := []string{\"apple\", \"boy\", \"cat\", \"dog\"} \nvar buffer string \nbuffer = \"SELECT * FROM DB WHERE DB.ITEM_NAME=\"+userInput[0]+\n         \"OR DB.ITEM_NAME=\"+userInput[1]\n</code></pre>\n\n<p>In such a case if I debug on variable buffer, for example I can see it contains only until \"SELECT * FROM DB WHERE DB.ITEM_NAME=\"+userInput[0]+OR\" depending upon user input size it varies and it caps the string to 64th character </p>\n"}, {"tags": ["go", "testify"], "comments": [{"owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "edited": false, "score": 6, "creation_date": 1487175653, "post_id": 42254513, "comment_id": 71667174, "body": "Have you run <code>go get github.com&#47;stretchr&#47;testify&#47;assert</code> to get the assert package?"}, {"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "reply_to_user": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "edited": false, "score": 0, "creation_date": 1487175783, "post_id": 42254513, "comment_id": 71667271, "body": "ahhhhhhh nope! Brand new to golang and aside from doing that once a week ago I forgot. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "is_accepted": true, "score": 9, "last_activity_date": 1487175937, "creation_date": 1487175937, "answer_id": 42254825, "question_id": 42254513, "link": "https://stackoverflow.com/questions/42254513/golang-test-error-cannot-find-package-github-com-stretchr-testify-assert-in-a/42254825#42254825", "title": "golang test error: cannot find package &quot;github.com/stretchr/testify/assert&quot; in any of:", "body": "<p>Moving the answer here for others in the future.</p>\n\n<p>You need to both import the package and run <code>go get github.com/package/path</code> to install the package. </p>\n"}], "owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4555, "favorite_count": 0, "accepted_answer_id": 42254825, "answer_count": 1, "score": 4, "last_activity_date": 1487175937, "creation_date": 1487175069, "question_id": 42254513, "link": "https://stackoverflow.com/questions/42254513/golang-test-error-cannot-find-package-github-com-stretchr-testify-assert-in-a", "title": "golang test error: cannot find package &quot;github.com/stretchr/testify/assert&quot; in any of:", "body": "<p>My import looks like this below:</p>\n\n<pre><code>import (\n\"testing\"\n\n\"github.com/stretchr/testify/assert\"\n)\n</code></pre>\n\n<p>when I try try running 'go test' I get the error message: </p>\n\n<pre><code>cannot find package \"github.com/stretchr/testify/assert\" in any of:\n/Users/[username]/go/src/github.com/[group_name]/[project_name]/vendor/github.com/stretchr/testify/assert (vendor tree)\n/usr/local/go/src/github.com/stretchr/testify/assert (from $GOROOT)\n/Users/[username]/go/src/github.com/stretchr/testify/assert (from $GOPATH)\nFAIL    github.com/[group_name]/[project_name]/lib/briteverify [setup failed]\n</code></pre>\n\n<p>So it appears the last line is the issue, where it says in .../lib/briteverify it cannot find github.com/stretchr/testify/assert. However, I have this as an import so I don't know why it would throw this error. Any thoughts?</p>\n"}, {"tags": ["go", "influxdb"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7569973, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7ZPKA.jpg?s=128&g=1", "display_name": "Prathamesh Nimkar", "link": "https://stackoverflow.com/users/7569973/prathamesh-nimkar"}, "edited": false, "score": 0, "creation_date": 1487235050, "post_id": 42261052, "comment_id": 71694188, "body": "Hello @kostya  Thanks for your reply Here is what I tried:  &gt;cd c:\\go &gt;mkdir projects &gt;set &quot;GOPATH=C:\\Go\\projects&quot; &gt;cd %gopath% &gt;git config --global http.proxy <a href=\"http://username:encodedpassword@hostname:port\" rel=\"nofollow noreferrer\">username:encodedpassword@hostname:port</a> &gt;set https_proxy=<a href=\"https://username:encodedpassword@host:port\" rel=\"nofollow noreferrer\">username:encodedpassword@host:port</a> &gt;go get -u github.com/influxdata/influxdb/...  &amp; I still ended up with the same error as above  Am I missing something?  Thanks P"}, {"owner": {"reputation": 23, "user_id": 7569973, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7ZPKA.jpg?s=128&g=1", "display_name": "Prathamesh Nimkar", "link": "https://stackoverflow.com/users/7569973/prathamesh-nimkar"}, "edited": false, "score": 0, "creation_date": 1487235702, "post_id": 42261052, "comment_id": 71694652, "body": "Hello again @kostya  Also I downloaded Standalone Windows Binaries (64-bit) from  <a href=\"https://portal.influxdata.com/downloads\" rel=\"nofollow noreferrer\">portal.influxdata.com/downloads</a>  Followed my original link followed Xavier to execute and now I am not able to create a database on <a href=\"http://localhost:8083\" rel=\"nofollow noreferrer\">localhost:8083</a>  Thanks P"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 0, "last_activity_date": 1487196664, "creation_date": 1487196664, "answer_id": 42261052, "question_id": 42254362, "link": "https://stackoverflow.com/questions/42254362/influxdb-installation-issue-on-windows/42261052#42261052", "title": "InfluxDB installation issue on Windows", "body": "<pre><code>go get -u github.com/influxdata/influxdb/...\n</code></pre>\n\n<p>follow the second answer from the link you mentined (by Xavier Pe\u00f1a)</p>\n\n<p>Or download pre-built binary from <a href=\"https://portal.influxdata.com/downloads\" rel=\"nofollow noreferrer\">https://portal.influxdata.com/downloads</a></p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 7569973, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7ZPKA.jpg?s=128&g=1", "display_name": "Prathamesh Nimkar", "link": "https://stackoverflow.com/users/7569973/prathamesh-nimkar"}, "is_accepted": true, "score": 0, "last_activity_date": 1487509379, "last_edit_date": 1487509379, "creation_date": 1487432763, "answer_id": 42317241, "question_id": 42254362, "link": "https://stackoverflow.com/questions/42254362/influxdb-installation-issue-on-windows/42317241#42317241", "title": "InfluxDB installation issue on Windows", "body": "<p><strong>Solution</strong>\nRefer to <a href=\"https://github.com/influxdata/influxdb/issues/8016\" rel=\"nofollow noreferrer\">https://github.com/influxdata/influxdb/issues/8016</a></p>\n\n<p>Go version - 1.7.5\nGit version - 2.11.1\nHg version - 3.7.1</p>\n\n<pre><code>cd c:\\go\nmkdir projects\nset \"GOPATH=C:\\Go\\projects\"\ncd %gopath%\ngit config --global http.proxy http://user:enc_pw@IP:port\nset https_proxy=https://user:enc_pw@IP:port\ngo get github.com/sparrc/gdm\ngo get github.com/influxdata/influxdb\ncd src\\github.com\\influxdata\\influxdb\ngo get -v -u -f ./...\nC:\\Go\\projects\\bin\\gdm restore\ngo install ./...\ngo build ./...\n</code></pre>\n\n<p>This should help to effectively solve all the problems and you may continue with original link</p>\n"}], "owner": {"reputation": 23, "user_id": 7569973, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7ZPKA.jpg?s=128&g=1", "display_name": "Prathamesh Nimkar", "link": "https://stackoverflow.com/users/7569973/prathamesh-nimkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1178, "favorite_count": 0, "accepted_answer_id": 42317241, "answer_count": 2, "score": 0, "last_activity_date": 1487509379, "creation_date": 1487174659, "last_edit_date": 1495542844, "question_id": 42254362, "link": "https://stackoverflow.com/questions/42254362/influxdb-installation-issue-on-windows", "title": "InfluxDB installation issue on Windows", "body": "<p>In reference to \n<a href=\"https://stackoverflow.com/questions/26116711/how-to-install-influxdb-in-windows\">How to install InfluxDB in Windows</a></p>\n\n<p>I've followed all the steps upto:</p>\n\n<pre><code>go get -u -f ./...\n</code></pre>\n\n<p>But am facing an issue as below</p>\n\n<pre><code># github.com/influxdata/influxdb/services/precreator\nservices\\precreator\\service.go:32: undefined: zap.NullEncoder\nservices\\precreator\\service.go:32: cannot use zap.New(zap.NullEncoder()) (type *zap.Logger) as type zap.Logger in field value\nservices\\precreator\\service.go:40: cannot use log.With(zap.String(\"service\", \"shard-precreation\")) (type *zap.Logger) as type zap.Logger in assignment\n\n# github.com/influxdata/influxdb/services/admin\nservices\\admin\\service.go:36: undefined: zap.NullEncoder\nservices\\admin\\service.go:36: cannot use zap.New(zap.NullEncoder()) (type *zap.Logger) as type zap.Logger in field value\nservices\\admin\\service.go:85: cannot use log.With(zap.String(\"service\", \"admin\")) (type *zap.Logger) as type zap.Logger in assignment\n# github.com/influxdata/influxdb/influxql\ninfluxql\\query_executor.go:184: undefined: zap.NullEncoder\ninfluxql\\query_executor.go:184: cannot use zap.New(zap.NullEncoder()) (type *zap.Logger) as type zap.Logger in field value\ninfluxql\\query_executor.go:219: cannot use log.With(zap.String(\"service\", \"query\")) (type *zap.Logger) as type zap.Logger in assignment\ninfluxql\\task_manager.go:45: undefined: zap.NullEncoder\ninfluxql\\task_manager.go:45: cannot use zap.New(zap.NullEncoder()) (type *zap.Logger) as type zap.Logger in field value\n</code></pre>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 1, "last_activity_date": 1487175871, "last_edit_date": 1487175871, "creation_date": 1487174914, "answer_id": 42254448, "question_id": 42254256, "link": "https://stackoverflow.com/questions/42254256/variable-json-structure-mapping-with-go-struct-type/42254448#42254448", "title": "Variable JSON structure mapping with Go struct type", "body": "<p>You can use <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">json2go</a>. For the variable part you could use a map</p>\n\n<p>And you get:</p>\n\n<pre><code>type AutoGenerated struct {\n    Key1 string `json:\"Key1\"`\n    Key2 string `json:\"Key2\"`\n    Key3 map[string]string `json:\"Key3\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 828, "user_id": 662017, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0b1bad601ac2781fc1a5dd2160121a44?s=128&d=identicon&r=PG", "display_name": "Alwin Doss", "link": "https://stackoverflow.com/users/662017/alwin-doss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 42254448, "answer_count": 1, "score": 1, "last_activity_date": 1487175871, "creation_date": 1487174412, "question_id": 42254256, "link": "https://stackoverflow.com/questions/42254256/variable-json-structure-mapping-with-go-struct-type", "title": "Variable JSON structure mapping with Go struct type", "body": "<p>I have a JSON that is as follows</p>\n\n<pre><code>{\n  \"Key1\": \"Value1\",\n  \"Key2\": \"Value2\",\n  \"Key3\": {\n    \"InnerKey1\": \"InnerValue1\",\n    \"InnerKey2\": \"InnerValue2\",\n    ...\n  }\n}\n</code></pre>\n\n<p>The problem I have is with the Key3 structure which contains a key value of variable length. It is possible that the client sends me another key. How do I create a <code>struct</code> for this in Go</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3635106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774ee3c3ef89162b67a11cf685d3d56b?s=128&d=identicon&r=PG&f=1", "display_name": "TaylorBarrick", "link": "https://stackoverflow.com/users/3635106/taylorbarrick"}, "edited": false, "score": 0, "creation_date": 1487177166, "post_id": 42254737, "comment_id": 71668300, "body": "That&#39;s exactly what I was looking for.  I did change the idea od the Scanner interface to take ...interface{} instead of the structure, but exactly what I needed!"}], "tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 0, "last_activity_date": 1487175701, "creation_date": 1487175701, "answer_id": 42254737, "question_id": 42253698, "link": "https://stackoverflow.com/questions/42253698/testable-database-sql-sql-rows-in-go/42254737#42254737", "title": "Testable database/sql sql.Rows in go", "body": "<p>The go way would be to use an interface as input.</p>\n\n<p>In your case it could look like this:</p>\n\n<pre><code>type Scanner interface {\n  Next()\n  Scan(User)\n}\n</code></pre>\n\n<p>The function should look like this:</p>\n\n<pre><code>func parseUsers(s Scanner) (users []User, err error) {\n  // ...\n}\n</code></pre>\n\n<p>Now testing is very easy, because you can create a mock scanner, which implements the interface and remembers, with which parameters the methods has been called.</p>\n"}], "owner": {"reputation": 55, "user_id": 3635106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774ee3c3ef89162b67a11cf685d3d56b?s=128&d=identicon&r=PG&f=1", "display_name": "TaylorBarrick", "link": "https://stackoverflow.com/users/3635106/taylorbarrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 42254737, "answer_count": 1, "score": 1, "last_activity_date": 1487175701, "creation_date": 1487173033, "question_id": 42253698, "link": "https://stackoverflow.com/questions/42253698/testable-database-sql-sql-rows-in-go", "title": "Testable database/sql sql.Rows in go", "body": "<p>Is there a good practice for testing/mocking functions that perform the scanning of sql.Rows into structs.  </p>\n\n<pre><code>func parseUsers(r *sql.Rows) (users []User, err error) {\n    for r.Next() {\n        var u User\n        if err = r.Scan(&amp;u.Username,\n            &amp;u.DisplayName,\n            &amp;u.EmailAddress,\n            &amp;u.IsEnabled,\n            &amp;u.PhoneNumber); err != nil {\n            return []User{}, err\n        }\n        users = append(users, u)\n    }\n    err = r.Err()\n    return\n}\n</code></pre>\n\n<p>But trying to do something like:</p>\n\n<pre><code>func TestParseUsers(t *testing.T) {\n    //make mock sql.Rows\n    u, err := parseUsers(fakeRows)\n    //Do tests...\n}\n</code></pre>\n\n<p>I have looked at sqlx, but would like to keep the database/sql structure. And I checked go-sqlmock, but I am looking for something without a large build up.</p>\n\n<p>Is there a good strategy for this sort of test?</p>\n"}, {"tags": ["google-app-engine", "go", "installation"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1487172925, "post_id": 42253616, "comment_id": 71664964, "body": "What do you mean by <code>goapp</code>? <code>go</code> is the application."}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1487173294, "post_id": 42253616, "comment_id": 71665260, "body": "Not according to the Tutorial:  <a href=\"https://cloud.google.com/appengine/docs/go/getting-started/creating-guestbook\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/getting-started/&hellip;</a>"}, {"owner": {"reputation": 14385, "user_id": 125759, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/779643d33a595f5736dbd5a93d188cfe?s=128&d=identicon&r=PG", "display_name": "sgmoore", "link": "https://stackoverflow.com/users/125759/sgmoore"}, "edited": false, "score": 0, "creation_date": 1487173686, "post_id": 42253616, "comment_id": 71665555, "body": "Did you just create a new tag for goapp without saying that it was? (I assume goappengine is the go sdk for developing apps to run under google&#39;s appengine)."}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1487174370, "post_id": 42253616, "comment_id": 71666139, "body": "goapp is a binary that should be installed with the Go sdk. It seems to be used to start a local server."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1487174622, "post_id": 42253616, "comment_id": 71666350, "body": "@BryanWheelock The Go AppEngine SDK has its own separate folder. It is not installed into the Go SDK, you won&#39;t find <code>goapp</code> in the <code>go&#47;bin</code> folder."}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1487174970, "post_id": 42253616, "comment_id": 71666645, "body": "Oh, so Golang  needs to be installed first AND then install the Go appengine SDK?"}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1487175347, "post_id": 42253616, "comment_id": 71666937, "body": "I ran a find on my entire systems and goapp doesn&#39;t exist there."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1487178507, "post_id": 42253616, "comment_id": 71669336, "body": "@BryanWheelock Go (golang) is not required for the Google App Engine SDK (as it has a bundled Go SDK). Please read my other post entirely (this is mentioned in it): <a href=\"http://stackoverflow.com/questions/39025458/google-go-sdk-or-golang-app/39032559#39032559\">Google Go SDK or Golang app?</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1487178566, "post_id": 42253616, "comment_id": 71669376, "body": "@BryanWheelock If you can&#39;t find the <code>goapp</code> binary, that means have not downloaded and / or extracted the AppEngine SDK (or not to a folder where you&#39;re looking for it)."}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1487179684, "post_id": 42253616, "comment_id": 71670148, "body": "I have a go binary, but not a goapp binary. The tutorial uses $ goapp server    to start a local GAE server.  I attempted $ go server and that didn&#39;t work either."}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1487180352, "post_id": 42253616, "comment_id": 71670586, "body": "I just downloaded the SDK again. It has the exact same name but when I unpacked the new download it contained google_appengine and the goapp binary.   I wish I understood why it was different from the content of my earlier download."}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1487180888, "post_id": 42253616, "comment_id": 71670929, "body": "<code>-rw-r--r--@   1 bryan  staff  68629396 Feb 15 12:32 go_appengine_sdk_darwin_amd64-1.9.48 (1).zip   -rw-r--r--@   1 bryan  staff  68629396 Feb 15 10:17 go_appengine_sdk_darwin_amd64-1.9.48.zip</code>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1487189138, "post_id": 42253616, "comment_id": 71675746, "body": "Simply extracting the AppEngine Go SDK and adding its directory to your <code>PATH</code> will allow you to use <code>goapp</code> wherever you want."}], "answers": [{"comments": [{"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1487174286, "post_id": 42253789, "comment_id": 71666068, "body": "I&#39;m running osX and downloaded go_appengine_sdk_darwin_amd64-1.9.48.zip  which is a different package. Maybe the download package does not contain all the required files."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1487174483, "post_id": 42253789, "comment_id": 71666243, "body": "@BryanWheelock No, I just checked it with the OS-X version, and it&#39;s the same."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1487174890, "last_edit_date": 1495540900, "creation_date": 1487173256, "answer_id": 42253789, "question_id": 42253616, "link": "https://stackoverflow.com/questions/42253616/where-is-the-goapp-binary/42253789#42253789", "title": "Where is the goapp binary?", "body": "<p><strong>Foreword:</strong> If you are unsure what the <em>\"Go SDK\"</em> and the <em>\"Google App Engine SDK for Go\"</em> are or which one you need, I recommend you this post: <a href=\"https://stackoverflow.com/questions/39025458/google-go-sdk-or-golang-app/39032559#39032559\">Google Go SDK or Golang app?</a></p>\n\n<hr>\n\n<p><strong>Edit:</strong> Below answer uses the Linux 64-bit version, but I also tried the OS-X 64-bit version and it's the same.</p>\n\n<p>The Go AppEngine SDK has its own separate folder. It is not installed into the Go SDK, you won't find <code>goapp</code> in the <code>go/bin</code> folder.</p>\n\n<p>When you unzip the Go AppEngine SDK zip file, it contains a <code>go_appengine</code> folder, and the <code>goapp</code> executable binary is right inside that along with <code>godoc</code> and <code>gofmt</code>.</p>\n\n<p>E.g.:</p>\n\n<pre><code>wget https://storage.googleapis.com/appengine-sdks/featured/go_appengine_sdk_linux_amd64-1.9.48.zip\nunzip go_appengine_sdk_linux_amd64-1.9.48.zip\nll\n</code></pre>\n\n<p>Output after unpacking:</p>\n\n<pre><code>total 67224\ndrwxrwxr-x  3 myuser mygroup     4096 Feb 15 15:37 ./\ndrwxr-x--- 12 myuser mygroup     4096 Feb  7 00:10 ../\ndrwxr-xr-x  8 myuser mygroup     4096 Nov 29 19:29 go_appengine/\n-rw-rw-r--  1 myuser mygroup 68822758 Dec  1 19:31 go_appengine_sdk_linux_amd64-1.9.48.zip\n</code></pre>\n\n<p>Listing contents of <code>go_appengine/</code>:</p>\n\n<pre><code>ll go_appengine\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>-rwxr-xr-x  1 myuser mygroup  3127 Nov 29 19:29 appcfg.py\n-rwxr-xr-x  1 myuser mygroup  3127 Nov 29 19:29 backends_conversion.py\n-rw-r--r--  1 myuser mygroup   156 Nov 29 19:29 BUGS\n-rwxr-xr-x  1 myuser mygroup  3127 Nov 29 19:29 bulkload_client.py\n-rwxr-xr-x  1 myuser mygroup  3127 Nov 29 19:29 bulkloader.py\ndrwxr-xr-x 11 myuser mygroup  4096 Nov 29 19:29 demos\n-rwxr-xr-x  1 myuser mygroup  2344 Nov 29 19:29 dev_appserver.py\n-rwxr-xr-x  1 myuser mygroup  3127 Nov 29 19:29 download_appstats.py\n-rwxr-xr-x  1 myuser mygroup  3127 Nov 29 19:29 endpointscfg.py\n-rwxr-xr-x  1 myuser mygroup  1527 Nov 29 19:29 goapp\n-rwxr-xr-x  1 myuser mygroup  1527 Nov 29 19:29 godoc\n-rwxr-xr-x  1 myuser mygroup  1527 Nov 29 19:29 gofmt\ndrwxr-xr-x  6 myuser mygroup  4096 Nov 29 19:29 google\ndrwxr-xr-x  2 myuser mygroup  4096 Nov 29 19:29 gopath\ndrwxr-xr-x  6 myuser mygroup  4096 Nov 29 19:29 goroot\ndrwxr-xr-x 47 myuser mygroup  4096 Nov 29 19:29 lib\n-rw-r--r--  1 myuser mygroup  5949 Nov 29 19:29 LICENSE\n-rwxr-xr-x  1 myuser mygroup  2344 Nov 29 19:29 php_cli.py\n-rwxr-xr-x  1 myuser mygroup  2344 Nov 29 19:29 _python_runtime.py\n-rw-r--r--  1 myuser mygroup 17738 Nov 29 19:29 RELEASE_NOTES\n-rw-r--r--  1 myuser mygroup   138 Nov 29 19:29 RELEASE_NOTES.python\n-rwxr-xr-x  1 myuser mygroup  2115 Nov 29 19:29 run_tests.py\ndrwxr-xr-x  2 myuser mygroup  4096 Nov 29 19:29 tools\n-rw-r--r--  1 myuser mygroup   221 Nov 29 19:29 VERSION\n-rwxr-xr-x  1 myuser mygroup 11323 Nov 29 19:29 wrapper_util.py\n</code></pre>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487174890, "creation_date": 1487172834, "last_edit_date": 1487174855, "question_id": 42253616, "link": "https://stackoverflow.com/questions/42253616/where-is-the-goapp-binary", "title": "Where is the goapp binary?", "body": "<p>I'm very confused on the set up of Golang.</p>\n\n<p>I downloaded <code>go_appengine_sdk_darwin_amd64-1.9.48.zip</code>.</p>\n\n<p>When I unpacked the zip file, I could not find the <code>goapp</code> binary.</p>\n\n<p>It looks like goapp is a binary used to run a local GAE server but I'm a newb to golang and just following the tutorial:  <a href=\"https://cloud.google.com/appengine/docs/go/getting-started/creating-guestbook#building_and_running_locally\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/go/getting-started/creating-guestbook#building_and_running_locally</a></p>\n\n<pre><code>$ ls go/bin/    \n\ntotal 54560  \n-rwxr-xr-x@ 1 bryan  staff   9884220 Feb 15 10:27 go  \n-rwxr-xr-x@ 1 bryan  staff  15065500 Feb 15 10:27 godoc  \n-rwxr-xr-x@ 1 bryan  staff   2976976 Feb 15 10:27 gofmt  \n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 975478, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/057a2e4b28f0ee27db450f0dece3fa6a?s=128&d=identicon&r=PG", "display_name": "xXPhenom22Xx", "link": "https://stackoverflow.com/users/975478/xxphenom22xx"}, "edited": false, "score": 0, "creation_date": 1487172677, "post_id": 42253516, "comment_id": 71664779, "body": "I tried this at one point as well, I made your change and am getting back an empty result set. I will put the JSON return above in my question."}, {"owner": {"reputation": 1245, "user_id": 975478, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/057a2e4b28f0ee27db450f0dece3fa6a?s=128&d=identicon&r=PG", "display_name": "xXPhenom22Xx", "link": "https://stackoverflow.com/users/975478/xxphenom22xx"}, "edited": false, "score": 0, "creation_date": 1487172860, "post_id": 42253516, "comment_id": 71664923, "body": "One interesting thing I just noticed in the returned JSON, the ID being returned is correct, the result of the fields aren&#39;t coming back though???"}, {"owner": {"reputation": 1245, "user_id": 975478, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/057a2e4b28f0ee27db450f0dece3fa6a?s=128&d=identicon&r=PG", "display_name": "xXPhenom22Xx", "link": "https://stackoverflow.com/users/975478/xxphenom22xx"}, "edited": false, "score": 0, "creation_date": 1487172990, "post_id": 42253516, "comment_id": 71665024, "body": "The TestResult struct is in the above code near the top."}, {"owner": {"reputation": 1245, "user_id": 975478, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/057a2e4b28f0ee27db450f0dece3fa6a?s=128&d=identicon&r=PG", "display_name": "xXPhenom22Xx", "link": "https://stackoverflow.com/users/975478/xxphenom22xx"}, "edited": false, "score": 0, "creation_date": 1487173297, "post_id": 42253516, "comment_id": 71665264, "body": "Ok I think I am getting close, If I comment out all my date fields that data is returning for all the other fields. So I assume I am not representing Date/DateTime/Timestamp fields correctly in Golang by using time.Time?"}, {"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "reply_to_user": {"reputation": 1245, "user_id": 975478, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/057a2e4b28f0ee27db450f0dece3fa6a?s=128&d=identicon&r=PG", "display_name": "xXPhenom22Xx", "link": "https://stackoverflow.com/users/975478/xxphenom22xx"}, "edited": false, "score": 0, "creation_date": 1487173490, "post_id": 42253516, "comment_id": 71665417, "body": "What type of fields your db table have?"}, {"owner": {"reputation": 1245, "user_id": 975478, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/057a2e4b28f0ee27db450f0dece3fa6a?s=128&d=identicon&r=PG", "display_name": "xXPhenom22Xx", "link": "https://stackoverflow.com/users/975478/xxphenom22xx"}, "edited": false, "score": 0, "creation_date": 1487173615, "post_id": 42253516, "comment_id": 71665512, "body": "Included the schema above in my question"}], "tags": [], "owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "is_accepted": false, "score": 0, "last_activity_date": 1487172725, "last_edit_date": 1487172725, "creation_date": 1487172538, "answer_id": 42253516, "question_id": 42253366, "link": "https://stackoverflow.com/questions/42253366/golang-api-mysql-connects-but-queries-empty/42253516#42253516", "title": "Golang API - MySQL connects but queries empty", "body": "<p>You need to initialize the result variable, try:</p>\n\n<pre><code> db.Table(\"test_result\").Where(\"serial = ?\", \"124111-0027\").Scan(&amp;result)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1245, "user_id": 975478, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/057a2e4b28f0ee27db450f0dece3fa6a?s=128&d=identicon&r=PG", "display_name": "xXPhenom22Xx", "link": "https://stackoverflow.com/users/975478/xxphenom22xx"}, "is_accepted": false, "score": 0, "last_activity_date": 1487174895, "creation_date": 1487174895, "answer_id": 42254441, "question_id": 42253366, "link": "https://stackoverflow.com/questions/42253366/golang-api-mysql-connects-but-queries-empty/42254441#42254441", "title": "Golang API - MySQL connects but queries empty", "body": "<p>Ok the issue was with the MySQL Date/DateTime fields, I was not passing in </p>\n\n<p><code>?charset=utf8&amp;parseTime=True</code> </p>\n\n<pre><code>db, err := gorm.Open(\"mysql\", \"api:password@tcp(10.1.1.1:3306)/opt_db1?charset=utf8&amp;parseTime=True\")\n</code></pre>\n\n<p>to the database connection string.</p>\n\n<p><a href=\"https://github.com/jinzhu/gorm/issues/56\" rel=\"nofollow noreferrer\">https://github.com/jinzhu/gorm/issues/56</a></p>\n"}], "owner": {"reputation": 1245, "user_id": 975478, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/057a2e4b28f0ee27db450f0dece3fa6a?s=128&d=identicon&r=PG", "display_name": "xXPhenom22Xx", "link": "https://stackoverflow.com/users/975478/xxphenom22xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1286, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487174895, "creation_date": 1487172103, "last_edit_date": 1487173591, "question_id": 42253366, "link": "https://stackoverflow.com/questions/42253366/golang-api-mysql-connects-but-queries-empty", "title": "Golang API - MySQL connects but queries empty", "body": "<p>Let me preface this by saying I am new to Golang and working on refactoring an existing Python based API using Golang, so the database and underlying schema already exists and is populated with data.</p>\n\n<p>I have a very basic API setup using Gin and Gorm. During the GET API call it is able to connect to the MySQL 5.7 backend but none of my queries will return anything. I've tried various queries with known serial numbers that are in the database and are being returned when I query outside of this app.</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"github.com/jinzhu/gorm\"\n    \"time\"\n    \"log\"\n    \"fmt\"\n)\n\nvar db *gorm.DB\n\nfunc InitDB() *gorm.DB{\n    var err error\n    db, err := gorm.Open(\"mysql\", \"api:MyPassword@tcp(10.37.1.1:3306)/opt_db1\")\n    db.SingularTable(true)\n\n    err = db.DB().Ping()\n\n    if err != nil {\n        log.Panic(err)\n        fmt.Print(err.Error())\n    } else {\n        fmt.Printf(\"Successfully connected to MySQL\")\n    }\n\n    return db\n}\n\ntype TestResult struct {\n    ID                    int  `db:\"id\" json:\"id\"`\n    DateAdded             time.Time `db:\"date_added\" json:\"date_added\"`\n    Serial                string  `db:\"serial\" json:\"serial\"`\n    SequenceId            int `db:\"sequence_id\" json:\"sequence_id\"`\n    LastCompletedStage    int `db:\"last_completed_stage\" json:\"last_completed_stage\"`\n    LastCompletedSequence int `db:\"last_completed_sequence\" json:\"last_completed_sequence\"`\n    Workorder             string  `db:\"workorder\" json:\"workorder\"`\n    Product               string `db:\"product\" json:\"product\"`\n    IsComplete            string `db:\"is_complete\" json:\"is_complete\"`\n    IsScrapped            string `db:\"is_scrapped\" json:\"is_scrapped\"`\n    ValueStream           string `db:\"value_stream\" json:\"value_stream\"`\n    PromiseDate           string `db:\"promise_date\" json:\"promise_date\"`\n    FailLock              int `db:\"fail_lock\" json:\"fail_lock\"`\n    SequenceRev           int `db:\"sequence_rev\" json:\"sequence_rev\"`\n    DateUpdated           time.Time `db:\"date_updated\" json:\"date_updated\"`\n    Date                  time.Time `db:\"date\" json:\"date\"`\n    Time                  time.Time `db:\"time\" json:\"time\"`\n    Ptyp2                 string `db:\"ptyp2\" json:\"ptyp2\"`\n    WoQty                 int `db:\"wo_qty\" json:\"wo_qty\"`\n    IsActive              int `db:\"is_active\" json:\"is_active\"`\n    IsTimeLock            int `db:\"is_time_lock\" json:\"is_time_lock\"`\n    TimeLockTimestamp     time.Time `db:\"time_lock_timestamp\" json:\"time_lock_timestamp\"`\n    ScrapReason           string `db:\"scrap_reason\" json:\"scrap_reason\"`\n    ScrappedBy            int `db:\"scrapped_by\" json:\"scrapped_by\"`\n}\n\nfunc main() {\n    router := gin.Default()\n\n    opt := router.Group(\"opt/v2\")\n    {\n        opt.GET(\"/last-completed-test/:serial\", LastTest)\n    }\n\n    // Add API handlers here\n    router.Run(\":3000\")\n}\n\nfunc LastTest(c *gin.Context) {\n    // Connection to the database\n    db := InitDB()\n    defer db.Close()\n\n    var result TestResult\n\n    // get param and query\n    //serial := c.Params.ByName(\"serial\")\n\n    db.Table(\"test_result\").Where(\"serial = ?\", \"124111-0027\").Scan(&amp;result)\n\n    if result.ID != 0 {\n         //Display JSON result\n        c.JSON(200, result)\n    } else {\n        // Display JSON error\n        c.JSON(404, gin.H{\"error\": \"Record not found\", \"code\": 404})\n    }\n}\n</code></pre>\n\n<p><strong>Console Output:</strong></p>\n\n<pre><code>[GIN-debug] Listening and serving HTTP on :3000 Successfully connected to MySQL[GIN] 2017/02/15 - 09:05:13 |[97;43m 404 [0m|      4.5005ms | 127.0.0.1 |[97;4 4m  [0m GET     /opt/v2/last-completed-test/124111-0027\n</code></pre>\n\n<p><strong>Web Output:</strong></p>\n\n<pre><code>{\"id\":2252920,\"date_added\":\"0001-01-01T00:00:00Z\",\"serial\":\"\",\"sequence_id\":0,\"last_completed_stage\":0,\"last_completed_sequence\":0,\"workorder\":\"\",\"product\":\"\",\"is_complete\":\"\",\"is_scrapped\":\"\",\"value_stream\":\"\",\"promise_date\":\"\",\"fail_lock\":0,\"sequence_rev\":0,\"date_updated\":\"0001-01-01T00:00:00Z\",\"date\":\"0001-01-01T00:00:00Z\",\"time\":\"0001-01-01T00:00:00Z\",\"ptyp2\":\"\",\"wo_qty\":0,\"is_active\":0,\"is_time_lock\":0,\"time_lock_timestamp\":\"0001-01-01T00:00:00Z\",\"scrap_reason\":\"\",\"scrapped_by\":0}\n</code></pre>\n\n<p><strong>Schema from Workbench:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ntwLI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ntwLI.jpg\" alt=\"![enter image description here\"></a></p>\n\n<p>In the above code I have even hard-coded a serial number I know has data to no avail.</p>\n\n<p>Is there something obvious I am missing in trying to query my DB?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "swagger", "go-swagger"], "answers": [{"tags": [], "owner": {"reputation": 1159, "user_id": 23418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39a948a58f4569c53d971c2e120920?s=128&d=identicon&r=PG", "display_name": "Casual Jim", "link": "https://stackoverflow.com/users/23418/casual-jim"}, "is_accepted": false, "score": 0, "last_activity_date": 1490847952, "creation_date": 1490847952, "answer_id": 43108562, "question_id": 42250915, "link": "https://stackoverflow.com/questions/42250915/goswagger-not-creating-appropriate-json-spec-file/43108562#43108562", "title": "Goswagger not creating appropriate json spec file", "body": "<p>The code you want to document needs to be reachable from your main package. That means from the main package its usage needs to be detectable.\nSo if you have a working server that isn't hooked up through some means of reflection it will generate the right specification.</p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490847952, "creation_date": 1487165787, "question_id": 42250915, "link": "https://stackoverflow.com/questions/42250915/goswagger-not-creating-appropriate-json-spec-file", "title": "Goswagger not creating appropriate json spec file", "body": "<p>I am trying to create a spec file for the <a href=\"https://github.com/go-swagger/go-swagger/tree/master/fixtures/goparsing/petstore\" rel=\"nofollow noreferrer\">go implementation of petstore example</a> . I tried a <code>go generate</code> in the directory which had <code>doc.go</code> but it did nothing. On further reading, I realised that there should be </p>\n\n<p><code>//go:generate swagger generate spec -o swagger.json</code></p>\n\n<p>in <code>doc.go</code> . When I added that it creates a spec file but it doesn't contain the entire specification. This is the .json file that is create on <code>go generate</code> </p>\n\n<pre><code>{\n  \"consumes\": [\n    \"application/json\"\n  ],\n  \"produces\": [\n    \"application/json\"\n  ],\n  \"schemes\": [\n    \"http\",\n    \"https\"\n  ],\n  \"swagger\": \"2.0\",\n  \"info\": {\n    \"description\": \"the purpose of this application is to provide an application\\nthat is using plain go code to define an API\\n\\nThis should demonstrate all the possible comment annotations\\nthat are available to turn go code into a fully compliant swagger 2.0 spec\",\n    \"title\": \"Petstore API.\",\n    \"termsOfService\": \"there are no TOS at this moment, use at your own risk we take no responsibility\\ngo:generate swagger generate spec -o swagger.json\",\n    \"contact\": {\n      \"name\": \"John Doe\",\n      \"url\": \"http://john.doe.com\",\n      \"email\": \"john.doe@example.com\"\n    },\n    \"license\": {\n      \"name\": \"MIT\",\n      \"url\": \"http://opensource.org/licenses/MIT\"\n    },\n    \"version\": \"0.0.1\"\n  },\n  \"host\": \"localhost\",\n  \"basePath\": \"/v2\",\n  \"paths\": {}\n}\n</code></pre>\n\n<p>There are no routes/parameters/models mentioned in the spec file. Is this how this is supposed to be? This is an official example from the goswagger repo so I doubt the code is wrong. What should I change to make it work?</p>\n"}, {"tags": ["firebase", "go", "firebase-realtime-database"], "comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 1, "creation_date": 1487177156, "post_id": 42249482, "comment_id": 71668292, "body": "Are you checking the error returned from <code>db.Child...Value(&amp;job)</code>?"}, {"owner": {"reputation": 133, "user_id": 7255142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/svdMc.jpg?s=128&g=1", "display_name": "Sarath Sankara Kurup", "link": "https://stackoverflow.com/users/7255142/sarath-sankara-kurup"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1487219264, "post_id": 42249482, "comment_id": 71686772, "body": "@jcbwlkr I have updated the code with error checking. Error is not printing because it returns &quot;nil&quot;"}], "owner": {"reputation": 133, "user_id": 7255142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/svdMc.jpg?s=128&g=1", "display_name": "Sarath Sankara Kurup", "link": "https://stackoverflow.com/users/7255142/sarath-sankara-kurup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487219790, "creation_date": 1487161806, "last_edit_date": 1487219790, "question_id": 42249482, "link": "https://stackoverflow.com/questions/42249482/cant-search-for-numbers-in-firebase-using-golang", "title": "Can&#39;t search for numbers in Firebase using Golang?", "body": "<p>I have the following Firebase Structure and I use Firego to connect with Golang. </p>\n\n<pre><code>\"Job\":{\n  \"-Kd0G5mRrRCXlGJmIuD0\" : {\n    \"CurrentDate\" : 1487153684854,\n    \"CustomerId\" : \"-Kcgz7IpH0fbs4EXaELr\",\n    \"CustomerName\" : \"David\",\n    \"JobName\" : \"Maintanence\",\n    \"JobNumber\" : \"101\",\n    \"NumberOfTask\" : \"1\",\n    \"Status\" : \"Active\"\n  },\n  \"-Kd0UwmSHRhHdPX8z2hl\" : {\n    \"CurrentDate\" : 1487157576818,\n    \"CustomerId\" : \"-Kcg6uppyD8yKznNXZd7\",\n    \"CustomerName\" : \"John\",\n    \"JobName\" : \"Cleaning\",\n    \"JobNumber\" : \"101\",\n    \"NumberOfTask\" : \"4\",\n    \"Status\" : \"Active\"\n  }\n}\n</code></pre>\n\n<p>My Job Struct:</p>\n\n<pre><code>type Job   struct {\n    CustomerId      string\n    CustomerName    string\n    JobName         string\n    JobNumber       string\n    NumberOfTask    string\n    Status          string\n    CurrentDate     int64\n}\n</code></pre>\n\n<p>I used the folowing code to search Jobname = \"Maintanence\"</p>\n\n<pre><code>err = dB.Child(\"Job\").OrderBy(\"JobName\").EqualTo(\"Maintanence\").Value(&amp;job)\nif err!=nil{\n    log.Println(\"Error:\",err)\n}\nif len(job)==0{\n   log.Println(\"map null:\",job)\n}else{\n   log.Println(\"map not null:\",job)\n}\n</code></pre>\n\n<p>and it print: </p>\n\n<pre><code>map not null: -Kd0G5mRrRCXlGJmIuD0\" : {\n            \"CurrentDate\" : 1487153684854,\n            \"CustomerId\" : \"-Kcgz7IpH0fbs4EXaELr\",\n            \"CustomerName\" : \"David\",\n            \"JobName\" : \"Maintanence\",\n            \"JobNumber\" : \"101\",\n            \"NumberOfTask\" : \"1\",\n            \"Status\" : \"Active\"\n          }\n</code></pre>\n\n<p>But when I trird to search for the Jobnumber = \"101\" using following code</p>\n\n<pre><code>err = dB.Child(\"Job\").OrderBy(\"JobNumber\").EqualTo(\"101\").Value(&amp;job)\nif err!=nil{\n   log.Println(\"Error:\",err)\n}\nif len(job)==0{\n   log.Println(\"map null:\",job)\n}else{\n   log.Println(\"map not null:\",job)\n}\n</code></pre>\n\n<p>it print: </p>\n\n<pre><code>map null:{}\n</code></pre>\n\n<p>Why I can't search and print the JobNumber = \"101\" , when I was able to search and print JobName = \"Maintanence\" ?</p>\n"}, {"tags": ["go", "put"], "comments": [{"owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 2, "creation_date": 1487158377, "post_id": 42248159, "comment_id": 71654556, "body": "Where is your go code ?"}, {"owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "reply_to_user": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 0, "creation_date": 1487158831, "post_id": 42248159, "comment_id": 71654837, "body": "<a href=\"https://play.golang.org/p/tOFxziLgGo\" rel=\"nofollow noreferrer\">play.golang.org/p/tOFxziLgGo</a> example here, thanks for reply"}, {"owner": {"reputation": 1, "user_id": 9348036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GkHu-Ueq80I/AAAAAAAAAAI/AAAAAAAAACQ/EZc1SByJ8OM/photo.jpg?sz=128", "display_name": "luojie", "link": "https://stackoverflow.com/users/9348036/luojie"}, "edited": false, "score": 0, "creation_date": 1586315622, "post_id": 42248159, "comment_id": 108081186, "body": "You can find the answer from [If a DELETE request includes an entity body, the body is ignored [...]](<a href=\"https://stackoverflow.com/questions/299628/is-an-entity-body-allowed-for-an-http-delete-request\" title=\"is an entity body allowed for an http delete request\">stackoverflow.com/questions/299628/&hellip;</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "edited": false, "score": 0, "creation_date": 1487209379, "post_id": 42254783, "comment_id": 71684022, "body": "test := c.Request.ParseForm()  not work for me, i return nil"}, {"owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "reply_to_user": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "edited": false, "score": 0, "creation_date": 1487233005, "post_id": 42254783, "comment_id": 71692994, "body": "Try accessing the postform params after calling the ParseForm function. I don&#39;t use gin myself but that is how the http package works iirc"}], "tags": [], "owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "is_accepted": false, "score": 0, "last_activity_date": 1487175840, "creation_date": 1487175840, "answer_id": 42254783, "question_id": 42248159, "link": "https://stackoverflow.com/questions/42248159/how-to-retrieve-data-from-put-delete-method-golang-gin-gonic/42254783#42254783", "title": "How to retrieve data from PUT,DELETE method golang (gin gonic)", "body": "<p>It looks like you need to call the ParseForm method first - <a href=\"https://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Request.ParseForm</a></p>\n"}], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2147, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487216601, "creation_date": 1487158279, "last_edit_date": 1487216601, "question_id": 42248159, "link": "https://stackoverflow.com/questions/42248159/how-to-retrieve-data-from-put-delete-method-golang-gin-gonic", "title": "How to retrieve data from PUT,DELETE method golang (gin gonic)", "body": "<pre><code>   $.ajax({\n        type: \"PUT\",(or \"DELETE\")\n        url: \"example.com/controller\",\n        data: {\n            ID: 10,\n        },\n        cache: false,\n        success: function(data) {}\n\n    });\n</code></pre>\n\n<p>here my ajax, and in my controller i want to get ID, but c.PostForm(\"ID\") not work for delete(work for PUT), help me please!</p>\n\n<p>Finally, i have to pass params to URI.(delete method)</p>\n"}, {"tags": ["rest", "go", "go-gin"], "comments": [{"owner": {"reputation": 121, "user_id": 4564808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e502b95edbba664a15e55326c4a5b16?s=128&d=identicon&r=PG&f=1", "display_name": "Salami", "link": "https://stackoverflow.com/users/4564808/salami"}, "edited": false, "score": 0, "creation_date": 1492000692, "post_id": 42247978, "comment_id": 73801195, "body": "I ended up creating a struct and parsing my json to the struct. As far as I know I can&#39;t simply get any JSON."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4564808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e502b95edbba664a15e55326c4a5b16?s=128&d=identicon&r=PG&f=1", "display_name": "Salami", "link": "https://stackoverflow.com/users/4564808/salami"}, "edited": false, "score": 1, "creation_date": 1487159216, "post_id": 42248237, "comment_id": 71655102, "body": "This implies that my JSON has a user and a password fileds, it can&#39;t be any JSON. E.g. if I want a JSON like {&quot;time&quot;:23,&quot;space&quot;:&quot;xyz&quot;} this code woudn&#39;t work. I would like to receive and send raw text. Is this possible in Gin Gonic?"}, {"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1499912632, "post_id": 42248237, "comment_id": 77113812, "body": "Why does the elements of the struct always need to begin with caps??"}, {"owner": {"reputation": 353, "user_id": 2461002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5aYy9.jpg?s=128&g=1", "display_name": "Daniel Shterenberg", "link": "https://stackoverflow.com/users/2461002/daniel-shterenberg"}, "reply_to_user": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1563604367, "post_id": 42248237, "comment_id": 100762402, "body": "@NidhinDavid because you want them to be public and you want to decode them. If they are private, the JSON decoder won&#39;t be able to do this (they are not accessible to it)"}], "tags": [], "owner": {"reputation": 301, "user_id": 2008328, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/840a8db2994331cde292c3afc4e66702?s=128&d=identicon&r=PG", "display_name": "mstafkmx", "link": "https://stackoverflow.com/users/2008328/mstafkmx"}, "is_accepted": false, "score": 9, "last_activity_date": 1601921271, "last_edit_date": 1601921271, "creation_date": 1487158520, "answer_id": 42248237, "question_id": 42247978, "link": "https://stackoverflow.com/questions/42247978/go-gin-gonic-get-text-from-post-request/42248237#42248237", "title": "Go Gin-Gonic, get text from POST request", "body": "<p>Try this example:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n\n    &quot;github.com/gin-gonic/gin&quot;\n    &quot;net/http&quot;\n)\n\ntype LOGIN struct{\n    USER string `json:&quot;user&quot; binding:&quot;required&quot;`\n    PASSWORD string `json:&quot;password&quot; binding:&quot;required&quot;`\n}\n\nfunc main() {\n    r := gin.Default()\n    r.GET(&quot;/status&quot;, func(c *gin.Context) {\n        c.String(200, &quot;on&quot;)\n    })\n\n    r.GET(&quot;/user/:name&quot;, func(c *gin.Context) {\n        name := c.Param(&quot;name&quot;)\n        c.String(http.StatusOK, &quot;Hello %s&quot;, name)\n    })\n\n    r.GET(&quot;/user/:name/:action&quot;, func(c *gin.Context) {\n        name := c.Param(&quot;name&quot;)\n        action := c.Param(&quot;action&quot;)\n        message := name + &quot; is &quot; + action\n        c.String(http.StatusOK, message)\n    })\n\n    r.POST(&quot;/foo&quot;, func(c *gin.Context) {\n        var login LOGIN\n        c.BindJSON(&amp;login)\n        c.JSON(200, gin.H{&quot;status&quot;: login.USER}) // Your custom response here\n    })\n    r.Run(&quot;:8080&quot;) // listen for incoming connections\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 4564808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e502b95edbba664a15e55326c4a5b16?s=128&d=identicon&r=PG&f=1", "display_name": "Salami", "link": "https://stackoverflow.com/users/4564808/salami"}, "is_accepted": false, "score": 0, "last_activity_date": 1487866874, "creation_date": 1487866874, "answer_id": 42421072, "question_id": 42247978, "link": "https://stackoverflow.com/questions/42247978/go-gin-gonic-get-text-from-post-request/42421072#42421072", "title": "Go Gin-Gonic, get text from POST request", "body": "<p>I ended up creating a struct to parse my JSON, then I make some required calculations and finally I resend the data parsing my JSON to string using json.Marshal. I think it makes sense to parse the JSON, it is a way to check whether the info received is correct. </p>\n"}], "owner": {"reputation": 121, "user_id": 4564808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e502b95edbba664a15e55326c4a5b16?s=128&d=identicon&r=PG&f=1", "display_name": "Salami", "link": "https://stackoverflow.com/users/4564808/salami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16354, "favorite_count": 1, "answer_count": 2, "score": 7, "last_activity_date": 1601921271, "creation_date": 1487157844, "last_edit_date": 1487159415, "question_id": 42247978, "link": "https://stackoverflow.com/questions/42247978/go-gin-gonic-get-text-from-post-request", "title": "Go Gin-Gonic, get text from POST request", "body": "<p>I'm starting to develop a <strong>REST</strong> API using <strong>Go</strong> and package <strong>Gin-Gonic</strong>. The idea is to create a REST API that receives POST requests in a JSON format and redirects this call to another application (also a API). Here is a peace of code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/gin-gonic/gin\"\n    \"net/http\"\n)\nfunc main() {\n    r := gin.Default()\n    r.GET(\"/status\", func(c *gin.Context) {\n        c.String(200, \"on\")\n    })\n\n    r.GET(\"/user/:name\", func(c *gin.Context) {\n        name := c.Param(\"name\")\n        c.String(http.StatusOK, \"Hello %s\", name)\n    })\n\n    r.GET(\"/user/:name/:action\", func(c *gin.Context) {\n        name := c.Param(\"name\")\n        action := c.Param(\"action\")\n        message := name + \" is \" + action\n        c.String(http.StatusOK, message)\n    })\n\n    r.POST(\"/foo\", func(c *gin.Context) {\n        fmt.Printf(\"%s\", \"At least I got here\")\n        message := c.PostForm() //???\n        c.JSON(200, gin.H{\"status\": message}) //???\n    })\n    r.Run(\":8080\") // listen an\n}\n</code></pre>\n\n<p>At function <code>r.Posts(\"/foo\",...)</code> I would like <code>c.JSON</code> to send me back the full JSON that I sent:</p>\n\n<pre><code>curl -H \"Content-Type: application/json\" -X POST -d '{\"user\":\"xyz\",\"password\":\"xyz\"}' http://localhost:8080/foo\n</code></pre>\n\n<p>I've seen examples where they bind the JSON file by creating a struct with the same structure as the input JSON (check Gin-Gonic examples at <a href=\"https://github.com/gin-gonic/gin\" rel=\"noreferrer\">https://github.com/gin-gonic/gin</a> ). However I only need to resend the full string without taking care of the format. Any ideas?</p>\n"}, {"tags": ["file", "go", "io"], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 2969272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95bc136055ef3028847d419f129f409d?s=128&d=identicon&r=PG", "display_name": "antham", "link": "https://stackoverflow.com/users/2969272/antham"}, "edited": false, "score": 0, "creation_date": 1556975952, "post_id": 42245306, "comment_id": 98615104, "body": "I don&#39;t understand because the signature of <code>Seek</code> is <code>Seek(offset int64, whence int)</code> and constant are related to whence value so it must be <code>File.Seek(0, io.SeekStart)</code> not the opposite."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 19, "last_activity_date": 1556980686, "last_edit_date": 1556980686, "creation_date": 1487150716, "answer_id": 42245306, "question_id": 42245227, "link": "https://stackoverflow.com/questions/42245227/golang-a-proper-way-to-rewind-file-pointer/42245306#42245306", "title": "Golang, a proper way to rewind file pointer", "body": "<p>Seeking to the beginning of the file is easiest done using <a href=\"https://golang.org/pkg/os/#File.Seek\" rel=\"noreferrer\"><code>File.Seek(0, 0)</code></a> (or more safely using a constant: <code>File.Seek(0, io.SeekStart)</code>) just as you suggested, but don't forget that:</p>\n\n<blockquote>\n  <p>The behavior of Seek on a file opened with O_APPEND is not specified.</p>\n</blockquote>\n\n<p>(This does not apply to your example though.)</p>\n\n<p>Setting the pointer to the beginning of the file is always much faster than closing and reopening the file. If you need to read different, \"small\" parts of the file <em>many</em> times, alternating, then <em>maybe</em> it might be profitable to open the file twice to avoid repeated seeking (worry about this only if you have peformance problems).</p>\n\n<p>And again, <a href=\"https://golang.org/pkg/os/#File\" rel=\"noreferrer\"><code>*os.File</code></a> implements <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"noreferrer\"><code>io.Reader</code></a>, so you can use it as an <code>io.Reader</code>. I don't know what <code>ioutil.NewReader(data)</code> is you mentioned in your question (package <a href=\"https://golang.org/pkg/io/ioutil/\" rel=\"noreferrer\"><code>io/ioutil</code></a> has no such function; maybe you meant <a href=\"https://golang.org/pkg/bufio/#NewReader\" rel=\"noreferrer\"><code>bufio.NewReader()</code></a>?), but certainly it is not needed to read from a file.</p>\n"}], "owner": {"reputation": 919, "user_id": 1567827, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/87a58b82af58822a71c75479cace6649?s=128&d=identicon&r=PG", "display_name": "Shadowfax", "link": "https://stackoverflow.com/users/1567827/shadowfax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12827, "favorite_count": 2, "accepted_answer_id": 42245306, "answer_count": 1, "score": 16, "last_activity_date": 1556980686, "creation_date": 1487150513, "question_id": 42245227, "link": "https://stackoverflow.com/questions/42245227/golang-a-proper-way-to-rewind-file-pointer", "title": "Golang, a proper way to rewind file pointer", "body": "<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"encoding/csv\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    data, err := os.Open(\"cc.csv\")\n    defer data.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    s := bufio.NewScanner(data)\n    for s.Scan() {\n        fmt.Println(s.Text())\n        if err := s.Err(); err != nil {\n            panic(err)\n        }\n    }\n    // Is it a proper way?\n    data.Seek(0, 0)\n    r := csv.NewReader(data)\n\n    for {\n        if record, err := r.Read(); err == io.EOF {\n\n            break\n        } else if err != nil {\n            log.Fatal(err)\n        } else {\n            fmt.Println(record)\n        }\n\n    }\n}\n</code></pre>\n\n<p>I use two readers here to read from a csv file.\nTo rewind a file I use  <code>data.Seek(0, 0)</code> is it a good way? Or it's better to close the file and open again before second reading.</p>\n\n<p>Is it also correct to use <code>*File</code> as an <code>io.Reader</code> ? Or it's better to do <code>r := ioutil.NewReader(data)</code> </p>\n"}, {"tags": ["testing", "go", "build", "flags"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1487147673, "creation_date": 1487147673, "answer_id": 42244265, "question_id": 42243919, "link": "https://stackoverflow.com/questions/42243919/using-go-build-but-i-also-see-the-test-flags/42244265#42244265", "title": "Using go build but I also see the -test flags", "body": "<p>Most likely you're using the default flag set (<a href=\"https://golang.org/pkg/flag/#FlagSet\" rel=\"noreferrer\"><code>flag.FlagSet</code></a>) of the <a href=\"https://golang.org/pkg/flag/\" rel=\"noreferrer\"><code>flag</code></a> package. And note that you may not be the only one using it. If you import other packages, they might also register flags, which will be processed just like your own flags (flags you registered).</p>\n\n<p>See this simple example:</p>\n\n<pre><code>import (\n    \"flag\"\n    _ \"testing\"\n)\n\nfunc main() {\n    flag.Int(\"port\", 80, \"port to use\")\n    flag.Parse()\n}\n</code></pre>\n\n<p>This app registers a <code>port</code> flag, and nothing else. But it also imports the <a href=\"https://golang.org/pkg/testing/\" rel=\"noreferrer\"><code>testing</code></a> package which registers a lot of flags.</p>\n\n<p>Running it with the <code>-h</code> command line argument, the output is:</p>\n\n<pre><code>  -port int\n        port to use (default 80)\n  -test.bench string\n        regular expression per path component to select benchmarks to run\n  -test.benchmem\n        print memory allocations for benchmarks\n  -test.benchtime duration\n        approximate run time for each benchmark (default 1s)\n  -test.blockprofile string\n        write a goroutine blocking profile to the named file after execution\n  -test.blockprofilerate int\n        if &gt;= 0, calls runtime.SetBlockProfileRate() (default 1)\n  -test.count n\n        run tests and benchmarks n times (default 1)\n  -test.coverprofile string\n        write a coverage profile to the named file after execution\n  -test.cpu string\n        comma-separated list of number of CPUs to use for each test\n  -test.cpuprofile string\n        write a cpu profile to the named file during execution\n  -test.memprofile string\n        write a memory profile to the named file after execution\n  -test.memprofilerate int\n        if &gt;=0, sets runtime.MemProfileRate\n  -test.outputdir string\n        directory in which to write profiles\n  -test.parallel int\n        maximum test parallelism (default 4)\n  -test.run string\n        regular expression to select tests and examples to run\n  -test.short\n        run smaller test suite to save time\n  -test.timeout duration\n        if positive, sets an aggregate time limit for all tests\n  -test.trace string\n        write an execution trace to the named file after execution\n  -test.v\n        verbose: print additional output\nexit status 2\n</code></pre>\n\n<p>If you don't want your flags to be mixed with flags of other packages, create and use your own <code>flag.FlagSet</code> by calling <a href=\"https://golang.org/pkg/flag/#NewFlagSet\" rel=\"noreferrer\"><code>flag.NewFlagSet()</code></a>, but then of course you have to use its methods instead of the top-level functions of the <code>flag</code> package.</p>\n"}], "owner": {"reputation": 9005, "user_id": 337504, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f365e5b3587387ed67c9c747288874e2?s=128&d=identicon&r=PG", "display_name": "Mustafa", "link": "https://stackoverflow.com/users/337504/mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "accepted_answer_id": 42244265, "answer_count": 1, "score": 4, "last_activity_date": 1487147673, "creation_date": 1487146586, "question_id": 42243919, "link": "https://stackoverflow.com/questions/42243919/using-go-build-but-i-also-see-the-test-flags", "title": "Using go build but I also see the -test flags", "body": "<p>I have a <code>main.go</code> and <code>mypkg/...go</code>. I use <code>go build -o main main.go</code> or <code>go install &lt;pkg that has main.go&gt;</code> and which has some flags I require. But I also see the test flags. Why is this happening? What am I missing?</p>\n\n<pre><code>Usage of ./main:\n  -docker string\n        Docker API Path, defaults to local (default \"unix:///var/run/docker.sock\")\n  -httptest.serve string\n        if non-empty, httptest.NewServer serves on this address and blocks\n  -port int\n        The default port to listen (default 8000)\n  -test.bench string\n        regular expression per path component to select benchmarks to run\n  -test.benchmem\n        print memory allocations for benchmarks\n  -test.benchtime duration\n        approximate run time for each benchmark (default 1s)\n  -test.blockprofile string\n        write a goroutine blocking profile to the named file after execution\n  -test.blockprofilerate int\n        if &gt;= 0, calls runtime.SetBlockProfileRate() (default 1)\n</code></pre>\n\n<p>dockerPath and port are my flags, but as you can see the others are not my flags.</p>\n"}, {"tags": ["go", "slice", "allocation", "escape-analysis"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1487144303, "post_id": 42243197, "comment_id": 71644961, "body": "This is implementation dependent, different compilers might do it differently, different architectures might do it differently and different releases may handle it differently. So what exactly is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1487148532, "last_edit_date": 1487148532, "creation_date": 1487147146, "answer_id": 42244087, "question_id": 42243197, "link": "https://stackoverflow.com/questions/42243197/what-is-considered-small-object-in-go-regarding-stack-allocation/42244087#42244087", "title": "What is considered &quot;small&quot; object in Go regarding stack allocation?", "body": "<p>Since this is not mentioned in the language spec, it is an implementation detail, and as such, it may vary based on a number of things (Go version, target OS, architecture etc.).</p>\n\n<p>If you want to find out its current value or a place to start digging, check out the <code>cmd/compile/internal/gc</code> package.</p>\n\n<p>The <a href=\"https://en.wikipedia.org/wiki/Escape_analysis\" rel=\"nofollow noreferrer\">escape analysis</a> which decides where to allocate the variable is in <a href=\"https://golang.org/src/cmd/compile/internal/gc/esc.go\" rel=\"nofollow noreferrer\"><code>cmd/compile/internal/gc/esc.go</code></a>. Check of the make slice operation is in unexported function <code>esc()</code>:</p>\n\n<pre><code>func esc(e *EscState, n *Node, up *Node) {\n    // ...\n\n    // Big stuff escapes unconditionally\n    // \"Big\" conditions that were scattered around in walk have been gathered here\n    if n.Esc != EscHeap &amp;&amp; n.Type != nil &amp;&amp;\n        (n.Type.Width &gt; MaxStackVarSize ||\n            (n.Op == ONEW || n.Op == OPTRLIT) &amp;&amp; n.Type.Elem().Width &gt;= 1&lt;&lt;16 ||\n            n.Op == OMAKESLICE &amp;&amp; !isSmallMakeSlice(n)) {\n        if Debug['m'] &gt; 2 {\n            Warnl(n.Lineno, \"%v is too large for stack\", n)\n        }\n        n.Esc = EscHeap\n        addrescapes(n)\n        escassignSinkNilWhy(e, n, n, \"too large for stack\") // TODO category: tooLarge\n    }\n\n    // ...\n}\n</code></pre>\n\n<p>The decision involving the size is in function <code>isSmallMakeSlice()</code>, this is in file <a href=\"https://golang.org/src/cmd/compile/internal/gc/walk.go\" rel=\"nofollow noreferrer\"><code>cmd/compile/internal/gc/walk.go</code></a>:</p>\n\n<pre><code>func isSmallMakeSlice(n *Node) bool {\n    if n.Op != OMAKESLICE {\n        return false\n    }\n    l := n.Left\n    r := n.Right\n    if r == nil {\n        r = l\n    }\n    t := n.Type\n\n    return Smallintconst(l) &amp;&amp; Smallintconst(r) &amp;&amp; (t.Elem().Width == 0 || r.Int64() &lt; (1&lt;&lt;16)/t.Elem().Width)\n}\n</code></pre>\n\n<p>The size limit is this:</p>\n\n<pre><code>r.Int64() &lt; (1&lt;&lt;16)/t.Elem().Width\n</code></pre>\n\n<p><code>r</code> is the length or capacity of the slice (if cap is provided), <code>t.Elem().Width</code> is the byte size of the element type:</p>\n\n<pre><code>NumElem &lt; 65536 / SizeElem\n</code></pre>\n\n<p>In your case:</p>\n\n<pre><code>NumElem &lt; 65536 / 8 = 8192\n</code></pre>\n\n<p>So if the slice type is <code>[]uint64</code>, 8192 is the limit from which it is allocated on the heap (instead of the stack), just as you experienced.</p>\n"}], "owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1487148749, "creation_date": 1487144081, "last_edit_date": 1487148749, "question_id": 42243197, "link": "https://stackoverflow.com/questions/42243197/what-is-considered-small-object-in-go-regarding-stack-allocation", "title": "What is considered &quot;small&quot; object in Go regarding stack allocation?", "body": "<p>The code:</p>\n\n<pre><code>func MaxSmallSize() {\n    a := make([]int64, 8191)\n    b := make([]int64, 8192)\n    _ = a\n    _ = b\n}\n</code></pre>\n\n<p>Then run <code>go build -gcflags='-m' . 2&gt;&amp;1</code> to check memory allocation details. The result:</p>\n\n<pre><code>./mem.go:10: can inline MaxSmallSize\n./mem.go:12: make([]int64, 8192) escapes to heap\n./mem.go:11: MaxSmallSize make([]int64, 8191) does not escape\n</code></pre>\n\n<p><strong>My question is why <code>a</code> is small object and <code>b</code> is large object?</strong></p>\n\n<p><code>make</code> 64KB will escape to heap and less will allocate in stack. Does the <code>_MaxSmallSize = 32 &lt;&lt; 10</code> is the reason?</p>\n\n<p><code>go env</code></p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/vagrant/gopath\"\nGORACE=\"\"\nGOROOT=\"/home/vagrant/go\"\nGOTOOLDIR=\"/home/vagrant/go/pkg/tool/linux_amd64\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build201775001=/tmp/go-build\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n"}, {"tags": ["go", "mocking"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -1, "last_activity_date": 1487144161, "creation_date": 1487144161, "answer_id": 42243222, "question_id": 42242713, "link": "https://stackoverflow.com/questions/42242713/how-to-properly-mock-an-imported-library/42243222#42243222", "title": "How to properly mock an imported library?", "body": "<p>\"Does golang support conditional importing [?]\". Answer: No. Just take a look at the language spec.</p>\n\n<p>\"How do I do it better?\" Answer: Route calls to route53 through your own package which switches between mock and real route53 depending on your environment/build -tags/cmdlineargs/whatever.</p>\n"}, {"tags": [], "owner": {"reputation": 629, "user_id": 1572023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b3103a5ba913c4b6de8d131709a15f?s=128&d=identicon&r=PG", "display_name": "csm", "link": "https://stackoverflow.com/users/1572023/csm"}, "is_accepted": false, "score": 2, "last_activity_date": 1487151133, "last_edit_date": 1487151133, "creation_date": 1487145351, "answer_id": 42243577, "question_id": 42242713, "link": "https://stackoverflow.com/questions/42242713/how-to-properly-mock-an-imported-library/42243577#42243577", "title": "How to properly mock an imported library?", "body": "<p>Go does not support conditional importing\u2013at least not in the current stable version.</p>\n\n<p>An <code>interface</code> with the methods you need to use is a good fit to solve this problem:</p>\n\n<pre><code>type TrafficPolicyLister interface {\n   ListTrafficPolicies(*route53.ListTrafficPoliciesInput) (*route53.ListTrafficPoliciesOutput, error)\n}\n</code></pre>\n\n<p>Now you can use the interface wherever you would previously use <code>route53.Route53</code>. In production you would pass an object of type <code>route53.Route53</code> (which implements that interface) but during development you can pass a mock:</p>\n\n<pre><code>type TrafficPolicyListerMock struct {}\n\nfunc (t *TrafficPolicyListerMock) ListTrafficPolicies(input *route53.ListTrafficPoliciesInput) (*route53.ListTrafficPoliciesOutput, error) {\n    // return whatever you want your mock to return\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "is_accepted": false, "score": 1, "last_activity_date": 1487150886, "last_edit_date": 1495541425, "creation_date": 1487150886, "answer_id": 42245374, "question_id": 42242713, "link": "https://stackoverflow.com/questions/42242713/how-to-properly-mock-an-imported-library/42245374#42245374", "title": "How to properly mock an imported library?", "body": "<p>If you want to do unit testing, read the <a href=\"https://stackoverflow.com/a/42243577/372172\">answer of @csm</a>.</p>\n\n<p>If you want to have a development environment (not unit testing), you should probably look at <a href=\"https://www.minio.io/\" rel=\"nofollow noreferrer\">minio</a>, effectively a self-hosted S3 implementation. You should use environment variable to inject the S3 endpoints. Then you're free to use your own minio server for your development.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1487151133, "creation_date": 1487142397, "question_id": 42242713, "link": "https://stackoverflow.com/questions/42242713/how-to-properly-mock-an-imported-library", "title": "How to properly mock an imported library?", "body": "<p>I have an import:</p>\n\n<pre><code>import {\n    \"github.com/aws/aws-sdk-go/service/route53\"\n}\n</code></pre>\n\n<p>Which I then use to work with host zones in AWS Route 53.\nI see that the code I created works properly now with the current setup.</p>\n\n<p>To simplify development process, I want to create a mock of the library methods I use while developing.</p>\n\n<p>I have a key in config, like this <code>env=\"development\"</code> or <code>env=\"production\"</code>.</p>\n\n<p>My plan is to add my own object that is <code>route53</code> with the needed methods and import it if the env is development.</p>\n\n<p>How do I do it better?\nDoes golang support conditional importing, like this:</p>\n\n<pre><code>if (env==\"development\") {\n    import \"./route53-mock\"\n} else {\n    \"github.com/aws/aws-sdk-go/service/route53\"\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 3, "creation_date": 1487140539, "post_id": 42242122, "comment_id": 71643017, "body": "&quot;Trim returns a slice of the string s with all leading and trailing Unicode code points contained in cutset removed.&quot;"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 2, "creation_date": 1487140581, "post_id": 42242122, "comment_id": 71643037, "body": "Perhaps you want <code>TrimPrefix</code>"}, {"owner": {"reputation": 1519, "user_id": 506016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b2ef6443a54b6be94a1c522b67b661a?s=128&d=identicon&r=PG&f=1", "display_name": "MondayPaper", "link": "https://stackoverflow.com/users/506016/mondaypaper"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1487140907, "post_id": 42242122, "comment_id": 71643189, "body": "Thanks! Clearly I need to get some sleep."}], "answers": [{"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 6, "last_activity_date": 1487140511, "creation_date": 1487140511, "answer_id": 42242224, "question_id": 42242122, "link": "https://stackoverflow.com/questions/42242122/strings-trim-is-removing-the-letter-i-golang/42242224#42242224", "title": "strings.Trim is removing the letter &quot;i&quot; (golang)", "body": "<p>The second parameter to <a href=\"https://golang.org/pkg/strings/#Trim\">strings.Trim()</a> is a 'cutset', ie, a set of runes to remove from the strings, and 'i' is one of them.</p>\n\n<p>To return all but the last element of path, use <a href=\"https://golang.org/pkg/path/#Dir\">path.Dir()</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1893, "user_id": 4900669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pTcS6.jpg?s=128&g=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4900669/ivan"}, "is_accepted": false, "score": 1, "last_activity_date": 1487142938, "creation_date": 1487142938, "answer_id": 42242883, "question_id": 42242122, "link": "https://stackoverflow.com/questions/42242122/strings-trim-is-removing-the-letter-i-golang/42242883#42242883", "title": "strings.Trim is removing the letter &quot;i&quot; (golang)", "body": "<p>Also you can use <code>strings.Replace</code>:</p>\n\n<pre><code>fmt.Println(\"full path:\", path)\nfmt.Println(\"trim set (views):\", strings.Replace(path, \"views\", \"\", -1))\nfmt.Println(\"trim set (views/):\", strings.Replace(path, \"views/\", \"\", -1))\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>full path: views/index.html\ntrim set (views): /index.html\ntrim set (views/): index.html\n</code></pre>\n"}], "owner": {"reputation": 1519, "user_id": 506016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b2ef6443a54b6be94a1c522b67b661a?s=128&d=identicon&r=PG&f=1", "display_name": "MondayPaper", "link": "https://stackoverflow.com/users/506016/mondaypaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 42242224, "answer_count": 2, "score": 0, "last_activity_date": 1487142938, "creation_date": 1487140068, "last_edit_date": 1487140944, "question_id": 42242122, "link": "https://stackoverflow.com/questions/42242122/strings-trim-is-removing-the-letter-i-golang", "title": "strings.Trim is removing the letter &quot;i&quot; (golang)", "body": "<pre><code>full path: views/admin/users.html\ntrim set (views): /admin/users.html\ntrim set (views/): admin/users.html\n\nfull path: views/index.html\ntrim set (views): /index.html\ntrim set (views/): ndex.html\n</code></pre>\n\n<p>Heres my code:</p>\n\n<pre><code>    err := filepath.Walk(\"./views\", func(path string, info os.FileInfo, err error) error {\n        if strings.Contains(path, \".html\") {\n            bytes, err := ioutil.ReadFile(path)\n            if err != nil {\n                panic(err)\n            }\n            fmt.Println(\"full path:\", path)\n            fmt.Println(\"trim set (views):\", strings.Trim(path, \"views\"))\n            fmt.Println(\"trim set (views/):\", strings.Trim(path, \"views/\"))\n        }\n    }\n</code></pre>\n\n<p>Have I lost my mind? Does the forward slash have something to do with this? Please explain what's going on if you know.</p>\n"}, {"tags": ["file", "go", "process", "executable", "ram"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 2, "creation_date": 1487139616, "post_id": 42241774, "comment_id": 71642639, "body": "The infinite loop without sleep or any is a bad idea it consumes a lot of CPU. Is the file pointed by URL the exact code you are using?"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1487141017, "post_id": 42241774, "comment_id": 71643247, "body": "It would be difficult to help you  unless you respond to comments"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1487141942, "post_id": 42241774, "comment_id": 71643730, "body": "but then I got 2 binaries: one named go, and the other with the name of the file without the json part. The go binary has like 5mb, but this one has 36mb...  <code>go run</code> does not create binaries in working directory"}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 4, "last_activity_date": 1487143894, "creation_date": 1487143894, "answer_id": 42243138, "question_id": 42241774, "link": "https://stackoverflow.com/questions/42241774/why-my-go-program-creates-another-go-process-with-the-name-of-an-open-file-and/42243138#42243138", "title": "Why my Go program creates another Go process with the name of an open file, and why it&#39;s so big?", "body": "<blockquote>\n  <p>Why does go creates another process with the name of the file?</p>\n</blockquote>\n\n<p>It doesn't. You did. When you do <code>go run main.go</code> You are running the go program which compiles your main.go to a different executable (you remember that Go is a compiled language producing native executables?) and executes this second executable. You told the go tool to do so and it behaves as told. If you do not like that: <code>go build -o whatever; ./whatever</code>.</p>\n\n<blockquote>\n  <p>Also, shouldn't, when getPages() return, both the file object and json object be deleted from memory because of the go's garbage collector?</p>\n</blockquote>\n\n<p>Yes and that actually happens. It just isn't observable in the way you tried to check it. Memory management in Go is complicated and the interplay with the memory management of the OS is complicated (and OS dependent) and OS memory management is complicated too.</p>\n\n<p>Very roughly: The unreferenced objects are collected by the Go GC but that memory is not \"returned\" to the OS as \"returning\" and \"re-acquire\" memory from the OS is a very expensive operation, so memory is not \"returned\" to the OS (unless needed).</p>\n\n<p>Search SO or the web for \"go does not release memory\" if you think the gory details of memory management are of interest to you. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6791424"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1487143894, "creation_date": 1487138482, "question_id": 42241774, "link": "https://stackoverflow.com/questions/42241774/why-my-go-program-creates-another-go-process-with-the-name-of-an-open-file-and", "title": "Why my Go program creates another Go process with the name of an open file, and why it&#39;s so big?", "body": "<p>I have a big .json file that has about 2mb. I'm using <a href=\"http://www.chazzuka.com/2015/03/load-parse-json-file-golang/\" rel=\"nofollow noreferrer\">this code</a> to read the json, with a little modification:</p>\n\n<pre><code>func main() {\n    pages := getPages()\n    for {\n\n    }\n    for _, p := range pages {\n       fmt.Println(p.toString())\n    }\n</code></pre>\n\n<p>As you can see, I've put an infinite loop so I could make the program wait while I read the process's RAM size. When I've gone to read it, I've found 2 go programs running. I just did </p>\n\n<p><code>go run myfile.go</code></p>\n\n<p>but then I got 2 binaries: one named <code>go</code>, and the other with the name of the file without the json part. The <code>go</code> binary has like 5mb, but this one has 36mb...</p>\n\n<p>Why does go creates another process with the name of the file? Is it where it holds the file so I can read? Why it does that? As far as I know, the file reading should be handed by the OS. And why it's so big compared to the .json size?</p>\n\n<p>Also, shouldn't, when <code>getPages()</code> return, both the file object and json object be deleted from memory because of the go's garbage collector?</p>\n"}, {"tags": ["linux", "go", "httpserver"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487119584, "post_id": 42238695, "comment_id": 71636829, "body": "What exactly is the issue? Do you want to close active connections? Do you have timeouts set so unresponsive clients don&#39;t tie up connections?"}, {"owner": {"reputation": 742, "user_id": 1006006, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c7e18db000f12082ea6b1a68ae678701?s=128&d=identicon&r=PG", "display_name": "Vishal Kumar", "link": "https://stackoverflow.com/users/1006006/vishal-kumar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487120219, "post_id": 42238695, "comment_id": 71637014, "body": "@JimB how to set connection timeout from server side in golang. I do know for client side. I start my server with http.ListenAndServe"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1487123350, "post_id": 42238695, "comment_id": 71637930, "body": "@VishalKumar Copy the <a href=\"https://golang.org/src/net/http/server.go#L2349\" rel=\"nofollow noreferrer\">ListenAndServe code</a>. Modify to set values for <a href=\"https://godoc.org/net/http#Server.ReadTimeout\" rel=\"nofollow noreferrer\">ReadTimeout</a>, WriteTimeout, ...."}], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 1006006, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c7e18db000f12082ea6b1a68ae678701?s=128&d=identicon&r=PG", "display_name": "Vishal Kumar", "link": "https://stackoverflow.com/users/1006006/vishal-kumar"}, "edited": false, "score": 0, "creation_date": 1487180934, "post_id": 42243108, "comment_id": 71670957, "body": "For completeness changed                                          http.ListenAndServe(&quot;:port&quot;, r)                                                                               to s := &amp;http.Server{  \t\tAddr:           &quot;:port&quot;,  \t\tHandler:        r,  \t\tReadTimeout:    somesec * time.Second,  \t\tWriteTimeout:   sonesec * time.Second,  \t\tMaxHeaderBytes: 1 &lt;&lt; somenumber,  \t}  s.ListenAndServe()"}], "tags": [], "owner": {"reputation": 29080, "user_id": 1242778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKoAV.jpg?s=128&g=1", "display_name": "Agis", "link": "https://stackoverflow.com/users/1242778/agis"}, "is_accepted": true, "score": 2, "last_activity_date": 1605556231, "last_edit_date": 1605556231, "creation_date": 1487143769, "answer_id": 42243108, "question_id": 42238695, "link": "https://stackoverflow.com/questions/42238695/goroutine-in-io-wait-state-for-long-time/42243108#42243108", "title": "Goroutine in IO wait state for long time", "body": "<p>These could easily be clients the initiated a request but never completed it, or slow clients etc.</p>\n<p>You should configure the Read/Write timeouts of your server (<a href=\"https://golang.org/pkg/net/http/#Server\" rel=\"nofollow noreferrer\"><code>server.ReadTimeout</code></a> and <a href=\"https://golang.org/pkg/net/http/#Server\" rel=\"nofollow noreferrer\"><code>server.WriteTimeout</code></a> respectively):</p>\n<pre><code>s := new(http.Server)\n// ...\ns.ReadTimeout = 5 * time.Second\ns.WriteTimeout = 5 * time.Second\n// ...\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 1006006, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c7e18db000f12082ea6b1a68ae678701?s=128&d=identicon&r=PG", "display_name": "Vishal Kumar", "link": "https://stackoverflow.com/users/1006006/vishal-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6417, "favorite_count": 1, "accepted_answer_id": 42243108, "answer_count": 1, "score": 3, "last_activity_date": 1605556231, "creation_date": 1487118300, "question_id": 42238695, "link": "https://stackoverflow.com/questions/42238695/goroutine-in-io-wait-state-for-long-time", "title": "Goroutine in IO wait state for long time", "body": "<p>I have a heavy traffic server(more than 800K qps) with go1.7.</p>\n\n<p>From <a href=\"http://urltoserver:debugport/debug/pprof/goroutine?debug=2\" rel=\"nofollow noreferrer\">http://urltoserver:debugport/debug/pprof/goroutine?debug=2</a> I see 8K goroutines out of which almost 1800 are in IO wait for minutes. One of such goroutine stack is as below. </p>\n\n<pre><code>    goroutine 128328653 [IO wait, 54 minutes]:\n    net.runtime_pollWait(0x7f0fcc60c378, 0x72, 0x7cb)\n      /usr/local/go/src/runtime/netpoll.go:160 +0x59\n    net.(*pollDesc).wait(0xc4231d0a00, 0x72, 0xc42479fa20, 0xc42000c048)\n      /usr/local/go/src/net/fd_poll_runtime.go:73 +0x38\n    net.(*pollDesc).waitRead(0xc4231d0a00, 0x92f200, 0xc42000c048)\n      /usr/local/go/src/net/fd_poll_runtime.go:78 +0x34\n    net.(*netFD).Read(0xc4231d09a0, 0xc423109000, 0x1000, 0x1000, 0x0, 0x92f200, 0xc42000c048)\n      /usr/local/go/src/net/fd_unix.go:243 +0x1a1\n    net.(*conn).Read(0xc4234282b8, 0xc423109000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n      /usr/local/go/src/net/net.go:173 +0x70\n    net/http.(*connReader).Read(0xc420449840, 0xc423109000, 0x1000, 0x1000, 0xc422b38b68, 0x100000000, 0xc421810601)\n      /usr/local/go/src/net/http/server.go:586 +0x144\n    bufio.(*Reader).fill(0xc422e22360)\n      /usr/local/go/src/bufio/bufio.go:97 +0x10c\n    bufio.(*Reader).Peek(0xc422e22360, 0x4, 0x7a066c, 0x4, 0x1, 0x0, 0x0)\n      /usr/local/go/src/bufio/bufio.go:129 +0x62\n    net/http.(*conn).readRequest(0xc422b38b00, 0x931fc0, 0xc424d19440, 0x0, 0x0, 0x0)\n      /usr/local/go/src/net/http/server.go:762 +0xdff\n    net/http.(*conn).serve(0xc422b38b00, 0x931fc0, 0xc424d19440)\n      /usr/local/go/src/net/http/server.go:1532 +0x3d3\n    created by net/http.(*Server).Serve\n      /usr/local/go/src/net/http/server.go:2293 +0x44d\n</code></pre>\n\n<p>Anyone have faced this issue ?\nAny pointer is appreciated. </p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1487136247, "post_id": 42238624, "comment_id": 71641284, "body": "Because the language spec says so?"}], "answers": [{"tags": [], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "is_accepted": false, "score": 6, "last_activity_date": 1487120456, "creation_date": 1487120456, "answer_id": 42239023, "question_id": 42238624, "link": "https://stackoverflow.com/questions/42238624/calling-a-method-on-a-nil-struct-pointer-doesnt-panic-why-not/42239023#42239023", "title": "Calling a method on a nil struct pointer doesn&#39;t panic. Why not?", "body": "<p>Please read: <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">https://golang.org/ref/spec#The_zero_value</a></p>\n\n<blockquote>\n  <p>When storage is allocated for a variable, either through a declaration\n  or a call of new, or when a new value is created, either through a\n  composite literal or a call of make, and no explicit initialization is\n  provided, the variable or value is given a default value. Each element\n  of such a variable or value is set to the zero value for its type:\n  false for booleans, 0 for integers, 0.0 for floats, \"\" for strings,\n  and <strong>nil for pointers, functions, interfaces, slices, channels, and\n  maps</strong>. This initialization is done recursively, so for instance each\n  element of an array of structs will have its fields zeroed if no value\n  is specified.</p>\n</blockquote>\n\n<p>So in your code, <code>var err *MyError</code> is <code>nil</code>, you can call <code>err.Error()</code> is ok even <code>err = nill</code>,</p>\n\n<p>**</p>\n\n<blockquote>\n  <p>In Go, the function to be called by the Expression.Name() syntax is\n  entirely determined by the type of Expression and not by the\n  particular run-time value of that expression, including nil.</p>\n</blockquote>\n\n<p>** </p>\n"}, {"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 16, "last_activity_date": 1487120882, "creation_date": 1487120882, "answer_id": 42239079, "question_id": 42238624, "link": "https://stackoverflow.com/questions/42238624/calling-a-method-on-a-nil-struct-pointer-doesnt-panic-why-not/42239079#42239079", "title": "Calling a method on a nil struct pointer doesn&#39;t panic. Why not?", "body": "<p><a href=\"https://groups.google.com/d/msg/golang-nuts/wcrZ3P1zeAk/WI88iQgFMvwJ\" rel=\"noreferrer\">Michael Jones explained this well</a> (copied as answer):</p>\n\n<blockquote>\n  <p>In Go the function to be called by the Expression.Name() syntax is\n  entirely determined by the type of Expression and not by the\n  particular run-time value of that expression, including nil. </p>\n  \n  <p>In this manner, the invocation of a method on a nil pointer of a\n  specific type has a clear and logical meaning. </p>\n  \n  <p>Those familiar with vtable[] implementations will find this odd at\n  first, yet, when thinking of methods this way, it is even simpler and\n  makes sense. Think of:</p>\n\n<pre><code>func (p *Sometype) Somemethod (firstArg int) {} \n</code></pre>\n  \n  <p>as having the literal meaning:</p>\n\n<pre><code>func SometypeSomemethod(p *Sometype, firstArg int) {}\n</code></pre>\n  \n  <p>and in this view, the body of SometypeSomemethod() is certainly free\n  to test it's (actual) first argument (p *Sometype) for a value of nil.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 350, "user_id": 6091736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87bddf5a361754d628ee1365cacfbcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek Subramanian", "link": "https://stackoverflow.com/users/6091736/vivek-subramanian"}, "is_accepted": false, "score": 0, "last_activity_date": 1604914778, "creation_date": 1604914778, "answer_id": 64749133, "question_id": 42238624, "link": "https://stackoverflow.com/questions/42238624/calling-a-method-on-a-nil-struct-pointer-doesnt-panic-why-not/64749133#64749133", "title": "Calling a method on a nil struct pointer doesn&#39;t panic. Why not?", "body": "<p>Coming from C++/Java, this can look odd, another gotcha is that an interface holding a nil struct is not itself nil!</p>\n<p>You can try this on go playground to get a hang of things:</p>\n<pre><code>type inf interface {\n  test() string\n}\n\ntype s struct {\n}\n\nfunc (t *s) test() string {\n   return &quot;nil struct with pointer reciever can still call method\\n&quot;\n}\n\nfunc main() {\n    var sTest *s\n    if sTest == nil {\n       fmt.Printf(&quot;sTest is Nil\\n&quot;)\n    }\n    \n    fmt.Printf(&quot;%s&quot;, sTest.test())\n    \n    var fTest inf\n    if fTest == nil {\n       fmt.Printf(&quot;fTest is nil\\n&quot;)\n    }\n    \n        fTest = sTest\n        if fTest != nil {\n           fmt.Printf(&quot;interface holding nil is not nil!\\n&quot;)\n        }\n}\n</code></pre>\n<p>The key thing to you: go 'inheritance' is actually <em>duck typing.</em> And interfaces are defined to be able hold any valid value, and nil itself is a valid value!</p>\n"}], "owner": {"reputation": 91, "user_id": 7565822, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6DV8Z.jpg?s=128&g=1", "display_name": "cdh0805010118", "link": "https://stackoverflow.com/users/7565822/cdh0805010118"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4581, "favorite_count": 4, "answer_count": 3, "score": 6, "last_activity_date": 1604914778, "creation_date": 1487117758, "last_edit_date": 1487186914, "question_id": 42238624, "link": "https://stackoverflow.com/questions/42238624/calling-a-method-on-a-nil-struct-pointer-doesnt-panic-why-not", "title": "Calling a method on a nil struct pointer doesn&#39;t panic. Why not?", "body": "<pre><code>type MyError struct {\n    errors []string\n}\n\nfunc (t *MyError) Error() string {\n    if t == nil {\n        fmt.Println(\"t ptr empty\")\n        return \"\"\n    }\n    pointers := make([]string, 0, len(t.errors))\n    for i, r := range t.errors {\n        pointers[i] = r\n    }\n    sort.Strings(pointers)\n    return fmt.Sprintf(\"n error(s) decoding:\\n\\n%s\", len(t.errors), strings.Join(pointers, \",\"))\n}\n\nfunc main() {\n    var err *MyError\n    err.Error()  // expected \"panic: runtime error: invalid memory address or nil pointer dereference\" here\n}\n</code></pre>\n\n<p>The variable err is nil so calling err.Error() method is expected to cause a panic \"runtime error: invalid memory address or nil pointer dereference\", but the method call succeeds. Why doesn't this panic?</p>\n"}, {"tags": ["arrays", "go", "concurrency", "locking", "mutex"], "answers": [{"comments": [{"owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "edited": false, "score": 0, "creation_date": 1487121270, "post_id": 42239093, "comment_id": 71637364, "body": "Awesome explanation. Thanks! The code is just an example so I can understand how pointers, arrays, and locks work together. I seem to be running into this particular pattern a lot. Anyways, thanks again."}, {"owner": {"reputation": 594, "user_id": 409054, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7ec96a77503599f6c646ff211d0e96c?s=128&d=identicon&r=PG", "display_name": "TaslemGuy", "link": "https://stackoverflow.com/users/409054/taslemguy"}, "reply_to_user": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "edited": false, "score": 0, "creation_date": 1487121809, "post_id": 42239093, "comment_id": 71637529, "body": "The one caveat is that there&#39;s a common mistake (which <code>go vet</code> detects; so I would recommend running) is that loop variables (like the <code>i</code> in the <code>range</code>) have a scope that lasts longer than the given iteration; in particular:      <code>for i := range a { go func() { fmt.Printf(&quot;%d&quot;, i) }() }</code>  is likely to print out 3, 3, 3 or various other values since all of the goroutines capture the same <code>i</code>. The solution is to do      <code>for i := range a { go func(i int) { fmt.Printf(&quot;%d&quot;, i) }(i) }</code>"}, {"owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "edited": false, "score": 0, "creation_date": 1487121929, "post_id": 42239093, "comment_id": 71637551, "body": "What do you mean that they last longer? They&#39;re still only in the loop scope, right?"}, {"owner": {"reputation": 594, "user_id": 409054, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7ec96a77503599f6c646ff211d0e96c?s=128&d=identicon&r=PG", "display_name": "TaslemGuy", "link": "https://stackoverflow.com/users/409054/taslemguy"}, "reply_to_user": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "edited": false, "score": 1, "creation_date": 1487122332, "post_id": 42239093, "comment_id": 71637654, "body": "The example above showcases what I was trying to explain (although perhaps it could be clearer). Specifically, a closure in the body of the loop will capture the loop variable (<code>i</code> above). Thus, all of the closures will have <i>the same</i> reference to the same  value for <code>i</code>, rather than each getting their own value. Hence, it is necessary to pass it as a parameter or otherwise give it a scope local to each iteration, rather than over the whole loop."}], "tags": [], "owner": {"reputation": 594, "user_id": 409054, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7ec96a77503599f6c646ff211d0e96c?s=128&d=identicon&r=PG", "display_name": "TaslemGuy", "link": "https://stackoverflow.com/users/409054/taslemguy"}, "is_accepted": true, "score": 3, "last_activity_date": 1487121006, "creation_date": 1487121006, "answer_id": 42239093, "question_id": 42238425, "link": "https://stackoverflow.com/questions/42238425/golang-mutex-ranging-over-shared-array-in-goroutines/42239093#42239093", "title": "Golang mutex ranging over shared array in goroutines", "body": "<p>First, some Go terminology:</p>\n\n<p><code>[]int{1, 2, 3}</code> is a <em>slice</em>, not an <em>array</em>. An array would be written as <code>[...]int{1, 2, 3}</code>.</p>\n\n<p>A slice is a triplet of <code>(start, length, capacity)</code> and points to an underlying array (usually heap-allocated, but this is an implementation detail that the language completely hides from you!)</p>\n\n<p>Go's memory model allows any number of readers or (but not and) at most one writer to any given region in memory. The <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">Go memory model</a> (unfortunately) doesn't specifically call out the case of accessing multiple indices into the same slice concurrently, but it appears to be fine to do so (i.e. they are treated as distinct locations in memory, as would be expected).</p>\n\n<p>So if you're just reading from it, it is not necessary to protect it at all.</p>\n\n<p>If you're reading <em>and</em> writing to it, but the goroutines don't read and write to the same places as each other (for example, if goroutine <code>i</code> only reads and writes to position <code>i</code>) then you also don't need synchronization. Moreover, you could either synchronize the entire slice (which means fewer mutexes, but <em>much</em> higher contention) or you could synchronize the individual positions in the slice (which means much lower contention but many more mutexes and locks acquired and released).</p>\n\n<p>But since Go allows functions to capture variables in scope (that is, they are closures) there's really no reason to pass the array as a pointer at all:</p>\n\n<p>Your code would thus be most idiomatically be written as:</p>\n\n<pre><code>a := []int{1,2,3}\nfor i := 0; i &lt; 10; i++ \nfor i &lt; 10 {\n    go func() {\n        for _, i := range a {\n            fmt.Println(a[0])\n        }\n    }()\n}\n</code></pre>\n\n<p>I'm not really sure what the above code is supposed to be for- since it's going to print out <code>a[0]</code> 10 times in various goroutines, which makes it look like it's not even using the slice in a meaningful way.</p>\n"}, {"tags": [], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "is_accepted": false, "score": 2, "last_activity_date": 1487121471, "creation_date": 1487121471, "answer_id": 42239155, "question_id": 42238425, "link": "https://stackoverflow.com/questions/42238425/golang-mutex-ranging-over-shared-array-in-goroutines/42239155#42239155", "title": "Golang mutex ranging over shared array in goroutines", "body": "<p>First you shuold know <code>a := []int{1,2,3}</code> is not an array, it is a <strong>slice</strong>.</p>\n\n<p>A slice literal is like an array literal without the length.</p>\n\n<blockquote>\n  <p>This is an array literal:</p>\n</blockquote>\n\n<pre><code>[3]bool{true, true, false}\n</code></pre>\n\n<blockquote>\n  <p>And this creates the same array as above, then builds a slice that\n  references it:</p>\n</blockquote>\n\n<pre><code>[]bool{true, true, false}\n</code></pre>\n\n<p>Types with empty [], such as []int are actually slices, not arrays. In Go, the size of an array is part of the type, so to actually have an array you would need to have something like [16]int, and the pointer to that would be *[16]int.</p>\n\n<p>Q: is it necessary to pass the array to the goroutine as a pointer?</p>\n\n<p>A: No. From <a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#slices</a></p>\n\n<blockquote>\n  <p>If a function takes a slice argument, changes it makes to the elements\n  of the slice will be visible to the caller, analogous to passing a\n  pointer to the underlying array.</p>\n</blockquote>\n"}], "owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2020, "favorite_count": 0, "accepted_answer_id": 42239093, "answer_count": 2, "score": 0, "last_activity_date": 1487121471, "creation_date": 1487116572, "question_id": 42238425, "link": "https://stackoverflow.com/questions/42238425/golang-mutex-ranging-over-shared-array-in-goroutines", "title": "Golang mutex ranging over shared array in goroutines", "body": "<p>Say I have the following code:</p>\n\n<pre><code>a := []int{1,2,3}\ni := 0\nvar mu = &amp;sync.Mutex{}\nfor i &lt; 10 {\n    go func(a *[]int) {\n        for _, i := range a {\n            mu.Lock()\n            fmt.Println(a[0])\n            mu.Unlock()\n        }\n    }(&amp;a)\n    i++\n}\n</code></pre>\n\n<p>The array is a shared resource and is being read from in the loop. How do I protect the array in the loop header and do I need to? Also is it necessary to pass the array to the goroutine as a pointer?</p>\n"}, {"tags": ["go", "cqlsh"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1487111740, "post_id": 42237493, "comment_id": 71634408, "body": "What&#39;s the error? You&#39;re passing your args as a single argument."}, {"owner": {"reputation": 1339, "user_id": 1726183, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e052c9c68ad2978015d389b4c00513f0?s=128&d=identicon&r=PG", "display_name": "Varun Gupta", "link": "https://stackoverflow.com/users/1726183/varun-gupta"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487112218, "post_id": 42237493, "comment_id": 71634598, "body": "args := []string{&quot;ipaddress&quot;, &quot;-e&quot;, <code>&quot;COPY keyspace.table (cl1, cl2) to &#47;path&#47;to&#47;file&quot;</code>} ... &lt;stdin&gt;:1:SyntaxException: line 1:0 no viable alternative at input &#39;COPY...."}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 6253101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ygYWm.png?s=128&g=1", "display_name": "vogtb", "link": "https://stackoverflow.com/users/6253101/vogtb"}, "is_accepted": false, "score": 0, "last_activity_date": 1487870456, "creation_date": 1487870456, "answer_id": 42422336, "question_id": 42237493, "link": "https://stackoverflow.com/questions/42237493/run-cqlsh-shell-command-from-golang/42422336#42422336", "title": "run cqlsh shell command from golang", "body": "<p>When you pass in your arguments they need to be properly formatted, meaning you can't pass them in together as a single string. You also need to escape the quotation marks for the CQL command so the entire command is considered a single command line argument.</p>\n\n<p>The args should look something like this:</p>\n\n<pre><code>args := []string{\"ipaddress\", \"-e\", \"\\\"COPY keyspace.table (cl1, cl2) to /path/to/file\\\"\"}\n</code></pre>\n"}], "owner": {"reputation": 1339, "user_id": 1726183, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e052c9c68ad2978015d389b4c00513f0?s=128&d=identicon&r=PG", "display_name": "Varun Gupta", "link": "https://stackoverflow.com/users/1726183/varun-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487870456, "creation_date": 1487111689, "question_id": 42237493, "link": "https://stackoverflow.com/questions/42237493/run-cqlsh-shell-command-from-golang", "title": "run cqlsh shell command from golang", "body": "<p>I am trying to run cqlsh shell command 'COPY' from golang, but it is always exit status 2.</p>\n\n<pre><code>cmd := \"/path/to/my/cqlsh\"\nargs := []string{`ipaddress -e \"COPY keyspace.table (cl1, cl2) to /path/to/file\"`}\nexec.Command(cmd, args...).Run()\n</code></pre>\n\n<p>This always run into error.</p>\n"}, {"tags": ["security", "go", "docker"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1487110333, "post_id": 42237169, "comment_id": 71633800, "body": "See also <a href=\"https://github.com/airdock-io/docker-base/wiki/How-Managing-user-in-docker-container\" rel=\"nofollow noreferrer\">github.com/airdock-io/docker-base/wiki/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 4434175, "user_type": "registered", "profile_image": "https://graph.facebook.com/595050817/picture?type=large", "display_name": "Tom Mornini", "link": "https://stackoverflow.com/users/4434175/tom-mornini"}, "edited": false, "score": 0, "creation_date": 1487111766, "post_id": 42237169, "comment_id": 71634416, "body": "Thank you sir, much appreciated!"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 0, "last_activity_date": 1487110138, "creation_date": 1487110138, "answer_id": 42237169, "question_id": 42237002, "link": "https://stackoverflow.com/questions/42237002/non-privileged-execution-from-scratch/42237169#42237169", "title": "non-privileged execution FROM scratch", "body": "<p>You don't seem to have any choice in the user (root) running the CMD inside a container launched from an image built \"<code>FROM scratch</code>\".</p>\n\n<p>But by definition of a container, that user can only influence its own (disk, memory, resources) space, not the host. So it should not matter.</p>\n\n<p>The only other alternative would be to define a container from scratch only for declaring a volume container, that you would use in a full-fledged image able to run with a non-root user.<br>\nSee \"<a href=\"https://gist.github.com/dsimunic/33d4b53bded2b39aa7eb\" rel=\"nofollow noreferrer\">Running as a non-root inside a container</a>\"</p>\n\n<pre><code>$ echo 'FROM scratch\nADD data.tar /\nVOLUME [\"/data\"]' &gt; Dockerfile\n\n$ docker build -t minimal .\n$ docker create --name minimal minimal :\n</code></pre>\n\n<blockquote>\n  <p>The container that mounts this minimal volume container needs to create the user with id 1000:</p>\n</blockquote>\n\n<pre><code>$ docker run --rm --volumes-from minimal  -it debian:jessie /bin/bash -c 'useradd postgres &amp;&amp; ls -l /data'\n</code></pre>\n\n<p>That is not what you need (since the Go program does not need any dynamic libraries, and can run solely on system calls). But that illustrates how a non-root user can use a \"<code>FROM scratch</code>\" container (here as a volume)</p>\n"}], "owner": {"reputation": 13, "user_id": 4434175, "user_type": "registered", "profile_image": "https://graph.facebook.com/595050817/picture?type=large", "display_name": "Tom Mornini", "link": "https://stackoverflow.com/users/4434175/tom-mornini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 42237169, "answer_count": 1, "score": 1, "last_activity_date": 1487110517, "creation_date": 1487109406, "last_edit_date": 1487110517, "question_id": 42237002, "link": "https://stackoverflow.com/questions/42237002/non-privileged-execution-from-scratch", "title": "non-privileged execution FROM scratch", "body": "<p>I'm building/deploying go/golang micro-services on images FROM scratch.</p>\n\n<p>Is it possible to specify non-privileged execution on an image built this way -- there are only two files on the image\u2013the go executable and a root certificate file\u2013so there doesn't seem to be any concept of privilege within the container.</p>\n\n<p>I also use read-only containers and --selinux-enabled=true --icc=false --iptables=true, but would feel more warm and fuzzy if I knew that the executable was running as a \"common\" non-privileged user.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 3, "last_activity_date": 1487104773, "creation_date": 1487104773, "answer_id": 42235766, "question_id": 42235270, "link": "https://stackoverflow.com/questions/42235270/copying-reference-to-pointer-or-by-value/42235766#42235766", "title": "Copying reference to pointer or by value", "body": "<p>In short: No.</p>\n\n<p>First: There are no \"references\" in Go. Forget about this idea now, otherwise you'll hurt yourself. Really. Thinking about \"by reference\" is plain wrong.</p>\n\n<p>Second: Performance is totally the same. Forget about this type of nano optimisations now. Especially when dealing with int. If and only if you have a performance problem: Measure, then optimize. It might be intuitively appealing to think \"Handing around a tiny pointer of 8 bytes must be much faster than copying structs with 30 or even 100 bytes.\" It is not, at least it is not that simple.</p>\n\n<p>Third: Just write it a <code>func f() *int { d := 6; return &amp;d; }</code>. There is no need to do any fancy dances here.</p>\n\n<p>Fourth: Option 2 makes a \"deep copy\" of the int. But this might be misleading as there are no \"shallow copies\" of an int so I'm unsure if I understand what you are asking here. Go has no notion of deep vs. shallow copy. If you copy a pointer value the pointer value is copied. You remember the first point? There are no references in Go. A pointer value is a value if copied you have a copy of the pointer value. Such a copy does absolutely nothing to the value pointed to, especially it doesn't do a copy. This would hint that copies in Go are not \"deep\". Forget about deep/shallow copy when talking about Go. (Of course you can implement functions which perform a \"deep copy\" of your custom objects)</p>\n\n<p>Fifth: Go has a <em>properly</em> <em>working</em> garbage collector. It makes absolutely no difference what you do: While an object is live it won't be collected and once it can be collected it will be. You can pass, return, copy, hand over, take address, dereference pointers or whatever you like, it just does not matter. The GC works properly. (Unless you are deliberately looking for pain and errors by using package unsafe.)</p>\n"}, {"tags": [], "owner": {"reputation": 29080, "user_id": 1242778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKoAV.jpg?s=128&g=1", "display_name": "Agis", "link": "https://stackoverflow.com/users/1242778/agis"}, "is_accepted": true, "score": 10, "last_activity_date": 1487105370, "last_edit_date": 1487105370, "creation_date": 1487104981, "answer_id": 42235827, "question_id": 42235270, "link": "https://stackoverflow.com/questions/42235270/copying-reference-to-pointer-or-by-value/42235827#42235827", "title": "Copying reference to pointer or by value", "body": "<p>There is no better place to look than the official documentation:</p>\n\n<blockquote>\n<pre><code>func NewFile(fd int, name string) *File {\n    if fd &lt; 0 {\n        return nil\n    }\n    f := File{fd, name, nil, 0}\n    return &amp;f\n}\n</code></pre>\n  \n  <p>Note that, unlike in C, <strong>it's perfectly OK to return the address\n  of a local variable; the storage associated with the variable survives\n  after the function returns.</strong> In fact, taking the address of a composite\n  literal allocates a fresh instance each time it is evaluated, so we\n  can combine these last two lines.</p>\n</blockquote>\n\n<p><em>(source: <a href=\"https://golang.org/doc/effective_go.html#composite_literals\">\"Effective Go\"</a>)</em></p>\n\n<p>So the first option (returning a pointer to a local variable) is absolutely safe and even <em>encouraged</em>. By performing <a href=\"https://en.wikipedia.org/wiki/Escape_analysis\">escape analysis</a> the compiler can tell that a variable escapes its local scope and allocates it on the heap instead.</p>\n"}], "owner": {"reputation": 2783, "user_id": 7234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e56a1b2b3064b7b91628435d9375d0a1?s=128&d=identicon&r=PG", "display_name": "HidekiAI", "link": "https://stackoverflow.com/users/7234/hidekiai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 1, "accepted_answer_id": 42235827, "answer_count": 2, "score": 7, "last_activity_date": 1487105370, "creation_date": 1487102869, "last_edit_date": 1495540436, "question_id": 42235270, "link": "https://stackoverflow.com/questions/42235270/copying-reference-to-pointer-or-by-value", "title": "Copying reference to pointer or by value", "body": "<p>I think I understand the answer from <a href=\"https://stackoverflow.com/questions/38443348/is-dereference-golang-struct-return-new-copy-of-struct\">here</a> but just in case, I want to explicitly ask about the following (my apologies if you think it is the same question, but to me, it feels different on the concerns):</p>\n\n<pre><code>func f() *int {\n  d := 6\n  pD := new(int)\n  pD = &amp;d // option 1\n  *pD = d // option 2\n  return pD\n}\n</code></pre>\n\n<p>The first option where I just copy the reference as a pointer is performance-wise, more optimal (this is educational guess, but it seems obvious).  I would prefer this method/pattern.</p>\n\n<p>The second option would (shallow) copy (?) instead.  What I presume is that this method, because it copies, I have no concerns about GC sweeping the instance of 'd'.  I often use this method due to my insecurity (or ignorance as a beginner).</p>\n\n<p>What I am concerned about (or more so, insecure about) is that in the first method (where address of 'd' is transfered), will GC recognize that it (the 'd' variable) is referenced by a pointer container, thus it will not be swept?  Thus it will be safe to use this method instead?  I.e. can I safely pass around pointer 'pD' returned from func 'f()' for the lifetime of the application?</p>\n\n<p>Reference: <a href=\"https://play.golang.org/p/JWNf5yRd_B\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JWNf5yRd_B</a></p>\n"}, {"tags": ["performance", "class", "go", "functional-programming"], "comments": [{"owner": {"reputation": 517, "user_id": 4253002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oh2x3.jpg?s=128&g=1", "display_name": "Pepijn van Leeuwen", "link": "https://stackoverflow.com/users/4253002/pepijn-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1487102893, "post_id": 42235120, "comment_id": 71629923, "body": "Go isn&#39;t a functional programming language <i>per se</i>. Golang supports first-class functions, see: <a href=\"https://blog.golang.org/first-class-functions-in-go-and-new-go\" rel=\"nofollow noreferrer\">blog.golang.org/first-class-functions-in-go-and-new-go</a> . However, I don&#39;t think it will make any difference in performance \u2013 use first-class functions/recursion/etc. when it makes sense to use them."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487104889, "post_id": 42235120, "comment_id": 71631034, "body": "Go methods are just functions, so there&#39;s no performance different calling one or the other."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1487105622, "post_id": 42235120, "comment_id": 71631417, "body": "<i>&quot;I was told using a class-based approach to coding is more performant in Javascript than functional.&quot;</i> \u2013 ignore this kind of dribble. there&#39;s no way that&#39;s true for all possible programs. Use the style you want and optimize for performance when its required."}, {"owner": {"reputation": 407, "user_id": 1095292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380f81966ae6c98bd3eb0c87ecf17948?s=128&d=identicon&r=PG", "display_name": "Petar Donchev", "link": "https://stackoverflow.com/users/1095292/petar-donchev"}, "edited": false, "score": 0, "creation_date": 1487278667, "post_id": 42235120, "comment_id": 71725654, "body": "A note on the side, not related to performance, but to design. You can always satisfy a function type with a (bound) method, but in order to satisfy an interface you need a type with methods (though it can be a dummy struct{}). On the other hand interfaces are more expressive, of course. Look at the stdlib - utilities are mostly functions and methods are used sparingly, mostly as means to implement interfaces, and less often (than other languages) as utility. I don&#39;t think performance should be the guiding force for this."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1487106338, "post_id": 42236060, "comment_id": 71631805, "body": "at .27ns per op, your first benchmark is probably optimized away completely (or maybe that would be the point here, that it doesn&#39;t matter)"}, {"owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487106591, "post_id": 42236060, "comment_id": 71631957, "body": "That is basically the point - if we can&#39;t tell any sort of noticeable difference in our benchmarks, chances are it isn&#39;t worth worrying about."}, {"owner": {"reputation": 72, "user_id": 5419764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff33d1d86e64b81e9367b01d97b24286?s=128&d=identicon&r=PG&f=1", "display_name": "Britt", "link": "https://stackoverflow.com/users/5419764/britt"}, "edited": false, "score": 0, "creation_date": 1487224947, "post_id": 42236060, "comment_id": 71688792, "body": "Very complete and succinct, just what I was looking for."}], "tags": [], "owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "is_accepted": true, "score": 3, "last_activity_date": 1487105821, "creation_date": 1487105821, "answer_id": 42236060, "question_id": 42235120, "link": "https://stackoverflow.com/questions/42235120/go-is-a-class-based-approach-more-performant-than-functional/42236060#42236060", "title": "Go: Is a class-based approach more performant than functional?", "body": "<p>You can actually test this in go!</p>\n\n<p>In your code you can create a method and the equivalent function. I'm doing this in a <code>main.go</code> file.</p>\n\n<pre><code>type A string\nfunc (a A) Demo(i int) {}\nfunc Demo(a A, i int) {}\n</code></pre>\n\n<p>Then create a benchmark for it in the test file (<code>main_test.go</code> for me).</p>\n\n<pre><code>func BenchmarkMethod(b *testing.B) {\n    var a A = \"test\"\n    var i int = 123\n\n    for n := 0; n &lt; b.N; n++ {\n        a.Demo(i)\n    }\n}\n\nfunc BenchmarkFunction(b *testing.B) {\n    var a A = \"test\"\n    var i int = 123\n\n    for n := 0; n &lt; b.N; n++ {\n        Demo(a, i)\n    }\n}\n</code></pre>\n\n<p>Then test the benchmarks with <code>go test -bench=.</code></p>\n\n<pre><code>BenchmarkMethod-8       2000000000           0.27 ns/op\nBenchmarkFunction-8     2000000000           0.29 ns/op\nPASS\n</code></pre>\n\n<p>You can update your method and function to do the same thing to see how that affects things.</p>\n\n<pre><code>func (a A) Demo(i int) string {\n    return fmt.Sprintf(\"%s-%d\", a, i)\n}\n\nfunc Demo(a A, i int) string {\n    return fmt.Sprintf(\"%s-%d\", a, i)\n}\n</code></pre>\n\n<p>And testing this still gets me nearly identical perf.</p>\n\n<pre><code>$ go test -bench=.\nBenchmarkMethod-8       10000000           233 ns/op\nBenchmarkFunction-8     10000000           232 ns/op\nPASS\n</code></pre>\n\n<p>So short answer - I highly doubt there is any significant performance difference between the two, and if there is it looks like any other code you run is likely to have a larger impact than using methods vs functions. </p>\n"}], "owner": {"reputation": 72, "user_id": 5419764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff33d1d86e64b81e9367b01d97b24286?s=128&d=identicon&r=PG&f=1", "display_name": "Britt", "link": "https://stackoverflow.com/users/5419764/britt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "closed_date": 1487117060, "accepted_answer_id": 42236060, "answer_count": 1, "score": 0, "last_activity_date": 1487105821, "creation_date": 1487102374, "question_id": 42235120, "link": "https://stackoverflow.com/questions/42235120/go-is-a-class-based-approach-more-performant-than-functional", "closed_reason": "Needs more focus", "title": "Go: Is a class-based approach more performant than functional?", "body": "<p>I am curious if a class-based approach using structs and functions on those structs is more performant in Golang?</p>\n\n<p>So far I have been unable to unearth any resources that compare the two different techniques.</p>\n\n<p>This question came out of a conversation when I was told using a class-based approach to coding is more performant in Javascript than functional.</p>\n"}, {"tags": ["performance", "amazon-web-services", "go", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "edited": false, "score": 1, "creation_date": 1487094928, "post_id": 42232925, "comment_id": 71625583, "body": "Another difference is that your EB setup most likely involved an Elastic Load Balancer. The &quot;elastic&quot; part means that it&#39;s supposed to scale with traffic, but I&#39;ve seen instances where a sudden burst of traffic (such as with a performance test) can cause issues until the ELB catches up."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1487095050, "post_id": 42232925, "comment_id": 71625659, "body": "Agree with Brian. To test hypotheses, you could compare 1) m3.medium behind an ELB, 2) m3.medium + ELB after, say, 15 minutes of sustained load, 3) m3.medium + ELB + nginx."}, {"owner": {"reputation": 1105, "user_id": 3051060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZeQp.jpg?s=128&g=1", "display_name": "rcmgleite", "link": "https://stackoverflow.com/users/3051060/rcmgleite"}, "edited": false, "score": 0, "creation_date": 1487095089, "post_id": 42232925, "comment_id": 71625693, "body": "My EB setup is single instance but good point"}, {"owner": {"reputation": 137816, "user_id": 13070, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/pio3A.jpg?s=128&g=1", "display_name": "Mark B", "link": "https://stackoverflow.com/users/13070/mark-b"}, "edited": false, "score": 0, "creation_date": 1487097133, "post_id": 42232925, "comment_id": 71626815, "body": "Were the EBS disk volumes of the same type and size?"}, {"owner": {"reputation": 1105, "user_id": 3051060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZeQp.jpg?s=128&g=1", "display_name": "rcmgleite", "link": "https://stackoverflow.com/users/3051060/rcmgleite"}, "edited": false, "score": 0, "creation_date": 1487097420, "post_id": 42232925, "comment_id": 71626974, "body": "Yes. Both of them were gp2 8GiB."}, {"owner": {"reputation": 1105, "user_id": 3051060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZeQp.jpg?s=128&g=1", "display_name": "rcmgleite", "link": "https://stackoverflow.com/users/3051060/rcmgleite"}, "reply_to_user": {"reputation": 137816, "user_id": 13070, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/pio3A.jpg?s=128&g=1", "display_name": "Mark B", "link": "https://stackoverflow.com/users/13070/mark-b"}, "edited": false, "score": 0, "creation_date": 1487097785, "post_id": 42232925, "comment_id": 71627161, "body": "But how could this affect the test? @MarkB"}, {"owner": {"reputation": 137816, "user_id": 13070, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/pio3A.jpg?s=128&g=1", "display_name": "Mark B", "link": "https://stackoverflow.com/users/13070/mark-b"}, "edited": false, "score": 1, "creation_date": 1487098002, "post_id": 42232925, "comment_id": 71627260, "body": "If your test generated any disk I/O at all, such as writing to log files, then the speed of the EBS disk volumes would affect the requests/second that the server can handle. It sounds like you used identical volumes though. My guess is the Nginx settings in the EB environment were causing a bottleneck. Maybe just the additional logging enabled by default on EB is causing the bottleneck."}], "answers": [{"comments": [{"owner": {"reputation": 1105, "user_id": 3051060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZeQp.jpg?s=128&g=1", "display_name": "rcmgleite", "link": "https://stackoverflow.com/users/3051060/rcmgleite"}, "edited": false, "score": 0, "creation_date": 1487108115, "post_id": 42236595, "comment_id": 71632764, "body": "Nice answer. I did something similar myself. On the EB instance, a opened another port and made my application bind to that port(bypassing nginx). As a result the performance improved, but not as much as the standalone application. That&#39;s why i believe there is something more happening with EB instance."}], "tags": [], "owner": {"reputation": 890, "user_id": 3364249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQltG.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3364249/marco"}, "is_accepted": false, "score": 2, "last_activity_date": 1487107808, "creation_date": 1487107808, "answer_id": 42236595, "question_id": 42232925, "link": "https://stackoverflow.com/questions/42232925/are-there-any-performance-issues-when-running-golang-apps-on-elastic-beanstalk/42236595#42236595", "title": "Are there any performance issues when running Golang apps on elastic beanstalk?", "body": "<p>The short answer: You were not measuring the same thing. On your own instance, you measured the native Go Webserver whereas on Beanstalk you measured Nginx with a native Go Web server behind.</p>\n\n<p>The long answer:</p>\n\n<p>If you are using AWS Elastic Beanstalk in a Single Instance Configuration, you receive the exact same instance as if you are using EC2.\nYou do not receive an Elastic Load Balancer in front of a single instance Beanstalk environment.</p>\n\n<p>If you are using the Beanstalk, you will get a predeployed nginx (as you already stated). \nNginx has a significant impact on the performance, especially in a single CPU configuration as with the m3.medium instance.</p>\n\n<p>The performance impact you measured were by no means caused directly by Beanstalk, but by your deployment configuration.\nTo avoid this decrease in performance, you may choose to use the native Go Web server.</p>\n\n<hr>\n\n<p>To support my reasoning I run some tests to demonstrate the performance.\nThe following numbers were generated by running <a href=\"https://github.com/wg/wrk/\" rel=\"nofollow noreferrer\">wrk</a> on an EC2 m3.medium instance in the same datacenter as the workload was located.</p>\n\n<p>I installed the same Go application on Beanstalk as on the native EC2 instance, and I installed a NGINX server with the same configuration as Beanstalk is using.</p>\n\n<pre><code>./wrk http://&lt;server&gt;/ --duration 20s --connections 300\n\nBeanstalk m3.medium instance DIRECT:  9230.52 Requests / sec\nBeanstalk m3.medium instance NGINX:   1502.14 Requests / sec\nEC2 m3.medium instance DIRECT:       13649.46 Requests / sec\nEC2 m3.medium instance NGINX:         2489.78 Requests / sec\n</code></pre>\n"}], "owner": {"reputation": 1105, "user_id": 3051060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZeQp.jpg?s=128&g=1", "display_name": "rcmgleite", "link": "https://stackoverflow.com/users/3051060/rcmgleite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1487118169, "creation_date": 1487094607, "last_edit_date": 1487118169, "question_id": 42232925, "link": "https://stackoverflow.com/questions/42232925/are-there-any-performance-issues-when-running-golang-apps-on-elastic-beanstalk", "title": "Are there any performance issues when running Golang apps on elastic beanstalk?", "body": "<p>I'm trying to benchmark a simple 'hello world' HTTP server in <code>go</code>.\nI've made 2 tests:</p>\n\n<ol>\n<li>Using amazon ec2 - m3.medium instance</li>\n<li>Using amazon elastic beanstalk - also with m3.medium single instance</li>\n</ol>\n\n<p>On the first setup, I could get up to 18k req/sec.\nOn the second, 1.6k req/sec.</p>\n\n<p>Source code:(from: <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">https://golang.org/doc/articles/wiki/</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Is there any explanation for such a huge performance difference?</p>\n\n<p>PS:\nbenchmark tool: <a href=\"https://github.com/wg/wrk\" rel=\"nofollow noreferrer\">https://github.com/wg/wrk</a> <br>\nAlso, one important thing is: Elastic beanstalk always adds nginx as a reverse proxy for it's applications(and for Go apps I was not able to remove it)\nOn the first setup, there was no nginx at all. </p>\n"}, {"tags": ["memory", "go", "concurrency", "atomic"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487090126, "post_id": 42231153, "comment_id": 71622406, "body": "Did you try it? In most cases <code>f()</code> won&#39;t be executed at all."}], "answers": [{"comments": [{"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1487090089, "post_id": 42231285, "comment_id": 71622386, "body": "correct me if I&#39;m wrong: let&#39;s say ev1 as a = 1, ev2 as b= 2, ev3 as print a, ev4 as print b. Since there is no synchronisation can happen that ev3 and ev4 are executed before ev1 &amp; ev2. But if ev3 print 2 this mean also that ev1 and ev2 are already executed so ev4 will print for sure 1. Am I wrong?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 2, "creation_date": 1487090749, "post_id": 42231285, "comment_id": 71622832, "body": "@Tinwor: No, that&#39;s not guaranteed, especially without atomic operations. Each goroutine may be in a different thread, on a different core, on a different NUMA node and viewing different memory. Even when using atomic operations, the implicit order of operations technically only applies within a goroutine, so I don&#39;t think it&#39;s be guaranteed by the memory model."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1487091489, "last_edit_date": 1487091489, "creation_date": 1487089657, "answer_id": 42231285, "question_id": 42231153, "link": "https://stackoverflow.com/questions/42231153/do-atomic-operations-establish-a-happen-before-relation/42231285#42231285", "title": "Do atomic operations establish a happen-before relation?", "body": "<p>No. There's no synchronization, so there is no <a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"nofollow noreferrer\">\"happens before\"</a> relationship.</p>\n\n<p><a href=\"https://golang.org/ref/mem#tmp_3\" rel=\"nofollow noreferrer\">Synchronization</a> between goroutines is done via channel communication and lock operations.</p>\n\n<p>A key paragraph in the memory model is:</p>\n\n<blockquote>\n  <p>Within a single goroutine, reads and writes must behave as if they executed in the order specified by the program. That is, compilers and processors may reorder the reads and writes executed within a single goroutine only when the reordering does not change the behavior within that goroutine as defined by the language specification. Because of this reordering, the execution order observed by one goroutine may differ from the order perceived by another. For example, if one goroutine executes a = 1; b = 2;, another might observe the updated value of b before the updated value of a.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 3, "last_activity_date": 1487111168, "creation_date": 1487111168, "answer_id": 42237392, "question_id": 42231153, "link": "https://stackoverflow.com/questions/42231153/do-atomic-operations-establish-a-happen-before-relation/42237392#42237392", "title": "Do atomic operations establish a happen-before relation?", "body": "<p>Practically it will work as you described. The Go compiler won't re-order atomic operations and atomic store is implemented using XCHG on amd64 (and similar instructions on other architectures): <a href=\"https://github.com/golang/go/blob/release-branch.go1.8/src/cmd/compile/internal/ssa/gen/AMD64.rules#L472\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/release-branch.go1.8/src/cmd/compile/internal/ssa/gen/AMD64.rules#L472</a></p>\n\n<p>This behaviour is not specified at the moment (as of Go 1.8) and might change, see discussion at <a href=\"https://github.com/golang/go/issues/5045\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/5045</a> for more insights.</p>\n"}], "owner": {"reputation": 313, "user_id": 1097131, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/af802679b9ab256e47b6e415749c5728?s=128&d=identicon&r=PG", "display_name": "luyi0619", "link": "https://stackoverflow.com/users/1097131/luyi0619"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1611833224, "creation_date": 1487089267, "last_edit_date": 1611833224, "question_id": 42231153, "link": "https://stackoverflow.com/questions/42231153/do-atomic-operations-establish-a-happen-before-relation", "title": "Do atomic operations establish a happen-before relation?", "body": "<p>I know it can happen that g prints 2 and then 0 given the following code.</p>\n\n<pre><code>var a, b uint32\n\nfunc f() {\n    a = 1\n    b = 2\n}\n\nfunc g() {\n    fmt.Println(b)\n    fmt.Println(a)\n}\n\nfunc main() {\n    go f()\n    g()\n}\n</code></pre>\n\n<p>What if I change all read and write to atomic operations? Is that guaranteed that if g prints 2 first, then 1 is also printed?</p>\n\n<pre><code>var a, b uint32\n\nfunc f() {\n    atomic.StoreUint32(&amp;a, 1)\n    atomic.StoreUint32(&amp;b, 2)\n}\n\nfunc g() {\n    fmt.Println(atomic.LoadUint32(&amp;b))\n    fmt.Println(atomic.LoadUint32(&amp;a))\n}\n\nfunc main() {\n    go f()\n    g()\n}\n</code></pre>\n"}, {"tags": ["arrays", "json", "go", "struct"], "comments": [{"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487089252, "post_id": 42231120, "comment_id": 71621809, "body": "Why aren&#39;t you simply running a marshal on the struct object? That would work and since you&#39;ve provided runes, it will properly convert it to JSON."}, {"owner": {"reputation": 5521, "user_id": 1187785, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dcced9c986164b9e0ed456f353d8fca9?s=128&d=identicon&r=PG", "display_name": "Ali Issa", "link": "https://stackoverflow.com/users/1187785/ali-issa"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487089476, "post_id": 42231120, "comment_id": 71621960, "body": "it won&#39;t work, since I don&#39;t know what will be filled inside the <code>Insights []struct </code>"}, {"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487089783, "post_id": 42231120, "comment_id": 71622168, "body": "Yeah, so simply define a <code>[]map[string]interface</code> in the struct. It&#39;ll take care of everything on its own. Make it like <code>Insights []map[string]interface{}</code>"}, {"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487089911, "post_id": 42231120, "comment_id": 71622272, "body": "if you&#39;re not even sure it&#39;ll be an array of something, then simply put an <code>interface{}</code> there."}, {"owner": {"reputation": 5521, "user_id": 1187785, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dcced9c986164b9e0ed456f353d8fca9?s=128&d=identicon&r=PG", "display_name": "Ali Issa", "link": "https://stackoverflow.com/users/1187785/ali-issa"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487091695, "post_id": 42231120, "comment_id": 71623483, "body": "not working with interface{}, error: unexpected interface, expecting field name or embedded type"}, {"owner": {"reputation": 5521, "user_id": 1187785, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dcced9c986164b9e0ed456f353d8fca9?s=128&d=identicon&r=PG", "display_name": "Ali Issa", "link": "https://stackoverflow.com/users/1187785/ali-issa"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487091726, "post_id": 42231120, "comment_id": 71623502, "body": "should I make it <code>Data interface{}</code> for example?"}, {"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487097199, "post_id": 42231120, "comment_id": 71626851, "body": "Yes, sorry for the missing Data"}, {"owner": {"reputation": 5521, "user_id": 1187785, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dcced9c986164b9e0ed456f353d8fca9?s=128&d=identicon&r=PG", "display_name": "Ali Issa", "link": "https://stackoverflow.com/users/1187785/ali-issa"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487148852, "post_id": 42231120, "comment_id": 71647517, "body": "@ishaan this won&#39;t work buddy, the generated json will be like this: <code>&quot;posts&quot;: [{ \t\t&quot;post_id&quot;: &quot;24225267232_10154099759037233&quot;, \t\t&quot;type&quot;: &quot;photo&quot;, \t\t&quot;insights&quot;: [{ \t\t\t&quot;name&quot;: &quot;post_impressions_organic_unique&quot;, \t\t\t&quot;values&quot;: [{ \t\t\t\t&quot;value&quot;: 1828 \t\t\t}] \t\t}</code>"}, {"owner": {"reputation": 5521, "user_id": 1187785, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dcced9c986164b9e0ed456f353d8fca9?s=128&d=identicon&r=PG", "display_name": "Ali Issa", "link": "https://stackoverflow.com/users/1187785/ali-issa"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1487148890, "post_id": 42231120, "comment_id": 71647542, "body": "I need it to be something else like <code>organic_impressions_unique&quot;: 8288 </code> without the name parameter"}], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 1187785, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dcced9c986164b9e0ed456f353d8fca9?s=128&d=identicon&r=PG", "display_name": "Ali Issa", "link": "https://stackoverflow.com/users/1187785/ali-issa"}, "edited": false, "score": 0, "creation_date": 1487168478, "post_id": 42247504, "comment_id": 71661466, "body": "it is not working while doing so:  <code>for _, p := range messages[0].Posts {         for k, i := range p.Insights {             jsonRes.Posts[&quot;post_id&quot;] = p.PostID             fmt.Println(i)             fmt.Println(k)         }     }</code>"}, {"owner": {"reputation": 5521, "user_id": 1187785, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dcced9c986164b9e0ed456f353d8fca9?s=128&d=identicon&r=PG", "display_name": "Ali Issa", "link": "https://stackoverflow.com/users/1187785/ali-issa"}, "edited": false, "score": 0, "creation_date": 1487168534, "post_id": 42247504, "comment_id": 71661501, "body": "and this won&#39;t work as well:  <code>for _, p := range messages[0].Posts {         for k, i := range p.Insights {             jsonRes.Posts[k][&quot;post_id&quot;] = p.PostID             fmt.Println(i)             fmt.Println(k)         }     }</code>  the difference is this <code>jsonRes.Posts[k]</code>"}], "tags": [], "owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1487156513, "creation_date": 1487156513, "answer_id": 42247504, "question_id": 42231120, "link": "https://stackoverflow.com/questions/42231120/restructuring-json-using-golang/42247504#42247504", "title": "Restructuring Json using Golang", "body": "<p>Keep your struct as:</p>\n\n<pre><code>type NameValue struct {\n    Name string `json:\"name\"`\n    Values []map[string]interface{} `json:\"values\"`\n}\n\ntype JsonData struct {\n    TalentID string `json:\"talent_id\"`\n    Platform string `json:\"platform\"`\n    Posts []struct {\n        PostID string `json:\"post_id\"`\n        Type string `json:\"type\"`\n        Insights []NameValue `json:\"insights\"`\n    } `json:\"posts\"`\n}\n</code></pre>\n\n<p>Create another struct similar to this one:</p>\n\n<pre><code>type JsonDataRes struct {\n    TalentID string `json:\"talent_id\"`\n    Platform string `json:\"platform\"`\n    Posts []map[string]interface{} `json:\"posts\"`\n}\n</code></pre>\n\n<p>Once you have the data in your <code>JsonData</code> struct, loop over the insights object and manually assign values to the new <code>JsonDataRes</code> object and also the vaules of <code>PostId</code> and <code>Type</code> inside the Posts <code>[]map[string]interface{}</code></p>\n"}], "owner": {"reputation": 5521, "user_id": 1187785, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dcced9c986164b9e0ed456f353d8fca9?s=128&d=identicon&r=PG", "display_name": "Ali Issa", "link": "https://stackoverflow.com/users/1187785/ali-issa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1487156513, "creation_date": 1487089113, "question_id": 42231120, "link": "https://stackoverflow.com/questions/42231120/restructuring-json-using-golang", "title": "Restructuring Json using Golang", "body": "<p>I have the following JSON response:</p>\n\n<pre><code>[\n      {\n        \"talent_id\": \"b520ad50-5302-45ce-9121-5ff42d67b4fb\",\n        \"platform\": \"facebook\",\n        \"posts\": [\n          {\n            \"insights\": [\n              {\n                \"name\": \"post_impressions_organic_unique\",\n                \"values\": [\n                  {\n                    \"value\": 1828\n                  }\n                ]\n              },\n              {\n                \"name\": \"post_stories_by_action_type\",\n                \"values\": [\n                  {\n                    \"like\": 42\n                  }\n                ]\n              }\n            ],\n            \"type\": \"photo\",\n            \"post_id\": \"24225267232_10154099759037233\"\n          },\n          {\n            \"insights\": [\n              {\n                \"name\": \"post_impressions_organic_unique\",\n                \"values\": [\n                  {\n                    \"value\": 864\n                  }\n                ]\n              },\n              {\n                \"name\": \"post_stories_by_action_type\",\n                \"values\": [\n                  {\n                    \"like\": 19\n                  }\n                ]\n              }\n            ],\n            \"type\": \"photo\",\n            \"post_id\": \"24225267232_10154099756677233\"\n          }\n        ]\n      }\n    ]\n</code></pre>\n\n<p>I need to restructure/flatten it into something like this:</p>\n\n<pre><code>{\n    \"talent_id\": \"b520ad50-5302-45ce-9121-5ff42d67b4fb\",\n    \"platform\": \"facebook\",\n    \"posts\": [{\n        \"post_id\": \"24225267232_10154051404062233\",\n        \"type\": \"photo\",\n        \"organic_impressions_unique\": 8288,\n        \"post_story_actions_by_type\": {\n            \"shares\": 234,\n            \"comments\": 838,\n            \"likes\": 8768\n        }\n    }, {\n        \"post_id\": \"24225267232_10154051404062233\",\n        \"type\": \"photo\",\n        \"organic_impressions_unique\": 8288,\n        \"post_story_actions_by_type\": {\n            \"shares\": 234,\n            \"comments\": 838,\n            \"likes\": 8768\n        }\n    }]\n}\n</code></pre>\n\n<p>I am using a struct to map the JSON response:</p>\n\n<pre><code>type JsonData struct {\n    TalentID string `json:\"talent_id\"`\n    Platform string `json:\"platform\"`\n    Posts []struct {\n        PostID string `json:\"post_id\"`\n        Type string `json:\"type\"`\n        Insights []struct {\n            //Data []map[string]interface{}\n            Name   string `json:\"name\"`\n        } `json:\"insights\"`\n    } `json:\"posts\"`\n}\n</code></pre>\n\n<p>My problem is with the data inside the posts and how can I map it, I am using a map to fill the data and Marshal it to generate the new structure of JSON.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    messages := [] JsonData{}\n    json.Unmarshal(body, &amp;messages)\n\n    m := make(map[string]interface{})\n    m[\"talent_id\"] = messages[0].TalentID\n    m[\"platform\"] = messages[0].Platform\n\n    for _, p := range messages[0].Posts {\n\n        for _, i := range p.Insights {\n            // here is where I got lost and couldn't know how to fill the data inside the posts\n        }\n    }\n\n\n    jsonString, err := json.Marshal(m)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    fmt.Println(string(jsonString))\n</code></pre>\n\n<p>P.S. the metrics post_impressions_organic_unique and post_stories_by_action_type are not static, they can change or other keys might be returned here</p>\n"}, {"tags": ["windows", "gcc", "go", "mingw", "libiconv"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1487599250, "post_id": 42231030, "comment_id": 71844341, "body": "What packages are these that need <code>gcc</code>?"}, {"owner": {"reputation": 3379, "user_id": 4787510, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/0p1SM.jpg?s=128&g=1", "display_name": "Sossenbinder", "link": "https://stackoverflow.com/users/4787510/sossenbinder"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1487600967, "post_id": 42231030, "comment_id": 71845522, "body": "It&#39;s id3-go: <a href=\"https://github.com/mikkyang/id3-go\" rel=\"nofollow noreferrer\">github.com/mikkyang/id3-go</a>"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1487629081, "post_id": 42231030, "comment_id": 71861074, "body": "I don&#39;t see any use of compilation in that package."}, {"owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "edited": false, "score": 0, "creation_date": 1487646753, "post_id": 42231030, "comment_id": 71866694, "body": "I recommend vagrant for developing in windows."}, {"owner": {"reputation": 3379, "user_id": 4787510, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/0p1SM.jpg?s=128&g=1", "display_name": "Sossenbinder", "link": "https://stackoverflow.com/users/4787510/sossenbinder"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1487683224, "post_id": 42231030, "comment_id": 71886568, "body": "@eduncan911 Well, I don&#39;t know the interna, but thats what I end up with when trying to run my project in IntelliJ. I performed &quot;go get&quot; for the package beforehand."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 9331201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c35a200308368fc4a79199536a332d?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Garcia", "link": "https://stackoverflow.com/users/9331201/fernando-garcia"}, "edited": false, "score": 0, "creation_date": 1585253684, "post_id": 42457723, "comment_id": 107703610, "body": "Hi, I got exactly the issue mentioned on the main question, I followed your instructions but I&#39;m absolutely lost finding the proper location for the libivonv2.a file. Does anybody know how to find that proper location?"}, {"owner": {"reputation": 550, "user_id": 3534491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f39384bd883954aa9fd10b2c4d390c3?s=128&d=identicon&r=PG&f=1", "display_name": "Marduk", "link": "https://stackoverflow.com/users/3534491/marduk"}, "edited": false, "score": 0, "creation_date": 1609007731, "post_id": 42457723, "comment_id": 115729606, "body": "You can use <a href=\"https://www.voidtools.com/\" rel=\"nofollow noreferrer\">Everything</a> to locate the file."}], "tags": [], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "is_accepted": true, "score": 3, "last_activity_date": 1488035354, "creation_date": 1488035354, "answer_id": 42457723, "question_id": 42231030, "link": "https://stackoverflow.com/questions/42231030/how-can-i-install-a-go-package-with-mingw-which-depends-on-libiconv/42457723#42457723", "title": "How can I install a go package with MinGW which depends on libiconv", "body": "<p>I've met the same problem when I want to <code>go install github.com/google/gopacket</code> which need <code>CGO</code>. It's because your <code>libiconv2.a</code> is generated by other compiler, so it's incompatible with mingw32 compiler as the error message says. We need generate the static lib with the mingw32 toolset:</p>\n\n<ol>\n<li>find libiconv-2.dll(the coresonding dynamic library) in your PC</li>\n<li>run <code>gendef</code>(located in C:\\TDM-GCC-64\\x86_64-w64-mingw32\\bin in my 64-bit Windows ) on those files <code>gendef libiconv-2.dll</code>, this will generate libiconv2.def file</li>\n<li><p>Then generate the static library:</p>\n\n<p><code>dlltool --as-flags=--64 -m i386:x86-64 -k --output-lib libiconv2.a --input-def libiconv2.def</code></p></li>\n<li><p>copy libiconv2.a to proper location.</p></li>\n</ol>\n"}], "owner": {"reputation": 3379, "user_id": 4787510, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/0p1SM.jpg?s=128&g=1", "display_name": "Sossenbinder", "link": "https://stackoverflow.com/users/4787510/sossenbinder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1243, "favorite_count": 1, "accepted_answer_id": 42457723, "answer_count": 1, "score": 8, "last_activity_date": 1488035354, "creation_date": 1487088804, "last_edit_date": 1487784583, "question_id": 42231030, "link": "https://stackoverflow.com/questions/42231030/how-can-i-install-a-go-package-with-mingw-which-depends-on-libiconv", "title": "How can I install a go package with MinGW which depends on libiconv", "body": "<p>I am currently trying to set up a Go project, and considering I am running Windows, while the other 2 developers are working on a Mac, I have some trouble with installing a few packages.</p>\n\n<p>After trying to install the packages with cmd, I was only able to install 2 out of 4. The other two needed gcc.</p>\n\n<p>Therefore, I installed MinGW. I was able to install a third package that way, but now I am stuck on <a href=\"https://github.com/mikkyang/id3-go\" rel=\"noreferrer\">https://github.com/mikkyang/id3-go</a>.</p>\n\n<p>It seems to depend on another underlying project, <a href=\"https://github.com/djimenez/iconv-go\" rel=\"noreferrer\">https://github.com/djimenez/iconv-go</a>. The moment I try to <code>go install</code> id3-go, I am always left with this error:</p>\n\n<pre><code>src\\github.com\\djimenez\\iconv-go\\converter.go:8:19: fatal error: iconv.h: No such file or directory\n</code></pre>\n\n<p>Somehow, I need to use libiconv with MinGW, but I have no idea how to connect both parts. I'm not really an expert in that field, so any help would be appreciated a lot. I already downloaded libiconv for Windows. </p>\n\n<p>Related issue for additional information I found on the github project:\n<a href=\"https://github.com/mikkyang/id3-go/issues/21\" rel=\"noreferrer\">https://github.com/mikkyang/id3-go/issues/21</a></p>\n\n<p>EDIT: I made some progress on the whole problem. I now got all the files I need, but now I am stuck with this warning:</p>\n\n<pre><code># github.com/djimenez/iconv-go\nE:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -liconv\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n\n<p>I tried to add the libiconv2.a from my libiconv installation to the mingw32 lib folder, but then this is what I end up with:</p>\n\n<pre><code># github.com/djimenez/iconv-go\nE:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible E:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/lib/../lib/libiconv.a when searching for -liconv\nE:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible E:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/lib/../lib\\libiconv.a when searching for -liconv\nE:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible E:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/lib/libiconv.a when searching for -liconv\nE:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible E:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/lib\\libiconv.a when searching for -liconv\nE:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible E:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/lib/../lib/libiconv.a when searching for -liconv\nE:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible E:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/lib/libiconv.a when searching for -liconv\nE:/Tools/TDM-GCC/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -liconv\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n\n<p>I have no idea how to proceed from here.</p>\n"}, {"tags": ["go", "docker", "docker-compose"], "comments": [{"owner": {"reputation": 1963, "user_id": 2853439, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46524bf1c9cb5f680e137242b3a70836?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Jain", "link": "https://stackoverflow.com/users/2853439/prateek-jain"}, "edited": false, "score": 2, "creation_date": 1535883258, "post_id": 42230536, "comment_id": 91221696, "body": "export COMPOSE_HTTP_TIMEOUT=&lt;some_higher_value&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 1838, "user_id": 3692286, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/deAJz.jpg?s=128&g=1", "display_name": "jleeothon", "link": "https://stackoverflow.com/users/3692286/jleeothon"}, "edited": false, "score": 0, "creation_date": 1535888686, "post_id": 52135934, "comment_id": 91223030, "body": "One of those issues was open by me. In my case, it helped to increase the timeouts, and also to just not try to start too many containers at the same time in a machine that is not powerful enough for that."}, {"owner": {"reputation": 1788, "user_id": 1157720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe5sj.jpg?s=128&g=1", "display_name": "sajjadG", "link": "https://stackoverflow.com/users/1157720/sajjadg"}, "reply_to_user": {"reputation": 1838, "user_id": 3692286, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/deAJz.jpg?s=128&g=1", "display_name": "jleeothon", "link": "https://stackoverflow.com/users/3692286/jleeothon"}, "edited": false, "score": 1, "creation_date": 1535904670, "post_id": 52135934, "comment_id": 91227191, "body": "increasing the timeouts did not helped in my case due to low spec of my machine. You&#39;re right. it seems to be machine resource limitation. But I couldn&#39;t find anything related to the amount of resources for each container! Thanks @jleeothon for your comment."}, {"owner": {"reputation": 1838, "user_id": 3692286, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/deAJz.jpg?s=128&g=1", "display_name": "jleeothon", "link": "https://stackoverflow.com/users/3692286/jleeothon"}, "edited": false, "score": 2, "creation_date": 1536178154, "post_id": 52135934, "comment_id": 91335168, "body": "Something else my team did was to make a script that starts a batch of containers, waited for them to be healthy, and then started another batch of containers, and so on. That way the computer was not overwhelmed by all the operations that ran during startup."}, {"owner": {"reputation": 166, "user_id": 3995268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa536773c4e4effcac610f3250f9551c?s=128&d=identicon&r=PG&f=1", "display_name": "yash", "link": "https://stackoverflow.com/users/3995268/yash"}, "edited": false, "score": 2, "creation_date": 1586199145, "post_id": 52135934, "comment_id": 108035871, "body": "Well, i have 2 F series 64 core vms on Azure and i&#39;m still facing the same issue on both of them. Increasing the timeout doesn&#39;t help. Restarting docker does."}], "tags": [], "owner": {"reputation": 1788, "user_id": 1157720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe5sj.jpg?s=128&g=1", "display_name": "sajjadG", "link": "https://stackoverflow.com/users/1157720/sajjadg"}, "is_accepted": true, "score": 30, "last_activity_date": 1535882827, "creation_date": 1535882827, "answer_id": 52135934, "question_id": 42230536, "link": "https://stackoverflow.com/questions/42230536/docker-compose-up-times-out-with-unixhttpconnectionpool/52135934#52135934", "title": "`docker-compose up` times out with UnixHTTPConnectionPool", "body": "<p>Restarting docker service:</p>\n\n<pre><code>sudo systemctl restart docker\n</code></pre>\n\n<p>and setting <code>DOCKER_CLIENT_TIMEOUT</code> and <code>COMPOSE_HTTP_TIMEOUT</code> environment variables:</p>\n\n<pre><code>export DOCKER_CLIENT_TIMEOUT=120\nexport COMPOSE_HTTP_TIMEOUT=120\n</code></pre>\n\n<p>are two workarounds for now. But the issues are still open in docker compose github:</p>\n\n<p><a href=\"https://github.com/docker/compose/issues/3927\" rel=\"noreferrer\">https://github.com/docker/compose/issues/3927</a></p>\n\n<p><a href=\"https://github.com/docker/compose/issues/4486\" rel=\"noreferrer\">https://github.com/docker/compose/issues/4486</a></p>\n\n<p><a href=\"https://github.com/docker/compose/issues/3834\" rel=\"noreferrer\">https://github.com/docker/compose/issues/3834</a></p>\n"}, {"comments": [{"owner": {"reputation": 6969, "user_id": 1883256, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/uZVmH.png?s=128&g=1", "display_name": "Pathros", "link": "https://stackoverflow.com/users/1883256/pathros"}, "edited": false, "score": 0, "creation_date": 1605558549, "post_id": 63521316, "comment_id": 114682037, "body": "This worked for me, but first I restarted the docker service <code>$ sudo systemctl restart docker</code>, just like @yash suggests. Then: <code>$ sudo docker-compose down</code> and finally <code>$ sudo docker-compose up -d</code>."}], "tags": [], "owner": {"reputation": 71, "user_id": 11903694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41dc2dabdc1a0213354cb8d34a17bfd5?s=128&d=identicon&r=PG&f=1", "display_name": "Srihitha_30", "link": "https://stackoverflow.com/users/11903694/srihitha-30"}, "is_accepted": false, "score": 7, "last_activity_date": 1598006601, "creation_date": 1598006601, "answer_id": 63521316, "question_id": 42230536, "link": "https://stackoverflow.com/questions/42230536/docker-compose-up-times-out-with-unixhttpconnectionpool/63521316#63521316", "title": "`docker-compose up` times out with UnixHTTPConnectionPool", "body": "<pre><code>docker-compose down\n</code></pre>\n<p>Running <code>docker-compose down</code> and then running <code>docker-compose up --build</code> may work. I am working on vscode and when I encountered a similar problem while building docker, this solution worked for me.</p>\n<p>Before performing above mentioned command its better you refer to <a href=\"https://docs.docker.com/compose/reference/down/#:%7E:text=Stops%20containers%20and%20removes%20containers,defined%20in%20the%20Compose%20file\" rel=\"noreferrer\">what is the purpose of docker-compose down</a></p>\n"}, {"tags": [], "owner": {"reputation": 1756, "user_id": 4382528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7934e4513a44e0b0f0b138ace19ac8?s=128&d=identicon&r=PG", "display_name": "Yoruba", "link": "https://stackoverflow.com/users/4382528/yoruba"}, "is_accepted": false, "score": 2, "last_activity_date": 1612521091, "creation_date": 1612521091, "answer_id": 66061624, "question_id": 42230536, "link": "https://stackoverflow.com/questions/42230536/docker-compose-up-times-out-with-unixhttpconnectionpool/66061624#66061624", "title": "`docker-compose up` times out with UnixHTTPConnectionPool", "body": "<p>I had the same problem. It was solved after change the max-file size value from a number to a string.</p>\n<p>Wrong config</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>logging:\n options:\n       max-file: 10\n       max-size: 10m\n</code></pre>\n<p>Correct config</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>logging:\n options:\n       max-file: &quot;10&quot;\n       max-size: 10m\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 247, "user_id": 3432169, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6XNb6.jpg?s=128&g=1", "display_name": "yido", "link": "https://stackoverflow.com/users/3432169/yido"}, "is_accepted": false, "score": 0, "last_activity_date": 1614960065, "creation_date": 1614960065, "answer_id": 66495735, "question_id": 42230536, "link": "https://stackoverflow.com/questions/42230536/docker-compose-up-times-out-with-unixhttpconnectionpool/66495735#66495735", "title": "`docker-compose up` times out with UnixHTTPConnectionPool", "body": "<pre><code>docker-compose restart\n</code></pre>\n<p>Fixed my issue. This will restart all stopped and running services.</p>\n"}], "owner": {"reputation": 1838, "user_id": 3692286, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/deAJz.jpg?s=128&g=1", "display_name": "jleeothon", "link": "https://stackoverflow.com/users/3692286/jleeothon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24360, "favorite_count": 4, "accepted_answer_id": 52135934, "answer_count": 4, "score": 27, "last_activity_date": 1614960065, "creation_date": 1487087432, "last_edit_date": 1487150326, "question_id": 42230536, "link": "https://stackoverflow.com/questions/42230536/docker-compose-up-times-out-with-unixhttpconnectionpool", "title": "`docker-compose up` times out with UnixHTTPConnectionPool", "body": "<p>In our Jenkins agents we are running about several (around 20) tests whose setup involves running <code>docker-compose up</code> for a \"big\" number of services/containers (around 14).</p>\n\n<p>From time to time, I'll get the following error:</p>\n\n<pre><code>ERROR: for testdb-data  UnixHTTPConnectionPool(host='localhost', port=None): Read timed out. (read timeout=60)\nAn HTTP request took too long to complete. Retry with --verbose to obtain debug information.\nIf you encounter this issue regularly because of slow network conditions, consider setting COMPOSE_HTTP_TIMEOUT to a higher value (current value: 60).\n</code></pre>\n\n<p>Haven't been able to reproduce this consistently. And I'm still trying to figure out whether or not there is a correlation with our agent's resources being at full use.</p>\n\n<p><code>docker -v</code> is <code>1.10.1</code> and <code>docker-compose -v</code> is <code>1.13.1</code>.</p>\n\n<p>Any ideas about what this may be related to?</p>\n"}, {"tags": ["go", "gorilla", "negroni"], "answers": [{"comments": [{"owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "edited": false, "score": 0, "creation_date": 1487096069, "post_id": 42231276, "comment_id": 71626246, "body": "Please use the longer version of type conversion <code>(domain, ok := req.Context().Value(...)</code>    It will save you a lot of headaches if there is an issue like the value never being set. I would also use custom getters/setters for context values and unexported keys. All of which are safer in practice and not much more code."}], "tags": [], "owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "is_accepted": false, "score": 1, "last_activity_date": 1487098206, "last_edit_date": 1487098206, "creation_date": 1487089624, "answer_id": 42231276, "question_id": 42229594, "link": "https://stackoverflow.com/questions/42229594/request-context-set-in-negroni-middleware-is-lost-in-nested-gorilla-subrouter/42231276#42231276", "title": "Request context set in negroni middleware is lost in nested gorilla Subrouter", "body": "<p>I ended up using <code>Go 1.7</code>'s built in <code>Context</code>:</p>\n\n<pre><code>context.Set(req, helperKeys.DomainName, \"some-value\")\n\n// Replaced with:\n\nctx := req.Context()\nctx = context.WithValue(ctx, helperKeys.DomainName, \"some-value\")\nreq = req.WithContext(ctx)\n</code></pre>\n\n<p>AND</p>\n\n<pre><code>domain := context.Get(req, helperKeys.DomainName)\n\n// Replaced with:\n\ndomain := req.Context().Value(helperKeys.DomainName).(string)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1487098123, "post_id": 42233545, "comment_id": 71627330, "body": "Hey thanks for the heads up, but I&#39;m not actually storing the DB, I&#39;m just storing a copy of the connection session to the database. I connect to the database in the main function and only store a copy of the session in each request&#39;s context"}, {"owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "reply_to_user": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1487098857, "post_id": 42233545, "comment_id": 71627725, "body": "That is still generally frowned upon - a copy of the DB connection isn&#39;t specific to the request at all and could just as easily be accessed via the first approach I showed here, which is much safer in the long term.  What <i>might</i> be more kosher is storing say a transaction created from the DB connection, and that transaction will only live as long as the request is alive.   That said, I get the desire to do this to speed things up. I just figured I&#39;d let you know that there are better ways to handle this as your app grows that are easier to maintain and debug."}], "tags": [], "owner": {"reputation": 1338, "user_id": 1209538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1777de319efe52999139231273746dc9?s=128&d=identicon&r=PG", "display_name": "joncalhoun", "link": "https://stackoverflow.com/users/1209538/joncalhoun"}, "is_accepted": false, "score": 0, "last_activity_date": 1487096627, "creation_date": 1487096627, "answer_id": 42233545, "question_id": 42229594, "link": "https://stackoverflow.com/questions/42229594/request-context-set-in-negroni-middleware-is-lost-in-nested-gorilla-subrouter/42233545#42233545", "title": "Request context set in negroni middleware is lost in nested gorilla Subrouter", "body": "<p>Based on your answer, it looks like you are trying to store a database in the context. I wouldn't suggest doing that. Instead try something like this:</p>\n\n<pre><code>type Something struct {\n  DB *sql.DB // or some other DB object\n}\n\nfunc (s *Something) CreateUser(w http.ResponseWriter, r *http.Request) {\n  // use s.DB to access the database\n  fmt.Fprintln(w, \"Created a user...\")\n}\n\nfunc main() {\n  db := ...\n  s := Something{db}\n  http.HandleFunc(\"/\", s.CreateUser)\n  // ... everything else is pretty much like normal.\n}\n</code></pre>\n\n<p>This gives your handlers access to the database while not having to set it on the context every single time. Context values should be reserved for things that you can't possibly set until runtime. For example, a request ID that is specific to that web request. Things that outlive the request don't typically fall into this category, and your DB connection will outlive the request.</p>\n\n<p>If you do actually need context values, you should:</p>\n\n<ol>\n<li>Use getters and setters that are typed</li>\n<li>\"packages should define keys as an unexported type to avoid collisions.\" - <a href=\"https://github.com/golang/net/blob/236b8f043b920452504e263bc21d354427127473/context/context.go#L100\" rel=\"nofollow noreferrer\">From the Go source code</a></li>\n</ol>\n\n<p>An example of this is shown below, and I talk more about context values in general in <a href=\"https://www.calhoun.io/pitfalls-of-context-values-and-how-to-avoid-or-mitigate-them/\" rel=\"nofollow noreferrer\">this blog post</a>:</p>\n\n<pre><code>type userCtxKeyType string\n\nconst userCtxKey userCtxKeyType = \"user\"\n\nfunc WithUser(ctx context.Context, user *User) context.Context {  \n  return context.WithValue(ctx, userCtxKey, user)\n}\n\nfunc GetUser(ctx context.Context) *User {  \n  user, ok := ctx.Value(userCtxKey).(*User)\n  if !ok {\n    // Log this issue\n    return nil\n  }\n  return user\n}\n</code></pre>\n"}], "owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1487098206, "creation_date": 1487084961, "question_id": 42229594, "link": "https://stackoverflow.com/questions/42229594/request-context-set-in-negroni-middleware-is-lost-in-nested-gorilla-subrouter", "title": "Request context set in negroni middleware is lost in nested gorilla Subrouter", "body": "<p>My basic <code>main</code> setup:</p>\n\n<pre><code>muxRouter := mux.NewRouter()\n\nv1Router.Router(muxRouter.PathPrefix(\"/v1\").Subrouter())\n\nhttp.Handle(\"/\", muxRouter)\n\n\nn := negroni.Classic()\nn.Use(negroni.HandlerFunc(apiRouter.Middleware))\nn.UseHandler(muxRouter)\n\ns := &amp;http.Server{\n    Addr:           \":6060\",\n    Handler:        n,\n    ReadTimeout:    10 * time.Second,\n    WriteTimeout:   10 * time.Second,\n    MaxHeaderBytes: 1 &lt;&lt; 20,\n}\nlog.Fatal(s.ListenAndServe())\n</code></pre>\n\n<p>Inside the <code>apiRouter.Middleware</code> I have set the following context:</p>\n\n<pre><code>context.Set(req, helperKeys.DomainName, \"some-value\")\n</code></pre>\n\n<p>However, in some handlerFunc within <code>v1Router.Router</code> when trying to <code>Get</code> the context's value, the result is nil:</p>\n\n<pre><code>domain := context.Get(req, helperKeys.DomainName)\nfmt.Println(\"DomainName\", domain)\n</code></pre>\n\n<p>Prints: <code>DomainName &lt;nil&gt;</code></p>\n\n<p>I know that the <code>Set</code> method is correct as getting the value immediately after setting it in the <code>apiRouter.Middleware</code> will return the correct string value.</p>\n"}, {"tags": ["go", "runtime"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1487084311, "post_id": 42227934, "comment_id": 71618091, "body": "Can you provide a link to the code you&#39;re reviewing?  Perhaps it&#39;s Cgo?"}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 5776961, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72a07720ad60d5d21fe66561f767429c?s=128&d=identicon&r=PG&f=1", "display_name": "wangzhe", "link": "https://stackoverflow.com/users/5776961/wangzhe"}, "edited": false, "score": 0, "creation_date": 1487132729, "post_id": 42230230, "comment_id": 71640308, "body": "Thanks for your answer, it helps me a lot ! But how to get more details about the execution of this function when it is processed by compiler?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 5, "last_activity_date": 1487088951, "last_edit_date": 1487088951, "creation_date": 1487086665, "answer_id": 42230230, "question_id": 42227934, "link": "https://stackoverflow.com/questions/42227934/how-to-get-g-in-golang-mpg-model/42230230#42230230", "title": "how to get g in golang MPG model", "body": "<p>See <a href=\"https://stackoverflow.com/questions/14189606/function-signature-with-no-function-body\">Function signature with no function body</a>, and the specification for <a href=\"https://golang.org/ref/spec#Function_declarations\" rel=\"nofollow noreferrer\">Function Declarations</a>.</p>\n\n<p>In the case of <code>runtime.getg</code> the code is directly emitted by the compiler. </p>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 5776961, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72a07720ad60d5d21fe66561f767429c?s=128&d=identicon&r=PG&f=1", "display_name": "wangzhe", "link": "https://stackoverflow.com/users/5776961/wangzhe"}, "edited": false, "score": 0, "creation_date": 1487246807, "post_id": 42251170, "comment_id": 71703001, "body": "Thank you for your answer, it really helps me a lot !"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1487166458, "creation_date": 1487166458, "answer_id": 42251170, "question_id": 42227934, "link": "https://stackoverflow.com/questions/42227934/how-to-get-g-in-golang-mpg-model/42251170#42251170", "title": "how to get g in golang MPG model", "body": "<p>It's not being executed&mdash;exactly because, as stated in the comment</p>\n\n<blockquote>\n  <p>The compiler rewrites calls to this function into instructions\n  that fetch the <code>g</code> directly (from TLS or from the dedicated register).</p>\n</blockquote>\n\n<p>As you can obtain yourself via something like</p>\n\n<pre><code>grep -rFw getg /usr/share/go-1.7/src/\n</code></pre>\n\n<p>the code which is emitted when the compiler sees a call to <code>runtime.getg()</code>\nis architecture-dependent and is located in the files</p>\n\n<pre><code>{src}/src/cmd/compile/internal/{arch}/ggen.go\n</code></pre>\n\n<p>(for Go 1.7)&mdash;where <code>{src}</code> is the source directory of your Go code\nand <code>{arch}</code> is an architecture-specific directory.</p>\n\n<p>Say, for <code>amd64</code>, it's <code>{src}/cmd/compile/internal/amd64/ggen.go</code>.</p>\n"}], "owner": {"reputation": 313, "user_id": 5776961, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72a07720ad60d5d21fe66561f767429c?s=128&d=identicon&r=PG&f=1", "display_name": "wangzhe", "link": "https://stackoverflow.com/users/5776961/wangzhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1487166458, "creation_date": 1487080291, "last_edit_date": 1487081350, "question_id": 42227934, "link": "https://stackoverflow.com/questions/42227934/how-to-get-g-in-golang-mpg-model", "title": "how to get g in golang MPG model", "body": "<p>I'm reading some runtime of code of golang(go1.6.2 linux/amd64), Could someone help me to understand the underlying mechanism of getg() function in runtime/stubs.go file?</p>\n\n<pre><code>// getg returns the pointer to the current g.\n// The compiler rewrites calls to this function into instructions\n// that fetch the g directly (from TLS or from the dedicated register).\nfunc getg() *g\n</code></pre>\n\n<p>how do the getg() function operate here? What is the body of this function?</p>\n"}, {"tags": ["http", "go", "httpwebrequest"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1487078554, "post_id": 42226947, "comment_id": 71613958, "body": "&quot;but when the URL is down, it [http.Get] generates a panic call&quot;. No it doesn&#39;t."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1487084352, "post_id": 42226947, "comment_id": 71618120, "body": "You want to know if something is listening for TCP connections on a given port,or you want to know if a web server is running there, and will serve a given URL?"}, {"owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1487089435, "post_id": 42226947, "comment_id": 71621933, "body": "@Volker You&#39;re right, sorry about that. This is the first time I&#39;m having a go at Go. I removed that detail from my question."}], "answers": [{"tags": [], "owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "is_accepted": true, "score": 18, "last_activity_date": 1589624454, "last_edit_date": 1589624454, "creation_date": 1487077989, "answer_id": 42227115, "question_id": 42226947, "link": "https://stackoverflow.com/questions/42226947/check-if-a-url-is-reachable-using-golang/42227115#42227115", "title": "Check if a URL is reachable using Golang", "body": "<p>If you only want see if a URL is reachable you could use <a href=\"https://godoc.org/net#DialTimeout\" rel=\"nofollow noreferrer\">net.DialTimeout</a>. Like this:  </p>\n\n<pre><code>timeout := 1 * time.Second\nconn, err := net.DialTimeout(\"tcp\",\"mysyte:myport\", timeout)\nif err != nil {\n    log.Println(\"Site unreachable, error: \", err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 890, "user_id": 3364249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQltG.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3364249/marco"}, "is_accepted": false, "score": 10, "last_activity_date": 1487092652, "creation_date": 1487092652, "answer_id": 42232301, "question_id": 42226947, "link": "https://stackoverflow.com/questions/42226947/check-if-a-url-is-reachable-using-golang/42232301#42232301", "title": "Check if a URL is reachable using Golang", "body": "<p>If you want to check if a Web server answers on a certain URL, you can invoke an HTTP GET request using <a href=\"https://golang.org/pkg/net/http/#Client.Get\" rel=\"noreferrer\">net/http</a>.\nYou will get a timeout if the server doesn't response at all. You might also check the response status.</p>\n\n<pre><code>resp, err := http.Get(\"http://google.com/\")\nif err != nil {\n    print(err.Error())\n} else {\n    print(string(resp.StatusCode) + resp.Status)\n}\n</code></pre>\n\n<p>You can change the default timeout by initializing a http.Client.</p>\n\n<pre><code>timeout := time.Duration(1 * time.Second)\nclient := http.Client{\n    Timeout: timeout,\n}\nresp, err := client.Get(\"http://google.com\")\n</code></pre>\n\n<p><strong>Bonus</strong>:\nGo generally does not rely on exceptions and the built in libraries generally do not panic, but return an error as a second value.\nSee <a href=\"https://golang.org/doc/faq#exceptions\" rel=\"noreferrer\">Why does Go not have exceptions?</a>.\nYou can assume that something very bad happened if your call to a native function panics.</p>\n"}, {"tags": [], "owner": {"reputation": 328, "user_id": 4620617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b957d55c0087b0f563ba37f9fab29061?s=128&d=identicon&r=PG", "display_name": "Alberto Salvia Novella", "link": "https://stackoverflow.com/users/4620617/alberto-salvia-novella"}, "is_accepted": false, "score": 2, "last_activity_date": 1571788734, "last_edit_date": 1571788734, "creation_date": 1571784082, "answer_id": 58513193, "question_id": 42226947, "link": "https://stackoverflow.com/questions/42226947/check-if-a-url-is-reachable-using-golang/58513193#58513193", "title": "Check if a URL is reachable using Golang", "body": "<p>If you don't mind the port, use <strong>http.Get(web)</strong>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n)\n\nfunc main() {\n    web := os.Args[1]\n    fmt.Println(webIsReachable(web))\n}\n\nfunc webIsReachable(web string) bool {\n    response, errors := http.Get(web)\n\n    if errors != nil {\n        _, netErrors := http.Get(\"https://www.google.com\")\n\n        if netErrors != nil {\n            fmt.Fprintf(os.Stderr, \"no internet\\n\")\n            os.Exit(1)\n        }\n\n        return false\n    }\n\n    if response.StatusCode == 200 {\n        return true\n    }\n\n    return false\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1618782275, "creation_date": 1618782275, "answer_id": 67153659, "question_id": 42226947, "link": "https://stackoverflow.com/questions/42226947/check-if-a-url-is-reachable-using-golang/67153659#67153659", "title": "Check if a URL is reachable using Golang", "body": "<p>You can make a HEAD request:</p>\n<pre><code>package main\nimport &quot;net/http&quot;\n\nfunc head(s string) bool {\n   r, e := http.Head(s)\n   return e == nil &amp;&amp; r.StatusCode == 200\n}\n\nfunc main() {\n   b := head(&quot;https://stackoverflow.com&quot;)\n   println(b)\n}\n</code></pre>\n<p><a href=\"https://golang.org/pkg/net/http#Head\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http#Head</a></p>\n"}], "owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10814, "favorite_count": 4, "accepted_answer_id": 42227115, "answer_count": 4, "score": 10, "last_activity_date": 1618782275, "creation_date": 1487077449, "last_edit_date": 1487089282, "question_id": 42226947, "link": "https://stackoverflow.com/questions/42226947/check-if-a-url-is-reachable-using-golang", "title": "Check if a URL is reachable using Golang", "body": "<p>I want to create a simple script that checks if a certain hostname:port is running. I only want to get a <code>bool</code> response if that URL is live, but I'm not sure if there's a straightforward way of doing it.</p>\n"}, {"tags": ["json", "go", "marshalling"], "comments": [{"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "edited": false, "score": 0, "creation_date": 1487075296, "post_id": 42226157, "comment_id": 71611900, "body": "The json is valid?"}, {"owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1487137134, "post_id": 42226157, "comment_id": 71641594, "body": "@Flimzy added code for reproducing the error"}], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "is_accepted": true, "score": 7, "last_activity_date": 1487077606, "creation_date": 1487077606, "answer_id": 42226994, "question_id": 42226157, "link": "https://stackoverflow.com/questions/42226157/json-error-calling-marshaljson-for-type-json-rawmessage/42226994#42226994", "title": "Json error calling MarshalJSON for type json.RawMessage", "body": "<p>Fixed by making <code>Chart.Data</code> a pointer</p>\n\n<pre><code> Data        *json.RawMessage `json:\"data,ommitempty\"`\n</code></pre>\n\n<p>Go 1.8 (currently rc3 as of writing) will correctly handle Marshalling of both a pointer and non-pointer json.RawMessage.</p>\n\n<p>Fixing commit: <a href=\"https://github.com/golang/go/commit/1625da24106b610f89ff7a67a11581df95f8e234\" rel=\"noreferrer\">https://github.com/golang/go/commit/1625da24106b610f89ff7a67a11581df95f8e234</a></p>\n"}], "owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3219, "favorite_count": 2, "accepted_answer_id": 42226994, "answer_count": 1, "score": 4, "last_activity_date": 1487139977, "creation_date": 1487075185, "last_edit_date": 1487139977, "question_id": 42226157, "link": "https://stackoverflow.com/questions/42226157/json-error-calling-marshaljson-for-type-json-rawmessage", "title": "Json error calling MarshalJSON for type json.RawMessage", "body": "<p>I am getting following error while trying to marshal this struct</p>\n\n<blockquote>\n  <p>json: error calling MarshalJSON for type json.RawMessage: unexpected\n  end of JSON input</p>\n</blockquote>\n\n<p>for the object of below struct  </p>\n\n<pre><code>type Chart struct {\n    ID          int             `json:\"id,omitempty\" db:\"id\"`\n    Name        string          `json:\"name,omitempty\" db:\"name\"`\n    Type        string          `json:\"type,omitempty\" db:\"type\"`\n    DashboardID int             `json:\"dashboard_id,omitempty\"`\n    SourceType  string          `json:\"source_type,omitempty\" db:\"source_type\"`\n    Data        json.RawMessage `json:\"graph_data,ommitempty\"`\n}\n\nfunc main() {\n    chart := Chart{}\n    chart.ID = 1\n    chart.Name = \"Jishnu\"\n    str, err := json.Marshal(chart)\n    fmt.Println(err)\n}\n</code></pre>\n"}, {"tags": ["php", "sockets", "go", "rpc"], "answers": [{"comments": [{"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 0, "creation_date": 1487075748, "post_id": 42225709, "comment_id": 71612218, "body": "Yes we are using RabbitMQ, but I just get it now it have an RPC support, is this performance is good?"}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "reply_to_user": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 0, "creation_date": 1487077576, "post_id": 42225709, "comment_id": 71613348, "body": "RabbitMQ is only a message broker but you can use as RPC by creating a channel, listening for that and sending messages encoded in some format (the most easier in both language is json)"}], "tags": [], "owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "is_accepted": true, "score": 2, "last_activity_date": 1487145569, "last_edit_date": 1487145569, "creation_date": 1487073833, "answer_id": 42225709, "question_id": 42225361, "link": "https://stackoverflow.com/questions/42225361/call-go-rpc-socket-methods-in-php/42225709#42225709", "title": "Call Go RPC socket methods in PHP", "body": "<p>The Go rpc default implementation <code>net/rpc</code> use a particular encoding specific for Go struct called <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">Gob</a>. Far as I know there isn't a implementation of encoding/deconding Gob for PHP and for this reason you will not able to call an rpc golang server from PHP.<br>\nThe alternatives are: use grpc (yes, it use proto buffer but is not to difficult and since proto buffer 3 there new type of object) or use a message broker such as <a href=\"http://zeromq.org\" rel=\"nofollow noreferrer\">ZeroMQ</a> or <a href=\"https://www.rabbitmq.com\" rel=\"nofollow noreferrer\">RabbitMQ</a> (if you are beginner on both I suggest RabbitMQ since it's more easier to learn).</p>\n"}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 42225709, "answer_count": 1, "score": 3, "last_activity_date": 1491011777, "creation_date": 1487072850, "last_edit_date": 1491011777, "question_id": 42225361, "link": "https://stackoverflow.com/questions/42225361/call-go-rpc-socket-methods-in-php", "title": "Call Go RPC socket methods in PHP", "body": "<p>I started looking for RPC frameworks and I found the gRPC, but my problem it uses the Protocol-Buffer and I'm afraid if I want to use it in my current monolithic PHP application it will be a big mess. So, I started to implement a Go basic RPC service but currently I don't have any idea what and how to use it in PHP. </p>\n\n<p>So basically I have a databasemanager package where I have these struct and methods: </p>\n\n<pre><code>type DatabaseManager struct {\n    Database *gorm.DB\n    Log      logging.Logger\n}\n\nfunc (db *DatabaseManager) Last(args *string, reply *string) error {\n\n    db.Log[logging.INFO].Printf(\"%v\", *args)\n    reply = args\n    db.Log[logging.INFO].Printf(\"%v\", *reply)\n    return nil\n}\n</code></pre>\n\n<p>And I'm using a command which starts the server for listening:</p>\n\n<pre><code>func registerDatabaseManager(server *rpc.Server, dbManager *databasemanager.DatabaseManager) {\n    server.RegisterName(\"DatabaseManager\", dbManager)\n}\n\nfunc RunRPC(path string) error {\n    db, _, log := dependencyInjection(path)\n    dbManager := &amp;databasemanager.DatabaseManager{\n        Database: db,\n        Log:      log,\n    }\n    server := rpc.NewServer()\n    registerDatabaseManager(server, dbManager)\n    listen, err := net.Listen(\"tcp\", \":50051\")\n    if err != nil {\n        log[logging.ERROR].Print(err)\n    }\n    log[logging.INFO].Print(\"Server started - listening on :50051\")\n    server.Accept(listen)\n    return nil\n}\n</code></pre>\n\n<p>So basically it is using a very basic approach. The request and response format will be JSON because most of the time it will handle big amounts of data. </p>\n\n<p>The client in Golang is looks like: </p>\n\n<pre><code>type DBManager struct {\n    client *rpc.Client\n}\n\nfunc (t *DBManager) Last(args *string) string {\n    *args = \"awesome test\"\n    var reply string\n    err := t.client.Call(\"DatabaseManager.Last\", args, &amp;reply)\n    if err != nil {\n        log.Fatal(\"arith error:\", err)\n    }\n    return reply\n}\n\nfunc main() {\n    conn, err := net.Dial(\"tcp\", \"localhost:50051\")\n    if err != nil {log.Fatal(\"Connectiong:\", err)}\n    dbManager := &amp;DBManager{client: rpc.NewClient(conn)}\n    asd := \"asdasqwesaf\"\n    fmt.Println(dbManager.Last(&amp;asd))\n}\n</code></pre>\n\n<p>It is working nicely and I can use it but had mentioned I have an old monolitic PHP where I want to use the methods there too. </p>\n\n<p>I found <a href=\"https://gist.github.com/ccirello/11376473\" rel=\"nofollow noreferrer\">this</a> on the internet, which is to implement the same what I want, but the problem I tried to rewrite it for my needs, but it's not working. Basically I just changed the callRPC params as the following:</p>\n\n<pre><code>$result = callRPC(\n    \"tcp://127.0.0.1:50051\",\n    [\n        '{\"method\":\"DatabaseManager.Last\",\"params\":[\"asd\"],\"id\":0}',\n    ],\n    1,\n    8\n); \n</code></pre>\n\n<p>I don't know, am I following a good approach? Or not? Maybe someone can show me a better solution. </p>\n"}, {"tags": ["go", "govendor"], "answers": [{"tags": [], "owner": {"reputation": 696, "user_id": 1856086, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/edb72c51ff89eddf7e9d7a274cfd81fe?s=128&d=identicon&r=PG&f=1", "display_name": "Stas Makarov", "link": "https://stackoverflow.com/users/1856086/stas-makarov"}, "is_accepted": false, "score": 2, "last_activity_date": 1487076034, "creation_date": 1487076034, "answer_id": 42226466, "question_id": 42224603, "link": "https://stackoverflow.com/questions/42224603/set-specific-commit-of-a-dependency-with-govendor/42226466#42226466", "title": "Set specific commit of a dependency with govendor", "body": "<p>I got help from @jbrandhorst in go slack: </p>\n\n<blockquote>\n  <p>you'll want to remove the old one as well, <code>govendor remove gopkg.in/h2non/bimg.v1</code></p>\n  \n  <p>[3:16]   source repo appears to be <code>github.com/h2non/bimg</code>, so\n  <code>govendor fetch github.com/h2non/bimg</code> will install it to your vendor\n  folder</p>\n  \n  <p>[3:16]   if you just want to add it to your <code>vendor.json</code>, you use\n  <code>govendor add</code> I think</p>\n</blockquote>\n"}], "owner": {"reputation": 696, "user_id": 1856086, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/edb72c51ff89eddf7e9d7a274cfd81fe?s=128&d=identicon&r=PG&f=1", "display_name": "Stas Makarov", "link": "https://stackoverflow.com/users/1856086/stas-makarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1487076034, "creation_date": 1487070567, "question_id": 42224603, "link": "https://stackoverflow.com/questions/42224603/set-specific-commit-of-a-dependency-with-govendor", "title": "Set specific commit of a dependency with govendor", "body": "<p>I'm using govendor for managing dependencies in a project. I have the following dependency in my <code>vendor/vendor.json</code>. </p>\n\n<pre><code>{\n...\n\"package\": [    \n    {...},\n    {\n        \"checksumSHA1\": \"8XAGmXqf+b4LW91wsWxa4kH1NN0=\",\n        \"path\": \"gopkg.in/h2non/bimg.v1\",\n        \"revision\": \"9bb3ae10c5ce30e72f7ac0834368536fc095d6a7\",\n        \"revisionTime\": \"2017-01-13T19:35:42Z\"\n    }\n],\n...\n</code></pre>\n\n<p>}</p>\n\n<p>Now I want to use master version of bimg package, which is newer than version 1.0.7 fetched by govendor. What is a proper way to achieve this, beside manually downloading master version from github and saving it to the vendor folder? </p>\n\n<p>ps: all dependencies are committed.</p>\n"}, {"tags": ["go", "connection", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1487068373, "post_id": 42223627, "comment_id": 71607308, "body": "In your 2nd answer you said <code>&quot;create a global variable that contains the database connection&quot;</code>, but this would limit me to connecting to 1 database at a time only, right? Can I do the same by creating a global slice variable containing multiple connections and close all of them when the app dies?"}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "reply_to_user": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1487069383, "post_id": 42223627, "comment_id": 71608034, "body": "It depends: mainly because with dial you can connect to multiple host at time and then you can change the Mongo database by using the <a href=\"https://godoc.org/labix.org/v2/mgo#Session.DB\" rel=\"nofollow noreferrer\">DB function</a> for changing the database. It&#39;s up to you. But, imho, it&#39;s more cleaner a separate connection per each db. By doing this you can also split each db logic"}, {"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1487070092, "post_id": 42223627, "comment_id": 71608503, "body": "What do you mean by db logic? Every database have the same collections. Imagine you&#39;re replicating shopify or a similar service for SaaS website hosting / editor, whenever a new user registers and creates a website, we launch a new <code>docker</code> container for their &quot;dedicated&quot; website which has it&#39;s own <code>mongodb</code> server. We keep track of who owns each <code>docker</code> container and how to access them from our &quot;main&quot; <code>Go</code> server. So the difference is really only who can access which database from within the <code>main</code> <code>Go</code> server."}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "reply_to_user": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1487070350, "post_id": 42223627, "comment_id": 71608688, "body": "Not in all case same collections means same logic (maybe the query should be different). Anyway for this case you could try to create a global variable that is connected to more host, take a look <a href=\"https://www.goinggo.net/2014/02/running-queries-concurrently-against.html\" rel=\"nofollow noreferrer\">here</a>, it&#39;s well explained. And then if you see that the query are slow you can always add a connections mongoldb slice"}, {"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1487074726, "post_id": 42223627, "comment_id": 71611531, "body": "Thanks for your help. I&#39;ll do some research on this and try to come up with the best solution for my app"}, {"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1487090458, "post_id": 42223627, "comment_id": 71622648, "body": "I end up using the method I explained in the question&#39;s update. But thanks anyways"}], "tags": [], "owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "is_accepted": true, "score": 0, "last_activity_date": 1487076143, "last_edit_date": 1487076143, "creation_date": 1487067958, "answer_id": 42223627, "question_id": 42222797, "link": "https://stackoverflow.com/questions/42222797/managing-connections-per-request-in-go/42223627#42223627", "title": "Managing connections per request in Go", "body": "<p>Hypothetically speaking is not a good practice because:  </p>\n\n<ol>\n<li>The database logic is scattered among several packages.</li>\n<li>It's difficult to test</li>\n<li>You can't apply DI (mainly it will be hard to maintain the code)</li>\n</ol>\n\n<p>Replying to your questions:  </p>\n\n<ol>\n<li>Yes is feasible BUT you will not use the connection pool inside them go package (take a look to the code <a href=\"http://bazaar.launchpad.net/+branch/mgo/v2/view/head:/session.go#L195\" rel=\"nofollow noreferrer\">here</a> if you want know more about Connection Pool)</li>\n<li>A better way is to create a global variable that contains the database connection and close when the application is going to stop (and not close the connection every request)</li>\n<li>How do I ensure the session is only closed when the request has complete&lt;- you should checkout the answer fro your db query and then close the connection (but I don't recommend to close the connection after a request because you'll need to open again for another request and close again etc...)</li>\n</ol>\n"}], "owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 0, "accepted_answer_id": 42223627, "answer_count": 1, "score": 1, "last_activity_date": 1522328471, "creation_date": 1487065827, "last_edit_date": 1487091239, "question_id": 42222797, "link": "https://stackoverflow.com/questions/42222797/managing-connections-per-request-in-go", "title": "Managing connections per request in Go", "body": "<p>Hypothetically speaking, is it good practice to connect to a database for each request and close in when the request has completed?</p>\n\n<p>I'm using <code>mongodb</code> with <code>mgo</code> for the database.</p>\n\n<p>In my project, I would like to connect to a certain database by getting the database name from the request header (of course, this is combined with an authentication mechanism, e.g. JWT in my app). The flow goes something like:</p>\n\n<ol>\n<li><p>User authentication:</p>\n\n<pre><code>POST to http://api.app.com/authenticate\n// which checks the user in a \"global\" database,\n// authenticates them and returns a signed JWT token\n// The token is stored in bolt.db for the authentication mechanism\n</code></pre></li>\n<li><p>Some RESTful operations</p>\n\n<pre><code>POST to http://api.app.com/v1/blog/posts\n// JWT middleware for each request to /v1* is set up\n// `Client-Domain` in header is set to a database's name, e.g 'app-com'\n// so we open a connection to that database and close when\n// request finishes\n</code></pre></li>\n</ol>\n\n<p>So my questions are:</p>\n\n<ol>\n<li>Is this feasible? - I've read about connection pools and reusing them but I haven't read much about them yet</li>\n<li>Is there a better way of achieving the desired functionality?</li>\n<li>How do I ensure the session is only closed when the request has completed?</li>\n</ol>\n\n<p>The reason why I need to do this is because we have multiple vendors that have the same database collections with different entries with restricted access to their own databases.</p>\n\n<p><strong>Update / Solution</strong>\nI ended up using <code>Go</code>'s built in <code>Context</code> by Copying a session and using it anywhere I need to do any CRUD ops</p>\n\n<p>Something like:</p>\n\n<pre><code>func main() {\n    ...\n    // Configure connection and set in global var\n    model.DBSession, err = mgo.DialWithInfo(mongoDBDialInfo)\n    defer model.DBSession.Close()\n    ...\n\n    n := negroni.Classic()\n    n.Use(negroni.HandlerFunc(Middleware))\n\n    ...\n}\n\nfunc Middleware(res http.ResponseWriter, req *http.Request, next http.HandlerFunc) {\n\n    ...\n    db := NewDataStore(clientDomain)\n    // db.Close() is an alias for ds.session.Close(), code for this function is not included in this post\n    // Im still experimenting with this, I need to make sure the session is only closed after a request has completed, currently it does not always do so\n    defer db.Close()\n\n    ctx := req.Context()\n    ctx = context.WithValue(ctx, auth.DataStore, db)\n    req = req.WithContext(ctx)\n    ...\n}\n\nfunc NewDataStore(db string) *DataStore {\n    store := &amp;DataStore{\n        db: DBSession.Copy().DB(db),\n        session: DBSession.Copy(),\n    }\n    return store\n}\n</code></pre>\n\n<p>And then use it in a HandlerFunc, example <code>/v1/system/users</code>:</p>\n\n<pre><code>func getUsers(res http.ResponseWriter, req *http.Request) {\n    db := req.Context().Value(auth.DataStore).(*model.DataStore)\n    users := make([]SystemUser{}, 0)\n    // db.C() is an alias for ds.db.C(), code for this function is not included in this post\n    db.C(\"system_users\").Find(nil).All(&amp;users)\n}\n</code></pre>\n\n<p>40% response time decrease over the original method I experimented with.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "edited": false, "score": 1, "creation_date": 1487064418, "post_id": 42222235, "comment_id": 71604576, "body": "Share code, please."}], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 1, "last_activity_date": 1487065396, "creation_date": 1487065396, "answer_id": 42222648, "question_id": 42222235, "link": "https://stackoverflow.com/questions/42222235/how-to-decrypt-post-request-body-in-golang/42222648#42222648", "title": "How to decrypt POST request body in golang", "body": "<p>Your text has been <a href=\"https://en.wikipedia.org/wiki/Percent-encoding\" rel=\"nofollow noreferrer\">url encoded</a>. Probably because it was a query parameter ? </p>\n\n<p>What you can do is use the <a href=\"https://golang.org/pkg/net/url/#QueryUnescape\" rel=\"nofollow noreferrer\"><code>url.QueryUnescape</code></a> function to decode the value.</p>\n\n<pre><code>str := \"9oF0LS0aY0RGGfUEGoT%2FHSdqypxXKh7lmaTawlekrxw%3D\"\nstr, _ = url.QueryUnescape(str)\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 5449397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7CJrP.jpg?s=128&g=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/5449397/vicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 42222648, "answer_count": 1, "score": -1, "last_activity_date": 1487065427, "creation_date": 1487064336, "last_edit_date": 1487065427, "question_id": 42222235, "link": "https://stackoverflow.com/questions/42222235/how-to-decrypt-post-request-body-in-golang", "title": "How to decrypt POST request body in golang", "body": "<p>I am getting my request body value in encrypted form as below:</p>\n\n<p><code>9oF0LS0aY0RGGfUEGoT%2FHSdqypxXKh7lmaTawlekrxw%3D</code></p>\n\n<p>But the actual value I send is:</p>\n\n<p><code>9oF0LS0aY0RGGfUEGoT/HSdqypxXKh7lmaTawlekrxw=</code></p>\n\n<p>Any suggestion How I can get correct value.</p>\n"}, {"tags": ["ubuntu", "go", "tcp"], "comments": [{"owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1487064386, "post_id": 42222136, "comment_id": 71604559, "body": "2114 is a non-standard port, but syslog is usually udp rather than tcp excepting special config or tls.  Maybe syslog.Dial(&quot;udp&quot;, &quot;localhost:2114&quot;, syslog.LOG_ERR, &quot;testapi&quot;) ?  Unfortunately you will not get any err even if it not correct since udp is connectionless."}, {"owner": {"reputation": 12238, "user_id": 97926, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7CP1W.png?s=128&g=1", "display_name": "Jalpesh Vadgama", "link": "https://stackoverflow.com/users/97926/jalpesh-vadgama"}, "reply_to_user": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1487064696, "post_id": 42222136, "comment_id": 71604768, "body": "I have tried 5514 also but its not working!. What do you mean by non standard port?"}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1487064764, "post_id": 42222136, "comment_id": 71604822, "body": "You should post your syslog.conf"}, {"owner": {"reputation": 3265, "user_id": 2606938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7gIUB.jpg?s=128&g=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/2606938/prabhu"}, "edited": false, "score": 0, "creation_date": 1487065138, "post_id": 42222136, "comment_id": 71605068, "body": "Can you check if any process is bound to 2114?"}, {"owner": {"reputation": 12238, "user_id": 97926, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7CP1W.png?s=128&g=1", "display_name": "Jalpesh Vadgama", "link": "https://stackoverflow.com/users/97926/jalpesh-vadgama"}, "edited": false, "score": 0, "creation_date": 1487065274, "post_id": 42222136, "comment_id": 71605163, "body": "Added syslog.conf."}, {"owner": {"reputation": 12238, "user_id": 97926, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7CP1W.png?s=128&g=1", "display_name": "Jalpesh Vadgama", "link": "https://stackoverflow.com/users/97926/jalpesh-vadgama"}, "edited": false, "score": 0, "creation_date": 1487065321, "post_id": 42222136, "comment_id": 71605207, "body": "@Prabhu- I have checked with following command &#39;netstat -an|grep :2114&#39; and nothing attached."}, {"owner": {"reputation": 3265, "user_id": 2606938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7gIUB.jpg?s=128&g=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/2606938/prabhu"}, "edited": false, "score": 0, "creation_date": 1487066558, "post_id": 42222136, "comment_id": 71606029, "body": "And hence you are getting the <code>connection refused</code> error. I think Tinwor&#39;s answer below should be correct one to address the issue."}, {"owner": {"reputation": 12238, "user_id": 97926, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7CP1W.png?s=128&g=1", "display_name": "Jalpesh Vadgama", "link": "https://stackoverflow.com/users/97926/jalpesh-vadgama"}, "edited": false, "score": 0, "creation_date": 1487066762, "post_id": 42222136, "comment_id": 71606174, "body": "@Prabhu- checking that only!!"}], "answers": [{"comments": [{"owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1487066206, "post_id": 42222883, "comment_id": 71605820, "body": "udp 514 is the default ?"}, {"owner": {"reputation": 12238, "user_id": 97926, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7CP1W.png?s=128&g=1", "display_name": "Jalpesh Vadgama", "link": "https://stackoverflow.com/users/97926/jalpesh-vadgama"}, "edited": false, "score": 0, "creation_date": 1487066225, "post_id": 42222883, "comment_id": 71605831, "body": "Okay let me check"}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1487066269, "post_id": 42222883, "comment_id": 71605862, "body": "Yes 514 UDP, 601 TCP and another one that I don&#39;t remember as TLS (6514)"}, {"owner": {"reputation": 12238, "user_id": 97926, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7CP1W.png?s=128&g=1", "display_name": "Jalpesh Vadgama", "link": "https://stackoverflow.com/users/97926/jalpesh-vadgama"}, "edited": false, "score": 0, "creation_date": 1487066845, "post_id": 42222883, "comment_id": 71606238, "body": "@Tinwor - Getting same error dial tcp 127.0.0.1:514: getsockopt: connection refused. Should I use 601?"}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1487066913, "post_id": 42222883, "comment_id": 71606287, "body": "Well, if you want use as tcp yes, otherwise if you want use as ump use 514"}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1487067368, "post_id": 42222883, "comment_id": 71606579, "body": "Sorry, I haven&#39;t entirely ready your configuration file. Uncomment #module(load=&quot;imtcp&quot;) and #input(type=&quot;imtcp&quot; port=&quot;514&quot;) and then restart syslog. Then try to connect using the tcp port on 514. If it works I need to update the answer"}], "tags": [], "owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "is_accepted": true, "score": 0, "last_activity_date": 1487069564, "last_edit_date": 1487069564, "creation_date": 1487066065, "answer_id": 42222883, "question_id": 42222136, "link": "https://stackoverflow.com/questions/42222136/getting-connection-refused-for-tcp-connection-syslog-golang/42222883#42222883", "title": "Getting Connection refused for tcp connection SysLog Golang", "body": "<p>You need to uncomment  </p>\n\n<pre><code>#module(load=\"imtcp\")\n#input(type=\"imtcp\" port=\"514\")\n</code></pre>\n\n<p>To provide syslog TCP reception. Once you have do this restart the syslog service and will work.<br>\nIf you want listen tcp on port <code>2114</code> you need to change the input as  </p>\n\n<pre><code>input(type=\"imtcp\" port=\"2114\")\n</code></pre>\n"}], "owner": {"reputation": 12238, "user_id": 97926, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7CP1W.png?s=128&g=1", "display_name": "Jalpesh Vadgama", "link": "https://stackoverflow.com/users/97926/jalpesh-vadgama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3850, "favorite_count": 0, "accepted_answer_id": 42222883, "answer_count": 1, "score": 0, "last_activity_date": 1487069564, "creation_date": 1487064029, "last_edit_date": 1487066026, "question_id": 42222136, "link": "https://stackoverflow.com/questions/42222136/getting-connection-refused-for-tcp-connection-syslog-golang", "title": "Getting Connection refused for tcp connection SysLog Golang", "body": "<p>I am using syslog on ubuntu 16.4 Operating System in golang to log error like following.</p>\n\n<pre><code>w, err = syslog.Dial(\"tcp\", \"localhost:2114\", syslog.LOG_ERR, \"testapi\")\n</code></pre>\n\n<p>Here I'm getting following error.</p>\n\n<p>dial tcp 127.0.0.1:2114: getsockopt: connection refused</p>\n\n<p>I have already tried following things.</p>\n\n<ol>\n<li>Enable port in firewall with - sudo ufw allow 2114 command.</li>\n<li>Disable firewall and tried with that.</li>\n<li>Tried other port with above steps.</li>\n</ol>\n\n<p>Any help with will be really appreciated.</p>\n\n<p>Here is the syslog.conf</p>\n\n<pre><code>#  /etc/rsyslog.conf    Configuration file for rsyslog.\n#\n#           For more information see\n#           /usr/share/doc/rsyslog-doc/html/rsyslog_conf.html\n#\n#  Default logging rules can be found in /etc/rsyslog.d/50-default.conf\n\n\n#################\n#### MODULES ####\n#################\n\nmodule(load=\"imuxsock\") # provides support for local system logging\nmodule(load=\"imklog\")   # provides kernel logging support\n#module(load=\"immark\")  # provides --MARK-- message capability\n\n# provides UDP syslog reception\n#module(load=\"imudp\")\n#input(type=\"imudp\" port=\"514\")\n\n# provides TCP syslog reception\n#module(load=\"imtcp\")\n#input(type=\"imtcp\" port=\"514\")\n\n# Enable non-kernel facility klog messages\n$KLogPermitNonKernelFacility on\n\n##########################\n#### GLOBAL DIRECTIVES ####\n##########################\n\n#\n# Use traditional timestamp format.\n# To enable high precision timestamps, comment out the following line.\n#\n$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat\n\n# Filter duplicated messages\n$RepeatedMsgReduction on\n\n#\n# Set the default permissions for all log files.\n#\n$FileOwner syslog\n$FileGroup adm\n$FileCreateMode 0640\n$DirCreateMode 0755\n$Umask 0022\n$PrivDropToUser syslog\n$PrivDropToGroup syslog\n\n#\n# Where to place spool and state files\n#\n$WorkDirectory /var/spool/rsyslog\n\n#\n# Include all config files in /etc/rsyslog.d/\n#\n$IncludeConfig /etc/rsyslog.d/*.conf\n</code></pre>\n"}, {"tags": ["go", "docker"], "comments": [{"owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1487063953, "post_id": 42221207, "comment_id": 71604296, "body": "Are the binaries statically linked?  With a scratch image there will not be a libc (or any shared libs).  If it works fine on debian, then I suspect the binary is not statically linked, which is the normal default.  Try CGO_ENABLED=0 go build -a -installsuffix cgo as seen here <a href=\"http://www.blang.io/posts/2015-04_golang-alpine-build-golang-binaries-for-alpine-linux/\" rel=\"nofollow noreferrer\">blang.io/posts/&hellip;</a>"}, {"owner": {"reputation": 3074, "user_id": 494531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13e2ba2d5dc8b94598898d1f572cafcd?s=128&d=identicon&r=PG", "display_name": "Roman Mazur", "link": "https://stackoverflow.com/users/494531/roman-mazur"}, "reply_to_user": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1487065462, "post_id": 42221207, "comment_id": 71605300, "body": "Thanks for the hint, setting CGO_ENABLED=0 does help. If you post it as an answer, I&#39;ll be happy to accept :)"}], "answers": [{"tags": [], "owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "is_accepted": true, "score": 1, "last_activity_date": 1487065622, "creation_date": 1487065622, "answer_id": 42222722, "question_id": 42221207, "link": "https://stackoverflow.com/questions/42221207/spawn-a-new-process-in-docker-container-which-image-is-built-from-scratch/42222722#42222722", "title": "Spawn a new process in docker container which image is built from scratch", "body": "<p>With a scratch image there will not be a libc (or any shared libs). If it works fine on debian, then I suspect the binary is not statically linked, which is the normal default. Try CGO_ENABLED=0 go build -a -installsuffix cgo as seen here <a href=\"http://www.blang.io/posts/2015-04_golang-alpine-build-golang-binaries-for-alpine-linux/\" rel=\"nofollow noreferrer\">http://www.blang.io/posts/2015-04_golang-alpine-build-golang-binaries-for-alpine-linux/</a></p>\n"}], "owner": {"reputation": 3074, "user_id": 494531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13e2ba2d5dc8b94598898d1f572cafcd?s=128&d=identicon&r=PG", "display_name": "Roman Mazur", "link": "https://stackoverflow.com/users/494531/roman-mazur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 1, "accepted_answer_id": 42222722, "answer_count": 1, "score": 1, "last_activity_date": 1487065622, "creation_date": 1487061123, "last_edit_date": 1487061862, "question_id": 42221207, "link": "https://stackoverflow.com/questions/42221207/spawn-a-new-process-in-docker-container-which-image-is-built-from-scratch", "title": "Spawn a new process in docker container which image is built from scratch", "body": "<p>I'm trying to build a minimal docker image (<code>FROM scratch</code>) that contains 2 executable binaries. Both are binaries built with Go. The entrypoint is set to the first one. It takes some data on the image, transforms it using environment variables, starts a new process executing the second binary and pipes the data as an input for the spawned process.</p>\n\n<pre><code>FROM scratch\nCOPY bin /opt/my-app\nENTRYPOINT [\"/opt/my-app/first\", \"--run\", \"/opt/my-app/second\"]\n</code></pre>\n\n<p>When I build this image on my Mac, everything works fine. But when it's created it on our build server running linux, the first process cannot start the second one. It fails with an error \"fork/exec /opt/my-app/second: no such file or directory\". However, \"second\" binary does exist. In both cases docker engine 1.13.1 is used.</p>\n\n<p>It also works if parent image is changed from <code>scratch</code> to <code>debian:jessie</code>.</p>\n\n<p>Are there any limitations of the scratch image that I'm not aware of?</p>\n"}, {"tags": ["python", "c", "pointers", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1487071910, "post_id": 42220152, "comment_id": 71609714, "body": "The error says &quot;cgo result has Go pointer&quot; because the return value from <code>ArrayToSlice</code> is a Go pointer"}], "owner": {"reputation": 27886, "user_id": 636626, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b18fc48caab5bf7c3e2a15292972f05b?s=128&d=identicon&r=PG", "display_name": "Nils Werner", "link": "https://stackoverflow.com/users/636626/nils-werner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1491554926, "creation_date": 1487057137, "last_edit_date": 1491554926, "question_id": 42220152, "link": "https://stackoverflow.com/questions/42220152/how-to-wrap-c-pointer-in-go-without-triggering-cgo-result-has-go-pointer", "title": "How to wrap C pointer in Go without triggering &quot;cgo result has Go pointer&quot;", "body": "<p>I am trying to implement a function in cgo that wraps a <code>double</code> array in a <code>Slice</code>:</p>\n\n<pre><code>//export ArrayToSlice\nfunc ArrayToSlice(a *C.double, length int) (*[]float64) {\n    hdr := reflect.SliceHeader{\n        Data: uintptr(unsafe.Pointer(a)),\n        Len:  length,\n        Cap:  length,\n    }\n    return (*[]float64)(unsafe.Pointer(&amp;hdr))\n}\n</code></pre>\n\n<p>this function is supposed to be <a href=\"https://github.com/nils-werner/python-go-cffi/blob/master/py/gosum.py#L15\" rel=\"nofollow noreferrer\">called from C, return the Slice to C, which will then pass it to another Go function</a>.</p>\n\n<p>This used to work with Go 1.5, but with 1.6 it started showing this panic:</p>\n\n<pre><code>panic: runtime error: cgo result has Go pointer\n</code></pre>\n\n<p>I understand what the issue is: Go does not want to hand out its pointers to C, because Go is garbage collected and might destroy pointers that are in the hands of the non-garbage collected C code.</p>\n\n<p>Is there a way to do this in Go 1.6?</p>\n"}, {"tags": ["go", "plugins", "dependencies"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3889, "user_id": 100405, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/924e4500ab6bdce291ab6346099ede26?s=128&d=identicon&r=PG", "display_name": "weima", "link": "https://stackoverflow.com/users/100405/weima"}, "edited": false, "score": 1, "creation_date": 1487069416, "post_id": 42220856, "comment_id": 71608059, "body": "@weima Added even more details and examples."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1487072516, "last_edit_date": 1487072516, "creation_date": 1487059746, "answer_id": 42220856, "question_id": 42218472, "link": "https://stackoverflow.com/questions/42218472/how-do-go-plugin-dependencies-work/42220856#42220856", "title": "How do Go plugin dependencies work?", "body": "<p>You're not doing exactly what you think you are.</p>\n\n<p>Your <strong>plugin1</strong> imports and uses a <em>package</em>, namely <code>github.com/vimal/testplugin1/plug</code>. This is not \"equal\" to <strong>plugin2</strong>!</p>\n\n<p>What happens here is that when you build <strong>plugin1</strong>, all its dependencies are built into the plugin file, including the <code>.../testplugin1/plug</code> package. And when you load <strong>plugin1</strong>, all its dependencies are also loaded from the plugin file, including the <code>plug</code> package. After this, it's not surprising that it works no matter the loaded status of <strong>plugin2</strong>. These 2 plugins are independent from each another.</p>\n\n<p>The <code>-buildmode=plugin</code> instructs the compiler that you want to build a plugin and not a standalone app, but it doesn't mean dependencies must not be included. They have to be, because the plugin cannot have any guarantee what Go app will load it, and what packages that Go app will have. Because a runnable app also only contains packages even from the standard library that the app itself references explicitly.</p>\n\n<p>The only way to guarantee that the plugin will have everything it needs and so that it will work if it also contains all its dependencies, including those from the standard library. (This is the reason why building simple plugins generate relatively big files, similarly to building simple Go executables resulting in big files.)</p>\n\n<p>Few things that don't need to be added to plugins include the Go runtime for example, because a running Go app that will load the plugin will already have a Go runtime running. (Note that you can only load a plugin from an app compiled with the same version of Go.) But beyond that, the plugin has to contain everything it needs.</p>\n\n<p>Go is a statically linked language. Once a Go app or plugin is compiled, they do not rely nor check the value of <code>GOPATH</code>, it is only used by the Go tool during building them.</p>\n\n<h3>Deeper insight</h3>\n\n<p>It's possible that your main app and a plugin refers to the same package (\"same\" by import path). In such cases only one \"instance\" of the package will be used.</p>\n\n<p>This can be tested if this commonly referred package has \"state\", e.g a global variable. Let's assume a common, shared package called <code>mymath</code>:</p>\n\n<pre><code>package mymath\n\nvar S string\n\nfunc SetS(s string) {\n    S = s\n}\n</code></pre>\n\n<p>And a plugin called <code>pg</code> that uses it:</p>\n\n<pre><code>package main\n\nimport (\n    \"C\"\n    \"mymath\"\n    \"fmt\"\n)\n\nfunc Start() {\n    fmt.Println(\"pg:mymath.S\", mymath.S)\n    mymath.SetS(\"pghi\")\n    fmt.Println(\"pg:mymath.S\", mymath.S)\n}\n</code></pre>\n\n<p>And the main app that uses <code>mymath</code> and loads <code>pg</code> (which uses it):</p>\n\n<pre><code>package main\n\nimport (\n    \"plugin\"\n    \"mymath\"\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"mymath.S\", mymath.S)\n    mymath.SetS(\"hi\")\n    fmt.Println(\"mymath.S\", mymath.S)\n\n    p, err := plugin.Open(\"../pg/pg.so\")\n    if err != nil {\n        panic(err)\n    }\n\n    start, err := p.Lookup(\"Start\")\n    if err != nil {\n        panic(err)\n    }\n\n    start.(func())()\n\n    fmt.Println(\"mymath.S\", mymath.S)\n}\n</code></pre>\n\n<p>Building the plugin:</p>\n\n<pre><code>cd pg\ngo build -buildmode=plugin\n</code></pre>\n\n<p>Running the main app, the output is:</p>\n\n<pre><code>mymath.S \nmymath.S hi\npg:mymath.S hi\npg:mymath.S pghi\nmymath.S pghi\n</code></pre>\n\n<p>Analysis: first the main app plays with <code>mymath.S</code>, sets it to <code>\"hi\"</code> eventually. Then comes the plugin, which prints it (we see the value set by the main app <code>\"hi\"</code>), then changes it to <code>\"pghi\"</code>. Then comes again the main app and prints <code>mymath.S</code>, and again, sees the last value set by the plugin: <code>\"pghi\"</code>.</p>\n\n<p>So there is only one \"instance\" of <code>mymath</code>. Now if you go ahead and change <code>mymath</code>, e.g. rename <code>myMath.SetS()</code> to <code>mymath.SetS2()</code>, and you update the call in the main app (to <code>mymath.SetS2(\"hi\")</code>), and without rebuilding the plugin, just running the main app, you get the following output:</p>\n\n<pre><code>mymath.S \nmymath.S hi\npanic: plugin.Open: plugin was built with a different version of package mymath\n\ngoroutine 1 [running]:\nmain.main()\n    &lt;GOPATH&gt;/src/play/play.go:16 +0x4b5\nexit status 2\n</code></pre>\n\n<p>As you can see, when building the main app and the plugin, the package version (which is most likely a hash) is recorded, which must match if their import paths match in the main app and in the plugin.</p>\n\n<p>(Note that you will also get the above error if you don't change the exported identifiers (and signatures) of the used <code>mymath</code> package, only the implementation; e.g. <code>func SetS(s string) { S = s + \"+\" }</code>.)</p>\n"}], "owner": {"reputation": 3889, "user_id": 100405, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/924e4500ab6bdce291ab6346099ede26?s=128&d=identicon&r=PG", "display_name": "weima", "link": "https://stackoverflow.com/users/100405/weima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 0, "accepted_answer_id": 42220856, "answer_count": 1, "score": 5, "last_activity_date": 1487072516, "creation_date": 1487049777, "last_edit_date": 1487062553, "question_id": 42218472, "link": "https://stackoverflow.com/questions/42218472/how-do-go-plugin-dependencies-work", "title": "How do Go plugin dependencies work?", "body": "<p>Go 1.8 supports Go plugins.</p>\n\n<p>I have created two plugins as follows.</p>\n\n<p>As I understand, the plugin exposes only the functions and variables in the <code>main</code> package. i.e. <code>plugin.Lookup()</code> will fail for non-<code>main</code> variable/function.</p>\n\n<p>But I wanted to test if a plugin can internally invoke a method from another plugin, similar to how a C++ library can invoke another library.</p>\n\n<p>So I tested as follows:</p>\n\n<p><strong>plugin1</strong> github.com/vimal/testplugin</p>\n\n<pre><code>$ cat myplugin.go\npackage main\n\nimport \"C\"\nimport \"fmt\"\nimport help \"github.com/vimal/testplugin1/plug\"\n\nfunc init() {\n        fmt.Printf(\"main.init invoked\\n\")\n}\n// TestPlugin \nfunc TestPlugin() string {\n        return help.Help()\n}\n</code></pre>\n\n<p><strong>plugin2</strong> github.com/vimal/testplugin1</p>\n\n<pre><code>$ cat myplugin.go\npackage main\n\nimport \"C\"\n\nfunc HelperFunc() string {\n        return \"help\"\n}\n$ cat plug/helper.go\npackage help\n\nfunc Help() string {\n        return \"help234\"\n}\n</code></pre>\n\n<p>Idea here is that plugin1 invokes an internal, non-<code>main</code> function of plugin2.</p>\n\n<p><strong>main program</strong></p>\n\n<p>Main program loads a number of plugins given as arguments, and invokes <code>TestPlugin()</code> from the last plugin.</p>\n\n<p><strong>test 1:</strong></p>\n\n<p>Build both plugins, and load both plugins, and invoke <code>TestPlugin()</code>, the output contains <code>\"help234\"</code>, i.e. the inner function is invoked. This can be understood, since both plugins are loaded, one plugin can invoke another plugin's inner code.</p>\n\n<p><strong>test 2:</strong></p>\n\n<p>Load only plugin1, and invoke <code>TestPlugin()</code>, the output contains <code>\"help234\"</code>, i.e. the inner function is invoked. The same output is observed as in test1. Perhaps this time the method is found from <code>GOPATH</code>.</p>\n\n<p><strong>test 3:</strong></p>\n\n<p>Rename the folder <code>\"github.com/vimal/testplugin1\"</code> to <code>\"github.com/vimal/junk1\"</code>, delete the plugin2, and load only plugin1, and invoke <code>TestPlugin()</code>. the output still contains <code>\"help234\"</code>, i.e. the inner function is invoked. </p>\n\n<p>I am not able to understand how test3 produces the same output. Does plugin1 contain plugin2 code also? How can I understand the Go plugin dependency on other Go plugins?</p>\n\n<p>Go version : <code>go version go1.8rc3 linux/amd64</code></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18829, "user_id": 24998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c14a4f2931fa9336fdccdfe11318fef?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/24998/jack"}, "is_accepted": true, "score": 6, "last_activity_date": 1487048579, "creation_date": 1487048579, "answer_id": 42218240, "question_id": 42217995, "link": "https://stackoverflow.com/questions/42217995/why-doesnt-this-go-code-print-anything-with-a-goroutine/42218240#42218240", "title": "why doesn&#39;t this go code print anything with a goroutine", "body": "<p>Your program is finishing before your goroutines have a chance to run.</p>\n\n<p>Here's your code with a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\">WaitGroup</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 20; i++ {\n        wg.Add(1)\n        go func(j int) {\n            defer wg.Done()\n            fmt.Println(j + 100)\n        }(i)\n    }\n    fmt.Println(\"Waiting...\")\n    wg.Wait()\n    fmt.Println(\"Done.\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/lmCPU9-qkB\" rel=\"noreferrer\">https://play.golang.org/p/lmCPU9-qkB</a></p>\n"}, {"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1487049425, "creation_date": 1487049425, "answer_id": 42218390, "question_id": 42217995, "link": "https://stackoverflow.com/questions/42217995/why-doesnt-this-go-code-print-anything-with-a-goroutine/42218390#42218390", "title": "why doesn&#39;t this go code print anything with a goroutine", "body": "<p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">From the spec of Go</a>:</p>\n\n<blockquote>\n  <p>Program execution begins by initializing the main package and then\n  invoking the function main. When that function invocation returns, the\n  program exits. It <strong>does not wait for other (non-main) goroutines</strong> to\n  complete.</p>\n</blockquote>\n\n<p>See Jack's answer for a working version.</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "closed_date": 1487056686, "accepted_answer_id": 42218240, "answer_count": 2, "score": 0, "last_activity_date": 1487049425, "creation_date": 1487047291, "question_id": 42217995, "link": "https://stackoverflow.com/questions/42217995/why-doesnt-this-go-code-print-anything-with-a-goroutine", "closed_reason": "Duplicate", "title": "why doesn&#39;t this go code print anything with a goroutine", "body": "<p>I must be missing something really basic about goroutines, but I've looked around and I cannot see any reason why this would not work...</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    for i := 0; i &lt; 20; i++ {\n        //fmt.Println(i)\n        go func(j int) {\n            fmt.Println(j + 100)\n        }(i)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1487055944, "post_id": 42217839, "comment_id": 71600047, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/29138591/hiding-nil-values-understanding-why-golang-fails-here/29138676#29138676\">Hiding nil values, understanding why golang fails here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": true, "score": 4, "last_activity_date": 1487047254, "creation_date": 1487047254, "answer_id": 42217989, "question_id": 42217839, "link": "https://stackoverflow.com/questions/42217839/how-can-v-nil-return-false-and-reflect-valueofv-isnil-return-true-at-the/42217989#42217989", "title": "How can v == nil return false and reflect.ValueOf(v).IsNil() return true at the same time?", "body": "<p><a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">From golang.org</a>:</p>\n\n<blockquote>\n  <p>Under the covers, interfaces are implemented as two elements, a type\n  and a value. The value, called the interface's dynamic value, is an\n  arbitrary concrete value and the type is that of the value. For the\n  int value 3, an interface value contains, schematically, (int, 3).</p>\n  \n  <p>An interface value is nil only if the inner value and type are both\n  unset, (nil, nil). In particular, a nil interface will always hold a\n  nil type. If we store a nil pointer of type *int inside an interface\n  value, the inner type will be *int regardless of the value of the\n  pointer: (*int, nil). Such an interface value will therefore be\n  non-nil even when the pointer inside is nil.</p>\n</blockquote>\n\n<p>You can try <code>fmt.Printf(\"(%v, %T)\\n\", v, v)</code>. It prints <code>(&lt;nil&gt;, *string)</code>.</p>\n\n<p>When you change first two lines to <code>v := (*string)(nil)</code>, <code>v</code> is just a pointer, not an interface.</p>\n"}], "owner": {"reputation": 3440, "user_id": 1407735, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7c273f8bbfe205223d4f785dd5e8b830?s=128&d=identicon&r=PG", "display_name": "Marc-Fran&#231;ois", "link": "https://stackoverflow.com/users/1407735/marc-fran%c3%a7ois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 42217989, "answer_count": 1, "score": 2, "last_activity_date": 1487047254, "creation_date": 1487046198, "last_edit_date": 1592644375, "question_id": 42217839, "link": "https://stackoverflow.com/questions/42217839/how-can-v-nil-return-false-and-reflect-valueofv-isnil-return-true-at-the", "title": "How can v == nil return false and reflect.ValueOf(v).IsNil() return true at the same time?", "body": "<p>Here's some code:</p>\n<pre><code>var v interface{}\nv = (*string)(nil)\n\n// Reflect says it is nil\nval := reflect.ValueOf(v)\nif val.IsNil() {\n    fmt.Println(&quot;val is nil&quot;)\n} else {\n    fmt.Println(&quot;val is not nil&quot;)\n}\n\n// This says it is not nil\nif v == nil {\n    fmt.Println(&quot;v is nil&quot;)\n} else {\n    fmt.Println(&quot;v is not nil&quot;)\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/apyPa4CNZ6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/apyPa4CNZ6</a></p>\n<p>The output is:</p>\n<blockquote>\n<p>val is nil</p>\n<p>v is not nil</p>\n</blockquote>\n<p>How is this possible? Is v nil or not?</p>\n<p>Also, if you change the first two lines with</p>\n<pre><code>v := (*string)(nil)\n</code></pre>\n<p>then the output clearly states that the variable is nil.</p>\n<p>Right now in my project I have a function that accepts a argument of type interface{} and I can't reliably check if it is nil with a simple v == nil. I would like to avoid using the reflect package.</p>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1487060410, "post_id": 42217308, "comment_id": 71602259, "body": "You asked &quot;Where can I find documentation on the meanings of [... some detail] in the layout [of a function f of package p]?&quot; and the answer is always the same: In the documentation of package p (read the full package documentation always!) and the documentation of the function f (also read it; twice). There is no short circuiting for doc: Don&#39;t guess, don&#39;t assume based on signature and don&#39;t experiment solely on function doc: Read the package doc first, then the function doc. Repeat if necessary. Run the examples."}], "answers": [{"tags": [], "owner": {"reputation": 18829, "user_id": 24998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c14a4f2931fa9336fdccdfe11318fef?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/24998/jack"}, "is_accepted": false, "score": 10, "last_activity_date": 1487043582, "creation_date": 1487043582, "answer_id": 42217472, "question_id": 42217308, "link": "https://stackoverflow.com/questions/42217308/go-time-format-how-to-understand-meaning-of-2006-01-02-layout/42217472#42217472", "title": "Go: time.Format: how to understand meaning of &#39;2006-01-02&#39; layout?", "body": "<p><code>Mon Jan 2 15:04:05 -0700 MST 2006</code> is the reference time, which means the layout needs to use that exact date. There's <a href=\"https://golang.org/pkg/time/#Parse\">more information here</a>, but basically by using unique values for each part of a datetime it's able to tell where each part (year, month, etc) actually is automatically.</p>\n\n<p><a href=\"https://play.golang.org/p/5kULop6obM\">Corrected go playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 626, "user_id": 3471636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kVPaJ.jpg?s=128&g=1", "display_name": "mkokho", "link": "https://stackoverflow.com/users/3471636/mkokho"}, "edited": false, "score": 1, "creation_date": 1487104349, "post_id": 42217483, "comment_id": 71630722, "body": "Thank you, this explains everything: &quot;We stress that one must show how the reference time is formatted, not a time of the user&#39;s choosing&quot;. Sad that such important information is hidden in the example."}], "tags": [], "owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "is_accepted": false, "score": 7, "last_activity_date": 1487043638, "creation_date": 1487043638, "answer_id": 42217483, "question_id": 42217308, "link": "https://stackoverflow.com/questions/42217308/go-time-format-how-to-understand-meaning-of-2006-01-02-layout/42217483#42217483", "title": "Go: time.Format: how to understand meaning of &#39;2006-01-02&#39; layout?", "body": "<p>to follow up on Jack's info, see the detailed <a href=\"https://godoc.org/time#example-Time-Format\" rel=\"noreferrer\">examples</a>:</p>\n\n<pre><code>// The layout string used by the Parse function and Format method\n// shows by example how the reference time should be represented.\n// We stress that one must show how the reference time is formatted,\n// not a time of the user's choosing. Thus each layout string is a\n// representation of the time stamp,\n//  Jan 2 15:04:05 2006 MST\n// An easy way to remember this value is that it holds, when presented\n// in this order, the values (lined up with the elements above):\n//    1 2  3  4  5    6  -7\n</code></pre>\n\n<p>this reference time allows us to clarify whether go should parse 01-02-17 as jan 2 2017 or feb 1</p>\n"}, {"tags": [], "owner": {"reputation": 1104, "user_id": 6438430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5VRc3dZXdns/AAAAAAAAAAI/AAAAAAAAAeI/nemPXRtg3JU/photo.jpg?sz=128", "display_name": "Ashish Tiwari", "link": "https://stackoverflow.com/users/6438430/ashish-tiwari"}, "is_accepted": false, "score": 4, "last_activity_date": 1540375344, "creation_date": 1540375344, "answer_id": 52966197, "question_id": 42217308, "link": "https://stackoverflow.com/questions/42217308/go-time-format-how-to-understand-meaning-of-2006-01-02-layout/52966197#52966197", "title": "Go: time.Format: how to understand meaning of &#39;2006-01-02&#39; layout?", "body": "<p>Go\u2019s time formatting unique and different than what you would do in other languages. Instead of having a conventional format to print the date, Go uses the reference date <code>20060102150405</code> which seems meaningless but actually has a reason, as it\u2019s <code>1 2 3 4 5 6</code> in the Posix date command:</p>\n\n<pre><code>Mon Jan 2 15:04:05 -0700 MST 2006\n0   1   2  3  4  5              6\n</code></pre>\n\n<p>In Go layout string is:</p>\n\n<pre><code>Jan 2 15:04:05 2006 MST\n1   2  3  4  5    6  -7\n</code></pre>\n\n<p>Check <a href=\"https://flaviocopes.com/go-date-time-format/\" rel=\"nofollow noreferrer\">this</a></p>\n"}], "owner": {"reputation": 626, "user_id": 3471636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kVPaJ.jpg?s=128&g=1", "display_name": "mkokho", "link": "https://stackoverflow.com/users/3471636/mkokho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4740, "favorite_count": 0, "answer_count": 3, "score": 6, "last_activity_date": 1540375344, "creation_date": 1487042468, "question_id": 42217308, "link": "https://stackoverflow.com/questions/42217308/go-time-format-how-to-understand-meaning-of-2006-01-02-layout", "title": "Go: time.Format: how to understand meaning of &#39;2006-01-02&#39; layout?", "body": "<p>Given a time variable, I want to print year, month, and day.\nFrom the documentation, it seems that any layout can be used. For example, I don't see difference between layouts 2006-01-02, 2006-10-10, 1999-02-02.</p>\n\n<p>However, only layout 2006-01-02 returns what I expect. \nWhere can I find documentation on the meanings of '2006', '01', '02' in the layout?</p>\n\n<p>I played here with different layouts: <a href=\"https://play.golang.org/p/LihASulNoM\" rel=\"noreferrer\">go playground: testing layouts</a> </p>\n"}, {"tags": ["unit-testing", "http", "go"], "comments": [{"owner": {"reputation": 983, "user_id": 1623765, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c0d6d0a84591bfb64bd401f213b8c88b?s=128&d=identicon&r=PG", "display_name": "Kumaran Senapathy", "link": "https://stackoverflow.com/users/1623765/kumaran-senapathy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1487024774, "post_id": 42214611, "comment_id": 71590736, "body": "I have multiple api&#39;s that I test and in those functions, I append the path to the base URL.  In my original function, I have a base URL like &quot;<a href=\"http://someserver.com\" rel=\"nofollow noreferrer\">someserver.com</a>&quot;  Under getStudent() I modify that to be baseUrl + &quot;/student/{id}&quot; Under getClass() I would change to baseUrl + &quot;/class/{id}&quot;  Because each of the httptest server I create having different ports I get 127.0.0.1:49855/student/1: getsockopt: connection refused"}, {"owner": {"reputation": 983, "user_id": 1623765, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c0d6d0a84591bfb64bd401f213b8c88b?s=128&d=identicon&r=PG", "display_name": "Kumaran Senapathy", "link": "https://stackoverflow.com/users/1623765/kumaran-senapathy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1487025037, "post_id": 42214611, "comment_id": 71590870, "body": "I hope my edit makes more sense.. I am trying to explain it the best I could. In the file that I am testing, I have an Init that is called by test to modify the base URL Like, var baseURL = &quot;<a href=\"http://originalUrl.com\" rel=\"nofollow noreferrer\">originalUrl.com</a>&quot; var mockUrl = &quot;<a href=\"http://127.0.0.1:49855\" rel=\"nofollow noreferrer\">127.0.0.1:49855</a>&quot; func Init(mockServer bool){ if mockServer { \t\tbaseURL = mockUrl \t} }"}, {"owner": {"reputation": 983, "user_id": 1623765, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c0d6d0a84591bfb64bd401f213b8c88b?s=128&d=identicon&r=PG", "display_name": "Kumaran Senapathy", "link": "https://stackoverflow.com/users/1623765/kumaran-senapathy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1487025527, "post_id": 42214611, "comment_id": 71591070, "body": "Because I am appending the URL in each of the api calls, it would still fail.  Just like I append some value to url in the getStudent function, I would do in getClass function too. Basically the URL is changed inside the functions. With a custom URL/port, I can specify the final URL in the testServer"}, {"owner": {"reputation": 983, "user_id": 1623765, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c0d6d0a84591bfb64bd401f213b8c88b?s=128&d=identicon&r=PG", "display_name": "Kumaran Senapathy", "link": "https://stackoverflow.com/users/1623765/kumaran-senapathy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1487035273, "post_id": 42214611, "comment_id": 71593950, "body": "That is what I did.. Thank you. Even though this works, I would like to know if we can use custom ports for httptest. Is that possible?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 14, "last_activity_date": 1487088305, "last_edit_date": 1487088305, "creation_date": 1487051292, "answer_id": 42218765, "question_id": 42214611, "link": "https://stackoverflow.com/questions/42214611/using-custom-url-for-httptest-newserver-in-go/42218765#42218765", "title": "Using custom URL for httptest.NewServer in Go", "body": "<p>Most applications use the port assigned in NewServer or NewUnstartedServer because this port will not conflict with a port in use on the machine. Instead of assigning a port, they set the base URL for the service to the <a href=\"https://godoc.org/net/http/httptest#Server.URL\" rel=\"noreferrer\">test server's URL</a>.</p>\n\n<p>If you do want to set the listening port, do the following:</p>\n\n<pre><code>// create a listener with the desired port.\nl, err := net.Listen(\"tcp\", \"127.0.0.1:8080\")\nif err != nil {\n    log.Fatal(err)\n}\n\nts := httptest.NewUnstartedServer(handler)\n\n// NewUnstartedServer creates a listener. Close that listener and replace \n// with the one we created.\nts.Listener.Close()\nts.Listener = l\n\n// Start the server.\nts.Start()\n\n// Run your tests here.\n\n// Cleanup.\nts.Close()\n</code></pre>\n"}], "owner": {"reputation": 983, "user_id": 1623765, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c0d6d0a84591bfb64bd401f213b8c88b?s=128&d=identicon&r=PG", "display_name": "Kumaran Senapathy", "link": "https://stackoverflow.com/users/1623765/kumaran-senapathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5930, "favorite_count": 1, "accepted_answer_id": 42218765, "answer_count": 1, "score": 6, "last_activity_date": 1525702659, "creation_date": 1487024483, "last_edit_date": 1525702659, "question_id": 42214611, "link": "https://stackoverflow.com/questions/42214611/using-custom-url-for-httptest-newserver-in-go", "title": "Using custom URL for httptest.NewServer in Go", "body": "<p>I am running UT on some rest calls by creating a http test server in the Go language. My code is as follows.</p>\n\n<pre><code>type student struct{\nFirstName string\nLastName string\n}\n\nfunc testGetStudentName() {\n    testServer := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    response = new(student)\n    response.FirstName = \"Some\"\n    response.LastName = \"Name\"\n    b, err := json.Marshal(response)\n    if err == nil {\n            fmt.Fprintln(w, string(b[:]))\n        }\n    }))\n    defer ts.Close()\n    student1 := base.getStudent(\"123\")\n    log.Print(\"testServerUrl\",testServer.URL) //prints out http://127.0.0.1:49931 ( port changes every time this is run)\n\n   ts.URL = \"http://127.0.0.1:8099\" //this assignment does not quite change the URL of the created test server.\n}\n</code></pre>\n\n<p>In the file being tested,</p>\n\n<pre><code>var baseURL = \"http://originalUrl.com\"\nvar mockUrl = \"http://127.0.0.1:49855\"\nfunc Init(mockServer bool){\n    if mockServer {\n        baseURL = mockUrl\n    }\n}\n\nfunc getStudent(id String){\n     url := baseUrl + \"/student/\" + id\n     req, err := http.NewRequest(\"GET\", url, nil)\n}\n</code></pre>\n\n<p>This init is called from my test.</p>\n\n<p>This creates a new test server and runs the calls on a random port. Is it possible for me to run this server on a port I specify?</p>\n"}, {"tags": ["parsing", "go", "command-line"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487023080, "post_id": 42213996, "comment_id": 71589937, "body": "Note that this is going to be system specific. The output on other systems will be formatted differently, and IIRC the Windows <code>ping</code> is the only one that always exits after 4 packets."}, {"owner": {"reputation": 404, "user_id": 6757551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f817b964323633a387c6ee603915bbe?s=128&d=identicon&r=PG&f=1", "display_name": "as.beaulieu", "link": "https://stackoverflow.com/users/6757551/as-beaulieu"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487047953, "post_id": 42213996, "comment_id": 71597021, "body": "So to be specific, I will mainly be working on Windows 7 and Server 2008 R2. I&#39;m practicing with writing programs that will run programs, and I want to learn how to parse information that is being displayed. I used ping as an example, and hopes that I could parse the output to be displayed somewhere more UI friendly for a user."}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 6757551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f817b964323633a387c6ee603915bbe?s=128&d=identicon&r=PG&f=1", "display_name": "as.beaulieu", "link": "https://stackoverflow.com/users/6757551/as-beaulieu"}, "edited": false, "score": 0, "creation_date": 1487605280, "post_id": 42261688, "comment_id": 71848434, "body": "Clear, simple, and great! Thanks for editing my cmdOutput.Bytes() into a more manageable output to be called later. So focused on the complicated stuff I forgot the simple things."}], "tags": [], "owner": {"reputation": 515, "user_id": 927588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117c87ac418e42aa9145f86c3ab93b8c?s=128&d=identicon&r=PG", "display_name": "Sasan Rose", "link": "https://stackoverflow.com/users/927588/sasan-rose"}, "is_accepted": true, "score": 5, "last_activity_date": 1487199461, "creation_date": 1487199461, "answer_id": 42261688, "question_id": 42213996, "link": "https://stackoverflow.com/questions/42213996/trying-to-parse-a-stdout-on-command-line-with-golang/42261688#42261688", "title": "Trying to parse a stdout on command line with Golang", "body": "<p>You can use <code>regexp</code>. For instance something like:</p>\n\n<pre><code>package main\n\nimport (\n        \"bytes\"\n        \"fmt\"\n        \"os\"\n        \"os/exec\"\n        \"regexp\"\n        \"strings\"\n        \"time\"\n)\n\ntype Ping struct {\n        average time.Duration\n}\n\nfunc main() {\n        cmd := exec.Command(\"ping\", \"8.8.8.8\")\n        // Linux version\n        //cmd := exec.Command(\"ping\", \"-c 4\", \"8.8.8.8\")\n        cmdOutput := &amp;bytes.Buffer{}\n        cmd.Stdout = cmdOutput\n        printCommand(cmd)\n        err := cmd.Run()\n        printError(err)\n        output := cmdOutput.Bytes()\n        printOutput(output)\n        ping := Ping{}\n        parseOutput(output, &amp;ping)\n\n        fmt.Println(ping)\n}\n\nfunc printCommand(cmd *exec.Cmd) {\n        fmt.Printf(\"==&gt; Executing: %s\\n\", strings.Join(cmd.Args, \" \"))\n}\n\nfunc printError(err error) {\n        if err != nil {\n                os.Stderr.WriteString(fmt.Sprintf(\"==&gt; Error: %s\\n\", err.Error()))\n        }\n}\n\nfunc printOutput(outs []byte) {\n        if len(outs) &gt; 0 {\n                fmt.Printf(\"==&gt; Output: %s\\n\", string(outs))\n        }\n}\n\nfunc parseOutput(outs []byte, ping *Ping) {\n        var average = regexp.MustCompile(`Average = (\\d+ms)`)\n        result := average.FindStringSubmatch(string(outs))\n\n        if len(result) &gt; 0 {\n                ping.average, _ = time.ParseDuration(result[1])\n        }\n        // Linux version\n        /*var average = regexp.MustCompile(`min\\/avg\\/max\\/mdev = (0\\.\\d+)\\/(0\\.\\d+)\\/(0\\.\\d+)\\/(0\\.\\d+) ms`)\n        result := average.FindAllStringSubmatch(string(outs), -1)\n\n        if len(result) &gt; 0 {\n                ping.average, _ = time.ParseDuration(result[0][2] + \"ms\")\n        }*/\n}\n</code></pre>\n"}], "owner": {"reputation": 404, "user_id": 6757551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f817b964323633a387c6ee603915bbe?s=128&d=identicon&r=PG&f=1", "display_name": "as.beaulieu", "link": "https://stackoverflow.com/users/6757551/as-beaulieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4630, "favorite_count": 1, "accepted_answer_id": 42261688, "answer_count": 1, "score": 1, "last_activity_date": 1487199461, "creation_date": 1487021732, "question_id": 42213996, "link": "https://stackoverflow.com/questions/42213996/trying-to-parse-a-stdout-on-command-line-with-golang", "title": "Trying to parse a stdout on command line with Golang", "body": "<p>I'm practicing to use GoLang to pass arguements to the command line, and being able to parse information from the results that are passed out. For example, I have code that is designed to execute a command, and display what will display anyway if the command was entered through cmd anyway.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n    \"strings\"\n)\n\nfunc main() {\n    cmd = exec.Command(\"ping\", \"8.8.8.8\")\n    cmdOutput = &amp;bytes.Buffer{}\n    cmd.Stdout = cmdOutput\n    printCommand(cmd)\n    err = cmd.Run()\n    printError(err)\n    printOutput(cmdOutput.Bytes())\n}\n\nfunc printCommand(cmd *exec.Cmd) {\n    fmt.Printf(\"==&gt; Executing: %s\\n\", strings.Join(cmd.Args, \" \"))\n}\n\nfunc printError(err error) {\n    if err != nil {\n        os.Stderr.WriteString(fmt.Sprintf(\"==&gt; Error: %s\\n\", err.Error()))\n    }\n}\n\nfunc printOutput(outs []byte) {\n    if len(outs) &gt; 0 {\n        fmt.Printf(\"==&gt; Output: %s\\n\", string(outs))\n    }\n}\n</code></pre>\n\n<p>Considering the output would be: </p>\n\n<pre><code>==&gt; Executing: ping 8.8.8.8\n==&gt; Output:\nPinging 8.8.8.8 with 32 bytes of data:\nReply from 8.8.8.8: bytes=32 time=13ms TTL=56\nReply from 8.8.8.8: bytes=32 time=13ms TTL=56\nReply from 8.8.8.8: bytes=32 time=14ms TTL=56\nReply from 8.8.8.8: bytes=32 time=11ms TTL=56\n\nPing statistics for 8.8.8.8:\n    Packets: Sent = 4, Received = 4, Lost = 0 (0% lo\nApproximate round trip times in milli-seconds:\n    Minimum = 11ms, Maximum = 14ms, Average = 12ms\n</code></pre>\n\n<p>My question is: If I wanted to parse the Average response time, so I can assign that to a variable so I can display that when I want to, how can I parse that? </p>\n"}, {"tags": ["go", "memory-leaks", "concurrency"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 7, "creation_date": 1487015638, "post_id": 42212381, "comment_id": 71586094, "body": "You&#39;re copying the <code>sync.WaitGroup</code>; pass a pointer to it instead."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1487015784, "post_id": 42212381, "comment_id": 71586188, "body": "running <code>go vet</code> will show you the error."}, {"owner": {"reputation": 49, "user_id": 7559494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gACto.jpg?s=128&g=1", "display_name": "dpog", "link": "https://stackoverflow.com/users/7559494/dpog"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1487016669, "post_id": 42212381, "comment_id": 71586673, "body": "Hi @TimCooper, in regards to the memory leak, you are correct! That does indeed fix issue #1, BUT in that scenario goroutine 4 runs far more than the others; when outputting to a .txt file, I can see that the first time #1 runs is line 1640001. That doesn&#39;t make much sense to me."}, {"owner": {"reputation": 2119, "user_id": 3447910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2HdtL.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/3447910/greg"}, "edited": false, "score": 3, "creation_date": 1487016790, "post_id": 42212381, "comment_id": 71586738, "body": "@dpog your output for <code>n</code> isn&#39;t what you&#39;re expecting it to be. See: <a href=\"https://github.com/golang/go/wiki/CommonMistakes#using-goroutines-on-loop-iterator-variables\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 7559494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gACto.jpg?s=128&g=1", "display_name": "dpog", "link": "https://stackoverflow.com/users/7559494/dpog"}, "is_accepted": false, "score": 2, "last_activity_date": 1487017943, "creation_date": 1487017943, "answer_id": 42213004, "question_id": 42212381, "link": "https://stackoverflow.com/questions/42212381/why-does-this-golang-program-create-a-memory-leak/42213004#42213004", "title": "Why does this golang program create a memory leak?", "body": "<p>Thanks to Tim Cooper, JimB, and Greg for their helpful comments. The corrected version of the code is posted below for reference.</p>\n\n<p>The two fixes were to pass in the <strong>WaitGroup</strong> by reference, which fixed the memory leak, and to pass <strong>n</strong> correctly into the anonymous goroutine, and</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n  var wg sync.WaitGroup\n    for {\n      // spawn four worker goroutines\n      spawnWorkers(4,&amp;wg)\n      // wait for the workers to finish\n      wg.Wait()\n    }\n}\n\nfunc spawnWorkers(max int, wg *sync.WaitGroup) {\n  for n := 0; n &lt; max; n++ {\n        wg.Add(1)\n        go func(n int) {\n            defer wg.Done()\n            f(n)\n          return\n        }(n)\n    }   \n}\n\nfunc f(n int) {\n    for i := 0; i &lt; 1000; i++ {\n      fmt.Println(n, \":\", i)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 7559494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gACto.jpg?s=128&g=1", "display_name": "dpog", "link": "https://stackoverflow.com/users/7559494/dpog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487017943, "creation_date": 1487015462, "question_id": 42212381, "link": "https://stackoverflow.com/questions/42212381/why-does-this-golang-program-create-a-memory-leak", "title": "Why does this golang program create a memory leak?", "body": "<p>I am trying to understand concurrency and goroutines, and had a couple questions about the following experimental code:</p>\n\n<ol>\n<li>Why does it create a memory leak? I thought that a return at the end of the goroutine would allow memory associated with it to get cleaned up.</li>\n<li>Why do my loops almost never reach 999? In fact, when I output to a file and study the output, I notice that it rarely prints integers in double digits; the first time it prints \"99\" is line 2461, and for \"999\" line 6120. This behavior is unexpected to me, which clearly means I don't really understand what is going on with goroutine scheduling. </li>\n</ol>\n\n<p>Disclaimer: </p>\n\n<p><strong>Be careful running the code below, it can crash your system if you don't stop it after a few seconds!</strong></p>\n\n<p>CODE</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n  var wg sync.WaitGroup\n    for {\n      // spawn four worker goroutines\n      spawnWorkers(4, wg)\n      // wait for the workers to finish\n      wg.Wait()\n    }\n}\n\nfunc spawnWorkers(max int, wg sync.WaitGroup) {\n  for n := 0; n &lt; max; n++ {\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            f(n)\n          return\n        }()\n    }   \n}\n\nfunc f(n int) {\n    for i := 0; i &lt; 1000; i++ {\n      fmt.Println(n, \":\", i)\n    }\n}\n</code></pre>\n"}, {"tags": ["rest", "api", "go", "bots", "botframework"], "comments": [{"owner": {"reputation": 2119, "user_id": 3447910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2HdtL.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/3447910/greg"}, "edited": false, "score": 0, "creation_date": 1487013238, "post_id": 42211664, "comment_id": 71584716, "body": "Could you some sample code to show how you are making the request and sending the token?"}, {"owner": {"reputation": 23, "user_id": 4795441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0f6f367fd721f2d33dbcf6edd3e021?s=128&d=identicon&r=PG&f=1", "display_name": "rjxby", "link": "https://stackoverflow.com/users/4795441/rjxby"}, "reply_to_user": {"reputation": 2119, "user_id": 3447910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2HdtL.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/3447910/greg"}, "edited": false, "score": 0, "creation_date": 1487013672, "post_id": 42211664, "comment_id": 71584953, "body": "Yeah, thanks for the comments I added code sample."}, {"owner": {"reputation": 6783, "user_id": 5935112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ymenn.jpg?s=128&g=1", "display_name": "Just Shadow", "link": "https://stackoverflow.com/users/5935112/just-shadow"}, "edited": false, "score": 0, "creation_date": 1487014728, "post_id": 42211664, "comment_id": 71585582, "body": "Try setting Accept header too:   req.Header.Set(&quot;Accept&quot;, &quot;application/json&quot;)"}, {"owner": {"reputation": 13207, "user_id": 2573335, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ae4ba2948224d10514e51d7ea2abbf2?s=128&d=identicon&r=PG", "display_name": "rnrneverdies", "link": "https://stackoverflow.com/users/2573335/rnrneverdies"}, "edited": false, "score": 0, "creation_date": 1487087391, "post_id": 42211664, "comment_id": 71620410, "body": "<i>&quot;Invalid JSON: Unexpected token \\n in JSON at position 77&quot;</i>. Did you validate the JSON sent by using any JSON validation tool such as <a href=\"http://jsonlint.com/\" rel=\"nofollow noreferrer\">jsonlint.com</a>?"}, {"owner": {"reputation": 23, "user_id": 4795441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0f6f367fd721f2d33dbcf6edd3e021?s=128&d=identicon&r=PG&f=1", "display_name": "rjxby", "link": "https://stackoverflow.com/users/4795441/rjxby"}, "edited": false, "score": 0, "creation_date": 1487093419, "post_id": 42211664, "comment_id": 71624658, "body": "Adding req.Header.Set(&quot;Accept&quot;, &quot;application/json&quot;) to header not helped."}, {"owner": {"reputation": 23, "user_id": 4795441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0f6f367fd721f2d33dbcf6edd3e021?s=128&d=identicon&r=PG&f=1", "display_name": "rjxby", "link": "https://stackoverflow.com/users/4795441/rjxby"}, "edited": false, "score": 0, "creation_date": 1487093993, "post_id": 42211664, "comment_id": 71625018, "body": "Yep I make mistake into formatting json, thanks a lot!"}], "owner": {"reputation": 23, "user_id": 4795441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0f6f367fd721f2d33dbcf6edd3e021?s=128&d=identicon&r=PG&f=1", "display_name": "rjxby", "link": "https://stackoverflow.com/users/4795441/rjxby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487014030, "creation_date": 1487012851, "last_edit_date": 1487014030, "question_id": 42211664, "link": "https://stackoverflow.com/questions/42211664/cant-send-massage-to-botconnector-v3-using-rest-api-authentication", "title": "Can&#39;t send massage to BotConnector V3 using REST API authentication", "body": "<p>I try to send message to Bot Connector service. First of all I have successfully log in to the MSA/AAD v2 service and retrieve a token. \nFor example I received: <code>{\"token_type\":\"Bearer\",\"expires_in\":3599,\"ext_expires_in\":0,\"access_token\":\"eyJ0eXAi...}</code> \nso my next step is send this token to the Bot Connector service and I try to send message use next url and header</p>\n\n<pre><code>POST /v3/conversations/12345/activities/67890\nAuthorization: Bearer eyJ0eXAi...\n</code></pre>\n\n<p>but, I received next response </p>\n\n<pre><code>{\"code\":\"InvalidContent\",\"message\":\"Invalid JSON: Unexpected token \\n in JSON at position 77\"}\n</code></pre>\n\n<p>with status code 400.</p>\n\n<p>My code sample </p>\n\n<pre><code>req, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(jsonStr))\nif err != nil {\n    fmt.Println(err)\n}\n\nreq.Header.Set(\"Content-Type\", \"application/json\")\nreq.Header.Set(\"Authorization\", token)\n\ntr := &amp;http.Transport{\n    TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n}\nclient := &amp;http.Client{Transport: tr}\n\nresp, err := client.Do(req)\nif err != nil {\n    fmt.Println(err)\n}\ndefer resp.Body.Close()\n</code></pre>\n\n<p>What I am doing wrong?</p>\n"}, {"tags": ["google-app-engine", "pointers", "go", "google-app-engine-go"], "comments": [{"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487005985, "post_id": 42209650, "comment_id": 71580540, "body": "I am knew in golang. I know this is can be considered as out of bounds reads, but this is required to know if a particular system call is enabled."}], "answers": [{"comments": [{"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487006287, "post_id": 42209751, "comment_id": 71580710, "body": "thanks, is there a way to do it with <code>fmt.Printf()</code> or <code>syscall.Write()</code>instead of using <code>syscall.Syscall</code>directly\u202f?"}, {"owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "reply_to_user": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487009310, "post_id": 42209751, "comment_id": 71582473, "body": "It looks like JimB&#39;s answer covers it."}], "tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": false, "score": 1, "last_activity_date": 1487006070, "creation_date": 1487006070, "answer_id": 42209751, "question_id": 42209650, "link": "https://stackoverflow.com/questions/42209650/how-to-fmt-println-memory-not-allocated-by-the-go-program/42209751#42209751", "title": "How to fmt.Println() memory not allocated by the go program?", "body": "<p>The immediate problem you are facing is that you should convert 0x10000 directly to uintptr instead of through unsafe.Pointer. I don't know if fixing that will solve the rest of your problem or not.</p>\n"}, {"comments": [{"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487008747, "post_id": 42210190, "comment_id": 71582109, "body": "What does the part<code>[1 &lt;&lt; 30]byte</code>means\u202f?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487008867, "post_id": 42210190, "comment_id": 71582183, "body": "@user2284570: that&#39;s an array type with a size of <code>1&lt;&lt;30</code>"}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487023197, "post_id": 42210190, "comment_id": 71589985, "body": "Is there a way to print that kind of array without the syscall package ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487023465, "post_id": 42210190, "comment_id": 71590113, "body": "@user2284570: You can&#39;t print <i>anything</i> without the syscall package, because writing to a file descriptor requires a syscall. Or are you asking how to write the data to stdout/stderr without importing syscall yourself? e.g. <code>os.Stdout.Write(mem)</code>?"}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487023550, "post_id": 42210190, "comment_id": 71590165, "body": "Yes, I need something that can be used with the<code>fmt</code>package. You should noticed that I was using the number<code>1</code>as file descriptor in my question."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487023926, "post_id": 42210190, "comment_id": 71590334, "body": "A slice can be use with the format package, what is it you expect to see by printing the binary memory contents?"}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487024015, "post_id": 42210190, "comment_id": 71590367, "body": "Hemmm thanks, finally it appears the unsafe package isn\u2019t available<code>bad import &quot;unsafe&quot; in main.go</code>. This what I feared."}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487025191, "post_id": 42210190, "comment_id": 71590932, "body": "Is there a way without the <code>unsafe</code> <code>syscall</code> and <code>cgo</code> package ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "edited": false, "score": 0, "creation_date": 1487025273, "post_id": 42210190, "comment_id": 71590961, "body": "@user2284570: Go is a memory safe language, you can&#39;t read arbitrary memory without specifically using the unsafe package (or a syscall to do it for you)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1487008584, "last_edit_date": 1487008584, "creation_date": 1487007724, "answer_id": 42210190, "question_id": 42209650, "link": "https://stackoverflow.com/questions/42209650/how-to-fmt-println-memory-not-allocated-by-the-go-program/42210190#42210190", "title": "How to fmt.Println() memory not allocated by the go program?", "body": "<p>You can convert that address to a slice of bytes, which can then be passed to any <code>Write</code> method.</p>\n\n<p>To convert the address <code>0x10000</code> to a slice of bytes with a length of <code>0x30000</code>, you would use</p>\n\n<pre><code>mem := (*[1 &lt;&lt; 30]byte)(unsafe.Pointer(uintptr(0x10000)))[:0x30000:0x30000]\n</code></pre>\n\n<p>If the size is always static, you could just set the array to the proper size to start</p>\n\n<pre><code>mem := (*[0x30000]byte)(unsafe.Pointer(uintptr(0x10000)))[:]\n</code></pre>\n"}], "owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 42210190, "answer_count": 2, "score": 0, "last_activity_date": 1487025266, "creation_date": 1487005772, "last_edit_date": 1487025266, "question_id": 42209650, "link": "https://stackoverflow.com/questions/42209650/how-to-fmt-println-memory-not-allocated-by-the-go-program", "title": "How to fmt.Println() memory not allocated by the go program?", "body": "<p>I\u2019d like to print the virtual memory content of the current program from <code>0x10000</code> to <code>0x50000</code> <em>(an area containing a syscall trampoline on my system)</em>.</p>\n\n<pre><code>package main\n\nimport (\n    \"syscall\"\n    \"unsafe\"\n)\nfunc main() {\n    syscall.Syscall(SYS_WRITE, uintptr(1), uintptr(unsafe.Pointer(0x10000)), uintptr(0x40000))\n}\n</code></pre>\n\n<p>However when I tried to compile I\u2019m getting that error\u00a0:</p>\n\n<pre><code>cannot convert 65536 (type int) to type unsafe.Pointer\n</code></pre>\n\n<p>In my case,<code>cgo</code> is disabled <em>(<code>import \"C\"</code> fails at compile time)</em>.<br>\nAlso does <code>syscall.Syscall(SYS_WRITE</code> is the only way to do it\u202f?</p>\n"}, {"tags": ["xml", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1487005679, "post_id": 42209427, "comment_id": 71580354, "body": "<a href=\"https://github.com/golang/go/issues/9519\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/9519</a> -- last comment suggests that only prefixed attributes (not elements) are supported."}, {"owner": {"reputation": 643, "user_id": 7552759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ldvQc.jpg?s=128&g=1", "display_name": "Anurope", "link": "https://stackoverflow.com/users/7552759/anurope"}, "reply_to_user": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1487005857, "post_id": 42209427, "comment_id": 71580460, "body": "How would I go about extracting just the prefixed attributes? Example: <code>meta:word-count=&quot;0&quot;</code> or are they also not accessible because the tag is name-spaced?"}, {"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1487008249, "post_id": 42209427, "comment_id": 71581814, "body": "Here&#39;s an updated version of your playground <a href=\"https://play.golang.org/p/YFO5jp70gN\" rel=\"nofollow noreferrer\">code</a> that may help."}, {"owner": {"reputation": 643, "user_id": 7552759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ldvQc.jpg?s=128&g=1", "display_name": "Anurope", "link": "https://stackoverflow.com/users/7552759/anurope"}, "reply_to_user": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1487009195, "post_id": 42209427, "comment_id": 71582393, "body": "@DmitriGoldring It does indeed work. Thanks. Do you mind elaborating what I was doing wrong? Does the struct layout have to correspond to the tag layout?"}, {"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1487009625, "post_id": 42209427, "comment_id": 71582645, "body": "In theory you can skip into sub-elements with <code>&gt;</code>, but it&#39;s definitely easier to reason about the unmarshalling when it fairly directly maps to the structs."}, {"owner": {"reputation": 643, "user_id": 7552759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ldvQc.jpg?s=128&g=1", "display_name": "Anurope", "link": "https://stackoverflow.com/users/7552759/anurope"}, "reply_to_user": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1487009869, "post_id": 42209427, "comment_id": 71582788, "body": "@DmitriGoldring Great, seems like it was just a newbie mistake. Do you mind posting the code from playground as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "is_accepted": true, "score": 3, "last_activity_date": 1487011272, "creation_date": 1487011272, "answer_id": 42211215, "question_id": 42209427, "link": "https://stackoverflow.com/questions/42209427/unmarshal-namespaced-xml-tags-golang/42211215#42211215", "title": "Unmarshal namespaced XML tags - Golang", "body": "<p>You will find that things go more smoothly if your structs map fairly directly to the XML. This code should get you started:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\ntype Stats struct {\n    XMLName   xml.Name\n    PageCount int `xml:\"page-count,attr\"`\n}\n\ntype Meta struct {\n    XMLName xml.Name\n    Date    string `xml:\"creation-date\"`\n    Title   string `xml:\"title\"`\n    Stats   Stats  `xml:\"document-statistic\"`\n}\n\ntype DocumentMeta struct {\n    XMLName xml.Name\n    Meta    Meta `xml:\"meta\"`\n}\n\nvar data = []byte(`&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;office:document-meta&gt;\n    &lt;office:meta&gt;\n        &lt;meta:creation-date&gt;2016-10-18T15:05:19.137453293&lt;/meta:creation-date&gt;\n        &lt;dc:title&gt;Document&lt;/dc:title&gt;\n        &lt;dc:date&gt;2017-01-17T00:59:04.731054728&lt;/dc:date&gt;\n        &lt;meta:document-statistic meta:page-count=\"1\" meta:word-count=\"0\" meta:character-count=\"0\"/&gt;\n    &lt;/office:meta&gt;\n&lt;/office:document-meta&gt;`)\n\nfunc main() {\n    var dm DocumentMeta\n    xml.Unmarshal(data, &amp;dm)\n    fmt.Println(dm)\n}\n</code></pre>\n"}], "owner": {"reputation": 643, "user_id": 7552759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ldvQc.jpg?s=128&g=1", "display_name": "Anurope", "link": "https://stackoverflow.com/users/7552759/anurope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2529, "favorite_count": 0, "accepted_answer_id": 42211215, "answer_count": 1, "score": 2, "last_activity_date": 1487011272, "creation_date": 1487005041, "last_edit_date": 1487006930, "question_id": 42209427, "link": "https://stackoverflow.com/questions/42209427/unmarshal-namespaced-xml-tags-golang", "title": "Unmarshal namespaced XML tags - Golang", "body": "<p>I'm trying to extract metadata from an <code>.odt</code> document.</p>\n\n<p>The file containing XML is called <code>meta.xml</code></p>\n\n<p>It has this structure:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\"  xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" office:version=\"1.2\"&gt;\n    &lt;office:meta&gt;\n        &lt;meta:creation-date&gt;2016-10-18T15:05:19.137453293&lt;/meta:creation-date&gt;\n        &lt;dc:title&gt;Document&lt;/dc:title&gt;\n        &lt;dc:date&gt;2017-01-17T00:59:04.731054728&lt;/dc:date&gt;\n        &lt;meta:document-statistic meta:page-count=\"1\" meta:word-count=\"0\" meta:character-count=\"0\"/&gt;\n    &lt;/office:meta&gt;\n&lt;/office:document-meta&gt;\n</code></pre>\n\n<p>I'm using <code>xml.Unmarshal()</code> from the <code>encoding/xml</code> package to parse the XML and place the values inside struct fields.</p>\n\n<p>This is the struct I'm using:</p>\n\n<pre><code>type Query struct {\n    CreationDate string `xml:\"\"`\n    PageCount int `xml:\"\"`\n    WordCount int `xml:\"\"`\n    CharCount int `xml:\"\"`\n}\n</code></pre>\n\n<p>What I understood from the available documentation is that I can use field tags of type <code>xml:\"tag-name\"</code> to get the value of the XML tag, and <code>xml:name,attr</code> to get the attribute value.</p>\n\n<p>However, since the XML file has namespaced tags (e.g. <code>meta:creation-date</code>) everything I've tried so far leaves the struct fields empty. Although, I might be doing something wrong.</p>\n\n<p>This is the entire program inside Go playground:\n<a href=\"https://play.golang.org/p/n7C50l1gsV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/n7C50l1gsV</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "edited": false, "score": 0, "creation_date": 1487004840, "post_id": 42209267, "comment_id": 71579866, "body": "Thank you but this starts with a string. The code I showed above is when you have been given a <code>[]byte</code> but need to convert it to a string and want to avoid a copy being made."}, {"owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "edited": false, "score": 0, "creation_date": 1487018527, "post_id": 42209267, "comment_id": 71587620, "body": "OK, that makes sense. The <code>s</code> is a copy of the header, so the data pointer and length get copied into new memory and the original header is a completely separate entity that is traced separately. Thanks!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1487014462, "last_edit_date": 1487014462, "creation_date": 1487004521, "answer_id": 42209267, "question_id": 42209149, "link": "https://stackoverflow.com/questions/42209149/what-happens-to-the-capacity-memory-when-using-unsafe-to-convert-a-byte-to-a/42209267#42209267", "title": "What happens to the &#39;capacity&#39; memory when using unsafe to convert a []byte to a string?", "body": "<p>The statement <code>var s = *(*string)(unsafe.Pointer(&amp;b))</code> copies the data and length from <a href=\"https://godoc.org/reflect#SliceHeader\" rel=\"nofollow noreferrer\">a slice header</a> value to a <a href=\"https://godoc.org/reflect#StringHeader\" rel=\"nofollow noreferrer\">string header</a> value. </p>\n\n<p>The statement does not change the runtime's interpretation of the slice header. The capacity is not dropped from the slice header.</p>\n\n<p>Copying the data and length only does not cause GC problems. </p>\n\n<ul>\n<li>The string header and slice header values are both valid after the copy operation. </li>\n<li>The garbage collector does not assume that the size of a string backing array is equal to the length in the string header. For example, the GC handles the safe code <code>s := \"foobarxxx\"[:6]</code> where the string header <code>s</code> has length 6 and the backing array has size 9.</li>\n</ul>\n"}], "owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 42209267, "answer_count": 1, "score": 3, "last_activity_date": 1487014462, "creation_date": 1487004192, "last_edit_date": 1487005299, "question_id": 42209149, "link": "https://stackoverflow.com/questions/42209149/what-happens-to-the-capacity-memory-when-using-unsafe-to-convert-a-byte-to-a", "title": "What happens to the &#39;capacity&#39; memory when using unsafe to convert a []byte to a string?", "body": "<p>I have seen people use <code>unsafe.Pointer</code> to efficiently convert a <code>[]byte</code> to a <code>string</code>. <a href=\"https://play.golang.org/p/uz84H54VM8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uz84H54VM8</a></p>\n\n<pre><code>var b = []byte{'f', 'o', 'o', 'b', 'a', 'r'}\nvar s = *(*string)(unsafe.Pointer(&amp;b))\n</code></pre>\n\n<p>I understand what it is doing as well as the dangers involved in general but have a question about the memory.</p>\n\n<p>Since the structure of a slice has a data pointer, a length, and a capacity, but the string doesn't have the capacity, what happens to that memory if <code>b</code> was created on the heap? Does the garbage collector know that it needs to track the capacity separately? Or could this cause a memory leak?</p>\n\n<p>EDIT:</p>\n\n<p>I understand how to reslice strings and slices. The above code is for when you need to convert from <code>[]byte</code> to <code>string</code> but want to avoid a full copy.</p>\n\n<p>The question is about the <code>capacity</code> that we're dropping from the structure and if it causes GC problems.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 1, "creation_date": 1487202834, "post_id": 42209109, "comment_id": 71682136, "body": "It may have failed to install a dependency. What does it say in <code>&#47;var&#47;log&#47;eb-activity.log</code> file?"}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 1, "creation_date": 1487605608, "post_id": 42209109, "comment_id": 71848698, "body": "Why don&#39;t you vendor the dependencies and then zip the code. No need to do <code>go get .&#47;...</code>."}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1487720450, "post_id": 42209109, "comment_id": 71909327, "body": "It looks like foreman failing, is your Procfile valid?"}, {"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "reply_to_user": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1487729407, "post_id": 42209109, "comment_id": 71911909, "body": "@KennyGrant My Procfile is taken pretty much from the AWS documentation"}, {"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "reply_to_user": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 0, "creation_date": 1487729508, "post_id": 42209109, "comment_id": 71911932, "body": "@MayankPatel I could easily do that except I would have to vendor from the <code>cmd</code> folder which to me that just seems wrong"}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1487755904, "post_id": 42209109, "comment_id": 71923351, "body": "To debug this solution you&#39;d probably have to provide more info, why don&#39;t you put up a minimal problematic setup on github or similar and people can try it out. I&#39;d rule out the procfile first by setting up a simple project with a procfile that works, then substitute in your one. Hard to debug without more info though."}, {"owner": {"reputation": 429, "user_id": 1718121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiLXs.png?s=128&g=1", "display_name": "Lrdwhyt", "link": "https://stackoverflow.com/users/1718121/lrdwhyt"}, "edited": false, "score": 0, "creation_date": 1513437017, "post_id": 42209109, "comment_id": 82658091, "body": "mass&#39;s comment was what helped with this error - for me, looking in the logs revealed that build.sh didn&#39;t have permission to execute (chmod +x) so I changed my buildfile to <code>make: sh build.sh</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "edited": false, "score": 0, "creation_date": 1487729371, "post_id": 42380323, "comment_id": 71911901, "body": "This is the approach I&#39;ve had to take not the way I wanted it to be plus I don&#39;t like the fact that it adds a bin folder to my application but it seems to be the easiest solution"}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "reply_to_user": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "edited": false, "score": 1, "creation_date": 1487755786, "post_id": 42380323, "comment_id": 71923235, "body": "I use this solution personally and am quite happy with it, you can use the latest Go 1.8 (AWS is on Go 1.6 isn&#39;t it?), it speeds up deploys, and you can see and fix any errors locally before upload, and it makes you less dependent on AWS infrastructure as it can be used anywhere (GC, VPS etc). I don&#39;t mind the bin folder :)"}, {"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "edited": false, "score": 0, "creation_date": 1487781229, "post_id": 42380323, "comment_id": 71941453, "body": "I&#39;m gonna go ahead to check this answer it doesn&#39;t fully &quot;answer&quot; the question but its does provide a working solution."}, {"owner": {"reputation": 538, "user_id": 383848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76638af162f7d3ada4ac6d79eb7145ce?s=128&d=identicon&r=PG", "display_name": "Phrozen", "link": "https://stackoverflow.com/users/383848/phrozen"}, "edited": false, "score": 0, "creation_date": 1500489930, "post_id": 42380323, "comment_id": 77364478, "body": "This is great! This will allow me to use Go 1.8! but how about the folder structure, assets and such, do I keep them all the same? Just add the bin/application? Can I write to disk in a relative folder (ie. ./data) with this approach?"}, {"owner": {"reputation": 95, "user_id": 4831129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d862678e0685156ddeecdc9653d870d?s=128&d=identicon&r=PG", "display_name": "Paul Slevin", "link": "https://stackoverflow.com/users/4831129/paul-slevin"}, "edited": false, "score": 0, "creation_date": 1593417547, "post_id": 42380323, "comment_id": 110762996, "body": "Bit late to the party here, but you can include the above line in build.sh, meaning you don&#39;t need to include the binary in your source file"}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 2, "last_activity_date": 1487721948, "creation_date": 1487721948, "answer_id": 42380323, "question_id": 42209109, "link": "https://stackoverflow.com/questions/42209109/deploying-golang-app-in-cmd-folder-to-aws-beanstalk/42380323#42380323", "title": "Deploying golang app in cmd folder to AWS Beanstalk", "body": "<p>Another approach here instead of using a procfile etc would be to cross-compile your binary (usually pretty painless in go) and upload it that way, as per the simple instructions in the guide:</p>\n\n<p><a href=\"http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/go-environment.html\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/go-environment.html</a></p>\n\n<p>You can just compile it locally with:</p>\n\n<pre><code>GOARCH=amd64 GOOS=linux go build -o bin/application ./cmd/vano \n</code></pre>\n\n<p>Then upload zip of the application file and it should work, assuming your setup only requires this one binary to run.</p>\n"}], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1597, "favorite_count": 1, "accepted_answer_id": 42380323, "answer_count": 1, "score": 9, "last_activity_date": 1487721948, "creation_date": 1487004076, "question_id": 42209109, "link": "https://stackoverflow.com/questions/42209109/deploying-golang-app-in-cmd-folder-to-aws-beanstalk", "title": "Deploying golang app in cmd folder to AWS Beanstalk", "body": "<p>I have a pre-existing golang project with the a following folder structure (minimized the folder for readability).</p>\n\n<pre><code>- postgre\n    - service.go\n- cmd\n    - vano\n        - main.go\n    - vanoctl\n        - main.go\nvano.go\n</code></pre>\n\n<p>Now since my project web server is in <code>./cmd/vano</code> I need to create a custom <code>Buildfile</code> and <code>Procfile</code>. So I did that</p>\n\n<p>Here is my Buildfile</p>\n\n<pre><code>make: ./build.sh\n</code></pre>\n\n<p>build.sh file:</p>\n\n<pre><code>#!/usr/bin/env bash\n\n# Install dependencies.\ngo get ./...\n# Build app\ngo build ./cmd/vano -o bin/application\n</code></pre>\n\n<p>and finally my Procfile:</p>\n\n<pre><code>web: bin/application\n</code></pre>\n\n<p>So now my folder structure looks like this:</p>\n\n<pre><code>- postgre\n    - service.go\n- cmd\n    - vano\n        - main.go\n    - vanoctl\n        - main.go\nvano.go\nBuildfile\nbuild.sh\nProcfile\n</code></pre>\n\n<p>I zip up the source using git:</p>\n\n<pre><code>git archive --format=zip HEAD &gt; vano.zip\n</code></pre>\n\n<p>And upload it to AWS Beanstalk. How ever I keep getting errors and AWS errors don't seem to be the most read. Here is my error</p>\n\n<pre><code>Command execution completed on all instances. Summary: [Successful: 0, Failed: 1].\n</code></pre>\n\n<p>Error Message</p>\n\n<pre><code>[Instance: i-0d8f642474e3b2c68] Command failed on instance. Return code: 1 Output: (TRUNCATED)...' Failed to execute 'HOME=/tmp /opt/elasticbeanstalk/lib/ruby/bin/ruby /opt/elasticbeanstalk/lib/ruby/bin/foreman start --procfile /tmp/d20170213-1941-1baz0rh/eb-buildtask-0 --root /var/app/staging --env /var/elasticbeanstalk/staging/elasticbeanstalk.env'. Hook /opt/elasticbeanstalk/hooks/appdeploy/pre/01_configure_application.sh failed. For more detail, check /var/log/eb-activity.log using console or EB CLI.\n</code></pre>\n\n<p>Extra Error info:</p>\n\n<pre><code>Failed to execute 'HOME=/tmp /opt/elasticbeanstalk/lib/ruby/bin/ruby /opt/elasticbeanstalk/lib/ruby/bin/foreman start --procfile /tmp/d20170213-1941-1baz0rh/eb-buildtask-0 --root /var/app/staging --env /var/elasticbeanstalk/staging/elasticbeanstalk.env'\n</code></pre>\n"}, {"tags": ["rest", "variables", "go", "scope", "package"], "comments": [{"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 0, "creation_date": 1487014063, "post_id": 42209040, "comment_id": 71585182, "body": "Could you provide your non-working source for this? (given your explanation everything seems to be in order)"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 7544942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49575411fc07e4c62d554b265dadc884?s=128&d=identicon&r=PG&f=1", "display_name": "St&#233;phane MERLE", "link": "https://stackoverflow.com/users/7544942/st%c3%a9phane-merle"}, "is_accepted": false, "score": 1, "last_activity_date": 1487168982, "creation_date": 1487168982, "answer_id": 42252136, "question_id": 42209040, "link": "https://stackoverflow.com/questions/42209040/golang-gin-gonic-and-splitting-files-in-package/42252136#42252136", "title": "golang gin-gonic and splitting files in package", "body": "<p>I did manage to make it work by \"sending\" the router in the LoadTodo function :</p>\n\n<p>in apirest.go : </p>\n\n<pre><code>LoadTodo(Router)\n</code></pre>\n\n<p>and in todoCRUD.go :</p>\n\n<pre><code>func LoadTodo(r *gin.Engine){\n</code></pre>\n\n<p>and it's working fine ... I hope I didn't bring a bug failure in the code ...</p>\n\n<p>St\u00e9phane</p>\n"}], "owner": {"reputation": 15, "user_id": 7544942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49575411fc07e4c62d554b265dadc884?s=128&d=identicon&r=PG&f=1", "display_name": "St&#233;phane MERLE", "link": "https://stackoverflow.com/users/7544942/st%c3%a9phane-merle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1942, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490742851, "creation_date": 1487003838, "last_edit_date": 1487067651, "question_id": 42209040, "link": "https://stackoverflow.com/questions/42209040/golang-gin-gonic-and-splitting-files-in-package", "title": "golang gin-gonic and splitting files in package", "body": "<p>I am quite new to go and try to learn, I am setting up an application with a gin-gonic server.\nI managed to have it to work with everything in on main package, I would like to organize it better with all the apirest related in a package (which I manage) AND to split each group CRUD by file.</p>\n\n<p>so in the \"main\" file of the package within the init function, I defined : </p>\n\n<pre><code>Router := gin.New()\nRouter.Use(gin.Logger())\nRouter.Use(gin.Recovery())\n</code></pre>\n\n<p>and I though that I would be able in each other files of the package to use it like that : </p>\n\n<pre><code>v1 := Router.Group(\"/api/v1/todos\")\nv1.Use(AuthRequired())\n{\n    v1.POST(\"/\", CreateTodo)\n    v1.GET(\"/\", FetchAllTodo)\n    v1.GET(\"/:id\", FetchSingleTodo)\n    v1.PUT(\"/:id\", UpdateTodo)\n    v1.DELETE(\"/:id\", DeleteTodo)\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>packagename.Router.Group\n</code></pre>\n\n<p>but none are working and I get : </p>\n\n<blockquote>\n  <p>undefined: Router in Router.Group</p>\n</blockquote>\n\n<p>St\u00e9phane\nPS : I did setup a sub folder for the package and I am able to go build it if it's in one file.</p>\n\n<hr>\n\n<p>I though that the solution was to declare the Router variable as *gin.Engine but while it's compiling fine, I get a panic error on the Router.Group call </p>\n\n<p>let me post some more part of code : </p>\n\n<p>maincode.go : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"./apirest\"\n    \"github.com/braintree/manners\"\n)\n\nfunc main(){\n    fmt.Printf(\"hello world.\\n\")\n    //router.Run()\n    manners.ListenAndServe(\":8080\", apirest.Router)\n}\n</code></pre>\n\n<p>Then I split the apirest package in 2 files : </p>\n\n<p>apirest.go (I did manually cleanup, maybee I missed an import) : </p>\n\n<pre><code>package apirest\n\nimport (\n    \"fmt\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/braintree/manners\"\n    \"os\"\n    \"os/signal\"\n)\n\n//Router pour g\u00e9rer l'api\nvar Router *gin.Engine\n\n/*\n    MAIN FUNCTION\n*/\nfunc init() {\n\n    Router := gin.New()\n    Router.Use(gin.Logger())\n    Router.Use(gin.Recovery())\n\n    c := make(chan os.Signal, 1)\n    signal.Notify(c, os.Interrupt)\n    go func(){\n        for sig := range c {\n            // sig is a ^C, handle it\n            fmt.Printf(\"ctl+c catched \"+sig.String())\n            manners.Close()\n        }\n    }()\n\n    LoadMonitor()\n\n}\n</code></pre>\n\n<p>and then the todoCRUD.go file that handle all the declaration, the todoCRUD.go and apirest.go are in the same subfolder apirest (and compile ok) : </p>\n\n<pre><code>package apirest\n\nimport (\n    \"fmt\"\n    \"github.com/gin-gonic/gin\"\n    \"gopkg.in/validator.v2\"\n    \"github.com/jinzhu/gorm\"\n    \"strconv\"\n    \"net/http\"\n    \"time\"\n)\n\n//Todo definition d'un element todo\ntype Todo struct {\n    gorm.Model\n    CreatedAt   time.Time\n    UpdatedAt   time.Time\n    OwnerID     int    `json:\"ownerid\"  validate:\"nonzero\"`\n    URL         string `json:\"url\"`\n}\n\n//TransformedTodo version pour le retour d'api sans certaines infos\ntype TransformedTodo struct {\n    ID          uint   `json:\"id\"`\n    CreatedAt   time.Time\n    UpdatedAt   time.Time\n    OwnerID     uint   `json:\"ownerid\"`\n    URL         string `json:\"url\"`   \n}\n\n//LoadTodo permet de lancer le mappage todos\nfunc LoadTodo(){\n    v1 := Router.Group(\"/api/v1/todos\")\n    {\n        v1.POST(\"/\", CreateTodo)\n        v1.GET(\"/\", FetchAllTodo)\n        v1.GET(\"/:id\", FetchSingleTodo)\n        v1.PUT(\"/:id\", UpdateTodo)\n        v1.DELETE(\"/:id\", DeleteTodo)\n    }\n}\n\n//CreateTodo g\u00e9n\u00e9ration d'un todo\nfunc CreateTodo(c *gin.Context) {\n\n    owner, _ := strconv.Atoi(c.PostForm(\"ownerid\"))\n    todo := Todo{\n        OwnerID: owner,\n        URL: c.PostForm(\"url\"),\n    };\n    v := validator.NewValidator()\n    if errs := v.Validate(todo); errs!=nil {\n        errors := errs.(validator.ErrorMap)\n        var errOuts []string\n        for f, e := range errors {\n            errOuts = append(errOuts, fmt.Sprintf(\"\\t - %s (%v)\\n\", f, e))\n        }\n        //c.JSON(500, gin.H{\"Error\": errs.Error()})\n        c.JSON(500, gin.H{\"Erreur sur le(s) champ(s) : \": errOuts})\n    } else {\n\n        db, _ := Database()\n        defer db.Close()\n        db.Save(&amp;todo)\n\n        c.JSON(http.StatusCreated, gin.H{\"status\" : http.StatusCreated, \"message\" : \"Todo item created successfully!\", \"resourceId\": todo.ID})\n    }\n}\n\n//FetchAllTodo r\u00e9cup\u00e9ration de tous les todos\nfunc FetchAllTodo(c *gin.Context) {\n    var todos []Todo\n    var _todos []TransformedTodo\n\n    db, _ := Database()\n    defer db.Close()\n    db.Find(&amp;todos)\n\n    if (len(todos) &lt;= 0) {\n        c.JSON(http.StatusNotFound, gin.H{\"status\" : http.StatusNotFound, \"message\" : \"No todo found!\"})\n        return\n    }\n\n    //transforms the todos for building a good response,\n    //je peux choisir des champs a ne pas display\n    for _, item := range todos {\n        status := false\n        if (item.Status == 1) {\n            status = true\n        } else {\n            status = false\n        }\n        _todos = append(_todos, TransformedTodo{ID: item.ID, URL:item.URL})\n    }\n    c.JSON(http.StatusOK, gin.H{\"status\" : http.StatusOK, \"data\" : _todos})\n}\n\n//FetchSingleTodo R\u00e9cup\u00e9ration d'un seul todo en fonction de son id\nfunc FetchSingleTodo(c *gin.Context) {\n    var todo Todo\n    todoID := c.Param(\"id\")\n\n    db, _ := Database()\n    defer db.Close()\n    db.First(&amp;todo, todoID)\n\n    if (todo.ID == 0) {\n        c.JSON(http.StatusNotFound, gin.H{\"status\" : http.StatusNotFound, \"message\" : \"No todo found!\"})\n        return\n    }\n\n    _todo := TransformedTodo{ID: todo.ID, URL:todo.URL}\n    c.JSON(http.StatusOK, gin.H{\"status\" : http.StatusOK, \"data\" : _todo})\n}\n\n//UpdateTodo Mise \u00e0 jour d'un todo\nfunc UpdateTodo(c *gin.Context) {\n    var todo Todo\n    todoID := c.Param(\"id\")\n    db, _ := Database()\n    defer db.Close()\n    db.First(&amp;todo, todoID)\n\n    if (todo.ID == 0) {\n        c.JSON(http.StatusNotFound, gin.H{\"status\" : http.StatusNotFound, \"message\" : \"No todo found!\"})\n        return\n    }\n\n    db.Model(&amp;todo).Update(\"title\", c.PostForm(\"title\"))\n    db.Model(&amp;todo).Update(\"completed\", c.PostForm(\"completed\"))\n    c.JSON(http.StatusOK, gin.H{\"status\" : http.StatusOK, \"message\" : \"Todo updated successfully!\"})\n}\n\n\n//DeleteTodo Suppression d'un todo\nfunc DeleteTodo(c *gin.Context) {\n    var todo Todo\n    todoID := c.Param(\"id\")\n    db, _ := Database()\n    defer db.Close()\n    db.First(&amp;todo, todoID)\n\n    if (todo.ID == 0) {\n        c.JSON(http.StatusNotFound, gin.H{\"status\" : http.StatusNotFound, \"message\" : \"No todo found!\"})\n        return\n    }\n\n    db.Delete(&amp;todo)\n    c.JSON(http.StatusOK, gin.H{\"status\" : http.StatusOK, \"message\" : \"Todo deleted successfully!\"})\n}\n</code></pre>\n\n<p>The Idea is to have a xxxxCRUD.go file for each entity to handle but the whole folder in the same package.</p>\n\n<p>the exact errror is : </p>\n\n<blockquote>\n  <p>PS D:\\www\\developpement> go run .\\maincode.go [GIN-debug] [WARNING]\n  Running in \"debug\" mode. Switch to \"release\" mode in production.\n   - using env:   export GIN_MODE=release\n   - using code:  gin.SetMode(gin.ReleaseMode)</p>\n  \n  <p>panic: runtime error: invalid memory address or nil pointer\n  dereference [signal 0xc0000005 code=0x0 addr=0x0 pc=0x46cc0f]</p>\n  \n  <p>goroutine 1 [running]: panic(0x831880, 0xc04200a080)\n          C:/Go/src/runtime/panic.go:500 +0x1af\n  <em>/D</em>/www/developpement/apirest.LoadTodo()\n          D:/www/developpement/apirest/todoCRUD.go:33 +0x2f   [Router.Group]\n  <em>/D</em>/www/developpement/apirest.init.1()\n          D:/www/developpement/apirest/apirest.go:73 +0x220     [LoadTodo()]\n  <em>/D</em>/www/developpement/apirest.init()\n          D:/www/developpement/apirest/todoCRUD.go:190 +0x80  [last line] main.init()\n          D:/www/developpement/maincode.go:13 +0x3a         [manners.ListenAndServe(\":8080\", apirest.Router)] exit status 2</p>\n</blockquote>\n\n<p>I hope that this will help to understand !</p>\n\n<p>Thanks for your time and help !</p>\n\n<p>St\u00e9phane</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 764, "user_id": 1433380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66773480afdb4c66188850ed23269881?s=128&d=identicon&r=PG", "display_name": "Goranek", "link": "https://stackoverflow.com/users/1433380/goranek"}, "edited": false, "score": 0, "creation_date": 1487004323, "post_id": 42208498, "comment_id": 71579560, "body": "I&#39;m trying to escape using nested ifs ..because it would duplicate too much template code in between"}, {"owner": {"reputation": 764, "user_id": 1433380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66773480afdb4c66188850ed23269881?s=128&d=identicon&r=PG", "display_name": "Goranek", "link": "https://stackoverflow.com/users/1433380/goranek"}, "edited": false, "score": 0, "creation_date": 1487056809, "post_id": 42208498, "comment_id": 71600472, "body": "even though this isn&#39;t the real solution i&#39;m gonna accept it ."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 12, "last_activity_date": 1549893437, "last_edit_date": 1549893437, "creation_date": 1487002093, "answer_id": 42208498, "question_id": 42208440, "link": "https://stackoverflow.com/questions/42208440/go-template-and-function/42208498#42208498", "title": "Go template and function", "body": "<p>The template <code>and</code> function does not do <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"nofollow noreferrer\">short circuit</a> evaluation like the Go <code>&amp;&amp;</code> operator.</p>\n\n<p>The arguments to the <code>and</code> function are evaluated before the function is called. The expression <code>.User.Registered</code> is always evaluated, even if <code>.User</code> is nil. </p>\n\n<p>The fix is to use nested <code>if</code>:</p>\n\n<pre><code> {{if .User}}{{if .User.Registered}}  {{end}}{{end}}\n</code></pre>\n\n<p>You can avoid the nested <code>if</code> or <code>with</code> by using a template function:</p>\n\n<pre><code>func isRegistered(u *user) bool {\n  return u != nil &amp;&amp; u.Registered\n}\n\nconst tmpl = `{{if isRegistered .User}}registered{{else}}not registered{{end}}`\n\nt := template.Must(template.New(\"\").Funcs(template.FuncMap{\"isRegistered\": isRegistered}).Parse(tmpl))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/0qBR9qBnOz\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}, {"comments": [{"owner": {"reputation": 764, "user_id": 1433380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66773480afdb4c66188850ed23269881?s=128&d=identicon&r=PG", "display_name": "Goranek", "link": "https://stackoverflow.com/users/1433380/goranek"}, "edited": false, "score": 0, "creation_date": 1487004357, "post_id": 42208700, "comment_id": 71579582, "body": "unfortunately, this is the same as using nested ifs, which i&#39;m trying not to use"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 764, "user_id": 1433380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66773480afdb4c66188850ed23269881?s=128&d=identicon&r=PG", "display_name": "Goranek", "link": "https://stackoverflow.com/users/1433380/goranek"}, "edited": false, "score": 0, "creation_date": 1487061723, "post_id": 42208700, "comment_id": 71602916, "body": "@Goranek You did not mention that in your question."}, {"owner": {"reputation": 764, "user_id": 1433380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66773480afdb4c66188850ed23269881?s=128&d=identicon&r=PG", "display_name": "Goranek", "link": "https://stackoverflow.com/users/1433380/goranek"}, "edited": false, "score": 0, "creation_date": 1487149057, "post_id": 42208700, "comment_id": 71647648, "body": "sorry i thought it was obvious what i wanted to achieve :("}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1487003081, "last_edit_date": 1487003081, "creation_date": 1487002665, "answer_id": 42208700, "question_id": 42208440, "link": "https://stackoverflow.com/questions/42208440/go-template-and-function/42208700#42208700", "title": "Go template and function", "body": "<p>Another option is to use the <code>{{with}}</code> action instead of the <code>and</code> template function.</p>\n\n<p>Quoting from package doc of <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text/template</code></a>:</p>\n\n<blockquote>\n<pre><code>{{with pipeline}} T1 {{end}}\n    If the value of the pipeline is empty, no output is generated;\n    otherwise, dot is set to the value of the pipeline and T1 is\n    executed.\n</code></pre>\n</blockquote>\n\n<p>Using <code>{{with}}</code> often results in cleaner and shorter code, as inside the <code>{{with}}</code> the dot <code>.</code> is already set to the non-empty \"wrapper\", the <code>.User</code> in our case; moreover you don't have to worry about how and if the arguments of the <code>and</code> template function are evaluated.</p>\n\n<p>Your template rewritten:</p>\n\n<pre><code>{{with .User -}}\n    {{if .Registered}}REGISTERED{{end}}\n{{- end}}\n</code></pre>\n\n<p>Testing it without and with a user:</p>\n\n<pre><code>t := template.Must(template.New(\"\").Parse(tmpl))\n\nfmt.Println(\"No user:\")\nif err := t.Execute(os.Stdout, nil); err != nil {\n    panic(err)\n}\n\nu := struct{ Registered bool }{true}\nfmt.Printf(\"User: %+v\\n\", u)\nif err := t.Execute(os.Stdout, map[string]interface{}{\"User\": u}); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/F62nqRVpev\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>No user:\nUser: {Registered:true}\nREGISTERED\n</code></pre>\n"}], "owner": {"reputation": 764, "user_id": 1433380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66773480afdb4c66188850ed23269881?s=128&d=identicon&r=PG", "display_name": "Goranek", "link": "https://stackoverflow.com/users/1433380/goranek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3605, "favorite_count": 0, "accepted_answer_id": 42208498, "answer_count": 2, "score": 6, "last_activity_date": 1549893437, "creation_date": 1487001956, "last_edit_date": 1487003016, "question_id": 42208440, "link": "https://stackoverflow.com/questions/42208440/go-template-and-function", "title": "Go template and function", "body": "<p>In my go code I often use <code>if</code> like this</p>\n\n<pre><code>if user &amp;&amp; user.Registered { }\n</code></pre>\n\n<p>equivalent code in go templates would be</p>\n\n<pre><code>{{ if and .User .User.Registered }} {{ end }}\n</code></pre>\n\n<p>Unfortunately code in the template fails, if <code>.User</code> is <code>nil</code> :/ </p>\n\n<p>Is it possible to achieve the same thing in go templates?</p>\n"}, {"tags": ["go", "stream", "byte"], "answers": [{"comments": [{"owner": {"reputation": 799, "user_id": 675083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l75tP.jpg?s=128&g=1", "display_name": "sbs", "link": "https://stackoverflow.com/users/675083/sbs"}, "edited": false, "score": 0, "creation_date": 1487002944, "post_id": 42208606, "comment_id": 71578641, "body": "Thanks. I&#39;m trying to do this filter as part of (my copy of) os/exec&#39;s prefixSuffixSaver, and I&#39;m not quite sure how to use your code in that context."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 799, "user_id": 675083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l75tP.jpg?s=128&g=1", "display_name": "sbs", "link": "https://stackoverflow.com/users/675083/sbs"}, "edited": false, "score": 0, "creation_date": 1487003795, "post_id": 42208606, "comment_id": 71579220, "body": "@sbs: What I meant is you use a scanner and buffer <i>instead</i> of <code>myFilter</code>. This requires buffering the entire line, but your implementation has that same limitation."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1487010227, "last_edit_date": 1487010227, "creation_date": 1487002404, "answer_id": 42208606, "question_id": 42206739, "link": "https://stackoverflow.com/questions/42206739/correct-way-to-filter-a-byte-stream-in-golang/42208606#42208606", "title": "Correct way to filter a byte stream in Golang?", "body": "<p>Your partial line algorithm isn't correct for all inputs. </p>\n\n<p>You can replace <code>myFilter</code> with a <a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow noreferrer\"><code>bufio.Scanner</code></a>, which will handle the partial line buffering correctly for you, and a <code>[]byte</code> or <code>bytes.Buffer</code> to accumulate the output.</p>\n\n<pre><code>var out bytes.Buffer\nscanner := bufio.NewScanner(stdout)\nfor scanner.Scan() {\n    p := scanner.Bytes()\n    lines := bytes.Split(p, cr)\n    out.Write(lines[0])\n    out.Write(lf)\n    if len(lines) &gt; 1 {\n        out.Write(lines[len(lines)-1])\n        out.Write(lf)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 799, "user_id": 675083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l75tP.jpg?s=128&g=1", "display_name": "sbs", "link": "https://stackoverflow.com/users/675083/sbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 0, "accepted_answer_id": 42208606, "answer_count": 1, "score": 2, "last_activity_date": 1487010227, "creation_date": 1486996996, "question_id": 42206739, "link": "https://stackoverflow.com/questions/42206739/correct-way-to-filter-a-byte-stream-in-golang", "title": "Correct way to filter a byte stream in Golang?", "body": "<p>I want to filter the STDOUT from a command such that I only keep the first and last line of any contiguous block of \\r terminated lines (to largely ignore progress indicators).</p>\n\n<p>Here's my attempt (orig code does more, this is a simplified version, but basically the filtering has to happen as the input comes in, not at the end):</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"os/exec\"\n)\n\nvar cr = []byte(\"\\r\")\nvar lf = []byte(\"\\n\")\n\nfunc main() {\n    input1 := []byte(\"a\\nb\\n\\nprogress 98%\\r\")\n    input2 := []byte(\"progress 99%\\r\")\n    input3 := []byte(\"progress 100%\\r\")\n    input4 := []byte(\"\\n\\nc\\n\")\n\n    var stream []byte\n    stream = append(stream, input1...)\n    stream = append(stream, input2...)\n    stream = append(stream, input3...)\n    stream = append(stream, input4...)\n\n    fmt.Printf(\"stream:\\n%s\\n\", stream)\n\n    streamer := &amp;myFilter{}\n    streamer.Write(input1)\n    streamer.Write(input2)\n    streamer.Write(input3)\n    streamer.Write(input4)\n    final := streamer.Bytes()\n\n    fmt.Printf(\"streamer:\\n%s\\n\\n\", final)\n\n    cmd := exec.Command(\"bash\", \"-c\", \"perl -e '$|++; print qq[a\\nb\\n\\nprogress: 98%\\r]; for (99..100) { print qq[progess: $_%\\r]; sleep(1); } print qq[\\n\\nc\\n]'\")\n    cmd.Stdout = &amp;myFilter{}\n    cmd.Start()\n    cmd.Wait()\n    fromCmd := cmd.Stdout.(*myFilter).Bytes()\n\n    fmt.Printf(\"fromCmd:\\n%s\\n\", fromCmd)\n}\n\ntype myFilter struct {\n    partialLine []byte\n    storage     []byte\n}\n\nfunc (w *myFilter) Write(p []byte) (n int, err error) {\n    // in order to filter out all but the first and last line of a set of \\r\n    // terminated lines (a progress bar), we need to collect whole \\n terminated\n    // lines\n    lines := bytes.SplitAfter(p, lf)\n\n    if len(w.partialLine) &gt; 0 || (len(lines) == 1 &amp;&amp; !bytes.HasSuffix(p, lf)) {\n        w.partialLine = append(w.partialLine, lines[0]...)\n\n        partialComplete := false\n        if len(lines) &gt; 1 {\n            lines = lines[1:]\n            partialComplete = true\n\n        } else {\n            lines = nil\n            if bytes.HasSuffix(p, lf) {\n                partialComplete = true\n            }\n        }\n\n        if partialComplete {\n            w.filterCR(w.partialLine)\n            w.partialLine = nil\n        }\n    }\n\n    lastLineIndex := len(lines) - 1\n    if lastLineIndex &gt; -1 &amp;&amp; !bytes.HasSuffix(p, lf) {\n        w.partialLine, lines = lines[lastLineIndex], lines[:lastLineIndex]\n    }\n\n    for _, line := range lines {\n        w.filterCR(line)\n    }\n\n    return len(p), nil\n}\n\nfunc (w *myFilter) filterCR(p []byte) {\n    if bytes.Contains(p, cr) {\n        lines := bytes.Split(p, cr)\n        w.store(lines[0])\n        w.store(lf)\n\n        if len(lines) &gt; 2 {\n            w.store(lines[len(lines)-2])\n            w.store(lf)\n        }\n    } else {\n        w.store(p)\n    }\n}\n\nfunc (w *myFilter) store(p []byte) {\n    w.storage = append(w.storage, p...)\n}\n\nfunc (w *myFilter) Bytes() []byte {\n    if len(w.partialLine) &gt; 0 {\n        w.filterCR(w.partialLine)\n    }\n    return w.storage\n}\n</code></pre>\n\n<p>My output is:</p>\n\n<pre><code>stream:\na\nb\n\nprogress 100%\n\nc\n\nstreamer:\na\nb\n\nprogress 98%\nprogress 100%\n\nc\n\n\nfromCmd:\na\nb\n\nss: 100%\nprogess: 100%\n\nc\n</code></pre>\n\n<p>What I want is the output you see from \"fromCmd\" to match the output I got from \"streamer\".</p>\n\n<p>What am I doing wrong, why does my actual output seem \"corrupt\", why does the real command run behave differently to my \"streamer\" test, and what's a better way to filter STDOUT?</p>\n"}, {"tags": ["go", "makefile", "compiler-errors", "compilation", "ethereum"], "answers": [{"tags": [], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "is_accepted": true, "score": 4, "last_activity_date": 1486991253, "creation_date": 1486991253, "answer_id": 42204806, "question_id": 42204612, "link": "https://stackoverflow.com/questions/42204612/compilation-fails-no-such-file-or-directory-but-it-does-exist/42204806#42204806", "title": "Compilation fails: No such file or directory (but it DOES exist!)", "body": "<p>Ok, nevermind. Found it. The problem was that line endings where in dos style.</p>\n\n<p>So to recursively convert line endings to unix I ran:</p>\n\n<pre><code>find . -type f -print0 | xargs -0 -n 1 -P 4 dos2unix\n</code></pre>\n\n<p>and then tried building again. That fixed it.</p>\n\n<p>I hope this helps someone else here. In any case I wish you all a beautiful day!</p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 9362036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eD7OA.jpg?s=128&g=1", "display_name": "xwa130", "link": "https://stackoverflow.com/users/9362036/xwa130"}, "is_accepted": false, "score": 0, "last_activity_date": 1521150942, "creation_date": 1521150942, "answer_id": 49309883, "question_id": 42204612, "link": "https://stackoverflow.com/questions/42204612/compilation-fails-no-such-file-or-directory-but-it-does-exist/49309883#49309883", "title": "Compilation fails: No such file or directory (but it DOES exist!)", "body": "<p>I solve the problem using by following instructions below. I don't know the reason, but I completely get rid of <code>brew</code> to make it run. (mac)\n<code>\n1 install go(I used package)\n2 git clone https://github.com/ethereum/go-ethereum\n3 cd go-ethereum &amp;&amp; git checkout tags/v1.8.2\n4 run `find . -type f -print0 | xargs -0 -n 1 -P 4 dos2unix`(if you don't have dos2unix, you could brew one, it does not break anything.)\n5 make geth\n6 ln -s /path/to/origin/geth /path/to/target/geth\n</code>\nThen run <code>which geth</code> you could find your geth. Run <code>geth version</code> you can see your version.</p>\n"}], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 42204806, "answer_count": 2, "score": 2, "last_activity_date": 1521150942, "creation_date": 1486990603, "question_id": 42204612, "link": "https://stackoverflow.com/questions/42204612/compilation-fails-no-such-file-or-directory-but-it-does-exist", "title": "Compilation fails: No such file or directory (but it DOES exist!)", "body": "<p>I'm trying to compile the <a href=\"https://github.com/ethereum/go-ethereum\" rel=\"nofollow noreferrer\">Ethereum Go client</a>. Following <a href=\"https://github.com/ethereum/go-ethereum#building-the-source\" rel=\"nofollow noreferrer\">the instructions</a> I simply run <code>make geth</code>, but that fails:</p>\n\n<pre><code>$ make geth\nbuild/env.sh go run build/ci.go install ./cmd/geth\nmake: build/env.sh: No such file or directory\nmake: *** [geth] Error 1\n</code></pre>\n\n<p>As far as I understand from this error it complaints that either <code>build/env.sh</code> or <code>build/ci.go</code> doesn't exist. So I checked out the build folder, but they both seem to be there:</p>\n\n<pre><code>$ ls -l build\ntotal 648\ndrwxr-xr-x  3 kramer65  staff     102 Feb 13 13:45 _vendor\n-rw-r--r--  1 kramer65  staff    2892 Feb 13 13:45 ci-notes.md\n-rw-r--r--  1 kramer65  staff   30516 Feb 13 13:45 ci.go             &lt;===\n-rw-r--r--  1 kramer65  staff     123 Feb 13 13:45 deb.changelog\n... some other files here\n-rw-r--r--  1 kramer65  staff     379 Feb 13 13:45 deb.rules\n-rwxr-xr-x  1 kramer65  staff     721 Feb 13 13:45 env.sh            &lt;===\n-rw-r--r--  1 kramer65  staff    1722 Feb 13 13:45 mvn.pom\n... and some more files here\n</code></pre>\n\n<p>I checked whether go is installed and which version it is:</p>\n\n<pre><code>$ which go\n/usr/local/bin/go\n$ go version\ngo version go1.7.5 darwin/amd64\n</code></pre>\n\n<p>So go seems to be fine. </p>\n\n<p>Does anybody have any idea how I can debug/solve this? All tips are welcome!</p>\n"}, {"tags": ["go", "netsh"], "answers": [{"comments": [{"owner": {"reputation": 625, "user_id": 4174678, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-4-R8SvnftWw/AAAAAAAAAAI/AAAAAAAAAAA/rABVJRgbn1M/photo.jpg?sz=128", "display_name": "Andrey K.", "link": "https://stackoverflow.com/users/4174678/andrey-k"}, "edited": false, "score": 0, "creation_date": 1486992412, "post_id": 42204730, "comment_id": 71571485, "body": "And then run as Administrator or embedding manifest file into exe file withhttps://github.com/akavel/rsrc"}, {"owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "reply_to_user": {"reputation": 625, "user_id": 4174678, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-4-R8SvnftWw/AAAAAAAAAAI/AAAAAAAAAAA/rABVJRgbn1M/photo.jpg?sz=128", "display_name": "Andrey K.", "link": "https://stackoverflow.com/users/4174678/andrey-k"}, "edited": false, "score": 0, "creation_date": 1486992855, "post_id": 42204730, "comment_id": 71571815, "body": "@AndreyK. <code>runas</code>?"}], "tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1486990964, "creation_date": 1486990964, "answer_id": 42204730, "question_id": 42204608, "link": "https://stackoverflow.com/questions/42204608/how-to-execute-netsh-command-from-golang-on-windows/42204730#42204730", "title": "How to execute netsh command from Golang on Windows", "body": "<p>Try <code>exec.Command(\"netsh\", \"interface\", \"ipv6\", \"set\", \"privacy\", \"state=disable\").Run()</code></p>\n"}], "owner": {"reputation": 625, "user_id": 4174678, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-4-R8SvnftWw/AAAAAAAAAAI/AAAAAAAAAAA/rABVJRgbn1M/photo.jpg?sz=128", "display_name": "Andrey K.", "link": "https://stackoverflow.com/users/4174678/andrey-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "accepted_answer_id": 42204730, "answer_count": 1, "score": 0, "last_activity_date": 1486990964, "creation_date": 1486990580, "question_id": 42204608, "link": "https://stackoverflow.com/questions/42204608/how-to-execute-netsh-command-from-golang-on-windows", "title": "How to execute netsh command from Golang on Windows", "body": "<p>How to execute</p>\n\n<blockquote>\n  <p>netsh </p>\n</blockquote>\n\n<p>command from Golang which requires \"run as Admin\"?</p>\n\n<pre><code>err1 := exec.Command(\"netsh\", \"interface ipv6 set privacy state=disable\").Run()\nfmt.Printf(\"Exec1 err: %+v\\n\", err1)\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1486989563, "post_id": 42203920, "comment_id": 71569763, "body": "If you could provide <i>exact</i> specs for the regular expression, it would be easier to help you. Right now, it is not clear if you need the digit to be part of the match, or just require them to be somewhere after the expected match."}], "answers": [{"tags": [], "owner": {"reputation": 362892, "user_id": 256196, "user_type": "moderator", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d84b558fd67be10d5a718fb94231909d?s=128&d=identicon&r=PG", "display_name": "Bohemian", "link": "https://stackoverflow.com/users/256196/bohemian"}, "is_accepted": true, "score": 1, "last_activity_date": 1487001324, "creation_date": 1487001324, "answer_id": 42208216, "question_id": 42203920, "link": "https://stackoverflow.com/questions/42203920/how-to-convert-regexp-from-lookahead/42208216#42208216", "title": "How to convert regexp from lookahead", "body": "<p>Firstly, the left hand side of the alternation <code>/^...</code> matches nothing, because <code>/</code> can never appear before start of input.</p>\n\n<p>That leaves just <code>(?:[A-Z0-9]+) +?(?=.*\\d)</code>, which can be expressed as:</p>\n\n<pre><code>((?:[A-Z0-9]+) ).*\\d.*\n</code></pre>\n\n<p>The term <code>\" +?\"</code> as used is identical in effect to just <code>\" \"</code>.</p>\n\n<p>Note however that this consumes more input than the original, which is unavoidable. Your original match is now in group 1.</p>\n"}], "owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1442, "favorite_count": 0, "accepted_answer_id": 42208216, "answer_count": 1, "score": 1, "last_activity_date": 1569061675, "creation_date": 1486988457, "last_edit_date": 1569061675, "question_id": 42203920, "link": "https://stackoverflow.com/questions/42203920/how-to-convert-regexp-from-lookahead", "title": "How to convert regexp from lookahead", "body": "<p>I have the following Regex in PHP and other code that is doing a great job.</p>\n\n<pre><code>/^(?:(?=[^ ]+\\d)(?:[A-Z0-9]+))|(?:[A-Z0-9]+) +?(?=.*\\d)(?:[A-Z0-9]+)?\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3BbEU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3BbEU.png\" alt=\"Regular expression visualization\"></a></p>\n\n<p><a href=\"https://www.debuggex.com/r/dKpoZrNfcdwtzOtR\" rel=\"nofollow noreferrer\">Debuggex Demo</a></p>\n\n<p>It turns out that Go doesn't support lookheads and I'm at a loss on how to convert it across.</p>\n\n<p>The Debuggex link has some test data I was using to qualify the code before.</p>\n"}, {"tags": ["arrays", "go", "initialization", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1486983758, "post_id": 42201804, "comment_id": 71566219, "body": "The first thing when learning Go is to work through the Tour of Go (<a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">tour.golang.org</a>). The second thing is to do it again. The third thing is reading Effective Go (<a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a>). The fourth thing is reading the Spec (<a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">golang.org/ref/spec</a>). Then you redo the tour and then you worry about efficient code. Not earlier :-)"}], "answers": [{"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1486982613, "last_edit_date": 1486982613, "creation_date": 1486982214, "answer_id": 42201984, "question_id": 42201804, "link": "https://stackoverflow.com/questions/42201804/different-sizes-of-arrays-using-make-or-default-initialization/42201984#42201984", "title": "Different sizes of arrays using make or default initialization", "body": "<p><code>ind1</code> is a slice (the type is <code>[]bool</code>).</p>\n\n<p><code>ind2</code> is an array (the type is <code>[10]bool</code>).</p>\n\n<p>They are not of the same type.</p>\n\n<p>The result of <code>unsafe.Sizeof(ind1)</code> probably has nothing to do with the arguments passed to <code>make</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1486988523, "last_edit_date": 1495540406, "creation_date": 1486982546, "answer_id": 42202087, "question_id": 42201804, "link": "https://stackoverflow.com/questions/42201804/different-sizes-of-arrays-using-make-or-default-initialization/42202087#42202087", "title": "Different sizes of arrays using make or default initialization", "body": "<p><a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">Arrays</a> and <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">slices</a> in Go are different things.</p>\n\n<p>Your <code>ind1</code> is a slice, and <code>ind2</code> is an array. The length of an array is part of the type, so for example <code>[2]bool</code> and <code>[3]bool</code> are 2 different array types.</p>\n\n<p>A slice in Go is a descriptor for a <em>contiguous segment</em> of an underlying array and provides access to a numbered sequence of elements from that array. This slice header is a struct-like data structure represented by the type <a href=\"https://golang.org/pkg/reflect/#SliceHeader\" rel=\"nofollow noreferrer\"><code>reflect.SliceHeader</code></a>:</p>\n\n<pre><code>type SliceHeader struct {\n        Data uintptr\n        Len  int\n        Cap  int\n}\n</code></pre>\n\n<p>It contains a data pointer (to the first element of the represented segment), a length and a capacity.</p>\n\n<p>The <a href=\"https://golang.org/pkg/unsafe/#Sizeof\" rel=\"nofollow noreferrer\"><code>unsafe.SizeOf()</code></a> function returns the size in bytes of the hypothetical variable as if it would hold the passed value. <strong>It does not include any memory possibly referenced by it.</strong></p>\n\n<p>So if you pass a slice value (<code>ind1</code>), it will tell you the size of the above mentioned <em>slice header</em>. Note that the size of the fields of <code>SliceHeader</code> are architecture dependent, e.g. <code>int</code> may be 4 bytes on one platform and it may be 8 bytes on another. The size <code>24</code> applies to 64-bit architectures.</p>\n\n<p>The Go Playground runs on a 32-bit architecture. Let's see this example:</p>\n\n<pre><code>fmt.Println(unsafe.Sizeof(make([]bool, 10)))\nfmt.Println(unsafe.Sizeof(make([]bool, 20)))\n\nfmt.Println(unsafe.Sizeof([10]bool{}))\nfmt.Println(unsafe.Sizeof([20]bool{}))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/en0A1y0uUD\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>12\n12\n10\n20\n</code></pre>\n\n<p>As you can see, no matter the length of the slice you pass to <code>unsafe.SizeOf()</code>, it always returns 12 on the Go Playground (and 24 on 64-bit architectures).</p>\n\n<p>On the other hand, an array value includes all its elements, and as such, its size depends on its length. Size of <code>[10]bool</code> is 10, and size of <code>[20]bool</code> is 20.</p>\n\n<p>See related questions+answers to learn more about slices, arrays and the difference and relation between them:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/35937828/how-do-i-find-the-size-of-the-array-in-go/35939008#35939008\">How do I find the size of the array in go</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/38645175/why-have-arrays-in-go/38645895#38645895\">Why have arrays in Go?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/30694652/why-use-arrays-instead-of-slices\">Why use arrays instead of slices?</a></p>\n\n<p>Must read blog posts:</p>\n\n<p><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a></p>\n\n<p><a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">Arrays, slices (and strings): The mechanics of 'append'</a></p>\n"}], "owner": {"reputation": 314, "user_id": 2032903, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0xnps.jpg?s=128&g=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/2032903/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 42202087, "answer_count": 2, "score": 1, "last_activity_date": 1486988523, "creation_date": 1486981648, "last_edit_date": 1486983177, "question_id": 42201804, "link": "https://stackoverflow.com/questions/42201804/different-sizes-of-arrays-using-make-or-default-initialization", "title": "Different sizes of arrays using make or default initialization", "body": "<p>I'm new to Go and try to understand the language in order to write efficient code. In the following code, sizes of the two arrays differ by 140%, can someone explain this?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    ind1 := make([]bool, 10)\n    var ind2 [10]bool\n    fmt.Println(unsafe.Sizeof(ind1)) // 24\n    fmt.Println(len(ind1)) // 10\n    fmt.Println(unsafe.Sizeof(ind2)) // 10\n    fmt.Println(len(ind2)) // 10\n}\n</code></pre>\n\n<p>The size of the first array remains 10, even in case the capacity is set explicitly:</p>\n\n<pre><code>    ind1 := make([]bool, 10, 10)\n</code></pre>\n\n<p>Can someone explain this? Is there any additional overhead in using <code>make</code>? If yes, why is it recommended to use make over default initialization?</p>\n"}, {"tags": ["go", "client-server", "coap"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7372768, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5x1sCj6DONU/AAAAAAAAAAI/AAAAAAAAAMw/Unnqr_fLi-k/photo.jpg?sz=128", "display_name": "Aakarshit Naga Sai Batchu", "link": "https://stackoverflow.com/users/7372768/aakarshit-naga-sai-batchu"}, "edited": false, "score": 0, "creation_date": 1487050811, "post_id": 42204033, "comment_id": 71598020, "body": "I am expecting for an example of server-client which makes use of End-points."}], "tags": [], "owner": {"reputation": 1248, "user_id": 2298377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ji8D8.jpg?s=128&g=1", "display_name": "John Hua", "link": "https://stackoverflow.com/users/2298377/john-hua"}, "is_accepted": false, "score": 0, "last_activity_date": 1486988774, "creation_date": 1486988774, "answer_id": 42204033, "question_id": 42200741, "link": "https://stackoverflow.com/questions/42200741/how-to-add-a-resource-or-endpoint-in-a-coap-server-program-golang/42204033#42204033", "title": "How to add a Resource or Endpoint in a CoAP server program Golang", "body": "<p>The sample code of <a href=\"https://github.com/dustin/go-coap/blob/master/example/client/goap_client.go\" rel=\"nofollow noreferrer\">client</a> and <a href=\"https://github.com/dustin/go-coap/blob/master/example/server/coap_server.go\" rel=\"nofollow noreferrer\">server</a> are under ./example/</p>\n"}], "owner": {"reputation": 31, "user_id": 7372768, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5x1sCj6DONU/AAAAAAAAAAI/AAAAAAAAAMw/Unnqr_fLi-k/photo.jpg?sz=128", "display_name": "Aakarshit Naga Sai Batchu", "link": "https://stackoverflow.com/users/7372768/aakarshit-naga-sai-batchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1486988774, "creation_date": 1486978292, "question_id": 42200741, "link": "https://stackoverflow.com/questions/42200741/how-to-add-a-resource-or-endpoint-in-a-coap-server-program-golang", "title": "How to add a Resource or Endpoint in a CoAP server program Golang", "body": "<p><a href=\"https://github.com/dustin/go-coap\" rel=\"nofollow noreferrer\">https://github.com/dustin/go-coap</a></p>\n\n<p>I am using the above library for Building a Server-Client programs in Golang.\nHow can we add a Resource or Endpoint on Server Side and write a Handler in-specific to that endpoint.</p>\n\n<p>And also how to Publish data to specific Resource or Endpoint from client Side.</p>\n\n<p>Can someone give examples using the above library.\nThanks in Advance!  </p>\n"}, {"tags": ["math", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1486977497, "last_edit_date": 1486977497, "creation_date": 1486977134, "answer_id": 42200364, "question_id": 42200281, "link": "https://stackoverflow.com/questions/42200281/why-does-math-pow10e-int-returns-float64-rather-than-int64/42200364#42200364", "title": "Why does math.Pow10(e int) returns float64 rather than int64?", "body": "<p>2 reasons:</p>\n\n<p>First, the parameter may be negative too, in which case the result is a fraction number between <code>0</code> and <code>1</code>, so a <code>float64</code> return value is not just justified but needed.</p>\n\n<pre><code>fmt.Println(math.Pow10(-1))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/lSRZApp6pO\">Go Playground</a>):</p>\n\n<pre><code>0.1\n</code></pre>\n\n<p>Second, almost<sup>*</sup> every function of the <a href=\"https://golang.org/pkg/math/\"><code>math</code></a> package returns value(s) of type <code>float64</code>, adding one that doesn't would break \"consistency\".</p>\n\n<p><sup>[*] Few exceptions include functions like <a href=\"https://golang.org/pkg/math/#Float32frombits\"><code>Float32frombits()</code></a> and <a href=\"https://golang.org/pkg/math/#Ilogb\"><code>llogb()</code></a> where the deviation is justified.</sup></p>\n"}], "owner": {"reputation": 1124, "user_id": 1263312, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/698a447f866ea18b3b0c45cb7b0bf780?s=128&d=identicon&r=PG", "display_name": "PickBoy", "link": "https://stackoverflow.com/users/1263312/pickboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 42200364, "answer_count": 1, "score": 2, "last_activity_date": 1486977780, "creation_date": 1486976858, "last_edit_date": 1486977780, "question_id": 42200281, "link": "https://stackoverflow.com/questions/42200281/why-does-math-pow10e-int-returns-float64-rather-than-int64", "title": "Why does math.Pow10(e int) returns float64 rather than int64?", "body": "<p>Since parameter <code>e</code> is <code>int</code>, why not just return an <code>int64</code>? Is there any special reason for this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 3, "last_activity_date": 1486965481, "creation_date": 1486965481, "answer_id": 42197509, "question_id": 42197468, "link": "https://stackoverflow.com/questions/42197468/go-what-is-the-n-parameter-in-regexpfindall/42197509#42197509", "title": "go: What is the n parameter in regexp:FindAll()", "body": "<p>From <a href=\"https://golang.org/pkg/regexp/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/regexp/</a>:</p>\n\n<blockquote>\n  <p>Find(All)?(String)?(Submatch)?(Index)?</p>\n  \n  <p>If 'All' is present, the routine matches successive non-overlapping\n  matches of the entire expression. Empty matches abutting a preceding\n  match are ignored. The return value is a slice containing the\n  successive return values of the corresponding non-'All' routine. These\n  routines take an extra integer argument, n; if n >= 0, the function\n  returns at most n matches/submatches.</p>\n</blockquote>\n"}], "owner": {"reputation": 1682, "user_id": 1977535, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/NK9Et.jpg?s=128&g=1", "display_name": "firelyu", "link": "https://stackoverflow.com/users/1977535/firelyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486965481, "creation_date": 1486965234, "question_id": 42197468, "link": "https://stackoverflow.com/questions/42197468/go-what-is-the-n-parameter-in-regexpfindall", "title": "go: What is the n parameter in regexp:FindAll()", "body": "<p>I use regexp.FindAll() to get all the matches. I don't understand the parameter of <code>n</code>, and in the <a href=\"https://golang.org/pkg/regexp/#Regexp.FindAll\" rel=\"nofollow noreferrer\">office reference</a>, there is no explanation. How can I set the parameter.</p>\n\n<pre><code>// FindAll is the 'All' version of Find; it returns a slice of all successive\n// matches of the expression, as defined by the 'All' description in the\n// package comment.\n// A return value of nil indicates no match.\nfunc (re *Regexp) FindAll(b []byte, n int) [][]byte {}\n</code></pre>\n"}, {"tags": ["go", "import", "dependencies"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1486972209, "last_edit_date": 1486972209, "creation_date": 1486932083, "answer_id": 42192990, "question_id": 42192925, "link": "https://stackoverflow.com/questions/42192925/imports-for-go-package-splitted-into-files/42192990#42192990", "title": "Imports for Go package splitted into files", "body": "<p>It's not a question of being idiomatic, it's a question of scopes.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">Import declarations</a> are scoped to the containing <em>file</em>. <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">Spec: Import declarations:</a></p>\n\n<blockquote>\n  <p>An import declaration states that the <strong>source file</strong> containing the declaration depends on functionality of the imported package (<a href=\"https://golang.org/ref/spec#Program_initialization_and_execution\" rel=\"nofollow noreferrer\">\u00a7Program initialization and execution</a>) and enables access to exported identifiers of that package.</p>\n</blockquote>\n\n<p>Also <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">Spec: Declarations and scope:</a></p>\n\n<blockquote>\n  <p>Go is lexically scoped using <a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow noreferrer\">blocks</a>:<br>\n  ...<br>\n  3. The scope of the package name of an imported package is the <strong>file block</strong> of the file containing the import declaration.<br>\n  ...</p>\n</blockquote>\n\n<p>What this means is that if there's a package that is needed in multiple files (forming a single package or multiple, it doesn't matter), you have to import it separately in all of those files.</p>\n\n<p>What you should do is review and revise how you separate code between files, because it may be a good way to group functions and declarations into the same file that have the same dependencies (that depend on the same set of packages), and so you would only need to import those packages once.</p>\n\n<p>Also note that if certain files of package <code>mypkg</code> depend on a set of other packages, but not the other files of <code>mypkg</code>, it may also be profitable to split <code>mypkg</code> into 2 separate packages based on the dependencies. Most of these decisions are subjective though, you have tell if they make sense in your case or not.</p>\n"}], "owner": {"reputation": 673, "user_id": 921051, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/09bf092eb87afa75958cdc6624bd5b54?s=128&d=identicon&r=PG", "display_name": "Steffen", "link": "https://stackoverflow.com/users/921051/steffen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 42192990, "answer_count": 1, "score": 1, "last_activity_date": 1486974735, "creation_date": 1486931756, "last_edit_date": 1486974735, "question_id": 42192925, "link": "https://stackoverflow.com/questions/42192925/imports-for-go-package-splitted-into-files", "title": "Imports for Go package splitted into files", "body": "<p>If I need an import in two or more files for one package in Go, what is the idiomatic way?</p>\n\n<p>Until today I do it like this:</p>\n\n<p>file1.go</p>\n\n<pre><code>package A\n\nimport \"os\"\n</code></pre>\n\n<p>file2.go</p>\n\n<pre><code>package A\n\nimport \"os\"\n</code></pre>\n"}, {"tags": ["file", "go"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1486930437, "post_id": 42192628, "comment_id": 71547297, "body": "os.File which you obtain with os.Open(&quot;path&quot;) IS a Reader"}], "answers": [{"tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": true, "score": 7, "last_activity_date": 1486930779, "creation_date": 1486930779, "answer_id": 42192764, "question_id": 42192628, "link": "https://stackoverflow.com/questions/42192628/reading-the-first-two-bytes-from-a-file-efficiently-golang/42192764#42192764", "title": "Reading the first two bytes from a file efficiently - Golang", "body": "<p>You get the initial reader by opening the file. For 2 bytes, I wouldn't use the <code>LimitReader</code> though. Just reading 2 bytes with <a href=\"https://golang.org/pkg/io/#ReadFull\">io.ReadFull</a> is easier.</p>\n\n<pre><code>r, err := os.Open(file)\nif err != nil {\n    return err\n}\n\ndefer r.Close()\n\nvar header [2]byte\nn, err := io.ReadFull(r, header[:])\nif err != nil {\n    return err\n}\n</code></pre>\n"}], "owner": {"reputation": 643, "user_id": 7552759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ldvQc.jpg?s=128&g=1", "display_name": "Anurope", "link": "https://stackoverflow.com/users/7552759/anurope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2741, "favorite_count": 1, "accepted_answer_id": 42192764, "answer_count": 1, "score": 5, "last_activity_date": 1486930779, "creation_date": 1486930001, "question_id": 42192628, "link": "https://stackoverflow.com/questions/42192628/reading-the-first-two-bytes-from-a-file-efficiently-golang", "title": "Reading the first two bytes from a file efficiently - Golang", "body": "<p>I'm trying to find a good way of reading the first two bytes from a file using Go.</p>\n\n<p>I have some <code>.zip</code> files in my current directory, mixed in with other files.</p>\n\n<p>I would like to loop through all the files in the directory and check if the first two bytes contain the right <code>.zip</code> identifier, namely <code>50 4B</code>.</p>\n\n<p>What would be a good way to accomplish this using the standard library without having to read the entire file?</p>\n\n<p>Going through the available functions in the <code>io</code> package I managed to find:</p>\n\n<pre><code>func LimitReader(r Reader, n int64) Reader\n</code></pre>\n\n<p>Which seems to fit my description, it reads from <code>Reader</code> (How do I get a <code>Reader</code>?) but stops after <code>n</code> bytes. Since I'm rather new to Go, I'm not sure how to go about it.</p>\n"}, {"tags": ["c", "go", "casting"], "comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1486927965, "post_id": 42192207, "comment_id": 71546301, "body": "@soundslikeodd Can you edit again? Sorry"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1486928531, "post_id": 42192207, "comment_id": 71546519, "body": "actually that might not be safe in C either ..."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1486929596, "post_id": 42192207, "comment_id": 71546956, "body": "The C code does different things on different compilers and machines because of differences in alignment restrictions, alignment, padding, and endianness. It can even cause a segfault. The safe, portable thing to do is to extract a field at a time, the reverse of what <a href=\"http://stackoverflow.com/a/39132179/589924\">this answer</a> does."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1486929859, "post_id": 42192207, "comment_id": 71547068, "body": "@ikegami we have assembly code embedded in C application. How do u  embed assembly code in GO?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1486930065, "post_id": 42192207, "comment_id": 71547146, "body": "1) Don&#39;t post new questions in the comments. If you have a new question, post it as a Question. Though stop asking how to translate things, and start asking how to do the things the code you want translated does. 2) I don&#39;t know GO"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1486933039, "post_id": 42192207, "comment_id": 71548260, "body": "You may find this package useful: <a href=\"https://godoc.org/golang.org/x/net/ipv4\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/net/ipv4</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1487002102, "last_edit_date": 1487002102, "creation_date": 1486933209, "answer_id": 42193183, "question_id": 42192207, "link": "https://stackoverflow.com/questions/42192207/type-safe-vs-loosely-typed-go-vs-c/42193183#42193183", "title": "Type Safe Vs Loosely typed - GO Vs C", "body": "<p><strong>Foreword:</strong> Even though what you want is possible, try to avoid using package <code>unsafe</code> as much as possible. This is not a \"go to first\" solution but rather think of it as a last resort (or something that comes after that).</p>\n\n<hr>\n\n<p>Go does give you support for this in package <a href=\"https://golang.org/pkg/unsafe/\" rel=\"nofollow noreferrer\"><code>unsafe</code></a>.</p>\n\n<p>Even the spec has a dedicated section for it. <a href=\"https://golang.org/ref/spec#Package_unsafe\" rel=\"nofollow noreferrer\">Spec: Package <code>unsafe</code>:</a></p>\n\n<blockquote>\n  <p>The built-in package <code>unsafe</code>, known to the compiler, provides facilities for low-level programming including operations that violate the type system. A package using <code>unsafe</code> must be vetted manually for type safety and may not be portable.</p>\n</blockquote>\n\n<p>The package was intentionally named <code>unsafe</code>, giving you the proper prior-warning that if something goes wrong, don't blame the compiler or the language.</p>\n\n<p>What you need is the <a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow noreferrer\"><code>unsafe.Pointer</code></a> type. <code>Pointer</code> is a special <a href=\"https://golang.org/ref/spec#Pointer_types\" rel=\"nofollow noreferrer\">pointer type</a> that may not be <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">dereferenced</a>, but any pointer type can be converted to <code>Pointer</code>, and <code>Pointer</code> can be converted to any (other) pointer type. So this is your \"gateway\" between different types.</p>\n\n<p>For example, if you have a value of type <code>float64</code> (which is 8 bytes in memory), you can interpret those 8 bytes as an <code>int64</code> (which is also 8 bytes in memory) like this:</p>\n\n<pre><code>var f float64 = 1\nvar i int64\n\nip := (*int64)(unsafe.Pointer(&amp;f))\ni = *ip\n\nfmt.Println(i)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/IicOAa8kUA\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>4607182418800017408\n</code></pre>\n\n<p>The key is this line:</p>\n\n<pre><code>(*int64)(unsafe.Pointer(&amp;f))\n</code></pre>\n\n<p>It means take the address of <code>f</code> (which will be of type <code>*float64</code>), convert it to <code>unsafe.Pointer</code> (any pointer type can be converted to <code>Pointer</code>), then convert this <code>unsafe.Pointer</code> value to another pointer type <code>*int64</code>. If we dereference this pointer, we get a value of type <code>int64</code>.</p>\n\n<p>In your example you want to \"place\" a variable on an address with an offset applied. Go does not have pointer arithmetic. You can get around this in 2 ways:</p>\n\n<ol>\n<li><p>use <a href=\"https://golang.org/pkg/builtin/#uintptr\" rel=\"nofollow noreferrer\"><code>uintptr</code></a> which may hold an address, but you can treat it as an <code>int</code> and add values to it</p></li>\n<li><p>or use a pointer to a \"buffer\" type, e.g. <code>*[1&lt;&lt;31]byte</code>; you may convert the address to this pointer, and you can apply the offset by indexing the buffer at the given offset, and take the address of that element, e.g. <code>&amp;buf[14]</code></p></li>\n</ol>\n\n<p>Method #1 could look likes this:</p>\n\n<pre><code>type X [16]byte\nvar x = X{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15}\n\nxx := (uintptr)(unsafe.Pointer(&amp;x[0])) + 14 // APPLY OFFSET\n\nvar x2 X = *(*X)(unsafe.Pointer(xx))\nfmt.Println(x2[0], x2[1])\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/0DbHhSh9WT\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>14 15\n</code></pre>\n\n<p>Method #2 could look like this:</p>\n\n<pre><code>type X [16]byte\nvar x = X{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15}\n\nxx := (*X)(unsafe.Pointer(&amp;x[0]))\nxx = (*X)(unsafe.Pointer(&amp;xx[14])) // APPLY OFFSET\n\nvar x2 X = *(*X)(unsafe.Pointer(xx))\nfmt.Println(x2[0], x2[1])\n</code></pre>\n\n<p>Output is the same. Try it on the <a href=\"https://play.golang.org/p/JFxFdXsTMm\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 6, "last_activity_date": 1486933386, "creation_date": 1486933386, "answer_id": 42193202, "question_id": 42192207, "link": "https://stackoverflow.com/questions/42192207/type-safe-vs-loosely-typed-go-vs-c/42193202#42193202", "title": "Type Safe Vs Loosely typed - GO Vs C", "body": "<p>Let's look at this from a different angle: what does typecasting do in C?</p>\n\n<p>Well, in some sense, it doesn't do anything! It just takes some bit pattern at some point in memory, and blindly assumes that this particular bit pattern actually represents a value of some type. But there's no validation of this, no sort of parsing. And that's the problem.</p>\n\n<p>But, I already used the word that is the solution to our problem above: parsing. Instead of just blindly assuming that some random bit pattern in memory is the same bit pattern that the C compiler would generate for a value of some type, we actually <em>look at the bit pattern</em>, check whether it conforms to the rules of how bit patterns for that datatype are constructed, and deconstruct the bit patterns into its constituent parts according to those rules.</p>\n\n<p>In other words: we write a parser.</p>\n\n<p>Note that this isn't specific to Go. It is a good idea even in C. In fact, the code you posted is broken in at least three, maybe four different ways:</p>\n\n<ul>\n<li>platforms where a <code>char</code> is not 8 bits wide</li>\n<li>alignment</li>\n<li>padding</li>\n<li>endianness</li>\n</ul>\n\n<p>AFAIK, there are already existing IP, UDP, and TCP parsers written in Go out there, that you can either use or learn from. Also, the current system from Alan Kay's Viewpoints Research Institute has a really cool TCP/IP stack written in just 120 lines or so, which is very easy to read. (In fact, the source code for the parser actually just consists of ASCII diagrams cut&amp;pasted from the RFCs.)</p>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1487003064, "creation_date": 1486927806, "last_edit_date": 1487003064, "question_id": 42192207, "link": "https://stackoverflow.com/questions/42192207/type-safe-vs-loosely-typed-go-vs-c", "title": "Type Safe Vs Loosely typed - GO Vs C", "body": "<p>In C, following is the sniffer code,</p>\n\n<pre><code>void Handle_IP(char *buf)\n{\n    struct iphdr *ip_hdr; // declaring pointer of type ip header \n\n    struct in_addr in; // declaring a structure which holds ip address \n\n    FILE *fp;\n    int ctl, len;\n\n    /* In the following statement we're adjusting the offset so that\n       ip pointer can point to correct location */\n\n    ip_hdr = (struct iphdr *)(buf + 14);\n    ....\n}\n</code></pre>\n\n<hr>\n\n<p>where line,</p>\n\n<p><code>ip_hdr = (struct iphdr *)(buf + 14)</code> has <code>char *</code> that is type casted to <code>struct iphdr *</code>.</p>\n\n<p>GO being a type safe language, does not allow such type casting. Go has no <code>void *</code> except <code>interface</code> that follows structural typing</p>\n\n<p>How to approach such code in GO?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1486915655, "post_id": 42189723, "comment_id": 71541508, "body": "From the docs: <a href=\"https://golang.org/cmd/go/#hdr-Import_path_checking\" rel=\"nofollow noreferrer\">Import Path Checking</a>"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1486917611, "post_id": 42189723, "comment_id": 71542291, "body": "Thanks. Would be better if you posted that and a brief summary as an answer. Can&#39;t close the question this way."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1486923336, "post_id": 42189723, "comment_id": 71544509, "body": "Related questions: <a href=\"http://stackoverflow.com/questions/27344013/go-get-error-cant-load-package\" title=\"go get error cant load package\">stackoverflow.com/questions/27344013/&hellip;</a> <a href=\"http://stackoverflow.com/questions/37330303/forcing-a-specific-import-path-in-go\" title=\"forcing a specific import path in go\">stackoverflow.com/questions/37330303/&hellip;</a>"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1486938727, "post_id": 42189723, "comment_id": 71550227, "body": "Not a duplicate because I&#39;m trying to explain the phenomenon and searches for the error will lead here. I&#39;m not trying to solve a problem (which is the purpose of the other topics)."}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 1, "closed_date": 1486938581, "answer_count": 0, "score": 1, "last_activity_date": 1486914675, "creation_date": 1486914675, "question_id": 42189723, "link": "https://stackoverflow.com/questions/42189723/go-wants-to-import-package-from-comment", "closed_reason": "Duplicate", "title": "Go Wants to Import Package From Comment", "body": "<p>I'm experiencing a weird phenomenon. I have the executable package importing a library package. However, the library has a comment after the package name mentioning an import path. When Go attempts to build the library package it gives an \"expects import\" error. It doesn't happen when the comment is before or after the package statement.</p>\n\n<p>Executable package:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/dsoprea/import_confusion_lib\"\n)\n\nfunc main() {\n\n}\n</code></pre>\n\n<p>Library package:</p>\n\n<pre><code>package mypackage // import \"extraneous/import/path\"\n</code></pre>\n\n<p>When I run the build:</p>\n\n<pre><code>GOPATH=`pwd`/import_confusion_root go build github.com/dsoprea/import_confusion\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>import_confusion_root/src/github.com/dsoprea/import_confusion/app.go:4:5: code in directory /home/dustin/development/go/test/import_confusion_root/src/github.com/dsoprea/import_confusion_lib expects import \"extraneous/import/path\"\n</code></pre>\n\n<p>Looks like a bug to me. Can anyone explain this or otherwise corroborate that it's a bug?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 2, "creation_date": 1486891872, "post_id": 42186003, "comment_id": 71534201, "body": "How did you install it? If you installed it with a package manager, remove it with it. Otherwise just delete the files (wherever they installed to) and remove any environment variables."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1486891968, "post_id": 42186003, "comment_id": 71534234, "body": "Perhaps you want <code>rm -rvf &#47;usr&#47;local&#47;go&#47;</code>, but be careful before trying that. Also remove any mention of <code>go</code> in e.g. your <code>~&#47;.bashrc</code> then logout and login again."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1486891972, "post_id": 42186003, "comment_id": 71534235, "body": "Unfortunately...I don&#39;t remember (I did this a while back)"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1486892013, "post_id": 42186003, "comment_id": 71534242, "body": "@BrandonIbbotson that&#39;s what I&#39;ve done."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1486892062, "post_id": 42186003, "comment_id": 71534256, "body": "@BasileStarynkevitch that worked - want to provide an answer so I can accept?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1486894093, "post_id": 42186003, "comment_id": 71534783, "body": "@praks5432: I did add an answer"}], "answers": [{"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 5, "creation_date": 1486894329, "post_id": 42186042, "comment_id": 71534826, "body": "I also recommend using <a href=\"https://github.com/moovweb/gvm\" rel=\"nofollow noreferrer\">github.com/moovweb/gvm</a> it&#39;s made everything clean."}, {"owner": {"reputation": 646, "user_id": 1260885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/169c32a4506a4a1e91615c1f731909be?s=128&d=identicon&r=PG", "display_name": "Esa", "link": "https://stackoverflow.com/users/1260885/esa"}, "edited": false, "score": 4, "creation_date": 1505745154, "post_id": 42186042, "comment_id": 79526698, "body": "When installed via OsX graph.installer, remove also :  sudo rm /etc/paths.d/go. (this removes old go-binary from PATH)."}, {"owner": {"reputation": 1106, "user_id": 425144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3dbde928c99a6d63f66be154b696c6?s=128&d=identicon&r=PG", "display_name": "DaveStephens", "link": "https://stackoverflow.com/users/425144/davestephens"}, "edited": false, "score": 0, "creation_date": 1570704577, "post_id": 42186042, "comment_id": 103001258, "body": "Don&#39;t forget <code>sudo ...</code> unless you&#39;re someone that likes to run everything as root..."}, {"owner": {"reputation": 119, "user_id": 7562902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Dt9O.jpg?s=128&g=1", "display_name": "hemant singh", "link": "https://stackoverflow.com/users/7562902/hemant-singh"}, "edited": false, "score": 1, "creation_date": 1576041453, "post_id": 42186042, "comment_id": 104765159, "body": "thanks, Basile it worked for me, but need to add &quot;<b>sudo rm -rvf /usr/local/go/</b>&quot; otherwise we get permission denial in mac os calalina"}, {"owner": {"reputation": 1579, "user_id": 6096986, "user_type": "registered", "profile_image": "https://graph.facebook.com/1003427346371128/picture?type=large", "display_name": "Adarsha Jha", "link": "https://stackoverflow.com/users/6096986/adarsha-jha"}, "edited": false, "score": 0, "creation_date": 1612358674, "post_id": 42186042, "comment_id": 116741355, "body": "this doesn&#39;t work if in case you installed multiple go versions.  so it&#39;s always better to run this sudo apt-get remove --auto-remove golang-go"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 58, "last_activity_date": 1486892192, "creation_date": 1486892192, "answer_id": 42186042, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/42186042#42186042", "title": "How to uninstall Golang?", "body": "<p>You might try </p>\n\n<pre><code>rm -rvf /usr/local/go/\n</code></pre>\n\n<p>then remove any mention of <code>go</code> in e.g. your <code>~/.bashrc</code>; then you need at least to logout and login.</p>\n\n<p>However, be careful when doing that. You might break your system badly if something is wrong.</p>\n\n<p><sup>PS. I am assuming a Linux or POSIX system.</sup></p>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 6001349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PTE_eA98cOE/AAAAAAAAAAI/AAAAAAAAACI/GhBOo8gJQbU/photo.jpg?sz=128", "display_name": "harold ramos", "link": "https://stackoverflow.com/users/6001349/harold-ramos"}, "is_accepted": false, "score": -1, "last_activity_date": 1595296511, "last_edit_date": 1595296511, "creation_date": 1492042219, "answer_id": 43381557, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/43381557#43381557", "title": "How to uninstall Golang?", "body": "<ol>\n<li><p>Go to the directory</p>\n<pre><code>cd /usr/local\n</code></pre>\n</li>\n<li><p>Remove it with super user privileges</p>\n<pre><code>sudo rm -rf go\n</code></pre>\n</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1358, "user_id": 9194639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcKsd.png?s=128&g=1", "display_name": "new QOpenGLWidget", "link": "https://stackoverflow.com/users/9194639/new-qopenglwidget"}, "edited": false, "score": 0, "creation_date": 1565221305, "post_id": 44214964, "comment_id": 101288411, "body": "That&#39;s because anything cannot be used directly in Linux anywhere except for your <code>&#47;home&#47;your account&#47;...</code> account folder that you <i>own</i>."}, {"owner": {"reputation": 1215, "user_id": 7149128, "user_type": "registered", "profile_image": "https://graph.facebook.com/1308753592521618/picture?type=large", "display_name": "Hokhy Tann", "link": "https://stackoverflow.com/users/7149128/hokhy-tann"}, "edited": false, "score": 0, "creation_date": 1603959457, "post_id": 44214964, "comment_id": 114202031, "body": "It&#39;s a common knowledge to remove something with sudo in Linux."}], "tags": [], "owner": {"reputation": 5, "user_id": 2484540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZMxbt.png?s=128&g=1", "display_name": "Yan Li", "link": "https://stackoverflow.com/users/2484540/yan-li"}, "is_accepted": false, "score": -3, "last_activity_date": 1495875816, "creation_date": 1495875816, "answer_id": 44214964, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/44214964#44214964", "title": "How to uninstall Golang?", "body": "<p>only tab<br>\n<code>rm -rvf /usr/local/go/</code><br>\nnot works well, but<br>\n<code>sudo rm -rvf /usr/local/go/</code><br>\ndo.</p>\n"}, {"comments": [{"owner": {"reputation": 2903, "user_id": 1160216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/f0TsK.jpg?s=128&g=1", "display_name": "Mike Miller", "link": "https://stackoverflow.com/users/1160216/mike-miller"}, "edited": false, "score": 1, "creation_date": 1571696317, "post_id": 44714851, "comment_id": 103319314, "body": "Thanks for this. I&#39;m on a mac and I had to use <code>brew uninstall go</code> to uninstall with homebrew - your answer set me on the right track."}], "tags": [], "owner": {"reputation": 597, "user_id": 8198799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aee4728426abae2c1348820a97e7d233?s=128&d=identicon&r=PG&f=1", "display_name": "loukaswho", "link": "https://stackoverflow.com/users/8198799/loukaswho"}, "is_accepted": false, "score": 48, "last_activity_date": 1498200601, "creation_date": 1498200601, "answer_id": 44714851, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/44714851#44714851", "title": "How to uninstall Golang?", "body": "<p>I'm using Ubuntu. I spent a whole morning fixing this, tried all different solutions, when I type go version, it's still there, really annoying...\nFinally this worked for me, hope this will help!</p>\n\n<pre><code>sudo apt-get remove golang-go\nsudo apt-get remove --auto-remove golang-go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1623, "user_id": 244667, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6171cf5a9d0698bfc3d1575ec71461e6?s=128&d=identicon&r=PG", "display_name": "Jaco Briers", "link": "https://stackoverflow.com/users/244667/jaco-briers"}, "is_accepted": false, "score": 10, "last_activity_date": 1521724883, "creation_date": 1521724883, "answer_id": 49429803, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/49429803#49429803", "title": "How to uninstall Golang?", "body": "<p>For Windows 10:</p>\n\n<ol>\n<li>Go to <code>Apps</code> in the <code>Settings</code> App.  </li>\n<li>Look for <code>Go Programming Language *</code> in the list and uninstall it.  </li>\n<li>Remove <code>C:\\Go\\bin</code> from your <code>PATH</code> environment variable (only if you don't plan on installing another version of golang)</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "is_accepted": false, "score": -1, "last_activity_date": 1537528327, "creation_date": 1537528327, "answer_id": 52442497, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/52442497#52442497", "title": "How to uninstall Golang?", "body": "<p>On linux we can do like this to remove go completely:</p>\n\n<pre><code>rm -rf \"/usr/local/.go/\"\nrm -rf \"/usr/local/go/\"\n</code></pre>\n\n<p>These two command remove go and hidden .go files. Now we also have to update entries in shell profile.</p>\n\n<p>Open your basic file. Mostly I open like this <code>sudo gedit ~/.bashrc</code> and remove all go mentions.</p>\n\n<p>You can also do by sed command in ubuntu</p>\n\n<pre><code>sed -i '/# GoLang/d' .bashrc\nsed -i '/export GOROOT/d' .bashrc\nsed -i '/:$GOROOT/d' .bashrc\nsed -i '/export GOPATH/d' .bashrc\nsed -i '/:$GOPATH/d' .bashrc\n</code></pre>\n\n<p>It will remove Golang from everywhere. Also run this after running these command</p>\n\n<p><code>source ~/.bash_profile</code></p>\n\n<p>Tested on linux 18.04 also. That's All.</p>\n"}, {"comments": [{"owner": {"reputation": 1358, "user_id": 9194639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcKsd.png?s=128&g=1", "display_name": "new QOpenGLWidget", "link": "https://stackoverflow.com/users/9194639/new-qopenglwidget"}, "edited": false, "score": 0, "creation_date": 1565221157, "post_id": 55564319, "comment_id": 101288382, "body": "Ubuntu 18.18? Ubuntu versions can only have 4, 6 or 10 as their suffixes."}], "tags": [], "owner": {"reputation": 37, "user_id": 11326359, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/68c3d1d889c73087865bdfedd51e1239?s=128&d=identicon&r=PG", "display_name": "abrid", "link": "https://stackoverflow.com/users/11326359/abrid"}, "is_accepted": false, "score": 1, "last_activity_date": 1554687060, "last_edit_date": 1554687060, "creation_date": 1554677016, "answer_id": 55564319, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/55564319#55564319", "title": "How to uninstall Golang?", "body": "<pre><code>sudo apt-get remove golang-go\nsudo apt-get remove --auto-remove golang-go\n</code></pre>\n\n<p>This is perfect for Ubuntu 18.18</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 5548456, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UN4Ge0nfbtQ/AAAAAAAAAAI/AAAAAAAAES8/KH8DbYAG8wE/photo.jpg?sz=128", "display_name": "pratik singh", "link": "https://stackoverflow.com/users/5548456/pratik-singh"}, "is_accepted": false, "score": 9, "last_activity_date": 1555916642, "creation_date": 1555916642, "answer_id": 55790455, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/55790455#55790455", "title": "How to uninstall Golang?", "body": "<p><strong>On a Mac-OS system</strong></p>\n\n<ol>\n<li>If you have used an installer, you can uninstall golang by using the same installer.</li>\n<li>If you have installed from source\n\n<pre><code>rm -rf /usr/local/go\nrm -rf $(echo $GOPATH)\n</code></pre></li>\n</ol>\n\n<p>Then, remove all entries related to go i.e. GOROOT, GOPATH from <code>~/.bash_profile</code> and run</p>\n\n<pre><code>source ~/.bash_profile\n</code></pre>\n\n<p><strong>On a Linux system</strong></p>\n\n<pre><code>rm -rf /usr/local/go\nrm -rf $(echo $GOPATH)\n</code></pre>\n\n<p>Then, remove all entries related to go i.e. GOROOT, GOPATH from <code>~/.bashrc</code> and run</p>\n\n<pre><code>source ~/.bashrc\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "reply_to_user": {"reputation": 3142, "user_id": 2311167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZpVr.jpg?s=128&g=1", "display_name": "Adrian W", "link": "https://stackoverflow.com/users/2311167/adrian-w"}, "edited": false, "score": 0, "creation_date": 1559028383, "post_id": 56335504, "comment_id": 99279718, "body": "@adrian W can you please explain what is my mistakes."}, {"owner": {"reputation": 3142, "user_id": 2311167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZpVr.jpg?s=128&g=1", "display_name": "Adrian W", "link": "https://stackoverflow.com/users/2311167/adrian-w"}, "edited": false, "score": 0, "creation_date": 1559050105, "post_id": 56335504, "comment_id": 99291695, "body": "Nobody said it is a mistake. Just reformatted to suit the style which is usual in SO posts. I.e. text which is literal computer in/output (such as a shell command) is formatted as code block. It was formatted as citation before."}], "tags": [], "owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "is_accepted": false, "score": 3, "last_activity_date": 1559023932, "last_edit_date": 1559023932, "creation_date": 1559021224, "answer_id": 56335504, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/56335504#56335504", "title": "How to uninstall Golang?", "body": "<p>Use this command to uninstall Golang for Ubuntu.</p>\n\n<p>This will remove just the golang-go package itself.</p>\n\n<pre><code>sudo apt-get remove golang-go\n</code></pre>\n\n<p>Uninstall golang-go and its dependencies:</p>\n\n<pre><code>sudo apt-get remove --auto-remove golang-go\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17011, "user_id": 1079901, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/oEWB8.png?s=128&g=1", "display_name": "noob", "link": "https://stackoverflow.com/users/1079901/noob"}, "reply_to_user": {"reputation": 1358, "user_id": 9194639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcKsd.png?s=128&g=1", "display_name": "new QOpenGLWidget", "link": "https://stackoverflow.com/users/9194639/new-qopenglwidget"}, "edited": false, "score": 2, "creation_date": 1565216535, "post_id": 57402939, "comment_id": 101287415, "body": "@zixuan The quoted text explains it very well. Nobody mentioned the official docs, so I did. Do you find it ambiguous?"}], "tags": [], "owner": {"reputation": 17011, "user_id": 1079901, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/oEWB8.png?s=128&g=1", "display_name": "noob", "link": "https://stackoverflow.com/users/1079901/noob"}, "is_accepted": false, "score": 4, "last_activity_date": 1565216365, "creation_date": 1565216365, "answer_id": 57402939, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/57402939#57402939", "title": "How to uninstall Golang?", "body": "<p>From the <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">official install page</a> - </p>\n\n<blockquote>\n  <p>To remove an existing Go installation from your system delete the go\n  directory. This is usually <code>/usr/local/go</code> under Linux, macOS, and\n  FreeBSD or <code>c:\\Go</code> under Windows.</p>\n  \n  <p>You should also remove the Go <code>bin</code> directory from your PATH environment\n  variable. Under Linux and FreeBSD you should edit <code>/etc/profile</code> or\n  <code>$HOME/.profile</code>. If you installed Go with the <a href=\"https://golang.org/doc/install#macos\" rel=\"nofollow noreferrer\">macOS package</a> then you\n  should remove the <code>/etc/paths.d/go</code> file. Windows users should read the\n  section about <a href=\"https://golang.org/doc/install#windows_env\" rel=\"nofollow noreferrer\">setting environment variables under Windows</a>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 29273, "user_id": 1882064, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/45c89ec690f3c549bfbcc1cb43d6c6a6?s=128&d=identicon&r=PG", "display_name": "arcseldon", "link": "https://stackoverflow.com/users/1882064/arcseldon"}, "edited": false, "score": 9, "creation_date": 1566653307, "post_id": 57634196, "comment_id": 101728833, "body": "if you downvote, please can you leave a comment to clarify your reason. The above answer references and agrees with the official docs (Mac OSX). What didn&#39;t work for you?"}, {"owner": {"reputation": 1003, "user_id": 1042151, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a174aae9a43259bf01947d009bb351ec?s=128&d=identicon&r=PG", "display_name": "tom", "link": "https://stackoverflow.com/users/1042151/tom"}, "edited": false, "score": 0, "creation_date": 1606935905, "post_id": 57634196, "comment_id": 115117004, "body": "Unfortunately that link doesn&#39;t go to uninstall docs anymore."}, {"owner": {"reputation": 4046, "user_id": 1440240, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/079c35c4cdab398fc94f466961445fa8?s=128&d=identicon&r=PG", "display_name": "Ben Racicot", "link": "https://stackoverflow.com/users/1440240/ben-racicot"}, "edited": false, "score": 1, "creation_date": 1612489353, "post_id": 57634196, "comment_id": 116789881, "body": "I didnt DV but this would only work if you&#39;ve installed to those paths which is only the Go packed install wizard thing. Installs via scripts, automation or choice can be anywhere."}, {"owner": {"reputation": 3152, "user_id": 875657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/76252e82c814ba851bc53d1f4b17f1b3?s=128&d=identicon&r=PG", "display_name": "marcelosalloum", "link": "https://stackoverflow.com/users/875657/marcelosalloum"}, "edited": false, "score": 0, "creation_date": 1619008863, "post_id": 57634196, "comment_id": 118774578, "body": "Is there any advantage to use homebrew for installing Go, rather than the official *.pkg installer?"}, {"owner": {"reputation": 9525, "user_id": 777285, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/I1WDv.png?s=128&g=1", "display_name": "Arnaud P", "link": "https://stackoverflow.com/users/777285/arnaud-p"}, "reply_to_user": {"reputation": 1003, "user_id": 1042151, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a174aae9a43259bf01947d009bb351ec?s=128&d=identicon&r=PG", "display_name": "tom", "link": "https://stackoverflow.com/users/1042151/tom"}, "edited": false, "score": 1, "creation_date": 1619011351, "post_id": 57634196, "comment_id": 118775814, "body": "@tom I have fixed the link to official docs"}], "tags": [], "owner": {"reputation": 29273, "user_id": 1882064, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/45c89ec690f3c549bfbcc1cb43d6c6a6?s=128&d=identicon&r=PG", "display_name": "arcseldon", "link": "https://stackoverflow.com/users/1882064/arcseldon"}, "is_accepted": false, "score": 64, "last_activity_date": 1619011303, "last_edit_date": 1619011303, "creation_date": 1566605310, "answer_id": 57634196, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/57634196#57634196", "title": "How to uninstall Golang?", "body": "<p><strong>Update August 2019</strong></p>\n<p>Found the <a href=\"https://golang.org/doc/manage-install#uninstalling\" rel=\"nofollow noreferrer\">official uninstall docs</a> worked as expected (on Mac OSX).</p>\n<pre><code>$ which go\n/usr/local/go/bin/go\n</code></pre>\n<p>In summary, to uninstall:</p>\n<pre><code>$ sudo rm -rf /usr/local/go\n$ sudo rm /etc/paths.d/go\n</code></pre>\n<p>Then, did a fresh install with homebrew using <code>brew install go</code>. Now, i have:</p>\n<pre><code> $ which go\n/usr/local/bin/go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 7562902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Dt9O.jpg?s=128&g=1", "display_name": "hemant singh", "link": "https://stackoverflow.com/users/7562902/hemant-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1576045077, "last_edit_date": 1576045077, "creation_date": 1576042124, "answer_id": 59279369, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/59279369#59279369", "title": "How to uninstall Golang?", "body": "<p><strong>On a Mac-OS Catalina</strong></p>\n\n<ol>\n<li><p>need to add sudo before rm -rf /usr/local/go <strong>sudo rm -rf /usr/local/go</strong>\notherwise, we will run into permission denial.</p></li>\n<li><p><strong>sudo vim ~/.profile</strong> or <strong>sudo ~/.bash_profile</strong> remove <strong>export PATH=$PATH:$GOPATH/BIN</strong> or anything related to \ngo lang</p></li>\n<li>If you use Zsh shell, then you need to remove the above line to ~/.zshrc file. </li>\n</ol>\n\n<p>Hope it helps you :)</p>\n"}, {"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1607687757, "post_id": 65250390, "comment_id": 115356910, "body": "op asks how to <b>un</b>install"}, {"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 2, "creation_date": 1607693379, "post_id": 65250390, "comment_id": 115359236, "body": "What makes you think that the OP used Brew to install Go?"}], "tags": [], "owner": {"reputation": 1, "user_id": 14807278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G64aK.png?s=128&g=1", "display_name": "timtike", "link": "https://stackoverflow.com/users/14807278/timtike"}, "is_accepted": false, "score": -3, "last_activity_date": 1607716860, "last_edit_date": 1607716860, "creation_date": 1607685697, "answer_id": 65250390, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/65250390#65250390", "title": "How to uninstall Golang?", "body": "<p>In MacOS, you can just do it with <code>brew</code>:</p>\n<pre><code>brew uninstall go\nbrew install go\nbrew upgrade go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4046, "user_id": 1440240, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/079c35c4cdab398fc94f466961445fa8?s=128&d=identicon&r=PG", "display_name": "Ben Racicot", "link": "https://stackoverflow.com/users/1440240/ben-racicot"}, "is_accepted": false, "score": 1, "last_activity_date": 1612489197, "last_edit_date": 1612489197, "creation_date": 1612488743, "answer_id": 66056358, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang/66056358#66056358", "title": "How to uninstall Golang?", "body": "<p>I just have to answer here after reading such super-basic advice in the other answers.</p>\n<p>For MacOS the default paths are:</p>\n<ol>\n<li>/user/bracicot/go (working dir)</li>\n<li>/usr/local/go (install dir)</li>\n</ol>\n<p>When uninstalling remove both directories.<br />\nIf you've installed manually obviously these directories may be in other places.</p>\n<p>One script I came across installed to <code>/usr/local/.go/</code> a hidden folder because of permissioning... this could trip you up.</p>\n<p>In terminal check:</p>\n<pre><code>echo $GOPATH\necho $GOROOT\n#and\ngo version\n</code></pre>\n<p>For me after deleting all go folders I was still getting a go version.</p>\n<p>Digging through my system path <code>echo $PATH</code></p>\n<p><code>/Users/bracicot/google-cloud-sdk/bin:/usr/local/bin:</code></p>\n<p>revealed some places to check for still-existing go files such as <code>/usr/local/bin</code></p>\n<blockquote>\n<p>Another user mentioned: <code>/etc/paths.d/go</code></p>\n</blockquote>\n<p>You may also want to remove <code>GOPATH</code> and <code>GOROOT</code> environment variables.<br />\nCheck .zshsrc and or .bash_profile.<br />\nOr you can <code>unset GOPATH</code> and <code>unset GOROOT</code></p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117729, "favorite_count": 9, "protected_date": 1607709245, "accepted_answer_id": 42186042, "answer_count": 14, "score": 62, "last_activity_date": 1619011303, "creation_date": 1486891770, "last_edit_date": 1495540928, "question_id": 42186003, "link": "https://stackoverflow.com/questions/42186003/how-to-uninstall-golang", "title": "How to uninstall Golang?", "body": "<p>I tried the answer here <a href=\"https://stackoverflow.com/questions/35643576/removed-golang-but-go-command-still-works\">Removed golang but go command still works?</a>, but it didn't work (I can still run go)</p>\n\n<p>Currently, when I run <code>which go</code> I see this output</p>\n\n<pre><code>/usr/local/go/bin/go\n</code></pre>\n\n<p>I think I had two installations of go as my <code>GOPATH</code> was pointing to another folder named <code>gocode</code>. I've now removed that folder, and the <code>usr/local/go/bin/go</code> folder.</p>\n\n<p>I've also removed my <code>GOPATH</code>. However, I can still run <code>go</code>. </p>\n\n<p>How do I uninstall golang?</p>\n"}, {"tags": ["curl", "go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 1, "creation_date": 1486888613, "post_id": 42185635, "comment_id": 71533469, "body": "Because <code>go</code> follows redirection and <code>curl</code> don&#39;t?"}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1486888888, "post_id": 42185635, "comment_id": 71533525, "body": "@u_mulder you are right! changing the client to not use re-direct solve this. If you want to submit this as an answer feel free and I&#39;ll accept it (used code from here: stackoverflow.com/questions/23297520/how-can-i-make-the-go-h&zwnj;&#8203;ttp-client-not-follo&zwnj;&#8203;w-redirects-automati&zwnj;&#8203;cally)"}, {"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1486888951, "post_id": 42185635, "comment_id": 71533540, "body": "I think you can answer you question)"}], "answers": [{"tags": [], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "is_accepted": true, "score": 1, "last_activity_date": 1486889098, "creation_date": 1486889098, "answer_id": 42185713, "question_id": 42185635, "link": "https://stackoverflow.com/questions/42185635/different-response-from-curl-and-golang-post-cant-understand-why/42185713#42185713", "title": "Different Response From cURL and Golang POST - Can&#39;t Understand Why", "body": "<p>Thanks @u_mulder for pointing me out in the right direction. It seems that the default go <code>http</code> client follows the redirect header by default, while <code>curl</code> does not. </p>\n\n<p>Here is the updated code that generates the same results between go and <code>curl</code>:</p>\n\n<pre><code>body := strings.NewReader(`fulladdress=22280+S+209th+Way%2C+Queen+Creek%2C+AZ+85142`)\nreq, err := http.NewRequest(\"POST\", \"http://www.homefacts.com/hfreport.html\", body)\nif err != nil {\n    // handle err\n}\nreq.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n\nclient := &amp;http.Client{\n    CheckRedirect: func(req *http.Request, via []*http.Request) error {\n        return http.ErrUseLastResponse\n    },\n}\n\nresp, err := client.Do(req)\nif err != nil {\n    // handle err\n}\ndefer resp.Body.Close()\n</code></pre>\n"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1585, "favorite_count": 0, "accepted_answer_id": 42185713, "answer_count": 1, "score": 2, "last_activity_date": 1486889098, "creation_date": 1486888367, "question_id": 42185635, "link": "https://stackoverflow.com/questions/42185635/different-response-from-curl-and-golang-post-cant-understand-why", "title": "Different Response From cURL and Golang POST - Can&#39;t Understand Why", "body": "<p>I'm trying to get a response from a server using golang's <code>http</code> client. </p>\n\n<p>The request I'm looking to perform via go should be identical to the following <code>curl</code> command:</p>\n\n<pre><code>curl  --data \"fulladdress=22280+S+209th+Way%2C+Queen+Creek%2C+AZ+85142\"  'http://www.homefacts.com/hfreport.html'\n</code></pre>\n\n<p>I've coded the equivalent go code, and also tried using a nice service called <a href=\"https://mholt.github.io/curl-to-go/\" rel=\"nofollow noreferrer\">curl-to-go</a>, which generates the following go code for the above <code>curl</code> request:</p>\n\n<pre><code> // Generated by curl-to-Go: https://mholt.github.io/curl-to-go\n\nbody := strings.NewReader(`fulladdress=22280+S+209th+Way%2C+Queen+Creek%2C+AZ+85142`)\nreq, err := http.NewRequest(\"POST\", \"http://www.homefacts.com/hfreport.html\", body)\nif err != nil {\n    // handle err\n}\nreq.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n\nresp, err := http.DefaultClient.Do(req)\nif err != nil {\n    // handle err\n}\ndefer resp.Body.Close()\n</code></pre>\n\n<p>The problem is that I keep getting a different response between the <code>curl</code> command and the go code. The <code>curl</code> command returns this response body:</p>\n\n<pre><code>&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=\"refresh\" content=\"0;url=http://www.homefacts.com/address/Arizona/Maricopa-County/Queen-Creek/85142/22280-S-209th-Way.html\"/&gt;&lt;/head&gt;&lt;/html&gt;\n</code></pre>\n\n<p>which is the expected result. However the go code returns a lengthly <code>HTML</code> which is not the expected result.</p>\n\n<p>I've tried adding <code>--verbose</code> to the <code>curl</code> command to copy all it's headers, so I added the following headers via my go code:</p>\n\n<pre><code>req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\nreq.Header.Set(\"User-Agent\", \"curl/7.51.0\")\nreq.Header.Set(\"Accept\", \"*/*\")\nreq.Header.Set(\"Content-Length\", \"56\")\n</code></pre>\n\n<p>But still no joy, the output from the go code remains different than the <code>curl</code> one. </p>\n\n<p>Any ideas on how to get the same <code>curl</code> response from go? </p>\n"}, {"tags": ["arrays", "go"], "answers": [{"tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": true, "score": 5, "last_activity_date": 1486873448, "creation_date": 1486873448, "answer_id": 42184190, "question_id": 42184152, "link": "https://stackoverflow.com/questions/42184152/golang-print-the-number-of-occurances-of-the-values-in-an-array/42184190#42184190", "title": "GoLang Print the Number of Occurances of the Values in an Array", "body": "<p>You need to initialize <code>dict</code> with a non-nil map; one way would be with <code>var dict = make(map[int]int)</code>.</p>\n\n<p>Once you fix that, you will also need to deal with the logic error in <code>dict[num] = count+1</code>, where the count of that value is set to 1 (count is always 0) instead of one more than the previous value.</p>\n"}, {"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 7, "last_activity_date": 1486873680, "creation_date": 1486873680, "answer_id": 42184212, "question_id": 42184152, "link": "https://stackoverflow.com/questions/42184152/golang-print-the-number-of-occurances-of-the-values-in-an-array/42184212#42184212", "title": "GoLang Print the Number of Occurances of the Values in an Array", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\n    //Initialize an array \n    inputArray := []int{10,20,30,56,67,90,10,20}\n    printUniqueValue(inputArray)\n}\n\nfunc printUniqueValue( arr []int){\n    //Create a   dictionary of values for each element\n    dict:= make(map[int]int)\n    for _ , num :=  range arr {\n        dict[num] = dict[num]+1\n    }\n    fmt.Println(dict)\n}\n</code></pre>\n\n<p>This prints <code>map[67:1 90:1 10:2 20:2 30:1 56:1]</code></p>\n"}], "owner": {"reputation": 383, "user_id": 4634669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-RCOr91QgPvQ/AAAAAAAAAAI/AAAAAAAAAIk/X1Aka8XIDgw/photo.jpg?sz=128", "display_name": "athavan kanapuli", "link": "https://stackoverflow.com/users/4634669/athavan-kanapuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3746, "favorite_count": 0, "accepted_answer_id": 42184190, "answer_count": 2, "score": 4, "last_activity_date": 1486873680, "creation_date": 1486873011, "question_id": 42184152, "link": "https://stackoverflow.com/questions/42184152/golang-print-the-number-of-occurances-of-the-values-in-an-array", "title": "GoLang Print the Number of Occurances of the Values in an Array", "body": "<p>The following is my code  where I need to Print the number of occurances of each values in an array.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\n    //Initialize an array \n    inputArray := []int{10,20,30,56,67,90,10,20}\n    printUniqueValue(inputArray)\n}\n\nfunc printUniqueValue( arr []int){\n    //Create a   dictionary of values for each element\n    var  dict map[int]int \n    count := 0\n    for _ , num :=  range arr {\n        dict[num] = count+1\n    }\n    fmt.Println(dict)\n}\n</code></pre>\n\n<p>But I couldn't  construct the dictionary as I wish like ,  dict[10] should have value 2. \nSample Expected Output :</p>\n\n<pre><code>dict[10] = 2\ndict[20] = 2\ndict[30] = 1  \n</code></pre>\n\n<p>Error I  got:  panic: assignment to entry in nil map</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1486867323, "post_id": 42183615, "comment_id": 71529856, "body": "Hard to answer this if you don&#39;t supply the inputs you are typing and the output of the application"}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 4, "creation_date": 1486871322, "post_id": 42183615, "comment_id": 71530529, "body": "Because <code>float32(zero_&#47;len(arr))</code> first divides an int by an int which gives you zero and then you convert that 0 to a float32 0. It should be <code>float32(zero_)&#47;float32(len(arr))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6707730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n0irX.jpg?s=128&g=1", "display_name": "Davit Hermansyah", "link": "https://stackoverflow.com/users/6707730/davit-hermansyah"}, "edited": false, "score": 0, "creation_date": 1486888133, "post_id": 42183775, "comment_id": 71533378, "body": "i mean to output  A decimal representing of the fraction of positive numbers in the array. A decimal representing of the fraction of negative numbers in the array. A decimal representing of the fraction of zeroes in the array.  Sample Input  6  -4 3 -9 0 4 1  Sample Output  0.500000  0.333333  0.166667  but in my code the output like this with the same input  1.000000  0.000000  0.000000"}], "tags": [], "owner": {"reputation": 11435, "user_id": 6328256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PyZe2.png?s=128&g=1", "display_name": "Sash Sinha", "link": "https://stackoverflow.com/users/6328256/sash-sinha"}, "is_accepted": false, "score": 0, "last_activity_date": 1486868472, "creation_date": 1486868472, "answer_id": 42183775, "question_id": 42183615, "link": "https://stackoverflow.com/questions/42183615/float-return-zero-in-golang/42183775#42183775", "title": "Float return zero in golang", "body": "<p>Firstly the first variable you get from the user is the length of the array not the index... Secondly you should prompt the user when asking for user input like so:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n  var length int\n  fmt.Print(\"Please enter the length of the array: \")\n  fmt.Scan(&amp;length)\n\n  var arr = make([]int, length)\n  for i := 0; i &lt; len(arr); i++ {\n    fmt.Printf(\"Please enter the value at index %d of the array: \", i)\n    fmt.Scan(&amp;arr[i])\n  }\n\n  fmt.Println(\"You entered the array: \", arr)\n\n  positive := 0\n  negative := 0\n  zero := 0\n  for _, arr_v := range arr {\n    if arr_v &gt; 0 {\n      positive++\n    } else if arr_v &lt; 0 {\n      negative++\n    } else if arr_v == 0 {\n      zero++\n    }\n  }\n\n  fmt.Printf(\"There are %d postive numbers in the array\\n\", int32(positive))\n  fmt.Printf(\"There are %d negative numbers in the array\\n\", int32(negative))\n  fmt.Printf(\"There are %d zeroes in the array\", int32(zero))\n}\n</code></pre>\n\n<p><strong>Example Usage:</strong></p>\n\n<pre><code>Please enter the length of the array:  4\nPlease enter the value at index 0 of the array:  7\nPlease enter the value at index 1 of the array:  0\nPlease enter the value at index 2 of the array:  -9\nPlease enter the value at index 3 of the array:  8\nYou entered the array:  [7 0 -9 8]\nThere are 2 postive numbers in the array\nThere are 1 negative numbers in the array\nThere are 1 zeroes in the array\n</code></pre>\n\n<p>Try it <a href=\"https://repl.it/FgfQ/0\" rel=\"nofollow noreferrer\">here!</a></p>\n"}, {"comments": [{"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "reply_to_user": {"reputation": 55, "user_id": 6707730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n0irX.jpg?s=128&g=1", "display_name": "Davit Hermansyah", "link": "https://stackoverflow.com/users/6707730/davit-hermansyah"}, "edited": false, "score": 0, "creation_date": 1486955039, "post_id": 42183822, "comment_id": 71554060, "body": "Welcome. Glade that my answer is helping you."}], "tags": [], "owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "is_accepted": true, "score": 0, "last_activity_date": 1486944258, "last_edit_date": 1486944258, "creation_date": 1486869025, "answer_id": 42183822, "question_id": 42183615, "link": "https://stackoverflow.com/questions/42183615/float-return-zero-in-golang/42183822#42183822", "title": "Float return zero in golang", "body": "<p>I've done some modifications to your code and it should run as you expected:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"bufio\"\n    \"os\"\n    \"strconv\"\n)\n\nfunc main() {\n    scanner := bufio.NewScanner(os.Stdin)\n    fmt.Print(\"Enter the lenght of the array: \")\n    scanner.Scan()\n    index_of_array, err := strconv.Atoi(scanner.Text())\n    if err != nil {\n        panic(\"Errroor!\")\n    }\n\n    arr := make([]int, index_of_array)\n\n    for i := 0; i &lt; len(arr); i++ {\n        fmt.Printf(\"Enter value number %d: \", i+1)\n        scanner.Scan()\n        arr[i], err = strconv.Atoi(scanner.Text())\n        if err != nil {\n            panic(\"Error 2!\")\n        }\n    }\n\n    positive := 0\n    negative := 0\n    zero_ := 0\n    for _, arr_v := range arr {\n        if arr_v &gt; 0 {\n            positive++\n        } else if arr_v &lt; 0 {\n            negative++\n        } else if arr_v == 0 {\n            zero_++\n        }\n    }\n\n    fmt.Println(\"Array entered: \", arr)\n    fmt.Printf(\"There are %d positive number(s) of %d in the array. Fraction: %.6f\\n\", positive, len(arr), float64(positive)/float64(len(arr)))\n    fmt.Printf(\"There are %d negative number(s) of %d in the array. Fraction: %.6f\\n\", negative, len(arr), float64(negative)/float64(len(arr)))\n    fmt.Printf(\"There are %d zero(s) of %d in the array. Fraction: %.6f\\n\", zero_, len(arr), float64(zero_)/ float64(len(arr)))\n\n}\n</code></pre>\n\n<p>you can run it on <a href=\"https://repl.it/FgfQ/2\" rel=\"nofollow noreferrer\">repl.it</a></p>\n\n<p>And you can use it like this example:</p>\n\n<pre><code>Enter the lenght of the array: 6\nEnter value number 1: -4\nEnter value number 2: 3\nEnter value number 3: -9\nEnter value number 4: 0\nEnter value number 5: 4\nEnter value number 6: 1\nArray entered:  [-4 3 -9 0 4 1]\nThere are 3 positive number(s) of 6 in the array. Fraction: 0.500000\nThere are 2 negative number(s) of 6 in the array. Fraction: 0.333333\nThere are 1 zero(s) of 6 in the array. Fraction: 0.166667\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6707730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n0irX.jpg?s=128&g=1", "display_name": "Davit Hermansyah", "link": "https://stackoverflow.com/users/6707730/davit-hermansyah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 42183822, "answer_count": 2, "score": 0, "last_activity_date": 1486944258, "creation_date": 1486866731, "last_edit_date": 1486888670, "question_id": 42183615, "link": "https://stackoverflow.com/questions/42183615/float-return-zero-in-golang", "title": "Float return zero in golang", "body": "<p>Why does this code always return zero:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var index_of_array int\n    fmt.Scan(&amp;index_of_array)\n    var arr = make([]int, index_of_array)\n    for i := 0; i &lt; len(arr); i++ {\n        fmt.Scan(&amp;arr[i])\n    }\n\n    positive := 0\n    negative := 0\n    zero_ := 0\n    for _, arr_v := range arr {\n        if arr_v &gt; 0 {\n            positive++\n        } else if arr_v &lt; 0 {\n            negative++\n        } else if arr_v == 0 {\n            zero_++\n        }\n    }\n\n    fmt.Printf(\"%f \", float32(positive/len(arr)))\n    fmt.Printf(\"%f \", float32(negative/len(arr)))\n    fmt.Printf(\"%f \", float32(zero_/len(arr)))\n\n}\n</code></pre>\n\n<p>i mean to output</p>\n\n<p>A decimal representing of the fraction of positive numbers in the array.\n A decimal representing of the fraction of negative numbers in the array.\n A decimal representing of the fraction of zeroes in the array.</p>\n\n<p>Sample Input</p>\n\n<p>6</p>\n\n<p>-4 3 -9 0 4 1</p>\n\n<p>Sample Output</p>\n\n<p>0.500000</p>\n\n<p>0.333333</p>\n\n<p>0.166667</p>\n\n<p>but in my code the output like this with the same input</p>\n\n<p>0.000000</p>\n\n<p>0.000000</p>\n\n<p>0.000000</p>\n"}, {"tags": ["unit-testing", "testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 3, "last_activity_date": 1486848572, "creation_date": 1486848572, "answer_id": 42181442, "question_id": 42181009, "link": "https://stackoverflow.com/questions/42181009/go-cli-cant-find-my-tests/42181442#42181442", "title": "Go cli cant find my tests", "body": "<p>Test functions must begin with <code>Test</code>. Try renaming your function to <code>TestTest</code>. That should fix it. Full info here: <a href=\"https://golang.org/pkg/testing\" rel=\"nofollow noreferrer\">https://golang.org/pkg/testing</a></p>\n"}], "owner": {"reputation": 155, "user_id": 5910064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd6b289147ef3b80c77fe55b382ac5e?s=128&d=identicon&r=PG&f=1", "display_name": "Yeater", "link": "https://stackoverflow.com/users/5910064/yeater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 42181442, "answer_count": 1, "score": 1, "last_activity_date": 1486848572, "creation_date": 1486845812, "question_id": 42181009, "link": "https://stackoverflow.com/questions/42181009/go-cli-cant-find-my-tests", "title": "Go cli cant find my tests", "body": "<p>When i try to run my tests in golang i get the following error</p>\n\n<pre><code>testing: warning: no tests to run\n</code></pre>\n\n<p>I also tried to create a test project to see if it behaves the same in other projects these are my 2 files.</p>\n\n<pre><code>package test\n\nfunc test() string {\n    return \"test\"\n}\n</code></pre>\n\n<p>And here is my test.</p>\n\n<pre><code>package test\n\nimport (\n    \"testing\"\n\n    \"github.com/stretchr/testify/assert\"\n )\n\n func testTest(t *testing.T) {\n    assert.Equal(t, \"test\", test(), \"String was not test\")\n }\n</code></pre>\n\n<p>I tried running it with:</p>\n\n<pre><code>go test\ngo test -v\n</code></pre>\n\n<p>Also i tested the behaviour in git bash and the cmd.\nIm using Windows 10 with Go 1.7.1.</p>\n\n<p>I hope somebody can help me.</p>\n"}, {"tags": ["memory", "go", "process", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1486845659, "post_id": 42180716, "comment_id": 71524847, "body": "Just forget about &quot;process&quot;, this is an OS/userspace/layman term. In GO everything is a goroutine and these are scheduled to threads. There are no &quot;go processes&quot; (whatever that could mean)."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1486849147, "post_id": 42180716, "comment_id": 71525821, "body": "To expand on that a little, when you run a go program it&#39;s just like running anything else \u2013 it&#39;s only one process (unless the program explicitly creates other processes). There&#39;s always at least one goroutine in a Go program (the one that runs <code>main</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": true, "score": 4, "last_activity_date": 1486853329, "last_edit_date": 1495542302, "creation_date": 1486853329, "answer_id": 42182138, "question_id": 42180716, "link": "https://stackoverflow.com/questions/42180716/is-a-process-the-same-as-a-goroutine-in-golang/42182138#42182138", "title": "Is a process the same as a Goroutine in Golang?", "body": "<blockquote>\n  <p>Is a process the same as a Goroutine in Golang?</p>\n</blockquote>\n\n<p>You are using the wrong term <code>process</code> here. In GO everything is a goroutine. as <a href=\"https://stackoverflow.com/users/1266756/volker\">Volker</a> said. and you can see gouroutine definition from <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow noreferrer\">here</a> : </p>\n\n<blockquote>\n  <p>A goroutine is a lightweight thread managed by the Go runtime.</p>\n</blockquote>\n\n<p>for example in your code </p>\n\n<pre><code>func main() {\n    goRtns := runtime.NumGoroutine()\n    fmt.Println(\"goroutines:\", goRtns)\n}\n</code></pre>\n\n<p>this has only one goroutine because it has only <code>main</code> function and inside there are no <code>go</code> calling here. it just print the something from given variable.</p>\n\n<p>another example if you have <code>go</code> called in your function <code>main</code> : </p>\n\n<pre><code>func main() {\n\n    result := sq(sq(sq(gen(1, 2, 3, 4))))\n\n    numGoroutines := runtime.NumGoroutine()\n    fmt.Println(\"number goroutine = \", numGoroutines)\n\n    fmt.Println(&lt;-result)\n    fmt.Println(&lt;-result)\n    fmt.Println(&lt;-result)\n    fmt.Println(&lt;-result)\n\n}\n</code></pre>\n\n<p>you can find sq and gen function <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">here</a>. Now the <code>runtime.NumGoroutine()</code> will have 5 gorutine. Since inside function <code>gen</code> and <code>sq</code> we have <code>go</code> called and we combine theme here the total would be 4 + the <code>main</code> the final result is 5. </p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 2, "last_activity_date": 1486892417, "creation_date": 1486892417, "answer_id": 42186072, "question_id": 42180716, "link": "https://stackoverflow.com/questions/42180716/is-a-process-the-same-as-a-goroutine-in-golang/42186072#42186072", "title": "Is a process the same as a Goroutine in Golang?", "body": "<p>You have to be careful about the term <em>process</em> in Go. You quoted a definition about operating system entities called <em>processes</em> that will be recognised very widely. Many people will understand that usage.</p>\n\n<p>But the term is overloaded. The work of C.A.R. Hoare also matters to us: in his <em>Communicating Sequential Processes</em> (CSP) algebra, the term <em>process</em> refers to something small - much more like a super-lightweight thread. His algebra is in a category of mathematics called <em>process algebra</em>.</p>\n\n<p>So it is fair to assume that a <em>goroutine</em> is Go's implementation of a CSP <em>process</em>.</p>\n\n<p>Go is like a much older language, Occam, in this respect. In Occam a process means a CSP process. Occam was widely used for bare-metal (I.e. no operating system) embedded programming and so there was never any ambiguity over the term <em>process</em>.</p>\n"}], "owner": {"reputation": 587, "user_id": 3582467, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/805cee70da40b10138134970787daed0?s=128&d=identicon&r=PG", "display_name": "abgordon", "link": "https://stackoverflow.com/users/3582467/abgordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2393, "favorite_count": 1, "accepted_answer_id": 42182138, "answer_count": 2, "score": 5, "last_activity_date": 1486892417, "creation_date": 1486843975, "question_id": 42180716, "link": "https://stackoverflow.com/questions/42180716/is-a-process-the-same-as-a-goroutine-in-golang", "title": "Is a process the same as a Goroutine in Golang?", "body": "<p>For the following code:</p>\n\n<pre><code>func main() {\n    goRtns := runtime.NumGoroutine()\n    fmt.Println(\"goroutines:\", goRtns)\n}\n</code></pre>\n\n<p>The output is <code>1</code>. But this is within a \"process,\" with no goroutines being explicitly called:</p>\n\n<p>\"In computing, a process is an instance of a computer program that is being executed. It contains the program code and its current activity. Depending on the operating system (OS), a process may be made up of multiple threads of execution that execute instructions concurrently.\"</p>\n\n<p>Also from the excellent \"How goroutines work\" blog post by Krishna Sundarram: <a href=\"http://blog.nindalf.com/how-goroutines-work/\" rel=\"noreferrer\">http://blog.nindalf.com/how-goroutines-work/</a></p>\n\n<p>\"The creation of a goroutine does not require much memory - only 2kB of stack space. They grow by allocating and freeing heap storage as required.\" </p>\n\n<p>My question is this, then: the instance of code that is running (my simple main.go function) is counted as a goroutine by the runtime library. Am I to assume that the parent process is treated as a go routine, with the same rules of memory allocation, garbage collection, etc? Would it be wise to assume reading a fact about a goroutine's execution is analogous to the overarching go process that runs it? With respect to the second quote on goroutines above, this sounds like a process growing/shrinking its stack space as a program executes which is a standard paradigm in programming. </p>\n\n<p>Do go processes and routines share the same rules? Or am I just missing something about the reported number of goroutines. </p>\n"}, {"tags": ["sql", "postgresql", "go"], "comments": [{"owner": {"reputation": 629, "user_id": 1572023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b3103a5ba913c4b6de8d131709a15f?s=128&d=identicon&r=PG", "display_name": "csm", "link": "https://stackoverflow.com/users/1572023/csm"}, "edited": false, "score": 0, "creation_date": 1486840848, "post_id": 42179617, "comment_id": 71523331, "body": "What do you mean by &quot;database arguments&quot;? Could you give a minimal example of what such a query looks like including the database arguments?"}, {"owner": {"reputation": 1651, "user_id": 787563, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f486d3f0381e98e0287d45ebc6e1fc6e?s=128&d=identicon&r=PG", "display_name": "HackToHell", "link": "https://stackoverflow.com/users/787563/hacktohell"}, "reply_to_user": {"reputation": 629, "user_id": 1572023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b3103a5ba913c4b6de8d131709a15f?s=128&d=identicon&r=PG", "display_name": "csm", "link": "https://stackoverflow.com/users/1572023/csm"}, "edited": false, "score": 0, "creation_date": 1486878594, "post_id": 42179617, "comment_id": 71531693, "body": "@csm can you check the answer below, it has exactly what I needed."}], "answers": [{"comments": [{"owner": {"reputation": 1651, "user_id": 787563, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f486d3f0381e98e0287d45ebc6e1fc6e?s=128&d=identicon&r=PG", "display_name": "HackToHell", "link": "https://stackoverflow.com/users/787563/hacktohell"}, "edited": false, "score": 0, "creation_date": 1486878558, "post_id": 42183206, "comment_id": 71531689, "body": "Thanks, that was exactly what I was looking for, can we use varargs like this on all functions that have multiple arguments like this in golang ?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 1651, "user_id": 787563, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f486d3f0381e98e0287d45ebc6e1fc6e?s=128&d=identicon&r=PG", "display_name": "HackToHell", "link": "https://stackoverflow.com/users/787563/hacktohell"}, "edited": false, "score": 0, "creation_date": 1486882005, "post_id": 42183206, "comment_id": 71532247, "body": "The function must be declared to accept variadic parameters, as <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow noreferrer\">DB.Query</a> does. See also the <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">spec</a>. Also <a href=\"https://play.golang.org/p/Xk9tqeCkit\" rel=\"nofollow noreferrer\">have a play</a>."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 1651, "user_id": 787563, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f486d3f0381e98e0287d45ebc6e1fc6e?s=128&d=identicon&r=PG", "display_name": "HackToHell", "link": "https://stackoverflow.com/users/787563/hacktohell"}, "edited": false, "score": 0, "creation_date": 1487018237, "post_id": 42183206, "comment_id": 71587470, "body": "Glad to hear. Also, use <a href=\"https://golang.org/pkg/database/sql/#DB.Exec\" rel=\"nofollow noreferrer\">db.Exec</a> for inserts and updates, not db.Query. Use db.Query when the query returns rows. I just noticed now and edited the answer."}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 3, "last_activity_date": 1487017729, "last_edit_date": 1487017729, "creation_date": 1486862272, "answer_id": 42183206, "question_id": 42179617, "link": "https://stackoverflow.com/questions/42179617/handling-inserts-into-a-database-with-varying-and-large-number-of-columns-in-gol/42183206#42183206", "title": "Handling inserts into a database with varying and large number of columns in golang", "body": "<p>Assuming column values will default to null if not set, here's one approach.</p>\n\n<p>Create a map of column names to interface{} values:</p>\n\n<pre><code>args := make(map[string]interface{})\n</code></pre>\n\n<p>Set the column values you're interested in:</p>\n\n<pre><code>args[\"col_x\"] = . . . \nargs[\"col_y\"] = . . .\n</code></pre>\n\n<p>Prepare the sql statement:</p>\n\n<pre><code>sql = \"insert into tab ( xxx ) values ( yyy )\"\n</code></pre>\n\n<p>where xxx is the list of column names, and yyy is the list of value replacement characters, one for each value, specific to the database, eg, ?</p>\n\n<p>Finally execute the query, expanding args as a variadic parameter:</p>\n\n<pre><code>db.Exec(sql, args...)\n</code></pre>\n"}], "owner": {"reputation": 1651, "user_id": 787563, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f486d3f0381e98e0287d45ebc6e1fc6e?s=128&d=identicon&r=PG", "display_name": "HackToHell", "link": "https://stackoverflow.com/users/787563/hacktohell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 42183206, "answer_count": 1, "score": 0, "last_activity_date": 1487017729, "creation_date": 1486837741, "question_id": 42179617, "link": "https://stackoverflow.com/questions/42179617/handling-inserts-into-a-database-with-varying-and-large-number-of-columns-in-gol", "title": "Handling inserts into a database with varying and large number of columns in golang", "body": "<p>So I have golang program that reads a JSON off a kafka queue, makes it into normal flat syntax and pushes to a database table. The table is has (200+) columns, if the data doesn't contain a column, a null should be inserted. </p>\n\n<p>Currently I can do that by forming the INSERT statement manually(with the present fields), problem comes with database arguments, how do I pass the argument to <code>db.Query</code> ?</p>\n\n<p>The database to be populated is postgresql.</p>\n"}, {"tags": ["sql", "sql-server", "linux", "go"], "comments": [{"owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 0, "creation_date": 1486834148, "post_id": 42178564, "comment_id": 71520989, "body": "are you able to connect from sqlcmd atleast ?"}, {"owner": {"reputation": 91, "user_id": 7075406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/714d96a51d5af64c7ede064980c0a553?s=128&d=identicon&r=PG&f=1", "display_name": "Samu", "link": "https://stackoverflow.com/users/7075406/samu"}, "reply_to_user": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 0, "creation_date": 1486838290, "post_id": 42178564, "comment_id": 71522462, "body": "@TheGameiswar yes I am"}, {"owner": {"reputation": 346, "user_id": 852853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95d4519031ee41d18f25149e46f397ee?s=128&d=identicon&r=PG", "display_name": "Luis Bosquez", "link": "https://stackoverflow.com/users/852853/luis-bosquez"}, "edited": false, "score": 0, "creation_date": 1487022444, "post_id": 42178564, "comment_id": 71589645, "body": "can you show the errorlog contents? <code>cat &#47;var&#47;opt&#47;mssql&#47;log&#47;errorlog</code> if the connection went through, you might see an entry there."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 0, "creation_date": 1487499889, "post_id": 42178564, "comment_id": 71805030, "body": "I guess 500 error means database access happens inside an http handler. Which would mean your handler&#39;s code actually panicked. Recover from panic and log the error intercepted. It will most likely tell you what the problem is."}], "answers": [{"tags": [], "owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "is_accepted": false, "score": 0, "last_activity_date": 1486835274, "last_edit_date": 1486835274, "creation_date": 1486834519, "answer_id": 42179016, "question_id": 42178564, "link": "https://stackoverflow.com/questions/42178564/how-to-connect-to-mssql-database-in-linux-with-go/42179016#42179016", "title": "How to connect to mssql database in linux with GO", "body": "<p>In the <a href=\"https://github.com/denisenkom/go-mssqldb/blob/master/examples/simple.go\" rel=\"nofollow noreferrer\">Github example</a> you can see how it work.\nYou can follow those steps:</p>\n\n<pre><code>var (\n    server    string = \"localhost\" // for example\n    user      string = \"userdb\"    // Database user\n    password  string = \"userpwd\"   // User Password\n    port      int    = 1433        // Database port\n)\n\nconnString := fmt.Sprintf(\"server=%s;user id=%s;password=%s;port=%d\", server, user, password, port)\nconn, err := sql.Open(\"mssql\", connString)\n\n// Test if the connection is OK or not\nif err != nil {\n    panic(\"Cannot connect to database\")\n} else {\n    fmt.Println(\"Connected!\")\n\n  }\n// Don't forget to close the connection to your database\ndefer conn.Close()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": false, "score": 0, "last_activity_date": 1486923832, "creation_date": 1486923832, "answer_id": 42191450, "question_id": 42178564, "link": "https://stackoverflow.com/questions/42178564/how-to-connect-to-mssql-database-in-linux-with-go/42191450#42191450", "title": "How to connect to mssql database in linux with GO", "body": "<pre><code>import \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\ndb, err := sql.Open(\"mysql\", \"user:password@/dbname\")\n</code></pre>\n\n<p>As simple as this you can connect to your DB\nyou should add driver in your code as unused package then it has parameters URI to connect to DB.\nAnd you can query like this link blow\n<a href=\"https://golang.org/pkg/database/sql/#example_DB_Query\" rel=\"nofollow noreferrer\">https://golang.org/pkg/database/sql/#example_DB_Query</a></p>\n"}, {"tags": [], "owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "is_accepted": false, "score": 0, "last_activity_date": 1486980524, "creation_date": 1486980524, "answer_id": 42201443, "question_id": 42178564, "link": "https://stackoverflow.com/questions/42178564/how-to-connect-to-mssql-database-in-linux-with-go/42201443#42201443", "title": "How to connect to mssql database in linux with GO", "body": "<p>If you are having troubles creating a connection string, then you can always get your library to format your connection string for you.</p>\n\n<pre><code>import (\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n    // OTHER STUFF\n)\n\nfunc main() {\n    cfg := mysql.Config{\n        User:   \"username\",\n        Passwd: \"password\",\n        Net:    \"tcp\",\n        Addr:   \"127.0.0.1:3306\",\n        DBName: \"database_name\",\n    }\n\n    db, err := sql.Open(\"mysql\", cfg.FormatDSN())\n    check(err)\n\n    // DO SOMETHING WITH db\n}\n\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7075406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/714d96a51d5af64c7ede064980c0a553?s=128&d=identicon&r=PG&f=1", "display_name": "Samu", "link": "https://stackoverflow.com/users/7075406/samu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1949, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1486980524, "creation_date": 1486832092, "question_id": 42178564, "link": "https://stackoverflow.com/questions/42178564/how-to-connect-to-mssql-database-in-linux-with-go", "title": "How to connect to mssql database in linux with GO", "body": "<p>I have created and connected to an sql server on linux using <a href=\"https://docs.microsoft.com/en-us/sql/linux/sql-server-linux-connect-and-query-sqlcmd\" rel=\"nofollow noreferrer\">this</a> tutorial.</p>\n\n<p>I am using golang and <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">this</a> driver. (<a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">https://github.com/denisenkom/go-mssqldb</a>)</p>\n\n<p>I am having problems connecting to the database using golang. I have specified a user as SA and a password. I have also written in the terminal \"hostname\" and got the hostname xxx. When I use that info to connect I get a 500 error. </p>\n\n<pre><code>conn, err := sql.Open(\"mssql\", \"server=xxx; id=SA; password=mypass; database=testdb)\n</code></pre>\n\n<p>Does this seem correct? I am a newbie so maybe I am missing something obvious?</p>\n"}, {"tags": ["go", "rethinkdb", "rethinkdb-go"], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 7551505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22b1c5459924dd6509ec732c3a008e3?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Hughes", "link": "https://stackoverflow.com/users/7551505/sam-hughes"}, "is_accepted": false, "score": 1, "last_activity_date": 1486846273, "creation_date": 1486846273, "answer_id": 42181092, "question_id": 42178117, "link": "https://stackoverflow.com/questions/42178117/update-object-in-do-function-in-rethinkdb/42181092#42181092", "title": "Update object in Do-function in RethinkDB", "body": "<p>Because the document <code>room</code> has an id, you can select the document by id (instead of filtering the whole table a second time) and update it that way.</p>\n"}], "owner": {"reputation": 932, "user_id": 1955931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GvXEF.png?s=128&g=1", "display_name": "Jan Berktold", "link": "https://stackoverflow.com/users/1955931/jan-berktold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1486846273, "creation_date": 1486829604, "question_id": 42178117, "link": "https://stackoverflow.com/questions/42178117/update-object-in-do-function-in-rethinkdb", "title": "Update object in Do-function in RethinkDB", "body": "<p>Example data in table <em>rooms</em>:</p>\n\n<pre><code>{\n    \"id\": \"8ae9865-b602-41f7-8637-9fd5517095d9\",\n    \"members\": {\n        \"12345\": {\n            \"Id\": 12345,\n            \"Name\": \"User1\",\n            \"LastUpdated\": timestamp\n        }\n    }\n}\n</code></pre>\n\n<p>My query:</p>\n\n<pre><code>        result, err := r.DB(rethinkdbDatabase).Table(\"rooms\").Filter(\n            r.Row.Field(\"members\").HasFields(playerIdStr)).Nth(0).Default(nil).Do(func(room r.Term) interface{} {\n            return r.Branch(\n                    room.Ne(nil),\n                    room.Update(map[string]interface{}{\n                            \"LastUpdate\": r.Now(),\n                    }),\n                    r.DB(rethinkdbDatabase).Table(\"rooms\").Insert(map[string]interface{}{\n                            \"id\": r.UUID(),\n                            \"members\": map[string]interface{}{\n                                    playerIdStr: map[string]interface{}{\n                                            \"LastUpdate\": r.Now(),\n                                            \"Name\":       request.Player.Name,\n                                            \"Id\":         request.Player.Id,\n                                    },\n                            },\n                    }, r.InsertOpts{\n                            Durability: \"hard\",\n                    }),\n            )\n    }).Run(rethinkdbClient)\n</code></pre>\n\n<p>It gives the following error:</p>\n\n<pre><code>gorethink: Expected type SELECTION but found DATUM:\n{\n    \"id\":   \"08ae9865-b602-41f7-8637-9fd5517095d9\",\n    \"members\":      {\n    \"7360165\":      {\n    \"Id\":   7360165,\n    \"LastUpdate\":   {\n    \"$reql_type$\":  \"TIME\",\n    \"epoch_time\":   1486826898.51,\n    \"timezone\":     \"+00:00\"\n    },\n    \"Name\": \"Player1\"\n    }\n    }\n} in:\nr.Do(func(var_10 r.Term) r.Term { return r.Branch(var_10.Ne(&lt;nil&gt;), var_10.Update({LastUpdate=r.Now()}), r.DB(\"drill_dev\").Table(\"rooms\").Insert({id=r.UUID(), members={7360165={LastUpdate=r.Now(), Name=\"Player1\", Id=7360165}}}, durability=\"hard\")) }, r.DB(\"drill_dev\").Table(\"rooms\").Filter(func(var_9 r.Term) r.Term { return r.Row.Field(\"members\").HasFields(\"7360165\") }).Nth(0).Default(&lt;nil&gt;))\n</code></pre>\n\n<p>To my understanding, the issue appears to be, that the <em>room</em> variable is of type <em>OBJECT</em> which is not compatible with the update function, therefore the call room.Update({...}) does not work. How can I update the \"LastUpdated\" field in the nested document without having to filter the table again, using the <em>room</em> variable?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 527, "user_id": 335472, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3eec49d54e643c464a5d9e42c8dd5c59?s=128&d=identicon&r=PG", "display_name": "Joao Henrique", "link": "https://stackoverflow.com/users/335472/joao-henrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1486905169, "creation_date": 1486905169, "answer_id": 42187971, "question_id": 42176843, "link": "https://stackoverflow.com/questions/42176843/golang-what-is-the-meaning-of-the-seconds-in-cpu-profiling-graph/42187971#42187971", "title": "Golang - What is the meaning of the seconds in CPU profiling graph?", "body": "<p>When CPU profiling is enabled, the Go program stops about 100 times per second and records a sample consisting of the program counters on the currently executing goroutine's stack.</p>\n\n<p>That time and percentange is in reference to the sample.</p>\n\n<p>Here is a nice reference for you to read more about it: <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">https://blog.golang.org/profiling-go-programs</a></p>\n"}], "owner": {"reputation": 5435, "user_id": 1078503, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/00cb3812de2cb2d15f6e5d14c15e6ed8?s=128&d=identicon&r=PG", "display_name": "leiyonglin", "link": "https://stackoverflow.com/users/1078503/leiyonglin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1486905169, "creation_date": 1486822261, "question_id": 42176843, "link": "https://stackoverflow.com/questions/42176843/golang-what-is-the-meaning-of-the-seconds-in-cpu-profiling-graph", "title": "Golang - What is the meaning of the seconds in CPU profiling graph?", "body": "<p>For example, the data in the figure <strong>runtime.scanobject</strong>:</p>\n\n<ol>\n<li>13.42s</li>\n<li>runtime.scanobject 9.69s(4.51%) of 18.30s(8.52%). </li>\n<li>5.33s</li>\n</ol>\n\n<p>what is the meaning of the seconds and percent?</p>\n\n<p>Thanks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qiMGA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qiMGA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "udp", "ipv6"], "answers": [{"comments": [{"owner": {"reputation": 1041, "user_id": 2772588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b6fb04e8ecf4cae2da6d45b813f7829c?s=128&d=identicon&r=PG", "display_name": "ababo", "link": "https://stackoverflow.com/users/2772588/ababo"}, "edited": false, "score": 0, "creation_date": 1486856469, "post_id": 42180512, "comment_id": 71527798, "body": "Thanks! For my card address I get <code>write: connection refused</code>, for a (link-local) multicast address it works as expected."}], "tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": true, "score": 3, "last_activity_date": 1486842686, "last_edit_date": 1490005099, "creation_date": 1486842686, "answer_id": 42180512, "question_id": 42175773, "link": "https://stackoverflow.com/questions/42175773/sending-udpv6-locally-in-golang/42180512#42180512", "title": "Sending UDPv6 locally in golang", "body": "<p>In both cases (link-local and interface-local multicast) you have forgotten to specify the scope ID. Without this, it is impossible to determine which interface to use, and you get an <code>Invalid argument</code> error from the operating system.</p>\n\n<p><a href=\"https://golang.org/pkg/net/#UDPAddr\" rel=\"nofollow noreferrer\"><code>net.UDPAddr</code></a> uses the <code>Zone</code> field to store the scope ID. You need to ensure that you have provided one, either by setting <code>Zone</code> explicitly or by using the <a href=\"https://superuser.com/q/99746/144961\">percent-suffix notation</a>.</p>\n"}], "owner": {"reputation": 1041, "user_id": 2772588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b6fb04e8ecf4cae2da6d45b813f7829c?s=128&d=identicon&r=PG", "display_name": "ababo", "link": "https://stackoverflow.com/users/2772588/ababo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "accepted_answer_id": 42180512, "answer_count": 1, "score": 0, "last_activity_date": 1486842686, "creation_date": 1486815579, "question_id": 42175773, "link": "https://stackoverflow.com/questions/42175773/sending-udpv6-locally-in-golang", "title": "Sending UDPv6 locally in golang", "body": "<p>I need to send a UDPv6 datagram being able to track this message by a local receiver (or via <code>tcpdump</code>).</p>\n\n<pre><code>daddr, err = net.ResolveUDPAddr(\"udp6\", \"[address]:port\")\nif err != nil {\n    return err\n}\n\nconn, err := net.DialUDP(\"udp6\", nil, daddr)\nif err != nil {\n    return err\n}\ndefer conn.Close()\n\nconn.Write(...)\n</code></pre>\n\n<p>Unlike IPv4 this code doesn't work with IPv6. For example, when I try to send a datagram to a multicast address, e.g. to [FF01::DB8:0:0]:5000, I get <code>connect: invalid argument</code>. The same happens when I try to send it to [fe80::20c:29ff:fee1:d66]:5000 (my IPv6 address according to <code>ifconfig</code>).</p>\n"}, {"tags": ["bash", "go", "elementary"], "comments": [{"owner": {"reputation": 1419, "user_id": 2080764, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/79TpD.png?s=128&g=1", "display_name": "MatejMecka", "link": "https://stackoverflow.com/users/2080764/matejmecka"}, "edited": false, "score": 0, "creation_date": 1486808035, "post_id": 42174635, "comment_id": 71512979, "body": "can you tell us the desired behaviour?"}, {"owner": {"reputation": 11, "user_id": 7125705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e1ecbc174fba718fe19aebda555acd?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth Chawat", "link": "https://stackoverflow.com/users/7125705/yashwanth-chawat"}, "reply_to_user": {"reputation": 1419, "user_id": 2080764, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/79TpD.png?s=128&g=1", "display_name": "MatejMecka", "link": "https://stackoverflow.com/users/2080764/matejmecka"}, "edited": false, "score": 0, "creation_date": 1486808261, "post_id": 42174635, "comment_id": 71513034, "body": "I was trying to set GOPATH as per instructions from this site <a href=\"https://larry-price.com/blog/2013/12/15/setting-up-a-go-environment-in-ubuntu-12-dot-04\" rel=\"nofollow noreferrer\">larry-price.com/blog/2013/12/15/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 7125705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e1ecbc174fba718fe19aebda555acd?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth Chawat", "link": "https://stackoverflow.com/users/7125705/yashwanth-chawat"}, "reply_to_user": {"reputation": 1419, "user_id": 2080764, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/79TpD.png?s=128&g=1", "display_name": "MatejMecka", "link": "https://stackoverflow.com/users/2080764/matejmecka"}, "edited": false, "score": 0, "creation_date": 1486808306, "post_id": 42174635, "comment_id": 71513045, "body": "but after the input commands , I was expecting the gopath to be set to the desired location... but it wasnt and I am getting this output"}], "answers": [{"tags": [], "owner": {"reputation": 629, "user_id": 1572023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b3103a5ba913c4b6de8d131709a15f?s=128&d=identicon&r=PG", "display_name": "csm", "link": "https://stackoverflow.com/users/1572023/csm"}, "is_accepted": true, "score": 0, "last_activity_date": 1486809206, "creation_date": 1486809206, "answer_id": 42174849, "question_id": 42174635, "link": "https://stackoverflow.com/questions/42174635/unable-to-set-gopath-in-elementary-os-loki/42174849#42174849", "title": "Unable to set GOPATH in elementary os loki", "body": "<p>It sounds like <code>.bashrc</code> was not terminated by a newline before you ran those commands. Look at the end of the file in a text editor and make sure that <code>GOPATH=/home/chawat/Programming/GoWorkspace</code> starts on a line of its own.</p>\n"}], "owner": {"reputation": 11, "user_id": 7125705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e1ecbc174fba718fe19aebda555acd?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth Chawat", "link": "https://stackoverflow.com/users/7125705/yashwanth-chawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 42174849, "answer_count": 1, "score": -3, "last_activity_date": 1486809206, "creation_date": 1486807692, "last_edit_date": 1486807949, "question_id": 42174635, "link": "https://stackoverflow.com/questions/42174635/unable-to-set-gopath-in-elementary-os-loki", "title": "Unable to set GOPATH in elementary os loki", "body": "<p><strong>Input :</strong></p>\n\n<pre><code>echo \"GOPATH=/home/chawat/Programming/GoWorkspace\" &gt;&gt; ~/.bashrc\n\necho \"export GOPATH\" &gt;&gt; ~/.bashrc\n\necho \"PATH=\\$PATH:\\$GOPATH/bin\" &gt;&gt; ~/.bashrc\n\nsource ~/.bashrc\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>bash: /home/chawat/.bashrc: line 171: syntax error near unexpected token `newline'\n\nbash: /home/chawat/.bashrc: line 171: `esacGOPATH=/home/chawat/Programming/GoWorkspace'\n</code></pre>\n\n<p>plz help me whats wrong?</p>\n"}, {"tags": ["json", "rest", "go"], "answers": [{"comments": [{"owner": {"reputation": 1347, "user_id": 1559202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3dabf6305a8fd64f9c020d2257263fbb?s=128&d=identicon&r=PG", "display_name": "John Kenn", "link": "https://stackoverflow.com/users/1559202/john-kenn"}, "edited": false, "score": 0, "creation_date": 1486823880, "post_id": 42175372, "comment_id": 71517584, "body": "Didn&#39;t notice that my updates in my question didn&#39;t get saved earlier. I re-added more context now to make my question clearer."}, {"owner": {"reputation": 1347, "user_id": 1559202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3dabf6305a8fd64f9c020d2257263fbb?s=128&d=identicon&r=PG", "display_name": "John Kenn", "link": "https://stackoverflow.com/users/1559202/john-kenn"}, "edited": false, "score": 0, "creation_date": 1486823979, "post_id": 42175372, "comment_id": 71517610, "body": "Hmm, I think I get what you mean. I just don&#39;t know yet how to implement it in code. Can you kindly provide a simple example?"}], "tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1486830180, "last_edit_date": 1486830180, "creation_date": 1486812812, "answer_id": 42175372, "question_id": 42174308, "link": "https://stackoverflow.com/questions/42174308/whats-a-clean-solution-for-supporting-dynamic-struct-fields-in-go/42175372#42175372", "title": "What&#39;s a clean solution for supporting dynamic struct fields in Go?", "body": "<p>It's difficult to say without more context. I assume that the SportId is also part of the Sport struct. You are basically only returning the ID or the whole struct.</p>\n\n<p>I would propose to only add the</p>\n\n<pre><code>Sport Sport `json:\"-\"`\n</code></pre>\n\n<p>struct. Instead of directly serializing it to json you would have to create a map (basically a viewmodel) first with the fixed attributes set. There you can set your SportID or Sport struct and after that you can serialize the map to json.</p>\n\n<p>This is also not a very nice solution but the advantage is that in your current solution, the ugliness of your response code leaks into the data model and therefore into the rest of your application. With the intermediate map the ugly part is confined into the response generation.</p>\n\n<pre><code>// models/league.go\ntype League struct {\n  Sport Sport\n}\n\n... parse includes ...\n\nviewModel := map[string]interface{}\n\nif includeSport {\n  viewModel[\"sport\"] = league.Sport\n} else {\n  viewModel[\"sport\"] = league.Sport.ID\n}\n\nc.JSON(http.StatusOK, viewModel)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": false, "score": 0, "last_activity_date": 1486926840, "last_edit_date": 1486926840, "creation_date": 1486925190, "answer_id": 42191708, "question_id": 42174308, "link": "https://stackoverflow.com/questions/42174308/whats-a-clean-solution-for-supporting-dynamic-struct-fields-in-go/42191708#42191708", "title": "What&#39;s a clean solution for supporting dynamic struct fields in Go?", "body": "<pre><code>// models/league.go\ntype League struct {\n    SportID int64 `json:\"-\"`\n    Sport Sport `json:\"-\"`\n    SportWrapper interface{} `json:\"sport\"`\n}\n\n\nvar (\n    sportID int\n    sport Sport\n)\n// controllers/league.go\ninclude := c.Request.URL.Query().Get(\"include\")\nif err := json.Unmarshal([]byte(unclude), &amp;sportID); err != nil {\n    json.Unmarshal([]byte(unclude), &amp;sport)\n    league.SportWrapper = sport\n    league.Sport = sport\n} else {\n    league.SportWrapper = sportID\n    league.SportID = sportID\n}\n\nc.JSON(http.StatusOK, league)\n</code></pre>\n\n<p>if you could set your request param to json you can use this.</p>\n"}], "owner": {"reputation": 1347, "user_id": 1559202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3dabf6305a8fd64f9c020d2257263fbb?s=128&d=identicon&r=PG", "display_name": "John Kenn", "link": "https://stackoverflow.com/users/1559202/john-kenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1486926840, "creation_date": 1486805377, "last_edit_date": 1486823770, "question_id": 42174308, "link": "https://stackoverflow.com/questions/42174308/whats-a-clean-solution-for-supporting-dynamic-struct-fields-in-go", "title": "What&#39;s a clean solution for supporting dynamic struct fields in Go?", "body": "<p>Planning to refactor the codebase of an app we built last year. Let's say we have this api endpoint w/c supports including a related resource <code>GET /api/leagues?include=sport</code>. Is there a cleaner way to make the <code>sport</code> attribute of the <code>league</code> resource dynamic in the api response? The value of the sport attribute can be an int or Sport struct. Currently, this is what we're doing:</p>\n\n<pre><code>// models/league.go\ntype League struct {\n  SportId int64 `json:\"-\"`\n  Sport Sport `json:\"-\"`\n  SportWrapper interface{} `json:\"sport\"`\n}\n\n// controllers/league.go\ninclude := c.Request.URL.Query().Get(\"include\")\nincludes := strings.Split(include, \",\")\n\nfor _, include := range includes {\n  if include == \"sport\" {\n    includeSport = true\n  }\n}\n\nif includeSport {\n  league.SportWrapper = league.Sport\n} else {\n  league.SportWrapper = league.SportId\n}\n\nc.JSON(http.StatusOK, league)\n</code></pre>\n\n<p>response to the api request:</p>\n\n<pre><code>{\n  sport: {\n    id: &lt;id&gt;,\n    name: &lt;name&gt;\n  }\n}\n</code></pre>\n\n<p>it can also be:</p>\n\n<pre><code>{\n  sport: &lt;sport_id&gt;\n}\n</code></pre>\n"}, {"tags": ["testing", "memory", "go", "garbage-collection", "benchmarking"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7548972, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202939267278283/picture?type=large", "display_name": "John Ballesteros", "link": "https://stackoverflow.com/users/7548972/john-ballesteros"}, "edited": false, "score": 0, "creation_date": 1486944479, "post_id": 42176613, "comment_id": 71551622, "body": "any ideas on question 3?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1486887022, "last_edit_date": 1495541822, "creation_date": 1486820977, "answer_id": 42176613, "question_id": 42172360, "link": "https://stackoverflow.com/questions/42172360/go-benchmark-and-gc-b-op-alloc-op/42176613#42176613", "title": "go benchmark and gc: B/op alloc/op", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow noreferrer\">Appending to and copying slices</a></p>\n  \n  <p>The variadic function append appends zero or more values x to s of\n  type S, which must be a slice type, and returns the resulting slice,\n  also of type S.</p>\n\n<pre><code>append(s S, x ...T) S  // T is the element type of S\n</code></pre>\n  \n  <p>If the capacity of s is not large enough to fit the additional values,\n  append allocates a new, sufficiently large underlying array that fits\n  both the existing slice elements and the additional values. Otherwise,\n  append re-uses the underlying array.</p>\n</blockquote>\n\n<p>For your example, on average, [40, 41) bytes per operation are allocated to increase the capacity of the slice when necessary. The capacity is increased using an amortized constant time algorithm: up to len 1024 increase to 2 times cap then increase to 1.25 times cap. On average, there are [0, 1) allocations per operation.</p>\n\n<p>For example,</p>\n\n<pre><code>func BenchmarkMem(b *testing.B) {\n    b.ReportAllocs()\n    var x []int64\n    var a, ac int64\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        c := cap(x)\n        x = append(x, int64(i))\n        if cap(x) != c {\n            a++\n            ac += int64(cap(x))\n        }\n    }\n    b.StopTimer()\n    sizeInt64 := int64(8)\n    B := ac * sizeInt64 // bytes\n    b.Log(\"op\", b.N, \"B\", B, \"alloc\", a, \"lx\", len(x), \"cx\", cap(x))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>BenchmarkMem-4      50000000            26.6 ns/op        40 B/op          0 allocs/op\n--- BENCH: BenchmarkMem-4\n    bench_test.go:32: op 1 B 8 alloc 1 lx 1 cx 1\n    bench_test.go:32: op 100 B 2040 alloc 8 lx 100 cx 128\n    bench_test.go:32: op 10000 B 386296 alloc 20 lx 10000 cx 12288\n    bench_test.go:32: op 1000000 B 45188344 alloc 40 lx 1000000 cx 1136640\n    bench_test.go:32: op 50000000 B 2021098744 alloc 57 lx 50000000 cx 50539520\n</code></pre>\n\n<p>For <code>op = 50000000</code>,</p>\n\n<pre><code>B/op = floor(2021098744 / 50000000) = floor(40.421974888) = 40\n\nallocs/op = floor(57 / 50000000) = floor(0.00000114) = 0\n</code></pre>\n\n<p>Read:</p>\n\n<p><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a></p>\n\n<p><a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">Arrays, slices (and strings): The mechanics of 'append'</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/15702419/append-complexity\">'append' complexity</a></p>\n\n<p>To have zero B/op (and zero allocs/op) for append, allocate a slice with sufficient capacity before appending.</p>\n\n<p>For example, with <code>var x = make([]int64, 0, b.N)</code>, </p>\n\n<pre><code>func BenchmarkZero(b *testing.B) {\n    b.ReportAllocs()\n    var x = make([]int64, 0, b.N)\n    var a, ac int64\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        c := cap(x)\n        x = append(x, int64(i))\n        if cap(x) != c {\n            a++\n            ac += int64(cap(x))\n        }\n    }\n    b.StopTimer()\n    sizeInt64 := int64(8)\n    B := ac * sizeInt64 // bytes\n    b.Log(\"op\", b.N, \"B\", B, \"alloc\", a, \"lx\", len(x), \"cx\", cap(x))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>BenchmarkZero-4     100000000           11.7 ns/op         0 B/op          0 allocs/op\n--- BENCH: BenchmarkZero-4\n    bench_test.go:51: op 1 B 0 alloc 0 lx 1 cx 1\n    bench_test.go:51: op 100 B 0 alloc 0 lx 100 cx 100\n    bench_test.go:51: op 10000 B 0 alloc 0 lx 10000 cx 10000\n    bench_test.go:51: op 1000000 B 0 alloc 0 lx 1000000 cx 1000000\n    bench_test.go:51: op 100000000 B 0 alloc 0 lx 100000000 cx 100000000\n</code></pre>\n\n<p>Note the reduction in benchmark CPU time from around 26.6 ns/op to around 11.7 ns/op.</p>\n"}], "owner": {"reputation": 33, "user_id": 7548972, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202939267278283/picture?type=large", "display_name": "John Ballesteros", "link": "https://stackoverflow.com/users/7548972/john-ballesteros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 1, "accepted_answer_id": 42176613, "answer_count": 1, "score": 3, "last_activity_date": 1486887022, "creation_date": 1486788593, "question_id": 42172360, "link": "https://stackoverflow.com/questions/42172360/go-benchmark-and-gc-b-op-alloc-op", "title": "go benchmark and gc: B/op alloc/op", "body": "<p>benchmark code: </p>\n\n<pre><code>func BenchmarkSth(b *testing.B) {\n    var x []int\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        x = append(x, i)\n    }\n}\n</code></pre>\n\n<p>result: </p>\n\n<pre><code>BenchmarkSth-4    50000000    20.7 ns/op    40 B/op    0 allocs/op \n</code></pre>\n\n<p>question/s:</p>\n\n<ul>\n<li>where did 40 B/op come from? (any way of tracing + instructions is greatly appreciated)</li>\n<li>how is it possible to have 40 B/op while having 0 allocs?</li>\n<li>which one affects GC and how? (B/op or allocs/op)</li>\n<li>is it really possible to have 0 B/op using append?</li>\n</ul>\n"}, {"tags": ["go", "tensorflow"], "answers": [{"comments": [{"owner": {"reputation": 479, "user_id": 2763060, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yBb54.png?s=128&g=1", "display_name": "ranu", "link": "https://stackoverflow.com/users/2763060/ranu"}, "edited": false, "score": 0, "creation_date": 1575404177, "post_id": 42173093, "comment_id": 104553400, "body": "You could also just do a <code>sudo ldconfig</code> as the libraries are located under <code>&#47;usr&#47;local&#47;lib</code>."}], "tags": [], "owner": {"reputation": 19, "user_id": 2330178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7770fc436c9301ec4928ae47fba8e9ae?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/2330178/steve"}, "is_accepted": false, "score": 0, "last_activity_date": 1486795427, "last_edit_date": 1486795427, "creation_date": 1486794979, "answer_id": 42173093, "question_id": 42172072, "link": "https://stackoverflow.com/questions/42172072/error-building-go-bindings-for-tensorflow/42173093#42173093", "title": "Error Building Go Bindings for Tensorflow", "body": "<p>Found the solution.</p>\n\n<p>On both Linux and OSX to get it to build and test I needed to explicitly set the library paths.</p>\n\n<p>On an Ubuntu VM I spun up for testing build:</p>\n\n<pre><code>~/work$ export LD_LIBRARY_PATH=/usr/local/lib\n~/work$ export LIBRARY_PATH=/usr/local/lib\n~/work$ go get github.com/tensorflow/tensorflow/tensorflow/go\n~/work# go test github.com/tensorflow/tensorflow/tensorflow/go\nok github.com/tensorflow/tensorflow/tensorflow/go   0.210s\n~/work$  \n</code></pre>\n\n<p>On my local OSX machine:</p>\n\n<pre><code>pendragon:go sjc$ export LIBRARY_PATH=$LIBRARY_PATH:/usr/local/lib\npendragon:go sjc$ export DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:/usr/local/lib\npendragon:go sjc$ go get github.com/tensorflow/tensorflow/tensorflow/go\npendragon:go sjc$ go test github.com/tensorflow/tensorflow/tensorflow/go\nok      github.com/tensorflow/tensorflow/tensorflow/go  0.237s\n</code></pre>\n\n<p>So it seems the instructions about setting those path environment variables seem to apply even if you have installed <code>libtensorflow</code> into <code>/usr/local/lib</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 2330178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7770fc436c9301ec4928ae47fba8e9ae?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/2330178/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486795427, "creation_date": 1486785648, "question_id": 42172072, "link": "https://stackoverflow.com/questions/42172072/error-building-go-bindings-for-tensorflow", "title": "Error Building Go Bindings for Tensorflow", "body": "<p>I am trying to get the Go bindings for Tensorflow going. I've followed the QuickStart instructions from the repo. </p>\n\n<p><a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/go\" rel=\"nofollow noreferrer\">https://github.com/tensorflow/tensorflow/tree/master/tensorflow/go</a></p>\n\n<p>However the build command:</p>\n\n<p><code>go get github.com/tensorflow/tensorflow/tensorflow/go</code></p>\n\n<p>fails with the following error:</p>\n\n<pre><code>pendragon:src sjc$ go get github.com/tensorflow/tensorflow/tensorflow/go\n# github.com/tensorflow/tensorflow/tensorflow/go\nld: library not found for -ltensorflow\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\npendragon:src sjc$ \n</code></pre>\n\n<p>The lib has been downloaded and installed in /usr/local/lib</p>\n\n<pre><code>$ ls -l libtens*\n-r-xr-xr-x  1 root  wheel  107227008  1 Jan  1970 libtensorflow.so\n</code></pre>\n\n<p>It appears to all be setup as per instructions. Not sure how else to indicate to the Go build where to find the library. Anyone else got the Go wrapper to build?</p>\n"}, {"tags": ["go", "tcp", "goroutine"], "comments": [{"owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "edited": false, "score": 0, "creation_date": 1486797977, "post_id": 42171951, "comment_id": 71510965, "body": "are you closing the waitgroup correctly (I&#39;m asking because the sample code doesn&#39;t say anything about it) Also the sample code doesn&#39;t document if you are closing the subroutines correctly."}], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 2031060, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/74b9198b642d443dcfa94112a3777a90?s=128&d=identicon&r=PG", "display_name": "darthvading", "link": "https://stackoverflow.com/users/2031060/darthvading"}, "edited": false, "score": 0, "creation_date": 1486811644, "post_id": 42173446, "comment_id": 71513902, "body": "Channels were my first choice, but problem I had wanted me to create the instance of &quot;remote server&quot; dynamically, which I couldn&#39;t figure out how to do with channels. In case of wait group, I easily used the wg.Add(1) in the loop every time I get a request of a new server."}], "tags": [], "owner": {"reputation": 23, "user_id": 7076565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/385b866e968c40b99bc285384be0ce19?s=128&d=identicon&r=PG&f=1", "display_name": "B.Zamalutdinov", "link": "https://stackoverflow.com/users/7076565/b-zamalutdinov"}, "is_accepted": false, "score": 0, "last_activity_date": 1486798041, "creation_date": 1486798041, "answer_id": 42173446, "question_id": 42171951, "link": "https://stackoverflow.com/questions/42171951/conn-read-goes-to-infinite-loop-on-closing-conn-via-other-go-routine/42173446#42173446", "title": "conn.Read goes to infinite loop on closing conn via other go routine", "body": "<p>I think you should use semaphores(channels,select inside method), so, when you call stop, it will send a message(boolean or int), and when method get message from this channel, it will close connection and stop the go rutine.</p>\n\n<p>Short example</p>\n\n<pre><code>select{\ncase &lt;- stopChannel:\n//Do stuff to close connection\ncase default:\n//Do stuff to read from connection\n }\n</code></pre>\n\n<p>More example you can find there\n<a href=\"https://stackoverflow.com/questions/6807590/how-to-stop-a-goroutine\">Stackoverflow</a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1486922749, "creation_date": 1486922749, "answer_id": 42191229, "question_id": 42171951, "link": "https://stackoverflow.com/questions/42171951/conn-read-goes-to-infinite-loop-on-closing-conn-via-other-go-routine/42191229#42191229", "title": "conn.Read goes to infinite loop on closing conn via other go routine", "body": "<p><code>Read</code> on a closed connection returns an error.</p>\n\n<p>The application should break out of the read loop on any error returned from <code>Read</code> on the TCP connection.  Break on error handles all of these cases: application closes connection in another goroutine, peer shuts down the connection, network error.</p>\n\n<p>No other synchronization is required to coordinate between a closer of a TCP connection and a reader on that connection. </p>\n"}], "owner": {"reputation": 809, "user_id": 2031060, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/74b9198b642d443dcfa94112a3777a90?s=128&d=identicon&r=PG", "display_name": "darthvading", "link": "https://stackoverflow.com/users/2031060/darthvading"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1486922749, "creation_date": 1486784494, "question_id": 42171951, "link": "https://stackoverflow.com/questions/42171951/conn-read-goes-to-infinite-loop-on-closing-conn-via-other-go-routine", "title": "conn.Read goes to infinite loop on closing conn via other go routine", "body": "<p>My code is little complex, but in simple terms it is having multiple go routines, all dial-ing different tcp server and reading the input in a for loop when a readable message is present over the stream. So far so good. Now there is another go routine which manages the previous bunch of 'clients' and closes them when user wants to. For that I have associated each 'conn' with appropriate go routine client and closing that. </p>\n\n<p>The problem what I am facing is as soon as I call the close function of any conn object, its' corresponding Read function goes in an infinite loop reading just the empty strings continuously.</p>\n\n<p>I wrote a simple code which is similar to the way I am handling the connections in multiple go routines- <a href=\"https://play.golang.org/p/wq7zt9Kqz7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wq7zt9Kqz7</a></p>\n\n<p><strong>TL;DR</strong></p>\n\n<p>In short I have a 'class' which represents one remote server with its address, conn, waitgroup with in it and I am creating its multiple instances and handling for their inputs in separate go routines. And in another go routine I am trying to close one of those instance and this read() goes in a loop indefinitely.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "edited": false, "score": 0, "creation_date": 1486785129, "post_id": 42171765, "comment_id": 71508587, "body": "Can you give some example of those different JSON request?"}], "answers": [{"tags": [], "owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "is_accepted": true, "score": 1, "last_activity_date": 1486791855, "last_edit_date": 1486791855, "creation_date": 1486786514, "answer_id": 42172168, "question_id": 42171765, "link": "https://stackoverflow.com/questions/42171765/parse-http-json-request-based-on-a-field-in-json/42172168#42172168", "title": "Parse http json request based on a field in json", "body": "<p>There are 2 ways to solve this issue:</p>\n\n<h2>Solution 1: Core Library Way</h2>\n\n<p>By only using the core library, you may do this:</p>\n\n\n\n<pre><code>import (\n    \"bytes\"\n    \"ioutil\"\n    \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n\n    // read body content first to reuse\n    type protoData struct {\n        Version string `json:\"version\"`\n    }\n    proto := protoData{}\n    content, err := ioutil.ReadAll(req.Body)\n    json.NewDecoder(bytes.NewBuffer(content)).Decode(&amp;proto)\n\n    // version switch\n    if proto.Version == \"v1\" {\n            var data v1Object\n            json.NewDecoder(bytes.NewBuffer(content)).Decode(&amp;data)\n            // ... do something with data\n    } else {\n            var data v2Object\n            json.NewDecoder(bytes.NewBuffer(content)).Decode(&amp;data)\n            // ... do something with data\n    }\n\n}\n</code></pre>\n\n<h2>Solution 2: lzjson Way</h2>\n\n<p>I've written a silly library, <a href=\"https://github.com/go-restit/lzjson\" rel=\"nofollow noreferrer\">lzjson</a>, to make the code cleaner.</p>\n\n\n\n<pre><code>import (\n    \"net/http\"\n\n    \"github/go-restit/lzjson\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    jsonBody := lzjson.Decode(r.Body)\n    version := jsonBody.Get(\"version\").String()\n    if version == \"v1\" {\n        var data v1Object\n        jsonBody.Unmarshal(&amp;data)\n        // ... do something with data\n    } else {\n        var data v2Object\n        jsonBody.Unmarshal(&amp;data)\n        // ... do something with data\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "edited": false, "score": 0, "creation_date": 1486976078, "post_id": 42192097, "comment_id": 71561469, "body": "The type <code>req.Body</code> is a <code>io.Reader</code> implementation, which is only designed to be read once. So this implementation will fail at the <code>json.NewDecoder(req.Body).Decode(&amp;data)</code> statement because you have already <code>Unmarshal</code> it earlier."}, {"owner": {"reputation": 43, "user_id": 1265388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908783c6b4fd6b0d18a5ed1d7d0ec78d?s=128&d=identicon&r=PG", "display_name": "Yashesh", "link": "https://stackoverflow.com/users/1265388/yashesh"}, "reply_to_user": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "edited": false, "score": 0, "creation_date": 1487010899, "post_id": 42192097, "comment_id": 71583389, "body": "@KoalaYeung that is exactly what I had observed before I posted the Q here. thanks for your help!"}, {"owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "edited": false, "score": 0, "creation_date": 1487135860, "post_id": 42192097, "comment_id": 71641170, "body": "io.ReadFull(r Reader, buf []byte) (n int, err error)   with this func you should convert reader to []byte"}], "tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": false, "score": 0, "last_activity_date": 1486927336, "creation_date": 1486927336, "answer_id": 42192097, "question_id": 42171765, "link": "https://stackoverflow.com/questions/42171765/parse-http-json-request-based-on-a-field-in-json/42192097#42192097", "title": "Parse http json request based on a field in json", "body": "<pre><code>type BaseObj struct {\n        Version string\n}\n\ntype v1Object struct {\n        BaseObj\n        Name string\n}\n\ntype v2Object struct {\n        BaseObj\n        Name string\n        Address string\n}\n\nvar response map[string]string\n\n\njson.Unmarshal(req.Body, &amp;response)\n\nif response[\"version\"] == \"v1\" {\n        var data v1Object\n        json.NewDecoder(req.Body).Decode(&amp;data)\n} else {\n        var data v2Object\n        json.NewDecoder(req.Body).Decode(&amp;data)\n</code></pre>\n\n<p>total solution is not good but this is the way you could use data</p>\n"}], "owner": {"reputation": 43, "user_id": 1265388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908783c6b4fd6b0d18a5ed1d7d0ec78d?s=128&d=identicon&r=PG", "display_name": "Yashesh", "link": "https://stackoverflow.com/users/1265388/yashesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 1, "accepted_answer_id": 42172168, "answer_count": 2, "score": 0, "last_activity_date": 1486927336, "creation_date": 1486782800, "last_edit_date": 1486785900, "question_id": 42171765, "link": "https://stackoverflow.com/questions/42171765/parse-http-json-request-based-on-a-field-in-json", "title": "Parse http json request based on a field in json", "body": "<p>I want to decode an incoming JSON payload of a POST request using the <code>Decode()</code> function from <code>encoding/json</code></p>\n\n<p>However, I have a case where the body of the JSON can be different for the same http request. I want to differentiate this body based on a field embedded in the JSON. How can I extract this singular field in Go? For instance, I want the following logic-</p>\n\n<pre><code>type BaseObj struct {\n        Version string\n}\n\ntype v1Object struct {\n        BaseObj\n        Name string\n}\n\ntype v2Object struct {\n        BaseObj\n        Name string\n        Address string\n}\n\n// Somehow extract the 'version' from JSON (req.Body)\nif version == \"v1\" {\n        var data v1Object\n        json.NewDecoder(req.Body).Decode(&amp;data)\n} else {\n        var data v2Object\n        json.NewDecoder(req.Body).Decode(&amp;data)\n}\n</code></pre>\n\n<p>How can I get the 'version' field embedded in the body?</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["image", "go", "png"], "comments": [{"owner": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "edited": false, "score": 0, "creation_date": 1486786720, "post_id": 42171651, "comment_id": 71508875, "body": "I&#39;d expect the size of the raw data to be: 1270*720*4 == 3657600 bytes. The size of the provided binary dump is 3768320 (or 0x398000 as you mentioned). Are you sure the data provided is actually just the raw pixel values?"}, {"owner": {"reputation": 2474, "user_id": 1509611, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3HeS5.jpg?s=128&g=1", "display_name": "Alexander Forbes-Reed", "link": "https://stackoverflow.com/users/1509611/alexander-forbes-reed"}, "reply_to_user": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "edited": false, "score": 0, "creation_date": 1487348632, "post_id": 42171651, "comment_id": 71760291, "body": "That length of the dump is the <code>framebuffersize</code> given by the Xbox."}, {"owner": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "edited": false, "score": 0, "creation_date": 1487445042, "post_id": 42171651, "comment_id": 71792173, "body": "Could you provide more info on how you get the data dump? If it were raw RGBA pixel values your code should work."}, {"owner": {"reputation": 2474, "user_id": 1509611, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3HeS5.jpg?s=128&g=1", "display_name": "Alexander Forbes-Reed", "link": "https://stackoverflow.com/users/1509611/alexander-forbes-reed"}, "reply_to_user": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "edited": false, "score": 0, "creation_date": 1487544181, "post_id": 42171651, "comment_id": 71820011, "body": "I send the command <code>screenshot</code> over TCP to the console, it returns with the response <code>203- binary response follows</code>, then the body: <code>pitch=0x width=0x height=0x format=0x offsetx=0x offsety=0x, framebuffersize=0x sw=0x sh=0x colorspace=0x</code>. I used that information to read the rest of the response and deseizzle it into the correct pixel format."}], "answers": [{"comments": [{"owner": {"reputation": 2474, "user_id": 1509611, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3HeS5.jpg?s=128&g=1", "display_name": "Alexander Forbes-Reed", "link": "https://stackoverflow.com/users/1509611/alexander-forbes-reed"}, "edited": false, "score": 0, "creation_date": 1487348558, "post_id": 42288862, "comment_id": 71760241, "body": "I might be missing something, but that image you posted is exactly the same as the one I posted above, is it not?"}, {"owner": {"reputation": 7372, "user_id": 412689, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/73160611f90c8c1e1cdc79f43702bda1?s=128&d=identicon&r=PG", "display_name": "Alex Nichol", "link": "https://stackoverflow.com/users/412689/alex-nichol"}, "reply_to_user": {"reputation": 2474, "user_id": 1509611, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3HeS5.jpg?s=128&g=1", "display_name": "Alexander Forbes-Reed", "link": "https://stackoverflow.com/users/1509611/alexander-forbes-reed"}, "edited": false, "score": 0, "creation_date": 1487350363, "post_id": 42288862, "comment_id": 71761522, "body": "Oh, interesting. On macOS, the image he posted looks completely empty (like a fully transparent image)."}, {"owner": {"reputation": 2474, "user_id": 1509611, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3HeS5.jpg?s=128&g=1", "display_name": "Alexander Forbes-Reed", "link": "https://stackoverflow.com/users/1509611/alexander-forbes-reed"}, "edited": false, "score": 0, "creation_date": 1487350654, "post_id": 42288862, "comment_id": 71761718, "body": "Oh. I noticed something like that too. It renders fine in Chrome (any OS) and on Windows. But on macOS, Safari, and iPhone it&#39;s just transparent. Maybe macOS is more strict to the spec when it comes to rendering? Will update original post."}], "tags": [], "owner": {"reputation": 7372, "user_id": 412689, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/73160611f90c8c1e1cdc79f43702bda1?s=128&d=identicon&r=PG", "display_name": "Alex Nichol", "link": "https://stackoverflow.com/users/412689/alex-nichol"}, "is_accepted": false, "score": 1, "last_activity_date": 1487302085, "creation_date": 1487302085, "answer_id": 42288862, "question_id": 42171651, "link": "https://stackoverflow.com/questions/42171651/png-encode-producing-corrupt-image/42288862#42288862", "title": "PNG Encode producing corrupt image", "body": "<p>You are not flushing the buffered writer. You should do:</p>\n\n<pre><code>filewriter := bufio.NewWriter(file)\ndefer filewriter.Flush()\n</code></pre>\n\n<p>After this fix, I get a valid image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/anqxq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/anqxq.png\" alt=\"image produced by program\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7678677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wGDg61JoYys/AAAAAAAAAAI/AAAAAAAAAOY/PofHciNjMSg/photo.jpg?sz=128", "display_name": "Troy Drysdale", "link": "https://stackoverflow.com/users/7678677/troy-drysdale"}, "is_accepted": false, "score": 0, "last_activity_date": 1488981172, "creation_date": 1488981172, "answer_id": 42673169, "question_id": 42171651, "link": "https://stackoverflow.com/questions/42171651/png-encode-producing-corrupt-image/42673169#42673169", "title": "PNG Encode producing corrupt image", "body": "<p>Not a fix, and I want to comment but can't yet due to reputation, but will add to the Mac OS discrepancy. </p>\n\n<p>The MacOS part of the problem appears to be new, showing up since either the latest 10.12.3 update, or something with Safari. I haven't narrowed down the source yet. But yes, there is something new about how a Mac system will encode/decode an image, causing it to be transparent or grey as a result. A project I am on is also suffering from this problem for the past few weeks and I'm still investigating where it breaks down. </p>\n"}], "owner": {"reputation": 2474, "user_id": 1509611, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3HeS5.jpg?s=128&g=1", "display_name": "Alexander Forbes-Reed", "link": "https://stackoverflow.com/users/1509611/alexander-forbes-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488981172, "creation_date": 1486781623, "last_edit_date": 1487350742, "question_id": 42171651, "link": "https://stackoverflow.com/questions/42171651/png-encode-producing-corrupt-image", "title": "PNG Encode producing corrupt image", "body": "<p>I'm reading a framebuffer from a video game console with golang - the buffer is in the format BRGA (which I then convert to RGBA). When I pass the information into the Go PNG Encoder, the image that comes out is not valid. The code i'm using is - where:</p>\n\n<blockquote>\n  <p>where <code>data</code> is a slice of RGBA pixels - 0x398000 in length, <code>pitch</code> is 5120, <code>width</code> is 1270, and <code>height</code> is 720)</p>\n</blockquote>\n\n<pre><code>img := &amp;image.RGBA{\n    Pix:    data,\n    Stride: pitch,\n    Rect:   image.Rect(0, 0, width, height),\n}\n\nos.Remove(\"./img.png\")\nfile, _ := os.Create(\"./img.png\")\ndefer file.Close()\nfilewriter := bufio.NewWriter(file)\nif err := png.Encode(filewriter, img); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>The expected outcome would be: <a href=\"https://i.stack.imgur.com/z1H6H.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z1H6H.jpg\" alt=\"xbox\"></a></p>\n\n<p>But the actual outcome is (only renders on Windows or when view in Chrome.. weird): <a href=\"https://i.stack.imgur.com/8gb0L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8gb0L.png\" alt=\"sad xbox\"></a></p>\n\n<p>I have uploaded a binary dump of the RGBA slice if anybody would like it - <a href=\"https://1drv.ms/u/s!Ak-aZ3z7Ea8KwvUsqdP5OgWpZqxsGA\" rel=\"nofollow noreferrer\">https://1drv.ms/u/s!Ak-aZ3z7Ea8KwvUsqdP5OgWpZqxsGA</a></p>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 8, "creation_date": 1486765061, "post_id": 42169388, "comment_id": 71504002, "body": "you need to type <code>.&#47;go</code> if the directory isn&#39;t in your path."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1486786646, "post_id": 42171931, "comment_id": 71508863, "body": "Adding <code>.</code> to your <code>$PATH</code> is <i>not</i> recommended. If you insist on adding, it be sure to put it at the end."}], "tags": [], "owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "is_accepted": true, "score": 3, "last_activity_date": 1486785359, "last_edit_date": 1486785359, "creation_date": 1486784344, "answer_id": 42171931, "question_id": 42169388, "link": "https://stackoverflow.com/questions/42169388/why-cant-i-run-the-go-binary-from-within-the-bin-directory/42171931#42171931", "title": "Why can&#39;t I run the go binary from within the /bin directory?", "body": "<p>When you type a command without giving the full path, your system will try to find it within all the folders provided in <code>$PATH</code> variable.</p>\n\n<p>In typical Unix environment, your <code>$PATH</code> does not include \"your current folder\". So you need to either:</p>\n\n<ul>\n<li>call go by its full path (i.e. <code>$HOME/Downloads/go/bin/go</code>); or</li>\n<li>call go by its relative path (i.e. <code>./go</code>); or</li>\n<li>put <code>$HOME/Downloads/go/bin</code> in your <code>$PATH</code> variable; or</li>\n<li>put <code>.</code> (Unix way of saying \"your current folder\") in your <code>$PATH</code>; or</li>\n<li><p>put your go binary into folders that already in your <code>$PATH</code>. For example</p>\n\n<pre><code>sudo cp $HOME/Downloads/go/bin/* /usr/local/bin/.\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": false, "score": -1, "last_activity_date": 1486930202, "creation_date": 1486930202, "answer_id": 42192662, "question_id": 42169388, "link": "https://stackoverflow.com/questions/42169388/why-cant-i-run-the-go-binary-from-within-the-bin-directory/42192662#42192662", "title": "Why can&#39;t I run the go binary from within the /bin directory?", "body": "<pre><code>sudo chmod +x go\n</code></pre>\n\n<p>seems like it does not have execute permission, so just change permission and run it then you should alias your go binary path to your environment to access binary every where. </p>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 42171931, "answer_count": 2, "score": -1, "last_activity_date": 1486930202, "creation_date": 1486764147, "last_edit_date": 1486776680, "question_id": 42169388, "link": "https://stackoverflow.com/questions/42169388/why-cant-i-run-the-go-binary-from-within-the-bin-directory", "title": "Why can&#39;t I run the go binary from within the /bin directory?", "body": "<p>I downloaded go1.7.5.darwin-amd64.tar.gz for osx 10.12.2.</p>\n\n<p>Unpacked the tar and went to the /bin directory to see if the Go executable would run.  </p>\n\n<pre><code>$ cd Downloads/go/bin \n$ ls\n\ntotal 54560  \n-rwxr-xr-x@ 1 bryanwheelock  staff   9884220 Feb 10 16:53 go  \n-rwxr-xr-x@ 1 bryanwheelock  staff  15065500 Feb 10 16:53 godoc  \n-rwxr-xr-x@ 1 bryanwheelock  staff   2976976 Feb 10 16:53 gofmt  \n\nbryanwheelock@Bryans-MacBook Fri Feb 10 16:57:45 ~/Downloads/go/bin\n$ go version\n-bash: go: command not found\n</code></pre>\n"}, {"tags": ["ubuntu", "go", "docker", "docker-swarm", "docker-swarm-mode"], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 720939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9e8c16e8c1679d0928b00bfb42953a?s=128&d=identicon&r=PG", "display_name": "ingshtrom", "link": "https://stackoverflow.com/users/720939/ingshtrom"}, "is_accepted": true, "score": 0, "last_activity_date": 1487001874, "creation_date": 1487001874, "answer_id": 42208410, "question_id": 42168853, "link": "https://stackoverflow.com/questions/42168853/docker-service-update-error-eof/42208410#42208410", "title": "Docker Service Update Error: EOF", "body": "<p>Turned out to be a fluke somewhere. We rebuilt the swarm by stopping the docker daemon, removing /var/lib/docker, and starting the daemon back up. After that the error no longer occurred.</p>\n"}], "owner": {"reputation": 56, "user_id": 720939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9e8c16e8c1679d0928b00bfb42953a?s=128&d=identicon&r=PG", "display_name": "ingshtrom", "link": "https://stackoverflow.com/users/720939/ingshtrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 1, "accepted_answer_id": 42208410, "answer_count": 1, "score": 1, "last_activity_date": 1487001874, "creation_date": 1486761732, "question_id": 42168853, "link": "https://stackoverflow.com/questions/42168853/docker-service-update-error-eof", "title": "Docker Service Update Error: EOF", "body": "<p>We have a GO application that listens for code repo changes and Redis messages in order to apply CD in a Docker Swarm environment. That application was recently updated to use the <code>github.com/docker/docker</code> v1.13.1 client code. It worked on my mac, which runs Docker v1.13.1. When I deploy this code to a development server running Ubuntu and Docker v1.12.6, I get an \"EOF\" error when trying to call <code>cli.ServiceUpdate(..)</code>. As far as I know, the CLI client is backwards compatible (until v1.10.x or something). When looking at the code and the screenshot, the connection between the two is the log message of \"An error occurred while updating a service\".</p>\n\n<p>Event thought we are using the v1.13.1 version of the golang libraries, we specify the api version v1.24 in our client initialization:</p>\n\n<pre><code>func createClient() {\n    if cli == nil {\n        defaultHeaders := map[string]string{\"User-Agent\": \"engine-api-cli-1.0\"}\n        var err error\n        cli, err = client.NewClient(\"unix:///var/run/docker.sock\", \"v1.24\", nil, defaultHeaders)\n        if err != nil {\n            panic(err)\n        }\n    }\n}\n</code></pre>\n\n<p>Here is the offending code:</p>\n\n<pre><code>func updateService(s configuration.Service, version string) {\n    createClient()\n\n    ctx := context.Background()\n\n    service, _, err := cli.ServiceInspectWithRaw(ctx, configuration.ServiceName(s))\n    if err != nil {\n        fmt.Println(\"could not find service\", err)\n        return\n    }\n\n    serviceSpec := createServiceSpec(s, version)\n\n    encodedRegistryAuth := createEncodedRegistryAuth()\n    var resp types.ServiceUpdateResponse\n    resp, err = cli.ServiceUpdate(ctx, service.ID, service.Version, serviceSpec, types.ServiceUpdateOptions{EncodedRegistryAuth: encodedRegistryAuth})\n    if err != nil {\n        fmt.Println(\"An error occurred while updating a service: \", s.Service, \"; \", err)\n    } else {\n        message := \"SERVICE UPDATE - \" + s.Service + \"_\" + s.Channel + \" &gt;&gt; \" + envName + \":\" + s.Service + \":\" + version\n        connections.SlackMessage(message)\n        connections.NewRelicDeploy(version, message)\n        connections.GrafanaDeploy(version, message)\n        fmt.Println(\"Updated service\", s.Service, \"and waiting\", s.UpdateDelay)\n        fmt.Println(\"Warnings from service update\", resp.Warnings)\n    }\n}\n</code></pre>\n\n<p>Here is a screen grab of what happened in syslog:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7P0g8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7P0g8.png\" alt=\"Docker Syslog\"></a></p>\n\n<p>Here is the output from <code>docker info</code>:</p>\n\n<pre><code>Client:\n Version:      1.12.6\n API version:  1.24\n Go version:   go1.6.4\n Git commit:   78d1802\n Built:        Tue Jan 10 20:40:44 2017\n OS/Arch:      linux/amd64\n Experimental: true\n\nServer:\n Version:      1.12.6\n API version:  1.24\n Go version:   go1.6.4\n Git commit:   78d1802\n Built:        Tue Jan 10 20:40:44 2017\n OS/Arch:      linux/amd64\n Experimental: true\n</code></pre>\n\n<p>Any ideas on what I could be doing wrong? </p>\n"}, {"tags": ["go", "go-echo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1486744841, "post_id": 42164203, "comment_id": 71493609, "body": "What is it exactly you expect to see? <code>echo.Context</code> has a lot of methods you can call to get whatever information you want."}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 1, "creation_date": 1486760032, "post_id": 42164203, "comment_id": 71501894, "body": "Here is a link to echo&#39;s <a href=\"https://github.com/labstack/echo/blob/master/context.go\" rel=\"nofollow noreferrer\">context.go</a> for your convenience. Also, if I had to guess, the most interesting methods might be Request() and Response() which retrieve the HTTP Request and Response objects respecively."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1486762416, "post_id": 42164203, "comment_id": 71503004, "body": "Or a link to the nicer formatted godoc: <a href=\"https://godoc.org/github.com/labstack/echo#Context\" rel=\"nofollow noreferrer\"><code>echo.Context</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "is_accepted": false, "score": 0, "last_activity_date": 1535999228, "creation_date": 1535999228, "answer_id": 52154714, "question_id": 42164203, "link": "https://stackoverflow.com/questions/42164203/golang-print-echo-context-values/52154714#52154714", "title": "golang print echo.Context values", "body": "<ul>\n<li><p><a href=\"https://echo.labstack.com/guide/context\" rel=\"nofollow noreferrer\">https://echo.labstack.com/guide/context</a> is an excellent source for looking into echo.</p></li>\n<li><p>offline there is <code>godoc</code> functionality, which helps with understanding any package(which is downloaded in your machine). In your case this can be done, <code>godoc github.com/labstack/echo Context</code> on your command line. </p></li>\n<li><p>There are GOTO functionalities many editors that lets you see the library source, while you are coding, <a href=\"https://github.com/fatih/vim-go\" rel=\"nofollow noreferrer\">https://github.com/fatih/vim-go</a>, <a href=\"https://github.com/DisposaBoy/GoSublime\" rel=\"nofollow noreferrer\">https://github.com/DisposaBoy/GoSublime</a> are such examples. What they allow you to do is to navigate these functions and structs to the point where they are defined. Hopefully, someone will have written, a crisp documentary comment there.</p></li>\n<li><p>if all you want is to watch the execution of your code, you can use debugging tools, like delve <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow noreferrer\">https://github.com/derekparker/delve</a>.</p></li>\n</ul>\n"}], "owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3106, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535999228, "creation_date": 1486744210, "last_edit_date": 1521027165, "question_id": 42164203, "link": "https://stackoverflow.com/questions/42164203/golang-print-echo-context-values", "title": "golang print echo.Context values", "body": "<p>I'm brand new to Go and trying to inspect a method argument. I've got the following code</p>\n\n<pre><code>func (c *controller) OrderNew(ctx echo.Context) error {\n</code></pre>\n\n<p>When I try either:</p>\n\n<pre><code>    fmt.println(ctx)\n    fmt.Printf(\"%v \\n\", ctx)\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>&amp;{0xc4200f21e0 0xc4202302d0 /order [] [] map[] 0x4092860 map[site_key:2] 0xc4200bb6c0}\n</code></pre>\n\n<p>I realize *controller is a pointer and the values returned contain addresses, but not sure how to really debug or inspect further. I also see functions called on cxt like </p>\n\n<pre><code>ctx.Get and ctx.Render\n</code></pre>\n\n<p>which I realize are functions in echo.Context</p>\n\n<p>Any help/clarification is appreciated. Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 1, "creation_date": 1486743039, "post_id": 42163748, "comment_id": 71492541, "body": "It could be a syntax error in your files."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1486743059, "post_id": 42163748, "comment_id": 71492555, "body": "What is the package name in the <code>search.pb.go</code> file?"}, {"owner": {"reputation": 2531, "user_id": 721616, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/5990dc71908d05dc416b75d9fac6bb6a?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/721616/david"}, "edited": false, "score": 0, "creation_date": 1486743221, "post_id": 42163748, "comment_id": 71492631, "body": "the package name is &#39;search&#39;"}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1486750060, "post_id": 42163748, "comment_id": 71496742, "body": "@David If you go to <code>$GOPATH&#47;src&#47;github.com&#47;wilbyang&#47;gotham-grpc&#47;search</code> and do <code>go build</code> what do you get?"}], "answers": [{"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 0, "last_activity_date": 1486797226, "creation_date": 1486797226, "answer_id": 42173356, "question_id": 42163748, "link": "https://stackoverflow.com/questions/42163748/strange-compiling-error-saying-no-buildable-go-source-files/42173356#42173356", "title": "strange compiling error saying &#39;no buildable Go source files&#39;", "body": "<p><code>go run client.go</code> works when there is a <code>main</code> function inside <code>client.go</code>.</p>\n"}], "owner": {"reputation": 2531, "user_id": 721616, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/5990dc71908d05dc416b75d9fac6bb6a?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/721616/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1486797226, "creation_date": 1486742858, "last_edit_date": 1486743000, "question_id": 42163748, "link": "https://stackoverflow.com/questions/42163748/strange-compiling-error-saying-no-buildable-go-source-files", "title": "strange compiling error saying &#39;no buildable Go source files&#39;", "body": "<p>Bascially, in client.go I import a package like this</p>\n\n<pre><code>pb \"github.com/wilbyang/gotham-grpc/search\"\n</code></pre>\n\n<p>when I try to run go run client.go, I get the error:</p>\n\n<blockquote>\n  <p>no buildable Go source files in /Users/wilbyang/goPath/src/github.com/wilbyang/gotham-grpc/search\".</p>\n</blockquote>\n\n<p>My gopath is:</p>\n\n<blockquote>\n  <p>\"/Users/wilbyang/goPath/\".</p>\n</blockquote>\n\n<p>And I am sure dir <code>$GOPATH/src/github.com/wilbyang/gotham-grpc/search</code> exists and under that dir <code>search.pb.go</code> exists, generated by protoc and package being search. I really do not understand why and struggled with it for hours! Anyone would lead me out of this?</p>\n"}, {"tags": ["mysql", "amazon-web-services", "ssl", "go"], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 7546742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb799d55e1612a9ce76df09773b1b603?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Neitz", "link": "https://stackoverflow.com/users/7546742/jonathan-neitz"}, "edited": false, "score": 0, "creation_date": 1486848351, "post_id": 42163998, "comment_id": 71525615, "body": "This appeared to work however when I run a query against my mysql database. I get the following errors.                                                          [mysql] 2017/02/11 14:23:14 packets.go:33: unexpected EOF [mysql] 2017/02/11 14:23:15 packets.go:33: unexpected EOF [mysql] 2017/02/11 14:23:15 statement.go:27: invalid connection                       So it looks like the connection doesn&#39;t actually work.                                       Any other ideas on how to get this to work?"}], "tags": [], "owner": {"reputation": 137816, "user_id": 13070, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/pio3A.jpg?s=128&g=1", "display_name": "Mark B", "link": "https://stackoverflow.com/users/13070/mark-b"}, "is_accepted": false, "score": 3, "last_activity_date": 1486743566, "creation_date": 1486743566, "answer_id": 42163998, "question_id": 42163732, "link": "https://stackoverflow.com/questions/42163732/how-to-use-the-go-mysql-driver-with-ssl-on-aws-with-a-mysql-rds-instance/42163998#42163998", "title": "How to use the go-mysql-driver with ssl on aws with a mysql rds instance", "body": "<p>From looking at the docs <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://godoc.org/github.com/go-sql-driver/mysql#RegisterTLSConfig\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://godoc.org/crypto/tls#Config\" rel=\"nofollow noreferrer\">here</a>, it looks like you simply need to set the <code>RootCAs</code> value to the root certificate you obtained from AWS. You don't need to set the <code>Certificates</code> value since you aren't using a client cert. So the code would look something like:</p>\n\n<pre><code>rootCertPool := x509.NewCertPool()\npem, err := ioutil.ReadFile(\"/path/ca-cert.pem\")\nif err != nil {\n   log.Fatal(err)\n}\nif ok := rootCertPool.AppendCertsFromPEM(pem); !ok {\n   log.Fatal(\"Failed to append PEM.\")\n}\nmysql.RegisterTLSConfig(\"custom\", &amp;tls.Config{\n                         RootCAs: rootCertPool,\n                        })\ndb, err := sql.Open(\"mysql\", \"user@tcp(localhost:3306)/test?tls=custom\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 2395602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da7d3d9dcd9443fa4629862ef7d2f8d1?s=128&d=identicon&r=PG", "display_name": "fishybell", "link": "https://stackoverflow.com/users/2395602/fishybell"}, "is_accepted": false, "score": 6, "last_activity_date": 1547500651, "creation_date": 1547500651, "answer_id": 54189333, "question_id": 42163732, "link": "https://stackoverflow.com/questions/42163732/how-to-use-the-go-mysql-driver-with-ssl-on-aws-with-a-mysql-rds-instance/54189333#54189333", "title": "How to use the go-mysql-driver with ssl on aws with a mysql rds instance", "body": "<p>I'd add a comment to the previous answer, but my reputation isn't high enough. This is working for me:</p>\n\n<pre><code>    rootCertPool := x509.NewCertPool()\n    pem, err := ioutil.ReadFile(\"/path/ca-cert.pem\")\n    if err != nil {\n       log.Fatal(err)\n    }\n    if ok := rootCertPool.AppendCertsFromPEM(pem); !ok {\n       log.Fatal(\"Failed to append PEM.\")\n    }\n    mysql.RegisterTLSConfig(\"custom\", &amp;tls.Config{\n                             ServerName: \"qcaurora.cb556lynvxio.us-east-1.rds.amazonaws.com\",\n                             RootCAs: rootCertPool,\n                            })\n    db, err := sql.Open(\"mysql\", \"user:pass@tcp(qcrds.example.com:3306)/databasename?tls=custom\")\n</code></pre>\n\n<p>The only change from the above is the addition of the ServerName field. I've also clarified the address field for use with a CNAME dns entry and using a password. If you don't use a CNAME to RDS, you could leave out the ServerName field.</p>\n\n<p>I'm using go 1.11 with go-sql-driver/mysql version v1.4.1.</p>\n"}], "owner": {"reputation": 169, "user_id": 7546742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb799d55e1612a9ce76df09773b1b603?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Neitz", "link": "https://stackoverflow.com/users/7546742/jonathan-neitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2863, "favorite_count": 3, "answer_count": 2, "score": 10, "last_activity_date": 1547500651, "creation_date": 1486742819, "question_id": 42163732, "link": "https://stackoverflow.com/questions/42163732/how-to-use-the-go-mysql-driver-with-ssl-on-aws-with-a-mysql-rds-instance", "title": "How to use the go-mysql-driver with ssl on aws with a mysql rds instance", "body": "<p>I have a RDS instance running on AWS and I want to know how to connect to that instance over ssl.</p>\n\n<p>From this link <a href=\"http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_MySQL.html#MySQL.Concepts.SSLSupport\" rel=\"noreferrer\">Using SSL with mysql database</a>. AWS sets up our database registered with a certificate and provides the root certificate for download.\n<a href=\"http://%20https://s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem\" rel=\"noreferrer\">AWS rds root ca</a></p>\n\n<p>Now the go-mysql-driver provides this information in there documentation to setup an ssl connection.</p>\n\n<pre><code>rootCertPool := x509.NewCertPool()\npem, err := ioutil.ReadFile(\"/path/ca-cert.pem\")\nif err != nil {\n   log.Fatal(err)\n}\nif ok := rootCertPool.AppendCertsFromPEM(pem); !ok {\n   log.Fatal(\"Failed to append PEM.\")\n}\nclientCert := make([]tls.Certificate, 0, 1)\ncerts, err := tls.LoadX509KeyPair(\"/path/client-cert.pem\", \"/path/client-    key.pem\")\nif err != nil {\n   log.Fatal(err)\n}\nclientCert = append(clientCert, certs)\nmysql.RegisterTLSConfig(\"custom\", &amp;tls.Config{\n                         RootCAs: rootCertPool,\n                         Certificates: clientCert,\n                        })\ndb, err := sql.Open(\"mysql\", \"user@tcp(localhost:3306)/test?tls=custom\")\n</code></pre>\n\n<p>The example indicates that I need a client certificate and client key. </p>\n\n<p>But amazon only provides the root certificate. How can I use that with go-mysql-driver to connect to my mysql instance?</p>\n"}, {"tags": ["go", "grpc"], "comments": [{"owner": {"reputation": 161, "user_id": 3818395, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81736896cefe216a62806083cc220bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket", "link": "https://stackoverflow.com/users/3818395/sanket"}, "edited": false, "score": 1, "creation_date": 1486746444, "post_id": 42163585, "comment_id": 71494607, "body": "Got an answer to the error message. I was reading it wrong.  The part that says &quot;unknown service my_agent.MyServiceAPI&quot; means that the server does not have an implementation of a service with that name, and status code 12 means &quot;unimplemented&quot;. This probably means that either your server is misconfigured or that you are not using the right proto file in your grpc_cli invocation. Thanks to Micheal Lumish at grpc.io group!     However that being said, I have the correct proto file and I do have service implemented with the name I have in my proto file. I will have to dig deep to fix this."}], "owner": {"reputation": 161, "user_id": 3818395, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81736896cefe216a62806083cc220bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket", "link": "https://stackoverflow.com/users/3818395/sanket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 692, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1486742338, "creation_date": 1486742338, "question_id": 42163585, "link": "https://stackoverflow.com/questions/42163585/how-to-read-grpc-command-line-tool-error-messages-from-the-responses", "title": "How to read grpc command line tool error messages from the responses?", "body": "<p>I am using the grpc command line tool to test response for my grpc request. This is the official link to the grpc command line tool: <a href=\"https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md\" rel=\"nofollow noreferrer\">https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md</a> (The usage guide is not updated. Kindly read <code>~/workspace/src/github.com/grpc/bins/opt/grpc_cli help</code>)</p>\n\n<p>I am running the command from the location where my protocol file resides. I am sending a request like this, (FYI: I am also sending the metadata. Irrespective of inclusion of the metadata or not I am getting the same error message) : </p>\n\n<pre><code>$ ~/my_workspace/src/github.com/grpc/bins/opt/grpc_cli call 0.0.0.0:50051 \\  \nMyGrpcMethod &lt;name_of_my_proto_file.proto&gt; \"abc : '12-34-56-78', xyz: '1234'\" \\ \n--metadata \"auth:&lt;auth_token&gt;:space:xxx:org:xxx\" --enable_ssl=false \n</code></pre>\n\n<p>In the response I am getting it says that there are some errors however, it does not show what the errors are. Here is the response I got from my client request:</p>\n\n<pre><code>connecting to 0.0.0.0:50051\nFailed to read response.\nRpc failed with status code 12 error message unknown service my_agent.MyServiceAPI \n</code></pre>\n\n<p>Right now, I am not able to figure out from the documentation or otherwise on how to read the response. Did anyone face an issue like this? </p>\n"}, {"tags": ["go", "concurrency"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1486742210, "post_id": 42163356, "comment_id": 71492040, "body": "Note that you&#39;re missing the final <code>4 + 4</code> because you&#39;re not waiting for the last goroutine to complete. <a href=\"https://play.golang.org/p/lPQWfvAV5S\" rel=\"nofollow noreferrer\">play.golang.org/p/lPQWfvAV5S</a>"}, {"owner": {"reputation": 2004, "user_id": 1269414, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/820c57298f90d4b67d6de34dd649a6c6?s=128&d=identicon&r=PG", "display_name": "wojciech_rak", "link": "https://stackoverflow.com/users/1269414/wojciech-rak"}, "edited": false, "score": 0, "creation_date": 1486760774, "post_id": 42163356, "comment_id": 71502289, "body": "I was aware that passing <code>i</code> and <code>j</code> as function arguments would help here. I was missing the basics of the <code>for</code> loop, ie. that variable is FIRST incremented, and THEN condition is checked. That explains 5s"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1486741603, "creation_date": 1486741603, "answer_id": 42163356, "question_id": 42162879, "link": "https://stackoverflow.com/questions/42162879/mutex-within-loop-leads-to-unexpected-output/42163356#42163356", "title": "Mutex within loop leads to unexpected output", "body": "<p>You're closing over variables in a loop and then running the closure in a separate thread, while those variables continue to change. When you do this, expect the unexpected - for example, you see 5s because <code>j</code> is incremented to 5 on the last iteration, which causes the loop to end, but <code>j</code> still holds 5, which the separate thread can then read. It has nothing to do with your mutex; it's the cross-thread sharing of variables. If you use:</p>\n\n<pre><code>go func(i,j int) {\n    fmt.Printf(\"%d + %d = %d\\n\", i, j, j+i)\n    mutex.Unlock()\n}(i,j)\n</code></pre>\n\n<p>Then it will pass in the values of <code>i</code> and <code>j</code> at the time your goroutine is started, and subsequent iterations won't affect it: <a href=\"https://play.golang.org/p/P3kUP5e1Fp\" rel=\"nofollow noreferrer\">https://play.golang.org/p/P3kUP5e1Fp</a></p>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "is_accepted": false, "score": 1, "last_activity_date": 1486741950, "creation_date": 1486741950, "answer_id": 42163476, "question_id": 42162879, "link": "https://stackoverflow.com/questions/42162879/mutex-within-loop-leads-to-unexpected-output/42163476#42163476", "title": "Mutex within loop leads to unexpected output", "body": "<p>When you execute this : </p>\n\n<pre><code>go func() {\n                fmt.Printf(\"%d + %d = %d\\n\", i, j, j+i)\n                mutex.Unlock()\n            }()\n</code></pre>\n\n<p>The current goroutine makes another loop which increments j.</p>\n\n<p>Incrementation takes place before printf that is why even thought the function was called while<br>\n<code>j</code> was <code>&lt; 5</code> it could be increased to 5 before the function had time to print out values.<br>\nIn other words you program runs like this :</p>\n\n<ul>\n<li>Enter loop</li>\n<li>Lock Mutex</li>\n<li>Call func()</li>\n<li>Increment j</li>\n<li>Print values</li>\n<li>Unlock Mutex</li>\n</ul>\n\n<p>Solution to this would be to pass the values by value to the function instead of sharing them throughout goroutines.</p>\n"}], "owner": {"reputation": 2004, "user_id": 1269414, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/820c57298f90d4b67d6de34dd649a6c6?s=128&d=identicon&r=PG", "display_name": "wojciech_rak", "link": "https://stackoverflow.com/users/1269414/wojciech-rak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "accepted_answer_id": 42163356, "answer_count": 2, "score": 3, "last_activity_date": 1486741950, "creation_date": 1486740112, "question_id": 42162879, "link": "https://stackoverflow.com/questions/42162879/mutex-within-loop-leads-to-unexpected-output", "title": "Mutex within loop leads to unexpected output", "body": "<p>I have this simplistic piece of code (or here <a href=\"https://play.golang.org/p/KW8_OHUp9v\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KW8_OHUp9v</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    mutex := new(sync.Mutex)\n\n    for i := 1; i &lt; 5; i++ {\n        for j := 1; j &lt; 5; j++ {\n            mutex.Lock()\n            go func() {\n                fmt.Printf(\"%d + %d = %d\\n\", i, j, j+i)\n                mutex.Unlock()\n            }()\n        }\n    }\n}\n</code></pre>\n\n<p>It produces an output like this</p>\n\n<pre><code>1 + 2 = 3\n1 + 3 = 4\n1 + 4 = 5\n2 + 5 = 7\n2 + 2 = 4\n2 + 3 = 5\n2 + 4 = 6\n3 + 5 = 8\n3 + 2 = 5\n3 + 3 = 6\n3 + 4 = 7\n4 + 5 = 9\n4 + 2 = 6\n4 + 3 = 7\n4 + 4 = 8\n\nProgram exited.\n</code></pre>\n\n<p>Looking at the output I was surprised by few things:</p>\n\n<ol>\n<li>There are no '1's for the <code>j</code></li>\n<li>There are '5's for the <code>j</code></li>\n<li>There are only 3 values for i=1, instead of 4</li>\n</ol>\n\n<p>I can understand lack of '1's as the variable is incremented before it is written.</p>\n\n<p>Can someone explain 2. and 3. ?</p>\n"}]