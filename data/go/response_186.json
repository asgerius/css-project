[{"tags": ["go", "go-gorm", "revel"], "answers": [{"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 3, "last_activity_date": 1533181044, "last_edit_date": 1533181044, "creation_date": 1533165510, "answer_id": 51643498, "question_id": 51643293, "link": "https://stackoverflow.com/questions/51643293/how-to-query-a-gorm-model/51643498#51643498", "title": "How to query a GORM Model", "body": "<p>When populating a struct from the database, you need to pass a pointer for GORM to be able to populate it.  Otherwise it's pass-by-value and GORM populates a copy and you never see it.</p>\n\n<p>And if you want to get all accounts you should pass a pointer to a slice of accounts.  Regarding pointers versus values, a slice is different from a struct in that the underlying array can still be modified even in pass-by-value, but outside the function the slice length (and capacity) won't change even as the array is populated within the function, so it still won't behave as expected without a pointer.</p>\n\n<p>And you should check <code>Error</code> afterward:</p>\n\n<pre><code>accounts := make([]models.Account, 0)\nif err := c.DB.Find(&amp;accounts).Error; err != nil {\n     if gorm.IsRecordNotFoundError(err) {\n          // handle not found\n     } else {\n          // print/log/return error\n     }\n     return\n}\n\n// do something with accounts\n</code></pre>\n"}], "owner": {"reputation": 1162, "user_id": 1890328, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11d715ddc533970983f63e27f30edf53?s=128&d=identicon&r=PG", "display_name": "user1890328", "link": "https://stackoverflow.com/users/1890328/user1890328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5206, "favorite_count": 0, "accepted_answer_id": 51643498, "answer_count": 1, "score": 1, "last_activity_date": 1533181044, "creation_date": 1533163932, "last_edit_date": 1533164877, "question_id": 51643293, "link": "https://stackoverflow.com/questions/51643293/how-to-query-a-gorm-model", "title": "How to query a GORM Model", "body": "<p>I'm attempting to query a database given a model, and I'm getting a blank model as a response. I'm using Revel framework and GORM to create the model and query the database.</p>\n\n<p><strong>app.go</strong></p>\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/revel/revel\"\n    \"route/to/models\"\n)\n\ntype App struct {\n    *revel.Controller\n    GormController\n}\n\nfunc (c App) Index() revel.Result {\n    accounts := models.Account{}\n    account := c.DB.Find(accounts)\n\n    return c.RenderJSON(account)\n}\n</code></pre>\n\n<p><strong>gorm.go</strong></p>\n\n<pre><code>package controllers\n\nimport (\n    _ \"github.com/jinzhu/gorm/dialects/postgres\"\n    \"github.com/jinzhu/gorm\"\n    r \"github.com/revel/revel\"\n)\ntype GormController struct {\n    *r.Controller\n    DB *gorm.DB\n}\n\n// it can be used for jobs\nvar Gdb *gorm.DB\n\n// init db\nfunc InitDB() {\n    var err error\n    // open db\n    Gdb, err = gorm.Open(\"postgres\", \"host=hostname port=5432 user=postgres password=password dbname=some_db_name sslmode=disable\")\n    Gdb.LogMode(true) // Print SQL statements\n    if err != nil {\n        r.ERROR.Println(\"FATAL\", err)\n        panic(err)\n    }\n}\n\nfunc (c *GormController) SetDB() r.Result {\n    c.DB = Gdb\n    return nil\n}\n</code></pre>\n\n<p>Not sure where I'm going wrong, ultimately I want to do a select * from accounts;</p>\n\n<p><strong>Note:</strong> I can run a migration and create in the Index() function and the data is handled correctly.</p>\n"}, {"tags": ["go", "slack", "slack-api"], "answers": [{"comments": [{"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1533165391, "post_id": 51643456, "comment_id": 90251234, "body": "that seems interesting. Can you show me how that might look with the example slack.Command(&quot;shout &lt;word&gt;&quot;, func(conv hanu.ConversationInterface) { \t\tstr, _ := conv.String(&quot;word&quot;) \t\tconv.Reply(strings.ToUpper(str)) \t})"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 1, "last_activity_date": 1533220593, "last_edit_date": 1533220593, "creation_date": 1533165184, "answer_id": 51643456, "question_id": 51643159, "link": "https://stackoverflow.com/questions/51643159/slackbot-that-supports-parameters-wrapped-with-quotation-marks/51643456#51643456", "title": "Slackbot that supports parameters wrapped with quotation marks", "body": "<p>One approach would be to abuse <a href=\"https://golang.org/pkg/strings/#FieldsFunc\" rel=\"nofollow noreferrer\"><code>strings.FieldsFunc(...)</code></a> to split the string on whitespace only if it is not in a quoted section:</p>\n\n<pre><code>func main() {\n  s := `@bot &lt;command&gt; \"Something\" \"Another thing that contains spaces, it's great\" \"A final thing with spaces\"`\n\n  tokens := splitWithQuotes(s)\n  for i, t := range tokens {\n    fmt.Printf(\"OK: tokens[%d] = %s\\n\", i, t)\n  }\n  // OK: tokens[0] = @bot\n  // OK: tokens[1] = &lt;command&gt;\n  // OK: tokens[2] = \"Something\"\n  // OK: tokens[3] = \"Another thing that contains spaces, it's great\"\n  // OK: tokens[4] = \"A final thing with spaces\"\n}\n\nfunc splitWithQuotes(s string) []string {\n  inquote := false\n  return strings.FieldsFunc(s, func(c rune) bool {\n    switch {\n    case c == '\"':\n      inquote = !inquote\n      return false\n    case inquote:\n      return false\n    default:\n      return unicode.IsSpace(c)\n    }\n  })\n}\n</code></pre>\n\n<p>Strictly speaking, this approach might not work with all versions of golang since, per the documentation:</p>\n\n<blockquote>\n  <p>If f does not return consistent results for a given c, FieldsFunc may crash.</p>\n</blockquote>\n\n<p>...and this function definitely returns varying results for whitespace characters; however, it seems to work with go 1.9 and newer, so I guess it depends on your appetite for adventure!</p>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533220593, "creation_date": 1533163101, "question_id": 51643159, "link": "https://stackoverflow.com/questions/51643159/slackbot-that-supports-parameters-wrapped-with-quotation-marks", "title": "Slackbot that supports parameters wrapped with quotation marks", "body": "<p>I am trying to write a slackbot. I've tried a variety of frameworks from github, but the most promising I've used seems to be <a href=\"https://github.com/sbstjn/hanu\" rel=\"nofollow noreferrer\">hanu</a></p>\n\n<p>What I'd like to do is send a message to a bot like so:</p>\n\n<pre><code>@bot &lt;command&gt; \"Something\" \"Another thing that contains spaces\" \"A final thing with spaces\"\n</code></pre>\n\n<p>I'd like to then have each of those 3 parameters be passed as strings to a var, which then has a handle func which can be executed.</p>\n\n<p>I just don't seem to be able to do this! The hanu framework linked above seems to use <a href=\"https://github.com/sbstjn/allot\" rel=\"nofollow noreferrer\">this</a> framework which states:</p>\n\n<blockquote>\n  <p>The allot library supports placeholders and regular expressions for\n  parameter matching and parsing.</p>\n</blockquote>\n\n<p>But because I'm a terrible developer, I can't seem to figure out how to do this in the framework above because there's no examples.</p>\n\n<p>So I'd like to either be able to:</p>\n\n<ul>\n<li>figure out how to use the above library with those kind of parameters so I can start building something</li>\n<li>write a bot command that takes those kind of params myself using github.com/nlopes/slack and pass my own handler functions.</li>\n</ul>\n"}, {"tags": ["go", "emacs"], "answers": [{"tags": [], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "is_accepted": true, "score": 3, "last_activity_date": 1533160539, "creation_date": 1533160539, "answer_id": 51642796, "question_id": 51642744, "link": "https://stackoverflow.com/questions/51642744/godef-not-being-found-in-a-go-mode-emacs-session/51642796#51642796", "title": "Godef not being found in a go-mode emacs session", "body": "<p>It's this again:</p>\n\n<p><a href=\"https://askubuntu.com/questions/1045712/emacs-launched-from-favorites-doesnt-read-bashrc\">https://askubuntu.com/questions/1045712/emacs-launched-from-favorites-doesnt-read-bashrc</a></p>\n\n<p>If you launch emacs from the Ubuntu launcher, it doesn't load .bashrc.</p>\n\n<p>You have to open a terminal, and call </p>\n\n<pre><code>$ emacs\n</code></pre>\n\n<p>The emacs that pops up will have inherited your .bashrc from your shell.</p>\n"}, {"tags": [], "owner": {"reputation": 387, "user_id": 4318885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc8371a7fb83e8253a98879af309077?s=128&d=identicon&r=PG", "display_name": "\u5b59\u6b23\u4e50", "link": "https://stackoverflow.com/users/4318885/%e5%ad%99%e6%ac%a3%e4%b9%90"}, "is_accepted": false, "score": 0, "last_activity_date": 1576136152, "creation_date": 1576136152, "answer_id": 59299721, "question_id": 51642744, "link": "https://stackoverflow.com/questions/51642744/godef-not-being-found-in-a-go-mode-emacs-session/59299721#59299721", "title": "Godef not being found in a go-mode emacs session", "body": "<p><a href=\"https://i.stack.imgur.com/4cumc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4cumc.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>~/.emacs.d/init.el</p>\n\n<pre><code>(setq exec-path (append exec-path '(\"/root/go/bin\")))\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 3, "accepted_answer_id": 51642796, "answer_count": 2, "score": 2, "last_activity_date": 1576136152, "creation_date": 1533160232, "question_id": 51642744, "link": "https://stackoverflow.com/questions/51642744/godef-not-being-found-in-a-go-mode-emacs-session", "title": "Godef not being found in a go-mode emacs session", "body": "<p>I have godef installed via</p>\n\n<pre><code>go get github.com/rogpeppe/godef\n</code></pre>\n\n<p>I have emacs go-mode installed, and the following exports in my .bashrc:</p>\n\n<pre><code>export GOROOT=/usr/local/go\nexport GOPATH=$HOME/go\nexport PATH=$GOPATH/bin:$GOROOT/bin:$PATH\n</code></pre>\n\n<p>godef is found in the sense that </p>\n\n<pre><code>godef -h # appears to work.\n</code></pre>\n\n<p>As in:</p>\n\n<pre><code>$ godef -h\nusage: godef [flags] [expr]\n  -A    print all type and members information\n  -a    print public type and member information\n  -acme\n        use current acme window\n  -debug\n        debug mode\n  -f string\n        Go source filename\n  -i    read file from stdin\n  -json\n        output location in JSON format (-t flag is ignored)\n  -o int\n        file offset of identifier in stdin (default -1)\n  -t    print type information\n</code></pre>\n\n<p>When I run <code>C-c C-d</code> in a file in my emacs session, which should be calling a <code>godef-describe</code> function per</p>\n\n<p><a href=\"https://github.com/dominikh/go-mode.el\" rel=\"nofollow noreferrer\">https://github.com/dominikh/go-mode.el</a></p>\n\n<p>I expect:</p>\n\n<pre><code>Integration with godef\n\n    godef-describe (C-c C-d) to describe expressions\n    godef-jump (C-c C-j) and godef-jump-other-window (C-x 4 C-c C-j) to jump to declarations\n    This requires you to install godef via go get github.com/rogpeppe/godef.\n</code></pre>\n\n<p>Cool, all set. But when I try to use C-c C-d in a go file, I get:</p>\n\n<pre><code>Could not run godef binary\n</code></pre>\n\n<p>I can run it on the command line, and it appears properly defined.  What's happening?</p>\n\n<p>I find:</p>\n\n<pre><code>M-x godoc\n\n// then\ngodoc: OSReadDir // for example\n</code></pre>\n\n<p>Produces</p>\n\n<pre><code>godoc: /bin/bash: go: command not found\n</code></pre>\n\n<p>Which suggests to me that even though godef and godoc are found in an ordinary shell, there may be some path issue within emacs?  How can I check or fix?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1533159027, "post_id": 51642487, "comment_id": 90249508, "body": "comparing it to <code>nil</code> is precisely what you do. Can you show an example that doesn&#39;t work for you?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533159360, "post_id": 51642487, "comment_id": 90249611, "body": "@noqcks The error for nil pointer always comes when you are passing a nil value in place where it is required to have some value assigned. Post the code in which you are getting an error of nil pointer"}, {"owner": {"reputation": 743, "user_id": 4951118, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a159086740c239ee2bdfdfeb057a6992?s=128&d=identicon&r=PG", "display_name": "Adrian Smith", "link": "https://stackoverflow.com/users/4951118/adrian-smith"}, "edited": false, "score": 0, "creation_date": 1533159460, "post_id": 51642487, "comment_id": 90249642, "body": "Are you making sure Foo isn&#39;t nil?"}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1533160784, "last_edit_date": 1533160784, "creation_date": 1533159162, "answer_id": 51642546, "question_id": 51642487, "link": "https://stackoverflow.com/questions/51642487/verify-that-field-is-set-in-struct-golang/51642546#51642546", "title": "Verify that field is set in struct golang", "body": "<p>You should be able to compare to nil, here's a working example:</p>\n\n<pre><code>check := func(f Foo) {\n  if f.Bar == nil {\n    panic(\"oops!\")\n  }\n  fmt.Println(\"OK\")\n}\n\nfoo1 := Foo{Bar: &amp;FooBar{\"Alpha\"}}\ncheck(foo1) // OK\n\nfoo2 := Foo{}\ncheck(foo2) // panic: oops!\n</code></pre>\n\n<p>Note that if you were to modify the \"check\" function to accept a <code>*Foo</code> and it was called with a nil pointer then that function would itself panic with a \"nil pointer dereference runtime error\". This might be what is currently happening with your example.</p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 4974261, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ewCosYzy7EI/AAAAAAAAAAI/AAAAAAAAAfQ/rvklfLv5qCU/photo.jpg?sz=128", "display_name": "Eli Davis", "link": "https://stackoverflow.com/users/4974261/eli-davis"}, "is_accepted": false, "score": 0, "last_activity_date": 1533174850, "creation_date": 1533174850, "answer_id": 51644463, "question_id": 51642487, "link": "https://stackoverflow.com/questions/51642487/verify-that-field-is-set-in-struct-golang/51644463#51644463", "title": "Verify that field is set in struct golang", "body": "<p>You should not have any errors thrown when attempting to access a nil member of the Foo struct.  Here is a <a href=\"https://play.golang.org/p/axUBar3nzYQ\" rel=\"nofollow noreferrer\">playground example</a> where the program exits without error.</p>\n\n<p>However, if you want to guarantee Bar and Baz is always set, I'd recommend making a function for building your Foo struct and making the Bar and Biz members lowercase as to not be visible by external packages:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Foo struct {\n    bar *FooBar\n    baz *FooBaz\n\n}\n\ntype FooBar struct {\n    Name string\n}\n\ntype FooBaz struct {\n    Name string\n}\n\nfunc NewFoo(bar *FooBar, baz *FooBaz) *Foo {\n\n    r := &amp;Foo {bar, baz}\n\n    if bar == nil {\n        r.bar = &amp;FooBar{\"default bar\"}\n    }\n\n    if baz == nil {\n        r.baz = &amp;FooBaz{\"default baz\"}\n    }\n\n    return r\n}\n\nfunc main() {\n    f := NewFoo(nil, nil)\n\n    // prints: f.Bar: default bar\n    fmt.Printf(\"f.Bar: %v\", f.bar.Name)\n}\n</code></pre>\n"}], "owner": {"reputation": 463, "user_id": 2512907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pnQlH.jpg?s=128&g=1", "display_name": "noqcks", "link": "https://stackoverflow.com/users/2512907/noqcks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533174850, "creation_date": 1533158830, "last_edit_date": 1533159302, "question_id": 51642487, "link": "https://stackoverflow.com/questions/51642487/verify-that-field-is-set-in-struct-golang", "title": "Verify that field is set in struct golang", "body": "<p>I have the following struct: </p>\n\n<pre><code>type Foo struct {\n    Bar *FooBar\n    Baz *FooBaz\n}\n\ntype FooBar struct {\n    Name string\n}\n\ntype FooBaz struct {\n    Name string\n}\n</code></pre>\n\n<p>How can I access the <code>Baz</code> and <code>Bar</code> in the struct without getting a nil pointer reference when they're not set?</p>\n\n<p>I want something that goes like the below, but I keep getting nil pointer dereference errors.</p>\n\n<pre><code>if Foo.Bar == nil {\n  throw error\n}\n</code></pre>\n\n<p>I'm struggling with this!</p>\n"}, {"tags": ["go", "hyperledger-fabric", "blockchain"], "comments": [{"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 1, "creation_date": 1533162712, "post_id": 51642410, "comment_id": 90250576, "body": "<code>var logger = shim.logger(&quot;my logger&quot;)</code> needs to be <code>var logger = shim.Logger(&quot;my logger&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 9942350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3691b98533432ee7d8e05f3a98a194?s=128&d=identicon&r=PG&f=1", "display_name": "Blockchaindeveloper", "link": "https://stackoverflow.com/users/9942350/blockchaindeveloper"}, "edited": false, "score": 0, "creation_date": 1533239382, "post_id": 51650151, "comment_id": 90285746, "body": "Yes it worked I got result - ./Samplesupplychain.go:5:1: imported and not used: &quot;fmt&quot; ./Samplesupplychain.go:7:1: imported and not used: &quot;encoding/json&quot; ./Samplesupplychain.go:13:14: undefined: shim.Logger ./Samplesupplychain.go:85:36: undefined: username.. not sure if these are errors or just warnings"}, {"owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "reply_to_user": {"reputation": 97, "user_id": 9942350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3691b98533432ee7d8e05f3a98a194?s=128&d=identicon&r=PG&f=1", "display_name": "Blockchaindeveloper", "link": "https://stackoverflow.com/users/9942350/blockchaindeveloper"}, "edited": false, "score": 0, "creation_date": 1533278341, "post_id": 51650151, "comment_id": 90296210, "body": "These are errors, not warnings. In Go you must not import unused packages."}, {"owner": {"reputation": 97, "user_id": 9942350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3691b98533432ee7d8e05f3a98a194?s=128&d=identicon&r=PG&f=1", "display_name": "Blockchaindeveloper", "link": "https://stackoverflow.com/users/9942350/blockchaindeveloper"}, "edited": false, "score": 0, "creation_date": 1533475542, "post_id": 51650151, "comment_id": 90350744, "body": "Thanks, it actually worked but while compiling after these I got an error :  cannot use new(SampleChaincode) (type *SampleChaincode) as type shim.Chaincode in argument to shim.Start:         *SampleChaincode does not implement shim.Chaincode (missing Init method)"}], "tags": [], "owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "is_accepted": true, "score": 3, "last_activity_date": 1533202162, "creation_date": 1533202162, "answer_id": 51650151, "question_id": 51642410, "link": "https://stackoverflow.com/questions/51642410/chaincode-not-building-go-program-error-cannot-refer-to-unexported-name/51650151#51650151", "title": "Chaincode not building - Go program error - Cannot refer to unexported name", "body": "<p>In Go only you can only access names in other packages if they start with an upper-case letter. This is kind of like using <code>public</code> and <code>private</code> in Java or C++.</p>\n\n<p>Call your type <code>Logger</code> instead of <code>logger</code> and it will work.</p>\n"}], "owner": {"reputation": 97, "user_id": 9942350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3691b98533432ee7d8e05f3a98a194?s=128&d=identicon&r=PG&f=1", "display_name": "Blockchaindeveloper", "link": "https://stackoverflow.com/users/9942350/blockchaindeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1000, "favorite_count": 0, "accepted_answer_id": 51650151, "answer_count": 1, "score": 0, "last_activity_date": 1533202162, "creation_date": 1533158410, "last_edit_date": 1533179508, "question_id": 51642410, "link": "https://stackoverflow.com/questions/51642410/chaincode-not-building-go-program-error-cannot-refer-to-unexported-name", "title": "Chaincode not building - Go program error - Cannot refer to unexported name", "body": "<p>I am getting an error while building my go code on an Ubuntu machine. I have check GOPATH variables and everything seems fine. Below is stack trace of error I am getting:</p>\n\n<p>/go/src/Chaincodeexample$ go build\n   # _/home/ubuntu/go/src/Chaincodeexample</p>\n\n<pre><code>./Samplesupplychain.go:13:14: cannot refer to unexported name shim.logger\n./Samplesupplychain.go:91:5: syntax error: non-declaration statement outside function body\n</code></pre>\n\n<p>Below is my code :</p>\n\n<pre><code>import(\n\"errors\"\n\"fmt\"\n\n\"encoding/json\"\n\n\"github.com/hyperledger/fabric/core/chaincode/shim\"\n\n)\n\nvar logger = shim.logger(\"my logger\")\n//Create a struct for these 2 values\ntype testuser struct{\n    Username string `json:\"username\"`\n    Fileuploaded string `json:\"fileuploaded\"`\n}\n\n//A function to create a user on the ledger\n\nfunc CreateUser(stub shim.ChaincodeStubInterface, args []string) ([]byte, error){\n    if len(args) &lt; 2 {\n        logger.Error(\"Invalid number of args\")\n        return nil, errors.New(\"Expected atleast 1 argument for user creation\")\n    }\n\n    var Username = args[0]\n    var UsernameInput = args[1]\n    //trying to understand\n    err := stub.PutState(Username, []byte(UsernameInput))\n    if err != nil {\n        logger.Error(\"Could not save new User to ledger\", err)\n        return nil, err\n    }\n\n    var customEvent = \"{eventType: 'UserCreation', description:\" + Username + \"' Successfully created'}\"\n    err = stub.SetEvent(\"evtSender\", []byte(customEvent))\n    if err != nil {\n        return nil, err\n    }\n    logger.Info(\"Successfully saved a supply chain user\")\n    return nil, nil\n\n\n}\n\nfunc Checkuploadstatus(stub shim.ChaincodeStubInterface, args []string) ([]byte, error) {\n    logger.Debug(\"Entering supply-chain application\")\n\n    if len(args) &lt; 1 {\n        logger.Error(\"Invalid number of arguments\")\n        return nil, errors.New(\"Missing details\")\n    }\n\n\n\n    var Fileuploadedstatus = args[0] \n\n    bytes, err := stub.GetState(Fileuploadedstatus) \n    if err != nil {\n        logger.Error(\"Could not fetch Fileuploadedstatus with \"+ Fileuploadedstatus +\" from ledger\", err)\n        return nil, err\n    }\n    return bytes, nil\n}\n\nfunc (t *testuser) Init(stub shim.ChaincodeStubInterface, function string, args []string) ([]byte, error) {\n    return nil, nil\n\n\n}\n\nfunc (t *testuser) Query(stub shim.ChaincodeStubInterface, function string, args []string) ([]byte, error) {\n    if function == \"Checkuploadstatus\" {\n        return Checkuploadstatus(stub, args)\n    }\n    return nil, nil\n}\n\n\n\nfunc (t *testuser) Invoke(stub shim.ChaincodeStubInterface, function string, args []string) ([]byte, error) {\n    if function == \"CreateUser\" {\n        return CreateUser(stub, args)\n        } else {\n            return nil, errors.New(username + \" does not have access to create a User\")\n        }\n\n    }\n    return nil, nil\n}\n</code></pre>\n\n<p>Give me idea to resolve this.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1533158488, "post_id": 51642390, "comment_id": 90249313, "body": "What are you expecting to happen? You&#39;re not giving it any source, and what is <code>version</code>?"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1533159170, "post_id": 51642390, "comment_id": 90249548, "body": "I&#39;m expecting it to operate as a command line binary, so I can figure out why it isn&#39;t working.  I am trying to debug, when in emacs, and I run C-c C-d, which should show me the godef at point, I get &quot;Could not run godef binary&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1533159336, "post_id": 51642390, "comment_id": 90249608, "body": "<code>version</code> isn&#39;t a valid argument on its own, unless you&#39;re looking for the <code>version</code> declaration in a source file and provided the source too. See the example in the docs: <a href=\"https://godoc.org/github.com/rogpeppe/godef\" rel=\"nofollow noreferrer\">godoc.org/github.com/rogpeppe/godef</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1533159414, "post_id": 51642543, "comment_id": 90249625, "body": "I understand godef to describe at point: godef-describe (C-c C-d) to describe expressions  <a href=\"https://github.com/dominikh/go-mode.el\" rel=\"nofollow noreferrer\">github.com/dominikh/go-mode.el</a>"}, {"owner": {"reputation": 103, "user_id": 8379152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCUG0.jpg?s=128&g=1", "display_name": "clafoutis", "link": "https://stackoverflow.com/users/8379152/clafoutis"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1533230336, "post_id": 51642543, "comment_id": 90281688, "body": "Well I think that godef is made to find declarations and/or expressions in a go file. If I&#39;m not mistaken, this is helpful on big projects."}], "tags": [], "owner": {"reputation": 103, "user_id": 8379152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCUG0.jpg?s=128&g=1", "display_name": "clafoutis", "link": "https://stackoverflow.com/users/8379152/clafoutis"}, "is_accepted": true, "score": 2, "last_activity_date": 1533159155, "creation_date": 1533159155, "answer_id": 51642543, "question_id": 51642390, "link": "https://stackoverflow.com/questions/51642390/installing-and-using-godef/51642543#51642543", "title": "Installing and using godef", "body": "<p>I would suggest you to read the documentation found here: <a href=\"https://github.com/rogpeppe/godef/blob/master/doc.go\" rel=\"nofollow noreferrer\">https://github.com/rogpeppe/godef/blob/master/doc.go</a></p>\n\n<p>You can also try typing <code>godef -h</code>.</p>\n\n<p>If you want more information, please explain what you are actually trying to do.</p>\n\n<p><em>EDIT: Regarding your comment above, I think that this library can't help you to accomplish what you are trying to do.</em></p>\n"}, {"tags": [], "owner": {"reputation": 1015, "user_id": 740997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42906a3e6d031337e7bc7e7285057627?s=128&d=identicon&r=PG", "display_name": "adamc", "link": "https://stackoverflow.com/users/740997/adamc"}, "is_accepted": false, "score": 0, "last_activity_date": 1598418285, "creation_date": 1598418285, "answer_id": 63590809, "question_id": 51642390, "link": "https://stackoverflow.com/questions/51642390/installing-and-using-godef/63590809#63590809", "title": "Installing and using godef", "body": "<p>I ran into an issue trying to use <code>godef-describe (C-c C-d)</code> which would output the following error:</p>\n<pre><code>No description found for expression at point\n</code></pre>\n<p>If I tried using <code>godef</code> directly on a file, I would receive the following error:</p>\n<pre><code>% godef -f path/to/file.go &quot;SomeFunction()&quot;\n2020/08/26 14:57:46 internal error: nil Pkg importing &quot;io&quot; from &quot;github.com/some/package&quot;\n</code></pre>\n<p>I fixed this by reinstalling <code>godef</code> and using the <code>master</code> branch as described <a href=\"https://github.com/rogpeppe/godef/issues/118#issuecomment-595222101\" rel=\"nofollow noreferrer\">here</a>:</p>\n<pre><code>go get -v github.com/rogpeppe/godef@master\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2683, "favorite_count": 0, "accepted_answer_id": 51642543, "answer_count": 2, "score": 1, "last_activity_date": 1598418285, "creation_date": 1533158285, "question_id": 51642390, "link": "https://stackoverflow.com/questions/51642390/installing-and-using-godef", "title": "Installing and using godef", "body": "<p>I install godef:</p>\n\n<pre><code>$ go get -u github.com/rogpeppe/godef\n</code></pre>\n\n<p>Looks great:</p>\n\n<pre><code>$ which godef\n/home/username/go/bin/godef\n</code></pre>\n\n<p>Right where I expect it:</p>\n\n<pre><code>$ echo $GOPATH\n/home/username/go\n</code></pre>\n\n<p>But when called as a command line tool:</p>\n\n<pre><code>$ godef version\ngodef: cannot read : open : no such file or directory\n</code></pre>\n\n<p>What's happening?</p>\n"}, {"tags": ["multithreading", "go", "routines"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1533211964, "post_id": 51642096, "comment_id": 90269949, "body": "Java is a very different language than Go. &quot;Converting&quot; Java to Go is unlikely to yield good results. Rather, try to take your goals and requirements and reimplement them in Go using Go idioms."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10146782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158b8c2d05e18b6082b0f873ab311521?s=128&d=identicon&r=PG&f=1", "display_name": "Sucheta", "link": "https://stackoverflow.com/users/10146782/sucheta"}, "edited": false, "score": 0, "creation_date": 1533691505, "post_id": 51642222, "comment_id": 90435350, "body": "I have a qs.. <a href=\"https://play.golang.org\" rel=\"nofollow noreferrer\">play.golang.org</a> I am trying to execute this.. the value for test-I is always 10. I wanted it to be that of value of i, which I am passing to the test(). I wanted to know, why its just taking 10?"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 11, "user_id": 10146782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158b8c2d05e18b6082b0f873ab311521?s=128&d=identicon&r=PG&f=1", "display_name": "Sucheta", "link": "https://stackoverflow.com/users/10146782/sucheta"}, "edited": false, "score": 0, "creation_date": 1533696404, "post_id": 51642222, "comment_id": 90436257, "body": "@Sucheta sounds like a separate question to me"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 6, "last_activity_date": 1533159298, "last_edit_date": 1533159298, "creation_date": 1533157359, "answer_id": 51642222, "question_id": 51642096, "link": "https://stackoverflow.com/questions/51642096/how-to-convert-the-following-thread-statement-in-go/51642222#51642222", "title": "How to convert the following Thread statement in go", "body": "<p>Golang uses a concept called <a href=\"https://tour.golang.org/concurrency/1\" rel=\"noreferrer\">\"goroutines\"</a> (inspired by <a href=\"https://en.wikipedia.org/wiki/Coroutine\" rel=\"noreferrer\">\"coroutines\"</a>) instead of \"threads\" used by many other languages.</p>\n\n<p>Your specific example looks like a common use for the <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a> type:</p>\n\n<pre><code>wg := sync.WaitGroup{}\nfor i := 0; i &lt; 5; i++ {      \n    wg.Add(1) // Increment the number of routines to wait for.\n    go func(x int) { // Start an anonymous function as a goroutine.\n        defer wg.Done() // Mark this routine as complete when the function returns.\n        SomeFunction(x)\n    }(i) // Avoid capturing \"i\".\n}\nwg.Wait() // Wait for all routines to complete.\n</code></pre>\n\n<p>Note that <code>SomeFunction(...)</code> in the example can be work of any sort and will be executed concurrently with all other invocations; however, if it uses goroutines itself then it should be sure to use a similar mechanism as shown here to prevent from returning from the \"SomeFunction\" until it is actually done with its work.</p>\n"}], "owner": {"reputation": 11, "user_id": 10146782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158b8c2d05e18b6082b0f873ab311521?s=128&d=identicon&r=PG&f=1", "display_name": "Sucheta", "link": "https://stackoverflow.com/users/10146782/sucheta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 51642222, "answer_count": 1, "score": -1, "last_activity_date": 1533159298, "creation_date": 1533156795, "question_id": 51642096, "link": "https://stackoverflow.com/questions/51642096/how-to-convert-the-following-thread-statement-in-go", "title": "How to convert the following Thread statement in go", "body": "<p>I am trying to convert the following java statement of threads in go;</p>\n\n<pre><code>int num = 5;\n    Thread[] threads = new Thread[5];\n    for (int i = 0; i &lt; num; i++)\n    {\n        threads[i] = new Thread(new NewClass(i));\n        threads[i].start();\n    }\n    for (int i = 0; i &lt; numT; i++)\n        threads[i].join();\n</code></pre>\n\n<p>I wanted to know, how to convert this to go?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "documentation", "godoc"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1533155068, "last_edit_date": 1592644375, "creation_date": 1533155068, "answer_id": 51641739, "question_id": 51641640, "link": "https://stackoverflow.com/questions/51641640/godoc-add-newline-character/51641739#51641739", "title": "GoDoc add newline character", "body": "<p>Insert an empty comment line, and it will be a new paragraph, meaning it will start on a new line:</p>\n<pre><code>// GetFunctionName gets function name\n//\n// Parameters:\n//   - `i` : Function\n//\n// **NOTE** this func fails if `i` is a variable set to a func\n// (they're called &quot;anonymous functions&quot; in JavaScript)\nfunc GetFunctionName(i interface{}) string {\n    return runtime.FuncForPC(reflect.ValueOf(i).Pointer()).Name()\n}\n</code></pre>\n<p>Recommended blog post: <a href=\"https://blog.golang.org/godoc-documenting-go-code\" rel=\"noreferrer\">Godoc: documenting Go code</a></p>\n<p>Relevant section:</p>\n<blockquote>\n<p>There are a few formatting rules that Godoc uses when converting comments to HTML:</p>\n<ul>\n<li><strong>Subsequent lines of text are considered part of the same paragraph; you must leave a blank line to separate paragraphs.</strong></li>\n<li>Pre-formatted text must be indented relative to the surrounding comment text (see gob's doc.go for an example).</li>\n<li>URLs will be converted to HTML links; no special markup is necessary.</li>\n</ul>\n</blockquote>\n"}], "owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2015, "favorite_count": 1, "accepted_answer_id": 51641739, "answer_count": 1, "score": 4, "last_activity_date": 1555506685, "creation_date": 1533154623, "last_edit_date": 1555506685, "question_id": 51641640, "link": "https://stackoverflow.com/questions/51641640/godoc-add-newline-character", "title": "GoDoc add newline character", "body": "<p>I know that Golang supports documentation of functions via single-line comments starting with the name of the function (spelled \"func\"). However, there's a nauseating side effect: having multiple single line comments will not produce a GoDoc with newline characters separating each line of text </p>\n\n<p>Here's a pic to illustrate: </p>\n\n<p><a href=\"https://i.stack.imgur.com/ddY02.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ddY02.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the func, and its documentation: </p>\n\n<pre><code>//GetFunctionName gets function name\n// Parameters:\n// - `i` : Function\n// **NOTE** this func fails if `i` is a variable set to a func\n// (they're called \"anonymous functions\" in JavaScript)\nfunc GetFunctionName(i interface{}) string {\n    return runtime.FuncForPC(reflect.ValueOf(i).Pointer()).Name()\n}\n</code></pre>\n\n<p>How does one insert newlines in the generated documentation? (If this were Javadoc, I would be like <code>&lt;br&gt;</code> and all would be good)</p>\n"}, {"tags": ["go", "makefile", "serverless"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1533148924, "post_id": 51639940, "comment_id": 90244915, "body": "Probably your GOPATH is wrong."}, {"owner": {"reputation": 1, "user_id": 7020390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2774fede910b29756d6aa2ca17928cff?s=128&d=identicon&r=PG&f=1", "display_name": "nabski", "link": "https://stackoverflow.com/users/7020390/nabski"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1533150108, "post_id": 51639940, "comment_id": 90245502, "body": "@MichaelHampton I&#39;ve tried building before, nothing went wrong. My GOPATH is <code>home\\yasmine\\go</code>."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1533153196, "post_id": 51639940, "comment_id": 90247051, "body": "@nabski Maybe your GOPATH is indeed the problem. On Unix you should use forward slashes, as in <code>GOPATH=&#47;home&#47;yasmine&#47;go</code> (note in the output it says: <code>separator: &#47;</code>."}, {"owner": {"reputation": 1, "user_id": 7020390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2774fede910b29756d6aa2ca17928cff?s=128&d=identicon&r=PG&f=1", "display_name": "nabski", "link": "https://stackoverflow.com/users/7020390/nabski"}, "reply_to_user": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1533153841, "post_id": 51639940, "comment_id": 90247333, "body": "@Jens sorry I mistyped, it is in <code>&#47;home&#47;yasmine&#47;go</code>."}, {"owner": {"reputation": 231, "user_id": 3627279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HIlkU.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/3627279/joe"}, "edited": false, "score": 1, "creation_date": 1547762743, "post_id": 51639940, "comment_id": 95314409, "body": "@nabski: I&#39;ve got the same issue, any solution ?"}], "owner": {"reputation": 1, "user_id": 7020390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2774fede910b29756d6aa2ca17928cff?s=128&d=identicon&r=PG&f=1", "display_name": "nabski", "link": "https://stackoverflow.com/users/7020390/nabski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1587, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533152241, "creation_date": 1533147731, "last_edit_date": 1533152241, "question_id": 51639940, "link": "https://stackoverflow.com/questions/51639940/unexpected-directory-layout-after-running-make", "title": "Unexpected directory layout after running make", "body": "<p>I was following <a href=\"https://serverless.com/blog/framework-example-golang-lambda-support/\" rel=\"nofollow noreferrer\">serverless golang lambda support</a>, but when I got to step</p>\n\n<pre><code>$ cd myservice\n$ make\n</code></pre>\n\n<p>I got this error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>dep ensure\nenv GOOS=linux go build -ldflags=\"-s -w\" -o bin/hello hello/main.go\nunexpected directory layout:\n    import path: github.com/aws/aws-lambda-go/lambda\n    root: /home/yasmine/go/src\n    dir: /home/yasmine/go/src/myservice/vendor/github.com/aws/aws-lambda-go/lambda\n    expand root: /home/yasmine/go/src\n    expand dir: /home/yasmine/go/src/myservice/vendor/github.com/aws/aws-lambda-go/lambda\n    separator: /\nMakefile:2: recipe for target 'build' failed\nmake: *** [build] Error 1\n</code></pre>\n\n<p>How do I fix this? Thank you.</p>\n"}, {"tags": ["windows", "go", "assembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1533146502, "post_id": 51639548, "comment_id": 90243589, "body": "You seem to load <code>BX</code> though."}, {"owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1533146704, "post_id": 51639548, "comment_id": 90243703, "body": "My bad, it was a typo. The program still panics and yields the same behaviour. It looks like the TEB is unreadable."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1533146828, "post_id": 51639548, "comment_id": 90243771, "body": "Hmmm ... please double check what the code is that you are actually running."}, {"owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1533146895, "post_id": 51639548, "comment_id": 90243798, "body": "Look at the edited question. The program panics as soon as the data pointed by fs:[0x18] is accessed."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1533147219, "post_id": 51639548, "comment_id": 90243972, "body": "Now v2 of the question uses <code>AX</code> but the machine code uses <code>ebx</code>. Try <code>64 8B 00</code>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1533147336, "post_id": 51639548, "comment_id": 90244030, "body": "Is it <code>amd64</code>? Why your Go code uses <code>FP</code> (frame pointer) register when it&#39;s supposed to be using <code>FS</code>?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1533147524, "post_id": 51639548, "comment_id": 90244145, "body": "@kostix it&#39;s using <code>FP</code> to access argument and result. <code>FS</code> is in the machine code bytes (the prefix <code>64</code>)."}, {"owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1533152863, "post_id": 51639548, "comment_id": 90246913, "body": "@Jester I fixed the instruction with <code>64 8B 00</code>. The program now panics on this instruction. I wonder why fs:[18h] is inaccessible."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1533153094, "post_id": 51639548, "comment_id": 90247001, "body": "@NTAuthority Did the signal change?  Can you use a debugger to show us the content of all registers immediately before the crashing instruction or even better, provide us with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can try out ourselves?"}, {"owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "edited": false, "score": 0, "creation_date": 1533153239, "post_id": 51639548, "comment_id": 90247068, "body": "Absolutely, I&#39;ll add the example to the question. The signal is now <code>[signal 0xc0000005 code=0x0 addr=0x18 pc=0x47a244]</code>."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 3, "creation_date": 1533153516, "post_id": 51639548, "comment_id": 90247189, "body": "Note that according to <a href=\"https://en.wikipedia.org/wiki/Win32_Thread_Information_Block\" rel=\"nofollow noreferrer\">this article</a>, the Thread Environment Block is accessed through GS, not FS in 64 bit mode.  Have you tried using GS and changing the offsets as indicated in the article?"}, {"owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1533154288, "post_id": 51639548, "comment_id": 90247505, "body": "@fuz You&#39;re absolutely right. I was working under the assumption the process runs in WoW64. I&#39;ll try to apply the suggested changes."}, {"owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1533154655, "post_id": 51639548, "comment_id": 90247673, "body": "@fuz The problem was fixed. Indeed the gs segment selector is used in x64, with a different offset (0x30). The library now reads the correct values."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1533154742, "post_id": 51639548, "comment_id": 90247707, "body": "@NTAuthority Note that you can compile Go code as 32 bit code by defining the environment variable <code>GOARCH</code> to <code>386</code> while building.  If this is going to be a library, consider using appropriate build tags so it does the right thing for both architectures."}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533156549, "post_id": 51639548, "comment_id": 90248517, "body": "Does Go really use a stack-args calling convention in x86-64?  I don&#39;t get why a function arg would in memory relative to <code>RBP</code> at the start of a function.  (Or does FP expand to RSP if you build with optimization enabled?).   I don&#39;t really know Go, so maybe that&#39;s normal, but it still seem inefficient."}, {"owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "reply_to_user": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533157379, "post_id": 51639548, "comment_id": 90248890, "body": "@Peter I don&#39;t know either. There probably is a way to use another calling convention (one that passes arguments via registers) but I haven&#39;t had time to dig into it. I don&#39;t know if frame pointer omission is enabled by default and if <code>FP</code> is expanded to <code>SP</code>"}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533157548, "post_id": 51639548, "comment_id": 90248965, "body": "You could try disassembling your binary with a real disassembler (into non-Go asm), or single-stepping it with a debugger, if you&#39;re curious."}, {"owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "edited": false, "score": 0, "creation_date": 1533157656, "post_id": 51639548, "comment_id": 90248995, "body": "Yes. I&#39;ll try loading it up in Immunity and get back with my findings."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1533158582, "post_id": 51639548, "comment_id": 90249350, "body": "@PeterCordes Yes, they do.  For simplicity.  The even pass the return value on the stack."}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1533162819, "post_id": 51639548, "comment_id": 90250604, "body": "@fuz: Yuck, seems like a giant leap backwards in calling conventions.  Windows x64 is a pretty good tradeoff of simplicity vs. performance, if you don&#39;t want the complexity of x86-64 System V (especially for variadic functions), so IDK why they wouldn&#39;t use that.  Is Go very good at always inlining small functions or something, so this never matters much?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1533166646, "post_id": 51639548, "comment_id": 90251504, "body": "@PeterCordes They did this to make the compiler easier to write.  The ABI is not tied down and may be replaced by a more efficient one in the future."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1533217243, "post_id": 51642176, "comment_id": 90273673, "body": "I find it interesting that it&#39;s exactly what <a href=\"https://www.reddit.com/r/golang/comments/9349cd/the_go_lowlevel_calling_convention_on_x8664/e3cc46d\" rel=\"nofollow noreferrer\"><code>u&#47;aarzilli</code> warned about</a> in their Reddit comment to <a href=\"http://science.raphael.poss.name/go-calling-convention-x86-64.html\" rel=\"nofollow noreferrer\">this recently appeared document</a>."}], "tags": [], "owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "is_accepted": false, "score": 5, "last_activity_date": 1533157514, "last_edit_date": 1533157514, "creation_date": 1533157143, "answer_id": 51642176, "question_id": 51639548, "link": "https://stackoverflow.com/questions/51639548/go-program-panics-when-accessing-the-thread-environment-block/51642176#51642176", "title": "Go program panics when accessing the Thread Environment Block", "body": "<p>The problem was fixed. Apparently, Windows uses the <code>gs</code> register with an offset of 0x30 on x64 whereas <code>fs</code> and a 0x18 offset are used on x86/WoW64 mode. \nThe solution is to use either <code>fs</code> or <code>gs</code> with the respective offsets depending on the value of <code>GOARCH</code>.</p>\n"}], "owner": {"reputation": 301, "user_id": 2002911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54idX.jpg?s=128&g=1", "display_name": "NTAuthority", "link": "https://stackoverflow.com/users/2002911/ntauthority"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1533157514, "creation_date": 1533146264, "last_edit_date": 1533153987, "question_id": 51639548, "link": "https://stackoverflow.com/questions/51639548/go-program-panics-when-accessing-the-thread-environment-block", "title": "Go program panics when accessing the Thread Environment Block", "body": "<p>I'm developing on a Go library to access some internal Windows thread structures (Thread Environment Block) and this requires writing some assembly code. I've been trying to understand why this works on a Win32 C++ application but it doesn't on my Go library.</p>\n\n<p>This snippet of Go assembly code accesses <strong>fs:[0x18]</strong> to return a pointer to the thread's associated <strong>TEB</strong>:</p>\n\n<pre><code>    // func ReadFsDword(offset uint32) (dword uint32)\n    TEXT \u00b7ReadFsDword(SB),$0-8\n            MOVL offset+0(FP), AX\n            // mov eax, dword ptr fs:[eax]\n            BYTE $0x64; BYTE $0x8B; BYTE $0x00\n            MOVL AX, ret+8(FP)\n            RET\n</code></pre>\n\n<p>This is the equivalent MASM code, which compiles and runs just fine on MSVC:</p>\n\n<pre><code>void* readfsdword(unsigned offset_)\n{\n    unsigned dw;\n\n    __asm {\n        mov eax, offset_\n        mov eax, fs:[eax]\n        mov dw, eax\n    }\n\n    return (void*)dw;\n}\n</code></pre>\n\n<p>The Go program panics when accessing the returned pointer to the TEB. Here's the message I get:</p>\n\n<blockquote>\n  <p>panic: runtime error: invalid memory address or nil pointer\n  dereference [signal 0xc0000005 code=0x0 addr=0x0 pc=0x498d5b]</p>\n</blockquote>\n\n<p>The Go assembly code seems right to me, but I can't understand how and why the program panics. Any help is much appreciated!</p>\n\n<p>Here's an example to reproduce the issue:</p>\n\n<p><strong><em>intrinsics.s</em></strong></p>\n\n<pre><code>#include \"textflag.h\"\n#include \"funcdata.h\"\n\n// func ReadFsDword(offset uint32) (ret uint32)\nTEXT \u00b7ReadFsDword(SB),$0-8\n        MOVL offset+0(FP), AX\n        // mov eax, dword ptr fs:[eax]\n        BYTE $0x64; BYTE $0x8B; BYTE $0x00\n        MOVL AX, ret+8(FP)\n        RET\n</code></pre>\n\n<p><strong><em>intrinsics.go</em></strong></p>\n\n<pre><code>package nt\n\nfunc ReadFsDword(offset uint32) (ret uint32)\n</code></pre>\n\n<p><strong><em>test.go</em></strong></p>\n\n<pre><code>package main\n\nimport \"nt\"\n\nfunc main() {\n    GetProcAddress(\"LoadLibraryExW\")\n}\n\nfunc GetProcAddress(proc string) unsafe.Pointer {\n    teb := nt.NtGetTeb()\n    fmt.Printf(\"%p\", teb)\n\n    // todo: implement\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go", "server", "static-libraries", "gorilla"], "comments": [{"owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "edited": false, "score": 0, "creation_date": 1533135931, "post_id": 51636548, "comment_id": 90237646, "body": "What (status) does the server respond with for your assets?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1533139101, "post_id": 51636548, "comment_id": 90239672, "body": "<code>http.Handle(&quot;&#47;assets&#47;&quot;, http.StripPrefix(&quot;&#47;assets&#47;&quot;, fs))</code> and <code>http.ListenAndServe(&quot;:8080&quot;, muxWithMiddlewares)</code> are incompatible. The first one says &quot;have the <b>default</b> ServeMux handle assets&quot;, the second says &quot;start the server using the <b>non-default</b> muxWithMiddlewares handler&quot;. Use either the default mux, or the gorilla mux, but not both."}, {"owner": {"reputation": 1, "user_id": 9387899, "user_type": "registered", "profile_image": "https://graph.facebook.com/1618976841526453/picture?type=large", "display_name": "Nicolas Augusto Sassi", "link": "https://stackoverflow.com/users/9387899/nicolas-augusto-sassi"}, "edited": false, "score": 0, "creation_date": 1533141255, "post_id": 51636548, "comment_id": 90240904, "body": "It doesn&#39;t actually responde with any errors. It just does not serve them. The HTML is served just fine"}, {"owner": {"reputation": 1, "user_id": 9387899, "user_type": "registered", "profile_image": "https://graph.facebook.com/1618976841526453/picture?type=large", "display_name": "Nicolas Augusto Sassi", "link": "https://stackoverflow.com/users/9387899/nicolas-augusto-sassi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533141293, "post_id": 51636548, "comment_id": 90240925, "body": "Thanks for clarify that @mkopriva! I&#39;m trying to fix that"}, {"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533323776, "post_id": 51636548, "comment_id": 90320853, "body": "Try to remove the last slash for <code>StripPrefix</code> so that you have  <code>http.Handle(&quot;&#47;assets&#47;&quot;, http.StripPrefix(&quot;&#47;assets&quot;, fs))</code> (or whatever you have after fixing the thing @mkopriva mentioned). I think i&#39;ve had similar issues with <code>FileServer</code> not liking not having the leading slash"}, {"owner": {"reputation": 216, "user_id": 5039386, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y1c-Clsbdkw/AAAAAAAAAAI/AAAAAAAAAKA/WFHwWVc3h_I/photo.jpg?sz=128", "display_name": "Hau Ma", "link": "https://stackoverflow.com/users/5039386/hau-ma"}, "edited": false, "score": 0, "creation_date": 1534223420, "post_id": 51636548, "comment_id": 90621948, "body": "Please follow instructions in this post: <a href=\"https://medium.com/@hau12a1/golang-http-serve-static-files-correctly-5feb98ae9da1\" rel=\"nofollow noreferrer\">medium.com/@hau12a1/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8010060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdfab80374961037d67e63c530298b3?s=128&d=identicon&r=PG", "display_name": "Dabnis", "link": "https://stackoverflow.com/users/8010060/dabnis"}, "is_accepted": false, "score": 0, "last_activity_date": 1559153232, "creation_date": 1559153232, "answer_id": 56366290, "question_id": 51636548, "link": "https://stackoverflow.com/questions/51636548/serve-static-files-with-golang/56366290#56366290", "title": "Serve static files with golang", "body": "<p>Try This:</p>\n\n<pre><code>mux.Handle(\"/static/\", http.StripPrefix(\"/static\", fileServer))\n</code></pre>\n\n<p>Note that static, in your case assets only has a single forward slash within the stripPreFix function.</p>\n\n<p>Hope this helps. </p>\n"}], "owner": {"reputation": 1, "user_id": 9387899, "user_type": "registered", "profile_image": "https://graph.facebook.com/1618976841526453/picture?type=large", "display_name": "Nicolas Augusto Sassi", "link": "https://stackoverflow.com/users/9387899/nicolas-augusto-sassi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559153232, "creation_date": 1533135537, "question_id": 51636548, "link": "https://stackoverflow.com/questions/51636548/serve-static-files-with-golang", "title": "Serve static files with golang", "body": "<p>I'm trying to develop a simple web application but I'mhaving problem with serving my static files.</p>\n\n<p>The file structure is:</p>\n\n<ul>\n<li>main</li>\n</ul>\n\n<p>--main.go</p>\n\n<p>-serve</p>\n\n<p>--listenAndServe.go</p>\n\n<p>--templates</p>\n\n<p>---login.html</p>\n\n<p>---assets</p>\n\n<p>----css</p>\n\n<p>----fonts</p>\n\n<p>----js</p>\n\n<p>my code is this:</p>\n\n<pre><code>    import (\n        \"log\"\n        \"net/http\"\n        \"time\"\n\n        \"github.com/gorilla/mux\"\n    )\n\n    var (\n        router = mux.NewRouter()\n    )\n\n    func (c *Conn) ListenAndServe() {\n        fs := http.FileServer(http.Dir(\"./templates/assets\"))\n        http.Handle(\"/assets/\", http.StripPrefix(\"/assets/\", fs))\n        router.HandleFunc(\"/\", c.IndexPageHandler)\n        router.HandleFunc(\"/login.html\", c.LoginPageHandler)\n        log.Println(\"Listening...\")\n        http.Handle(\"/\", router)\n        muxWithMiddlewares := http.TimeoutHandler(router, time.Minute*30, \n        \"Timeout!\")\n         http.ListenAndServe(\":8080\", muxWithMiddlewares)\n      }\n</code></pre>\n\n<p>But for some reason when I run it from main.go it serves the html but not the assets. I would really apreciate some tips. Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 1, "creation_date": 1533133433, "post_id": 51635766, "comment_id": 90235842, "body": "Please post more code to regenerate the issue you are facing. And you can use <code>reflect.DeepEqual</code> to check if two structs are equal."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1533133645, "post_id": 51635766, "comment_id": 90236013, "body": "If you&#39;re using testify, the docs say: <code>Pointer variable equality is determined based on the equality of the referenced values (as opposed to the memory addresses).</code> So this comparison probably isn&#39;t doing what you think it is in the first place."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1533133719, "post_id": 51635766, "comment_id": 90236074, "body": "If <code>a</code> and <code>aa</code> are both value types (not pointers), then you&#39;re already creating a copy. If they&#39;re not, dereference in the assignment to create a copy: <code>aa := *a</code>."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1533133784, "post_id": 51635766, "comment_id": 90236117, "body": "The addresses are different, but assert compares the values pointed to."}, {"owner": {"reputation": 15998, "user_id": 770425, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f87997cd806a0495c0b677f5a7728319?s=128&d=identicon&r=PG", "display_name": "Jeff Widman", "link": "https://stackoverflow.com/users/770425/jeff-widman"}, "edited": false, "score": 0, "creation_date": 1582161067, "post_id": 51635766, "comment_id": 106685893, "body": "You may want the new <a href=\"https://godoc.org/github.com/stretchr/testify/assert#NotSame\" rel=\"nofollow noreferrer\"><code>assert.NotSame()</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 1748, "user_id": 4106031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NM3jO.jpg?s=128&g=1", "display_name": "Alok Kumar Singh", "link": "https://stackoverflow.com/users/4106031/alok-kumar-singh"}, "edited": false, "score": 1, "creation_date": 1599659675, "post_id": 51638160, "comment_id": 112842010, "body": "seeing is believing <a href=\"https://play.golang.org/p/dZD8xoW_kvS\" rel=\"nofollow noreferrer\">play.golang.org/p/dZD8xoW_kvS</a>"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 49, "last_activity_date": 1533142133, "last_edit_date": 1533142133, "creation_date": 1533140835, "answer_id": 51638160, "question_id": 51635766, "link": "https://stackoverflow.com/questions/51635766/how-do-i-copy-a-struct-in-golang/51638160#51638160", "title": "How do I copy a struct in Golang?", "body": "<p>In go, primitive types, and structs containing only primitive types, are copied by value, so you can copy them by simply assigning to a new variable (or returning from a function). For example:</p>\n\n<pre><code>type Person struct{\n  Name string\n  Age  int\n}\n\nalice1 := Person{\"Alice\", 30}\nalice2 := alice1\nfmt.Println(alice1 == alice2)   // =&gt; true, they have the same field values\nfmt.Println(&amp;alice1 == &amp;alice2) // =&gt; false, they have different addresses\n\nalice2.Age += 10\nfmt.Println(alice1 == alice2)   // =&gt; false, now they have different field values\n</code></pre>\n\n<p>Note that, as mentioned by commenters, the confusion in your example is likely due to the semantics of the test library you are using.</p>\n\n<p>If your struct happens to include arrays, slices, or pointers, then you'll need to perform a deep copy of the referenced objects unless you want to retain references between copies. Golang provides no builtin deep copy functionality so you'll have to implement your own or use one of the many freely available libraries that provide it.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 4764298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0737c1716f0cd32f4f474bf8af35a7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Sezal Agrawal", "link": "https://stackoverflow.com/users/4764298/sezal-agrawal"}, "is_accepted": false, "score": 3, "last_activity_date": 1577185039, "last_edit_date": 1577185039, "creation_date": 1576605501, "answer_id": 59379721, "question_id": 51635766, "link": "https://stackoverflow.com/questions/51635766/how-do-i-copy-a-struct-in-golang/59379721#59379721", "title": "How do I copy a struct in Golang?", "body": "<p>DeepCopy is a very heavy operation and hence should be avoided if possible. For complex structures such as the following, we can optimise the code.</p>\n\n<pre><code>type Address struct {\n    city  string\n    state string\n}\n\ntype Person struct {\n    age     int\n    name    string\n    address []Address\n}\n\np := Person{\n    age:  20,\n    name: \"Jack\",\n    address: []Address{\n        {\n            city:  \"city1\",\n            state: \"state1\",\n        }, {\n            city:  \"city2\",\n            state: \"state2\",\n        },\n    },\n}\n\nvar q Person\nq.age = p.age\nq.name = p.name\nq.address = append(q.address, p.address...)\nq.address[0].city = \"cityx\"\n</code></pre>\n\n<p>Result:<br></p>\n\n<pre><code>p object:\n{20 Jack [{city1 state1} {city2 state2}]}\n\nq object:\n{20 Jack [{cityx state1} {city2 state2}]}\n</code></pre>\n\n<p>Inference:<br>\nAs can be seen from the above example, the p object did not change when q was changed. This approach can be used in nested array of structs.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6745534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d377d1f7d13da29c0c4d02d67a145b75?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Costea", "link": "https://stackoverflow.com/users/6745534/bogdan-costea"}, "is_accepted": false, "score": 1, "last_activity_date": 1583958440, "creation_date": 1583958440, "answer_id": 60643972, "question_id": 51635766, "link": "https://stackoverflow.com/questions/51635766/how-do-i-copy-a-struct-in-golang/60643972#60643972", "title": "How do I copy a struct in Golang?", "body": "<p>You can use a function with pass by value and return the argument untouched or changed depending on your needs.</p>\n\n<p>Using the structs from above:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    copyOf := func(y Person) Person {\n        y.name = \"Polonius\"\n        y.address = append(y.address, Address{\n            city:  \"other city\",\n            state: \"other state\",\n        })\n        return y\n    }\n\n    p := Person{\n        age:  20,\n        name: \"Jack\",\n        address: []Address{\n            {\n                city:  \"city1\",\n                state: \"state1\",\n            }, {\n                city:  \"city2\",\n                state: \"state2\",\n            },\n        },\n    }\n\n    q := copyOf(p)\n\n    fmt.Printf(\"Orig %v, \\naddrss: %p \\n\\n\", p, &amp;p)\n    fmt.Printf(\"Copy %v, \\naddress: %p\\n\\n\", q, &amp;q)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1549, "user_id": 13631587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c4714de792628cb0aa0a4e39cf6eaa1?s=128&d=identicon&r=PG", "display_name": "Jon Nickles", "link": "https://stackoverflow.com/users/13631587/jon-nickles"}, "edited": false, "score": 0, "creation_date": 1618717145, "post_id": 67142112, "comment_id": 118684715, "body": "A <code>struct</code> cannot be a pointer.  I think you meant to say &#39;if your source is pointer to a struct`."}], "tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": -1, "last_activity_date": 1618687200, "creation_date": 1618687200, "answer_id": 67142112, "question_id": 51635766, "link": "https://stackoverflow.com/questions/51635766/how-do-i-copy-a-struct-in-golang/67142112#67142112", "title": "How do I copy a struct in Golang?", "body": "<p>Be careful, if your source <code>struct</code> is actually a pointer, then a normal assign\nwont work:</p>\n<pre><code>package main\nimport &quot;net/http&quot;\n\nfunc main() {\n   a, e := http.NewRequest(&quot;GET&quot;, &quot;https://stackoverflow.com&quot;, nil)\n   if e != nil {\n      panic(e)\n   }\n   b := a.URL\n   b.Host = &quot;superuser.com&quot;\n   println(a.URL.Host == &quot;superuser.com&quot;)\n}\n</code></pre>\n<p>instead, you need to dereference the pointer:</p>\n<pre><code>package main\nimport &quot;net/http&quot;\n\nfunc main() {\n   a, e := http.NewRequest(&quot;GET&quot;, &quot;https://stackoverflow.com&quot;, nil)\n   if e != nil {\n      panic(e)\n   }\n   b := *a.URL\n   b.Host = &quot;superuser.com&quot;\n   println(a.URL.Host == &quot;stackoverflow.com&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 4447, "user_id": 1179137, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/561be56442fcc03169b0c9cafb6b1626?s=128&d=identicon&r=PG", "display_name": "Salim Fadhley", "link": "https://stackoverflow.com/users/1179137/salim-fadhley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30059, "favorite_count": 3, "accepted_answer_id": 51638160, "answer_count": 4, "score": 16, "last_activity_date": 1618687200, "creation_date": 1533133377, "question_id": 51635766, "link": "https://stackoverflow.com/questions/51635766/how-do-i-copy-a-struct-in-golang", "title": "How do I copy a struct in Golang?", "body": "<p>I want to copy an object so that I have two identical objects with two different memory addresses. My first attempt at this has failed:</p>\n\n<pre><code>aa := a\nassert.NotEqual(t, &amp;a, &amp;aa, \"Copied items should not be the same object.\") // Test fails\n</code></pre>\n\n<p>Can I fix this so that it really does a copy of the struct? There's nothing special about this structure.</p>\n"}, {"tags": ["http", "go", "routing", "gorilla"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533130158, "post_id": 51634411, "comment_id": 90233427, "body": "Please post the handler code also where you are capturing the <code>{param}</code>"}, {"owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533130800, "post_id": 51634411, "comment_id": 90233861, "body": "@Himanshu, post has been edited"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533130880, "post_id": 51634411, "comment_id": 90233914, "body": "Add the handler you are calling it seems like the url you are calling is not going to the defined one That&#39;s why the error is <code>page not found</code>. You can achieve that using <code>gorilla&#47;mux</code>. Till now there is no error that can be generated using your provided code."}, {"owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533131160, "post_id": 51634411, "comment_id": 90234123, "body": "@Himanshu, yes it seems because <code>&#47;v1&#47;data&#47;hello%2Fworld</code> interprets by router as  <code>&#47;v1&#47;data&#47;hello&#47;world</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "edited": false, "score": 0, "creation_date": 1533132154, "post_id": 51635153, "comment_id": 90234908, "body": "@Rudzianko\u016d yes I have checked it the space is <code>%20</code>."}, {"owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "edited": false, "score": 0, "creation_date": 1533137262, "post_id": 51635153, "comment_id": 90238519, "body": "answered my own question"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1533133375, "last_edit_date": 1533133375, "creation_date": 1533131714, "answer_id": 51635153, "question_id": 51634411, "link": "https://stackoverflow.com/questions/51634411/how-to-escape-forward-slash-in-request-to-make-url-routers-count-it-as-part-of-u/51635153#51635153", "title": "How to escape forward slash in request to make url-routers count it as part of uri parameter?", "body": "<p>For your question:</p>\n\n<blockquote>\n  <p>Is it possible to achieve this using gorilla/mux or any other router?</p>\n</blockquote>\n\n<p>Yes it is possible using <a href=\"https://github.com/gorilla/mux#examples\" rel=\"nofollow noreferrer\">gorilla/mux</a>. There is nothing wrong in the code you have posted.</p>\n\n<p>The error is <code>page not found</code> which means the url that you are passing is not registered with the mux router.</p>\n\n<p>Pass <code>http://localhost:8080/v1/data/hello world</code> on browser. route will capture  any parameter after the defined url. Also print the captured url path inside handler request struct to see what is the requested url as:</p>\n\n<pre><code>fmt.Println(r.URL.Path)\nuriP := mux.Vars(r)\nparam := uriP[\"param\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "is_accepted": true, "score": 2, "last_activity_date": 1533137237, "creation_date": 1533137237, "answer_id": 51637119, "question_id": 51634411, "link": "https://stackoverflow.com/questions/51634411/how-to-escape-forward-slash-in-request-to-make-url-routers-count-it-as-part-of-u/51637119#51637119", "title": "How to escape forward slash in request to make url-routers count it as part of uri parameter?", "body": "<p>You should add regexp, bc default regexp is matching until <code>/</code> or <code>?</code> symbols. </p>\n\n<pre><code>router.Handle(\"/v1/data/{param:.*}\", handler)\n</code></pre>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 1, "accepted_answer_id": 51637119, "answer_count": 2, "score": 1, "last_activity_date": 1533137237, "creation_date": 1533129656, "last_edit_date": 1533130763, "question_id": 51634411, "link": "https://stackoverflow.com/questions/51634411/how-to-escape-forward-slash-in-request-to-make-url-routers-count-it-as-part-of-u", "title": "How to escape forward slash in request to make url-routers count it as part of uri parameter?", "body": "<p>I have following route mapping using <a href=\"https://github.com/gorilla/mux\" rel=\"nofollow noreferrer\">gorilla/mux</a>:</p>\n\n<pre><code>router.Handle(\"/v1/data/{param}\", handler)\n</code></pre>\n\n<p>when I call <code>curl http://localhost:8080/v1/data/hello%2Fworld</code> I get <code>404</code> response code. The problem is that in my microservice I would like to interpret everything that goes after <code>/v1/data/</code> as <code>param</code>. </p>\n\n<p>Code that's capturing params is following:</p>\n\n<pre><code>uriP := mux.Vars(r)\nparam := uriP[\"param\"]\n</code></pre>\n\n<p>Is it possible to achieve this using <a href=\"https://github.com/gorilla/mux\" rel=\"nofollow noreferrer\">gorilla/mux</a> or any other router? </p>\n"}, {"tags": ["ubuntu", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1533119088, "post_id": 51630935, "comment_id": 90225992, "body": "Are you asking about changing environment variables (that remain changed after your Go app terminates); or changing variables defined and used inside your Go app?"}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1533119544, "post_id": 51630935, "comment_id": 90226281, "body": "Hi thank your for your reply. Imagine that I want o change the port of an IP address, like <code>localhost:8080</code>, and then when I&#39;m in command line I make the go file and execute like this <code>.&#47;name_of_go_file command_name and here I need like a variable to change the port 8080 to 8000</code>"}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1533119744, "post_id": 51630935, "comment_id": 90226398, "body": "`   func mainCmd() *cobra.Command {          return &amp;cobra.Command{         Use: &quot;sensor&quot;,                 RunE: func(cmd *cobra.Command, args []string) error {           ip := &quot;tcp://127.0.0.1:1883&quot;         cmd.Println(&quot;O IP da gateway e o port s&#227;o:&quot;,ip)           //Connect to the broker         opts := MQTT.NewClientOptions()         opts.AddBroker(ip)   `"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1533119810, "post_id": 51630935, "comment_id": 90226437, "body": "Please edit your question with the code samples you have. In general, you may use package <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\"><code>flag</code></a> to get command line arguments into Go variables."}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1533120442, "post_id": 51630935, "comment_id": 90226854, "body": "I&#39;m using cobra not the package ` flag`"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1533123898, "post_id": 51630935, "comment_id": 90228994, "body": "<a href=\"https://github.com/spf13/cobra/blob/master/README.md#working-with-flags\" rel=\"nofollow noreferrer\">github.com/spf13/cobra/blob/master/README.md#working-with-fl&zwnj;&#8203;ags</a>"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533120037, "post_id": 51631218, "comment_id": 90226598, "body": "But I want to change the variables to another value. Imagine I got a variable which name&#39;s ip=80, and in command line I want to change ip=10"}, {"owner": {"reputation": 57, "user_id": 4972469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bldr2qcvznw/AAAAAAAAAAI/AAAAAAAAAA4/Q1OP9YFCnhk/photo.jpg?sz=128", "display_name": "Arun Prakash", "link": "https://stackoverflow.com/users/4972469/arun-prakash"}, "reply_to_user": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 1, "creation_date": 1533121579, "post_id": 51631218, "comment_id": 90227549, "body": "use len(os.Args) in that case. If its &lt;2 use your default option else use the value you passed in command line"}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533123156, "post_id": 51631218, "comment_id": 90228495, "body": "Sorry but I use that like `    argsWithProg := len(os.Args)`"}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533123414, "post_id": 51631218, "comment_id": 90228665, "body": "I can&#39;t see anything"}, {"owner": {"reputation": 57, "user_id": 4972469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bldr2qcvznw/AAAAAAAAAAI/AAAAAAAAAA4/Q1OP9YFCnhk/photo.jpg?sz=128", "display_name": "Arun Prakash", "link": "https://stackoverflow.com/users/4972469/arun-prakash"}, "reply_to_user": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533124479, "post_id": 51631218, "comment_id": 90229360, "body": "initially let ip=80 then check if len(os.Args) &lt; 2 then ip=80 else ip=os.Args[1].  Here in the args[1] you will pass the value 10 as &#39; go run program_name.go 10&#39;"}, {"owner": {"reputation": 57, "user_id": 4972469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bldr2qcvznw/AAAAAAAAAAI/AAAAAAAAAA4/Q1OP9YFCnhk/photo.jpg?sz=128", "display_name": "Arun Prakash", "link": "https://stackoverflow.com/users/4972469/arun-prakash"}, "reply_to_user": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533127450, "post_id": 51631218, "comment_id": 90231387, "body": "yeah. The os.Args[1] should contain the value that you want to assign to the variable ip"}, {"owner": {"reputation": 57, "user_id": 4972469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bldr2qcvznw/AAAAAAAAAAI/AAAAAAAAAA4/Q1OP9YFCnhk/photo.jpg?sz=128", "display_name": "Arun Prakash", "link": "https://stackoverflow.com/users/4972469/arun-prakash"}, "reply_to_user": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533128739, "post_id": 51631218, "comment_id": 90232310, "body": "<a href=\"https://pastebin.com/043VwAY3\" rel=\"nofollow noreferrer\">pastebin.com/043VwAY3</a> - check this. I gave you the pseudo code. This is a example of how to be implemented"}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533128932, "post_id": 51631218, "comment_id": 90232472, "body": "<code>gateway@gateway:~&#47;go-learn&#47;ub_test&#47;another$ go run main.go 15 2 15 gateway@gateway:~&#47;go-learn&#47;ub_test&#47;another$ go run main.go  1 80 </code> The problem is that still has the old number and I want to change"}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533133237, "post_id": 51631218, "comment_id": 90235694, "body": "I need that example to string is possible?"}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 0, "creation_date": 1533134169, "post_id": 51631218, "comment_id": 90236403, "body": "I can do it, but my problem is that I got a cmd cobra every time i run ` ./gateway sensor 80` don&#39;t work"}], "tags": [], "owner": {"reputation": 57, "user_id": 4972469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bldr2qcvznw/AAAAAAAAAAI/AAAAAAAAAA4/Q1OP9YFCnhk/photo.jpg?sz=128", "display_name": "Arun Prakash", "link": "https://stackoverflow.com/users/4972469/arun-prakash"}, "is_accepted": false, "score": 0, "last_activity_date": 1533119837, "creation_date": 1533119837, "answer_id": 51631218, "question_id": 51630935, "link": "https://stackoverflow.com/questions/51630935/how-do-i-can-change-a-variable-with-go-command-line/51631218#51631218", "title": "How do I can change a variable with go command line?", "body": "<p>If you want to change value of variable inside the code, you can use command line arguments.\nYou can refer <a href=\"https://gobyexample.com/command-line-arguments\" rel=\"nofollow noreferrer\">https://gobyexample.com/command-line-arguments</a></p>\n"}, {"comments": [{"owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 0, "creation_date": 1533125073, "post_id": 51632647, "comment_id": 90229733, "body": "It is not necessary to have the main-function in a main.go file, it can be in any file in the package main. It is confusing that you mention main.go in your explanation, but have program.go in your example"}, {"owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "edited": false, "score": 1, "creation_date": 1533126927, "post_id": 51632647, "comment_id": 90231007, "body": "after reading and execute, it can add the <code>Hello CloudFlare</code>."}], "tags": [], "owner": {"reputation": 408, "user_id": 2234099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678915aaa580bada8ed32e01000274c2?s=128&d=identicon&r=PG", "display_name": "gngchrs", "link": "https://stackoverflow.com/users/2234099/gngchrs"}, "is_accepted": false, "score": 0, "last_activity_date": 1533137280, "last_edit_date": 1533137280, "creation_date": 1533124466, "answer_id": 51632647, "question_id": 51630935, "link": "https://stackoverflow.com/questions/51630935/how-do-i-can-change-a-variable-with-go-command-line/51632647#51632647", "title": "How do I can change a variable with go command line?", "body": "<p>you can change the variables during build with <code>go run -ldflags=\"-X..</code>. flags. </p>\n\n<p>In this example, change the ip to become a variable at the start of your code.</p>\n\n<pre><code>var IP = \"&lt;default_ip&gt;\"\n</code></pre>\n\n<p>Then you can reference the variable in the rest of your code. Then run the code with </p>\n\n<pre><code>go run -ldflags=\"-X &lt;package&gt;.IP &lt;new_ip_address&gt;\" program.go\n</code></pre>\n\n<p>So if your package is <code>main</code>, and the program name is <code>main.go</code> and the new IP is <code>0.0.0.0</code> you would run</p>\n\n<pre><code>go run -ldflags=\"-X main.IP 0.0.0.0\" program.go\n</code></pre>\n\n<p>I used this however in my testing (with an <code>=</code> sign, since it errored)</p>\n\n<pre><code>go run -ldflags=\"-X main.who=0.0.0.0\" program.go\n</code></pre>\n\n<p>You can read <a href=\"https://blog.cloudflare.com/setting-go-variables-at-compile-time/\" rel=\"nofollow noreferrer\">this article here for more information</a></p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1533118974, "question_id": 1345154}, "owner": {"reputation": 37, "user_id": 10065267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b0dedd40722f93e646ca0b22e86a52?s=128&d=identicon&r=PG&f=1", "display_name": "Dicarva", "link": "https://stackoverflow.com/users/10065267/dicarva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1533137280, "creation_date": 1533118773, "last_edit_date": 1533120377, "question_id": 51630935, "link": "https://stackoverflow.com/questions/51630935/how-do-i-can-change-a-variable-with-go-command-line", "title": "How do I can change a variable with go command line?", "body": "<p>My problem is <code>go run someprogram.go usecomand change_variable=value</code> is this possible and how I can make it?</p>\n\n<pre><code>import (\n        \"github.com/spf13/cobra\"\n\n        \"fmt\"\n        \"math/rand\"\n        \"time\"\n\n        \"github.com/brocaar/lorawan\"\n\n        MQTT \"github.com/eclipse/paho.mqtt.golang\"\n        lds \"github.com/iegomez/loraserver-device-sim\"\n\n)\n\nfunc mainCmd() *cobra.Command { \n     return &amp;cobra.Command{ \n         Use: \"sensor\", RunE: func(cmd *cobra.Command,args []string) error {\n         ip := \"tcp://127.0.0.1:1883\" \n         cmd.Println(\"O IP da gateway e o port s\u00e3o:\",ip) \n    //Connect to the broker \n    opts :=MQTT.NewClientOptions() opts.AddBroker(ip) \n</code></pre>\n\n<p>See this is what my go file contains and I want in command line build the go file and execute and change the ip variable</p>\n"}, {"tags": ["go", "hugo"], "comments": [{"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1533128281, "post_id": 51628945, "comment_id": 90231957, "body": "Just as a side note, there will always be a trailing comma in your <code>itemListElement</code> logic. Only show the comma if it&#39;s not first <i>and</i> not last."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6731796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc09be0e1cbc155cbed6b8d9cc92c43?s=128&d=identicon&r=PG&f=1", "display_name": "smazzin", "link": "https://stackoverflow.com/users/6731796/smazzin"}, "is_accepted": false, "score": 1, "last_activity_date": 1534899257, "creation_date": 1534899257, "answer_id": 51958529, "question_id": 51628945, "link": "https://stackoverflow.com/questions/51628945/urls-are-repeated/51958529#51958529", "title": "URL&#39;s are repeated", "body": "<p>So I'm not sure what your list page template looks like, but for example in mine I had</p>\n\n<pre><code>{{ partial \"header.html\" . }}\n</code></pre>\n\n<p>when it should have been</p>\n\n<pre><code>{{ partial \"header\" . }}\n</code></pre>\n\n<p>This removed the repeating url's. I have all of the same code you have rendering in my header partial.</p>\n"}, {"tags": [], "owner": {"reputation": 413, "user_id": 4549677, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152565221337447/picture?type=large", "display_name": "Apoorv Mote", "link": "https://stackoverflow.com/users/4549677/apoorv-mote"}, "is_accepted": false, "score": 0, "last_activity_date": 1614573170, "creation_date": 1614573170, "answer_id": 66416679, "question_id": 51628945, "link": "https://stackoverflow.com/questions/51628945/urls-are-repeated/66416679#66416679", "title": "URL&#39;s are repeated", "body": "<p>There are 2 reasons URLs are repeated</p>\n<ol>\n<li>Its known bug with hugo hot reloading. But final production version will not have it. So run <code>hugo</code> and check the public folder.</li>\n<li>If the issue persists on public folder then check how many partials you are doing <code>{{ $.Scratch.Add &quot;path&quot; .Site.BaseURL }}</code>. After you add it once then same data is available via scratch on all partials of the same page.</li>\n</ol>\n<p>I have blog post on <a href=\"https://apoorv.blog/breadcrumb-json-ld-hugo/\" rel=\"nofollow noreferrer\">breadcrumb partial for hugo with json-ld</a></p>\n<p>I reuse the same scratch to display breadcrumbs on page.</p>\n<p>DONT JUST ADD BREADCRUMBS FOR SEARCH ENGINE. SHOW THEM TO USERS ALSO.</p>\n"}], "owner": {"reputation": 173, "user_id": 4559568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MljMl.jpg?s=128&g=1", "display_name": "Hanna Stone", "link": "https://stackoverflow.com/users/4559568/hanna-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1614573170, "creation_date": 1533113043, "question_id": 51628945, "link": "https://stackoverflow.com/questions/51628945/urls-are-repeated", "title": "URL&#39;s are repeated", "body": "<p>I want to output my breadcrumbs using schema, but the <code>@id</code> repeats the URL twice or sometimes more than that?! So if I visit the <code>about</code> page, I see:</p>\n\n<p><code>\"@id\":\"http://localhost:1313/about/http://localhost:1313/about/\",</code> </p>\n\n<p>When I use pagination, it repeats the URL even more: </p>\n\n<p><code>\"@id\":\"http://localhost:1313/blog/http://localhost:1313/blog//http://localhost:1313/blog/http://localhost:1313/blog//http://localhost:1313/blog/http://localhost:1313/blog/\",</code> </p>\n\n<p><strong>The code I am using:</strong> \nTaken from: <a href=\"https://gohugohq.com/partials/breadcrumb-partial-with-structured-data-in-hugo/\" rel=\"nofollow noreferrer\">https://gohugohq.com/partials/breadcrumb-partial-with-structured-data-in-hugo/</a></p>\n\n<pre><code>{{ $url := replace .Permalink ( printf \"%s\" .Site.BaseURL) \"\" }}\n{{ $.Scratch.Add \"path\" .Site.BaseURL }}\n\n{{ $.Scratch.Add \"breadcrumb\" (slice (dict \"url\" .Site.BaseURL \"name\" \"home\" \"position\" 1 )) }}\n{{ range $index, $element := split $url \"/\" }}\n{{ $.Scratch.Add \"path\" $element }}\n{{ $.Scratch.Add \"path\" \"/\" }}\n{{ if ne $element \"\" }}\n{{ $.Scratch.Add \"breadcrumb\" (slice (dict \"url\" ($.Scratch.Get \"path\") \"name\" . \"position\" (add $index 2))) }}\n{{ end }}\n{{ end }}\n\n&lt;script type=\"application/ld+json\"&gt;\n{\n  \"@context\": \"http://schema.org\",\n  \"@type\": \"BreadcrumbList\",\n  \"itemListElement\": [{{ range $.Scratch.Get \"breadcrumb\" }}{{ if ne .position 1 }},{{ end }}{\n        \"@type\": \"ListItem\",\n        \"position\": {{ .position }},\n        \"item\": {\n          \"@id\": \"{{ .url }}\",\n          \"name\": \"{{ .name }}\"\n        }\n    }{{ end }}]\n}\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1533113141, "post_id": 51628755, "comment_id": 90222201, "body": "It depends on your purpose and design. On this specific one, you can set a custom Transport which is a field of <code>http.Client</code> and can add headers there."}, {"owner": {"reputation": 3247, "user_id": 625521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f75ea35d0ffa8468c61f1fb2347a8000?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/625521/jonas"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1533113335, "post_id": 51628755, "comment_id": 90222308, "body": "Could you please give me a hint how to add headers with Transport?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1533144995, "post_id": 51628755, "comment_id": 90242785, "body": "<i>&quot;If there is no way how to mimic OOP, how to do it least painfully?&quot;</i> &lt;-- can&#39;t help but respond to this: Golang isn&#39;t meant to be used in classical OOP way, so please don&#39;t even try to mimic typical OOP constructs. It&#39;s easier just to learn to use the language in the way it was intended to be used, rather than to force it to behave in ways it was not"}, {"owner": {"reputation": 3247, "user_id": 625521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f75ea35d0ffa8468c61f1fb2347a8000?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/625521/jonas"}, "edited": false, "score": 0, "creation_date": 1533215270, "post_id": 51628755, "comment_id": 90272234, "body": "Still would be great to have this feature to be able to change composited methods like in OOP, but must be reasons that Go designers haven&#39;t done this feature. Maybe in future this will be implemented?"}], "answers": [{"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 10, "last_activity_date": 1533114438, "creation_date": 1533114438, "answer_id": 51629379, "question_id": 51628755, "link": "https://stackoverflow.com/questions/51628755/how-to-add-default-header-fields-from-http-client/51629379#51629379", "title": "How to add default header fields from http.Client", "body": "<p><code>http.Client</code> has a field <code>Transport</code> which is of type <code>RoundTripper</code> - an interface type.</p>\n\n<p>It provides us the option to change request (and response, of course) between.</p>\n\n<p>You can create a custom type that wraps another <code>RoundTripper</code> and adds the header in the custom type's <code>RoundTrip</code>:</p>\n\n<pre><code>type AddHeaderTransport struct{\n    T http.RoundTripper\n}\n\nfunc (adt *AddHeaderTransport) RoundTrip(req *http.Request) (*http.Response,error) {\n    req.Header.Add(\"User-Agent\", \"go\")\n    return adt.T.RoundTrip(req)\n}\n</code></pre>\n\n<p>Full code on playground: <a href=\"https://play.golang.org/p/FbkpFlyFCm_F\" rel=\"noreferrer\">https://play.golang.org/p/FbkpFlyFCm_F</a></p>\n"}], "owner": {"reputation": 3247, "user_id": 625521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f75ea35d0ffa8468c61f1fb2347a8000?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/625521/jonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3001, "favorite_count": 2, "accepted_answer_id": 51629379, "answer_count": 1, "score": 3, "last_activity_date": 1533124340, "creation_date": 1533112382, "last_edit_date": 1533124340, "question_id": 51628755, "link": "https://stackoverflow.com/questions/51628755/how-to-add-default-header-fields-from-http-client", "title": "How to add default header fields from http.Client", "body": "<p>I want <code>http.Client</code> to add additional header for all requests.</p>\n\n<pre><code>type MyClient struct {\n    http.Client\n}\n\nfunc (c *MyClient) Do(req *http.Request) (*http.Response, error) {\n    req.Header.Add(\"User-Agent\", \"go\")\n    return c.Client.Do(req)\n}\n</code></pre>\n\n<p><code>func Do</code> never gets called if I call <code>func PostForm</code> that is using <code>Do</code>. If there is no way how to mimic OOP, how to do it least painfully?</p>\n"}, {"tags": ["pointers", "go", "reflection", "slice"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8379152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCUG0.jpg?s=128&g=1", "display_name": "clafoutis", "link": "https://stackoverflow.com/users/8379152/clafoutis"}, "edited": false, "score": 0, "creation_date": 1533120494, "post_id": 51629010, "comment_id": 90226884, "body": "Thank you very much this solved my problem and helped me understand the <code>reflect</code> pkg better !"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1533113265, "creation_date": 1533113265, "answer_id": 51629010, "question_id": 51628655, "link": "https://stackoverflow.com/questions/51628655/concatenate-slices-from-pointer-passed-as-interface/51629010#51629010", "title": "Concatenate slices from pointer passed as interface", "body": "<p>You shouldn't use <a href=\"https://golang.org/pkg/reflect/#Copy\" rel=\"nofollow noreferrer\"><code>reflect.Copy()</code></a> to copy the result slice (after append), as destination will not have enough space. <a href=\"https://golang.org/pkg/reflect/#AppendSlice\" rel=\"nofollow noreferrer\"><code>reflect.AppendSlice()</code></a> will not change the slice pointed by <code>dst</code>, it will allocate a new one if needed, and it returns the new slice (more precisely the <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\"><code>reflect.Value</code></a> holding it).</p>\n\n<p>What you should do is set the slice returned by <code>reflect.AppendSlice()</code> to the value pointed by <code>dst</code>, simply using the <a href=\"https://golang.org/pkg/reflect/#Value.Set\" rel=\"nofollow noreferrer\"><code>Value.Set()</code></a> method. One thing to note is that you are not setting a slice pointer but a slice, so first call e.g. <a href=\"https://golang.org/pkg/reflect/#Value.Elem\" rel=\"nofollow noreferrer\"><code>Value.Elem()</code></a> before calling <code>Set()</code>.</p>\n\n<p>See this example:</p>\n\n<pre><code>func concatenateSlice(dst, src interface{}) {\n    dv := reflect.ValueOf(dst)\n    sv := reflect.ValueOf(src)\n    if dv.Type() != sv.Type() {\n        return\n    }\n\n    dv2 := reflect.AppendSlice(dv.Elem(), sv.Elem())\n    dv.Elem().Set(dv2)\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>dst := []int{1, 2}\nsrc := []int{3, 4}\n\nconcatenateSlice(&amp;dst, &amp;src)\n\nfmt.Println(dst)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/V-d9F6zisbD\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[1 2 3 4]\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8379152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCUG0.jpg?s=128&g=1", "display_name": "clafoutis", "link": "https://stackoverflow.com/users/8379152/clafoutis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 2, "accepted_answer_id": 51629010, "answer_count": 1, "score": 2, "last_activity_date": 1533140515, "creation_date": 1533112019, "last_edit_date": 1533140515, "question_id": 51628655, "link": "https://stackoverflow.com/questions/51628655/concatenate-slices-from-pointer-passed-as-interface", "title": "Concatenate slices from pointer passed as interface", "body": "<p>I'm working on a client for a specific API, and I built several structures (one for each route).<br>\nThe API works with pages so I have getters returning slices of a struct. This is done passing through a common function that takes an interface supposed to be a pointer to a slice of the wanted structure so I can use <code>Unmarshal</code> from the <code>json</code> package.</p>\n\n<p>The problem I'm facing is that I would like to get all the pages in a single request, but in order to do that I would need to concatenate several slices.</p>\n\n<p>I tried to do this using <code>reflect</code> but I can only manage to create a new slice without actually altering the value that my interface is pointing to.</p>\n\n<p>Here's a part of my code:</p>\n\n<pre><code>func concatenateSlice(dst, src interface{})(){\n    dstValue := reflect.ValueOf(dst)\n    srcValue := reflect.ValueOf(src)\n    if srcValue.Type() != dstValue.Type(){\n        return\n    }\n    switch srcValue.Kind(){\n    case reflect.Ptr, reflect.Slice:\n        dstValuePoint := reflect.Indirect(dstValue)\n        srcValuePoint := reflect.Indirect(srcValue)\n        reflect.Copy(dstValuePoint, reflect.AppendSlice(dstValuePoint, srcValuePoint))\n    }\n}\n</code></pre>\n\n<p>I'm sorry for the sloppy post, this is my first time on stackoverflow.</p>\n"}, {"tags": ["go", "profiling"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "edited": false, "score": 0, "creation_date": 1533114320, "post_id": 51629057, "comment_id": 90222872, "body": "What does total samples = 2.8s mean? every sample is drawn with an interval of 2.8s?"}, {"owner": {"reputation": 76, "user_id": 5622965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1d4bd0043fa0c623d339a9541b0b13?s=128&d=identicon&r=PG&f=1", "display_name": "sophisticasean", "link": "https://stackoverflow.com/users/5622965/sophisticasean"}, "reply_to_user": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "edited": false, "score": 0, "creation_date": 1540278645, "post_id": 51629057, "comment_id": 92794462, "body": "It means that it took 2.8s worth of samples out of the 1 minute of total runtime."}], "tags": [], "owner": {"reputation": 76, "user_id": 5622965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1d4bd0043fa0c623d339a9541b0b13?s=128&d=identicon&r=PG&f=1", "display_name": "sophisticasean", "link": "https://stackoverflow.com/users/5622965/sophisticasean"}, "is_accepted": false, "score": 1, "last_activity_date": 1533113412, "creation_date": 1533113412, "answer_id": 51629057, "question_id": 51628235, "link": "https://stackoverflow.com/questions/51628235/how-to-interpret-cpu-profiling-graph/51629057#51629057", "title": "How to interpret cpu profiling graph", "body": "<p>Think of the graph as a graph of a resource, time. You'll start at the top with, for example, 10 seconds. Then you'll see that 5 seconds went to <code>time.Sleep</code> and 5 went to <code>encoding/json</code>. The particular divides in that time is represented by the arrows, so they show that 5 went to each part of the program. So now we have 3 nodes, the first node 10 seconds, <code>time.Sleep</code> 5 seconds, and <code>encoding/json</code> 5 seconds. Then those 5 seconds in <code>encoding/json</code> are broken down even further into the functions that took up most the time. The <code>0.01s (percentage) out of 0.02s (larger percentage)</code> means that this function took 0.01s of processing time out of a total of 0.02s of the block of time (the arrow with the number) total by this particular call stack. The percentage represents the overall percentage of execution time this part took up from the whole pie. So you'll see that <code>encoding/json string/encoder</code> took 0.36 percent of the total execution time/resources of your program.</p>\n"}], "owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533140530, "creation_date": 1533110508, "last_edit_date": 1533140530, "question_id": 51628235, "link": "https://stackoverflow.com/questions/51628235/how-to-interpret-cpu-profiling-graph", "title": "How to interpret cpu profiling graph", "body": "<p>I was following the go blog <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<p>I tried to profile my program but it looks a bit different. (Seems that go has moved from sampling to instrumentation?)</p>\n\n<p>I wonder what these numbers mean</p>\n\n<p><a href=\"https://i.stack.imgur.com/nM8Lk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nM8Lk.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/tQKxx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tQKxx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Especially <code>showing nodes accounting for 2.59s, 92.5% of 2.8</code></p>\n\n<ol>\n<li><p>What does total sample = 2.8s mean? The sample is drawn in an interval of 2.8 seconds?</p></li>\n<li><p>Does it mean that only nodes that are running over 92.5% of sample\ntime are shown?</p></li>\n</ol>\n\n<p>Also I wonder these numbers are generated. In the original go blog, the measure is how many times the function is detected in execution among all samples. However, we are dealing with seconds here. How does go profiling tool know how many seconds a function call takes.</p>\n\n<p>Any help will be appreciated</p>\n"}, {"tags": ["image", "go", "draw"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 1, "creation_date": 1533134764, "post_id": 51626905, "comment_id": 90236826, "body": "What do you want to draw a circle onto?"}, {"owner": {"reputation": 33, "user_id": 7763649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/304fb60b8619ad6d90f0da2899929762?s=128&d=identicon&r=PG&f=1", "display_name": "igohardinmath", "link": "https://stackoverflow.com/users/7763649/igohardinmath"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1533171908, "post_id": 51626905, "comment_id": 90252473, "body": "draw a circle onto a square image. Like there&#39;s a way to draw a rectangle (like below), there should be a way to draw a circle (maybe i just don&#39;t know about it)"}, {"owner": {"reputation": 33, "user_id": 7763649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/304fb60b8619ad6d90f0da2899929762?s=128&d=identicon&r=PG&f=1", "display_name": "igohardinmath", "link": "https://stackoverflow.com/users/7763649/igohardinmath"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1533171977, "post_id": 51626905, "comment_id": 90252488, "body": "image.NewRGBA(image.Rect(0, 0, 200, 200)) blue := color.RGBA{255, 255, 255, 255} draw.Draw(m, m.Bounds(), &amp;image.Uniform{blue}, image.ZP, draw.Src)"}], "answers": [{"comments": [{"owner": {"reputation": 3662, "user_id": 179438, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9bd9a8a0dbba9f6aa56b78304f231f1a?s=128&d=identicon&r=PG", "display_name": "Alessandro De Simone", "link": "https://stackoverflow.com/users/179438/alessandro-de-simone"}, "edited": false, "score": 0, "creation_date": 1611403174, "post_id": 51627141, "comment_id": 116442963, "body": "Thanks a lot!  The only thing I had to change in the DrawCircle function was the condition in the for loop : &quot;x &gt;= y&quot; instead of &quot;x &gt; y&quot;, since there were few gaps in the circle."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1533194650, "last_edit_date": 1533194650, "creation_date": 1533106702, "answer_id": 51627141, "question_id": 51626905, "link": "https://stackoverflow.com/questions/51626905/drawing-circles-with-two-radius-in-golang/51627141#51627141", "title": "Drawing Circles with two radius in Golang", "body": "<p>Please read this related question: <a href=\"https://stackoverflow.com/questions/28992396/draw-a-rectangle-in-golang/29004191#29004191\">Draw a rectangle in Golang?</a></p>\n\n<p>To sum it up: the standard Go library does not provide primitive drawing or painting capabilities.</p>\n\n<p>So yes, either you have to use a 3rd party library to draw a circle (such as <a href=\"https://github.com/llgcode/draw2d\" rel=\"noreferrer\">github.com/llgcode/draw2d</a>), or you have to do it yourself. Don't worry, it's not hard at all.</p>\n\n<h2>Drawing a single circle</h2>\n\n<p>First pick a circle drawing algorithm which is simple and efficient. I recommend the <a href=\"https://en.wikipedia.org/wiki/Midpoint_circle_algorithm\" rel=\"noreferrer\">Midpoint circle algorithm</a>.</p>\n\n<p>You will find the algorithm on the linked Wikipedia page. Note: you do not have to understand it if you want to use it.</p>\n\n<p>But we do need to implement the algorithm in Go. Which is rather simple:</p>\n\n<pre><code>func drawCircle(img draw.Image, x0, y0, r int, c color.Color) {\n    x, y, dx, dy := r-1, 0, 1, 1\n    err := dx - (r * 2)\n\n    for x &gt; y {\n        img.Set(x0+x, y0+y, c)\n        img.Set(x0+y, y0+x, c)\n        img.Set(x0-y, y0+x, c)\n        img.Set(x0-x, y0+y, c)\n        img.Set(x0-x, y0-y, c)\n        img.Set(x0-y, y0-x, c)\n        img.Set(x0+y, y0-x, c)\n        img.Set(x0+x, y0-y, c)\n\n        if err &lt;= 0 {\n            y++\n            err += dy\n            dy += 2\n        }\n        if err &gt; 0 {\n            x--\n            dx += 2\n            err += dx - (r * 2)\n        }\n    }\n}\n</code></pre>\n\n<p>That's all it takes. Just pass a <a href=\"https://golang.org/pkg/image/draw/#Image\" rel=\"noreferrer\"><code>draw.Image</code></a> you want to draw on, and the parameters of the circle you want to draw (center point, radius and the color).</p>\n\n<p>Let's see it in action. Let's create an image, draw a circle on it, and save the image to a file. This is all it takes:</p>\n\n<pre><code>img := image.NewRGBA(image.Rect(0, 0, 100, 100))\ndrawCircle(img, 40, 40, 30, color.RGBA{255, 0, 0, 255})\n\nbuf := &amp;bytes.Buffer{}\nif err := png.Encode(buf, img); err != nil {\n    panic(err)\n}\nif err := ioutil.WriteFile(\"circle.png\", buf.Bytes(), 0666); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Note: you could also encode the image directly to an <a href=\"https://golang.org/pkg/os/#File\" rel=\"noreferrer\"><code>os.File</code></a> and \"skip\" the in-memory buffer. This is just for demonstration, and to verify our implementation works.</p>\n\n<h2>Drawing a ring (filling space between 2 circles)</h2>\n\n<p>This one isn't that trivial if you want to implement it yourself, but using a 3rd party lib here could really come handy.</p>\n\n<p>Although most of them don't contain ring-painting support, they do have circle drawing support, and you can set the width of the line used to draw the circle.</p>\n\n<p>So, set the line width to the value that is the difference of the 2 radius of your circles. And draw a circle with a new radius that is the arithmetic center of the 2 original radius.</p>\n\n<p>Here's the algorithm (this is not runnable code):</p>\n\n<pre><code>// Helper functions abstracting the library you choose:\n\nfunc setColor(c color.Color) {}\nfunc setLineWidth(width float64) {}\nfunc drawCircle(r, x, y float64) {}\n\n// fillRing draws a ring, where r1 and r2 are 2 concentric circles,\n// the boundaries of the ring, (x, y) being the center point.\nfunc fillRing(r1, r2, x, y float64, c color.color) {\n    // Set drawing color:\n    setColor(c)\n\n    // Set line width:\n    width := r2 - r1\n    if width &lt; 0 {\n        width = -width\n    }\n    setLineWidth(width)\n\n    // And finally draw a circle which will be a ring:\n    r := (r2 + r1) / 2\n    drawCircle(r, x, y)\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7763649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/304fb60b8619ad6d90f0da2899929762?s=128&d=identicon&r=PG&f=1", "display_name": "igohardinmath", "link": "https://stackoverflow.com/users/7763649/igohardinmath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2720, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1533194650, "creation_date": 1533105831, "last_edit_date": 1533107326, "question_id": 51626905, "link": "https://stackoverflow.com/questions/51626905/drawing-circles-with-two-radius-in-golang", "title": "Drawing Circles with two radius in Golang", "body": "<p>I've looked around but can't find anything useful for drawing circles in golang.\nI'd like to draw a draw with 2 given (inner and outer) radius and color all pixels in between. </p>\n\n<p>One possible method would be to iterate through each pixel and color it until the ring has been created. Although, that seems really inefficient. </p>\n\n<p>Any help on this would be greatly appreciated! :)</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1533116003, "last_edit_date": 1533116003, "creation_date": 1533105665, "answer_id": 51626865, "question_id": 51626813, "link": "https://stackoverflow.com/questions/51626813/is-there-any-command-line-in-golang-to-check-syntax-error-of-my-go-source-code/51626865#51626865", "title": "Is there any command line in Golang to check syntax error of my go source code &amp; write the errors to a file?", "body": "<p><code>gofmt</code> will output the errors to the standard error. You can simply redirect the standard error stream of <code>gofmt</code> to a file on unix systems like this:</p>\n\n<pre><code>gofmt -e my_file.go 2&gt;a.txt\n</code></pre>\n\n<p>Checking it:</p>\n\n<pre><code>more a.txt\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>my_file.go:8:1: expected declaration, found '}'\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 10093490, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-HkLheA9uM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ozdVcVH7ARZk7IhIhgAzGdme_k3Q/mo/photo.jpg?sz=128", "display_name": "Suman", "link": "https://stackoverflow.com/users/10093490/suman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533116075, "creation_date": 1533105490, "last_edit_date": 1533116075, "question_id": 51626813, "link": "https://stackoverflow.com/questions/51626813/is-there-any-command-line-in-golang-to-check-syntax-error-of-my-go-source-code", "title": "Is there any command line in Golang to check syntax error of my go source code &amp; write the errors to a file?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc plus(a int, b int) int {\n    return a + b\n}\n}\nfunc plusPlus(a, b, c int) int {\n    return a + b + c\n}\n\nfunc main() {\n    res := plus(1, 2)\n    fmt.Println(\"1+2 =\", res)\n\n    res = plusPlus(1, 2, 3)\n    fmt.Println(\"1+2+3 =\", res)\n}\n</code></pre>\n\n<p>This is my Go Source code.\n<code>gofmt -e my_file.go</code> is working But I am not able to write the errors to a text file.</p>\n"}, {"tags": ["go", "goland"], "comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533105905, "post_id": 51626573, "comment_id": 90218207, "body": "I need more details on this. Is the GOPATH value configured in the correct place? Can you update the question with a screenshot of that settings screen? Can you also give me a screenshot of the project panel with the whole External Libraries section expanded where the GOPATH entry is?"}, {"owner": {"reputation": 440, "user_id": 9304999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3970fc1fd87d29ff362f86310cce7b06?s=128&d=identicon&r=PG&f=1", "display_name": "jinbeom hong", "link": "https://stackoverflow.com/users/9304999/jinbeom-hong"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533107878, "post_id": 51626573, "comment_id": 90219288, "body": "@dlsniper I uploaded a video <a href=\"https://youtu.be/KI085FfgufM\" rel=\"nofollow noreferrer\">here</a> on youtube."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1533129028, "post_id": 51626573, "comment_id": 90232552, "body": "P.S. you don&#39;t need to delete <code>.idea</code> directory. Just refresh the IDE (by closing it and reopening) and it will work."}, {"owner": {"reputation": 440, "user_id": 9304999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3970fc1fd87d29ff362f86310cce7b06?s=128&d=identicon&r=PG&f=1", "display_name": "jinbeom hong", "link": "https://stackoverflow.com/users/9304999/jinbeom-hong"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1533129279, "post_id": 51626573, "comment_id": 90232748, "body": "@Lansana I also rebooted computer :)"}], "owner": {"reputation": 440, "user_id": 9304999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3970fc1fd87d29ff362f86310cce7b06?s=128&d=identicon&r=PG&f=1", "display_name": "jinbeom hong", "link": "https://stackoverflow.com/users/9304999/jinbeom-hong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2181, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1533114914, "creation_date": 1533104512, "last_edit_date": 1533114914, "question_id": 51626573, "link": "https://stackoverflow.com/questions/51626573/how-to-index-entire-gopath-for-existing-project-in-goland", "title": "How to index entire GOPATH for existing project in Goland?", "body": "<p>When I create a project, I forgot to check [index entire GOPATH]. So currently, the project can't find third party modules.</p>\n\n<p>Even though I checked <code>[index entire GOPATH]</code> option for this project in <code>Preferences | Go | GOPATH | Project GOPATH</code>, the project doesn't index the entire GOPATH.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>I deleted .idea directory and opened the project again, it works fine now.</p>\n"}, {"tags": ["node.js", "string", "go", "encoding", "base64"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1533105008, "post_id": 51626547, "comment_id": 90217767, "body": "<code>new Buffer(&#39;test&#39;, &#39;base64&#39;)</code> <i>decodes</i> \u201ctest\u201d as base64. Did you mean <code>new Buffer(&#39;test&#39;, &#39;ascii&#39;).toString(&#39;base64&#39;)</code>?"}, {"owner": {"reputation": 2406, "user_id": 990403, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3bcbd781c6de2ac68c0cfab7ff90c714?s=128&d=identicon&r=PG", "display_name": "mkingston", "link": "https://stackoverflow.com/users/990403/mkingston"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1533105220, "post_id": 51626547, "comment_id": 90217869, "body": "Ooh well now that&#39;s interesting; the string <code>&quot;test&quot;</code> is a jwt signing key. And the software in question appears then to be using <code>&quot;thingsboardDefaultSigningKey&quot;</code> as a b64 string. Thanks for your comment, you may have answered my question. Back in a minute!"}, {"owner": {"reputation": 2406, "user_id": 990403, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3bcbd781c6de2ac68c0cfab7ff90c714?s=128&d=identicon&r=PG", "display_name": "mkingston", "link": "https://stackoverflow.com/users/990403/mkingston"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1533105403, "post_id": 51626547, "comment_id": 90217958, "body": "@Ry-, thanks a lot, icza has posted the same in an answer, I&#39;m going to award the tick to that. Sorry I can&#39;t split it."}], "answers": [{"comments": [{"owner": {"reputation": 2406, "user_id": 990403, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3bcbd781c6de2ac68c0cfab7ff90c714?s=128&d=identicon&r=PG", "display_name": "mkingston", "link": "https://stackoverflow.com/users/990403/mkingston"}, "edited": false, "score": 0, "creation_date": 1533105428, "post_id": 51626731, "comment_id": 90217968, "body": "You&#39;ve very thoroughly answered the question, you can stop editing! Thank you!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1533105180, "last_edit_date": 1592644375, "creation_date": 1533105180, "answer_id": 51626731, "question_id": 51626547, "link": "https://stackoverflow.com/questions/51626547/golang-base64-encoding-vs-nodejs-buffer-base64-encoding/51626731#51626731", "title": "golang base64 encoding vs nodejs buffer base64 encoding", "body": "<p>This constructor:</p>\n<pre><code>new Buffer('test', 'base64')\n</code></pre>\n<p>Decodes the input string <code>test</code>, using <code>base64</code> encoding. It does not encode the <code>test</code> using base64. See the <a href=\"https://nodejs.org/api/buffer.html#buffer_new_buffer_string_encoding\" rel=\"nofollow noreferrer\">reference</a>:</p>\n<blockquote>\n<pre><code>new Buffer(string[, encoding])\n</code></pre>\n<ul>\n<li><code>string</code>  String to encode.</li>\n<li><code>encoding</code>  The encoding of <code>string</code>. <strong>Default:</strong> <code>'utf8'</code>.</li>\n</ul>\n</blockquote>\n<p>The equivalent Go code would be:</p>\n<pre><code>data, err := base64.StdEncoding.DecodeString(&quot;test&quot;)\nif err != nil {\n    panic(err)\n}\nfmt.Printf(&quot;% x&quot;, data)\n</code></pre>\n<p>Which outputs (try it on the <a href=\"https://play.golang.org/p/pnHLApLtmxt\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>b5 eb 2d\n</code></pre>\n<p>To encode in Node.js, use (for details see <a href=\"https://stackoverflow.com/questions/6182315/how-to-do-base64-encoding-in-node-js\">How to do Base64 encoding in node.js?</a>):</p>\n<pre><code>Buffer.from(&quot;test&quot;).toString('base64')\n</code></pre>\n"}], "owner": {"reputation": 2406, "user_id": 990403, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3bcbd781c6de2ac68c0cfab7ff90c714?s=128&d=identicon&r=PG", "display_name": "mkingston", "link": "https://stackoverflow.com/users/990403/mkingston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1086, "favorite_count": 1, "accepted_answer_id": 51626731, "answer_count": 1, "score": 0, "last_activity_date": 1533194129, "creation_date": 1533104412, "last_edit_date": 1533194129, "question_id": 51626547, "link": "https://stackoverflow.com/questions/51626547/golang-base64-encoding-vs-nodejs-buffer-base64-encoding", "title": "golang base64 encoding vs nodejs buffer base64 encoding", "body": "<p>I'm using a piece of software that base64 encodes in node as follows:</p>\n\n<pre><code>const enc = new Buffer('test', 'base64')\n</code></pre>\n\n<p><code>console.log(enc)</code> displays:</p>\n\n<pre><code>&lt;Buffer b5 eb 2d&gt;\n</code></pre>\n\n<p>I'm writing a golang service that needs to interoperate with this. But I can't reproduce the above result in go.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    b64 \"encoding/base64\"\n)\n\nfunc main() {\n    // Attempt 1\n    res := []byte(b64.URLEncoding.EncodeToString([]byte(\"test\")))\n    fmt.Println(res)\n    // Attempt 2\n    buf := make([]byte, 8)\n    b64.URLEncoding.Encode(buf, []byte(\"test\"))\n    fmt.Println(buf)\n}\n</code></pre>\n\n<p>The above prints:</p>\n\n<pre><code>[100 71 86 122 100 65 61 61]\n[100 71 86 122 100 65 61 61]\n</code></pre>\n\n<p>both of which are rather different from node's output. I suspect the difference is that node is storing the string as bytes from a base64 string, while go is storing the string as bytes from an ascii/utf8 string represented as base64. But haven't figured out how to get go to do as node is doing!</p>\n\n<p>I skimmed the go source for the encoding, then attempted to find the Node source for Buffer, but after a little while hunting decided it would probably be much quicker to post here in the hope someone knew the answer off-hand.</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 2330486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c55dd7c0a68acd97963da84a3175cc66?s=128&d=identicon&r=PG", "display_name": "Heungsub Lee", "link": "https://stackoverflow.com/users/2330486/heungsub-lee"}, "edited": false, "score": 0, "creation_date": 1533204695, "post_id": 51630462, "comment_id": 90265169, "body": "Thank you for the answer! Is the reason, why only Go has a higher limit, that GAE Go doesn&#39;t support dynamic linking?"}, {"owner": {"reputation": 2037, "user_id": 9908251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfe029a5bd86f462e1debd7dc3442d2?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo Cacheda", "link": "https://stackoverflow.com/users/9908251/guillermo-cacheda"}, "reply_to_user": {"reputation": 168, "user_id": 2330486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c55dd7c0a68acd97963da84a3175cc66?s=128&d=identicon&r=PG", "display_name": "Heungsub Lee", "link": "https://stackoverflow.com/users/2330486/heungsub-lee"}, "edited": false, "score": 0, "creation_date": 1533222456, "post_id": 51630462, "comment_id": 90277370, "body": "@HeungsubLee Thank you too! About your question, the GCP team received reports of users hitting the size limit when using Go. After looking into it, they considered appropriate to rise it."}], "tags": [], "owner": {"reputation": 2037, "user_id": 9908251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfe029a5bd86f462e1debd7dc3442d2?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo Cacheda", "link": "https://stackoverflow.com/users/9908251/guillermo-cacheda"}, "is_accepted": true, "score": 2, "last_activity_date": 1533117638, "creation_date": 1533117638, "answer_id": 51630462, "question_id": 51625239, "link": "https://stackoverflow.com/questions/51625239/what-is-the-actual-app-binary-limit-in-google-app-engine/51630462#51630462", "title": "What is the actual app binary limit in Google App Engine?", "body": "<p>Yes, Go has a higher max static data file size limit than other languages. This change is not in the documentation and it needs to be updated to reflect the correct value for Go.</p>\n\n<p>I've filed a public issue about it <a href=\"https://issuetracker.google.com/issues/112061972\" rel=\"nofollow noreferrer\">here</a> for the documentation update.</p>\n"}], "owner": {"reputation": 168, "user_id": 2330486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c55dd7c0a68acd97963da84a3175cc66?s=128&d=identicon&r=PG", "display_name": "Heungsub Lee", "link": "https://stackoverflow.com/users/2330486/heungsub-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 51630462, "answer_count": 1, "score": 1, "last_activity_date": 1533117638, "creation_date": 1533096823, "last_edit_date": 1533103363, "question_id": 51625239, "link": "https://stackoverflow.com/questions/51625239/what-is-the-actual-app-binary-limit-in-google-app-engine", "title": "What is the actual app binary limit in Google App Engine?", "body": "<p>When I deploy an app on my Go standard environment, the below size limit error occurred:</p>\n\n<pre><code>ERROR: (gcloud.app.deploy) Error Response: [9] Deployment contains files that cannot be compiled: App binary too big: 69351840 &gt; 67108864\n</code></pre>\n\n<p><code>67108864</code> is <code>64MB</code>. But this limit is different with what <a href=\"https://cloud.google.com/appengine/quotas\" rel=\"nofollow noreferrer\">the documentation</a> says. The limit in the documentation is <code>32MB</code> instead:</p>\n\n<blockquote>\n  <p>Each file is limited to a maximum size of 32 megabytes.</p>\n</blockquote>\n\n<p>Is the documentation outdated? Or only Go has a higher limit than other languages? I want to find the documentation of actual app binary limits.</p>\n"}, {"tags": ["generics", "go", "slice"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1533109032, "post_id": 51624639, "comment_id": 90219979, "body": "Why not just use <code>append</code>? It is already generic. For example you can do this <a href=\"https://play.golang.org/p/pj5sjlINtNF\" rel=\"nofollow noreferrer\"><code>ints = append(ints, ReturnInt())</code></a>. Also note that, apart from a few builtins, Go does not support generics, and therefore an attempt to implement generic types in your go program is gonna result in either failure or a solution that&#39;s lacking."}, {"owner": {"reputation": 4880, "user_id": 507606, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/80369b9130fb400572c162106e44ea00?s=128&d=identicon&r=PG", "display_name": "JaredC", "link": "https://stackoverflow.com/users/507606/jaredc"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533133385, "post_id": 51624639, "comment_id": 90235805, "body": "Why the downvote?  I&#39;m well aware of the generics situation in go, but there are appropriate times to use it.  In this case, its a single, very isolated, small function that can unlock a lot of other cleanliness and go-like idioms throughout the rest of my application.  Feels like the appropriate level of tradeoff for me."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533133724, "post_id": 51624639, "comment_id": 90236076, "body": "Jared just FYI, I&#39;m not the one who gave you the downvote, so I can&#39;t answer your question. As to the rest of your comment: fair enough."}], "answers": [{"comments": [{"owner": {"reputation": 4880, "user_id": 507606, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/80369b9130fb400572c162106e44ea00?s=128&d=identicon&r=PG", "display_name": "JaredC", "link": "https://stackoverflow.com/users/507606/jaredc"}, "edited": false, "score": 0, "creation_date": 1533133241, "post_id": 51625064, "comment_id": 90235697, "body": "Thanks, this is exactly what I needed."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1533101614, "last_edit_date": 1533101614, "creation_date": 1533095096, "answer_id": 51625064, "question_id": 51624639, "link": "https://stackoverflow.com/questions/51624639/how-to-implement-a-generic-slice-appender/51625064#51625064", "title": "How to implement a generic slice appender?", "body": "<p>The types <code>func() *interface{}</code> (type type of GenericFunc) and <code>(type func() *int)</code> (the type of ReturnInt) are different types. One returns a <code>*interface{}</code>.  The other returns a <code>*int</code>.  The types are not assignable to each other.</p>\n\n<p>Use this function to generically append the result of a function to a slice:</p>\n\n<pre><code>func Append(sp interface{}, f interface{}) {\n    s := reflect.ValueOf(sp).Elem()\n    s.Set(reflect.Append(s, reflect.ValueOf(f).Call(nil)[0]))\n}\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>var ints []*int\nAppend(&amp;ints, ReturnInt)\n</code></pre>\n\n<p>The function will panic if the argument is not a pointer to a slice or the function does not return a value assignable to a slice element.</p>\n\n<p><a href=\"https://play.golang.org/p/9vbOXvRZ0nk\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 4880, "user_id": 507606, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/80369b9130fb400572c162106e44ea00?s=128&d=identicon&r=PG", "display_name": "JaredC", "link": "https://stackoverflow.com/users/507606/jaredc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 51625064, "answer_count": 1, "score": -1, "last_activity_date": 1533101614, "creation_date": 1533091016, "last_edit_date": 1533091337, "question_id": 51624639, "link": "https://stackoverflow.com/questions/51624639/how-to-implement-a-generic-slice-appender", "title": "How to implement a generic slice appender?", "body": "<p>I'm relatively new to <code>go</code>.  I'm trying to write a generic \"appender\" function.  This is a simplification, but its an attempt to create a clean interface for processing some lists.  Specifically, I have questions about the two errors that this generates:</p>\n\n<pre><code>package main\n\ntype GenericFunc func() *interface{}\nfunc Append(ints interface{}, f GenericFunc) {\n    ints = append(ints, f())\n}\n\nfunc ReturnInt() *int {\n    i := 1\n    return &amp;i\n}\n\nfunc main() {\n    var ints []*int\n    Append(ints, ReturnInt)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/SmeKgEq3Y0y\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<blockquote>\n  <p>prog.go:5:18: first argument to append must be slice; have interface\n  {} prog.go:15:11: cannot use ReturnInt (type func() *int) as type\n  GenericFunc in argument to Append</p>\n</blockquote>\n\n<ol>\n<li>Why can't <code>ReturnInt</code> be of type <code>GenericFunc</code>?  If this doesn't work, I'm not understanding how <code>interface{}</code> can be used with functions at all.. can it?</li>\n<li>How can you accept a \"generic\" slice and append to it using reflection?  This would involve checking that <code>GenericFunc</code> returns the same type that the slice is, but after that appending should be possible.  </li>\n</ol>\n"}, {"tags": ["oop", "go"], "comments": [{"owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1533085859, "post_id": 51623856, "comment_id": 90213154, "body": "Will that make Dog adhere to the Animal interface? How would the relationship between Dog and Animal be enforced ?"}, {"owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1533095822, "post_id": 51623856, "comment_id": 90215047, "body": "So I&#39;d need to do <code>var _ Animal = (*Dog)(nil)</code> ? According to comments in that thread, this is an unofficial way to enforce interface methods are implemented. This would work for my purpose. But wondering if there is a better way to do the scenario I have? Is my code example good go code?"}, {"owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1533096387, "post_id": 51623856, "comment_id": 90215140, "body": "The code does compile. Please see the playground: <a href=\"https://play.golang.org/p/IRmreX4nhYt\" rel=\"nofollow noreferrer\">play.golang.org/p/IRmreX4nhYt</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 0, "creation_date": 1533135866, "post_id": 51625437, "comment_id": 90237603, "body": "This seems useful. So this is casting the Animal to be a Dog right?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 0, "creation_date": 1533136959, "post_id": 51625437, "comment_id": 90238342, "body": "@Bharat no this is not casting an <code>Animal</code> interface to be a <code>Dog</code>. This is just using type assertion to get the underlying value of Dog. But creating a new instance for struct and then using it to call the methods is the same like creating an instance of Dog and using it directly rather than creating an instance of struct from underlying value of <code>Animal</code> interface"}, {"owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 0, "creation_date": 1533137741, "post_id": 51625437, "comment_id": 90238849, "body": "Thanks for the explanation. <code>d := dog.(*Dog)</code> is equivalent to <code>d := &amp;Dog{}</code> right?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 1, "creation_date": 1533142445, "post_id": 51625437, "comment_id": 90241563, "body": "@Bharat that&#39;s right both are creating an instance of struct Dog which will be used for calling the methods with Dog struct as receiver."}, {"owner": {"reputation": 66, "user_id": 10163689, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z7cJI5HzQIs/AAAAAAAAAAI/AAAAAAAAACY/XjfwX3wL-9M/photo.jpg?sz=128", "display_name": "shal", "link": "https://stackoverflow.com/users/10163689/shal"}, "reply_to_user": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 0, "creation_date": 1533190298, "post_id": 51625437, "comment_id": 90256924, "body": "@Bharat,@Himanshu I don&#39;t think <code>d := dog.(*Dog)</code> will create an instance of struct Dog. <code>d</code> and <code>dog</code> are point to the same address. On Playground: <a href=\"https://play.golang.org/p/eWBawUhhy22\" rel=\"nofollow noreferrer\">play.golang.org/p/eWBawUhhy22</a>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533221884, "post_id": 51625437, "comment_id": 90276966, "body": "@shal <code>d := dog.(*Dog)</code> this is using type Assertion for Animal interface which is pointing to the same address. In Golang you create a variable using <code>:=</code> operator which is called short variable declaration."}], "tags": [], "owner": {"reputation": 66, "user_id": 10163689, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z7cJI5HzQIs/AAAAAAAAAAI/AAAAAAAAACY/XjfwX3wL-9M/photo.jpg?sz=128", "display_name": "shal", "link": "https://stackoverflow.com/users/10163689/shal"}, "is_accepted": false, "score": 4, "last_activity_date": 1533116596, "last_edit_date": 1533116596, "creation_date": 1533098415, "answer_id": 51625437, "question_id": 51623856, "link": "https://stackoverflow.com/questions/51623856/non-interface-methods-in-interface-implementation/51625437#51625437", "title": "Non-interface methods in interface implementation", "body": "<p>This may help you.</p>\n\n<pre><code>d := dog.(*Dog)\nd.WagTail()\n</code></pre>\n\n<p>On Playground: <a href=\"https://play.golang.org/p/KlNqpmvFTJi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KlNqpmvFTJi</a></p>\n"}, {"comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533114271, "post_id": 51627320, "comment_id": 90222839, "body": "<code>type assertion and&#47;or type conversion</code> are way too different they are not same. Please check more information for type assertion. Go does not works like java."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533114361, "post_id": 51627320, "comment_id": 90222894, "body": "And OP didnot require to type assert the interface. OP wants to implement the method using same struct method receiver."}, {"owner": {"reputation": 1976, "user_id": 91362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7uY2.jpg?s=128&g=1", "display_name": "edwardsmatt", "link": "https://stackoverflow.com/users/91362/edwardsmatt"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533115574, "post_id": 51627320, "comment_id": 90223670, "body": "@Himanshu the intention of my answer was to further describe how the OP <code>could have a struct adhere to an interface and also define it&#39;s own methods</code>. I clarified the section which appears to have caught your attention."}], "tags": [], "owner": {"reputation": 1976, "user_id": 91362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7uY2.jpg?s=128&g=1", "display_name": "edwardsmatt", "link": "https://stackoverflow.com/users/91362/edwardsmatt"}, "is_accepted": false, "score": 2, "last_activity_date": 1533116377, "last_edit_date": 1533116377, "creation_date": 1533107375, "answer_id": 51627320, "question_id": 51623856, "link": "https://stackoverflow.com/questions/51623856/non-interface-methods-in-interface-implementation/51627320#51627320", "title": "Non-interface methods in interface implementation", "body": "<p>You can definitely do it, one such method is using type assertion as shown in the other answer <a href=\"https://stackoverflow.com/a/51625437/91362\">here</a>. Otherwise the answer by @Himanshu <a href=\"https://stackoverflow.com/a/51627346/91362\">here</a> describes the situation very well.</p>\n\n<p>I would like to add to the discussion to further describe how you </p>\n\n<blockquote>\n  <p>could have a struct adhere to an interface and also define it's own methods</p>\n</blockquote>\n\n<p>The <code>MakeDog</code> method returns an Animal, and there are a number of reasons you may consider returning a <code>Dog</code> (or whichever concrete type) directly.</p>\n\n<p>The reason I bring this up is because of something someone told me about creating methods when I first started programming in Go:</p>\n\n<blockquote>\n  <p>Accept an Interface and return a Concrete type (such as a Struct)</p>\n</blockquote>\n\n<p>Interfaces can accept any concrete type. That's  why they are used when you don't know the type of argument you are passing to the function.</p>\n\n<p>I did a google search with the following terms and quite a few articles turned up</p>\n\n<blockquote>\n  <p>golang accept interface, return struct</p>\n</blockquote>\n\n<p>For example: <a href=\"https://mycodesmells.com/post/accept-interfaces-return-struct-in-go\" rel=\"nofollow noreferrer\">https://mycodesmells.com/post/accept-interfaces-return-struct-in-go</a> and <a href=\"http://idiomaticgo.com/post/best-practice/accept-interfaces-return-structs/\" rel=\"nofollow noreferrer\">http://idiomaticgo.com/post/best-practice/accept-interfaces-return-structs/</a></p>\n\n<p>I have put together a little bit of a demo extending on your concepts in your question to try and clearly describe interface methods as well as methods and attributes for specific types</p>\n\n<p>Taken from <a href=\"https://play.golang.org/p/-A6bIISx3Ej\" rel=\"nofollow noreferrer\" title=\"Link to Playground Snippet\">this snippet on Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Animal interface {\n    MakeNoise() string\n}\n\n// printNoise accepts any animal and prints it's noise\nfunc printNoise(a Animal) {\n    fmt.Println(a.MakeNoise())\n}\n\ntype pet struct {\n    nLegs int\n    color string\n}\n\n// describe is available to all types of Pet, but not for an animal\nfunc (p pet) describe() string {\n    return fmt.Sprintf(`My colour is \"%s\", and I have \"%d\" legs`, p.color, p.nLegs)\n}\n\ntype Dog struct {\n    pet\n    favouriteToy string\n}\n\n// MakeNoise implements the Animal interface for type Dog\nfunc (Dog) MakeNoise() string {\n    return \"Bark!\"\n}\n\n// WagTail is something only a Dog can do\nfunc (d Dog) WagTail() {\n    fmt.Println(\"I am a dog,\", d.pet.describe(), \": Wags Tail\")\n}\n\ntype Cat struct {\n    pet\n    favouriteSleepingPlace string\n}\n\n// MakeNoise implements the Animal interface for type Cat\nfunc (Cat) MakeNoise() string {\n    return \"Meow!\"\n}\n\n// ArchBack is something only a Cat can do\nfunc (c Cat) ArchBack() {\n    fmt.Println(\"I am a cat,\", c.pet.describe(), \": Arches Back\")\n}\n\ntype Bird struct {\n    pet\n    favoritePerch string\n}\n\n// MakeNoise implements the Animal interface for type Cat\nfunc (Bird) MakeNoise() string {\n    return \"Tweet!\"\n}\n\n// Hop is something only a Bird can do\nfunc (c Bird) Hop() {\n    fmt.Println(\"I am a bird,\", c.pet.describe(), \": Hops to a different perch\")\n}\n\nfunc main() {\n    dog := Dog{\n        pet:          pet{nLegs: 4, color: \"Brown\"},\n        favouriteToy: \"Ball\",\n    }\n    printNoise(dog)\n    dog.WagTail()\n\n    cat := Cat{\n        pet: pet{nLegs: 4, color: \"Tabby\"},\n        favouriteSleepingPlace: \"Sofa\",\n    }\n    printNoise(cat)\n    cat.ArchBack()\n\n    bird := Bird{\n        pet:           pet{nLegs: 2, color: \"Rainbow\"},\n        favoritePerch: \"Back of Cage\",\n    }\n\n    printNoise(bird)\n    bird.Hop()\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 0, "creation_date": 1533135739, "post_id": 51627346, "comment_id": 90237514, "body": "So, I could do the compile time check and simply return a *Dog instead of Animal in NewDog() right? If I have to explicitly declare, then I will only be able to call the methods in the interface and not in the struct."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 1, "creation_date": 1533136134, "post_id": 51627346, "comment_id": 90237786, "body": "@Bharat that&#39;s absolutely right. You can return *Dog struct by which you can access any method which has *Dog struct as receiver."}, {"owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 0, "creation_date": 1533144460, "post_id": 51627346, "comment_id": 90242540, "body": "Marking this answer as accepted though @shal&#39;s answer is also useful since this one has more explanation."}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 3, "last_activity_date": 1533130496, "last_edit_date": 1533130496, "creation_date": 1533107458, "answer_id": 51627346, "question_id": 51623856, "link": "https://stackoverflow.com/questions/51623856/non-interface-methods-in-interface-implementation/51627346#51627346", "title": "Non-interface methods in interface implementation", "body": "<p>The error described it all:</p>\n\n<blockquote>\n  <p>dog.WagTail undefined (type Animal has no field or method WagTail)</p>\n</blockquote>\n\n<p>To implement an interface you should implement all methods defined inside it.</p>\n\n<pre><code>dog := NewDog(\"Brown\")\ndog.MakeNoise()\ndog.WagTail()\n</code></pre>\n\n<p>Now <code>NewDog</code> returns Animal interface which contains <code>MakeNoise</code> method but not <code>WagTail</code>. </p>\n\n<p>The only way to manage your requirement is either create a variable of struct type <code>Dog</code> and then you can call any method having Dog as receiver.</p>\n\n<pre><code>d := &amp;Dog{\"Brown\"}\nd.WagTail()\n</code></pre>\n\n<p>Or you can return the pointer to <code>Dog</code> struct from <code>NewDog</code> method just like you did in your code mentioned in the comment as:</p>\n\n<pre><code>func NewDog(color string) *Dog {\n    return &amp;Dog{color}\n}\n</code></pre>\n\n<p>But if the method is not defined in interface you cannot implement it using the struct as method receiver.</p>\n\n<p>Golang provides a way in which:</p>\n\n<blockquote>\n  <p>You can ask the compiler to check that the type T implements the\n  interface I by attempting an assignment using the zero value for T or\n  pointer to T, as appropriate</p>\n</blockquote>\n\n<pre><code>type T struct{}\nvar _ I = T{}       // Verify that T implements I.\nvar _ I = (*T)(nil) // Verify that *T implements I.\n</code></pre>\n\n<p>If T (or *T, accordingly) doesn't implement I, the mistake will be caught at compile time.</p>\n\n<blockquote>\n  <p>If you wish the users of an interface to explicitly declare that they\n  implement it, you can add a method with a descriptive name to the\n  interface's method set. For example:</p>\n</blockquote>\n\n<pre><code>type Fooer interface {\n    Foo()\n    ImplementsFooer()\n}\n</code></pre>\n\n<p>A type must then implement the ImplementsFooer method to be a Fooer, clearly documenting the fact and announcing it in godoc's output.</p>\n\n<pre><code>type Bar struct{}\nfunc (b Bar) ImplementsFooer() {}\nfunc (b Bar) Foo() {}\n</code></pre>\n\n<blockquote>\n  <p>Most code doesn't make use of such constraints, since they limit the\n  utility of the interface idea. Sometimes, though, they're necessary to\n  resolve ambiguities among similar interfaces.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 14504605, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Ghqljwc2HpkEv_gzXh9psFwGgvsBSHSN4I1JQZ9PQ=k-s128", "display_name": "Ugbun", "link": "https://stackoverflow.com/users/14504605/ugbun"}, "is_accepted": false, "score": 1, "last_activity_date": 1604240722, "last_edit_date": 1604240722, "creation_date": 1604226886, "answer_id": 64630898, "question_id": 51623856, "link": "https://stackoverflow.com/questions/51623856/non-interface-methods-in-interface-implementation/64630898#64630898", "title": "Non-interface methods in interface implementation", "body": "<p>Yes, you can run methods that are not part of the interface. There were two issues in the code preventing it from running properly.</p>\n<ol>\n<li>The function NewDog returns the type Animal. The WagTale method is attached to Dog not Animal which gave an error. The return type has been changed to Dog.</li>\n<li>Pointers are not needed in this code and have been removed.</li>\n</ol>\n<p>After these adjustments, the code runs and properly and all methods execute as expected.</p>\n<p>Link on Go playground: <a href=\"https://play.golang.org/p/LYZJiQND7WW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LYZJiQND7WW</a></p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\n\ntype Animal interface {\n    MakeNoise()\n}\n\ntype Dog struct {\n    color string\n}\n\n/* Interface implementation */\n\nfunc (d Dog) MakeNoise() {\n    fmt.Println(&quot;Bark!&quot;)\n}\n\n/* End Interface implementation */\n\nfunc (d Dog) WagTail() {\n    fmt.Println(d.color + &quot; dog: Wag wag&quot;)\n}\n\nfunc NewDog(color string) Dog {\n    return Dog{color}\n}\n\nfunc main() {\n    dog := NewDog(&quot;Brown&quot;)\n    dog.MakeNoise()\n    dog.WagTail()\n    \n}\n</code></pre>\n"}], "owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1347, "favorite_count": 0, "accepted_answer_id": 51627346, "answer_count": 4, "score": 2, "last_activity_date": 1604240722, "creation_date": 1533084065, "last_edit_date": 1533115411, "question_id": 51623856, "link": "https://stackoverflow.com/questions/51623856/non-interface-methods-in-interface-implementation", "title": "Non-interface methods in interface implementation", "body": "<p>I have an interface which defines a method. I have a struct which <em>implements</em> this interface. In it, I have implemented the methods from this interface and also have additional methods defined. </p>\n\n<p>For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)   \n\ntype Animal interface {\n    MakeNoise()\n}\n\ntype Dog struct {\n    color string\n}\n\n/* Interface implementation */\n\nfunc (d *Dog) MakeNoise() {\n    fmt.Println(\"Bark!\")\n}\n\n/* End Interface implementation */\n\nfunc (d *Dog) WagTail() {\n    fmt.Println(d.color + \" dog: Wag wag\")\n}\n\nfunc NewDog(color string) Animal {\n    return &amp;Dog{color}\n}\n\nfunc main() {\n    dog := NewDog(\"Brown\")\n    dog.MakeNoise()\n    dog.WagTail()\n\n}\n</code></pre>\n\n<p>On Playground: <a href=\"https://play.golang.org/p/B1GgoNToNl_l\" rel=\"nofollow noreferrer\">https://play.golang.org/p/B1GgoNToNl_l</a></p>\n\n<p>Here, WagTail() is not part of the Animal interface but belongs to the Dog struct. Running this code gives an error </p>\n\n<blockquote>\n  <p>dog.WagTail undefined (type Animal has no field or method WagTail).</p>\n</blockquote>\n\n<p>Is there a way I could have a struct adhere to an interface and also define it's own methods? </p>\n"}, {"tags": ["unit-testing", "testing", "go", "code-coverage", "go-packages"], "comments": [{"owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "edited": false, "score": 1, "creation_date": 1533091401, "post_id": 51623755, "comment_id": 90214251, "body": "So after testing this I thought the same thing but it is looking like when I hit the dropdown and switch to mypackage_adding.go, f2() is covered. It is just in a different file. Just change the file in the dropdown in the html page."}, {"owner": {"reputation": 548, "user_id": 5345652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZdgGaohbRX0/AAAAAAAAAAI/AAAAAAAAAAA/65laXilEcK8/photo.jpg?sz=128", "display_name": "Sharon Katz", "link": "https://stackoverflow.com/users/5345652/sharon-katz"}, "reply_to_user": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "edited": false, "score": 0, "creation_date": 1533130596, "post_id": 51623755, "comment_id": 90233733, "body": "You are absolutely right. Works well."}], "answers": [{"tags": [], "owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "is_accepted": true, "score": 1, "last_activity_date": 1533309100, "creation_date": 1533309100, "answer_id": 51675583, "question_id": 51623755, "link": "https://stackoverflow.com/questions/51623755/how-to-get-coverage-for-multiple-files-in-golang/51675583#51675583", "title": "How to get coverage for multiple files in GOLANG", "body": "<p>Just reiterating what is in my comment</p>\n\n<p>So after testing this I thought the same thing but it is looking like when I hit the dropdown and switch to mypackage_adding.go, f2() is covered. It is just in a different file. Just change the file in the dropdown in the HTML page.</p>\n"}], "owner": {"reputation": 548, "user_id": 5345652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZdgGaohbRX0/AAAAAAAAAAI/AAAAAAAAAAA/65laXilEcK8/photo.jpg?sz=128", "display_name": "Sharon Katz", "link": "https://stackoverflow.com/users/5345652/sharon-katz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 51675583, "answer_count": 1, "score": 1, "last_activity_date": 1533309100, "creation_date": 1533083048, "last_edit_date": 1533084309, "question_id": 51623755, "link": "https://stackoverflow.com/questions/51623755/how-to-get-coverage-for-multiple-files-in-golang", "title": "How to get coverage for multiple files in GOLANG", "body": "<p>I have a package in GO-LANG that has several files implementing it. (all files are in the same directory)</p>\n\n<pre><code>file1: mypackage.go\npackage mypackage\nfunc f1 () {}\n\nfile2: mypackage_addition.go\npackage mypackage\nfunc f2 () {}\n\nfile3: mypackage_test.go\npackage mypackage\nimport \"testing\"\nfunc TestF1 (t *testing.T) { \n    f1()\n}\n\nfile4: mypackageAddition_test.go\npackage mypackage\nimport \"testing\"\nfunc TestF2 (t *testing.T) { \n    f2()\n}\n</code></pre>\n\n<p>I do this in order to get coverage:</p>\n\n<pre><code>mypackage&gt; $ tree\n.\n\u251c\u2500\u2500 mypackage.go\n\u251c\u2500\u2500 mypackageAddition_test.go\n\u251c\u2500\u2500 mypackageAdditions.go\n\u2514\u2500\u2500 mypackage_test.go\n\n0 directories, 4 files\nmypackage&gt; $ go test -v -coverprofile cover.out ./...\n=== RUN   TestF2\n--- PASS: TestF2 (0.00s)\n=== RUN   TestF1\n--- PASS: TestF1 (0.00s)\nPASS\ncoverage: 0.0% of statements\nok      github.com/MyDevelopment/mypackage  0.701s  coverage: 0.0% of statements\nmypackage&gt; $ go tool cover -html=cover.out -o cover.html\nmypackage&gt; $ open cover.html \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ydVD9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ydVD9.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/ly7yU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ly7yU.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I open the html, I only get coverage for f1().<br>\nf2 is called (I verified it in debug), and the run of f2 is represented in the text, but not in the html file.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 1, "creation_date": 1533075960, "post_id": 51622959, "comment_id": 90211141, "body": "This is assuming I didn&#39;t want to modify the existing library, but I&#39;m quite happy to fork the repo and update the repo in place, is there a way to do that?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 1, "creation_date": 1533076092, "post_id": 51622959, "comment_id": 90211171, "body": "@jaxxstorm if they accept your PR, then sure. Simply change their <code>NewIncidentUpdate</code> to include the status changes map and update the <code>String</code> method (and any other method that might be affected -- I haven&#39;t scoured the repo) accordingly. (and good on you for contributing to existing projects!)"}, {"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 1, "creation_date": 1533084293, "post_id": 51622959, "comment_id": 90212863, "body": "Thanks for the fantastic answer, really appreciated!"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1533075881, "creation_date": 1533075881, "answer_id": 51622959, "question_id": 51622733, "link": "https://stackoverflow.com/questions/51622733/mapstringstring-inside-a-struct/51622959#51622959", "title": "map[string]string inside a struct", "body": "<p>You could embed a <code>NewIncidentUpdate</code> inside your own struct that defines the component status changes.</p>\n\n<pre><code>type MyIncidentUpdate struct {\n    NewIncidentUpdate\n    ComponentStatusChanges map[string]string\n}\n</code></pre>\n\n<p>then define <code>String</code> the same way, while accomodating for your <code>ComponentStatusChanges</code> map.</p>\n\n<pre><code>func (i *MyIncidentUpdate) String() string {\n    params := map[string]interface{}{\n        \"incident[name]\":                 i.Name,\n        \"incident[status]\":               i.Status,\n        \"incident[message]\":              i.Message,\n        \"incident[wants_twitter_update]\": i.WantsTwitterUpdate,\n        \"incident[impact_override]\":      i.ImpactOverride,\n        \"incident[component_ids]\":        i.ComponentIDs,\n    }\n    for k, val := range i.ComponentStatusChanges {\n        key := fmt.Sprintf(\"incident[components][%s]\", k)\n        params[key] = val\n    }\n\n    return encodeParams(params)\n}\n</code></pre>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 51622959, "answer_count": 1, "score": 0, "last_activity_date": 1533075881, "creation_date": 1533074575, "question_id": 51622733, "link": "https://stackoverflow.com/questions/51622733/mapstringstring-inside-a-struct", "title": "map[string]string inside a struct", "body": "<p>Apologies for the title, but this is a weird one and out of my ability to understand.</p>\n\n<p>I'm working with a go library that's sort of finished, but sort of not:</p>\n\n<p><a href=\"https://github.com/yfronto/go-statuspage-api\" rel=\"nofollow noreferrer\">https://github.com/yfronto/go-statuspage-api</a></p>\n\n<p>The statuspage.io API supports the following params when posting an incident:</p>\n\n<pre><code>incident[components][component_id] - Map of status changes to apply to affected components.\n</code></pre>\n\n<p>An example would be:</p>\n\n<pre><code>\"incident[components][ftgks51sfs2d]=degraded_performance\"\n</code></pre>\n\n<p>Unfortunately, the struct defined in the library <a href=\"https://github.com/yfronto/go-statuspage-api/blob/master/incident.go#L116-L134\" rel=\"nofollow noreferrer\">doesn't support that particular field</a>:</p>\n\n<pre><code>type NewIncidentUpdate struct {\n    Name               string\n    Status             string\n    Message            string\n    WantsTwitterUpdate bool\n    ImpactOverride     string\n    ComponentIDs       []string\n}\n\nfunc (i *NewIncidentUpdate) String() string {\n    return encodeParams(map[string]interface{}{\n        \"incident[name]\":                 i.Name,\n        \"incident[status]\":               i.Status,\n        \"incident[message]\":              i.Message,\n        \"incident[wants_twitter_update]\": i.WantsTwitterUpdate,\n        \"incident[impact_override]\":      i.ImpactOverride,\n        \"incident[component_ids]\":        i.ComponentIDs,\n    })\n}\n</code></pre>\n\n<p>How can I update this struct (and <a href=\"https://github.com/yfronto/go-statuspage-api/blob/master/http_helper.go#L69-L112\" rel=\"nofollow noreferrer\">the associated encodeParams function</a>) to support passing an arbitrary map of components and associated statuses?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 9, "creation_date": 1533071541, "post_id": 51622113, "comment_id": 90209717, "body": "fmt is supposed to format your code nicely, not to fix your syntax mistakes."}, {"owner": {"reputation": 9672, "user_id": 1460955, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8259b91a7595aae684de9b52cf52621?s=128&d=identicon&r=PG", "display_name": "exts", "link": "https://stackoverflow.com/users/1460955/exts"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1533071718, "post_id": 51622113, "comment_id": 90209778, "body": "@tkausl can you respond as an answer not a comment so I can select it an answered."}], "answers": [{"comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 1, "creation_date": 1533133640, "post_id": 51622208, "comment_id": 90236008, "body": "It&#39;ll also allow stuff to sit on a single line, e.g. <code>func main() { fmt.Println() }</code> or <code>if err != nil { return err } else { fmt.Println(&quot;all okay&quot;) }</code>"}, {"owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "edited": false, "score": 0, "creation_date": 1538918271, "post_id": 51622208, "comment_id": 92304694, "body": "Aaarg. Nothing like that mentioned in the introductory tutorials that I saw."}], "tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": true, "score": 9, "last_activity_date": 1533071878, "creation_date": 1533071878, "answer_id": 51622208, "question_id": 51622113, "link": "https://stackoverflow.com/questions/51622113/does-golangs-go-fmt-not-format-brackets/51622208#51622208", "title": "Does golang&#39;s go fmt not format brackets?", "body": "<p>Go has some very strong opinions about what a valid code is.<br>\nThis is one of the cases. Unlike many other C-family languages that allow putting curly bracket of function body declaration on the same line or on the next line (or even ten lines after, if you fancy), Go compiler allows it to be put only on the same line.  </p>\n\n<p>Another example is the else statement. Where in other languages </p>\n\n<pre><code>if {\n}\nelse {\n}\n</code></pre>\n\n<p>May be valid or even preferred, in Go only compiling else statement is of the form</p>\n\n<pre><code>if {\n} else {\n}\n</code></pre>\n\n<p>The <code>go fmt</code> will fix empty or missing spaces though:</p>\n\n<pre><code>func main()             {\n    fmt.Println(\"Hello, playground\")\n}\n\nfunc main(){\n   fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>Will both become</p>\n\n<pre><code>func main() {\n   fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n"}], "owner": {"reputation": 9672, "user_id": 1460955, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8259b91a7595aae684de9b52cf52621?s=128&d=identicon&r=PG", "display_name": "exts", "link": "https://stackoverflow.com/users/1460955/exts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 51622208, "answer_count": 1, "score": 4, "last_activity_date": 1533071878, "creation_date": 1533071366, "question_id": 51622113, "link": "https://stackoverflow.com/questions/51622113/does-golangs-go-fmt-not-format-brackets", "title": "Does golang&#39;s go fmt not format brackets?", "body": "<p>So I've been trying to use golang again and I remembered go has a formatting tool to clean up your source. So When I run <code>go fmt</code> on my project the following error gets spit out:</p>\n\n<p><code>expected declaration, found '{'</code></p>\n\n<p>I was expecting go fmt to fix my brackets to respect go's syntax requirements, but it just spits out an error. Is this intended functionality or is it supposed to actually put the bracket on the correct line (same line as the function declaration)?</p>\n\n<p>Basic code in question that I was expecting to be properly formatted:</p>\n\n<pre><code>package main\n\nfunc main()\n{\n    println(\"Learning go again\")\n}\n</code></pre>\n"}, {"tags": ["for-loop", "go", "while-loop"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1533073142, "post_id": 51622033, "comment_id": 90210233, "body": "You can always <code>break</code>..."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1533090248, "post_id": 51622033, "comment_id": 90213993, "body": "Your oversimplified code makes very little sense: <code>if ele == &quot;.&quot;</code> this condition would never be <code>true</code>."}, {"owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1533131173, "post_id": 51622033, "comment_id": 90234139, "body": "@zerkms my bad, added more code to make some sense"}], "answers": [{"tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": false, "score": 1, "last_activity_date": 1533246885, "last_edit_date": 1533246885, "creation_date": 1533090077, "answer_id": 51624540, "question_id": 51622033, "link": "https://stackoverflow.com/questions/51622033/better-way-to-write-while-for-in-golang/51624540#51624540", "title": "Better way to write while (for) in golang", "body": "<p>This is slightly different way to perform the same task.</p>\n\n<p>UPDATE: Updated answer to reflect the new requirements.</p>\n\n<pre><code>ele := path.Dir(str)\nif ele == \".\" {\n    return\n}\nfor ele != \".\" {\n    functionA()\n    ele = path.Dir(ele)\n}\nfunctionA()\nfunctionB()\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/KbIH7s45aFR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KbIH7s45aFR</a></p>\n"}], "owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533246885, "creation_date": 1533071019, "last_edit_date": 1533140660, "question_id": 51622033, "link": "https://stackoverflow.com/questions/51622033/better-way-to-write-while-for-in-golang", "title": "Better way to write while (for) in golang", "body": "<p>I am working on a while loop which a for in Go as in below code   </p>\n\n<pre><code>ele = path.Dir(str)\nfor ele != \".\" {\n    functionA()\n    ele = path.Dir(ele)\n    if ele == \".\" {\n        functionA()\n        functionB()\n    }\n}\n</code></pre>\n\n<p>In the above code as you can see I am calling functionA twice based on a condition inside the while (for)</p>\n\n<p><strong>Is there a better and cleaner way to do this?</strong></p>\n"}, {"tags": ["sorting", "go", "slice"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1533071160, "post_id": 51622019, "comment_id": 90209573, "body": "I think your best bet would be to write a custom type that satisfies the <code>sort.Interface</code> type. More info is in the <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\">package documentation</a>."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 4, "last_activity_date": 1533074970, "last_edit_date": 1533074970, "creation_date": 1533073337, "answer_id": 51622527, "question_id": 51622019, "link": "https://stackoverflow.com/questions/51622019/sorting-int-slice-in-golang/51622527#51622527", "title": "sorting int slice in golang", "body": "<p>One approach would be to use <a href=\"https://golang.org/pkg/sort/#Slice\" rel=\"nofollow noreferrer\"><code>sort.Slice(...)</code></a> with a \"less\" (comparator) function that simply returns the lesser of the distance of the two given values from the target value.</p>\n\n<p>For example (<a href=\"https://play.golang.com/p/ABJp-LoIIRQ\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>func main() {\n  xs := []int{2781, 4706, 1347, 1192, 3087, 2920, 198, 2312, 930, 3284, 1677, 3687, 2011, 4107, 4148, 4195, 2159, 1263, 2918, 2503}\n  sortByDistanceFrom(1200, xs)\n  fmt.Println(xs)\n  // [1192 1263 1347 930 1677 2011 2159 198 2312 2503 2781 2918 2920 3087 3284 3687 4107 4148 4195 4706]\n\n}\n\nfunc sortByDistanceFrom(x int, xs []int) {\n  sort.Slice(xs, func(i, j int) bool {\n    di := math.Abs(float64(x - xs[i]))\n    dj := math.Abs(float64(x - xs[j]))\n    return di &lt; dj\n  })\n}\n</code></pre>\n\n<p>Note that the fourth value returned by this example is 930 instead of 1677 produced by your sample output because it computes the absolute distance to the target number (<code>|1200-1677|=433 &gt; |1200-930|=270</code>). If you want to prefer values greater than the target to values less than the target then you would have to modify your comparator function accordingly.</p>\n"}], "owner": {"reputation": 7, "user_id": 8066959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209744486665068/picture?type=large", "display_name": "Reinaldo Villasmil", "link": "https://stackoverflow.com/users/8066959/reinaldo-villasmil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "accepted_answer_id": 51622527, "answer_count": 1, "score": 0, "last_activity_date": 1533088817, "creation_date": 1533070987, "last_edit_date": 1533088817, "question_id": 51622019, "link": "https://stackoverflow.com/questions/51622019/sorting-int-slice-in-golang", "title": "sorting int slice in golang", "body": "<p>say I have an int slice containing the following numbers: 2781,4706,1347,1192,3087,2920,198,2312,930,3284,1677,3687,2011,4107,4148,4195,2159,1263,2918,2503</p>\n\n<p>I want to sort them based on how close they are away from a certain value.\nFor example, say my value was 1200.</p>\n\n<p>My slice after being sorted would be: 1192,1263,1347,1677,2011,2159,2312,2503,2781,2918,2920,3087,3284,3687,4107,4148,4195,4706,930,198</p>\n\n<p>I tried the approach of iterating through the array, subtracting my  specified value, then sorting in ascending order ultimately adding the value again to return to my original number. This approach wouldn't work in all test cases, and I know its bad practice since I'm mutating the array.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1533065380, "post_id": 51620432, "comment_id": 90206922, "body": "Under what circumstance? Some context might be helpful here."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1533065896, "creation_date": 1533065896, "answer_id": 51620872, "question_id": 51620432, "link": "https://stackoverflow.com/questions/51620432/how-can-i-create-an-empty-sql-rows-instance/51620872#51620872", "title": "How can I create an empty sql.Rows instance?", "body": "<p>I would handle this a little differently, and just pass in the handler to your function.  So if your function is currently:</p>\n\n<pre><code>func YourFunc() (*sql.Rows, error) {\n    // ...\n    if (...) {\n        return nil, nil\n    }\n    return rows, nil\n}\n</code></pre>\n\n<p>It would have it be:</p>\n\n<pre><code>func yourFunc() (*sql.Rows, error) {\n    // ...\n    if (...) {\n        return nil, sql.ErrNoRows\n    }\n    return rows, nil\n}\n\nfunc YourFunc(cb func(*sql.Rows)) error {\n    rows, err := yourFunc()\n    if err == sql.ErrNoRows {\n        return nil\n    }\n    if err != nil {\n        return err\n    }\n    cb(rows)\n    return nil\n}\n</code></pre>\n\n<p>And then in your caller:</p>\n\n<pre><code>err := YourFunc(func(row *sql.Rows) {\n    for rows.Next() {\n        // ...\n    }\n})\n</code></pre>\n\n<p>This will have the function you pass only get called if there are rows, you get the error if it's one you care about, and the caller's syntax is pretty clean.</p>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 51620872, "answer_count": 1, "score": 2, "last_activity_date": 1533065896, "creation_date": 1533064141, "question_id": 51620432, "link": "https://stackoverflow.com/questions/51620432/how-can-i-create-an-empty-sql-rows-instance", "title": "How can I create an empty sql.Rows instance?", "body": "<p>I have a function that returns <code>(*sql.Rows, error)</code> in Go. Under some circumstances, there's nothing to return, but also no error. The choices seems to be:</p>\n\n<pre><code>if (...) {\n    return nil, nil\n}\n</code></pre>\n\n<p>and then, in the caller:</p>\n\n<pre><code>rows, err := fn()\nif err != nil {\n    return nil, err\n}\n\nif rows == nil {\n   ...\n} else {\n    for rows.Next() {\n    ...\n    }\n}\n</code></pre>\n\n<p>or else returning a special error which I then check for. I think it would be a lot more elegant if I could return a valid Rows instance, but that does nothing but return false when its <code>Next()</code> method is called, like this:</p>\n\n<pre><code>if (...) {\n    return EmptyRows(), nil\n}\n</code></pre>\n\n<p>and, in the caller:</p>\n\n<pre><code>rows, err := fn()\nif err != nil {\n    return nil, err\n}\n\nfor rows.Next() {\n    ...\n}\n</code></pre>\n\n<p>I could do something like:</p>\n\n<pre><code>if (...) {\n    return db.QueryRows(\"select * from something where true=false\"), nil\n}\n</code></pre>\n\n<p>but that seems pretty goofy. Any recommendations?</p>\n"}, {"tags": ["go", "recursion", "channel", "goroutine"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1533067362, "post_id": 51620244, "comment_id": 90207851, "body": "is this faster ?"}, {"owner": {"reputation": 4735, "user_id": 5270744, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/kPNwH.jpg?s=128&g=1", "display_name": "m_callens", "link": "https://stackoverflow.com/users/5270744/m-callens"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1533067475, "post_id": 51620244, "comment_id": 90207928, "body": "@mh-cbon I did a speed comparison with the standard recursive function with a <code>node_modules</code> folder because that&#39;s a black hole of files and the concurrent model was neck-and-neck with the recursive model, so it appears there&#39;s no real benefit right now"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1533067749, "post_id": 51620244, "comment_id": 90208075, "body": "yeah, the work you have paralelized is too small to get any benefits in regards of the number of added contention. I suspect that if you have very very large tree, having only two/four routine counting different major branches might give better results. sorry for the preliminary fake question."}], "answers": [{"comments": [{"owner": {"reputation": 4735, "user_id": 5270744, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/kPNwH.jpg?s=128&g=1", "display_name": "m_callens", "link": "https://stackoverflow.com/users/5270744/m-callens"}, "edited": false, "score": 0, "creation_date": 1533063840, "post_id": 51620321, "comment_id": 90206212, "body": "moving the <code>wg.Done()</code> call for the accumulator inside the loop would treat each iteration as a separate goroutine which isn&#39;t the case. It would give a negative counter for the WaitGroup"}, {"owner": {"reputation": 4735, "user_id": 5270744, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/kPNwH.jpg?s=128&g=1", "display_name": "m_callens", "link": "https://stackoverflow.com/users/5270744/m-callens"}, "edited": false, "score": 0, "creation_date": 1533064025, "post_id": 51620321, "comment_id": 90206295, "body": "The suggestions in your edit worked for the most part, but I have inconsistent performance because of the way that i <code>defer close(ch)</code>. Is that unnecessary?"}, {"owner": {"reputation": 4735, "user_id": 5270744, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/kPNwH.jpg?s=128&g=1", "display_name": "m_callens", "link": "https://stackoverflow.com/users/5270744/m-callens"}, "edited": false, "score": 0, "creation_date": 1533064218, "post_id": 51620321, "comment_id": 90206379, "body": "I ended up having to place <code>close(ch)</code> inside a separate closure with the initial call to <code>count</code> and now its consistent"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1533063845, "last_edit_date": 1533063845, "creation_date": 1533063656, "answer_id": 51620321, "question_id": 51620244, "link": "https://stackoverflow.com/questions/51620244/count-tree-leaves-concurrently/51620321#51620321", "title": "Count Tree Leaves Concurrently", "body": "<p>I'm pretty sure your <code>WaitGroup</code> is just never getting enough <code>wg.Done</code> calls:</p>\n\n<pre><code>go func(total *int) {\n    for x := range ch {\n        fmt.Println(x)\n        *total += x\n    }\n    wg.Done()\n}(&amp;total)\n</code></pre>\n\n<p>Since you never close <code>ch</code>, the <code>wg.Done</code> will never be called here.  I <em>think</em> if you move it inside the loop:</p>\n\n<pre><code>go func(total *int) {\n    for x := range ch {\n        fmt.Println(x)\n        *total += x\n         wg.Done()\n    }\n}(&amp;total)\n</code></pre>\n\n<p>That will resolve the issue.</p>\n\n<p>EDIT:</p>\n\n<p>Actually, I think there is one more issue:</p>\n\n<pre><code>defer wg.Done()\nch &lt;- len(t.Leaves)\nif t.SubTrees != nil {\n    wg.Add(len(t.SubTrees))\n    for _, s := range t.SubTrees {\n        go count(s, false, ch, wg)\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>The defered <code>wg.Done()</code> won't get called until you return, so this <code>wg.Wait()</code> will also wait forever.  This hsould probable be:</p>\n\n<pre><code>ch &lt;- len(t.Leaves)\nif t.SubTrees != nil {\n    wg.Add(len(t.SubTrees))\n    for _, s := range t.SubTrees {\n        go count(s, false, ch, wg)\n    }\n    wg.Done()\n    wg.Wait()\n} else {\n    wg.Done()\n}\n</code></pre>\n"}], "owner": {"reputation": 4735, "user_id": 5270744, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/kPNwH.jpg?s=128&g=1", "display_name": "m_callens", "link": "https://stackoverflow.com/users/5270744/m-callens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 51620321, "answer_count": 1, "score": 0, "last_activity_date": 1533063845, "creation_date": 1533063324, "question_id": 51620244, "link": "https://stackoverflow.com/questions/51620244/count-tree-leaves-concurrently", "title": "Count Tree Leaves Concurrently", "body": "<p>There is a function that I want to write using a concurrency model in case the input is too large and parallel processing would be more efficient but it never ends.</p>\n\n<p>Assuming there is a <code>struct</code> defined as:</p>\n\n<pre><code>type Tree struct {\n    Name     string   `json:\"name\"`\n    SubTrees []*Tree  `json:\"subTrees,omitempty\"`\n    Leaves   []string `json:\"leaves\"`\n}\n</code></pre>\n\n<p>I want to write a function that calculates the total number of <code>Leaves</code> throughout the entire recursive structure. This is easily done with recursion with:</p>\n\n<pre><code>func (tree *Tree) CountLeaves() int {\n    curr := len(tree.Leaves)\n    for _, s := range tree.SubTrees {\n        curr += s.CountLeaves()\n    }\n    return curr\n}\n</code></pre>\n\n<p>That's nice and all, but if the structure becomes too large, this is going to be inefficient so I wanted to refactor it to be concurrent and use channels. Here is my attempt at the refactor:</p>\n\n<pre><code>func (tree *Tree) CountLeaves() int {\n    var wg sync.WaitGroup\n    ch := make(chan int)\n    defer close(ch)\n    go count(tree, true, ch, &amp;wg)\n\n    var total int\n    wg.Add(1)\n    go func(total *int) {\n        for x := range ch {\n            fmt.Println(x)\n            *total += x\n        }\n        wg.Done()\n    }(&amp;total)\n    wg.Wait()\n\n    return total\n}\n\nfunc count(t *Tree, root bool, ch chan int, wg *sync.WaitGroup) {\n    defer wg.Done()\n    ch &lt;- len(t.Leaves)\n    if t.SubTrees != nil {\n        wg.Add(len(t.SubTrees))\n        for _, s := range t.SubTrees {\n            go count(s, false, ch, wg)\n        }\n        wg.Wait()\n    }\n\n    if root {\n        ch &lt;- -1\n    }\n}\n</code></pre>\n\n<p>I am able to currently gather all numbers through the channel that I would need to currently calculate the total number of <code>Leaves</code> but the function never ends. The terminating value <code>-1</code> from the root <code>Tree</code> struct is never pushed or received through the channel and I can't figure out why.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go", "callback"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1533064230, "post_id": 51620024, "comment_id": 90206384, "body": "Functions are first-class types in Go: <a href=\"https://tour.golang.org/moretypes/24\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/24</a>"}], "answers": [{"tags": [], "owner": {"reputation": 435, "user_id": 10061533, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fv61VUShbCs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rTOnJlSCJr_asOOUez6u2WFiAdCQ/mo/photo.jpg?sz=128", "display_name": "Cubey Mew", "link": "https://stackoverflow.com/users/10061533/cubey-mew"}, "is_accepted": true, "score": 0, "last_activity_date": 1533586852, "creation_date": 1533586852, "answer_id": 51715083, "question_id": 51620024, "link": "https://stackoverflow.com/questions/51620024/is-there-anything-similar-to-c-bind-in-go/51715083#51715083", "title": "Is there anything similar to C++ bind in Go?", "body": "<h2><strong>Solution:</strong></h2>\n\n<p>I'm posting my own solution for my question:</p>\n\n<p>I am passing go function as a parameter of another function to do the callback. The following code is a go version of the above C++ code.</p>\n\n<p>In <code>A.go</code></p>\n\n<pre><code>type A struct {\n    //... some properties\n}\n\ntype Handler func(string) bool\nfunc (a *A) ReadRecords(handler Handler) bool {\n    // getData will get data from file at path\n    auto data = getData(path)\n    return handler(data)\n}\n\nfunc (a *A) Initialize() {\n    //... Initialization\n}\n</code></pre>\n\n<p>In <code>B.go</code>, A is a member of B struct</p>\n\n<pre><code>type B struct {\n    a    A\n    //...other properties\n}\n\nvar read A.Handler\nfunc (b *B) Run() bool {\n    read = func(data string) {\n        fmt.Println(data)\n    }\n    b.a.Initialize()\n    return b.a.ReadRecords(read)\n}\n</code></pre>\n"}], "owner": {"reputation": 435, "user_id": 10061533, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fv61VUShbCs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rTOnJlSCJr_asOOUez6u2WFiAdCQ/mo/photo.jpg?sz=128", "display_name": "Cubey Mew", "link": "https://stackoverflow.com/users/10061533/cubey-mew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 51715083, "answer_count": 1, "score": 1, "last_activity_date": 1533586852, "creation_date": 1533062362, "question_id": 51620024, "link": "https://stackoverflow.com/questions/51620024/is-there-anything-similar-to-c-bind-in-go", "title": "Is there anything similar to C++ bind in Go?", "body": "<p>I'm trying to do something in Go, similar to C++'s bind.<br>\n<strong>In C++ :</strong> </p>\n\n<pre><code>class A {\npublic:\n    typedef std::function&lt;bool(const string&amp;)&gt; Handler;\n    bool func(A::Handler&amp; handler) {\n        // getData will get data from file at path\n        auto data = getData(path);\n        return handler(data);\n    }\n};\n</code></pre>\n\n<p>In another class B:</p>\n\n<pre><code>Class B {\npublic:\n    bool run() {\n        using namespace std::placeholders;\n        A::Handler handler = bind(&amp;B::read, this, _1);\n        m_A.initialize();\n        return m_A.func(handler);\n    }\n    bool read(const string&amp; data) {\n        std::out &lt;&lt; data &lt;&lt; std::endl;\n    }\nprivate:\n    A m_A {};\n};\n</code></pre>\n\n<p>when B's run() function is called, it will bind class B member function read with A's Handler.\nThen <code>m_A.func(hander)</code> is called, it will call <code>getData()</code>. The data got is then parsed to <code>B::read(const string&amp; data)</code></p>\n\n<p>Is there any way to do it in Go? How to create a forwarding call wrapper in golang?</p>\n"}, {"tags": ["go", "webpage", "go-http"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 1, "creation_date": 1533062097, "post_id": 51619910, "comment_id": 90205422, "body": "Did you try logging the error message? <code>fmt.Println(&quot;error: %v&quot;, err)</code> If there&#39;s no error, just an empty response, did you check the response headers? Maybe it&#39;s a redirect that python automatically follows, but the Go client doesn&#39;t."}, {"owner": {"reputation": 33, "user_id": 8987815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff1393badce07f3a18a943ac2763f5c2?s=128&d=identicon&r=PG&f=1", "display_name": "J Mead", "link": "https://stackoverflow.com/users/8987815/j-mead"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1533063256, "post_id": 51619910, "comment_id": 90205969, "body": "There weren&#39;t any error messages, nor any useful response headers. The response had a status of 200, but Content length 0"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8987815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff1393badce07f3a18a943ac2763f5c2?s=128&d=identicon&r=PG&f=1", "display_name": "J Mead", "link": "https://stackoverflow.com/users/8987815/j-mead"}, "edited": false, "score": 0, "creation_date": 1533063061, "post_id": 51620050, "comment_id": 90205881, "body": "That&#39;s fixed it, thanks a lot Dave! I assume python applies headers by default, but do you know if that&#39;s also true of Postman?"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "reply_to_user": {"reputation": 33, "user_id": 8987815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff1393badce07f3a18a943ac2763f5c2?s=128&d=identicon&r=PG&f=1", "display_name": "J Mead", "link": "https://stackoverflow.com/users/8987815/j-mead"}, "edited": false, "score": 2, "creation_date": 1533063339, "post_id": 51620050, "comment_id": 90205996, "body": "Go actually has a user agent by default too, <code>const defaultUserAgent = &quot;Go-http-client&#47;1.1&quot;</code>, I&#39;d imagine PostMan either has one or uses your browsers.  It&#39;s hard to know <i>why</i> Go&#39;s default was blocked, but it&#39;s just a common issue with scraping - in general you want to emulate a real browser as much as possible"}, {"owner": {"reputation": 33, "user_id": 8987815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff1393badce07f3a18a943ac2763f5c2?s=128&d=identicon&r=PG&f=1", "display_name": "J Mead", "link": "https://stackoverflow.com/users/8987815/j-mead"}, "edited": false, "score": 0, "creation_date": 1533063388, "post_id": 51620050, "comment_id": 90206017, "body": "That makes sense. Thanks a lot :)"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1533066465, "post_id": 51620050, "comment_id": 90207415, "body": "Looks like they&#39;re checking for <code>Mozilla</code>. I sent a request with <i>only</i> <code>Mozilla</code> as the user agent, and they sent the data."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 6, "last_activity_date": 1533064082, "last_edit_date": 1533064082, "creation_date": 1533062446, "answer_id": 51620050, "question_id": 51619910, "link": "https://stackoverflow.com/questions/51619910/why-cant-golang-download-certain-webpages/51620050#51620050", "title": "Why can&#39;t Golang download certain webpages?", "body": "<p>They are doing some sort of validation on the user agent, the following code works:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"time\"\n)\n\nconst AllPlayerData = \"https://fantasy.premierleague.com/drf/bootstrap-static\"\n\nfunc main() {\n    downloadAllData()\n}\n\nfunc downloadAllData() {\n    client := &amp;http.Client{\n        Timeout: 20 * time.Second,\n    }\n\n    request, err := http.NewRequest(http.MethodGet, AllPlayerData, nil)\n    if err != nil {\n        fmt.Println(\"Unable to create request.\")\n        return\n    }\n    request.Header.Add(\"User-Agent\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36\")\n    response, err := client.Do(request)\n    if err != nil {\n        fmt.Println(\"Unable to download player data.\")\n        return\n    }\n\n    body, err := ioutil.ReadAll(response.Body)\n    if err != nil {\n        fmt.Println(\"Failed to read response\")\n        return\n    }\n\n    defer response.Body.Close()\n\n    fmt.Println(string(body))\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8987815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff1393badce07f3a18a943ac2763f5c2?s=128&d=identicon&r=PG&f=1", "display_name": "J Mead", "link": "https://stackoverflow.com/users/8987815/j-mead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 51620050, "answer_count": 1, "score": 2, "last_activity_date": 1533064082, "creation_date": 1533061892, "question_id": 51619910, "link": "https://stackoverflow.com/questions/51619910/why-cant-golang-download-certain-webpages", "title": "Why can&#39;t Golang download certain webpages?", "body": "<p>I want to download Fantasy Football Data to analyse in Go, but when I try to download from <a href=\"https://fantasy.premierleague.com/drf/bootstrap-static\" rel=\"nofollow noreferrer\" title=\"this page\">this api page</a> then I get back an empty response, even though the code works for other websites, e.g. <a href=\"https://api.tfl.gov.uk/StopPoint/Meta/Categories\" rel=\"nofollow noreferrer\" title=\"this api\">this api page</a></p>\n\n<p>Minimal reproduction, outputs an empty array.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"time\"\n)\n\nconst AllPlayerData = \"https://fantasy.premierleague.com/drf/bootstrap-static\"\n\nfunc main() {\n    downloadAllData()\n}\n\nfunc downloadAllData() {\n    client := &amp;http.Client{\n        Timeout: 20 * time.Second,\n    }\n\n    response, err := client.Get(AllPlayerData)\n    if err != nil {\n        fmt.Println(\"Unable to download player data.\")\n        return\n    }\n\n    body, err := ioutil.ReadAll(response.Body)\n    if err != nil {\n        fmt.Println(\"Failed to read response\")\n        return\n    }\n\n    defer response.Body.Close()\n\n    fmt.Println(body)\n}\n</code></pre>\n\n<p>The same webpage downloads fine in Python:</p>\n\n<pre><code>import requests\nurl = \"https://fantasy.premierleague.com/drf/bootstrap-static\"\nr = requests.get(url)\nprint(r.content)\n</code></pre>\n\n<p>I don't think it's related to e.g. <a href=\"https://stackoverflow.com/questions/34989139/cant-download-webpage-via-c-sharp-webclient-and-via-request-respond\" title=\"Ajax calls\">Ajax calls</a> as viewing the network requests in Chrome doesn't show up any beyond the page load itself</p>\n"}, {"tags": ["html", "forms", "go", "post", "methods"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1533057995, "post_id": 51618399, "comment_id": 90203392, "body": "Are you sure this handler is being called for the form submit? The handler is bound to <code>&#47;subscribe&#47;</code> but your form is pointed at <code>&#47;subscribe</code>."}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 9183891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec5cdaa8b1c8cc83f9617d5864a412f8?s=128&d=identicon&r=PG&f=1", "display_name": "Piko Monde", "link": "https://stackoverflow.com/users/9183891/piko-monde"}, "edited": false, "score": 1, "creation_date": 1533143993, "post_id": 51619281, "comment_id": 90242303, "body": "I was spending my time figuring out why the form always sent a <code>get</code> request. Now, I know it is happening because the request is redirected. Good demo example though. Thanks!"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 5, "last_activity_date": 1533059457, "creation_date": 1533059457, "answer_id": 51619281, "question_id": 51618399, "link": "https://stackoverflow.com/questions/51618399/html-form-method-post-with-golang/51619281#51619281", "title": "HTML Form Method Post with Golang", "body": "<p>Per the docs:</p>\n\n<blockquote>\n  <p>If a subtree has been registered and a request is received naming the subtree root without its trailing slash, ServeMux redirects that request to the subtree root (adding the trailing slash). This behavior can be overridden with a separate registration for the path without the trailing slash.</p>\n</blockquote>\n\n<p>Because you registered <code>\"/subscribe/\"</code>, <em>with</em> the trailing slash, it is registered as a subtree.  Again, per the docs:</p>\n\n<blockquote>\n  <p>a pattern ending in a slash names a rooted subtree</p>\n</blockquote>\n\n<p>Because an HTTP redirect is (in practice) always a GET request, the method after the redirect is of course a GET.  You can see that a real redirect is happening in this example: <a href=\"https://play.golang.org/p/OcEhVDosTNf\" rel=\"noreferrer\">https://play.golang.org/p/OcEhVDosTNf</a></p>\n\n<p>The solution is to either register both:</p>\n\n<pre><code>http.HandleFunc(\"/subscribe/\", SubscribeHandler)\nhttp.HandleFunc(\"/subscribe\", SubscribeHandler)\n</code></pre>\n\n<p>Or point your form to the one with a <code>/</code>:</p>\n\n<pre><code>&lt;form action=\"/subscribe/\" method=\"post\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 322, "user_id": 9183891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec5cdaa8b1c8cc83f9617d5864a412f8?s=128&d=identicon&r=PG&f=1", "display_name": "Piko Monde", "link": "https://stackoverflow.com/users/9183891/piko-monde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1921, "favorite_count": 0, "accepted_answer_id": 51619281, "answer_count": 1, "score": 2, "last_activity_date": 1533069316, "creation_date": 1533055833, "last_edit_date": 1533069316, "question_id": 51618399, "link": "https://stackoverflow.com/questions/51618399/html-form-method-post-with-golang", "title": "HTML Form Method Post with Golang", "body": "<p>So, I have this form in an html. It is intended to have a POST request to <code>/subscribe</code> page:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;form action=\"/subscribe\" method=\"post\"&gt;\n    First Name: &lt;input type=\"text\" name=\"first_name\" placeholder=\"Willy\"/&gt;&lt;br/&gt;\n    Last Name: &lt;input type=\"text\" name=\"last_name\" placeholder=\"Warmwood\"/&gt;&lt;br/&gt;\n    Email: &lt;input type=\"email\" name=\"email\" placeholder=\"willy.warwood@gmail.com\"/&gt;&lt;br/&gt;\n    &lt;input type=\"submit\" value=\"Submit\"/&gt;\n  &lt;/form&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Then, I have this router in golang:</p>\n\n<pre><code>http.HandleFunc(\"/subscribe/\", SubscribeHandler)\n</code></pre>\n\n<p>And this handler in golang:</p>\n\n<pre><code>func SubscribeHandler(w http.ResponseWriter, r *http.Request) {\n    log.Println(r.Method)\n}\n</code></pre>\n\n<p>But the problem is, it always print <code>GET</code>.</p>\n\n<p>How to post the form, so the value of <code>r.Method</code> is <code>POST</code>?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-apiserver", "kubernetes-custom-resources"], "comments": [{"owner": {"reputation": 9163, "user_id": 563072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/87897775ae66733545b7eae7128e2e8f?s=128&d=identicon&r=PG", "display_name": "Jose Armesto", "link": "https://stackoverflow.com/users/563072/jose-armesto"}, "edited": false, "score": 0, "creation_date": 1561540802, "post_id": 51618374, "comment_id": 100094304, "body": "did you figure out how to do it? I&#39;m having the same issue"}, {"owner": {"reputation": 884, "user_id": 1139454, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fZDFq.png?s=128&g=1", "display_name": "Cocotton", "link": "https://stackoverflow.com/users/1139454/cocotton"}, "reply_to_user": {"reputation": 9163, "user_id": 563072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/87897775ae66733545b7eae7128e2e8f?s=128&d=identicon&r=PG", "display_name": "Jose Armesto", "link": "https://stackoverflow.com/users/563072/jose-armesto"}, "edited": false, "score": 1, "creation_date": 1562783408, "post_id": 51618374, "comment_id": 100489516, "body": "I&#39;ve opened an issue concerning this, but got no answers. Nobody from the Slack channel was able to help either. I&#39;m just assuming this is not/won&#39;t be supported, so I converted all my anonymous structs into named ones."}], "owner": {"reputation": 884, "user_id": 1139454, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fZDFq.png?s=128&g=1", "display_name": "Cocotton", "link": "https://stackoverflow.com/users/1139454/cocotton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533125435, "creation_date": 1533055751, "last_edit_date": 1533125435, "question_id": 51618374, "link": "https://stackoverflow.com/questions/51618374/how-to-use-slices-and-maps-with-the-k8s-io-code-generator", "title": "How to use slices and maps with the k8s.io/code-generator", "body": "<p>I'm writing a Kubernetes Controller listening on a <em>Environment</em> Custom Resource.</p>\n\n<p>The <em>pkg/apis/environment/v1alpha1/types.go</em> has the following content:</p>\n\n<pre><code>package v1alpha1\n\nimport (\n    meta_v1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n)\n\n// +genclient\n// +genclient:noStatus\n// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object\n\n// Environment describes an Environment resource\ntype Environment struct {\n    meta_v1.TypeMeta   `json:\",inline\"`\n    meta_v1.ObjectMeta `json:\"metadata,omitempty\"`\n    Spec               EnvironmentSpec `json:\"spec\"`\n}\n\n// EnvironmentSpec contains the specs for an Environment resource\ntype EnvironmentSpec struct {\n    Services []Service `json:\"services\"`\n}\n\n// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object\n\n// EnvironmentList is a list of Environment resources\ntype EnvironmentList struct {\n    meta_v1.TypeMeta `json:\",inline\"`\n    meta_v1.ListMeta `json:\"metadata\"`\n\n    Items []Environment `json:\"items\"`\n}\n\n// Service describes a Service in the Environment Custom Resource\ntype Service struct {\n    Code       string `json:\"code\"`\n    Parameters struct {\n        Foo map[string]string `json:\"foo\"`\n        Bar int               `json:\"bar\"`\n    } `json:\"parameters\"`\n}\n</code></pre>\n\n<p>After running the k8s.io/code-generator/generate-groups.sh script, I end up with a faulty <em>pkg/apis/environment/v1alpha1/zz_generated.deepcopy.go</em> file. The problem comes from this generated method:</p>\n\n<pre><code>// DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.\nfunc (in *Service) DeepCopyInto(out *Service) {\n    *out = *in\n    in.Parameters.DeepCopyInto(&amp;out.Parameters)\n    return\n}\n</code></pre>\n\n<p>Trying to build or run this code will give me the following error</p>\n\n<pre><code>pkg/apis/environment/v1alpha1/zz_generated.deepcopy.go:113:15: in.Parameters.DeepCopyInto undefined (type struct { Foo map[string]string \"json:\\\"foo\\\"\"; Bar int \"json:\\\"bar\\\"\" } has no field or method DeepCopyInto)\n</code></pre>\n\n<p>As soon as I have a <em>Map</em> or a <em>Slice</em> inside an anonymous struct included in the <em>Parameters</em> struct, I encounter this error.</p>\n\n<p><strong>WORKAROUND</strong></p>\n\n<p>A workaround to this is to create a named type that will contain the map. For example I refactored the <em>Service</em> struct like this:</p>\n\n<pre><code>// Service describes a Service in the Environment Custom Resource\ntype Service struct {\n    Code       string `json:\"code\"`\n    Parameters FooBar `json:\"parameters\"`\n}\n\ntype FooBar struct {\n    Foo map[string]string `json:\"foo\"`\n    Bar int               `json:\"bar\"`\n}\n</code></pre>\n\n<p>The generated <code>func (in *Service) DeepCopyInto(out *Service)</code> does not change, but the following 2 new methods are created:</p>\n\n<pre><code>// DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.\nfunc (in *FooBar) DeepCopyInto(out *FooBar) {\n    *out = *in\n    if in.Foo != nil {\n        in, out := &amp;in.Foo, &amp;out.Foo\n        *out = make(map[string]string, len(*in))\n        for key, val := range *in {\n            (*out)[key] = val\n        }\n    }\n    return\n}\n\n// DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new FooBar.\nfunc (in *FooBar) DeepCopy() *FooBar {\n    if in == nil {\n        return nil\n    }\n    out := new(FooBar)\n    in.DeepCopyInto(out)\n    return out\n}\n</code></pre>\n\n<p>And now, I don't have any issues building and running the code.</p>\n\n<p>This workaround is painful because my real <em>Service</em> struct is much bigger than in this example.</p>\n\n<p>Is there a way to use maps and slices inside of anonymous func with the code-generator?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533060333, "post_id": 51619390, "comment_id": 90204552, "body": "Sorry, but this is what I already have, I posted it wrong and I fixed the question"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533060486, "post_id": 51619390, "comment_id": 90204633, "body": "What do your imports look like? Are you sure your GOPATH is set to the project root in the terminal that your Go binary is running in? If you changed the GOPATH afterwards then you&#39;ll need a refresh of the terminal environment for it to pick up the new GOPATH."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533061999, "post_id": 51619390, "comment_id": 90205386, "body": "It is not set at the project root, since I am working on multiple projects at once. All projects are under GOPATH/src. So the path to my vendor directory is something like GOPATH/src/project1/vendor"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533062220, "post_id": 51619390, "comment_id": 90205474, "body": "That is likely your problem. With the approach you are taking, it would work if you just use one vendor directory to manage dependencies for all projects, and it should be directly in the src folder. If you don&#39;t want to do that, then you should split up the projects. You can do something like <code>project1&#47;src&#47;vendor</code>, <code>project2&#47;src&#47;vendor</code>, and so on, and you would just toggle your GOPATH to be at the root of project1 or project2, respectively, depending on which project you&#39;re working on. That way each project will still have its own dependency management, and just toggle your GOPATH to switch."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533062461, "post_id": 51619390, "comment_id": 90205600, "body": "If I do <code>project&#47;src&#47;</code> and set GOROOT for each project, I don&#39;t see how I will be able to import local packages. And making a shared vendor for all projects seems kinda ugly, how do I build individual projects? how do I use different versions of the same package for different projects? how do I make sure every binary doesn&#39;t get linked against every dependency ever?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533062634, "post_id": 51619390, "comment_id": 90205679, "body": "Updated answer."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533062997, "post_id": 51619390, "comment_id": 90205843, "body": "So, if I go with path #2, how do I import things from one project in another project?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533063255, "post_id": 51619390, "comment_id": 90205968, "body": "If you want to reuse code between projects, the clean way to do that would be through the vendor folder. Create a package and add it to the vendor directory of the project you want to share it with. This is a good approach because then you can version things properly..for instance one project uses v1.0.0 and can&#39;t upgrade for some requirements reason, yet another project can upgrade to the latest v2.0.0. If you use one shared piece of code - perhaps from a higher level package that both projects import (assuming that was even possible with your structure) - then you can&#39;t get this versioning."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533063518, "post_id": 51619390, "comment_id": 90206079, "body": "To further elaborate, think of when you need a third party package from Github. What do you do? Something along the lines of <code>gvt fetch github.com&#47;foo&#47;bar</code> (which sends it to the vendor directory), and then <code>import &quot;github.com&#47;foo&#47;bar&quot;</code> within your code. This is the same approach, except it&#39;s with your own custom code and not third party code."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533063788, "post_id": 51619390, "comment_id": 90206182, "body": "As I said in the question, I have multiple projects sharing code from a single custom library. The library changes a lot, since it is in active development. It is a proprietory codebase and it does not have its own repository as of now. And when it does, it will be inside another project written in a different language altogether. If I have to manually vendor this shared library into each project, I am losing all the safety of having common shared codebase."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533065612, "post_id": 51619390, "comment_id": 90207033, "body": "I don&#39;t mean manually, I mean programatically. However you vendor your other third party packages, you should vendor this package the same way. But since you say it has no repository, that won&#39;t be possible. So my next idea would be to use a higher level package. But that requires all projects to be within one GOPATH namespace so they know where to import from, which brings us back to the original problem."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533065719, "post_id": 51619390, "comment_id": 90207089, "body": "You can have multiple GOPATH&#39;s, however <a href=\"https://dmitri.shuralyov.com/blog/18\" rel=\"nofollow noreferrer\">&quot;Go searches each directory listed in GOPATH to find source code and new packages are always downloaded into the first directory in the list&quot;</a>. This is why the approach #2 is necessary for your approach if you want individual vendor directories for each project. But that approach also makes it so that you can&#39;t use a &quot;higher level package&quot; to share code between multiple projects -- that would only be possible if all projects were within the same GOPATH namespace."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533066016, "post_id": 51619390, "comment_id": 90207204, "body": "So, basically, what you are trying to do (as far as I am aware) is not possible. If you absolutely MUST have this &quot;shared code&quot;, go back to your original approach using one GOPATH namespace for all projects, and share one vendor directory amongst them for the time being so that you can get going. Iterate on this later on when you have time and find a better approach; I don&#39;t think you&#39;ll run into those dependency problems anytime soon. Or if that isn&#39;t sufficient for you I would advise to keep looking. Let me know if you need additional help, I&#39;d be happy to dig deeper when I get home."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533066390, "post_id": 51619390, "comment_id": 90207367, "body": "Check my recent update to the answer. If you can tolerate one vendor directory, that is a solution that will achieve what you want."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533154774, "post_id": 51619390, "comment_id": 90247725, "body": "So... basically you are telling me that there is no way to share code between Go projects without sharing every dependency as well?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533155198, "post_id": 51619390, "comment_id": 90247913, "body": "You can do this. You just have to change your structure. The structure you&#39;re using has the limitations we&#39;ve discussed above. You can set your GOPATH far up the directory tree, then have as many projects as you want and each of them can import code from one another. This doesn&#39;t follow the <code>src</code> pattern, though."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533155878, "post_id": 51619390, "comment_id": 90248212, "body": "The way I understand, I can either have a common vendor directory, effectively sharing same set of dependencies between all projects or I can set GOPATH for every project which prevents me from importing local code."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533212099, "post_id": 51619390, "comment_id": 90270043, "body": "Go will lookup your code like so: First <code>$GOPATH&#47;vendor&#47;package1</code>, second <code>$GOPATH&#47;src&#47;vendor&#47;package1</code>, third <code>$GOROOT&#47;src&#47;vendor&#47;package1</code>. So you can try adding packages to your GOROOT, and use approach #2 in the first update on my answer. That way, each project has it&#39;s own GOPATH tree (meaning they have their own vendor directory), and they can all still use globally shared code that you have somewhere in the GOROOT tree. Let me know if this works for you and I&#39;ll update my answer for the final solution. If not, let&#39;s keep iterating on ideas - we&#39;re almost there."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533212559, "post_id": 51619390, "comment_id": 90270355, "body": "Sorry, I mean <code>$GOROOT&#47;src&#47;package1</code>, not <code>$GOROOT&#47;src&#47;vendor&#47;package1</code>. The GOROOT path shouldn&#39;t have vendor; only the GOPATH should."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533223219, "post_id": 51619390, "comment_id": 90277960, "body": "I am not sure. At this point I am confused. I have several projects. Code in one of them is shared by every other project. Each project (including shared one) has some vendored dependencies. I want to be able to import the shared project from other projects without 1. copying my code into every vendor directory 2. having a shared vendor directory across all projects and 3. still having all my code somewhere at the same level in the folder structure. That was my original question."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533224346, "post_id": 51619390, "comment_id": 90278675, "body": "You can achieve all 3 of those points by going with #2 approach in my answer and also using the GOROOT as the location where your shared code lives. Try it and let me know what happens."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533569768, "post_id": 51619390, "comment_id": 90383623, "body": "I am currently trying things with a shared vendor directory and also without any vendoring at all (setting GOPATH to the root of all projects and just using <code>go get</code> to install dependencies). The way you described in #2 doesn&#39;t work for me. It breaks my shared code imports, since shared code ends up outside of the GOPATH for the current project."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1533569853, "post_id": 51619390, "comment_id": 90383672, "body": "Thank you for your help, it seems that Go toolset was never designed for working on more than one project at a time and while it is making progress in that direction it is not quite there yet."}], "tags": [], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "is_accepted": false, "score": 0, "last_activity_date": 1533066360, "last_edit_date": 1533066360, "creation_date": 1533059868, "answer_id": 51619390, "question_id": 51617301, "link": "https://stackoverflow.com/questions/51617301/building-a-go-project-with-vendor-dependencies-across-multiple-projects/51619390#51619390", "title": "Building a Go project with vendor dependencies across multiple projects", "body": "<p>Here is one solution using a <code>src</code> directory:</p>\n\n<ol>\n<li>Set your GOPATH to your project root.</li>\n<li>Create a <code>src</code> directory in your project root. All your Go code should live in here.</li>\n<li>Within the <code>src</code> directory, create a <code>vendor</code> directory. All your third party packages should live here. Dependency Management tools like GVT will install third party packages directly to this folder for you.</li>\n</ol>\n\n<p>So your project should look like this:</p>\n\n<pre><code>- bin\n- pkg\n- src\n    - project1\n    - project2\n    - models\n    - vendor\n        - github.com\n            ...\n</code></pre>\n\n<p>To import third party packages within your code (for example from github.com), you would just use the github path directly, like <code>import \"github.com/foo/bar\"</code>. The Go compiler will use your GOPATH to determine that <code>github.com/foo/bar</code> actually lives at <code>$GOPATH/src/vendor/github.com/foo/bar</code>.</p>\n\n<p>To import local packages, just use your local path directly, like <code>import \"models\"</code>. The Go compiler will use your GOPATH to determine that <code>models</code> actually lives at <code>$GOPATH/src/models</code>.</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>Based on our conversation below, you have two options:</p>\n\n<ol>\n<li>Consolidate the dependencies of all your projects into one vendor folder located at <code>$GOPATH/src/vendor</code>.</li>\n<li>Use isolated projects and toggle your GOPATH to a new project root based on the project you're currently working on.</li>\n</ol>\n\n<p>I would go with approach #2 to keep things clean and independent.</p>\n\n<p>To achieve #2, you can create a structure like this:</p>\n\n<pre><code>- project1\n    - bin\n    - pkg\n    - src\n        - vendor\n- project2\n    - bin\n    - pkg\n    - src\n        - vendor\n</code></pre>\n\n<p>To work on project1, set GOPATH to the root of project1. Same goes for project2 and any other projects you have.</p>\n\n<p>Everything else I said above should still apply, because these projects still follow the same structure individually, but now we've also fulfilled the requirement of having a unique vendor directory for each project.</p>\n\n<p>I know it's not \"seamless\" because you'll have to toggle your GOPATH, but I hardly think that is a big deal because you're only ever going to do that once in a blue moon, and it takes half a second. Plus, Golang was not made specifically to cater to such project structure requirements, though it is flexible enough to get it working without much hassle (all you have to do is toggle GOPATH).</p>\n\n<p>You can even automate this further by writing aliases that change your GOPATH for you for certain projects. For instance, to switch to project1 really fast you can create an alias <code>project1</code> that runs the command <code>export GOPATH=/path/to/project1</code>. </p>\n\n<hr>\n\n<p><strong>Update 2</strong></p>\n\n<p>Here is how I structure a personal project of mine, which achieves everything you're trying to achieve:</p>\n\n<pre><code>- bin\n- pkg\n- src\n    - vendor\n    - core\n    - apps\n        - foo.com\n        - api.foo.com\n        - auth.foo.com\n</code></pre>\n\n<p>As you can see, in the <code>apps</code> folder I have multiple \"projects\" (though in reality these are just different binaries/HTTP servers).</p>\n\n<p>You'll also see that I have a <code>core</code> directory. This is where all my shared logic lives. Each project in the <code>apps</code> folder can import from <code>core</code> with no problems since they're all within the same GOPATH namespace.</p>\n"}], "owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 573, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1533066360, "creation_date": 1533051863, "last_edit_date": 1533066356, "question_id": 51617301, "link": "https://stackoverflow.com/questions/51617301/building-a-go-project-with-vendor-dependencies-across-multiple-projects", "title": "Building a Go project with vendor dependencies across multiple projects", "body": "<p>OK, so I have a few projects in Go that all share the same set of structs to represent my database schema. So to avoid code going out of sync, I moved all the structs into their own \"models\" project. My folder structure looks like this</p>\n\n<pre><code>GOPATH\n  - src\n    - project1\n    - project2\n    - models\n  - pkg\n  - bin\n</code></pre>\n\n<p>Models have some methods defined to fetch records from the database, but since each project needs to control its own database connection pool, I am passing the db connection to the model methods as an argument, so in models I have something like</p>\n\n<pre><code>import (\n    \"github.com/jmoiron/sqlx\"\n    _ \"github.com/lib/pq\"\n)\n\ntype User struct {\n    ...\n}\n\ntype UserList []User\n\nfunc (u *UserList) FetchAll(db *sqlx.DB) {\n    ...\n}\n</code></pre>\n\n<p>and in the project code, I have something like </p>\n\n<pre><code>import (\n    \"github.com/jmoiron/sqlx\"\n    _ \"github.com/lib/pq\"\n\n    . \"models\"\n)\n\nfunc UserListAPI(c *gin.Context) {\n    var users UserList\n    db := GetDBConnection()\n    users.FetchAll(db)\n    c.JSON(200, users)\n}\n</code></pre>\n\n<p>But now, when I try to build, I get an error</p>\n\n<p><code>cannot use db (type *\"project1/vendor/github.com/jmoiron/sqlx\".DB) as type *\"models/vendor/github.com/jmoiron/sqlx\".DB in argument to users.FetchAll</code></p>\n\n<p>Is there any way to resolve this without drastically changing my project structure?</p>\n\n<p>I am using <code>dep</code> to manage my dependencies.</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 2, "creation_date": 1533050477, "post_id": 51616786, "comment_id": 90199149, "body": "The XML is well-formed, so it&#39;s pretty standard."}, {"owner": {"reputation": 73, "user_id": 6015862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LqN7.jpg?s=128&g=1", "display_name": "fauliath", "link": "https://stackoverflow.com/users/6015862/fauliath"}, "reply_to_user": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1533050525, "post_id": 51616786, "comment_id": 90199182, "body": "Really? I&#39;ve never seen the directive:entry before, and I believe that is what is throwing this off."}, {"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 2, "creation_date": 1533050593, "post_id": 51616786, "comment_id": 90199234, "body": "That&#39;s called a namespace and getting an empty result can be a result of not defining this namespace."}, {"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1533050641, "post_id": 51616786, "comment_id": 90199263, "body": "But I don&#39;t know about how Go handles namespaces, so I cannot help you in this regard."}, {"owner": {"reputation": 73, "user_id": 6015862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LqN7.jpg?s=128&g=1", "display_name": "fauliath", "link": "https://stackoverflow.com/users/6015862/fauliath"}, "reply_to_user": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1533050731, "post_id": 51616786, "comment_id": 90199340, "body": "Okay well now I know I need to look into parsing namespaces, so thank you for that!"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1533051154, "post_id": 51616786, "comment_id": 90199641, "body": "You have to export the <code>id</code> field, otherwise the XML package can&#39;t assign values to it."}, {"owner": {"reputation": 73, "user_id": 6015862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LqN7.jpg?s=128&g=1", "display_name": "fauliath", "link": "https://stackoverflow.com/users/6015862/fauliath"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1533051301, "post_id": 51616786, "comment_id": 90199737, "body": "@Peter I&#39;m sorry I don&#39;t understand what you mean by exporting the field? How would I do this?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 4, "creation_date": 1533051835, "post_id": 51616786, "comment_id": 90200104, "body": "<a href=\"https://tour.golang.org/basics/3\" rel=\"nofollow noreferrer\">tour.golang.org/basics/3</a>"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6015862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LqN7.jpg?s=128&g=1", "display_name": "fauliath", "link": "https://stackoverflow.com/users/6015862/fauliath"}, "edited": false, "score": 0, "creation_date": 1533116750, "post_id": 51617908, "comment_id": 90224464, "body": "Okay I&#39;ll give this a go at implementing, thank you!"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1533054001, "creation_date": 1533054001, "answer_id": 51617908, "question_id": 51616786, "link": "https://stackoverflow.com/questions/51616786/parsing-non-standard-xml-in-go/51617908#51617908", "title": "Parsing non-standard XML in GO", "body": "<p>Instead of using decoder.DecodeElement() I would recommend you use xml.Unmarshal, and for <code>xml.Unmarshal</code> to be able to do what you want it to do, the <code>DT</code> type's structure has to match the <code>&lt;dt&gt;</code> element's structure following the rules documented <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>For example something like this:</p>\n\n<pre><code>type DT struct {\n    DataEntry struct {\n        List []EntryMap `xml:\"list\"`\n    } `xml:\"Data&gt;Entry\"`\n}\n\ntype EntryMap struct {\n    Entries []Entry `xml:\"map&gt;Entry\"`\n}\n\ntype Entry struct {\n    Name  string `xml:\",attr\"`\n    Value string `xml:\",any\"`\n}\n</code></pre>\n\n<p>You can then loop over <code>dt.DataEntry.List[N].Entries</code> to get what you need.</p>\n\n<p><a href=\"https://play.golang.org/p/3XxmYQ4ECza\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3XxmYQ4ECza</a></p>\n"}, {"tags": [], "owner": {"reputation": 1143, "user_id": 370213, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/PH4vL.jpg?s=128&g=1", "display_name": "zhengchun", "link": "https://stackoverflow.com/users/370213/zhengchun"}, "is_accepted": false, "score": 0, "last_activity_date": 1537696644, "creation_date": 1537696644, "answer_id": 52464991, "question_id": 51616786, "link": "https://stackoverflow.com/questions/51616786/parsing-non-standard-xml-in-go/52464991#52464991", "title": "Parsing non-standard XML in GO", "body": "<p>Im using <a href=\"https://github.com/antchfx/xmlquery\" rel=\"nofollow noreferrer\">xmlquery</a> library to parse and extract data from XML document.</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"strings\"\n\n\"github.com/antchfx/xmlquery\"\n)\n\nfunc main() {\nvar s = `&lt;dt\nxmlns:directive=\"d\"\nxmlns:ref=\"ref\"&gt;\n&lt;Data&gt;\n&lt;directive:Entry Name='abcd'&gt;\n&lt;list&gt;\n    &lt;map&gt;\n            &lt;directive:Entry Name='id'&gt;\n                    &lt;Integer&gt;21&lt;/Integer&gt;\n            &lt;/directive:Entry&gt;\n            &lt;directive:Entry Name='t'&gt;\n                    &lt;Date&gt;T14:31:43.823Z&lt;/Date&gt;\n            &lt;/directive:Entry&gt;\n        &lt;/map&gt;\n    &lt;/list&gt;\n    &lt;/directive:Entry&gt;\n&lt;/Data&gt;\n&lt;/dt&gt;`\n\ndoc, err := xmlquery.Parse(strings.NewReader(s))\nif err != nil {\n    panic(err)\n}\nid := xmlquery.FindOne(doc, \"//directive:Entry[@Name='id']/Integer\")\nfmt.Println(id.InnerText())\nt := xmlquery.FindOne(doc, \"//directive:Entry[@Name='t']/Date\")\nfmt.Println(t.InnerText())\n}\n</code></pre>\n\n<p>It's very simple and easy used.</p>\n"}], "owner": {"reputation": 73, "user_id": 6015862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5LqN7.jpg?s=128&g=1", "display_name": "fauliath", "link": "https://stackoverflow.com/users/6015862/fauliath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1537696644, "creation_date": 1533050273, "question_id": 51616786, "link": "https://stackoverflow.com/questions/51616786/parsing-non-standard-xml-in-go", "title": "Parsing non-standard XML in GO", "body": "<p>I have a 4.5 million line XML file, and I cannot figure out a way to parse the information out using the decoder.DecodeElement() function.</p>\n\n<p>A snippet of the XML:</p>\n\n<pre><code>&lt;dt\n    xmlns:directive=\"d\"\n    xmlns:ref=\"ref\"&gt;\n    &lt;Data&gt;\n        &lt;directive:Entry Name='abcd'&gt;\n            &lt;list&gt;\n                &lt;map&gt;\n                    &lt;directive:Entry Name='id'&gt;\n                        &lt;Integer&gt;21&lt;/Integer&gt;\n                    &lt;/directive:Entry&gt;\n                    &lt;directive:Entry Name='t'&gt;\n                        &lt;Date&gt;T14:31:43.823Z&lt;/Date&gt;\n                    &lt;/directive:Entry&gt;\n                &lt;/map&gt;\n            &lt;/list&gt;\n        &lt;/directive:Entry&gt;\n    &lt;/Data&gt;\n&lt;/dt&gt;\n</code></pre>\n\n<p>So the above constitutes one line of the XML file. My goal is to extract 't' and 'id'.</p>\n\n<p>My current attempt involves creating a struct:</p>\n\n<pre><code>type DT struct {\n    id string `xml:\"Data\"` // This is my attempt to get the entire Data portion/segment/chunk(?)\n}\n</code></pre>\n\n<p>The code to perform the actual decoding: </p>\n\n<pre><code>decoder := xml.NewDecoder(readInFile())\n\nfor {\n    t, _ := decoder.Token()\n    if t == nil {\n        break\n    }\n\n    switch se := t.(type) {\n    case xml.StartElement:\n        inE := se.Name.Local\n\n        if inE == \"dt\" {\n            var dt DT\n            decoder.DecodeElement(&amp;dt, &amp;se)\n\n            fmt.Println(&amp;dt)\n        }\n    }\n}\n</code></pre>\n\n<p>The above code, when run, outputs</p>\n\n<pre><code>&amp;{}\n</code></pre>\n\n<p>Which tells me that no information can be parsed out. The same is true when if I output </p>\n\n<pre><code>fmt.Println(&amp;dt.id)\n</code></pre>\n\n<p>Could someone please help me. I am not sure if the reason my output is blank is due to the way I am extracting in the struct, or an issue with my decoding.</p>\n"}, {"tags": ["go", "compiler-errors", "go-build"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 5, "creation_date": 1533049301, "post_id": 51616379, "comment_id": 90198310, "body": "Regex compilation happens at runtime."}], "answers": [{"tags": [], "owner": {"reputation": 506, "user_id": 2832138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a572640dcd7416b0783869fe6759d32?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2832138/maxim"}, "is_accepted": true, "score": 5, "last_activity_date": 1533049240, "creation_date": 1533049240, "answer_id": 51616451, "question_id": 51616379, "link": "https://stackoverflow.com/questions/51616379/why-does-go-build-succeed-for-a-regexp-mustcompile-parsing-error/51616451#51616451", "title": "Why does go build succeed for a regexp.MustCompile parsing error?", "body": "<p>Compiler does not analyze your regular expression. It is done in runtime.\n\"Compile\" part of \"MustCompile\" function name stands for the compilation of the regular expression.</p>\n"}], "owner": {"reputation": 1518, "user_id": 3150057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32880beea401dfe8fdccd7bced822d5d?s=128&d=identicon&r=PG", "display_name": "Henry Blyth", "link": "https://stackoverflow.com/users/3150057/henry-blyth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "accepted_answer_id": 51616451, "answer_count": 1, "score": -3, "last_activity_date": 1533049240, "creation_date": 1533049012, "question_id": 51616379, "link": "https://stackoverflow.com/questions/51616379/why-does-go-build-succeed-for-a-regexp-mustcompile-parsing-error", "title": "Why does go build succeed for a regexp.MustCompile parsing error?", "body": "<p>It fails for <code>go run</code> or <code>go test</code> (compile then run), but not for <code>go build</code> (compile only). I would have thought <code>MustCompile</code> relates to compilation, not runtime.</p>\n\n<hr>\n\n<pre class=\"lang-js prettyprint-override\"><code>package main\n\nimport (\n    \"regexp\"\n)\n\nvar someInvalidRegex = regexp.MustCompile(`(?!`)\n\nfunc main() {\n    someInvalidRegex.MatchString(\"foo\")\n}\n</code></pre>\n\n<p>Runtime fail:\n</p>\n\n<pre><code>$ go run main.go\npanic: regexp: Compile(`(?!`): error parsing regexp: invalid or unsupported Perl syntax: `(?!`\n\ngoroutine 1 [running]:\nregexp.MustCompile(0x10b7d19, 0x3, 0xc420022070)\n    /usr/local/Cellar/go/1.10.3/libexec/src/regexp/regexp.go:240 +0x171\nexit status 2\n</code></pre>\n\n<p>Compilation success:\n</p>\n\n<pre><code>$ go build -o foo\n$ echo $?\n0\n</code></pre>\n\n<p>Runtime fail again:\n</p>\n\n<pre><code>$ ./foo\npanic: regexp: Compile(`(?!`): error parsing regexp: invalid or unsupported Perl syntax: `(?!`\n\ngoroutine 1 [running]:\nregexp.MustCompile(0x10b7d19, 0x3, 0xc420022070)\n    /usr/local/Cellar/go/1.10.3/libexec/src/regexp/regexp.go:240 +0x171\n</code></pre>\n"}, {"tags": ["debugging", "go", "terminal", "goland"], "answers": [{"comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 89, "user_id": 10123374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ef45474ba37378f0360a3c54a80e2?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/10123374/javier-salas"}, "edited": false, "score": 0, "creation_date": 1533065244, "post_id": 51615953, "comment_id": 90206854, "body": "You can add your own parameters to the app in the Run Configuration, edit the configuration via Run | Edit Configurations... | Go Build | your build config"}, {"owner": {"reputation": 555, "user_id": 5675692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcbd2723a6bbde29f0a7f62e6651475a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashvin Sharma", "link": "https://stackoverflow.com/users/5675692/ashvin-sharma"}, "edited": false, "score": 0, "creation_date": 1591784683, "post_id": 51615953, "comment_id": 110185405, "body": "<code>Run | Attach to local process</code> shows a blank window @dlsniper"}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 3, "last_activity_date": 1533047758, "creation_date": 1533047758, "answer_id": 51615953, "question_id": 51615711, "link": "https://stackoverflow.com/questions/51615711/how-to-debug-while-running-from-goland-terminal/51615953#51615953", "title": "How to debug while running from GoLand Terminal", "body": "<p>You can run the debugger directly from GoLand and it will use Go build then delve to run the application.</p>\n\n<p>However, if you want to use a custom build process for the binary, build it as you normally would, and make sure you specify the <code>-gcflags=\"all=-N -l\"</code>(if you use Go 1.10+,or drop <code>all=</code> if you use 1.9 or lower). The launch the binary from terminal and then use \"Run| Attach to local process\" to attach the debugger to the binary.</p>\n\n<p>Please clarify the question in case this is not what you are looking for.</p>\n"}, {"comments": [{"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "reply_to_user": {"reputation": 89, "user_id": 10123374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ef45474ba37378f0360a3c54a80e2?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/10123374/javier-salas"}, "edited": false, "score": 0, "creation_date": 1533052724, "post_id": 51616161, "comment_id": 90200661, "body": "@JavierSalas Glad, that it helped you!"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533065163, "post_id": 51616161, "comment_id": 90206816, "body": "Can you please help me understand why you are using the terminal instead of letting the IDE build the project? Do we need to improve something there? Thank you."}, {"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533066844, "post_id": 51616161, "comment_id": 90207601, "body": "@dlsniper Hey. Because it won&#39;t work( Here you can find video: <a href=\"https://monosnap.com/file/2kVZ2NVQzWyhD9KDimdqrh806z997u\" rel=\"nofollow noreferrer\">monosnap.com/file/2kVZ2NVQzWyhD9KDimdqrh806z997u</a>"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533083095, "post_id": 51616161, "comment_id": 90212617, "body": "The project is not in GOPATH so the IDE will not correctly automatically map the files as it expects that it respects either the Go Workspace layout (aka GOPATH), <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#Workspaces</a>, or it uses Go modules. We should probably do a better job at warning you about this."}, {"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533125718, "post_id": 51616161, "comment_id": 90230158, "body": "@dlsniper Can&#39;t agree with you. I&#39;ve created new goland project and added my x.go emaple. Video1: <a href=\"https://monosnap.com/file/Q8CoZwNnoEjtO10HLDiZjmePUyE2Y5\" rel=\"nofollow noreferrer\">monosnap.com/file/Q8CoZwNnoEjtO10HLDiZjmePUyE2Y5</a> Video2: <a href=\"https://monosnap.com/file/4txmBkXrU5Pg2axOezb7fQdb7334T8\" rel=\"nofollow noreferrer\">monosnap.com/file/4txmBkXrU5Pg2axOezb7fQdb7334T8</a>"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533161840, "post_id": 51616161, "comment_id": 90250347, "body": "@VladimirKovpak, unfortunately, neither of those videos contain a correct GOPATH setting. In both, the &quot;src/&quot; folder is missing. A valid GOPATH is formed of the directories described here: <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#Workspaces</a> and the IDE will look for the sources in the GOPATH/src/ folder. You need to configure the IDE to point to GOPATH, not GOPATH/src/, and once you do that, you can create a package and start debugging. Furthermore, you just need to set the GOPATH in either the Global or Project spaces, not both if the path is the same."}, {"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533190474, "post_id": 51616161, "comment_id": 90257003, "body": "@dlsniper Ooops, I&#39;ve forgot about <code>src</code> dir. Thank you! This is video with <code>src</code> dir: <a href=\"https://monosnap.com/file/LWCWvfnJyOEjdtaC4TAhnb0CTWQFQF\" rel=\"nofollow noreferrer\">monosnap.com/file/LWCWvfnJyOEjdtaC4TAhnb0CTWQFQF</a>"}, {"owner": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1533197595, "post_id": 51616161, "comment_id": 90260865, "body": "@VladimirKovpak <code>could not launch process EOF</code> error message looks like delve is outdated. Could you please confirm that you use IDE version less than 2018.1.1? Or maybe you override <code>dlv.path</code> in custom system properties of IDE?"}, {"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "reply_to_user": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1533199700, "post_id": 51616161, "comment_id": 90262077, "body": "@AlexanderZolotov My IDE: <code>GoLand 2018.1 Build #GO-181.4203.567, built on March 28, 2018</code> and I didn&#39;t override <code>dlv.path</code> because I&#39;ve found in settings only this: <a href=\"https://monosnap.com/file/GcaRNYTJ1x1RDsUVE43n5EJfocxHzV\" rel=\"nofollow noreferrer\">monosnap.com/file/GcaRNYTJ1x1RDsUVE43n5EJfocxHzV</a>"}, {"owner": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1533228862, "post_id": 51616161, "comment_id": 90280984, "body": "@VladimirKovpak then just upgrade it. 2018.1 is the outdated version, and <code>could not launch process EOF</code> in debugger was fixed months ago."}], "tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": true, "score": 2, "last_activity_date": 1533066408, "last_edit_date": 1533066408, "creation_date": 1533048321, "answer_id": 51616161, "question_id": 51615711, "link": "https://stackoverflow.com/questions/51615711/how-to-debug-while-running-from-goland-terminal/51616161#51616161", "title": "How to debug while running from GoLand Terminal", "body": "<p>Yes, it's possible to debug from GoLand! For me next approach is the best:</p>\n\n<p>1) For example we have <code>x.go</code>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    name, ending := \"World\", \"!\"\n    ending2 := `)`\n    fmt.Printf(\"Hello %s %s%s \\n\", name, ending, ending2)\n}\n</code></pre>\n\n<p>2) Edit your debug configuration:</p>\n\n<p><a href=\"https://i.stack.imgur.com/W1Uwj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W1Uwj.png\" alt=\"enter image description here\"></a> </p>\n\n<p>3) Run in console next command:</p>\n\n<pre><code>go build -gcflags='-N -l' x.go \\\n    &amp;&amp; dlv --listen=:2345 --headless=true --api-version=2 exec ./x\n</code></pre>\n\n<p>4) Now place your breakpoint and hit \"debug\" button.</p>\n\n<p><strong><a href=\"https://monosnap.com/file/aDJXVaE2EM1kb9GdjID70XDo9M0XHQ\" rel=\"nofollow noreferrer\">Here</a></strong> you can find <strong>video</strong> how it looks for me.</p>\n"}, {"comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1533299752, "post_id": 51661068, "comment_id": 90308081, "body": "This only works for single file configurations and your project is not in the correct GOPATH which means when you want to use packages, this will fail. We already discussed this in the previous answer. Also the use case presented worked from 2017.3"}, {"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 1, "creation_date": 1533322527, "post_id": 51661068, "comment_id": 90320362, "body": "@dlsniper I&#39;ve updated my answer: changed GOPATH and &quot;Run kind&quot;. Does it look better for you?"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 1, "creation_date": 1533334602, "post_id": 51661068, "comment_id": 90324561, "body": "Yeah, it looks great! Thank you!"}], "tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 1, "last_activity_date": 1533322213, "last_edit_date": 1533322213, "creation_date": 1533238935, "answer_id": 51661068, "question_id": 51615711, "link": "https://stackoverflow.com/questions/51615711/how-to-debug-while-running-from-goland-terminal/51661068#51661068", "title": "How to debug while running from GoLand Terminal", "body": "<p>It's super easy in <code>GoLand</code>!</p>\n\n<p>1) For example we have <code>x.go</code>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    name, ending := \"World\", \"!\"\n    ending2 := `)`\n    fmt.Printf(\"Hello %s %s%s \\n\", name, ending, ending2)\n}\n</code></pre>\n\n<p>2) Set <code>GOPATH</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8fHWp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8fHWp.png\" alt=\"enter image description here\"></a></p>\n\n<p>3) Edit your debug configuration. Set <code>Run kind</code> to directory with purpose to debug all go files in directory:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jAjRC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jAjRC.png\" alt=\"enter image description here\"></a></p>\n\n<p>4) Now place your breakpoint and hit \"debug\" button.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lkp7u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lkp7u.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><a href=\"https://monosnap.com/file/UpNfzqKuv8MHTa0iruoAOnuIejPqqJ\" rel=\"nofollow noreferrer\">Here</a></strong> you can find <strong>video</strong> how it looks for me.</p>\n"}], "owner": {"reputation": 89, "user_id": 10123374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ef45474ba37378f0360a3c54a80e2?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/10123374/javier-salas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1517, "favorite_count": 1, "accepted_answer_id": 51616161, "answer_count": 3, "score": 2, "last_activity_date": 1533322213, "creation_date": 1533047055, "last_edit_date": 1533048126, "question_id": 51615711, "link": "https://stackoverflow.com/questions/51615711/how-to-debug-while-running-from-goland-terminal", "title": "How to debug while running from GoLand Terminal", "body": "<p>Is possible to debug from terminal (included in GoLand IDE), what I want to do is to stop in a break point when you run a .go file from the terminal.\nThis because I want to run the script sending parameters to go to validate if parameters has been received to the .go script.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TTwNT.png\" rel=\"nofollow noreferrer\">GoLand Breakpoint</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/fBRri.png\" rel=\"nofollow noreferrer\">GoLand Terminal</a></p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "jpeg", "automl"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533042887, "post_id": 51614091, "comment_id": 90193837, "body": "Try to view the image on browser using <code>&quot;&lt;html&gt;&lt;body&gt;&lt;img src=\\&quot;data:image&#47;png;base64,&quot; + imgBase64Str + &quot;\\&quot; &#47;&gt;&lt;&#47;body&gt;&lt;&#47;html&gt;&quot;</code> in response."}, {"owner": {"reputation": 31, "user_id": 9958354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SKva.jpg?s=128&g=1", "display_name": "Drostanolone", "link": "https://stackoverflow.com/users/9958354/drostanolone"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533043759, "post_id": 51614091, "comment_id": 90194381, "body": "Thanks, I just put in a front end with your script and the image renders perfectly, in the same way the S3 upload is fine.  But, still, when posting it in the payload to the API it dies, and I can&#39;t see a pattern in the images in which it fails"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533043908, "post_id": 51614091, "comment_id": 90194498, "body": "May be something wrong when you are creating a payload. Can try to post the image directly."}, {"owner": {"reputation": 31, "user_id": 9958354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SKva.jpg?s=128&g=1", "display_name": "Drostanolone", "link": "https://stackoverflow.com/users/9958354/drostanolone"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533044583, "post_id": 51614091, "comment_id": 90194957, "body": "I think you are write, it is the payload creation.  It only accepts it in JSON format with base64 images.  I just tried changing the payload quotes but still the same problem:  \t<code>payload := fmt.Sprintf(&quot;{&#39;payload&#39;: {&#39;image&#39;: {&#39;imageBytes&#39;: &#39;%v&#39;},}}&quot;, imgBase64Str)</code>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533045186, "post_id": 51614091, "comment_id": 90195366, "body": "May be there is an extra comma in the payload json <code>{&quot;payload&quot;: {&quot;image&quot;: {&quot;imageBytes&quot;: &quot;%v&quot;}}}</code>. Remove comma and then try to post the payload"}, {"owner": {"reputation": 31, "user_id": 9958354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SKva.jpg?s=128&g=1", "display_name": "Drostanolone", "link": "https://stackoverflow.com/users/9958354/drostanolone"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533047417, "post_id": 51614091, "comment_id": 90196940, "body": "I tried that, the extra comma doesn&#39;t make sense, but it&#39;s in the Docs for automl and the only way it works.... <a href=\"https://cloud.google.com/vision/automl/docs/predict#automl-nl-example-cli\" rel=\"nofollow noreferrer\">cloud.google.com/vision/automl/docs/&hellip;</a>  --- EDIT, actually it does work with or without the comma, but same issue"}, {"owner": {"reputation": 31, "user_id": 9958354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SKva.jpg?s=128&g=1", "display_name": "Drostanolone", "link": "https://stackoverflow.com/users/9958354/drostanolone"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533047570, "post_id": 51614091, "comment_id": 90197060, "body": "I also tried resizing it in go, then sending the resized image.  That fails.  But, resizing it manually on the command line, then sending the resized version works.  My have to kludge some exec.Command in it as a last resort"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533047599, "post_id": 51614091, "comment_id": 90197084, "body": "yes the payload json was correct. And the docs shows the way to upload the json in the same format you are using."}, {"owner": {"reputation": 31, "user_id": 9958354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SKva.jpg?s=128&g=1", "display_name": "Drostanolone", "link": "https://stackoverflow.com/users/9958354/drostanolone"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533047804, "post_id": 51614091, "comment_id": 90197230, "body": "This kludge works <code>exec.Command(&quot;convert&quot;, &quot;-resize&quot;, &quot;200%&quot;, filename, resized).Run()</code> But, resizing it in GO using <a href=\"https://github.com/nfnt/resize\" rel=\"nofollow noreferrer\">github.com/nfnt/resize</a> does not.  Shame I have to have it on lambda, so I can&#39;t do the exec.... going to keep playing with it, thanks so far"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533048032, "post_id": 51614091, "comment_id": 90197413, "body": "The general process should also work. May be when you are initializing the buffer it goes wrong. Use <code>bytes.NewReader([]byte(payload))</code> to convert the payload to io.reader."}, {"owner": {"reputation": 31, "user_id": 9958354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SKva.jpg?s=128&g=1", "display_name": "Drostanolone", "link": "https://stackoverflow.com/users/9958354/drostanolone"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533050359, "post_id": 51614091, "comment_id": 90199067, "body": "good idea, but sadly no go. It seems to function with both types of buffer, but the API still only accepts all images if i put it through imagemagick.  Maybe I am going to put it on EC2 for now and just do the resize until they start building the official APIs"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9958354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SKva.jpg?s=128&g=1", "display_name": "Drostanolone", "link": "https://stackoverflow.com/users/9958354/drostanolone"}, "is_accepted": false, "score": 1, "last_activity_date": 1533129826, "creation_date": 1533129826, "answer_id": 51634473, "question_id": 51614091, "link": "https://stackoverflow.com/questions/51614091/encoding-a-file-to-send-to-google-automl/51634473#51634473", "title": "Encoding a file to send to Google AutoML", "body": "<p>I believe I fixed it.</p>\n\n<p>I looked in the Google docs again and for the speech to text (which is a different API) it says to do <code>encode64 -w 0</code> </p>\n\n<p>So, looking in Go docs, it seems <code>RawStdEncoding</code> is right to use to replicate this behaviour, not <code>StdEncoding</code></p>\n\n<p>No image failures yet.  Hope this helps someone else one day.</p>\n"}], "owner": {"reputation": 31, "user_id": 9958354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SKva.jpg?s=128&g=1", "display_name": "Drostanolone", "link": "https://stackoverflow.com/users/9958354/drostanolone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533129826, "creation_date": 1533042308, "last_edit_date": 1533069556, "question_id": 51614091, "link": "https://stackoverflow.com/questions/51614091/encoding-a-file-to-send-to-google-automl", "title": "Encoding a file to send to Google AutoML", "body": "<p>I am writing a golang script to send an image to the prediction engine of Google AutoML API.</p>\n\n<p>It accepts most files using the code below, but certain .jpeg or .jpeg it returns error 500 saying invalid file.  Mostly it works, but I can't figure out the exceptions.  They are perfectly valid jpg's.</p>\n\n<p>I am encoding the payload using EncodeToString.</p>\n\n<p>Among other things, I have tried decoding it, saving it to a PNG, nothing seems to work.  It doesn't like some images.</p>\n\n<p>I wonder if I have an error in my method?  Any help would be really appreciated.  Thanks</p>\n\n<p>PS the file saves to the filesystem and uploads to S3 just fine.  It's just the encoding to a string when it goes to Google that it fails.</p>\n\n<pre><code>imgFile, err := os.Open(filename)\nif err != nil {\n    fmt.Println(err)\n}\n\nimg, fname, err := image.Decode(imgFile)\nif err != nil {\n    fmt.Println(fname)\n}\n\nbuf := new(bytes.Buffer)\nerr = jpeg.Encode(buf, img, nil)\n\n// Encode as base64.\nimgBase64Str := base64.StdEncoding.EncodeToString(buf.Bytes())\n\ndefer imgFile.Close()\n\npayload := fmt.Sprintf(`{\"payload\": {\"image\": {\"imageBytes\": \"%v\"},}}`, imgBase64Str)\n\n// send as a byte\npay := bytes.NewBuffer([]byte(payload))\nreq, err := http.NewRequest(http.MethodPost, URL.String(), pay)\n</code></pre>\n"}, {"tags": ["go", "buffer", "channel", "channels"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1533042214, "post_id": 51613955, "comment_id": 90193358, "body": "Because the channel c is unbuffered. Unbuffered channels don&#39;t buffer messages by definition."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533042374, "post_id": 51613955, "comment_id": 90193475, "body": "What does this <code>channel c buffered out</code> mean. What you are expecting in your code."}, {"owner": {"reputation": 95, "user_id": 8774650, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v89qZfm8_YQ/AAAAAAAAAAI/AAAAAAAAEQU/BDO9LcdTJ_Y/photo.jpg?sz=128", "display_name": "luffy", "link": "https://stackoverflow.com/users/8774650/luffy"}, "edited": false, "score": 0, "creation_date": 1533048228, "post_id": 51613955, "comment_id": 90197586, "body": "I was expecting an error- <code>fatal error: all goroutines are asleep - deadlock!</code> This occurs when there is a block when the buffer is full. Since channel <code>c</code> has size 1, sending the second value should have given the above error."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533058240, "post_id": 51613955, "comment_id": 90203497, "body": "It will not report error until there is someone to receive the value on other side which is your case"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1533060043, "post_id": 51613955, "comment_id": 90204408, "body": "Check this code <a href=\"https://play.golang.org/p/dTekL0kIOHW\" rel=\"nofollow noreferrer\">play.golang.org/p/dTekL0kIOHW</a> it will not show error But this will <a href=\"https://play.golang.org/p/cSerXev2vBb\" rel=\"nofollow noreferrer\">play.golang.org/p/cSerXev2vBb</a>. Since second code will wait for value to be send from the channel."}, {"owner": {"reputation": 95, "user_id": 8774650, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v89qZfm8_YQ/AAAAAAAAAAI/AAAAAAAAEQU/BDO9LcdTJ_Y/photo.jpg?sz=128", "display_name": "luffy", "link": "https://stackoverflow.com/users/8774650/luffy"}, "edited": false, "score": 0, "creation_date": 1533115239, "post_id": 51613955, "comment_id": 90223447, "body": "Got it. Thanks for the help!"}], "answers": [{"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 1, "last_activity_date": 1533061897, "creation_date": 1533061897, "answer_id": 51619914, "question_id": 51613955, "link": "https://stackoverflow.com/questions/51613955/go-tutorial-channels-and-buffered-channels/51619914#51619914", "title": "Go tutorial: Channels and Buffered Channels", "body": "<p>Just because a write can\u2019t succeed immediately, you won\u2019t get the \u201cdeadlock\u201d error so long as there\u2019s some other goroutine that can run.</p>\n\n<p>Let\u2019s imagine a scheduling model where a <code>go</code> function immediately starts the goroutine and makes as much forward progress as it can before yielding to someone else.  Then this will happen:</p>\n\n<ol>\n<li>The program will call <code>sum()</code> for the first half of the list, calculate the sum, and try to write it to the channel, but since there is no listener, it will block.</li>\n<li>The program will call <code>sum()</code> for the second half of the list, calculate the sum, and try to write it to the channel, but since there is no listener, it will block.</li>\n<li><code>main()</code> will try to read from the channel, wakes up one of the previous goroutines, and gets the value from it.</li>\n<li><code>main()</code> will try to read from the channel, wakes up the other blocked goroutine, and gets the value from it.</li>\n<li>Nobody\u2019s blocked on channel input or output any more and all of the goroutines (including <code>main()</code>) can run to completion.</li>\n</ol>\n\n<p>You can do the same exercise if you pretend <code>go</code> just schedules something in the background and continues running the main goroutine.  The important thing is that as soon as there\u2019s a paired read and write on the same channel, both will proceed.</p>\n"}], "owner": {"reputation": 95, "user_id": 8774650, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v89qZfm8_YQ/AAAAAAAAAAI/AAAAAAAAEQU/BDO9LcdTJ_Y/photo.jpg?sz=128", "display_name": "luffy", "link": "https://stackoverflow.com/users/8774650/luffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 51619914, "answer_count": 1, "score": -2, "last_activity_date": 1533061897, "creation_date": 1533041868, "last_edit_date": 1533059832, "question_id": 51613955, "link": "https://stackoverflow.com/questions/51613955/go-tutorial-channels-and-buffered-channels", "title": "Go tutorial: Channels and Buffered Channels", "body": "<p>Why does not the channel <em>c</em> buffered out when the second value is sent via another go routine and the first value sent isn't received? </p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc sum(s []int, c chan int) {\n    sum := 0\n    for _, v := range s {\n        sum += v\n    }\n    c &lt;- sum // send sum to c   \n}\n\nfunc main() {\n    s := []int{7, 2, 8, -9, 4, 0}\n    c := make(chan int)\n    go sum(s[:len(s)/2], c)\n    go sum(s[len(s)/2:], c)\n    x, y :=  &lt;-c ,&lt;-c// receive from c\n    fmt.Println(x,y ,x+y)\n}\n</code></pre>\n\n<p>What I was expecting is an error- </p>\n\n<blockquote>\n  <p>fatal error: all goroutines are asleep - deadlock!</p>\n</blockquote>\n\n<p>This occurs when there is a block when the buffer is full. Since channel c has size 1, sending the second value should have given the above error.</p>\n\n<p>What is happening in above code ?</p>\n"}, {"tags": ["go", "swagger", "go-swagger"], "comments": [{"owner": {"reputation": 111, "user_id": 1542778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fc3444375d06a3f970671917ffdb42?s=128&d=identicon&r=PG", "display_name": "jesusnoseq", "link": "https://stackoverflow.com/users/1542778/jesusnoseq"}, "edited": false, "score": 0, "creation_date": 1533064837, "post_id": 51613772, "comment_id": 90206651, "body": "Is this correct?           &quot;schema:             type: string&quot; Why not just   &quot;type: string&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "edited": false, "score": 0, "creation_date": 1534427099, "post_id": 51619782, "comment_id": 90708440, "body": "can you please explain how I can define file type request param in above GetUser Struct?"}, {"owner": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "edited": false, "score": 0, "creation_date": 1534572093, "post_id": 51619782, "comment_id": 90762048, "body": "Okay @Lansana . I have added param in GetUser struct like below:                                       // UserFile that identifies a user.     //     // in: formData     // type: file     UserFile multipart.File <code>json:&quot;user_file&quot;</code> which generates swagger json code like this {             &quot;$ref&quot;: &quot;#/definitions/File&quot;,             &quot;x-go-name&quot;: &quot;UserFile&quot;,             &quot;description&quot;: &quot;UserFile that identifies a user.&quot;,             &quot;name&quot;: &quot;user_file&quot;,             &quot;in&quot;: &quot;formData&quot;           }"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "edited": false, "score": 0, "creation_date": 1534780019, "post_id": 51619782, "comment_id": 90818655, "body": "Please update your answer with this code in its entirety."}], "tags": [], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "is_accepted": true, "score": 1, "last_activity_date": 1533061329, "creation_date": 1533061329, "answer_id": 51619782, "question_id": 51613772, "link": "https://stackoverflow.com/questions/51613772/swagger-parameter-issue/51619782#51619782", "title": "Swagger parameter issue", "body": "<p>Your example is incomplete. However, using what you have, your code should look something along the lines of this in its simplest form:</p>\n\n<pre><code>// swagger:parameters GetUser\ntype GetUser struct {\n    // UserId that identifies a user.\n    //\n    // in: query\n    UserId string `json:\"user_id\"`\n}\n\n// Returns a user.\n// swagger:response UserResponse\ntype UserResponse struct { \n    // in: body\n    Body struct {}\n}\n\n// swagger:route GET /user_list GetUser\n//\n// Get a user profile.\n//\n// Responses:\n//      200: UserResponse\nrouter.Get(\"/user_list\", handler.GetUser)\n</code></pre>\n\n<p>Notice how we have three things:</p>\n\n<ol>\n<li>The request object</li>\n<li>The response object</li>\n<li>The route that uses both the request and response object</li>\n</ol>\n"}], "owner": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1462, "favorite_count": 0, "accepted_answer_id": 51619782, "answer_count": 1, "score": 0, "last_activity_date": 1533061329, "creation_date": 1533041266, "last_edit_date": 1533041597, "question_id": 51613772, "link": "https://stackoverflow.com/questions/51613772/swagger-parameter-issue", "title": "Swagger parameter issue", "body": "<p>Below is my code:</p>\n\n<pre><code>// swagger:route GET /user_list get_user\n//\n// Get a user profile\n// Parameters:\n//  user_id: userParam\n// Consumes:\n// - application/json\n// Produces:\n// - application/json\n//\n// Responses:\n//      200: UserResponse\n</code></pre>\n\n<p>In my model for request I have added param like below:</p>\n\n<pre><code>// swagger:parameters userParam\ntype UserRequest struct {\n    // aaaa\n    // in: query\n    UserId string `json:\"user_id\"`\n}\n</code></pre>\n\n<p>I am getting below error when I generate swagger json.</p>\n\n<pre><code>panic: assignment to entry in nil map\n\ngoroutine 1 [running]:\ngithub.com/go-swagger/go-swagger/scan.(*setOpParams).Parse(0xc428986a20, 0xc426439f30, 0x1, 0x1, 0x0, 0x0)\n    /home/sotsys-056/go_10/src/github.com/go-swagger/go-swagger/scan/route_params.go:137 +0x635\ngithub.com/go-swagger/go-swagger/scan.(*tagParser).Parse(0xc426e873d0, 0xc426439f30, 0x1, 0x1, 0x0, 0xc426439f30)\n    /home/sotsys-056/go_10/src/github.com/go-swagger/go-swagger/scan/scanner.go:526 +0x52\n</code></pre>\n\n<p>When I remove parameters section it works fine I am not generate swagger json but with parameters I am not able to generate it.</p>\n\n<p>I have also tried these ways too.</p>\n\n<pre><code>// Parameters:\n//      - user_id: [in:query required:true type:string] Description goes her\n\nparameters:\n        - name: user_id\n          in: query\n          description: this argument is a string\n          schema:\n            type: string\n</code></pre>\n"}, {"tags": ["go", "activemq", "stomp", "amazon-mq"], "answers": [{"tags": [], "owner": {"reputation": 237, "user_id": 1946459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d4ba3f1a4f7308f53ece5bb4872bb505?s=128&d=identicon&r=PG", "display_name": "xaxes", "link": "https://stackoverflow.com/users/1946459/xaxes"}, "is_accepted": true, "score": 1, "last_activity_date": 1533038930, "creation_date": 1533038930, "answer_id": 51613071, "question_id": 51613070, "link": "https://stackoverflow.com/questions/51613070/connect-to-activemq-via-stomp-in-go/51613071#51613071", "title": "Connect to ActiveMQ via STOMP in Go", "body": "<p>AmazonMQ uses stomp+ssl proto, so the proper way to connect to it is to setup TLS connection on your own first:</p>\n\n<pre><code>func (s *STOMP) Init() error {\n    netConn, err := tls.Dial(\"tcp\", \"host:61614\", &amp;tls.Config{})\n    if err != nil {\n        return errors.Wrap(err, \"dial tls\")\n    }\n    stompConn, err := stomp.Connect(netConn)\n    if err != nil {\n        return errors.Wrap(err, \"dial to server\")\n    }\n\n    s.conn = stompConn\n\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://github.com/go-stomp/stomp/wiki/Connect-using-TLS\" rel=\"nofollow noreferrer\">https://github.com/go-stomp/stomp/wiki/Connect-using-TLS</a></p>\n"}], "owner": {"reputation": 237, "user_id": 1946459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d4ba3f1a4f7308f53ece5bb4872bb505?s=128&d=identicon&r=PG", "display_name": "xaxes", "link": "https://stackoverflow.com/users/1946459/xaxes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1588, "favorite_count": 0, "accepted_answer_id": 51613071, "answer_count": 1, "score": 1, "last_activity_date": 1533038930, "creation_date": 1533038930, "question_id": 51613070, "link": "https://stackoverflow.com/questions/51613070/connect-to-activemq-via-stomp-in-go", "title": "Connect to ActiveMQ via STOMP in Go", "body": "<p>Trying to connect to ActiveMQ instance on AWS via <code>github.com/go-stomp/stomp</code> library.</p>\n\n<p>The following code throws <code>invalid command</code> error:</p>\n\n<pre><code>func (s *STOMP) Init() error {\n    netConn, err := stomp.Dial(\"tcp\", \"host:61614\")\n    if err != nil {\n        return errors.Wrap(err, \"dial to server\")\n    }\n\n    s.conn = netConn\n\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1533038324, "post_id": 51612799, "comment_id": 90190500, "body": "Go does not allow you to do this. You can use a package like <a href=\"https://godoc.org/go/types\" rel=\"nofollow noreferrer\"><code>go&#47;types</code></a> to examine the source of a package to list exported variables, functions, etc."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1533042297, "post_id": 51612799, "comment_id": 90193413, "body": "Are you familar with <a href=\"https://godoc.org/golang.org/x/tools/cmd/godoc\" rel=\"nofollow noreferrer\">godoc</a>?"}, {"owner": {"reputation": 779, "user_id": 5082396, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ecb90aafcaa063edf9fe1161289be637?s=128&d=identicon&r=PG&f=1", "display_name": "pro", "link": "https://stackoverflow.com/users/5082396/pro"}, "edited": false, "score": 0, "creation_date": 1533045407, "post_id": 51612799, "comment_id": 90195530, "body": "why the down vote. this is a legit question for someone coming from another language."}], "answers": [{"tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": true, "score": 1, "last_activity_date": 1533048546, "last_edit_date": 1533048546, "creation_date": 1533038540, "answer_id": 51612957, "question_id": 51612799, "link": "https://stackoverflow.com/questions/51612799/how-to-peek-through-imported-packages-in-golang/51612957#51612957", "title": "How to peek through imported packages in Golang", "body": "<p>In <a href=\"/questions/tagged/javascript\" class=\"post-tag\" title=\"show questions tagged &#39;javascript&#39;\" rel=\"tag\">javascript</a> when you use something like <code>const assert = require('assert');</code> you are importing <code>object</code> which was exported from <code>assert</code> script.</p>\n\n<p>But in <a href=\"/questions/tagged/go\" class=\"post-tag\" title=\"show questions tagged &#39;go&#39;\" rel=\"tag\"><img src=\"https://i.stack.imgur.com/sawHl.png\" height=\"16\" width=\"18\" alt=\"\" class=\"sponsor-tag-img\">go</a> <code>import</code> it's something like namespace which you're going to use in your package. And that's why you just can't do what you wish, because namespace it is not object instance.</p>\n\n<p>You can create object instance from <code>os</code> package and inspect it like in your example with <code>console.log()</code>, it should looks like:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    ps := os.ProcessState{}\n    fmt.Printf(\"%+v\", ps)\n}\n</code></pre>\n\n<p>With purpose to inspect whole <code>os</code> package you can check <a href=\"https://golang.org/pkg/os/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/</a>, here you can find all info about go packages (functions, structures, methods, constants, etc).</p>\n"}], "owner": {"reputation": 779, "user_id": 5082396, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ecb90aafcaa063edf9fe1161289be637?s=128&d=identicon&r=PG&f=1", "display_name": "pro", "link": "https://stackoverflow.com/users/5082396/pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 51612957, "answer_count": 1, "score": -1, "last_activity_date": 1533048546, "creation_date": 1533037979, "last_edit_date": 1533038029, "question_id": 51612799, "link": "https://stackoverflow.com/questions/51612799/how-to-peek-through-imported-packages-in-golang", "title": "How to peek through imported packages in Golang", "body": "<p>Programming languages such as Javascript allow you to peek through a library/package by just passing the package into <code>console.log()</code>.  I tried doing the same in Go, but that did not work.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"os\"\n\n\nfunc main() {\n    fmt.Print(os)\n}\n</code></pre>\n\n<p>Is this not the right approach? </p>\n"}, {"tags": ["python-3.x", "algorithm", "performance", "go", "yara"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1533036487, "post_id": 51611862, "comment_id": 90189267, "body": "Please use the benchmark framework offered by package <code>testing</code> in Go. (BTW I doubt you will find something more optimized than strings.Contains or byte.Contains)."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1533039973, "post_id": 51611862, "comment_id": 90191783, "body": "The needle is exactly 32-byte long. It means it gets asm optimization on 64-bit machines but not on 32-bit ones. Though I am amazed at Python3&#39;s speed."}], "answers": [{"comments": [{"owner": {"reputation": 2406, "user_id": 604515, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5a59cce890ffc226eddf1ad65602fe8f?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/604515/willem"}, "edited": false, "score": 0, "creation_date": 1533118750, "post_id": 51620023, "comment_id": 90225777, "body": "Thanks for showing a counter example! Similar results here. It&#39;s still puzzling me what makes the difference, so will do more testing."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1533062347, "creation_date": 1533062347, "answer_id": 51620023, "question_id": 51611862, "link": "https://stackoverflow.com/questions/51611862/go-strings-contains-2x-slower-than-python3/51620023#51620023", "title": "Go strings.Contains() 2x slower than Python3?", "body": "<p>Why is Python 3 (24.79s) 4.5 times slower than Go (5.47s)? What results do you get?</p>\n\n<p><strong>Python</strong>:</p>\n\n<pre><code>$ cat contains.py\nimport time\nimport re\n\nRUNS = 10000\n\nif __name__ == '__main__':\n    # The Complete Works of William Shakespeare by William Shakespeare\n    # http://www.gutenberg.org/files/100/100-0.txt\n    file = '/home/peter/shakespeare.100-0.txt' # 'data.php'\n    with open(file) as fh:\n        testString = fh.read()\n\n    def do():\n        return \"Means to immure herself and not be seen.\" in testString\n\n    start = time.time()\n    for i in range(RUNS):\n        _ = do()\n    duration = time.time() - start\n    print(\"Python: %.2fs\" % duration)\n    print(do())\n$ python3 --version\nPython 3.6.5\n$ python3 contains.py\nPython: 24.79s\nTrue\n$ \n</code></pre>\n\n<p><strong>Go</strong>:</p>\n\n<pre><code>$ cat contains.go\npackage main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"strings\"\n    \"time\"\n)\n\nconst (\n    runs = 10000\n)\n\nfunc main() {\n    // The Complete Works of William Shakespeare by William Shakespeare\n    // http://www.gutenberg.org/files/100/100-0.txt\n    fname := `/home/peter/shakespeare.100-0.txt` // \"data.php\"\n    testdata := readFile(fname)\n    needle := \"Means to immure herself and not be seen.\"\n    start := time.Now()\n\n    for i := 0; i &lt; runs; i++ {\n        _ = strings.Contains(testdata, needle)\n\n    }\n    duration := time.Now().Sub(start)\n    fmt.Printf(\"Go: %.2fs\\n\", duration.Seconds())\n\n    fmt.Println(strings.Contains(testdata, needle))\n    fmt.Println(strings.Index(testdata, needle))\n\n}\n\nfunc readFile(fname string) string {\n    data, err := ioutil.ReadFile(fname)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return string(data)\n}\n$ go version\ngo version devel +5332b5e75a Tue Jul 31 15:44:37 2018 +0000 linux/amd64\n$ go run contains.go\nGo: 5.47s\ntrue\n5837178\n$ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2406, "user_id": 604515, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5a59cce890ffc226eddf1ad65602fe8f?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/604515/willem"}, "is_accepted": true, "score": 0, "last_activity_date": 1533462967, "last_edit_date": 1533462967, "creation_date": 1533412049, "answer_id": 51689065, "question_id": 51611862, "link": "https://stackoverflow.com/questions/51611862/go-strings-contains-2x-slower-than-python3/51689065#51689065", "title": "Go strings.Contains() 2x slower than Python3?", "body": "<p>I've done more benchmarking with various string search implementations that I found on <a href=\"https://en.wikipedia.org/wiki/String-searching_algorithm\" rel=\"nofollow noreferrer\">Wikipedia</a>, such as:</p>\n\n<ul>\n<li><a href=\"https://github.com/cloudflare/ahocorasick\" rel=\"nofollow noreferrer\">https://github.com/cloudflare/ahocorasick</a></li>\n<li><a href=\"https://github.com/cubicdaiya/bms\" rel=\"nofollow noreferrer\">https://github.com/cubicdaiya/bms</a></li>\n<li><a href=\"https://github.com/kkdai/kmp\" rel=\"nofollow noreferrer\">https://github.com/kkdai/kmp</a></li>\n<li><a href=\"https://github.com/paddie/gokmp\" rel=\"nofollow noreferrer\">https://github.com/paddie/gokmp</a></li>\n<li><a href=\"https://github.com/hillu/go-yara\" rel=\"nofollow noreferrer\">https://github.com/hillu/go-yara</a> (Yara seems to implement Aho &amp; Corasick under the hood).</li>\n</ul>\n\n<p>Benchmark results (<a href=\"https://gist.github.com/gwillem/84228ec86953bf5c3ac2d0f01ad017d3\" rel=\"nofollow noreferrer\">code here</a>):</p>\n\n<pre><code>BenchmarkStringsContains-4         10000        208055 ns/op\nBenchmarkBMSSearch-4                1000       1856732 ns/op\nBenchmarkPaddieKMP-4                2000       1069495 ns/op\nBenchmarkKkdaiKMP-4                 1000       1440147 ns/op\nBenchmarkAhocorasick-4              2000        935885 ns/op\nBenchmarkYara-4                     1000       1237887 ns/op\n</code></pre>\n\n<p>Then, I benchmarked my practical use case of testing about 1100 signatures (100 regex, 1000 literals) against a 500KB no-match file, for both the native (<code>strings.Contains</code> and <code>regexp</code>) and the C-based Yara implementations:</p>\n\n<pre><code>BenchmarkScanNative-4              2     824328504 ns/op\nBenchmarkScanYara-4              300       5338861 ns/op\n</code></pre>\n\n<p>Even though C calls in Go are supposedly expensive, in these \"heavy\" operations the profit is remarkable. Side observation: it takes Yara just 5 times as much CPU time to match 1100 signatures instead of 1. </p>\n"}], "owner": {"reputation": 2406, "user_id": 604515, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5a59cce890ffc226eddf1ad65602fe8f?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/604515/willem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 1, "accepted_answer_id": 51689065, "answer_count": 2, "score": 0, "last_activity_date": 1533463199, "creation_date": 1533034908, "last_edit_date": 1533463199, "question_id": 51611862, "link": "https://stackoverflow.com/questions/51611862/go-strings-contains-2x-slower-than-python3", "title": "Go strings.Contains() 2x slower than Python3?", "body": "<p>Am converting a text pattern scanner from Python3 to Go1.10, but am surprised it is actually 2 times slower. Upon profiling, the culprit is in <code>strings.Contains()</code>. See the simple benchmarks below. Did I miss anything? Could you recommend a faster pattern search algorithm for Go that would perform better in this case? I'm not bothered about startup time, the same pattern will be used to scan millions of files. </p>\n\n<p>Py3 benchmark:</p>\n\n<pre><code>import time\nimport re\n\nRUNS = 10000\n\nif __name__ == '__main__':\n    with open('data.php') as fh:\n        testString = fh.read()\n\n    def do():\n        return \"576ad4f370014dfb1d0f17b0e6855f22\" in testString\n\n    start = time.time()\n    for i in range(RUNS):\n        _ = do()\n    duration = time.time() - start\n    print(\"Python: %.2fs\" % duration)\n</code></pre>\n\n<p>Go1.10 benchmark:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"strings\"\n    \"time\"\n)\n\nconst (\n    runs = 10000\n)\n\nfunc main() {\n    fname := \"data.php\"\n    testdata := readFile(fname)\n    needle := \"576ad4f370014dfb1d0f17b0e6855f22\"\n    start := time.Now()\n\n    for i := 0; i &lt; runs; i++ {\n        _ = strings.Contains(testdata, needle)\n\n    }\n    duration := time.Now().Sub(start)\n    fmt.Printf(\"Go: %.2fs\\n\", duration.Seconds())\n}\n\nfunc readFile(fname string) string {\n    data, err := ioutil.ReadFile(fname)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return string(data)\n}\n</code></pre>\n\n<p><code>data.php</code> is a 528KB file that can be <a href=\"https://raw.githubusercontent.com/gwillem/magento-malware-scanner/master/corpus/backend/3f34f51c981a9ddcfb0f41815c7dad49\" rel=\"nofollow noreferrer\">found here</a>.</p>\n\n<p>Output:</p>\n\n<pre><code>Go:     1.98s\nPython: 0.84s\n</code></pre>\n"}, {"tags": ["pointers", "inheritance", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1533033362, "post_id": 51611086, "comment_id": 90187281, "body": "Forget about trying traditional, inheritance based OOP in Go: It <b>does</b> <b>not</b> <b>work</b>, no matter how hard you try. Really. Redesign. Doing (or even mimicking) traditional OOP in Go will just lead to bugs, problems and pain. You gain <i>nothing</i> by doing it this way."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1533033602, "post_id": 51611086, "comment_id": 90187439, "body": "As @Volker says Golang not works like object oriented technology. There is a difference on how interface works in go."}, {"owner": {"reputation": 329, "user_id": 9005922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pO3dq.jpg?s=128&g=1", "display_name": "InFamous X", "link": "https://stackoverflow.com/users/9005922/infamous-x"}, "edited": false, "score": 0, "creation_date": 1533036109, "post_id": 51611086, "comment_id": 90189061, "body": "Thank you a lot, but can you show how?"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 9005922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pO3dq.jpg?s=128&g=1", "display_name": "InFamous X", "link": "https://stackoverflow.com/users/9005922/infamous-x"}, "edited": false, "score": 0, "creation_date": 1533035889, "post_id": 51611252, "comment_id": 90188920, "body": "Thank you! But this way <code>Type(r.prev_) == Brace</code>, not <code>Square</code>. In my first block of code am I right that <code>r.prev_</code> is now a copy of <code>s</code>?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 329, "user_id": 9005922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pO3dq.jpg?s=128&g=1", "display_name": "InFamous X", "link": "https://stackoverflow.com/users/9005922/infamous-x"}, "edited": false, "score": 1, "creation_date": 1533036269, "post_id": 51611252, "comment_id": 90189150, "body": "@InFamousX yes In go lang every thing is passed by value. So you are passing the copy of struct not struct itself."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 329, "user_id": 9005922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pO3dq.jpg?s=128&g=1", "display_name": "InFamous X", "link": "https://stackoverflow.com/users/9005922/infamous-x"}, "edited": false, "score": 1, "creation_date": 1533036314, "post_id": 51611252, "comment_id": 90189170, "body": "@InFamousX To compare the underlying values of interface you should use type assertion"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 12, "last_activity_date": 1534840051, "last_edit_date": 1534840051, "creation_date": 1533033009, "answer_id": 51611252, "question_id": 51611086, "link": "https://stackoverflow.com/questions/51611086/pointer-to-interface-is-not-an-interface-error/51611252#51611252", "title": "pointer to interface is not an interface error?", "body": "<p>As the error says:</p>\n\n<blockquote>\n  <p>cannot use &amp;s (type *Square) as type *Brace in assignment: *Brace is\n  pointer to interface, not interface</p>\n</blockquote>\n\n<p>An interface can wrap any type of value. But you are wraping the struct inside pointer type interface not an interface. That's not how interface works in golang.</p>\n\n<p>If you wants to pass the address of an struct. An interface can wrap the pointer to struct directly. There is no need of creating a pointer to an interface to achieve that.</p>\n\n<pre><code>type Brace interface {}\n\ntype Round struct {\n    prev_ Brace\n}\n\ntype Square struct {}\n\nfunc main() {\n    var r Round\n    var s Square\n    r.prev_ = &amp;s\n    fmt.Printf(\"%#v\", r)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/F1fzWT1_GcT\" rel=\"noreferrer\">Playground Example</a></p>\n\n<p>In Golang you should avoid passing a pointer to interface as:</p>\n\n<blockquote>\n  <p>The compiler will complain about this error but the situation can\n  still be confusing, because sometimes a pointer is necessary to\n  satisfy an interface. The insight is that although a pointer to a\n  concrete type can satisfy an interface, with one exception a pointer\n  to an interface can never satisfy an interface.</p>\n</blockquote>\n\n<p>Consider the variable declaration,</p>\n\n<pre><code>var w io.Writer\n</code></pre>\n\n<p>The printing function fmt.Fprintf takes as its first argument a value that satisfies io.Writer\u2014something that implements the canonical Write method. Thus we can write</p>\n\n<pre><code>fmt.Fprintf(w, \"hello, world\\n\")\n</code></pre>\n\n<p>If however we pass the address of w, the program will not compile.</p>\n\n<pre><code>fmt.Fprintf(&amp;w, \"hello, world\\n\") // Compile-time error.\n</code></pre>\n\n<blockquote>\n  <p>The one exception is that any value, even a pointer to an interface,\n  can be assigned to a variable of empty interface type (interface{}).\n  Even so, it's almost certainly a mistake if the value is a pointer to\n  an interface; the result can be confusing.</p>\n</blockquote>\n\n<p>Check it on <a href=\"https://play.golang.org/p/DtUzToDV0pq\" rel=\"noreferrer\">Go playground</a>. You will find the same error you are getting in your code snippet when trying to pass pointer to interface.</p>\n"}], "owner": {"reputation": 329, "user_id": 9005922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pO3dq.jpg?s=128&g=1", "display_name": "InFamous X", "link": "https://stackoverflow.com/users/9005922/infamous-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10291, "favorite_count": 2, "accepted_answer_id": 51611252, "answer_count": 1, "score": 2, "last_activity_date": 1534840051, "creation_date": 1533032458, "last_edit_date": 1533146833, "question_id": 51611086, "link": "https://stackoverflow.com/questions/51611086/pointer-to-interface-is-not-an-interface-error", "title": "pointer to interface is not an interface error?", "body": "<p>The following code works:</p>\n\n<pre><code>type Brace interface {}\n\ntype Round struct {\n    prev_ Brace\n}\n\ntype Square struct {}\n\nfunc main() {\n    var r Round\n    var s Square\n    r.prev_ = s\n}\n</code></pre>\n\n<p>Is it true that <code>r.prev_</code> is now a copy of <code>s</code>? How can I change it that Round will contain a pointer to Brace? This code doesn't work:</p>\n\n<pre><code>type Brace interface {}\n\ntype Round struct {\n    prev_ *Brace\n}\n\ntype Square struct {}\n\nfunc main() {\n    var r Round\n    var s Square\n    r.prev_ = &amp;s\n}\n</code></pre>\n\n<p>because of the error:</p>\n\n<blockquote>\n  <p>cannot use &amp;s (type *Square) as type *Brace in assignment:\n  *Brace is pointer to interface, not interface</p>\n</blockquote>\n"}, {"tags": ["file", "go"], "answers": [{"comments": [{"owner": {"reputation": 972, "user_id": 1260548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b2ca990a7888cda2671c3eb1b3161068?s=128&d=identicon&r=PG", "display_name": "Markus Tenghamn", "link": "https://stackoverflow.com/users/1260548/markus-tenghamn"}, "edited": false, "score": 0, "creation_date": 1533033093, "post_id": 51611198, "comment_id": 90187093, "body": "Beautiful, I figured I could use the <code>aws.WriteAtBuffer</code> but I was missing the <code>tr := tar.NewReader(bytes.NewReader(buf.Bytes()))</code> part. Will test to see if it works, if there is no better answer I&#39;ll mark this one as the correct one later."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 6, "last_activity_date": 1533032859, "creation_date": 1533032859, "answer_id": 51611198, "question_id": 51610048, "link": "https://stackoverflow.com/questions/51610048/how-to-keep-files-in-memory-transferring-files-between-servers-without-storing/51611198#51611198", "title": "How to keep files in memory - transferring files between servers without storing them locally", "body": "<p>This is mentioned in the <a href=\"https://godoc.org/github.com/aws/aws-sdk-go/service/s3/s3manager#Downloader.Download\" rel=\"noreferrer\">docs for <code>Download</code></a>:</p>\n\n<blockquote>\n  <p>The w io.WriterAt can be satisfied by an os.File to do multipart concurrent downloads, or in memory []byte wrapper using aws.WriteAtBuffer.</p>\n</blockquote>\n\n<p>So use an <a href=\"https://godoc.org/github.com/aws/aws-sdk-go/aws#WriteAtBuffer\" rel=\"noreferrer\"><code>aws.WriteAtBuffer</code></a> instead of an <code>*os.File</code>:</p>\n\n<pre><code>buf := new(aws.WriteAtBuffer)\n\nnumBytes, err := downloader.Download(buf, &amp;s3.GetObjectInput{\n    Bucket: aws.String(s3bucket),\n    Key:    aws.String(item),\n})\n\ntr := tar.NewReader(bytes.NewReader(buf.Bytes()))\n// ...\n</code></pre>\n"}], "owner": {"reputation": 972, "user_id": 1260548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b2ca990a7888cda2671c3eb1b3161068?s=128&d=identicon&r=PG", "display_name": "Markus Tenghamn", "link": "https://stackoverflow.com/users/1260548/markus-tenghamn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 1, "accepted_answer_id": 51611198, "answer_count": 1, "score": 1, "last_activity_date": 1533069656, "creation_date": 1533029403, "last_edit_date": 1533069656, "question_id": 51610048, "link": "https://stackoverflow.com/questions/51610048/how-to-keep-files-in-memory-transferring-files-between-servers-without-storing", "title": "How to keep files in memory - transferring files between servers without storing them locally", "body": "<p>I am in the process of writing a simple deployment tool which needs to take tar files from s3, extract them and then upload them to our staging server. I would like to do this without storing the files locally, keeping them in memory.</p>\n\n<p>Here is my code to download files from s3</p>\n\n<pre><code>func s3downloadFile(downloader *s3manager.Downloader, item string) {\n    localitem := strings.Replace(item, s3base, \"\", -1)\n    os.MkdirAll(path.Dir(localitem), os.ModePerm)\n    file, err := os.Create(localitem)\n    if err != nil {\n        exitErrorf(\"Unable to open file %q, %v\", err)\n    }\n\n    defer file.Close()\n\n    numBytes, err := downloader.Download(file,\n        &amp;s3.GetObjectInput{\n            Bucket: aws.String(s3bucket),\n            Key:    aws.String(item),\n        })\n    if err != nil {\n        exitErrorf(\"Unable to download item %q, %v\", item, err)\n    }\n\n    fmt.Println(\"Downloaded\", file.Name(), numBytes, \"bytes\")\n}\n</code></pre>\n\n<p>I would like to avoid having to create the directories and files in this example and just keep everything in memory. I left out the step that extracts the files from my code. The next step would be to upload the files with <a href=\"https://github.com/bramvdbogaerde/go-scp\" rel=\"nofollow noreferrer\">go-scp</a> like so:</p>\n\n<pre><code>// Finaly, copy the file over\n// Usage: CopyFile(fileReader, remotePath, permission)\n\nclient.CopyFile(f, \"/path/to/remote/file\", \"0655\")\n</code></pre>\n\n<p>My question would then focus on the <code>file, err := os.Create(localitem)</code> part of this code, how can I keep a filereader in memory instead of storing the file locally.</p>\n"}, {"tags": ["multithreading", "go", "design-patterns", "api-design"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1533029540, "post_id": 51609517, "comment_id": 90184775, "body": "Instead of having everything implemented as methods, I&#39;d have a &quot;worker pool&quot; expose a channel on which you&#39;d submit jobs to it. Then either have the pool to export another channel\u2014for the results, or have each job carry such a channel with it. Then the question of requeueing jobs becomes a matter of shoveling them back to the pool&#39;s channel when they get ready. This is actually a pretty standard pattern."}, {"owner": {"reputation": 1, "user_id": 7089107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c224b50259cfcc39f9594fc234dacccc?s=128&d=identicon&r=PG&f=1", "display_name": "allrik", "link": "https://stackoverflow.com/users/7089107/allrik"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533030556, "post_id": 51609517, "comment_id": 90185456, "body": "Can you tell me more precise about this standard pattern? How is it called? I would like to know more about it..."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533043759, "post_id": 51609517, "comment_id": 90194379, "body": "Sorry, it&#39;s not a pattern in the sense of that GoF book, it&#39;s in the original meaning of that word ;-)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533045253, "post_id": 51609517, "comment_id": 90195407, "body": "<a href=\"https://play.golang.org/p/nuEHlh_6-GV\" rel=\"nofollow noreferrer\">Here</a> is a skeleton implementation of a pool which processes tasks, returns each one back along with the outcome of its execution on the channel submitted by the task (they all use the same channel but this is not a requirement), and the code in the main goroutine puts each completed task back into the pool for re-execution. This all happens until 42 tasks are &quot;round-tripped&quot; this way (to actually have a halt condition for out program)."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533045326, "post_id": 51609517, "comment_id": 90195468, "body": "In your particular case I see no fit to ever have any special code to &quot;reschedule&quot; tasks as this can be done right by the &quot;worker pool&quot; itself. So basically you shovel tasks into it, it processes each &quot;new&quot; task\u2014as they come it\u2014and then re-posts each completed task back into itself."}, {"owner": {"reputation": 1, "user_id": 7089107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c224b50259cfcc39f9594fc234dacccc?s=128&d=identicon&r=PG&f=1", "display_name": "allrik", "link": "https://stackoverflow.com/users/7089107/allrik"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533103306, "post_id": 51609517, "comment_id": 90217046, "body": "Thank you for the code example. So you mean, that I have to modify the given API to succeed?"}, {"owner": {"reputation": 1, "user_id": 7089107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c224b50259cfcc39f9594fc234dacccc?s=128&d=identicon&r=PG&f=1", "display_name": "allrik", "link": "https://stackoverflow.com/users/7089107/allrik"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533104587, "post_id": 51609517, "comment_id": 90217580, "body": "I also notice, that there&#39;s only one worker working in the pool, am I right? The newWorkerPool method calls run as a subroutine only once..."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533105944, "post_id": 51609517, "comment_id": 90218228, "body": "Re. your 2nd question\u2014yes, it actually has a single worker; having <code>N</code> workers in the simplest case amounts to executing <code>go pool.run()</code> <code>N</code> times. This pattern actually has a nifty name: <a href=\"https://blog.golang.org/pipelines#TOC_4.\" rel=\"nofollow noreferrer\">&quot;fan-out&quot;</a>. Re. your 1st question\u2014I&#39;m afraid you might be a victim of a common &quot;give me a complete solution&quot; syndrome while you&#39;re a programmer and are supposed to actually program. Please read <a href=\"https://whathaveyoutried.com\" rel=\"nofollow noreferrer\">this</a> carefully and try to work on this issue. Have fun!"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533106191, "post_id": 51609517, "comment_id": 90218354, "body": "Regarding concurrency and the use of channels, please also read <a href=\"https://blog.golang.org/advanced-go-concurrency-patterns\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://blog.golang.org/go-concurrency-patterns-timing-out-and\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://blog.golang.org/index\" rel=\"nofollow noreferrer\">this</a> in general\u2014it&#39;s indispensible."}, {"owner": {"reputation": 1, "user_id": 7089107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c224b50259cfcc39f9594fc234dacccc?s=128&d=identicon&r=PG&f=1", "display_name": "allrik", "link": "https://stackoverflow.com/users/7089107/allrik"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1533107016, "post_id": 51609517, "comment_id": 90218797, "body": "Thanks a lot for your help. I think I can move on from here... :-)"}], "owner": {"reputation": 1, "user_id": 7089107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c224b50259cfcc39f9594fc234dacccc?s=128&d=identicon&r=PG&f=1", "display_name": "allrik", "link": "https://stackoverflow.com/users/7089107/allrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533069672, "creation_date": 1533027897, "last_edit_date": 1533069672, "question_id": 51609517, "link": "https://stackoverflow.com/questions/51609517/given-this-worker-api-how-do-i-create-an-infinite-loop-of-jobs", "title": "Given this Worker-API, how do I create an infinite loop of Jobs?", "body": "<p>Since I wasn't able to find anything about my specific problem, I'm going to ask this for myself here. </p>\n\n<p>I've got this API for workers in Go: </p>\n\n<pre><code>package workerapi\nimport (...)\n\nvar MaxWorkers int = 1 &lt;&lt; 16\n\ntype Job interface {\n    Run()\n}\n\ntype Pool struct {\n    workers  sync.WaitGroup\n    jobqueue chan Job\n}\n\nfunc NewPool(n int) (*Pool, error) {\n    if n &lt;= 0 {\n        return nil, fmt.Errorf(\"worker: number of workers(n=%d) is &lt;= 0\", n)\n    }\n    if n &gt; MaxWorkers {\n        return nil, fmt.Errorf(\"worker: number of workers(n=%d) is &gt; MaxWorkers(%d)\", n, MaxWorkers)\n    }\n\n    p := &amp;Pool{jobqueue: make(chan Job)}\n\n    p.workers.Add(n)\n    for i := 1; i &lt;= n; i++ {\n        go p.worker()\n    }\n    return p, nil\n}\n\nfunc (p *Pool) worker() {\n    for job := range p.jobqueue {\n        job.Run()\n    }\n\n    p.workers.Done()\n}\n\nfunc (p *Pool) SubmitAndWait(jobs ...Job) {\n    for _, job := range jobs {\n        p.jobqueue &lt;- job\n    }\n    close(p.jobqueue)\n    p.workers.Wait()\n}\n</code></pre>\n\n<p>My task is now to build an infinite loop of Jobs. This is, what I have so far: </p>\n\n<pre><code>package workertest\n\nimport (...)\n\ntype job struct {\n    id int\n    // later on, these will contain more data\n}\n\nfunc (j job) Run() {\n    sleep := rand.Intn(100)\n    fmt.Printf(\"job %3d: Start   (%dms)\\n\", j.id, sleep)\n    time.Sleep(time.Duration(sleep) * time.Millisecond)\n    // here some more calculation\n    fmt.Printf(\"job %3d: Stopped (%dms)\\n\", j.id, sleep)\n}\n\nfunc Start(args []string) {\n    nrJobs := len(args)\n    const nrWorkers = 5\n\n    fmt.Printf(\"Starting   %3d workers\\n\", nrWorkers)\n    p, err := workerapi.NewPool(nrWorkers)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Printf(\"Submitting %3d jobs\\n\", nrJobs)\n    jobs := make([]workerapi.Job, nrJobs)\n    for i := 0; i &lt; nrJobs; i++ {\n        jobs[i] = job{i + 1, args[i]}\n    }\n\n    fmt.Println(\"Submit and Wait ...\")\n    p.SubmitAndWait(jobs...)\n    fmt.Println(\"Finished all jobs\")\n}\n</code></pre>\n\n<p>The code above runs every given Job once with 5 workers in total. My goal is to put a finished job into the jobqueue again. But I don't know, how to manage this. Any advice is welcome! </p>\n"}, {"tags": ["regex", "go", "strip", "traefik", "mux"], "comments": [{"owner": {"reputation": 13949, "user_id": 33969, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/84cac0fa5789fee40e1f51b19c30b95c?s=128&d=identicon&r=PG", "display_name": "Reddog", "link": "https://stackoverflow.com/users/33969/reddog"}, "edited": false, "score": 0, "creation_date": 1535418172, "post_id": 51608342, "comment_id": 91048232, "body": "I am having the same issue! Similar question over at: <a href=\"https://stackoverflow.com/questions/50885435/traefik-pathprefixstripregex-frontend-rule-doesnt-seem-to-set-the-path-properly\" title=\"traefik pathprefixstripregex frontend rule doesnt seem to set the path properly\">stackoverflow.com/questions/50885435/&hellip;</a>"}], "owner": {"reputation": 621, "user_id": 1201599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad429b0d583364e782d718262a8bdbaf?s=128&d=identicon&r=PG", "display_name": "daniyel", "link": "https://stackoverflow.com/users/1201599/daniyel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1546203851, "creation_date": 1533024139, "last_edit_date": 1546203851, "question_id": 51608342, "link": "https://stackoverflow.com/questions/51608342/how-to-write-pathprefixstripregex-in-traefik", "title": "How to write PathPrefixStripRegex in Traefik?", "body": "<p>I have a Docker containers that are running on the ECS Cluster on AWS. I am using Traefik to route certain routes to services. For this I am using <strong>DockerLabels</strong> option in CloudFormation and one of them is <code>traefik.frontend.rule</code> and <code>PathPrefixStripRegex</code>. I had before <code>PathPrefixStrip</code> rule as </p>\n\n<pre><code>traefik.frontend.rule: \"PathPrefixStrip: /api/service-name\"\n</code></pre>\n\n<p>and everything was working without a problem. Now I am trying to expand the <code>api</code> part to match multiple values like </p>\n\n<pre><code>traefik.frontend.rule: \"PathPrefixStripRegex: /{basepath:(?:api|docs)}/service-name\"\n</code></pre>\n\n<p>The problem is what ever url I call the whole path is stripped. So for example, if I call </p>\n\n<pre><code>https://my.example.org/api/service-name/health\n</code></pre>\n\n<p>the Traefik is stripping everything. So <code>/api/service-name/health</code> part is removed and the service is being called at the <code>/</code> (root) path.</p>\n\n<p>Does anyone have any clue why the whole path is being stripped? Is the regex part wrong, I know the Traefik is using Gorilla mux under the hood and frankly I do not have any experience with Go nor mux.</p>\n\n<p>I have tried to use <code>/(api|docs)/service-name</code> as regex. On regex101 site, it works as expected, when I tried to use it as a rule in Traefik, it does not. The version of Traefik is 1.7.</p>\n"}, {"tags": ["docker", "go", "networking", "tcp"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1533024253, "post_id": 51608246, "comment_id": 90181641, "body": "Don&#39;t post screenshots."}, {"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1533156453, "post_id": 51608246, "comment_id": 90248466, "body": "Could it be as simple as the application is not reading data fast enough so a zero window size advertising to halt the sender from wasting packets that will be dropped?"}], "owner": {"reputation": 329, "user_id": 9437085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZbW0.jpg?s=128&g=1", "display_name": "gyuaisdfaasf", "link": "https://stackoverflow.com/users/9437085/gyuaisdfaasf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533069683, "creation_date": 1533023826, "last_edit_date": 1533069683, "question_id": 51608246, "link": "https://stackoverflow.com/questions/51608246/how-to-tune-setreadbuffer-size", "title": "How to tune SetReadBuffer size", "body": "<p>I am writing a service (in go) that needs to connect to client via tcp. I used Wireshark to monitor my network traffic and occasionally I see</p>\n\n<p>TCP zero window size from my host machine</p>\n\n<p>I wonder if setting a large size in </p>\n\n<blockquote>\n  <p>func (*TCPConn) SetReadBuffer</p>\n</blockquote>\n\n<p>will alleviate this. To my understanding, this function will change the operating system's receive buffer associated with the tcp connection. The client will send packets in thousands per second and typical packet data size is 1448 bytes. Also, if I run this service inside a docker image, will there be other factors that may affect the buffer size(like some docker specific limits). </p>\n"}, {"tags": ["curl", "go", "restful-url"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1533022235, "post_id": 51607677, "comment_id": 90180544, "body": "What does &quot;didn&#39;t work&quot; exactly mean"}, {"owner": {"reputation": 265, "user_id": 5954317, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/zeQTP.jpg?s=128&g=1", "display_name": "Casualet", "link": "https://stackoverflow.com/users/5954317/casualet"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1533022582, "post_id": 51607677, "comment_id": 90180716, "body": "I got the error message: 415: Unsupported Media Type. I thought this program allow us to post data:)"}], "answers": [{"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1533023450, "post_id": 51608056, "comment_id": 90181201, "body": "its defined here <a href=\"https://github.com/emicklei/go-restful/blob/1905f349c059305e2785c36f986dbaf9e691898c/entity_accessors.go#L37\" rel=\"nofollow noreferrer\">github.com/emicklei/go-restful/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 2, "last_activity_date": 1533023205, "creation_date": 1533023205, "answer_id": 51608056, "question_id": 51607677, "link": "https://stackoverflow.com/questions/51607677/how-to-use-curl-to-post-xml-data-to-a-simple-server/51608056#51608056", "title": "How to use curl to post xml data to a simple server", "body": "<p>This library doesnt recognize <code>text/xml</code> header for some reason, you should use <code>application/xml</code></p>\n\n<p><a href=\"https://github.com/emicklei/go-restful/blob/7dd77babc0fbac18c02f6968b4dcf69e9c43bc73/constants.go#L8\" rel=\"nofollow noreferrer\">Check the source code</a></p>\n\n<pre><code>const (\n    MIME_XML   = \"application/xml\"      \n.....\n</code></pre>\n\n<p>Here is the difference <a href=\"http://www.rfc-editor.org/rfc/rfc3023.txt\" rel=\"nofollow noreferrer\">rfc3023</a>:</p>\n\n<blockquote>\n  <p>If an XML document -- that is, the unprocessed, source XML document --\n  is readable by casual users, text/xml is preferable to\n  application/xml. MIME user agents (and web user agents) that do not\n  have explicit support for text/xml will treat it as text/plain, for\n  example, by displaying the XML MIME entity as plain text.\n  Application/xml is preferable when the XML MIME entity is unreadable\n  by casual users.</p>\n</blockquote>\n"}], "owner": {"reputation": 265, "user_id": 5954317, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/zeQTP.jpg?s=128&g=1", "display_name": "Casualet", "link": "https://stackoverflow.com/users/5954317/casualet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533023205, "creation_date": 1533021927, "question_id": 51607677, "link": "https://stackoverflow.com/questions/51607677/how-to-use-curl-to-post-xml-data-to-a-simple-server", "title": "How to use curl to post xml data to a simple server", "body": "<p>I'm trying out go-restful. I found an example here: <a href=\"https://github.com/emicklei/go-restful/blob/master/examples/restful-resource-functions.go\" rel=\"nofollow noreferrer\">go example</a></p>\n\n<p>I try to use curl to post data:</p>\n\n<pre><code>curl -H \"Content-Type: text/xml\"  -X POST -d \"&lt;Product&gt;&lt;Id&gt;1&lt;/Id&gt;&lt;Title&gt;The First&lt;/Title&gt;&lt;/Product&gt;\" localhost:8080/products\n</code></pre>\n\n<p>but it didn't work. My questions are:</p>\n\n<ol>\n<li><p>how to use curl to post data in this example ?</p></li>\n<li><p>how can this program read xml data into a struct using ?</p>\n\n<p>err := req.ReadEntity(updatedProduct)</p></li>\n</ol>\n\n<p>(In other examples, req.ReadEntity is able to read json data. How can this single function read data into different structs?)</p>\n\n<p>thanks:)</p>\n"}, {"tags": ["go", "grpc", "pool"], "comments": [{"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 1, "creation_date": 1533005005, "post_id": 51604712, "comment_id": 90175116, "body": "So do your initial research, publish your code you have come up with so far - this is not a free consultancy service."}, {"owner": {"reputation": 3, "user_id": 10158180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XXOkgIUgwPA/AAAAAAAAAAI/AAAAAAAAACM/wBlK5JwiHbU/photo.jpg?sz=128", "display_name": "PoormaJin Rao", "link": "https://stackoverflow.com/users/10158180/poormajin-rao"}, "reply_to_user": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1533005395, "post_id": 51604712, "comment_id": 90175194, "body": "I would like to ask about the optimization scheme, which is not very experienced in this field  This is my code: <a href=\"https://github.com/PoormaJin/grpcpool\" rel=\"nofollow noreferrer\">github.com/PoormaJin/grpcpool</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1085, "user_id": 3169138, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSAPm.jpg?s=128&g=1", "display_name": "byrnedo", "link": "https://stackoverflow.com/users/3169138/byrnedo"}, "is_accepted": true, "score": 0, "last_activity_date": 1533026333, "creation_date": 1533026333, "answer_id": 51609017, "question_id": 51604712, "link": "https://stackoverflow.com/questions/51604712/optimization-of-golang-connection-pool/51609017#51609017", "title": "Optimization of golang connection pool", "body": "<blockquote>\n  <p>... will it affect the normal get and put operation when checking</p>\n</blockquote>\n\n<p>So currently you pop one connection from the channel and check if it's live.\nWhile this is being checked, that connection wont be available to other subscribers on that pool channel.</p>\n\n<p>I guess you're asking if this will affect any concurrent operation at the time you do this check?</p>\n\n<p>I don't think it will since the 'user' of the pool also has to pop a connection from the channel to use the connection.\nSo a concurrent operation shouldn't occur.</p>\n\n<p>This, of course depends on you having a 'Put' function that pops the connection from the channel, does a command, then pushes it back onto the channel only once everything is done.</p>\n"}], "owner": {"reputation": 3, "user_id": 10158180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XXOkgIUgwPA/AAAAAAAAAAI/AAAAAAAAACM/wBlK5JwiHbU/photo.jpg?sz=128", "display_name": "PoormaJin Rao", "link": "https://stackoverflow.com/users/10158180/poormajin-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 1, "accepted_answer_id": 51609017, "answer_count": 1, "score": 0, "last_activity_date": 1533026333, "creation_date": 1533004812, "question_id": 51604712, "link": "https://stackoverflow.com/questions/51604712/optimization-of-golang-connection-pool", "title": "Optimization of golang connection pool", "body": "<p>Ask a question about using golang to develop a connection pool to put connections in a buffered channel with get and put operations &lt;-chan and chan &lt;- conn</p>\n\n<p>Currently, there is also a function to check whether the connection is valid at regular intervals. To do this at regular intervals, that is, to take out the check and store it in, but will it affect the normal get and put operation when checking?</p>\n\n<p>Or are there other data structures to recommend?</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533019334, "post_id": 51604621, "comment_id": 90179055, "body": "<code>&amp;order.Status = &quot;No 3A4&quot;</code> doesn&#39;t make sense in this case, just use <code>order.Status = &quot;No 3A4&quot;</code>. While you need to pass a pointer to the Scan method (<code>row.Scan(&amp;order.Status)</code>) for it to be able to &quot;mutate&quot; the order&#39;s Status, you don&#39;t need to do that when you have access to the <code>order</code> value as you already do inside the loop&#39;s scope. Don&#39;t confuse the two."}], "answers": [{"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 0, "last_activity_date": 1533005670, "creation_date": 1533005670, "answer_id": 51604812, "question_id": 51604621, "link": "https://stackoverflow.com/questions/51604621/assign-to-a-property-of-a-pointer-of-a-struct-in-go-lang/51604812#51604812", "title": "Assign to a property of a pointer of a struct in Go Lang", "body": "<p>Based on the error, we know that <code>&amp;order.Status</code> is type <code>*string</code>.  Yet you're trying to assign it a value of type <code>string</code>.  You could make a pointer to the string instead:</p>\n\n<pre><code>str := \"No 3A4\"\n&amp;order.Status = &amp;str\n</code></pre>\n\n<p>Or you could just assign to order.Status directly:</p>\n\n<pre><code>order.Status = \"No 3A4\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1533020651, "creation_date": 1533020651, "answer_id": 51607314, "question_id": 51604621, "link": "https://stackoverflow.com/questions/51604621/assign-to-a-property-of-a-pointer-of-a-struct-in-go-lang/51607314#51607314", "title": "Assign to a property of a pointer of a struct in Go Lang", "body": "<p>Since the field is of type <code>*string</code> you have to assign a pointer to a string. That cannot be done on a single line:</p>\n\n<pre><code>s := \"No 3A4\"    \norder.Status = &amp;s\n</code></pre>\n\n<p>Alternatively change the value that order.Status is pointing to:</p>\n\n<pre><code>order.Status = new(string)\n*order.Status = \"No 3A4\"\n</code></pre>\n"}], "owner": {"reputation": 62, "user_id": 1563981, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/42ZCA.jpg?s=128&g=1", "display_name": "Jorge Limas", "link": "https://stackoverflow.com/users/1563981/jorge-limas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1533020651, "creation_date": 1533003992, "question_id": 51604621, "link": "https://stackoverflow.com/questions/51604621/assign-to-a-property-of-a-pointer-of-a-struct-in-go-lang", "title": "Assign to a property of a pointer of a struct in Go Lang", "body": "<p>I'm getting the following error<br>\n<strong>Cannot use '\"No 3A4\"' (type string) as type *string in assignment</strong></p>\n\n<p>How can I add a default value for the query doesn't return rows so I can't use the row.Scan() function, sample code below.</p>\n\n<pre><code>func (orders *Orders) getOrderStatus() {\n    var err error\n    for _, order := range *orders {\n        row := db.QueryRow(\"SELECT status FROM mss_orders WHERE externalorderkey = ? ORDER BY tipo ASC LIMIT 1\", order.PoNumber)\n        err = row.Scan(&amp;order.Status)\n\n        if err != nil {\n            &amp;order.Status = \"No 3A4\"    &lt;----- How can I do this?\n        }\n\n        fmt.Printf(\"%+v\\n\", order)\n    }\n}\n</code></pre>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1533009402, "post_id": 51604587, "comment_id": 90175921, "body": "Are you using some package to marshal or format your map? It can be because <code>birth</code> is an unexported field and thus not shown. I cannot reproduce the problem on playground using <code>fmt</code>."}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1533021080, "post_id": 51604587, "comment_id": 90179955, "body": "code works fine, check your args"}], "answers": [{"tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 0, "last_activity_date": 1533124442, "creation_date": 1533124442, "answer_id": 51632641, "question_id": 51604587, "link": "https://stackoverflow.com/questions/51604587/input-map-data-to-struct-using-golang/51632641#51632641", "title": "Input map data to struct using Golang", "body": "<p>The problem is with this section of code</p>\n\n<pre><code>cattle[\"birthInfo\"] = struct {\n    birth map[string]interface{}\n}{\n    birth,\n}\n</code></pre>\n\n<p>The json package can only marshal values that are exported (public / start with a capital letter).</p>\n\n<p>Change the code block to this and it will work:</p>\n\n<pre><code>cattle[\"birthInfo\"] = struct {\n    Birth map[string]interface{} // note: capital \"Birth\", exported\n}{\n    birth,\n}\n</code></pre>\n\n<p>Runnable example with exported field name:</p>\n\n<p><a href=\"https://play.golang.org/p/maTKn95AoGM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/maTKn95AoGM</a></p>\n"}], "owner": {"reputation": 51, "user_id": 4265865, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001835718756/picture?type=large", "display_name": "TH Cho", "link": "https://stackoverflow.com/users/4265865/th-cho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533124442, "creation_date": 1533003589, "question_id": 51604587, "link": "https://stackoverflow.com/questions/51604587/input-map-data-to-struct-using-golang", "title": "Input map data to struct using Golang", "body": "<p>I want to put my map data to another map data using Golang. however it has struct type.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>birth := make(map[string]interface{})\n\nbirth[\"docType\"] = \"registerBirth\"\nbirth[\"agencyCd\"] = string(args[0])\nbirth[\"birthYmd\"] = string(args[1])\nbirth[\"lsTypeNm\"] = string(args[2])\nbirth[\"monthDiff\"] = string(args[3])\nbirth[\"nationNm\"] = string(args[4])\nbirth[\"sexNm\"] = string(args[5])\nbirth[\"regType\"] = string(args[9])\nbirth[\"regYmd\"] = string(args[10])\n</code></pre>\n\n<p>I want to put this map data to another map but I want to use struct type.</p>\n\n<pre><code>cattle := make(map[string]interface{})\n\ncattle[\"docType\"] = \"information\"\ncattle[\"birthInfo\"] = struct {\n    birth map[string]interface{}\n}{\n    birth,\n}\n</code></pre>\n\n<p>but, when I get data.. It comes out like this.</p>\n\n<pre><code>{\"birthInfo\":{},\"docType\":\"information\"}\n</code></pre>\n\n<p>Here Is the example that I want.</p>\n\n<pre><code>\"birthInfo\": {\n        \"birthYmd\": \"2018-07-25\",\n        \"cattleNo\": \"cow001\",\n        \"docType\": \"registerBirth\",\n        \"farmNo\": \"farm001\",\n        \"flatEartagNo\": \"eartag123123\",\n        \"lsTypeNm\": \"\ud669\uc18c\",\n        \"monthDiff\": \"2018-07\",\n        \"nationNm\": \"austria\",\n        \"regType\": \"\uc9c1\uc811\",\n        \"regYmd\": \"20185-07-25\",\n        \"sexNm\": \"M\"\n    },\n\"docType\": \"information\",\n...\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["http", "go", "http2"], "comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 1, "creation_date": 1533010536, "post_id": 51604469, "comment_id": 90176125, "body": "Try to dig into this issue <a href=\"https://github.com/golang/go/issues/14008\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/14008</a>"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1533020445, "post_id": 51604469, "comment_id": 90179645, "body": "<code>AllowHTTP</code> only enables HTTP2 over plain TCP (as opposed to TCP+TLS)."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1533043594, "post_id": 51604469, "comment_id": 90194257, "body": "@majidarif, thanks for showing me that issue, I hadn&#39;t come across it yet"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1533043620, "post_id": 51604469, "comment_id": 90194281, "body": "@peter ohh that makes sense?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1533046797, "post_id": 51604469, "comment_id": 90196510, "body": "AllowHTTP isn&#39;t useful in general because you never know what proxies might do to the traffic, but in some cases it&#39;s useful. grpc can be configured to run without TLS, for example."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1533053112, "post_id": 51604469, "comment_id": 90200942, "body": "@Peter yeah I learned that the hard way lol, trial by fire."}], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1533043970, "post_id": 51607141, "comment_id": 90194544, "body": "Will this increase the speed of the overall request. I know from the few tests I&#39;ve run and numerous articles, https2 + TLS, is faster then http + TLS. Since I&#39;m making millions of SSL GET and POST requests a day I&#39;m hoping to reduce the latency created by the handshake and reduce overall cpu usage.. As a side note plus 1 for Dial Context, I had no idea Dial was depricated"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1533044803, "post_id": 51607141, "comment_id": 90195123, "body": "Measure it. I can&#39;t possibly tell you what switching to HTTP/2 does for you in terms of performance. It depends."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1533045054, "post_id": 51607141, "comment_id": 90195269, "body": "oh I have measured, which is why I want to use HTTP/2. My confusion is whether or not http2 is ready for production in Go and whether or not my posted example is sufficient, correct, and fully feature like its time tested sibling http.Transport"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1533045162, "post_id": 51607141, "comment_id": 90195350, "body": "It is ready for production. Anything in the standard library in a stable version of Go is production-ready, unless the documentation explicitly states otherwise."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1533045287, "post_id": 51607141, "comment_id": 90195430, "body": "@Adrian to your point the only place I see http2 is in <code>golang.org&#47;x&#47;net&#47;http2</code>, which places it outside of the standard lib"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1533045350, "post_id": 51607141, "comment_id": 90195484, "body": "It&#39;s supported transparently by <code>net&#47;http</code>."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 4, "last_activity_date": 1533020058, "creation_date": 1533020058, "answer_id": 51607141, "question_id": 51604469, "link": "https://stackoverflow.com/questions/51604469/confusion-over-gos-http2-implementation/51607141#51607141", "title": "Confusion over Go&#39;s http2 implementation", "body": "<p><code>http.Transport</code> supports HTTP2, however you have to configure the more modern DialContext, not Dial (which is deprecated):</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"net\"\n        \"net/http\"\n        \"net/http/httputil\"\n        \"time\"\n)\n\nfunc main() {\n        c := &amp;http.Client{\n                Transport: &amp;http.Transport{\n                        Proxy: http.ProxyFromEnvironment,\n                        DialContext: (&amp;net.Dialer{ // use DialContext here\n                                Timeout:   10 * time.Second,\n                                KeepAlive: 1 * time.Minute,\n                        }).DialContext,\n                        TLSHandshakeTimeout: 10 * time.Second,\n                        MaxIdleConns:        3000,\n                        MaxIdleConnsPerHost: 3000,\n                        IdleConnTimeout:     60 * time.Second,\n                },\n                Timeout: 1 * time.Second,\n        }\n        res, _ := c.Get(\"https://http2.akamai.com/\")\n        b, _ := httputil.DumpResponse(res, false)\n        fmt.Println(string(b))\n}\n\n// HTTP/2.0 200 OK\n// Content-Length: 11928\n// Accept-Ch: DPR, Width, Viewport-Width, Downlink, Save-Data\n// Access-Control-Allow-Credentials: false\n// ...\n</code></pre>\n\n<p>The only reason to use http2.Transport is to skip the initial connection upgrade (aka. prior knowledge). If that is not a concern, stick to the standard client and transport.</p>\n"}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 51607141, "answer_count": 1, "score": 0, "last_activity_date": 1533020058, "creation_date": 1533002317, "last_edit_date": 1533004360, "question_id": 51604469, "link": "https://stackoverflow.com/questions/51604469/confusion-over-gos-http2-implementation", "title": "Confusion over Go&#39;s http2 implementation", "body": "<p>I run tons of traffic over SSL. I was thinking of speeding up these calls by using a http2 client. However, I'm hesitant to do so because it feels like i have less control on how it behaves.</p>\n\n<p>Here is a production client using Go's basic net/http</p>\n\n<pre><code>ClientHTTP := &amp;http.Client{\n    Transport: &amp;http.Transport{\n        Proxy: http.ProxyFromEnvironment,\n        Dial: (&amp;net.Dialer{\n            Timeout:   timeout * time.Second,\n            KeepAlive: 1 * time.Minute,\n        }).Dial,\n        TLSHandshakeTimeout: timeout * time.Second,\n        MaxIdleConns:        3000,\n        MaxIdleConnsPerHost: 3000,\n        IdleConnTimeout:     60 * time.Second,\n    },\n    Timeout: timeout * time.Second,\n}\n</code></pre>\n\n<p>As far as I can tell I have way less control on the transport. </p>\n\n<pre><code>ClientHTTP2 := &amp;http.Client{\n    Transport: &amp;http2.Transport{\n        AllowHTTP: true,\n    },\n    Timeout: timeout * time.Second,\n}\n</code></pre>\n\n<p>Is there anything I'm missing? Is http2 production ready? I understand that http2 uses a single TCP connection and therefore things likes pools go away. Yet it somehow feels incomplete. Will these behave the same way as the production client? Is there a better way to implement <code>ClientHTTP2</code> and lastly, <code>AllowHTTP</code> doesn't seem to do anything. In the case where there might be an http call I thought I'd be able to able it safely, but instead it errors out.</p>\n"}, {"tags": ["dictionary", "go", "merge"], "comments": [{"owner": {"reputation": 1233, "user_id": 4983242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KQbOP.jpg?s=128&g=1", "display_name": "Dharma Saputra", "link": "https://stackoverflow.com/users/4983242/dharma-saputra"}, "edited": false, "score": 0, "creation_date": 1533014808, "post_id": 51603747, "comment_id": 90177203, "body": "Never try it, but I hope this give you some hints: <a href=\"https://github.com/imdario/mergo\" rel=\"nofollow noreferrer\">github.com/imdario/mergo</a>."}, {"owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "reply_to_user": {"reputation": 1233, "user_id": 4983242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KQbOP.jpg?s=128&g=1", "display_name": "Dharma Saputra", "link": "https://stackoverflow.com/users/4983242/dharma-saputra"}, "edited": false, "score": 0, "creation_date": 1533050003, "post_id": 51603747, "comment_id": 90198816, "body": "It&#39;ll merge but the order is lost."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533066010, "post_id": 51603747, "comment_id": 90207202, "body": "@gdanko unfortunately for you the order of Go&#39;s built in <code>map</code>s is random. You&#39;ll have to use a different data type. <a href=\"https://blog.golang.org/go-maps-in-action#TOC_7\" rel=\"nofollow noreferrer\">blog.golang.org/go-maps-in-action#TOC_7</a>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533066412, "post_id": 51603747, "comment_id": 90207380, "body": "@gdanko you may want to consider trying a plain old struct, If the yaml package has similar behaviour to other marshaling/unmarshaling packages then this ought to be simple. You first unmarshal the baseline file into your struct, and then the environment file. The second unmarshal should overwrite only those fields that are provided in the environment file, and leave the other ones, those from the first unmarshal, unchanged. (This is only how I think it should work, I haven&#39;t used the yaml package, so I don&#39;t actually know for sure.)"}, {"owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533066478, "post_id": 51603747, "comment_id": 90207427, "body": "@mkopriva the problem is that the &quot;schema&quot; will change based on the file."}, {"owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "edited": false, "score": 0, "creation_date": 1533066550, "post_id": 51603747, "comment_id": 90207475, "body": "The iteration order needs to be the insertion order. Go yaml has something called yaml.MapSlice{} which is essentially an array of arrays. If I can find a way to flatten that into something like: [key1: baseline, key2.subkey1: baseline], etc I may be able to create my own ordered merge."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533066790, "post_id": 51603747, "comment_id": 90207585, "body": "@gdanko depending on how radical the difference between the schemas is, this may not be a problem at all. Looking at the two files in your example this shouldn&#39;t really be an issue. Again I haven&#39;t used yaml so I&#39;m not sure, but, with json for example, this is very much doable."}, {"owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533067777, "post_id": 51603747, "comment_id": 90208082, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/177132/discussion-between-gdanko-and-mkopriva\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "is_accepted": false, "score": 0, "last_activity_date": 1533249868, "creation_date": 1533249868, "answer_id": 51663108, "question_id": 51603747, "link": "https://stackoverflow.com/questions/51603747/deep-merge-order-maps-in-go/51663108#51663108", "title": "Deep merge order maps in Go", "body": "<p>All right, I solved it! My goal was to deep merge two yaml files and retain their order. A co-worker and I figured it out. I will be doing the same thing with the OrderedMap Python clone.</p>\n"}], "owner": {"reputation": 1602, "user_id": 589254, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/34890ea3a42603929d8a1d22864fcfd5?s=128&d=identicon&r=PG", "display_name": "gdanko", "link": "https://stackoverflow.com/users/589254/gdanko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533249868, "creation_date": 1532995115, "question_id": 51603747, "link": "https://stackoverflow.com/questions/51603747/deep-merge-order-maps-in-go", "title": "Deep merge order maps in Go", "body": "<p>I am reading two YAML files, one is considered the \"base\" and one the \"environment\". I need to unmarshal them as ordered maps and merge them, retaining the order.</p>\n\n<p>So if baseline looks like this:</p>\n\n<pre><code>key1: baseline\nkey2:\n  subkey1: baseline\n  subkey2:\n    subsubkey1: baseline\n</code></pre>\n\n<p>And the environment looks like this:</p>\n\n<pre><code>key2:\n  subkey2:\n    subsubkey1: environment\n</code></pre>\n\n<p>I want the resultant map to look like this</p>\n\n<pre><code>key1: baseline\nkey2:\n  subkey1: baseline\n  subkey2:\n    subsubkey1: environment\n</code></pre>\n\n<p>I have tried to use yaml.MapSlice{} but it is essentially an array of arrays and you cannot really merge that.</p>\n\n<p>With Ruby I can use activesupport's deep_merge() and get the desired result and get similar using Python's Collections.OrderedDict. Finding anything in Go has been difficult. I get people dismissing it by saying Go is designed this way. </p>\n\n<p>That's all well and good, but I need the functionality for my project.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1532996233, "post_id": 51603644, "comment_id": 90173608, "body": "it needs to be <code>parsed map[string]interface{}</code>, a <code>*interface{}</code> means you have something with the type <code>interface{}</code>, and then got a pointer to it (e.g. <a href=\"https://play.golang.org/p/-j3p8u7gf__z\" rel=\"nofollow noreferrer\">play.golang.org/p/-j3p8u7gf__z</a>)"}, {"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "reply_to_user": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1532996820, "post_id": 51603644, "comment_id": 90173692, "body": "when I do that it says: cannot use command.parsed[&quot;test&quot;] (type interface {}) as type *string in argument to command.Flagset.StringVar: need type assertion"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 1, "creation_date": 1532997476, "post_id": 51603644, "comment_id": 90173780, "body": "right.  so do a type assertion: <code>command.parsed[&quot;test&quot;].(*string)</code>"}, {"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "reply_to_user": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1533059495, "post_id": 51603644, "comment_id": 90204137, "body": "@dave, thank you dave, pointer (*) in the type assertion was what I was missing.  THANKS"}], "owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532994217, "creation_date": 1532994217, "question_id": 51603644, "link": "https://stackoverflow.com/questions/51603644/flag-stringvar-with-struct-as-destination", "title": "flag.StringVar with struct as destination", "body": "<p>I'm attempting to capture flags and the parsed values into a struct.  What I have below works, but only on strings. When I encounter a boolean it fails so I'm trying to use an interface type without success.</p>\n\n<pre><code>type Commands struct {\n    appDescription string\n    flagsets map[string]Command\n}\n\ntype Command struct {\n    Flagset *flag.FlagSet\n    parsed map[string]*string\n}\n\n\ncommand.parsed = make(map[string]string)\n\nfunc main() {\n   var command Command\n   command.parsed = make(map[string]string)\n\n   flagName := \"appImportFlags\"\n   command.Flagset = flag.NewFlagSet(flagName, flag.ExitOnError)    \n\n\n   command.Flagset.StringVar(command.parsed[\"test\"], \"arg\", \"\", \"description\")\n}\n</code></pre>\n\n<p>This works, but when I use a Boolean as in:\\</p>\n\n<pre><code>   command.Flagset.Bool(command.parsed[\"test\"], \"arg\", \"\", \"description\")\n</code></pre>\n\n<p>It fails because parsed is a string.  So I change it to an interface:</p>\n\n<pre><code>type Command struct {\n        Flagset *flag.FlagSet\n        parsed map[string]*interface{}\n    }\n</code></pre>\n\n<p>Then it says I can't use a type *interface{} as a *string</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1532976912, "post_id": 51600193, "comment_id": 90167199, "body": "If you&#39;re only checking for the content that won&#39;t change based on the input, then you really only need one test. Your expected would be <code>[]byte(fmt.Sprintf(&quot;%s%s%s&quot;, NEW_LINE, NEW_LINE, &quot;Application&quot;))</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1532978456, "post_id": 51600193, "comment_id": 90167930, "body": "@Gavin - Thanks, can you please provide it as answer  ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1532981931, "post_id": 51600193, "comment_id": 90169522, "body": "@Gavin - do you mean something like `\tvar tests []struct { \t\tname     string \t\targs     args \t\texpected []byte \t} \t{ \t\t[]byte(fmt.Sprintf(&quot;%s%s%s&quot;, NEW_LINE, NEW_LINE, &quot;Application&quot;)) \t}`"}], "answers": [{"tags": [], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "is_accepted": true, "score": 0, "last_activity_date": 1533052428, "creation_date": 1533052428, "answer_id": 51617494, "question_id": 51600193, "link": "https://stackoverflow.com/questions/51600193/table-driven-test-for-file-creation/51617494#51617494", "title": "Table-driven test for file creation", "body": "<p>If you are only checking for the static content at the beginning, then you really only need one test. It would look something like this:</p>\n\n<pre><code>func Test_setFile(t *testing.T) {\n    type args struct {\n        appStr models.App\n    }\n    var tests []struct {\n        name string\n        args args\n        expected []byte\n    }{\n        name: 'Test Static Content',\n        args: args{appStr: 'Some String'},\n        expected: []byte(fmt.Sprintf(\"%s%s%s\", NEW_LINE, NEW_LINE, \"Application\")),\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            b := &amp;bytes.Buffer{}\n            setFile(b, tt.args.AppStr)\n            if !bytes.Equal(b.Bytes(), tt.expected) {\n                t.Error(\"somewhat bad happen\")\n            }\n        })\n    }\n}\n</code></pre>\n\n<p>Although, since you only have one case for this test, there really isn't a need to use table driven tests here. You could clean it up to look something like this:</p>\n\n<pre><code>func Test_setFile(t *testing.T) {\n    b := &amp;bytes.Buffer{}\n    setFile(b, 'Some String')\n    want := []byte(fmt.Sprintf(\"%s%s%s\", NEW_LINE, NEW_LINE, \"Application\"))\n    got := b.Bytes()\n    if !bytes.Equal(want, got) {\n        t.Errorf(\"want: %s got: %s\", want, got)\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 51617494, "answer_count": 1, "score": 0, "last_activity_date": 1533069707, "creation_date": 1532975417, "last_edit_date": 1533069707, "question_id": 51600193, "link": "https://stackoverflow.com/questions/51600193/table-driven-test-for-file-creation", "title": "Table-driven test for file creation", "body": "<p>I got an example from @volker about table driven test like following\nBut currently I miss what I should put in the real test, this test is using byte, currently im not sure what to put in the <code>args</code> and the <code>expected []byte</code>, \ne.g. I want to check that in the file there is <code>2 new line</code> and then <code>application</code> entry, how can I do it without the need to create the real file and parse it?</p>\n\n<pre><code>type Models struct {\n    name        string\n    vtype       string\n    contentType string\n}\n\nfunc setFile(file io.Writer, appStr Models) {\n    fmt.Fprint(file, \"1.0\")\n\n    fmt.Fprint(file, \"Created-By: application generation process\")\n    for _, mod := range appStr.Modules {\n        fmt.Fprint(file, \"\\n\")\n        fmt.Fprint(file, \"\\n\")\n        fmt.Fprint(file,  appStr.vtype) //\"userApp\"\n        fmt.Fprint(file, \"\\n\")\n        fmt.Fprint(file, appStr.name) //\"applicationValue\"\n        fmt.Fprint(file, \"\\n\")\n        fmt.Fprint(file, appStr.contentType)//\"ContentType\"\n    }\n}\n\nfunc Test_setFile(t *testing.T) {\n    type args struct {\n        appStr models.App\n    }\n    var tests []struct {\n        name string\n        args args\n        expected []byte\n   }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            b := &amp;bytes.Buffer{}\n            setFile(b, tt.args.AppStr)\n            if !bytes.Equal(b.Bytes(), tt.expected) {\n                t.Error(\"somewhat bad happen\")\n            }\n        })\n    }\n}\n</code></pre>\n\n<p>I read and understand the following example but not for byte and file\n<a href=\"https://medium.com/@virup/how-to-write-concise-tests-table-driven-tests-ed672c502ae4\" rel=\"nofollow noreferrer\">https://medium.com/@virup/how-to-write-concise-tests-table-driven-tests-ed672c502ae4</a></p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1532970883, "post_id": 51599022, "comment_id": 90164221, "body": "&quot;But I haven&#39;t got the result I wanted&quot; - meaning what? What result did you want, what result did you get, what specifically is the issue you&#39;re having?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1532971043, "post_id": 51599022, "comment_id": 90164308, "body": "Post the error that you are getting if any."}, {"owner": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "edited": false, "score": 0, "creation_date": 1532972944, "post_id": 51599022, "comment_id": 90165244, "body": "I have corrected the question. I hope it&#39;s more descriptive."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "edited": false, "score": 0, "creation_date": 1532972667, "post_id": 51599311, "comment_id": 90165116, "body": "Thanks for quick response. I have used your advise. But I have taken the same error code at Db.Exec line. The error code: 1064 You have an error in your SQL syntax; check the manual that corr...  I&#39;ve minimized the amount of code in test stored procedure as much as possible to reduce the chance of error due to different sql command. The test.sql that I used is in question part."}, {"owner": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "edited": false, "score": 0, "creation_date": 1532975436, "post_id": 51599311, "comment_id": 90166518, "body": "peterSO, I have noticed the change you made to the variable later. In the meantime, I&#39;ve fixed your code. I wanted to make it back to its original form, this time it was blocked by the rule of 6 char change. Sorry. and thanks again."}, {"owner": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "edited": false, "score": 0, "creation_date": 1532975560, "post_id": 51599311, "comment_id": 90166579, "body": "problem is caused by the delimeter command. I removed those lines. Problem is solved."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1532971817, "last_edit_date": 1532971817, "creation_date": 1532971505, "answer_id": 51599311, "question_id": 51599022, "link": "https://stackoverflow.com/questions/51599022/load-stored-procedure-from-sql-file/51599311#51599311", "title": "load stored procedure from sql file", "body": "<p>I would expect something more like this:</p>\n\n<pre><code>DB, err = sql.Open(\"mysql\", MAPP.CF.Mysql)\nif err != nil {\n    // handle error\n}\ndata, err := ioutil.ReadFile(`E:/Qlass/goserv/src/modul/modul_sp.sql`)\nif err != nil {\n    // handle error\n}\nsqlProc := string(data)\n_, err := DB.Exec(sqlProc)\nif err != nil {\n    // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 1, "accepted_answer_id": 51599311, "answer_count": 1, "score": 1, "last_activity_date": 1532975636, "creation_date": 1532970265, "last_edit_date": 1532975636, "question_id": 51599022, "link": "https://stackoverflow.com/questions/51599022/load-stored-procedure-from-sql-file", "title": "load stored procedure from sql file", "body": "<p>I have a mysql test.sql file that contains stored procedure.\nto load this sql file after connecting to database in go server, I used Exec command. But I haven't got the result I wanted. I take error code </p>\n\n<blockquote>\n  <p>1064 You have an error in your SQL syntax; check the manual that corr...</p>\n</blockquote>\n\n<p>How can I load stored procedure from a sql file after connecting the database in go. </p>\n\n<p>// go code section : </p>\n\n<pre><code>sqlProc, err := ioutil.ReadFile(\"E:/Qlass/goserv/src/cevir/test.sql\")\n// handle error\n\n_, err = MAPP.DB.Db.Exec(string(sqlProc[:]))\n// handle error\n</code></pre>\n\n<p>// content of test.sql</p>\n\n<pre><code>drop procedure if exists Test;\ndelimiter ;;\ncreate procedure Test()\nbegin\n    truncate table _prlog;\nend ;;\ndelimiter ;\n</code></pre>\n\n<p>problem is caused by the delimeter command. I removed those lines. Problem is solved. The corrected sql file.</p>\n\n<pre><code>drop procedure if exists Test;\ncreate procedure Test()\nbegin\n    truncate table _prlog;\nend ;\n</code></pre>\n"}, {"tags": ["string", "go", "split"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1532968101, "post_id": 51598250, "comment_id": 90162798, "body": "There&#39;s <a href=\"https://golang.org/pkg/strings/#LastIndex\" rel=\"nofollow noreferrer\"><code>strings.LastIndex</code></a>. Is this only for path operations? If so there&#39;s also <a href=\"https://golang.org/pkg/path/#Split\" rel=\"nofollow noreferrer\"><code>path.Split</code></a>."}, {"owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532968146, "post_id": 51598250, "comment_id": 90162815, "body": "Yes, this is only for path operations"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1532970534, "last_edit_date": 1532970534, "creation_date": 1532968428, "answer_id": 51598541, "question_id": 51598250, "link": "https://stackoverflow.com/questions/51598250/split-a-string-at-the-last-occurrence-of-the-separator-in-golang/51598541#51598541", "title": "Split a string at the last occurrence of the separator in golang", "body": "<p>Since this is for path operations, and it looks like you don't want the trailing path separator, then <a href=\"https://golang.org/pkg/path/#Dir\" rel=\"nofollow noreferrer\"><code>path.Dir</code></a> does what you're looking for:</p>\n\n<pre><code>fmt.Println(path.Dir(\"a/b/c/d/e\"))\n// a/b/c/d\n</code></pre>\n\n<p>If this is specifically for filesystem paths, you will want to use the <a href=\"https://golang.org/pkg/path/filepath/\" rel=\"nofollow noreferrer\"><code>filepath</code></a> package instead, to properly handle multiple path separators. </p>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 1, "last_activity_date": 1532987079, "creation_date": 1532987079, "answer_id": 51602697, "question_id": 51598250, "link": "https://stackoverflow.com/questions/51598250/split-a-string-at-the-last-occurrence-of-the-separator-in-golang/51602697#51602697", "title": "Split a string at the last occurrence of the separator in golang", "body": "<p>Here's a simple function that uses <a href=\"https://golang.org/pkg/path/filepath/#Dir\" rel=\"nofollow noreferrer\"><code>filepath.Dir(string)</code></a> to build a list of all ancestor directories of a given filepath:</p>\n\n<pre><code>func main() {\n  fmt.Printf(\"OK: %#v\\n\", parentsOf(\"a/b/c/d\"))\n  // OK: []string{\"a/b/c\", \"a/b\", \"a\"}\n}\n\nfunc parentsOf(s string) []string {\n  dirs := []string{}\n  for {\n    parent := filepath.Dir(s)\n    if parent == \".\" || parent == \"/\" {\n      break\n    }\n    dirs = append(dirs, parent)\n    s = parent\n  }\n  return dirs\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 163, "user_id": 10547264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30c862a9d857e96da3d2e7e4b227f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Riya John", "link": "https://stackoverflow.com/users/10547264/riya-john"}, "is_accepted": false, "score": 3, "last_activity_date": 1605856767, "last_edit_date": 1605856767, "creation_date": 1598255394, "answer_id": 63556783, "question_id": 51598250, "link": "https://stackoverflow.com/questions/51598250/split-a-string-at-the-last-occurrence-of-the-separator-in-golang/63556783#63556783", "title": "Split a string at the last occurrence of the separator in golang", "body": "<p>To split any string only at the last occurrence, using <code>strings.LastIndex</code></p>\n<pre><code>import (\n    &quot;fmt&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    x := &quot;a_ab_daqe_sd_ew&quot;\n    lastInd := strings.LastIndex(x, &quot;_&quot;)\n    fmt.Println(x[:lastInd]) // o/p: a_ab_daqe_sd\n    fmt.Println(x[lastInd+1:]) // o/p: ew\n}\n</code></pre>\n<p>Note, strings.LastIndex <strong>returns -1 if substring passed</strong>(in above example, &quot;_&quot;) <strong>is not found</strong></p>\n"}], "owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1910, "favorite_count": 1, "accepted_answer_id": 51598541, "answer_count": 3, "score": 2, "last_activity_date": 1605856767, "creation_date": 1532967399, "question_id": 51598250, "link": "https://stackoverflow.com/questions/51598250/split-a-string-at-the-last-occurrence-of-the-separator-in-golang", "title": "Split a string at the last occurrence of the separator in golang", "body": "<p>I am trying to split a string by the last occurrence of a separator (/) in golang</p>\n\n<p>Example, I have a string \"a/b/c/d\", after performing the split, I would like an array of string as below </p>\n\n<pre><code>[\n\"a/b/c\",\n\"a/b\"\n\"a\"\n]\n</code></pre>\n\n<p>I tried exploring strings package but couldn't find any function that does this</p>\n\n<pre><code>func main() {\n    fmt.Printf(\"%q\\n\", strings.Split(\"a/b/c/d/e\", \"/\"))\n}\n</code></pre>\n\n<p><strong>May I know a way to handle this?</strong></p>\n"}, {"tags": ["go", "increment"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1532966911, "post_id": 51598032, "comment_id": 90162120, "body": "You can&#39;t safely read the <code>currentNodeSize</code> value without also using atomic operations. There&#39;s no reason here however to use atomic operations, because the method calling <code>addCount</code> can&#39;t safely be used concurrently."}, {"owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532966961, "post_id": 51598032, "comment_id": 90162144, "body": "@JimB thanks for the information"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1532966812, "creation_date": 1532966812, "answer_id": 51598073, "question_id": 51598032, "link": "https://stackoverflow.com/questions/51598032/incrementor-not-functioning/51598073#51598073", "title": "Incrementor not functioning", "body": "<p><code>addCount</code> takes a value receiver, not a pointer, so it's operating on a copy of the struct, incrementing the field of the copy and then discarding the copy. Change it instead to take a pointer:</p>\n\n<pre><code>func (p *PipelineData) addCount(){\n</code></pre>\n\n<p>This should resolve your issue.</p>\n"}], "owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 51598073, "answer_count": 1, "score": -2, "last_activity_date": 1532966820, "creation_date": 1532966686, "last_edit_date": 1532966820, "question_id": 51598032, "link": "https://stackoverflow.com/questions/51598032/incrementor-not-functioning", "title": "Incrementor not functioning", "body": "<p>I have some code which is supposed to increment a count. </p>\n\n<p>Here is the struct containing the count variable:</p>\n\n<pre><code>type PipelineData struct {\n    nodeData          map[string]map[string]int\n    lastBurstResults  map[string]map[string]string\n    burstReady        map[string]bool\n    lastExecutionTime map[string]time.Time\n    currentNodeSize  uint64\n}\n</code></pre>\n\n<p>As you can see there is a member entitled <code>currentNodeSize</code>. This variable is intended to increment ever time the function <code>addNodeData</code> is called. You can see that the function <code>addNodeData</code> calls the function <code>addCount</code> which then uses an atomic incrementer. </p>\n\n<pre><code>func (p PipelineData) addNodeData(key string) {\n    nodeSlot := clusterScenario.GetNodeSlotByHashSlot(key)\n    i:=p.nodeData[nodeSlot][key]\n    i++ \n    p.nodeData[nodeSlot][key]=i \n    p.addCount()\n    fmt.Println(\"Adding node count \",p.currentNodeSize)\n}\n\nfunc (p PipelineData) addCount(){\n    atomic.AddUint64(&amp;p.currentNodeSize, 1) \n}\n</code></pre>\n\n<p>Unfortunately, when I run this:</p>\n\n<pre><code>p.addNodeData(\"{pipelinetest}.key\");\np.addNodeData(\"{pipelinetest}.key\");\np.addNodeData(\"{pipelinetest}.key\");\np.addNodeData(\"{pipelinetest}.key\");\np.addNodeData(\"{pipelinetest}.key\");    \np.addNodeData(\"{pipelinetest}.key\");                \nDump(p.currentNodeSize) \n</code></pre>\n\n<p>The output is <code>0</code>.</p>\n\n<p>Here is the initialization of the PipelineData struct:</p>\n\n<pre><code>p = &amp;PipelineData{\n  nodeData:make(map[string]map[string]int,0),\n  lastBurstResults:make(map[string]map[string]string,0),\n  burstReady:make(map[string]bool,0),\n  lastExecutionTime:make(map[string]time.Time,0),\n  currentNodeSize:0,\n}\nfor i,_ := range clusterScenario.masterNodes{\n    p.nodeData[i]=make(map[string]int,0)\n}       \n</code></pre>\n\n<p>I understand the community has asked me to do my research. I'm not sure what to do at the point. Any help would be appreciated.</p>\n\n<p><strong>I also tried a general incrementor using a variable and that produced the same result which is why I tried an atomic incrementor</strong></p>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "edited": false, "score": 0, "creation_date": 1532968970, "post_id": 51597007, "comment_id": 90163230, "body": "Thank you! , since im not sure how to do it can you please provide some sample code ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1532969244, "post_id": 51597007, "comment_id": 90163361, "body": "Updated with a sample."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "edited": false, "score": 0, "creation_date": 1532970539, "post_id": 51597007, "comment_id": 90164043, "body": "Thanks 1+ , for example how should I check that it prints &quot;ApplicationContent&quot;?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1532970824, "post_id": 51597007, "comment_id": 90164188, "body": "Put whatever you expect it to print in the <code>expected</code> field of the test, or if you want to check partial content, update the test accordingly. The sample code is meant as just that, a sample - it should be enough for you to write your own tests using it as a base."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "edited": false, "score": 0, "creation_date": 1532971484, "post_id": 51597007, "comment_id": 90164514, "body": "I see, the <code>only</code> thing that I miss here for my example is how should I create the `\tvar tests []struct { \t\tname     string \t\targs     args \t\texpected []byte \t}` what should I put in args? it will be great if you can update your answer."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1532971660, "post_id": 51597007, "comment_id": 90164614, "body": "It&#39;s unchanged from your original code, so I assumed you wrote it and knew how it worked. If you don&#39;t understand how to use table driven tests, do a Google search (it&#39;s a very common practice) and if it still doesn&#39;t make sense, post a new question about that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "edited": false, "score": 0, "creation_date": 1532975539, "post_id": 51597007, "comment_id": 90166563, "body": "as you suggest i&#39;ve opend new question, please have a look if you can help , thank you! <a href=\"https://stackoverflow.com/questions/51600193/go-table-driven-test-for-file-creation\" title=\"go table driven test for file creation\">stackoverflow.com/questions/51600193/&hellip;</a>"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1532969236, "last_edit_date": 1532969236, "creation_date": 1532963168, "answer_id": 51597007, "question_id": 51596953, "link": "https://stackoverflow.com/questions/51596953/create-unit-test-for-file-creation-with-content/51597007#51597007", "title": "Create unit test for file creation with content", "body": "<p>The better approach would be to accept an interface, something like <code>io.Writer</code>. In your real usage you can pass in a <code>*os.File</code>, and in your tests you can pass in something easier to work with like a <code>bytes.Buffer</code>.</p>\n\n<p>Something like (untested but should get you started):</p>\n\n<pre><code>func setFile(file io.Writer, appStr models.App) {\n    fmt.Fprint(file, \"1.0\")\n\n    fmt.Fprint(file, \"Created-By: application generation process\")\n    for _, mod := range appStr.Modules {\n        fmt.Fprint(file, NEW_LINE)\n        fmt.Fprint(file, NEW_LINE)\n        fmt.Fprint(file, \"Application\")\n        fmt.Fprint(file, NEW_LINE)\n        fmt.Fprint(file, \"ApplicationContent\")\n        fmt.Fprint(file, NEW_LINE)\n        fmt.Fprint(file, \"ContentType\")\n    }\n}\n\nfunc Test_setFile(t *testing.T) {\n    type args struct {\n        appStr models.App\n    }\n    var tests []struct {\n        name string\n        args args\n        expected []byte\n   }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            b := &amp;bytes.Buffer{}\n            setFile(b, tt.args.AppStr)\n            if !bytes.Equal(b.Bytes(), tt.expected) {\n                t.Error(\"somewhat bad happen\")\n            }\n        })\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 1, "accepted_answer_id": 51597007, "answer_count": 1, "score": 2, "last_activity_date": 1533069718, "creation_date": 1532962987, "last_edit_date": 1533069718, "question_id": 51596953, "link": "https://stackoverflow.com/questions/51596953/create-unit-test-for-file-creation-with-content", "title": "Create unit test for file creation with content", "body": "<p>I've the following function which getting a file and write content to it.</p>\n\n<pre><code>func setFile(file *os.File, appStr models.App) {\n\n    file.WriteString(\"1.0\")\n\n    file.WriteString(\"Created-By: application generation process\")\n    for _, mod := range appStr.Modules {\n\n        file.WriteString(NEW_LINE)\n        file.WriteString(NEW_LINE)\n        file.WriteString(\"Application\")\n        file.WriteString(NEW_LINE)\n        file.WriteString(\"ApplicationContent\")\n        file.WriteString(NEW_LINE)\n        file.WriteString(\"ContentType\")\n\n    }\n}\n</code></pre>\n\n<p>For that I generate a unit test like following</p>\n\n<pre><code>func Test_setFile(t *testing.T) {\n\n\n    type args struct {\n        file   *os.File\n        appStr models.App\n    }\n    var tests []struct {\n        name string\n        args args\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            setFile(tt.args.file, tt.args.AppStr)\n        })\n    }\n}\n</code></pre>\n\n<p>The problem here is that <strong>im depending on file</strong>, what is better approach to create unit test for this kind of function</p>\n\n<ol>\n<li>run code in the unit test which is creating file update it with this function and then parse it and check the values ? is there a better approach for this kind of function ? </li>\n</ol>\n"}, {"tags": ["generics", "go", "protocol-buffers"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1532963046, "post_id": 51596887, "comment_id": 90159834, "body": "<code>[]interface{}</code> is not <code>interface{}</code>, it&#39;s a specific type (a slice of type <code>interface{}</code>). You must pass a <code>[]interface{}</code> to that function, but that slice can contain values of any type (or any mix of types)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1532963097, "post_id": 51596887, "comment_id": 90159873, "body": "See the FAQ: <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>"}, {"owner": {"reputation": 635, "user_id": 2906821, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/zAm2R.jpg?s=128&g=1", "display_name": "Dhruv Pal", "link": "https://stackoverflow.com/users/2906821/dhruv-pal"}, "edited": false, "score": 0, "creation_date": 1566913101, "post_id": 51596887, "comment_id": 101798955, "body": "try using something like <code>func processSlice(mySlice ...interface{}) void{   &#47;&#47; Do stuff in here }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 3, "last_activity_date": 1532964799, "last_edit_date": 1532964799, "creation_date": 1532962954, "answer_id": 51596935, "question_id": 51596887, "link": "https://stackoverflow.com/questions/51596887/cannot-use-mytype-as-type-interface-i-thought-all-types-counted-as-interfac/51596935#51596935", "title": "&quot;Cannot use myType as type interface{}&quot;? I thought all types counted as interface{} in Go?", "body": "<p>As the error clearly depicts:</p>\n\n<blockquote>\n  <p>cannot use myProtoSlice (type []*MyProto) as type []interface{} in\n  argument to processSlice</p>\n</blockquote>\n\n<p><code>[]interface{}</code> of interface is not <code>interface{}</code> type it is different. Golang is strict about types.</p>\n\n<p>Change the slice of interface to just interface to wrap the value you are receiving in your function. Modify below code:</p>\n\n<pre><code>func processSlice(mySlice []interface{}) void{\n  // Do stuff in here\n}\n</code></pre>\n\n<p>To passing an interface</p>\n\n<pre><code>func processSlice(mySlice interface{}) void{\n  // Do stuff in here\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 3, "last_activity_date": 1532962958, "creation_date": 1532962958, "answer_id": 51596938, "question_id": 51596887, "link": "https://stackoverflow.com/questions/51596887/cannot-use-mytype-as-type-interface-i-thought-all-types-counted-as-interfac/51596938#51596938", "title": "&quot;Cannot use myType as type interface{}&quot;? I thought all types counted as interface{} in Go?", "body": "<p>You can't cast slices from a slice of one type to another (as you can types), it would be expensive, and they decided it was better to force you to be explicit. </p>\n\n<p>It would probably be less painful to simply write the function for each slice type you actually need to handle (if you know the types and there are not many).  </p>\n"}], "owner": {"reputation": 3405, "user_id": 3134918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/MQ11M.png?s=128&g=1", "display_name": "Reagankm", "link": "https://stackoverflow.com/users/3134918/reagankm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2007, "favorite_count": 0, "closed_date": 1532963133, "accepted_answer_id": 51596938, "answer_count": 2, "score": 0, "last_activity_date": 1532964799, "creation_date": 1532962809, "question_id": 51596887, "link": "https://stackoverflow.com/questions/51596887/cannot-use-mytype-as-type-interface-i-thought-all-types-counted-as-interfac", "closed_reason": "Duplicate", "title": "&quot;Cannot use myType as type interface{}&quot;? I thought all types counted as interface{} in Go?", "body": "<p>I'm trying to write a function that can take any type (more specifically, trying to get it to take any type of protobuffer, but I'll settle for being more broadly generic if I have to).  Based on what I've read, it seems like it can be done like this:</p>\n\n<pre><code>func processSlice(mySlice []interface{}) void{\n  // Do stuff in here\n}\n</code></pre>\n\n<p>When I try to use this with a slice of protos, though, I get the following error: </p>\n\n<pre><code>cannot use myProtoSlice (type []*MyProto) as type []interface{} in argument to processSlice\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1532964598, "post_id": 51596823, "comment_id": 90160782, "body": "<a href=\"https://godoc.org/golang.org/x/tools/cmd/guru\" rel=\"nofollow noreferrer\">guru</a> can identify the other end(s) of a channel (called peers). Many IDEs and editors can integrate guru to tell you all sorts of things about Go code. See if integration is available for your editor of choice."}, {"owner": {"reputation": 249, "user_id": 2807939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1600eec20b27688bf09abfb06630b1a2?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/2807939/raj"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1533041356, "post_id": 51596823, "comment_id": 90192768, "body": "Wondering why the downvotes?"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1532963265, "creation_date": 1532963265, "answer_id": 51597038, "question_id": 51596823, "link": "https://stackoverflow.com/questions/51596823/how-to-find-out-destination-of-a-golang-channel/51597038#51597038", "title": "How to find out destination of a golang channel", "body": "<p>No, because multiple places can receive from the same channel, and multiple instances of the same function can be receiving from different channels. Your best bet is to follow the channel itself around - look at where it's created, then what it gets passed to, and find what is receiving from it that way.</p>\n"}], "owner": {"reputation": 249, "user_id": 2807939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1600eec20b27688bf09abfb06630b1a2?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/2807939/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 51597038, "answer_count": 1, "score": -2, "last_activity_date": 1532963265, "creation_date": 1532962600, "question_id": 51596823, "link": "https://stackoverflow.com/questions/51596823/how-to-find-out-destination-of-a-golang-channel", "title": "How to find out destination of a golang channel", "body": "<p>I am taking over maintenance of a multi-file golang program and now trying to understand the code flow. One feature of golang is the use of channels for sending values to another part of the code base. This feature can make tracing and understanding the code flow difficult, as the execution will resume at the receiving end of the channel, which may well be in a different file and may have a different name.</p>\n\n<p>When reading through the code, I can see where data is being sent to a channel, but I do not see an intuitive or easy way to figure out where it is being received.</p>\n\n<p>Is there a way in gloang to find out where (as in filename:linenum) a data sent through a channel is received?</p>\n"}, {"tags": ["amazon-web-services", "go", "module"], "answers": [{"tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": false, "score": 1, "last_activity_date": 1533069798, "creation_date": 1533069798, "answer_id": 51621780, "question_id": 51596297, "link": "https://stackoverflow.com/questions/51596297/how-to-import-an-existing-library-into-go-1-11-as-a-module/51621780#51621780", "title": "How to import an existing library into Go 1.11 as a module?", "body": "<p>Your module's go.mod should require entire modules.</p>\n\n<p>Try replacing:</p>\n\n<pre><code>require github.com/aws/aws-sdk-go/aws v1.15.0\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>require github.com/aws/aws-sdk-go v1.15.0\n</code></pre>\n\n<p>You can see the AWS SDK module is defined as <code>github.com/aws/aws-sdk-go</code> here:</p>\n\n<p><a href=\"https://github.com/aws/aws-sdk-go/blob/master/go.mod\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/blob/master/go.mod</a></p>\n\n<p>See also this example of a real repository depending on multiple modules from other repositories:</p>\n\n<p><a href=\"https://github.com/google/go-cloud/blob/master/go.mod\" rel=\"nofollow noreferrer\">https://github.com/google/go-cloud/blob/master/go.mod</a></p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1957, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1533069798, "creation_date": 1532960974, "question_id": 51596297, "link": "https://stackoverflow.com/questions/51596297/how-to-import-an-existing-library-into-go-1-11-as-a-module", "title": "How to import an existing library into Go 1.11 as a module?", "body": "<p>I am trying out Go 1.11 beta2 with this modules support <a href=\"https://tip.golang.org/cmd/go/#hdr-Modules__module_versions__and_more\" rel=\"nofollow noreferrer\">https://tip.golang.org/cmd/go/#hdr-Modules__module_versions__and_more</a>.</p>\n\n<p>I have created <code>go.mod</code> file looking like this:</p>\n\n<pre><code>module example.com/m\n\nrequire github.com/aws/aws-sdk-go/aws v1.15.0\nrequire github.com/aws/aws-sdk-go/aws/session v1.15.0\nrequire github.com/aws/aws-sdk-go/service/s3 v1.15.0\n</code></pre>\n\n<p>But this shows me an error when trying to build:</p>\n\n<blockquote>\n  <p>go: github.com/aws/aws-sdk-go/aws@v1.15.0: unknown revision aws/v1.15.0\n  go: github.com/aws/aws-sdk-go/service/s3@v1.15.0: unknown revision service/s3/v1.15.0\n  go: github.com/aws/aws-sdk-go/aws/session@v1.15.0: unknown revision aws/session/v1.15.0\n  go: error loading module requirements</p>\n</blockquote>\n\n<p>So, I have a question, should I wait for the moment vendor adds support of modules versions into the library before I can import it using go modules or is there some other syntax I can use right now?</p>\n"}, {"tags": ["go", "gopacket"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5388361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VnCUY.png?s=128&g=1", "display_name": "user669", "link": "https://stackoverflow.com/users/5388361/user669"}, "is_accepted": true, "score": 1, "last_activity_date": 1533027273, "creation_date": 1533027273, "answer_id": 51609322, "question_id": 51593997, "link": "https://stackoverflow.com/questions/51593997/adding-custom-layer-to-packet-from-capture-fails/51609322#51609322", "title": "Adding custom layer to packet from capture fails", "body": "<p>As no one responded I am going to answer it myself now. </p>\n\n<p>Basically we have 3 options to handle this:</p>\n\n<ol>\n<li><p>Create an extended TCP layer that handles our additional bytes and override default one by setting <code>layers.LinkTypeMetadata[layers.LinkTypeTCP]</code> to our extended version. <a href=\"http://damianzaremba.co.uk/2017/12/decoding-arista-ethertype-headers-with-gopacket/\" rel=\"nofollow noreferrer\">Have a look at this example</a>.</p></li>\n<li><p>Create a new packet from the TCP payload using <code>gopacket.NewPacket</code> setting <code>firstLayerDecoder</code> to <code>CustomLayerType</code> and decode it normally.</p></li>\n<li><p>As you mostly don't need an actual layer but instead a filled CustomLayer struct simply write a <code>DecodeBytesToCustomStruct</code> function where you pass TCP payload. This way we can even return multiple structs from one packets payload which wouldn't be possible otherwise.</p></li>\n</ol>\n\n<p>Omit all CustomLayer code from above.</p>\n\n<pre><code>type CustomStruct struct {\n    SomeByte    byte\n    AnotherByte byte\n    restOfData  []byte\n}\n\nfunc (customStruct *CustomStruct) DecodeStructFromBytes(data []byte) error { \n    customStruct.SomeByte = data[0]\n    customStruct.AnotherByte = data[1]\n    customStruct.restOfData = data[2:]\n    return nil\n}\n</code></pre>\n\n<p>In your main.go</p>\n\n<pre><code>for packet := range packetSource.Packets() {\n    tcpLayer := packet.Layer(layers.LayerTypeTCP)\n    if tcpLayer != nil {\n        tcp, _ := tcpLayer.(*layers.TCP)\n        if tcp.Payload != nil &amp;&amp; len(tcpLayer.Payload) &gt; 0 {\n            customStruct := CustomStruct{}\n            customStruct.DecodeStructFromBytes(tcp.Payload)\n            fmt.Println(\"SomeByte element:\", customStruct.SomeByte)\n        }\n    }\n}\n</code></pre>\n\n<p><code>tcp.Payload</code> is the same as <code>packet.ApplicationLayer().Payload()</code></p>\n"}], "owner": {"reputation": 11, "user_id": 5388361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VnCUY.png?s=128&g=1", "display_name": "user669", "link": "https://stackoverflow.com/users/5388361/user669"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 2, "accepted_answer_id": 51609322, "answer_count": 1, "score": 0, "last_activity_date": 1533027273, "creation_date": 1532953726, "question_id": 51593997, "link": "https://stackoverflow.com/questions/51593997/adding-custom-layer-to-packet-from-capture-fails", "title": "Adding custom layer to packet from capture fails", "body": "<p>I am trying to implement my own decoding layer ontop of TCP, so far it only works when I create a packet without any Eth/IP/TCP header and set its layer to my custom layer manually. The data of the custom protocol is inside an ordinary TCP payload.</p>\n\n<p>How do I decode only the payload of the TCP layer as another layer?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/google/gopacket\"\n    \"github.com/google/gopacket/pcap\"\n)\n\nvar (\n    pcapFile string = \"capt.pcap\"\n    handle   *pcap.Handle\n    err      error\n)\n\ntype CustomLayer struct {\n    SomeByte    byte\n    AnotherByte byte\n    restOfData  []byte\n}\n\nvar CustomLayerType = gopacket.RegisterLayerType(\n    2001,\n    gopacket.LayerTypeMetadata{\n        \"CustomLayerType\",\n        gopacket.DecodeFunc(decodeCustomLayer),\n    },\n)\n\nfunc (l CustomLayer) LayerType() gopacket.LayerType {\n    return CustomLayerType\n}\n\nfunc (l CustomLayer) LayerContents() []byte {\n    return []byte{l.SomeByte, l.AnotherByte}\n}\n\nfunc (l CustomLayer) LayerPayload() []byte {\n    return l.restOfData\n}\n\nfunc decodeCustomLayer(data []byte, p gopacket.PacketBuilder) error {\n    p.AddLayer(&amp;CustomLayer{data[0], data[1], data[2:]})\n\n    // nil means this is the last layer. No more decoding\n    return nil\n}\n\nfunc main() {\n    handle, err = pcap.OpenOffline(pcapFile)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer handle.Close()\n\n    packetSource := gopacket.NewPacketSource(handle, handle.LinkType())\n    for packet := range packetSource.Packets() {\n        tcpLayer := packet.Layer(layers.LayerTypeTCP)\n        if tcpLayer != nil {\n            fmt.Println(\"TCP layer detected.\")\n            tcp, _ := tcpLayer.(*layers.TCP)\n            fmt.Println(\"Sequence number: \", tcp.Seq)\n            customLayer := packet.Layer(CustomLayerType)\n            if customLayer != nil { // always nil\n                customLayerContent, _ := customLayer.(*CustomLayer)\n                // Now we can access the elements of the custom struct\n                fmt.Println(\"Payload: \", customLayerContent.LayerPayload())\n                fmt.Println(\"SomeByte element:\", customLayerContent.SomeByte)\n                fmt.Println(\"AnotherByte element:\", customLayerContent.AnotherByte)\n            }\n        }\n        fmt.Println()\n    }\n}\n</code></pre>\n\n<p>Most of the code is from <a href=\"https://www.devdungeon.com/content/packet-capture-injection-and-analysis-gopacket#custom-layers\" rel=\"nofollow noreferrer\">this great post by devdungeon</a>.</p>\n"}, {"tags": ["javascript", "html", "css", "go", "server"], "comments": [{"owner": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 0, "creation_date": 1532952037, "post_id": 51593359, "comment_id": 90152539, "body": "so you&#39;re saying all of the other files (eg main.js, style.css) are in the same folder as index.html, but you can only get index.html?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1532952595, "post_id": 51593359, "comment_id": 90152874, "body": "Check the browser console&#39;s network tab, you&#39;ll probably see 404s for the assets, which is possibly caused by the incompatibility of the server&#39;s folder structure and the html files asset paths."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 0, "creation_date": 1532952618, "post_id": 51593359, "comment_id": 90152892, "body": "@dylan-myers yes all the files are in the same directory. But somehow it will display 404 Page not found in their console."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1532952758, "post_id": 51593359, "comment_id": 90152993, "body": "@mkopriva by that you mean that files pathed in the index.html are wrong?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1532952806, "post_id": 51593359, "comment_id": 90153025, "body": "@DavidB Yes, that is what I mean. Compare one of the urls of those requests that caused the 404 to the actual location of the file on the server."}, {"owner": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 0, "creation_date": 1532952903, "post_id": 51593359, "comment_id": 90153091, "body": "@DavidB can you share us the index.html file, specifically the line where you include your main.js? Also can you share the URL where you can access the index.html file? (It doesn&#39;t have to be public we just need to see how you access the file)"}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1532953129, "post_id": 51593359, "comment_id": 90153229, "body": "@mkopriva Yes the url shows localhost:12112/main.js in the case of error. It displays 404. But do I need to create a new path for this certain file so it will display it on server."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1532953253, "post_id": 51593359, "comment_id": 90153313, "body": "@DavidB I doubt your server&#39;s public facing url is localhost:12112, or is it? Or is that a subfolder of the ./static/ folder on your server?"}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1532953372, "post_id": 51593359, "comment_id": 90153399, "body": "@mkopriva the server is not public. I start it using terminal. However it should work just as a public one no? I changed the url name with toml file."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 0, "creation_date": 1532953410, "post_id": 51593359, "comment_id": 90153428, "body": "@dylan-myers I edited the question and now you can see the html code. I access the by localhost:12112. It is a local server which I created."}, {"owner": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 0, "creation_date": 1532953783, "post_id": 51593359, "comment_id": 90153681, "body": "@DavidB do any of the requests work? eg jquery.js. And all the files are in /static, including index.html?"}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 0, "creation_date": 1532954132, "post_id": 51593359, "comment_id": 90153889, "body": "@dylan-myers none of the requests work. jquery.js and main.js get overwritten my 404, therefore throws an error in console that there is a syntax error. And yes all the files are in static."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1532956174, "post_id": 51593359, "comment_id": 90155161, "body": "@DavidB this is very simple to do in Go, local or public, doesn&#39;t matter. There is no need for including Node. Please add to the question your project&#39;s folder structure, on the server, so we can see where the index file and the asset files live. Also you are using a relative path in your Go code, in that case make sure you start the go binary from the correct location in you server so that the program&#39;s cwd is what you assume it to be."}, {"owner": {"reputation": 1332, "user_id": 3664021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3a9f339c82088c5bfe6be353fbae64?s=128&d=identicon&r=PG", "display_name": "leninhasda", "link": "https://stackoverflow.com/users/3664021/leninhasda"}, "edited": false, "score": 0, "creation_date": 1532959240, "post_id": 51593359, "comment_id": 90157229, "body": "can you show us your folder structure? @DavidB"}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1532959754, "post_id": 51593359, "comment_id": 90157594, "body": "@mkopriva you can check all the files now. All files which should be running in index.html are in the directory called static."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1532959796, "post_id": 51593359, "comment_id": 90157622, "body": "@MichaelHampton all the files are in the same folder. I edited the post if you&#39;d like to see the full content of the directory I am working in."}, {"owner": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 0, "creation_date": 1532961728, "post_id": 51593359, "comment_id": 90158987, "body": "@DavidB silly question, but does localhost:12112/static/main.css work?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1532961785, "post_id": 51593359, "comment_id": 90159023, "body": "@DavidB try this <a href=\"https://gist.github.com/mkopriva/9a94487639b861df8b6c1217bdc91733\" rel=\"nofollow noreferrer\">gist</a>, as you can see from the screen.png, both css and js are loaded just fine (this was executed on my local). Try creating this simplified version of your project on your server and see if it works, if it doesn&#39;t then I don&#39;t know how else to help; if it does work then try to isolate the cause of the issue by gradually changing the simplified version to the full version."}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 1, "creation_date": 1532962031, "post_id": 51593359, "comment_id": 90159181, "body": "Are you using gorilla mux? If so that might be the issue. You should give a working example with imports."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1533021837, "post_id": 51593359, "comment_id": 90180351, "body": "@KennyGrant I am working with mux yes."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 0, "creation_date": 1533022095, "post_id": 51593359, "comment_id": 90180472, "body": "@dylan-myers localhost:12112/static/main.css throws out a 404."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533025358, "post_id": 51593359, "comment_id": 90182276, "body": "@mkopriva Yes this is working, but let us say I now have two different servers and one of them displays data in a json file, and second one displays the html which pulls the data. Now there is a problem with func main(){} since there cannot be two different. Do you have any idea how to resolve this? And btw your code works like a charm, javascript and all, thank you very muhc. Mux was a problem I see."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533025891, "post_id": 51593359, "comment_id": 90182586, "body": "@DavidB <code>main()</code> is not a problem, you can start one server inside a goroutine so that it doesn&#39;t block the other server from being started. Also you can have one server serve both, json and html+assets, this can be done by either routing or by using http headers and query parameters to tell the server what kind of data the client is requesting, and there might be other options. FWIW in my opinion routing is the cleaner option."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533026277, "post_id": 51593359, "comment_id": 90182803, "body": "@mkopriva Currently I am on a project on where I need to create a server that displays the events which are booked on a completely different server.  I am using one test server with same json but the problem is that func main can not be used more than one time. However other things work. This is just a new problem that showed up after I have resolved this one."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1533026828, "post_id": 51593359, "comment_id": 90183110, "body": "@DavidB I don&#39;t think you have a &quot;problem&quot; but maybe I&#39;m misunderstanding something... anyways <code>main</code> is the entrypoint for your program, having more than one entrypoints for a single program makes no sense, and this is not Go specific, the few other languages I know behave the same. If you need to share code between two programs, then create a non-main package and have the two programs import it. If you need two programs to communicate with each other, say over http, e.g. server A retrieves json from server B, then that&#39;s also doable, just use the <code>net&#47;http.Client</code> type to send the requests."}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1533027264, "post_id": 51593359, "comment_id": 90183354, "body": "@mkopriva Well I solved the so called &quot;problem&quot;. The servers were in the same folder therefore func main got rewritten time and time again. So all I did was move one server to the other directory, because it was only a test server for the one which is actually going to be used and then started the servers from 2 different terminals. Thank you again for all of your help."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "edited": false, "score": 0, "creation_date": 1533022018, "post_id": 51597260, "comment_id": 90180439, "body": "It does work differently than before, but still punches errors for each file in the static folder now. Most of them say it is a MIME type (text/plain)"}, {"owner": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 1, "creation_date": 1533025470, "post_id": 51597260, "comment_id": 90182326, "body": "Sorry, me again, does replacing <code>mux.NewRouter</code> with a custom router which uses http.FileServer (like this: <a href=\"https://golangcode.com/serve-static-assets-using-the-mux-router/\" rel=\"nofollow noreferrer\">golangcode.com/serve-static-assets-using-the-mux-router</a>) help?"}, {"owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "reply_to_user": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "edited": false, "score": 1, "creation_date": 1533026103, "post_id": 51597260, "comment_id": 90182699, "body": "@dylan-myers I have completely discarded mux from my code now and tried the normal server create approach. It works fine now."}, {"owner": {"reputation": 174, "user_id": 2710385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d051dbe69f276cf71ca9fa54358b10?s=128&d=identicon&r=PG&f=1", "display_name": "dylan-myers", "link": "https://stackoverflow.com/users/2710385/dylan-myers"}, "reply_to_user": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "edited": false, "score": 0, "creation_date": 1533027769, "post_id": 51597260, "comment_id": 90183654, "body": "@DavidB fair enough. This answer from Michael is probably a good answer for your question though, I&#39;d accept it for anyone else with the same issue :)"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "edited": false, "score": 0, "creation_date": 1533038930, "post_id": 51597260, "comment_id": 90190957, "body": "@DavidB This minimal example works exactly as is. It&#39;s intended to demonstrate the concept while being <code>go run</code>able. If you had trouble adapting it to your existing code, you might ask a new question about that."}], "tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": true, "score": 3, "last_activity_date": 1532964002, "creation_date": 1532964002, "answer_id": 51597260, "question_id": 51593359, "link": "https://stackoverflow.com/questions/51593359/possibility-of-adding-html-css-js-to-go-server/51597260#51597260", "title": "Possibility of adding html, css, js, ... to Go server?", "body": "<p>The problem is you're trying to feed a <code>http.FileServer</code> to Gorilla mux's <code>route.Handle</code> function. This handles a single URL, so it's only valid for the given URL, <code>/</code>.</p>\n\n<p>What you want for serving static files is a <code>route.PathPrefix()</code>. This serves any URL path which <em>begins with</em> the given string, while <code>route.Handle()</code> serves only a path which matches the string exactly.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n    r := mux.NewRouter()\n    r.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./static\")))\n\n    // Create and start HTTP server.\n    s := &amp;http.Server{\n        Handler: r,\n        Addr:    \":8009\",\n    }\n\n    log.Fatalln(s.ListenAndServe())\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10076329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EqZwubKY3zc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o1wH_fgsJoiN84cK5Cw8mgjbgn3g/mo/photo.jpg?sz=128", "display_name": "DavidB", "link": "https://stackoverflow.com/users/10076329/davidb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 51597260, "answer_count": 1, "score": 0, "last_activity_date": 1532964002, "creation_date": 1532951468, "last_edit_date": 1532959681, "question_id": 51593359, "link": "https://stackoverflow.com/questions/51593359/possibility-of-adding-html-css-js-to-go-server", "title": "Possibility of adding html, css, js, ... to Go server?", "body": "<p>I am having trouble getting files such as index.html, main.js, style.css and more on my server made in Go.\nMy html file works fine with javascript and css on my local file but I can not make it work on a server.\n<br>\nI already tried making this in my code, but it only starts html file and javascript, css, jquer, font are listed in console like the page was not found (404 Page not found).</p>\n\n<pre><code>r := mux.NewRouter()\nr.Handle(\"/\", http.FileServer(http.Dir(\"./static\")))\nr.HandleFunc(\"/events\", eventHandler) //Ignore this\nr.NotFoundHandler = http.HandlerFunc(notFound) //This is just a custom 404.\n\n// Create and start HTTP server.\ns := &amp;http.Server{\n    Handler: r,\n    Addr:    config.Address,\n}\n</code></pre>\n\n<p>My question is:\n<br>Is there any possibility to do this without Node.js. Is there any option that will display all my javascript files and css in the html. I really would not like to get this things complicated with Node.</p>\n\n<p><strong>Note</strong>\n<br>\nMy codes for html, css, javascript all work. My server also works, the only thing needed now is adding the files to the server.<p>\n<a href=\"https://i.stack.imgur.com/9TnUF.png\" rel=\"nofollow noreferrer\">This is what I get</a><br><a href=\"https://i.stack.imgur.com/782Fu.png\" rel=\"nofollow noreferrer\"> This is what I should get on server.</a></p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n    &lt;link rel=\"stylesheet\" href=\"main.css\"&gt;\n    &lt;script src=\"jquery-3.3.1.min.js\"&gt;&lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body id='body'&gt;\n    &lt;div class=\"app-body\"&gt;\n        &lt;div id='left' class=\"left\"&gt;\n            &lt;div class='conferenceRoom'&gt;Conference room\n                &lt;h1 class=\"roomName\"&gt;crane\n                &lt;/h1&gt;\n            &lt;/div&gt;\n            &lt;div class=\"status\"&gt;\n                &lt;h1 id=\"free_busy\" class=\"free_busy\"&gt;&lt;/h1&gt;\n                &lt;h1 id=\"duration\" class=\"duration\"&gt;&lt;/h1&gt;\n\n            &lt;/div&gt;\n            &lt;/div&gt;\n\n        &lt;/div&gt;\n        &lt;div class=\"right\"&gt;\n            &lt;div class=\"date\" id=\"date\"&gt;&lt;/div&gt;\n            &lt;div id='eventList' class=\"eventList\"&gt;&lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;script src=\"main.js\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>\nindex.html\nThis are my files in a directory called Website. Server is started by: <br></p>\n\n<pre><code>        go run *.go -c config.toml\n</code></pre>\n\n<p>This is ran from the website folder. <a href=\"https://i.stack.imgur.com/6aCi3.png\" rel=\"nofollow noreferrer\">And this is what the files look like</a></p>\n"}, {"tags": ["arrays", "json", "go", "interface"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1532968129, "post_id": 51592316, "comment_id": 90162807, "body": "Why the downvote here? The question seems well phrased, includes code and sample data, and otherwise seems appropriate for this community..."}, {"owner": {"reputation": 81, "user_id": 10150930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GgBBkpUW710/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7puoa8L7t1UYQZjYTO4431xkK3NpA/mo/photo.jpg?sz=128", "display_name": "bed", "link": "https://stackoverflow.com/users/10150930/bed"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1533030846, "post_id": 51592316, "comment_id": 90185658, "body": "I don&#39;t know. Thx for the support man"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 10150930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GgBBkpUW710/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7puoa8L7t1UYQZjYTO4431xkK3NpA/mo/photo.jpg?sz=128", "display_name": "bed", "link": "https://stackoverflow.com/users/10150930/bed"}, "edited": false, "score": 1, "creation_date": 1533130786, "post_id": 51599073, "comment_id": 90233852, "body": "With a small change I got what I wanted .. Thanks a lot"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 2, "last_activity_date": 1532970496, "creation_date": 1532970496, "answer_id": 51599073, "question_id": 51592316, "link": "https://stackoverflow.com/questions/51592316/merge-two-json-arrays-with-a-common-key-golang/51599073#51599073", "title": "merge two JSON arrays with a common key golang", "body": "<p>One observation here is that you can define a simple type that will model both of your data sets and use the golang type system to your advantage (instead of working against it by using so much reflection), for example:</p>\n\n<pre><code>type Data struct {\n  Count   int                 `json:\"count\"`\n  Results []map[string]string `json:\"result\"`\n}\n\n// ...\noracleData, mysqlData := Data{}, Data{}\nerr := json.Unmarshal([]byte(oracleJson), &amp;oracleData)\ncheck(err)\nerr := json.Unmarshal([]byte(mysqlJson), &amp;mysqlData)\ncheck(err)\n</code></pre>\n\n<p>Now your \"merge\" function can simply return a new \"Data\" struct with values populated from the two inputs without having to worry about type assertions or casting. One key feature of this implementation is that it creates a lookup table of data result objects by their \"DESC\" key, which is later used for correlation:</p>\n\n<pre><code>func merge(d1, d2 Data) Data {\n  // Create the lookup table by each result object \"DESC\".\n  d1ResultsByDesc := map[string]map[string]string{}\n  for _, obj1 := range d1.Results {\n    d1ResultsByDesc[obj1[\"DESC\"]] = obj1\n  }\n\n  newData := Data{}\n  for _, obj2 := range d2.Results {\n    newObj := map[string]string{}\n    // Include all result data objects from d2\n    for k2, v2 := range obj2 {\n      newObj[k2] = v2\n    }\n    // Also include the matching result data from d1\n    obj1 := d1ResultsByDesc[obj2[\"DESC\"]]\n    for k1, v1 := range obj1 {\n      newObj[k1] = v1\n    }\n    newData.Results = append(newData.Results, newObj)\n  }\n\n  return newData\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 10150930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GgBBkpUW710/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7puoa8L7t1UYQZjYTO4431xkK3NpA/mo/photo.jpg?sz=128", "display_name": "bed", "link": "https://stackoverflow.com/users/10150930/bed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1739, "favorite_count": 0, "accepted_answer_id": 51599073, "answer_count": 1, "score": 0, "last_activity_date": 1532970496, "creation_date": 1532947843, "last_edit_date": 1532962458, "question_id": 51592316, "link": "https://stackoverflow.com/questions/51592316/merge-two-json-arrays-with-a-common-key-golang", "title": "merge two JSON arrays with a common key golang", "body": "<p>it's days I try to merge two jons based on a common key. I have in input two different JSONs with a common field, I would like to merge the data of the two json based on the common key. A sort of sql join between the two JSON.</p>\n\n<p>JSON derives from this code</p>\n\n<pre><code>func Dati_plus(c *gin.Context) {\n\noracle, err := http.Get(\"http://XXXX/XXX\")\n    if err != nil {\n            panic(err)\n    }\ndefer oracle.Body.Close()\n\nmysql, err := http.Get(\"http://XXXX/XXX\")\nif err != nil {\n        panic(err)\n}\ndefer mysql.Body.Close()\n\noracleJSON, err := ioutil.ReadAll(oracle.Body)\nif err != nil {\n        panic(err)\n}\nmysqlJSON, err := ioutil.ReadAll(mysql.Body)\nif err != nil {\n        panic(err)\n}\n\nvar oracleOUT map[string]interface{}\nvar mysqlOUT map[string]interface{}\n\njson.Unmarshal([]byte(oracleJSON), &amp;oracleOUT)\njson.Unmarshal([]byte(mysqlJSON), &amp;mysqlOUT)\n\na := map[string]interface{}{\"result\":mysqlOUT[\"result\"]}\nb := map[string]interface{}{\"result\":oracleOUT[\"result\"]}\n</code></pre>\n\n<p>the JSONs in input have this form</p>\n\n<pre><code>{\"count\":2,\"result\":[{\"DESC\":\"2\",\"NOMEmy\":\"PIPPO\",\"COGNOMEmy\":\"PIPPO\"},{\"DESC\":\"7\",\"NOMEmy\":\"PIPPO\",\"COGNOMEmy\":\"PIPPO\"}]\n\n{\"count\":2,\"result\":[{\"DESC\":\"2\",\"COS\":\"PIPPO\",\"ROS\":\"PIPPO\"},{\"DESC\":\"7\",\"COS\":\"PIPPO\",\"ROS\":\"PIPPO\"},{\"DESC\":\"60\",\"COS\":\"PIPPO\",\"ROS\":\"PIPPO\"}]\n</code></pre>\n\n<p>If i have two json like this the result of the function it should be</p>\n\n<pre><code>{\"count\":2,\"result\":[{\"DESC\":\"2\",\"COS\":\"PIPPO\",\"ROS\":\"PIPPO\",\"NOMEmy\":\"PIPPO\",\"COGNOMEmy\":\"PIPPO\"},{\"DESC\":\"7\",\"COS\":\"PIPPO\",\"ROS\":\"PIPPO\",\"NOMEmy\":\"PIPPO\",\"COGNOMEmy\":\"PIPPO\"},{\"DESC\":\"60\",\"COS\":\"PIPPO\",\"ROS\":\"PIPPO\"}]\n</code></pre>\n\n<p>if it can help, this is a function I use for merge between two single-value JSONs, but I could not modify it in the right way</p>\n\n<pre><code>    func merge(dst, src map[string]interface{}, depth int) map[string]interface{} {\n    if depth &gt; MaxDepth {\n        panic(\"Troppo Lungo\")\n    }\n    for key, srcVal := range src {\n        if dstVal, ok := dst[key]; ok {\n            srcMap, srcMapOk := mapify(srcVal)\n            dstMap, dstMapOk := mapify(dstVal)\n            if srcMapOk &amp;&amp; dstMapOk {\n                srcVal = merge(dstMap, srcMap, depth+1)\n            }\n        }\n        dst[key] = srcVal\n    }\n    return dst\n}\n\n    func mapify(i interface{}) (map[string]interface{}, bool) {\n        value := reflect.ValueOf(i)\n        if value.Kind() == reflect.Map {\n            m := map[string]interface{}{}\n            for _, k := range value.MapKeys() {\n                m[k.String()] = value.MapIndex(k).Interface()\n            }\n            return m, true\n        }\n        return map[string]interface{}{}, false\n    }\n</code></pre>\n\n<p>Please, Help Me. THX</p>\n"}, {"tags": ["go", "multipartform-data", "gorilla"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1532955442, "post_id": 51592161, "comment_id": 90154690, "body": "Bear in mind that while most browsers will submit form fields in the order they appear in the HTML, there is technically no guarantee this will be the case, so relying on the ordering of multiple fields with the same name may be dangerous. You might consider sequential naming of fields to be certain that <code>name1</code> goes with <code>phone1</code>, because <code>name[1]</code> and <code>phone[1]</code> might not."}], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1532952061, "post_id": 51592453, "comment_id": 90152551, "body": "How would you process the data though?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1532952112, "post_id": 51592453, "comment_id": 90152589, "body": "looping over the data and then assign it to a different struct as per your requirement. Or simply implement unmarshal interface"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1532954040, "post_id": 51592453, "comment_id": 90153827, "body": "@hendry Please check edited code to process the data according to your requirement"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1532960166, "last_edit_date": 1532960166, "creation_date": 1532948281, "answer_id": 51592453, "question_id": 51592161, "link": "https://stackoverflow.com/questions/51592161/repeating-formdata-to-go-struct/51592453#51592453", "title": "Repeating formData to Go struct", "body": "<p>In your provided data of json each key contains two values. That's the reason behind empty slices. Use slice of string in your struct to unmarshal the value. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/gorilla/schema\"\n)\n\ntype Person struct {\n    Name  []string // this should be a slice since the key contains multiple values\n    Phone []string\n}\n\ntype Person2 struct {\n    Name  string\n    Phone string\n}\n\nfunc main() {\n    values := map[string][]string{\n        \"Name\":  {\"John\", \"Jake\"},\n        \"Phone\": {\"999-999-999\", \"12312-123-123\"},\n    }\n    person := new(Person)\n    decoder := schema.NewDecoder()\n    decoder.Decode(person, values)\n    fmt.Println(person)\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>&amp;{[John Jake] [999-999-999 12312-123-123]}\n</code></pre>\n\n<p>For required structure</p>\n\n<pre><code>{ Name: \"John\", Phone: \"999-999-999\" }, \n{ Name: \"Jake\", Phone: \"12312-123-123\" }\n</code></pre>\n\n<p><strong>Edited:</strong></p>\n\n<p>Process the data coming from form to change the format of your structure.</p>\n\n<pre><code>type Person2 struct {\n    Name  string\n    Phone string\n}\n\nfunc processData(person *Person) {\n    var result []Person2\n    var person2 Person2\n    for i := 0; i &lt; len(person.Name); i++ {\n        person2.Name = person.Name[i]\n        person2.Phone = person.Phone[i]\n        result = append(result, person2)\n    }\n    fmt.Printf(\"%#v\\n\", result)\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>[]stack.Person2{stack.Person2{Name:\"John\", Phone:\"999-999-999\"}, stack.Person2{Name:\"Jake\", Phone:\"12312-123-123\"}}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ja9t2-D8Wik\" rel=\"nofollow noreferrer\">Playground Example</a> to process the data</p>\n\n<p>As @Adrain suggested it is better to use some kind of indexing with the field names for the form. It is also provided in <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"nofollow noreferrer\"><code>gorilla/schema</code></a> package to name the values with indexes for saving multiple records.</p>\n\n<pre><code>&lt;form&gt;\n    &lt;input type=\"text\" name=\"Name\"&gt;\n    &lt;input type=\"text\" name=\"Phones.0.Label\"&gt;\n    &lt;input type=\"text\" name=\"Phones.0.Number\"&gt;\n    &lt;input type=\"text\" name=\"Phones.1.Label\"&gt;\n    &lt;input type=\"text\" name=\"Phones.1.Number\"&gt;\n    &lt;input type=\"text\" name=\"Phones.2.Label\"&gt;\n    &lt;input type=\"text\" name=\"Phones.2.Number\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Above form can be parsed to below struct which contains a slice of Phone:</p>\n\n<pre><code>type Person struct {\n    Name   string\n    Phones []Phone\n}\n</code></pre>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532960166, "creation_date": 1532947300, "last_edit_date": 1532948784, "question_id": 51592161, "link": "https://stackoverflow.com/questions/51592161/repeating-formdata-to-go-struct", "title": "Repeating formData to Go struct", "body": "<p>I am submitting a repeating form, where the resulting formData is parsed as:</p>\n\n<pre><code>\"Name\":  {\"John\", \"Jake\"},\n\"Phone\": {\"999-999-999\", \"12312-123-123\"}, \n</code></pre>\n\n<p>However, I want to structure to be </p>\n\n<pre><code>{ Name: \"John\", Phone: \"999-999-999\" }, \n{ Name: \"Jake\", Phone: \"12312-123-123\" }.\n</code></pre>\n\n<p>I'm told <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"nofollow noreferrer\">gorilla/schema</a>, is a good fit, but I tried it below and it produces an empty slice. Is there something I am missing?</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n\n        \"github.com/gorilla/schema\"\n)\n\ntype Person struct {\n        Name  string\n        Phone string\n}\n\nfunc main() {\n        values := map[string][]string{\n                \"Name\":  {\"John\", \"Jake\"},\n                \"Phone\": {\"999-999-999\", \"12312-123-123\"},\n        }\n        var persons []Person\n        decoder := schema.NewDecoder()\n        decoder.Decode(persons, values)\n        fmt.Println(persons)\n}\n</code></pre>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1532947174, "post_id": 51591135, "comment_id": 90149442, "body": "There is an open GitHub issue related to it, a lot of people don&#39;t like it. <a href=\"https://github.com/golang/protobuf/issues/276\" rel=\"nofollow noreferrer\">github.com/golang/protobuf/issues/276</a> For now you can create your own struct for DB, excluding XXX properties."}, {"owner": {"reputation": 1, "user_id": 9971664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3vii.jpg?s=128&g=1", "display_name": "salamanderGame", "link": "https://stackoverflow.com/users/9971664/salamandergame"}, "reply_to_user": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1533085496, "post_id": 51591135, "comment_id": 90213089, "body": "@pltvs alright."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8374408, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OPR1mg5ed9M/AAAAAAAAAAI/AAAAAAAAB50/TWrphusq98g/photo.jpg?sz=128", "display_name": "jafar basha", "link": "https://stackoverflow.com/users/8374408/jafar-basha"}, "is_accepted": false, "score": 0, "last_activity_date": 1583214072, "creation_date": 1583214072, "answer_id": 60500734, "question_id": 51591135, "link": "https://stackoverflow.com/questions/51591135/some-strange-fields-was-added-after-converting-protobuf-message-to-go-struct/60500734#60500734", "title": "some strange fields was added after converting protobuf message to go struct?", "body": "<p><a href=\"https://github.com/gogo/protobuf\" rel=\"nofollow noreferrer\">gogoprotobuf</a> is a fork of golang/protobuf with extra code generation features.</p>\n\n<p>protoc-gen-gogofaster (without XXX_unrecognized, less pointer fields)</p>\n\n<pre><code>go get github.com/gogo/protobuf/protoc-gen-gofaster\n\ngo install github.com/gogo/protobuf/protoc-gen-gofaster\n\nprotoc --gofaster_out=plugins=grpc:. my.proto\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9971664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3vii.jpg?s=128&g=1", "display_name": "salamanderGame", "link": "https://stackoverflow.com/users/9971664/salamandergame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583214072, "creation_date": 1532943762, "last_edit_date": 1533026129, "question_id": 51591135, "link": "https://stackoverflow.com/questions/51591135/some-strange-fields-was-added-after-converting-protobuf-message-to-go-struct", "title": "some strange fields was added after converting protobuf message to go struct?", "body": "<p>I want to have an API to save a User. Here is my user message:</p>\n\n<pre><code>message User {\n    int32 uid = 1;\n    string username = 2;\n    string password = 3;\n}\n</code></pre>\n\n<p>And I use <code>protoc-gen-go</code> to convert it to go struct. I found some strange fields was added(<code>XXX_NoUnkeyedLiteral</code>, <code>XXX_unrecognized</code>).</p>\n\n<pre><code>type User struct {\n    Uid                  int32    `protobuf:\"varint,1,opt,name=uid,proto3\" json:\"uid,omitempty\"`\n    Username             string   `protobuf:\"bytes,2,opt,name=username,proto3\" json:\"username,omitempty\"`\n    Password             string   `protobuf:\"bytes,3,opt,name=password,proto3\" json:\"password,omitempty\"`\n    XXX_NoUnkeyedLiteral struct{} `json:\"-\"`\n    XXX_unrecognized     []byte   `json:\"-\"`\n    XXX_sizecache        int32    `json:\"-\"`\n}\n</code></pre>\n\n<p>I can't save it to MySQL due to those fields because my MySQL table doesn't have those fields. anyone good advice? I have to create another struct to convert MySQL table to protobuf Message?</p>\n"}, {"tags": ["mysql", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "is_accepted": true, "score": 3, "last_activity_date": 1532947789, "last_edit_date": 1532947789, "creation_date": 1532943764, "answer_id": 51591137, "question_id": 51590876, "link": "https://stackoverflow.com/questions/51590876/cannot-fetch-all-rows-with-db-rows/51591137#51591137", "title": "Cannot fetch all rows with *DB.Rows()", "body": "<p>You can try this alternate approach:</p>\n\n<pre><code>var records []Group\ndb.Find(&amp;records)\n</code></pre>\n\n<p>All data will be available as an array in <code>records</code>.</p>\n\n<p>If you need to handle the errors:</p>\n\n<pre><code>if err := db.Find(&amp;records).Error; err != nil {\n  log.Fatalln(err)\n}\nlog.Printf(\"%d rows found.\", len(records))\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5800884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2180, "favorite_count": 0, "accepted_answer_id": 51591137, "answer_count": 1, "score": 0, "last_activity_date": 1532953604, "creation_date": 1532942971, "last_edit_date": 1532953604, "question_id": 51590876, "link": "https://stackoverflow.com/questions/51590876/cannot-fetch-all-rows-with-db-rows", "title": "Cannot fetch all rows with *DB.Rows()", "body": "<p>I'm new to gorm so if I misunderstand something, please point it out.</p>\n\n<p>I'm writing small application using MySQL and I decide to use gorm as ORM.\nSource code and output is following.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/mysql\"\n)\n\ntype Group struct {\n    gorm.Model\n    Name string `gorm:\"not null;unique\"`\n}\n\nfunc openDB() *gorm.DB {\n    user := \"ipmonitor\"\n    password := \"testpassword\"\n    database := \"ipmonitor\"\n\n    mysqlURL := \"%s:%s@/%s?charset=utf8mb4&amp;parseTime=True&amp;loc=Local\"\n\n    db, err := gorm.Open(\"mysql\", fmt.Sprintf(mysqlURL, user, password, database))\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    return db\n}\n\nfunc initDB(db *gorm.DB) {\n    db = db.Set(\"gorm:table_options\", \"ENGINE=InnoDB CHARSET=utf8mb4\")\n    db.AutoMigrate(&amp;Group{})\n\n    result := db.Create(&amp;Group{Name: \"foo\"})\n    if result.Error != nil {\n        log.Fatalln(result.Error)\n    }\n    result = db.Create(&amp;Group{Name: \"bar\"})\n    if result.Error != nil {\n        log.Fatalln(result.Error)\n    }\n    result = db.Create(&amp;Group{Name: \"baz\"})\n    if result.Error != nil {\n        log.Fatalln(result.Error)\n    }\n}\n\nfunc main() {\n    db := openDB()\n    db.LogMode(true)\n    initDB(db)\n\n    records := db.Find(&amp;Group{})\n    if records.Error != nil {\n        log.Fatalln(records.Error)\n    }\n\n    log.Printf(\"%d rows found.\", records.RowsAffected)\n    rows, err := records.Rows()\n    if err != nil {\n        log.Fatalln(err)\n    }\n    defer rows.Close()\n\n    for rows.Next() {\n        var group Group\n        err := db.ScanRows(rows, &amp;group)\n        if err != nil {\n            log.Fatalln(err)\n        }\n\n        log.Printf(\"%+v\\n\", group)\n    }\n    if rows.Err() != nil {\n        log.Fatalln(rows.Err())\n    }\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>(dbtest.go:33)\n[2018-07-30 18:12:33]  [9.96ms]  CREATE TABLE `groups` (`id` int unsigned AUTO_INCREMENT,`created_at` timestamp NULL,`updated_at` timestamp NULL,`deleted_at` timestamp NULL,`name` varchar(255) NOT NULL UNIQUE , PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4\n[0 rows affected or returned ]\n\n(dbtest.go:33)\n[2018-07-30 18:12:33]  [6.95ms]  CREATE INDEX idx_groups_deleted_at ON `groups`(deleted_at)\n[0 rows affected or returned ]\n\n(dbtest.go:35)\n[2018-07-30 18:12:33]  [0.89ms]  INSERT INTO `groups` (`created_at`,`updated_at`,`deleted_at`,`name`) VALUES ('2018-07-30 18:12:33','2018-07-30 18:12:33',NULL,'foo')\n[1 rows affected or returned ]\n\n(dbtest.go:39)\n[2018-07-30 18:12:33]  [0.99ms]  INSERT INTO `groups` (`created_at`,`updated_at`,`deleted_at`,`name`) VALUES ('2018-07-30 18:12:33','2018-07-30 18:12:33',NULL,'bar')\n[1 rows affected or returned ]\n\n(dbtest.go:43)\n[2018-07-30 18:12:33]  [0.88ms]  INSERT INTO `groups` (`created_at`,`updated_at`,`deleted_at`,`name`) VALUES ('2018-07-30 18:12:33','2018-07-30 18:12:33',NULL,'baz')\n[1 rows affected or returned ]\n\n(dbtest.go:54)\n[2018-07-30 18:12:33]  [0.63ms]  SELECT * FROM `groups`  WHERE `groups`.`deleted_at` IS NULL\n[3 rows affected or returned ]\n2018/07/30 18:12:33 3 rows found.\n\n(dbtest.go:60)\n[2018-07-30 18:12:33]  [0.77ms]  SELECT * FROM `groups`  WHERE `groups`.`deleted_at` IS NULL AND `groups`.`id` = '3'\n[0 rows affected or returned ]\n2018/07/30 18:12:33 {Model:{ID:3 CreatedAt:2018-07-30 18:12:34 +0900 JST UpdatedAt:2018-07-30 18:12:34 +0900 JST DeletedAt:&lt;nil&gt;} Name:baz}\n</code></pre>\n\n<p>MySQL</p>\n\n<pre><code>mysql&gt; select * from groups;\n+----+---------------------+---------------------+------------+------+\n| id | created_at          | updated_at          | deleted_at | name |\n+----+---------------------+---------------------+------------+------+\n|  1 | 2018-07-30 18:12:34 | 2018-07-30 18:12:34 | NULL       | foo  |\n|  2 | 2018-07-30 18:12:34 | 2018-07-30 18:12:34 | NULL       | bar  |\n|  3 | 2018-07-30 18:12:34 | 2018-07-30 18:12:34 | NULL       | baz  |\n+----+---------------------+---------------------+------------+------+\n3 rows in set (0.00 sec)\n</code></pre>\n\n<p>I expect that <code>*DB.Find().Rows()</code> method returns multiple rows but it seems only return last row.</p>\n\n<p>According to gorm debug output, it seems that unspecified condition is added when SELECT statement is executed.</p>\n\n<p>After googling, I can't figure out the cause of problem.\nWhy my code doesn't work?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "goland"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1532941505, "post_id": 51590368, "comment_id": 90146051, "body": "go fmt makes no changes to your DVCS."}], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 2, "last_activity_date": 1532941815, "creation_date": 1532941815, "answer_id": 51590515, "question_id": 51590368, "link": "https://stackoverflow.com/questions/51590368/what-is-differences-between-goland-reformat-shortcutctrlaltl-and-go-fmt/51590515#51590515", "title": "What is differences between goland reformat shortcut(ctrl+alt+L) and go fmt?", "body": "<p>The builtin formatter, available via <kbd>ctrl</kbd>+<kbd>alt</kbd>+<kbd>L</kbd> (reformat code),  is what the IDE implements in order to format the code. It currently (as of 2018.2) is not 100% on-par with gofmt so I recommend using gofmt before committing the files.</p>\n\n<p>As for the changes you mention in DVCS, you need to provide more details either here or on <a href=\"https://youtrack.jetbrains.com/issues/Go\" rel=\"nofollow noreferrer\">the issue tracker</a>, in order to understand what's happening.</p>\n"}, {"tags": [], "owner": {"reputation": 368, "user_id": 1538111, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/60cd75d8909aa1c1318d2e93d7507990?s=128&d=identicon&r=PG", "display_name": "Muhammad Farag", "link": "https://stackoverflow.com/users/1538111/muhammad-farag"}, "is_accepted": false, "score": 0, "last_activity_date": 1532962857, "creation_date": 1532962857, "answer_id": 51596899, "question_id": 51590368, "link": "https://stackoverflow.com/questions/51590368/what-is-differences-between-goland-reformat-shortcutctrlaltl-and-go-fmt/51596899#51596899", "title": "What is differences between goland reformat shortcut(ctrl+alt+L) and go fmt?", "body": "<p>You can use GoLand to gofmt your code when you commit it. It is easy to do, just check the <code>Go fmt</code> check box in the Before Commit section in the commit box. I don't care as much not which one do I do, if any while working on the code.</p>\n\n<p>There are few things that Go fmt doesn't do. Things around arbitrary line length which doesn't contradict with Go fmt. That is Go fmt will not reformat them</p>\n"}], "owner": {"reputation": 21, "user_id": 8443467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce27b171c152edec5030f58c84d7da8?s=128&d=identicon&r=PG&f=1", "display_name": "cassia", "link": "https://stackoverflow.com/users/8443467/cassia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1532962857, "creation_date": 1532941308, "last_edit_date": 1532941861, "question_id": 51590368, "link": "https://stackoverflow.com/questions/51590368/what-is-differences-between-goland-reformat-shortcutctrlaltl-and-go-fmt", "title": "What is differences between goland reformat shortcut(ctrl+alt+L) and go fmt?", "body": "<p>I always use goland's keyboard shortcut <kbd>ctrl</kbd>+<kbd>alt</kbd>+<kbd>L</kbd> (reformat code) to format my goland code. And when I use go fmt command,it still make some changes. So... What is differences between goland reformat(<kbd>ctrl</kbd>+<kbd>alt</kbd>+<kbd>l</kbd>) and go fmt?</p>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1532941522, "post_id": 51590153, "comment_id": 90146062, "body": "<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-refresh.html\" rel=\"nofollow noreferrer\">elastic.co/guide/en/elasticsearch/reference/current/&hellip;</a>. Note that many requests with ?refresh can cause serious performance issues."}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1532941872, "post_id": 51590153, "comment_id": 90146259, "body": "Thanks. Can you please create the answer."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1532943566, "post_id": 51590153, "comment_id": 90147292, "body": "Nah. I don&#39;t know the package, so I can&#39;t write an adequate answer. You can do it yourself though."}], "answers": [{"tags": [], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "is_accepted": true, "score": 1, "last_activity_date": 1532965596, "creation_date": 1532965596, "answer_id": 51597728, "question_id": 51590153, "link": "https://stackoverflow.com/questions/51590153/delete-document-from-elasticsearch-synchronously/51597728#51597728", "title": "Delete document from Elasticsearch synchronously", "body": "<pre><code>_, err := e.client.Delete().Index(index).Type(\"entity\").\n    Id(id).Refresh(\"true\").Do(e.ctx)\n</code></pre>\n\n<p><strong>Refresh(\"true\")</strong></p>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 51597728, "answer_count": 1, "score": 0, "last_activity_date": 1532965596, "creation_date": 1532940482, "question_id": 51590153, "link": "https://stackoverflow.com/questions/51590153/delete-document-from-elasticsearch-synchronously", "title": "Delete document from Elasticsearch synchronously", "body": "<p>I am using olivere/elastic to work with elasticsearch in Go.\nHere is my code:</p>\n\n<pre><code>// (1) delete document \n_, err := e.client.Delete().Index(index).Type(\"entity\").\n    Id(id).Do(e.ctx)\n\nif err != nil {\n    fmt.Println(err.Error())\n}\n\n// (2) get all documents \nresult, err := e.client.Search().Index(index).From(1).Size(100).Do(e.ctx)\nif err != nil {\n    log.Println(err)\n}\n\nfmt.Println(result.TotalHits())\n\n// (3) wait\ntime.Sleep(3 * time.Second)\n\n// (4) get all documents\nresult, err = e.client.Search().Index(index).From(1).Size(100).Do(e.ctx)\nif err != nil {\n    log.Println(err)\n}\n\nfmt.Println(result.TotalHits())\n</code></pre>\n\n<p>Here I am:</p>\n\n<ul>\n<li>delete document </li>\n<li>get all documents from collection</li>\n<li>wait 3 seconds</li>\n<li>get the same documents from collection</li>\n</ul>\n\n<p>Now on the step (2) I get one more document than step (4).\nLooks like the document is deleted in Elastic with some delay and I am searching the way to delete the document synchronously.</p>\n"}, {"tags": ["elasticsearch", "go"], "owner": {"reputation": 73, "user_id": 8499218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9eb596194db6f333c1e819615b8ca0?s=128&d=identicon&r=PG&f=1", "display_name": "user8499218", "link": "https://stackoverflow.com/users/8499218/user8499218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1532940465, "creation_date": 1532940465, "question_id": 51590148, "link": "https://stackoverflow.com/questions/51590148/elastic-error-400-bad-request-failed-to-execute-script-type-illegal-argumen", "title": "elastic: Error 400 (Bad Request): failed to execute script [type=illegal_argument_exception]", "body": "<p>Using <strong>gopkg.in/olivere/elastic.v5</strong>\nfor adding a field to a document in elasticsearch \nCode:</p>\n\n<pre><code>script := elastic.NewScript(`ctx._source.new_field += params.vijay`).Param(\"vijay\", \"kumar\").p\n                //script := elastic.NewScript(\"ctx._source.retweets += params.num\").Param(\"num\", 1)\n                fmt.Println(\"script\", script)\n                update, err := client.Update().Index(\"idx001\").Type(\"sdoc\").Id(t.Docid).Script(script).Do(ctx)\n                if err != nil {\n                    // Handle error\n                    panic(err)\n                }\n                fmt.Println(\"result is\", update.Result)\n</code></pre>\n\n<p>And the result got is(here i am printing the script formed also)</p>\n\n<p><strong>script &amp;{ctx._source.new_field += params.vijay   map[vijay:kumar]}\npanic: elastic: Error 400 (Bad Request): failed to execute script [type=illegal_argument_exception]</strong> </p>\n\n<p>Expected the field <strong>vijay</strong> to be added into elasticsearch with the value <strong>kumar</strong></p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "edited": false, "score": 0, "creation_date": 1532946747, "post_id": 51590329, "comment_id": 90149217, "body": "Do you know why when I decode with mapstructure the struct has empty values?"}, {"owner": {"reputation": 26372, "user_id": 5867722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VQ1v.jpg?s=128&g=1", "display_name": "Farhad Farahi", "link": "https://stackoverflow.com/users/5867722/farhad-farahi"}, "reply_to_user": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "edited": false, "score": 0, "creation_date": 1532952752, "post_id": 51590329, "comment_id": 90152990, "body": "@FabioVenturiPastor Please refer to this example, <a href=\"https://godoc.org/github.com/mitchellh/mapstructure#example-Decode\" rel=\"nofollow noreferrer\">godoc.org/github.com/mitchellh/mapstructure#example-Decode</a> and check for differences in your code. I can confirm that the example is working, although I prefer second method in the answer."}, {"owner": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "edited": false, "score": 0, "creation_date": 1532953741, "post_id": 51590329, "comment_id": 90153655, "body": "Sorry I did a mistake, thank you. Only one question, do you know the integer values are 0?"}, {"owner": {"reputation": 26372, "user_id": 5867722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VQ1v.jpg?s=128&g=1", "display_name": "Farhad Farahi", "link": "https://stackoverflow.com/users/5867722/farhad-farahi"}, "reply_to_user": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "edited": false, "score": 0, "creation_date": 1532954208, "post_id": 51590329, "comment_id": 90153936, "body": "@FabioVenturiPastor you mean initial integer value? if so Yes, its initialized as 0."}, {"owner": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "edited": false, "score": 0, "creation_date": 1532954279, "post_id": 51590329, "comment_id": 90153976, "body": "No sorry, the Page struct has more values like talking_about_count. So before  Decode the value is for example 45 and after Decode is 0 :S"}, {"owner": {"reputation": 26372, "user_id": 5867722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VQ1v.jpg?s=128&g=1", "display_name": "Farhad Farahi", "link": "https://stackoverflow.com/users/5867722/farhad-farahi"}, "reply_to_user": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "edited": false, "score": 0, "creation_date": 1532954467, "post_id": 51590329, "comment_id": 90154085, "body": "@FabioVenturiPastor I checked with provided example again (link in answer) it has a field named Age and is indeed an integer, and I can see it is indeed is set to 91 when converted into struct."}, {"owner": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "edited": false, "score": 0, "creation_date": 1532954647, "post_id": 51590329, "comment_id": 90154180, "body": "Yes I did the same but I give 0, I&#39;ll ask to SO if im missing something. Thank you."}, {"owner": {"reputation": 26372, "user_id": 5867722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VQ1v.jpg?s=128&g=1", "display_name": "Farhad Farahi", "link": "https://stackoverflow.com/users/5867722/farhad-farahi"}, "reply_to_user": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "edited": false, "score": 0, "creation_date": 1532954675, "post_id": 51590329, "comment_id": 90154201, "body": "@FabioVenturiPastor no problem mate."}], "tags": [], "owner": {"reputation": 26372, "user_id": 5867722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VQ1v.jpg?s=128&g=1", "display_name": "Farhad Farahi", "link": "https://stackoverflow.com/users/5867722/farhad-farahi"}, "is_accepted": true, "score": 1, "last_activity_date": 1532952813, "last_edit_date": 1532952813, "creation_date": 1532941157, "answer_id": 51590329, "question_id": 51589995, "link": "https://stackoverflow.com/questions/51589995/golang-facebook-response-to-struct/51590329#51590329", "title": "Golang Facebook response to struct", "body": "<p>Converting map to struct:</p>\n\n<pre><code>import \"github.com/mitchellh/mapstructure\"\n\nmapstructure.Decode(myMap, &amp;myStruct)\n</code></pre>\n\n<p><a href=\"https://godoc.org/github.com/mitchellh/mapstructure#example-Decode\" rel=\"nofollow noreferrer\">example</a></p>\n\n<p>But I would do this:</p>\n\n<pre><code>type Page struct {\n    ID                string   `json:\"id\"`\n    About             string   `json:\"about\"`\n    //other fields and nested structs like your metadata struct\n}\ntype fbPages map[string]Page\n</code></pre>\n"}], "owner": {"reputation": 2370, "user_id": 5453049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e2c00b88d6175b93b0360c8057a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Venturi Pastor", "link": "https://stackoverflow.com/users/5453049/fabio-venturi-pastor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 51590329, "answer_count": 1, "score": 0, "last_activity_date": 1532952813, "creation_date": 1532939862, "question_id": 51589995, "link": "https://stackoverflow.com/questions/51589995/golang-facebook-response-to-struct", "title": "Golang Facebook response to struct", "body": "<p>Hi there I'm new in GO and I'm trying to convert a json from the facebook api to struct.</p>\n\n<p>The problem is that the keys of the object are dinamic:</p>\n\n<pre><code>{\n  \"100555213756790\": {\n    \"id\": \"100555213756790\",\n    \"about\": \"Noodle Bar &amp; Restaurant\",\n    \"metadata\": {\n      \"fields\": [\n        {\n          \"name\": \"id\",\n          \"description\": \"asdasdasdasd\",\n          \"type\": \"numeric string\"\n        },\n        //...\n  ,\n  \"101285033290986\": {\n    \"id\": \"101285033290986\",\n    \"about\": \"Smart City Expo World Congress\",\n    \"metadata\": {\n      \"fields\": [\n        {\n          \"name\": \"id\",\n          \"description\": \"fgddgdfgdg\",\n          \"type\": \"numeric string\"\n        },\n</code></pre>\n\n<p>what I have achieved so far is extract the objects by id and turn them into a map:</p>\n\n<pre><code>for _, id := range ids {\n    fbPages, ok := results[string(id)].(map[string]interface{})\n    if ok {\n        for k, v := range fbPages {\n            fmt.Println(k)\n            fmt.Println(v)\n        }\n    }\n}\n\n//json to Page struct?\n    type Page struct {\n        ID                string   `json:\"id\"`\n        About             string   `json:\"about\"`\n    }\n\n    type Metadata struct {\n        Fields      []Field           `json:\"fields\"`\n        Type        string            `json:\"type\"`\n        Connections map[string]string `json:\"connections\"`\n    }\n\n    type Field struct {\n        Name        string  `json:\"name\"`\n        Description string  `json:\"description\"`\n        Type        *string `json:\"type,omitempty\"`\n    }\n</code></pre>\n\n<p>My question is: </p>\n\n<p>how can I convert that map to struct? or is there any easy way to do what I'm trying to do?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1532939890, "post_id": 51589712, "comment_id": 90145189, "body": "Make the path to your blacklist a command line flag or read it from an environment variable."}, {"owner": {"reputation": 123, "user_id": 3004217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fvpgo.jpg?s=128&g=1", "display_name": "angeldsWang", "link": "https://stackoverflow.com/users/3004217/angeldswang"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1532942738, "post_id": 51589712, "comment_id": 90146750, "body": "@Volker Yeah, command line flag or using ENV should be a workaround. Just wonder, is there a solution can fix it without changing anything out of box. Also, should loading conf by relative path in init function be regarded as a bad idea?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1532944030, "post_id": 51589712, "comment_id": 90147596, "body": "&quot;should loading conf by relative path in init function be regarded as a bad idea?&quot; Yes. Because it cannot work. relative paths are relative to the current working directory during execution and totally unrelated to your code layout."}, {"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1533157276, "post_id": 51589712, "comment_id": 90248847, "body": "What about running the tests using something like <code>SRC_ROOT=$PWD go test</code> and then use <code>os.Getenv(&quot;SRC_ROOT&quot;)</code> to get the path."}, {"owner": {"reputation": 123, "user_id": 3004217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fvpgo.jpg?s=128&g=1", "display_name": "angeldsWang", "link": "https://stackoverflow.com/users/3004217/angeldswang"}, "reply_to_user": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1533212050, "post_id": 51589712, "comment_id": 90270010, "body": "@MattiasWadman Yeah, that&#39;s exactly the best solution right now for me."}, {"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1533221669, "post_id": 51589712, "comment_id": 90276813, "body": "@angeldsWang Nice. That is what i do in a project, feels simpler and safer then messing around with go internals :)  I wrote it as a proper answer. Let me know if it needs some tweaking."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 3004217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fvpgo.jpg?s=128&g=1", "display_name": "angeldsWang", "link": "https://stackoverflow.com/users/3004217/angeldswang"}, "edited": false, "score": 1, "creation_date": 1533224093, "post_id": 51656661, "comment_id": 90278524, "body": "This should be an accepted answer for common cases. However, my case is, in a legacy project, the conf file has been loaded in the init function by using a relative path, that force me to use the Getenv for testing and leave the relative path for running code. Of course, I can refactor all things to using command line flags, but it costs too much for me. :("}], "tags": [], "owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1533239551, "last_edit_date": 1533239551, "creation_date": 1533221826, "answer_id": 51656661, "question_id": 51589712, "link": "https://stackoverflow.com/questions/51589712/use-relative-path-in-init-function-cannot-be-found-in-test/51656661#51656661", "title": "Use relative path in init function cannot be found in test", "body": "<p>A simple solution is to run tests using something like <code>SRC_ROOT=$PWD go test</code> and then inside the test that want to access files use <code>os.Getenv(\"SRC_ROOT\")</code>.</p>\n"}], "owner": {"reputation": 123, "user_id": 3004217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fvpgo.jpg?s=128&g=1", "display_name": "angeldsWang", "link": "https://stackoverflow.com/users/3004217/angeldswang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 51656661, "answer_count": 1, "score": 2, "last_activity_date": 1533239551, "creation_date": 1532938771, "question_id": 51589712, "link": "https://stackoverflow.com/questions/51589712/use-relative-path-in-init-function-cannot-be-found-in-test", "title": "Use relative path in init function cannot be found in test", "body": "<p>I'm running into an annoying problem when using relative path in the init function which cannot be found by the unit test. </p>\n\n<p>Say I have a project structured like:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 conf\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 blacklist\n\u251c\u2500\u2500 filter\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 filter.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 filter_test.go\n</code></pre>\n\n<p>And in the <code>init</code> function of <code>filter.go</code>, I try to load the blacklist by using relative path <code>conf/blacklist</code> to avoid loading it multiple times.\nSince the default working directory is exactly the project root directory, it works well with compiled binary. However <code>filter_test.go</code> will panic by\n<code>panic: open conf/blacklist: no such file or directory</code>, becasue go test always uses the package directory as the working directory.</p>\n\n<p>I also referred <a href=\"https://stackoverflow.com/a/28200371/3004217\">this solution</a>, which could dynamically build the relative path to find the config file. It did work well until I add the <code>covermode=set</code> flag and try to do some coverage testing. It seems that the <code>covermode</code> would rewrite and generate some middle packages like <code>_obj</code>, which makes the dynamical relative path not working any more.</p>\n\n<p>Has anyone run into the same problem before? I'm still new to golang for a couple of months. Any suggestions will be appreciated.</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 51, "user_id": 6709674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qoTjgJAzSgI/AAAAAAAAAAI/AAAAAAAAAHY/ymNR4iHgVgc/photo.jpg?sz=128", "display_name": "Andy Mok", "link": "https://stackoverflow.com/users/6709674/andy-mok"}, "edited": false, "score": 1, "creation_date": 1532933474, "post_id": 51588290, "comment_id": 90141960, "body": "I think you need to compile the protocol buffer definition, it will produce files with suffix <code>pb.go</code>"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 1542778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fc3444375d06a3f970671917ffdb42?s=128&d=identicon&r=PG", "display_name": "jesusnoseq", "link": "https://stackoverflow.com/users/1542778/jesusnoseq"}, "is_accepted": false, "score": 0, "last_activity_date": 1532973898, "creation_date": 1532973898, "answer_id": 51599847, "question_id": 51588290, "link": "https://stackoverflow.com/questions/51588290/send-protobuf-enum-message-to-a-grpc-server/51599847#51599847", "title": "Send protobuf enum message to a grpc server", "body": "<p>You define State but you do not have a State field in Foo.</p>\n\n<p>Try this</p>\n\n<pre><code>syntax=\"proto3\";\noption go_package =\"enumpb\";\nmessage Foo {\n  enum State {\n    STATE1 = 0;\n    STATE2 = 1;\n    STATE3 = 2;\n  }\n  State myState = 1;\n}\n</code></pre>\n\n<p>And this in go</p>\n\n<pre><code>enumExample := enumpb.Foo{\n    MyState: enumpb.Foo_STATE1,\n}\nfmt.Println(\"enumExample\", enumExample)\n</code></pre>\n"}], "owner": {"reputation": 976, "user_id": 2427672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc34b049a33674b91a2335d31db475b2?s=128&d=identicon&r=PG", "display_name": "Seph", "link": "https://stackoverflow.com/users/2427672/seph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3047, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532973898, "creation_date": 1532932824, "question_id": 51588290, "link": "https://stackoverflow.com/questions/51588290/send-protobuf-enum-message-to-a-grpc-server", "title": "Send protobuf enum message to a grpc server", "body": "<p>Given a</p>\n\n<pre><code>message Foo {\nenum State {\n    STATE1 = 0;\n    STATE2 = 1;\n    STATE3 = 2;\n}\n}\n</code></pre>\n\n<p>and a grpc service definition of</p>\n\n<pre><code>rpc Method(stream Foo) returns (Empty) {}\n</code></pre>\n\n<p>What does the go grpc client code to send this to a grpc server look like? To clarify, suppose I have a <code>streamClient.Send()</code>. What would I pass to <code>Send()</code>? How do I construct the enum?</p>\n"}, {"tags": ["json", "go", "struct", "types", "nested"], "comments": [{"owner": {"reputation": 5, "user_id": 1597746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de4bd06c2f0ad5ee355c27c2d192a89?s=128&d=identicon&r=PG", "display_name": "dobermaster", "link": "https://stackoverflow.com/users/1597746/dobermaster"}, "edited": false, "score": 0, "creation_date": 1532907261, "post_id": 51585362, "comment_id": 90136290, "body": "its should be like data.Data[&quot;randomName&quot;].val = 2"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1532910943, "post_id": 51585362, "comment_id": 90136846, "body": "That is not valid JSON.  Please revise your question to include valid JSON."}, {"owner": {"reputation": 5, "user_id": 1597746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de4bd06c2f0ad5ee355c27c2d192a89?s=128&d=identicon&r=PG", "display_name": "dobermaster", "link": "https://stackoverflow.com/users/1597746/dobermaster"}, "reply_to_user": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1532935313, "post_id": 51585362, "comment_id": 90142823, "body": "in this the problem, json shouldt be valid, and i need to parse it way it is"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1532955800, "post_id": 51585362, "comment_id": 90154916, "body": "You can&#39;t use a JSON parser to parse something that isn&#39;t JSON. If you can&#39;t get a hold of valid JSON, you&#39;ll have to find a way to turn it into valid JSON, or write your own parser."}, {"owner": {"reputation": 5, "user_id": 1597746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de4bd06c2f0ad5ee355c27c2d192a89?s=128&d=identicon&r=PG", "display_name": "dobermaster", "link": "https://stackoverflow.com/users/1597746/dobermaster"}, "edited": false, "score": 0, "creation_date": 1532957827, "post_id": 51585362, "comment_id": 90156253, "body": "okay, thanks, just thought there in golang were some things to parse invalid json"}], "answers": [{"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 1, "last_activity_date": 1532911458, "last_edit_date": 1532911458, "creation_date": 1532909993, "answer_id": 51585612, "question_id": 51585362, "link": "https://stackoverflow.com/questions/51585362/nested-json-golang-maps/51585612#51585612", "title": "Nested JSON golang maps", "body": "<p>Is that really representative of your data?  It's not valid JSON.  See description at <a href=\"http://json.org/\" rel=\"nofollow noreferrer\">json.org</a>.  In particular you need quotes around the strings, and commas should not be present after the last member of an object or array.  It's odd that <code>\"true\"</code> is a string instead of a boolean.  Since this clearly isn't a copy/paste of your data, are you sure you got the square brackets and curly braces right?  Those are important to the answer.</p>\n\n<p>Assuming you did get those right... From these lines:</p>\n\n<pre><code>data: [\n         { \n          randomName: {\n</code></pre>\n\n<p>We can tell that <code>data</code> is an array of objects.  If you meant the square braces, it's an error that the array is not represented in your data model.  Alter your data model to include a slice to capture the JSON array:</p>\n\n<pre><code>type TheData struct {\n    Result string                `json:\"result\"`\n    Data   []map[string]DataInfo `json:\"data\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 1597746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de4bd06c2f0ad5ee355c27c2d192a89?s=128&d=identicon&r=PG", "display_name": "dobermaster", "link": "https://stackoverflow.com/users/1597746/dobermaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1532911458, "creation_date": 1532906932, "last_edit_date": 1532910637, "question_id": 51585362, "link": "https://stackoverflow.com/questions/51585362/nested-json-golang-maps", "title": "Nested JSON golang maps", "body": "<p>I can't find the same problem like mine.</p>\n\n<p>I have the following JSON:</p>\n\n<pre><code>{\n    result: \"true\",\n        data: [\n         { \n          randomName: {\n                 val: 2,\n                 secval: 0.142412,\n                 thirdval: 0.5235325,\n          },\n          secRandomName: {\n                 val: 8,\n                 secval: 0.152512,\n                 thirdval: 0.6574,\n          },\n          thiRandomName: {\n                 val: 6,\n                 secval: 0.4121,\n                 thirdval: 0.2123\n          },\n        }\n    ]\n}`\n</code></pre>\n\n<p>How to make a type that works with the JSON sample in golang, I've tried something like this:</p>\n\n<pre><code>type TheData struct {\nResult  string              `json:\"result\"`\nData    map[string]DataInfo `json:\"data\"`\n}\n\ntype DataInfo struct {\nValue           int         `json:\"val\"`\nSecondValue     float32     `json:\"secval\"`\nThirdValue      float32     `json:\"thirdval\"`\n}\n</code></pre>\n\n<p>but it is wrong.</p>\n\n<p>P.S. Sorry for my English, I hope you understand. Thanks.</p>\n"}, {"tags": ["go", "package", "goimports"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532897461, "post_id": 51584370, "comment_id": 90134320, "body": "You have 2 parts in your GOPATH, what is \u201cWorkspace\u201d? Also don\u2019t set GOROOT."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532898390, "post_id": 51584370, "comment_id": 90134575, "body": "Also, if \u201capplication/utility\u201d is a proper package, you should be able to run <code>go build application&#47;utility</code> without error, or it may provide some information about the problem with your configuration."}, {"owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532899113, "post_id": 51584370, "comment_id": 90134774, "body": "@JimB It builds without a message or error"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532902991, "post_id": 51584370, "comment_id": 90135622, "body": "@JimB: From the context, the <code>GOROOT</code> value in the question looks like part of the output from <code>go env</code>. If GOROOT is not set (I don&#39;t set it), the Go tool chain sets it to the implicit GOROOT for the <code>go</code> command. I have <code>$ echo $GOROOT\\n\\n</code> and <code>$ go env GOROOT\\n&#47;home&#47;peter&#47;go\\n</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532910142, "post_id": 51584370, "comment_id": 90136725, "body": "@Whiteclaws: then you need to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, since it should work if everything is configured in a standard manner."}, {"owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 1, "creation_date": 1532935355, "post_id": 51584370, "comment_id": 90142851, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13214029/go-build-cannot-find-package-even-though-gopath-is-set\">Go build: &quot;Cannot find package&quot; (even though GOPATH is set)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "edited": false, "score": 0, "creation_date": 1532970420, "post_id": 51585555, "comment_id": 90163981, "body": "I reproduced your example with a simple application: <a href=\"https://pastebin.com/NagedTLK\" rel=\"nofollow noreferrer\">pastebin.com/NagedTLK</a>"}, {"owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "edited": false, "score": 0, "creation_date": 1532970654, "post_id": 51585555, "comment_id": 90164100, "body": "Oh, and also, calling go install application/utility does give me a package"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "edited": false, "score": 0, "creation_date": 1532972661, "post_id": 51585555, "comment_id": 90165111, "body": "Your pastebin output stopped before the <code>goimports -w main.go</code> and <code>cat main.go</code> steps."}, {"owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "edited": false, "score": 0, "creation_date": 1532977191, "post_id": 51585555, "comment_id": 90167309, "body": "goimports main.go is the equivalent of goimports -w main.go and cat main.go without changing main.go, in other words, goimports -w main.go would also print the same thing... but yeah, goimports -w main.go doesn&#39;t import &quot;application/utility&quot;"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1532954659, "last_edit_date": 1532954659, "creation_date": 1532909322, "answer_id": 51585555, "question_id": 51584370, "link": "https://stackoverflow.com/questions/51584370/local-packages-are-not-detected-by-goimports/51585555#51585555", "title": "Local packages are not detected by goimports", "body": "<p>You haven't provided us with specific steps to reproduce your problem. I don't see a problem. <code>goimports -w main.go</code> works. For example,</p>\n\n<p><code>application/main.go</code> before <code>goimports -w main.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(utility.PiE())\n}\n</code></pre>\n\n<p><code>application/utility/math.go</code>:</p>\n\n<pre><code>package utility\n\nimport \"math\"\n\nfunc PiE() float64 { return math.Pi * math.E }\n</code></pre>\n\n<p>Commands:</p>\n\n<pre><code>#\ncd $HOME\ncd $HOME/Desktop/Workspace\nrm -f src/application/application\ncp src/application/main.bak src/application/main.go\ntree\ncd $HOME/Desktop/Workspace/src/\ncat application/utility/math.go\ncd application\nexport GOPATH=$HOME/gopath:$HOME/Desktop/Workspace\ngo env GOPATH\ncat main.go\ngo build -a\ngoimports -w main.go\ncat main.go\ngo build -a &amp;&amp; ./application\n#\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>~$ #\n~$ cd $HOME\n~$ cd $HOME/Desktop/Workspace\n~/Desktop/Workspace$ rm -f src/application/application\n~/Desktop/Workspace$ cp src/application/main.bak src/application/main.go\n~/Desktop/Workspace$ tree\n.\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 application\n        \u251c\u2500\u2500 main.bak\n        \u251c\u2500\u2500 main.go\n        \u2514\u2500\u2500 utility\n            \u2514\u2500\u2500 math.go\n\n3 directories, 3 files\n~/Desktop/Workspace$ cd $HOME/Desktop/Workspace/src/\n~/Desktop/Workspace/src$ cat application/utility/math.go\npackage utility\n\nimport \"math\"\n\nfunc PiE() float64 { return math.Pi * math.E }\n~/Desktop/Workspace/src$ cd application\n~/Desktop/Workspace/src/application$ export GOPATH=$HOME/gopath:$HOME/Desktop/Workspace\n~/Desktop/Workspace/src/application$ go env GOPATH\n/home/peter/gopath:/home/peter/Desktop/Workspace\n~/Desktop/Workspace/src/application$ cat main.go\npackage main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(utility.PiE())\n}\n~/Desktop/Workspace/src/application$ go build -a\n# application\n./main.go:8:14: undefined: utility\n~/Desktop/Workspace/src/application$ goimports -w main.go\n~/Desktop/Workspace/src/application$ cat main.go\npackage main\n\nimport (\n    \"application/utility\"\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(utility.PiE())\n}\n~/Desktop/Workspace/src/application$ go build -a &amp;&amp; ./application\n8.539734222673568\n~/Desktop/Workspace/src/application$ #\n</code></pre>\n\n<p><code>application/main.go</code> after <code>goimports -w main.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"application/utility\"\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(utility.PiE())\n}\n</code></pre>\n"}], "owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1333, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1532954659, "creation_date": 1532896719, "question_id": 51584370, "link": "https://stackoverflow.com/questions/51584370/local-packages-are-not-detected-by-goimports", "title": "Local packages are not detected by goimports", "body": "<p>I have a few packages in separate folders for my golang project that is getting a bit big. I've been trying to create separate packages but don't get detected by goimports</p>\n\n<pre><code>GOPATH=\"/home/malek/go:/home/malek/Desktop/Workspace\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\n</code></pre>\n\n<p>My directory is as such,</p>\n\n<pre><code>Workspace -&gt; src -&gt; application -&gt; utility -&gt; math.go\n</code></pre>\n\n<p>and in my math.go folder, I have package utility</p>\n\n<p>But when I try to do <code>import \"application/utility\"</code> or when i try to include a public function from the math.go file in my main.go file (in application folder), I get undefined...</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1532894949, "post_id": 51584031, "comment_id": 90133609, "body": "String pointers are always the same size--the size of a pointer."}], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 2, "last_activity_date": 1532894448, "creation_date": 1532894448, "answer_id": 51584083, "question_id": 51584031, "link": "https://stackoverflow.com/questions/51584031/checking-length-of-a-string-pointer-in-go/51584083#51584083", "title": "Checking length of a string pointer in Go", "body": "<p>you can access an object with a star before pointer variable name for eg <code>len(*r.myString)</code></p>\n\n<p><a href=\"https://play.golang.org/p/lLwKtOh7NCz\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}, {"tags": [], "owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "is_accepted": false, "score": 3, "last_activity_date": 1532894496, "creation_date": 1532894496, "answer_id": 51584088, "question_id": 51584031, "link": "https://stackoverflow.com/questions/51584031/checking-length-of-a-string-pointer-in-go/51584088#51584088", "title": "Checking length of a string pointer in Go", "body": "<p>You should explain why your code is not correct, and which error message you get. If it is a pointer to a string, you should dereference it by asterix *</p>\n\n<pre><code>len(*r.myString)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10152158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7eb57ddaee813bb04fe900f8f8f5d9?s=128&d=identicon&r=PG&f=1", "display_name": "jkfff", "link": "https://stackoverflow.com/users/10152158/jkfff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1532894496, "creation_date": 1532894099, "question_id": 51584031, "link": "https://stackoverflow.com/questions/51584031/checking-length-of-a-string-pointer-in-go", "title": "Checking length of a string pointer in Go", "body": "<p>How do I go about finding the length of a string pointer which comes from a struct. Currently I am writing unit tests and want to see whether a string pointer is less than 250 characters. If r is my and myString is a string pointer.</p>\n\n<p>This code is not valid:</p>\n\n<pre><code>if len(r.myString) &gt; 256 {\n    return ErrStringTooLong\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "kubernetes", "http2"], "comments": [{"owner": {"reputation": 791, "user_id": 837620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6adce64e71f76c5135bdaae1646d86f?s=128&d=identicon&r=PG&f=1", "display_name": "Vilva", "link": "https://stackoverflow.com/users/837620/vilva"}, "edited": false, "score": 0, "creation_date": 1532891073, "post_id": 51583437, "comment_id": 90132522, "body": "are you using any ingress controller in your kubernetes ?"}], "answers": [{"comments": [{"owner": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "edited": false, "score": 3, "creation_date": 1532931361, "post_id": 51583717, "comment_id": 90141030, "body": "There are plenty of benefits to having the front end only (<a href=\"https://stackoverflow.com/questions/41637076/http2-with-node-js-behind-nginx-proxy\" title=\"http2 with node js behind nginx proxy\">stackoverflow.com/questions/41637076/&hellip;</a>). HTTP/2 also does not improve the SSL negotiation other than to not require it for additional streams. QUIC which is currently being worked on is a further improvement which does improve this but not available yet."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "reply_to_user": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "edited": false, "score": 0, "creation_date": 1532931506, "post_id": 51583717, "comment_id": 90141080, "body": "@BarryPollard - links for HTTP2 on AWS services that show my answer is wrong. I will happily update my answer."}, {"owner": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "edited": false, "score": 0, "creation_date": 1532931594, "post_id": 51583717, "comment_id": 90141119, "body": "Links that prove your answer please. It is incorrect in a couple of places."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "reply_to_user": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "edited": false, "score": 0, "creation_date": 1532931665, "post_id": 51583717, "comment_id": 90141158, "body": "@BarryPollard - Please post your own answer to better help the community."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "reply_to_user": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "edited": false, "score": 1, "creation_date": 1532931979, "post_id": 51583717, "comment_id": 90141309, "body": "@BarryPollard - You just sold one of your books. I will read it. For the sake of argument, please comment on exactly what I have wrong. I know HTTP2 very well also."}, {"owner": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "edited": false, "score": 0, "creation_date": 1532933573, "post_id": 51583717, "comment_id": 90142007, "body": "Thanks. Added my answer below. The two points I raised in my original comment are the things I think are wrong. Plenty of good info in your answer but those two are wrong IMHO. Most benefits of HTTP/2 are over high latency client to LB connection not over internal LB -&gt; server connections so I think still worth HTTP/2 on load balancer only. And it doesn\u2019t change round trip for SSL on initial connection (though the fact it uses one connection does save round trips on subsequent connections if that is what you meant?)."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "reply_to_user": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "edited": false, "score": 1, "creation_date": 1532933838, "post_id": 51583717, "comment_id": 90142125, "body": "@BarryPollard - Both of us could write answers that are so technical that few will read them. The key is not the theory but what happens in the real world. I read your answer in detail. I still don&#39;t see an error in my answer. However, I am enjoying your significant number of posts on HTTP2. I will defer to you as the resident expert. +1 vote from me."}, {"owner": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1532938799, "post_id": 51583717, "comment_id": 90144688, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/176999/discussion-between-barry-pollard-and-john-hanley\">continue this discussion in chat</a>."}, {"owner": {"reputation": 5428, "user_id": 51055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ded38f00c715123b3a5312dfa892de?s=128&d=identicon&r=PG", "display_name": "hemp", "link": "https://stackoverflow.com/users/51055/hemp"}, "edited": false, "score": 0, "creation_date": 1592336531, "post_id": 51583717, "comment_id": 110388571, "body": "Amazon directly addressed this question in their <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\" rel=\"nofollow noreferrer\">docs</a>: &quot;Application Load Balancers provide native support for HTTP/2 with HTTPS listeners. You can send up to 128 requests in parallel using one HTTP/2 connection. The load balancer converts these to individual HTTP/1.1 requests and distributes them across the healthy targets in the target group. Because HTTP/2 uses front-end connections more efficiently, you might notice fewer connections between clients and the load balancer.&quot;"}, {"owner": {"reputation": 5428, "user_id": 51055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ded38f00c715123b3a5312dfa892de?s=128&d=identicon&r=PG", "display_name": "hemp", "link": "https://stackoverflow.com/users/51055/hemp"}, "edited": false, "score": 0, "creation_date": 1592336814, "post_id": 51583717, "comment_id": 110388693, "body": "The use of &quot;might&quot; in AWS docs suggests they believe the benefits are negligible. Nonetheless, sophisticated users will want to see that pleasing &quot;h2&quot; in their browser&#39;s network tab and not seeing it may raise (unfounded) doubts about the site&#39;s administration."}], "tags": [], "owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "is_accepted": true, "score": 1, "last_activity_date": 1532891768, "creation_date": 1532891768, "answer_id": 51583717, "question_id": 51583437, "link": "https://stackoverflow.com/questions/51583437/deploying-an-http-2-web-server-with-kubernetes-on-aws/51583717#51583717", "title": "Deploying an HTTP/2 web-server with Kubernetes on AWS", "body": "<p>There is no benefit to deploying HTTP2 on an AWS load balancer if your backend is not HTTP2 also. Technically HTTP2 does not require HTTPS, but nobody implements HTTP2 for HTTP. HTTP2 is a protocol optimization (simple viewpoint) that removes round trips in the SSL negotiation, improves pipelining, etc. If the load balancer is communicating with your backend via HTTP, there will not be any improvement. The load balancer will see a small decrease in load due to reduced round trips during HTTPS setup.</p>\n\n<p>I recommend that you configure your backend services to only use HTTPS (redirect clients to HTTPS) and use an SSL certificate. Then configure HTTP2, which is not easy by the way. You can use Let's Encrypt for SSL which works very well. You can also use OpenSSL self-signed certificates (which I don't recommend). You cannot use AWS services to create SSL certificates for your backend services, only for AWS managed services (CloudFront, ALB, etc.).</p>\n\n<p>You can also setup the load balancer with Layer 4 (TCP) listeners. This is what I do when I setup HTTP2 on my backend servers. Now the entire path from client to backend is using HTTP2 without double SSL encryption / decryption layers. </p>\n\n<p>One of the nice features of load balancers is called \"SSL offloading\". This means that you enable SSL on the load balancer and only enable HTTP on your backend web servers. This goes against HTTP2. Therefore think thru what you really want to accomplish and then design your services to meet those objectives.</p>\n\n<p>Another point to consider. Since you are looking into HTTP2, at the same time remove support in your services for the older TLS versions and unsafe encryption and hashing algorithms. Dropping TLS 1.0 should be mandatory today and I recommend dropping TLS 1.1 also. Unless you really need to support ancient browsers or custom low-end hardware, TLS 1.2 should be the standard today. Your logfiles can tell you if clients are connecting via older protocols.</p>\n"}, {"comments": [{"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1532937998, "post_id": 51588361, "comment_id": 90144284, "body": "Barry, I find you answer interesting. Instead of clearly disputing my answer, you interject forward facing technologies such as QUIC which does not exist yet in AWS. You also discuss problems (limitations) with AWS that agrees with my answer, you just used different wording - yet you find my answer wrong. Your counter answer is also flawed. Here is my proposal, let&#39;s create a new question that you and I can debate under. The topic will be HTTP/2 on AWS. No technical theory about HTTP/2 tomorrow, just how AWS implements HTTP/2 in the real world today."}, {"owner": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1532938729, "post_id": 51588361, "comment_id": 90144654, "body": "My answer WASN&#39;T given to dispute your answer, but to answer the question, and also provide extra information which I thought might be interesting and relevant (much like the last part of your answer). My comment on your answer WAS to dispute 2 specific parts of your answer which I think were incorrect. Maybe they are &quot;correct&quot; in terms of what is supported on AWS at this time and if you update your answer to reflect this, then I&#39;ll happily withdraw my reservations and delete my comments as I do not think it is clear now. If you have flaws in my answer then do let me know so I can correct."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1532938847, "post_id": 51588361, "comment_id": 90144705, "body": "Agreed. I will comment further tomorrow."}], "tags": [], "owner": {"reputation": 30128, "user_id": 2144578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6sbqF.png?s=128&g=1", "display_name": "Barry Pollard", "link": "https://stackoverflow.com/users/2144578/barry-pollard"}, "is_accepted": false, "score": 2, "last_activity_date": 1532933216, "creation_date": 1532933216, "answer_id": 51588361, "question_id": 51583437, "link": "https://stackoverflow.com/questions/51583437/deploying-an-http-2-web-server-with-kubernetes-on-aws/51588361#51588361", "title": "Deploying an HTTP/2 web-server with Kubernetes on AWS", "body": "<p>The new ELB supports HTTP/2 (<a href=\"https://aws.amazon.com/blogs/aws/new-aws-application-load-balancer/\" rel=\"nofollow noreferrer\">https://aws.amazon.com/blogs/aws/new-aws-application-load-balancer/</a>) but not the Push attribute (<a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html#listener-configuration\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html#listener-configuration</a>): \u201cYou can't use the server-push feature of HTTP/2\u201d</p>\n\n<p>If you want to use Push you can use the ELB as a level four TCP LoadBalancer and enable this at your webserver. For HaProxy it is also possible to still offset SSL/TLS with this set up (<a href=\"https://stackoverflow.com/questions/38730281/http-2-behind-reverse-proxy\">HTTP/2 behind reverse proxy</a>) but not sure if similar is possible under ELB (probably not). This is because while HTTP/2 requires HTTPS from all the major browsers it is not a requirement of the protocol itself so load balancer -> server can be over HTTP/2 without HTTPS (called h2c).</p>\n\n<p>However I would say that HTTP/2 Push is very complicated to get right - read this excellent post by Jake Archibald of Google on this: <a href=\"https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/\" rel=\"nofollow noreferrer\">https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/</a>. It\u2019s generally been found to benefit in a few cases and cause no change in most and even cause degradation in performance in others. Ultimately it\u2019s a bit of a let down in HTTP/2 features, though personally I don\u2019t think it\u2019s been explored enough so may be some positives to come out of it yet.</p>\n\n<p>So if you don\u2019t want Push then is there still a point in upgrading to HTTP/2 on the front end? Yes in my opinion as detailed in my answer here: <a href=\"https://stackoverflow.com/questions/41637076/http2-with-node-js-behind-nginx-proxy\">HTTP2 with node.js behind nginx proxy</a>. This also shows that there is no real need to have HTTP/2 on the backend from LB to webserver meaning you could leave it as a HTTPS offloading loaf balancer.</p>\n\n<p>It should be noted that there are some use cases where HTTP/2 is slower:</p>\n\n<ol>\n<li>Under heavy packet loss (i.e. a very bad Internet connection). Here the single TCP connection used by HTTP/2 and it\u2019s TCP Head of Line Blocking means the connection suffers more than 6 individual HTTP/1 connections. QUIC which is a even newer protocol then HTTP/2 (so new it\u2019s not even out yet, so not really available except on Google servers) addresses this.</li>\n<li>For large packets due to AWS\u2019s specific implementation. Interesting post here on that: <a href=\"https://medium.com/@ptforsberg/on-the-aws-application-load-balancer-http-2-support-fad4bc67b21a\" rel=\"nofollow noreferrer\">https://medium.com/@ptforsberg/on-the-aws-application-load-balancer-http-2-support-fad4bc67b21a</a>. This is only really an issue for truely large downloads most likely for APIs and shouldn\u2019t be an issue for most websites (and if it is then you should optimise your website cause HTTP/2 won\u2019t be able to help much anyway!). Could be easily fixed by upgrading the HTTP/2 window size setting but looks like ELB does not allow you to set this.</li>\n</ol>\n"}], "owner": {"reputation": 329, "user_id": 8053307, "user_type": "registered", "profile_image": "https://graph.facebook.com/306305043125716/picture?type=large", "display_name": "dfek", "link": "https://stackoverflow.com/users/8053307/dfek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1708, "favorite_count": 1, "accepted_answer_id": 51583717, "answer_count": 2, "score": 1, "last_activity_date": 1532933216, "creation_date": 1532889846, "question_id": 51583437, "link": "https://stackoverflow.com/questions/51583437/deploying-an-http-2-web-server-with-kubernetes-on-aws", "title": "Deploying an HTTP/2 web-server with Kubernetes on AWS", "body": "<p>I have a Go server that is currently running with Kubernetes on AWS. The website sits under a route-53 and an ELB that manages the SSL termination.\nNow, I want to support HTTP/2 in my web-server in order to push resources to the clients, and I saw that HTTP/2 requires that the web-server will use HTTPS. I have a few questions according to that.</p>\n\n<ul>\n<li><p>HTTP/2 requires HTTPS - In my case the HTTPS logic is in the ELB and it manages for me the SSL termination. My application gets the decrypted data as a simple HTTP request. Do I need to remove the ELB in order to enable HTTP/2 in my web-server?\nIs there any way to leave the ELB there and enable HTTP/2 in my web-server? </p></li>\n<li><p>In my local development I use openssl to generate certificate. If I deploy the web-server I need to get the CA certificate from AWS and store it somewhere in the Kubernetes certificate-manager and inject to my web-server in the initialization. What is the recommended way to do this? </p></li>\n</ul>\n\n<p>I feel like I miss something, so I'll appreciate any help. Thanks</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1532895252, "post_id": 51583149, "comment_id": 90133698, "body": "AFAIK, Go&#39;s compiler eliminates dead code. So your mock types, if they are used only in tests, may already be excluded from the final binary. Also, possible duplicate <a href=\"https://stackoverflow.com/a/42827979/965900\">stackoverflow.com/a/42827979/965900</a>"}, {"owner": {"reputation": 5482, "user_id": 715978, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4cfaab6e2dcef0e7f3060ad9d3e9be77?s=128&d=identicon&r=PG", "display_name": "bloudraak", "link": "https://stackoverflow.com/users/715978/bloudraak"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1532959898, "post_id": 51583149, "comment_id": 90157688, "body": "That is a fair point. I&#39;m wasting time compiling it, but for the size of my project isn&#39;t too much. I guess it will be an issue when your application becomes rather large (e.g. 100,000s of lines of code)."}], "answers": [{"comments": [{"owner": {"reputation": 5482, "user_id": 715978, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4cfaab6e2dcef0e7f3060ad9d3e9be77?s=128&d=identicon&r=PG", "display_name": "bloudraak", "link": "https://stackoverflow.com/users/715978/bloudraak"}, "edited": false, "score": 0, "creation_date": 1532960011, "post_id": 51583612, "comment_id": 90157768, "body": "I looked at build constraints, but couldn&#39;t find documentation or examples that actually worked within this scenario.  Any suggestions on what to explore?"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "reply_to_user": {"reputation": 5482, "user_id": 715978, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4cfaab6e2dcef0e7f3060ad9d3e9be77?s=128&d=identicon&r=PG", "display_name": "bloudraak", "link": "https://stackoverflow.com/users/715978/bloudraak"}, "edited": false, "score": 0, "creation_date": 1532961067, "post_id": 51583612, "comment_id": 90158491, "body": "Sorry my only experience with them is for partitioning up a test suite and only executing tests with certain tags, ie unit, integration, service. Soundcloud illustrates how to do this here: <a href=\"http://peter.bourgon.org/go-in-production/#testing-and-validation\" rel=\"nofollow noreferrer\">peter.bourgon.org/go-in-production/#testing-and-validation</a>"}], "tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 2, "last_activity_date": 1532891100, "creation_date": 1532891100, "answer_id": 51583612, "question_id": 51583149, "link": "https://stackoverflow.com/questions/51583149/how-does-one-exclude-mock-or-stub-structs-from-being-built-in-go/51583612#51583612", "title": "How does one exclude Mock or Stub structs from being built in Go", "body": "<p>One way could be to use <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">Build Constraints</a>.</p>\n\n<p>Go even supports a built in <code>ignore</code> tag, but I'm not really sure of its interaction with the testing/benchmark toolchain:</p>\n\n<blockquote>\n  <p>To keep a file from being considered for the build:</p>\n  \n  <p>// +build ignore</p>\n</blockquote>\n"}], "owner": {"reputation": 5482, "user_id": 715978, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4cfaab6e2dcef0e7f3060ad9d3e9be77?s=128&d=identicon&r=PG", "display_name": "bloudraak", "link": "https://stackoverflow.com/users/715978/bloudraak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532891100, "creation_date": 1532887652, "question_id": 51583149, "link": "https://stackoverflow.com/questions/51583149/how-does-one-exclude-mock-or-stub-structs-from-being-built-in-go", "title": "How does one exclude Mock or Stub structs from being built in Go", "body": "<p>Assume for a moment I have a Go package with numerous interfaces. For this example, I'd focus on one called <code>Middleware</code> defined in <code>middleware.go</code>:</p>\n\n<pre><code>type Middleware interface {\n  // some functions\n}  \n</code></pre>\n\n<p>I have some other parts of the system that uses it, so to better help test those parts of the system, I created a mock implementation by hand in <code>mock_middleware.go</code>:</p>\n\n<pre><code>type MockMiddleware struct {\n\n}  \n\n// implementations\n</code></pre>\n\n<p>When building the binary without tests, how do I exclude the mock classes from being built into the binary? I'm aware that <code>middleware_test.go</code> will be excluded, but I'd don't want to name all my mocks with that convention so as not to confuse actual tests with implementations to support testing.  </p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1532887663, "post_id": 51583068, "comment_id": 90131610, "body": "I dont see launch command, how you run your program?"}], "answers": [{"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 2, "last_activity_date": 1532889471, "creation_date": 1532889471, "answer_id": 51583385, "question_id": 51583068, "link": "https://stackoverflow.com/questions/51583068/deploying-golang-app-on-docker-exits-process/51583385#51583385", "title": "Deploying Golang app on Docker exits process", "body": "<p>From your <code>docker ps</code> output, your image is configured to only run a shell.  Since you ran it as a background process without any input, it processed all of its input and exited successfully (status code 0).  <code>docker logs 6adc34244350</code> will show you what output (if any) it produced.</p>\n\n<p>Docker has an excellent <a href=\"https://docs.docker.com/get-started/part2/\" rel=\"nofollow noreferrer\">tutorial on writing and running custom images</a> that's worth reading.  In particular, you shouldn't copy the official <code>golang</code> Dockerfile; your own Dockerfile can start with <code>FROM golang:1.10</code> and it will inherit everything in that image.  You also almost certainly want to make sure you have a <code>CMD</code> command that runs your application (by default) when the container starts up.</p>\n"}], "owner": {"reputation": 349, "user_id": 8983881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75333e6361cc0bb9b31999e3d47277d6?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyTheMouse", "link": "https://stackoverflow.com/users/8983881/mickeythemouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532889471, "creation_date": 1532886975, "question_id": 51583068, "link": "https://stackoverflow.com/questions/51583068/deploying-golang-app-on-docker-exits-process", "title": "Deploying Golang app on Docker exits process", "body": "<p>I'm very new to Docker. I have a Golang app that has the following structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 404.html\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 index.html\n\u251c\u2500\u2500 scripts\n\u251c\u2500\u2500 server.go\n\u251c\u2500\u2500 static\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 jquery.min.js\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 main.css\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.js\n\u2514\u2500\u2500 styles\n</code></pre>\n\n<p>I got the Dockerfile from DockerHub. It's too large to post here, but the <a href=\"https://github.com/docker-library/golang/blob/fa0223eaa427188e0c70025f557d515129a9973f/1.10/alpine3.7/Dockerfile\" rel=\"nofollow noreferrer\">full version is here</a>. The last few lines of the Dockerfile, which I think might be relevant, are:</p>\n\n<pre><code>ENV GOPATH /go\nENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH\n\nRUN mkdir -p \"$GOPATH/src\" \"$GOPATH/bin\" &amp;&amp; chmod -R 777 \"$GOPATH\"\nWORKDIR $GOPATH\n</code></pre>\n\n<p>When I go into my directory and type in <code>docker build -t my-app .</code> then it successfully builds. When I type in <code>docker run -d -p 80:80 url-shortener</code>, it gives me a string which I assume is the ID.</p>\n\n<p>But when I do <code>docker ps</code>, it doesn't show the process running.\nIf I do <code>docker ps -a</code>, it shows the process but it says,</p>\n\n<pre><code>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                     PORTS               NAMES\n6adc34244350        my-app       \"/bin/sh\"           6 minutes ago \nExited (0) 6 minutes ago\n</code></pre>\n\n<p>I apologize if this is a very dumb question. I'm a complete Docker noob and could use some guidance.</p>\n"}, {"tags": ["arrays", "go", "memory", "slice"], "comments": [{"owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 0, "creation_date": 1532886295, "post_id": 51582848, "comment_id": 90131208, "body": "I don&#39;t see your point. There is no guarantee. There can be nil pointers in a slice. Or is that not what you ask? It seems that you lost some where  a word in your question which caused the question to be grammatically in more ways interpretable."}, {"owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "reply_to_user": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 0, "creation_date": 1532887106, "post_id": 51582848, "comment_id": 90131459, "body": "@BertVerhees, nil pointer is valid pointer (assuming such value is stored, and array stores pointers -- I am asking about pointers of the elements, not the pointer elements). Please see my update."}, {"owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 0, "creation_date": 1532887357, "post_id": 51582848, "comment_id": 90131524, "body": "The elaborate on your question, please show me some code how to create an invalid pointer in Go. Maybe then I understand what you are asking, or maybe your question is then solved by yourself."}, {"owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "reply_to_user": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 0, "creation_date": 1532888654, "post_id": 51582848, "comment_id": 90131884, "body": "@BertVerhees, I cannot and that is why I am asking how Go does it. Because there has to be some underlying mechanism which &quot;corrects&quot; the lifetimes of the data (see the snippet I posted -- <code>ptr</code> outlives <code>array</code> yet the pointer in Go is valid). Please also note, it does not work with <code>map</code> exactly for the reason I mention -- that pointer could outlive the data stored in <code>map</code> thus <code>map</code> indexer returns value not a variable."}, {"owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 0, "creation_date": 1532889735, "post_id": 51582848, "comment_id": 90132150, "body": "Sorry, I cannot help you, I do not have much knowledge about how garbage control works in go. Check here, I think it is a good starting point: <a href=\"https://blog.golang.org/ismmkeynote\" rel=\"nofollow noreferrer\">blog.golang.org/ismmkeynote</a> . It is written by Richard L. Hudson, he  is currently a member of Google&#39;s Go team where he is working on Go&#39;s garbage collection and runtime issues."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1532935680, "post_id": 51582848, "comment_id": 90143004, "body": "a) What makes you think any of your variables are allocated on the stack? b) Even if the slice is garbage collected that does not imply that the underlying array is garbage collected as well. There can be any number of slices referencing the same array, and if you keep a reference to an array element it is by definition not garbage."}, {"owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1533049230, "post_id": 51582848, "comment_id": 90198278, "body": "@Peter, because compiler sees only the body of current function, not the body of used methods (here indexer), of course it might be the case that calling a method which returns variable causes using heap instead of stack, I don&#39;t know (thus I am asking), a.d) this I understand, but indexer in this case returns variable not entire slice (?) so is the same mechanism used for single elements as well -- i.e. using address of acquired variable prevents GC from reclaiming slice/array?"}], "answers": [{"comments": [{"owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "edited": false, "score": 1, "creation_date": 1532892574, "post_id": 51583651, "comment_id": 90132926, "body": "Thank you, but stack is not reclaimed by GC, it is just unwinded. So does Go perform some selective unwind? And when the memory is allocated on heap you get the pointer of it -- so Go does not only use it but also additional pointers used for referencing addresses within the allocated memory, correct?"}, {"owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 0, "creation_date": 1532893907, "post_id": 51583651, "comment_id": 90133327, "body": "peterSO, the question is how does GC guarantee that, you do not answer that at all, you just give some links where maybe somewhere this is explained or is explained how it was done in the past. One link points to a book from 2012. Do you suggest we should buy and read that? Can you explain why? And the other link was already accompanied by context in my comment at the question."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1532956112, "post_id": 51583651, "comment_id": 90155111, "body": "The Go compiler performs a step called &quot;escape analysis&quot; - if a variable or reference escapes the current function, it will be stored on the heap instead of the stack. There is no selective unwind of the stack because anything that escapes the current context isn&#39;t put on the stack, it&#39;s put on the heap."}, {"owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1533049010, "post_id": 51583651, "comment_id": 90198136, "body": "@Adrian, thank you, as escape analysis goes it should assume the body of the indexer is known. As for the heap version, does Go connect pointer to element with pointer to entire array/slice in order to prevent GC from reclaiming entire array/slice?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1533049386, "post_id": 51583651, "comment_id": 90198362, "body": "No. When you take a pointer to an element of an array/slice, you have a pointer to that value, not a pointer to an index in the array. If the array/slice has no other references, it should be collected."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1532891355, "creation_date": 1532891355, "answer_id": 51583651, "question_id": 51582848, "link": "https://stackoverflow.com/questions/51582848/how-does-go-guarantee-element-pointers-are-valid-for-arrays-and-slices/51583651#51583651", "title": "How does Go guarantee element pointers are valid for arrays and slices?", "body": "<p>The Go compiler and the Go garbage collector guarantee that memory is not freed until it is no longer used.</p>\n\n<p>To learn the basics of garbage collection, the Go team recommends <a href=\"http://gchandbook.org/\" rel=\"nofollow noreferrer\">The Garbage Collection Handbook: The Art of Automatic Memory Management</a>. </p>\n\n<p>See <a href=\"https://blog.golang.org/ismmkeynote\" rel=\"nofollow noreferrer\">The Go Blog: Getting to Go: The Journey of Go's Garbage Collector</a> for some history.</p>\n"}], "owner": {"reputation": 15571, "user_id": 210342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7412dfe0e7374347dda68aff0c4943fa?s=128&d=identicon&r=PG", "display_name": "greenoldman", "link": "https://stackoverflow.com/users/210342/greenoldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1532891355, "creation_date": 1532885474, "last_edit_date": 1532888669, "question_id": 51582848, "link": "https://stackoverflow.com/questions/51582848/how-does-go-guarantee-element-pointers-are-valid-for-arrays-and-slices", "title": "How does Go guarantee element pointers are valid for arrays and slices?", "body": "<p>When you use indexer on array or slice in return you get the variable so you can take an address of it. I wonder how it is possible because the array/slice could more nested than the target variable:</p>\n\n<pre><code>// ptr declaration here\n{\n  // array declaration here\n  ptr = &amp;array[0];\n}\n</code></pre>\n\n<p>In array case I see a problem that the data are on stack, with slice, that allocating it on heap does not solve automatically the problem, because GC could remove entire slice unless taking an address of the element links to the slice itself (thus preventing freeing memory).</p>\n\n<p><em>Example: what happens when there is no guarantee on validity of the pointers -- let's say my array is a collection of colors. I pick one element, take an address of it, entire array is deleted (because it went of out scope), I check the value of element and it is 3.14. Or \"hello world\". Or maybe <code>green</code>. Since there is no guarantee it could be anything that is located at given address.</em></p>\n"}, {"tags": ["regex", "go"], "answers": [{"comments": [{"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "reply_to_user": {"reputation": 413, "user_id": 1063474, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caafe52a8d9e565719997511c8af01c6?s=128&d=identicon&r=PG", "display_name": "Digital God", "link": "https://stackoverflow.com/users/1063474/digital-god"}, "edited": false, "score": 0, "creation_date": 1532886557, "post_id": 51582910, "comment_id": 90131290, "body": "@DigitalGod Happy to help. If I&#39;m not mistaken, you have enough rep for upvoting <i>and</i> downvoting now."}], "tags": [], "owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "is_accepted": true, "score": 2, "last_activity_date": 1532885922, "creation_date": 1532885922, "answer_id": 51582910, "question_id": 51582791, "link": "https://stackoverflow.com/questions/51582791/regexp-groups-selection/51582910#51582910", "title": "Regexp groups selection", "body": "<p>This should do the trick: <code>^\\[(.*?)\\](?:\\[(.*?)\\])?-&gt;([a-zA-Z ]+)</code>. Make sure you're using the multi-line flag. Here's a Python demo:</p>\n\n<pre><code>&gt;&gt;&gt; for x in re.finditer(r'^\\[(.*?)\\](?:\\[(.*?)\\])?-&gt;([a-zA-Z ]+)', file, re.M):\n    print(x.group(1), x.group(2), x.group(3))\n2018.07.10 00:30:03:109 TraceID: 8HRWSI105YVO91 IncomingTime\n2018.07.10 00:30:03:109 TraceID: 8HRWSI105YVO91 IncomingData\n2018.07.10 00:30:03:109 TraceID: 8HRWSI105YVO91 ThreadID\n2018.07.10 00:30:03:109 TraceID: 8HRWSI105YVO91 RequestExecuteStart\n2018.07.10 00:30:03:109 TraceID: 8HRWSI105YVO91 RequestInfo\n2018.07.10 00:30:03:109 TraceID: 8HRWSI105YVO91 CheckUserInfo\n2018.07.10 00:30:03:218 None Start RTS\n2018.07.10 00:30:03:640 TraceID: 8HRWSI105YVO91 StartExecuteTask\n2018.07.10 00:30:03:749 TraceID: 8HRWSI105YVO91 EndExecuteTask\n2018.07.10 00:30:03:749 TraceID: 8HRWSI105YVO91 RequestExecuteEnd\n2018.07.10 00:30:03:749 TraceID: 8HRWSI105YVO91 OutgoingData\n</code></pre>\n\n<p>You could make it only give you the actual trace ID using <code>^\\[(.*?)\\](?:\\[TraceID: (.*?)\\])?-&gt;([a-zA-Z ]+)</code>.</p>\n"}], "owner": {"reputation": 413, "user_id": 1063474, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caafe52a8d9e565719997511c8af01c6?s=128&d=identicon&r=PG", "display_name": "Digital God", "link": "https://stackoverflow.com/users/1063474/digital-god"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 51582910, "answer_count": 1, "score": 1, "last_activity_date": 1532885922, "creation_date": 1532885038, "question_id": 51582791, "link": "https://stackoverflow.com/questions/51582791/regexp-groups-selection", "title": "Regexp groups selection", "body": "<p>I'm stuck with log parsing. I've this rows in log file. Everything ends with line end <code>\\n</code></p>\n\n<pre><code>[2018.07.10 00:30:03:125] VersionInfo\\886\n[2018.07.10 00:30:03:109][TraceID: 8HRWSI105YVO91]-&gt;IncomingTime\\16\n[2018.07.10 00:30:03:109][TraceID: 8HRWSI105YVO91]-&gt;IncomingData\\397\n[2018.07.10 00:30:03:109][TraceID: 8HRWSI105YVO91]-&gt;ThreadID\\8\n[2018.07.10 00:30:03:109][TraceID: 8HRWSI105YVO91]-&gt;RequestExecuteStart\\16\n[2018.07.10 00:30:03:109][TraceID: 8HRWSI105YVO91]-&gt;RequestInfo\\25\n[2018.07.10 00:30:03:109][TraceID: 8HRWSI105YVO91]-&gt;CheckUserInfo\\139\n[2018.07.10 00:30:03:218]-&gt;Start RTS\n[2018.07.10 00:30:03:640][TraceID: 8HRWSI105YVO91]-&gt;StartExecuteTask\\35\n[2018.07.10 00:30:03:749][TraceID: 8HRWSI105YVO91]-&gt;EndExecuteTask\\36\n[2018.07.10 00:30:03:749][TraceID: 8HRWSI105YVO91]-&gt;RequestExecuteEnd\\16\n[2018.07.10 00:30:03:749][TraceID: 8HRWSI105YVO91]-&gt;OutgoingData\\26651\n</code></pre>\n\n<p>I want to parse each row in groups - time, traceid (if exists) and block name.\nTo select datetime (which is always there) i use <code>\\[(.*?)\\]</code>. It's first group.\nNext must be traceid, if it exists. Get separator <code>(?:\\[|-&gt;| )</code> - <code>[</code> or <code>-&gt;</code> or <code></code>. Group select is same as first <code>\\[(.*?)\\]</code>. And then goes third group with block name <code>([a-zA-Z ]+)</code> - any text at the end without numbers.</p>\n\n<p>I'm completely confused with how to connect it all.\nWhat i want to get is:</p>\n\n<ul>\n<li>group 1 - datetime</li>\n<li>group 2 - traceid | zero</li>\n<li>group 3 - block name</li>\n</ul>\n"}, {"tags": ["go", "opengl"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10151871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GqVaXpP6tGc/AAAAAAAAAAI/AAAAAAAAABw/1bLHEa8W07w/photo.jpg?sz=128", "display_name": "Rishabh Bector", "link": "https://stackoverflow.com/users/10151871/rishabh-bector"}, "edited": false, "score": 0, "creation_date": 1532884785, "post_id": 51582597, "comment_id": 90130787, "body": "I spent hours trying to fix this, and never realized this was the problem. Thanks!"}], "tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 5, "last_activity_date": 1532884083, "last_edit_date": 1532884083, "creation_date": 1532883775, "answer_id": 51582597, "question_id": 51582064, "link": "https://stackoverflow.com/questions/51582064/golang-opengl-element-buffer-object-not-rendering-properly/51582597#51582597", "title": "Golang OpenGL element buffer object not rendering properly", "body": "<p>You are probably using a 64-bit operating system. At a 64-bit operations system the data type <code>uint</code> has a size of 64 bits.\nSee <a href=\"http://www.w3big.com/go/go-data-types.html\" rel=\"noreferrer\">Go language data types</a> or <a href=\"https://tour.golang.org/basics/11\" rel=\"noreferrer\">A Tour of GO - Basic types</a>.</p>\n\n<p>The coordinates of the rectangle ar specified like this:</p>\n\n<pre><code> 1: -0.5, 0.5             2: 0.5, 0.5\n             x-----------x\n             |           |\n             |           |\n             |           |\n             |           |\n             x-----------x\n0: -0.5, -0.5             3: 0.5, -0.5\n</code></pre>\n\n<p>The indices array is a array of 64 bit integer values:</p>\n\n<pre><code>var rectangle = []uint{\n    0, 1, 2,\n    2, 3, 0,\n}\n</code></pre>\n\n<p>But it is treated as an array of 32 bit integers, when the geometry is draw (<code>gl.UNSIGNED_INT</code>):</p>\n\n<pre><code>gl.DrawElements(gl.TRIANGLES, 6, gl.UNSIGNED_INT, gl.PtrOffset(0))\n</code></pre>\n\n<p>This causes that each index of the array is splitted to 2 indices, which 32 bit each, where the 1st value is the index of the array and the 2nd is 0:</p>\n\n<pre><code>[0, 0,   1, 0,   2, 0,   2, 0,   3, 0   0, 0]\n</code></pre>\n\n<p>So the first 2 triangles  (first 6 indices) are</p>\n\n<pre><code>0 - 0 - 1\n0 - 2 - 0\n</code></pre>\n\n<p>In the image you can see this 2 triangles, which are narrowed down to 2 lines, because 2 points of each triangle are equal.</p>\n\n<p>Use the data type <code>uint32</code> to solve the issue:</p>\n\n<pre><code>var rectangle = []uint32{\n    0, 1, 2,\n    2, 3, 0,\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10151871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GqVaXpP6tGc/AAAAAAAAAAI/AAAAAAAAABw/1bLHEa8W07w/photo.jpg?sz=128", "display_name": "Rishabh Bector", "link": "https://stackoverflow.com/users/10151871/rishabh-bector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 51582597, "answer_count": 1, "score": 2, "last_activity_date": 1532884083, "creation_date": 1532879734, "last_edit_date": 1532882151, "question_id": 51582064, "link": "https://stackoverflow.com/questions/51582064/golang-opengl-element-buffer-object-not-rendering-properly", "title": "Golang OpenGL element buffer object not rendering properly", "body": "<p>I'm trying to use an element buffer object to render a simple rectangle in Golang using the go-gl bindings for OpenGL. The following is the main code:</p>\n\n<pre><code>package main\n\nimport (\n    \"gogame/shaders\"\n    \"runtime\"\n\n    \"github.com/go-gl/gl/v4.1-core/gl\"\n    \"github.com/go-gl/glfw/v3.2/glfw\"\n\n    log \"github.com/sirupsen/logrus\"\n)\n\nvar vertices = []float32{\n    -0.5, -0.5, 0.0,\n    -0.5, 0.5, 0.0,\n    0.5, 0.5, 0.0,\n    0.5, -0.5, 0.0,\n}\n\nvar rectangle = []uint{\n    0, 1, 2,\n    2, 3, 0,\n}\n\nfunc init() {\n    runtime.LockOSThread()\n}\n\nfunc main() {\n    window := initGLFW()\n    defer glfw.Terminate()\n\n    program := initOpenGL()\n\n    var vertexBuffer uint32\n    var elementBuffer uint32\n    var vertexArray uint32\n\n    gl.GenBuffers(1, &amp;vertexBuffer)\n    gl.GenBuffers(1, &amp;elementBuffer)\n    gl.GenVertexArrays(1, &amp;vertexArray)\n\n    gl.BindVertexArray(vertexArray)\n\n    gl.BindBuffer(gl.ARRAY_BUFFER, vertexBuffer)\n    gl.BufferData(gl.ARRAY_BUFFER, 4*len(vertices), gl.Ptr(vertices), gl.STATIC_DRAW)\n\n    gl.BindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer)\n    gl.BufferData(gl.ELEMENT_ARRAY_BUFFER, 4*len(rectangle), gl.Ptr(rectangle), gl.STATIC_DRAW)\n\n    gl.VertexAttribPointer(0, 3, gl.FLOAT, false, 0, nil)\n    gl.EnableVertexAttribArray(0)\n\n    gl.BindBuffer(gl.ARRAY_BUFFER, 0)\n    gl.BindVertexArray(0)\n\n    if err := gl.GetError(); err != 0 {\n        log.Error(err)\n    }\n\n    for !window.ShouldClose() {\n        gl.ClearColor(0.5, 0.5, 0.5, 0.5)\n        gl.Clear(gl.COLOR_BUFFER_BIT)\n        gl.Clear(gl.DEPTH_BUFFER_BIT)\n        gl.UseProgram(program)\n\n        gl.BindVertexArray(vertexArray)\n        gl.DrawElements(gl.TRIANGLES, 6, gl.UNSIGNED_INT, gl.PtrOffset(0))\n        //gl.DrawArrays(gl.TRIANGLES, 0, 3)\n\n        glfw.PollEvents()\n        window.SwapBuffers()\n\n        if err := gl.GetError(); err != 0 {\n            log.Error(err)\n        }\n    }\n\n    glfw.Terminate()\n}\n</code></pre>\n\n<p>Theoretically, this should draw a rectangle. However, this is what I get when running it in Wireframe mode:</p>\n\n<p>OpenGL Window<br/><a href=\"https://i.stack.imgur.com/cnLtK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cnLtK.png\" alt=\"OpenGL Window\"></a></p>\n\n<p>The code I left out is just to compile very basic shaders and initialize GLFW and OpenGL.</p>\n"}, {"tags": ["json", "go", "struct", "interface", "strong-typing"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 2, "creation_date": 1532883450, "post_id": 51581729, "comment_id": 90130389, "body": "I think the problem here might be you are just creating an API to the database and do not really process the code. In that way, static typing can provide little help and it makes sense to let <code>map[string] interface</code> flow through the code."}], "answers": [{"comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1532889972, "post_id": 51582176, "comment_id": 90132209, "body": "(If I need to look up more than about three things in a <code>map[string]interface{}</code> and especially if I need to go into inner objects, it&#39;s really painful in Go and I&#39;d much rather be working with a struct.  In, say, Python can trivially look at <code>obj[&#39;parent&#39;][&#39;child&#39;]</code> but in Go getting that value is easily a dozen lines of code.)"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1532890209, "post_id": 51582176, "comment_id": 90132277, "body": "@DavidMaze yes it becomes cumbersome if the json contains nested value to get the deeper values in case of using <code>map[string]interface</code>. So it is better to use structs. Also there may be the case when you wants to unmarshal array of objects in that case you can implement unmarshal interface by using interface for help"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 2, "last_activity_date": 1532951517, "last_edit_date": 1532951517, "creation_date": 1532880526, "answer_id": 51582176, "question_id": 51581729, "link": "https://stackoverflow.com/questions/51581729/excessive-use-of-mapstringinterface-in-go-development/51582176#51582176", "title": "Excessive use of map[string]interface{} in go development?", "body": "<p>It really depends on the requirements just like you have said you don't require to process the json it comes from the request or from the sql results. Then you can easily unmarshal into <code>interface{}</code>. And marshal the json coming from sql results.</p>\n\n<p>For <strong>Step 2</strong></p>\n\n<p>Golang has library which works on validation of structs used to unmarshal json with tags for the fields inside.</p>\n\n<p><a href=\"https://github.com/go-playground/validator\" rel=\"nofollow noreferrer\">https://github.com/go-playground/validator</a></p>\n\n<pre><code>type Test struct {\n    Field `validate:\"max=10,min=1\"`\n}\n\n// max will be checked then min\n</code></pre>\n\n<p>you can also go to godoc for <a href=\"https://godoc.org/gopkg.in/go-playground/validator.v9\" rel=\"nofollow noreferrer\">validation library</a>. It is very good implementation of validation for json values using struct tags.</p>\n\n<p>For <strong>STEP 4</strong> </p>\n\n<p>Most of the times, We use structs if we know the format and data of our JSON. Because it provides us more control over the data types and other functionality. For example if you wants to empty a JSON feild if you don't require it in your JSON. You should use struct with <code>_</code> json tag.</p>\n\n<p>Now you have said that you don't care if the result coming from sql is empty or not. But if you do it again comes to using struct. You can scan the result into struct with <a href=\"https://golang.org/pkg/database/sql/#NullBool\" rel=\"nofollow noreferrer\"><code>sql.NullTypes</code></a>. With that also you can provide json tag for <code>omitempty</code> if you wants to omit the json object when <code>marshaling</code> the data when sending a response.</p>\n\n<blockquote>\n  <p>Struct values encode as JSON objects. Each exported struct field\n  becomes a member of the object, using the field name as the object\n  key, unless the field is omitted for one of the reasons given below.</p>\n  \n  <p>The encoding of each struct field can be customized by the format\n  string stored under the \"json\" key in the struct field's tag. The\n  format string gives the name of the field, possibly followed by a\n  comma-separated list of options. The name may be empty in order to\n  specify options without overriding the default field name.</p>\n  \n  <p>The \"omitempty\" option specifies that the field should be omitted from\n  the encoding if the field has an empty value, defined as false, 0, a\n  nil pointer, a nil interface value, and any empty array, slice, map,\n  or string.</p>\n  \n  <p>As a special case, if the field tag is \"-\", the field is always\n  omitted. Note that a field with name \"-\" can still be generated using\n  the tag \"-,\".</p>\n</blockquote>\n\n<p>Example of json tags</p>\n\n<pre><code>// Field appears in JSON as key \"myName\".\nField int `json:\"myName\"`\n\n// Field appears in JSON as key \"myName\" and\n// the field is omitted from the object if its value is empty,\n// as defined above.\nField int `json:\"myName,omitempty\"`\n\n// Field appears in JSON as key \"Field\" (the default), but\n// the field is skipped if empty.\n// Note the leading comma.\nField int `json:\",omitempty\"`\n\n// Field is ignored by this package.\nField int `json:\"-\"`\n\n// Field appears in JSON as key \"-\".\nField int `json:\"-,\"`\n</code></pre>\n\n<p>As you can analyze from above information given in Golang spec for <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">json marshal</a>. Struct provide so much control over json. That's why Golang developer most probably use structs.</p>\n\n<p>Now on using <code>map[string]interface{}</code> you should use it when you don't the structure of your json coming from the server or the types of fields. Most Golang developers stick to structs wherever they can.</p>\n"}], "owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 0, "accepted_answer_id": 51582176, "answer_count": 1, "score": 3, "last_activity_date": 1532969795, "creation_date": 1532877458, "last_edit_date": 1532969795, "question_id": 51581729, "link": "https://stackoverflow.com/questions/51581729/excessive-use-of-mapstringinterface-in-go-development", "title": "Excessive use of map[string]interface{} in go development?", "body": "<p>The majority of my development experience has been from dynamically typed languages like PHP and Javascript.  I've been practicing with Golang for about a month now by re-creating some of my old PHP/Javascript REST APIs in Golang.  I feel like I'm not doing things the Golang way most of the time.  Or more generally, I'm not use to working with strongly typed languages.  I feel like I'm making excessive use of <code>map[string]interface{}</code> and slices of them to box up data as it comes in from http requests or when it gets shipped out as json http output.  So what I'd like to know is if what I'm about to describe goes against the philosophy of golang development?  Or if I'm breaking the principles of developing with strongly typed languages?</p>\n\n<p>Right now, about 90% of the program flow for REST Apis I've rewritten with Golang can be described by these 5 steps.</p>\n\n<p><strong>STEP 1 - Receive Data</strong></p>\n\n<p>I receive http form data from <code>http.Request.ParseForm()</code> as <code>formvals := map[string][]string</code>.  Sometimes I will store serialized JSON objects that need to be unmarshaled like <code>jsonUserInfo := json.Unmarshal(formvals[\"user_information\"][0]) /* gives some complex json object */</code>.</p>\n\n<p><strong>STEP 2 - Validate Data</strong></p>\n\n<p>I do validation on <code>formvals</code> to make sure all the data values are what I expect before using it in SQL queries.  I treat everyting as a string, then use Regex to determine if the string format and business logic is valid (eg. IsEmail, IsNumeric, IsFloat, IsCASLCompliant, IsEligibleForVoting,IsLibraryCardExpired etc...).  I've written my own Regex and custom functions for these types of validations</p>\n\n<p><strong>STEP 3 - Bind Data to SQL Queries</strong></p>\n\n<p>I use golang's <code>database/sql.DB</code> to take my formvals and bind them to my Query and Exec functions like this <code>Query(\"SELECT * FROM tblUser WHERE user_id = ?, user_birthday &gt; ? \",formvals[\"user_id\"][0], jsonUserInfo[\"birthday\"])</code>.  I never care about the data types I'm supplying as arguments to be bound, so they're all probably strings.  I trust the validation in the step immediately above has determined they are acceptable for SQL use.</p>\n\n<p><strong>STEP 4 - Bind SQL results to <code>[]map[string]interface{}{}</code></strong></p>\n\n<p>I <code>Scan()</code> the results of my queries into a <code>sqlResult := []map[string]interface{}{}</code> because I don't care if the value types are null, strings, float, ints or whatever.  So the schema of an <code>sqlResult</code> might look like:</p>\n\n<pre><code>sqlResult =&gt;\n    [0] {\n        \"user_id\":\"1\"\n        \"user_name\":\"Bob Smith\"\n        \"age\":\"45\"\n        \"weight\":\"34.22\"\n    },\n    [1] {\n        \"user_id\":\"2\"\n        \"user_name\":\"Jane Do\"\n        \"age\":nil\n        \"weight\":\"22.22\"\n    }\n</code></pre>\n\n<p>I wrote my own eager load function so that I can bind more information like so <code>EagerLoad(\"tblAddress\", \"JOIN ON tblAddress.user_id\",&amp;sqlResult)</code> which then populates <code>sqlResult</code> with more information of the type <code>[]map[string]interface{}{}</code> such that it looks like this:</p>\n\n<pre><code>sqlResult =&gt;\n    [0] {\n        \"user_id\":\"1\"\n        \"user_name\":\"Bob Smith\"\n        \"age\":\"45\"\n        \"weight\":\"34.22\"\n        \"addresses\"=&gt;\n            [0] {\n                \"type\":\"home\"\n                \"address1\":\"56 Front Street West\"\n                \"postal\":\"L3L3L3\"\n                \"lat\":\"34.3422242\"\n                \"lng\":\"34.5523422\"\n            }\n            [1] {\n                \"type\":\"work\"\n                \"address1\":\"5 Kennedy Avenue\"\n                \"postal\":\"L3L3L3\"\n                \"lat\":\"34.3422242\"\n                \"lng\":\"34.5523422\"\n            }\n    },\n    [1] {\n        \"user_id\":\"2\"\n        \"user_name\":\"Jane Do\"\n        \"age\":nil\n        \"weight\":\"22.22\"\n        \"addresses\"=&gt;\n            [0] {\n                \"type\":\"home\"\n                \"address1\":\"56 Front Street West\"\n                \"postal\":\"L3L3L3\"\n                \"lat\":\"34.3422242\"\n                \"lng\":\"34.5523422\"\n            }\n    }\n</code></pre>\n\n<p><strong>STEP 5 - JSON Marshal and send HTTP Response</strong></p>\n\n<p>then I do a <code>http.ResponseWriter.Write(json.Marshal(sqlResult))</code> and output data for my REST API</p>\n\n<p>Recently, I've been revisiting articles with code samples that use structs in places I would have used <code>map[string]interface{}</code>.  For example, I wanted to refactor Step 2 with a more standard approach that other golang developers would use.  So I found this <a href=\"https://godoc.org/gopkg.in/go-playground/validator.v9\" rel=\"nofollow noreferrer\">https://godoc.org/gopkg.in/go-playground/validator.v9</a>, except all it's examples are with structs .  I also noticed that most blogs that talk about <code>database/sql</code> scan their SQL results into typed variables or structs with typed properties, as opposed to my Step 4 which just puts everything into <code>map[string]interface{}</code></p>\n\n<p>Hence, i started writing this question.  I feel the <code>map[string]interface{}</code> is so useful because majority of the time,I don't really care what the data is and it gives me to the freedom in Step 4 to construct any data schema on the fly before I dump it as JSON http response. I do all this with as little code verbosity as possible.  But this means my code is not as ready to leverage Go's validation tools, and it doesn't seem to comply with the golang community's way of doing things.</p>\n\n<p>So my question is, what do other golang developers do with regards to Step 2 and Step 4?  Especially in Step 4...do Golang developers really encourage specifying the schema of the data through structs and strongly typed properties?  Do they also specify structs with strongly typed properties along with every eager loading call they make?  Doesn't that seem like so much more code verbosity?</p>\n"}, {"tags": ["templates", "go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532885931, "post_id": 51582900, "comment_id": 90131108, "body": "Can you please update your answer with the exact code ?"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532885991, "post_id": 51582900, "comment_id": 90131123, "body": "im using <code>{{- range .ExeApp}} {{range .Command }} &amp;&amp; {{.}} {{end}} {{- end}}</code> and getting error, what am I missing here ?"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532886155, "post_id": 51582900, "comment_id": 90131162, "body": "even if I remove the <code>&amp;&amp;</code> im getting error <code>function Command&quot; not defined </code>"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532886591, "post_id": 51582900, "comment_id": 90131304, "body": "This is the last version <code>{{-range .ExeApp}} {{range .Command}} {{.}} {{end}} {{-end}}</code>"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532886683, "post_id": 51582900, "comment_id": 90131328, "body": "so it should be like what I put in my last comment ? or something else"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532891679, "post_id": 51582900, "comment_id": 90132683, "body": "Thanks 1+, but my code use FuncMap, how should I do it in this case ?"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532892355, "post_id": 51582900, "comment_id": 90132859, "body": "The function which is returning this data is <code>ExeApp</code>, I must use it..."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532892419, "post_id": 51582900, "comment_id": 90132879, "body": "if I can use function that returning <code>data := []App{App{&quot;test data&quot;, []string{&quot;app1&quot;, &quot;app2&quot;, &quot;app3&quot;}}}</code> it will be great (with FuncMap), this will solve the issue"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532927062, "post_id": 51582900, "comment_id": 90139664, "body": "Thanks, well this is part from a bigger template which is divided to functions..., the dot is not helping becouse the template miss the cotext, where does the ExeApp function should be take part, I dont see anything in the template which is related to the function which return the <code>data</code>..."}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "reply_to_user": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532933012, "post_id": 51582900, "comment_id": 90141755, "body": "added a new last line. if you read the docs this should become clear."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532933274, "post_id": 51582900, "comment_id": 90141860, "body": "I&#39;ve read the docs and here its a bit more complicated, where should I put the {{ range ExeApp }} , can you please update the sample you have created with the funcMap , this is what I miss here?"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532933956, "post_id": 51582900, "comment_id": 90142179, "body": "I think that this example is closer to what I need but I couldn&#39;t make it work :( <a href=\"https://play.golang.org/p/C3U2vw_cDo_k\" rel=\"nofollow noreferrer\">play.golang.org/p/C3U2vw_cDo_k</a>"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532937231, "post_id": 51582900, "comment_id": 90143857, "body": "Thanks, im checking it now"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532937677, "post_id": 51582900, "comment_id": 90144124, "body": "Looks good, thanks a lot.that my function <code>ExeApp(m model)</code> is having parameter (in real life) , how it should be adopted {{ range ExeCmd - }} in this case ?"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532938450, "post_id": 51582900, "comment_id": 90144504, "body": "You said in your comments that I need to use function just for helpres but lets assume that I&#39;ve big template which needs to generate different thiings from diffrent data how would you hande lit ?"}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "reply_to_user": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532938538, "post_id": 51582900, "comment_id": 90144554, "body": "Context can be a struct containing all the data you need or a map[string]interface{} to contain arbitrary data."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532938597, "post_id": 51582900, "comment_id": 90144583, "body": "but it&#39;s different type of data and different structures of data why I need to combine them ?"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532938627, "post_id": 51582900, "comment_id": 90144602, "body": "in funcMap for my opinion you can spreate the data sources value, each func sends different data, is it wrong ?"}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "reply_to_user": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1532939187, "post_id": 51582900, "comment_id": 90144857, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/177000/discussion-between-shopia-t-and-kenny-grant\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1532939734, "post_id": 51582900, "comment_id": 90145113, "body": "Thanks for your help :)"}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 1, "last_activity_date": 1532936988, "last_edit_date": 1532936988, "creation_date": 1532885839, "answer_id": 51582900, "question_id": 51581323, "link": "https://stackoverflow.com/questions/51581323/golang-template-generate-values-from-array-of-strings-error/51582900#51582900", "title": "Golang template generate values from array of strings error", "body": "<p>In your final example you have two ranges and only one end (prior to your edit!)</p>\n\n<p>Now that is fixed, are you sure you don't have a space between the dot and Command? Try putting an example on play.golang.org as the errors don't match what you have shown - funcs from funcmap don't have a dot prefix. </p>\n\n<p>Then to avoid trailing &amp;&amp; you'll need to use the variant of range with an index, put the &amp;&amp; before and only print if index > 0</p>\n\n<p>I think you want something like this: </p>\n\n<p><a href=\"https://play.golang.org/p/O8rpum8LtZr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/O8rpum8LtZr</a></p>\n\n<pre><code>// Define a template.\nconst tmpl = `\n{{ range . -}}\n{{range $i,$a := .Command}}{{if gt $i 0 }} &amp;&amp; {{end}}{{.}}{{end}}\n{{end}}\n`\n\n// Prepare some data\ntype App struct {\n    Data    string\n    Command []string\n}\ndata := []App{App{\"test data\", []string{\"app1\", \"app2\", \"app3\"}}}\n\n// Create a new template and parse into it.\nt := template.Must(template.New(\"tmpl\").Parse(tmpl))\n\n// Execute the template with data\nerr := t.Execute(os.Stdout, data)\nif err != nil {\n    log.Println(\"executing template:\", err)\n}\n</code></pre>\n\n<p>Read the <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">docs</a> for text/template before proceeding, to clear up a few misunderstandings - funcs don't take ., you may not need a func at all, don't use them to pass data in use a context for that (data in my example).</p>\n\n<p>Also perhaps consider in this example whether you want to use text/template at all - if the strings you are building are command line arguments you may well want to look at examples for the <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">os/exec</a> package instead. </p>\n\n<p>Use <code>{{ range ExeApp }}</code> (note no dot) if you want to use the data returned from a function. Your example introduces several errors! If you must use a funcmap for data, here is how you'd do it: </p>\n\n<p><a href=\"https://play.golang.org/p/euWxctWRbp_L\" rel=\"nofollow noreferrer\">https://play.golang.org/p/euWxctWRbp_L</a></p>\n\n<p>Please <strong>do</strong> read the docs though, funcs don't use the dot prefix (that's rather important), and also funcmaps are for helpers, not data, you are storing up problems for yourself if you rely on funcmaps for data, as you will make it harder to tell where the data comes from, harder to debug the handlers etc. </p>\n"}], "owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3004, "favorite_count": 1, "accepted_answer_id": 51582900, "answer_count": 1, "score": -1, "last_activity_date": 1532936988, "creation_date": 1532874600, "last_edit_date": 1532887187, "question_id": 51581323, "link": "https://stackoverflow.com/questions/51581323/golang-template-generate-values-from-array-of-strings-error", "title": "Golang template generate values from array of strings error", "body": "<p>Im using Golang project which needs to generate the following </p>\n\n<p><code>app1 &amp;&amp; app2 &amp;&amp; app3</code></p>\n\n<p>My template look like following</p>\n\n<pre><code>{{- range ExeApp .}} {{ .Command }} {{- end}}\n</code></pre>\n\n<p>My code looks like following with command which is array of strings</p>\n\n<pre><code>type App struct {\n   Data    string\n   Command []string\n}\n\n//This is the function\nfunc ExeApp(m models) []App {\n\n   switch m.Type {\n   case \u201capps\":\n      return []App{\n         {\"# running apps\",\n            []string{\u201capp1\", \u201capp2\", \u201capp3\"}},\n      }\n\n\u2026\n</code></pre>\n\n<p>Currently its generated like </p>\n\n<pre><code>[app1 app2 app3]\n</code></pre>\n\n<p>And I need it like </p>\n\n<p><code>app1 &amp;&amp; app2 &amp;&amp; app3</code> ,</p>\n\n<p>I try to play with the template by adding &amp;&amp; before the .Command which doesn\u2019t help and in addition I don\u2019t know how to remove the array [] before and after the apps, any idea what I\u2019m doing wrong here ?</p>\n\n<p>i've tried with the following</p>\n\n<pre><code>{{- range .ExeApp}} {{range .Command }} &amp;&amp; {{.}} {{end}} {{- end}}\n</code></pre>\n\n<p>But now im getting dump with <strong>error:</strong> <code>unexpected EOF</code> or <strong>function \"Command\" not defined</strong></p>\n\n<p>while running the template</p>\n\n<p>The code to generate is:</p>\n\n<pre><code>funcMap := template.FuncMap{\n    \"ExeApp\": ExeApp,\n}\nt, err := template.New(\"file.txt\").Funcs(funcMap).ParseFiles(container)\n</code></pre>\n\n<p>in case Im working with the first structure (same structure without the array of strings and of course adapt the code of the object) everything is working as expected</p>\n\n<p>Try also with this\n<code>{{-range .ExeApp}} {{range .Command}} {{.}} {{end}} {{end}}</code></p>\n\n<p><strong>Now im getting error</strong> </p>\n\n<pre><code>executing \"file.txt\" at &lt;.ExeApp&gt;: can't evaluate field ExeApp in type *models\n</code></pre>\n\n<p>why :( </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1532868661, "post_id": 51580410, "comment_id": 90126299, "body": "I also do that mistake, inserting [] after type (as I spell it as type array). Instead spelling as &quot;slice of type&quot; helps to write as []string."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1532868087, "creation_date": 1532868087, "answer_id": 51580428, "question_id": 51580410, "link": "https://stackoverflow.com/questions/51580410/golang-array-of-string-inside-struct/51580428#51580428", "title": "Golang array of string inside struct", "body": "<p>The correct syntax is the following:</p>\n\n<pre><code>return []Str{\n    {\"info from source\", []string{\"install\", \"run\"}},\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 51580428, "answer_count": 1, "score": 0, "last_activity_date": 1532868087, "creation_date": 1532867928, "question_id": 51580410, "link": "https://stackoverflow.com/questions/51580410/golang-array-of-string-inside-struct", "title": "Golang array of string inside struct", "body": "<p>Im using the following struct</p>\n\n<pre><code>type Str struct {\n    Info    string\n    Command string\n}\n</code></pre>\n\n<p>And to fill data inside of it Im doing the following which works.</p>\n\n<pre><code>    return []Str{\n        {\"info from source\",\n            \"install &amp;&amp; run\"},\n    }\n</code></pre>\n\n<p>Now I need to change the command to array</p>\n\n<pre><code>type Str struct {\n    Info    string\n    Command []string\n}\n</code></pre>\n\n<p>And provide each of the commands(\"install\" and \"run\")  in new entry in the array, how can I do that </p>\n\n<p>when I try with </p>\n\n<pre><code>return []Str{\n    {\"info from source\",string[]{\n        {\"install},  {\"run\"}},\n}\n</code></pre>\n\n<p>I got erorr of missing type literal, any idea what Im  doing wrong </p>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 2249, "user_id": 890750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8b5721b4d1ad819031db37d52360a0c?s=128&d=identicon&r=PG", "display_name": "nachopro", "link": "https://stackoverflow.com/users/890750/nachopro"}, "edited": false, "score": 0, "creation_date": 1532904311, "post_id": 51580254, "comment_id": 90135870, "body": "Could you expand your explanation? I understand your advice but I can not apply it in my example. Thanks."}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "reply_to_user": {"reputation": 2249, "user_id": 890750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8b5721b4d1ad819031db37d52360a0c?s=128&d=identicon&r=PG", "display_name": "nachopro", "link": "https://stackoverflow.com/users/890750/nachopro"}, "edited": false, "score": 0, "creation_date": 1532940771, "post_id": 51580254, "comment_id": 90145657, "body": "added snippet for second way"}], "tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 0, "last_activity_date": 1532940720, "last_edit_date": 1532940720, "creation_date": 1532866698, "answer_id": 51580254, "question_id": 51579812, "link": "https://stackoverflow.com/questions/51579812/my-graceful-stop-http-listenandserve-fails/51580254#51580254", "title": "My graceful stop http.ListenAndServe fails", "body": "<p>one way is to narrow down your max connection to 1 by:</p>\n\n<pre><code>l, err := net.Listen(\"tcp\", \":8000\")\n\nif err != nil {\n    log.Fatalf(\"Listen: %v\", err)\n}\n\ndefer l.Close()\n\nl = netutil.LimitListener(l, 1)\n\nlog.Fatal(http.Serve(l, nil))\n</code></pre>\n\n<p>another way is using a global variable:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"sync/atomic\"\n    \"fmt\"\n)\n\nvar toggle *int32\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    val := atomic.LoadInt32(toggle)\n    if val != 0 {\n        fmt.Fprintln(w, \"Not Valid!\")\n        w.WriteHeader(http.StatusForbidden)\n        return\n    }\n\n    atomic.StoreInt32(toggle, 1)\n    // do stuff\n    w.WriteHeader(http.StatusOK)\n}\n\nfunc init (){\n    atomic.StoreInt32(toggle, int32(0))\n}\n</code></pre>\n\n<p>**notice both ways works for single node servers and does not work in distributed systems, solution for that is using cache servers like redis etc.</p>\n"}, {"tags": [], "owner": {"reputation": 2249, "user_id": 890750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8b5721b4d1ad819031db37d52360a0c?s=128&d=identicon&r=PG", "display_name": "nachopro", "link": "https://stackoverflow.com/users/890750/nachopro"}, "is_accepted": false, "score": 1, "last_activity_date": 1532930519, "creation_date": 1532930519, "answer_id": 51587790, "question_id": 51579812, "link": "https://stackoverflow.com/questions/51579812/my-graceful-stop-http-listenandserve-fails/51587790#51587790", "title": "My graceful stop http.ListenAndServe fails", "body": "<p>Thanks to this <a href=\"https://tylerchr.blog/golang-18-whats-coming/\" rel=\"nofollow noreferrer\">blog entry</a> and their example I found this <a href=\"https://github.com/golang/go/issues/4674\" rel=\"nofollow noreferrer\">issue</a> and their <a href=\"https://tip.golang.org/pkg/net/http/#Server.Shutdown\" rel=\"nofollow noreferrer\">solution</a>. I saw that my problem isn't related to net/http module!</p>\n\n<p>The real problem is the <code>log.Fatal(err)</code> inside <code>go func()</code>, changing it to <code>log.Info(err)</code> does not abort the shutdown process.</p>\n\n<pre><code>go func() {\n    log.Info(\"Serving on http://\", listenAt)\n\n    if err := h.ListenAndServe(); err != nil {\n        // log.Fatal(err)\n        log.Info(err)\n    }\n}()\n</code></pre>\n"}], "owner": {"reputation": 2249, "user_id": 890750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8b5721b4d1ad819031db37d52360a0c?s=128&d=identicon&r=PG", "display_name": "nachopro", "link": "https://stackoverflow.com/users/890750/nachopro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532940720, "creation_date": 1532863411, "last_edit_date": 1532864298, "question_id": 51579812, "link": "https://stackoverflow.com/questions/51579812/my-graceful-stop-http-listenandserve-fails", "title": "My graceful stop http.ListenAndServe fails", "body": "<p>I'm a novice Go programmer.</p>\n\n<p>I am writing a web application and I need the server to wait until the active requests are made before closing.</p>\n\n<p>I wrote a handler that waits 5 seconds to answer. If I make a request and stop the server (before the 5 seconds) I get an \"Unable to connect\" error.</p>\n\n<p>There is a way to stop listen new requests and wait to active requests get done?</p>\n\n<p>Here my example</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    log.Infof(\"Starting (PID %d)...\", os.Getpid())\n\n    stop := make(chan os.Signal, 1)\n    signal.Notify(stop, syscall.SIGTERM)\n    signal.Notify(stop, syscall.SIGINT)\n\n    listenAt := \"127.0.0.1:8000\"\n\n    r := newRouter()\n    h := &amp;http.Server{Addr: listenAt, Handler: r}\n\n    go func() {\n        log.Info(\"Serving on http://\", listenAt)\n\n        if err := h.ListenAndServe(); err != nil {\n            log.Fatal(err)\n        }\n    }()\n    &lt;-stop\n\n    log.Info(\"Stoping ...\")\n    h.Shutdown(context.Background())\n    log.Info(\"Bye :)\")\n}\n</code></pre>\n\n<p>Example Handler</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func handler(w http.ResponseWriter, r *http.Request) {\n    time.Sleep(5 * time.Second)\n    log.Info(\"new request\")\n    fmt.Fprintf(w, \"Hola!\")\n}\n</code></pre>\n\n<p>Full example @ <a href=\"https://gist.github.com/nachopro/d80fa71ae49527e1ddcaf359b4ff488b\" rel=\"nofollow noreferrer\">https://gist.github.com/nachopro/d80fa71ae49527e1ddcaf359b4ff488b</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 589969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/743586d634a537e7466e2dd5b16e18a3?s=128&d=identicon&r=PG&f=1", "display_name": "Odinovsky", "link": "https://stackoverflow.com/users/589969/odinovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1532866576, "creation_date": 1532866576, "answer_id": 51580241, "question_id": 51579712, "link": "https://stackoverflow.com/questions/51579712/multidimensional-array-in-golang/51580241#51580241", "title": "multidimensional array in golang", "body": "<p>I may have to do it like this:</p>\n\n<pre><code>        v_pl, ok_pl := postinglist[str]\n        if !ok_pl {\n            _, ok_pl2 := v_pl[id]\n            if !ok_pl2 {\n                postinglist[str] = map[int]float64{id: tf}\n            }\n        } else {\n            _, ok_pl2 := v_pl[id]\n            if !ok_pl2 {\n                postinglist[str][id] = tf\n            }\n        }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1532869949, "last_edit_date": 1532869949, "creation_date": 1532867290, "answer_id": 51580327, "question_id": 51579712, "link": "https://stackoverflow.com/questions/51579712/multidimensional-array-in-golang/51580327#51580327", "title": "multidimensional array in golang", "body": "<p>Make a map if the map is <code>nil</code>. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    tests := []struct {\n        s string\n        i int\n        f float64\n    }{\n        {\"s\", 42, math.Pi},\n        {\"s\", 100, math.E},\n        {\"s\", 100, 1000.0},\n        {\"x\", 1, 2.0},\n    }\n\n    var m map[string]map[int]float64\n    fmt.Println(m)\n    for _, t := range tests {\n        if m == nil {\n            m = make(map[string]map[int]float64)\n        }\n        if m[t.s] == nil {\n            m[t.s] = make(map[int]float64)\n        }\n        m[t.s][t.i] += t.f\n        fmt.Println(m)\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/IBZxGgAi6eL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IBZxGgAi6eL</a></p>\n\n<p>Output:</p>\n\n<pre><code>map[]\nmap[s:map[42:3.141592653589793]]\nmap[s:map[42:3.141592653589793 100:2.718281828459045]]\nmap[s:map[42:3.141592653589793 100:1002.718281828459]]\nmap[s:map[42:3.141592653589793 100:1002.718281828459] x:map[1:2]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5576, "user_id": 4986182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5oDOo.png?s=128&g=1", "display_name": "vitr", "link": "https://stackoverflow.com/users/4986182/vitr"}, "is_accepted": false, "score": 0, "last_activity_date": 1532871048, "creation_date": 1532871048, "answer_id": 51580802, "question_id": 51579712, "link": "https://stackoverflow.com/questions/51579712/multidimensional-array-in-golang/51580802#51580802", "title": "multidimensional array in golang", "body": "<p>If you don't use the zero value in the map, you can take advantage of comparing with nil, as <a href=\"https://stackoverflow.com/users/221700/peterso\">peterSO</a> suggested. In addition, I would encourage you to use custom types, e.g.</p>\n\n<pre><code>type PostStat map[int]float64\ntype PostList map[string]PostStat\n\npl := make(PostList)\nfor id, doc := range indexmanager.GetDocuments() {\n    for str, tf := range doc {\n        if pl[str] == nil {\n            pl[str] = make(PostStat)\n        }\n        if _, ok := pl[str][id]; !ok {\n            pl[str][id] = tf\n        }\n    }\n}\n</code></pre>\n\n<p>The code above looks a bit clearer and easier to understand, in my opinion.</p>\n"}], "owner": {"reputation": 471, "user_id": 589969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/743586d634a537e7466e2dd5b16e18a3?s=128&d=identicon&r=PG&f=1", "display_name": "Odinovsky", "link": "https://stackoverflow.com/users/589969/odinovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3219, "favorite_count": 2, "accepted_answer_id": 51580327, "answer_count": 3, "score": 5, "last_activity_date": 1532871048, "creation_date": 1532862745, "question_id": 51579712, "link": "https://stackoverflow.com/questions/51579712/multidimensional-array-in-golang", "title": "multidimensional array in golang", "body": "<p>Coming from a language that uses array (PHP) and only 3 days of experience in golang, how can I translate a multi-dimensional array assignment using map (or slice, or combination)</p>\n\n<p>I have this code in PHP:\n$set is a collection of document vectors (string => frequency).</p>\n\n<p>I normally can create a posting statistics like this:</p>\n\n<pre><code>$postinglist = array();  \n\nforeach ($set as $id=&gt;$doc) {\n      foreach ($doc as $term =&gt; $value) {\n\n      if(!isset($postinglist[$term][$id])) {\n          $postinglist[$term][$id] = $value;\n      }\n}\n</code></pre>\n\n<p>So it would look something like:</p>\n\n<pre><code>array ( \n   'the' =&gt; array ( \n      1 =&gt; 5, \n      2 =&gt; 10 \n      ), \n   'and' =&gt; array ( \n      1 =&gt; 6, \n      3 =&gt; 7\n      )\n    )\n</code></pre>\n\n<p>After building my corpus (just array of all terms in all documents),\nI would then build the posting list for each terms:</p>\n\n<pre><code>$terms = $this-&gt;getAllTerms();\n\nforeach($terms as $term) {\n    $entry = new EntryStatistics();\n\n    foreach($postinglist[$term] as $id =&gt; $value) {\n       $post = new PostingStatistics;\n       $post-&gt;setTf($value);\n       $entry-&gt;setPostingList($id, $post);\n    }\n}\n</code></pre>\n\n<p>I'm wondering if there's a neat way of doing such in golang as I've tried this:</p>\n\n<pre><code>postinglist := make(map[string]map[int]float64)\nfor id, doc := range indexmanager.GetDocuments() {\n  for str, tf := range doc {\n      _, ok_pl := postinglist[str][id]\n      if !ok_pl {\n          postinglist[str] = make(map[int]float64)\n          postinglist[str][id] = tf\n      }\n   }\n}\n</code></pre>\n\n<p>Of course it doesn't work, as it always initializes the map everytime I do:</p>\n\n<pre><code>postinglist[str] = make(map[int]float64)\n</code></pre>\n"}, {"tags": ["json", "dictionary", "go", "interface"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1532859623, "post_id": 51579246, "comment_id": 90123899, "body": "Give us JSON example please"}, {"owner": {"reputation": 81, "user_id": 10150930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GgBBkpUW710/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7puoa8L7t1UYQZjYTO4431xkK3NpA/mo/photo.jpg?sz=128", "display_name": "bed", "link": "https://stackoverflow.com/users/10150930/bed"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1532865544, "post_id": 51579246, "comment_id": 90125407, "body": "{&quot;count&quot;:1,&quot;result&quot;:{&quot;COD_DIPENDENTE&quot;:&quot;00060636&quot;,&quot;MATRICOLA&quot;&zwnj;&#8203;:&quot;60636&quot;,&quot;COGNOME&quot;:&quot;&zwnj;&#8203;PIPPO&quot;}}  this is the JSON example. If i have two json like this the result of the function it should be  &quot;result&quot;:{&quot;COD_DIPENDENTE&quot;:&quot;00060636&quot;,&quot;MATRICOLA&quot;:&quot;60636&quot;,&quot;C&zwnj;&#8203;OGNOME&quot;:&quot;PIPPO&quot;,&quot;COD&zwnj;&#8203;_DIPENDENTE&quot;:&quot;000606&zwnj;&#8203;36&quot;,&quot;MATRICOLA&quot;:&quot;606&zwnj;&#8203;36&quot;,&quot;COGNOME&quot;:&quot;PIPPO&zwnj;&#8203;&quot;}}"}, {"owner": {"reputation": 380, "user_id": 2562707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/144239114cfd238694964d1d4a75666c?s=128&d=identicon&r=PG", "display_name": "Joshua Kolden", "link": "https://stackoverflow.com/users/2562707/joshua-kolden"}, "edited": false, "score": 0, "creation_date": 1532897028, "post_id": 51579246, "comment_id": 90134201, "body": "Your output as described is not valid JSON.  You describe &quot;result&quot; as referring to an object by using brackets, but objects are <i>SETS</i> which means names may not be repeated. Is it preferable to you to reformat the output to be valid JSON, or to maintain the structure despite the fact it is not JSON?  I can provide an answer either way, but need to know which you prefer."}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 2562707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/144239114cfd238694964d1d4a75666c?s=128&d=identicon&r=PG", "display_name": "Joshua Kolden", "link": "https://stackoverflow.com/users/2562707/joshua-kolden"}, "is_accepted": true, "score": 0, "last_activity_date": 1535605705, "last_edit_date": 1535605705, "creation_date": 1532903868, "answer_id": 51585119, "question_id": 51579246, "link": "https://stackoverflow.com/questions/51579246/merge-two-mapstringinterface-from-json/51585119#51585119", "title": "merge two map[string]interface{} from json", "body": "<p>The output you are looking for is not valid JSON. However with a small change you can output something very similar to your example that is valid JSON.</p>\n\n<p>You probably do want to use a defined structure for the portion of the input that has a known structure, so that you can extract the more abstract \"result\" section more easily.</p>\n\n<p>If you start at the top of the input structure using a <code>map[string]interface{}</code> then you'll have to do a type assertion on the \"result\" key. For example:</p>\n\n<pre><code>var input map[string]interface{}\n\nerr = json.Unmarshal(data, &amp;input)\nif err != nil {\n    return err\n}\nkeys, ok := input[\"result\"].(map[string]interface{})\nif !ok {\n    return errors.New(\"wasn't the type we expected\")\n}\n</code></pre>\n\n<p>However if you used a defined structure for the top level you can do it like the following which feels much cleaner.</p>\n\n<pre><code>type Input struct {\n    Count  int                    `json:\"count\"`\n    Result map[string]interface{} `json:\"result\"`\n}\n\nvar input Input\nerr = json.Unmarshal(data, &amp;input)\nif err != nil {\n    return err\n}\n// from here you can use input.Result directly without a type assertion\n</code></pre>\n\n<p>To generate output that has duplicate keys, you could use an array of objects with a single key/value pair in each, then you end up with a valid JSON structure that does not overwrite keys.  Here's how to do that (<a href=\"https://play.golang.org/p/ZPrDeFlX3Vu\" rel=\"nofollow noreferrer\">playground link</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Input struct {\n    Count  int                    `json:\"count\"`\n    Result map[string]interface{} `json:\"result\"`\n}\n\ntype Output struct {\n    Count  int                      `json:\"count\"`\n    Result []map[string]interface{} `json:\"result\"`\n}\n\nvar inputdata = [][]byte{\n    []byte(`{\"count\":1,\"result\":{\"COD_DIPENDENTE\":\"00060636\", \"MATRICOLA\":\"60636\", \"COGNOME\":\"PIPPO\"}}`),\n    []byte(`{\"count\":1,\"result\":{\"COD_DIPENDENTE\":\"00060636\", \"MATRICOLA\":\"60636\", \"COGNOME\":\"PIPPO\"}}`),\n}\n\nfunc main() {\n    inputs := make([]Input, len(inputdata))\n    for i := range inputs {\n        err := json.Unmarshal(inputdata[i], &amp;inputs[i])\n        if err != nil {\n            panic(err)\n        }\n    }\n\n    var out Output\n    out.Count = len(inputs)\n    for _, input := range inputs {\n        for k, v := range input.Result {\n            out.Result = append(out.Result, map[string]interface{}{k: v})\n        }\n    }\n\n    outdata, _ := json.Marshal(out)\n    fmt.Println(string(outdata))\n}\n</code></pre>\n\n<p>Which produces output that looks like this when formatted:</p>\n\n<pre><code>{\n  \"count\": 2,\n  \"result\": [\n    {\"MATRICOLA\": \"60636\"},\n    {\"COGNOME\": \"PIPPO\"},\n    {\"COD_DIPENDENTE\": \"00060636\"},\n    {\"COGNOME\": \"PIPPO\"},\n    {\"COD_DIPENDENTE\": \"00060636\"},\n    {\"MATRICOLA\": \"60636\"}\n  ]\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 10150930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GgBBkpUW710/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7puoa8L7t1UYQZjYTO4431xkK3NpA/mo/photo.jpg?sz=128", "display_name": "bed", "link": "https://stackoverflow.com/users/10150930/bed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 773, "favorite_count": 0, "accepted_answer_id": 51585119, "answer_count": 1, "score": 0, "last_activity_date": 1535605705, "creation_date": 1532858962, "last_edit_date": 1532867035, "question_id": 51579246, "link": "https://stackoverflow.com/questions/51579246/merge-two-mapstringinterface-from-json", "title": "merge two map[string]interface{} from json", "body": "<p>I have two json inputs built this way</p>\n\n<pre><code>\"count: 1 result: fields\"   \n</code></pre>\n\n<p>I would like to concatenate the fields that I find within result without using a defined structure. I have tried in many ways but most of the time the result is an error about the type Interface {} or the last map overwritten the data</p>\n\n<p>I would like both the \"result\" and the first and second map fields to be merged within the result in output.</p>\n\n<pre><code>oracle, err := http.Get(\"http://XXX:8080/XXXX/\"+id)\n    if err != nil {\n            panic(err)\n    }\ndefer oracle.Body.Close()\n\nmysql, err := http.Get(\"http://XXX:3000/XXX/\"+id)\nif err != nil {\n        panic(err)\n}\ndefer mysql.Body.Close()\n\noracleJSON, err := ioutil.ReadAll(oracle.Body)\nif err != nil {\n        panic(err)\n}\nmysqlJSON, err := ioutil.ReadAll(mysql.Body)\nif err != nil {\n        panic(err)\n}\n\nvar oracleOUT map[string]interface{}\nvar mysqlOUT map[string]interface{}\n\njson.Unmarshal(oracleJSON, &amp;oracleOUT)\njson.Unmarshal(mysqlJSON, &amp;mysqlOUT)\n\na := oracleOUT[\"result\"]\nb := mysqlOUT[\"result\"]\n\n\nc.JSON(http.StatusOK, gin.H{\"result\": ????})\n</code></pre>\n\n<p>this is an example of json</p>\n\n<pre><code>{\"count\":1,\"result\":{\"COD_DIPENDENTE\":\"00060636\",\"MATRICOLA\":\"60636\",\"COGNOME\":\"PIPPO\"}}\n</code></pre>\n\n<p>If i have two json like this the result of the function it should be </p>\n\n<pre><code>`\"result\":{\"COD_DIPENDENTE\":\"00060636\",\"MATRICOLA\":\"60636\",\"COGNOME\":\"PIPPO\",\"COD_DIPENDENTE\":\"00060636\",\"MATRICOLA\":\"60636\",\"COGNOME\":\"PIPPO\"}}` \n</code></pre>\n"}, {"tags": ["go", "ssa"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1532934673, "post_id": 51578997, "comment_id": 90142535, "body": "Currently: you cannot."}, {"owner": {"reputation": 1447, "user_id": 6771046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K59fa.png?s=128&g=1", "display_name": "U880D", "link": "https://stackoverflow.com/users/6771046/u880d"}, "edited": false, "score": 0, "creation_date": 1534948511, "post_id": 51578997, "comment_id": 90888888, "body": "Right Volker, +1. @Geha, please see <a href=\"https://forum.golangbridge.org/t/ssa-to-go-decompiler/9223/2\" rel=\"nofollow noreferrer\">Golang forum</a> for more background information."}], "owner": {"reputation": 915, "user_id": 6082685, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a9cc15ce2d58adada9312998361ee0c6?s=128&d=identicon&r=PG&f=1", "display_name": "Geha", "link": "https://stackoverflow.com/users/6082685/geha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1532857922, "creation_date": 1532856847, "last_edit_date": 1532857922, "question_id": 51578997, "link": "https://stackoverflow.com/questions/51578997/execute-ssa-code", "title": "Execute SSA code", "body": "<p>I have a SSA code in text file it was generated from golang.</p>\n\n<p><strong>How can I compile this SSA code and execute it?</strong></p>\n\n<p>P.S I don't have an original go code.</p>\n"}, {"tags": ["date", "go"], "comments": [{"owner": {"reputation": 40432, "user_id": 1807667, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/976dc9df3ea3d05a18e90f0cd9c29b7a?s=128&d=identicon&r=PG", "display_name": "Ortomala Lokni", "link": "https://stackoverflow.com/users/1807667/ortomala-lokni"}, "edited": false, "score": 1, "creation_date": 1532852713, "post_id": 51578482, "comment_id": 90122345, "body": "According to the <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">time.Parse function documentation</a>: Years must be in the range 0000..9999."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1532901619, "last_edit_date": 1532901619, "creation_date": 1532856252, "answer_id": 51578926, "question_id": 51578482, "link": "https://stackoverflow.com/questions/51578482/parsing-dates-with-negative-year-in-go/51578926#51578926", "title": "Parsing dates with negative year in Go?", "body": "<p>Here is a first draft that illustrates the concept:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"time\"\n)\n\nfunc parseCEDate(value string) (time.Time, error) {\n    const layout = \"_2 Jan 2006\"\n    date, err := time.Parse(layout, value)\n    if err == nil {\n        return date, err\n    }\n    perr, ok := err.(*time.ParseError)\n    if !ok {\n        return time.Time{}, err\n    }\n    if perr.LayoutElem != \"2006\" {\n        return time.Time{}, err\n    }\n    if !strings.HasPrefix(perr.ValueElem, \"-\") {\n        return time.Time{}, err\n    }\n    value = strings.Replace(value, perr.ValueElem, perr.ValueElem[1:], 1)\n    date, derr := time.Parse(layout, value)\n    if derr != nil {\n        return time.Time{}, err\n    }\n    return date.AddDate(-2*date.Year(), 0, 0), derr\n}\n\nfunc main() {\n    fmt.Println(parseCEDate(\"3 Mar -1500\"))\n    fmt.Println(parseCEDate(\"3 Mar 1500\"))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/QtZ5BBSJmHJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QtZ5BBSJmHJ</a></p>\n\n<p>Output:</p>\n\n<pre><code>-1500-03-03 00:00:00 +0000 UTC &lt;nil&gt;\n1500-03-03 00:00:00 +0000 UTC &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1532901619, "creation_date": 1532852060, "last_edit_date": 1532852832, "question_id": 51578482, "link": "https://stackoverflow.com/questions/51578482/parsing-dates-with-negative-year-in-go", "title": "Parsing dates with negative year in Go?", "body": "<p>How do I parse the date \"3 Mar -1500\" to represent 1500 BC?</p>\n\n<p><a href=\"https://play.golang.org/p/akqQPj4mLeo\" rel=\"nofollow noreferrer\">https://play.golang.org/p/akqQPj4mLeo</a></p>\n"}, {"tags": ["pointers", "go", "func"], "answers": [{"tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": true, "score": 1, "last_activity_date": 1532849137, "creation_date": 1532849137, "answer_id": 51578192, "question_id": 51578131, "link": "https://stackoverflow.com/questions/51578131/golang-funcs-in-func-list-take-last-value/51578192#51578192", "title": "Golang funcs in func list take last value", "body": "<p>If we think of what code is generated for those functions, it is identical indeed: the same variable is used every time. Even though <code>i</code> is out of scope after the loop, it becomes the part of the closures and its latest value is seen by the function when they run. By the moment the loop exits, it's <code>3</code>. If you want to bind a closure to the particular value and guard it from further changes, you may create a narrow-scoped variable, like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    flist := make([]func(), 0)\n    for i := 0; i &lt; 3; i++ {\n        j := i  // a different variable for each iteration\n        flist = append(flist, func() { fmt.Printf(\"%d \", j) })\n    }\n    for j := 0; j &lt; 3; j++ {\n        flist[j]()\n    }\n} \n</code></pre>\n"}], "owner": {"reputation": 818, "user_id": 4287267, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/MxZkq.png?s=128&g=1", "display_name": "mjgalindo", "link": "https://stackoverflow.com/users/4287267/mjgalindo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 51578192, "answer_count": 1, "score": 0, "last_activity_date": 1532849137, "creation_date": 1532848590, "question_id": 51578131, "link": "https://stackoverflow.com/questions/51578131/golang-funcs-in-func-list-take-last-value", "title": "Golang funcs in func list take last value", "body": "<p>In the following snippet I create a func list that should, the way I see it, contain funcs that print the numbers 0 1 2.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    flist := make([]func(), 0)\n    for i := 0; i &lt; 3; i++ {\n        flist = append(flist, func() { fmt.Printf(\"%d \", i) })\n    }\n    for j := 0; j &lt; 3; j++ {\n        flist[j]()\n    }\n}\n</code></pre>\n\n<p>However, all funcs in <code>flist</code> are the same <code>main.main.func1</code> and the output is</p>\n\n<p><code>3 3 3</code></p>\n\n<p>even though <code>i</code> never reaches the value 3 in the loop. This would make me thing the func is simply taking the address of <code>i</code>, creating the same func every time but that <code>i</code> is out of scope when the funcs are called later.</p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1532847681, "post_id": 51577388, "comment_id": 90121406, "body": "line <code>cursor.Decode(e)</code> returns error too. add its result in your question"}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1532931867, "post_id": 51577388, "comment_id": 90141245, "body": "No. If I print e I see valid BSON data from MongoDB"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 1, "creation_date": 1532935258, "post_id": 51577388, "comment_id": 90142802, "body": "i mean the function <code>Decode()</code> returns error too. print the error here if its not nil"}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1532955947, "post_id": 51577388, "comment_id": 90155008, "body": "Yes, you are right. <code>Decode(interface{}) error</code> is the definition of <code>Decode</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2803, "user_id": 921082, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0770877b86732beed2e809a6f7797f65?s=128&d=identicon&r=PG", "display_name": "tomriddle_1234", "link": "https://stackoverflow.com/users/921082/tomriddle-1234"}, "edited": false, "score": 0, "creation_date": 1535334221, "post_id": 51578525, "comment_id": 91013648, "body": "may I ask, do you really need the _id checked out from Mongodb?"}, {"owner": {"reputation": 757, "user_id": 3795212, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/987621bf8b5d812def204c0075ed0d2d?s=128&d=identicon&r=PG&f=1", "display_name": "apostrophedottilde", "link": "https://stackoverflow.com/users/3795212/apostrophedottilde"}, "edited": false, "score": 0, "creation_date": 1550311806, "post_id": 51578525, "comment_id": 96228407, "body": "I notice that this struct describes both JSON and BSON serialisation. This feels like the same struct that is &#39;fetched&#39; from the database is then presented to the user as JSON without transformation, essentially exposing your data structures directly to the client. As a relative newcomer to Go,  I am genuinely very curious as to whether this is really considered good practice? Is this idiomatic go?"}, {"owner": {"reputation": 26372, "user_id": 5867722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VQ1v.jpg?s=128&g=1", "display_name": "Farhad Farahi", "link": "https://stackoverflow.com/users/5867722/farhad-farahi"}, "edited": false, "score": 0, "creation_date": 1550315107, "post_id": 51578525, "comment_id": 96229192, "body": "I will leave the &quot;is this idiomatic go?&quot;, to the experts to answer. You can always use <code>Field int json:&quot;-&quot;</code> to avoid sending a field to client"}], "tags": [], "owner": {"reputation": 26372, "user_id": 5867722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VQ1v.jpg?s=128&g=1", "display_name": "Farhad Farahi", "link": "https://stackoverflow.com/users/5867722/farhad-farahi"}, "is_accepted": true, "score": 10, "last_activity_date": 1532852457, "creation_date": 1532852457, "answer_id": 51578525, "question_id": 51577388, "link": "https://stackoverflow.com/questions/51577388/in-mongodb-go-driver-how-to-marshal-unmarshal-bson-in-to-a-struct/51578525#51578525", "title": "In mongodb-go-driver, how to marshal/unmarshal BSON in to a struct", "body": "<p>The official MongoDB driver uses the objectid.ObjectID type for MongoDB ObjectIds. This type is:</p>\n\n<p><code>type ObjectID [12]byte</code></p>\n\n<p>So you need to change your struct to:</p>\n\n<pre><code>type Language struct {\n    ID         objectid.ObjectID   `json:\"id\" bson:\"_id\"`             \n    Name       string   `json:\"name\" bson:\"name\"`\n    Vowels     []string `json:\"vowels\" bson:\"vowels\"`\n    Consonants []string `json:\"consonants\" bson:\"consonants\"`\n}\n</code></pre>\n\n<p>I had success with:</p>\n\n<pre><code>m := make(map[string]Language)\ncursor, e := collection.Find(context.Background(), bson.NewDocument(bson.EC.String(\"name\", id)))\n\nfor cursor.Next(context.Background()) {\n\n    l := Language{}\n    err := cursor.Decode(&amp;l)\n    if err != nil {\n        //handle err\n    }\n    m[id] = l // you need to handle this in a for loop or something... I'm assuming there is only one result per id\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 895, "user_id": 904335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03fc2aea05dfb5cea4fcf22817eea3fd?s=128&d=identicon&r=PG", "display_name": "Alexey Podlasov", "link": "https://stackoverflow.com/users/904335/alexey-podlasov"}, "edited": false, "score": 0, "creation_date": 1547057410, "post_id": 54059780, "comment_id": 95064749, "body": "That works, but this will JSON serialize into <code>&quot;ID&quot;:{&quot;Type&quot;:7,&quot;Value&quot;:&quot;XDYvP6JTO607bPbw&quot;}</code>"}], "tags": [], "owner": {"reputation": 465, "user_id": 1936173, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/8uQ1j.png?s=128&g=1", "display_name": "Illia Danko", "link": "https://stackoverflow.com/users/1936173/illia-danko"}, "is_accepted": false, "score": 6, "last_activity_date": 1547221849, "last_edit_date": 1547221849, "creation_date": 1546762630, "answer_id": 54059780, "question_id": 51577388, "link": "https://stackoverflow.com/questions/51577388/in-mongodb-go-driver-how-to-marshal-unmarshal-bson-in-to-a-struct/54059780#54059780", "title": "In mongodb-go-driver, how to marshal/unmarshal BSON in to a struct", "body": "<p><strong>Update:</strong>\nNew changes were made recently, now have to change to:</p>\n\n<pre><code>import \"github.com/mongodb/mongo-go-driver/bson/primitive\"\n\ntype Language struct {\n    ID         primitive.ObjectID `bson:\"_id,omitempty\"` // omitempty to protect against zeroed _id insertion         \n    Name       string   `json:\"name\" bson:\"name\"`\n    Vowels     []string `json:\"vowels\" bson:\"vowels\"`\n    Consonants []string `json:\"consonants\" bson:\"consonants\"`\n}\n</code></pre>\n\n<p>And take the ID value:</p>\n\n<pre><code>log.Println(\"lang id:\", objLang.ID)\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 895, "user_id": 904335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03fc2aea05dfb5cea4fcf22817eea3fd?s=128&d=identicon&r=PG", "display_name": "Alexey Podlasov", "link": "https://stackoverflow.com/users/904335/alexey-podlasov"}, "is_accepted": false, "score": 19, "last_activity_date": 1547223513, "last_edit_date": 1547223513, "creation_date": 1547057813, "answer_id": 54116108, "question_id": 51577388, "link": "https://stackoverflow.com/questions/51577388/in-mongodb-go-driver-how-to-marshal-unmarshal-bson-in-to-a-struct/54116108#54116108", "title": "In mongodb-go-driver, how to marshal/unmarshal BSON in to a struct", "body": "<p>Newer \"github.com/mongodb/mongo-go-driver\" expects object IDs defined as </p>\n\n<pre><code>type Application struct {\n    ID      *primitive.ObjectID `json:\"ID\" bson:\"_id,omitempty\"`\n}\n</code></pre>\n\n<p>This serializes into JSON <code>\"ID\":\"5c362f3fa2533bad3b6cf6f0\"</code> and here is how you get the ID from insert result</p>\n\n<pre><code>if oid, ok := res.InsertedID.(primitive.ObjectID); ok {\n    app.ID = &amp;oid\n}\n</code></pre>\n\n<p>Convert from string</p>\n\n<pre><code>appID := \"5c362f3fa2533bad3b6cf6f0\"    \nid, err := primitive.ObjectIDFromHex(appID)\nif err != nil {\n    return err\n}\n_, err = collection.DeleteOne(nil, bson.M{\"_id\": id})\n</code></pre>\n\n<p>Convert into string</p>\n\n<pre><code>str_id := objId.Hex()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 5445321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G8U6N.png?s=128&g=1", "display_name": "Yianni", "link": "https://stackoverflow.com/users/5445321/yianni"}, "is_accepted": false, "score": 2, "last_activity_date": 1560959767, "creation_date": 1560959767, "answer_id": 56671716, "question_id": 51577388, "link": "https://stackoverflow.com/questions/51577388/in-mongodb-go-driver-how-to-marshal-unmarshal-bson-in-to-a-struct/56671716#56671716", "title": "In mongodb-go-driver, how to marshal/unmarshal BSON in to a struct", "body": "<p>I was getting </p>\n\n<p><code>cannot decode objectID into an array</code></p>\n\n<p>so i changed to </p>\n\n<p><code>ID interface{} `bson:\"_id,omitempty\"`</code></p>\n\n<p>without any issues</p>\n"}], "owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17285, "favorite_count": 5, "accepted_answer_id": 51578525, "answer_count": 4, "score": 11, "last_activity_date": 1560959767, "creation_date": 1532840645, "question_id": 51577388, "link": "https://stackoverflow.com/questions/51577388/in-mongodb-go-driver-how-to-marshal-unmarshal-bson-in-to-a-struct", "title": "In mongodb-go-driver, how to marshal/unmarshal BSON in to a struct", "body": "<p>I am new to mongodb-go-driver. But i am stuck.</p>\n\n<pre><code>cursor, e := collection.Find(context.Background(), bson.NewDocument(bson.EC.String(\"name\", id)))\n\nfor cursor.Next(context.Background()) {\n\n    e := bson.NewDocument()\n    cursor.Decode(e)\n\n    b, _ := e.MarshalBSON()\n    err := bson.Unmarshal(b, m[id])\n}\n</code></pre>\n\n<p>When look at the contents of m[id], it has no content - all nulls.</p>\n\n<p>My map is like this : \n    m   map[string]Language</p>\n\n<p>and Language is defined like :</p>\n\n<pre><code>type Language struct {\n    ID         string   `json:\"id\" bson:\"_id\"`                   // is this wrong?\n    Name       string   `json:\"name\" bson:\"name\"`\n    Vowels     []string `json:\"vowels\" bson:\"vowels\"`\n    Consonants []string `json:\"consonants\" bson:\"consonants\"`\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>I am learning using this example : <a href=\"https://github.com/mongodb/mongo-go-driver/blob/master/examples/documentation_examples/examples.go\" rel=\"noreferrer\">https://github.com/mongodb/mongo-go-driver/blob/master/examples/documentation_examples/examples.go</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 0, "last_activity_date": 1532850015, "creation_date": 1532850015, "answer_id": 51578288, "question_id": 51576791, "link": "https://stackoverflow.com/questions/51576791/fuzzy-matching-a-list-of-coordinates-golang/51578288#51578288", "title": "Fuzzy matching a list of coordinates (Golang)", "body": "<p>You have two problems for each set of points (start and end): </p>\n\n<ol>\n<li>Convert locations to lat lon</li>\n<li>Fuzzy match lat,lon to this traffic data (which contains lat,lon)</li>\n</ol>\n\n<p>The location to lat,lon conversion is pretty straightforward using a reverse geocoding api like the one available from google. </p>\n\n<p>To match lat,lon fuzzily, you could either truncate lat lon and store that as a hash (so that you're storing approximate matches), then lookup data that way, or you could do a radius calc and pick results within that radius (this requires some math involving the radius of the earth which you can look up easily enough, it can be done in sql if your data is in a db for example). </p>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532850015, "creation_date": 1532832031, "question_id": 51576791, "link": "https://stackoverflow.com/questions/51576791/fuzzy-matching-a-list-of-coordinates-golang", "title": "Fuzzy matching a list of coordinates (Golang)", "body": "<p>I'm trying to create a simple tool which will allow a user to specify two places around Seattle.</p>\n\n<p>I'm working with the WSDOT traffic data set. An example of the output can be found here: <a href=\"https://gist.github.com/jaxxstorm/0ab818b300f65cf3a46cc01dbc35bf60\" rel=\"nofollow noreferrer\">https://gist.github.com/jaxxstorm/0ab818b300f65cf3a46cc01dbc35bf60</a></p>\n\n<p>What I'd like to be able to do is specify two locations like:</p>\n\n<p>Bellevue\nSeattle</p>\n\n<p>and then lookup all traffic times for those locations.</p>\n\n<p>I'm considering doing a reverse geocode like <a href=\"https://stackoverflow.com/questions/28998709/how-can-i-get-the-nearest-city-to-geo-coordinates-with-go\">this answer</a> but I want it to be \"fuzzy\" in that I don't want people to have to specify exact locations. I also suspect the processing time for this might be long as I'd have to loop through the list, and reverse lookup all the coordinates which could take a short while</p>\n\n<p>Is there any better alternatives for processing this data in this way? I'm writing the tool in Go</p>\n"}, {"tags": ["linux", "file", "go"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1532828891, "post_id": 51576496, "comment_id": 90118679, "body": "How are you going to know that the <i>entire</i> file was copied correctly?  Are you just assuming it will be?"}, {"owner": {"reputation": 411, "user_id": 5458950, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb2b553cce267f4db596aef25327f61c?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/5458950/chaos"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1532829142, "post_id": 51576496, "comment_id": 90118706, "body": "Assumption @AndrewHenle unless you know of any other way"}], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 5458950, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb2b553cce267f4db596aef25327f61c?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/5458950/chaos"}, "edited": false, "score": 0, "creation_date": 1532829122, "post_id": 51576574, "comment_id": 90118701, "body": "fsnotify looks like it could work, however it also only has a Create event. How could I know when the file is closed using it?"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 411, "user_id": 5458950, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb2b553cce267f4db596aef25327f61c?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/5458950/chaos"}, "edited": false, "score": 0, "creation_date": 1532829372, "post_id": 51576574, "comment_id": 90118730, "body": "@Chaos: Indeed!  I just realized that while <code>fsnotify</code> uses <code>inotify</code>, it does so in a non-customizable way that does not support <code>unix.IN_CLOSE_WRITE</code> (the event name you&#39;d want).  There is a note about this here: <a href=\"https://github.com/golang/go/issues/15406\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/15406</a> .  I guess you will need to write your own code using <code>inotify</code>, perhaps using <code>fsnotify</code> as a starting point.  I&#39;ll edit my answer a bit."}, {"owner": {"reputation": 411, "user_id": 5458950, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb2b553cce267f4db596aef25327f61c?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/5458950/chaos"}, "edited": false, "score": 0, "creation_date": 1532829754, "post_id": 51576574, "comment_id": 90118770, "body": "Thanks, do you perhaps any example of the inotify package? Does the FILE CLOSE event make sense for my use case? It would be triggered for files being being editted as well, not just for initial copies right?"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 411, "user_id": 5458950, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb2b553cce267f4db596aef25327f61c?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/5458950/chaos"}, "edited": false, "score": 0, "creation_date": 1532830821, "post_id": 51576574, "comment_id": 90118894, "body": "@Chaos: see here for one possible inotify package for Go: <a href=\"https://godoc.org/lukeshu.com/git/go/libgnulinux.git/inotify\" rel=\"nofollow noreferrer\">godoc.org/lukeshu.com/git/go/libgnulinux.git/inotify</a> .  I suggest using the &quot;create&quot; event to look for new files, and the &quot;file close write&quot; event to look for files which are &quot;finished.&quot;  If you see both events for a file, there&#39;s a good chance it is one  you want."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 2, "last_activity_date": 1532829446, "last_edit_date": 1532829446, "creation_date": 1532828736, "answer_id": 51576574, "question_id": 51576496, "link": "https://stackoverflow.com/questions/51576496/wait-until-a-file-is-done-being-copied/51576574#51576574", "title": "Wait until a file is done being copied", "body": "<p>The library you are using cannot do what you are asking.  The docs say:</p>\n\n<blockquote>\n  <p>watcher is a Go package for watching for files or directory changes (recursively or non recursively) <strong>without using filesystem events</strong>, which allows it to work cross platform consistently.</p>\n</blockquote>\n\n<p>When I first saw this question, I thought it would be easily solved by waiting for the \"file close\" event, which will occur when a file copy is complete.  But because the library you're using refuses to utilize platform-specific APIs, it cannot know this information.</p>\n\n<p>You can solve your problem more efficiently and accurately by using <code>inotify</code>.  There is <a href=\"https://github.com/fsnotify/fsnotify\" rel=\"nofollow noreferrer\">https://github.com/fsnotify/fsnotify</a> but it does not support the <code>IN_CLOSE_WRITE</code> event (see <a href=\"https://github.com/golang/go/issues/15406\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/15406</a>).  Perhaps you can use it as inspiration to write your own <code>inotify</code> wrapper which does support <code>IN_CLOSE_WRITE</code> (and probably little else).</p>\n\n<p>One notable limitation of <code>inotify</code> is that it will not work with NFS, but there are limitations with <code>watcher</code> too (and you wouldn't want to use its polling mechanism on a network share, at least not rapidly).</p>\n"}, {"tags": [], "owner": {"reputation": 2182, "user_id": 991076, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1a0377f4f9912163fc86713519db487f?s=128&d=identicon&r=PG", "display_name": "seaguest", "link": "https://stackoverflow.com/users/991076/seaguest"}, "is_accepted": false, "score": 1, "last_activity_date": 1561607092, "creation_date": 1561607092, "answer_id": 56783607, "question_id": 51576496, "link": "https://stackoverflow.com/questions/51576496/wait-until-a-file-is-done-being-copied/56783607#56783607", "title": "Wait until a file is done being copied", "body": "<p>fkocik has committed a PR which implements IN_CLOSE_WRITE, and it does work for me on Linux.</p>\n\n<p><a href=\"https://github.com/fsnotify/fsnotify/pull/252\" rel=\"nofollow noreferrer\">ADDED: CloseWrite event support</a></p>\n\n<p>NB: the code is not present in the master branch yet, you nee retrieve it manually. </p>\n"}], "owner": {"reputation": 411, "user_id": 5458950, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb2b553cce267f4db596aef25327f61c?s=128&d=identicon&r=PG", "display_name": "Chaos", "link": "https://stackoverflow.com/users/5458950/chaos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1515, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1561607092, "creation_date": 1532827454, "last_edit_date": 1532827921, "question_id": 51576496, "link": "https://stackoverflow.com/questions/51576496/wait-until-a-file-is-done-being-copied", "title": "Wait until a file is done being copied", "body": "<p>I'm using the golang watcher package to watch a directory of files.\n<a href=\"https://github.com/radovskyb/watcher\" rel=\"nofollow noreferrer\">https://github.com/radovskyb/watcher</a></p>\n\n<p>The only issue is that the Create event is triggered when a file begins being copied/moved, not when it's actually ready. I was wondering if there was a neat way in Go to sort of wait after the create event until the file is no longer being written to before continuing on.</p>\n\n<p>I suppose this waiting would most likely have to be done in a goroutine to not block any other file events. </p>\n\n<p>Simple example:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"log\"\n        \"time\"\n\n        \"github.com/radovskyb/watcher\"\n)\n\nfunc main() {\n        w := watcher.New()\n\n        w.FilterOps(watcher.Create, watcher.Write)\n\n        go func() {\n                for {\n                        select {\n                        case event := &lt;-w.Event:\n                                fmt.Println(event) // Print the event's info.\n                                if event.Op == watcher.Create {\n                                    // HERE WE DO STUFF\n                                    doStuff(event)\n                                }\n                        case err := &lt;-w.Error:\n                                log.Fatalln(err)\n                        case &lt;-w.Closed:\n                                return\n                        }\n                }\n        }()\n\n        // Watch this folder for changes.\n        if err := w.Add(\"./files/\"); err != nil {\n                log.Fatalln(err)\n        }\n\n\n        // Start the watching process - it'll check for changes every 100ms.\n        if err := w.Start(time.Millisecond * 100); err != nil {\n                log.Fatalln(err)\n        }\n}\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 10102358, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CLSltd3rmjE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rZpBvod8TQ7AKPmfDN-1fcjeztRQ/mo/photo.jpg?sz=128", "display_name": "Josh Wright", "link": "https://stackoverflow.com/users/10102358/josh-wright"}, "is_accepted": true, "score": 2, "last_activity_date": 1532823093, "creation_date": 1532823093, "answer_id": 51576214, "question_id": 51576115, "link": "https://stackoverflow.com/questions/51576115/not-printing-receiving-channel-value-on-console/51576214#51576214", "title": "Not printing Receiving Channel value on console", "body": "<p>A good pattern for using <code>WaitGroup</code> is to call <code>Add()</code> before you send to the channel or use the <code>go</code> keyword, and call <code>Done()</code> after receiving from the channel.\nThis way you can be sure that <code>Add()</code> is always called on-time, regardless of whether sending on the channel blocks.</p>\n\n<p>I have changed your example code to do this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype safeOperation struct {\n    i int\n    sync.Mutex\n}\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    so := new(safeOperation)\n    ch := make(chan int)\n    for i := 0; i &lt; 5; i++ {\n        wg.Add(1)\n        go so.Increment(ch)\n        wg.Add(1)\n        go so.Decrement(ch)\n    }\n\n    go func() {\n        for c := range ch {\n            fmt.Println(\"Receiving Channel Value: \", c)\n            wg.Done()\n        }\n    }()\n    wg.Wait()\n    //&lt;-done\n    fmt.Println(\"Value: \", so.GetValue())\n    fmt.Println(\"Main method finished\")\n}\n\nfunc (so *safeOperation) Increment(ch chan int) {\n    so.i++\n    ch &lt;- so.i\n}\n\nfunc (so *safeOperation) Decrement(ch chan int) {\n    so.i--\n    ch &lt;- so.i\n}\n\nfunc (so *safeOperation) GetValue() int {\n    so.Lock()\n    v := so.i\n    so.Unlock()\n    return v\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/xce_7sFdgqf\" rel=\"nofollow noreferrer\">Go playground link</a></p>\n\n<p>Of course you also want to protect <code>safeOperation.i</code> with a mutex (or its value will be unpredictable), but this is all that is necessary to get the desired output.</p>\n"}], "owner": {"reputation": 371, "user_id": 8371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a960d78c618a2e95795f9115259a21?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Singh", "link": "https://stackoverflow.com/users/8371320/deepak-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 51576214, "answer_count": 1, "score": 1, "last_activity_date": 1532823882, "creation_date": 1532821911, "question_id": 51576115, "link": "https://stackoverflow.com/questions/51576115/not-printing-receiving-channel-value-on-console", "title": "Not printing Receiving Channel value on console", "body": "<p>I am a learner to GoLang and was trying to experiment and learn about Sync package and chan concept. </p>\n\n<p>Follwoing is the code I am running and expecting to print <strong>Receiving Channel Value</strong> on console, but the value is not getting printed, it print the values sometimes but not always.</p>\n\n<p>If I range through the chan without putting it into the go routine then its printing all the channel values but failing with an error \"<strong>fatal error: all goroutines are asleep - deadlock!</strong>\"</p>\n\n<p>I tried synchronizing the channel reading using channel \"done\", but in that case it again started failing with same error. I also tried waitGroup API as well which you can see in my code (commented), but that also didn't worked for me.</p>\n\n<p>Thanks for the help</p>\n\n<p><strong>Source Code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype safeOperation struct {\n    i int\n    sync.Mutex\n}\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    so := new(safeOperation)\n    ch := make(chan int)\n    //done := make(chan bool)\n    for i := 0; i &lt; 5; i++ {\n        go so.Increment(ch)\n        go so.Decrement(ch)\n    }\n\n    go func() {\n        //wg.Add(1)\n        for c := range ch {\n            fmt.Println(\"Receiving Channel Value: \", c)\n        }\n        //wg.Done()\n        //done &lt;- true\n    }()\n    //wg.Wait()\n    //&lt;-done\n    fmt.Println(\"Value: \", so.GetValue())\n    fmt.Println(\"Main method finished\")\n}\n\nfunc (so *safeOperation) Increment(ch chan int) {\n    //so.Lock()\n    //defer wg.Done()\n    so.i++\n    ch &lt;- so.i\n    //so.Unlock()\n}\n\nfunc (so *safeOperation) Decrement(ch chan int) {\n    //so.Lock()\n    //defer wg.Done()\n    so.i--\n    ch &lt;- so.i\n    //so.Unlock()\n}\n\nfunc (so *safeOperation) GetValue() int {\n    so.Lock()\n    v := so.i\n    so.Unlock()\n    return v\n}\n</code></pre>\n\n<p><strong>Output:</strong>\nValue:  1\nMain method finished</p>\n"}]